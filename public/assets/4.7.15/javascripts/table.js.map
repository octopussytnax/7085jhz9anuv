{"version":3,"sources":["../../../../vendor/assets/javascripts/rgbcolor.js","../../../../lib/assets/javascripts/cartodb/old_common/global_click.js","../../../../lib/assets/javascripts/cartodb/table/map/draw_geometry.js","../../../../lib/assets/javascripts/cartodb/table/mapview.js","../../../../lib/assets/javascripts/cartodb/table/slides/transition_dropdown.js","../../../../vendor/assets/javascripts/codemirror.js","../../../../vendor/assets/javascripts/show-hint.js","../../../../vendor/assets/javascripts/anyword-hint.js","../../../../vendor/assets/javascripts/custom-list-hint.js","../../../../vendor/assets/javascripts/custom-list-with-type-hint.js","../../../../vendor/assets/javascripts/select2.min.js","../../../../vendor/assets/javascripts/jquery.faviconNotify.js","../../../../vendor/assets/javascripts/crossfilter.js","../../../../vendor/assets/javascripts/jquery-ui/jquery.effects.core.js","../../../../vendor/assets/javascripts/jquery-ui/jquery.effects.ui.blind.js","../../../../vendor/assets/javascripts/jquery-ui/jquery.effects.ui.highlight.js","../../../../vendor/assets/javascripts/jquery-ui/jquery.ui.autocomplete.js","../../../../vendor/assets/javascripts/jquery-ui/jquery.ui.core.js","../../../../vendor/assets/javascripts/jquery-ui/jquery.ui.draggable.js","../../../../vendor/assets/javascripts/jquery-ui/jquery.ui.droppable.js","../../../../vendor/assets/javascripts/jquery-ui/jquery.ui.mouse.js","../../../../vendor/assets/javascripts/jquery-ui/jquery.ui.position.js","../../../../vendor/assets/javascripts/jquery-ui/jquery.ui.resizable.min.js","../../../../vendor/assets/javascripts/jquery-ui/jquery.ui.slider.js","../../../../vendor/assets/javascripts/jquery-ui/jquery.ui.sortable.js","../../../../vendor/assets/javascripts/jquery-ui/jquery.ui.widget.js","../../../../vendor/assets/javascripts/jquery.caret.js","../../../../vendor/assets/javascripts/moment.js","../../../../vendor/assets/javascripts/ZeroClipboard.js","../../../../vendor/assets/javascripts/tag-it.js","../../../../vendor/assets/javascripts/jquery.tipsy.js","../../../../vendor/assets/javascripts/d3.v2.js","../../../../vendor/assets/javascripts/colorpicker.js","../../../../vendor/assets/javascripts/leaflet.draw.js","../../../../vendor/assets/javascripts/markdown.js","../../../../vendor/assets/javascripts/datepicker.js","../../../../vendor/assets/javascripts/dragster.js","../../../../vendor/assets/javascripts/dropzone.js","../../../../vendor/assets/javascripts/backbone-model-file-upload.js","../../../../vendor/assets/javascripts/html2canvas.js","../../../../lib/assets/javascripts/utils/postgres.codemirror.js","../../../../lib/assets/javascripts/utils/xml.codemirror.js","../../../../lib/assets/javascripts/utils/draggable.js","../../../../lib/assets/javascripts/utils/carto.codemirror.js","../../../../lib/assets/javascripts/utils/color.keywords.js","../../../../lib/assets/javascripts/cartodb/table/leaflet_monkeypath.js","../../../../lib/assets/javascripts/cartodb/old_common/utils.js","../../../../lib/assets/javascripts/cartodb/old_common/dropdown_menu.js","../../../../lib/assets/javascripts/cartodb/old_common/forms/string_field.js","../../../../lib/assets/javascripts/cartodb/old_common/forms/widgets.js","../../../../lib/assets/javascripts/cartodb/table/overlays/text.js","../../../../lib/assets/javascripts/cartodb/old_common/urls/url.js","../../../../lib/assets/javascripts/cartodb/old_common/urls/dashboard_vis_url.js","../../../../lib/assets/javascripts/cartodb/old_common/custom_scroll.js","../../../../lib/assets/javascripts/cartodb/old_common/error_stats.js","../../../../lib/assets/javascripts/cartodb/old_common/forms/boolean_field.js","../../../../lib/assets/javascripts/cartodb/old_common/forms/color_picker.js","../../../../lib/assets/javascripts/cartodb/old_common/forms/date_field.js","../../../../lib/assets/javascripts/cartodb/old_common/forms/edit_in_place.js","../../../../lib/assets/javascripts/cartodb/old_common/forms/filters_combo.js","../../../../lib/assets/javascripts/cartodb/old_common/forms/form.js","../../../../lib/assets/javascripts/cartodb/old_common/forms/geometry_field.js","../../../../lib/assets/javascripts/cartodb/old_common/forms/number_field.js","../../../../lib/assets/javascripts/cartodb/old_common/forms/spinner_slider.js","../../../../lib/assets/javascripts/cartodb/old_common/forms/text_custom_combo.js","../../../../lib/assets/javascripts/cartodb/old_common/globalerror.js","../../../../lib/assets/javascripts/cartodb/old_common/header.js","../../../../lib/assets/javascripts/cartodb/old_common/hotkeys.js","../../../../lib/assets/javascripts/cartodb/old_common/localStorage.js","../../../../lib/assets/javascripts/cartodb/old_common/metrics.js","../../../../lib/assets/javascripts/cartodb/old_common/small_dialog.js","../../../../lib/assets/javascripts/cartodb/old_common/tabs.js","../../../../lib/assets/javascripts/cartodb/old_common/tipsy_tooltip.js","../../../../lib/assets/javascripts/cartodb/old_common/tooltip_trails.js","../../../../lib/assets/javascripts/cartodb/old_common/urls/dashboard_datasets_url.js","../../../../lib/assets/javascripts/cartodb/old_common/urls/dashboard_url.js","../../../../lib/assets/javascripts/cartodb/old_common/urls/dataset_url.js","../../../../lib/assets/javascripts/cartodb/old_common/urls/map_url.js","../../../../lib/assets/javascripts/cartodb/old_common/urls/organization_url.js","../../../../lib/assets/javascripts/cartodb/old_common/urls/user_url.js","../../../../lib/assets/javascripts/cartodb/old_common/video_player.js","../../../../lib/assets/javascripts/cartodb/old_common/wizard_dialog.js","../../../../lib/assets/javascripts/cartodb/table/right_menu.js","../../../../lib/assets/javascripts/cartodb/table/default_layers.js","../../../../lib/assets/javascripts/cartodb/table/menu_module.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/carto_editor.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/carto_wizard.js","../../../../lib/assets/javascripts/cartodb/table/actions_menu.js","../../../../lib/assets/javascripts/cartodb/table/basemap/basemap_dropdown/add_basemap_button.js","../../../../lib/assets/javascripts/cartodb/table/basemap/basemap_dropdown/basemap_dropdown.js","../../../../lib/assets/javascripts/cartodb/table/basemap/basemap_dropdown/color_basemap.js","../../../../lib/assets/javascripts/cartodb/table/basemap/basemap_dropdown/custom_basemap.js","../../../../lib/assets/javascripts/cartodb/table/basemap/basemap_dropdown/gmaps_basemap.js","../../../../lib/assets/javascripts/cartodb/table/basemap/basemap_dropdown/pattern_basemap.js","../../../../lib/assets/javascripts/cartodb/table/column_type_dropdown.js","../../../../lib/assets/javascripts/cartodb/table/editor_small_dialog.js","../../../../lib/assets/javascripts/cartodb/table/export_image_format_dropdown.js","../../../../lib/assets/javascripts/cartodb/table/export_image_view.js","../../../../lib/assets/javascripts/cartodb/table/geom_editor.js","../../../../lib/assets/javascripts/cartodb/table/header/header_sync_info.js","../../../../lib/assets/javascripts/cartodb/table/header/options_menu.js","../../../../lib/assets/javascripts/cartodb/table/header_dropdown.js","../../../../lib/assets/javascripts/cartodb/table/header_view.js","../../../../lib/assets/javascripts/cartodb/table/infowindow.js","../../../../lib/assets/javascripts/cartodb/table/layer_panel_view.js","../../../../lib/assets/javascripts/cartodb/table/map/layerview_from_layergroup.js","../../../../lib/assets/javascripts/cartodb/table/map/map_options_dropdown.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/carto_wizard_forms.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/codemirror_color_picker.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/filters.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/filters/histogram.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/filters/selection.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/html_editor_help.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/infowindow.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/infowindow/infowindow_base_pane.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/infowindow/infowindow_field.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/infowindow/infowindow_field_item.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/infowindow/infowindow_fields_pane.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/infowindow/infowindow_html_pane.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/infowindow/infowindow_tab.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/infowindow/infowindow_title_pane.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/infowindow/tooltip_tab.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/legend_editor.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/legends/bubble_legend.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/legends/category_legend.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/legends/choropleth_legend.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/legends/color_legend.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/legends/density_legend.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/legends/intensity_legend.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/legends/legend_fields_pane.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/legends/legend_html_pane.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/sql.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/wizards/bubble_wizard.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/wizards/category_wizard.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/wizards/choropleth_wizard.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/wizards/cluster_wizard.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/wizards/density_wizard.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/wizards/intensity_wizard.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/wizards/torque.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/wizards/torque_category.js","../../../../lib/assets/javascripts/cartodb/table/menu_modules/wizards/torque_heat_wizard.js","../../../../lib/assets/javascripts/cartodb/table/overlays/annotation.js","../../../../lib/assets/javascripts/cartodb/table/overlays/canvas_setup_dropdown.js","../../../../lib/assets/javascripts/cartodb/table/overlays/code.js","../../../../lib/assets/javascripts/cartodb/table/overlays/fullscreen.js","../../../../lib/assets/javascripts/cartodb/table/overlays/header.js","../../../../lib/assets/javascripts/cartodb/table/overlays/image.js","../../../../lib/assets/javascripts/cartodb/table/overlays/layer_selector.js","../../../../lib/assets/javascripts/cartodb/table/overlays/loader.js","../../../../lib/assets/javascripts/cartodb/table/overlays/logo.js","../../../../lib/assets/javascripts/cartodb/table/overlays/map_overlays.js","../../../../lib/assets/javascripts/cartodb/table/overlays/mobile.js","../../../../lib/assets/javascripts/cartodb/table/overlays/overlay_properties_bar.js","../../../../lib/assets/javascripts/cartodb/table/overlays/overlay_properties_dropdown.js","../../../../lib/assets/javascripts/cartodb/table/overlays/overlays.js","../../../../lib/assets/javascripts/cartodb/table/overlays/overlays_dropdown.js","../../../../lib/assets/javascripts/cartodb/table/overlays/search.js","../../../../lib/assets/javascripts/cartodb/table/overlays/search_control_view.js","../../../../lib/assets/javascripts/cartodb/table/overlays/search_infowindow_view.js","../../../../lib/assets/javascripts/cartodb/table/overlays/share.js","../../../../lib/assets/javascripts/cartodb/table/overlays/zoom.js","../../../../lib/assets/javascripts/cartodb/table/row_header_dropdown.js","../../../../lib/assets/javascripts/cartodb/table/row_view.js","../../../../lib/assets/javascripts/cartodb/table/slides/panel.js","../../../../lib/assets/javascripts/cartodb/table/table.js","../../../../lib/assets/javascripts/cartodb/table/table_router.js","../../../../lib/assets/javascripts/cartodb/table/tableview.js","../../../../lib/assets/javascripts/cartodb/table/tooltip.js","../../../../lib/assets/javascripts/cartodb/table/watching_notifier_model.js","../../../../lib/assets/javascripts/cartodb/table/watching_notifier_view.js"],"names":["RGBColor","color_string","this","ok","charAt","substr","replace","toLowerCase","simple_colors","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","feldspar","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgrey","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslateblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","violetred","wheat","white","whitesmoke","yellow","yellowgreen","key","color_defs","re","example","process","bits","parseInt","i","length","processor","exec","channels","r","g","b","isNaN","toRGB","toHex","toString","getHelpXML","examples","Array","j","sc","xml","document","createElement","setAttribute","list_item","list_color","example_div","style","cssText","appendChild","createTextNode","list_item_value","e","enableClickOut","el","click","cdb","god","trigger","MarkerGMaps","opts","arguments","position","google","maps","LatLng","Marker","apply","PolygonGMaps","Polygon","PolylineGMaps","Polyline","GrouperLayerMapView","mapViewClass","initialize","groupLayer","activeLayerModel","prototype","call","_removeLayers","self","_","each","map","layers","getLayersByType","layer","unbind","geo","MapView","model","_removeLayer","cid","_updateLayerDefinition","log","info","setActiveLayer","_setInteraction","disableInteraction","_clearInteraction","enableInteraction","idx","getLayerDefIndex","getLayerCount","setInteraction","remove","def","getLayerDef","setLayerDefinition","_routeErrors","errors","styleRegExp","postgresExp","generalPostgresExp","syntaxErrorExp","webMercatorErrorExp","tilerError","where","visible","type","err","match","layerIndex","_t","error","lyr","_routeSignal","signal","args","concat","_addLayer","get","m","CartoDBGroupLayer","extend","toLayerGroup","user_name","options","user","maps_api_template","config","no_cdn","force_cors","layer_view","silent","bind","_addLayerToMap","proxyModel","fn","Backbone","Model","set","attributes","signalDisabled","unlink","window","CodeMirror","place","opt","defaults","hasOwnProperty","setGuttersForLineNumbers","docStart","value","first","display","makeDisplay","wrapper","updateGutters","autofocus","mobile","focusInput","state","keyMaps","overlays","modeGen","overwrite","focused","suppressEdits","pasteIncoming","cutIncoming","draggingText","highlight","Delayed","themeChanged","lineWrapping","className","doc","Doc","mode","operation","attachDoc","old_ie","setTimeout","resetInput","registerEventHandlers","hasFocus","activeElement","input","onFocus","onBlur","optionHandlers","propertyIsEnumerable","Init","initHooks","d","elt","webkit","width","ios","border","inputDiv","scrollbarH","scrollbarV","scrollbarFiller","gutterFiller","lineDiv","selectionDiv","cursor","otherCursor","measure","lineSpace","mover","sizer","heightForcer","scrollerCutOff","gutters","lineGutter","scroller","ie_lt8","zIndex","paddingRight","draggable","khtml","height","minWidth","viewOffset","lastSizeC","showingFrom","showingTo","lineNumWidth","lineNumInnerWidth","lineNumChars","prevInput","alignWidgets","pollingFast","poll","cachedCharWidth","cachedTextHeight","cachedPaddingH","measureLineCache","measureLineCachePos","inaccurateSelection","maxLine","maxLineLength","maxLineChanged","wheelDX","wheelDY","wheelStartX","wheelStartY","loadMode","cm","getMode","modeOption","resetModeState","iter","line","stateAfter","styles","frontier","startWorker","curOp","regChange","wrappingChanged","computeMaxLength","estimateLineHeights","clearCaches","updateScrollbars","estimateHeight","th","textHeight","wrapping","perLine","Math","max","clientWidth","charWidth","lineIsHidden","ceil","text","est","estHeight","updateLineHeight","keyMapChanged","keyMap","theme","guttersChanged","alignHorizontally","specs","removeChildren","gutterClass","gElt","lineLength","merged","len","cur","collapsedSpanAtStart","found","find","getLine","from","ch","to","collapsedSpanAtEnd","indexOf","lineNumbers","slice","splice","docHeight","totalHeight","paddingVert","minHeight","top","clientHeight","scrollHeight","needsH","scrollWidth","needsV","bottom","scrollbarWidth","firstChild","right","coverGutterNextToScrollbar","fixedGutter","offsetWidth","mac_geLion","mac_geMountainLion","pointerEvents","visibleLines","viewPort","scrollTop","floor","paddingTop","lineAtHeight","comp","compensateForHScroll","scrollLeft","gutterW","l","n","nextSibling","alignable","a","left","maybeUpdateLineNumberWidth","last","lineNumberFor","size","test","innerW","padding","String","lineNumberFormatter","firstLineNumber","getRect","updateDisplay","changes","forced","updated","oldFrom","oldTo","oldWidth","updateDisplayInner","updateSelection","min","signalLater","marginLeft","positionsChangedFrom","Infinity","diff","end","viewportMargin","sawCollapsedSpans","lineNo","visualLine","intact","computeIntact","range","newTo","intactLines","updateViewOffset","sort","patchDisplay","offsetHeight","focus","different","updateHeightsInViewport","prevBottom","offsetTop","node","lineObj","bot","box","widgets","off","heightAtLine","change","intact2","l2","push","getDimensions","offsetLeft","fixedPos","gutterTotalWidth","gutterLeft","gutterWidth","wrapperWidth","updateNumbersFrom","rm","next","mac","currentWheelTarget","parentNode","removeChild","dims","container","nextIntact","shift","lineN","previousSibling","w","showIfHidden","prev","nodeName","wrap","replaceChild","wnode","handleMouseEvents","ignoreEvents","positionLineWidget","lineNumber","setTextContent","reuse","search","lineNode","buildLineElement","insertBefore","built","buildLineContent","lineElement","pre","markers","gutterMarkers","bgClass","wrapClass","isOk","widgetsSeen","widget","above","gutterWrap","k","id","ws","noHScroll","coverGutter","paddingLeft","collapsed","posEq","sel","showCursorWhenSelecting","updateSelectionCursor","updateSelectionRange","moveInputWithCursor","headPos","cursorCoords","head","wrapOff","lineOff","pos","cursorHeight","other","add","fragment","rightSide","drawForLine","fromArg","toArg","coords","bias","charCoords","Pos","start","lineLen","iterateBidiSections","getOrder","dir","rightPos","leftPos","tmp","leftSide","createDocumentFragment","paddingH","fromLine","toLine","singleVLine","leftEnd","rightStart","removeChildrenAndAdd","restartBlink","clearInterval","blinker","on","visibility","cursorBlinkRate","setInterval","time","startState","highlightWorker","prevChange","Date","workTime","copyState","getStateBefore","changed","oldStyles","highlightLine","ischange","processLine","workDelay","findStartLine","precise","minindent","minline","lim","innerMode","indented","countColumn","tabSize","save","getComputedStyle","currentStyle","measureChar","data","measureLine","crude","findCachedMeasurement","cache","memo","markedSpans","classes","textClass","clearCachedMeasurement","exists","cached","measureLineInner","measureRect","rect","outer","maxBot","vranges","rtop","rbot","finishRect","crudeMeasuringFrom","crudelyMeasureLine","emptyArray","childNodes","chunk","chunks","ie_lt9","getClientRects","nodeType","rects","measureRight","copy","Line","measureLineWidth","hasBadSpan","sp","zeroWidthElement","pageScrollX","pageXOffset","documentElement","body","pageScrollY","pageYOffset","intoCoordSystem","context","widgetHeight","yOff","lOff","xOff","fromCoordSystem","localBox","lineSpaceBox","measurement","getBidi","partPos","part","order","level","bidiLeft","bidiRight","getBidiPartAt","val","bidiOther","PosWithInfo","outside","xRel","coordsChar","x","y","coordsCharInner","mergedPos","getX","wrongLine","innerOff","adjust","bidi","dist","lineLeft","lineRight","fromX","fromOutside","toX","toOutside","moveVisually","xDiff","isExtendingChar","step","middle","middleX","measureText","anchor","startOperation","forceUpdate","updateInput","userSelChange","textChanged","selectionChanged","cursorActivity","updateMaxLine","updateScrollPos","nextOpId","delayedCallbackDepth","delayedCallbacks","endOperation","op","maxScrollLeft","setScrollLeft","newScrollPos","calculateScrollPos","scrollToPos","scrollPosIntoView","clipPos","margin","scrollCursorIntoView","hidden","maybeHiddenMarkers","unhidden","maybeUnhiddenMarkers","lines","delayed","cm1","f","withOp","result","docOperation","runInOp","lendiff","slowPoll","pollInterval","readInput","fastPoll","p","missed","hasSelection","isReadOnly","disableInput","fakedLastChar","substring","ie","inputHasSelection","same","charCodeAt","inserted","changeEvent","splitLines","origin","makeChange","electricChars","smartIndent","electric","getModeAt","indentLine","minimal","selected","hasCopyEvent","getSelection","content","selectInput","readOnly","ensureFocus","cantEdit","reFocus","onResize","resizeTimer","knownScrollbarWidth","unregister","drag_","signalDOMEvent","onDragEvent","addStop","e_stop","prepareCopy","onMouseDown","posFromMouse","clickInGutter","eventInWidget","e_preventDefault","word","findWordAt","extendSelection","captureMiddleClick","onContextMenu","setScrollTop","onScrollWheel","onKeyUp","onKeyDown","onKeyPress","dragDrop","onDragStart","onDrop","lastMiddleDown","selectionStart","selectionEnd","blur","e_target","liberal","target","space","clientX","clientY","doSelect","lastPos","startstart","startend","posLess","curCount","counter","editorSize","done","move","up","shiftKey","e_button","now","lastDoubleClick","selectLine","lastClick","dragAndDrop","dragEnd","e2","abs","ie_lt10","buttons","gutterEvent","prevent","signalfn","mX","mY","lineBox","hasHandler","e_defaultPrevented","gutter","contextMenuInGutter","lastDrop","files","dataTransfer","FileReader","File","read","loadFile","file","reader","onload","join","readAsText","getData","curFrom","curTo","setSelection","replaceRange","replaceSelection","txt","setData","setDragImage","safari","img","src","opera","_top","gecko","isScroller","dx","wheelDeltaX","dy","wheelDeltaY","detail","axis","HORIZONTAL_AXIS","VERTICAL_AXIS","wheelDelta","scroll","wheelPixelsPerUnit","pixels","wheelSamples","movedX","movedY","sample","doHandleBinding","bound","dropShift","commands","prevShift","Pass","allKeyMaps","extraKeys","handleKeyBinding","startMap","getKeyMap","auto","clearTimeout","maybeTransition","isModifierKey","name","keyName","handled","keymaps","lookupKey","motion","oldKeyCode","keyCode","handleCharBinding","onKeyEvent","returnValue","code","lastStoppedKey","metaKey","ctrlKey","charCode","which","fromCharCode","prepareSelectAllHack","extval","rehide","oldCSS","scrollPos","detectingSelectAll","selectAll","reset","resetSelectionOnContextMenu","mouseup","clipPostChange","preLine","lastLine","clipToLen","lst","inside","computeSelAfterChange","hint","changeEnd","adjustPos","filterChange","update","obj","canceled","cancel","undefined","selUpdate","ignoreReadOnly","split","sawReadOnlySpans","removeReadOnlyRanges","makeChangeNoReadonly","selAfter","addToHistory","NaN","makeChangeSingleDoc","stretchSpansOverChange","rebased","linkedDocs","sharedHist","history","rebaseHist","makeChangeFromHistory","hist","event","undone","pop","anti","anchorBefore","anchorAfter","headBefore","headAfter","generation","maxGeneration","filter","historyChangeFromChange","after","mergeOldSpans","shiftDoc","distance","shiftPos","spans","removed","getBetween","makeChangeSingleDocInEditor","updateDoc","recomputeMaxLength","checkWidthStart","changeObj","cmp","copyPos","clipLine","linelen","isLine","posBefore","filterSelectionChange","checkAtomic","filtered","goalColumn","skipAtomic","inv","reCheckSelection","mayClear","flipped","curPos","marker","inclusiveLeft","inclusiveRight","explicitlyCleared","atomic","newPos","cursorScrollMargin","doScroll","innerHeight","phantom","scrollNode","scrollIntoView","endCoords","startTop","startLeft","x1","y1","x2","y2","snapMargin","screen","screentop","docBottom","atTop","atBottom","newTop","screenw","screenleft","gutterw","atLeft","addToScrollPos","how","aggressive","indent","curSpace","indentation","curSpaceString","indentUnit","indentString","indentWithTabs","spaceStr","changeLine","handle","no","findPosH","unit","visually","findNextLine","possible","moveOnce","boundToLine","moveLogically","origDir","sawType","group","isWordChar","hitSide","findPosV","pageSize","startChar","check","option","deflt","notOnInit","old","nstate","a1","a2","lookup","nofallthrough","fallthrough","Object","keyNames","noShift","altGraphKey","altKey","flipCtrlCmd","StringStream","string","lastColumnPos","lastColumnValue","lineStart","TextMarker","markText","shared","markTextShared","copyObj","clearWhenEmpty","replacedWith","conflictingCollapsedRange","Error","curLine","span","addMarkedSpan","clearOnEnter","clear","clearHistory","nextMarkerId","title","startStyle","endStyle","SharedTextMarker","primary","me","parent","cloneNode","linked","isParent","getMarkedSpanFor","removeMarkedSpan","attachLine","markedSpansBefore","startCh","isInsert","nw","startsBefore","insertLeft","endsAfter","markedSpansAfter","endCh","oldFirst","oldLast","sameLine","offset","clearEmptySpans","newMarkers","gapMarkers","gap","getOldSpans","stretched","oldCur","stretchCur","mark","parts","mk","newParts","extraLeft","extraRight","compareCollapsedMarkers","lenDiff","aPos","bPos","fromCmp","toCmp","collapsedSpanAtSide","sps","lineIsHiddenInner","endLine","detachMarkedSpans","detachLine","attachMarkedSpans","widgetOperation","addLineWidget","LineWidget","insertAt","aboveVisible","updateLine","cleanUpLine","runMode","forceToEnd","flattenSpans","curStart","curStyle","stream","blankLine","eol","maxHighlightLength","token","addModeClass","mName","st","o","overlay","at","i_end","opaque","getLineStyles","startAt","interpretTokenStyle","builder","lineClass","index","prop","RegExp","styleToClassCacheWithMode","styleToClassCache","realLine","copyWidgets","empty","col","measuredSomething","addToken","buildTokenMeasure","buildToken","getOption","buildTokenSplitSpaces","insertLineContent","defaultSpecialCharPlaceholder","special","specialChars","lastIndex","skipped","tabWidth","specialCharPlaceholder","fullStyle","spanAffectsWrapping","whiteSpace","inner","out","buildCollapsedSpan","ignoreWidget","allText","spanStyle","spanEndStyle","spanStartStyle","nextChange","foundBookmarks","upto","tokenText","spansFor","firstLine","lastText","lastSpans","nlines","wholeLineUpdateBefore","added","insert","LeafChunk","BranchChunk","children","chunkSize","sharedHistOnly","propagate","skip","rel","child","sz","getLines","h","lh","bidiOrdering","makeHistory","startGen","undoDepth","lastTime","lastOp","lastOrigin","attachLocalSpans","existing","histChange","opId","historyEventDelay","removeClearedSpans","copyHistoryArray","events","newGroup","newChanges","Number","rebaseHistSel","rebaseHistArray","array","sub","copied","readAfter","stopMethod","stop","preventDefault","e_stopPropagation","stopPropagation","cancelBubble","defaultPrevented","srcElement","button","emitter","addEventListener","attachEvent","_handlers","arr","removeEventListener","detachEvent","bnd","fireDelayed","override","codemirrorIgnore","eventMixin","ctor","startIndex","startValue","spaceStrs","select","_e","collection","createObj","base","props","Obj","inst","toUpperCase","nonASCIISingleCaseWordChar","isEmpty","extendingChars","relativeLuminanceW3C","R8bit","G8bit","B8bit","RsRGB","GsRGB","BsRGB","R","pow","G","B","L","tag","color","innerHTML","luminance","background","count","str","textContent","getBoundingClientRect","zwspSupported","visual","lineEnd","compareBidiLevel","linedir","moveInLine","byUnit","navigator","userAgent","documentMode","ie_gt10","qtwebkit","chrome","vendor","platform","windows","opera_version","constructor","setOption","getDoc","addKeyMap","removeKeyMap","addOverlay","spec","modeSpec","removeOverlay","indentSelection","getTokenAt","current","getTokenTypeAt","before","mid","getHelper","getHelpers","helpers","help","helperType","_global","pred","getStateAfter","defaultTextHeight","defaultCharWidth","setGutterMarker","gutterID","clearGutter","addLineClass","cls","removeLineClass","removeLineWidget","lineInfo","getViewport","addWidget","vert","horiz","vspace","hspace","triggerOnKeyDown","triggerOnKeyPress","triggerOnKeyUp","execCommand","cmd","amount","moveH","rtlMoveVisually","deleteH","moveV","goal","toggleOverwrite","scrollTo","getScrollInfo","co","sPos","setSize","interpret","refresh","oldHeight","swapDoc","getInputField","getWrapperElement","getScrollerElement","getGutterElement","setValue","source","integer","disabled","tabIndex","modes","mimeModes","defineMode","dependencies","defineMIME","mime","resolveMode","mfactory","modeObj","modeExtensions","exts","modeProps","skipToEnd","extendMode","properties","defineExtension","func","defineDocExtension","defineOption","defineInitHook","registerHelper","registerGlobalHelper","predicate","killLine","getCursor","deleteLine","delLineLeft","undo","redo","goDocStart","goDocEnd","goLineStart","goLineStartSmart","getLineHandle","firstNonWS","inWS","goLineEnd","goLineRight","goLineLeft","goLineUp","goLineDown","goPageUp","goPageDown","goCharLeft","goCharRight","goColumnLeft","goColumnRight","goWordLeft","goGroupRight","goGroupLeft","goWordRight","delCharBefore","delCharAfter","delWordBefore","delWordAfter","delGroupBefore","delGroupAfter","indentAuto","indentMore","indentLess","insertTab","defaultTab","somethingSelected","transposeChars","newlineAndIndent","basic","Left","Right","Up","Down","End","Home","PageUp","PageDown","Delete","Backspace","Shift-Backspace","Tab","Shift-Tab","Enter","Insert","pcDefault","Ctrl-A","Ctrl-D","Ctrl-Z","Shift-Ctrl-Z","Ctrl-Y","Ctrl-Home","Ctrl-Up","Ctrl-End","Ctrl-Down","Ctrl-Left","Ctrl-Right","Alt-Left","Alt-Right","Ctrl-Backspace","Ctrl-Delete","Ctrl-S","Ctrl-F","Ctrl-G","Shift-Ctrl-G","Shift-Ctrl-F","Shift-Ctrl-R","Ctrl-[","Ctrl-]","macDefault","Cmd-A","Cmd-D","Cmd-Z","Shift-Cmd-Z","Cmd-Y","Cmd-Up","Cmd-End","Cmd-Down","Cmd-Left","Cmd-Right","Alt-Backspace","Ctrl-Alt-Backspace","Alt-Delete","Cmd-S","Cmd-F","Cmd-G","Shift-Cmd-G","Cmd-Alt-F","Shift-Cmd-Alt-F","Cmd-[","Cmd-]","Cmd-Backspace","emacsy","Ctrl-B","Ctrl-P","Ctrl-N","Alt-F","Alt-B","Ctrl-E","Ctrl-V","Shift-Ctrl-V","Ctrl-H","Alt-D","Ctrl-K","Ctrl-T","fromTextArea","textarea","getValue","tabindex","placeholder","getAttribute","form","leaveSubmitMethodAlone","realSubmit","submit","wrappedSubmit","getTextArea","toTextArea","sol","peek","eat","eatWhile","eatSpace","skipTo","backUp","column","pattern","consume","caseInsensitive","cased","hideFirstChars","bothSides","oldH","removeInner","collapse","insertInner","iterN","spilled","newleaf","maybeSpill","sibling","myIndex","used","nextDocId","cleanGeneration","lineSep","getRange","setLine","removeLine","getLineNumber","getLineHandleVisualStart","lineCount","setCursor","setExtending","historySize","markClean","changeGeneration","forceSplit","isClean","gen","getHistory","setHistory","histData","setBookmark","realOpts","findMarksAt","findMarks","getAllMarks","posFromIndex","indexFromPos","copyHistory","linkedDoc","unlinkDoc","link","splitIds","iterLinkedDocs","getEditor","eachLine","dontDelegate","method","ms","replaceGetRect","div","nl","rt","te","ownerDocument","selection","createRange","parentElement","compareEndPoints","oncopy","3","8","9","13","16","17","18","19","20","27","32","33","34","35","36","37","38","39","40","44","45","46","59","61","91","92","93","107","109","127","173","186","187","188","189","190","191","192","219","220","221","222","63232","63233","63234","63235","63272","63273","63275","63276","63277","63302","charType","lowTypes","arabicTypes","bidiRE","isNeutral","isStrong","countsAsLeft","countsAsNum","outerType","types","nstart","unshift","version","Completion","getHints","onClose","getText","completion","getType","buildKeyMap","addBinding","baseMap","ourMap","moveFocus","menuSize","setFocus","pick","Esc","close","customKeys","Widget","hints","selectedHint","completions","list","render","displayText","hintId","alignWithWord","below","winW","innerWidth","winH","overlapX","overlapY","changeActive","screenAmount","closeOnUnfocus","closingOnBlur","startScroll","onScroll","curScroll","editor","point","t","showHint","completionActive","async","showHints","active","completeSingle","showWidget","finished","activity","finishUpdate","data_","debounce","startPos","startLen","closeOn","closeCharacters","WORD","RANGE","scan","curWord","seen","forEach","arrayContains","item","scriptHint","keywords","getToken","tprop","getCompletions","columnsHint","maybeAdd","gatherCompletions","$","each2","c","jQuery","v","localeCompare","equal","splitVal","separator","trim","getSideBorderPadding","element","outerWidth","installKeyUpChangeEvent","removeData","installFilteredMouseMove","lastpos","lastMousePosition","pageX","pageY","quietMillis","ctx","timeout","thunk","formula","evaluated","installDebouncedScroll","threshold","notify","killEvent","killEventImmediately","stopImmediatePropagation","measureTextWidth","css","fontSize","fontFamily","fontStyle","fontWeight","letterSpacing","textTransform","append","markMatch","term","markup","tl","ajax","requestSequence","handler","query","requestNumber","transport","traditional","page","abort","url","dataType","success","results","callback","local","dataText","isArray","isFunction","datum","attr","childDatum","matcher","tags","isObject","checkFormatter","formatter","formatterName","evaluate","countResults","defaultTokenizer","selectCallback","original","dupe","createSearchChoice","tokenSeparators","clazz","SuperClass","methods","Select2","KEY","AbstractSelect2","SingleSelect2","MultiSelect2","nextUid","$document","TAB","ENTER","ESC","SPACE","LEFT","UP","RIGHT","DOWN","SHIFT","CTRL","ALT","PAGE_UP","PAGE_DOWN","HOME","END","BACKSPACE","DELETE","isArrow","isControl","isFunctionKey","ready","closest","tagName","init","free_text","resultsSelector","prepareOpts","destroy","enabled","createContainer","containerId","containerSelector","addClass","containerCss","containerCssClass","hide","dropdown","dropdownCssClass","resultsPage","initContainer","initContainerWidth","delegate","highlightUnderEvent","loadMoreIfNeeded","mousewheel","delta","deltaX","deltaY","updateResults","removeClass","selectHighlighted","focusSearch","initSelection","monitorSource","is","disable","hasClass","bucket","html","colors","admin","color_ramps","c_l","select2","show","idKey","ajaxUrl","populateResults","populate","depth","selectable","compound","label","innerContainer","formatted","formatResultCssClass","msg","tipsy","fade","gravity","color_ramp","formatResult","escapeMarkup","prevObject","more","elm","getPlaceholder","not","triggerChange","details","blurOnChange","enable","removeAttr","opened","positionDropdown","bodyOffset","outerHeight","dropHeight","viewPortRight","viewportBottom","dropTop","dropLeft","enoughRoomBelow","enoughRoomAbove","dropWidth","enoughRoomOnRight","aboveNow","dropdownCss","shouldOpen","Event","isDefaultPrevented","clearDropdownAlignmentPreference","open","opening","selector","resize","parents","s2","detach","appendTo","ensureHighlightVisible","clearSearch","hb","rb","moveHighlight","choices","choice","countSelectableResults","formatLoadMore","tokenize","initial","removeTipsys","$el","postRender","showSearchInput","maximumSelectionSize","formatSelectionTooBig","minimumInputLength","formatInputTooShort","formatSearching","formatNoMatches","postprocessResults","triggerHandler","highlighted","onSelect","resolveContainerWidth","attrs","matches","class","insertAfter","isFocused","clickingInside","openOnEnter","ti","allowClear","setPlaceholder","showFreeTextInput","minimumResultsForSearch","freeText","formatSelection","searchContainer","unselect","resizeSearch","clearPlaceholder","getVal","ids","addSelectedChoice","tokenizer","closeOnSelect","enableChoice","locked","enabledItem","disabledItem","replaceWith","fadeOut","dequeue","setVal","minimumWidth","maxWidth","containerLeft","searchWidth","sideBorderPadding","unique","onSortStart","onSortEnd","values","multiple","allowedMethods","limit","pageNumber","util","abstract","single","multi","canvas","bg","fg","glyphs","faviconNotify","icon","num","myPos","myBg","myFg","getContext","drawImage","myGlyphs","combined","glyphHeight","glyphWidth","dX","dY","pixel","fillStyle","fillRect","toDataURL","exports","crossfilter_identity","permute","bisect_by","bisectLeft","lo","hi","bisectRight","heap_by","heap","sift","heapselect_by","heapselect","queue","insertionsort_by","insertionsort","quicksort_by","quicksort_sizeThreshold","quicksort","sixth","i1","i5","i3","i2","i4","e1","e3","x3","e4","x4","e5","x5","pivot1","pivotValue1","pivot2","pivotValue2","less","great","pivotsEqual","ek","xk","greatValue","lessValue","crossfilter_arrayUntyped","crossfilter_arrayLengthenUntyped","crossfilter_arrayWidenUntyped","crossfilter_filterExact","bisect","crossfilter_filterRange","crossfilter_filterAll","crossfilter_null","crossfilter_zero","crossfilter_reduceIncrement","crossfilter_reduceDecrement","crossfilter_reduceAdd","crossfilter_reduceSubtract","crossfilter","newData","n0","n1","filters","crossfilter_arrayLengthen","dataListeners","newIndex","crossfilter_index","filterListeners","removeDataListeners","dimension","preAdd","newValues","crossfilter_range","bounds","refilter","lo1","hi1","refilterFunction","one","lo0","hi0","oldValues","oldIndex","i0","postAdd","indexListeners","reIndex","filterIndexBounds","filterIndexFunction","filterAll","filterRange","filterFunction","filterExact","zero","groupIncrement","groupCapacity","crossfilter_arrayWiden","groupWidth","groupIndex","crossfilter_capacity","g0","x0","oldGroups","groups","reduceAdd","reduceInitial","k0","resetNeeded","updateMany","resetMany","groupAll","updateOne","resetOne","oldK","seenGroups","filterOne","reduceRemove","all","reduce","reduceCount","reduceSum","valueOf","orderNatural","dispose","dimensionGroups","M","reduceValue","crossfilter_array8","crossfilter_array16","crossfilter_array32","by","Uint8Array","Uint16Array","Uint32Array","effects","getRGB","parseFloat","getColor","elem","curCSS","getElementStyles","camelCase","defaultView","newStyle","letter","filterStyles","shorthandStyles","styleDifference","oldStyle","_normalizeArguments","effect","speed","fx","speeds","duration","_default","complete","colorInit","darkgrey","transparent","classAnimationActions","borderBottom","borderColor","borderLeft","borderRight","borderTop","borderWidth","animateClass","easing","that","originalStyleAttr","originalStyle","action","animate","_addClass","classNames","_removeClass","_toggleClass","toggleClass","force","toggle","switchClass","restore","setMode","getBaseline","createWrapper","float","removeWrapper","setTransition","factor","cssUnit","args2","effectMethod","_show","_hide","__toggle","jswing","swing","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","easeInSine","cos","PI","easeOutSine","sin","easeInOutSine","easeInExpo","easeOutExpo","easeInOutExpo","easeInCirc","sqrt","easeOutCirc","easeInOutCirc","easeInElastic","s","asin","easeOutElastic","easeInOutElastic","easeInBack","easeOutBack","easeInOutBack","easeInBounce","easeOutBounce","easeInOutBounce","blind","direction","overflow","ref","animation","backgroundColor","opacity","backgroundImage","support","removeAttribute","requestIndex","autoFocus","delay","minLength","my","collision","pending","_create","suppressKeyPress","isMultiLine","role","aria-autocomplete","aria-haspopup","propAttr","ui","_move","_keyEvent","NUMPAD_ENTER","menu","ESCAPE","searching","selectedItem","previous","closing","_change","_initSource","mousedown","menuElement","contains","_trigger","originalEvent","bgiframe","beforeunloadHandler","_setOption","xhr","request","response","autocomplete","status","_search","_response","__response","_normalize","_suggest","deactivate","items","ul","_renderMenu","_resizeMenu","of","_renderItem","keyEvent","escapeRegex","grep","aria-activedescendant","mouseenter","activate","mouseleave","hasScroll","elementHeight","eq","prevAll","nextAll","edge","nextPage","previousPage","focusable","isTabIndexNotNaN","mapName","href","andSelf","expr","CAPS_LOCK","COMMA","COMMAND","COMMAND_LEFT","COMMAND_RIGHT","CONTROL","INSERT","MENU","NUMPAD_ADD","NUMPAD_DECIMAL","NUMPAD_DIVIDE","NUMPAD_MULTIPLY","NUMPAD_SUBTRACT","PERIOD","WINDOWS","_focus","scrollParent","browser","msie","disableSelection","selectstart","enableSelection","jquery","side","orig","createPseudo","dataName","tabbable","isTabIndexNaN","plugin","module","proto","plugins","instance","compareDocumentPosition","has","isOverAxis","reference","isOver","mouse","widgetEventPrefix","addClasses","connectToSortable","containment","cursorAt","grid","helper","iframeFix","refreshPositions","revert","revertDuration","scope","scrollSensitivity","scrollSpeed","snap","snapMode","snapTolerance","stack","_mouseInit","_mouseDestroy","_mouseCapture","_getHandle","_mouseStart","_createHelper","_cacheHelperProportions","ddmanager","_cacheMargins","cssPosition","positionAbs","margins","_getParentOffset","relative","_getRelativeOffset","originalPosition","_generatePosition","originalPageX","originalPageY","_adjustOffsetFromHelper","_setContainment","_clear","dropBehaviour","prepareOffsets","_mouseDrag","dragStart","noPropagation","_convertPositionTo","_uiHash","_mouseUp","drag","_mouseStop","dropped","drop","elementInDom","dragStop","clone","helperProportions","offsetParent","po","ce","over","relative_container","mod","scrollIsRootNode","round","cancelHelperRemoval","uiSortable","sortables","sortable","shouldRevert","_helper","currentItem","_intersectsWith","containerCache","_cursor","_opacity","overflowOffset","scrolled","snapElements","$t","$o","ts","bs","ls","rs","snapping","snapItem","release","makeArray","_zIndex","accept","activeClass","greedy","hoverClass","tolerance","isover","isout","proportions","droppables","_activate","_deactivate","_over","_out","_drop","custom","childrenIntersection","intersect","droppable","toleranceMode","absolute","draggableLeft","clickOffset","draggableTop","default","droppablesLoop","greedyChild","intersects","parentInstance","mouseHandled","widgetName","_mouseDown","started","_mouseMoveDelegate","_mouseUpDelegate","_mouseStarted","_mouseDownEvent","btnIsLeft","elIsCancel","mouseDelayMet","_mouseDelayTimer","_mouseDistanceMet","_mouseDelayMet","_mouseMove","horizontalPositions","verticalPositions","center","_position","_offset","targetWidth","targetHeight","basePosition","targetElem","collisionPosition","elemWidth","elemHeight","marginTop","collisionWidth","collisionHeight","fractions","using","fit","win","flip","myOffset","atOffset","setOffset","curElem","curOffset","curTop","curLeft","testElement","testElementParent","testElementStyle","offsetTotal","getElementsByTagName","alsoResize","animateDuration","animateEasing","aspectRatio","autoHide","ghost","handles","maxHeight","_aspectRatio","originalElement","_proportionallyResizeElements","elementIsWrapper","marginRight","marginBottom","originalResizeStyle","zoom","_proportionallyResize","se","sw","ne","u","_renderAxis","_handles","mouseover","resizing","_destroy","documentScroll","_renderProxy","originalSize","sizeDiff","originalMousePosition","_propagate","_updateVirtualBoundaries","_updateRatio","_respectSize","_updateCache","_vBoundaries","borderDif","elementOffset","ie6","containerElement","containerOffset","containerPosition","parentData","containerSize","numPages","orientation","existingHandles","handleCount","_keySliding","_mouseSliding","_animateOff","_handleIndex","_detectOrientation","_valueMin","hover","keydown","allowed","curVal","newVal","_start","_valueMax","_trimAlignValue","_slide","keyup","_stop","_refreshValue","normValue","closestHandle","mouseOverHandle","elementSize","_normValueFromMouse","thisDistance","_clickOffset","pixelTotal","pixelMouse","percentMouse","valueTotal","valueMouse","uiHash","otherVal","newValue","_value","vals","_values","valsLength","valModStep","alignValue","toFixed","valPercent","lastValPercent","valueMin","valueMax","oRange","_set","slider","connectWith","dropOnEmpty","forcePlaceholderSize","forceHelperSize","floating","overrideHandle","reverting","_refreshItems","validHandle","_removeCurrentsFromItems","noActivation","currentContainer","domPosition","_createPlaceholder","_storedCursor","_storedOpacity","_storedZIndex","_preserveHelperProportions","containers","dragging","lastPositionAbs","itemElement","intersection","_intersectsWithPointer","_intersectsWithSides","_rearrange","_contactContainers","_storedCSS","_noFinalSort","prepend","serialize","_getItemsAsjQuery","connected","res","attribute","expression","toArray","ret","dyClick","dxClick","isOverElement","forcePointerForContainers","isOverElementHeight","isOverElementWidth","verticalDirection","_getDragVerticalDirection","horizontalDirection","_getDragHorizontalDirection","isOverBottomHalf","isOverRightHalf","_connectWith","queries","targetData","_queries","queriesLength","fast","toleranceElement","refreshContainers","innermostContainer","innermostIndex","itemWithLeastDistance","hardRefresh","delayedTriggers","sender","cleanData","_cleanData","elems","_remove","keepData","fullName","namespace","_createWidget","basePrototype","widgetBaseClass","bridge","object","isMethodCall","methodValue","_init","_getCreateOptions","metadata","_setOptions","duplicate","caret","opt2","selRange","createTextRange","moveStart","moveEnd","lastIndexOf","stored_range","moveToElementText","setEndPoint","global","factory","define","amd","moment","utils_hooks__hooks","hookCallback","setHookCallback","defaultParsingFlags","unusedTokens","unusedInput","charsLeftOver","nullInput","invalidMonth","invalidFormat","userInvalidated","iso","isDate","hasOwnProp","create_utc__createUTC","format","locale","strict","createLocalOrUTC","utc","valid__isValid","_isValid","_d","getTime","_pf","_strict","bigHour","valid__createInvalid","flags","copyConfig","_isAMomentObject","_i","_f","_l","_tzm","_isUTC","_locale","momentProperties","Moment","updateInProgress","updateOffset","isMoment","toInt","argumentForCoercion","coercedNumber","isFinite","compareArrays","array1","array2","dontConvert","lengthDiff","diffs","Locale","normalizeLocale","chooseLocale","names","loadLocale","oldLocale","locales","globalLocale","_abbr","require","locale_locales__getSetGlobalLocale","locale_locales__getLocale","defineLocale","abbr","addUnitAlias","shorthand","lowerCase","aliases","normalizeUnits","units","normalizeObjectUnits","inputObject","normalizedProp","normalizedInput","makeGetSet","keepTime","get_set__set","get_set__get","mom","getSet","zeroFill","number","targetLength","forceSign","output","sign","addFormatToken","padded","ordinal","formatTokenFunctions","localeData","removeFormattingTokens","makeFormatFunction","formattingTokens","Function","formatMoment","isValid","expandFormat","formatFunctions","invalidDate","replaceLongDateFormatTokens","longDateFormat","localFormattingTokens","addRegexToken","regex","strictRegex","regexes","isStrict","getParseRegexForToken","unescapeFormat","matched","p1","p2","p3","p4","addParseToken","tokens","addWeekParseToken","_w","addTimeToArrayFromToken","_a","daysInMonth","year","month","UTC","getUTCDate","localeMonths","_months","localeMonthsShort","_monthsShort","localeMonthsParse","monthName","_monthsParse","_longMonthsParse","_shortMonthsParse","months","monthsShort","setMonth","dayOfMonth","monthsParse","date","getSetMonth","getDaysInMonth","checkOverflow","MONTH","DATE","YEAR","HOUR","MINUTE","SECOND","MILLISECOND","_overflowDayOfYear","warn","suppressDeprecationWarnings","console","deprecate","firstTime","deprecateSimple","deprecations","configFromISO","from_string__isoRegex","isoDates","isoTimes","matchOffset","configFromStringAndFormat","configFromString","aspNetJsonRegex","createFromInputFallback","createDate","setFullYear","createUTCDate","setUTCFullYear","daysInYear","isLeapYear","getIsLeapYear","weekOfYear","firstDayOfWeek","firstDayOfWeekOfYear","adjustedMoment","daysToDayOfWeek","day","local__createLocal","week","dayOfYear","localeWeek","_week","dow","doy","localeFirstDayOfWeek","localeFirstDayOfYear","getSetWeek","getSetISOWeek","dayOfYearFromWeeks","weekday","daysToAdd","getUTCDay","getSetDayOfYear","startOf","currentDateArray","_useUTC","getUTCFullYear","getUTCMonth","getFullYear","getMonth","getDate","configFromArray","currentDate","yearToUse","dayOfYearFromWeekInfo","_dayOfYear","_nextDay","setUTCMinutes","getUTCMinutes","weekYear","temp","GG","W","E","gg","ISO_8601","parsedInput","stringLength","totalParsedInputLength","meridiemFixWrap","_meridiem","hour","meridiem","isPm","meridiemHour","isPM","configFromStringAndArray","tempConfig","bestMoment","scoreToBeat","currentScore","score","configFromObject","minute","second","millisecond","createFromConfig","preparse","configFromInput","isUTC","pickBy","moments","Duration","years","quarters","quarter","weeks","days","hours","minutes","seconds","milliseconds","_milliseconds","_days","_data","_bubble","isDuration","utcOffset","offsetFromString","chunkOffset","cloneWithOffset","setTime","getDateOffset","getTimezoneOffset","getSetOffset","keepLocalTime","localAdjust","_changeInProgress","add_subtract__addSubtract","create__createDuration","getSetZone","setOffsetToUTC","setOffsetToLocal","subtract","setOffsetToParsedOffset","hasAlignedHourOffset","isDaylightSavingTime","isDaylightSavingTimeShifted","isLocal","isUtcOffset","isUtc","diffRes","aspNetRegex","create__isoRegex","parseIso","momentsDifference","inp","positiveMomentsDifference","isAfter","isBefore","createAdder","period","dur","isAdding","moment_calendar__calendar","sod","calendar","inputMs","endOf","isBetween","isSame","absFloor","asFloat","zoneDelta","monthDiff","anchor2","wholeMonthDiff","moment_format__toISOString","toISOString","toDate","inputString","defaultFormat","postformat","withoutSuffix","humanize","fromNow","newLocaleData","isoWeekday","to_type__valueOf","unix","moment_valid__isValid","parsingFlags","invalidAt","addWeekYearFormatToken","getter","weeksInYear","getSetWeekYear","getSetISOWeekYear","getISOWeeksInYear","getWeeksInYear","weekInfo","getSetQuarter","parseWeekday","weekdaysParse","localeWeekdays","_weekdays","localeWeekdaysShort","_weekdaysShort","localeWeekdaysMin","_weekdaysMin","localeWeekdaysParse","weekdayName","_weekdaysParse","weekdays","weekdaysShort","weekdaysMin","getSetDayOfWeek","getDay","getSetLocaleDayOfWeek","getSetISODayOfWeek","lowercase","matchMeridiem","_meridiemParse","localeIsPM","localeMeridiem","isLower","millisecond__milliseconds","getZoneAbbr","getZoneName","moment__createUnix","moment__createInZone","parseZone","locale_calendar__calendar","_calendar","_longDateFormat","_invalidDate","_ordinal","preParsePostFormat","relative__relativeTime","isFuture","_relativeTime","pastFuture","locale_set__set","_ordinalParseLenient","_ordinalParse","lists__get","field","setter","lists__listMonths","lists__listMonthsShort","lists__listWeekdays","lists__listWeekdaysShort","lists__listWeekdaysMin","duration_abs__abs","mathAbs","duration_add_subtract__addSubtract","duration_add_subtract__add","duration_add_subtract__subtract","bubble","daysToYears","yearsToDays","as","duration_as__valueOf","makeAs","alias","duration_get__get","makeGetter","substituteTimeAgo","relativeTime","duration_humanize__relativeTime","posNegDuration","thresholds","duration_humanize__getSetRelativeTimeThreshold","withSuffix","iso_string__toISOString","Y","iso_string__abs","D","total","asSeconds","match1","match2","match3","match4","match6","match1to2","match1to3","match1to4","match1to6","matchUnsigned","matchSigned","matchTimestamp","matchWord","defaultLocaleMonths","defaultLocaleMonthsShort","parseTwoDigitYear","getSetYear","defaultLocaleWeek","prototypeMin","prototypeMax","add_subtract__add","add_subtract__subtract","lang","isoWeekYear","getSetDayOfMonth","invalidWeekday","defaultLocaleWeekdays","defaultLocaleWeekdaysShort","defaultLocaleWeekdaysMin","_isPm","defaultLocaleMeridiemParse","getSetHour","getSetMinute","getSetSecond","getSetMillisecond","momentPrototype__proto","toJSON","isoWeek","isoWeeks","isoWeeksInYear","isDST","isDSTShifted","zoneAbbr","zoneName","dates","zone","momentPrototype","defaultCalendar","sameDay","nextDay","nextWeek","lastDay","lastWeek","sameElse","defaultLongDateFormat","LTS","LT","LL","LLL","LLLL","defaultInvalidDate","defaultOrdinal","defaultOrdinalParse","defaultRelativeTime","future","past","mm","hh","dd","MM","yy","prototype__proto","firstDayOfYear","ordinalParse","langData","asMilliseconds","asMinutes","asHours","asDays","asWeeks","asMonths","asYears","duration_get__milliseconds","duration_prototype__proto","toIsoString","invalid","relativeTimeThreshold","_moment","zclip","path","beforeCopy","afterCopy","clickAfter","setHandCursor","setCSSEffects","ZeroClipboard","setMoviePath","Client","setText","glue","reposition","clients","moviePath","nextId","getElementById","dispatch","receiveEvent","register","getDOMObjectPosition","handlers","movieId","movie","clipText","handCursorEnabled","cssEffects","domElement","addedStyle","getHTML","location","recoverActive","allowDuplicates","caseSensitive","fieldName","placeholderText","removeConfirmation","tagLimit","availableTags","showAutocompleteOnFocus","allowSpaces","singleField","singleFieldDelimiter","singleFieldNode","beforeTagAdded","afterTagAdded","beforeTagRemoved","afterTagRemoved","onTagClicked","onTagLimitExceeded","onTagAdded","onTagRemoved","tagSource","onSubmitTags","tagList","tagInput","showChoices","_subtractArray","assignedTags","_showAutocomplete","proxy","tagLabel","addedExistingFromSingleFieldNode","createTag","_lastTag","removeTag","_cleanedInput","autocompleteOptions","_tags","_updateSingleTagsField","inArray","_findTagByLabel","_formatStr","_isNew","_effectExists","Boolean","additionalClass","duringInitialization","preprocessTag","existingTag","removeTagIcon","escapedValue","removedTagLabel","hide_args","thisTag","removeTagByLabel","toRemove","removeAll","maybeCall","thing","isElementInDOM","ele","Tipsy","$element","fixTitle","MOVE_OFFSET","getTitle","$tip","tip","prependTo","tp","actualWidth","actualHeight","mo","$e","fallback","validate","toggleEnabled","elementOptions","enter","hoverState","delayIn","leave","delayOut","live","binder","eventIn","eventOut","revalidate","pointee","autoNS","autoWE","autoBounds","prefer","ns","ew","boundTop","boundLeft","$this","d3_class","defineProperty","enumerable","d3_arrayCopy","pseudoarray","d3_arraySlice","d3_Map","d3_identity","d3_this","d3_true","d3_functor","d3_rebind","d3_number","d3_zipLength","d3_splitter","d3_collapse","d3_range_integerScale","d3_dispatch","d3_dispatch_event","z","listeners","listenerByName","listener","d3_format_precision","LN10","d3_format_typeDefault","d3_format_group","reverse","d3_formatPrefix","scale","symbol","d3_ease_clamp","d3_ease_reverse","d3_ease_reflect","d3_ease_identity","d3_ease_poly","d3_ease_sin","d3_ease_exp","d3_ease_circle","d3_ease_elastic","d3_ease_back","d3_ease_bounce","d3_eventCancel","d3","d3_eventSource","sourceEvent","d3_eventDispatch","thiz","argumentz","e0","d3_interpolateByName","interpolateTransform","interpolate","d3_uninterpolateNumber","d3_uninterpolateClamp","d3_rgb","d3_Rgb","d3_rgb_hex","d3_rgb_parse","rgb","hsl","m1","m2","d3_rgb_parseNumber","d3_rgb_names","d3_rgb_hsl","d3_hsl","d3_Hsl","d3_hsl_rgb","vv","d3_selection","d3_arraySubclass","d3_selectionPrototype","d3_selection_selector","d3_select","d3_selection_selectorAll","d3_selectAll","d3_selection_classed","classedAdd","classList","cb","baseVal","cv","classedRemove","classedFunction","requote","d3_selection_dataNode","__data__","d3_selection_filter","d3_selectMatches","d3_selection_sortComparator","comparator","ascending","d3_selection_each","d3_selection_enter","d3_selection_enterPrototype","d3_transition","d3_transitionPrototype","tweens","ease","d3_transitionEase","tween","d3_transition_each","timer","elapsed","lock","tweened","tick","d3_transitionId","__transition__","d3_transitionNull","d3_transitionRemove","d3_transitionTween","transitionFunction","transitionString","d3_transitionDelay","d3_transitionDuration","d3_timer_step","t1","d3_timer_queue","then","flush","d3_timer_flush","d3_timer_timeout","d3_timer_interval","d3_timer_frame","t0","d3_transform","r0","r1","kx","d3_transformNormalize","kz","d3_transformDot","ky","d3_transformCombine","rotate","atan2","d3_transformDegrees","translate","skew","d3_mousePoint","svg","ownerSVGElement","createSVGPoint","d3_mouse_bug44083","scrollX","scrollY","ctm","getScreenCTM","matrixTransform","inverse","clientLeft","clientTop","d3_scaleExtent","domain","d3_scaleRange","rangeExtent","d3_scale_nice","nice","d3_scale_niceDefault","d3_scale_linear","clamp","rescale","linear","d3_scale_polylinear","d3_scale_bilinear","uninterpolate","invert","rangeRound","interpolateRound","ticks","d3_scale_linearTicks","tickFormat","d3_scale_linearTickFormat","d3_scale_linearNice","d3_scale_linearRebind","rebind","d3_scale_linearTickRange","extent","d3_scale_log","d3_scale_logn","d3_scale_logp","every","d3_scale_logFormat","d3_scale_pow","exponent","powp","d3_scale_powPow","powb","d3_scale_ordinal","ranger","steps","rangeBand","xi","rangePoints","rangeBands","rangeRoundBands","d3_scale_quantile","q","quantile","quantiles","d3_scale_quantize","d3_scale_identity","identity","d3_svg_arcInnerRadius","innerRadius","d3_svg_arcOuterRadius","outerRadius","d3_svg_arcStartAngle","startAngle","d3_svg_arcEndAngle","endAngle","d3_svg_line","projection","segment","segments","interpolator","points","tension","fy","defined","d3_svg_lineX","d3_svg_lineY","d3_svg_lineInterpolatorDefault","d3_svg_lineLinear","d3_svg_lineInterpolators","d3_svg_lineStepBefore","d3_svg_lineStepAfter","d3_svg_lineCardinalOpen","d3_svg_lineHermite","d3_svg_lineCardinalTangents","d3_svg_lineCardinalClosed","d3_svg_lineCardinal","closed","tangents","quad","p0","pi","lp","d3_svg_lineBasis","y0","px","py","d3_svg_lineBasisBezier","d3_svg_lineBasisOpen","d3_svg_lineDot4","d3_svg_lineBasisBezier3","d3_svg_lineBasisClosed","d3_svg_lineBundle","d3_svg_lineBasisBezier1","d3_svg_lineBasisBezier2","d3_svg_lineSlope","d3_svg_lineFiniteDifferences","d3_svg_lineMonotoneTangents","d3_svg_lineMonotone","d3_svg_lineRadial","d3_svg_arcOffset","d3_svg_area","area","points1","points0","fx0","fy0","fx1","fy1","d3_svg_chordSource","d3_svg_chordTarget","d3_svg_chordRadius","radius","d3_svg_diagonalProjection","d3_svg_diagonalRadialProjection","d3_svg_symbolSize","d3_svg_symbolType","d3_svg_symbolCircle","d3_svg_axisX","d3_svg_axisY","d3_svg_axisSubdivide","subticks","d3_behavior_zoomDelta","d3_behavior_zoomDiv","dispatchEvent","d3_layout_bundlePath","lca","d3_layout_bundleLeastCommonAncestor","d3_layout_bundleAncestors","ancestors","aNodes","bNodes","aNode","bNode","sharedNode","d3_layout_forceDragOver","fixed","d3_layout_forceDragOut","d3_layout_forceDragNode","d3_layout_forceDragEnd","d3_layout_forceDragForce","d3_layout_forceDrag","resume","d3_layout_forceAccumulate","alpha","charges","cx","cy","charge","leaf","nodes","random","pointCharge","d3_layout_forceLinkDistance","d3_layout_forceLinkStrength","d3_layout_stackX","d3_layout_stackY","d3_layout_stackOut","d3_layout_stackOrderDefault","d3_layout_stackOffsetZero","d3_layout_stackMaxIndex","d3_layout_stackReduceSum","d3_layout_stackSum","d3_layout_histogramBinSturges","d3_layout_histogramBinFixed","LN2","d3_layout_histogramRange","d3_layout_hierarchyRebind","hierarchy","links","d3_layout_hierarchyLinks","d3_layout_hierarchyInline","d3_layout_hierarchyChildren","d3_layout_hierarchyValue","d3_layout_hierarchySort","merge","d3_layout_packSort","d3_layout_packInsert","_pack_next","_pack_prev","d3_layout_packSplice","d3_layout_packIntersects","dr","d3_layout_packCircle","xMin","xMax","yMin","yMax","d3_layout_packLink","d3_layout_packPlace","isect","s1","cr","d3_layout_packUnlink","d3_layout_packTree","d3_layout_packTransform","db","da","dc","theta","acos","d3_layout_clusterY","d3_layout_clusterX","d3_layout_clusterLeft","d3_layout_clusterRight","d3_layout_treeSeparation","d3_layout_treeLeft","_tree","thread","d3_layout_treeRight","d3_layout_treeSearch","compare","d3_layout_treeRightmost","d3_layout_treeLeftmost","d3_layout_treeDeepest","d3_layout_treeVisitAfter","visit","previousChild","d3_layout_treeShift","prelim","d3_layout_treeMove","ancestor","d3_layout_treeAncestor","vim","d3_layout_treemapPadNull","d3_layout_treemapPad","d3_csv_formatRow","row","d3_csv_formatValue","d3_geo_type","defaultValue","d3_path_circle","d3_geo_bounds","d3_geo_boundsTypes","d3_geo_boundsFeature","geometry","d3_geo_boundsFeatureCollection","features","d3_geo_boundsGeometryCollection","geometries","d3_geo_boundsLineString","coordinates","d3_geo_boundsMultiLineString","d3_geo_boundsMultiPolygon","d3_geo_boundsPoint","d3_geo_boundsPolygon","d3_geo_greatArcSource","d3_geo_greatArcTarget","d3_geo_greatArcInterpolator","A","kx0","kx1","ky0","ky1","sy0","sy1","d3_geo_radians","cy0","cy1","cx0","sx0","cx1","sx1","d3_geo_greatArcInterpolate","d3_geom_contourStart","d3_geom_hullCCW","d3_geom_polygonInside","d3_geom_polygonIntersect","y3","y4","x13","x21","x43","y13","y21","y43","ua","d3_voronoi_tessellate","vertices","Sites","bottomSite","EdgeList","rightEnd","createHalfEdge","vertex","lb","he","leftBound","Geom","rightOf","del","leftRegion","region","rightRegion","d3_voronoi_opposite","newEdge","ep","adx","ady","el1","el2","xint","yint","e1r","e2r","rightOfSite","topsite","dyp","dxp","dxs","yl","t2","t3","endPoint","site","EventQueue","ystar","nextEvent","extractMin","newIntStar","lbnd","rbnd","llbnd","rrbnd","bisector","pm","newSite","d3_geom_quadtreeNode","d3_geom_quadtreeVisit","sx","sy","d3_geom_quadtreePoint","d3_time_utc","d3_time_parse","template","d3_time_parsers","d3_time_parseWeekdayAbbrev","d3_time_weekdayAbbrevRe","d3_time_parseWeekday","d3_time_weekdayRe","d3_time_parseMonthAbbrev","d3_time_monthAbbrevLookup","d3_time_parseMonth","d3_time_monthRe","d3_time_monthLookup","d3_time_parseLocaleFull","d3_time_formats","d3_time_parseLocaleDate","d3_time_parseLocaleTime","X","d3_time_parseFullYear","d3_time_numberRe","d3_time_parseYear","d3_time_century","d3_time_parseMonthNumber","d3_time_parseDay","d3_time_parseHour24","H","d3_time_parseMinutes","d3_time_parseSeconds","S","d3_time_parseMilliseconds","d3_time_parseAmPm","d3_time_amPmLookup","d3_time_zone","zs","zh","zm","d3_time_zfill2","d3_time_formatIsoNative","d3_time_interval","d0","d1","d3_time","dt","times","range_utc","d3_time_interval_utc","d3_time_scale","d3_time_scaleDate","d3_time_scaleExtent","d3_time_scaleSteps","d3_time_scaleFormat","formats","d3_time_scaleSetYear","d3_time_scaleGetYear","d3_time_scaleUTCSetYear","d3_time_scaleUTCGetYear","setProperty","d3_style_prototype","CSSStyleDeclaration","d3_style_setProperty","priority","d3_array","__proto__","property","d3_map_prefix","keys","entries","d3_map_prefixCode","functor","descending","mean","median","normal","deviation","sum","transpose","matrix","zip","zips","d3_bisector","nest","rollup","sortValues","keyValue","valuesByKey","sortKey","sortKeys","indexes","permutes","arrays","d3_requote_re","req","XMLHttpRequest","overrideMimeType","setRequestHeader","onreadystatechange","readyState","send","responseText","json","JSON","parse","selectNode","createContextualFragment","responseXML","d3_nsPrefix","xhtml","xlink","xmlns","prefix","qualify","specifier","d3_format_re","fill","zfill","comma","precision","suffix","d3_format_types","negative","formatPrefix","toPrecision","toExponential","d3_formatPrefixes","d3_ease_quad","d3_ease_cubic","d3_ease_default","d3_ease","poly","cubic","exp","circle","elastic","back","bounce","d3_ease_mode","in","in-out","out-in","interpolators","interpolateNumber","interpolateString","s0","d3_interpolate_number","transform","ta","tb","ra","wa","wb","ka","kb","interpolateRgb","ar","ag","ab","br","bb","interpolateHsl","h0","l0","h1","l1","interpolateArray","na","nb","interpolateObject","brighter","darker","darkslategrey","dimgrey","grey","lightgray","lightslategrey","slategrey","querySelector","querySelectorAll","d3_selectRoot","d3_selectMatcher","matchesSelector","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","Sizzle","uniqueSort","d3_selectionRoot","subgroup","subnode","subgroups","attrNull","attrNullNS","removeAttributeNS","attrConstant","attrConstantNS","setAttributeNS","attrFunction","attrFunctionNS","getAttributeNS","classed","styleNull","removeProperty","styleConstant","styleFunction","getPropertyValue","propertyNull","propertyConstant","propertyFunction","createElementNS","namespaceURI","appendNS","insertNS","groupData","nodeData","updateNodes","enterNodes","exitNodes","nodeByKeyValue","keyValues","exit","capture","transition","d3_transitionNextId","upgroup","d3_transitionDefaultDelay","d3_transitionDefaultDuration","d3_transitionDefaultEase","subnodes","attrTween","nameNS","attrTweenNS","styleTween","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","consolidate","touches","touch","identifier","category10","d3_category10","category20","d3_category20","category20b","d3_category20b","category20c","d3_category20c","quantize","arc","a0","df","c0","c1","d3_svg_arcMax","centroid","step-before","step-after","basis","basis-open","basis-closed","bundle","cardinal","cardinal-open","cardinal-closed","monotone","radial","angle","chord","equals","curve","diagonal","projection_","d3_svg_symbols","cross","diamond","ry","d3_svg_symbolTan30","rx","square","triangle-down","d3_svg_symbolSqrt3","triangle-up","symbolTypes","tickTransform","tickValues","tickArguments_","tickFormat_","tickSubdivide","subtick","subtickEnter","subtickExit","subtickUpdate","tickEnter","tickExit","tickUpdate","pathUpdate","scale1","scale0","__chart__","lineEnter","lineUpdate","textEnter","textUpdate","orient","tickMinorSize","tickMajorSize","tickPadding","tickEndSize","tickSize","brush","tz","resizes","brushstart","d3_svg_brushCursor","redrawX","redrawY","redraw","changedTouches","brushmove","moved","resizingX","move1","resizingY","event_","extentDomain","brushend","eventTarget","ex","ey","d3_svg_brushResizes","behavior","dragmove","dragend","origin_","mousemove","dblclick","touchstart","touchmove","scaleTo","scaleExtent","translateTo","translate0","touchtime","d3_behavior_zoomInfinity","layout","paths","relayout","groupSums","subgroupIndex","chords","sortGroups","sortSubgroups","di","dj","subindex","sortChords","resort","repulse","dn","dragstart","distances","strengths","friction","linkDistance","linkStrength","weight","geom","quadtree","neighbors","neighbor","partition","pie","d3_layout_pieSortByValue","arcs","series","orders","offsets","d3_layout_stackOrders","d3_layout_stackOffsets","inside-out","sums","tops","bottoms","silhouette","wiggle","s3","o0","expand","histogram","bin","bins","valuer","binner","frequency","recurse","childs","revalue","root","pack","cluster","previousNode","separation","tree","firstWalk","apportion","midpoint","secondWalk","vip","vop","vom","sip","sop","sim","som","deep","treemap","squarify","pad","remaining","best","worst","stickify","rmax","rmin","ratio","stickies","sticky","padFunction","padConstant","csv","header","parseRows","EOF","EOL","rows","azimuthal","cc","atan","albers","lng0","C","reload","phi1","parallels","phi2","lat0","p0y","albersUsa","lon","lat","alaska","hawaii","puertoRico","lower48","dz","bonne","parallel","equirectangular","mercator","pointRadius","pointCircle","pathType","buffer","project","polygonArea","polygonCentroid","polygon","FeatureCollection","Feature","Point","MultiPoint","LineString","MultiLineString","subcoordinates","MultiPolygon","subsubcoordinates","GeometryCollection","areaType","centroidType","feature","radians","clip","clipped","resample","resamples","resampled","degrees","greatArc","clipType","create","greatCircle","contour","pdx","pdy","d3_geom_contourDx","d3_geom_contourDy","hull","plen","subject","voronoi","polygons","v1","v2","delaunay","edges","triangles","insertChild","getHours","getUTCHours","getMilliseconds","getUTCMilliseconds","getMinutes","getSeconds","getUTCSeconds","setDate","d3_time_prototype","setUTCDate","setDay","setUTCDay","setHours","setUTCHours","setMilliseconds","setUTCMilliseconds","setMinutes","setUTCMonth","setSeconds","setUTCSeconds","d3_time_zfill3","d3_time_zfill4","d3_time_sfill2","d3_time_weekdays","d3_time_months","I","U","sundayOfYear","mondayOfYear","Z","%","jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec","january","february","march","april","june","july","august","september","october","november","december","am","d3_time_formatIso","timezone","interval","sunday","d3_time_scaleLocalMethods","d3_time_scaleLocalFormats","d3_time_scaleLinear","d3_time_scaleLocalFormat","d3_time_scaleUTCMethods","d3_time_scaleUTCFormats","d3_time_scaleUTCFormat","mousePosition","evt","contentOverflow","offsetX","offsetY","layerX","layerY","svgNS","hsv2rgb","hsv","hex","rgb2hsv","V","slideListener","slideElement","pickerElement","hueOffset","pickerListener","ColorPicker","colorpickerHTMLSnippet","getElementsByClassName","slideIndicator","pickerIndicator","fixIndicators","pickerCoordinate","slideCoordinate","positionIndicators","slideClone","slide","pickerClone","picker","hsvGradient","hsvRect","uniqID","blackAndWhiteGradients","whiteAndBlackRects","enableDragging","disableDragging","setColor","mouseSlide","pickerHeight","mousePicker","SVGAngle","implementation","hasFeature","stop-color","stop-opacity","namespaces","rgbHex","hsv2hex","rgb2hex","hex2hsv","hex2rgb","setHsv","setRgb","setHex","unBind","drawVersion","drawLocal","draw","toolbar","actions","polyline","rectangle","tooltip","cont","simpleshape","edit","editDisabled","removeDisabled","subtext","Draw","Handler","includes","Mixin","Events","_map","_container","_overlayPane","_panes","overlayPane","_popupPane","popupPane","shapeOptions","Util","setOptions","_enabled","fire","layerType","addHooks","DomUtil","disableTextSelection","getContainer","_tooltip","Tooltip","DomEvent","_cancelDrawing","removeHooks","enableTextSelection","_fireCreatedEvent","statics","TYPE","Poly","allowIntersection","repeatMode","drawError","DivIcon","iconSize","guidelineDistance","maxGuideLineLength","stroke","clickable","metric","showLength","zIndexOffset","message","_markers","_markerGroup","LayerGroup","addLayer","_poly","updateContent","_getTooltipText","_mouseMarker","getCenter","divIcon","iconAnchor","_onMouseDown","addTo","_onMouseMove","_onMouseUp","_onZoomEnd","_clearHideErrorTimeout","_cleanUpShape","removeLayer","_clearGuides","deleteLastVertex","lastMarker","latlng","spliceLatLngs","getLatLngs","_vertexChanged","addVertex","markersLength","newLatLngIntersects","_showErrorTooltip","_errorShown","_hideErrorTooltip","_createMarker","addLatLng","_finishShape","_shapeIsValid","_updateGuide","layerPoint","_currentLatLng","_updateTooltip","setLatLng","_updateFinishHandler","_updateRunningMeasure","_mouseDownOrigin","distanceTo","devicePixelRatio","markerCount","latLngToLayerPoint","_drawGuide","getLatLng","latLng","updatePosition","pointA","pointB","fraction","dashPoint","dash","_guidesContainer","setPosition","_updateGuideColor","labelText","distanceStr","_getMeasurementString","previousMarkerIndex","_measurementRunningTotal","currentLatLng","previousLatLng","GeometryUtil","readableDistance","showAsError","setStyle","_hideErrorTimeout","removeError","showArea","fillColor","fillOpacity","_area","readableArea","_vertexAdded","latLngs","geodesicArea","SimpleShape","_endLabelText","_mapDraggable","_initialLabelText","_shape","_isDrawing","_startLatLng","_drawShape","Rectangle","setBounds","LatLngBounds","getBounds","Circle","showRadius","setRadius","getRadius","useMetric","Icon","Default","_onClick","_marker","Edit","_initMarkers","updateMarkers","clearLayers","latlngs","_latlngs","_onMarkerClick","markerLeft","markerRight","_createMiddleMarker","_updatePrevNext","_origLatLng","_index","_onMarkerDrag","_fireEdit","_removeMarker","_updateIndexes","edited","_latlng","_middleLeft","_getMiddleLatLng","_prev","_middleRight","_next","minPoints","eachLayer","marker1","marker2","onClick","onDragEnd","setOpacity","lng","unproject","_add","_divideBy","addInitHook","editing","editable","moveIcon","resizeIcon","shape","_unbindMarker","_moveMarker","_resizeMarkers","_createMoveMarker","_createResizeMarker","_bindMarker","_onMarkerDragStart","_onMarkerDragEnd","_resize","corners","_getCorners","_cornerIndex","currentCornerIndex","_oppositeCorner","_toggleCornerMarkers","_repositionCornerMarkers","newCenter","newLatLngs","setLatLngs","latLngBounds","getNorthWest","getNorthEast","getSouthEast","getSouthWest","resizemarkerPoint","_getResizeMarkerPoint","_radius","moveLatLng","LatLngUtil","cloneLatLngs","cloneLatLng","pointsCount","d2r","DEG_TO_RAD","isMetric","areaStr","LineUtil","segmentsIntersect","_checkCounterclockwise","include","_originalPoints","_tooFewPointsForIntersection","_lineSegmentsIntersectsRange","skipFirst","newPointIntersects","newPoint","lastPoint","maxIndex","extraPoints","minIndex","polylineIntersects","firstPoint","Control","_toolbars","DrawToolbar","stamp","_toolbarEnabled","EditToolbar","onAdd","toolbarContainer","addedTopClass","topClassName","toolbarId","addToolbar","onRemove","removeToolbar","setDrawingOptions","Map","mergeOptions","drawControlTooltips","drawControl","addControl","Toolbar","Class","_modes","_actionButtons","_activeMode","buttonIndex","buttonClassPrefix","_toolbarClass","modeHandlers","getModeHandlers","_toolbarContainer","_initModeHandler","_lastButtonIndex","_actionsContainer","handlerId","_disposeButton","_handlerActivated","_handlerDeactivated","classNamePredix","buttonTitle","_createButton","_showActionsToolbar","_hideActionsToolbar","_createActions","li","dl","getActions","lastButtonIndex","toolbarPosition","_singleLineLabel","tooltipContainer","selectedPathOptions","dashArray","featureGroup","_selectedFeatureCount","_save","_checkDisabled","revertLayers","hasLayers","getLayers","_selectedPathOptions","_featureGroup","FeatureGroup","_uneditedLayerProps","_hasAvailableLayers","_enableLayerEdit","_disableLayerEdit","_revertLayer","editedLayers","_backupLayer","_toggleMarkerHighlight","_icon","_offsetMarker","iconMarginTop","iconMarginLeft","pathOptions","isMarker","previousOptions","_deletableLayers","_enableLayerDelete","_disableLayerDelete","_deletedLayers","layerGroup","expose","mk_block_toSource","uneval","trailing","mk_block_inspect","inspect","count_lines","strong_em","md","CloseTag","len_after","state_slot","other_slot","orig_match","processInline","consumed","split_meta_hash","meta_string","meta","in_quotes","extract_attr","jsonml","escapeHTML","render_tree","tag_attrs","convert_tree_to_html","references","preprocessTreeNode","merge_text_nodes","Markdown","dialect","dialects","Gruber","em_state","strong_state","debug_indent","toTree","toHTML","toHTMLTree","renderJsonML","refs","mk_block","block","trail","toSource","split_blocks","startLine","blocks","line_no","processBlock","cbs","ord","__order__","__call__","debug","inline","custom_root","old_tree","print","loop_re_over_block","atxHeader","setextHeader","block_search","horizRule","lists","regex_for_depth","indent_re","any_list","expand_tab","loose","add_to","what","is_str","get_contained_blocks","paragraphify","last_li","sublist","bullet_list","is_list_re","make_list","li_accumulate","line_re","wanted_depth","contained","next_block","hr","blockquote","abutting","processedBlock","referenceDefn","para","__oneElement__","patterns_or_re","previous_nodes","__patterns__","patterns","]","}","__escape__","\\","![","alt","[","DialectHelpers","inline_until_char","open_parens","<","`","  \n","buildBlockOrder","buildInlinePatterns","want","subclassDialect","Block","Inline","Maruku","processMetaHash","document_meta","pairs","block_meta","hash","definition_list","tight","terms","defns","table","_split_on_unescaped","leading_pipe","no_leading_pipe","html_attrs","align","html_row","thisp","markdown","DatePicker","views","moths","tpl","flat","starts","lastSel","view","calendars","eventName","onRender","onChange","onShow","onBeforeShow","onHide","daysShort","daysMin","weekMin","indic","indic2","tblCal","cal","currentCal","cnt","addMonths","formatDate","tmpl","addDays","getWeekNumber","classname","fromUser","parseDate","against","ir","getDayOfYear","sec","getDayName","getMonthName","extendDate","tempDate","getMaxDays","addYears","tmpDate","getFirstDay","dms","extraHeight","divs","extraWidth","tbl","ev","parentEl","tblEl","tblIndex","fillIt","nr","dat","prepareDate","compatMode","isChildOf","prEl","calEl","day1","day2","day3","day4","day5","day6","day7","showPicker","hidePicker","shiftTo","formated","fixLayout","DatePickerHide","DatePickerShow","DatePickerSetDate","DatePickerGetDate","DatePickerClear","DatePickerLayout","Dragster","__bind","dragleave","dragenter","supportsEventConstructors","CustomEvent","bubbles","cancelable","removeListeners","_error","Dropzone","Emitter","camelize","contentLoaded","detectVerticalSquash","drawImageIOSFix","noop","without","__slice","__hasProp","__extends","__super__","_callbacks","emit","callbacks","_len","removeListener","removeAllListeners","_super","_ref","defaultOptions","previewTemplate","clickableElements","dropzone","instances","optionsForElement","forceFallback","isBrowserSupported","acceptedFiles","acceptedMimeTypes","getExistingFallback","previewsContainer","getElement","getElements","resolveOption","withCredentials","parallelUploads","uploadMultiple","maxFilesize","paramName","createImageThumbnails","maxThumbnailFilesize","thumbnailWidth","thumbnailHeight","filesizeBase","maxFiles","params","ignoreHiddenFiles","autoProcessQueue","autoQueue","addRemoveLinks","dictDefaultMessage","dictFallbackMessage","dictFallbackText","dictFileTooBig","dictInvalidFileType","dictResponseError","dictCancelUpload","dictCancelUploadConfirmation","dictRemoveFile","dictRemoveFileConfirmation","dictMaxFilesExceeded","messageElement","getFallbackForm","srcRatio","trgRatio","srcX","srcY","srcWidth","srcHeight","optWidth","optHeight","trgHeight","trgWidth","dragover","paste","addedfile","removeFileEvent","removeLink","_j","_k","_len1","_len2","_ref1","_ref2","_results","previewElement","filesize","_removeLink","_this","UPLOADING","confirm","removeFile","removedfile","_updateMaxFilesReachedClass","thumbnail","dataUrl","thumbnailElement","errormultiple","processing","processingmultiple","uploadprogress","progress","bytesSent","totaluploadprogress","sending","sendingmultiple","successmultiple","canceledmultiple","completemultiple","maxfilesexceeded","maxfilesreached","queuecomplete","objects","getAcceptedFiles","accepted","getRejectedFiles","getFilesWithStatus","getQueuedFiles","QUEUED","getUploadingFiles","getActiveFiles","setupHiddenFileInput","hiddenFileInput","addFile","URL","webkitURL","updateTotalUploadProgress","efct","effectAllowed","dropEffect","clickableElement","elementInside","removeAllFiles","activeFiles","totalBytes","totalBytesSent","totalUploadProgress","upload","_getParamName","existingFallback","fields","fieldsString","getFallback","elements","setupEventListeners","elementListeners","_results1","removeEventListeners","cancelUpload","cutoff","selectedSize","selectedUnit","webkitGetAsEntry","_addFilesFromItems","handleFiles","clipboardData","entry","isFile","getAsFile","isDirectory","_addFilesFromDirectory","kind","directory","dirReader","entriesReader","createReader","fullPath","readEntries","isValidFile","ADDED","_enqueueThumbnail","_errorProcessing","enqueueFile","enqueueFiles","processQueue","_thumbnailQueue","_processingThumbnail","_processThumbnailQueue","createThumbnail","cancelIfNecessary","fileReader","createThumbnailFromUrl","readAsDataURL","imageUrl","resizeInfo","_ref3","trgX","trgY","onerror","processingLength","queuedFiles","processFiles","processFile","uploadFiles","_getFilesWithXhr","groupedFile","groupedFiles","CANCELED","uploadFile","formData","handleError","headerName","headerValue","headers","inputName","inputType","progressObj","updateProgress","_len3","_m","_ref4","_ref5","allFilesFinished","loaded","getResponseHeader","_finished","onprogress","Accept","Cache-Control","X-Requested-With","FormData","hasAttribute","checked","SUCCESS","ERROR","forElement","autoDiscover","discover","checkElements","dropzones","blacklistedBrowsers","capableBrowser","FileList","Blob","rejectedItem","els","question","rejected","baseMimeType","mimeType","validType","ACCEPTED","PROCESSING","ih","iw","naturalWidth","naturalHeight","getImageData","sh","dw","dh","vertSquashRatio","rem","createEventObject","frameElement","_autoDiscoverFunction","_superClass","BackboneModelFileUpload","fileAttribute","wait","_validate","mergedAttrs","formAttrs","fileAttr","_flatten","processData","contentType","ajaxSettings","_progressHandler","flatObject","lengthComputable","percentComplete","renderDocument","windowWidth","windowHeight","html2canvasIndex","createWindowClone","attributeName","html2canvasNodeAttribute","clonedWindow","contentWindow","oncloneHandler","Promise","resolve","onclone","renderWindow","Support","imageLoader","ImageLoader","documentWidth","documentHeight","renderer","parser","NodeParser","crop","cleanupContainer","removeContainer","croppedCanvas","smallImage","isIE9","cloneNodeIE9","javascriptEnabled","nodeValue","containerDocument","labelCanvasElements","scrolling","documentClone","cloneNodeValues","cloneCanvasContents","write","restoreOwnerScroll","adoptNode","removeScriptNodes","originalNodes","clonedNodes","loadUrlDocument","Proxy","documentFromHTML","DOMParser","parseFromString","createHTMLDocument","ee","host","html2canvasCanvasCloneAttribute","html2canvasCanvasCloneIndex","clonedCanvas","putImageData","isElementNode","Node","ELEMENT_NODE","absoluteUrl","Color","fromArray","namedColor","rgba","hex6","hex3","DummyImageContainer","promise","image","Image","reject","Font","family","baseline","sampleText","verticalAlign","lineHeight","lineWidth","FontMetrics","FrameContainer","sameOrigin","proxyLoad","html2canvas","allowTaint","imageTimeout","GradientContainer","imageData","colorStops","ImageContainer","cors","tainted","crossOrigin","getOrigin","LinearGradientContainer","TYPES","LINEAR","hasDirection","stepRegExp","colorStop","colorStopMatch","some","logging","NodeContainer","borders","backgroundClip","offsetBounds","computedStyles","backgroundImages","transformData","transformMatrix","isPseudoElement","selectionValue","selectedIndex","parseMatrix","isPercentage","parseBackgrounds","definition","prefix_i","quote","whitespace","numParen","appendResult","removePx","clientRect","renderQueue","StackingContext","canvasBackground","isTransparent","visibile","isElementVisible","createPseudoHideStyles","disableAnimations","flatten","getChildren","getPseudoElements","fontMetrics","calculateOverflowClips","images","fetch","isElement","createStackingContexts","sortStackingContexts","renderIndex","asyncRenderer","paint","hasParentClip","toCamelCase","ClearTransform","calculateBorders","nodeBounds","borderPoints","borderSide","bx","bw","bh","drawSide","c2","c3","c4","topLeftOuter","topLeftInner","topRightOuter","topRightInner","bottomRightOuter","bottomRightInner","bottomLeftOuter","bottomLeftInner","getCurvePoints","r2","kappa","ox","oy","xm","ym","topLeft","bezierCurve","topRight","bottomRight","bottomLeft","calculateCurvePoints","borderRadius","tlh","tlv","trh","trv","brh","brv","blh","blv","topWidth","rightHeight","bottomWidth","leftHeight","subdivide","startControl","endControl","lerp","bc","cd","abbc","bccd","dest","curveTo","borderArgs","curveToReversed","borderData","radius1","radius2","outer1","inner1","outer2","inner2","parseCorner","corner1","corner2","negativeZIndex","cssInt","positiveZIndex","zIndex0","inlineLevel","isStackingContext","hasText","noLetterSpacing","getBorderRadiusData","currentVal","asInt","renderableNode","TEXT_NODE","isPositionedForStacking","isPositioned","isFloating","isInlineBlock","isTextNode","zIndexSort","contexts","hasOpacity","getOpacity","getWidth","nonIgnoredElement","nodeContainer","stripQuotes","getWords","characters","words","onWordBoundary","isWordBoundary","punycode","ucs2","encode","characterCode","hasUnicode","createCallback","supportsCORS","createProxyUrl","XHR","jsonp","decode64","ProxyURL","supportsCORSImage","cleanup","useCORS","proxyCount","encodeURIComponent","api_key","ProxyImageContainer","PseudoElementContainer","Renderer","hasOwnStacking","ownStacking","rangeBounds","testRangeBounds","testCORS","testSVG","SVGContainer","hasFabric","isInline","inlineFormatting","fabric","loadSVGFromString","createCanvas","base64","encoded1","encoded2","encoded3","encoded4","byte1","byte2","byte3","chars","SVGNodeContainer","native","XMLSerializer","serializeToString","parseSVGDocument","TextContainer","capitalize","WebkitGradientContainer","RADIAL","statusText","CanvasRenderer","taintCtx","textBaseline","variables","hasEntries","F","nextTick","observe","characterData","MessageChannel","port1","onmessage","port2","postMessage","J","K","TypeError","N","O","MutationObserver","WebKitMutationObserver","Uint8ClampedArray","importScripts","race","catch","polyfill","ES6Promise","RangeError","mapDomain","labels","regexSeparators","encoded","ucs2decode","extra","ucs2encode","stringFromCharCode","basicToDigit","codePoint","digitToBasic","digit","flag","adapt","numPoints","damp","baseMinusTMin","tMax","decode","oldi","baseMinusT","inputLength","initialN","initialBias","delimiter","maxInt","tMin","handledCPCount","basicLength","currentValue","handledCPCountPlusOne","qMinusT","toUnicode","regexPunycode","toASCII","regexNonASCII","freeExports","freeModule","freeGlobal","not-basic","invalid-input","html2canvasCloneIndex","nodeList","onrendered","darken","isBlack","_hex3","_hex6","_rgb","_rgba","isColor","rebeccapurple","getMetrics","findImages","imageNodes","addImage","loadImage","findBackgroundImage","parseBackgroundImages","hasImageBackground","newImage","imageExists","isSVG","isSameOrigin","protocol","hostname","port","getPromise","dummy","cloneTo","cssFloat","assignStack","computedStyle","prefixedCss","prefixes","parseClip","CLIP","cssList","parseBackgroundSize","targetRatio","currentRatio","parseBackgroundPosition","backgroundSize","parseBackgroundRepeat","parseTextShadows","textShadow","shadows","TEXT_SHADOW_PROPERTY","TEXT_SHADOW_VALUES","parseTransform","hasTransform","parseBounds","parseTransformMatrix","MATRIX_PROPERTY","appendToDOM","parseBorders","cssClip","cleanDOM","asyncTimer","createStyles","PSEUDO_HIDE_ELEMENT_CLASS_BEFORE","PSEUDO_HIDE_ELEMENT_CLASS_AFTER","hidePseudoElements","getPseudoElement","isImage","pseudoNode","pseudoContainer","parentContainer","newStackingContext","parentStack","getParentStack","isRootElement","isBodyWithTransparentRoot","parseTextBounds","textList","getRangeBounds","replacementNode","splitText","getWrapperBounds","backupText","setStart","setEnd","negativeZindex","descendantElements","descendantNonFloats","nonInlineNonPositionedDescendants","nonPositionedFloats","inFlow","stackLevel0","positiveZindex","paintText","paintNode","setTransform","paintCheckbox","paintRadio","paintElement","renderBackground","renderBorders","imgContainer","renderImage","imageContainer","paintFormValue","font","circleStroke","applyTextTransform","letterRendering","character","fontShadow","clearShadow","renderTextDecoration","metrics","borderColorTransforms","inset","colorTransform","parseBackgroundClip","getHideClass","paddingBottom","renderBackgroundColor","renderBackgroundImage","renderBorder","drawShape","renderBackgroundRepeating","gradientImage","renderBackgroundGradient","repeat","backgroundRepeatShape","renderBackgroundRepeat","rangeHeight","removeContentType","StaticCanvas","lowerCanvasEl","setWidth","setHeight","groupSVGElements","renderAll","atob","setFillStyle","beginPath","closePath","strokeColor","strokeStyle","taints","shapes","variant","setVariable","globalAlpha","fillText","backgroundPosition","createPattern","resizeImage","gradient","createLinearGradient","addColorStop","wordRegexp","tokenBase","curPunc","tokenLiteral","tokenOpLiteral","operatorChars","ops","ch2","escaped","pushContext","popContext","textAfter","firstChar","parserConfig","inText","chain","inBlock","doctype","inTag","baseState","tagStart","inAttribute","stringStartCol","closure","isInAttribute","terminator","Context","startOfLine","Kludges","doNotIndent","noIndent","maybePopContext","nextTagName","parentTagName","contextGrabbers","tagNameState","closeTagNameState","attrState","implicitlyClosed","closeState","closeStateErr","_stream","attrEqState","autoSelfClosers","attrValueState","allowMissing","attrContinuedState","allowUnquoted","multilineTagIndentFactor","multilineTagIndentPastTag","htmlMode","command","embed","frame","keygen","param","track","wbr","optgroup","rp","tbody","td","tfoot","tr","address","article","aside","fieldset","footer","h2","h3","h4","h5","h6","hgroup","nav","ol","section","thead","caseFold","alignCDATA","fullLine","tagAfter","grabbers","electricInput","blockCommentStart","blockCommentEnd","configuration","draggableOverlay","$rule","$ruleH","$elements","horizontal_guides","vertical_guides","stickiness","vertical_limits","horizontal_limits","verticals","$container","horizontals","$drag","drg_h","drg_w","pos_y","pos_x","container_x","container_y","container_w","container_h","device","onMouseMove","otop","oleft","container_right","container_bottom","target_l","updateLayout","throttle","onExit","inTagsArray","tokenCComment","tokenSGMLComment","tokenString","tokenSComment","t_v","old_pos","new_pos","selectors","colorKeywords","keySet","maybeEnd","dashes","color_keywords","baseIndent","Utils","stripHTML","$0","$1","removeHTMLEvents","truncate","isURL","urlregex","encodeURLParams","urlParts","readablizeBytes","bytes","isBlank","formatNumber","rgbToHex","componentToHex","hexToRGB","genRandomPass","getRandomNum","rndNum","checkPunc","pass","randomLength","numI","sanitizeString","readizableNumber","getFileExtension","getGetOrdinal","isValidEmail","safeTableNameQuoting","table_name","DropdownMenu","common","Dropdown","dfd","Deferred","delegateEvents","vertical_position","speedIn","openAt","horizontal_position","isOpen","when","speedOut","StringField","core","View","default_options","template_name","autoResize","change textarea","keydown textarea","bindAll","template_base","templates","getTemplate","valid","_setOS","undelegateEvents","so","_onChange","_onKeyDown","_triggerEvent","$textarea","forms","click .image-picker","click .color-picker","image_property","image_kind","image_value","_createTooltips","addView","TipsyTooltip","_createPicker","picker_vertical_position","picker_horizontal_position","color_picker","extra_colors","unset","_destroyPicker","_bindColorPicker","_unbindColorPicker","removeView","setExtraColors","setColors","_openImagePicker","User","user_data","dialog","ImagePickerView","appendToBody","_onImageFileChosen","_openColorPicker","ColorWizard","cartoParser","CartoParser","colorsUsed","Hidden","add_related_model","SimpleNumber","inc","debounce_time","disable_triggering","click .plus","click .minus","keypress input.value","keydown input.value","keyup input.value","change .value","noSlider","_initSlider","_fireChange","initValue","isNumber","_changeValue","_plus","_minus","spinner_slider","SpinnerSlider","_checkNumber","_checkInputPress","newChar","_checkInputUp","_saveValue","_checkValueChange","baseNumber","_showSlider","SimpleNumberWithLabel","isDisabled","Spinner","Opacity","SimpleOpacity","OpacityPolygon","switchProperty","originalProperty","Width","Combo","change select","_onUpdate","deselect","updateData","_getOptions","_setValue","$select","plainSelect","combo_options","_formatResult","_formatSelection","_matcher","_changeSelection","clean","Switch","TextAlign","click .align","_align","alignments","Text","mouseenter .text","click .close","click .content","click .text","dblclick .content","dblclick .text","keyup .text","paste .text","form_data","font-size","font-family-name","text-align","box-color","box-opacity","box-padding","box-width","_setupModels","applyStyle","_applyStyle","_setText","_onChangeDisplay","_onChangeExtra","_onChangeSelected","editModel","_onChangeMode","_onKeyUp","$text","_onClickEdit","_savePosition","_close","_onPaste","_onDblClick","oldX","oldY","portrait_dominant_side","landscape_dominant_side","right_position","bottom_position","map_width","map_height","left_percentage","top_percentage","default_position","_onMouseEnter","animated","_onCloseDialogs","boxColor","boxOpacity","boxWidth","boxPadding","rgbaCol","fontFamilyClass","_disableEditingMode","_enableEditingMode","fadeIn","_isEmptyText","regexp","_transformToMarkdown","isNew","rendered_text","_place","Url","base_url","urlToPath","byBaseUrl","pathname","_joinArgumentsWithSlashes","compact","DashboardVisUrl","lockedItems","sharedItems","likedItems","CustomScrolls","checkScroll","height_","scroll_y","scroll_y_height","$parent","$top","$bottom","ErrorStats","people","enable_logs","_setService","BooleanField","click a.radiobutton","$radio","_setSelected","_PICKER_DELAY","_COLORS","horizontal_offset","vertical_offset","dragUpdate","click a.advanced","click .default-colors li a","keyup input.text","change input.text","submit form","_handleClick","_initBinds","uniq","_setPicker","_checkColor","_setColor","_clickedColor","_triggerColor","_submitColor","_onPickerMouseMove","_onPickerMouseUp","_bindAdvancedPicker","_destroyAdvancedPicker","_openAdvanced","positionate","$target","targetPos","elementWidth","DateField","change input.time","keyup input.time","_splitDate","_getTimeZone","date_model","_onChangeModel","_reClean","_initViews","today","split_date_hour","split_date","_toDate","_checkTime","EditInPlace","click .value","keyup input","blur input","_observedField","_setupConfig","_updateValue","_updateMode","$input","_preventEmptyValue","_onBlur","escape","ColumnTypeCombo","Form","simple_opacity","opacity_polygon","simple_number","simple_number_with_label","switch","text_align","field_template","updateForm","_renderField","field_name","getFieldByName","getFieldsByName","_subviews","clearSubViews","GeometryField","click .switch","isGeomLoaded","_chooseGeom","_loadGeom","rowNumber","stringify","_chooseEditor","updateInputs","_checkInputs","$lat","$lon","_onKeyInputUp","_onKeyTextareaDown","NumberField","change input","keydown input","_setValid","_setInvalid","_stopPropagation","CustomTextCombo","actual_value","_valueAsOption","isText","GlobalError","DEFAULT_TAG","_lastType","load","getTypeTemplate","showError","currentPriority","_timer","listenGlobal","Header","_TEXTS","saving","saved","visualization","loader","created","share","publish","visualize","share_privacy","ok_next","rename","readonly","owner","_MAX_DESCRIPTION_LENGTH","click a.title","click .metadata a","click a.options","click a.share","click a.privacy","click header nav a","$body","dataLayer","globalError","setInfo","layerView","setEditableInfo","isVisualization","_setName","_setPrivacy","_setSharedCount","_openOptionsMenu","options_menu","HeaderOptionsMenu","private_tables","geocoder","backgroundPollingModel","_shareVisualization","PublishView","clean_on_hide","enter_to_confirm","CreateVisFirstView","router","table_router","explanation","_showPrivacyDialog","isOwnedByUser","ChangePrivacyView","vis","_setSyncInfo","_setVisualization","_setMetadata","$share","privacy","isOwner","permission","$count","acl","shared_users","users_perm","getUsersWithAnyPermission","isSharedWithOrganization","$metadata","sync_info","isSyncTable","SyncInfo","$title","isVisEditable","$back","is_visualization","route","prefixUrl","_changeMetadata","dlg","EditVisMetadataView","maxLength","onShowPrivacy","onDone","_onChangeMetadata","nameChanged","navigate","_generateTableUrl","_changeTitle","destroyTipsy","setTitle","_onSetAttributes","change_confirmation","ViewFactory","createDialogByTemplate","title_dialog","EditTextDialog","initial_value","modal_class","onResponse","showAt","old_data","new_data","hasChanged","resp","isSync","CartoDBTableMetadata","getUnqualifiedName","owner_username","_onTabClick","hotkeys","_keyMap","68","67","83","localStorageWrapper","localStorage","getItem","searchTerm","wholeArray","setItem","removeItem","Metrics","bindEvents","_setTrack","hubspot_token","_hsq","email","event_id","hubspot_ids","published_visualization","visited_dashboard","connect_dataset","create_map","export_table","export_map","select_wms","color_basemap","pattern_basemap","geocoding","visual_merge","common_data","cartocss_manually","wizard","logged_in","visited_dashboard_first_time","applied_pecan","open_pecan_list","SmallDialog","Dialog","description","fix","showAtElement","extendEvents","keypress input","ok_title","render_content","_focusInput","_keyPress","_ok","EditMarkdownDialog","old_template_name","Tabs","desactivate","getTab","disableAll","_click","linkToPanel","panel","_tipsyOpenedManually","_initTipsy","showTipsy","hideTipsy","_destroyTipsy","TooltipTrails","margin-left","margin-top","DashboardDatasetsUrl","dataLibrary","DashboardUrl","datasets","deepInsights","DatasetUrl","public","MapUrl","OrganizationUrl","UserUrl","isUndefined","is_org_admin","organization","accountSettings","publicProfile","apiKeys","logout","dashboard","VideoModel","minimized","maximized","_initLocalStorage","videoData","_onChangeProperty","_onChangeMinimized","video_id","_storeVideoID","_saveVideoData","currentVideo","clearStoredData","VideoPlayer","click .js-toggle","click .js-close","_initModel","hasVideoData","_onStopDragging","_onInitDraggable","video","_loadScript","getScript","_initVideoBinds","player","$f","addEvent","_seekToStoredPosition","dontHide","_removeVideoBinds","removeEvent","elHeight","elWidth","_mouseEnter","_mouseLeave","api","_onCloseAnimationFinished","_toggle","setHorizontalPosition","elLeft","setVerticalPosition","WizardDialog","Button","elder","RightMenu","panels","TabPane","tabs","setElement","addToolButton","sections","_addButton","activeSection","addClassToButton","buttonType","getButtonByClass","removeClassFromButton","addModule","addTab","buttonClass","modName","showTools","enabledButtonsForSection","disableModule","getPane","enableModule","DEFAULT_BASEMAPS","CartoDB","subdomains","minZoom","maxZoom","attribution","Stamen","Module","_STORAGE_NAMESPACE","_ACTION","getModuleAction","triggerModuleAction","CartoCSSEditor","click .actions button","click .actions a.next","click .actions a.back","click .doc_info","_updateStyle","tile_style_history_position","tile_style_history","_showErrorFromServer","_checkLocalErrors","activated","buildAutocomplete","symbolizers","_mapnik_reference_latest","sym","codeEditor","_adjustCodeEditorSize","_initHelp","_initEditor","keymap","tabMode","matchBrackets","_onKeyUpEditor","Ctrl-Space","CodemirrorColorPicker","HTMLEditorHelp","localStorageKey","union","_getTableName","_getSQLColumns","pair","autocomplete_timeout","schema","formatStyle","spaces","editor_st","_checkDoButtons","_parseError","parsedErrors","_showError","_renderError","actions_h","info_h","help_h","vis_msg_h","checkVariables","variablesUsed","_clearErrors","_do","newCarto","redoHistory","_undo","undoHistory","vars","columns","columnNames","tile_style","tile_style_custom","hasChanges","isHistoryAtLastPosition","isHistoryAtFirstPosition","_showDoc","CartoCSSWizard","click  .wizard_arrows a","currentWizard","wizard_properties","_onWizardClick","enableTabs","renderWizards","_enableModules","MODULES","_onArrowClick","_moveNavigation","_resetNavigation","$ul","list_size","list_item_w","$right","$left","$selectedLi","sizeIndex","block_width","list_width","operator","_setThumbnails","geomColumnTypes","deactivated","renderTabs","toEnable","getEnabledWizards","Profiler","wizards","SimpleWizard","cartoProperties","enableGeneration","_bindChanges","_generateSQL","showTextFields","overlap","text-placement-type","text-label-position-tolerance","vhalo","voffset","voverlap","vplacement","tn","_unbindChanges","$wrapper","$content","custom_scroll","renderError","safeHtml","$no_columns","_searchFieldByName","geomForm","_getNumberColumns","columnNamesByType","_getColumns","_getColorColumns","hiddenColumns","LayersPanel","animation_time","torque","tiled","raster","click .add_layer","layer_panels","master_vis","_newLayer","_resetLayers","_updateLayerPositionLabel","_checkResize","_bindSort","activeWorkView","_setPanelState","removeTabs","_addLayers","_addLayerAddButton","_setDefaultLayer","LayerPanelView","_switchTo","_openDeleteLayerDialog","_addColumn","setActiveWorkView","_bindLayerTooltip","setPanelStatus","_checkLayers","tableTab","tableView","addColumn","dataLayerCid","tabBind","activeTab","_unbindLayerTooltip","removeTab","_manageLayers","getDataLayers","layer_id","cartodbLayers","_unbindSort","_addLayerDialog","canAddLayerTo","LimitsReachView","_createAddLayerDialog","createVisDlg","AddLayerModel","AddLayerView","_hideLayerTooltip","contaiment","_sortStart","_sortChange","beforeStop","_sortBeforeStop","_sortLayers","sort_actions","original_layer_pos","$layer","active_height","isAnyTorque","pluck","isLayerTorque","cancelSort","_removeSortTooltip","sortTooltip","_addSortTooltip","_moveSortTooltip","parentOffset","layerId","moveLayer","setLayerOrder","$active_layer","activePane","pre_size","t_s","next_size","b_s","getActivePane","movePanel","_hideDropdowns","active_pane","panel_width","DeleteLayerView","workView","tab","pane","BaseLayerButton","bindMap","selectButton","DropdownBasemap","basemaps_per_list","available_basemaps","click a.add","_keydown","baseLayers","_setupBindings","_bindBaseLayers","_bindMapView","_checkPlainColor","setActiveBaselayer","baselayer","getBaseLayer","background_color","background_image","_toggleAddBaseLayer","$add","googleMapsEnabled","BaseMapView","GMapsBaseView","featureEnabled","baseType","category","listClassName","_getCleanClassName","_updateTarget","subview","baseName","_setThumbnail","$thumb","bkg","background-image","background-position","background-size","background-color","_addBackgroundBasemap","BackgroundMapImageView","$view","_addColorBasemap","BackgroundMapColorView","_addAddBasemapLink","$a","vertical_property","_addBaseDefault","sv","isEqual","_openSelector","AddCustomBasemapView","_changeModel","PlainLayer","changeProvider","_bindPicker","_unbindPicker","_openPicker","click .remove_layer","back_tile","make","_openDropdown","setPattern","ColumntypeDropdown","dialogContainer","click .string","click .number","click .date","click .boolean","setTable","getColumnType","_disableColumn","isTypeChangeAllowed","keep_disabled","setColumnTypeChange","isTypeChangeDestructive","changeColumnType","setString","setNumber","setBool","SmallEditorDialog","editorField","min-width","ExportImageFormatsDropdown","click .js-format","_onChangeFormat","ExportImageView","click .js-ok","dblclick .js-format","click .js-advanced","dblclick input","click input","_MIN_WIDTH","_DEFAULT_MARGIN","_DEFAULT_MIN_WIDTH","horizontalMargin","verticalMargin","show_title","show_description","_onResizeWindow","mapOverlays","getHeaderOverlay","_onChangeVisName","_onChangeVisDescription","legend","_onChangeDimensions","_setupCanvas","_hideOverlays","_updateHelpers","_getMarkdown","sanitize","resizable","_onResize","mapView","_onDrag","_showOverlays","_legendsHidden","canvasWidth","canvasHeight","isTop","isBottom","_cancel","_calcCenter","pixelToLatLon","_isHTTPS","_onImageCallback","ExportImageResultView","generateImage","_openFormatDropdow","_openAdvancedExport","AdvancedExportView","_onAdvancedImageGeneration","vizjson","https","bbox","getUrl","_onAdvancedImageCallback","loadURL","GeometryEditor","MAX_VERTEXES","click .done","click .discard","click .cancel","TEXTS","invalid geometry","geomBeingEdited","drawer","isEditing","finish","canFinish","getGeoJSON","notice","fail","discard","originalGeom","_getGeomCount","geojson","pol1","pol2","editGeom","_showStopEdit","_startEdition","Geometry","the_geom","addGeometry","geoView","createGeom","geomType","editors","PointDrawTool","PolygonDrawTool","PolylineDrawTool","mapview","geom_type","_SYNC_GAP","_POLLING_GAP","few_moments","sync_now_disabled","click a.sync_options","click a.sync_now","synchronization","_isSyncing","_showSyncNow","_startSync","ran_at","run_at","canSync","_canTableSyncNow","fromExternalSource","_bindEvents","_onStateChange","_unbindEvents","_onClickSyncNow","syncNow","_onClickOptions","SyncView","pollCheck","_finishSync","destroyCheck","_hideSyncNow","invalidate","modal","sync_now","click .lock_vis","click .export_map","click .export_table","click .duplicate_table","click .duplicate_vis","click .append_data","click .delete_table","click .georeference","click .merge_tables","click .change_privacy","click .sync_settings","click .delete_vis","isLayerOwner","isVisOwner","googleUser","_setGeocodingBar","per","quota","monthly_use","per_class","_lockVis","viewModel","ChangeLockViewModel","ChangeLockView","_exportMap","ExportMapView","ExportMapModel","visualization_id","_exportTable","isInSQLView","ExportView","_duplicateDataset","DuplicateDatasetView","_duplicateVis","DuplicateVisView","_changePrivacy","_appendData","_syncSettings","_mergeTables","mergeDialog","MergeDatasetsView","_georeference","bkgPollingModel","tableIsReadOnly","canAddGeocoding","isGeocoding","GeoreferenceView","_deleteItem","isVis","DeleteItemsViewModel","viewUrl","DeleteItemsView","HeaderDropdown","isPublic","click .asc","click .desc","click .rename_column","click .change_data_type","click .clearview","click .filter_by_this_column","click .delete_column","click .add_new_column","reserved_column","read_only","in_sql_view","isReservedColumn","orderColumnsAsc","sort_order","order_by","orderColumnsDesc","renameColumn","clearView","changeType","georeference","filterColumn","_addFilter","column_name","deleteColumn","DeleteColumnView","HeaderView","no_geo","NO_MENU_COLUMNS","dblclick .coloptions","click    .coloptions","click    .coltype","click    .geo","keydown  .col_name_edit","focusout input","editing_name","changing_type","colTypeOptions","colOptions","sqlView","col_name","col_type","noMenu","max-width","_openColOptions","_changeType","link_width","_openColTypeOptions","_checkEditColnameInput","_submitEdit","_finishEdit","$coltype_link","activateColumnOptions","showColumnOptions","columnName","parent_","showGeoreferenceWindow","showColumnTypeOptions","MapInfowindow","Infowindow","_NO_FIELDS_SELECTED","_NO_FIELDS_SELECTED_BUTTON","_TEMPLATE_URL","click .edit_data","click .edit_geo","click .remove","click .open_infowindow_panel","renderInfo","_containsCover","_createHelpDialog","helpDialog","setFeatureInfo","cartodb_id","getRow","no_add","no_geom","popup_class","row_attributes","containsField","SYSTEM_COLUMNS","getFieldProperty","getFieldPos","render_fields","setLoading","adjustPan","_loadCover","$cover","$imageNotFound","$img","_getCoverURL","_isValidURL","shadow","hwaccel","spinner","spin","coverWidth","coverHeight","coverRatio","calculatedHeight","_editGeom","_editData","_removeGeom","_openInfowindowPanel","_getModelTemplate","TemplateMap","dblclick span.name","click .name_info a","click .info","click a.visibility","click a.remove","keyup input.alias","click input.alias","SQLViewData","view_model","setDataLayer","_setLayerType","setVisibleMsg","_onChangeStatus","isActive","_dblClick","_addFilters","_goToLayer","_editAlias","_changeAlias","table_name_alias","setLayerName","setActivePanelView","saveActivePanelView","_removeButtons","_switchVisibility","infowindow","_setLayerInfo","setLayerOptions","setVisibility","setView","$div","isEditor","currentPanelView","layerUrl","_setLayerTooltip","_unsetLayerTooltip","$name","_maybeHideVisibilitySwitch","isVisible","dataLayers","enabledModulesInit","_initDataLayer","sql","SQL","Filters","loadScroll","activeWizards","intensity","choropleth","density","torque_cat","torque_heat","enabledModules","enableModules","InfoWindow","_onModuleTabChanged","editorPanel","legends","LegendEditor","availableLegends","mergeTables","addRow","addGeom","_addRow","_addFeature","_bindDataLayer","stat_tag","cartodb_logo","map_key","bindSQLView","aborted","_enableGeometryRelatedWizards","_disableGeometryRelatedWizards","_checkButtons","_applyFilter","supportsInteractivity","SQL_WIZARDS","isGeoreferenced","_addGeometry","_showScratchDialog","ScratchView","skipDisabled","gt","sql_button_changes","applied","has_errors","getCurrentState","_readOnlyTableButtons","_writableTableButtons","work_view","showModule","modTab","setActiveTab","_layers","_loaded","_zoomBoundLayers","_updateZoomLevels","zoomAnimation","TileLayer","_tryAnimatedZoom","_animatingZoom","_nothingToAnimate","_onZoomTransitionEnd","_tileLayersNum","_tileLayersToLoad","_onTileLayerLoad","addListener","gmaps","PathView","gmapsPolyPrototype","setPath","setVertex","getPath","setAt","MarkerLeaflet","iconUrl","setMap","toGeoJSON","PathPrototype","_parent","strokeOpacity","strokeWeight","ll","PolygonLeaflet","PolylineLeaflet","BaseDrawTool","_setObjects","getNativeMap","raiseOnDrag","add_vertex","createOverlays","_add_vertex","defer","LayerView","MapOptionsDropdown","desktopOverlays","_setupOptions","disabledCartodbLogo","mapOptions","layer_selector","fullscreen","logo","scrollwheel","_onChangeDevice","_onMapOptionsChange","_enableDesktopOverlays","$overlay","_disableDesktopOverlays","models","simpleOverlays","overlay_type","_recalcHeight","special_height","dropdown_height","_addSwitches","switches","_addSwitch","_onSwitchSwitched","_renderSwitch","enableScrollWheel","disableScrollWheel","_toggleOverlay","show_property","remove_logo","LeafletMapView","GoogleMapsMapView","MapTab","click .toggle_slides.button","click .add_overlay.button","click .canvas_setup.button","click .export_image.button","click .sqlview .clearview","click .sqlview .export_query","no_interaction_warn","map_enabled","georeferenced","featureHovered","activeLayerView","layerDataView","layerModel","_addBindings","_moveInfo","switchMapType","_toggleLegends","_addLegends","_addTimeline","isMapEnabled","clearMap","autoSaveBoundsTimer","exportImageView","overlaysDropdown","mapOptionsDropdown","basemapDropdown","configureCanvasDropdown","_cleanOverlays","_cleanLegends","stackedLegend","timeline","geometryEditor","_hideInfowindow","enableMap","_showGMapsDeprecationDialog","setupMap","isInsideOrg","baseLayer","isProviderGmaps","_addMapView","clickTimeout","_bindMissingClickEvents","_addBasemapDropdown","_addInfowindow","_addTooltip","_addOverlays","_showPecan","_addSlides","_addOverlaysDropdown","_addConfigureCanvasDropdown","_addMapOptionsDropdown","_onChangeCanvasMode","_saveLocation","ConfigureCanvasDropdown","OverlaysDropdown","slidesPanel","$options","bindGeoRefCheck","fetched","checkGeoRef","scratchDialog","pecanView","noGeoRefDialog","_showNoGeoWarning","noGeoWarningDialog","hasPecan","hasData","skipPencanDialog","PecanView","skipScratchDialog","getLayerByCid","infowindowModel","tooltipModel","legendModel","_bindTable","_bindSQLView","featureClick","featureOut","featureOver","loadingTiles","loadTiles","setLayer","_updateSQLHeader","updateDataLayerView","_getCartoDBLayers","_showDesktopCanvas","_positionOverlaysVertically","_showMobileCanvas","$map","onBackgroundShown","onCanvasLandscapeStretched","onCanvasPortraitStretched","invalidateSize","setCenter","_enableAnimatedMap","_enableMobileLayout","Mobile","_disableMobileLayout","mTop","mLeft","curWidth","curHeight","autoWidth","autoHeight","onSecondAnimationFinished","onFirstAnimationFinished","stretchMapLandscape","_disableAnimatedMap","_bindMapOptions","createOverlayByType","MapOverlays","headerMessageIsVisible","_shouldAddSQLViewHeader","mapToolbar","_exportImage","vizjsonURL","SlidesPanel","slides","_addLegend","Legend","_renderStackedLengeds","any","torqueLayer","getStep","TimeSlider","StackedLegend","_renderLegend","omit_columns","hideDataLayer","showDataLayer","setFilter","FeatureDataView","provider","currentZoom","getZoom","DeleteRowView","newRow","_renderLoading","_removeSQLViewHeader","panel_opened","setHeaderMessageIsVisible","_addSQLViewHeader","latlon","pxPos","showInfowindow","slides_enabled","exportEnabled","showNoGeoRefWarning","warningStorageName","warnMsg","containsColumn","_toggleSlides","_clearView","clearSQLView","_tableFromQuery","duplicate_dialog","polygon_stroke","line-width","line-color","line-opacity","line_stroke","line_stroke_chroloplet","polygon_fill","polygon-fill","polygon-opacity","label_text","text-name","extra_default","label_text_properties","text-face-name","text-size","text-fill","text_allow_overlap","text-allow-overlap","label_placement","text-placement","label_text_offset","text-dy","label_halo_properties","text-halo-fill","text-halo-radius","marker_fill","marker-width","marker-fill","marker-opacity","marker-allow-overlap","marker-placement","marker-type","marker_stroke","marker-line-width","marker-line-color","marker-line-opacity","comp_op_options","comp_op_default_value","polygon_comp_op","polygon-comp-op","line_comp_op","line-comp-op","marker_comp_op","marker-comp-op","column_category","column_numeric","column_torque_category","property_cat","column_numeric_date_with_cartodb_id","default_column","buckets","QuantifyFn","qfunction","color_ramp_polyline","color_ramp_polygon","color_ramp_point","bubble_form","radius_min","radius_max","geometry_type","polygon-size","sharedForTorqueAndTorqueCat","layer-type","torque-duration","torque-frame-count","torque-blend-mode","torque-trails","torque-resolution","torque-cumulative","marker-file","image-filters","heat-animated","ed","_disableBinds","_getCurrentUsedColors","_replaceColor","_bindPickerEvents","_unbindPickerEvents","nameMatch","_getMatch","hexMatch","click .clear a","click .add_filter .add","click .add_filter .remove","_onToggleMode","_showAddFilter","_showCombo","_hideAddFilter","_refreshScroll","_scrollBy","_onClickHideFilterSelector","_onClickClearFilters","_hideQueryAppliedMessage","_onClickShowFilterSelector","_onScroll","getPercentScrolledY","_initialized","_filterViews","addMode","initFilters","comboData","innerColumnSelector","_sendEvent","columnSelector","excludedColumNames","repeatInterval","_onSchemaUpdate","_unbindChangeQuery","removeFilters","_bindChangeQuery","_showQueryAppliedMessage","_filtersChanged","_removeFilter","changeSQLEvents","_generateComboData","allowedTypes","fieldType","$scrollPane","jScrollPane","showArrows","animateScroll","_scrollTo","scrollToY","scrollByY","reinitialise","_getFilterViewforColumnType","columnType","Filter","SelectorFilter","ViewClass","_scrollToPosition","cond","getSQLCondition","_cleanSQL","applySQLView","sql_source","rtrim","cleaned_sql","sqlSource","isQueryApplied","_SHORT_MONTH_NAMES","_MONTH_NAMES","_renderRange","_checkEmpty","_renderHist","chartDivs","_cleanString","dim","dimK","lower","upper","_barChart","chartDefs","chartDiv","_getMinMaxFromDate","min_date","_getDateFromTimestamp","max_date","minMaxDate","_formatDate","_formatLowerUpper","minMax","_updateBounds","lower_","upper_","lowerFit","fitToBucket","upperFit","minDay","maxDay","minYear","maxYear","minMonth","maxMonth","minTime","minDate","maxTime","maxDate","chart","barPath","barWidth","inverseHeight","resizePath","gBrush","brushDirty","SelectorView","_formatNumber","pretty_bucket","bucket_name","column_type","_SCROLLSTEP","click a.apply","click a.up","click a.down","click a.all","click a.none","click .view_mode label","_updateFreeText","_toggleControllers","_toggleScrollers","_toggleMode","_updateLegend","_toggleItems","_updateCounter","countBy","$all","$none","_showControllers","_hideControllers","_showScrollers","_hideScrollers","_hideItems","_addItems","$items","_onKeyPress","_onApply","short_legend","list_view","reached_limit","$scroll","_toggleSwitch","_showListView","_showFreeTextView","_toggleShadow","unselected","_select","$btn","_selectAll","_selectNone","_moveUp","_moveDown","scrollTopPos","listHeight","liHeight","_setupLocalStorage","_setupModel","storage","_onClickClose","click a.doc_info","_renderContent","infowindow_tabs","slash","infowindow_panes","tooltip_pane","TooltipTab","_onEnableTab","infowindow_pane","InfoWindowTab","active_tab","getActiveTab","_showMustacheHelp","tabName","table/views/infowindow_light","table/views/infowindow_dark","table/views/infowindow_light_header_blue","table/views/infowindow_light_header_yellow","table/views/infowindow_light_header_orange","table/views/infowindow_light_header_green","table/views/infowindow_header_with_image","InfowindowBasePane","_DEFAULT_TEMPLATE","click .reset","getColumnNames","_onResetClick","restoreFields","_toggleContent","InfowindowField","click .title","fieldChange","$switch","removeField","addField","toggleTitle","setFieldProperty","InfowindowFieldItem","fieldTitle","fieldModel","getAlternativeName","setAlternativeName","editInPlace","InfowindowFieldsPane","click .selectall","_setupTemplate","sortedFields","Collection","renderFields","$selectAll","renderSelectAll","_storeSortedFields","selectedAll","_allFieldsSelected","_changeSelectAll","working","_manageAll","clearFields","_unselectAll","promises","_addField","sortFields","_toggleSelectAll","_showNoContent","pos_a","pos_b","fieldCount","_reasignPositions","_getSortedColumnNames","InfowindowHTMLPane","template_error","empty_error","click .apply","template_url","_checkTemplate","_setContent","_resetContent","adjustCodeEditorSize","_setKeymap","combination","_apply","hasV2Class","occ","html_value","_getTemplateContent","alternative_names","alternative_name","_getTemplateURL","_getErrors","Template","compile","_parseErrors","error_text","_onSQLApplied","saveFields","_generateFields","_CUSTOM_TEMPLATES_PATH","_THEMES","title_tab","_renderComponents","_setupPane","_onFieldsChange","linkToInfowindow","_onChangeTemplate","_refreshHTMLEditor","themes","_setupTipsy","tipsy_options","_destroyTripsy","fields_pane","InfowindowTitlePane","_activePane","tabView","horiz_pos","$tab","LegendWidget","_setupTemplates","_getLegends","layerGroupView","getLayer","_getLegendsCount","LegendEditorCollection","LegendEditorItem","click .sync","removable","showSwitch","_onChangeTitle","_onToggleShowTitle","_onToggleSync","sync","show_switch","_addEditInPlace","_addColorForm","_onClickSync","_onClickTitle","_removeItem","filter_type","tempModel","hasURL","colorForm","legend_panes","currentLegendPane","wizardProperties","_setupLegendPane","legend_tabs","LegendFieldsPane","LegendHTMLPane","toggleFieldstooltip","changeHTMLTooltip","NoneLegend","_FILTER_NAME","_calculateItems","CustomLegend","click .add","legendItems","item_template_name","_addItem","LegendItemModel","_renderItems","titleEditor","BubbleLegend","itemTemplates","_setupSync","leftLabel","rightLabel","leftSync","rightSync","legend_type","CategoryLegend","loaded_items","categories","ChoroplethLegend","item_templates","methodMap","3 Buckets","5 Buckets","7 Buckets","nquartiles","ramp","isLeftCustom","custom_value","leftLabelValue","isRightCustom","rightLabelValue","ColorLegend","DensityLegend","IntensityLegend","wizardTypeToLegend","_setupPanes","_setupStorage","panes","activateOnClick","_onWizardChange","_onStyleChange","_saveState","_saveItems","storageKey","savedItems","_getSavedItems","_loadSavedItems","_enableLegend","enabledLegends","_getLegendType","_enableLegendFromWizard","_loadTab","old_type","_activatePane","_changeColors","_reloadActiveTab","previousWizardProperties","previousAttributes","currentType","previousType","metadataDiff","difference","_refreshTemplateCombo","currentProperty","previousProperty","equalProperty","equalMarkerFill","equalRadiusMin","equalRadiusMax","equalColorRamp","equalMethod","condition","_getPanes","_getNumericColumns","_getEnabledPanes","_renderTemplateCombo","_getCartoColors","_capitalize","_getExtraLegendNames","extraLegends","_renderPanes","_renderPane","legendClass","table_id","isString","legend_name","click .actions a.clearview","_replaceSQL","_updateSQL","_updateQueryInfo","_onSQLError","query_history_position","_defaultSQL","fetchTables","applyQuery","_checkSubmit","_toggleClearView","editor_query","keepSql","alterTable","newQuery","qualifyTables","username","tables","replace_str","BubbleWizard","error_msg","NO_CONTENT_MSG","CategoryWizard","default_color","select_column","no_valid_columns","_getMetadata","_hideLoader","_showLoader","_addViews","custom_categories","CategoriesView","Loader","comeFromColor","title_type","CategoriesViewItem","CategoryColor","_setModel","value_type","_triggerChange","_getExtraColors","ChoroplethWizard","ClusterWizard","DensityWizard","IntensityWizard","TorqueWizard","click .to_the_top","LAYER_PROPS","LAYER_ON_TOP","ONLY_ONE_TORQUE_LAYER","layer_type","validColumns","isLayerOnTop","isLayerOnTopOfDataLayers","moveToFront","torqueLayersCount","getTorqueLayer","TorqueCategoryWizard","TorqueHeatWizard","showHeatAnimationFields","setDefaults","cumulative","time_col","trails","Annotation","_bindMap","minZoomLevel","maxZoomLevel","min-zoom","max-zoom","_applyZoomLevelStyle","_hideOverlay","_showOverlay","_unbindMap","textAlign","_onMouseLeave","_belongsToCanvas","latLonToPixel","getSize","_getStyleProperty","lineColor","textOpacity","rgbaLineCol","_getRGBA","rgbaBoxCol","_setupText","icon_name","OverlaysDropdownItem","_switchToDesktop","desktopButton","mobileButton","_switchToMobile","Code","mouseleave .text","_killEvent","keyUpTimeout","savingTimeout","_putOnTop","isLink","portraitDirection","landscapeDirection","rightSticked","bottomSticked","_addDropdown","WidgetPropertiesDropdown","offset_mode","_bindDropdown","Fullscreen","click a","_onChangeY","_onMouseEnterText","_onMouseLeaveText","_toggleFullScreen","docEl","requestFullScreen","requestFullscreen","mozRequestFullScreen","webkitRequestFullScreen","msRequestFullscreen","cancelFullScreen","exitFullscreen","mozCancelFullScreen","webkitExitFullscreen","msExitFullscreen","fullscreenElement","mozFullScreenElement","webkitFullscreenElement","msFullscreenElement","_onChangeShowTitle","_onChangeShowDescription","_onChangeDescription","showTitle","showDescription","$description","hasTitle","hasDescription","image_template","_setURL","default_image_url","has_default_image","_loadImage","_onLoadSuccess","_onLoadError","OverlayPropertiesDropdown","LayerSelector","_onChangeX","_checkZoom","zoom_in","setZoom","zoom_out","_getLayers","getSubLayer","layer_names","layer_name","_createLayer","_setCount","_class","dropdown_template","animationSpeed","Logo","overlayViews","horizontal_overlays","vertical_overlays","_bindOverlays","getOverlay","_onResetOverlays","_renderOverlay","_reloadDraggable","_setupOverlay","delayed_animation","_getOverlayType","vis_overlays","_configureOverlay","_bindOverlay","_setupLoaderOverlay","_setupZoomOverlay","_setupShareOverlay","_setupHeaderOverlay","_setupSearchOverlay","_setupCartoDBLogo","_setupLayerSelectorOverlay","_setupFullScreenOverlay","_positionOverlaysHorizontally","overlay_model","_positionOverlay","move_header","_duplicate","cloneAttributes","canvas_mode","getOverlaysZIndex","_getRandomCenter","_getRandomPoint","Overlay","_copiedOverlay","_editing","xR","yR","_positionSearchOverlay","_removeOverlayPropertiesBar","_addOverlayPropertiesBar","_hideToobarOptions","overlayPropertiesBar","compareModel","deselectOverlay","show_toolbar","_showToolbarOptions","animatedRemoval","OverlayPropertiesBar","randomTime","_bindShareOverlay","_positionShareOverlay","onDestroy","_bindLoaderOverlay","_positionLoaderOverlay","_bindFullScreenOverlay","_bindLayerSelectorOverlay","_bindZoomOverlay","relative_position","_bindSearchOverlay","_bindHeaderOverlay","_getHeaderHeight","_positionHeaderOverlay","_positionZoomOverlay","_positionFullScreenOverlay","_positionLayerSelectorOverlay","hasSQLHeader","MobileLayers","layerViews","layer_count","force_hidden_title","show_layer_selector","show_legends","_onChangeLayerCount","_onChangeShowLegends","_onChangeShowLayerSelector","_reloadLayers","_getLayer","layerCount","_showTitle","_hideTitle","_addTitle","hideTitle","showLayerSelector","hideLayerSelector","toggleLegends","_renderLayer","hasLegend","showLegends","MobileLayer","hide_toggle","_getTorqueLayer","_onChangeWizardProperties","_reInitScrollpane","_removeTorque","_renderLayers","MobileHeader","click h3","_onChangeLayerName","_onChangeVisible","_reloadLegend","_getLayerName","_truncate","toggle_class","click .cartodb-attribution-button","click .toggle","click .fullscreen","click .backdrop","dblclick .aside","dragstart .aside","mousedown .aside","touchstart .aside","MSPointerDown .aside","visibility_options","_onChangeOpen","_checkOrigin","come_from_scroll","_onBackdropClick","_onAttributionClick","_open","_initScrollPane","_resetOverlays","_removeOverlays","_removeLayerSelector","_removeHeader","_removeSearch","_removeFullscreen","_renderOverlays","overlayType","_addSearch","_addLayerSelector","_addFullscreen","_addHeader","_addAttributions","$scrollpane","Search","attributions","$li","_addTorqueLayer","pos_margin","toggleTime","OverlayPropertiesActions","click .btn-copy","click .btn-delete","click .btn-zIndexInc","click .btn-zIndexDec","_onClickCopy","_onClickDelete","_onClickZIndexInc","_onClickZIndexDec","_enableTipsy","_addStyleModel","_setStyle","_addForm","_addActions","_decreaseOverlayZIndex","_increaseOverlayZIndex","original_vertical_position","_adjustPosition","map_top_offset","map_left_offset","topPosition","leftPosition","syncAbort","urlVersion","_clone","omit","Overlays","byType","_createFullScreenOverlay","_createHeaderOverlay","_createLayerSelectorOverlay","_createShareOverlay","_createSearchOverlay","_createZoomOverlay","_createLogoOverlay","_onChangeActive","placeholders","public_default_image","default_image","_isDesktop","_addOverlay","_addLogoOverlay","_getDefaultImageURL","_getPublicDefaultImageURL","_addImageOverlay","defaultStyle","z-index","public_default_image_url","_addTitleOverlay","pTop","pLeft","_addTextOverlay","_addAnnotationOverlay","_addSearchControl","searchControl","SearchControl","infowindowTemplate","infowindowOffset","_toggleDisplay","_createInfowindow","InfowindowModel","infowindowWidth","_searchInfowindow","SearchInfowindow","click .js-addPoint","click .js-addAnnotation","layerData","_setEditButtons","canAddPoint","_canAddPoint","_addPoint","geomTypes","_addAnnotation","_getAddress","Share","_addControl","control","FullScreen","Zoom","click .zoom_in","click .zoom_out","_createTooltip","RowHeaderDropdown","click .delete_row","click .add_row","tableData","setRow","deleteRow","rowIndex","RowView","classLabel","click      .row_header","mouseout   .row_header","cellRenderers","boolean","row_header","retrigger","_getRowOptions","rowOptions","getTableView","dataModel","_onOptionsOut","$relatedTarget","relatedTarget","_onOptionsClick","valueView","colName","colType","Row","_renderDefault","additionalClasses","cell","_renderBoolean","_renderNumber","_renderGeometry","geomDisplayValue","isNull","formatCoord","objValue","toggleElement","_bindSlides","_addAddButton","addSlideButton","SlideViewAdd","SlideView","_fakeSlide","_addSlideView","slideView","_initSortable","current_id","next_id","setNext","_renderFake","SlideViewFake","click .count","_setupDropdown","TransitionDropdown","_onHideDropdown","_onChangeTransitionOptions","_onDestroy","_onChangeCount","setActive","_onClickInfo","delete_confirmation","transition_method","_getTransitionMethod","transition_trigger","_onChangeLoading","click .radiobutton","formModel","isLoaded","_onChangeTransitionTrigger","_onChangeTime","_onClickRadioButton","transitionType","_selectTimeEvent","_selectOnClickEvent","Table","keypress","selectedMenu","workViewActive","get_layers","_initModels","keyBind","Visualization","vis_data","setMaster","map_data","activeSlide","enableOverlays","basemaps","catLayers","cat","baseTypes","googlemaps","GMapsBaseLayer","BaseType","tmpLayer","base_type","urlTemplate","tileSize","zoomOffset","BackgroundPollingModel","geocodingsPolling","importsPolling","_resetModel","_id","ownerName","BuilderFeaturesWarningDialog","_initTableMap","mapTab","_setWatchingNotifier","errorMsg","mdl","bgPollingView","BackgroundPollingView","createVis","Geocoding","TableTab","mamufasView","MamufasImportView","_addVideoPlayer","_onGeocodingChosen","stopPollings","startPollings","_sendGeocodingMetrics","geocodeModel","LonLatGeocodingModel","longitude_column","longitude","latitude_column","latitude","force_all_rows","GeocodingModel","addGeocodingItem","setPermissions","setReadOnly","hasWriteAccess","watchvis_notifier","WatchingNotifierModel","watchvis_notifier_view","WatchingNotifierView","keyUp","keyPress","showLoader","hideLoader","_loader","randomQuote","activeView","_test","TableRouter","pushState","prefixUrlPathname","Router","routes",":type/:id",":type/:id/",":type/:id/:scenario","changeToVis","last_route","scenario","toVis","new_id","getRelatedTables","isTable","changeToMap","changeToDataset","TableView","click .noRows","rowView","_editorsOpened","initializeBindings","initPaginationAndScroll","newPage","_finishPagination","_editCell","_checkEmptyTable","_onSQLView","_forceScroll","_swicthEnabled","topReached","bottomReached","scroll_position","_scrollMagic","SCROLL_BACK_PIXELS","checkScrollTimer","isFetchingPage","tableHeight","realPos","lastPage","_startPagination","loadPageAtBottom","pages","loadPageAtTop","_setUpPagination","needsRender","ca","changedAttributes","geometry_types","_renderHeader","newColumnName","_highlightColumn","$th","centerPosition","updown","_renderSQLHeader","cleanEmptyTableInfo","_renderBodyTemplate","isEmptyTable","addEmptySQLIfo","actual_scroll_position","_getEditor","timestamp with time zone","timestamp without time zone","editorExists","closeEditor","getRowAt","getCell","prevRow","new_value","editError","$td","$tr","headerView","addEmptyTableInfo","_renderEmpty","columnsNumber","columnsFooter","$columns","$footer","slideUp","addEmptyRow","rowSaving","rowSynched","rowFailed","rowDestroying","rowDestroyed","recreate","_createTable","hasRenderedTableView","mouseout","empty_fields","_setTemplate","_compileTemplate","_changeFields","_alternameNames","hideTimeout","_lock","_unlock","setFields","asFunction","requestAnimFrame","_INTERVAL","_FIRST_TRY","users","_checkPermissions","perm","_fetchModel","pollTimer","_removeCurrentUser","_onModelChange"],"mappings":"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O,GAAIzB,GAAIyB,EAAMhL,EAAM9K,MAAQ,OAAO,gBAAkBqU,EAAI,mBAA0B,GAALA,EAAQ,GAAK,MACxIsjD,sBAAuB,SAAUoD,GAAS,MAAO,uBAAyBA,EAAQ,SAAoB,GAATA,EAAa,GAAK,MAC/G5D,eAAgB,SAAU6D,GAAc,MAAO,2BAC/ClD,gBAAiB,WAAc,MAAO,gBACtCkB,wBAAyB,EACzBpB,mBAAoB,EACpBF,qBAAsB,EACtBr8C,GAAI,SAAUzZ,GAAK,MAAOA,GAAEyZ,IAC5BsyC,QAAS,SAASxB,EAAM17C,GACpB,MAAOA,GAAKk7B,cAAcz5B,QAAQi6C,EAAKxgB,gBAAkB,GAE7Dse,UAAW,IACXuE,mBACAkL,UAAWvL,EACXkG,aAAc,SAAUjI,GACpB,MAAIA,IAA6B,gBAAb,GACTA,EAAO91D,QAAQ,KAAM,SAEzB81D,GAEXyI,cAAc,GAIlB1sD,OAAOymD,SACHnC,OACIH,KAAMA,EACNc,MAAOA,EACPQ,KAAMA,GACPqN,MACC7S,SAAUA,EACV8D,UAAWA,GACZqM,OACC2C,SAAYpM,EACZqM,OAAUpM,EACVqM,MAASpM,MAInBpF,QCpgFF,SAAUH,GACN,GAAI4R,GACAC,EAAQ,UACRC,EAAQ,UACRj/C,EAAQ,KACVk/C,IAEA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,YAEA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,UAEA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,YAEA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,YAEA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,YAEA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,YAEA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,YAEA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,YAEA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,YAEA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,YAEA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MAC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u7D,GACCxrJ,QAAS,2ZACToT,MACC,OACA,0CACC,UACC,OACC,2EACA,6EACA,2EACD,QACA,6BACC,kCACA,kCACA,kCACA,kCACA,kCACA,kCACA,kCACA,kCACD,QACD,WACD,iBAEDyQ,MAAQ,+CACRosE,MACC,iCACC,OACC,kFACA,2GACA,2GACA,2GACA,2GACA,2GACA,2GACA,2GACD,QACA,OACC,kFACA,2GACA,2GACA,2GACA,2GACA,2GACA,2GACA,2GACD,QACA,OACC,kFACA,2GACA,2GACA,2GACA,2GACA,2GACA,2GACA,2GACD,QACA,OACC,kFACA,2GACA,2GACA,2GACA,2GACA,2GACA,2GACA,2GACD,QACA,OACC,kFACA,2GACA,2GACA,2GACA,2GACA,2GACA,2GACA,2GACD,QACA,OACC,kFACA,2GACA,2GACA,2GACA,2GACA,2GACA,2GACA,2GACD,QACD,YAEDpH,QACC,iCACC,OACC,iEACA,iEACA,iEACA,iEACD,QACA,OACC,iEACA,iEACA,iEACA,iEACD,QACA,OACC,iEACA,iEACA,kEACA,kEACD,QACD,aAGFrpF,GACCisJ,MAAM,EACNC,OAAQ,EACRj7I,KAAM,UACNb,KAAM,UACN+7I,SAAS,EACTrqJ,KAAM,SACNsqJ,KAAM,OACNC,UAAW,EACX1qE,OAAQ,QACR5nF,SAAU,SACVuyJ,UAAW,QACXC,SAAU,WAAW,UACrBC,SAAU,WAAW,OAAO,GAC5BC,OAAQ,WAAW,OAAO,GAC1BC,aAAc,WAAW,OAAO,GAChCC,OAAQ,WAAW,OAAO,GAC1B/qE,QACC6O,MAAO,SAAU,SAAU,UAAW,YAAa,WAAY,SAAU,WAAY,UACrFm8D,WAAY,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,OAC7DC,SAAU,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MACpDxjE,QAAS,UAAW,WAAY,QAAS,QAAS,MAAO,OAAQ,OAAQ,SAAU,YAAa,UAAW,WAAY,YACvHC,aAAc,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,OAC3FwjE,QAAS,OAGX/+B,EA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","file":"table.js","sourcesContent":["\n/**\n * A class to parse color values\n * @author Stoyan Stefanov <sstoo@gmail.com>\n * @link   http://www.phpied.com/rgb-color-parser-in-javascript/\n * @license Use it if you like it\n */\nfunction RGBColor(color_string)\n{\n    this.ok = false;\n\n    // strip any leading #\n    if (color_string.charAt(0) == '#') { // remove # if any\n        color_string = color_string.substr(1,6);\n    }\n\n    color_string = color_string.replace(/ /g,'');\n    color_string = color_string.toLowerCase();\n\n    // before getting into regexps, try simple matches\n    // and overwrite the input\n    var simple_colors = {\n        aliceblue: 'f0f8ff',\n        antiquewhite: 'faebd7',\n        aqua: '00ffff',\n        aquamarine: '7fffd4',\n        azure: 'f0ffff',\n        beige: 'f5f5dc',\n        bisque: 'ffe4c4',\n        black: '000000',\n        blanchedalmond: 'ffebcd',\n        blue: '0000ff',\n        blueviolet: '8a2be2',\n        brown: 'a52a2a',\n        burlywood: 'deb887',\n        cadetblue: '5f9ea0',\n        chartreuse: '7fff00',\n        chocolate: 'd2691e',\n        coral: 'ff7f50',\n        cornflowerblue: '6495ed',\n        cornsilk: 'fff8dc',\n        crimson: 'dc143c',\n        cyan: '00ffff',\n        darkblue: '00008b',\n        darkcyan: '008b8b',\n        darkgoldenrod: 'b8860b',\n        darkgray: 'a9a9a9',\n        darkgreen: '006400',\n        darkkhaki: 'bdb76b',\n        darkmagenta: '8b008b',\n        darkolivegreen: '556b2f',\n        darkorange: 'ff8c00',\n        darkorchid: '9932cc',\n        darkred: '8b0000',\n        darksalmon: 'e9967a',\n        darkseagreen: '8fbc8f',\n        darkslateblue: '483d8b',\n        darkslategray: '2f4f4f',\n        darkturquoise: '00ced1',\n        darkviolet: '9400d3',\n        deeppink: 'ff1493',\n        deepskyblue: '00bfff',\n        dimgray: '696969',\n        dodgerblue: '1e90ff',\n        feldspar: 'd19275',\n        firebrick: 'b22222',\n        floralwhite: 'fffaf0',\n        forestgreen: '228b22',\n        fuchsia: 'ff00ff',\n        gainsboro: 'dcdcdc',\n        ghostwhite: 'f8f8ff',\n        gold: 'ffd700',\n        goldenrod: 'daa520',\n        gray: '808080',\n        green: '008000',\n        greenyellow: 'adff2f',\n        honeydew: 'f0fff0',\n        hotpink: 'ff69b4',\n        indianred : 'cd5c5c',\n        indigo : '4b0082',\n        ivory: 'fffff0',\n        khaki: 'f0e68c',\n        lavender: 'e6e6fa',\n        lavenderblush: 'fff0f5',\n        lawngreen: '7cfc00',\n        lemonchiffon: 'fffacd',\n        lightblue: 'add8e6',\n        lightcoral: 'f08080',\n        lightcyan: 'e0ffff',\n        lightgoldenrodyellow: 'fafad2',\n        lightgrey: 'd3d3d3',\n        lightgreen: '90ee90',\n        lightpink: 'ffb6c1',\n        lightsalmon: 'ffa07a',\n        lightseagreen: '20b2aa',\n        lightskyblue: '87cefa',\n        lightslateblue: '8470ff',\n        lightslategray: '778899',\n        lightsteelblue: 'b0c4de',\n        lightyellow: 'ffffe0',\n        lime: '00ff00',\n        limegreen: '32cd32',\n        linen: 'faf0e6',\n        magenta: 'ff00ff',\n        maroon: '800000',\n        mediumaquamarine: '66cdaa',\n        mediumblue: '0000cd',\n        mediumorchid: 'ba55d3',\n        mediumpurple: '9370d8',\n        mediumseagreen: '3cb371',\n        mediumslateblue: '7b68ee',\n        mediumspringgreen: '00fa9a',\n        mediumturquoise: '48d1cc',\n        mediumvioletred: 'c71585',\n        midnightblue: '191970',\n        mintcream: 'f5fffa',\n        mistyrose: 'ffe4e1',\n        moccasin: 'ffe4b5',\n        navajowhite: 'ffdead',\n        navy: '000080',\n        oldlace: 'fdf5e6',\n        olive: '808000',\n        olivedrab: '6b8e23',\n        orange: 'ffa500',\n        orangered: 'ff4500',\n        orchid: 'da70d6',\n        palegoldenrod: 'eee8aa',\n        palegreen: '98fb98',\n        paleturquoise: 'afeeee',\n        palevioletred: 'd87093',\n        papayawhip: 'ffefd5',\n        peachpuff: 'ffdab9',\n        peru: 'cd853f',\n        pink: 'ffc0cb',\n        plum: 'dda0dd',\n        powderblue: 'b0e0e6',\n        purple: '800080',\n        red: 'ff0000',\n        rosybrown: 'bc8f8f',\n        royalblue: '4169e1',\n        saddlebrown: '8b4513',\n        salmon: 'fa8072',\n        sandybrown: 'f4a460',\n        seagreen: '2e8b57',\n        seashell: 'fff5ee',\n        sienna: 'a0522d',\n        silver: 'c0c0c0',\n        skyblue: '87ceeb',\n        slateblue: '6a5acd',\n        slategray: '708090',\n        snow: 'fffafa',\n        springgreen: '00ff7f',\n        steelblue: '4682b4',\n        tan: 'd2b48c',\n        teal: '008080',\n        thistle: 'd8bfd8',\n        tomato: 'ff6347',\n        turquoise: '40e0d0',\n        violet: 'ee82ee',\n        violetred: 'd02090',\n        wheat: 'f5deb3',\n        white: 'ffffff',\n        whitesmoke: 'f5f5f5',\n        yellow: 'ffff00',\n        yellowgreen: '9acd32'\n    };\n    for (var key in simple_colors) {\n        if (color_string == key) {\n            color_string = simple_colors[key];\n        }\n    }\n    // emd of simple type-in colors\n\n    // array of color definition objects\n    var color_defs = [\n        {\n            re: /^rgb\\((\\d{1,3}),\\s*(\\d{1,3}),\\s*(\\d{1,3})\\)$/,\n            example: ['rgb(123, 234, 45)', 'rgb(255,234,245)'],\n            process: function (bits){\n                return [\n                    parseInt(bits[1]),\n                    parseInt(bits[2]),\n                    parseInt(bits[3])\n                ];\n            }\n        },\n        {\n            re: /^(\\w{2})(\\w{2})(\\w{2})$/,\n            example: ['#00ff00', '336699'],\n            process: function (bits){\n                return [\n                    parseInt(bits[1], 16),\n                    parseInt(bits[2], 16),\n                    parseInt(bits[3], 16)\n                ];\n            }\n        },\n        {\n            re: /^(\\w{1})(\\w{1})(\\w{1})$/,\n            example: ['#fb0', 'f0f'],\n            process: function (bits){\n                return [\n                    parseInt(bits[1] + bits[1], 16),\n                    parseInt(bits[2] + bits[2], 16),\n                    parseInt(bits[3] + bits[3], 16)\n                ];\n            }\n        }\n    ];\n\n    // search through the definitions to find a match\n    for (var i = 0; i < color_defs.length; i++) {\n        var re = color_defs[i].re;\n        var processor = color_defs[i].process;\n        var bits = re.exec(color_string);\n        if (bits) {\n            channels = processor(bits);\n            this.r = channels[0];\n            this.g = channels[1];\n            this.b = channels[2];\n            this.ok = true;\n        }\n\n    }\n\n    // validate/cleanup values\n    this.r = (this.r < 0 || isNaN(this.r)) ? 0 : ((this.r > 255) ? 255 : this.r);\n    this.g = (this.g < 0 || isNaN(this.g)) ? 0 : ((this.g > 255) ? 255 : this.g);\n    this.b = (this.b < 0 || isNaN(this.b)) ? 0 : ((this.b > 255) ? 255 : this.b);\n\n    // some getters\n    this.toRGB = function () {\n        return 'rgb(' + this.r + ', ' + this.g + ', ' + this.b + ')';\n    }\n    this.toHex = function () {\n        var r = this.r.toString(16);\n        var g = this.g.toString(16);\n        var b = this.b.toString(16);\n        if (r.length == 1) r = '0' + r;\n        if (g.length == 1) g = '0' + g;\n        if (b.length == 1) b = '0' + b;\n        return '#' + r + g + b;\n    }\n\n    // help\n    this.getHelpXML = function () {\n\n        var examples = new Array();\n        // add regexps\n        for (var i = 0; i < color_defs.length; i++) {\n            var example = color_defs[i].example;\n            for (var j = 0; j < example.length; j++) {\n                examples[examples.length] = example[j];\n            }\n        }\n        // add type-in colors\n        for (var sc in simple_colors) {\n            examples[examples.length] = sc;\n        }\n\n        var xml = document.createElement('ul');\n        xml.setAttribute('id', 'rgbcolor-examples');\n        for (var i = 0; i < examples.length; i++) {\n            try {\n                var list_item = document.createElement('li');\n                var list_color = new RGBColor(examples[i]);\n                var example_div = document.createElement('div');\n                example_div.style.cssText =\n                        'margin: 3px; '\n                        + 'border: 1px solid black; '\n                        + 'background:' + list_color.toHex() + '; '\n                        + 'color:' + list_color.toHex()\n                ;\n                example_div.appendChild(document.createTextNode('test'));\n                var list_item_value = document.createTextNode(\n                    ' ' + examples[i] + ' -> ' + list_color.toRGB() + ' -> ' + list_color.toHex()\n                );\n                list_item.appendChild(example_div);\n                list_item.appendChild(list_item_value);\n                xml.appendChild(list_item);\n\n            } catch(e){}\n        }\n        return xml;\n\n    }\n\n}\n","\n/**\n * enables a catch all for clicks to send singal in godbus to close all dialogs\n */\n\nfunction enableClickOut(el) {\n  el.click(function() {\n    cdb.god.trigger(\"closeDialogs\");\n  });\n}\n","/*\n ===========================================\n generic tool for polygon drawing over google maps map\n ===========================================\n\n*/\n\nif (typeof(google) !== 'undefined') {\n\nfunction MarkerGMaps() {\n  var opts = arguments[0]\n  if(opts.position) {\n    opts.position = new google.maps.LatLng(opts.position[0], opts.position[1]);\n  }\n  google.maps.Marker.apply(this, arguments);\n}\n\n_.extend(MarkerGMaps.prototype,\n  google.maps.Marker.prototype, {\n    bind: function(ev, callback) {\n      google.maps.event.addListener(this, ev, function(e) {\n        e._latlng = [e.latLng.lat(), e.latLng.lng()];\n        callback(e)\n      });\n    },\n    geojson: function() {\n      return cdb.geo.gmaps.PathView.getGeoJSON(this, 'Point');\n    }\n  }\n\n);\n\n\nfunction PolygonGMaps() {\n  google.maps.Polygon.apply(this, arguments);\n}\n\n\nvar gmapsPolyPrototype =  {\n  bind: function(ev, callback) {\n    google.maps.event.addListener(this, ev, function(e) {\n      e._latlng = [e.latlng.lat, e.latlng.lng];\n      callback(e)\n    });\n  },\n  setPath: function(points) {\n    google.maps.Polygon.prototype.setPath.call(this, _(points).map(function(p) {\n      return new google.maps.LatLng(p[0], p[1]);\n    })\n    );\n  },\n  setVertex: function(index, latlng) {\n    this.getPath().setAt(index, new google.maps.LatLng(latlng[0], latlng[1]));\n  }\n}\n_.extend(PolygonGMaps.prototype,\n  google.maps.Polygon.prototype, \n  gmapsPolyPrototype, {\n    geojson: function() {\n      return cdb.geo.gmaps.PathView.getGeoJSON(this, 'MultiPolygon');\n    }\n  }\n);\n\n\nfunction PolylineGMaps() { \n  google.maps.Polyline.apply(this, arguments); \n}\n_.extend(PolylineGMaps.prototype,\n  google.maps.Polyline.prototype, \n  gmapsPolyPrototype, {\n    geojson: function() {\n      return cdb.geo.gmaps.PathView.getGeoJSON(this, 'MultiLineString');\n    }\n  }\n);\n}\n\n\nvar MarkerLeaflet = L.Marker.extend({\n\n  initialize: function(opts) {\n    if(opts.icon) {\n      opts.icon = L.icon({\n        iconUrl: opts.icon.url,\n        iconAnchor: [opts.icon.anchor.x, opts.icon.anchor.y]\n      })\n    }\n    if(opts.position) {\n      opts.position = new L.LatLng(opts.position[0], opts.position[1]);\n    }\n    var args = [opts.position].concat(Array.prototype.slice.call(arguments));\n    L.Marker.prototype.initialize.apply(this, args);\n    var opts = arguments[0] || {}\n    if(opts.map) {\n      this.map = opts.map;\n      this.addTo(opts.map);\n    }\n  },\n\n  bind: function(ev, callback) {\n   var self = this;\n   this.on(ev, function(e) {\n     e._latlng = [self.getLatLng().lat,  self.getLatLng().lng];\n     callback(e);\n   });\n  },\n\n  setMap: function(map) {\n    if(map) {\n      this.addTo(map);\n    } else {\n      this.map.removeLayer(this);\n    }\n  },\n\n  geojson: function() {\n    return this.toGeoJSON().geometry;\n  }\n\n});\n\n\n/** polygon and polyline shares prototype */\nvar PathPrototype = {\n  initialize: function() {\n    this._parent.prototype.initialize.apply(this, arguments);\n    var opts = arguments[0] || {}\n    if(opts.map) {\n      this.map = opts.map;\n      this.addTo(opts.map);\n    }\n    opts.stroke = opts.strokeOpacity > 0;\n    opts.color = opts.strokeColor;\n    opts.fill = opts.fillOpacity > 0;\n    opts.weight = opts.strokeWeight;\n    opts.opacity = opts.strokeOpacity;\n\n    this.setStyle(opts);\n  },\n\n  bind: function(ev, callback) {\n   this.on(ev, function(e) {\n     e.latLng = e.latlng;\n     callback(e);\n   });\n  },\n\n  setVertex: function(index, latlng) {\n    var ll = this.getLatLngs();\n    ll[index] =  new L.LatLng(latlng[0], latlng[1]);\n    this.setLatLngs(ll);\n  },\n\n  setPath: function(points) {\n    var ll = _(points).map(function(p) {\n      return new L.LatLng(p[0], p[1]);\n    });\n    this.setLatLngs(ll);\n  },\n\n  setMap: function(map) {\n    if(map) {\n      this.addTo(map);\n    } else {\n      this.map.removeLayer(this);\n    }\n  }\n\n};\n\nvar PolygonLeaflet = L.Polygon.extend(PathPrototype).extend({\n  _parent: L.Polygon,\n  geojson: function() {\n    // transform to multipolygon\n    var geo = this.toGeoJSON().geometry;\n    return {\n      type: 'MultiPolygon',\n      coordinates: [geo.coordinates]\n    };\n  }\n});\n\nvar PolylineLeaflet = L.Polyline.extend(PathPrototype).extend({\n  _parent: L.Polyline,\n  geojson: function() {\n    // transform to multipolygon\n    var geo = this.toGeoJSON().geometry;\n    return {\n      type: 'MultiLineString',\n      coordinates: [geo.coordinates]\n    };\n  }\n});\n\n\nvar BaseDrawTool = cdb.core.View.extend({\n\n  image:  {\n    url: cdb.config.get('assets_url') + '/images/layout/edit_marker_icon.png',\n    anchor: {x: 5, y: 5}\n  },\n\n  _setObjects: function() {\n    if(this.mapview.map.get('provider') == 'googlemaps') {\n      this.Marker = MarkerGMaps;\n      this.Polygon = PolygonGMaps;\n      this.Polyline = PolylineGMaps;\n    } else {\n      this.Marker = MarkerLeaflet;\n      this.Polygon = PolygonLeaflet;\n      this.Polyline = PolylineLeaflet;\n    }\n  }\n\n\n});\n\nvar PointDrawTool = BaseDrawTool.extend({\n\n  image:  {\n    url: cdb.config.get('assets_url') + '/images/layout/default_marker.png',\n    anchor: {x: 11, y: 11}\n  },\n\n  initialize: function() {\n    this.mapview = this.options.mapview;\n    this.map = this.mapview.getNativeMap();\n    this.marker = null;\n    this._setObjects();\n\n  },\n\n  canFinish: function() {\n    return this.marker != null;\n  },\n\n  start: function() {\n    this.mapview.bind('click', function(e, latlng) {\n      this.marker = new this.Marker({\n        position: latlng,\n        map: this.map,\n        icon: this.image,\n        draggable: true,\n        flat : true,\n        raiseOnDrag: false\n      });\n      this.mapview.unbind('click', null, this);\n    }, this);\n  },\n\n  clean: function() {\n    this.marker && this.marker.setMap(null);\n    this.mapview.unbind('click', null, this);\n  },\n\n  getGeoJSON: function() {\n    return this.marker.geojson();\n  }\n\n});\n\n\nvar PolygonDrawTool = BaseDrawTool.extend({\n\n    initialize: function() {\n        _.bindAll(this, 'add_vertex', '_add_vertex');\n        this.mapview = this.options.mapview;\n        this.map = this.mapview.getNativeMap();\n\n        this._setObjects();\n        this.reset();\n\n    },\n\n    canFinish: function() {\n      return this.vertex.length >= 3;\n    },\n\n    start: function() {\n      this.mapview.unbind('click', this.add_vertex);\n      this.mapview.bind('click', this.add_vertex);\n      this.reset();\n    },\n\n\n    reset: function() {\n        var self = this;\n        if(this.feature !== undefined) {\n            this.feature.setMap(null);\n            delete this.feature;\n        }\n        if(this.markers !== undefined) {\n            _.each(this.markers, function(m) {\n                m.setMap(null);\n            });\n        }\n        this.markers = [];\n        this.vertex = [];\n        this.createOverlays();\n\n    },\n\n    createOverlays: function() {\n      this.feature = new this.Polygon({\n        path:[],\n        fillColor: \"white\",\n        fillOpacity: 0.4,\n        strokeOpacity: 1.0,\n        strokeColor: '#397DBA',\n        strokeWeight: 4,\n        clickable: false,\n        map: this.map\n      });\n    },\n\n    clean: function() {\n      this.reset();\n      this.mapview.unbind('click', this.add_vertex);\n      this.feature.setMap(null);\n      delete this.feature;\n    },\n\n    _add_vertex: function(latLng) {\n        var marker = new this.Marker({\n          position: latLng,\n          map: this.map,\n          icon: this.image,\n          draggable: true,\n          flat : true,\n          raiseOnDrag: false\n        });\n\n        marker.index = this.vertex.length;\n        this.markers.push(marker);\n        this.vertex.push(latLng);\n        this.feature.setPath(this.vertex);\n        return marker;\n    },\n\n    add_vertex: function(e, latLng) {\n        var marker = this._add_vertex(latLng);\n        marker.bind(\"drag\", function(e) {\n          self.mapview.unbind('click', self.add_vertex);\n          self.vertex[marker.index] = e._latlng;\n          self.feature.setVertex(marker.index, e._latlng);\n        });\n        marker.bind(\"dragend\", function(e) {\n          self.feature.setVertex(marker.index, e._latlng);\n          self.vertex[marker.index] = e._latlng;\n          _.defer(function() {\n            self.mapview.bind('click', self.add_vertex);\n          });\n        });\n        var self = this;\n    },\n\n    getGeoJSON: function() {\n      return this.feature.geojson();\n    }\n\n});\n\nvar PolylineDrawTool = PolygonDrawTool.extend({\n\n    createOverlays: function() {\n      // not shown\n      this.feature = new this.Polyline({\n        path:[],\n        strokeOpacity: 1.0,\n        strokeColor: '#397DBA',\n        strokeWeight: 4,\n        fillOpacity: 0.0,\n        clickable: false,\n        map: this.map\n      });\n    },\n\n    canFinish: function() {\n      return this.vertex.length >= 2;\n    },\n});\n\n","/**\n * map tab shown in cartodb admin\n */\n\n/**\n * inside the UI all the cartodb layers should be shown merged.\n * the problem is that the editor needs the layers separated to work\n * with them so this class transform from multiple cartodb layers\n * and create only a view to represent all merged in a single layer group\n */\nfunction GrouperLayerMapView(mapViewClass) {\n\n  return {\n\n    initialize: function() {\n      this.groupLayer = null;\n      this.activeLayerModel = null;\n      mapViewClass.prototype.initialize.call(this);\n    },\n\n    _removeLayers: function() {\n      var self = this;\n      _.each(this.map.layers.getLayersByType('CartoDB'), function(layer) {\n        layer.unbind(null, null, self);\n      });\n      cdb.geo.MapView.prototype._removeLayers.call(this);\n\n      if(this.groupLayer) {\n        this.groupLayer.model.unbind();\n      }\n      this.groupLayer = null;\n    },\n\n    _removeLayer: function(layer) {\n      // if the layer is in layergroup\n      if(layer.cid in this.layers) {\n        if(this.layers[layer.cid] === this.groupLayer) {\n          this._updateLayerDefinition(layer);\n          layer.unbind(null, null, this);\n          delete this.layers[layer.cid];\n          this.trigger('removeLayerView', this);\n        } else {\n          this.trigger('removeLayerView', this);\n          cdb.geo.MapView.prototype._removeLayer.call(this, layer);\n        }\n      } else {\n        cdb.log.info(\"removing non existing layer\");\n      }\n    },\n\n    setActiveLayer: function(layer) {\n      this.activeLayerModel = layer;\n      this._setInteraction();\n    },\n\n    disableInteraction: function() {\n      if (this.groupLayer) {\n        this.groupLayer._clearInteraction();\n      }\n    },\n\n    enableInteraction: function() {\n      this._setInteraction();\n    },\n\n    // set interaction only for the active layer\n    _setInteraction: function() {\n      if(!this.groupLayer) return;\n      if(this.activeLayerModel) {\n        this.groupLayer._clearInteraction();\n        var idx = this.map.layers.getLayerDefIndex(this.activeLayerModel);\n        // when layer is not found idx == -1 so the interaction is\n        // disabled for all the layers\n        for(var i = 0; i < this.groupLayer.getLayerCount(); ++i) {\n          this.groupLayer.setInteraction(i, i == idx);\n        }\n      }\n    },\n\n    _updateLayerDefinition: function(layer) {\n      if(!layer) throw \"layer must be a valid layer (not null)\";\n      if(this.groupLayer) {\n        if(this.map.layers.getLayersByType('CartoDB').length === 0) {\n          this.groupLayer.remove();\n          this.groupLayer = null;\n        } else {\n          var def = this.map.layers.getLayerDef();\n          this.groupLayer.setLayerDefinition(def);\n          this._setInteraction();\n        }\n      }\n    },\n\n    /**\n     * when merged layers raises an error this function send the error to the\n     * layer that actually caused it\n     */\n    _routeErrors: function(errors) {\n      var styleRegExp = /style(\\d+)/;\n      var postgresExp = /layer(\\d+):/i;\n      var generalPostgresExp = /PSQL error/i;\n      var syntaxErrorExp = /syntax error/i;\n      var webMercatorErrorExp = /\"the_geom_webmercator\" does not exist/i;\n      var tilerError = /Error:/i;\n      var layers = this.map.layers.where({ visible: true, type: 'CartoDB' });\n      for(var i in errors) {\n        var err = errors[i];\n        // filter empty errors\n        if(err && err.length) {\n          var match = styleRegExp.exec(err);\n          if(match) {\n            var layerIndex = parseInt(match[1], 10);\n            layers[layerIndex].trigger('parseError', [err]);\n          } else {\n            var match = postgresExp.exec(err);\n            if(match) {\n              var layerIndex = parseInt(match[1], 10);\n              if (webMercatorErrorExp.exec(err)) {\n                err = _t(\"you should select the_geom_webmercator column\");\n                layers[layerIndex].trigger('sqlNoMercator', [err]);\n              } else {\n                layers[layerIndex].trigger('sqlParseError', [err]);\n              }\n            } else if(generalPostgresExp.exec(err) || syntaxErrorExp.exec(err) || tilerError.exec(err)) {\n              var error = 'sqlError';\n              if (webMercatorErrorExp.exec(err)) {\n                error = 'sqlNoMercator';\n                err = _t(\"you should select the_geom_webmercator column\");\n              }\n              _.each(layers, function(lyr) { lyr.trigger(error, err); });\n            } else {\n              _.each(layers, function(lyr) { lyr.trigger('error', err); });\n            }\n          }\n        }\n      }\n    },\n\n    _routeSignal: function(signal) {\n      var self = this;\n      return function() {\n        var layers = self.map.layers.where({ visible: true, type: 'CartoDB' });\n        var args = [signal].concat(arguments);\n        _.each(layers, function(lyr) { lyr.trigger.apply(lyr, args); });\n      }\n    },\n\n    _addLayer: function(layer, layers, opts) {\n\n      // create group layer to acumulate cartodb layers\n      if (layer.get('type') === 'CartoDB') {\n        var self = this;\n        if(!this.groupLayer) {\n          // create model\n          var m = new cdb.geo.CartoDBGroupLayer(\n            _.extend(layer.toLayerGroup(), {\n              user_name: this.options.user.get(\"username\"),\n              maps_api_template: cdb.config.get('maps_api_template'),\n              no_cdn: false,\n              force_cors: true // use CORS to control error management in a better way\n            })\n          );\n\n          var layer_view = mapViewClass.prototype._addLayer.call(this, m, layers, _.extend({}, opts, { silent: true }));\n          delete this.layers[m.cid];\n          this.layers[layer.cid] = layer_view;\n          this.groupLayer = layer_view;\n          m.bind('error', this._routeErrors, this);\n          m.bind('tileOk', this._routeSignal('tileOk'), this);\n          this.trigger('newLayerView', layer_view, layer, this);\n        } else {\n          this.layers[layer.cid] = this.groupLayer;\n          this._updateLayerDefinition(layer);\n          this.trigger('newLayerView', this.groupLayer, layer, this);\n        }\n\n        layer.bind('change:tile_style change:query change:query_wrapper change:interactivity change:visible', this._updateLayerDefinition, this);\n        this._addLayerToMap(this.groupLayer);\n        delete this.layers[this.groupLayer.model.cid];\n      } else {\n        mapViewClass.prototype._addLayer.call(this, layer, layers, opts);\n      }\n    }\n  }\n};\n\ncdb.admin.LeafletMapView = cdb.geo.LeafletMapView.extend(GrouperLayerMapView(cdb.geo.LeafletMapView));\n\nif (typeof(google) !== 'undefined') {\n  cdb.admin.GoogleMapsMapView = cdb.geo.GoogleMapsMapView.extend(GrouperLayerMapView(cdb.geo.GoogleMapsMapView));\n}\n\ncdb.admin.MapTab = cdb.core.View.extend({\n\n  events: {\n    'click .toggle_slides.button': '_toggleSlides',\n    'click .add_overlay.button':   'killEvent',\n    'click .canvas_setup.button':  'killEvent',\n    'click .export_image.button':  '_exportImage',\n    'click .sqlview .clearview':   '_clearView',\n    'click .sqlview .export_query':'_tableFromQuery',\n    'keydown':'_onKeyDown'\n  },\n\n  _TEXTS: {\n    no_interaction_warn: _t(\"Map interaction is disabled, select cartodb_id to enable it\")\n  },\n\n  className: 'map',\n  animation_time: 300,\n\n  initialize: function() {\n\n    this.template = this.getTemplate('table/views/maptab');\n\n    this.map  = this.model;\n    this.user = this.options.user;\n    this.vis  = this.options.vis;\n    this.master_vis  = this.options.master_vis;\n\n    this.canvas  = new cdb.core.Model({ mode: \"desktop\" });\n\n    this.map_enabled     = false;\n    this.georeferenced   = false;\n    this.featureHovered  = null;\n    this.activeLayerView = null;\n    this.layerDataView   = null;\n    this.layerModel      = null;\n    this.legends         = [];\n    this.overlays        = null;\n\n    this.add_related_model(this.map);\n    this.add_related_model(this.canvas);\n    this.add_related_model(this.map.layers);\n\n    this._addBindings();\n\n  },\n\n  _addBindings: function() {\n\n    // Actions triggered in the right panel\n    cdb.god.bind(\"panel_action\", function(action) {\n      this._moveInfo(action);\n    }, this);\n\n    this.add_related_model(cdb.god);\n\n    this.map.bind('change:provider',       this.switchMapType, this);\n    this.map.bind('change:legends',        this._toggleLegends, this);\n    this.map.layers.bind('change:visible', this._addLegends, this);\n    this.map.layers.bind('change:visible', this._addTimeline, this);\n    this.map.layers.bind('change:tile_style', this._addTimeline, this);\n    this.map.layers.bind('remove reset',   this._addLegends, this);\n    this.map.layers.bind('remove reset',   this._addTimeline, this);\n\n    _.bindAll(this, 'showNoGeoRefWarning', \"_exportImage\");\n\n  },\n\n  isMapEnabled: function() {\n    return this.map_enabled;\n  },\n\n  deactivated: function() {\n    if(this.map_enabled) {\n      this.clearMap();\n    }\n  },\n\n  clearMap: function() {\n\n    clearTimeout(this.autoSaveBoundsTimer);\n\n    this.mapView.clean();\n\n    if (this.exportImageView) {\n      this.exportImageView.clean();\n      this.exportImageView = null;\n    }\n\n    if (this.overlaysDropdown)        this.overlaysDropdown.clean();\n    if (this.mapOptionsDropdown)      this.mapOptionsDropdown.clean();\n    if (this.basemapDropdown)         this.basemapDropdown.clean();\n    if (this.configureCanvasDropdown) this.configureCanvasDropdown.clean();\n\n    if (this.zoom) {\n      this.zoom.clean();\n    }\n\n    if (this.infowindow) {\n      this.infowindow.clean();\n    }\n\n    if (this.overlays) {\n      this.overlays._cleanOverlays();\n    }\n\n    this._cleanLegends();\n\n    if (this.stackedLegend) {\n      this.stackedLegend.clean();\n    }\n\n    if (this.timeline) {\n      this.timeline.clean();\n      this.timeline = null;\n    }\n\n    if (this.geometryEditor) this.geometryEditor.clean();\n\n    if (this.table) {\n      this.table.unbind(null, null, this);\n    }\n\n    delete this.mapView;\n    delete this.overlaysDropdown;\n    delete this.basemapDropdown;\n    delete this.mapOptionsDropdown;\n    delete this.configureCanvasDropdown;\n\n    delete this.zoom;\n    delete this.infowindow;\n    delete this.layer_selector;\n    delete this.header;\n    delete this.share;\n    delete this.legends;\n    delete this.overlays;\n    delete this.legend;\n    delete this.stackedLegend;\n    delete this.geometryEditor;\n\n    this.map_enabled = false;\n\n    // place the map DOM object again\n    this.render();\n  },\n\n\n  /**\n   *  Hide the infowindow when a query is applied or cleared\n   */\n  _hideInfowindow: function() {\n    if(this.infowindow) {\n      this.infowindow.model.set('visibility', false);\n    }\n  },\n\n\n  /**\n   * this function is used when the map library is changed. Each map library\n   * works in different way and need to recreate all the components again\n   */\n  switchMapType: function() {\n\n    if (this.map_enabled) {\n      this.clearMap();\n      this.enableMap();\n    }\n\n  },\n\n  _showGMapsDeprecationDialog: function() {\n    var dialog = cdb.editor.ViewFactory.createDialogByTemplate('common/dialogs/confirm_gmaps_basemap_to_leaflet_conversion');\n\n    var self = this;\n    dialog.ok = function() {\n      self.map.set('provider', 'leaflet', { silent: true });\n      self.setupMap();\n      this.close && this.close();\n    };\n\n    dialog.cancel = function() {\n      if (self.user.isInsideOrg()) {\n        window.location = \"/u/\" + self.user.get(\"username\") + \"/dashboard\";\n      } else {\n        window.location = \"/dashboard\";\n      }\n    };\n\n    dialog.appendToBody();\n  },\n\n  /**\n   * map can't be loaded from the beggining, it needs the DOM to be loaded\n   * so we wait until is actually shown to create the mapview and show it\n   */\n  enableMap: function() {\n\n    this.render();\n\n    var baseLayer = this.map.getBaseLayer();\n\n    // check if this user has google maps enabled. In case not and the provider is google maps\n    // show a message\n    if ( typeof cdb.admin.GoogleMapsMapView === 'undefined') {\n      if (baseLayer && this.map.isProviderGmaps()) {\n        this._showGMapsDeprecationDialog();\n        return;\n      }\n    }\n\n    this.setupMap();\n\n  },\n\n  setupMap: function() {\n\n    this.$('.tipsy').remove();\n\n    var self = this;\n\n    if (!this.map_enabled) {\n\n      this._addMapView();\n\n      this.clickTimeout = null;\n\n      this._bindMissingClickEvents();\n\n      this.map_enabled = true;\n\n      $(\".map\")\n      .append('<div class=\"map-options\" />')\n      .append(\"<div class='mobile_bkg' />\");\n\n      this._addBasemapDropdown();\n      this._addInfowindow();\n      this._addTooltip();\n      this._addLegends();\n      this._addOverlays();\n\n      this._showPecan();\n\n      this._showScratchDialog();\n\n      if (this.user.featureEnabled('slides')) {\n        this._addSlides();\n      };\n\n      var torqueLayer;\n\n      var type = this.vis.get(\"type\");\n\n      if (type !== \"table\") {\n\n        this._addOverlaysDropdown();\n        this._addConfigureCanvasDropdown();\n        this._addMapOptionsDropdown();\n\n        this.canvas.on(\"change:mode\", this._onChangeCanvasMode, this);\n\n      }\n\n      this.master_vis.on(\"change:type\", function() {\n        if (this.master_vis.previous('type') === 'table') {\n          // reaload the map to show overlays and other visualization related stuff\n          this.switchMapType();\n        }\n      }, this);\n\n      // HACK\n      // wait a little bit to give time to the mapview\n      // to estabilize\n      this.autoSaveBoundsTimer = setTimeout(function() {\n        //self.mapView.setAutoSaveBounds();\n        self.mapView.on('dragend zoomend', function() {\n          self.mapView._saveLocation();\n        });\n      }, 1000);\n\n    }\n\n  },\n\n  _addMapView: function() {\n\n    var div = this.$('.cartodb-map');\n\n    var mapViewClass = cdb.admin.LeafletMapView;\n    if (this.map.get('provider') === 'googlemaps') {\n      var mapViewClass = cdb.admin.GoogleMapsMapView;\n    }\n\n    this.mapView = new mapViewClass({\n      el: div,\n      map: this.map,\n      user: this.user\n    });\n\n    this.mapView.bind('removeLayerView', function(layerView) {\n      if (this.layer_selector) this.layer_selector.render();\n    }, this);\n\n    this.mapView.bind('newLayerView', function(layerView, model) {\n      if(this.activeLayerView && this.activeLayerView.model.id === model.id) {\n        this._bindDataLayer(this.activeLayerView, model);\n\n        if (this.layer_selector) {\n          this.layer_selector.render();\n        }\n      }\n      this._addTimeline();\n    }, this);\n\n    if (this.activeLayerView) {\n      this._bindDataLayer(this.activeLayerView, this.activeLayerView.model);\n    }\n\n  },\n\n  _addConfigureCanvasDropdown: function() {\n    if (!this.configureCanvasDropdown) {\n      this.configureCanvasDropdown = new cdb.admin.ConfigureCanvasDropdown({\n        target: $('.canvas_setup'),\n        position: \"position\",\n        canvas: this.canvas,\n        template_base: \"table/views/canvas_setup_dropdown\",\n        tick: \"left\",\n        horizontal_position: \"left\",\n        horizontal_offset: \"40px\"\n      });\n\n      this.addView(this.configureCanvasDropdown);\n\n      this.configureCanvasDropdown.bind(\"onDropdownShown\", function(){\n        this.exportImageView && this.exportImageView.hide();\n      }, this);\n\n      cdb.god.bind(\"closeDialogs\", this.configureCanvasDropdown.hide, this.configureCanvasDropdown);\n      $(\".canvas_setup\").append(this.configureCanvasDropdown.render().el);\n    }\n  },\n\n  _addOverlaysDropdown: function() {\n\n    if (!this.overlaysDropdown) {\n\n      this.overlaysDropdown = new cdb.admin.OverlaysDropdown({\n        vis: this.master_vis,\n        canvas: this.canvas,\n        mapView: this.mapView,\n        target: $('.add_overlay'),\n        position: \"position\",\n        collection: this.vis.overlays,\n        template_base: \"table/views/widget_dropdown\",\n        tick: \"left\",\n        horizontal_position: \"left\",\n        horizontal_offset: \"40px\"\n      });\n\n      this.addView(this.overlaysDropdown);\n\n      this.overlaysDropdown.bind(\"onOverlayDropdownOpen\", function(){\n        this.slidesPanel && this.slidesPanel.hide();\n        this.exportImageView && this.exportImageView.hide();\n      }, this);\n\n\n      cdb.god.bind(\"closeDialogs\", this.overlaysDropdown.hide, this.overlaysDropdown);\n      cdb.god.bind(\"closeOverlayDropdown\", this.overlaysDropdown.hide, this.overlaysDropdown);\n\n      $(\".add_overlay\").append(this.overlaysDropdown.render().el);\n    }\n\n  },\n\n  _addBasemapDropdown: function() {\n\n    if (!this.basemapDropdown) {\n\n      if (this.vis.get(\"type\") !== \"table\") {\n        // TODO: use templates and _t for texts\n        var $options = $('<a href=\"#\" class=\"option-button dropdown basemap_dropdown\"><div class=\"thumb\"></div>Change basemap</a>');\n\n        $(\".map-options\").append($options);\n\n      }\n\n      this.basemapDropdown = new cdb.admin.DropdownBasemap({\n        target: $('.basemap_dropdown'),\n        position: \"position\",\n        template_base: \"table/views/basemap/basemap_dropdown\",\n        model: this.map,\n        mapview: this.mapView,\n        user: this.user,\n        baseLayers: this.options.baseLayers,\n        tick: \"left\",\n        vertical_offset: 40,\n        horizontal_position: \"left\",\n        vertical_position: this.vis.get(\"type\") === 'table' ? \"down\" : \"up\",\n        horizontal_offset: this.vis.get(\"type\") === 'table' ? 42 : 0\n      });\n\n      this.addView(this.basemapDropdown);\n\n      this.basemapDropdown.bind(\"onDropdownShown\", function() {\n        cdb.god.trigger(\"closeDialogs\");\n      });\n\n      cdb.god.bind(\"closeDialogs\", this.basemapDropdown.hide, this.basemapDropdown);\n\n      $(\".basemap_dropdown\").append(this.basemapDropdown.render().el);\n\n    }\n\n    // Set active base layer if it already exists\n    if (this.map.getBaseLayer()) {\n      this.basemapDropdown.setActiveBaselayer();\n    }\n\n  },\n\n  bindGeoRefCheck: function() {\n    if(!this.table.data().fetched) {\n      this.table.bind('dataLoaded', function() {\n        this.checkGeoRef();\n        if (!this.scratchDialog) {\n          this._showScratchDialog();\n        }\n        if (!this.pecanView) {\n          this._showPecan();\n        }\n      }, this);\n    } else {\n      this.checkGeoRef();\n    }\n  },\n\n  activated: function() {\n    this.checkGeoRef();\n    $(window).scrollTop(0);\n  },\n\n  checkGeoRef: function() {\n    if (this.options && this.table) {\n      this.georeferenced = this.table.isGeoreferenced();\n      if (this.noGeoRefDialog) {\n        this.noGeoRefDialog.hide();\n      }\n      if (!this.georeferenced) {\n        if (this.table.data().length > 0) {\n          this[ this.table.isSync() ? '_showNoGeoWarning' : 'showNoGeoRefWarning' ]();\n        }\n      }\n    }\n  },\n\n  // Shows a warning dialog when your current dialog doesn't have any\n  // geometry on it and it is synchronized\n  _showNoGeoWarning: function() {\n    var noGeoWarningDialog = 'noGeoWarningDialog_' + this.table.id + '_' + this.table.get('map_id');\n    if (this.noGeoWarningDialog || localStorage[noGeoWarningDialog]) {\n      return;\n    }\n\n    this.noGeoWarningDialog = cdb.editor.ViewFactory.createDialogByTemplate(\n      'table/views/no_geo_warning_template', {\n        clean_on_hide: true\n      }\n    );\n\n    this.noGeoWarningDialog.bind(\"hide\", function() {\n      localStorage[noGeoWarningDialog] = true;\n    });\n\n    this.noGeoWarningDialog.appendToBody();\n  },\n\n  _showPecan: function() {\n\n    var hasPecan     = this.user.featureEnabled('pecan_cookies');\n\n    var hasData = this.options.table && this.options.table.data() && this.options.table.data().length > 0 ? true : false;\n\n    if (hasPecan && hasData) {\n\n      var skipPencanDialog = 'pecan_' + this.options.user.get(\"username\") + \"_\" + this.options.table.id;\n\n      if (!localStorage[skipPencanDialog]) {\n\n        this.pecanView = new cdb.editor.PecanView({\n          table: this.options.table,\n          backgroundPollingModel: this.options.backgroundPollingModel\n        });\n      }\n    }\n  },\n\n  _showScratchDialog: function() {\n    if (this.options.table && this.options.table.data().fetched && this.options.table.data().length === 0) {\n\n      var skipScratchDialog = 'scratchDialog_' + this.options.table.id + '_' + this.options.table.get('map_id');\n\n      if (!localStorage[skipScratchDialog]) {\n\n        this.scratchDialog = new cdb.editor.ScratchView({\n          table: this.options.table\n        });\n\n        this.scratchDialog.appendToBody();\n\n        this.scratchDialog.bind(\"newGeometry\", function(type) {\n          this._addGeometry(type);\n        }, this);\n\n        this.scratchDialog.bind(\"skip\", function() {\n          localStorage[skipScratchDialog] = true;\n        });\n      }\n    }\n  },\n\n  /**\n   * this function binds click and dblclick events\n   * in order to not raise click when user does a dblclick\n   *\n   * it raises a missingClick when the user clicks on the map\n   * but not over a feature or ui component\n   */\n  _bindMissingClickEvents: function() {\n    var self = this;\n    this.mapView.bind('click', function(e) {\n      if(self.clickTimeout === null) {\n        self.clickTimeout = setTimeout(function() {\n          self.clickTimeout = null;\n          if(!self.featureHovered) {\n            self.trigger('missingClick');\n          }\n        }, 150);\n      }\n      //google maps does not send an event\n      if(!self.featureHovered && e.preventDefault) {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n    });\n\n    this.mapView.bind('dblclick', function() {\n      if(self.clickTimeout !== null) {\n        clearTimeout(self.clickTimeout);\n        self.clickTimeout = null;\n      }\n    });\n  },\n\n  setActiveLayer: function(layerView) {\n    this.activeLayerView = layerView;\n    // check if the map is rendered and the layer is in the map\n    if(this.mapView && this.mapView.getLayerByCid(layerView.model.cid)) {\n      var layerModel = layerView.model;\n      this._bindDataLayer(layerView, layerModel);\n    }\n  },\n\n  /**\n   * when the layer view is created this method is called\n   * to attach all the click events\n   */\n  _bindDataLayer: function(layerView, layer) {\n    var self = this;\n    var layerType = layer.get('type');\n\n    if (layerType === 'CartoDB' || layerType === 'torque') { // unbind previos stuff\n\n      // Set data layer bindings\n      if (self.layerDataView) {\n        self.layerDataView.unbind(null, null, this);\n      }\n\n      if (self.layerModel) {\n        self.layerModel.unbind(null, null, this);\n      }\n\n      if (self.options.geocoder) {\n        self.options.geocoder.unbind(null, null, this);\n      }\n\n      self.infowindowModel  = layer.infowindow;\n      self.tooltipModel     = layer.tooltip;\n      self.legendModel      = layer.legend;\n\n      self._bindTable(layer.table);\n      self._bindSQLView(layer.sqlView);\n      self.layerDataView = self.mapView.getLayerByCid(layer.cid);\n\n      self.mapView.setActiveLayer(layer);\n      self._addLegends();\n      self._addTimeline();\n\n      if (self.layerDataView) {\n        self.layerDataView.bind('featureClick', self.featureClick, self);\n        self.layerDataView.bind('featureOut',   self.featureOut,   self);\n        self.layerDataView.bind('featureOver',  self.featureOver,  self);\n        self.layerDataView.bind('loading',      self.loadingTiles, self);\n        self.layerDataView.bind('load',         self.loadTiles,    self);\n        self.layerDataView.bind('error',        self.loadTiles,    self);\n        self.tooltip\n          .setLayer(self.layerDataView)\n          .enable();\n\n      }\n\n      // Set layer model binding\n      if (layerView && layer) {\n        layer.unbind('startEdition',this._addGeometry, this);\n        layer.bind('startEdition', this._addGeometry, this);\n      }\n\n      if(layer) {\n        self.layerModel = layer;\n        //TODO: unbind this at some point\n        layer.bind('change:interactivity', this._updateSQLHeader, this);\n        this._updateSQLHeader();\n      }\n\n      if (self.options.geocoder) {\n        self.options.geocoder.bind('geocodingComplete geocodingError geocodingCanceled', this.updateDataLayerView, this);\n        self.add_related_model(self.options.geocoder);\n      }\n\n    }\n  },\n\n  _cleanLegends: function() {\n\n    if (this.legends) {\n      _.each(this.legends, function(legend) {\n        legend.clean();\n      });\n\n    }\n\n    this.legends = [];\n\n  },\n\n\n  _getCartoDBLayers: function() {\n\n    return this.map.layers.models.filter(function(layerModel) {\n      return layerModel.get(\"type\") === 'CartoDB'\n    });\n\n  },\n\n  _onKeyDown: function(e) {\n    if (this.overlays && e.which == 86 && (e.ctrlKey || e.metaKey)) {\n      this.overlays.paste();\n    }\n  },\n\n  _onChangeCanvasMode: function() {\n\n    var self = this;\n\n    cdb.god.trigger(\"closeDialogs\");\n\n    var mode = this.canvas.get(\"mode\");\n\n    if (mode === \"desktop\") {\n\n      this._showDesktopCanvas(mode);\n\n      if (this.overlays.loader && this.overlays.fullscreen) {\n        setTimeout(function() {\n          self.overlays && self.overlays._positionOverlaysVertically(true);\n        }, 500);\n      }\n\n    } else if (mode === \"mobile\") {\n\n      this._showMobileCanvas(mode);\n\n      setTimeout(function() {\n        self.overlays && self.overlays._positionOverlaysVertically(true);\n      }, 300);\n\n    }\n\n  },\n\n  _showMobileCanvas: function(mode) {\n\n    var self = this;\n\n    var width  = 288;\n    var height = 476;\n\n    this.overlays._hideOverlays(\"desktop\");\n\n    var $map = $(\"div.map div.cartodb-map\");\n\n    this.$el.addClass(mode);\n\n    // Animations step - 1\n    var onBackgroundShown = function() {\n\n      $map.animate(\n        { width: width, marginLeft: -Math.round(width/2) - 1, left: \"50%\" },\n        { easing: \"easeOutQuad\", duration: 200, complete: onCanvasLandscapeStretched }\n      );\n\n    };\n\n    // Animations step - 2\n    var onCanvasPortraitStretched = function() {\n\n      self.$el.find(\".mobile_bkg\").animate(\n        { opacity: 1 },\n        { duration: 250 }\n      );\n\n      self.overlays._showOverlays(mode);\n\n      // Let's set center view for mobile mode\n      var center = self.map.get('center');\n      self.mapView.invalidateSize();\n      $map.fadeOut(250);\n\n      setTimeout(function() {\n        self.mapView.map.setCenter(center);\n        $map.fadeIn(250);\n      },300);\n\n    };\n\n    // Animations step - 3\n    var onCanvasLandscapeStretched = function() {\n\n      $map.animate(\n        { height: height, marginTop: -Math.round(height/2) + 23,  top:  \"50%\" },\n        { easing: \"easeOutQuad\", duration: 200, complete: onCanvasPortraitStretched }\n      );\n\n    };\n\n    onBackgroundShown();\n\n    this._enableAnimatedMap();\n    this._enableMobileLayout();\n\n  },\n\n  _enableMobileLayout: function() {\n\n    if (!this.mobile) {\n\n      var torqueLayer;\n\n      this.mobile = new cdb.admin.overlays.Mobile({\n        mapView: this.mapView,\n        overlays: this.overlays,\n        map: this.map\n      });\n\n      this.mapView.$el.append(this.mobile.render().$el);\n\n    } else {\n      this.mobile.show();\n    }\n\n  },\n\n  _disableMobileLayout: function() {\n\n    if (this.mobile) this.mobile.hide();\n\n  },\n\n  _showDesktopCanvas: function(mode) {\n\n    var self = this;\n\n    this.overlays._hideOverlays(\"mobile\");\n\n    this.$el.removeClass(\"mobile\");\n\n    this.$el.find(\".mobile_bkg\").animate({ opacity: 0}, 250);\n\n    var\n    $map       = $(\"div.map div.cartodb-map\"),\n    top        = $map.css(\"top\"),\n    left       = $map.css(\"left\"),\n    mTop       = $map.css(\"marginTop\"),\n    mLeft      = $map.css(\"marginLeft\"),\n    curWidth   = $map.width(),\n    curHeight  = $map.height(),\n    autoWidth  = $map.css({width:  'auto', marginLeft: 0, left: \"15px\"}).width();  //temporarily change to auto and get the width.\n    autoHeight = $map.css({height: 'auto', marginTop: 0,  top: \"82px\" }).height(); //temporarily change to auto and get the width.\n\n    $map.height(curHeight);\n    $map.width(curWidth);\n\n    $map.css({ top: top, left: left, marginLeft: mLeft, marginTop: mTop, height: curHeight, width: curWidth });\n\n    var onSecondAnimationFinished = function() {\n\n      $map.css('width', 'auto');\n      self.overlays._showOverlays(mode);\n\n      // Let's set center view for desktop mode\n      var center = self.map.get('center');\n      self.mapView.invalidateSize();\n\n      setTimeout(function() {\n        self.mapView.map.setCenter(center);\n      },300);\n\n    };\n\n    var onFirstAnimationFinished = function() {\n\n      $map.css('height', 'auto');\n      $map.animate(\n        { width: autoWidth, left: \"15px\", marginLeft: \"0\"},\n        { easing: \"easeOutQuad\", duration: 200, complete: onSecondAnimationFinished }\n      );\n\n    };\n\n    var stretchMapLandscape = function() {\n      $map.animate(\n        { height: autoHeight, top: \"82\", marginTop: \"0\"},\n        { easing: \"easeOutQuad\", duration: 200, complete: onFirstAnimationFinished }\n      );\n    };\n\n    stretchMapLandscape();\n\n    this._disableAnimatedMap();\n    this._disableMobileLayout();\n\n  },\n\n  _enableAnimatedMap: function() {\n\n    var self = this;\n\n    setTimeout(function() {\n      self.$el.addClass(\"animated\");\n    }, 800)\n\n  },\n\n  _disableAnimatedMap: function() {\n    this.$el.removeClass(\"animated\");\n  },\n\n  _addMapOptionsDropdown: function() {\n\n    if (!this.mapOptionsDropdown) {\n\n      var $options = $(\"<a href='#show-options' class='option-button show-table-options'>Options</a>\");\n\n      this.$options = $options;\n\n      $(\".map-options\").append($options);\n\n      this.mapOptionsDropdown = new cdb.admin.MapOptionsDropdown({\n        target:              $('.show-table-options'),\n        template_base:       \"table/views/map_options_dropdown\",\n        table:               table,\n        model:               this.map,\n        mapview:             this.mapView,\n        collection:          this.vis.overlays,\n        user:                this.user,\n        vis:                 this.vis,\n        canvas:              this.canvas,\n        position:            \"position\",\n        tick:                \"left\",\n        vertical_position:   \"up\",\n        horizontal_position: \"left\",\n        horizontal_offset:   \"-3px\"\n      });\n\n      this._bindMapOptions();\n\n      this.addView(this.mapOptionsDropdown);\n\n      $(\".show-table-options\").append(this.mapOptionsDropdown.render().el);\n\n    }\n\n  },\n\n  _bindMapOptions: function() {\n\n    this.mapOptionsDropdown.bind(\"onDropdownShown\", function() {\n      cdb.god.trigger(\"closeDialogs\");\n      this.$options.addClass(\"open\");\n    }, this);\n\n    this.mapOptionsDropdown.bind(\"onDropdownHidden\", function() {\n      this.$options.removeClass(\"open\");\n    }, this);\n\n    this.mapOptionsDropdown.bind(\"createOverlay\", function(overlay_type, property) {\n      this.vis.overlays.createOverlayByType(overlay_type, property);\n    }, this);\n\n    cdb.god.bind(\"closeDialogs\", this.mapOptionsDropdown.hide, this.mapOptionsDropdown);\n\n  },\n\n  _addOverlays: function() {\n    this.overlays = new cdb.admin.MapOverlays({\n      headerMessageIsVisible: this._shouldAddSQLViewHeader(),\n      vis: this.vis,\n      canvas: this.canvas,\n      mapView: this.mapView,\n      master_vis: this.master_vis,\n      mapToolbar: this.$el.find(\".map_toolbar\")\n    });\n\n  },\n\n  _exportImage: function(e) {\n\n    this.killEvent(e);\n\n    if (this.exportImageView) {\n      return;\n    }\n\n    this.exportImageView = new cdb.admin.ExportImageView({\n      vizjson:  this.vis.vizjsonURL(),\n      vis:      this.vis,\n      user:     this.options.user,\n      overlays: this.overlays,\n      mapView:  this.mapView,\n      width:    this.mapView.$el.width(),\n      height:   this.mapView.$el.height(),\n      map:      this.map\n    });\n\n    this.exportImageView.bind(\"was_removed\", function() {\n      this.exportImageView = null;\n    }, this);\n\n    this.mapView.$el.append(this.exportImageView.render().$el);\n\n    cdb.god.bind(\"panel_action\", function(action) {\n      if (action !== \"hide\" && this.exportImageView) {\n        this.exportImageView.hide();\n      }\n    }, this);\n  },\n\n  _addSlides: function() {\n\n    if (!this.vis.isVisualization()) return;\n\n    this.slidesPanel = new cdb.admin.SlidesPanel({\n      user: this.user,\n      slides:  this.vis.slides,\n      toggle: this.$el.find(\".toggle_slides\")\n    });\n\n    this.slidesPanel.bind(\"onChangeVisible\", function() {\n      this.exportImageView && this.exportImageView.hide();\n    }, this);\n\n    this.$el.append(this.slidesPanel.render().el);\n\n    this.addView(this.slidesPanel);\n\n  },\n\n  _addLegends: function() {\n\n    var self = this;\n\n    this._cleanLegends();\n    \n    if (!this.map.get(\"legends\")) {\n      return;\n    }\n\n    var models = this.map.layers.models;\n\n    for (var i = models.length - 1; i >= 0; --i) {\n      var layer = models[i];\n      self._addLegend(layer);\n    }\n\n  },\n\n  _addLegend: function(layer) {\n\n    var type = layer.get('type');\n\n    if (type === 'CartoDB' || type === 'torque') {\n\n      if (this.table && this.mapView) {\n\n        if (this.legend) this.legend.clean();\n\n        if (layer.get(\"visible\")) {\n\n          var legend = new cdb.geo.ui.Legend({\n            model:   layer.legend,\n            mapView: this.mapView,\n            table:   this.table\n          });\n\n          if (this.legends) {\n            this.legends.push(legend);\n            this._renderStackedLengeds();\n          }\n\n        }\n      }\n    }\n\n  },\n  \n  _toggleLegends: function() {\n    if (this.map.get(\"legends\")) {\n      this._addLegends();\n    } else {\n      this._cleanLegends();\n    }\n  },\n\n  _addTimeline: function() {\n    if (!this.mapView) return;\n    // check if there is some torque layer\n    if(!this.map.layers.any(function(lyr) { return lyr.get('type') === 'torque' && lyr.get('visible'); })) {\n      this.timeline && this.timeline.clean();\n      this.timeline = null;\n    } else {\n      var layer = this.map.layers.getLayersByType('torque')[0];\n      var steps = layer.wizard_properties.get('torque-frame-count');\n\n      if (this.timeline) {\n        // check if the model is different\n        if (this.timeline.torqueLayer.model.cid !== layer.cid) {\n          this.timeline.clean();\n          this.timeline = null;\n        }\n      }\n\n      layerView = this.mapView.getLayerByCid(layer.cid);\n\n      if (layerView && typeof layerView.getStep !== \"undefined\" && steps > 1) {\n        if (!this.timeline) {\n          this.timeline = new cdb.geo.ui.TimeSlider({\n            layer: layerView,\n            width: \"auto\"\n          });\n\n          this.mapView.$el.append(this.timeline.render().$el);\n          this.addView(this.timeline);\n        } else {\n          this.timeline.setLayer(layerView);\n        }\n      }\n      else if (this.timeline) {\n        this.timeline.clean();\n        this.timeline = null;\n      }\n    }\n  },\n\n  _renderStackedLengeds: function() {\n\n    if (this.stackedLegend) this.stackedLegend.clean();\n    if (this.legend)        this.legend.clean();\n\n    this.stackedLegend = new cdb.geo.ui.StackedLegend({\n      legends: this.legends\n    });\n\n    this.mapView.$el.append(this.stackedLegend.render().$el);\n    this.addView(this.stackedLegend);\n\n  },\n\n  _renderLegend: function() {\n\n    if (this.legend) this.legend.clean();\n\n    this.legend = this.legends[0];\n\n    this.mapView.$el.append(this.legend.render().$el);\n\n    if (!this.legend.model.get(\"type\")) this.legend.hide();\n    else this.legend.show();\n\n    this.addView(this.legend);\n\n  },\n\n  _addTooltip: function() {\n    if(this.tooltip) this.tooltip.clean();\n    if(this.table && this.mapView) {\n      this.tooltip = new cdb.admin.Tooltip({\n        model: this.tooltipModel,\n        table: this.table,\n        mapView: this.mapView,\n        omit_columns: ['cartodb_id'] // don't show cartodb_id while hover\n      });\n      this.mapView.$el.append(this.tooltip.render().el);\n      this.tooltip.bind('editData', this._editData, this);\n      this.tooltip.bind('removeGeom', this._removeGeom, this);\n      this.tooltip.bind('editGeom', this._editGeom, this);\n      if (this.layerDataView) {\n        this.tooltip\n          .setLayer(this.layerDataView)\n          .enable();\n      }\n    }\n  },\n\n  _addInfowindow: function() {\n    if(this.infowindow) this.infowindow.clean();\n    if(this.table && this.mapView) {\n      this.infowindow = new cdb.admin.MapInfowindow({\n        model: this.infowindowModel,\n        mapView: this.mapView,\n        table: this.table\n      });\n      this.mapView.$el.append(this.infowindow.el);\n\n      // Editing geometry\n      if(this.geometryEditor) {\n        this.geometryEditor.discard();\n        this.geometryEditor.clean();\n      }\n\n      this.geometryEditor = new cdb.admin.GeometryEditor({\n        user: this.user,\n        model: this.table\n      });\n\n      this.geometryEditor.mapView = this.mapView;\n      this.mapView.$el.append(this.geometryEditor.render().el);\n      this.geometryEditor.hide();\n\n      this.geometryEditor.bind('editStart', this.hideDataLayer, this);\n      this.geometryEditor.bind('editDiscard', this.showDataLayer, this);\n      this.geometryEditor.bind('editFinish', this.showDataLayer, this);\n      this.geometryEditor.bind('editFinish', this.updateDataLayerView, this);\n      this.geometryEditor.bind('geomCreated', function(row) {\n        this.table.data().add(row);\n      }, this);\n\n      var self = this;\n\n      this.infowindow.bind('editData', this._editData, this);\n      this.infowindow.bind('removeGeom', this._removeGeom, this);\n      this.infowindow.bind('editGeom', this._editGeom, this);\n\n      this.infowindow.bind('openInfowindowPanel', function() {\n        this.activeLayerView.showModule('infowindow', 'fields');\n      }, this);\n\n      this.infowindow.bind('close', function() {\n        if (this.tooltip) {\n          this.tooltip.setFilter(null);\n        }\n      }, this);\n\n      this.table.bind('remove:row', this.updateDataLayerView, this);\n\n      this.table.bind('change:dataSource', function() {\n        if (this.geometryEditor) this.geometryEditor.discard();\n      }, this);\n\n      this.map.bind('change:provider', function() {\n        if (this.geometryEditor) this.geometryEditor.discard();\n      }, this);\n    }\n  },\n\n  _editGeom: function(row) {\n    // when provider is leaflet move the world to [-180, 180]\n    // because vector features are only rendered on that slice\n    if (this.map.get('provider') === 'leaflet') {\n      this.map.clamp();\n    }\n    this.geometryEditor.editGeom(row);\n  },\n\n  /**\n   * Shows edit data modal window\n   */\n  _editData: function(row) {\n    if (!this.table.isReadOnly()) {\n      var self = this;\n      row.fetch({ cache: false, no_geom: true, success: function() {\n        var dlg = new cdb.editor.FeatureDataView({\n          row: row,\n          provider: self.map.get('provider'),\n          baseLayer: self.map.getBaseLayer().clone(),\n          dataLayer: self.layerModel.clone(),\n          currentZoom: self.map.getZoom(),\n          enter_to_confirm: false,\n          table: self.table,\n          user: self.user,\n          clean_on_hide: true,\n          onDone: self.updateDataLayerView.bind(self) // Refreshing layer when changes have been done\n        });\n\n        dlg.appendToBody();\n      }});\n\n      return false;\n    }\n  },\n\n  /**\n   * triggers an removeGeom event when the geometry\n   * is removed from the server\n   */\n  _removeGeom: function(row) {\n    if (!this.table.isReadOnly()) {\n      var view = new cdb.editor.DeleteRowView({\n        name: 'feature',\n        table: this.table,\n        row: row,\n        clean_on_hide: true,\n        enter_to_confirm: true,\n        wait: true // to not remove from parent collection until server-side confirmed deletion\n      });\n      view.appendToBody();\n\n      return false;\n    }\n  },\n\n  _addGeometry: function(type) {\n    this.geometryEditor.createGeom(this.table.data().newRow(), type);\n  },\n\n  _bindTable: function(table) {\n    if (this.table) {\n      this.table.unbind(null, null, this);\n    }\n\n    this.table = table;\n\n    this.table.bind('change:dataSource', this._hideInfowindow, this);\n    this.table.bind('change:dataSource', this._updateSQLHeader, this);\n    this.table.bind('change:schema',     this._updateSQLHeader, this);\n\n    this.table.bind('data:saved', this.updateDataLayerView, this);\n\n    this._addInfowindow();\n\n    this._addLegends();\n    this._addTooltip();\n\n    this.bindGeoRefCheck();\n  },\n\n  _bindSQLView: function(sqlView) {\n    if(this.sqlView) {\n      this.sqlView.unbind(null, null, this);\n    }\n    this.sqlView = sqlView;\n    this.sqlView.bind('reset error', this._updateSQLHeader, this);\n    this.sqlView.bind('loading', this._renderLoading, this);\n    this._updateSQLHeader();\n  },\n\n  _renderLoading: function(opts) {\n    this._removeSQLViewHeader();\n\n    //TODO: remove this hack\n    if ($('.table_panel').length > 0) {\n      panel_opened = $('.table_panel').css(\"right\").replace(\"px\",\"\") == 0\n    }\n\n    var html = this.getTemplate('table/views/sql_view_notice_loading')({\n      panel_opened: panel_opened\n    });\n\n    if (this.overlays) {\n      this.overlays.setHeaderMessageIsVisible(true);\n    }\n\n    this.$('.cartodb-map').after(html);\n  },\n\n  _updateSQLHeader: function() {\n    if (this._shouldAddSQLViewHeader()) {\n      this._addSQLViewHeader();\n    } else {\n      this._removeSQLViewHeader();\n    }\n  },\n\n  _shouldAddSQLViewHeader: function() {\n    return this.table && this.table.isInSQLView();\n  },\n\n  loadingTiles: function() {\n    if (this.overlays.loader) this.overlays.loader.show();\n  },\n\n  loadTiles: function() {\n    if (this.overlays.loader) this.overlays.loader.hide();\n  },\n\n  featureOver: function(e, latlon, pxPos, data) {\n    if(this.infowindowModel.get('disabled')) return;\n    this.mapView.setCursor('pointer');\n    this.featureHovered = data;\n  },\n\n  featureOut: function() {\n    if(this.infowindowModel.get('disabled')) return;\n    this.mapView.setCursor('auto');\n    this.featureHovered = null;\n  },\n\n  featureClick: function(e, latlon, pxPos, data) {\n    if(this.infowindowModel.get('disabled')) return;\n    if(!this.geometryEditor.isEditing()) {\n      if(data.cartodb_id) {\n        this.infowindow\n          .setLatLng(latlon)\n          .setFeatureInfo(data.cartodb_id)\n          .showInfowindow();\n\n        this.tooltip.setFilter(function(feature) {\n          return feature.cartodb_id !== data.cartodb_id;\n        }).hide();\n      } else {\n        cdb.log.error(\"can't show infowindow, no cartodb_id on data\");\n      }\n    }\n  },\n\n  /**\n   *  Move all necessary blocks when panel is openned (normal, narrowed,...) or closed\n   */\n  _moveInfo: function(type) {\n    if (type === \"show\") {\n      this.$el\n        .removeClass('narrow')\n        .addClass('displaced');\n    } else if (type === \"hide\") {\n      this.$el.removeClass('narrow displaced');\n    } else if (type === \"narrow\") {\n      this.$el.addClass('narrow displaced');\n    }\n  },\n\n  render: function() {\n\n    this.$el.html('');\n\n    this.$el\n    .removeClass(\"mobile\")\n    .removeClass(\"derived\")\n    .removeClass(\"table\");\n\n    this.$el.addClass(this.vis.isVisualization() ? 'derived': 'table');\n    var provider = this.map.get(\"provider\");\n\n    this.$el.append(this.template({\n      slides_enabled: this.user.featureEnabled('slides'),\n      type: this.vis.get('type'),\n      exportEnabled: !this.map.isProviderGmaps()\n    }));\n\n    return this;\n\n  },\n\n  showDataLayer: function() {\n    this.mapView.enableInteraction();\n    this.layerDataView.setOpacity && this.layerDataView.setOpacity(1.0);\n  },\n\n  hideDataLayer: function() {\n    this.mapView.disableInteraction();\n    this.layerDataView.setOpacity && this.layerDataView.setOpacity(0.5);\n  },\n\n  /**\n   * reload tiles\n   */\n  updateDataLayerView: function() {\n    if(this.layerDataView) {\n      this.layerDataView.invalidate();\n    }\n  },\n  /**\n   * Paints a dialog with a warning when the user hasn't any georeferenced row\n   * @method showNoGeorefWarning\n   */\n  showNoGeoRefWarning: function() {\n    var warningStorageName = 'georefNoContentWarningShowed_' + this.table.id + '_' + this.table.get('map_id');\n\n    // if the dialog already has been shown, we don't show it again\n    if(!this.noGeoRefDialog && !this.table.isInSQLView() && (!localStorage[warningStorageName])) {\n      localStorage[warningStorageName] = true;\n\n      this.noGeoRefDialog = new cdb.editor.GeoreferenceView({\n        table: this.table,\n        user: this.user\n      });\n      this.noGeoRefDialog.appendToBody();\n    }\n\n  },\n\n  //adds the green indicator when a query is applied\n  _addSQLViewHeader: function() {\n    this.$('.sqlview').remove();\n    var total = this.table.data().size();\n    var warnMsg = null;\n    // if the layer does not suppor interactivity do not show the message\n    if (this.layerModel && !this.layerModel.get('interactivity') && this.layerModel.wizard_properties.supportsInteractivity()) {\n      warnMsg = this._TEXTS.no_interaction_warn;\n    }\n    if (this.layerModel && !this.layerModel.table.containsColumn('the_geom_webmercator')) {\n      warnMsg = _t('the_geom_webmercator column should be selected');\n    }\n    var html = this.getTemplate('table/views/sql_view_notice')({\n      empty: !total,\n        isVisualization: this.vis.isVisualization(),\n        warnMsg: warnMsg\n    });\n\n    this.$('.cartodb-map').after(html);\n\n    if (this.overlays) {\n      this.overlays.setHeaderMessageIsVisible(true);\n    }\n  },\n\n  _removeSQLViewHeader: function() {\n    this.$('.sqlview').remove();\n\n    if (this.overlays) {\n      this.overlays.setHeaderMessageIsVisible(false);\n    }\n  },\n\n  _toggleSlides: function(e) {\n    this.killEvent(e);\n    this.slidesPanel && this.slidesPanel.toggle();\n  },\n\n  _clearView: function(e) {\n    this.killEvent(e);\n    this.activeLayerView.model.clearSQLView();\n    return false;\n  },\n\n  _tableFromQuery: function(e) {\n    this.killEvent(e);\n\n    var duplicate_dialog = new cdb.editor.DuplicateDatasetView({\n      model: this.table,\n      user: this.user,\n      clean_on_hide: true\n    });\n    duplicate_dialog.appendToBody();\n  }\n\n});\n","/**\n * this method creates a new Model in sync with the specicied one. Also takes a method to be executed every time the proxy model changes\n * returns the proxy model, an instance of Backbone.Model, it's not an instance of original model\n */\nfunction proxyModel(m, fn) {\n  var proxyModel = new Backbone.Model();\n  proxyModel.set(m.attributes);\n  var signalDisabled = false;\n\n  fn = fn || function() {\n    m.set(proxyModel.attributes);\n  }\n\n  m.bind('change', function() {\n    signalDisabled = true;\n    proxyModel.set(m.attributes);\n    signalDisabled = false;\n  }, proxyModel);\n\n  proxyModel.bind('change', function() {\n    if (signalDisabled) return;\n    fn(m, proxyModel);\n  }, m);\n\n  proxyModel.unlink = function() {\n    m.unbind(null, null, proxyModel);\n    proxyModel.unbind(null, null, m);\n  }\n\n  return proxyModel;\n}\n\ncdb.admin.TransitionDropdown = cdb.ui.common.Dropdown.extend({\n\n  className: 'dropdown slide_transition_dropdown',\n\n  defaults: {\n    speedOut: 100,\n    speedIn: 100\n  },\n\n  events: {\n    \"click\" : \"killEvent\",\n    'click .radiobutton': '_onClickRadioButton'\n  },\n\n  initialize: function() {\n    var self = this;\n\n    _.bindAll(this, \"open\", \"hide\", \"_handleClick\", \"_onKeyDown\");\n\n    // Extend options\n    _.defaults(this.options, this.defaults);\n\n    // Dropdown template\n    this.template_base = cdb.templates.getTemplate(this.options.template_base);\n\n    this.vis = this.options.vis;\n\n    // Bind to target\n    $(this.options.target).bind({ \"click\": this._handleClick});\n\n    // Bind ESC key\n    // TODO: unbind\n    $(document).bind('keydown', this._onKeyDown);\n\n    this.formModel = proxyModel(this.vis.transition, function(m, proxy) {\n      // since the visualization model may not be loaded fetch it and save\n      function _save() {\n          m.set(proxy.attributes);\n          self.vis.save();\n      }\n      if (!self.vis.isLoaded()) {\n        self.vis.fetch({\n          success: function() {\n            _save();\n          }\n        });\n      } else {\n        _save();\n      }\n    })\n\n    this.on('clean', function() {\n      this.formModel.unlink();\n    })\n\n    this.formModel.on(\"change:transition_trigger\", this._onChangeTransitionTrigger, this);\n    this.formModel.on(\"change:time\", this._onChangeTime, this);\n\n    // flags\n    this.isOpen    = false;\n  },\n\n  /* Check if the dropdown is visible to hiding with the click on the target */\n  _handleClick: function(ev) {\n    if (ev) {\n      ev.preventDefault();\n    }\n\n    // If visible\n    if (this.isOpen){\n      this.hide();\n    } else{\n      this.open();\n    }\n  },\n\n  _onClickRadioButton: function(e) {\n\n    e.preventDefault();\n    e.stopPropagation();\n\n    var $el = $(e.target);\n    var transitionType = $el.attr(\"data-transition\");\n\n    this.$el.find(\".radiobutton\").removeClass(\"selected\");\n    $el.addClass(\"selected\");\n\n    //this.formModel.set(\"time\", 0);\n    this.formModel.set({\n      transition_trigger: transitionType\n    })\n\n  },\n\n  _selectTimeEvent: function() {\n    this.$el.find(\".radiobutton\").removeClass(\"selected\");\n    this.$el.find(\"a[data-transition='time']\").addClass(\"selected\");\n  },\n\n  _selectOnClickEvent: function() {\n    this.$el.find(\".radiobutton\").removeClass(\"selected\");\n    this.$el.find(\"a[data-transition='click']\").addClass(\"selected\");\n  },\n\n  _onChangeTime: function() {\n\n    var time = this.formModel.get(\"time\");\n\n    if (time === 0 || !time) {\n      this._selectOnClickEvent();\n    } else {\n      this._selectTimeEvent();\n    }\n\n  },\n\n  _onChangeTransitionTrigger: function() {\n\n    var trigger = this.formModel.get(\"transition_trigger\");\n\n    if (trigger === \"click\" || !trigger) {\n      this._selectOnClickEvent();\n    } else {\n      this._selectTimeEvent();\n    }\n\n  },\n\n  show: function() {\n\n    var dfd = $.Deferred();\n    var self = this;\n\n    //sometimes this dialog is child of a node that is removed\n    //for that reason we link again DOM events just in case\n    this.delegateEvents();\n    this.$el\n    .css({\n      marginTop: \"-10px\",\n      opacity:0,\n      display:\"block\"\n    })\n    .animate({\n      margin: \"0\",\n      opacity: 1\n    }, {\n      \"duration\": this.options.speedIn,\n      \"complete\": function(){\n        dfd.resolve();\n      }\n    });\n\n    this.trigger(\"onDropdownShown\", this.el);\n\n    return dfd.promise();\n  },\n\n  open: function(ev, target) {\n\n    cdb.god.trigger(\"closeDialogs\");\n\n    // Target\n    var $target = target && $(target) || this.options.target;\n\n    this.options.target = $target;\n\n    this.$el.css({\n      top: this.options.vertical_offset,\n      right: this.options.horizontal_offset \n    })\n    .addClass(\n      // Add vertical and horizontal position class\n      (this.options.vertical_position == \"up\" ? \"vertical_top\" : \"vertical_bottom\" )\n      + \" \" +\n        (this.options.horizontal_position == \"right\" ? \"horizontal_right\" : \"horizontal_left\" )\n      + \" \" +\n        // Add tick class\n        \"border tick_\" + this.options.tick\n    );\n\n    // Show it\n    this.show();\n    this._recalcHeight();\n\n    // Dropdown open\n    this.isOpen = true;\n  },\n\n  _onKeyDown: function(e) {\n\n    if (e.keyCode === 27) {\n      this.hide();\n    }\n\n  },\n\n\n  hide: function(done) {\n\n    if (!this.isOpen) {\n      done && done();\n      return;\n    }\n\n    var self    = this;\n    this.isOpen = false;\n\n    this.$el.animate({\n      marginTop: self.options.vertical_position == \"down\" ? \"10px\" : \"-10px\",\n      opacity: 0\n    }, this.options.speedOut, function(){\n\n      // And hide it\n      self.$el.hide();\n\n    });\n\n    this.trigger(\"onDropdownHidden\",this.el);\n  },\n\n  _recalcHeight: function() {\n\n    var $ul  = this.$el.find(\"ul.special\");\n\n    // Resets heights\n    $ul.height(\"auto\");\n    $ul.parent().height(\"auto\");\n\n    var special_height  = $ul.height();\n    var dropdown_height = $ul.parent().height();\n\n    // Sets heights\n    if (special_height < dropdown_height) $ul.css(\"height\", dropdown_height);\n    else $ul.parent().height(special_height);\n\n  },\n\n  /*\n   * Renders the dropdown\n   */\n  render: function() {\n\n    this.clearSubViews();\n\n    this.$el.html(this.template_base(this.options));\n\n    var number = new cdb.forms.SimpleNumber({\n      model: this.formModel,\n      property: \"time\",\n      max: 120,\n      min: 1,\n      inc: 1\n    });\n\n    number.bind(\"saved\", function(a) {\n      this.formModel.set(\"transition_trigger\", \"time\");\n    }, this);\n\n    this.$el.find(\"li.seconds .form\").append(number.render().$el);\n    this._onChangeTransitionTrigger();\n\n    return this;\n  }\n\n});\n","// CodeMirror version 3.22.1 ( + custom code, read below )\n//\n//  - If you need to upgrade this library, do it from:\n//\n//  http://github.com/cartodb/codemirror\n//\n\n// CodeMirror is the only global var we claim\nwindow.CodeMirror = (function() {\n  \"use strict\";\n\n  // BROWSER SNIFFING\n\n  // Crude, but necessary to handle a number of hard-to-feature-detect\n  // bugs and behavior differences.\n  var gecko = /gecko\\/\\d/i.test(navigator.userAgent);\n  // IE11 currently doesn't count as 'ie', since it has almost none of\n  // the same bugs as earlier versions. Use ie_gt10 to handle\n  // incompatibilities in that version.\n  var old_ie = /MSIE \\d/.test(navigator.userAgent);\n  var ie_lt8 = old_ie && (document.documentMode == null || document.documentMode < 8);\n  var ie_lt9 = old_ie && (document.documentMode == null || document.documentMode < 9);\n  var ie_lt10 = old_ie && (document.documentMode == null || document.documentMode < 10);\n  var ie_gt10 = /Trident\\/([7-9]|\\d{2,})\\./.test(navigator.userAgent);\n  var ie = old_ie || ie_gt10;\n  var webkit = /WebKit\\//.test(navigator.userAgent);\n  var qtwebkit = webkit && /Qt\\/\\d+\\.\\d+/.test(navigator.userAgent);\n  var chrome = /Chrome\\//.test(navigator.userAgent);\n  var opera = /Opera\\//.test(navigator.userAgent);\n  var safari = /Apple Computer/.test(navigator.vendor);\n  var khtml = /KHTML\\//.test(navigator.userAgent);\n  var mac_geLion = /Mac OS X 1\\d\\D([7-9]|\\d\\d)\\D/.test(navigator.userAgent);\n  var mac_geMountainLion = /Mac OS X 1\\d\\D([8-9]|\\d\\d)\\D/.test(navigator.userAgent);\n  var phantom = /PhantomJS/.test(navigator.userAgent);\n\n  var ios = /AppleWebKit/.test(navigator.userAgent) && /Mobile\\/\\w+/.test(navigator.userAgent);\n  // This is woefully incomplete. Suggestions for alternative methods welcome.\n  var mobile = ios || /Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent);\n  var mac = ios || /Mac/.test(navigator.platform);\n  var windows = /win/i.test(navigator.platform);\n\n  var opera_version = opera && navigator.userAgent.match(/Version\\/(\\d*\\.\\d*)/);\n  if (opera_version) opera_version = Number(opera_version[1]);\n  if (opera_version && opera_version >= 15) { opera = false; webkit = true; }\n  // Some browsers use the wrong event properties to signal cmd/ctrl on OS X\n  var flipCtrlCmd = mac && (qtwebkit || opera && (opera_version == null || opera_version < 12.11));\n  var captureMiddleClick = gecko || (ie && !ie_lt9);\n\n  // Optimize some code when these features are not used\n  var sawReadOnlySpans = false, sawCollapsedSpans = false;\n\n  // CONSTRUCTOR\n\n  function CodeMirror(place, options) {\n    if (!(this instanceof CodeMirror)) return new CodeMirror(place, options);\n\n    this.options = options = options || {};\n    // Determine effective options based on given values and defaults.\n    for (var opt in defaults) if (!options.hasOwnProperty(opt) && defaults.hasOwnProperty(opt))\n      options[opt] = defaults[opt];\n    setGuttersForLineNumbers(options);\n\n    var docStart = typeof options.value == \"string\" ? 0 : options.value.first;\n    var display = this.display = makeDisplay(place, docStart);\n    display.wrapper.CodeMirror = this;\n    updateGutters(this);\n    if (options.autofocus && !mobile) focusInput(this);\n\n    this.state = {keyMaps: [],\n                  overlays: [],\n                  modeGen: 0,\n                  overwrite: false, focused: false,\n                  suppressEdits: false,\n                  pasteIncoming: false, cutIncoming: false,\n                  draggingText: false,\n                  highlight: new Delayed()};\n\n    themeChanged(this);\n    if (options.lineWrapping)\n      this.display.wrapper.className += \" CodeMirror-wrap\";\n\n    var doc = options.value;\n    if (typeof doc == \"string\") doc = new Doc(options.value, options.mode);\n    operation(this, attachDoc)(this, doc);\n\n    // Override magic textarea content restore that IE sometimes does\n    // on our hidden textarea on reload\n    if (old_ie) setTimeout(bind(resetInput, this, true), 20);\n\n    registerEventHandlers(this);\n    // IE throws unspecified error in certain cases, when\n    // trying to access activeElement before onload\n    var hasFocus; try { hasFocus = (document.activeElement == display.input); } catch(e) { }\n    if (hasFocus || (options.autofocus && !mobile)) setTimeout(bind(onFocus, this), 20);\n    else onBlur(this);\n\n    operation(this, function() {\n      for (var opt in optionHandlers)\n        if (optionHandlers.propertyIsEnumerable(opt))\n          optionHandlers[opt](this, options[opt], Init);\n      for (var i = 0; i < initHooks.length; ++i) initHooks[i](this);\n    })();\n  }\n\n  // DISPLAY CONSTRUCTOR\n\n  function makeDisplay(place, docStart) {\n    var d = {};\n\n    var input = d.input = elt(\"textarea\", null, null, \"position: absolute; padding: 0; width: 1px; height: 1em; outline: none\");\n    if (webkit) input.style.width = \"1000px\";\n    else input.setAttribute(\"wrap\", \"off\");\n    // if border: 0; -- iOS fails to open keyboard (issue #1287)\n    if (ios) input.style.border = \"1px solid black\";\n    input.setAttribute(\"autocorrect\", \"off\"); input.setAttribute(\"autocapitalize\", \"off\"); input.setAttribute(\"spellcheck\", \"false\");\n\n    // Wraps and hides input textarea\n    d.inputDiv = elt(\"div\", [input], null, \"overflow: hidden; position: relative; width: 3px; height: 0px;\");\n    // The actual fake scrollbars.\n    d.scrollbarH = elt(\"div\", [elt(\"div\", null, null, \"height: 1px\")], \"CodeMirror-hscrollbar\");\n    d.scrollbarV = elt(\"div\", [elt(\"div\", null, null, \"width: 1px\")], \"CodeMirror-vscrollbar\");\n    d.scrollbarFiller = elt(\"div\", null, \"CodeMirror-scrollbar-filler\");\n    d.gutterFiller = elt(\"div\", null, \"CodeMirror-gutter-filler\");\n    // DIVs containing the selection and the actual code\n    d.lineDiv = elt(\"div\", null, \"CodeMirror-code\");\n    d.selectionDiv = elt(\"div\", null, null, \"position: relative; z-index: 1\");\n    // Blinky cursor, and element used to ensure cursor fits at the end of a line\n    d.cursor = elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor\");\n    // Secondary cursor, shown when on a 'jump' in bi-directional text\n    d.otherCursor = elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor CodeMirror-secondarycursor\");\n    // Used to measure text size\n    d.measure = elt(\"div\", null, \"CodeMirror-measure\");\n    // Wraps everything that needs to exist inside the vertically-padded coordinate system\n    d.lineSpace = elt(\"div\", [d.measure, d.selectionDiv, d.lineDiv, d.cursor, d.otherCursor],\n                         null, \"position: relative; outline: none\");\n    // Moved around its parent to cover visible view\n    d.mover = elt(\"div\", [elt(\"div\", [d.lineSpace], \"CodeMirror-lines\")], null, \"position: relative\");\n    // Set to the height of the text, causes scrolling\n    d.sizer = elt(\"div\", [d.mover], \"CodeMirror-sizer\");\n    // D is needed because behavior of elts with overflow: auto and padding is inconsistent across browsers\n    d.heightForcer = elt(\"div\", null, null, \"position: absolute; height: \" + scrollerCutOff + \"px; width: 1px;\");\n    // Will contain the gutters, if any\n    d.gutters = elt(\"div\", null, \"CodeMirror-gutters\");\n    d.lineGutter = null;\n    // Provides scrolling\n    d.scroller = elt(\"div\", [d.sizer, d.heightForcer, d.gutters], \"CodeMirror-scroll\");\n    d.scroller.setAttribute(\"tabIndex\", \"-1\");\n    // The element in which the editor lives.\n    d.wrapper = elt(\"div\", [d.inputDiv, d.scrollbarH, d.scrollbarV,\n                            d.scrollbarFiller, d.gutterFiller, d.scroller], \"CodeMirror\");\n    // Work around IE7 z-index bug\n    if (ie_lt8) { d.gutters.style.zIndex = -1; d.scroller.style.paddingRight = 0; }\n    if (place.appendChild) place.appendChild(d.wrapper); else place(d.wrapper);\n\n    // Needed to hide big blue blinking cursor on Mobile Safari\n    if (ios) input.style.width = \"0px\";\n    if (!webkit) d.scroller.draggable = true;\n    // Needed to handle Tab key in KHTML\n    if (khtml) { d.inputDiv.style.height = \"1px\"; d.inputDiv.style.position = \"absolute\"; }\n    // Need to set a minimum width to see the scrollbar on IE7 (but must not set it on IE8).\n    else if (ie_lt8) d.scrollbarH.style.minWidth = d.scrollbarV.style.minWidth = \"18px\";\n\n    // Current visible range (may be bigger than the view window).\n    d.viewOffset = d.lastSizeC = 0;\n    d.showingFrom = d.showingTo = docStart;\n\n    // Used to only resize the line number gutter when necessary (when\n    // the amount of lines crosses a boundary that makes its width change)\n    d.lineNumWidth = d.lineNumInnerWidth = d.lineNumChars = null;\n    // See readInput and resetInput\n    d.prevInput = \"\";\n    // Set to true when a non-horizontal-scrolling widget is added. As\n    // an optimization, widget aligning is skipped when d is false.\n    d.alignWidgets = false;\n    // Flag that indicates whether we currently expect input to appear\n    // (after some event like 'keypress' or 'input') and are polling\n    // intensively.\n    d.pollingFast = false;\n    // Self-resetting timeout for the poller\n    d.poll = new Delayed();\n\n    d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n    d.measureLineCache = [];\n    d.measureLineCachePos = 0;\n\n    // Tracks when resetInput has punted to just putting a short\n    // string instead of the (large) selection.\n    d.inaccurateSelection = false;\n\n    // Tracks the maximum line length so that the horizontal scrollbar\n    // can be kept static when scrolling.\n    d.maxLine = null;\n    d.maxLineLength = 0;\n    d.maxLineChanged = false;\n\n    // Used for measuring wheel scrolling granularity\n    d.wheelDX = d.wheelDY = d.wheelStartX = d.wheelStartY = null;\n\n    return d;\n  }\n\n  // STATE UPDATES\n\n  // Used to get the editor into a consistent state again when options change.\n\n  function loadMode(cm) {\n    cm.doc.mode = CodeMirror.getMode(cm.options, cm.doc.modeOption);\n    resetModeState(cm);\n  }\n\n  function resetModeState(cm) {\n    cm.doc.iter(function(line) {\n      if (line.stateAfter) line.stateAfter = null;\n      if (line.styles) line.styles = null;\n    });\n    cm.doc.frontier = cm.doc.first;\n    startWorker(cm, 100);\n    cm.state.modeGen++;\n    if (cm.curOp) regChange(cm);\n  }\n\n  function wrappingChanged(cm) {\n    if (cm.options.lineWrapping) {\n      cm.display.wrapper.className += \" CodeMirror-wrap\";\n      cm.display.sizer.style.minWidth = \"\";\n    } else {\n      cm.display.wrapper.className = cm.display.wrapper.className.replace(\" CodeMirror-wrap\", \"\");\n      computeMaxLength(cm);\n    }\n    estimateLineHeights(cm);\n    regChange(cm);\n    clearCaches(cm);\n    setTimeout(function(){updateScrollbars(cm);}, 100);\n  }\n\n  function estimateHeight(cm) {\n    var th = textHeight(cm.display), wrapping = cm.options.lineWrapping;\n    var perLine = wrapping && Math.max(5, cm.display.scroller.clientWidth / charWidth(cm.display) - 3);\n    return function(line) {\n      if (lineIsHidden(cm.doc, line))\n        return 0;\n      else if (wrapping)\n        return (Math.ceil(line.text.length / perLine) || 1) * th;\n      else\n        return th;\n    };\n  }\n\n  function estimateLineHeights(cm) {\n    var doc = cm.doc, est = estimateHeight(cm);\n    doc.iter(function(line) {\n      var estHeight = est(line);\n      if (estHeight != line.height) updateLineHeight(line, estHeight);\n    });\n  }\n\n  function keyMapChanged(cm) {\n    var map = keyMap[cm.options.keyMap], style = map.style;\n    cm.display.wrapper.className = cm.display.wrapper.className.replace(/\\s*cm-keymap-\\S+/g, \"\") +\n      (style ? \" cm-keymap-\" + style : \"\");\n  }\n\n  function themeChanged(cm) {\n    cm.display.wrapper.className = cm.display.wrapper.className.replace(/\\s*cm-s-\\S+/g, \"\") +\n      cm.options.theme.replace(/(^|\\s)\\s*/g, \" cm-s-\");\n    clearCaches(cm);\n  }\n\n  function guttersChanged(cm) {\n    updateGutters(cm);\n    regChange(cm);\n    setTimeout(function(){alignHorizontally(cm);}, 20);\n  }\n\n  function updateGutters(cm) {\n    var gutters = cm.display.gutters, specs = cm.options.gutters;\n    removeChildren(gutters);\n    for (var i = 0; i < specs.length; ++i) {\n      var gutterClass = specs[i];\n      var gElt = gutters.appendChild(elt(\"div\", null, \"CodeMirror-gutter \" + gutterClass));\n      if (gutterClass == \"CodeMirror-linenumbers\") {\n        cm.display.lineGutter = gElt;\n        gElt.style.width = (cm.display.lineNumWidth || 1) + \"px\";\n      }\n    }\n    gutters.style.display = i ? \"\" : \"none\";\n  }\n\n  function lineLength(doc, line) {\n    if (line.height == 0) return 0;\n    var len = line.text.length, merged, cur = line;\n    while (merged = collapsedSpanAtStart(cur)) {\n      var found = merged.find();\n      cur = getLine(doc, found.from.line);\n      len += found.from.ch - found.to.ch;\n    }\n    cur = line;\n    while (merged = collapsedSpanAtEnd(cur)) {\n      var found = merged.find();\n      len -= cur.text.length - found.from.ch;\n      cur = getLine(doc, found.to.line);\n      len += cur.text.length - found.to.ch;\n    }\n    return len;\n  }\n\n  function computeMaxLength(cm) {\n    var d = cm.display, doc = cm.doc;\n    d.maxLine = getLine(doc, doc.first);\n    d.maxLineLength = lineLength(doc, d.maxLine);\n    d.maxLineChanged = true;\n    doc.iter(function(line) {\n      var len = lineLength(doc, line);\n      if (len > d.maxLineLength) {\n        d.maxLineLength = len;\n        d.maxLine = line;\n      }\n    });\n  }\n\n  // Make sure the gutters options contains the element\n  // \"CodeMirror-linenumbers\" when the lineNumbers option is true.\n  function setGuttersForLineNumbers(options) {\n    var found = indexOf(options.gutters, \"CodeMirror-linenumbers\");\n    if (found == -1 && options.lineNumbers) {\n      options.gutters = options.gutters.concat([\"CodeMirror-linenumbers\"]);\n    } else if (found > -1 && !options.lineNumbers) {\n      options.gutters = options.gutters.slice(0);\n      options.gutters.splice(found, 1);\n    }\n  }\n\n  // SCROLLBARS\n\n  // Re-synchronize the fake scrollbars with the actual size of the\n  // content. Optionally force a scrollTop.\n  function updateScrollbars(cm) {\n    var d = cm.display, docHeight = cm.doc.height;\n    var totalHeight = docHeight + paddingVert(d);\n    d.sizer.style.minHeight = d.heightForcer.style.top = totalHeight + \"px\";\n    d.gutters.style.height = Math.max(totalHeight, d.scroller.clientHeight - scrollerCutOff) + \"px\";\n    var scrollHeight = Math.max(totalHeight, d.scroller.scrollHeight);\n    var needsH = d.scroller.scrollWidth > (d.scroller.clientWidth + 1);\n    var needsV = scrollHeight > (d.scroller.clientHeight + 1);\n    if (needsV) {\n      d.scrollbarV.style.display = \"block\";\n      d.scrollbarV.style.bottom = needsH ? scrollbarWidth(d.measure) + \"px\" : \"0\";\n      // A bug in IE8 can cause this value to be negative, so guard it.\n      d.scrollbarV.firstChild.style.height =\n        Math.max(0, scrollHeight - d.scroller.clientHeight + d.scrollbarV.clientHeight) + \"px\";\n    } else {\n      d.scrollbarV.style.display = \"\";\n      d.scrollbarV.firstChild.style.height = \"0\";\n    }\n    if (needsH) {\n      d.scrollbarH.style.display = \"block\";\n      d.scrollbarH.style.right = needsV ? scrollbarWidth(d.measure) + \"px\" : \"0\";\n      d.scrollbarH.firstChild.style.width =\n        (d.scroller.scrollWidth - d.scroller.clientWidth + d.scrollbarH.clientWidth) + \"px\";\n    } else {\n      d.scrollbarH.style.display = \"\";\n      d.scrollbarH.firstChild.style.width = \"0\";\n    }\n    if (needsH && needsV) {\n      d.scrollbarFiller.style.display = \"block\";\n      d.scrollbarFiller.style.height = d.scrollbarFiller.style.width = scrollbarWidth(d.measure) + \"px\";\n    } else d.scrollbarFiller.style.display = \"\";\n    if (needsH && cm.options.coverGutterNextToScrollbar && cm.options.fixedGutter) {\n      d.gutterFiller.style.display = \"block\";\n      d.gutterFiller.style.height = scrollbarWidth(d.measure) + \"px\";\n      d.gutterFiller.style.width = d.gutters.offsetWidth + \"px\";\n    } else d.gutterFiller.style.display = \"\";\n\n    if (mac_geLion && scrollbarWidth(d.measure) === 0) {\n      d.scrollbarV.style.minWidth = d.scrollbarH.style.minHeight = mac_geMountainLion ? \"18px\" : \"12px\";\n      d.scrollbarV.style.pointerEvents = d.scrollbarH.style.pointerEvents = \"none\";\n    }\n  }\n\n  function visibleLines(display, doc, viewPort) {\n    var top = display.scroller.scrollTop, height = display.wrapper.clientHeight;\n    if (typeof viewPort == \"number\") top = viewPort;\n    else if (viewPort) {top = viewPort.top; height = viewPort.bottom - viewPort.top;}\n    top = Math.floor(top - paddingTop(display));\n    var bottom = Math.ceil(top + height);\n    return {from: lineAtHeight(doc, top), to: lineAtHeight(doc, bottom)};\n  }\n\n  // LINE NUMBERS\n\n  function alignHorizontally(cm) {\n    var display = cm.display;\n    if (!display.alignWidgets && (!display.gutters.firstChild || !cm.options.fixedGutter)) return;\n    var comp = compensateForHScroll(display) - display.scroller.scrollLeft + cm.doc.scrollLeft;\n    var gutterW = display.gutters.offsetWidth, l = comp + \"px\";\n    for (var n = display.lineDiv.firstChild; n; n = n.nextSibling) if (n.alignable) {\n      for (var i = 0, a = n.alignable; i < a.length; ++i) a[i].style.left = l;\n    }\n    if (cm.options.fixedGutter)\n      display.gutters.style.left = (comp + gutterW) + \"px\";\n  }\n\n  function maybeUpdateLineNumberWidth(cm) {\n    if (!cm.options.lineNumbers) return false;\n    var doc = cm.doc, last = lineNumberFor(cm.options, doc.first + doc.size - 1), display = cm.display;\n    if (last.length != display.lineNumChars) {\n      var test = display.measure.appendChild(elt(\"div\", [elt(\"div\", last)],\n                                                 \"CodeMirror-linenumber CodeMirror-gutter-elt\"));\n      var innerW = test.firstChild.offsetWidth, padding = test.offsetWidth - innerW;\n      display.lineGutter.style.width = \"\";\n      display.lineNumInnerWidth = Math.max(innerW, display.lineGutter.offsetWidth - padding);\n      display.lineNumWidth = display.lineNumInnerWidth + padding;\n      display.lineNumChars = display.lineNumInnerWidth ? last.length : -1;\n      display.lineGutter.style.width = display.lineNumWidth + \"px\";\n      return true;\n    }\n    return false;\n  }\n\n  function lineNumberFor(options, i) {\n    return String(options.lineNumberFormatter(i + options.firstLineNumber));\n  }\n  function compensateForHScroll(display) {\n    return getRect(display.scroller).left - getRect(display.sizer).left;\n  }\n\n  // DISPLAY DRAWING\n\n  function updateDisplay(cm, changes, viewPort, forced) {\n    var oldFrom = cm.display.showingFrom, oldTo = cm.display.showingTo, updated;\n    var visible = visibleLines(cm.display, cm.doc, viewPort);\n    for (var first = true;; first = false) {\n      var oldWidth = cm.display.scroller.clientWidth;\n      if (!updateDisplayInner(cm, changes, visible, forced)) break;\n      updated = true;\n      changes = [];\n      updateSelection(cm);\n      updateScrollbars(cm);\n      if (first && cm.options.lineWrapping && oldWidth != cm.display.scroller.clientWidth) {\n        forced = true;\n        continue;\n      }\n      forced = false;\n\n      // Clip forced viewport to actual scrollable area\n      if (viewPort)\n        viewPort = Math.min(cm.display.scroller.scrollHeight - cm.display.scroller.clientHeight,\n                            typeof viewPort == \"number\" ? viewPort : viewPort.top);\n      visible = visibleLines(cm.display, cm.doc, viewPort);\n      if (visible.from >= cm.display.showingFrom && visible.to <= cm.display.showingTo)\n        break;\n    }\n\n    if (updated) {\n      signalLater(cm, \"update\", cm);\n      if (cm.display.showingFrom != oldFrom || cm.display.showingTo != oldTo)\n        signalLater(cm, \"viewportChange\", cm, cm.display.showingFrom, cm.display.showingTo);\n    }\n    return updated;\n  }\n\n  // Uses a set of changes plus the current scroll position to\n  // determine which DOM updates have to be made, and makes the\n  // updates.\n  function updateDisplayInner(cm, changes, visible, forced) {\n    var display = cm.display, doc = cm.doc;\n    if (!display.wrapper.offsetWidth) {\n      display.showingFrom = display.showingTo = doc.first;\n      display.viewOffset = 0;\n      return;\n    }\n\n    // Bail out if the visible area is already rendered and nothing changed.\n    if (!forced && changes.length == 0 &&\n        visible.from > display.showingFrom && visible.to < display.showingTo)\n      return;\n\n    if (maybeUpdateLineNumberWidth(cm))\n      changes = [{from: doc.first, to: doc.first + doc.size}];\n    var gutterW = display.sizer.style.marginLeft = display.gutters.offsetWidth + \"px\";\n    display.scrollbarH.style.left = cm.options.fixedGutter ? gutterW : \"0\";\n\n    // Used to determine which lines need their line numbers updated\n    var positionsChangedFrom = Infinity;\n    if (cm.options.lineNumbers)\n      for (var i = 0; i < changes.length; ++i)\n        if (changes[i].diff && changes[i].from < positionsChangedFrom) { positionsChangedFrom = changes[i].from; }\n\n    var end = doc.first + doc.size;\n    var from = Math.max(visible.from - cm.options.viewportMargin, doc.first);\n    var to = Math.min(end, visible.to + cm.options.viewportMargin);\n    if (display.showingFrom < from && from - display.showingFrom < 20) from = Math.max(doc.first, display.showingFrom);\n    if (display.showingTo > to && display.showingTo - to < 20) to = Math.min(end, display.showingTo);\n    if (sawCollapsedSpans) {\n      from = lineNo(visualLine(doc, getLine(doc, from)));\n      while (to < end && lineIsHidden(doc, getLine(doc, to))) ++to;\n    }\n\n    // Create a range of theoretically intact lines, and punch holes\n    // in that using the change info.\n    var intact = [{from: Math.max(display.showingFrom, doc.first),\n                   to: Math.min(display.showingTo, end)}];\n    if (intact[0].from >= intact[0].to) intact = [];\n    else intact = computeIntact(intact, changes);\n    // When merged lines are present, we might have to reduce the\n    // intact ranges because changes in continued fragments of the\n    // intact lines do require the lines to be redrawn.\n    if (sawCollapsedSpans)\n      for (var i = 0; i < intact.length; ++i) {\n        var range = intact[i], merged;\n        while (merged = collapsedSpanAtEnd(getLine(doc, range.to - 1))) {\n          var newTo = merged.find().from.line;\n          if (newTo > range.from) range.to = newTo;\n          else { intact.splice(i--, 1); break; }\n        }\n      }\n\n    // Clip off the parts that won't be visible\n    var intactLines = 0;\n    for (var i = 0; i < intact.length; ++i) {\n      var range = intact[i];\n      if (range.from < from) range.from = from;\n      if (range.to > to) range.to = to;\n      if (range.from >= range.to) intact.splice(i--, 1);\n      else intactLines += range.to - range.from;\n    }\n    if (!forced && intactLines == to - from && from == display.showingFrom && to == display.showingTo) {\n      updateViewOffset(cm);\n      return;\n    }\n    intact.sort(function(a, b) {return a.from - b.from;});\n\n    // Avoid crashing on IE's \"unspecified error\" when in iframes\n    try {\n      var focused = document.activeElement;\n    } catch(e) {}\n    if (intactLines < (to - from) * .7) display.lineDiv.style.display = \"none\";\n    patchDisplay(cm, from, to, intact, positionsChangedFrom);\n    display.lineDiv.style.display = \"\";\n    if (focused && document.activeElement != focused && focused.offsetHeight) focused.focus();\n\n    var different = from != display.showingFrom || to != display.showingTo ||\n      display.lastSizeC != display.wrapper.clientHeight;\n    // This is just a bogus formula that detects when the editor is\n    // resized or the font size changes.\n    if (different) {\n      display.lastSizeC = display.wrapper.clientHeight;\n      startWorker(cm, 400);\n    }\n    display.showingFrom = from; display.showingTo = to;\n\n    display.gutters.style.height = \"\";\n    updateHeightsInViewport(cm);\n    updateViewOffset(cm);\n\n    return true;\n  }\n\n  function updateHeightsInViewport(cm) {\n    var display = cm.display;\n    var prevBottom = display.lineDiv.offsetTop;\n    for (var node = display.lineDiv.firstChild, height; node; node = node.nextSibling) if (node.lineObj) {\n      if (ie_lt8) {\n        var bot = node.offsetTop + node.offsetHeight;\n        height = bot - prevBottom;\n        prevBottom = bot;\n      } else {\n        var box = getRect(node);\n        height = box.bottom - box.top;\n      }\n      var diff = node.lineObj.height - height;\n      if (height < 2) height = textHeight(display);\n      if (diff > .001 || diff < -.001) {\n        updateLineHeight(node.lineObj, height);\n        var widgets = node.lineObj.widgets;\n        if (widgets) for (var i = 0; i < widgets.length; ++i)\n          widgets[i].height = widgets[i].node.offsetHeight;\n      }\n    }\n  }\n\n  function updateViewOffset(cm) {\n    var off = cm.display.viewOffset = heightAtLine(cm, getLine(cm.doc, cm.display.showingFrom));\n    // Position the mover div to align with the current virtual scroll position\n    cm.display.mover.style.top = off + \"px\";\n  }\n\n  function computeIntact(intact, changes) {\n    for (var i = 0, l = changes.length || 0; i < l; ++i) {\n      var change = changes[i], intact2 = [], diff = change.diff || 0;\n      for (var j = 0, l2 = intact.length; j < l2; ++j) {\n        var range = intact[j];\n        if (change.to <= range.from && change.diff) {\n          intact2.push({from: range.from + diff, to: range.to + diff});\n        } else if (change.to <= range.from || change.from >= range.to) {\n          intact2.push(range);\n        } else {\n          if (change.from > range.from)\n            intact2.push({from: range.from, to: change.from});\n          if (change.to < range.to)\n            intact2.push({from: change.to + diff, to: range.to + diff});\n        }\n      }\n      intact = intact2;\n    }\n    return intact;\n  }\n\n  function getDimensions(cm) {\n    var d = cm.display, left = {}, width = {};\n    for (var n = d.gutters.firstChild, i = 0; n; n = n.nextSibling, ++i) {\n      left[cm.options.gutters[i]] = n.offsetLeft;\n      width[cm.options.gutters[i]] = n.offsetWidth;\n    }\n    return {fixedPos: compensateForHScroll(d),\n            gutterTotalWidth: d.gutters.offsetWidth,\n            gutterLeft: left,\n            gutterWidth: width,\n            wrapperWidth: d.wrapper.clientWidth};\n  }\n\n  function patchDisplay(cm, from, to, intact, updateNumbersFrom) {\n    var dims = getDimensions(cm);\n    var display = cm.display, lineNumbers = cm.options.lineNumbers;\n    if (!intact.length && (!webkit || !cm.display.currentWheelTarget))\n      removeChildren(display.lineDiv);\n    var container = display.lineDiv, cur = container.firstChild;\n\n    function rm(node) {\n      var next = node.nextSibling;\n      if (webkit && mac && cm.display.currentWheelTarget == node) {\n        node.style.display = \"none\";\n        node.lineObj = null;\n      } else {\n        node.parentNode.removeChild(node);\n      }\n      return next;\n    }\n\n    var nextIntact = intact.shift(), lineN = from;\n    cm.doc.iter(from, to, function(line) {\n      if (nextIntact && nextIntact.to == lineN) nextIntact = intact.shift();\n      if (lineIsHidden(cm.doc, line)) {\n        if (line.height != 0) updateLineHeight(line, 0);\n        if (line.widgets && cur && cur.previousSibling) for (var i = 0; i < line.widgets.length; ++i) {\n          var w = line.widgets[i];\n          if (w.showIfHidden) {\n            var prev = cur.previousSibling;\n            if (/pre/i.test(prev.nodeName)) {\n              var wrap = elt(\"div\", null, null, \"position: relative\");\n              prev.parentNode.replaceChild(wrap, prev);\n              wrap.appendChild(prev);\n              prev = wrap;\n            }\n            var wnode = prev.appendChild(elt(\"div\", [w.node], \"CodeMirror-linewidget\"));\n            if (!w.handleMouseEvents) wnode.ignoreEvents = true;\n            positionLineWidget(w, wnode, prev, dims);\n          }\n        }\n      } else if (nextIntact && nextIntact.from <= lineN && nextIntact.to > lineN) {\n        // This line is intact. Skip to the actual node. Update its\n        // line number if needed.\n        while (cur.lineObj != line) cur = rm(cur);\n        if (lineNumbers && updateNumbersFrom <= lineN && cur.lineNumber)\n          setTextContent(cur.lineNumber, lineNumberFor(cm.options, lineN));\n        cur = cur.nextSibling;\n      } else {\n        // For lines with widgets, make an attempt to find and reuse\n        // the existing element, so that widgets aren't needlessly\n        // removed and re-inserted into the dom\n        if (line.widgets) for (var j = 0, search = cur, reuse; search && j < 20; ++j, search = search.nextSibling)\n          if (search.lineObj == line && /div/i.test(search.nodeName)) { reuse = search; break; }\n        // This line needs to be generated.\n        var lineNode = buildLineElement(cm, line, lineN, dims, reuse);\n        if (lineNode != reuse) {\n          container.insertBefore(lineNode, cur);\n        } else {\n          while (cur != reuse) cur = rm(cur);\n          cur = cur.nextSibling;\n        }\n\n        lineNode.lineObj = line;\n      }\n      ++lineN;\n    });\n    while (cur) cur = rm(cur);\n  }\n\n  function buildLineElement(cm, line, lineNo, dims, reuse) {\n    var built = buildLineContent(cm, line), lineElement = built.pre;\n    var markers = line.gutterMarkers, display = cm.display, wrap;\n\n    var bgClass = built.bgClass ? built.bgClass + \" \" + (line.bgClass || \"\") : line.bgClass;\n    if (!cm.options.lineNumbers && !markers && !bgClass && !line.wrapClass && !line.widgets)\n      return lineElement;\n\n    // Lines with gutter elements, widgets or a background class need\n    // to be wrapped again, and have the extra elements added to the\n    // wrapper div\n\n    if (reuse) {\n      reuse.alignable = null;\n      var isOk = true, widgetsSeen = 0, insertBefore = null;\n      for (var n = reuse.firstChild, next; n; n = next) {\n        next = n.nextSibling;\n        if (!/\\bCodeMirror-linewidget\\b/.test(n.className)) {\n          reuse.removeChild(n);\n        } else {\n          for (var i = 0; i < line.widgets.length; ++i) {\n            var widget = line.widgets[i];\n            if (widget.node == n.firstChild) {\n              if (!widget.above && !insertBefore) insertBefore = n;\n              positionLineWidget(widget, n, reuse, dims);\n              ++widgetsSeen;\n              break;\n            }\n          }\n          if (i == line.widgets.length) { isOk = false; break; }\n        }\n      }\n      reuse.insertBefore(lineElement, insertBefore);\n      if (isOk && widgetsSeen == line.widgets.length) {\n        wrap = reuse;\n        reuse.className = line.wrapClass || \"\";\n      }\n    }\n    if (!wrap) {\n      wrap = elt(\"div\", null, line.wrapClass, \"position: relative\");\n      wrap.appendChild(lineElement);\n    }\n    // Kludge to make sure the styled element lies behind the selection (by z-index)\n    if (bgClass)\n      wrap.insertBefore(elt(\"div\", null, bgClass + \" CodeMirror-linebackground\"), wrap.firstChild);\n    if (cm.options.lineNumbers || markers) {\n      var gutterWrap = wrap.insertBefore(elt(\"div\", null, \"CodeMirror-gutter-wrapper\", \"position: absolute; left: \" +\n                                             (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px\"),\n                                         lineElement);\n      if (cm.options.fixedGutter) (wrap.alignable || (wrap.alignable = [])).push(gutterWrap);\n      if (cm.options.lineNumbers && (!markers || !markers[\"CodeMirror-linenumbers\"]))\n        wrap.lineNumber = gutterWrap.appendChild(\n          elt(\"div\", lineNumberFor(cm.options, lineNo),\n              \"CodeMirror-linenumber CodeMirror-gutter-elt\",\n              \"left: \" + dims.gutterLeft[\"CodeMirror-linenumbers\"] + \"px; width: \"\n              + display.lineNumInnerWidth + \"px\"));\n      if (markers)\n        for (var k = 0; k < cm.options.gutters.length; ++k) {\n          var id = cm.options.gutters[k], found = markers.hasOwnProperty(id) && markers[id];\n          if (found)\n            gutterWrap.appendChild(elt(\"div\", [found], \"CodeMirror-gutter-elt\", \"left: \" +\n                                       dims.gutterLeft[id] + \"px; width: \" + dims.gutterWidth[id] + \"px\"));\n        }\n    }\n    if (ie_lt8) wrap.style.zIndex = 2;\n    if (line.widgets && wrap != reuse) for (var i = 0, ws = line.widgets; i < ws.length; ++i) {\n      var widget = ws[i], node = elt(\"div\", [widget.node], \"CodeMirror-linewidget\");\n      if (!widget.handleMouseEvents) node.ignoreEvents = true;\n      positionLineWidget(widget, node, wrap, dims);\n      if (widget.above)\n        wrap.insertBefore(node, cm.options.lineNumbers && line.height != 0 ? gutterWrap : lineElement);\n      else\n        wrap.appendChild(node);\n      signalLater(widget, \"redraw\");\n    }\n    return wrap;\n  }\n\n  function positionLineWidget(widget, node, wrap, dims) {\n    if (widget.noHScroll) {\n      (wrap.alignable || (wrap.alignable = [])).push(node);\n      var width = dims.wrapperWidth;\n      node.style.left = dims.fixedPos + \"px\";\n      if (!widget.coverGutter) {\n        width -= dims.gutterTotalWidth;\n        node.style.paddingLeft = dims.gutterTotalWidth + \"px\";\n      }\n      node.style.width = width + \"px\";\n    }\n    if (widget.coverGutter) {\n      node.style.zIndex = 5;\n      node.style.position = \"relative\";\n      if (!widget.noHScroll) node.style.marginLeft = -dims.gutterTotalWidth + \"px\";\n    }\n  }\n\n  // SELECTION / CURSOR\n\n  function updateSelection(cm) {\n    var display = cm.display;\n    var collapsed = posEq(cm.doc.sel.from, cm.doc.sel.to);\n    if (collapsed || cm.options.showCursorWhenSelecting)\n      updateSelectionCursor(cm);\n    else\n      display.cursor.style.display = display.otherCursor.style.display = \"none\";\n    if (!collapsed)\n      updateSelectionRange(cm);\n    else\n      display.selectionDiv.style.display = \"none\";\n\n    // Move the hidden textarea near the cursor to prevent scrolling artifacts\n    if (cm.options.moveInputWithCursor) {\n      var headPos = cursorCoords(cm, cm.doc.sel.head, \"div\");\n      var wrapOff = getRect(display.wrapper), lineOff = getRect(display.lineDiv);\n      display.inputDiv.style.top = Math.max(0, Math.min(display.wrapper.clientHeight - 10,\n                                                        headPos.top + lineOff.top - wrapOff.top)) + \"px\";\n      display.inputDiv.style.left = Math.max(0, Math.min(display.wrapper.clientWidth - 10,\n                                                         headPos.left + lineOff.left - wrapOff.left)) + \"px\";\n    }\n  }\n\n  // No selection, plain cursor\n  function updateSelectionCursor(cm) {\n    var display = cm.display, pos = cursorCoords(cm, cm.doc.sel.head, \"div\");\n    display.cursor.style.left = pos.left + \"px\";\n    display.cursor.style.top = pos.top + \"px\";\n    display.cursor.style.height = Math.max(0, pos.bottom - pos.top) * cm.options.cursorHeight + \"px\";\n    display.cursor.style.display = \"\";\n\n    if (pos.other) {\n      display.otherCursor.style.display = \"\";\n      display.otherCursor.style.left = pos.other.left + \"px\";\n      display.otherCursor.style.top = pos.other.top + \"px\";\n      display.otherCursor.style.height = (pos.other.bottom - pos.other.top) * .85 + \"px\";\n    } else { display.otherCursor.style.display = \"none\"; }\n  }\n\n  // Highlight selection\n  function updateSelectionRange(cm) {\n    var display = cm.display, doc = cm.doc, sel = cm.doc.sel;\n    var fragment = document.createDocumentFragment();\n    var padding = paddingH(cm.display), leftSide = padding.left, rightSide = display.lineSpace.offsetWidth - padding.right;\n\n    function add(left, top, width, bottom) {\n      if (top < 0) top = 0;\n      fragment.appendChild(elt(\"div\", null, \"CodeMirror-selected\", \"position: absolute; left: \" + left +\n                               \"px; top: \" + top + \"px; width: \" + (width == null ? rightSide - left : width) +\n                               \"px; height: \" + (bottom - top) + \"px\"));\n    }\n\n    function drawForLine(line, fromArg, toArg) {\n      var lineObj = getLine(doc, line);\n      var lineLen = lineObj.text.length;\n      var start, end;\n      function coords(ch, bias) {\n        return charCoords(cm, Pos(line, ch), \"div\", lineObj, bias);\n      }\n\n      iterateBidiSections(getOrder(lineObj), fromArg || 0, toArg == null ? lineLen : toArg, function(from, to, dir) {\n        var leftPos = coords(from, \"left\"), rightPos, left, right;\n        if (from == to) {\n          rightPos = leftPos;\n          left = right = leftPos.left;\n        } else {\n          rightPos = coords(to - 1, \"right\");\n          if (dir == \"rtl\") { var tmp = leftPos; leftPos = rightPos; rightPos = tmp; }\n          left = leftPos.left;\n          right = rightPos.right;\n        }\n        if (fromArg == null && from == 0) left = leftSide;\n        if (rightPos.top - leftPos.top > 3) { // Different lines, draw top part\n          add(left, leftPos.top, null, leftPos.bottom);\n          left = leftSide;\n          if (leftPos.bottom < rightPos.top) add(left, leftPos.bottom, null, rightPos.top);\n        }\n        if (toArg == null && to == lineLen) right = rightSide;\n        if (!start || leftPos.top < start.top || leftPos.top == start.top && leftPos.left < start.left)\n          start = leftPos;\n        if (!end || rightPos.bottom > end.bottom || rightPos.bottom == end.bottom && rightPos.right > end.right)\n          end = rightPos;\n        if (left < leftSide + 1) left = leftSide;\n        add(left, rightPos.top, right - left, rightPos.bottom);\n      });\n      return {start: start, end: end};\n    }\n\n    if (sel.from.line == sel.to.line) {\n      drawForLine(sel.from.line, sel.from.ch, sel.to.ch);\n    } else {\n      var fromLine = getLine(doc, sel.from.line), toLine = getLine(doc, sel.to.line);\n      var singleVLine = visualLine(doc, fromLine) == visualLine(doc, toLine);\n      var leftEnd = drawForLine(sel.from.line, sel.from.ch, singleVLine ? fromLine.text.length : null).end;\n      var rightStart = drawForLine(sel.to.line, singleVLine ? 0 : null, sel.to.ch).start;\n      if (singleVLine) {\n        if (leftEnd.top < rightStart.top - 2) {\n          add(leftEnd.right, leftEnd.top, null, leftEnd.bottom);\n          add(leftSide, rightStart.top, rightStart.left, rightStart.bottom);\n        } else {\n          add(leftEnd.right, leftEnd.top, rightStart.left - leftEnd.right, leftEnd.bottom);\n        }\n      }\n      if (leftEnd.bottom < rightStart.top)\n        add(leftSide, leftEnd.bottom, null, rightStart.top);\n    }\n\n    removeChildrenAndAdd(display.selectionDiv, fragment);\n    display.selectionDiv.style.display = \"\";\n  }\n\n  // Cursor-blinking\n  function restartBlink(cm) {\n    if (!cm.state.focused) return;\n    var display = cm.display;\n    clearInterval(display.blinker);\n    var on = true;\n    display.cursor.style.visibility = display.otherCursor.style.visibility = \"\";\n    if (cm.options.cursorBlinkRate > 0)\n      display.blinker = setInterval(function() {\n        display.cursor.style.visibility = display.otherCursor.style.visibility = (on = !on) ? \"\" : \"hidden\";\n      }, cm.options.cursorBlinkRate);\n  }\n\n  // HIGHLIGHT WORKER\n\n  function startWorker(cm, time) {\n    if (cm.doc.mode.startState && cm.doc.frontier < cm.display.showingTo)\n      cm.state.highlight.set(time, bind(highlightWorker, cm));\n  }\n\n  function highlightWorker(cm) {\n    var doc = cm.doc;\n    if (doc.frontier < doc.first) doc.frontier = doc.first;\n    if (doc.frontier >= cm.display.showingTo) return;\n    var end = +new Date + cm.options.workTime;\n    var state = copyState(doc.mode, getStateBefore(cm, doc.frontier));\n    var changed = [], prevChange;\n    doc.iter(doc.frontier, Math.min(doc.first + doc.size, cm.display.showingTo + 500), function(line) {\n      if (doc.frontier >= cm.display.showingFrom) { // Visible\n        var oldStyles = line.styles;\n        line.styles = highlightLine(cm, line, state, true);\n        var ischange = !oldStyles || oldStyles.length != line.styles.length;\n        for (var i = 0; !ischange && i < oldStyles.length; ++i) ischange = oldStyles[i] != line.styles[i];\n        if (ischange) {\n          if (prevChange && prevChange.end == doc.frontier) prevChange.end++;\n          else changed.push(prevChange = {start: doc.frontier, end: doc.frontier + 1});\n        }\n        line.stateAfter = copyState(doc.mode, state);\n      } else {\n        processLine(cm, line.text, state);\n        line.stateAfter = doc.frontier % 5 == 0 ? copyState(doc.mode, state) : null;\n      }\n      ++doc.frontier;\n      if (+new Date > end) {\n        startWorker(cm, cm.options.workDelay);\n        return true;\n      }\n    });\n    if (changed.length)\n      operation(cm, function() {\n        for (var i = 0; i < changed.length; ++i)\n          regChange(this, changed[i].start, changed[i].end);\n      })();\n  }\n\n  // Finds the line to start with when starting a parse. Tries to\n  // find a line with a stateAfter, so that it can start with a\n  // valid state. If that fails, it returns the line with the\n  // smallest indentation, which tends to need the least context to\n  // parse correctly.\n  function findStartLine(cm, n, precise) {\n    var minindent, minline, doc = cm.doc;\n    var lim = precise ? -1 : n - (cm.doc.mode.innerMode ? 1000 : 100);\n    for (var search = n; search > lim; --search) {\n      if (search <= doc.first) return doc.first;\n      var line = getLine(doc, search - 1);\n      if (line.stateAfter && (!precise || search <= doc.frontier)) return search;\n      var indented = countColumn(line.text, null, cm.options.tabSize);\n      if (minline == null || minindent > indented) {\n        minline = search - 1;\n        minindent = indented;\n      }\n    }\n    return minline;\n  }\n\n  function getStateBefore(cm, n, precise) {\n    var doc = cm.doc, display = cm.display;\n    if (!doc.mode.startState) return true;\n    var pos = findStartLine(cm, n, precise), state = pos > doc.first && getLine(doc, pos-1).stateAfter;\n    if (!state) state = startState(doc.mode);\n    else state = copyState(doc.mode, state);\n    doc.iter(pos, n, function(line) {\n      processLine(cm, line.text, state);\n      var save = pos == n - 1 || pos % 5 == 0 || pos >= display.showingFrom && pos < display.showingTo;\n      line.stateAfter = save ? copyState(doc.mode, state) : null;\n      ++pos;\n    });\n    if (precise) doc.frontier = pos;\n    return state;\n  }\n\n  // POSITION MEASUREMENT\n\n  function paddingTop(display) {return display.lineSpace.offsetTop;}\n  function paddingVert(display) {return display.mover.offsetHeight - display.lineSpace.offsetHeight;}\n  function paddingH(display) {\n    if (display.cachedPaddingH) return display.cachedPaddingH;\n    var e = removeChildrenAndAdd(display.measure, elt(\"pre\", \"x\"));\n    var style = window.getComputedStyle ? window.getComputedStyle(e) : e.currentStyle;\n    return display.cachedPaddingH = {left: parseInt(style.paddingLeft),\n                                     right: parseInt(style.paddingRight)};\n  }\n\n  function measureChar(cm, line, ch, data, bias) {\n    var dir = -1;\n    data = data || measureLine(cm, line);\n    if (data.crude) {\n      var left = data.left + ch * data.width;\n      return {left: left, right: left + data.width, top: data.top, bottom: data.bottom};\n    }\n\n    for (var pos = ch;; pos += dir) {\n      var r = data[pos];\n      if (r) break;\n      if (dir < 0 && pos == 0) dir = 1;\n    }\n    bias = pos > ch ? \"left\" : pos < ch ? \"right\" : bias;\n    if (bias == \"left\" && r.leftSide) r = r.leftSide;\n    else if (bias == \"right\" && r.rightSide) r = r.rightSide;\n    return {left: pos < ch ? r.right : r.left,\n            right: pos > ch ? r.left : r.right,\n            top: r.top,\n            bottom: r.bottom};\n  }\n\n  function findCachedMeasurement(cm, line) {\n    var cache = cm.display.measureLineCache;\n    for (var i = 0; i < cache.length; ++i) {\n      var memo = cache[i];\n      if (memo.text == line.text && memo.markedSpans == line.markedSpans &&\n          cm.display.scroller.clientWidth == memo.width &&\n          memo.classes == line.textClass + \"|\" + line.wrapClass)\n        return memo;\n    }\n  }\n\n  function clearCachedMeasurement(cm, line) {\n    var exists = findCachedMeasurement(cm, line);\n    if (exists) exists.text = exists.measure = exists.markedSpans = null;\n  }\n\n  function measureLine(cm, line) {\n    // First look in the cache\n    var cached = findCachedMeasurement(cm, line);\n    if (cached) return cached.measure;\n\n    // Failing that, recompute and store result in cache\n    var measure = measureLineInner(cm, line);\n    var cache = cm.display.measureLineCache;\n    var memo = {text: line.text, width: cm.display.scroller.clientWidth,\n                markedSpans: line.markedSpans, measure: measure,\n                classes: line.textClass + \"|\" + line.wrapClass};\n    if (cache.length == 16) cache[++cm.display.measureLineCachePos % 16] = memo;\n    else cache.push(memo);\n    return measure;\n  }\n\n  function measureLineInner(cm, line) {\n    if (!cm.options.lineWrapping && line.text.length >= cm.options.crudeMeasuringFrom)\n      return crudelyMeasureLine(cm, line);\n\n    var display = cm.display, measure = emptyArray(line.text.length);\n    var pre = buildLineContent(cm, line, measure, true).pre;\n\n    // IE does not cache element positions of inline elements between\n    // calls to getBoundingClientRect. This makes the loop below,\n    // which gathers the positions of all the characters on the line,\n    // do an amount of layout work quadratic to the number of\n    // characters. When line wrapping is off, we try to improve things\n    // by first subdividing the line into a bunch of inline blocks, so\n    // that IE can reuse most of the layout information from caches\n    // for those blocks. This does interfere with line wrapping, so it\n    // doesn't work when wrapping is on, but in that case the\n    // situation is slightly better, since IE does cache line-wrapping\n    // information and only recomputes per-line.\n    if (old_ie && !ie_lt8 && !cm.options.lineWrapping && pre.childNodes.length > 100) {\n      var fragment = document.createDocumentFragment();\n      var chunk = 10, n = pre.childNodes.length;\n      for (var i = 0, chunks = Math.ceil(n / chunk); i < chunks; ++i) {\n        var wrap = elt(\"div\", null, null, \"display: inline-block\");\n        for (var j = 0; j < chunk && n; ++j) {\n          wrap.appendChild(pre.firstChild);\n          --n;\n        }\n        fragment.appendChild(wrap);\n      }\n      pre.appendChild(fragment);\n    }\n\n    removeChildrenAndAdd(display.measure, pre);\n\n    var outer = getRect(display.lineDiv);\n    var vranges = [], data = emptyArray(line.text.length), maxBot = pre.offsetHeight;\n    // Work around an IE7/8 bug where it will sometimes have randomly\n    // replaced our pre with a clone at this point.\n    if (ie_lt9 && display.measure.first != pre)\n      removeChildrenAndAdd(display.measure, pre);\n\n    function measureRect(rect) {\n      var top = rect.top - outer.top, bot = rect.bottom - outer.top;\n      if (bot > maxBot) bot = maxBot;\n      if (top < 0) top = 0;\n      for (var i = vranges.length - 2; i >= 0; i -= 2) {\n        var rtop = vranges[i], rbot = vranges[i+1];\n        if (rtop > bot || rbot < top) continue;\n        if (rtop <= top && rbot >= bot ||\n            top <= rtop && bot >= rbot ||\n            Math.min(bot, rbot) - Math.max(top, rtop) >= (bot - top) >> 1) {\n          vranges[i] = Math.min(top, rtop);\n          vranges[i+1] = Math.max(bot, rbot);\n          break;\n        }\n      }\n      if (i < 0) { i = vranges.length; vranges.push(top, bot); }\n      return {left: rect.left - outer.left,\n              right: rect.right - outer.left,\n              top: i, bottom: null};\n    }\n    function finishRect(rect) {\n      rect.bottom = vranges[rect.top+1];\n      rect.top = vranges[rect.top];\n    }\n\n    for (var i = 0, cur; i < measure.length; ++i) if (cur = measure[i]) {\n      var node = cur, rect = null;\n      // A widget might wrap, needs special care\n      if (/\\bCodeMirror-widget\\b/.test(cur.className) && cur.getClientRects) {\n        if (cur.firstChild.nodeType == 1) node = cur.firstChild;\n        var rects = node.getClientRects();\n        if (rects.length > 1) {\n          rect = data[i] = measureRect(rects[0]);\n          rect.rightSide = measureRect(rects[rects.length - 1]);\n        }\n      }\n      if (!rect) rect = data[i] = measureRect(getRect(node));\n      if (cur.measureRight) rect.right = getRect(cur.measureRight).left - outer.left;\n      if (cur.leftSide) rect.leftSide = measureRect(getRect(cur.leftSide));\n    }\n    removeChildren(cm.display.measure);\n    for (var i = 0, cur; i < data.length; ++i) if (cur = data[i]) {\n      finishRect(cur);\n      if (cur.leftSide) finishRect(cur.leftSide);\n      if (cur.rightSide) finishRect(cur.rightSide);\n    }\n    return data;\n  }\n\n  function crudelyMeasureLine(cm, line) {\n    var copy = new Line(line.text.slice(0, 100), null);\n    if (line.textClass) copy.textClass = line.textClass;\n    var measure = measureLineInner(cm, copy);\n    var left = measureChar(cm, copy, 0, measure, \"left\");\n    var right = measureChar(cm, copy, 99, measure, \"right\");\n    return {crude: true, top: left.top, left: left.left, bottom: left.bottom, width: (right.right - left.left) / 100};\n  }\n\n  function measureLineWidth(cm, line) {\n    var hasBadSpan = false;\n    if (line.markedSpans) for (var i = 0; i < line.markedSpans; ++i) {\n      var sp = line.markedSpans[i];\n      if (sp.collapsed && (sp.to == null || sp.to == line.text.length)) hasBadSpan = true;\n    }\n    var cached = !hasBadSpan && findCachedMeasurement(cm, line);\n    if (cached || line.text.length >= cm.options.crudeMeasuringFrom)\n      return measureChar(cm, line, line.text.length, cached && cached.measure, \"right\").right;\n\n    var pre = buildLineContent(cm, line, null, true).pre;\n    var end = pre.appendChild(zeroWidthElement(cm.display.measure));\n    removeChildrenAndAdd(cm.display.measure, pre);\n    return getRect(end).right - getRect(cm.display.lineDiv).left;\n  }\n\n  function clearCaches(cm) {\n    cm.display.measureLineCache.length = cm.display.measureLineCachePos = 0;\n    cm.display.cachedCharWidth = cm.display.cachedTextHeight = cm.display.cachedPaddingH = null;\n    if (!cm.options.lineWrapping) cm.display.maxLineChanged = true;\n    cm.display.lineNumChars = null;\n  }\n\n  function pageScrollX() { return window.pageXOffset || (document.documentElement || document.body).scrollLeft; }\n  function pageScrollY() { return window.pageYOffset || (document.documentElement || document.body).scrollTop; }\n\n  // Context is one of \"line\", \"div\" (display.lineDiv), \"local\"/null (editor), or \"page\"\n  function intoCoordSystem(cm, lineObj, rect, context) {\n    if (lineObj.widgets) for (var i = 0; i < lineObj.widgets.length; ++i) if (lineObj.widgets[i].above) {\n      var size = widgetHeight(lineObj.widgets[i]);\n      rect.top += size; rect.bottom += size;\n    }\n    if (context == \"line\") return rect;\n    if (!context) context = \"local\";\n    var yOff = heightAtLine(cm, lineObj);\n    if (context == \"local\") yOff += paddingTop(cm.display);\n    else yOff -= cm.display.viewOffset;\n    if (context == \"page\" || context == \"window\") {\n      var lOff = getRect(cm.display.lineSpace);\n      yOff += lOff.top + (context == \"window\" ? 0 : pageScrollY());\n      var xOff = lOff.left + (context == \"window\" ? 0 : pageScrollX());\n      rect.left += xOff; rect.right += xOff;\n    }\n    rect.top += yOff; rect.bottom += yOff;\n    return rect;\n  }\n\n  // Context may be \"window\", \"page\", \"div\", or \"local\"/null\n  // Result is in \"div\" coords\n  function fromCoordSystem(cm, coords, context) {\n    if (context == \"div\") return coords;\n    var left = coords.left, top = coords.top;\n    // First move into \"page\" coordinate system\n    if (context == \"page\") {\n      left -= pageScrollX();\n      top -= pageScrollY();\n    } else if (context == \"local\" || !context) {\n      var localBox = getRect(cm.display.sizer);\n      left += localBox.left;\n      top += localBox.top;\n    }\n\n    var lineSpaceBox = getRect(cm.display.lineSpace);\n    return {left: left - lineSpaceBox.left, top: top - lineSpaceBox.top};\n  }\n\n  function charCoords(cm, pos, context, lineObj, bias) {\n    if (!lineObj) lineObj = getLine(cm.doc, pos.line);\n    return intoCoordSystem(cm, lineObj, measureChar(cm, lineObj, pos.ch, null, bias), context);\n  }\n\n  function cursorCoords(cm, pos, context, lineObj, measurement) {\n    lineObj = lineObj || getLine(cm.doc, pos.line);\n    if (!measurement) measurement = measureLine(cm, lineObj);\n    function get(ch, right) {\n      var m = measureChar(cm, lineObj, ch, measurement, right ? \"right\" : \"left\");\n      if (right) m.left = m.right; else m.right = m.left;\n      return intoCoordSystem(cm, lineObj, m, context);\n    }\n    function getBidi(ch, partPos) {\n      var part = order[partPos], right = part.level % 2;\n      if (ch == bidiLeft(part) && partPos && part.level < order[partPos - 1].level) {\n        part = order[--partPos];\n        ch = bidiRight(part) - (part.level % 2 ? 0 : 1);\n        right = true;\n      } else if (ch == bidiRight(part) && partPos < order.length - 1 && part.level < order[partPos + 1].level) {\n        part = order[++partPos];\n        ch = bidiLeft(part) - part.level % 2;\n        right = false;\n      }\n      if (right && ch == part.to && ch > part.from) return get(ch - 1);\n      return get(ch, right);\n    }\n    var order = getOrder(lineObj), ch = pos.ch;\n    if (!order) return get(ch);\n    var partPos = getBidiPartAt(order, ch);\n    var val = getBidi(ch, partPos);\n    if (bidiOther != null) val.other = getBidi(ch, bidiOther);\n    return val;\n  }\n\n  function PosWithInfo(line, ch, outside, xRel) {\n    var pos = new Pos(line, ch);\n    pos.xRel = xRel;\n    if (outside) pos.outside = true;\n    return pos;\n  }\n\n  // Coords must be lineSpace-local\n  function coordsChar(cm, x, y) {\n    var doc = cm.doc;\n    y += cm.display.viewOffset;\n    if (y < 0) return PosWithInfo(doc.first, 0, true, -1);\n    var lineNo = lineAtHeight(doc, y), last = doc.first + doc.size - 1;\n    if (lineNo > last)\n      return PosWithInfo(doc.first + doc.size - 1, getLine(doc, last).text.length, true, 1);\n    if (x < 0) x = 0;\n\n    for (;;) {\n      var lineObj = getLine(doc, lineNo);\n      var found = coordsCharInner(cm, lineObj, lineNo, x, y);\n      var merged = collapsedSpanAtEnd(lineObj);\n      var mergedPos = merged && merged.find();\n      if (merged && (found.ch > mergedPos.from.ch || found.ch == mergedPos.from.ch && found.xRel > 0))\n        lineNo = mergedPos.to.line;\n      else\n        return found;\n    }\n  }\n\n  function coordsCharInner(cm, lineObj, lineNo, x, y) {\n    var innerOff = y - heightAtLine(cm, lineObj);\n    var wrongLine = false, adjust = 2 * cm.display.wrapper.clientWidth;\n    var measurement = measureLine(cm, lineObj);\n\n    function getX(ch) {\n      var sp = cursorCoords(cm, Pos(lineNo, ch), \"line\",\n                            lineObj, measurement);\n      wrongLine = true;\n      if (innerOff > sp.bottom) return sp.left - adjust;\n      else if (innerOff < sp.top) return sp.left + adjust;\n      else wrongLine = false;\n      return sp.left;\n    }\n\n    var bidi = getOrder(lineObj), dist = lineObj.text.length;\n    var from = lineLeft(lineObj), to = lineRight(lineObj);\n    var fromX = getX(from), fromOutside = wrongLine, toX = getX(to), toOutside = wrongLine;\n\n    if (x > toX) return PosWithInfo(lineNo, to, toOutside, 1);\n    // Do a binary search between these bounds.\n    for (;;) {\n      if (bidi ? to == from || to == moveVisually(lineObj, from, 1) : to - from <= 1) {\n        var ch = x < fromX || x - fromX <= toX - x ? from : to;\n        var xDiff = x - (ch == from ? fromX : toX);\n        while (isExtendingChar(lineObj.text.charAt(ch))) ++ch;\n        var pos = PosWithInfo(lineNo, ch, ch == from ? fromOutside : toOutside,\n                              xDiff < 0 ? -1 : xDiff ? 1 : 0);\n        return pos;\n      }\n      var step = Math.ceil(dist / 2), middle = from + step;\n      if (bidi) {\n        middle = from;\n        for (var i = 0; i < step; ++i) middle = moveVisually(lineObj, middle, 1);\n      }\n      var middleX = getX(middle);\n      if (middleX > x) {to = middle; toX = middleX; if (toOutside = wrongLine) toX += 1000; dist = step;}\n      else {from = middle; fromX = middleX; fromOutside = wrongLine; dist -= step;}\n    }\n  }\n\n  var measureText;\n  function textHeight(display) {\n    if (display.cachedTextHeight != null) return display.cachedTextHeight;\n    if (measureText == null) {\n      measureText = elt(\"pre\");\n      // Measure a bunch of lines, for browsers that compute\n      // fractional heights.\n      for (var i = 0; i < 49; ++i) {\n        measureText.appendChild(document.createTextNode(\"x\"));\n        measureText.appendChild(elt(\"br\"));\n      }\n      measureText.appendChild(document.createTextNode(\"x\"));\n    }\n    removeChildrenAndAdd(display.measure, measureText);\n    var height = measureText.offsetHeight / 50;\n    if (height > 3) display.cachedTextHeight = height;\n    removeChildren(display.measure);\n    return height || 1;\n  }\n\n  function charWidth(display) {\n    if (display.cachedCharWidth != null) return display.cachedCharWidth;\n    var anchor = elt(\"span\", \"x\");\n    var pre = elt(\"pre\", [anchor]);\n    removeChildrenAndAdd(display.measure, pre);\n    var width = anchor.offsetWidth;\n    if (width > 2) display.cachedCharWidth = width;\n    return width || 10;\n  }\n\n  // OPERATIONS\n\n  // Operations are used to wrap changes in such a way that each\n  // change won't have to update the cursor and display (which would\n  // be awkward, slow, and error-prone), but instead updates are\n  // batched and then all combined and executed at once.\n\n  var nextOpId = 0;\n  function startOperation(cm) {\n    cm.curOp = {\n      // An array of ranges of lines that have to be updated. See\n      // updateDisplay.\n      changes: [],\n      forceUpdate: false,\n      updateInput: null,\n      userSelChange: null,\n      textChanged: null,\n      selectionChanged: false,\n      cursorActivity: false,\n      updateMaxLine: false,\n      updateScrollPos: false,\n      id: ++nextOpId\n    };\n    if (!delayedCallbackDepth++) delayedCallbacks = [];\n  }\n\n  function endOperation(cm) {\n    var op = cm.curOp, doc = cm.doc, display = cm.display;\n    cm.curOp = null;\n\n    if (op.updateMaxLine) computeMaxLength(cm);\n    if (display.maxLineChanged && !cm.options.lineWrapping && display.maxLine) {\n      var width = measureLineWidth(cm, display.maxLine);\n      display.sizer.style.minWidth = Math.max(0, width + 3) + \"px\";\n      display.maxLineChanged = false;\n      var maxScrollLeft = Math.max(0, display.sizer.offsetLeft + display.sizer.offsetWidth - display.scroller.clientWidth);\n      if (maxScrollLeft < doc.scrollLeft && !op.updateScrollPos)\n        setScrollLeft(cm, Math.min(display.scroller.scrollLeft, maxScrollLeft), true);\n    }\n    var newScrollPos, updated;\n    if (op.updateScrollPos) {\n      newScrollPos = op.updateScrollPos;\n    } else if (op.selectionChanged && display.scroller.clientHeight) { // don't rescroll if not visible\n      var coords = cursorCoords(cm, doc.sel.head);\n      newScrollPos = calculateScrollPos(cm, coords.left, coords.top, coords.left, coords.bottom);\n    }\n    if (op.changes.length || op.forceUpdate || newScrollPos && newScrollPos.scrollTop != null) {\n      updated = updateDisplay(cm, op.changes, newScrollPos && newScrollPos.scrollTop, op.forceUpdate);\n      if (cm.display.scroller.offsetHeight) cm.doc.scrollTop = cm.display.scroller.scrollTop;\n    }\n    if (!updated && op.selectionChanged) updateSelection(cm);\n    if (op.updateScrollPos) {\n      var top = Math.max(0, Math.min(display.scroller.scrollHeight - display.scroller.clientHeight, newScrollPos.scrollTop));\n      var left = Math.max(0, Math.min(display.scroller.scrollWidth - display.scroller.clientWidth, newScrollPos.scrollLeft));\n      display.scroller.scrollTop = display.scrollbarV.scrollTop = doc.scrollTop = top;\n      display.scroller.scrollLeft = display.scrollbarH.scrollLeft = doc.scrollLeft = left;\n      alignHorizontally(cm);\n      if (op.scrollToPos)\n        scrollPosIntoView(cm, clipPos(cm.doc, op.scrollToPos.from),\n                          clipPos(cm.doc, op.scrollToPos.to), op.scrollToPos.margin);\n    } else if (newScrollPos) {\n      scrollCursorIntoView(cm);\n    }\n    if (op.selectionChanged) restartBlink(cm);\n\n    if (cm.state.focused && op.updateInput)\n      resetInput(cm, op.userSelChange);\n\n    var hidden = op.maybeHiddenMarkers, unhidden = op.maybeUnhiddenMarkers;\n    if (hidden) for (var i = 0; i < hidden.length; ++i)\n      if (!hidden[i].lines.length) signal(hidden[i], \"hide\");\n    if (unhidden) for (var i = 0; i < unhidden.length; ++i)\n      if (unhidden[i].lines.length) signal(unhidden[i], \"unhide\");\n\n    var delayed;\n    if (!--delayedCallbackDepth) {\n      delayed = delayedCallbacks;\n      delayedCallbacks = null;\n    }\n    if (op.textChanged)\n      signal(cm, \"change\", cm, op.textChanged);\n    if (op.cursorActivity) signal(cm, \"cursorActivity\", cm);\n    if (delayed) for (var i = 0; i < delayed.length; ++i) delayed[i]();\n  }\n\n  // Wraps a function in an operation. Returns the wrapped function.\n  function operation(cm1, f) {\n    return function() {\n      var cm = cm1 || this, withOp = !cm.curOp;\n      if (withOp) startOperation(cm);\n      try { var result = f.apply(cm, arguments); }\n      finally { if (withOp) endOperation(cm); }\n      return result;\n    };\n  }\n  function docOperation(f) {\n    return function() {\n      var withOp = this.cm && !this.cm.curOp, result;\n      if (withOp) startOperation(this.cm);\n      try { result = f.apply(this, arguments); }\n      finally { if (withOp) endOperation(this.cm); }\n      return result;\n    };\n  }\n  function runInOp(cm, f) {\n    var withOp = !cm.curOp, result;\n    if (withOp) startOperation(cm);\n    try { result = f(); }\n    finally { if (withOp) endOperation(cm); }\n    return result;\n  }\n\n  function regChange(cm, from, to, lendiff) {\n    if (from == null) from = cm.doc.first;\n    if (to == null) to = cm.doc.first + cm.doc.size;\n    cm.curOp.changes.push({from: from, to: to, diff: lendiff});\n  }\n\n  // INPUT HANDLING\n\n  function slowPoll(cm) {\n    if (cm.display.pollingFast) return;\n    cm.display.poll.set(cm.options.pollInterval, function() {\n      readInput(cm);\n      if (cm.state.focused) slowPoll(cm);\n    });\n  }\n\n  function fastPoll(cm) {\n    var missed = false;\n    cm.display.pollingFast = true;\n    function p() {\n      var changed = readInput(cm);\n      if (!changed && !missed) {missed = true; cm.display.poll.set(60, p);}\n      else {cm.display.pollingFast = false; slowPoll(cm);}\n    }\n    cm.display.poll.set(20, p);\n  }\n\n  // prevInput is a hack to work with IME. If we reset the textarea\n  // on every change, that breaks IME. So we look for changes\n  // compared to the previous content instead. (Modern browsers have\n  // events that indicate IME taking place, but these are not widely\n  // supported or compatible enough yet to rely on.)\n  function readInput(cm) {\n    var input = cm.display.input, prevInput = cm.display.prevInput, doc = cm.doc, sel = doc.sel;\n    if (!cm.state.focused || hasSelection(input) || isReadOnly(cm) || cm.options.disableInput) return false;\n    if (cm.state.pasteIncoming && cm.state.fakedLastChar) {\n      input.value = input.value.substring(0, input.value.length - 1);\n      cm.state.fakedLastChar = false;\n    }\n    var text = input.value;\n    if (text == prevInput && posEq(sel.from, sel.to)) return false;\n    if (ie && !ie_lt9 && cm.display.inputHasSelection === text) {\n      resetInput(cm, true);\n      return false;\n    }\n\n    var withOp = !cm.curOp;\n    if (withOp) startOperation(cm);\n    sel.shift = false;\n    var same = 0, l = Math.min(prevInput.length, text.length);\n    while (same < l && prevInput.charCodeAt(same) == text.charCodeAt(same)) ++same;\n    var from = sel.from, to = sel.to;\n    var inserted = text.slice(same);\n    if (same < prevInput.length)\n      from = Pos(from.line, from.ch - (prevInput.length - same));\n    else if (cm.state.overwrite && posEq(from, to) && !cm.state.pasteIncoming)\n      to = Pos(to.line, Math.min(getLine(doc, to.line).text.length, to.ch + inserted.length));\n\n    var updateInput = cm.curOp.updateInput;\n    var changeEvent = {from: from, to: to, text: splitLines(inserted),\n                       origin: cm.state.pasteIncoming ? \"paste\" : cm.state.cutIncoming ? \"cut\" : \"+input\"};\n    makeChange(cm.doc, changeEvent, \"end\");\n    cm.curOp.updateInput = updateInput;\n    signalLater(cm, \"inputRead\", cm, changeEvent);\n    if (inserted && !cm.state.pasteIncoming && cm.options.electricChars &&\n        cm.options.smartIndent && sel.head.ch < 100) {\n      var electric = cm.getModeAt(sel.head).electricChars;\n      if (electric) for (var i = 0; i < electric.length; i++)\n        if (inserted.indexOf(electric.charAt(i)) > -1) {\n          indentLine(cm, sel.head.line, \"smart\");\n          break;\n        }\n    }\n\n    if (text.length > 1000 || text.indexOf(\"\\n\") > -1) input.value = cm.display.prevInput = \"\";\n    else cm.display.prevInput = text;\n    if (withOp) endOperation(cm);\n    cm.state.pasteIncoming = cm.state.cutIncoming = false;\n    return true;\n  }\n\n  function resetInput(cm, user) {\n    var minimal, selected, doc = cm.doc;\n    if (!posEq(doc.sel.from, doc.sel.to)) {\n      cm.display.prevInput = \"\";\n      minimal = hasCopyEvent &&\n        (doc.sel.to.line - doc.sel.from.line > 100 || (selected = cm.getSelection()).length > 1000);\n      var content = minimal ? \"-\" : selected || cm.getSelection();\n      cm.display.input.value = content;\n      if (cm.state.focused) selectInput(cm.display.input);\n      if (ie && !ie_lt9) cm.display.inputHasSelection = content;\n    } else if (user) {\n      cm.display.prevInput = cm.display.input.value = \"\";\n      if (ie && !ie_lt9) cm.display.inputHasSelection = null;\n    }\n    cm.display.inaccurateSelection = minimal;\n  }\n\n  function focusInput(cm) {\n    if (cm.options.readOnly != \"nocursor\" && (!mobile || document.activeElement != cm.display.input))\n      cm.display.input.focus();\n  }\n\n  function ensureFocus(cm) {\n    if (!cm.state.focused) { focusInput(cm); onFocus(cm); }\n  }\n\n  function isReadOnly(cm) {\n    return cm.options.readOnly || cm.doc.cantEdit;\n  }\n\n  // EVENT HANDLERS\n\n  function registerEventHandlers(cm) {\n    var d = cm.display;\n    on(d.scroller, \"mousedown\", operation(cm, onMouseDown));\n    if (old_ie)\n      on(d.scroller, \"dblclick\", operation(cm, function(e) {\n        if (signalDOMEvent(cm, e)) return;\n        var pos = posFromMouse(cm, e);\n        if (!pos || clickInGutter(cm, e) || eventInWidget(cm.display, e)) return;\n        e_preventDefault(e);\n        var word = findWordAt(getLine(cm.doc, pos.line).text, pos);\n        extendSelection(cm.doc, word.from, word.to);\n      }));\n    else\n      on(d.scroller, \"dblclick\", function(e) { signalDOMEvent(cm, e) || e_preventDefault(e); });\n    on(d.lineSpace, \"selectstart\", function(e) {\n      if (!eventInWidget(d, e)) e_preventDefault(e);\n    });\n    // Gecko browsers fire contextmenu *after* opening the menu, at\n    // which point we can't mess with it anymore. Context menu is\n    // handled in onMouseDown for Gecko.\n    if (!captureMiddleClick) on(d.scroller, \"contextmenu\", function(e) {onContextMenu(cm, e);});\n\n    on(d.scroller, \"scroll\", function() {\n      if (d.scroller.clientHeight) {\n        setScrollTop(cm, d.scroller.scrollTop);\n        setScrollLeft(cm, d.scroller.scrollLeft, true);\n        signal(cm, \"scroll\", cm);\n      }\n    });\n    on(d.scrollbarV, \"scroll\", function() {\n      if (d.scroller.clientHeight) setScrollTop(cm, d.scrollbarV.scrollTop);\n    });\n    on(d.scrollbarH, \"scroll\", function() {\n      if (d.scroller.clientHeight) setScrollLeft(cm, d.scrollbarH.scrollLeft);\n    });\n\n    on(d.scroller, \"mousewheel\", function(e){onScrollWheel(cm, e);});\n    on(d.scroller, \"DOMMouseScroll\", function(e){onScrollWheel(cm, e);});\n\n    function reFocus() { if (cm.state.focused) setTimeout(bind(focusInput, cm), 0); }\n    on(d.scrollbarH, \"mousedown\", reFocus);\n    on(d.scrollbarV, \"mousedown\", reFocus);\n    // Prevent wrapper from ever scrolling\n    on(d.wrapper, \"scroll\", function() { d.wrapper.scrollTop = d.wrapper.scrollLeft = 0; });\n\n    var resizeTimer;\n    function onResize() {\n      if (resizeTimer == null) resizeTimer = setTimeout(function() {\n        resizeTimer = null;\n        // Might be a text scaling operation, clear size caches.\n        d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = knownScrollbarWidth = null;\n        clearCaches(cm);\n        runInOp(cm, bind(regChange, cm));\n      }, 100);\n    }\n    on(window, \"resize\", onResize);\n    // Above handler holds on to the editor and its data structures.\n    // Here we poll to unregister it when the editor is no longer in\n    // the document, so that it can be garbage-collected.\n    function unregister() {\n      for (var p = d.wrapper.parentNode; p && p != document.body; p = p.parentNode) {}\n      if (p) setTimeout(unregister, 5000);\n      else off(window, \"resize\", onResize);\n    }\n    setTimeout(unregister, 5000);\n\n    on(d.input, \"keyup\", operation(cm, onKeyUp));\n    on(d.input, \"input\", function() {\n      if (ie && !ie_lt9 && cm.display.inputHasSelection) cm.display.inputHasSelection = null;\n      fastPoll(cm);\n    });\n    on(d.input, \"keydown\", operation(cm, onKeyDown));\n    on(d.input, \"keypress\", operation(cm, onKeyPress));\n    on(d.input, \"focus\", bind(onFocus, cm));\n    on(d.input, \"blur\", bind(onBlur, cm));\n\n    function drag_(e) {\n      if (signalDOMEvent(cm, e) || cm.options.onDragEvent && cm.options.onDragEvent(cm, addStop(e))) return;\n      e_stop(e);\n    }\n    if (cm.options.dragDrop) {\n      on(d.scroller, \"dragstart\", function(e){onDragStart(cm, e);});\n      on(d.scroller, \"dragenter\", drag_);\n      on(d.scroller, \"dragover\", drag_);\n      on(d.scroller, \"drop\", operation(cm, onDrop));\n    }\n    on(d.scroller, \"paste\", function(e) {\n      if (eventInWidget(d, e)) return;\n      focusInput(cm);\n      fastPoll(cm);\n    });\n    on(d.input, \"paste\", function() {\n      // Workaround for webkit bug https://bugs.webkit.org/show_bug.cgi?id=90206\n      // Add a char to the end of textarea before paste occur so that\n      // selection doesn't span to the end of textarea.\n      if (webkit && !cm.state.fakedLastChar && !(new Date - cm.state.lastMiddleDown < 200)) {\n        var start = d.input.selectionStart, end = d.input.selectionEnd;\n        d.input.value += \"$\";\n        d.input.selectionStart = start;\n        d.input.selectionEnd = end;\n        cm.state.fakedLastChar = true;\n      }\n      cm.state.pasteIncoming = true;\n      fastPoll(cm);\n    });\n\n    function prepareCopy(e) {\n      if (d.inaccurateSelection) {\n        d.prevInput = \"\";\n        d.inaccurateSelection = false;\n        d.input.value = cm.getSelection();\n        selectInput(d.input);\n      }\n      if (e.type == \"cut\") cm.state.cutIncoming = true;\n    }\n    on(d.input, \"cut\", prepareCopy);\n    on(d.input, \"copy\", prepareCopy);\n\n    // Needed to handle Tab key in KHTML\n    if (khtml) on(d.sizer, \"mouseup\", function() {\n      if (document.activeElement == d.input) d.input.blur();\n      focusInput(cm);\n    });\n  }\n\n  function eventInWidget(display, e) {\n    for (var n = e_target(e); n != display.wrapper; n = n.parentNode) {\n      if (!n || n.ignoreEvents || n.parentNode == display.sizer && n != display.mover) return true;\n    }\n  }\n\n  function posFromMouse(cm, e, liberal) {\n    var display = cm.display;\n    if (!liberal) {\n      var target = e_target(e);\n      if (target == display.scrollbarH || target == display.scrollbarH.firstChild ||\n          target == display.scrollbarV || target == display.scrollbarV.firstChild ||\n          target == display.scrollbarFiller || target == display.gutterFiller) return null;\n    }\n    var x, y, space = getRect(display.lineSpace);\n    // Fails unpredictably on IE[67] when mouse is dragged around quickly.\n    try { x = e.clientX; y = e.clientY; } catch (e) { return null; }\n    return coordsChar(cm, x - space.left, y - space.top);\n  }\n\n  var lastClick, lastDoubleClick;\n  function onMouseDown(e) {\n    if (signalDOMEvent(this, e)) return;\n    var cm = this, display = cm.display, doc = cm.doc, sel = doc.sel;\n    sel.shift = e.shiftKey;\n\n    if (eventInWidget(display, e)) {\n      if (!webkit) {\n        display.scroller.draggable = false;\n        setTimeout(function(){display.scroller.draggable = true;}, 100);\n      }\n      return;\n    }\n    if (clickInGutter(cm, e)) return;\n    var start = posFromMouse(cm, e);\n    window.focus();\n\n    switch (e_button(e)) {\n    case 3:\n      if (captureMiddleClick) onContextMenu.call(cm, cm, e);\n      return;\n    case 2:\n      if (webkit) cm.state.lastMiddleDown = +new Date;\n      if (start) extendSelection(cm.doc, start);\n      setTimeout(bind(focusInput, cm), 20);\n      e_preventDefault(e);\n      return;\n    }\n    // For button 1, if it was clicked inside the editor\n    // (posFromMouse returning non-null), we have to adjust the\n    // selection.\n    if (!start) {if (e_target(e) == display.scroller) e_preventDefault(e); return;}\n\n    setTimeout(bind(ensureFocus, cm), 0);\n\n    var now = +new Date, type = \"single\";\n    if (lastDoubleClick && lastDoubleClick.time > now - 400 && posEq(lastDoubleClick.pos, start)) {\n      type = \"triple\";\n      e_preventDefault(e);\n      setTimeout(bind(focusInput, cm), 20);\n      selectLine(cm, start.line);\n    } else if (lastClick && lastClick.time > now - 400 && posEq(lastClick.pos, start)) {\n      type = \"double\";\n      lastDoubleClick = {time: now, pos: start};\n      e_preventDefault(e);\n      var word = findWordAt(getLine(doc, start.line).text, start);\n      extendSelection(cm.doc, word.from, word.to);\n    } else { lastClick = {time: now, pos: start}; }\n\n    var last = start;\n    if (cm.options.dragDrop && dragAndDrop && !isReadOnly(cm) && !posEq(sel.from, sel.to) &&\n        !posLess(start, sel.from) && !posLess(sel.to, start) && type == \"single\") {\n      var dragEnd = operation(cm, function(e2) {\n        if (webkit) display.scroller.draggable = false;\n        cm.state.draggingText = false;\n        off(document, \"mouseup\", dragEnd);\n        off(display.scroller, \"drop\", dragEnd);\n        if (Math.abs(e.clientX - e2.clientX) + Math.abs(e.clientY - e2.clientY) < 10) {\n          e_preventDefault(e2);\n          extendSelection(cm.doc, start);\n          focusInput(cm);\n          // Work around unexplainable focus problem in IE9 (#2127)\n          if (old_ie && !ie_lt9)\n            setTimeout(function() {document.body.focus(); focusInput(cm);}, 20);\n        }\n      });\n      // Let the drag handler handle this.\n      if (webkit) display.scroller.draggable = true;\n      cm.state.draggingText = dragEnd;\n      // IE's approach to draggable\n      if (display.scroller.dragDrop) display.scroller.dragDrop();\n      on(document, \"mouseup\", dragEnd);\n      on(display.scroller, \"drop\", dragEnd);\n      return;\n    }\n    e_preventDefault(e);\n    if (type == \"single\") extendSelection(cm.doc, clipPos(doc, start));\n\n    var startstart = sel.from, startend = sel.to, lastPos = start;\n\n    function doSelect(cur) {\n      if (posEq(lastPos, cur)) return;\n      lastPos = cur;\n\n      if (type == \"single\") {\n        extendSelection(cm.doc, clipPos(doc, start), cur);\n        return;\n      }\n\n      startstart = clipPos(doc, startstart);\n      startend = clipPos(doc, startend);\n      if (type == \"double\") {\n        var word = findWordAt(getLine(doc, cur.line).text, cur);\n        if (posLess(cur, startstart)) extendSelection(cm.doc, word.from, startend);\n        else extendSelection(cm.doc, startstart, word.to);\n      } else if (type == \"triple\") {\n        if (posLess(cur, startstart)) extendSelection(cm.doc, startend, clipPos(doc, Pos(cur.line, 0)));\n        else extendSelection(cm.doc, startstart, clipPos(doc, Pos(cur.line + 1, 0)));\n      }\n    }\n\n    var editorSize = getRect(display.wrapper);\n    // Used to ensure timeout re-tries don't fire when another extend\n    // happened in the meantime (clearTimeout isn't reliable -- at\n    // least on Chrome, the timeouts still happen even when cleared,\n    // if the clear happens after their scheduled firing time).\n    var counter = 0;\n\n    function extend(e) {\n      var curCount = ++counter;\n      var cur = posFromMouse(cm, e, true);\n      if (!cur) return;\n      if (!posEq(cur, last)) {\n        ensureFocus(cm);\n        last = cur;\n        doSelect(cur);\n        var visible = visibleLines(display, doc);\n        if (cur.line >= visible.to || cur.line < visible.from)\n          setTimeout(operation(cm, function(){if (counter == curCount) extend(e);}), 150);\n      } else {\n        var outside = e.clientY < editorSize.top ? -20 : e.clientY > editorSize.bottom ? 20 : 0;\n        if (outside) setTimeout(operation(cm, function() {\n          if (counter != curCount) return;\n          display.scroller.scrollTop += outside;\n          extend(e);\n        }), 50);\n      }\n    }\n\n    function done(e) {\n      counter = Infinity;\n      e_preventDefault(e);\n      focusInput(cm);\n      off(document, \"mousemove\", move);\n      off(document, \"mouseup\", up);\n    }\n\n    var move = operation(cm, function(e) {\n      if ((ie && !ie_lt10) ?  !e.buttons : !e_button(e)) done(e);\n      else extend(e);\n    });\n    var up = operation(cm, done);\n    on(document, \"mousemove\", move);\n    on(document, \"mouseup\", up);\n  }\n\n  function gutterEvent(cm, e, type, prevent, signalfn) {\n    try { var mX = e.clientX, mY = e.clientY; }\n    catch(e) { return false; }\n    if (mX >= Math.floor(getRect(cm.display.gutters).right)) return false;\n    if (prevent) e_preventDefault(e);\n\n    var display = cm.display;\n    var lineBox = getRect(display.lineDiv);\n\n    if (mY > lineBox.bottom || !hasHandler(cm, type)) return e_defaultPrevented(e);\n    mY -= lineBox.top - display.viewOffset;\n\n    for (var i = 0; i < cm.options.gutters.length; ++i) {\n      var g = display.gutters.childNodes[i];\n      if (g && getRect(g).right >= mX) {\n        var line = lineAtHeight(cm.doc, mY);\n        var gutter = cm.options.gutters[i];\n        signalfn(cm, type, cm, line, gutter, e);\n        return e_defaultPrevented(e);\n      }\n    }\n  }\n\n  function contextMenuInGutter(cm, e) {\n    if (!hasHandler(cm, \"gutterContextMenu\")) return false;\n    return gutterEvent(cm, e, \"gutterContextMenu\", false, signal);\n  }\n\n  function clickInGutter(cm, e) {\n    return gutterEvent(cm, e, \"gutterClick\", true, signalLater);\n  }\n\n  // Kludge to work around strange IE behavior where it'll sometimes\n  // re-fire a series of drag-related events right after the drop (#1551)\n  var lastDrop = 0;\n\n  function onDrop(e) {\n    var cm = this;\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e) || (cm.options.onDragEvent && cm.options.onDragEvent(cm, addStop(e))))\n      return;\n    e_preventDefault(e);\n    if (ie) lastDrop = +new Date;\n    var pos = posFromMouse(cm, e, true), files = e.dataTransfer.files;\n    if (!pos || isReadOnly(cm)) return;\n    if (files && files.length && window.FileReader && window.File) {\n      var n = files.length, text = Array(n), read = 0;\n      var loadFile = function(file, i) {\n        var reader = new FileReader;\n        reader.onload = function() {\n          text[i] = reader.result;\n          if (++read == n) {\n            pos = clipPos(cm.doc, pos);\n            makeChange(cm.doc, {from: pos, to: pos, text: splitLines(text.join(\"\\n\")), origin: \"paste\"}, \"around\");\n          }\n        };\n        reader.readAsText(file);\n      };\n      for (var i = 0; i < n; ++i) loadFile(files[i], i);\n    } else {\n      // Don't do a replace if the drop happened inside of the selected text.\n      if (cm.state.draggingText && !(posLess(pos, cm.doc.sel.from) || posLess(cm.doc.sel.to, pos))) {\n        cm.state.draggingText(e);\n        // Ensure the editor is re-focused\n        setTimeout(bind(focusInput, cm), 20);\n        return;\n      }\n      try {\n        var text = e.dataTransfer.getData(\"Text\");\n        if (text) {\n          var curFrom = cm.doc.sel.from, curTo = cm.doc.sel.to;\n          setSelection(cm.doc, pos, pos);\n          if (cm.state.draggingText) replaceRange(cm.doc, \"\", curFrom, curTo, \"paste\");\n          cm.replaceSelection(text, null, \"paste\");\n          focusInput(cm);\n        }\n      }\n      catch(e){}\n    }\n  }\n\n  function onDragStart(cm, e) {\n    if (ie && (!cm.state.draggingText || +new Date - lastDrop < 100)) { e_stop(e); return; }\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e)) return;\n\n    var txt = cm.getSelection();\n    e.dataTransfer.setData(\"Text\", txt);\n\n    // Use dummy image instead of default browsers image.\n    // Recent Safari (~6.0.2) have a tendency to segfault when this happens, so we don't do it there.\n    if (e.dataTransfer.setDragImage && !safari) {\n      var img = elt(\"img\", null, null, \"position: fixed; left: 0; top: 0;\");\n      img.src = \"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\";\n      if (opera) {\n        img.width = img.height = 1;\n        cm.display.wrapper.appendChild(img);\n        // Force a relayout, or Opera won't use our image for some obscure reason\n        img._top = img.offsetTop;\n      }\n      e.dataTransfer.setDragImage(img, 0, 0);\n      if (opera) img.parentNode.removeChild(img);\n    }\n  }\n\n  function setScrollTop(cm, val) {\n    if (Math.abs(cm.doc.scrollTop - val) < 2) return;\n    cm.doc.scrollTop = val;\n    if (!gecko) updateDisplay(cm, [], val);\n    if (cm.display.scroller.scrollTop != val) cm.display.scroller.scrollTop = val;\n    if (cm.display.scrollbarV.scrollTop != val) cm.display.scrollbarV.scrollTop = val;\n    if (gecko) updateDisplay(cm, []);\n    startWorker(cm, 100);\n  }\n  function setScrollLeft(cm, val, isScroller) {\n    if (isScroller ? val == cm.doc.scrollLeft : Math.abs(cm.doc.scrollLeft - val) < 2) return;\n    val = Math.min(val, cm.display.scroller.scrollWidth - cm.display.scroller.clientWidth);\n    cm.doc.scrollLeft = val;\n    alignHorizontally(cm);\n    if (cm.display.scroller.scrollLeft != val) cm.display.scroller.scrollLeft = val;\n    if (cm.display.scrollbarH.scrollLeft != val) cm.display.scrollbarH.scrollLeft = val;\n  }\n\n  // Since the delta values reported on mouse wheel events are\n  // unstandardized between browsers and even browser versions, and\n  // generally horribly unpredictable, this code starts by measuring\n  // the scroll effect that the first few mouse wheel events have,\n  // and, from that, detects the way it can convert deltas to pixel\n  // offsets afterwards.\n  //\n  // The reason we want to know the amount a wheel event will scroll\n  // is that it gives us a chance to update the display before the\n  // actual scrolling happens, reducing flickering.\n\n  var wheelSamples = 0, wheelPixelsPerUnit = null;\n  // Fill in a browser-detected starting value on browsers where we\n  // know one. These don't have to be accurate -- the result of them\n  // being wrong would just be a slight flicker on the first wheel\n  // scroll (if it is large enough).\n  if (ie) wheelPixelsPerUnit = -.53;\n  else if (gecko) wheelPixelsPerUnit = 15;\n  else if (chrome) wheelPixelsPerUnit = -.7;\n  else if (safari) wheelPixelsPerUnit = -1/3;\n\n  function onScrollWheel(cm, e) {\n    var dx = e.wheelDeltaX, dy = e.wheelDeltaY;\n    if (dx == null && e.detail && e.axis == e.HORIZONTAL_AXIS) dx = e.detail;\n    if (dy == null && e.detail && e.axis == e.VERTICAL_AXIS) dy = e.detail;\n    else if (dy == null) dy = e.wheelDelta;\n\n    var display = cm.display, scroll = display.scroller;\n    // Quit if there's nothing to scroll here\n    if (!(dx && scroll.scrollWidth > scroll.clientWidth ||\n          dy && scroll.scrollHeight > scroll.clientHeight)) return;\n\n    // Webkit browsers on OS X abort momentum scrolls when the target\n    // of the scroll event is removed from the scrollable element.\n    // This hack (see related code in patchDisplay) makes sure the\n    // element is kept around.\n    if (dy && mac && webkit) {\n      for (var cur = e.target; cur != scroll; cur = cur.parentNode) {\n        if (cur.lineObj) {\n          cm.display.currentWheelTarget = cur;\n          break;\n        }\n      }\n    }\n\n    // On some browsers, horizontal scrolling will cause redraws to\n    // happen before the gutter has been realigned, causing it to\n    // wriggle around in a most unseemly way. When we have an\n    // estimated pixels/delta value, we just handle horizontal\n    // scrolling entirely here. It'll be slightly off from native, but\n    // better than glitching out.\n    if (dx && !gecko && !opera && wheelPixelsPerUnit != null) {\n      if (dy)\n        setScrollTop(cm, Math.max(0, Math.min(scroll.scrollTop + dy * wheelPixelsPerUnit, scroll.scrollHeight - scroll.clientHeight)));\n      setScrollLeft(cm, Math.max(0, Math.min(scroll.scrollLeft + dx * wheelPixelsPerUnit, scroll.scrollWidth - scroll.clientWidth)));\n      e_preventDefault(e);\n      display.wheelStartX = null; // Abort measurement, if in progress\n      return;\n    }\n\n    if (dy && wheelPixelsPerUnit != null) {\n      var pixels = dy * wheelPixelsPerUnit;\n      var top = cm.doc.scrollTop, bot = top + display.wrapper.clientHeight;\n      if (pixels < 0) top = Math.max(0, top + pixels - 50);\n      else bot = Math.min(cm.doc.height, bot + pixels + 50);\n      updateDisplay(cm, [], {top: top, bottom: bot});\n    }\n\n    if (wheelSamples < 20) {\n      if (display.wheelStartX == null) {\n        display.wheelStartX = scroll.scrollLeft; display.wheelStartY = scroll.scrollTop;\n        display.wheelDX = dx; display.wheelDY = dy;\n        setTimeout(function() {\n          if (display.wheelStartX == null) return;\n          var movedX = scroll.scrollLeft - display.wheelStartX;\n          var movedY = scroll.scrollTop - display.wheelStartY;\n          var sample = (movedY && display.wheelDY && movedY / display.wheelDY) ||\n            (movedX && display.wheelDX && movedX / display.wheelDX);\n          display.wheelStartX = display.wheelStartY = null;\n          if (!sample) return;\n          wheelPixelsPerUnit = (wheelPixelsPerUnit * wheelSamples + sample) / (wheelSamples + 1);\n          ++wheelSamples;\n        }, 200);\n      } else {\n        display.wheelDX += dx; display.wheelDY += dy;\n      }\n    }\n  }\n\n  function doHandleBinding(cm, bound, dropShift) {\n    if (typeof bound == \"string\") {\n      bound = commands[bound];\n      if (!bound) return false;\n    }\n    // Ensure previous input has been read, so that the handler sees a\n    // consistent view of the document\n    if (cm.display.pollingFast && readInput(cm)) cm.display.pollingFast = false;\n    var doc = cm.doc, prevShift = doc.sel.shift, done = false;\n    try {\n      if (isReadOnly(cm)) cm.state.suppressEdits = true;\n      if (dropShift) doc.sel.shift = false;\n      done = bound(cm) != Pass;\n    } finally {\n      doc.sel.shift = prevShift;\n      cm.state.suppressEdits = false;\n    }\n    return done;\n  }\n\n  function allKeyMaps(cm) {\n    var maps = cm.state.keyMaps.slice(0);\n    if (cm.options.extraKeys) maps.push(cm.options.extraKeys);\n    maps.push(cm.options.keyMap);\n    return maps;\n  }\n\n  var maybeTransition;\n  function handleKeyBinding(cm, e) {\n    // Handle auto keymap transitions\n    var startMap = getKeyMap(cm.options.keyMap), next = startMap.auto;\n    clearTimeout(maybeTransition);\n    if (next && !isModifierKey(e)) maybeTransition = setTimeout(function() {\n      if (getKeyMap(cm.options.keyMap) == startMap) {\n        cm.options.keyMap = (next.call ? next.call(null, cm) : next);\n        keyMapChanged(cm);\n      }\n    }, 50);\n\n    var name = keyName(e, true), handled = false;\n    if (!name) return false;\n    var keymaps = allKeyMaps(cm);\n\n    if (e.shiftKey) {\n      // First try to resolve full name (including 'Shift-'). Failing\n      // that, see if there is a cursor-motion command (starting with\n      // 'go') bound to the keyname without 'Shift-'.\n      handled = lookupKey(\"Shift-\" + name, keymaps, function(b) {return doHandleBinding(cm, b, true);})\n             || lookupKey(name, keymaps, function(b) {\n                  if (typeof b == \"string\" ? /^go[A-Z]/.test(b) : b.motion)\n                    return doHandleBinding(cm, b);\n                });\n    } else {\n      handled = lookupKey(name, keymaps, function(b) { return doHandleBinding(cm, b); });\n    }\n\n    if (handled) {\n      e_preventDefault(e);\n      restartBlink(cm);\n      if (ie_lt9) { e.oldKeyCode = e.keyCode; e.keyCode = 0; }\n      signalLater(cm, \"keyHandled\", cm, name, e);\n    }\n    return handled;\n  }\n\n  function handleCharBinding(cm, e, ch) {\n    var handled = lookupKey(\"'\" + ch + \"'\", allKeyMaps(cm),\n                            function(b) { return doHandleBinding(cm, b, true); });\n    if (handled) {\n      e_preventDefault(e);\n      restartBlink(cm);\n      signalLater(cm, \"keyHandled\", cm, \"'\" + ch + \"'\", e);\n    }\n    return handled;\n  }\n\n  function onKeyUp(e) {\n    var cm = this;\n    if (signalDOMEvent(cm, e) || cm.options.onKeyEvent && cm.options.onKeyEvent(cm, addStop(e))) return;\n    if (e.keyCode == 16) cm.doc.sel.shift = false;\n  }\n\n  var lastStoppedKey = null;\n  function onKeyDown(e) {\n    var cm = this;\n    ensureFocus(cm);\n    if (signalDOMEvent(cm, e) || cm.options.onKeyEvent && cm.options.onKeyEvent(cm, addStop(e))) return;\n    if (old_ie && e.keyCode == 27) e.returnValue = false;\n    var code = e.keyCode;\n    // IE does strange things with escape.\n    cm.doc.sel.shift = code == 16 || e.shiftKey;\n    // First give onKeyEvent option a chance to handle this.\n    var handled = handleKeyBinding(cm, e);\n    if (opera) {\n      lastStoppedKey = handled ? code : null;\n      // Opera has no cut event... we try to at least catch the key combo\n      if (!handled && code == 88 && !hasCopyEvent && (mac ? e.metaKey : e.ctrlKey))\n        cm.replaceSelection(\"\");\n    }\n  }\n\n  function onKeyPress(e) {\n    var cm = this;\n    if (signalDOMEvent(cm, e) || cm.options.onKeyEvent && cm.options.onKeyEvent(cm, addStop(e))) return;\n    var keyCode = e.keyCode, charCode = e.charCode;\n    if (opera && keyCode == lastStoppedKey) {lastStoppedKey = null; e_preventDefault(e); return;}\n    if (((opera && (!e.which || e.which < 10)) || khtml) && handleKeyBinding(cm, e)) return;\n    var ch = String.fromCharCode(charCode == null ? keyCode : charCode);\n    if (handleCharBinding(cm, e, ch)) return;\n    if (ie && !ie_lt9) cm.display.inputHasSelection = null;\n    fastPoll(cm);\n  }\n\n  function onFocus(cm) {\n    if (cm.options.readOnly == \"nocursor\") return;\n    if (!cm.state.focused) {\n      signal(cm, \"focus\", cm);\n      cm.state.focused = true;\n      if (cm.display.wrapper.className.search(/\\bCodeMirror-focused\\b/) == -1)\n        cm.display.wrapper.className += \" CodeMirror-focused\";\n      if (!cm.curOp) {\n        resetInput(cm, true);\n        if (webkit) setTimeout(bind(resetInput, cm, true), 0); // Issue #1730\n      }\n    }\n    slowPoll(cm);\n    restartBlink(cm);\n  }\n  function onBlur(cm) {\n    if (cm.state.focused) {\n      signal(cm, \"blur\", cm);\n      cm.state.focused = false;\n      cm.display.wrapper.className = cm.display.wrapper.className.replace(\" CodeMirror-focused\", \"\");\n    }\n    clearInterval(cm.display.blinker);\n    setTimeout(function() {if (!cm.state.focused) cm.doc.sel.shift = false;}, 150);\n  }\n\n  var detectingSelectAll;\n  function onContextMenu(cm, e) {\n    if (signalDOMEvent(cm, e, \"contextmenu\")) return;\n    var display = cm.display, sel = cm.doc.sel;\n    if (eventInWidget(display, e) || contextMenuInGutter(cm, e)) return;\n\n    var pos = posFromMouse(cm, e), scrollPos = display.scroller.scrollTop;\n    if (!pos || opera) return; // Opera is difficult.\n\n    // Reset the current text selection only if the click is done outside of the selection\n    // and 'resetSelectionOnContextMenu' option is true.\n    var reset = cm.options.resetSelectionOnContextMenu;\n    if (reset && (posEq(sel.from, sel.to) || posLess(pos, sel.from) || !posLess(pos, sel.to)))\n      operation(cm, setSelection)(cm.doc, pos, pos);\n\n    var oldCSS = display.input.style.cssText;\n    display.inputDiv.style.position = \"absolute\";\n    display.input.style.cssText = \"position: fixed; width: 30px; height: 30px; top: \" + (e.clientY - 5) +\n      \"px; left: \" + (e.clientX - 5) + \"px; z-index: 1000; background: transparent; outline: none;\" +\n      \"border-width: 0; outline: none; overflow: hidden; opacity: .05; -ms-opacity: .05; filter: alpha(opacity=5);\";\n    focusInput(cm);\n    resetInput(cm, true);\n    // Adds \"Select all\" to context menu in FF\n    if (posEq(sel.from, sel.to)) display.input.value = display.prevInput = \" \";\n\n    function prepareSelectAllHack() {\n      if (display.input.selectionStart != null) {\n        var extval = display.input.value = \"\\u200b\" + (posEq(sel.from, sel.to) ? \"\" : display.input.value);\n        display.prevInput = \"\\u200b\";\n        display.input.selectionStart = 1; display.input.selectionEnd = extval.length;\n      }\n    }\n    function rehide() {\n      display.inputDiv.style.position = \"relative\";\n      display.input.style.cssText = oldCSS;\n      if (ie_lt9) display.scrollbarV.scrollTop = display.scroller.scrollTop = scrollPos;\n      slowPoll(cm);\n\n      // Try to detect the user choosing select-all\n      if (display.input.selectionStart != null) {\n        if (!ie || ie_lt9) prepareSelectAllHack();\n        clearTimeout(detectingSelectAll);\n        var i = 0, poll = function(){\n          if (display.prevInput == \"\\u200b\" && display.input.selectionStart == 0)\n            operation(cm, commands.selectAll)(cm);\n          else if (i++ < 10) detectingSelectAll = setTimeout(poll, 500);\n          else resetInput(cm);\n        };\n        detectingSelectAll = setTimeout(poll, 200);\n      }\n    }\n\n    if (ie && !ie_lt9) prepareSelectAllHack();\n    if (captureMiddleClick) {\n      e_stop(e);\n      var mouseup = function() {\n        off(window, \"mouseup\", mouseup);\n        setTimeout(rehide, 20);\n      };\n      on(window, \"mouseup\", mouseup);\n    } else {\n      setTimeout(rehide, 50);\n    }\n  }\n\n  // UPDATING\n\n  var changeEnd = CodeMirror.changeEnd = function(change) {\n    if (!change.text) return change.to;\n    return Pos(change.from.line + change.text.length - 1,\n               lst(change.text).length + (change.text.length == 1 ? change.from.ch : 0));\n  };\n\n  // Make sure a position will be valid after the given change.\n  function clipPostChange(doc, change, pos) {\n    if (!posLess(change.from, pos)) return clipPos(doc, pos);\n    var diff = (change.text.length - 1) - (change.to.line - change.from.line);\n    if (pos.line > change.to.line + diff) {\n      var preLine = pos.line - diff, lastLine = doc.first + doc.size - 1;\n      if (preLine > lastLine) return Pos(lastLine, getLine(doc, lastLine).text.length);\n      return clipToLen(pos, getLine(doc, preLine).text.length);\n    }\n    if (pos.line == change.to.line + diff)\n      return clipToLen(pos, lst(change.text).length + (change.text.length == 1 ? change.from.ch : 0) +\n                       getLine(doc, change.to.line).text.length - change.to.ch);\n    var inside = pos.line - change.from.line;\n    return clipToLen(pos, change.text[inside].length + (inside ? 0 : change.from.ch));\n  }\n\n  // Hint can be null|\"end\"|\"start\"|\"around\"|{anchor,head}\n  function computeSelAfterChange(doc, change, hint) {\n    if (hint && typeof hint == \"object\") // Assumed to be {anchor, head} object\n      return {anchor: clipPostChange(doc, change, hint.anchor),\n              head: clipPostChange(doc, change, hint.head)};\n\n    if (hint == \"start\") return {anchor: change.from, head: change.from};\n\n    var end = changeEnd(change);\n    if (hint == \"around\") return {anchor: change.from, head: end};\n    if (hint == \"end\") return {anchor: end, head: end};\n\n    // hint is null, leave the selection alone as much as possible\n    var adjustPos = function(pos) {\n      if (posLess(pos, change.from)) return pos;\n      if (!posLess(change.to, pos)) return end;\n\n      var line = pos.line + change.text.length - (change.to.line - change.from.line) - 1, ch = pos.ch;\n      if (pos.line == change.to.line) ch += end.ch - change.to.ch;\n      return Pos(line, ch);\n    };\n    return {anchor: adjustPos(doc.sel.anchor), head: adjustPos(doc.sel.head)};\n  }\n\n  function filterChange(doc, change, update) {\n    var obj = {\n      canceled: false,\n      from: change.from,\n      to: change.to,\n      text: change.text,\n      origin: change.origin,\n      cancel: function() { this.canceled = true; }\n    };\n    if (update) obj.update = function(from, to, text, origin) {\n      if (from) this.from = clipPos(doc, from);\n      if (to) this.to = clipPos(doc, to);\n      if (text) this.text = text;\n      if (origin !== undefined) this.origin = origin;\n    };\n    signal(doc, \"beforeChange\", doc, obj);\n    if (doc.cm) signal(doc.cm, \"beforeChange\", doc.cm, obj);\n\n    if (obj.canceled) return null;\n    return {from: obj.from, to: obj.to, text: obj.text, origin: obj.origin};\n  }\n\n  // Replace the range from from to to by the strings in replacement.\n  // change is a {from, to, text [, origin]} object\n  function makeChange(doc, change, selUpdate, ignoreReadOnly) {\n    if (doc.cm) {\n      if (!doc.cm.curOp) return operation(doc.cm, makeChange)(doc, change, selUpdate, ignoreReadOnly);\n      if (doc.cm.state.suppressEdits) return;\n    }\n\n    if (hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\")) {\n      change = filterChange(doc, change, true);\n      if (!change) return;\n    }\n\n    // Possibly split or suppress the update based on the presence\n    // of read-only spans in its range.\n    var split = sawReadOnlySpans && !ignoreReadOnly && removeReadOnlyRanges(doc, change.from, change.to);\n    if (split) {\n      for (var i = split.length - 1; i >= 1; --i)\n        makeChangeNoReadonly(doc, {from: split[i].from, to: split[i].to, text: [\"\"]});\n      if (split.length)\n        makeChangeNoReadonly(doc, {from: split[0].from, to: split[0].to, text: change.text}, selUpdate);\n    } else {\n      makeChangeNoReadonly(doc, change, selUpdate);\n    }\n  }\n\n  function makeChangeNoReadonly(doc, change, selUpdate) {\n    if (change.text.length == 1 && change.text[0] == \"\" && posEq(change.from, change.to)) return;\n    var selAfter = computeSelAfterChange(doc, change, selUpdate);\n    addToHistory(doc, change, selAfter, doc.cm ? doc.cm.curOp.id : NaN);\n\n    makeChangeSingleDoc(doc, change, selAfter, stretchSpansOverChange(doc, change));\n    var rebased = [];\n\n    linkedDocs(doc, function(doc, sharedHist) {\n      if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n        rebaseHist(doc.history, change);\n        rebased.push(doc.history);\n      }\n      makeChangeSingleDoc(doc, change, null, stretchSpansOverChange(doc, change));\n    });\n  }\n\n  function makeChangeFromHistory(doc, type) {\n    if (doc.cm && doc.cm.state.suppressEdits) return;\n\n    var hist = doc.history;\n    var event = (type == \"undo\" ? hist.done : hist.undone).pop();\n    if (!event) return;\n\n    var anti = {changes: [], anchorBefore: event.anchorAfter, headBefore: event.headAfter,\n                anchorAfter: event.anchorBefore, headAfter: event.headBefore,\n                generation: hist.generation};\n    (type == \"undo\" ? hist.undone : hist.done).push(anti);\n    hist.generation = event.generation || ++hist.maxGeneration;\n\n    var filter = hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\");\n\n    for (var i = event.changes.length - 1; i >= 0; --i) {\n      var change = event.changes[i];\n      change.origin = type;\n      if (filter && !filterChange(doc, change, false)) {\n        (type == \"undo\" ? hist.done : hist.undone).length = 0;\n        return;\n      }\n\n      anti.changes.push(historyChangeFromChange(doc, change));\n\n      var after = i ? computeSelAfterChange(doc, change, null)\n                    : {anchor: event.anchorBefore, head: event.headBefore};\n      makeChangeSingleDoc(doc, change, after, mergeOldSpans(doc, change));\n      var rebased = [];\n\n      linkedDocs(doc, function(doc, sharedHist) {\n        if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n          rebaseHist(doc.history, change);\n          rebased.push(doc.history);\n        }\n        makeChangeSingleDoc(doc, change, null, mergeOldSpans(doc, change));\n      });\n    }\n  }\n\n  function shiftDoc(doc, distance) {\n    function shiftPos(pos) {return Pos(pos.line + distance, pos.ch);}\n    doc.first += distance;\n    if (doc.cm) regChange(doc.cm, doc.first, doc.first, distance);\n    doc.sel.head = shiftPos(doc.sel.head); doc.sel.anchor = shiftPos(doc.sel.anchor);\n    doc.sel.from = shiftPos(doc.sel.from); doc.sel.to = shiftPos(doc.sel.to);\n  }\n\n  function makeChangeSingleDoc(doc, change, selAfter, spans) {\n    if (doc.cm && !doc.cm.curOp)\n      return operation(doc.cm, makeChangeSingleDoc)(doc, change, selAfter, spans);\n\n    if (change.to.line < doc.first) {\n      shiftDoc(doc, change.text.length - 1 - (change.to.line - change.from.line));\n      return;\n    }\n    if (change.from.line > doc.lastLine()) return;\n\n    // Clip the change to the size of this doc\n    if (change.from.line < doc.first) {\n      var shift = change.text.length - 1 - (doc.first - change.from.line);\n      shiftDoc(doc, shift);\n      change = {from: Pos(doc.first, 0), to: Pos(change.to.line + shift, change.to.ch),\n                text: [lst(change.text)], origin: change.origin};\n    }\n    var last = doc.lastLine();\n    if (change.to.line > last) {\n      change = {from: change.from, to: Pos(last, getLine(doc, last).text.length),\n                text: [change.text[0]], origin: change.origin};\n    }\n\n    change.removed = getBetween(doc, change.from, change.to);\n\n    if (!selAfter) selAfter = computeSelAfterChange(doc, change, null);\n    if (doc.cm) makeChangeSingleDocInEditor(doc.cm, change, spans, selAfter);\n    else updateDoc(doc, change, spans, selAfter);\n  }\n\n  function makeChangeSingleDocInEditor(cm, change, spans, selAfter) {\n    var doc = cm.doc, display = cm.display, from = change.from, to = change.to;\n\n    var recomputeMaxLength = false, checkWidthStart = from.line;\n    if (!cm.options.lineWrapping) {\n      checkWidthStart = lineNo(visualLine(doc, getLine(doc, from.line)));\n      doc.iter(checkWidthStart, to.line + 1, function(line) {\n        if (line == display.maxLine) {\n          recomputeMaxLength = true;\n          return true;\n        }\n      });\n    }\n\n    if (!posLess(doc.sel.head, change.from) && !posLess(change.to, doc.sel.head))\n      cm.curOp.cursorActivity = true;\n\n    updateDoc(doc, change, spans, selAfter, estimateHeight(cm));\n\n    if (!cm.options.lineWrapping) {\n      doc.iter(checkWidthStart, from.line + change.text.length, function(line) {\n        var len = lineLength(doc, line);\n        if (len > display.maxLineLength) {\n          display.maxLine = line;\n          display.maxLineLength = len;\n          display.maxLineChanged = true;\n          recomputeMaxLength = false;\n        }\n      });\n      if (recomputeMaxLength) cm.curOp.updateMaxLine = true;\n    }\n\n    // Adjust frontier, schedule worker\n    doc.frontier = Math.min(doc.frontier, from.line);\n    startWorker(cm, 400);\n\n    var lendiff = change.text.length - (to.line - from.line) - 1;\n    // Remember that these lines changed, for updating the display\n    regChange(cm, from.line, to.line + 1, lendiff);\n\n    if (hasHandler(cm, \"change\")) {\n      var changeObj = {from: from, to: to,\n                       text: change.text,\n                       removed: change.removed,\n                       origin: change.origin};\n      if (cm.curOp.textChanged) {\n        for (var cur = cm.curOp.textChanged; cur.next; cur = cur.next) {}\n        cur.next = changeObj;\n      } else cm.curOp.textChanged = changeObj;\n    }\n  }\n\n  function replaceRange(doc, code, from, to, origin) {\n    if (!to) to = from;\n    if (posLess(to, from)) { var tmp = to; to = from; from = tmp; }\n    if (typeof code == \"string\") code = splitLines(code);\n    makeChange(doc, {from: from, to: to, text: code, origin: origin}, null);\n  }\n\n  // POSITION OBJECT\n\n  function Pos(line, ch) {\n    if (!(this instanceof Pos)) return new Pos(line, ch);\n    this.line = line; this.ch = ch;\n  }\n  CodeMirror.Pos = Pos;\n\n  function posEq(a, b) {return a.line == b.line && a.ch == b.ch;}\n  function posLess(a, b) {return a.line < b.line || (a.line == b.line && a.ch < b.ch);}\n  function cmp(a, b) {return a.line - b.line || a.ch - b.ch;}\n  function copyPos(x) {return Pos(x.line, x.ch);}\n\n  // SELECTION\n\n  function clipLine(doc, n) {return Math.max(doc.first, Math.min(n, doc.first + doc.size - 1));}\n  function clipPos(doc, pos) {\n    if (pos.line < doc.first) return Pos(doc.first, 0);\n    var last = doc.first + doc.size - 1;\n    if (pos.line > last) return Pos(last, getLine(doc, last).text.length);\n    return clipToLen(pos, getLine(doc, pos.line).text.length);\n  }\n  function clipToLen(pos, linelen) {\n    var ch = pos.ch;\n    if (ch == null || ch > linelen) return Pos(pos.line, linelen);\n    else if (ch < 0) return Pos(pos.line, 0);\n    else return pos;\n  }\n  function isLine(doc, l) {return l >= doc.first && l < doc.first + doc.size;}\n\n  // If shift is held, this will move the selection anchor. Otherwise,\n  // it'll set the whole selection.\n  function extendSelection(doc, pos, other, bias) {\n    if (doc.sel.shift || doc.sel.extend) {\n      var anchor = doc.sel.anchor;\n      if (other) {\n        var posBefore = posLess(pos, anchor);\n        if (posBefore != posLess(other, anchor)) {\n          anchor = pos;\n          pos = other;\n        } else if (posBefore != posLess(pos, other)) {\n          pos = other;\n        }\n      }\n      setSelection(doc, anchor, pos, bias);\n    } else {\n      setSelection(doc, pos, other || pos, bias);\n    }\n    if (doc.cm) doc.cm.curOp.userSelChange = true;\n  }\n\n  function filterSelectionChange(doc, anchor, head) {\n    var obj = {anchor: anchor, head: head};\n    signal(doc, \"beforeSelectionChange\", doc, obj);\n    if (doc.cm) signal(doc.cm, \"beforeSelectionChange\", doc.cm, obj);\n    obj.anchor = clipPos(doc, obj.anchor); obj.head = clipPos(doc, obj.head);\n    return obj;\n  }\n\n  // Update the selection. Last two args are only used by\n  // updateDoc, since they have to be expressed in the line\n  // numbers before the update.\n  function setSelection(doc, anchor, head, bias, checkAtomic) {\n    if (!checkAtomic && hasHandler(doc, \"beforeSelectionChange\") || doc.cm && hasHandler(doc.cm, \"beforeSelectionChange\")) {\n      var filtered = filterSelectionChange(doc, anchor, head);\n      head = filtered.head;\n      anchor = filtered.anchor;\n    }\n\n    var sel = doc.sel;\n    sel.goalColumn = null;\n    if (bias == null) bias = posLess(head, sel.head) ? -1 : 1;\n    // Skip over atomic spans.\n    if (checkAtomic || !posEq(anchor, sel.anchor))\n      anchor = skipAtomic(doc, anchor, bias, checkAtomic != \"push\");\n    if (checkAtomic || !posEq(head, sel.head))\n      head = skipAtomic(doc, head, bias, checkAtomic != \"push\");\n\n    if (posEq(sel.anchor, anchor) && posEq(sel.head, head)) return;\n\n    sel.anchor = anchor; sel.head = head;\n    var inv = posLess(head, anchor);\n    sel.from = inv ? head : anchor;\n    sel.to = inv ? anchor : head;\n\n    if (doc.cm)\n      doc.cm.curOp.updateInput = doc.cm.curOp.selectionChanged =\n        doc.cm.curOp.cursorActivity = true;\n\n    signalLater(doc, \"cursorActivity\", doc);\n  }\n\n  function reCheckSelection(cm) {\n    setSelection(cm.doc, cm.doc.sel.from, cm.doc.sel.to, null, \"push\");\n  }\n\n  function skipAtomic(doc, pos, bias, mayClear) {\n    var flipped = false, curPos = pos;\n    var dir = bias || 1;\n    doc.cantEdit = false;\n    search: for (;;) {\n      var line = getLine(doc, curPos.line);\n      if (line.markedSpans) {\n        for (var i = 0; i < line.markedSpans.length; ++i) {\n          var sp = line.markedSpans[i], m = sp.marker;\n          if ((sp.from == null || (m.inclusiveLeft ? sp.from <= curPos.ch : sp.from < curPos.ch)) &&\n              (sp.to == null || (m.inclusiveRight ? sp.to >= curPos.ch : sp.to > curPos.ch))) {\n            if (mayClear) {\n              signal(m, \"beforeCursorEnter\");\n              if (m.explicitlyCleared) {\n                if (!line.markedSpans) break;\n                else {--i; continue;}\n              }\n            }\n            if (!m.atomic) continue;\n            var newPos = m.find()[dir < 0 ? \"from\" : \"to\"];\n            if (posEq(newPos, curPos)) {\n              newPos.ch += dir;\n              if (newPos.ch < 0) {\n                if (newPos.line > doc.first) newPos = clipPos(doc, Pos(newPos.line - 1));\n                else newPos = null;\n              } else if (newPos.ch > line.text.length) {\n                if (newPos.line < doc.first + doc.size - 1) newPos = Pos(newPos.line + 1, 0);\n                else newPos = null;\n              }\n              if (!newPos) {\n                if (flipped) {\n                  // Driven in a corner -- no valid cursor position found at all\n                  // -- try again *with* clearing, if we didn't already\n                  if (!mayClear) return skipAtomic(doc, pos, bias, true);\n                  // Otherwise, turn off editing until further notice, and return the start of the doc\n                  doc.cantEdit = true;\n                  return Pos(doc.first, 0);\n                }\n                flipped = true; newPos = pos; dir = -dir;\n              }\n            }\n            curPos = newPos;\n            continue search;\n          }\n        }\n      }\n      return curPos;\n    }\n  }\n\n  // SCROLLING\n\n  function scrollCursorIntoView(cm) {\n    var coords = scrollPosIntoView(cm, cm.doc.sel.head, null, cm.options.cursorScrollMargin);\n    if (!cm.state.focused) return;\n    var display = cm.display, box = getRect(display.sizer), doScroll = null;\n    if (coords.top + box.top < 0) doScroll = true;\n    else if (coords.bottom + box.top > (window.innerHeight || document.documentElement.clientHeight)) doScroll = false;\n    if (doScroll != null && !phantom) {\n      var scrollNode = elt(\"div\", \"\\u200b\", null, \"position: absolute; top: \" +\n                           (coords.top - display.viewOffset) + \"px; height: \" +\n                           (coords.bottom - coords.top + scrollerCutOff) + \"px; left: \" +\n                           coords.left + \"px; width: 2px;\");\n      cm.display.lineSpace.appendChild(scrollNode);\n      scrollNode.scrollIntoView(doScroll);\n      cm.display.lineSpace.removeChild(scrollNode);\n    }\n  }\n\n  function scrollPosIntoView(cm, pos, end, margin) {\n    if (margin == null) margin = 0;\n    for (;;) {\n      var changed = false, coords = cursorCoords(cm, pos);\n      var endCoords = !end || end == pos ? coords : cursorCoords(cm, end);\n      var scrollPos = calculateScrollPos(cm, Math.min(coords.left, endCoords.left),\n                                         Math.min(coords.top, endCoords.top) - margin,\n                                         Math.max(coords.left, endCoords.left),\n                                         Math.max(coords.bottom, endCoords.bottom) + margin);\n      var startTop = cm.doc.scrollTop, startLeft = cm.doc.scrollLeft;\n      if (scrollPos.scrollTop != null) {\n        setScrollTop(cm, scrollPos.scrollTop);\n        if (Math.abs(cm.doc.scrollTop - startTop) > 1) changed = true;\n      }\n      if (scrollPos.scrollLeft != null) {\n        setScrollLeft(cm, scrollPos.scrollLeft);\n        if (Math.abs(cm.doc.scrollLeft - startLeft) > 1) changed = true;\n      }\n      if (!changed) return coords;\n    }\n  }\n\n  function scrollIntoView(cm, x1, y1, x2, y2) {\n    var scrollPos = calculateScrollPos(cm, x1, y1, x2, y2);\n    if (scrollPos.scrollTop != null) setScrollTop(cm, scrollPos.scrollTop);\n    if (scrollPos.scrollLeft != null) setScrollLeft(cm, scrollPos.scrollLeft);\n  }\n\n  function calculateScrollPos(cm, x1, y1, x2, y2) {\n    var display = cm.display, snapMargin = textHeight(cm.display);\n    if (y1 < 0) y1 = 0;\n    var screen = display.scroller.clientHeight - scrollerCutOff, screentop = display.scroller.scrollTop, result = {};\n    var docBottom = cm.doc.height + paddingVert(display);\n    var atTop = y1 < snapMargin, atBottom = y2 > docBottom - snapMargin;\n    if (y1 < screentop) {\n      result.scrollTop = atTop ? 0 : y1;\n    } else if (y2 > screentop + screen) {\n      var newTop = Math.min(y1, (atBottom ? docBottom : y2) - screen);\n      if (newTop != screentop) result.scrollTop = newTop;\n    }\n\n    var screenw = display.scroller.clientWidth - scrollerCutOff, screenleft = display.scroller.scrollLeft;\n    x1 += display.gutters.offsetWidth; x2 += display.gutters.offsetWidth;\n    var gutterw = display.gutters.offsetWidth;\n    var atLeft = x1 < gutterw + 10;\n    if (x1 < screenleft + gutterw || atLeft) {\n      if (atLeft) x1 = 0;\n      result.scrollLeft = Math.max(0, x1 - 10 - gutterw);\n    } else if (x2 > screenw + screenleft - 3) {\n      result.scrollLeft = x2 + 10 - screenw;\n    }\n    return result;\n  }\n\n  function updateScrollPos(cm, left, top) {\n    cm.curOp.updateScrollPos = {scrollLeft: left == null ? cm.doc.scrollLeft : left,\n                                scrollTop: top == null ? cm.doc.scrollTop : top};\n  }\n\n  function addToScrollPos(cm, left, top) {\n    var pos = cm.curOp.updateScrollPos || (cm.curOp.updateScrollPos = {scrollLeft: cm.doc.scrollLeft, scrollTop: cm.doc.scrollTop});\n    var scroll = cm.display.scroller;\n    pos.scrollTop = Math.max(0, Math.min(scroll.scrollHeight - scroll.clientHeight, pos.scrollTop + top));\n    pos.scrollLeft = Math.max(0, Math.min(scroll.scrollWidth - scroll.clientWidth, pos.scrollLeft + left));\n  }\n\n  // API UTILITIES\n\n  function indentLine(cm, n, how, aggressive) {\n    var doc = cm.doc, state;\n    if (how == null) how = \"add\";\n    if (how == \"smart\") {\n      if (!cm.doc.mode.indent) how = \"prev\";\n      else state = getStateBefore(cm, n);\n    }\n\n    var tabSize = cm.options.tabSize;\n    var line = getLine(doc, n), curSpace = countColumn(line.text, null, tabSize);\n    if (line.stateAfter) line.stateAfter = null;\n    var curSpaceString = line.text.match(/^\\s*/)[0], indentation;\n    if (!aggressive && !/\\S/.test(line.text)) {\n      indentation = 0;\n      how = \"not\";\n    } else if (how == \"smart\") {\n      indentation = cm.doc.mode.indent(state, line.text.slice(curSpaceString.length), line.text);\n      if (indentation == Pass) {\n        if (!aggressive) return;\n        how = \"prev\";\n      }\n    }\n    if (how == \"prev\") {\n      if (n > doc.first) indentation = countColumn(getLine(doc, n-1).text, null, tabSize);\n      else indentation = 0;\n    } else if (how == \"add\") {\n      indentation = curSpace + cm.options.indentUnit;\n    } else if (how == \"subtract\") {\n      indentation = curSpace - cm.options.indentUnit;\n    } else if (typeof how == \"number\") {\n      indentation = curSpace + how;\n    }\n    indentation = Math.max(0, indentation);\n\n    var indentString = \"\", pos = 0;\n    if (cm.options.indentWithTabs)\n      for (var i = Math.floor(indentation / tabSize); i; --i) {pos += tabSize; indentString += \"\\t\";}\n    if (pos < indentation) indentString += spaceStr(indentation - pos);\n\n    if (indentString != curSpaceString)\n      replaceRange(cm.doc, indentString, Pos(n, 0), Pos(n, curSpaceString.length), \"+input\");\n    else if (doc.sel.head.line == n && doc.sel.head.ch < curSpaceString.length)\n      setSelection(doc, Pos(n, curSpaceString.length), Pos(n, curSpaceString.length), 1);\n    line.stateAfter = null;\n  }\n\n  function changeLine(cm, handle, op) {\n    var no = handle, line = handle, doc = cm.doc;\n    if (typeof handle == \"number\") line = getLine(doc, clipLine(doc, handle));\n    else no = lineNo(handle);\n    if (no == null) return null;\n    if (op(line, no)) regChange(cm, no, no + 1);\n    else return null;\n    return line;\n  }\n\n  function findPosH(doc, pos, dir, unit, visually) {\n    var line = pos.line, ch = pos.ch, origDir = dir;\n    var lineObj = getLine(doc, line);\n    var possible = true;\n    function findNextLine() {\n      var l = line + dir;\n      if (l < doc.first || l >= doc.first + doc.size) return (possible = false);\n      line = l;\n      return lineObj = getLine(doc, l);\n    }\n    function moveOnce(boundToLine) {\n      var next = (visually ? moveVisually : moveLogically)(lineObj, ch, dir, true);\n      if (next == null) {\n        if (!boundToLine && findNextLine()) {\n          if (visually) ch = (dir < 0 ? lineRight : lineLeft)(lineObj);\n          else ch = dir < 0 ? lineObj.text.length : 0;\n        } else return (possible = false);\n      } else ch = next;\n      return true;\n    }\n\n    if (unit == \"char\") moveOnce();\n    else if (unit == \"column\") moveOnce(true);\n    else if (unit == \"word\" || unit == \"group\") {\n      var sawType = null, group = unit == \"group\";\n      for (var first = true;; first = false) {\n        if (dir < 0 && !moveOnce(!first)) break;\n        var cur = lineObj.text.charAt(ch) || \"\\n\";\n        var type = isWordChar(cur) ? \"w\"\n          : group && cur == \"\\n\" ? \"n\"\n          : !group || /\\s/.test(cur) ? null\n          : \"p\";\n        if (group && !first && !type) type = \"s\";\n        if (sawType && sawType != type) {\n          if (dir < 0) {dir = 1; moveOnce();}\n          break;\n        }\n\n        if (type) sawType = type;\n        if (dir > 0 && !moveOnce(!first)) break;\n      }\n    }\n    var result = skipAtomic(doc, Pos(line, ch), origDir, true);\n    if (!possible) result.hitSide = true;\n    return result;\n  }\n\n  function findPosV(cm, pos, dir, unit) {\n    var doc = cm.doc, x = pos.left, y;\n    if (unit == \"page\") {\n      var pageSize = Math.min(cm.display.wrapper.clientHeight, window.innerHeight || document.documentElement.clientHeight);\n      y = pos.top + dir * (pageSize - (dir < 0 ? 1.5 : .5) * textHeight(cm.display));\n    } else if (unit == \"line\") {\n      y = dir > 0 ? pos.bottom + 3 : pos.top - 3;\n    }\n    for (;;) {\n      var target = coordsChar(cm, x, y);\n      if (!target.outside) break;\n      if (dir < 0 ? y <= 0 : y >= doc.height) { target.hitSide = true; break; }\n      y += dir * 5;\n    }\n    return target;\n  }\n\n  function findWordAt(line, pos) {\n    var start = pos.ch, end = pos.ch;\n    if (line) {\n      if ((pos.xRel < 0 || end == line.length) && start) --start; else ++end;\n      var startChar = line.charAt(start);\n      var check = isWordChar(startChar) ? isWordChar\n        : /\\s/.test(startChar) ? function(ch) {return /\\s/.test(ch);}\n        : function(ch) {return !/\\s/.test(ch) && !isWordChar(ch);};\n      while (start > 0 && check(line.charAt(start - 1))) --start;\n      while (end < line.length && check(line.charAt(end))) ++end;\n    }\n    return {from: Pos(pos.line, start), to: Pos(pos.line, end)};\n  }\n\n  function selectLine(cm, line) {\n    extendSelection(cm.doc, Pos(line, 0), clipPos(cm.doc, Pos(line + 1, 0)));\n  }\n\n  // PROTOTYPE\n\n  // The publicly visible API. Note that operation(null, f) means\n  // 'wrap f in an operation, performed on its `this` parameter'\n\n  CodeMirror.prototype = {\n    constructor: CodeMirror,\n    focus: function(){window.focus(); focusInput(this); fastPoll(this);},\n\n    setOption: function(option, value) {\n      var options = this.options, old = options[option];\n      if (options[option] == value && option != \"mode\") return;\n      options[option] = value;\n      if (optionHandlers.hasOwnProperty(option))\n        operation(this, optionHandlers[option])(this, value, old);\n    },\n\n    getOption: function(option) {return this.options[option];},\n    getDoc: function() {return this.doc;},\n\n    addKeyMap: function(map, bottom) {\n      this.state.keyMaps[bottom ? \"push\" : \"unshift\"](map);\n    },\n    removeKeyMap: function(map) {\n      var maps = this.state.keyMaps;\n      for (var i = 0; i < maps.length; ++i)\n        if (maps[i] == map || (typeof maps[i] != \"string\" && maps[i].name == map)) {\n          maps.splice(i, 1);\n          return true;\n        }\n    },\n\n    addOverlay: operation(null, function(spec, options) {\n      var mode = spec.token ? spec : CodeMirror.getMode(this.options, spec);\n      if (mode.startState) throw new Error(\"Overlays may not be stateful.\");\n      this.state.overlays.push({mode: mode, modeSpec: spec, opaque: options && options.opaque});\n      this.state.modeGen++;\n      regChange(this);\n    }),\n    removeOverlay: operation(null, function(spec) {\n      var overlays = this.state.overlays;\n      for (var i = 0; i < overlays.length; ++i) {\n        var cur = overlays[i].modeSpec;\n        if (cur == spec || typeof spec == \"string\" && cur.name == spec) {\n          overlays.splice(i, 1);\n          this.state.modeGen++;\n          regChange(this);\n          return;\n        }\n      }\n    }),\n\n    indentLine: operation(null, function(n, dir, aggressive) {\n      if (typeof dir != \"string\" && typeof dir != \"number\") {\n        if (dir == null) dir = this.options.smartIndent ? \"smart\" : \"prev\";\n        else dir = dir ? \"add\" : \"subtract\";\n      }\n      if (isLine(this.doc, n)) indentLine(this, n, dir, aggressive);\n    }),\n    indentSelection: operation(null, function(how) {\n      var sel = this.doc.sel;\n      if (posEq(sel.from, sel.to)) return indentLine(this, sel.from.line, how, true);\n      var e = sel.to.line - (sel.to.ch ? 0 : 1);\n      for (var i = sel.from.line; i <= e; ++i) indentLine(this, i, how);\n    }),\n\n    // Fetch the parser token for a given character. Useful for hacks\n    // that want to inspect the mode state (say, for completion).\n    getTokenAt: function(pos, precise) {\n      var doc = this.doc;\n      pos = clipPos(doc, pos);\n      var state = getStateBefore(this, pos.line, precise), mode = this.doc.mode;\n      var line = getLine(doc, pos.line);\n      var stream = new StringStream(line.text, this.options.tabSize);\n      while (stream.pos < pos.ch && !stream.eol()) {\n        stream.start = stream.pos;\n        var style = mode.token(stream, state);\n      }\n      return {start: stream.start,\n              end: stream.pos,\n              string: stream.current(),\n              className: style || null, // Deprecated, use 'type' instead\n              type: style || null,\n              state: state};\n    },\n\n    getTokenTypeAt: function(pos) {\n      pos = clipPos(this.doc, pos);\n      var styles = getLineStyles(this, getLine(this.doc, pos.line));\n      var before = 0, after = (styles.length - 1) / 2, ch = pos.ch;\n      if (ch == 0) return styles[2];\n      for (;;) {\n        var mid = (before + after) >> 1;\n        if ((mid ? styles[mid * 2 - 1] : 0) >= ch) after = mid;\n        else if (styles[mid * 2 + 1] < ch) before = mid + 1;\n        else return styles[mid * 2 + 2];\n      }\n    },\n\n    getModeAt: function(pos) {\n      var mode = this.doc.mode;\n      if (!mode.innerMode) return mode;\n      return CodeMirror.innerMode(mode, this.getTokenAt(pos).state).mode;\n    },\n\n    getHelper: function(pos, type) {\n      return this.getHelpers(pos, type)[0];\n    },\n\n    getHelpers: function(pos, type) {\n      var found = [];\n      if (!helpers.hasOwnProperty(type)) return helpers;\n      var help = helpers[type], mode = this.getModeAt(pos);\n      if (typeof mode[type] == \"string\") {\n        if (help[mode[type]]) found.push(help[mode[type]]);\n      } else if (mode[type]) {\n        for (var i = 0; i < mode[type].length; i++) {\n          var val = help[mode[type][i]];\n          if (val) found.push(val);\n        }\n      } else if (mode.helperType && help[mode.helperType]) {\n        found.push(help[mode.helperType]);\n      } else if (help[mode.name]) {\n        found.push(help[mode.name]);\n      }\n      for (var i = 0; i < help._global.length; i++) {\n        var cur = help._global[i];\n        if (cur.pred(mode, this) && indexOf(found, cur.val) == -1)\n          found.push(cur.val);\n      }\n      return found;\n    },\n\n    getStateAfter: function(line, precise) {\n      var doc = this.doc;\n      line = clipLine(doc, line == null ? doc.first + doc.size - 1: line);\n      return getStateBefore(this, line + 1, precise);\n    },\n\n    cursorCoords: function(start, mode) {\n      var pos, sel = this.doc.sel;\n      if (start == null) pos = sel.head;\n      else if (typeof start == \"object\") pos = clipPos(this.doc, start);\n      else pos = start ? sel.from : sel.to;\n      return cursorCoords(this, pos, mode || \"page\");\n    },\n\n    charCoords: function(pos, mode) {\n      return charCoords(this, clipPos(this.doc, pos), mode || \"page\");\n    },\n\n    coordsChar: function(coords, mode) {\n      coords = fromCoordSystem(this, coords, mode || \"page\");\n      return coordsChar(this, coords.left, coords.top);\n    },\n\n    lineAtHeight: function(height, mode) {\n      height = fromCoordSystem(this, {top: height, left: 0}, mode || \"page\").top;\n      return lineAtHeight(this.doc, height + this.display.viewOffset);\n    },\n    heightAtLine: function(line, mode) {\n      var end = false, last = this.doc.first + this.doc.size - 1;\n      if (line < this.doc.first) line = this.doc.first;\n      else if (line > last) { line = last; end = true; }\n      var lineObj = getLine(this.doc, line);\n      return intoCoordSystem(this, getLine(this.doc, line), {top: 0, left: 0}, mode || \"page\").top +\n        (end ? lineObj.height : 0);\n    },\n\n    defaultTextHeight: function() { return textHeight(this.display); },\n    defaultCharWidth: function() { return charWidth(this.display); },\n\n    setGutterMarker: operation(null, function(line, gutterID, value) {\n      return changeLine(this, line, function(line) {\n        var markers = line.gutterMarkers || (line.gutterMarkers = {});\n        markers[gutterID] = value;\n        if (!value && isEmpty(markers)) line.gutterMarkers = null;\n        return true;\n      });\n    }),\n\n    clearGutter: operation(null, function(gutterID) {\n      var cm = this, doc = cm.doc, i = doc.first;\n      doc.iter(function(line) {\n        if (line.gutterMarkers && line.gutterMarkers[gutterID]) {\n          line.gutterMarkers[gutterID] = null;\n          regChange(cm, i, i + 1);\n          if (isEmpty(line.gutterMarkers)) line.gutterMarkers = null;\n        }\n        ++i;\n      });\n    }),\n\n    addLineClass: operation(null, function(handle, where, cls) {\n      return changeLine(this, handle, function(line) {\n        var prop = where == \"text\" ? \"textClass\" : where == \"background\" ? \"bgClass\" : \"wrapClass\";\n        if (!line[prop]) line[prop] = cls;\n        else if (new RegExp(\"(?:^|\\\\s)\" + cls + \"(?:$|\\\\s)\").test(line[prop])) return false;\n        else line[prop] += \" \" + cls;\n        return true;\n      });\n    }),\n\n    removeLineClass: operation(null, function(handle, where, cls) {\n      return changeLine(this, handle, function(line) {\n        var prop = where == \"text\" ? \"textClass\" : where == \"background\" ? \"bgClass\" : \"wrapClass\";\n        var cur = line[prop];\n        if (!cur) return false;\n        else if (cls == null) line[prop] = null;\n        else {\n          var found = cur.match(new RegExp(\"(?:^|\\\\s+)\" + cls + \"(?:$|\\\\s+)\"));\n          if (!found) return false;\n          var end = found.index + found[0].length;\n          line[prop] = cur.slice(0, found.index) + (!found.index || end == cur.length ? \"\" : \" \") + cur.slice(end) || null;\n        }\n        return true;\n      });\n    }),\n\n    addLineWidget: operation(null, function(handle, node, options) {\n      return addLineWidget(this, handle, node, options);\n    }),\n\n    removeLineWidget: function(widget) { widget.clear(); },\n\n    lineInfo: function(line) {\n      if (typeof line == \"number\") {\n        if (!isLine(this.doc, line)) return null;\n        var n = line;\n        line = getLine(this.doc, line);\n        if (!line) return null;\n      } else {\n        var n = lineNo(line);\n        if (n == null) return null;\n      }\n      return {line: n, handle: line, text: line.text, gutterMarkers: line.gutterMarkers,\n              textClass: line.textClass, bgClass: line.bgClass, wrapClass: line.wrapClass,\n              widgets: line.widgets};\n    },\n\n    getViewport: function() { return {from: this.display.showingFrom, to: this.display.showingTo};},\n\n    addWidget: function(pos, node, scroll, vert, horiz) {\n      var display = this.display;\n      pos = cursorCoords(this, clipPos(this.doc, pos));\n      var top = pos.bottom, left = pos.left;\n      node.style.position = \"absolute\";\n      display.sizer.appendChild(node);\n      if (vert == \"over\") {\n        top = pos.top;\n      } else if (vert == \"above\" || vert == \"near\") {\n        var vspace = Math.max(display.wrapper.clientHeight, this.doc.height),\n        hspace = Math.max(display.sizer.clientWidth, display.lineSpace.clientWidth);\n        // Default to positioning above (if specified and possible); otherwise default to positioning below\n        if ((vert == 'above' || pos.bottom + node.offsetHeight > vspace) && pos.top > node.offsetHeight)\n          top = pos.top - node.offsetHeight;\n        else if (pos.bottom + node.offsetHeight <= vspace)\n          top = pos.bottom;\n        if (left + node.offsetWidth > hspace)\n          left = hspace - node.offsetWidth;\n      }\n      node.style.top = top + \"px\";\n      node.style.left = node.style.right = \"\";\n      if (horiz == \"right\") {\n        left = display.sizer.clientWidth - node.offsetWidth;\n        node.style.right = \"0px\";\n      } else {\n        if (horiz == \"left\") left = 0;\n        else if (horiz == \"middle\") left = (display.sizer.clientWidth - node.offsetWidth) / 2;\n        node.style.left = left + \"px\";\n      }\n      if (scroll)\n        scrollIntoView(this, left, top, left + node.offsetWidth, top + node.offsetHeight);\n    },\n\n    triggerOnKeyDown: operation(null, onKeyDown),\n    triggerOnKeyPress: operation(null, onKeyPress),\n    triggerOnKeyUp: operation(null, onKeyUp),\n\n    execCommand: function(cmd) {\n      if (commands.hasOwnProperty(cmd))\n        return commands[cmd](this);\n    },\n\n    findPosH: function(from, amount, unit, visually) {\n      var dir = 1;\n      if (amount < 0) { dir = -1; amount = -amount; }\n      for (var i = 0, cur = clipPos(this.doc, from); i < amount; ++i) {\n        cur = findPosH(this.doc, cur, dir, unit, visually);\n        if (cur.hitSide) break;\n      }\n      return cur;\n    },\n\n    moveH: operation(null, function(dir, unit) {\n      var sel = this.doc.sel, pos;\n      if (sel.shift || sel.extend || posEq(sel.from, sel.to))\n        pos = findPosH(this.doc, sel.head, dir, unit, this.options.rtlMoveVisually);\n      else\n        pos = dir < 0 ? sel.from : sel.to;\n      extendSelection(this.doc, pos, pos, dir);\n    }),\n\n    deleteH: operation(null, function(dir, unit) {\n      var sel = this.doc.sel;\n      if (!posEq(sel.from, sel.to)) replaceRange(this.doc, \"\", sel.from, sel.to, \"+delete\");\n      else replaceRange(this.doc, \"\", sel.from, findPosH(this.doc, sel.head, dir, unit, false), \"+delete\");\n      this.curOp.userSelChange = true;\n    }),\n\n    findPosV: function(from, amount, unit, goalColumn) {\n      var dir = 1, x = goalColumn;\n      if (amount < 0) { dir = -1; amount = -amount; }\n      for (var i = 0, cur = clipPos(this.doc, from); i < amount; ++i) {\n        var coords = cursorCoords(this, cur, \"div\");\n        if (x == null) x = coords.left;\n        else coords.left = x;\n        cur = findPosV(this, coords, dir, unit);\n        if (cur.hitSide) break;\n      }\n      return cur;\n    },\n\n    moveV: operation(null, function(dir, unit) {\n      var sel = this.doc.sel, target, goal;\n      if (sel.shift || sel.extend || posEq(sel.from, sel.to)) {\n        var pos = cursorCoords(this, sel.head, \"div\");\n        if (sel.goalColumn != null) pos.left = sel.goalColumn;\n        target = findPosV(this, pos, dir, unit);\n        if (unit == \"page\") addToScrollPos(this, 0, charCoords(this, target, \"div\").top - pos.top);\n        goal = pos.left;\n      } else {\n        target = dir < 0 ? sel.from : sel.to;\n      }\n      extendSelection(this.doc, target, target, dir);\n      if (goal != null) sel.goalColumn = goal;\n    }),\n\n    toggleOverwrite: function(value) {\n      if (value != null && value == this.state.overwrite) return;\n      if (this.state.overwrite = !this.state.overwrite)\n        this.display.cursor.className += \" CodeMirror-overwrite\";\n      else\n        this.display.cursor.className = this.display.cursor.className.replace(\" CodeMirror-overwrite\", \"\");\n\n      signal(this, \"overwriteToggle\", this, this.state.overwrite);\n    },\n    hasFocus: function() { return document.activeElement == this.display.input; },\n\n    scrollTo: operation(null, function(x, y) {\n      updateScrollPos(this, x, y);\n    }),\n    getScrollInfo: function() {\n      var scroller = this.display.scroller, co = scrollerCutOff;\n      return {left: scroller.scrollLeft, top: scroller.scrollTop,\n              height: scroller.scrollHeight - co, width: scroller.scrollWidth - co,\n              clientHeight: scroller.clientHeight - co, clientWidth: scroller.clientWidth - co};\n    },\n\n    scrollIntoView: operation(null, function(range, margin) {\n      if (range == null) range = {from: this.doc.sel.head, to: null};\n      else if (typeof range == \"number\") range = {from: Pos(range, 0), to: null};\n      else if (range.from == null) range = {from: range, to: null};\n      if (!range.to) range.to = range.from;\n      if (!margin) margin = 0;\n\n      var coords = range;\n      if (range.from.line != null) {\n        this.curOp.scrollToPos = {from: range.from, to: range.to, margin: margin};\n        coords = {from: cursorCoords(this, range.from),\n                  to: cursorCoords(this, range.to)};\n      }\n      var sPos = calculateScrollPos(this, Math.min(coords.from.left, coords.to.left),\n                                    Math.min(coords.from.top, coords.to.top) - margin,\n                                    Math.max(coords.from.right, coords.to.right),\n                                    Math.max(coords.from.bottom, coords.to.bottom) + margin);\n      updateScrollPos(this, sPos.scrollLeft, sPos.scrollTop);\n    }),\n\n    setSize: operation(null, function(width, height) {\n      function interpret(val) {\n        return typeof val == \"number\" || /^\\d+$/.test(String(val)) ? val + \"px\" : val;\n      }\n      if (width != null) this.display.wrapper.style.width = interpret(width);\n      if (height != null) this.display.wrapper.style.height = interpret(height);\n      if (this.options.lineWrapping)\n        this.display.measureLineCache.length = this.display.measureLineCachePos = 0;\n      this.curOp.forceUpdate = true;\n      signal(this, \"refresh\", this);\n    }),\n\n    operation: function(f){return runInOp(this, f);},\n\n    refresh: operation(null, function() {\n      var oldHeight = this.display.cachedTextHeight;\n      clearCaches(this);\n      updateScrollPos(this, this.doc.scrollLeft, this.doc.scrollTop);\n      regChange(this);\n      if (oldHeight == null || Math.abs(oldHeight - textHeight(this.display)) > .5)\n        estimateLineHeights(this);\n      signal(this, \"refresh\", this);\n    }),\n\n    swapDoc: operation(null, function(doc) {\n      var old = this.doc;\n      old.cm = null;\n      attachDoc(this, doc);\n      clearCaches(this);\n      resetInput(this, true);\n      updateScrollPos(this, doc.scrollLeft, doc.scrollTop);\n      signalLater(this, \"swapDoc\", this, old);\n      return old;\n    }),\n\n    getInputField: function(){return this.display.input;},\n    getWrapperElement: function(){return this.display.wrapper;},\n    getScrollerElement: function(){return this.display.scroller;},\n    getGutterElement: function(){return this.display.gutters;}\n  };\n  eventMixin(CodeMirror);\n\n  // OPTION DEFAULTS\n\n  var optionHandlers = CodeMirror.optionHandlers = {};\n\n  // The default configuration options.\n  var defaults = CodeMirror.defaults = {};\n\n  function option(name, deflt, handle, notOnInit) {\n    CodeMirror.defaults[name] = deflt;\n    if (handle) optionHandlers[name] =\n      notOnInit ? function(cm, val, old) {if (old != Init) handle(cm, val, old);} : handle;\n  }\n\n  var Init = CodeMirror.Init = {toString: function(){return \"CodeMirror.Init\";}};\n\n  // These two are, on init, called from the constructor because they\n  // have to be initialized before the editor can start at all.\n  option(\"value\", \"\", function(cm, val) {\n    cm.setValue(val);\n  }, true);\n  option(\"mode\", null, function(cm, val) {\n    cm.doc.modeOption = val;\n    loadMode(cm);\n  }, true);\n\n  option(\"indentUnit\", 2, loadMode, true);\n  option(\"indentWithTabs\", false);\n  option(\"smartIndent\", true);\n  option(\"tabSize\", 4, function(cm) {\n    resetModeState(cm);\n    clearCaches(cm);\n    regChange(cm);\n  }, true);\n  option(\"specialChars\", /[\\t\\u0000-\\u0019\\u00ad\\u200b\\u2028\\u2029\\ufeff]/g, function(cm, val) {\n    cm.options.specialChars = new RegExp(val.source + (val.test(\"\\t\") ? \"\" : \"|\\t\"), \"g\");\n    cm.refresh();\n  }, true);\n  option(\"specialCharPlaceholder\", defaultSpecialCharPlaceholder, function(cm) {cm.refresh();}, true);\n  option(\"electricChars\", true);\n  option(\"rtlMoveVisually\", !windows);\n  option(\"wholeLineUpdateBefore\", true);\n\n  option(\"theme\", \"default\", function(cm) {\n    themeChanged(cm);\n    guttersChanged(cm);\n  }, true);\n  option(\"keyMap\", \"default\", keyMapChanged);\n  option(\"extraKeys\", null);\n\n  option(\"onKeyEvent\", null);\n  option(\"onDragEvent\", null);\n\n  option(\"lineWrapping\", false, wrappingChanged, true);\n  option(\"gutters\", [], function(cm) {\n    setGuttersForLineNumbers(cm.options);\n    guttersChanged(cm);\n  }, true);\n  option(\"fixedGutter\", true, function(cm, val) {\n    cm.display.gutters.style.left = val ? compensateForHScroll(cm.display) + \"px\" : \"0\";\n    cm.refresh();\n  }, true);\n  option(\"coverGutterNextToScrollbar\", false, updateScrollbars, true);\n  option(\"lineNumbers\", false, function(cm) {\n    setGuttersForLineNumbers(cm.options);\n    guttersChanged(cm);\n  }, true);\n  option(\"firstLineNumber\", 1, guttersChanged, true);\n  option(\"lineNumberFormatter\", function(integer) {return integer;}, guttersChanged, true);\n  option(\"showCursorWhenSelecting\", false, updateSelection, true);\n\n  option(\"resetSelectionOnContextMenu\", true);\n\n  option(\"readOnly\", false, function(cm, val) {\n    if (val == \"nocursor\") {\n      onBlur(cm);\n      cm.display.input.blur();\n      cm.display.disabled = true;\n    } else {\n      cm.display.disabled = false;\n      if (!val) resetInput(cm, true);\n    }\n  });\n  option(\"disableInput\", false, function(cm, val) {if (!val) resetInput(cm, true);}, true);\n  option(\"dragDrop\", true);\n\n  option(\"cursorBlinkRate\", 530);\n  option(\"cursorScrollMargin\", 0);\n  option(\"cursorHeight\", 1);\n  option(\"workTime\", 100);\n  option(\"workDelay\", 100);\n  option(\"flattenSpans\", true, resetModeState, true);\n  option(\"addModeClass\", false, resetModeState, true);\n  option(\"pollInterval\", 100);\n  option(\"undoDepth\", 40, function(cm, val){cm.doc.history.undoDepth = val;});\n  option(\"historyEventDelay\", 500);\n  option(\"viewportMargin\", 10, function(cm){cm.refresh();}, true);\n  option(\"maxHighlightLength\", 10000, resetModeState, true);\n  option(\"crudeMeasuringFrom\", 10000);\n  option(\"moveInputWithCursor\", true, function(cm, val) {\n    if (!val) cm.display.inputDiv.style.top = cm.display.inputDiv.style.left = 0;\n  });\n\n  option(\"tabindex\", null, function(cm, val) {\n    cm.display.input.tabIndex = val || \"\";\n  });\n  option(\"autofocus\", null);\n\n  // MODE DEFINITION AND QUERYING\n\n  // Known modes, by name and by MIME\n  var modes = CodeMirror.modes = {}, mimeModes = CodeMirror.mimeModes = {};\n\n  CodeMirror.defineMode = function(name, mode) {\n    if (!CodeMirror.defaults.mode && name != \"null\") CodeMirror.defaults.mode = name;\n    if (arguments.length > 2) {\n      mode.dependencies = [];\n      for (var i = 2; i < arguments.length; ++i) mode.dependencies.push(arguments[i]);\n    }\n    modes[name] = mode;\n  };\n\n  CodeMirror.defineMIME = function(mime, spec) {\n    mimeModes[mime] = spec;\n  };\n\n  CodeMirror.resolveMode = function(spec) {\n    if (typeof spec == \"string\" && mimeModes.hasOwnProperty(spec)) {\n      spec = mimeModes[spec];\n    } else if (spec && typeof spec.name == \"string\" && mimeModes.hasOwnProperty(spec.name)) {\n      var found = mimeModes[spec.name];\n      if (typeof found == \"string\") found = {name: found};\n      spec = createObj(found, spec);\n      spec.name = found.name;\n    } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+xml$/.test(spec)) {\n      return CodeMirror.resolveMode(\"application/xml\");\n    }\n    if (typeof spec == \"string\") return {name: spec};\n    else return spec || {name: \"null\"};\n  };\n\n  CodeMirror.getMode = function(options, spec) {\n    var spec = CodeMirror.resolveMode(spec);\n    var mfactory = modes[spec.name];\n    if (!mfactory) return CodeMirror.getMode(options, \"text/plain\");\n    var modeObj = mfactory(options, spec);\n    if (modeExtensions.hasOwnProperty(spec.name)) {\n      var exts = modeExtensions[spec.name];\n      for (var prop in exts) {\n        if (!exts.hasOwnProperty(prop)) continue;\n        if (modeObj.hasOwnProperty(prop)) modeObj[\"_\" + prop] = modeObj[prop];\n        modeObj[prop] = exts[prop];\n      }\n    }\n    modeObj.name = spec.name;\n    if (spec.helperType) modeObj.helperType = spec.helperType;\n    if (spec.modeProps) for (var prop in spec.modeProps)\n      modeObj[prop] = spec.modeProps[prop];\n\n    return modeObj;\n  };\n\n  CodeMirror.defineMode(\"null\", function() {\n    return {token: function(stream) {stream.skipToEnd();}};\n  });\n  CodeMirror.defineMIME(\"text/plain\", \"null\");\n\n  var modeExtensions = CodeMirror.modeExtensions = {};\n  CodeMirror.extendMode = function(mode, properties) {\n    var exts = modeExtensions.hasOwnProperty(mode) ? modeExtensions[mode] : (modeExtensions[mode] = {});\n    copyObj(properties, exts);\n  };\n\n  // EXTENSIONS\n\n  CodeMirror.defineExtension = function(name, func) {\n    CodeMirror.prototype[name] = func;\n  };\n  CodeMirror.defineDocExtension = function(name, func) {\n    Doc.prototype[name] = func;\n  };\n  CodeMirror.defineOption = option;\n\n  var initHooks = [];\n  CodeMirror.defineInitHook = function(f) {initHooks.push(f);};\n\n  var helpers = CodeMirror.helpers = {};\n  CodeMirror.registerHelper = function(type, name, value) {\n    if (!helpers.hasOwnProperty(type)) helpers[type] = CodeMirror[type] = {_global: []};\n    helpers[type][name] = value;\n  };\n  CodeMirror.registerGlobalHelper = function(type, name, predicate, value) {\n    CodeMirror.registerHelper(type, name, value);\n    helpers[type]._global.push({pred: predicate, val: value});\n  };\n\n  // UTILITIES\n\n  CodeMirror.isWordChar = isWordChar;\n\n  // MODE STATE HANDLING\n\n  // Utility functions for working with state. Exported because modes\n  // sometimes need to do this.\n  function copyState(mode, state) {\n    if (state === true) return state;\n    if (mode.copyState) return mode.copyState(state);\n    var nstate = {};\n    for (var n in state) {\n      var val = state[n];\n      if (val instanceof Array) val = val.concat([]);\n      nstate[n] = val;\n    }\n    return nstate;\n  }\n  CodeMirror.copyState = copyState;\n\n  function startState(mode, a1, a2) {\n    return mode.startState ? mode.startState(a1, a2) : true;\n  }\n  CodeMirror.startState = startState;\n\n  CodeMirror.innerMode = function(mode, state) {\n    while (mode.innerMode) {\n      var info = mode.innerMode(state);\n      if (!info || info.mode == mode) break;\n      state = info.state;\n      mode = info.mode;\n    }\n    return info || {mode: mode, state: state};\n  };\n\n  // STANDARD COMMANDS\n\n  var commands = CodeMirror.commands = {\n    selectAll: function(cm) {cm.setSelection(Pos(cm.firstLine(), 0), Pos(cm.lastLine()));},\n    killLine: function(cm) {\n      var from = cm.getCursor(true), to = cm.getCursor(false), sel = !posEq(from, to);\n      if (!sel && cm.getLine(from.line).length == from.ch)\n        cm.replaceRange(\"\", from, Pos(from.line + 1, 0), \"+delete\");\n      else cm.replaceRange(\"\", from, sel ? to : Pos(from.line), \"+delete\");\n    },\n    deleteLine: function(cm) {\n      var l = cm.getCursor().line;\n      cm.replaceRange(\"\", Pos(l, 0), Pos(l + 1, 0), \"+delete\");\n    },\n    delLineLeft: function(cm) {\n      var cur = cm.getCursor();\n      cm.replaceRange(\"\", Pos(cur.line, 0), cur, \"+delete\");\n    },\n    undo: function(cm) {cm.undo();},\n    redo: function(cm) {cm.redo();},\n    goDocStart: function(cm) {cm.extendSelection(Pos(cm.firstLine(), 0));},\n    goDocEnd: function(cm) {cm.extendSelection(Pos(cm.lastLine()));},\n    goLineStart: function(cm) {\n      cm.extendSelection(lineStart(cm, cm.getCursor().line));\n    },\n    goLineStartSmart: function(cm) {\n      var cur = cm.getCursor(), start = lineStart(cm, cur.line);\n      var line = cm.getLineHandle(start.line);\n      var order = getOrder(line);\n      if (!order || order[0].level == 0) {\n        var firstNonWS = Math.max(0, line.text.search(/\\S/));\n        var inWS = cur.line == start.line && cur.ch <= firstNonWS && cur.ch;\n        cm.extendSelection(Pos(start.line, inWS ? 0 : firstNonWS));\n      } else cm.extendSelection(start);\n    },\n    goLineEnd: function(cm) {\n      cm.extendSelection(lineEnd(cm, cm.getCursor().line));\n    },\n    goLineRight: function(cm) {\n      var top = cm.charCoords(cm.getCursor(), \"div\").top + 5;\n      cm.extendSelection(cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\"));\n    },\n    goLineLeft: function(cm) {\n      var top = cm.charCoords(cm.getCursor(), \"div\").top + 5;\n      cm.extendSelection(cm.coordsChar({left: 0, top: top}, \"div\"));\n    },\n    goLineUp: function(cm) {cm.moveV(-1, \"line\");},\n    goLineDown: function(cm) {cm.moveV(1, \"line\");},\n    goPageUp: function(cm) {cm.moveV(-1, \"page\");},\n    goPageDown: function(cm) {cm.moveV(1, \"page\");},\n    goCharLeft: function(cm) {cm.moveH(-1, \"char\");},\n    goCharRight: function(cm) {cm.moveH(1, \"char\");},\n    goColumnLeft: function(cm) {cm.moveH(-1, \"column\");},\n    goColumnRight: function(cm) {cm.moveH(1, \"column\");},\n    goWordLeft: function(cm) {cm.moveH(-1, \"word\");},\n    goGroupRight: function(cm) {cm.moveH(1, \"group\");},\n    goGroupLeft: function(cm) {cm.moveH(-1, \"group\");},\n    goWordRight: function(cm) {cm.moveH(1, \"word\");},\n    delCharBefore: function(cm) {cm.deleteH(-1, \"char\");},\n    delCharAfter: function(cm) {cm.deleteH(1, \"char\");},\n    delWordBefore: function(cm) {cm.deleteH(-1, \"word\");},\n    delWordAfter: function(cm) {cm.deleteH(1, \"word\");},\n    delGroupBefore: function(cm) {cm.deleteH(-1, \"group\");},\n    delGroupAfter: function(cm) {cm.deleteH(1, \"group\");},\n    indentAuto: function(cm) {cm.indentSelection(\"smart\");},\n    indentMore: function(cm) {cm.indentSelection(\"add\");},\n    indentLess: function(cm) {cm.indentSelection(\"subtract\");},\n    insertTab: function(cm) {\n      cm.replaceSelection(\"\\t\", \"end\", \"+input\");\n    },\n    defaultTab: function(cm) {\n      if (cm.somethingSelected()) cm.indentSelection(\"add\");\n      else cm.replaceSelection(\"\\t\", \"end\", \"+input\");\n    },\n    transposeChars: function(cm) {\n      var cur = cm.getCursor(), line = cm.getLine(cur.line);\n      if (cur.ch > 0 && cur.ch < line.length - 1)\n        cm.replaceRange(line.charAt(cur.ch) + line.charAt(cur.ch - 1),\n                        Pos(cur.line, cur.ch - 1), Pos(cur.line, cur.ch + 1));\n    },\n    newlineAndIndent: function(cm) {\n      operation(cm, function() {\n        cm.replaceSelection(\"\\n\", \"end\", \"+input\");\n        cm.indentLine(cm.getCursor().line, null, true);\n      })();\n    },\n    toggleOverwrite: function(cm) {cm.toggleOverwrite();}\n  };\n\n  // STANDARD KEYMAPS\n\n  var keyMap = CodeMirror.keyMap = {};\n  keyMap.basic = {\n    \"Left\": \"goCharLeft\", \"Right\": \"goCharRight\", \"Up\": \"goLineUp\", \"Down\": \"goLineDown\",\n    \"End\": \"goLineEnd\", \"Home\": \"goLineStartSmart\", \"PageUp\": \"goPageUp\", \"PageDown\": \"goPageDown\",\n    \"Delete\": \"delCharAfter\", \"Backspace\": \"delCharBefore\", \"Shift-Backspace\": \"delCharBefore\",\n    \"Tab\": \"defaultTab\", \"Shift-Tab\": \"indentAuto\",\n    \"Enter\": \"newlineAndIndent\", \"Insert\": \"toggleOverwrite\"\n  };\n  // Note that the save and find-related commands aren't defined by\n  // default. Unknown commands are simply ignored.\n  keyMap.pcDefault = {\n    \"Ctrl-A\": \"selectAll\", \"Ctrl-D\": \"deleteLine\", \"Ctrl-Z\": \"undo\", \"Shift-Ctrl-Z\": \"redo\", \"Ctrl-Y\": \"redo\",\n    \"Ctrl-Home\": \"goDocStart\", \"Ctrl-Up\": \"goDocStart\", \"Ctrl-End\": \"goDocEnd\", \"Ctrl-Down\": \"goDocEnd\",\n    \"Ctrl-Left\": \"goGroupLeft\", \"Ctrl-Right\": \"goGroupRight\", \"Alt-Left\": \"goLineStart\", \"Alt-Right\": \"goLineEnd\",\n    \"Ctrl-Backspace\": \"delGroupBefore\", \"Ctrl-Delete\": \"delGroupAfter\", \"Ctrl-S\": \"save\", \"Ctrl-F\": \"find\",\n    \"Ctrl-G\": \"findNext\", \"Shift-Ctrl-G\": \"findPrev\", \"Shift-Ctrl-F\": \"replace\", \"Shift-Ctrl-R\": \"replaceAll\",\n    \"Ctrl-[\": \"indentLess\", \"Ctrl-]\": \"indentMore\",\n    fallthrough: \"basic\"\n  };\n  keyMap.macDefault = {\n    \"Cmd-A\": \"selectAll\", \"Cmd-D\": \"deleteLine\", \"Cmd-Z\": \"undo\", \"Shift-Cmd-Z\": \"redo\", \"Cmd-Y\": \"redo\",\n    \"Cmd-Up\": \"goDocStart\", \"Cmd-End\": \"goDocEnd\", \"Cmd-Down\": \"goDocEnd\", \"Alt-Left\": \"goGroupLeft\",\n    \"Alt-Right\": \"goGroupRight\", \"Cmd-Left\": \"goLineStart\", \"Cmd-Right\": \"goLineEnd\", \"Alt-Backspace\": \"delGroupBefore\",\n    \"Ctrl-Alt-Backspace\": \"delGroupAfter\", \"Alt-Delete\": \"delGroupAfter\", \"Cmd-S\": \"save\", \"Cmd-F\": \"find\",\n    \"Cmd-G\": \"findNext\", \"Shift-Cmd-G\": \"findPrev\", \"Cmd-Alt-F\": \"replace\", \"Shift-Cmd-Alt-F\": \"replaceAll\",\n    \"Cmd-[\": \"indentLess\", \"Cmd-]\": \"indentMore\", \"Cmd-Backspace\": \"delLineLeft\",\n    fallthrough: [\"basic\", \"emacsy\"]\n  };\n  keyMap[\"default\"] = mac ? keyMap.macDefault : keyMap.pcDefault;\n  keyMap.emacsy = {\n    \"Ctrl-F\": \"goCharRight\", \"Ctrl-B\": \"goCharLeft\", \"Ctrl-P\": \"goLineUp\", \"Ctrl-N\": \"goLineDown\",\n    \"Alt-F\": \"goWordRight\", \"Alt-B\": \"goWordLeft\", \"Ctrl-A\": \"goLineStart\", \"Ctrl-E\": \"goLineEnd\",\n    \"Ctrl-V\": \"goPageDown\", \"Shift-Ctrl-V\": \"goPageUp\", \"Ctrl-D\": \"delCharAfter\", \"Ctrl-H\": \"delCharBefore\",\n    \"Alt-D\": \"delWordAfter\", \"Alt-Backspace\": \"delWordBefore\", \"Ctrl-K\": \"killLine\", \"Ctrl-T\": \"transposeChars\"\n  };\n\n  // KEYMAP DISPATCH\n\n  function getKeyMap(val) {\n    if (typeof val == \"string\") return keyMap[val];\n    else return val;\n  }\n\n  function lookupKey(name, maps, handle) {\n    function lookup(map) {\n      map = getKeyMap(map);\n      var found = map[name];\n      if (found === false) return \"stop\";\n      if (found != null && handle(found)) return true;\n      if (map.nofallthrough) return \"stop\";\n\n      var fallthrough = map.fallthrough;\n      if (fallthrough == null) return false;\n      if (Object.prototype.toString.call(fallthrough) != \"[object Array]\")\n        return lookup(fallthrough);\n      for (var i = 0, e = fallthrough.length; i < e; ++i) {\n        var done = lookup(fallthrough[i]);\n        if (done) return done;\n      }\n      return false;\n    }\n\n    for (var i = 0; i < maps.length; ++i) {\n      var done = lookup(maps[i]);\n      if (done) return done != \"stop\";\n    }\n  }\n  function isModifierKey(event) {\n    var name = keyNames[event.keyCode];\n    return name == \"Ctrl\" || name == \"Alt\" || name == \"Shift\" || name == \"Mod\";\n  }\n  function keyName(event, noShift) {\n    if (opera && event.keyCode == 34 && event[\"char\"]) return false;\n    var name = keyNames[event.keyCode];\n    if (name == null || event.altGraphKey) return false;\n    if (event.altKey) name = \"Alt-\" + name;\n    if (flipCtrlCmd ? event.metaKey : event.ctrlKey) name = \"Ctrl-\" + name;\n    if (flipCtrlCmd ? event.ctrlKey : event.metaKey) name = \"Cmd-\" + name;\n    if (!noShift && event.shiftKey) name = \"Shift-\" + name;\n    return name;\n  }\n  CodeMirror.lookupKey = lookupKey;\n  CodeMirror.isModifierKey = isModifierKey;\n  CodeMirror.keyName = keyName;\n\n  // FROMTEXTAREA\n\n  CodeMirror.fromTextArea = function(textarea, options) {\n    if (!options) options = {};\n    options.value = textarea.value;\n    if (!options.tabindex && textarea.tabindex)\n      options.tabindex = textarea.tabindex;\n    if (!options.placeholder && textarea.placeholder)\n      options.placeholder = textarea.placeholder;\n    // Set autofocus to true if this textarea is focused, or if it has\n    // autofocus and no other element is focused.\n    if (options.autofocus == null) {\n      var hasFocus = document.body;\n      // doc.activeElement occasionally throws on IE\n      try { hasFocus = document.activeElement; } catch(e) {}\n      options.autofocus = hasFocus == textarea ||\n        textarea.getAttribute(\"autofocus\") != null && hasFocus == document.body;\n    }\n\n    function save() {textarea.value = cm.getValue();}\n    if (textarea.form) {\n      on(textarea.form, \"submit\", save);\n      // Deplorable hack to make the submit method do the right thing.\n      if (!options.leaveSubmitMethodAlone) {\n        var form = textarea.form, realSubmit = form.submit;\n        try {\n          var wrappedSubmit = form.submit = function() {\n            save();\n            form.submit = realSubmit;\n            form.submit();\n            form.submit = wrappedSubmit;\n          };\n        } catch(e) {}\n      }\n    }\n\n    textarea.style.display = \"none\";\n    var cm = CodeMirror(function(node) {\n      textarea.parentNode.insertBefore(node, textarea.nextSibling);\n    }, options);\n    cm.save = save;\n    cm.getTextArea = function() { return textarea; };\n    cm.toTextArea = function() {\n      save();\n      textarea.parentNode.removeChild(cm.getWrapperElement());\n      textarea.style.display = \"\";\n      if (textarea.form) {\n        off(textarea.form, \"submit\", save);\n        if (typeof textarea.form.submit == \"function\")\n          textarea.form.submit = realSubmit;\n      }\n    };\n    return cm;\n  };\n\n  // STRING STREAM\n\n  // Fed to the mode parsers, provides helper functions to make\n  // parsers more succinct.\n\n  // The character stream used by a mode's parser.\n  function StringStream(string, tabSize) {\n    this.pos = this.start = 0;\n    this.string = string;\n    this.tabSize = tabSize || 8;\n    this.lastColumnPos = this.lastColumnValue = 0;\n    this.lineStart = 0;\n  }\n\n  StringStream.prototype = {\n    eol: function() {return this.pos >= this.string.length;},\n    sol: function() {return this.pos == this.lineStart;},\n    peek: function() {return this.string.charAt(this.pos) || undefined;},\n    next: function() {\n      if (this.pos < this.string.length)\n        return this.string.charAt(this.pos++);\n    },\n    eat: function(match) {\n      var ch = this.string.charAt(this.pos);\n      if (typeof match == \"string\") var ok = ch == match;\n      else var ok = ch && (match.test ? match.test(ch) : match(ch));\n      if (ok) {++this.pos; return ch;}\n    },\n    eatWhile: function(match) {\n      var start = this.pos;\n      while (this.eat(match)){}\n      return this.pos > start;\n    },\n    eatSpace: function() {\n      var start = this.pos;\n      while (/[\\s\\u00a0]/.test(this.string.charAt(this.pos))) ++this.pos;\n      return this.pos > start;\n    },\n    skipToEnd: function() {this.pos = this.string.length;},\n    skipTo: function(ch) {\n      var found = this.string.indexOf(ch, this.pos);\n      if (found > -1) {this.pos = found; return true;}\n    },\n    backUp: function(n) {this.pos -= n;},\n    column: function() {\n      if (this.lastColumnPos < this.start) {\n        this.lastColumnValue = countColumn(this.string, this.start, this.tabSize, this.lastColumnPos, this.lastColumnValue);\n        this.lastColumnPos = this.start;\n      }\n      return this.lastColumnValue - (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0);\n    },\n    indentation: function() {\n      return countColumn(this.string, null, this.tabSize) -\n        (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0);\n    },\n    match: function(pattern, consume, caseInsensitive) {\n      if (typeof pattern == \"string\") {\n        var cased = function(str) {return caseInsensitive ? str.toLowerCase() : str;};\n        var substr = this.string.substr(this.pos, pattern.length);\n        if (cased(substr) == cased(pattern)) {\n          if (consume !== false) this.pos += pattern.length;\n          return true;\n        }\n      } else {\n        var match = this.string.slice(this.pos).match(pattern);\n        if (match && match.index > 0) return null;\n        if (match && consume !== false) this.pos += match[0].length;\n        return match;\n      }\n    },\n    current: function(){return this.string.slice(this.start, this.pos);},\n    hideFirstChars: function(n, inner) {\n      this.lineStart += n;\n      try { return inner(); }\n      finally { this.lineStart -= n; }\n    }\n  };\n  CodeMirror.StringStream = StringStream;\n\n  // TEXTMARKERS\n\n  function TextMarker(doc, type) {\n    this.lines = [];\n    this.type = type;\n    this.doc = doc;\n  }\n  CodeMirror.TextMarker = TextMarker;\n  eventMixin(TextMarker);\n\n  TextMarker.prototype.clear = function() {\n    if (this.explicitlyCleared) return;\n    var cm = this.doc.cm, withOp = cm && !cm.curOp;\n    if (withOp) startOperation(cm);\n    if (hasHandler(this, \"clear\")) {\n      var found = this.find();\n      if (found) signalLater(this, \"clear\", found.from, found.to);\n    }\n    var min = null, max = null;\n    for (var i = 0; i < this.lines.length; ++i) {\n      var line = this.lines[i];\n      var span = getMarkedSpanFor(line.markedSpans, this);\n      if (span.to != null) max = lineNo(line);\n      line.markedSpans = removeMarkedSpan(line.markedSpans, span);\n      if (span.from != null)\n        min = lineNo(line);\n      else if (this.collapsed && !lineIsHidden(this.doc, line) && cm)\n        updateLineHeight(line, textHeight(cm.display));\n    }\n    if (cm && this.collapsed && !cm.options.lineWrapping) for (var i = 0; i < this.lines.length; ++i) {\n      var visual = visualLine(cm.doc, this.lines[i]), len = lineLength(cm.doc, visual);\n      if (len > cm.display.maxLineLength) {\n        cm.display.maxLine = visual;\n        cm.display.maxLineLength = len;\n        cm.display.maxLineChanged = true;\n      }\n    }\n\n    if (min != null && cm) regChange(cm, min, max + 1);\n    this.lines.length = 0;\n    this.explicitlyCleared = true;\n    if (this.atomic && this.doc.cantEdit) {\n      this.doc.cantEdit = false;\n      if (cm) reCheckSelection(cm);\n    }\n    if (withOp) endOperation(cm);\n  };\n\n  TextMarker.prototype.find = function(bothSides) {\n    var from, to;\n    for (var i = 0; i < this.lines.length; ++i) {\n      var line = this.lines[i];\n      var span = getMarkedSpanFor(line.markedSpans, this);\n      if (span.from != null || span.to != null) {\n        var found = lineNo(line);\n        if (span.from != null) from = Pos(found, span.from);\n        if (span.to != null) to = Pos(found, span.to);\n      }\n    }\n    if (this.type == \"bookmark\" && !bothSides) return from;\n    return from && {from: from, to: to};\n  };\n\n  TextMarker.prototype.changed = function() {\n    var pos = this.find(), cm = this.doc.cm;\n    if (!pos || !cm) return;\n    if (this.type != \"bookmark\") pos = pos.from;\n    var line = getLine(this.doc, pos.line);\n    clearCachedMeasurement(cm, line);\n    if (pos.line >= cm.display.showingFrom && pos.line < cm.display.showingTo) {\n      for (var node = cm.display.lineDiv.firstChild; node; node = node.nextSibling) if (node.lineObj == line) {\n        if (node.offsetHeight != line.height) updateLineHeight(line, node.offsetHeight);\n        break;\n      }\n      runInOp(cm, function() {\n        cm.curOp.selectionChanged = cm.curOp.forceUpdate = cm.curOp.updateMaxLine = true;\n      });\n    }\n  };\n\n  TextMarker.prototype.attachLine = function(line) {\n    if (!this.lines.length && this.doc.cm) {\n      var op = this.doc.cm.curOp;\n      if (!op.maybeHiddenMarkers || indexOf(op.maybeHiddenMarkers, this) == -1)\n        (op.maybeUnhiddenMarkers || (op.maybeUnhiddenMarkers = [])).push(this);\n    }\n    this.lines.push(line);\n  };\n  TextMarker.prototype.detachLine = function(line) {\n    this.lines.splice(indexOf(this.lines, line), 1);\n    if (!this.lines.length && this.doc.cm) {\n      var op = this.doc.cm.curOp;\n      (op.maybeHiddenMarkers || (op.maybeHiddenMarkers = [])).push(this);\n    }\n  };\n\n  var nextMarkerId = 0;\n\n  function markText(doc, from, to, options, type) {\n    if (options && options.shared) return markTextShared(doc, from, to, options, type);\n    if (doc.cm && !doc.cm.curOp) return operation(doc.cm, markText)(doc, from, to, options, type);\n\n    var marker = new TextMarker(doc, type);\n    if (options) copyObj(options, marker);\n    if (posLess(to, from) || posEq(from, to) && marker.clearWhenEmpty !== false)\n      return marker;\n    if (marker.replacedWith) {\n      marker.collapsed = true;\n      marker.replacedWith = elt(\"span\", [marker.replacedWith], \"CodeMirror-widget\");\n      if (!options.handleMouseEvents) marker.replacedWith.ignoreEvents = true;\n    }\n    if (marker.collapsed) {\n      if (conflictingCollapsedRange(doc, from.line, from, to, marker) ||\n          from.line != to.line && conflictingCollapsedRange(doc, to.line, from, to, marker))\n        throw new Error(\"Inserting collapsed marker partially overlapping an existing one\");\n      sawCollapsedSpans = true;\n    }\n\n    if (marker.addToHistory)\n      addToHistory(doc, {from: from, to: to, origin: \"markText\"},\n                   {head: doc.sel.head, anchor: doc.sel.anchor}, NaN);\n\n    var curLine = from.line, cm = doc.cm, updateMaxLine;\n    doc.iter(curLine, to.line + 1, function(line) {\n      if (cm && marker.collapsed && !cm.options.lineWrapping && visualLine(doc, line) == cm.display.maxLine)\n        updateMaxLine = true;\n      var span = {from: null, to: null, marker: marker};\n      if (curLine == from.line) span.from = from.ch;\n      if (curLine == to.line) span.to = to.ch;\n      if (marker.collapsed && curLine != from.line) updateLineHeight(line, 0);\n      addMarkedSpan(line, span);\n      ++curLine;\n    });\n    if (marker.collapsed) doc.iter(from.line, to.line + 1, function(line) {\n      if (lineIsHidden(doc, line)) updateLineHeight(line, 0);\n    });\n\n    if (marker.clearOnEnter) on(marker, \"beforeCursorEnter\", function() { marker.clear(); });\n\n    if (marker.readOnly) {\n      sawReadOnlySpans = true;\n      if (doc.history.done.length || doc.history.undone.length)\n        doc.clearHistory();\n    }\n    if (marker.collapsed) {\n      marker.id = ++nextMarkerId;\n      marker.atomic = true;\n    }\n    if (cm) {\n      if (updateMaxLine) cm.curOp.updateMaxLine = true;\n      if (marker.className || marker.title || marker.startStyle || marker.endStyle || marker.collapsed)\n        regChange(cm, from.line, to.line + 1);\n      if (marker.atomic) reCheckSelection(cm);\n    }\n    return marker;\n  }\n\n  // SHARED TEXTMARKERS\n\n  function SharedTextMarker(markers, primary) {\n    this.markers = markers;\n    this.primary = primary;\n    for (var i = 0, me = this; i < markers.length; ++i) {\n      markers[i].parent = this;\n      on(markers[i], \"clear\", function(){me.clear();});\n    }\n  }\n  CodeMirror.SharedTextMarker = SharedTextMarker;\n  eventMixin(SharedTextMarker);\n\n  SharedTextMarker.prototype.clear = function() {\n    if (this.explicitlyCleared) return;\n    this.explicitlyCleared = true;\n    for (var i = 0; i < this.markers.length; ++i)\n      this.markers[i].clear();\n    signalLater(this, \"clear\");\n  };\n  SharedTextMarker.prototype.find = function() {\n    return this.primary.find();\n  };\n\n  function markTextShared(doc, from, to, options, type) {\n    options = copyObj(options);\n    options.shared = false;\n    var markers = [markText(doc, from, to, options, type)], primary = markers[0];\n    var widget = options.replacedWith;\n    linkedDocs(doc, function(doc) {\n      if (widget) options.replacedWith = widget.cloneNode(true);\n      markers.push(markText(doc, clipPos(doc, from), clipPos(doc, to), options, type));\n      for (var i = 0; i < doc.linked.length; ++i)\n        if (doc.linked[i].isParent) return;\n      primary = lst(markers);\n    });\n    return new SharedTextMarker(markers, primary);\n  }\n\n  // TEXTMARKER SPANS\n\n  function getMarkedSpanFor(spans, marker) {\n    if (spans) for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if (span.marker == marker) return span;\n    }\n  }\n  function removeMarkedSpan(spans, span) {\n    for (var r, i = 0; i < spans.length; ++i)\n      if (spans[i] != span) (r || (r = [])).push(spans[i]);\n    return r;\n  }\n  function addMarkedSpan(line, span) {\n    line.markedSpans = line.markedSpans ? line.markedSpans.concat([span]) : [span];\n    span.marker.attachLine(line);\n  }\n\n  function markedSpansBefore(old, startCh, isInsert) {\n    if (old) for (var i = 0, nw; i < old.length; ++i) {\n      var span = old[i], marker = span.marker;\n      var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= startCh : span.from < startCh);\n      if (startsBefore || span.from == startCh && marker.type == \"bookmark\" && (!isInsert || !span.marker.insertLeft)) {\n        var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= startCh : span.to > startCh);\n        (nw || (nw = [])).push({from: span.from,\n                                to: endsAfter ? null : span.to,\n                                marker: marker});\n      }\n    }\n    return nw;\n  }\n\n  function markedSpansAfter(old, endCh, isInsert) {\n    if (old) for (var i = 0, nw; i < old.length; ++i) {\n      var span = old[i], marker = span.marker;\n      var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= endCh : span.to > endCh);\n      if (endsAfter || span.from == endCh && marker.type == \"bookmark\" && (!isInsert || span.marker.insertLeft)) {\n        var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= endCh : span.from < endCh);\n        (nw || (nw = [])).push({from: startsBefore ? null : span.from - endCh,\n                                to: span.to == null ? null : span.to - endCh,\n                                marker: marker});\n      }\n    }\n    return nw;\n  }\n\n  function stretchSpansOverChange(doc, change) {\n    var oldFirst = isLine(doc, change.from.line) && getLine(doc, change.from.line).markedSpans;\n    var oldLast = isLine(doc, change.to.line) && getLine(doc, change.to.line).markedSpans;\n    if (!oldFirst && !oldLast) return null;\n\n    var startCh = change.from.ch, endCh = change.to.ch, isInsert = posEq(change.from, change.to);\n    // Get the spans that 'stick out' on both sides\n    var first = markedSpansBefore(oldFirst, startCh, isInsert);\n    var last = markedSpansAfter(oldLast, endCh, isInsert);\n\n    // Next, merge those two ends\n    var sameLine = change.text.length == 1, offset = lst(change.text).length + (sameLine ? startCh : 0);\n    if (first) {\n      // Fix up .to properties of first\n      for (var i = 0; i < first.length; ++i) {\n        var span = first[i];\n        if (span.to == null) {\n          var found = getMarkedSpanFor(last, span.marker);\n          if (!found) span.to = startCh;\n          else if (sameLine) span.to = found.to == null ? null : found.to + offset;\n        }\n      }\n    }\n    if (last) {\n      // Fix up .from in last (or move them into first in case of sameLine)\n      for (var i = 0; i < last.length; ++i) {\n        var span = last[i];\n        if (span.to != null) span.to += offset;\n        if (span.from == null) {\n          var found = getMarkedSpanFor(first, span.marker);\n          if (!found) {\n            span.from = offset;\n            if (sameLine) (first || (first = [])).push(span);\n          }\n        } else {\n          span.from += offset;\n          if (sameLine) (first || (first = [])).push(span);\n        }\n      }\n    }\n    // Make sure we didn't create any zero-length spans\n    if (first) first = clearEmptySpans(first);\n    if (last && last != first) last = clearEmptySpans(last);\n\n    var newMarkers = [first];\n    if (!sameLine) {\n      // Fill gap with whole-line-spans\n      var gap = change.text.length - 2, gapMarkers;\n      if (gap > 0 && first)\n        for (var i = 0; i < first.length; ++i)\n          if (first[i].to == null)\n            (gapMarkers || (gapMarkers = [])).push({from: null, to: null, marker: first[i].marker});\n      for (var i = 0; i < gap; ++i)\n        newMarkers.push(gapMarkers);\n      newMarkers.push(last);\n    }\n    return newMarkers;\n  }\n\n  function clearEmptySpans(spans) {\n    for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if (span.from != null && span.from == span.to && span.marker.clearWhenEmpty !== false)\n        spans.splice(i--, 1);\n    }\n    if (!spans.length) return null;\n    return spans;\n  }\n\n  function mergeOldSpans(doc, change) {\n    var old = getOldSpans(doc, change);\n    var stretched = stretchSpansOverChange(doc, change);\n    if (!old) return stretched;\n    if (!stretched) return old;\n\n    for (var i = 0; i < old.length; ++i) {\n      var oldCur = old[i], stretchCur = stretched[i];\n      if (oldCur && stretchCur) {\n        spans: for (var j = 0; j < stretchCur.length; ++j) {\n          var span = stretchCur[j];\n          for (var k = 0; k < oldCur.length; ++k)\n            if (oldCur[k].marker == span.marker) continue spans;\n          oldCur.push(span);\n        }\n      } else if (stretchCur) {\n        old[i] = stretchCur;\n      }\n    }\n    return old;\n  }\n\n  function removeReadOnlyRanges(doc, from, to) {\n    var markers = null;\n    doc.iter(from.line, to.line + 1, function(line) {\n      if (line.markedSpans) for (var i = 0; i < line.markedSpans.length; ++i) {\n        var mark = line.markedSpans[i].marker;\n        if (mark.readOnly && (!markers || indexOf(markers, mark) == -1))\n          (markers || (markers = [])).push(mark);\n      }\n    });\n    if (!markers) return null;\n    var parts = [{from: from, to: to}];\n    for (var i = 0; i < markers.length; ++i) {\n      var mk = markers[i], m = mk.find();\n      for (var j = 0; j < parts.length; ++j) {\n        var p = parts[j];\n        if (posLess(p.to, m.from) || posLess(m.to, p.from)) continue;\n        var newParts = [j, 1];\n        if (posLess(p.from, m.from) || !mk.inclusiveLeft && posEq(p.from, m.from))\n          newParts.push({from: p.from, to: m.from});\n        if (posLess(m.to, p.to) || !mk.inclusiveRight && posEq(p.to, m.to))\n          newParts.push({from: m.to, to: p.to});\n        parts.splice.apply(parts, newParts);\n        j += newParts.length - 1;\n      }\n    }\n    return parts;\n  }\n\n  function extraLeft(marker) { return marker.inclusiveLeft ? -1 : 0; }\n  function extraRight(marker) { return marker.inclusiveRight ? 1 : 0; }\n\n  function compareCollapsedMarkers(a, b) {\n    var lenDiff = a.lines.length - b.lines.length;\n    if (lenDiff != 0) return lenDiff;\n    var aPos = a.find(), bPos = b.find();\n    var fromCmp = cmp(aPos.from, bPos.from) || extraLeft(a) - extraLeft(b);\n    if (fromCmp) return -fromCmp;\n    var toCmp = cmp(aPos.to, bPos.to) || extraRight(a) - extraRight(b);\n    if (toCmp) return toCmp;\n    return b.id - a.id;\n  }\n\n  function collapsedSpanAtSide(line, start) {\n    var sps = sawCollapsedSpans && line.markedSpans, found;\n    if (sps) for (var sp, i = 0; i < sps.length; ++i) {\n      sp = sps[i];\n      if (sp.marker.collapsed && (start ? sp.from : sp.to) == null &&\n          (!found || compareCollapsedMarkers(found, sp.marker) < 0))\n        found = sp.marker;\n    }\n    return found;\n  }\n  function collapsedSpanAtStart(line) { return collapsedSpanAtSide(line, true); }\n  function collapsedSpanAtEnd(line) { return collapsedSpanAtSide(line, false); }\n\n  function conflictingCollapsedRange(doc, lineNo, from, to, marker) {\n    var line = getLine(doc, lineNo);\n    var sps = sawCollapsedSpans && line.markedSpans;\n    if (sps) for (var i = 0; i < sps.length; ++i) {\n      var sp = sps[i];\n      if (!sp.marker.collapsed) continue;\n      var found = sp.marker.find(true);\n      var fromCmp = cmp(found.from, from) || extraLeft(sp.marker) - extraLeft(marker);\n      var toCmp = cmp(found.to, to) || extraRight(sp.marker) - extraRight(marker);\n      if (fromCmp >= 0 && toCmp <= 0 || fromCmp <= 0 && toCmp >= 0) continue;\n      if (fromCmp <= 0 && (cmp(found.to, from) || extraRight(sp.marker) - extraLeft(marker)) > 0 ||\n          fromCmp >= 0 && (cmp(found.from, to) || extraLeft(sp.marker) - extraRight(marker)) < 0)\n        return true;\n    }\n  }\n\n  function visualLine(doc, line) {\n    var merged;\n    while (merged = collapsedSpanAtStart(line))\n      line = getLine(doc, merged.find().from.line);\n    return line;\n  }\n\n  function lineIsHidden(doc, line) {\n    var sps = sawCollapsedSpans && line.markedSpans;\n    if (sps) for (var sp, i = 0; i < sps.length; ++i) {\n      sp = sps[i];\n      if (!sp.marker.collapsed) continue;\n      if (sp.from == null) return true;\n      if (sp.marker.replacedWith) continue;\n      if (sp.from == 0 && sp.marker.inclusiveLeft && lineIsHiddenInner(doc, line, sp))\n        return true;\n    }\n  }\n  function lineIsHiddenInner(doc, line, span) {\n    if (span.to == null) {\n      var end = span.marker.find().to, endLine = getLine(doc, end.line);\n      return lineIsHiddenInner(doc, endLine, getMarkedSpanFor(endLine.markedSpans, span.marker));\n    }\n    if (span.marker.inclusiveRight && span.to == line.text.length)\n      return true;\n    for (var sp, i = 0; i < line.markedSpans.length; ++i) {\n      sp = line.markedSpans[i];\n      if (sp.marker.collapsed && !sp.marker.replacedWith && sp.from == span.to &&\n          (sp.to == null || sp.to != span.from) &&\n          (sp.marker.inclusiveLeft || span.marker.inclusiveRight) &&\n          lineIsHiddenInner(doc, line, sp)) return true;\n    }\n  }\n\n  function detachMarkedSpans(line) {\n    var spans = line.markedSpans;\n    if (!spans) return;\n    for (var i = 0; i < spans.length; ++i)\n      spans[i].marker.detachLine(line);\n    line.markedSpans = null;\n  }\n\n  function attachMarkedSpans(line, spans) {\n    if (!spans) return;\n    for (var i = 0; i < spans.length; ++i)\n      spans[i].marker.attachLine(line);\n    line.markedSpans = spans;\n  }\n\n  // LINE WIDGETS\n\n  var LineWidget = CodeMirror.LineWidget = function(cm, node, options) {\n    if (options) for (var opt in options) if (options.hasOwnProperty(opt))\n      this[opt] = options[opt];\n    this.cm = cm;\n    this.node = node;\n  };\n  eventMixin(LineWidget);\n  function widgetOperation(f) {\n    return function() {\n      var withOp = !this.cm.curOp;\n      if (withOp) startOperation(this.cm);\n      try {var result = f.apply(this, arguments);}\n      finally {if (withOp) endOperation(this.cm);}\n      return result;\n    };\n  }\n  LineWidget.prototype.clear = widgetOperation(function() {\n    var ws = this.line.widgets, no = lineNo(this.line);\n    if (no == null || !ws) return;\n    for (var i = 0; i < ws.length; ++i) if (ws[i] == this) ws.splice(i--, 1);\n    if (!ws.length) this.line.widgets = null;\n    var aboveVisible = heightAtLine(this.cm, this.line) < this.cm.doc.scrollTop;\n    updateLineHeight(this.line, Math.max(0, this.line.height - widgetHeight(this)));\n    if (aboveVisible) addToScrollPos(this.cm, 0, -this.height);\n    regChange(this.cm, no, no + 1);\n  });\n  LineWidget.prototype.changed = widgetOperation(function() {\n    var oldH = this.height;\n    this.height = null;\n    var diff = widgetHeight(this) - oldH;\n    if (!diff) return;\n    updateLineHeight(this.line, this.line.height + diff);\n    var no = lineNo(this.line);\n    regChange(this.cm, no, no + 1);\n  });\n\n  function widgetHeight(widget) {\n    if (widget.height != null) return widget.height;\n    if (!widget.node.parentNode || widget.node.parentNode.nodeType != 1)\n      removeChildrenAndAdd(widget.cm.display.measure, elt(\"div\", [widget.node], null, \"position: relative\"));\n    return widget.height = widget.node.offsetHeight;\n  }\n\n  function addLineWidget(cm, handle, node, options) {\n    var widget = new LineWidget(cm, node, options);\n    if (widget.noHScroll) cm.display.alignWidgets = true;\n    changeLine(cm, handle, function(line) {\n      var widgets = line.widgets || (line.widgets = []);\n      if (widget.insertAt == null) widgets.push(widget);\n      else widgets.splice(Math.min(widgets.length - 1, Math.max(0, widget.insertAt)), 0, widget);\n      widget.line = line;\n      if (!lineIsHidden(cm.doc, line) || widget.showIfHidden) {\n        var aboveVisible = heightAtLine(cm, line) < cm.doc.scrollTop;\n        updateLineHeight(line, line.height + widgetHeight(widget));\n        if (aboveVisible) addToScrollPos(cm, 0, widget.height);\n        cm.curOp.forceUpdate = true;\n      }\n      return true;\n    });\n    return widget;\n  }\n\n  // LINE DATA STRUCTURE\n\n  // Line objects. These hold state related to a line, including\n  // highlighting info (the styles array).\n  var Line = CodeMirror.Line = function(text, markedSpans, estimateHeight) {\n    this.text = text;\n    attachMarkedSpans(this, markedSpans);\n    this.height = estimateHeight ? estimateHeight(this) : 1;\n  };\n  eventMixin(Line);\n  Line.prototype.lineNo = function() { return lineNo(this); };\n\n  function updateLine(line, text, markedSpans, estimateHeight) {\n    line.text = text;\n    if (line.stateAfter) line.stateAfter = null;\n    if (line.styles) line.styles = null;\n    if (line.order != null) line.order = null;\n    detachMarkedSpans(line);\n    attachMarkedSpans(line, markedSpans);\n    var estHeight = estimateHeight ? estimateHeight(line) : 1;\n    if (estHeight != line.height) updateLineHeight(line, estHeight);\n  }\n\n  function cleanUpLine(line) {\n    line.parent = null;\n    detachMarkedSpans(line);\n  }\n\n  // Run the given mode's parser over a line, update the styles\n  // array, which contains alternating fragments of text and CSS\n  // classes.\n  function runMode(cm, text, mode, state, f, forceToEnd) {\n    var flattenSpans = mode.flattenSpans;\n    if (flattenSpans == null) flattenSpans = cm.options.flattenSpans;\n    var curStart = 0, curStyle = null;\n    var stream = new StringStream(text, cm.options.tabSize), style;\n    if (text == \"\" && mode.blankLine) mode.blankLine(state);\n    while (!stream.eol()) {\n      if (stream.pos > cm.options.maxHighlightLength) {\n        flattenSpans = false;\n        if (forceToEnd) processLine(cm, text, state, stream.pos);\n        stream.pos = text.length;\n        style = null;\n      } else {\n        style = mode.token(stream, state);\n      }\n      if (cm.options.addModeClass) {\n        var mName = CodeMirror.innerMode(mode, state).mode.name;\n        if (mName) style = \"m-\" + (style ? mName + \" \" + style : mName);\n      }\n      if (!flattenSpans || curStyle != style) {\n        if (curStart < stream.start) f(stream.start, curStyle);\n        curStart = stream.start; curStyle = style;\n      }\n      stream.start = stream.pos;\n    }\n    while (curStart < stream.pos) {\n      // Webkit seems to refuse to render text nodes longer than 57444 characters\n      var pos = Math.min(stream.pos, curStart + 50000);\n      f(pos, curStyle);\n      curStart = pos;\n    }\n  }\n\n  function highlightLine(cm, line, state, forceToEnd) {\n    // A styles array always starts with a number identifying the\n    // mode/overlays that it is based on (for easy invalidation).\n    var st = [cm.state.modeGen];\n    // Compute the base array of styles\n    runMode(cm, line.text, cm.doc.mode, state, function(end, style) {\n      st.push(end, style);\n    }, forceToEnd);\n\n    // Run overlays, adjust style array.\n    for (var o = 0; o < cm.state.overlays.length; ++o) {\n      var overlay = cm.state.overlays[o], i = 1, at = 0;\n      runMode(cm, line.text, overlay.mode, true, function(end, style) {\n        var start = i;\n        // Ensure there's a token end at the current position, and that i points at it\n        while (at < end) {\n          var i_end = st[i];\n          if (i_end > end)\n            st.splice(i, 1, end, st[i+1], i_end);\n          i += 2;\n          at = Math.min(end, i_end);\n        }\n        if (!style) return;\n        if (overlay.opaque) {\n          st.splice(start, i - start, end, style);\n          i = start + 2;\n        } else {\n          for (; start < i; start += 2) {\n            var cur = st[start+1];\n            st[start+1] = cur ? cur + \" \" + style : style;\n          }\n        }\n      });\n    }\n\n    return st;\n  }\n\n  function getLineStyles(cm, line) {\n    if (!line.styles || line.styles[0] != cm.state.modeGen)\n      line.styles = highlightLine(cm, line, line.stateAfter = getStateBefore(cm, lineNo(line)));\n    return line.styles;\n  }\n\n  // Lightweight form of highlight -- proceed over this line and\n  // update state, but don't save a style array.\n  function processLine(cm, text, state, startAt) {\n    var mode = cm.doc.mode;\n    var stream = new StringStream(text, cm.options.tabSize);\n    stream.start = stream.pos = startAt || 0;\n    if (text == \"\" && mode.blankLine) mode.blankLine(state);\n    while (!stream.eol() && stream.pos <= cm.options.maxHighlightLength) {\n      mode.token(stream, state);\n      stream.start = stream.pos;\n    }\n  }\n\n  var styleToClassCache = {}, styleToClassCacheWithMode = {};\n  function interpretTokenStyle(style, builder) {\n    if (!style) return null;\n    for (;;) {\n      var lineClass = style.match(/(?:^|\\s+)line-(background-)?(\\S+)/);\n      if (!lineClass) break;\n      style = style.slice(0, lineClass.index) + style.slice(lineClass.index + lineClass[0].length);\n      var prop = lineClass[1] ? \"bgClass\" : \"textClass\";\n      if (builder[prop] == null)\n        builder[prop] = lineClass[2];\n      else if (!(new RegExp(\"(?:^|\\s)\" + lineClass[2] + \"(?:$|\\s)\")).test(builder[prop]))\n        builder[prop] += \" \" + lineClass[2];\n    }\n    if (/^\\s*$/.test(style)) return null;\n    var cache = builder.cm.options.addModeClass ? styleToClassCacheWithMode : styleToClassCache;\n    return cache[style] ||\n      (cache[style] = style.replace(/\\S+/g, \"cm-$&\"));\n  }\n\n  function buildLineContent(cm, realLine, measure, copyWidgets) {\n    var merged, line = realLine, empty = true;\n    while (merged = collapsedSpanAtStart(line))\n      line = getLine(cm.doc, merged.find().from.line);\n\n    var builder = {pre: elt(\"pre\"), col: 0, pos: 0,\n                   measure: null, measuredSomething: false, cm: cm,\n                   copyWidgets: copyWidgets};\n\n    do {\n      if (line.text) empty = false;\n      builder.measure = line == realLine && measure;\n      builder.pos = 0;\n      builder.addToken = builder.measure ? buildTokenMeasure : buildToken;\n      if ((ie || webkit) && cm.getOption(\"lineWrapping\"))\n        builder.addToken = buildTokenSplitSpaces(builder.addToken);\n      var next = insertLineContent(line, builder, getLineStyles(cm, line));\n      if (measure && line == realLine && !builder.measuredSomething) {\n        measure[0] = builder.pre.appendChild(zeroWidthElement(cm.display.measure));\n        builder.measuredSomething = true;\n      }\n      if (next) line = getLine(cm.doc, next.to.line);\n    } while (next);\n\n    if (measure && !builder.measuredSomething && !measure[0])\n      measure[0] = builder.pre.appendChild(empty ? elt(\"span\", \"\\u00a0\") : zeroWidthElement(cm.display.measure));\n    if (!builder.pre.firstChild && !lineIsHidden(cm.doc, realLine))\n      builder.pre.appendChild(document.createTextNode(\"\\u00a0\"));\n\n    var order;\n    // Work around problem with the reported dimensions of single-char\n    // direction spans on IE (issue #1129). See also the comment in\n    // cursorCoords.\n    if (measure && ie && (order = getOrder(line))) {\n      var l = order.length - 1;\n      if (order[l].from == order[l].to) --l;\n      var last = order[l], prev = order[l - 1];\n      if (last.from + 1 == last.to && prev && last.level < prev.level) {\n        var span = measure[builder.pos - 1];\n        if (span) span.parentNode.insertBefore(span.measureRight = zeroWidthElement(cm.display.measure),\n                                               span.nextSibling);\n      }\n    }\n\n    var textClass = builder.textClass ? builder.textClass + \" \" + (realLine.textClass || \"\") : realLine.textClass;\n    if (textClass) builder.pre.className = textClass;\n\n    signal(cm, \"renderLine\", cm, realLine, builder.pre);\n    return builder;\n  }\n\n  function defaultSpecialCharPlaceholder(ch) {\n    var token = elt(\"span\", \"\\u2022\", \"cm-invalidchar\");\n    token.title = \"\\\\u\" + ch.charCodeAt(0).toString(16);\n    return token;\n  }\n\n  function buildToken(builder, text, style, startStyle, endStyle, title) {\n    if (!text) return;\n    var special = builder.cm.options.specialChars;\n    if (!special.test(text)) {\n      builder.col += text.length;\n      var content = document.createTextNode(text);\n    } else {\n      var content = document.createDocumentFragment(), pos = 0;\n      while (true) {\n        special.lastIndex = pos;\n        var m = special.exec(text);\n        var skipped = m ? m.index - pos : text.length - pos;\n        if (skipped) {\n          content.appendChild(document.createTextNode(text.slice(pos, pos + skipped)));\n          builder.col += skipped;\n        }\n        if (!m) break;\n        pos += skipped + 1;\n        if (m[0] == \"\\t\") {\n          var tabSize = builder.cm.options.tabSize, tabWidth = tabSize - builder.col % tabSize;\n          content.appendChild(elt(\"span\", spaceStr(tabWidth), \"cm-tab\"));\n          builder.col += tabWidth;\n        } else {\n          var token = builder.cm.options.specialCharPlaceholder(m[0]);\n          content.appendChild(token);\n          builder.col += 1;\n        }\n      }\n    }\n    if (style || startStyle || endStyle || builder.measure) {\n      var fullStyle = style || \"\";\n      if (startStyle) fullStyle += startStyle;\n      if (endStyle) fullStyle += endStyle;\n      var token = elt(\"span\", [content], fullStyle);\n      if (title) token.title = title;\n      return builder.pre.appendChild(token);\n    }\n    builder.pre.appendChild(content);\n  }\n\n  function buildTokenMeasure(builder, text, style, startStyle, endStyle) {\n    var wrapping = builder.cm.options.lineWrapping;\n    for (var i = 0; i < text.length; ++i) {\n      var start = i == 0, to = i + 1;\n      while (to < text.length && isExtendingChar(text.charAt(to))) ++to;\n      var ch = text.slice(i, to);\n      i = to - 1;\n      if (i && wrapping && spanAffectsWrapping(text, i))\n        builder.pre.appendChild(elt(\"wbr\"));\n      var old = builder.measure[builder.pos];\n      var span = builder.measure[builder.pos] =\n        buildToken(builder, ch, style,\n                   start && startStyle, i == text.length - 1 && endStyle);\n      if (old) span.leftSide = old.leftSide || old;\n      // In IE single-space nodes wrap differently than spaces\n      // embedded in larger text nodes, except when set to\n      // white-space: normal (issue #1268).\n      if (old_ie && wrapping && ch == \" \" && i && !/\\s/.test(text.charAt(i - 1)) &&\n          i < text.length - 1 && !/\\s/.test(text.charAt(i + 1)))\n        span.style.whiteSpace = \"normal\";\n      builder.pos += ch.length;\n    }\n    if (text.length) builder.measuredSomething = true;\n  }\n\n  function buildTokenSplitSpaces(inner) {\n    function split(old) {\n      var out = \" \";\n      for (var i = 0; i < old.length - 2; ++i) out += i % 2 ? \" \" : \"\\u00a0\";\n      out += \" \";\n      return out;\n    }\n    return function(builder, text, style, startStyle, endStyle, title) {\n      return inner(builder, text.replace(/ {3,}/g, split), style, startStyle, endStyle, title);\n    };\n  }\n\n  function buildCollapsedSpan(builder, size, marker, ignoreWidget) {\n    var widget = !ignoreWidget && marker.replacedWith;\n    if (widget) {\n      if (builder.copyWidgets) widget = widget.cloneNode(true);\n      builder.pre.appendChild(widget);\n      if (builder.measure) {\n        if (size) {\n          builder.measure[builder.pos] = widget;\n        } else {\n          var elt = zeroWidthElement(builder.cm.display.measure);\n          if (marker.type == \"bookmark\" && !marker.insertLeft)\n            builder.measure[builder.pos] = builder.pre.appendChild(elt);\n          else if (builder.measure[builder.pos])\n            return;\n          else\n            builder.measure[builder.pos] = builder.pre.insertBefore(elt, widget);\n        }\n        builder.measuredSomething = true;\n      }\n    }\n    builder.pos += size;\n  }\n\n  // Outputs a number of spans to make up a line, taking highlighting\n  // and marked text into account.\n  function insertLineContent(line, builder, styles) {\n    var spans = line.markedSpans, allText = line.text, at = 0;\n    if (!spans) {\n      for (var i = 1; i < styles.length; i+=2)\n        builder.addToken(builder, allText.slice(at, at = styles[i]), interpretTokenStyle(styles[i+1], builder));\n      return;\n    }\n\n    var len = allText.length, pos = 0, i = 1, text = \"\", style;\n    var nextChange = 0, spanStyle, spanEndStyle, spanStartStyle, title, collapsed;\n    for (;;) {\n      if (nextChange == pos) { // Update current marker set\n        spanStyle = spanEndStyle = spanStartStyle = title = \"\";\n        collapsed = null; nextChange = Infinity;\n        var foundBookmarks = [];\n        for (var j = 0; j < spans.length; ++j) {\n          var sp = spans[j], m = sp.marker;\n          if (sp.from <= pos && (sp.to == null || sp.to > pos)) {\n            if (sp.to != null && nextChange > sp.to) { nextChange = sp.to; spanEndStyle = \"\"; }\n            if (m.className) spanStyle += \" \" + m.className;\n            if (m.startStyle && sp.from == pos) spanStartStyle += \" \" + m.startStyle;\n            if (m.endStyle && sp.to == nextChange) spanEndStyle += \" \" + m.endStyle;\n            if (m.title && !title) title = m.title;\n            if (m.collapsed && (!collapsed || compareCollapsedMarkers(collapsed.marker, m) < 0))\n              collapsed = sp;\n          } else if (sp.from > pos && nextChange > sp.from) {\n            nextChange = sp.from;\n          }\n          if (m.type == \"bookmark\" && sp.from == pos && m.replacedWith) foundBookmarks.push(m);\n        }\n        if (collapsed && (collapsed.from || 0) == pos) {\n          buildCollapsedSpan(builder, (collapsed.to == null ? len : collapsed.to) - pos,\n                             collapsed.marker, collapsed.from == null);\n          if (collapsed.to == null) return collapsed.marker.find();\n        }\n        if (!collapsed && foundBookmarks.length) for (var j = 0; j < foundBookmarks.length; ++j)\n          buildCollapsedSpan(builder, 0, foundBookmarks[j]);\n      }\n      if (pos >= len) break;\n\n      var upto = Math.min(len, nextChange);\n      while (true) {\n        if (text) {\n          var end = pos + text.length;\n          if (!collapsed) {\n            var tokenText = end > upto ? text.slice(0, upto - pos) : text;\n            builder.addToken(builder, tokenText, style ? style + spanStyle : spanStyle,\n                             spanStartStyle, pos + tokenText.length == nextChange ? spanEndStyle : \"\", title);\n          }\n          if (end >= upto) {text = text.slice(upto - pos); pos = upto; break;}\n          pos = end;\n          spanStartStyle = \"\";\n        }\n        text = allText.slice(at, at = styles[i++]);\n        style = interpretTokenStyle(styles[i++], builder);\n      }\n    }\n  }\n\n  // DOCUMENT DATA STRUCTURE\n\n  function updateDoc(doc, change, markedSpans, selAfter, estimateHeight) {\n    function spansFor(n) {return markedSpans ? markedSpans[n] : null;}\n    function update(line, text, spans) {\n      updateLine(line, text, spans, estimateHeight);\n      signalLater(line, \"change\", line, change);\n    }\n\n    var from = change.from, to = change.to, text = change.text;\n    var firstLine = getLine(doc, from.line), lastLine = getLine(doc, to.line);\n    var lastText = lst(text), lastSpans = spansFor(text.length - 1), nlines = to.line - from.line;\n\n    // First adjust the line structure\n    if (from.ch == 0 && to.ch == 0 && lastText == \"\" &&\n        (!doc.cm || doc.cm.options.wholeLineUpdateBefore)) {\n      // This is a whole-line replace. Treated specially to make\n      // sure line objects move the way they are supposed to.\n      for (var i = 0, e = text.length - 1, added = []; i < e; ++i)\n        added.push(new Line(text[i], spansFor(i), estimateHeight));\n      update(lastLine, lastLine.text, lastSpans);\n      if (nlines) doc.remove(from.line, nlines);\n      if (added.length) doc.insert(from.line, added);\n    } else if (firstLine == lastLine) {\n      if (text.length == 1) {\n        update(firstLine, firstLine.text.slice(0, from.ch) + lastText + firstLine.text.slice(to.ch), lastSpans);\n      } else {\n        for (var added = [], i = 1, e = text.length - 1; i < e; ++i)\n          added.push(new Line(text[i], spansFor(i), estimateHeight));\n        added.push(new Line(lastText + firstLine.text.slice(to.ch), lastSpans, estimateHeight));\n        update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n        doc.insert(from.line + 1, added);\n      }\n    } else if (text.length == 1) {\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0] + lastLine.text.slice(to.ch), spansFor(0));\n      doc.remove(from.line + 1, nlines);\n    } else {\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n      update(lastLine, lastText + lastLine.text.slice(to.ch), lastSpans);\n      for (var i = 1, e = text.length - 1, added = []; i < e; ++i)\n        added.push(new Line(text[i], spansFor(i), estimateHeight));\n      if (nlines > 1) doc.remove(from.line + 1, nlines - 1);\n      doc.insert(from.line + 1, added);\n    }\n\n    signalLater(doc, \"change\", doc, change);\n    setSelection(doc, selAfter.anchor, selAfter.head, null, true);\n  }\n\n  function LeafChunk(lines) {\n    this.lines = lines;\n    this.parent = null;\n    for (var i = 0, e = lines.length, height = 0; i < e; ++i) {\n      lines[i].parent = this;\n      height += lines[i].height;\n    }\n    this.height = height;\n  }\n\n  LeafChunk.prototype = {\n    chunkSize: function() { return this.lines.length; },\n    removeInner: function(at, n) {\n      for (var i = at, e = at + n; i < e; ++i) {\n        var line = this.lines[i];\n        this.height -= line.height;\n        cleanUpLine(line);\n        signalLater(line, \"delete\");\n      }\n      this.lines.splice(at, n);\n    },\n    collapse: function(lines) {\n      lines.splice.apply(lines, [lines.length, 0].concat(this.lines));\n    },\n    insertInner: function(at, lines, height) {\n      this.height += height;\n      this.lines = this.lines.slice(0, at).concat(lines).concat(this.lines.slice(at));\n      for (var i = 0, e = lines.length; i < e; ++i) lines[i].parent = this;\n    },\n    iterN: function(at, n, op) {\n      for (var e = at + n; at < e; ++at)\n        if (op(this.lines[at])) return true;\n    }\n  };\n\n  function BranchChunk(children) {\n    this.children = children;\n    var size = 0, height = 0;\n    for (var i = 0, e = children.length; i < e; ++i) {\n      var ch = children[i];\n      size += ch.chunkSize(); height += ch.height;\n      ch.parent = this;\n    }\n    this.size = size;\n    this.height = height;\n    this.parent = null;\n  }\n\n  BranchChunk.prototype = {\n    chunkSize: function() { return this.size; },\n    removeInner: function(at, n) {\n      this.size -= n;\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at < sz) {\n          var rm = Math.min(n, sz - at), oldHeight = child.height;\n          child.removeInner(at, rm);\n          this.height -= oldHeight - child.height;\n          if (sz == rm) { this.children.splice(i--, 1); child.parent = null; }\n          if ((n -= rm) == 0) break;\n          at = 0;\n        } else at -= sz;\n      }\n      if (this.size - n < 25) {\n        var lines = [];\n        this.collapse(lines);\n        this.children = [new LeafChunk(lines)];\n        this.children[0].parent = this;\n      }\n    },\n    collapse: function(lines) {\n      for (var i = 0, e = this.children.length; i < e; ++i) this.children[i].collapse(lines);\n    },\n    insertInner: function(at, lines, height) {\n      this.size += lines.length;\n      this.height += height;\n      for (var i = 0, e = this.children.length; i < e; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at <= sz) {\n          child.insertInner(at, lines, height);\n          if (child.lines && child.lines.length > 50) {\n            while (child.lines.length > 50) {\n              var spilled = child.lines.splice(child.lines.length - 25, 25);\n              var newleaf = new LeafChunk(spilled);\n              child.height -= newleaf.height;\n              this.children.splice(i + 1, 0, newleaf);\n              newleaf.parent = this;\n            }\n            this.maybeSpill();\n          }\n          break;\n        }\n        at -= sz;\n      }\n    },\n    maybeSpill: function() {\n      if (this.children.length <= 10) return;\n      var me = this;\n      do {\n        var spilled = me.children.splice(me.children.length - 5, 5);\n        var sibling = new BranchChunk(spilled);\n        if (!me.parent) { // Become the parent node\n          var copy = new BranchChunk(me.children);\n          copy.parent = me;\n          me.children = [copy, sibling];\n          me = copy;\n        } else {\n          me.size -= sibling.size;\n          me.height -= sibling.height;\n          var myIndex = indexOf(me.parent.children, me);\n          me.parent.children.splice(myIndex + 1, 0, sibling);\n        }\n        sibling.parent = me.parent;\n      } while (me.children.length > 10);\n      me.parent.maybeSpill();\n    },\n    iterN: function(at, n, op) {\n      for (var i = 0, e = this.children.length; i < e; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at < sz) {\n          var used = Math.min(n, sz - at);\n          if (child.iterN(at, used, op)) return true;\n          if ((n -= used) == 0) break;\n          at = 0;\n        } else at -= sz;\n      }\n    }\n  };\n\n  var nextDocId = 0;\n  var Doc = CodeMirror.Doc = function(text, mode, firstLine) {\n    if (!(this instanceof Doc)) return new Doc(text, mode, firstLine);\n    if (firstLine == null) firstLine = 0;\n\n    BranchChunk.call(this, [new LeafChunk([new Line(\"\", null)])]);\n    this.first = firstLine;\n    this.scrollTop = this.scrollLeft = 0;\n    this.cantEdit = false;\n    this.history = makeHistory();\n    this.cleanGeneration = 1;\n    this.frontier = firstLine;\n    var start = Pos(firstLine, 0);\n    this.sel = {from: start, to: start, head: start, anchor: start, shift: false, extend: false, goalColumn: null};\n    this.id = ++nextDocId;\n    this.modeOption = mode;\n\n    if (typeof text == \"string\") text = splitLines(text);\n    updateDoc(this, {from: start, to: start, text: text}, null, {head: start, anchor: start});\n  };\n\n  Doc.prototype = createObj(BranchChunk.prototype, {\n    constructor: Doc,\n    iter: function(from, to, op) {\n      if (op) this.iterN(from - this.first, to - from, op);\n      else this.iterN(this.first, this.first + this.size, from);\n    },\n\n    insert: function(at, lines) {\n      var height = 0;\n      for (var i = 0, e = lines.length; i < e; ++i) height += lines[i].height;\n      this.insertInner(at - this.first, lines, height);\n    },\n    remove: function(at, n) { this.removeInner(at - this.first, n); },\n\n    getValue: function(lineSep) {\n      var lines = getLines(this, this.first, this.first + this.size);\n      if (lineSep === false) return lines;\n      return lines.join(lineSep || \"\\n\");\n    },\n    setValue: function(code) {\n      var top = Pos(this.first, 0), last = this.first + this.size - 1;\n      makeChange(this, {from: top, to: Pos(last, getLine(this, last).text.length),\n                        text: splitLines(code), origin: \"setValue\"},\n                 {head: top, anchor: top}, true);\n    },\n    replaceRange: function(code, from, to, origin) {\n      from = clipPos(this, from);\n      to = to ? clipPos(this, to) : from;\n      replaceRange(this, code, from, to, origin);\n    },\n    getRange: function(from, to, lineSep) {\n      var lines = getBetween(this, clipPos(this, from), clipPos(this, to));\n      if (lineSep === false) return lines;\n      return lines.join(lineSep || \"\\n\");\n    },\n\n    getLine: function(line) {var l = this.getLineHandle(line); return l && l.text;},\n    setLine: function(line, text) {\n      if (isLine(this, line))\n        replaceRange(this, text, Pos(line, 0), clipPos(this, Pos(line)));\n    },\n    removeLine: function(line) {\n      if (line) replaceRange(this, \"\", clipPos(this, Pos(line - 1)), clipPos(this, Pos(line)));\n      else replaceRange(this, \"\", Pos(0, 0), clipPos(this, Pos(1, 0)));\n    },\n\n    getLineHandle: function(line) {if (isLine(this, line)) return getLine(this, line);},\n    getLineNumber: function(line) {return lineNo(line);},\n\n    getLineHandleVisualStart: function(line) {\n      if (typeof line == \"number\") line = getLine(this, line);\n      return visualLine(this, line);\n    },\n\n    lineCount: function() {return this.size;},\n    firstLine: function() {return this.first;},\n    lastLine: function() {return this.first + this.size - 1;},\n\n    clipPos: function(pos) {return clipPos(this, pos);},\n\n    getCursor: function(start) {\n      var sel = this.sel, pos;\n      if (start == null || start == \"head\") pos = sel.head;\n      else if (start == \"anchor\") pos = sel.anchor;\n      else if (start == \"end\" || start === false) pos = sel.to;\n      else pos = sel.from;\n      return copyPos(pos);\n    },\n    somethingSelected: function() {return !posEq(this.sel.head, this.sel.anchor);},\n\n    setCursor: docOperation(function(line, ch, extend) {\n      var pos = clipPos(this, typeof line == \"number\" ? Pos(line, ch || 0) : line);\n      if (extend) extendSelection(this, pos);\n      else setSelection(this, pos, pos);\n    }),\n    setSelection: docOperation(function(anchor, head, bias) {\n      setSelection(this, clipPos(this, anchor), clipPos(this, head || anchor), bias);\n    }),\n    extendSelection: docOperation(function(from, to, bias) {\n      extendSelection(this, clipPos(this, from), to && clipPos(this, to), bias);\n    }),\n\n    getSelection: function(lineSep) {return this.getRange(this.sel.from, this.sel.to, lineSep);},\n    replaceSelection: function(code, collapse, origin) {\n      makeChange(this, {from: this.sel.from, to: this.sel.to, text: splitLines(code), origin: origin}, collapse || \"around\");\n    },\n    undo: docOperation(function() {makeChangeFromHistory(this, \"undo\");}),\n    redo: docOperation(function() {makeChangeFromHistory(this, \"redo\");}),\n\n    setExtending: function(val) {this.sel.extend = val;},\n\n    historySize: function() {\n      var hist = this.history;\n      return {undo: hist.done.length, redo: hist.undone.length};\n    },\n    clearHistory: function() {this.history = makeHistory(this.history.maxGeneration);},\n\n    markClean: function() {\n      this.cleanGeneration = this.changeGeneration(true);\n    },\n    changeGeneration: function(forceSplit) {\n      if (forceSplit)\n        this.history.lastOp = this.history.lastOrigin = null;\n      return this.history.generation;\n    },\n    isClean: function (gen) {\n      return this.history.generation == (gen || this.cleanGeneration);\n    },\n\n    getHistory: function() {\n      return {done: copyHistoryArray(this.history.done),\n              undone: copyHistoryArray(this.history.undone)};\n    },\n    setHistory: function(histData) {\n      var hist = this.history = makeHistory(this.history.maxGeneration);\n      hist.done = histData.done.slice(0);\n      hist.undone = histData.undone.slice(0);\n    },\n\n    markText: function(from, to, options) {\n      return markText(this, clipPos(this, from), clipPos(this, to), options, \"range\");\n    },\n    setBookmark: function(pos, options) {\n      var realOpts = {replacedWith: options && (options.nodeType == null ? options.widget : options),\n                      insertLeft: options && options.insertLeft,\n                      clearWhenEmpty: false};\n      pos = clipPos(this, pos);\n      return markText(this, pos, pos, realOpts, \"bookmark\");\n    },\n    findMarksAt: function(pos) {\n      pos = clipPos(this, pos);\n      var markers = [], spans = getLine(this, pos.line).markedSpans;\n      if (spans) for (var i = 0; i < spans.length; ++i) {\n        var span = spans[i];\n        if ((span.from == null || span.from <= pos.ch) &&\n            (span.to == null || span.to >= pos.ch))\n          markers.push(span.marker.parent || span.marker);\n      }\n      return markers;\n    },\n    findMarks: function(from, to) {\n      from = clipPos(this, from); to = clipPos(this, to);\n      var found = [], lineNo = from.line;\n      this.iter(from.line, to.line + 1, function(line) {\n        var spans = line.markedSpans;\n        if (spans) for (var i = 0; i < spans.length; i++) {\n          var span = spans[i];\n          if (!(lineNo == from.line && from.ch > span.to ||\n                span.from == null && lineNo != from.line||\n                lineNo == to.line && span.from > to.ch))\n            found.push(span.marker.parent || span.marker);\n        }\n        ++lineNo;\n      });\n      return found;\n    },\n    getAllMarks: function() {\n      var markers = [];\n      this.iter(function(line) {\n        var sps = line.markedSpans;\n        if (sps) for (var i = 0; i < sps.length; ++i)\n          if (sps[i].from != null) markers.push(sps[i].marker);\n      });\n      return markers;\n    },\n\n    posFromIndex: function(off) {\n      var ch, lineNo = this.first;\n      this.iter(function(line) {\n        var sz = line.text.length + 1;\n        if (sz > off) { ch = off; return true; }\n        off -= sz;\n        ++lineNo;\n      });\n      return clipPos(this, Pos(lineNo, ch));\n    },\n    indexFromPos: function (coords) {\n      coords = clipPos(this, coords);\n      var index = coords.ch;\n      if (coords.line < this.first || coords.ch < 0) return 0;\n      this.iter(this.first, coords.line, function (line) {\n        index += line.text.length + 1;\n      });\n      return index;\n    },\n\n    copy: function(copyHistory) {\n      var doc = new Doc(getLines(this, this.first, this.first + this.size), this.modeOption, this.first);\n      doc.scrollTop = this.scrollTop; doc.scrollLeft = this.scrollLeft;\n      doc.sel = {from: this.sel.from, to: this.sel.to, head: this.sel.head, anchor: this.sel.anchor,\n                 shift: this.sel.shift, extend: false, goalColumn: this.sel.goalColumn};\n      if (copyHistory) {\n        doc.history.undoDepth = this.history.undoDepth;\n        doc.setHistory(this.getHistory());\n      }\n      return doc;\n    },\n\n    linkedDoc: function(options) {\n      if (!options) options = {};\n      var from = this.first, to = this.first + this.size;\n      if (options.from != null && options.from > from) from = options.from;\n      if (options.to != null && options.to < to) to = options.to;\n      var copy = new Doc(getLines(this, from, to), options.mode || this.modeOption, from);\n      if (options.sharedHist) copy.history = this.history;\n      (this.linked || (this.linked = [])).push({doc: copy, sharedHist: options.sharedHist});\n      copy.linked = [{doc: this, isParent: true, sharedHist: options.sharedHist}];\n      return copy;\n    },\n    unlinkDoc: function(other) {\n      if (other instanceof CodeMirror) other = other.doc;\n      if (this.linked) for (var i = 0; i < this.linked.length; ++i) {\n        var link = this.linked[i];\n        if (link.doc != other) continue;\n        this.linked.splice(i, 1);\n        other.unlinkDoc(this);\n        break;\n      }\n      // If the histories were shared, split them again\n      if (other.history == this.history) {\n        var splitIds = [other.id];\n        linkedDocs(other, function(doc) {splitIds.push(doc.id);}, true);\n        other.history = makeHistory();\n        other.history.done = copyHistoryArray(this.history.done, splitIds);\n        other.history.undone = copyHistoryArray(this.history.undone, splitIds);\n      }\n    },\n    iterLinkedDocs: function(f) {linkedDocs(this, f);},\n\n    getMode: function() {return this.mode;},\n    getEditor: function() {return this.cm;}\n  });\n\n  Doc.prototype.eachLine = Doc.prototype.iter;\n\n  // The Doc methods that should be available on CodeMirror instances\n  var dontDelegate = \"iter insert remove copy getEditor\".split(\" \");\n  for (var prop in Doc.prototype) if (Doc.prototype.hasOwnProperty(prop) && indexOf(dontDelegate, prop) < 0)\n    CodeMirror.prototype[prop] = (function(method) {\n      return function() {return method.apply(this.doc, arguments);};\n    })(Doc.prototype[prop]);\n\n  eventMixin(Doc);\n\n  function linkedDocs(doc, f, sharedHistOnly) {\n    function propagate(doc, skip, sharedHist) {\n      if (doc.linked) for (var i = 0; i < doc.linked.length; ++i) {\n        var rel = doc.linked[i];\n        if (rel.doc == skip) continue;\n        var shared = sharedHist && rel.sharedHist;\n        if (sharedHistOnly && !shared) continue;\n        f(rel.doc, shared);\n        propagate(rel.doc, doc, shared);\n      }\n    }\n    propagate(doc, null, true);\n  }\n\n  function attachDoc(cm, doc) {\n    if (doc.cm) throw new Error(\"This document is already in use.\");\n    cm.doc = doc;\n    doc.cm = cm;\n    estimateLineHeights(cm);\n    loadMode(cm);\n    if (!cm.options.lineWrapping) computeMaxLength(cm);\n    cm.options.mode = doc.modeOption;\n    regChange(cm);\n  }\n\n  // LINE UTILITIES\n\n  function getLine(chunk, n) {\n    n -= chunk.first;\n    while (!chunk.lines) {\n      for (var i = 0;; ++i) {\n        var child = chunk.children[i], sz = child.chunkSize();\n        if (n < sz) { chunk = child; break; }\n        n -= sz;\n      }\n    }\n    return chunk.lines[n];\n  }\n\n  function getBetween(doc, start, end) {\n    var out = [], n = start.line;\n    doc.iter(start.line, end.line + 1, function(line) {\n      var text = line.text;\n      if (n == end.line) text = text.slice(0, end.ch);\n      if (n == start.line) text = text.slice(start.ch);\n      out.push(text);\n      ++n;\n    });\n    return out;\n  }\n  function getLines(doc, from, to) {\n    var out = [];\n    doc.iter(from, to, function(line) { out.push(line.text); });\n    return out;\n  }\n\n  function updateLineHeight(line, height) {\n    var diff = height - line.height;\n    for (var n = line; n; n = n.parent) n.height += diff;\n  }\n\n  function lineNo(line) {\n    if (line.parent == null) return null;\n    var cur = line.parent, no = indexOf(cur.lines, line);\n    for (var chunk = cur.parent; chunk; cur = chunk, chunk = chunk.parent) {\n      for (var i = 0;; ++i) {\n        if (chunk.children[i] == cur) break;\n        no += chunk.children[i].chunkSize();\n      }\n    }\n    return no + cur.first;\n  }\n\n  function lineAtHeight(chunk, h) {\n    var n = chunk.first;\n    outer: do {\n      for (var i = 0, e = chunk.children.length; i < e; ++i) {\n        var child = chunk.children[i], ch = child.height;\n        if (h < ch) { chunk = child; continue outer; }\n        h -= ch;\n        n += child.chunkSize();\n      }\n      return n;\n    } while (!chunk.lines);\n    for (var i = 0, e = chunk.lines.length; i < e; ++i) {\n      var line = chunk.lines[i], lh = line.height;\n      if (h < lh) break;\n      h -= lh;\n    }\n    return n + i;\n  }\n\n  function heightAtLine(cm, lineObj) {\n    lineObj = visualLine(cm.doc, lineObj);\n\n    var h = 0, chunk = lineObj.parent;\n    for (var i = 0; i < chunk.lines.length; ++i) {\n      var line = chunk.lines[i];\n      if (line == lineObj) break;\n      else h += line.height;\n    }\n    for (var p = chunk.parent; p; chunk = p, p = chunk.parent) {\n      for (var i = 0; i < p.children.length; ++i) {\n        var cur = p.children[i];\n        if (cur == chunk) break;\n        else h += cur.height;\n      }\n    }\n    return h;\n  }\n\n  function getOrder(line) {\n    var order = line.order;\n    if (order == null) order = line.order = bidiOrdering(line.text);\n    return order;\n  }\n\n  // HISTORY\n\n  function makeHistory(startGen) {\n    return {\n      // Arrays of history events. Doing something adds an event to\n      // done and clears undo. Undoing moves events from done to\n      // undone, redoing moves them in the other direction.\n      done: [], undone: [], undoDepth: Infinity,\n      // Used to track when changes can be merged into a single undo\n      // event\n      lastTime: 0, lastOp: null, lastOrigin: null,\n      // Used by the isClean() method\n      generation: startGen || 1, maxGeneration: startGen || 1\n    };\n  }\n\n  function attachLocalSpans(doc, change, from, to) {\n    var existing = change[\"spans_\" + doc.id], n = 0;\n    doc.iter(Math.max(doc.first, from), Math.min(doc.first + doc.size, to), function(line) {\n      if (line.markedSpans)\n        (existing || (existing = change[\"spans_\" + doc.id] = {}))[n] = line.markedSpans;\n      ++n;\n    });\n  }\n\n  function historyChangeFromChange(doc, change) {\n    var from = { line: change.from.line, ch: change.from.ch };\n    var histChange = {from: from, to: changeEnd(change), text: getBetween(doc, change.from, change.to)};\n    attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1);\n    linkedDocs(doc, function(doc) {attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1);}, true);\n    return histChange;\n  }\n\n  function addToHistory(doc, change, selAfter, opId) {\n    var hist = doc.history;\n    hist.undone.length = 0;\n    var time = +new Date, cur = lst(hist.done);\n\n    if (cur &&\n        (hist.lastOp == opId ||\n         hist.lastOrigin == change.origin && change.origin &&\n         ((change.origin.charAt(0) == \"+\" && doc.cm && hist.lastTime > time - doc.cm.options.historyEventDelay) ||\n          change.origin.charAt(0) == \"*\"))) {\n      // Merge this change into the last event\n      var last = lst(cur.changes);\n      if (posEq(change.from, change.to) && posEq(change.from, last.to)) {\n        // Optimized case for simple insertion -- don't want to add\n        // new changesets for every character typed\n        last.to = changeEnd(change);\n      } else {\n        // Add new sub-event\n        cur.changes.push(historyChangeFromChange(doc, change));\n      }\n      cur.anchorAfter = selAfter.anchor; cur.headAfter = selAfter.head;\n    } else {\n      // Can not be merged, start a new event.\n      cur = {changes: [historyChangeFromChange(doc, change)],\n             generation: hist.generation,\n             anchorBefore: doc.sel.anchor, headBefore: doc.sel.head,\n             anchorAfter: selAfter.anchor, headAfter: selAfter.head};\n      hist.done.push(cur);\n      while (hist.done.length > hist.undoDepth)\n        hist.done.shift();\n    }\n    hist.generation = ++hist.maxGeneration;\n    hist.lastTime = time;\n    hist.lastOp = opId;\n    hist.lastOrigin = change.origin;\n\n    if (!last) signal(doc, \"historyAdded\");\n  }\n\n  function removeClearedSpans(spans) {\n    if (!spans) return null;\n    for (var i = 0, out; i < spans.length; ++i) {\n      if (spans[i].marker.explicitlyCleared) { if (!out) out = spans.slice(0, i); }\n      else if (out) out.push(spans[i]);\n    }\n    return !out ? spans : out.length ? out : null;\n  }\n\n  function getOldSpans(doc, change) {\n    var found = change[\"spans_\" + doc.id];\n    if (!found) return null;\n    for (var i = 0, nw = []; i < change.text.length; ++i)\n      nw.push(removeClearedSpans(found[i]));\n    return nw;\n  }\n\n  // Used both to provide a JSON-safe object in .getHistory, and, when\n  // detaching a document, to split the history in two\n  function copyHistoryArray(events, newGroup) {\n    for (var i = 0, copy = []; i < events.length; ++i) {\n      var event = events[i], changes = event.changes, newChanges = [];\n      copy.push({changes: newChanges, anchorBefore: event.anchorBefore, headBefore: event.headBefore,\n                 anchorAfter: event.anchorAfter, headAfter: event.headAfter});\n      for (var j = 0; j < changes.length; ++j) {\n        var change = changes[j], m;\n        newChanges.push({from: change.from, to: change.to, text: change.text});\n        if (newGroup) for (var prop in change) if (m = prop.match(/^spans_(\\d+)$/)) {\n          if (indexOf(newGroup, Number(m[1])) > -1) {\n            lst(newChanges)[prop] = change[prop];\n            delete change[prop];\n          }\n        }\n      }\n    }\n    return copy;\n  }\n\n  // Rebasing/resetting history to deal with externally-sourced changes\n\n  function rebaseHistSel(pos, from, to, diff) {\n    if (to < pos.line) {\n      pos.line += diff;\n    } else if (from < pos.line) {\n      pos.line = from;\n      pos.ch = 0;\n    }\n  }\n\n  // Tries to rebase an array of history events given a change in the\n  // document. If the change touches the same lines as the event, the\n  // event, and everything 'behind' it, is discarded. If the change is\n  // before the event, the event's positions are updated. Uses a\n  // copy-on-write scheme for the positions, to avoid having to\n  // reallocate them all on every rebase, but also avoid problems with\n  // shared position objects being unsafely updated.\n  function rebaseHistArray(array, from, to, diff) {\n    for (var i = 0; i < array.length; ++i) {\n      var sub = array[i], ok = true;\n      for (var j = 0; j < sub.changes.length; ++j) {\n        var cur = sub.changes[j];\n        if (!sub.copied) { cur.from = copyPos(cur.from); cur.to = copyPos(cur.to); }\n        if (to < cur.from.line) {\n          cur.from.line += diff;\n          cur.to.line += diff;\n        } else if (from <= cur.to.line) {\n          ok = false;\n          break;\n        }\n      }\n      if (!sub.copied) {\n        sub.anchorBefore = copyPos(sub.anchorBefore); sub.headBefore = copyPos(sub.headBefore);\n        sub.anchorAfter = copyPos(sub.anchorAfter); sub.readAfter = copyPos(sub.headAfter);\n        sub.copied = true;\n      }\n      if (!ok) {\n        array.splice(0, i + 1);\n        i = 0;\n      } else {\n        rebaseHistSel(sub.anchorBefore); rebaseHistSel(sub.headBefore);\n        rebaseHistSel(sub.anchorAfter); rebaseHistSel(sub.headAfter);\n      }\n    }\n  }\n\n  function rebaseHist(hist, change) {\n    var from = change.from.line, to = change.to.line, diff = change.text.length - (to - from) - 1;\n    rebaseHistArray(hist.done, from, to, diff);\n    rebaseHistArray(hist.undone, from, to, diff);\n  }\n\n  // EVENT OPERATORS\n\n  function stopMethod() {e_stop(this);}\n  // Ensure an event has a stop method.\n  function addStop(event) {\n    if (!event.stop) event.stop = stopMethod;\n    return event;\n  }\n\n  function e_preventDefault(e) {\n    if (e.preventDefault) e.preventDefault();\n    else e.returnValue = false;\n  }\n  function e_stopPropagation(e) {\n    if (e.stopPropagation) e.stopPropagation();\n    else e.cancelBubble = true;\n  }\n  function e_defaultPrevented(e) {\n    return e.defaultPrevented != null ? e.defaultPrevented : e.returnValue == false;\n  }\n  function e_stop(e) {e_preventDefault(e); e_stopPropagation(e);}\n  CodeMirror.e_stop = e_stop;\n  CodeMirror.e_preventDefault = e_preventDefault;\n  CodeMirror.e_stopPropagation = e_stopPropagation;\n\n  function e_target(e) {return e.target || e.srcElement;}\n  function e_button(e) {\n    var b = e.which;\n    if (b == null) {\n      if (e.button & 1) b = 1;\n      else if (e.button & 2) b = 3;\n      else if (e.button & 4) b = 2;\n    }\n    if (mac && e.ctrlKey && b == 1) b = 3;\n    return b;\n  }\n\n  // EVENT HANDLING\n\n  function on(emitter, type, f) {\n    if (emitter.addEventListener)\n      emitter.addEventListener(type, f, false);\n    else if (emitter.attachEvent)\n      emitter.attachEvent(\"on\" + type, f);\n    else {\n      var map = emitter._handlers || (emitter._handlers = {});\n      var arr = map[type] || (map[type] = []);\n      arr.push(f);\n    }\n  }\n\n  function off(emitter, type, f) {\n    if (emitter.removeEventListener)\n      emitter.removeEventListener(type, f, false);\n    else if (emitter.detachEvent)\n      emitter.detachEvent(\"on\" + type, f);\n    else {\n      var arr = emitter._handlers && emitter._handlers[type];\n      if (!arr) return;\n      for (var i = 0; i < arr.length; ++i)\n        if (arr[i] == f) { arr.splice(i, 1); break; }\n    }\n  }\n\n  function signal(emitter, type /*, values...*/) {\n    var arr = emitter._handlers && emitter._handlers[type];\n    if (!arr) return;\n    var args = Array.prototype.slice.call(arguments, 2);\n    for (var i = 0; i < arr.length; ++i) arr[i].apply(null, args);\n  }\n\n  var delayedCallbacks, delayedCallbackDepth = 0;\n  function signalLater(emitter, type /*, values...*/) {\n    var arr = emitter._handlers && emitter._handlers[type];\n    if (!arr) return;\n    var args = Array.prototype.slice.call(arguments, 2);\n    if (!delayedCallbacks) {\n      ++delayedCallbackDepth;\n      delayedCallbacks = [];\n      setTimeout(fireDelayed, 0);\n    }\n    function bnd(f) {return function(){f.apply(null, args);};};\n    for (var i = 0; i < arr.length; ++i)\n      delayedCallbacks.push(bnd(arr[i]));\n  }\n\n  function signalDOMEvent(cm, e, override) {\n    signal(cm, override || e.type, cm, e);\n    return e_defaultPrevented(e) || e.codemirrorIgnore;\n  }\n\n  function fireDelayed() {\n    --delayedCallbackDepth;\n    var delayed = delayedCallbacks;\n    delayedCallbacks = null;\n    for (var i = 0; i < delayed.length; ++i) delayed[i]();\n  }\n\n  function hasHandler(emitter, type) {\n    var arr = emitter._handlers && emitter._handlers[type];\n    return arr && arr.length > 0;\n  }\n\n  CodeMirror.on = on; CodeMirror.off = off; CodeMirror.signal = signal;\n\n  function eventMixin(ctor) {\n    ctor.prototype.on = function(type, f) {on(this, type, f);};\n    ctor.prototype.off = function(type, f) {off(this, type, f);};\n  }\n\n  // MISC UTILITIES\n\n  // Number of pixels added to scroller and sizer to hide scrollbar\n  var scrollerCutOff = 30;\n\n  // Returned or thrown by various protocols to signal 'I'm not\n  // handling this'.\n  var Pass = CodeMirror.Pass = {toString: function(){return \"CodeMirror.Pass\";}};\n\n  function Delayed() {this.id = null;}\n  Delayed.prototype = {set: function(ms, f) {clearTimeout(this.id); this.id = setTimeout(f, ms);}};\n\n  // Counts the column offset in a string, taking tabs into account.\n  // Used mostly to find indentation.\n  function countColumn(string, end, tabSize, startIndex, startValue) {\n    if (end == null) {\n      end = string.search(/[^\\s\\u00a0]/);\n      if (end == -1) end = string.length;\n    }\n    for (var i = startIndex || 0, n = startValue || 0; i < end; ++i) {\n      if (string.charAt(i) == \"\\t\") n += tabSize - (n % tabSize);\n      else ++n;\n    }\n    return n;\n  }\n  CodeMirror.countColumn = countColumn;\n\n  var spaceStrs = [\"\"];\n  function spaceStr(n) {\n    while (spaceStrs.length <= n)\n      spaceStrs.push(lst(spaceStrs) + \" \");\n    return spaceStrs[n];\n  }\n\n  function lst(arr) { return arr[arr.length-1]; }\n\n  function selectInput(node) {\n    if (ios) { // Mobile Safari apparently has a bug where select() is broken.\n      node.selectionStart = 0;\n      node.selectionEnd = node.value.length;\n    } else {\n      // Suppress mysterious IE10 errors\n      try { node.select(); }\n      catch(_e) {}\n    }\n  }\n\n  function indexOf(collection, elt) {\n    if (collection.indexOf) return collection.indexOf(elt);\n    for (var i = 0, e = collection.length; i < e; ++i)\n      if (collection[i] == elt) return i;\n    return -1;\n  }\n\n  function createObj(base, props) {\n    function Obj() {}\n    Obj.prototype = base;\n    var inst = new Obj();\n    if (props) copyObj(props, inst);\n    return inst;\n  }\n\n  function copyObj(obj, target) {\n    if (!target) target = {};\n    for (var prop in obj) if (obj.hasOwnProperty(prop)) target[prop] = obj[prop];\n    return target;\n  }\n\n  function emptyArray(size) {\n    for (var a = [], i = 0; i < size; ++i) a.push(undefined);\n    return a;\n  }\n\n  function bind(f) {\n    var args = Array.prototype.slice.call(arguments, 1);\n    return function(){return f.apply(null, args);};\n  }\n\n  var nonASCIISingleCaseWordChar = /[\\u00df\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/;\n  function isWordChar(ch) {\n    return /\\w/.test(ch) || ch > \"\\x80\" &&\n      (ch.toUpperCase() != ch.toLowerCase() || nonASCIISingleCaseWordChar.test(ch));\n  }\n\n  function isEmpty(obj) {\n    for (var n in obj) if (obj.hasOwnProperty(n) && obj[n]) return false;\n    return true;\n  }\n\n  var extendingChars = /[\\u0300-\\u036f\\u0483-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u064b-\\u065e\\u0670\\u06d6-\\u06dc\\u06de-\\u06e4\\u06e7\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0900-\\u0902\\u093c\\u0941-\\u0948\\u094d\\u0951-\\u0955\\u0962\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2\\u09e3\\u0a01\\u0a02\\u0a3c\\u0a41\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70\\u0a71\\u0a75\\u0a81\\u0a82\\u0abc\\u0ac1-\\u0ac5\\u0ac7\\u0ac8\\u0acd\\u0ae2\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57\\u0b62\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62\\u0c63\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc\\u0ccd\\u0cd5\\u0cd6\\u0ce2\\u0ce3\\u0d3e\\u0d41-\\u0d44\\u0d4d\\u0d57\\u0d62\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9\\u0ebb\\u0ebc\\u0ec8-\\u0ecd\\u0f18\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86\\u0f87\\u0f90-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039\\u103a\\u103d\\u103e\\u1058\\u1059\\u105e-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108d\\u109d\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193b\\u1a17\\u1a18\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1b00-\\u1b03\\u1b34\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80\\u1b81\\u1ba2-\\u1ba5\\u1ba8\\u1ba9\\u1c2c-\\u1c33\\u1c36\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1dc0-\\u1de6\\u1dfd-\\u1dff\\u200c\\u200d\\u20d0-\\u20f0\\u2cef-\\u2cf1\\u2de0-\\u2dff\\u302a-\\u302f\\u3099\\u309a\\ua66f-\\ua672\\ua67c\\ua67d\\ua6f0\\ua6f1\\ua802\\ua806\\ua80b\\ua825\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc\\uaa29-\\uaa2e\\uaa31\\uaa32\\uaa35\\uaa36\\uaa43\\uaa4c\\uaab0\\uaab2-\\uaab4\\uaab7\\uaab8\\uaabe\\uaabf\\uaac1\\uabe5\\uabe8\\uabed\\udc00-\\udfff\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe26\\uff9e\\uff9f]/;\n  function isExtendingChar(ch) { return ch.charCodeAt(0) >= 768 && extendingChars.test(ch); }\n\n  // DOM UTILITIES\n\n  // Get the relative luminance\n  function relativeLuminanceW3C(R8bit, G8bit, B8bit) { \n    var RsRGB = R8bit/255;\n    var GsRGB = G8bit/255;\n    var BsRGB = B8bit/255;\n\n    var R = (RsRGB <= 0.03928) ? RsRGB/12.92 : Math.pow((RsRGB+0.055)/1.055, 2.4);\n    var G = (GsRGB <= 0.03928) ? GsRGB/12.92 : Math.pow((GsRGB+0.055)/1.055, 2.4);\n    var B = (BsRGB <= 0.03928) ? BsRGB/12.92 : Math.pow((BsRGB+0.055)/1.055, 2.4);\n\n    // For the sRGB colorspace, the relative luminance of a color is defined as: \n    var L = 0.2126 * R + 0.7152 * G + 0.0722 * B;\n\n    return L;\n  }\n\n  function elt(tag, content, className, style) {\n    var e = document.createElement(tag);\n    if (className) e.className = className;\n    if (style) e.style.cssText = style;\n    if (typeof content == \"string\") setTextContent(e, content);\n    else if (content) for (var i = 0; i < content.length; ++i) e.appendChild(content[i]);\n    \n    // It adds the background color of the element content\n    if (className === \"cm-color\" && RGBColor) {\n      var color = new RGBColor(e.innerHTML);\n      var luminance = relativeLuminanceW3C(color.r,color.g,color.b);\n      \n      if (luminance < 0.51) {\n        e.style.color = \"white\"\n      }\n      e.style.background = e.innerHTML;\n    }\n    return e;\n  }\n\n  function removeChildren(e) {\n    for (var count = e.childNodes.length; count > 0; --count)\n      e.removeChild(e.firstChild);\n    return e;\n  }\n\n  function removeChildrenAndAdd(parent, e) {\n    return removeChildren(parent).appendChild(e);\n  }\n\n  function setTextContent(e, str) {\n    if (ie_lt9) {\n      e.innerHTML = \"\";\n      e.appendChild(document.createTextNode(str));\n    } else e.textContent = str;\n  }\n\n  function getRect(node) {\n    return node.getBoundingClientRect();\n  }\n  CodeMirror.replaceGetRect = function(f) { getRect = f; };\n\n  // FEATURE DETECTION\n\n  // Detect drag-and-drop\n  var dragAndDrop = function() {\n    // There is *some* kind of drag-and-drop support in IE6-8, but I\n    // couldn't get it to work yet.\n    if (ie_lt9) return false;\n    var div = elt('div');\n    return \"draggable\" in div || \"dragDrop\" in div;\n  }();\n\n  // For a reason I have yet to figure out, some browsers disallow\n  // word wrapping between certain characters *only* if a new inline\n  // element is started between them. This makes it hard to reliably\n  // measure the position of things, since that requires inserting an\n  // extra span. This terribly fragile set of tests matches the\n  // character combinations that suffer from this phenomenon on the\n  // various browsers.\n  function spanAffectsWrapping() { return false; }\n  if (gecko) // Only for \"$'\"\n    spanAffectsWrapping = function(str, i) {\n      return str.charCodeAt(i - 1) == 36 && str.charCodeAt(i) == 39;\n    };\n  else if (safari && !/Version\\/([6-9]|\\d\\d)\\b/.test(navigator.userAgent))\n    spanAffectsWrapping = function(str, i) {\n      return /\\-[^ \\-?]|\\?[^ !\\'\\\"\\),.\\-\\/:;\\?\\]\\}]/.test(str.slice(i - 1, i + 1));\n    };\n  else if (webkit && /Chrome\\/(?:29|[3-9]\\d|\\d\\d\\d)\\./.test(navigator.userAgent))\n    spanAffectsWrapping = function(str, i) {\n      var code = str.charCodeAt(i - 1);\n      return code >= 8208 && code <= 8212;\n    };\n  else if (webkit)\n    spanAffectsWrapping = function(str, i) {\n      if (i > 1 && str.charCodeAt(i - 1) == 45) {\n        if (/\\w/.test(str.charAt(i - 2)) && /[^\\-?\\.]/.test(str.charAt(i))) return true;\n        if (i > 2 && /[\\d\\.,]/.test(str.charAt(i - 2)) && /[\\d\\.,]/.test(str.charAt(i))) return false;\n      }\n      return /[~!#%&*)=+}\\]\\\\|\\\"\\.>,:;][({[<]|-[^\\-?\\.\\u2010-\\u201f\\u2026]|\\?[\\w~`@#$%\\^&*(_=+{[|><]|\\u2026[\\w~`@#$%\\^&*(_=+{[><]/.test(str.slice(i - 1, i + 1));\n    };\n\n  var knownScrollbarWidth;\n  function scrollbarWidth(measure) {\n    if (knownScrollbarWidth != null) return knownScrollbarWidth;\n    var test = elt(\"div\", null, null, \"width: 50px; height: 50px; overflow-x: scroll\");\n    removeChildrenAndAdd(measure, test);\n    if (test.offsetWidth)\n      knownScrollbarWidth = test.offsetHeight - test.clientHeight;\n    return knownScrollbarWidth || 0;\n  }\n\n  var zwspSupported;\n  function zeroWidthElement(measure) {\n    if (zwspSupported == null) {\n      var test = elt(\"span\", \"\\u200b\");\n      removeChildrenAndAdd(measure, elt(\"span\", [test, document.createTextNode(\"x\")]));\n      if (measure.firstChild.offsetHeight != 0)\n        zwspSupported = test.offsetWidth <= 1 && test.offsetHeight > 2 && !ie_lt8;\n    }\n    if (zwspSupported) return elt(\"span\", \"\\u200b\");\n    else return elt(\"span\", \"\\u00a0\", null, \"display: inline-block; width: 1px; margin-right: -1px\");\n  }\n\n  // See if \"\".split is the broken IE version, if so, provide an\n  // alternative way to split lines.\n  var splitLines = \"\\n\\nb\".split(/\\n/).length != 3 ? function(string) {\n    var pos = 0, result = [], l = string.length;\n    while (pos <= l) {\n      var nl = string.indexOf(\"\\n\", pos);\n      if (nl == -1) nl = string.length;\n      var line = string.slice(pos, string.charAt(nl - 1) == \"\\r\" ? nl - 1 : nl);\n      var rt = line.indexOf(\"\\r\");\n      if (rt != -1) {\n        result.push(line.slice(0, rt));\n        pos += rt + 1;\n      } else {\n        result.push(line);\n        pos = nl + 1;\n      }\n    }\n    return result;\n  } : function(string){return string.split(/\\r\\n?|\\n/);};\n  CodeMirror.splitLines = splitLines;\n\n  var hasSelection = window.getSelection ? function(te) {\n    try { return te.selectionStart != te.selectionEnd; }\n    catch(e) { return false; }\n  } : function(te) {\n    try {var range = te.ownerDocument.selection.createRange();}\n    catch(e) {}\n    if (!range || range.parentElement() != te) return false;\n    return range.compareEndPoints(\"StartToEnd\", range) != 0;\n  };\n\n  var hasCopyEvent = (function() {\n    var e = elt(\"div\");\n    if (\"oncopy\" in e) return true;\n    e.setAttribute(\"oncopy\", \"return;\");\n    return typeof e.oncopy == 'function';\n  })();\n\n  // KEY NAMING\n\n  var keyNames = {3: \"Enter\", 8: \"Backspace\", 9: \"Tab\", 13: \"Enter\", 16: \"Shift\", 17: \"Ctrl\", 18: \"Alt\",\n                  19: \"Pause\", 20: \"CapsLock\", 27: \"Esc\", 32: \"Space\", 33: \"PageUp\", 34: \"PageDown\", 35: \"End\",\n                  36: \"Home\", 37: \"Left\", 38: \"Up\", 39: \"Right\", 40: \"Down\", 44: \"PrintScrn\", 45: \"Insert\",\n                  46: \"Delete\", 59: \";\", 61: \"=\", 91: \"Mod\", 92: \"Mod\", 93: \"Mod\", 107: \"=\", 109: \"-\", 127: \"Delete\",\n                  173: \"-\", 186: \";\", 187: \"=\", 188: \",\", 189: \"-\", 190: \".\", 191: \"/\", 192: \"`\", 219: \"[\", 220: \"\\\\\",\n                  221: \"]\", 222: \"'\", 63232: \"Up\", 63233: \"Down\", 63234: \"Left\", 63235: \"Right\", 63272: \"Delete\",\n                  63273: \"Home\", 63275: \"End\", 63276: \"PageUp\", 63277: \"PageDown\", 63302: \"Insert\"};\n  CodeMirror.keyNames = keyNames;\n  (function() {\n    // Number keys\n    for (var i = 0; i < 10; i++) keyNames[i + 48] = keyNames[i + 96] = String(i);\n    // Alphabetic keys\n    for (var i = 65; i <= 90; i++) keyNames[i] = String.fromCharCode(i);\n    // Function keys\n    for (var i = 1; i <= 12; i++) keyNames[i + 111] = keyNames[i + 63235] = \"F\" + i;\n  })();\n\n  // BIDI HELPERS\n\n  function iterateBidiSections(order, from, to, f) {\n    if (!order) return f(from, to, \"ltr\");\n    var found = false;\n    for (var i = 0; i < order.length; ++i) {\n      var part = order[i];\n      if (part.from < to && part.to > from || from == to && part.to == from) {\n        f(Math.max(part.from, from), Math.min(part.to, to), part.level == 1 ? \"rtl\" : \"ltr\");\n        found = true;\n      }\n    }\n    if (!found) f(from, to, \"ltr\");\n  }\n\n  function bidiLeft(part) { return part.level % 2 ? part.to : part.from; }\n  function bidiRight(part) { return part.level % 2 ? part.from : part.to; }\n\n  function lineLeft(line) { var order = getOrder(line); return order ? bidiLeft(order[0]) : 0; }\n  function lineRight(line) {\n    var order = getOrder(line);\n    if (!order) return line.text.length;\n    return bidiRight(lst(order));\n  }\n\n  function lineStart(cm, lineN) {\n    var line = getLine(cm.doc, lineN);\n    var visual = visualLine(cm.doc, line);\n    if (visual != line) lineN = lineNo(visual);\n    var order = getOrder(visual);\n    var ch = !order ? 0 : order[0].level % 2 ? lineRight(visual) : lineLeft(visual);\n    return Pos(lineN, ch);\n  }\n  function lineEnd(cm, lineN) {\n    var merged, line;\n    while (merged = collapsedSpanAtEnd(line = getLine(cm.doc, lineN)))\n      lineN = merged.find().to.line;\n    var order = getOrder(line);\n    var ch = !order ? line.text.length : order[0].level % 2 ? lineLeft(line) : lineRight(line);\n    return Pos(lineN, ch);\n  }\n\n  function compareBidiLevel(order, a, b) {\n    var linedir = order[0].level;\n    if (a == linedir) return true;\n    if (b == linedir) return false;\n    return a < b;\n  }\n  var bidiOther;\n  function getBidiPartAt(order, pos) {\n    bidiOther = null;\n    for (var i = 0, found; i < order.length; ++i) {\n      var cur = order[i];\n      if (cur.from < pos && cur.to > pos) return i;\n      if ((cur.from == pos || cur.to == pos)) {\n        if (found == null) {\n          found = i;\n        } else if (compareBidiLevel(order, cur.level, order[found].level)) {\n          if (cur.from != cur.to) bidiOther = found;\n          return i;\n        } else {\n          if (cur.from != cur.to) bidiOther = i;\n          return found;\n        }\n      }\n    }\n    return found;\n  }\n\n  function moveInLine(line, pos, dir, byUnit) {\n    if (!byUnit) return pos + dir;\n    do pos += dir;\n    while (pos > 0 && isExtendingChar(line.text.charAt(pos)));\n    return pos;\n  }\n\n  // This is somewhat involved. It is needed in order to move\n  // 'visually' through bi-directional text -- i.e., pressing left\n  // should make the cursor go left, even when in RTL text. The\n  // tricky part is the 'jumps', where RTL and LTR text touch each\n  // other. This often requires the cursor offset to move more than\n  // one unit, in order to visually move one unit.\n  function moveVisually(line, start, dir, byUnit) {\n    var bidi = getOrder(line);\n    if (!bidi) return moveLogically(line, start, dir, byUnit);\n    var pos = getBidiPartAt(bidi, start), part = bidi[pos];\n    var target = moveInLine(line, start, part.level % 2 ? -dir : dir, byUnit);\n\n    for (;;) {\n      if (target > part.from && target < part.to) return target;\n      if (target == part.from || target == part.to) {\n        if (getBidiPartAt(bidi, target) == pos) return target;\n        part = bidi[pos += dir];\n        return (dir > 0) == part.level % 2 ? part.to : part.from;\n      } else {\n        part = bidi[pos += dir];\n        if (!part) return null;\n        if ((dir > 0) == part.level % 2)\n          target = moveInLine(line, part.to, -1, byUnit);\n        else\n          target = moveInLine(line, part.from, 1, byUnit);\n      }\n    }\n  }\n\n  function moveLogically(line, start, dir, byUnit) {\n    var target = start + dir;\n    if (byUnit) while (target > 0 && isExtendingChar(line.text.charAt(target))) target += dir;\n    return target < 0 || target > line.text.length ? null : target;\n  }\n\n  // Bidirectional ordering algorithm\n  // See http://unicode.org/reports/tr9/tr9-13.html for the algorithm\n  // that this (partially) implements.\n\n  // One-char codes used for character types:\n  // L (L):   Left-to-Right\n  // R (R):   Right-to-Left\n  // r (AL):  Right-to-Left Arabic\n  // 1 (EN):  European Number\n  // + (ES):  European Number Separator\n  // % (ET):  European Number Terminator\n  // n (AN):  Arabic Number\n  // , (CS):  Common Number Separator\n  // m (NSM): Non-Spacing Mark\n  // b (BN):  Boundary Neutral\n  // s (B):   Paragraph Separator\n  // t (S):   Segment Separator\n  // w (WS):  Whitespace\n  // N (ON):  Other Neutrals\n\n  // Returns null if characters are ordered as they appear\n  // (left-to-right), or an array of sections ({from, to, level}\n  // objects) in the order in which they occur visually.\n  var bidiOrdering = (function() {\n    // Character types for codepoints 0 to 0xff\n    var lowTypes = \"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLL\";\n    // Character types for codepoints 0x600 to 0x6ff\n    var arabicTypes = \"rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmmrrrrrrrrrrrrrrrrrr\";\n    function charType(code) {\n      if (code <= 0xff) return lowTypes.charAt(code);\n      else if (0x590 <= code && code <= 0x5f4) return \"R\";\n      else if (0x600 <= code && code <= 0x6ff) return arabicTypes.charAt(code - 0x600);\n      else if (0x700 <= code && code <= 0x8ac) return \"r\";\n      else return \"L\";\n    }\n\n    var bidiRE = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;\n    var isNeutral = /[stwN]/, isStrong = /[LRr]/, countsAsLeft = /[Lb1n]/, countsAsNum = /[1n]/;\n    // Browsers seem to always treat the boundaries of block elements as being L.\n    var outerType = \"L\";\n\n    return function(str) {\n      if (!bidiRE.test(str)) return false;\n      var len = str.length, types = [];\n      for (var i = 0, type; i < len; ++i)\n        types.push(type = charType(str.charCodeAt(i)));\n\n      // W1. Examine each non-spacing mark (NSM) in the level run, and\n      // change the type of the NSM to the type of the previous\n      // character. If the NSM is at the start of the level run, it will\n      // get the type of sor.\n      for (var i = 0, prev = outerType; i < len; ++i) {\n        var type = types[i];\n        if (type == \"m\") types[i] = prev;\n        else prev = type;\n      }\n\n      // W2. Search backwards from each instance of a European number\n      // until the first strong type (R, L, AL, or sor) is found. If an\n      // AL is found, change the type of the European number to Arabic\n      // number.\n      // W3. Change all ALs to R.\n      for (var i = 0, cur = outerType; i < len; ++i) {\n        var type = types[i];\n        if (type == \"1\" && cur == \"r\") types[i] = \"n\";\n        else if (isStrong.test(type)) { cur = type; if (type == \"r\") types[i] = \"R\"; }\n      }\n\n      // W4. A single European separator between two European numbers\n      // changes to a European number. A single common separator between\n      // two numbers of the same type changes to that type.\n      for (var i = 1, prev = types[0]; i < len - 1; ++i) {\n        var type = types[i];\n        if (type == \"+\" && prev == \"1\" && types[i+1] == \"1\") types[i] = \"1\";\n        else if (type == \",\" && prev == types[i+1] &&\n                 (prev == \"1\" || prev == \"n\")) types[i] = prev;\n        prev = type;\n      }\n\n      // W5. A sequence of European terminators adjacent to European\n      // numbers changes to all European numbers.\n      // W6. Otherwise, separators and terminators change to Other\n      // Neutral.\n      for (var i = 0; i < len; ++i) {\n        var type = types[i];\n        if (type == \",\") types[i] = \"N\";\n        else if (type == \"%\") {\n          for (var end = i + 1; end < len && types[end] == \"%\"; ++end) {}\n          var replace = (i && types[i-1] == \"!\") || (end < len && types[end] == \"1\") ? \"1\" : \"N\";\n          for (var j = i; j < end; ++j) types[j] = replace;\n          i = end - 1;\n        }\n      }\n\n      // W7. Search backwards from each instance of a European number\n      // until the first strong type (R, L, or sor) is found. If an L is\n      // found, then change the type of the European number to L.\n      for (var i = 0, cur = outerType; i < len; ++i) {\n        var type = types[i];\n        if (cur == \"L\" && type == \"1\") types[i] = \"L\";\n        else if (isStrong.test(type)) cur = type;\n      }\n\n      // N1. A sequence of neutrals takes the direction of the\n      // surrounding strong text if the text on both sides has the same\n      // direction. European and Arabic numbers act as if they were R in\n      // terms of their influence on neutrals. Start-of-level-run (sor)\n      // and end-of-level-run (eor) are used at level run boundaries.\n      // N2. Any remaining neutrals take the embedding direction.\n      for (var i = 0; i < len; ++i) {\n        if (isNeutral.test(types[i])) {\n          for (var end = i + 1; end < len && isNeutral.test(types[end]); ++end) {}\n          var before = (i ? types[i-1] : outerType) == \"L\";\n          var after = (end < len ? types[end] : outerType) == \"L\";\n          var replace = before || after ? \"L\" : \"R\";\n          for (var j = i; j < end; ++j) types[j] = replace;\n          i = end - 1;\n        }\n      }\n\n      // Here we depart from the documented algorithm, in order to avoid\n      // building up an actual levels array. Since there are only three\n      // levels (0, 1, 2) in an implementation that doesn't take\n      // explicit embedding into account, we can build up the order on\n      // the fly, without following the level-based algorithm.\n      var order = [], m;\n      for (var i = 0; i < len;) {\n        if (countsAsLeft.test(types[i])) {\n          var start = i;\n          for (++i; i < len && countsAsLeft.test(types[i]); ++i) {}\n          order.push({from: start, to: i, level: 0});\n        } else {\n          var pos = i, at = order.length;\n          for (++i; i < len && types[i] != \"L\"; ++i) {}\n          for (var j = pos; j < i;) {\n            if (countsAsNum.test(types[j])) {\n              if (pos < j) order.splice(at, 0, {from: pos, to: j, level: 1});\n              var nstart = j;\n              for (++j; j < i && countsAsNum.test(types[j]); ++j) {}\n              order.splice(at, 0, {from: nstart, to: j, level: 2});\n              pos = j;\n            } else ++j;\n          }\n          if (pos < i) order.splice(at, 0, {from: pos, to: i, level: 1});\n        }\n      }\n      if (order[0].level == 1 && (m = str.match(/^\\s+/))) {\n        order[0].from = m[0].length;\n        order.unshift({from: 0, to: m[0].length, level: 0});\n      }\n      if (lst(order).level == 1 && (m = str.match(/\\s+$/))) {\n        lst(order).to -= m[0].length;\n        order.push({from: len - m[0].length, to: len, level: 0});\n      }\n      if (order[0].level != lst(order).level)\n        order.push({from: len, to: len, level: order[0].level});\n\n      return order;\n    };\n  })();\n\n  // THE END\n\n  CodeMirror.version = \"3.22.1\";\n\n  return CodeMirror;\n})();\n","(function() {\n  \"use strict\";\n\n  CodeMirror.showHint = function(cm, getHints, options) {\n    // We want a single cursor position.\n    if (cm.somethingSelected()) return;\n    if (getHints == null) getHints = cm.getHelper(cm.getCursor(), \"hint\");\n    if (getHints == null) return;\n\n    if (cm.state.completionActive) cm.state.completionActive.close();\n\n    var completion = cm.state.completionActive = new Completion(cm, getHints, options || {});\n    CodeMirror.signal(cm, \"startCompletion\", cm);\n    if (completion.options.async)\n      getHints(cm, function(hints) { completion.showHints(hints); }, completion.options);\n    else\n      return completion.showHints(getHints(cm, completion.options));\n  };\n\n  function Completion(cm, getHints, options) {\n    this.cm = cm;\n    this.getHints = getHints;\n    this.options = options;\n    this.widget = this.onClose = null;\n  }\n\n  Completion.prototype = {\n    close: function() {\n      if (!this.active()) return;\n      this.cm.state.completionActive = null;\n\n      if (this.widget) this.widget.close();\n      if (this.onClose) this.onClose();\n      CodeMirror.signal(this.cm, \"endCompletion\", this.cm);\n    },\n\n    active: function() {\n      return this.cm.state.completionActive == this;\n    },\n\n    pick: function(data, i) {\n      var completion = data.list[i];\n      if (completion.hint) completion.hint(this.cm, data, completion);\n      else this.cm.replaceRange(getText(completion), data.from, data.to);\n      this.close();\n    },\n\n    showHints: function(data) {\n      if (!data || !data.list.length || !this.active()) return this.close();\n\n      if (this.options.completeSingle != false && data.list.length == 1)\n        this.pick(data, 0);\n      else\n        this.showWidget(data);\n    },\n\n    showWidget: function(data) {\n      this.widget = new Widget(this, data);\n      CodeMirror.signal(data, \"shown\");\n\n      var debounce = null, completion = this, finished;\n      var closeOn = this.options.closeCharacters || /[\\s()\\[\\]{};:>,-]/;\n      var startPos = this.cm.getCursor(), startLen = this.cm.getLine(startPos.line).length;\n\n      function done() {\n        if (finished) return;\n        finished = true;\n        completion.close();\n        completion.cm.off(\"cursorActivity\", activity);\n        if (data) CodeMirror.signal(data, \"close\");\n      }\n\n      function update() {\n        if (finished) return;\n        CodeMirror.signal(data, \"update\");\n        if (completion.options.async)\n          completion.getHints(completion.cm, finishUpdate, completion.options);\n        else\n          finishUpdate(completion.getHints(completion.cm, completion.options));\n      }\n      function finishUpdate(data_) {\n        data = data_;\n        if (finished) return;\n        if (!data || !data.list.length) return done();\n        completion.widget = new Widget(completion, data);\n      }\n\n      function activity() {\n        clearTimeout(debounce);\n        var pos = completion.cm.getCursor(), line = completion.cm.getLine(pos.line);\n        if (pos.line != startPos.line || line.length - pos.ch != startLen - startPos.ch ||\n            pos.ch < startPos.ch || completion.cm.somethingSelected() ||\n            (pos.ch && closeOn.test(line.charAt(pos.ch - 1)))) {\n          completion.close();\n        } else {\n          debounce = setTimeout(update, 170);\n          if (completion.widget) completion.widget.close();\n        }\n      }\n      this.cm.on(\"cursorActivity\", activity);\n      this.onClose = done;\n    }\n  };\n\n  function getText(completion) {\n    if (typeof completion == \"string\") return completion;\n    else if (typeof completion == \"object\") return completion[0];\n    else return completion.text;\n  }\n\n  function getType(completion) {\n    if (typeof completion == \"object\") return completion[1];\n    else return \"\";\n  }\n\n  function buildKeyMap(options, handle) {\n    var baseMap = {\n      Up: function() {handle.moveFocus(-1);},\n      Down: function() {handle.moveFocus(1);},\n      PageUp: function() {handle.moveFocus(-handle.menuSize());},\n      PageDown: function() {handle.moveFocus(handle.menuSize());},\n      Home: function() {handle.setFocus(0);},\n      End: function() {handle.setFocus(handle.length);},\n      Enter: handle.pick,\n      Tab: handle.pick,\n      Esc: handle.close\n    };\n    var ourMap = options.customKeys ? {} : baseMap;\n    function addBinding(key, val) {\n      var bound;\n      if (typeof val != \"string\")\n        bound = function(cm) { return val(cm, handle); };\n      // This mechanism is deprecated\n      else if (baseMap.hasOwnProperty(val))\n        bound = baseMap[val];\n      else\n        bound = val;\n      ourMap[key] = bound;\n    }\n    if (options.customKeys)\n      for (var key in options.customKeys) if (options.customKeys.hasOwnProperty(key))\n        addBinding(key, options.customKeys[key]);\n    if (options.extraKeys)\n      for (var key in options.extraKeys) if (options.extraKeys.hasOwnProperty(key))\n        addBinding(key, options.extraKeys[key]);\n    return ourMap;\n  }\n\n  function Widget(completion, data) {\n    this.completion = completion;\n    this.data = data;\n    var widget = this, cm = completion.cm, options = completion.options;\n\n    var hints = this.hints = document.createElement(\"ul\");\n    hints.className = \"CodeMirror-hints\";\n    this.selectedHint = 0;\n\n    var completions = data.list;\n    for (var i = 0; i < completions.length; ++i) {\n      var elt = hints.appendChild(document.createElement(\"li\")), cur = getText(completions[i]);\n      var className = \"CodeMirror-hint\" + (i ? \"\" : \" CodeMirror-hint-active\");\n      if (cur.className != null) className = cur.className + \" \" + className;\n      elt.className = className;\n      if (cur.render) cur.render(elt, data, cur);\n      else {\n        var value = document.createElement(\"span\");\n        value.className = (typeof completions[i] == \"string\") ? \"text\" : \"value\";\n        value.innerHTML = cur.displayText || cur;\n        value.title = cur.displayText || cur;\n        value.hintId = i;\n\n        if (getType(completions[i])) {\n          var type = document.createElement(\"span\");\n          type.className = \"type\";\n          type.hintId = i;\n          type.innerHTML = getType(completions[i]);\n          elt.appendChild(type);\n        }\n\n        elt.appendChild(value);\n      }\n      elt.hintId = i;\n    }\n\n    var pos = cm.cursorCoords(options.alignWithWord !== false ? data.from : null);\n    var left = pos.left, top = pos.bottom, below = true;\n    hints.style.left = left + \"px\";\n    hints.style.top = top + \"px\";\n    // If we're at the edge of the screen, then we want the menu to appear on the left of the cursor.\n    var winW = window.innerWidth || Math.max(document.body.offsetWidth, document.documentElement.offsetWidth);\n    var winH = window.innerHeight || Math.max(document.body.offsetHeight, document.documentElement.offsetHeight);\n\n    (options.container || document.body).appendChild(hints);\n\n    var box = hints.getBoundingClientRect();\n    var overlapX = box.right - winW, overlapY = box.bottom - winH;\n    if (overlapX > 0) {\n      if (box.right - box.left > winW) {\n        hints.style.width = (winW - 5) + \"px\";\n        overlapX -= (box.right - box.left) - winW;\n      }\n      hints.style.left = (left = pos.left - overlapX) + \"px\";\n    }\n    if (overlapY > 0) {\n      var height = box.bottom - box.top;\n      if (box.top - (pos.bottom - pos.top) - height > 0) {\n        overlapY = height + (pos.bottom - pos.top);\n        below = false;\n      } else if (height > winH) {\n        hints.style.height = (winH - 5) + \"px\";\n        overlapY -= height - winH;\n      }\n      hints.style.top = (top = pos.bottom - overlapY) + \"px\";\n    }\n\n    cm.addKeyMap(this.keyMap = buildKeyMap(options, {\n      moveFocus: function(n) { widget.changeActive(widget.selectedHint + n); },\n      setFocus: function(n) { widget.changeActive(n); },\n      menuSize: function() { return widget.screenAmount(); },\n      length: completions.length,\n      close: function() { completion.close(); },\n      pick: function() { widget.pick(); }\n    }));\n\n    if (options.closeOnUnfocus !== false) {\n      var closingOnBlur;\n      cm.on(\"blur\", this.onBlur = function() { closingOnBlur = setTimeout(function() { completion.close(); }, 100); });\n      cm.on(\"focus\", this.onFocus = function() { clearTimeout(closingOnBlur); });\n    }\n\n    var startScroll = cm.getScrollInfo();\n    cm.on(\"scroll\", this.onScroll = function() {\n      var curScroll = cm.getScrollInfo(), editor = cm.getWrapperElement().getBoundingClientRect();\n      var newTop = top + startScroll.top - curScroll.top;\n      var point = newTop - (window.pageYOffset || (document.documentElement || document.body).scrollTop);\n      if (!below) point += hints.offsetHeight;\n      if (point <= editor.top || point >= editor.bottom) return completion.close();\n      hints.style.top = newTop + \"px\";\n      hints.style.left = (left + startScroll.left - curScroll.left) + \"px\";\n    });\n\n    CodeMirror.on(hints, \"click\", function(e) {\n      var t = e.target || e.srcElement;\n      if (t.hintId != null) {widget.changeActive(t.hintId); widget.pick();}\n    });\n    CodeMirror.on(hints, \"mouseover\", function(e) {\n      var t = e.target || e.srcElement;\n      if (t.hintId != null) widget.changeActive(t.hintId);\n    });\n    CodeMirror.on(hints, \"mousedown\", function() {\n      setTimeout(function(){cm.focus();}, 20);\n    });\n\n    CodeMirror.signal(data, \"select\", completions[0], hints.firstChild);\n    return true;\n  }\n\n  Widget.prototype = {\n    close: function() {\n      if (this.completion.widget != this) return;\n      this.completion.widget = null;\n      this.hints.parentNode.removeChild(this.hints);\n      this.completion.cm.removeKeyMap(this.keyMap);\n\n      var cm = this.completion.cm;\n      if (this.completion.options.closeOnUnfocus !== false) {\n        cm.off(\"blur\", this.onBlur);\n        cm.off(\"focus\", this.onFocus);\n      }\n      cm.off(\"scroll\", this.onScroll);\n    },\n\n    pick: function() {\n      this.completion.pick(this.data, this.selectedHint);\n    },\n\n    changeActive: function(i) {\n      i = Math.max(0, Math.min(i, this.data.list.length - 1));\n      if (this.selectedHint == i) return;\n      var node = this.hints.childNodes[this.selectedHint];\n      node.className = node.className.replace(\" CodeMirror-hint-active\", \"\");\n      node = this.hints.childNodes[this.selectedHint = i];\n      node.className += \" CodeMirror-hint-active\";\n      if (node.offsetTop < this.hints.scrollTop)\n        this.hints.scrollTop = node.offsetTop - 3;\n      else if (node.offsetTop + node.offsetHeight > this.hints.scrollTop + this.hints.clientHeight)\n        this.hints.scrollTop = node.offsetTop + node.offsetHeight - this.hints.clientHeight + 3;\n      CodeMirror.signal(this.data, \"select\", this.data.list[this.selectedHint], node);\n    },\n\n    screenAmount: function() {\n      return Math.floor(this.hints.clientHeight / this.hints.firstChild.offsetHeight) || 1;\n    }\n  };\n})();\n","(function() {\n  \"use strict\";\n\n  var WORD = /[\\w$]+/, RANGE = 500;\n\n  CodeMirror.registerHelper(\"hint\", \"anyword\", function(editor, options) {\n    var word = options && options.word || WORD;\n    var range = options && options.range || RANGE;\n    var cur = editor.getCursor(), curLine = editor.getLine(cur.line);\n    var start = cur.ch, end = start;\n    while (end < curLine.length && word.test(curLine.charAt(end))) ++end;\n    while (start && word.test(curLine.charAt(start - 1))) --start;\n    var curWord = start != end && curLine.slice(start, end);\n\n    var list = [], seen = {};\n    function scan(dir) {\n      var line = cur.line, end = Math.min(Math.max(line + dir * range, editor.firstLine()), editor.lastLine()) + dir;\n      for (; line != end; line += dir) {\n        var text = editor.getLine(line), m;\n        var re = new RegExp(word.source, \"g\");\n        while (m = re.exec(text)) {\n          if (line == cur.line && m[0] === curWord) continue;\n          if ((!curWord || m[0].indexOf(curWord) == 0) && !seen.hasOwnProperty(m[0])) {\n            seen[m[0]] = true;\n            list.push(m[0]);\n          }\n        }\n      }\n    }\n    scan(-1);\n    scan(1);\n    return {list: list, from: CodeMirror.Pos(cur.line, start), to: CodeMirror.Pos(cur.line, end)};\n  });\n})();\n","\n(function() {\n\n  var Pos = CodeMirror.Pos;\n\n  function forEach(arr, f) {\n    for (var i = 0, e = arr.length; i < e; ++i) f(arr[i]);\n  }\n\n  function arrayContains(arr, item) {\n    if (!Array.prototype.indexOf) {\n      var i = arr.length;\n      while (i--) {\n        if (arr[i] === item) {\n          return true;\n        }\n      }\n      return false;\n    }\n    return arr.indexOf(item) != -1;\n  }\n\n  function scriptHint(editor, keywords, getToken, options) {\n    // Find the token at the cursor\n    var cur = editor.getCursor(),\n        token = getToken(editor, cur),\n        tprop = token;\n    token.state = CodeMirror.innerMode(editor.getMode(), token.state)\n        .state;\n\n    // If it's not a 'word-style' token, ignore the token.\n    if (!/^[\\w$_]*$/.test(token.string)) {\n      token = tprop = {\n        start: cur.ch,\n        end: cur.ch,\n        string: \"\",\n        state: token.state,\n        type: token.string == \".\" ? \"property\" : null\n      };\n    }\n    // If it is a property, find out what it is a property of.\n    while (tprop.type == \"property\") {\n      tprop = getToken(editor, Pos(cur.line, tprop.start));\n      if (tprop.string != \".\") return;\n      tprop = getToken(editor, Pos(cur.line, tprop.start));\n      if (tprop.string == ')') {\n        var level = 1;\n        do {\n          tprop = getToken(editor, Pos(cur.line, tprop.start));\n          switch (tprop.string) {\n          case ')':\n            level++;\n            break;\n          case '(':\n            level--;\n            break;\n          default:\n            break;\n          }\n        } while (level > 0);\n        tprop = getToken(editor, Pos(cur.line, tprop.start));\n        if (tprop.type.indexOf(\"variable\") === 0) tprop.type = \"function\";\n        else return; // no clue\n      }\n      if (!context) var context = [];\n      context.push(tprop);\n    }\n\n    return {\n      list: getCompletions(token, context, keywords, options),\n      from: Pos(cur.line, token.start),\n      to: Pos(cur.line, token.end)\n    };\n  }\n\n  function columnsHint(editor, options) {\n    return scriptHint(editor, [], /* javascriptKeywords */\n      function(e, cur) {\n        return e.getTokenAt(cur);\n      },\n    options);\n  };\n\n\n  CodeMirror.registerHelper(\"hint\", \"custom-list\", columnsHint);\n\n  function getCompletions(token, context, keywords, options) {\n    var found = [],\n        start = token.string;\n\n    function maybeAdd(str) {\n      if (str.indexOf(start) == 0 && start != str && !arrayContains(found, str)) found.push(str);\n    }\n\n    function gatherCompletions(obj) {\n      for (var name in obj) {\n        maybeAdd(obj[name]);\n      }\n    }\n\n    gatherCompletions(options.list);\n    forEach(keywords, maybeAdd);\n\n    return found;\n  }\n})();","\n(function() {\n\n  var Pos = CodeMirror.Pos;\n\n  function forEach(arr, f) {\n    for (var i = 0, e = arr.length; i < e; ++i) f(arr[i]);\n  }\n\n  function arrayContains(arr, item) {\n    if (!Array.prototype.indexOf) {\n      var i = arr.length;\n      while (i--) {\n        if (arr[i] === item) {\n          return true;\n        }\n      }\n      return false;\n    }\n    return arr.indexOf(item) != -1;\n  }\n\n  function scriptHint(editor, keywords, getToken, options) {\n    // Find the token at the cursor\n    var cur = editor.getCursor(),\n        token = getToken(editor, cur),\n        tprop = token;\n    token.state = CodeMirror.innerMode(editor.getMode(), token.state)\n        .state;\n\n    // If it's not a 'word-style' token, ignore the token.\n    if (!/^[\\w$_]*$/.test(token.string)) {\n      token = tprop = {\n        start: cur.ch,\n        end: cur.ch,\n        string: \"\",\n        state: token.state,\n        type: token.string == \".\" ? \"property\" : null\n      };\n    }\n    // If it is a property, find out what it is a property of.\n    while (tprop.type == \"property\") {\n      tprop = getToken(editor, Pos(cur.line, tprop.start));\n      if (tprop.string != \".\") return;\n      tprop = getToken(editor, Pos(cur.line, tprop.start));\n      if (tprop.string == ')') {\n        var level = 1;\n        do {\n          tprop = getToken(editor, Pos(cur.line, tprop.start));\n          switch (tprop.string) {\n          case ')':\n            level++;\n            break;\n          case '(':\n            level--;\n            break;\n          default:\n            break;\n          }\n        } while (level > 0);\n        tprop = getToken(editor, Pos(cur.line, tprop.start));\n        if (tprop.type.indexOf(\"variable\") === 0) tprop.type = \"function\";\n        else return; // no clue\n      }\n      if (!context) var context = [];\n      context.push(tprop);\n    }\n\n    return {\n      list: getCompletions(token, context, keywords, options),\n      from: Pos(cur.line, token.start),\n      to: Pos(cur.line, token.end)\n    };\n  }\n\n  function columnsHint(editor, options) {\n    return scriptHint(editor, [], /* javascriptKeywords */\n      function(e, cur) {\n        return e.getTokenAt(cur);\n      },\n    options);\n  };\n\n\n  CodeMirror.registerHelper(\"hint\", \"custom-list-with-type\", columnsHint);\n\n  function getCompletions(token, context, keywords, options) {\n    var found = [],\n        start = token.string;\n\n    function maybeAdd(str) {\n      if (str[0].indexOf(start) == 0 && start != str[0] && !arrayContains(found, str[0])) found.push(str);\n    }\n\n    function gatherCompletions(obj) {\n      for (var name in obj) {\n        maybeAdd(obj[name]);\n      }\n    }\n\n    gatherCompletions(options.list);\n    forEach(keywords, maybeAdd);\n\n    return found;\n  }\n})();","/*\n\n------------------------------------------------------------------------------\nVersion touched for CartoDB2.0, fork here -> http://github.com/CartoDB/select2\nBranch: cartodb\n------------------------------------------------------------------------------\n\n\nDON'T REPLACE THIS LIBRARY FOR A NEW ONE UNTIL CHECK IT WORKS IN CARTODB\n\nCopyright 2012 Igor Vaynberg\n\nVersion: @@ver@@ Timestamp: @@timestamp@@\n\nThis software is licensed under the Apache License, Version 2.0 (the \"Apache License\") or the GNU\nGeneral Public License version 2 (the \"GPL License\"). You may choose either license to govern your\nuse of this software only upon the condition that you accept all of the terms of either the Apache\nLicense or the GPL License.\n\nYou may obtain a copy of the Apache License and the GPL License at:\n\n    http://www.apache.org/licenses/LICENSE-2.0\n    http://www.gnu.org/licenses/gpl-2.0.html\n\nUnless required by applicable law or agreed to in writing, software distributed under the\nApache License or the GPL Licesnse is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\nCONDITIONS OF ANY KIND, either express or implied. See the Apache License and the GPL License for\nthe specific language governing permissions and limitations under the Apache License and the GPL License.\n*/\n (function ($) {\n  if(typeof $.fn.each2 == \"undefined\"){\n    $.fn.extend({\n      /*\n      * 4-10 times faster .each replacement\n      * use it carefully, as it overrides jQuery context of element on each iteration\n      */\n      each2 : function (c) {\n        var j = $([0]), i = -1, l = this.length;\n        while (\n          ++i < l\n          && (j.context = j[0] = this[i])\n          && c.call(j[0], i, j) !== false //\"this\"=DOM, i=index, j=jQuery object\n        );\n        return this;\n      }\n    });\n  }\n})(jQuery);\n\n(function ($, undefined) {\n    \"use strict\";\n    /*global document, window, jQuery, console */\n\n    if (window.Select2 !== undefined) {\n        return;\n    }\n\n    var KEY, AbstractSelect2, SingleSelect2, MultiSelect2, nextUid, sizer,\n        lastMousePosition, $document;\n\n    KEY = {\n        TAB: 9,\n        ENTER: 13,\n        ESC: 27,\n        SPACE: 32,\n        LEFT: 37,\n        UP: 38,\n        RIGHT: 39,\n        DOWN: 40,\n        SHIFT: 16,\n        CTRL: 17,\n        ALT: 18,\n        PAGE_UP: 33,\n        PAGE_DOWN: 34,\n        HOME: 36,\n        END: 35,\n        BACKSPACE: 8,\n        DELETE: 46,\n        isArrow: function (k) {\n            k = k.which ? k.which : k;\n            switch (k) {\n            case KEY.LEFT:\n            case KEY.RIGHT:\n            case KEY.UP:\n            case KEY.DOWN:\n                return true;\n            }\n            return false;\n        },\n        isControl: function (e) {\n            var k = e.which;\n            switch (k) {\n            case KEY.SHIFT:\n            case KEY.CTRL:\n            case KEY.ALT:\n                return true;\n            }\n\n            if (e.metaKey) return true;\n\n            return false;\n        },\n        isFunctionKey: function (k) {\n            k = k.which ? k.which : k;\n            return k >= 112 && k <= 123;\n        }\n    };\n\n    $document = $(document);\n\n    nextUid=(function() { var counter=1; return function() { return counter++; }; }());\n\n    function indexOf(value, array) {\n        var i = 0, l = array.length, v;\n\n        if (typeof value === \"undefined\") {\n          return -1;\n        }\n\n        if (value.constructor === String) {\n            for (; i < l; i = i + 1) if (value.localeCompare(array[i]) === 0) return i;\n        } else {\n            for (; i < l; i = i + 1) {\n                v = array[i];\n                if (v.constructor === String) {\n                    if (v.localeCompare(value) === 0) return i;\n                } else {\n                    if (v === value) return i;\n                }\n            }\n        }\n        return -1;\n    }\n\n    /**\n     * Compares equality of a and b taking into account that a and b may be strings, in which case localeCompare is used\n     * @param a\n     * @param b\n     */\n    function equal(a, b) {\n        if (a === b) return true;\n        if (a === undefined || b === undefined) return false;\n        if (a === null || b === null) return false;\n        if (a.constructor === String) return a.localeCompare(b) === 0;\n        if (b.constructor === String) return b.localeCompare(a) === 0;\n        return false;\n    }\n\n    /**\n     * Splits the string into an array of values, trimming each value. An empty array is returned for nulls or empty\n     * strings\n     * @param string\n     * @param separator\n     */\n    function splitVal(string, separator) {\n        var val, i, l;\n        if (string === null || string.length < 1) return [];\n        val = string.split(separator);\n        for (i = 0, l = val.length; i < l; i = i + 1) val[i] = $.trim(val[i]);\n        return val;\n    }\n\n    function getSideBorderPadding(element) {\n        return element.outerWidth(false) - element.width();\n    }\n\n    function installKeyUpChangeEvent(element) {\n        var key=\"keyup-change-value\";\n        element.bind(\"keydown\", function () {\n            if ($.data(element, key) === undefined) {\n                $.data(element, key, element.val());\n            }\n        });\n        element.bind(\"keyup\", function () {\n            var val= $.data(element, key);\n            if (val !== undefined && element.val() !== val) {\n                $.removeData(element, key);\n                element.trigger(\"keyup-change\");\n            }\n        });\n    }\n\n    $document.bind(\"mousemove\", function (e) {\n        lastMousePosition = {x: e.pageX, y: e.pageY};\n    });\n\n    /**\n     * filters mouse events so an event is fired only if the mouse moved.\n     *\n     * filters out mouse events that occur when mouse is stationary but\n     * the elements under the pointer are scrolled.\n     */\n    function installFilteredMouseMove(element) {\n      element.bind(\"mousemove\", function (e) {\n            var lastpos = lastMousePosition;\n            if (lastpos === undefined || lastpos.x !== e.pageX || lastpos.y !== e.pageY) {\n                $(e.target).trigger(\"mousemove-filtered\", e);\n            }\n        });\n    }\n\n    /**\n     * Debounces a function. Returns a function that calls the original fn function only if no invocations have been made\n     * within the last quietMillis milliseconds.\n     *\n     * @param quietMillis number of milliseconds to wait before invoking fn\n     * @param fn function to be debounced\n     * @param ctx object to be used as this reference within fn\n     * @return debounced version of fn\n     */\n    function debounce(quietMillis, fn, ctx) {\n        ctx = ctx || undefined;\n        var timeout;\n        return function () {\n            var args = arguments;\n            window.clearTimeout(timeout);\n            timeout = window.setTimeout(function() {\n                fn.apply(ctx, args);\n            }, quietMillis);\n        };\n    }\n\n    /**\n     * A simple implementation of a thunk\n     * @param formula function used to lazily initialize the thunk\n     * @return {Function}\n     */\n    function thunk(formula) {\n        var evaluated = false,\n            value;\n        return function() {\n            if (evaluated === false) { value = formula(); evaluated = true; }\n            return value;\n        };\n    };\n\n    function installDebouncedScroll(threshold, element) {\n        var notify = debounce(threshold, function (e) { element.trigger(\"scroll-debounced\", e);});\n        element.bind(\"scroll\", function (e) {\n            if (indexOf(e.target, element.get()) >= 0) notify(e);\n        });\n    }\n\n    function killEvent(event) {\n        event.preventDefault();\n        event.stopPropagation();\n    }\n    function killEventImmediately(event) {\n        event.preventDefault();\n        event.stopImmediatePropagation();\n    }\n\n    function measureTextWidth(e) {\n        if (!sizer){\n          var style = e[0].currentStyle || window.getComputedStyle(e[0], null);\n          sizer = $(\"<div></div>\").css({\n              position: \"absolute\",\n              left: \"-10000px\",\n              top: \"-10000px\",\n              display: \"none\",\n              fontSize: style.fontSize,\n              fontFamily: style.fontFamily,\n              fontStyle: style.fontStyle,\n              fontWeight: style.fontWeight,\n              letterSpacing: style.letterSpacing,\n              textTransform: style.textTransform,\n              whiteSpace: \"nowrap\"\n          });\n          $(\"body\").append(sizer);\n        }\n        sizer.text(e.val());\n        return sizer.width();\n    }\n\n    function markMatch(text, term, markup) {\n        var match=text.toUpperCase().indexOf(term.toUpperCase()),\n            tl=term.length;\n\n        if (match<0) {\n            markup.push(text);\n            return;\n        }\n\n        markup.push(text.substring(0, match));\n        markup.push(\"<span class='select2-match'>\");\n        markup.push(text.substring(match, match + tl));\n        markup.push(\"</span>\");\n        markup.push(text.substring(match + tl, text.length));\n    }\n\n    /**\n     * Produces an ajax-based query function\n     *\n     * @param options object containing configuration paramters\n     * @param options.transport function that will be used to execute the ajax request. must be compatible with parameters supported by $.ajax\n     * @param options.url url for the data\n     * @param options.data a function(searchTerm, pageNumber, context) that should return an object containing query string parameters for the above url.\n     * @param options.dataType request data type: ajax, jsonp, other datatatypes supported by jQuery's $.ajax function or the transport function if specified\n     * @param options.traditional a boolean flag that should be true if you wish to use the traditional style of param serialization for the ajax request\n     * @param options.quietMillis (optional) milliseconds to wait before making the ajaxRequest, helps debounce the ajax function if invoked too often\n     * @param options.results a function(remoteData, pageNumber) that converts data returned form the remote request to the format expected by Select2.\n     *      The expected format is an object containing the following keys:\n     *      results array of objects that will be used as choices\n     *      more (optional) boolean indicating whether there are more results available\n     *      Example: {results:[{id:1, text:'Red'},{id:2, text:'Blue'}], more:true}\n     */\n    function ajax(options) {\n        var timeout, // current scheduled but not yet executed request\n            requestSequence = 0, // sequence used to drop out-of-order responses\n            handler = null,\n            quietMillis = options.quietMillis || 100;\n\n        return function (query) {\n            window.clearTimeout(timeout);\n            timeout = window.setTimeout(function () {\n                requestSequence += 1; // increment the sequence\n                var requestNumber = requestSequence, // this request's sequence number\n                    data = options.data, // ajax data function\n                    transport = options.transport || $.ajax,\n                    traditional = options.traditional || false,\n                    type = options.type || 'GET'; // set type of request (GET or POST)\n\n                data = data.call(this, query.term, query.page, query.context);\n\n                if( null !== handler) { handler.abort(); }\n\n                handler = transport.call(null, {\n                    url: options.url,\n                    dataType: options.dataType,\n                    data: data,\n                    type: type,\n                    traditional: traditional,\n                    success: function (data) {\n                        if (requestNumber < requestSequence) {\n                            return;\n                        }\n                        // TODO 3.0 - replace query.page with query so users have access to term, page, etc.\n                        var results = options.results(data, query.page);\n                        query.callback(results);\n                    }\n                });\n            }, quietMillis);\n        };\n    }\n\n    /**\n     * Produces a query function that works with a local array\n     *\n     * @param options object containing configuration parameters. The options parameter can either be an array or an\n     * object.\n     *\n     * If the array form is used it is assumed that it contains objects with 'id' and 'text' keys.\n     *\n     * If the object form is used ti is assumed that it contains 'data' and 'text' keys. The 'data' key should contain\n     * an array of objects that will be used as choices. These objects must contain at least an 'id' key. The 'text'\n     * key can either be a String in which case it is expected that each element in the 'data' array has a key with the\n     * value of 'text' which will be used to match choices. Alternatively, text can be a function(item) that can extract\n     * the text.\n     */\n    function local(options) {\n        var data = options, // data elements\n            dataText,\n            text = function (item) { return \"\"+item.text; }; // function used to retrieve the text portion of a data item that is matched against the search\n\n        if (!$.isArray(data)) {\n            text = data.text;\n            // if text is not a function we assume it to be a key name\n            if (!$.isFunction(text)) {\n              dataText = data.text; // we need to store this in a separate variable because in the next step data gets reset and data.text is no longer available\n              text = function (item) { return item[dataText]; };\n            }\n            data = data.results;\n        }\n\n        return function (query) {\n            var t = query.term, filtered = { results: [] }, process;\n            if (t === \"\") {\n                query.callback({results: data});\n                return;\n            }\n\n            process = function(datum, collection) {\n                var group, attr;\n                datum = datum[0];\n                if (datum.children) {\n                    group = {};\n                    for (attr in datum) {\n                        if (datum.hasOwnProperty(attr)) group[attr]=datum[attr];\n                    }\n                    group.children=[];\n                    $(datum.children).each2(function(i, childDatum) { process(childDatum, group.children); });\n                    if (group.children.length || query.matcher(t, text(group))) {\n                        collection.push(group);\n                    }\n                } else {\n                    if (query.matcher(t, text(datum))) {\n                        collection.push(datum);\n                    }\n                }\n            };\n\n            $(data).each2(function(i, datum) { process(datum, filtered.results); });\n            query.callback(filtered);\n        };\n    }\n\n    // TODO javadoc\n    function tags(data) {\n        // TODO even for a function we should probably return a wrapper that does the same object/string check as\n        // the function for arrays. otherwise only functions that return objects are supported.\n        if ($.isFunction(data)) {\n            return data;\n        }\n\n        // if not a function we assume it to be an array\n\n        return function (query) {\n            var t = query.term, filtered = {results: []};\n            $(data).each(function () {\n                var isObject = this.text !== undefined,\n                    text = isObject ? this.text : this;\n                if (t === \"\" || query.matcher(t, text)) {\n                    filtered.results.push(isObject ? this : {id: this, text: this});\n                }\n            });\n            query.callback(filtered);\n        };\n    }\n\n    /**\n     * Checks if the formatter function should be used.\n     *\n     * Throws an error if it is not a function. Returns true if it should be used,\n     * false if no formatting should be performed.\n     *\n     * @param formatter\n     */\n    function checkFormatter(formatter, formatterName) {\n        if ($.isFunction(formatter)) return true;\n        if (!formatter) return false;\n        throw new Error(\"formatterName must be a function or a falsy value\");\n    }\n\n    function evaluate(val) {\n        return $.isFunction(val) ? val() : val;\n    }\n\n    function countResults(results) {\n        var count = 0;\n        $.each(results, function(i, item) {\n            if (item.children) {\n                count += countResults(item.children);\n            } else {\n                count++;\n            }\n        });\n        return count;\n    }\n\n    /**\n     * Default tokenizer. This function uses breaks the input on substring match of any string from the\n     * opts.tokenSeparators array and uses opts.createSearchChoice to create the choice object. Both of those\n     * two options have to be defined in order for the tokenizer to work.\n     *\n     * @param input text user has typed so far or pasted into the search field\n     * @param selection currently selected choices\n     * @param selectCallback function(choice) callback tho add the choice to selection\n     * @param opts select2's opts\n     * @return undefined/null to leave the current input unchanged, or a string to change the input to the returned value\n     */\n    function defaultTokenizer(input, selection, selectCallback, opts) {\n        var original = input, // store the original so we can compare and know if we need to tell the search to update its text\n            dupe = false, // check for whether a token we extracted represents a duplicate selected choice\n            token, // token\n            index, // position at which the separator was found\n            i, l, // looping variables\n            separator; // the matched separator\n\n        if (!opts.createSearchChoice || !opts.tokenSeparators || opts.tokenSeparators.length < 1) return undefined;\n\n        while (true) {\n            index = -1;\n\n            for (i = 0, l = opts.tokenSeparators.length; i < l; i++) {\n                separator = opts.tokenSeparators[i];\n                index = input.indexOf(separator);\n                if (index >= 0) break;\n            }\n\n            if (index < 0) break; // did not find any token separator in the input string, bail\n\n            token = input.substring(0, index);\n            input = input.substring(index + separator.length);\n\n            if (token.length > 0) {\n                token = opts.createSearchChoice(token, selection);\n                if (token !== undefined && token !== null && opts.id(token) !== undefined && opts.id(token) !== null) {\n                    dupe = false;\n                    for (i = 0, l = selection.length; i < l; i++) {\n                        if (equal(opts.id(token), opts.id(selection[i]))) {\n                            dupe = true; break;\n                        }\n                    }\n\n                    if (!dupe) selectCallback(token);\n                }\n            }\n        }\n\n        if (original.localeCompare(input) != 0) return input;\n    }\n\n    /**\n     * blurs any Select2 container that has focus when an element outside them was clicked or received focus\n     *\n     * also takes care of clicks on label tags that point to the source element\n     */\n    $document.ready(function () {\n        $document.bind(\"mousedown touchend\", function (e) {\n            var target = $(e.target).closest(\"div.select2-container\").get(0), attr;\n            if (target) {\n                $document.find(\"div.select2-container-active\").each(function () {\n                    if (this !== target) $(this).data(\"select2\").blur();\n                });\n            } else {\n                target = $(e.target).closest(\"div.select2-drop\").get(0);\n                $document.find(\"div.select2-drop-active\").each(function () {\n                    if (this !== target) $(this).data(\"select2\").blur();\n                });\n            }\n\n            target=$(e.target);\n            attr = target.attr(\"for\");\n            if (\"LABEL\" === e.target.tagName && attr && attr.length > 0) {\n                attr = attr.replace(/([\\[\\].])/g,'\\\\$1'); /* escapes [, ], and . so properly selects the id */\n                target = $(\"#\"+attr);\n                target = target.data(\"select2\");\n                if (target !== undefined) { target.focus(); e.preventDefault();}\n            }\n        });\n    });\n\n    /**\n     * Creates a new class\n     *\n     * @param superClass\n     * @param methods\n     */\n    function clazz(SuperClass, methods) {\n        var constructor = function () {};\n        constructor.prototype = new SuperClass;\n        constructor.prototype.constructor = constructor;\n        constructor.prototype.parent = SuperClass.prototype;\n        constructor.prototype = $.extend(constructor.prototype, methods);\n        return constructor;\n    }\n\n    AbstractSelect2 = clazz(Object, {\n\n        // abstract\n        bind: function (func) {\n            var self = this;\n            return function () {\n                func.apply(self, arguments);\n            };\n        },\n\n        // abstract\n        init: function (opts) {\n            var results, search, free_text, resultsSelector = \".select2-results\";\n\n            // prepare options\n            this.opts = opts = this.prepareOpts(opts);\n\n            this.id=opts.id;\n\n            // destroy if called on an existing component\n            if (opts.element.data(\"select2\") !== undefined &&\n                opts.element.data(\"select2\") !== null) {\n                this.destroy();\n            }\n\n            this.enabled=true;\n            this.container = this.createContainer();\n\n            this.containerId=\"s2id_\"+(opts.element.attr(\"id\") || \"autogen\"+nextUid());\n            this.containerSelector=\"#\"+this.containerId.replace(/([;&,\\.\\+\\*\\~':\"\\!\\^#$%@\\[\\]\\(\\)=>\\|])/g, '\\\\$1');\n            this.container.attr(\"id\", this.containerId);\n\n            // cache the body so future lookups are cheap\n            this.body = thunk(function() { return opts.element.closest(\"body\"); });\n\n            if (opts.element.attr(\"class\") !== undefined) {\n                this.container.addClass(opts.element.attr(\"class\").replace(/validate\\[[\\S ]+] ?/, ''));\n            }\n\n            this.container.css(evaluate(opts.containerCss));\n            this.container.addClass(evaluate(opts.containerCssClass));\n\n            // swap container for the element\n            this.opts.element\n                .data(\"select2\", this)\n                .hide()\n                .before(this.container);\n            this.container.data(\"select2\", this);\n\n            this.dropdown = this.container.find(\".select2-drop\");\n            this.dropdown.addClass(evaluate(opts.dropdownCssClass));\n            this.dropdown.data(\"select2\", this);\n\n            this.results = results = this.container.find(resultsSelector);\n            this.search = search = this.container.find(\"input.select2-input\");\n            this.free_text = free_text = this.container.find(\"input.select2-input-free\");\n\n            search.attr(\"tabIndex\", this.opts.element.attr(\"tabIndex\"));\n\n            this.resultsPage = 0;\n            this.context = null;\n\n            // initialize the container\n            this.initContainer();\n            this.initContainerWidth();\n\n            installFilteredMouseMove(this.results);\n            this.dropdown.delegate(resultsSelector, \"mousemove-filtered\", this.bind(this.highlightUnderEvent));\n\n            installDebouncedScroll(80, this.results);\n            this.dropdown.delegate(resultsSelector, \"scroll-debounced\", this.bind(this.loadMoreIfNeeded));\n\n            // if jquery.mousewheel plugin is installed we can prevent out-of-bounds scrolling of results via mousewheel\n            if ($.fn.mousewheel) {\n                results.mousewheel(function (e, delta, deltaX, deltaY) {\n                    var top = results.scrollTop(), height;\n                    if (deltaY > 0 && top - deltaY <= 0) {\n                        results.scrollTop(0);\n                        killEvent(e);\n                    } else if (deltaY < 0 && results.get(0).scrollHeight - results.scrollTop() + deltaY <= results.height()) {\n                        results.scrollTop(results.get(0).scrollHeight - results.height());\n                        killEvent(e);\n                    }\n                });\n            }\n\n            installKeyUpChangeEvent(search);\n            search.bind(\"keyup-change\", this.bind(this.updateResults));\n            search.bind(\"focus\", function () { search.addClass(\"select2-focused\"); if (search.val() === \" \") search.val(\"\"); });\n            search.bind(\"blur\", function () { search.removeClass(\"select2-focused\");});\n\n            this.dropdown.delegate(resultsSelector, \"mouseup\", this.bind(function (e) {\n                if ($(e.target).closest(\".select2-result-selectable:not(.select2-disabled)\").length > 0) {\n                    this.highlightUnderEvent(e);\n                    this.selectHighlighted(e);\n                } else {\n                    this.focusSearch();\n                }\n                killEvent(e);\n            }));\n\n            // trap all mouse events from leaving the dropdown. sometimes there may be a modal that is listening\n            // for mouse events outside of itself so it can close itself. since the dropdown is now outside the select2's\n            // dom it will trigger the popup close, which is not what we want\n            this.dropdown.bind(\"click mouseup mousedown\", function (e) { e.stopPropagation(); });\n\n            if ($.isFunction(this.opts.initSelection)) {\n                // initialize selection based on the current value of the source element\n                this.initSelection();\n\n                // if the user has provided a function that can set selection based on the value of the source element\n                // we monitor the change event on the element and trigger it, allowing for two way synchronization\n                this.monitorSource();\n            }\n\n            if (opts.element.is(\":disabled\") || opts.element.is(\"[readonly='readonly']\")) this.disable();\n\n            // CartoDB 2.0 custom element ////////////////////////////////////////////////////////////////////////////////\n            if ($(this.container).hasClass(\"color_ramp\")) {\n              try {\n                var color = $(this.container).find(\".select2-choice\").text().replace(/ /g,\"\")\n                  , bucket = $(this.container).attr(\"class\").match(/(\\d)_buckets/)[1]\n                  , html = \"<ul>\"\n                  , colors = cdb.admin.color_ramps[color][bucket];\n\n                for (var j=0, c_l = colors.length; j<c_l; j++) {\n                  var color = colors[j];\n                  html += \"<li style='background:\" + color + \";'></li>\";\n                }\n\n                html += \"</ul>\";\n\n                $(this.container).find('.select2-choice').append(html);\n              } catch(e) {\n                cdb.log.info(\"Failing Select plugin when tries to generate a color ramp dropdown\");\n              }\n            }\n            /////////////////////////////////////////////////////////////////////////////////////////////////////////////\n        },\n\n        // abstract\n        destroy: function () {\n            var select2 = this.opts.element.data(\"select2\");\n            if (select2 !== undefined) {\n                select2.container.remove();\n                select2.dropdown.remove();\n                select2.opts.element\n                    .removeData(\"select2\")\n                    .unbind(\".select2\")\n                    .show();\n            }\n        },\n\n        // abstract\n        prepareOpts: function (opts) {\n            var element, select, idKey, ajaxUrl;\n\n            element = opts.element;\n\n            if (element.get(0).tagName.toLowerCase() === \"select\") {\n                this.select = select = opts.element;\n            }\n\n            if (select) {\n                // these options are not allowed when attached to a select because they are picked up off the element itself\n                $.each([\"id\", \"multiple\", \"ajax\", \"query\", \"createSearchChoice\", \"initSelection\", \"data\", \"tags\"], function () {\n                    if (this in opts) {\n                        throw new Error(\"Option '\" + this + \"' is not allowed for Select2 when attached to a <select> element.\");\n                    }\n                });\n            }\n\n            opts = $.extend({}, {\n                populateResults: function(container, results, query) {\n                    var populate,  data, result, children, id=this.opts.id, self=this;\n\n                    populate=function(results, container, depth) {\n\n                        var i, l, result, disabled, selectable, compound, node, label, innerContainer, formatted;\n                        for (i = 0, l = results.length; i < l; i = i + 1) {\n\n                            result=results[i];\n                            // CartoDB 2.0 custom element ////////////////////////////////////////////////////////////\n                            disabled = $(result.element).is(\":disabled\");\n                            selectable = (!disabled) && (id(result) !== undefined);\n                            //////////////////////////////////////////////////////////////////////////////////////////\n                            compound=result.children && result.children.length > 0;\n\n                            node=$(\"<li></li>\");\n                            node.addClass(\"select2-results-dept-\"+depth);\n                            node.addClass(\"select2-result\");\n                            node.addClass(selectable ? \"select2-result-selectable\" : \"select2-result-unselectable\");\n                            if (compound) { node.addClass(\"select2-result-with-children\"); }\n                            node.addClass(self.opts.formatResultCssClass(result));\n\n                            label=$(\"<div></div>\");\n                            //label.addClass(\"select2-result-label\");\n\n                            // CartoDB 2.0 custom element ////////////////////////////////////////////////////////////\n                            if (!selectable && $(result.element).data(\"message\")) {\n                              var msg = $(result.element).data(\"message\");\n                              node.tipsy({\n                                fade: true,\n                                gravity: 's',\n                                offset: -10,\n                                title: function() {\n                                  return msg\n                                }\n                              })\n                            }\n\n                            label.addClass(\"select2-result-label \" + ( color_ramp ? result.text : '' ));\n                            //////////////////////////////////////////////////////////////////////////////////////////\n\n                            formatted=opts.formatResult(result, label, query);\n                            if (formatted!==undefined) {\n                                label.html(self.opts.escapeMarkup(formatted));\n                            }\n\n                            node.append(label);\n\n                            if (compound) {\n\n                                innerContainer=$(\"<ul></ul>\");\n                                innerContainer.addClass(\"select2-result-sub\");\n                                populate(result.children, innerContainer, depth+1);\n                                node.append(innerContainer);\n                            }\n\n                            // CartoDB 2.0 custom element ////////////////////////////////////////////////////////////\n                            var color_ramp = $(container.prevObject).hasClass(\"color_ramp\");\n\n                            if (color_ramp) {\n\n                              try {\n                                label.html('');\n                                var color = result.text\n                                  , bucket = $(container.prevObject).attr(\"class\").match(/(\\d)_buckets/)[1]\n                                  , html = \"<table><tr>\"\n                                  , colors = cdb.admin.color_ramps[color][bucket];\n\n                                for (var j=0, c_l = colors.length; j<c_l; j++) {\n                                  var color = colors[j];\n                                  html += \"<td class='color' style='background:\" + color + \";'></td>\";\n                                }\n\n                                html += \"</tr></table>\";\n\n                                label.append(html);\n                              } catch(e) {\n                                cdb.log.info(\"Failing Select plugin when tries to generate a color ramp dropdown\");\n                              }\n                            }\n                            //////////////////////////////////////////////////////////////////////////////////////////\n\n                            node.data(\"select2-data\", result);\n                            container.append(node);\n                        }\n                    };\n\n                    populate(results, container, 0);\n                }\n            }, $.fn.select2.defaults, opts);\n\n            if (typeof(opts.id) !== \"function\") {\n                idKey = opts.id;\n                opts.id = function (e) { return e[idKey]; };\n            }\n\n            if (select) {\n                opts.query = this.bind(function (query) {\n                    var data = { results: [], more: false },\n                        term = query.term,\n                        children, firstChild, process;\n\n                    process=function(element, collection) {\n                        var group;\n                        if (element.is(\"option\")) {\n                            if (query.matcher(term, element.text(), element)) {\n                                collection.push({id:element.attr(\"value\"), text:element.text(), element: element.get(), css: element.attr(\"class\")});\n                            }\n                        } else if (element.is(\"optgroup\")) {\n                            group={text:element.attr(\"label\"), children:[], element: element.get(), css: element.attr(\"class\")};\n                            element.children().each2(function(i, elm) { process(elm, group.children); });\n                            if (group.children.length>0) {\n                                collection.push(group);\n                            }\n                        }\n                    };\n\n                    children=element.children();\n\n                    // ignore the placeholder option if there is one\n                    if (this.getPlaceholder() !== undefined && children.length > 0) {\n                        firstChild = children[0];\n                        if ($(firstChild).text() === \"\") {\n                            children=children.not(firstChild);\n                        }\n                    }\n\n                    children.each2(function(i, elm) { process(elm, data.results); });\n\n                    query.callback(data);\n                });\n                // this is needed because inside val() we construct choices from options and there id is hardcoded\n                opts.id=function(e) { return e.id; };\n                opts.formatResultCssClass = function(data) { return data.css; }\n            } else {\n                if (!(\"query\" in opts)) {\n                    if (\"ajax\" in opts) {\n                        ajaxUrl = opts.element.data(\"ajax-url\");\n                        if (ajaxUrl && ajaxUrl.length > 0) {\n                            opts.ajax.url = ajaxUrl;\n                        }\n                        opts.query = ajax(opts.ajax);\n                    } else if (\"data\" in opts) {\n                        opts.query = local(opts.data);\n                    } else if (\"tags\" in opts) {\n                        opts.query = tags(opts.tags);\n                        if (opts.createSearchChoice === undefined) {\n                            opts.createSearchChoice = function (term) { return {id: term, text: term}; };\n                        }\n                        opts.initSelection = function (element, callback) {\n                            var data = [];\n                            $(splitVal(element.val(), opts.separator)).each(function () {\n                                var id = this, text = this, tags=opts.tags;\n                                if ($.isFunction(tags)) tags=tags();\n                                $(tags).each(function() { if (equal(this.id, id)) { text = this.text; return false; } });\n                                data.push({id: id, text: text});\n                            });\n\n                            callback(data);\n                        };\n                    }\n                }\n            }\n            if (typeof(opts.query) !== \"function\") {\n                throw \"query function not defined for Select2 \" + opts.element.attr(\"id\");\n            }\n\n            return opts;\n        },\n\n        /**\n         * Monitor the original element for changes and update select2 accordingly\n         */\n        // abstract\n        monitorSource: function () {\n            this.opts.element.bind(\"change.select2\", this.bind(function (e) {\n                if (this.opts.element.data(\"select2-change-triggered\") !== true) {\n                    this.initSelection();\n                }\n            }));\n        },\n\n        /**\n         * Triggers the change event on the source element\n         */\n        // abstract\n        triggerChange: function (details) {\n\n            details = details || {};\n            details= $.extend({}, details, { type: \"change\", val: this.val() });\n            // prevents recursive triggering\n            this.opts.element.data(\"select2-change-triggered\", true);\n            this.opts.element.trigger(details);\n            this.opts.element.data(\"select2-change-triggered\", false);\n\n            // some validation frameworks ignore the change event and listen instead to keyup, click for selects\n            // so here we trigger the click event manually\n            this.opts.element.click();\n\n            // ValidationEngine ignorea the change event and listens instead to blur\n            // so here we trigger the blur event manually if so desired\n            if (this.opts.blurOnChange)\n                this.opts.element.blur();\n        },\n\n\n        // abstract\n        enable: function() {\n            if (this.enabled) return;\n\n            this.enabled=true;\n            this.container.removeClass(\"select2-container-disabled\");\n            this.opts.element.removeAttr(\"disabled\");\n        },\n\n        // abstract\n        disable: function() {\n            if (!this.enabled) return;\n\n            this.close();\n\n            this.enabled=false;\n            this.container.addClass(\"select2-container-disabled\");\n            this.opts.element.attr(\"disabled\", \"disabled\");\n        },\n\n        // abstract\n        opened: function () {\n            return this.container.hasClass(\"select2-dropdown-open\");\n        },\n\n        // abstract\n        positionDropdown: function() {\n            var offset = this.container.offset(),\n                height = this.container.outerHeight(false),\n                width = this.container.outerWidth(false),\n                dropHeight = this.dropdown.outerHeight(false),\n          viewPortRight = $(window).scrollLeft() + document.documentElement.clientWidth,\n                viewportBottom = $(window).scrollTop() + document.documentElement.clientHeight,\n                dropTop = offset.top + height,\n                dropLeft = offset.left,\n                enoughRoomBelow = dropTop + dropHeight <= viewportBottom,\n                enoughRoomAbove = (offset.top - dropHeight) >= this.body().scrollTop(),\n          dropWidth = this.dropdown.outerWidth(false),\n          enoughRoomOnRight = dropLeft + dropWidth <= viewPortRight,\n                aboveNow = this.dropdown.hasClass(\"select2-drop-above\"),\n                bodyOffset,\n                above,\n                css;\n\n            // console.log(\"below/ droptop:\", dropTop, \"dropHeight\", dropHeight, \"sum\", (dropTop+dropHeight)+\" viewport bottom\", viewportBottom, \"enough?\", enoughRoomBelow);\n            // console.log(\"above/ offset.top\", offset.top, \"dropHeight\", dropHeight, \"top\", (offset.top-dropHeight), \"scrollTop\", this.body().scrollTop(), \"enough?\", enoughRoomAbove);\n\n            // fix positioning when body has an offset and is not position: static\n\n            if (this.body().css('position') !== 'static') {\n                bodyOffset = this.body().offset();\n                dropTop -= bodyOffset.top;\n                dropLeft -= bodyOffset.left;\n            }\n\n            // always prefer the current above/below alignment, unless there is not enough room\n\n            if (aboveNow) {\n                above = true;\n                if (!enoughRoomAbove && enoughRoomBelow) above = false;\n            } else {\n                above = false;\n                if (!enoughRoomBelow && enoughRoomAbove) above = true;\n            }\n\n      if (!enoughRoomOnRight) {\n       dropLeft = offset.left + width - dropWidth;\n      }\n\n            if (above) {\n                dropTop = offset.top - dropHeight;\n                this.container.addClass(\"select2-drop-above\");\n                this.dropdown.addClass(\"select2-drop-above\");\n            }\n            else {\n                this.container.removeClass(\"select2-drop-above\");\n                this.dropdown.removeClass(\"select2-drop-above\");\n            }\n\n            css = $.extend({\n                top: dropTop,\n                left: dropLeft,\n                width: width\n            }, evaluate(this.opts.dropdownCss));\n\n            this.dropdown.css(css);\n        },\n\n        // abstract\n        shouldOpen: function() {\n            var event;\n\n            if (this.opened()) return false;\n\n            event = $.Event(\"open\");\n            this.opts.element.trigger(event);\n            return !event.isDefaultPrevented();\n        },\n\n        // abstract\n        clearDropdownAlignmentPreference: function() {\n            // clear the classes used to figure out the preference of where the dropdown should be opened\n            this.container.removeClass(\"select2-drop-above\");\n            this.dropdown.removeClass(\"select2-drop-above\");\n        },\n\n        /**\n         * Opens the dropdown\n         *\n         * @return {Boolean} whether or not dropdown was opened. This method will return false if, for example,\n         * the dropdown is already open, or if the 'open' event listener on the element called preventDefault().\n         */\n        // abstract\n        open: function () {\n\n            if (!this.shouldOpen()) return false;\n\n            window.setTimeout(this.bind(this.opening), 1);\n\n            return true;\n        },\n\n        /**\n         * Performs the opening of the dropdown\n         */\n        // abstract\n        opening: function() {\n            var cid = this.containerId, selector = this.containerSelector,\n                scroll = \"scroll.\" + cid, resize = \"resize.\" + cid;\n\n            this.container.parents().each(function() {\n                $(this).bind(scroll, function() {\n                    var s2 = $(selector);\n                    if (s2.length == 0) {\n                        $(this).unbind(scroll);\n                    }\n                    s2.select2(\"close\");\n                });\n            });\n\n            window.setTimeout(function() {\n                // this is done inside a timeout because IE will sometimes fire a resize event while opening\n                // the dropdown and that causes this handler to immediately close it. this way the dropdown\n                // has a chance to fully open before we start listening to resize events\n                $(window).bind(resize, function() {\n                    var s2 = $(selector);\n                    if (s2.length == 0) {\n                        $(window).unbind(resize);\n                    }\n                    s2.select2(\"close\");\n                });\n\n                $(window).bind(scroll, function() {\n                    var s2 = $(selector);\n                    if (s2.length == 0) {\n                        $(window).unbind(scroll);\n                    }\n                    s2.select2(\"close\");\n                });\n            }, 10);\n\n            this.clearDropdownAlignmentPreference();\n\n            if (this.search.val() === \" \") { this.search.val(\"\"); }\n\n            this.container.addClass(\"select2-dropdown-open\").addClass(\"select2-container-active\");\n\n            this.updateResults(true);\n\n            if(this.dropdown[0] !== this.body().children().last()[0]) {\n                this.dropdown.detach().appendTo(this.body());\n            }\n\n            this.dropdown.show();\n\n            this.positionDropdown();\n            this.dropdown.addClass(\"select2-drop-active\");\n\n            this.ensureHighlightVisible();\n\n            this.focusSearch();\n        },\n\n        // abstract\n        close: function () {\n            if (!this.opened()) return;\n\n            var self = this;\n\n            this.container.parents().each(function() {\n                $(this).unbind(\"scroll.\" + self.containerId);\n            });\n            $(window).unbind(\"resize.\" + this.containerId);\n            $(window).unbind(\"scroll.\" + this.containerId);\n\n            this.clearDropdownAlignmentPreference();\n\n            this.dropdown.hide();\n            this.container.removeClass(\"select2-dropdown-open\").removeClass(\"select2-container-active\");\n            this.results.empty();\n            this.clearSearch();\n\n            this.opts.element.trigger($.Event(\"close\"));\n        },\n\n        // abstract\n        clearSearch: function () {\n\n        },\n\n        // abstract\n        ensureHighlightVisible: function () {\n            var results = this.results, children, index, child, hb, rb, y, more;\n\n            index = this.highlight();\n\n            if (index < 0) return;\n\n            if (index == 0) {\n\n                // if the first element is highlighted scroll all the way to the top,\n                // that way any unselectable headers above it will also be scrolled\n                // into view\n\n                results.scrollTop(0);\n                return;\n            }\n\n            children = results.find(\".select2-result-selectable\");\n\n            child = $(children[index]);\n\n            hb = child.offset().top + child.outerHeight(true);\n\n            // if this is the last child lets also make sure select2-more-results is visible\n            if (index === children.length - 1) {\n                more = results.find(\"li.select2-more-results\");\n                if (more.length > 0) {\n                    hb = more.offset().top + more.outerHeight(true);\n                }\n            }\n\n            rb = results.offset().top + results.outerHeight(true);\n            if (hb > rb) {\n                results.scrollTop(results.scrollTop() + (hb - rb));\n            }\n            y = child.offset().top - results.offset().top;\n\n            // make sure the top of the element is visible\n            if (y < 0 && child.css('display') != 'none' ) {\n                results.scrollTop(results.scrollTop() + y); // y is negative\n            }\n        },\n\n        // abstract\n        moveHighlight: function (delta) {\n            var choices = this.results.find(\".select2-result-selectable\"),\n                index = this.highlight();\n\n            while (index > -1 && index < choices.length) {\n                index += delta;\n                var choice = $(choices[index]);\n                if (choice.hasClass(\"select2-result-selectable\") && !choice.hasClass(\"select2-disabled\")) {\n                    this.highlight(index);\n                    break;\n                }\n            }\n        },\n\n        // abstract\n        highlight: function (index) {\n            var choices = this.results.find(\".select2-result-selectable\").not(\".select2-disabled\");\n\n            if (arguments.length === 0) {\n                return indexOf(choices.filter(\".select2-highlighted\")[0], choices.get());\n            }\n\n            if (index >= choices.length) index = choices.length - 1;\n            if (index < 0) index = 0;\n\n            choices.removeClass(\"select2-highlighted\");\n\n            $(choices[index]).addClass(\"select2-highlighted\");\n            this.ensureHighlightVisible();\n\n        },\n\n        // abstract\n        countSelectableResults: function() {\n            return this.results.find(\".select2-result-selectable\").not(\".select2-disabled\").length;\n        },\n\n        // abstract\n        highlightUnderEvent: function (event) {\n            var el = $(event.target).closest(\".select2-result-selectable\");\n            if (el.length > 0 && !el.is(\".select2-highlighted\")) {\n            var choices = this.results.find('.select2-result-selectable');\n                this.highlight(choices.index(el));\n            } else if (el.length == 0) {\n                // if we are over an unselectable item remove al highlights\n                this.results.find(\".select2-highlighted\").removeClass(\"select2-highlighted\");\n            }\n        },\n\n        // abstract\n        loadMoreIfNeeded: function () {\n            var results = this.results,\n                more = results.find(\"li.select2-more-results\"),\n                below, // pixels the element is below the scroll fold, below==0 is when the element is starting to be visible\n                offset = -1, // index of first element without data\n                page = this.resultsPage + 1,\n                self=this,\n                term=this.search.val(),\n                context=this.context;\n\n            if (more.length === 0) return;\n            below = more.offset().top - results.offset().top - results.height();\n\n            if (below <= 0) {\n                more.addClass(\"select2-active\");\n                this.opts.query({\n                        term: term,\n                        page: page,\n                        context: context,\n                        matcher: this.opts.matcher,\n                        callback: this.bind(function (data) {\n\n                    // ignore a response if the select2 has been closed before it was received\n                    if (!self.opened()) return;\n\n\n                    self.opts.populateResults.call(this, results, data.results, {term: term, page: page, context:context});\n\n                    if (data.more===true) {\n                        more.detach().appendTo(results).text(self.opts.formatLoadMore(page+1));\n                        window.setTimeout(function() { self.loadMoreIfNeeded(); }, 10);\n                    } else {\n                        more.remove();\n                    }\n                    self.positionDropdown();\n                    self.resultsPage = page;\n                })});\n            }\n        },\n\n        /**\n         * Default tokenizer function which does nothing\n         */\n        tokenize: function() {\n\n        },\n\n        /**\n         * @param initial whether or not this is the call to this method right after the dropdown has been opened\n         */\n        // abstract\n        updateResults: function (initial) {\n            var search = this.search, results = this.results, opts = this.opts, data, self=this, input;\n\n            // if the search is currently hidden we do not alter the results\n            if (initial !== true && (this.showSearchInput === false || !this.opened())) {\n                return;\n            }\n\n            search.addClass(\"select2-active\");\n\n            ///// CartoDB 2.0 ///////////////////////////////////\n            function removeTipsys() {\n              results.find('.select2-result').each(function(i,el){\n                var $el = $(el);\n                var tipsy = $el.data('tipsy');\n                if (tipsy) {\n                  $el\n                    .tipsy('hide')\n                    .unbind('mouseleave mouseenter');\n                }\n              })\n            }\n            ///// CartoDB 2.0 ///////////////////////////////////\n\n            function postRender() {\n                results.scrollTop(0);\n                search.removeClass(\"select2-active\");\n                self.positionDropdown();\n            }\n\n            function render(html) {\n                results.html(self.opts.escapeMarkup(html));\n                postRender();\n            }\n\n            ///// CartoDB 2.0 ///////////////////////////////////\n            removeTipsys();\n            ///// CartoDB 2.0 ///////////////////////////////////\n\n            if (opts.maximumSelectionSize >=1) {\n                data = this.data();\n                if ($.isArray(data) && data.length >= opts.maximumSelectionSize && checkFormatter(opts.formatSelectionTooBig, \"formatSelectionTooBig\")) {\n                  render(\"<li class='select2-selection-limit'>\" + opts.formatSelectionTooBig(opts.maximumSelectionSize) + \"</li>\");\n                  return;\n                }\n            }\n\n            if (search.val().length < opts.minimumInputLength) {\n                if (checkFormatter(opts.formatInputTooShort, \"formatInputTooShort\")) {\n                    render(\"<li class='select2-no-results'>\" + opts.formatInputTooShort(search.val(), opts.minimumInputLength) + \"</li>\");\n                } else {\n                    render(\"\");\n                }\n                return;\n            }\n            else if (opts.formatSearching()) {\n                render(\"<li class='select2-searching'>\" + opts.formatSearching() + \"</li>\");\n            }\n\n            // give the tokenizer a chance to pre-process the input\n            input = this.tokenize();\n            if (input != undefined && input != null) {\n                search.val(input);\n            }\n\n            this.resultsPage = 1;\n            opts.query({\n                    term: search.val(),\n                    page: this.resultsPage,\n                    context: null,\n                    matcher: opts.matcher,\n                    callback: this.bind(function (data) {\n                var def; // default choice\n\n                // ignore a response if the select2 has been closed before it was received\n                if (!this.opened()) return;\n\n                // save context, if any\n                this.context = (data.context===undefined) ? null : data.context;\n\n                // create a default choice and prepend it to the list\n                if (this.opts.createSearchChoice && search.val() !== \"\") {\n                    def = this.opts.createSearchChoice.call(null, search.val(), data.results);\n                    if (def !== undefined && def !== null && self.id(def) !== undefined && self.id(def) !== null) {\n                        if ($(data.results).filter(\n                            function () {\n                                return equal(self.id(this), self.id(def));\n                            }).length === 0) {\n                            data.results.unshift(def);\n                        }\n                    }\n                }\n\n                if (data.results.length === 0 && checkFormatter(opts.formatNoMatches, \"formatNoMatches\")) {\n                    render(\"<li class='select2-no-results'>\" + opts.formatNoMatches(search.val()) + \"</li>\");\n                    return;\n                }\n\n                results.empty();\n                self.opts.populateResults.call(this, results, data.results, {term: search.val(), page: this.resultsPage, context:null});\n\n                if (data.more === true && checkFormatter(opts.formatLoadMore, \"formatLoadMore\")) {\n                    results.append(\"<li class='select2-more-results'>\" + self.opts.escapeMarkup(opts.formatLoadMore(this.resultsPage)) + \"</li>\");\n                    window.setTimeout(function() { self.loadMoreIfNeeded(); }, 10);\n                }\n\n                this.postprocessResults(data, initial);\n\n                postRender();\n            })});\n        },\n\n        // abstract\n        cancel: function () {\n            this.close();\n        },\n\n        // abstract\n        blur: function () {\n            this.close();\n            this.container.removeClass(\"select2-container-active\");\n            this.dropdown.removeClass(\"select2-drop-active\");\n            // synonymous to .is(':focus'), which is available in jquery >= 1.6\n            if (this.search[0] === document.activeElement) { this.search.blur(); }\n            this.clearSearch();\n            this.selection.find(\".select2-search-choice-focus\").removeClass(\"select2-search-choice-focus\");\n            this.opts.element.triggerHandler(\"blur\");\n        },\n\n        // abstract\n        focusSearch: function () {\n            if (this.showSearchInput) {\n                // need to do it here as well as in timeout so it works in IE\n                this.search.show();\n                this.search.focus();\n  \n                /* we do this in a timeout so that current event processing can complete before this code is executed.\n                 this makes sure the search field is focussed even if the current event would blur it */\n                window.setTimeout(this.bind(function () {\n                    // reset the value so IE places the cursor at the end of the input box\n                    this.search.show();\n                    this.search.focus();\n                    this.search.val(this.search.val());\n                }), 10);\n            }\n        },\n\n        // abstract\n        selectHighlighted: function () {\n            var index=this.highlight(),\n                highlighted=this.results.find(\".select2-highlighted\").not(\".select2-disabled\"),\n                data = highlighted.closest('.select2-result-selectable').data(\"select2-data\");\n            if (data) {\n                highlighted.addClass(\"select2-disabled\");\n                this.highlight(index);\n                this.onSelect(data);\n            }\n        },\n\n        // abstract\n        getPlaceholder: function () {\n            return this.opts.element.attr(\"placeholder\") ||\n                this.opts.element.attr(\"data-placeholder\") || // jquery 1.4 compat\n                this.opts.element.data(\"placeholder\") ||\n                this.opts.placeholder;\n        },\n\n        /**\n         * Get the desired width for the container element.  This is\n         * derived first from option `width` passed to select2, then\n         * the inline 'style' on the original element, and finally\n         * falls back to the jQuery calculated element width.\n         */\n        // abstract\n        initContainerWidth: function () {\n            function resolveContainerWidth() {\n                var style, attrs, matches, i, l;\n\n                if (this.opts.width === \"off\") {\n                    return null;\n                } else if (this.opts.width === \"element\"){\n                    return this.opts.element.outerWidth(false) === 0 ? 'auto' : this.opts.element.outerWidth(false) + 'px';\n                } else if (this.opts.width === \"copy\" || this.opts.width === \"resolve\") {\n                    // check if there is inline style on the element that contains width\n                    style = this.opts.element.attr('style');\n                    if (style !== undefined) {\n                        attrs = style.split(';');\n                        for (i = 0, l = attrs.length; i < l; i = i + 1) {\n                            matches = attrs[i].replace(/\\s/g, '')\n                                .match(/width:(([-+]?([0-9]*\\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/);\n                            if (matches !== null && matches.length >= 1)\n                                return matches[1];\n                        }\n                    }\n\n                    if (this.opts.width === \"resolve\") {\n                        // next check if css('width') can resolve a width that is percent based, this is sometimes possible\n                        // when attached to input type=hidden or elements hidden via css\n                        style = this.opts.element.css('width');\n                        if (style.indexOf(\"%\") > 0) return style;\n\n                        // finally, fallback on the calculated width of the element\n                        return (this.opts.element.outerWidth(false) === 0 ? 'auto' : this.opts.element.outerWidth(false) + 'px');\n                    }\n\n                    return null;\n                } else if ($.isFunction(this.opts.width)) {\n                    return this.opts.width();\n                } else {\n                    return this.opts.width;\n               }\n            };\n\n            var width = resolveContainerWidth.call(this);\n            if (width !== null) {\n                this.container.attr(\"style\", \"width: \"+width);\n            }\n        }\n    });\n\n    SingleSelect2 = clazz(AbstractSelect2, {\n\n        // single\n\n    createContainer: function () {\n            var container = $(\"<div></div>\", {\n                \"class\": \"select2-container\"\n            }).html([\n                \"    <a href='javascript:void(0)' onclick='return false;' class='select2-choice'>\",\n                \"   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>\",\n                \"   <div><b></b></div>\" ,\n                \"</a>\",\n                \"    <div class='select2-drop select2-offscreen'>\" ,\n                \"   <div class='select2-search'>\" ,\n                \"       <input type='text' autocomplete='off' class='select2-input'/>\" ,\n                \"   </div>\" ,\n                \"   <ul class='select2-results'>\" ,\n                \"   </ul>\" ,\n                \"   <div class='select2-text'>\" ,\n                \"       <input type='text' placeholder='Free text input' class='select2-input-free'/>\" ,\n                \"       <i class='select2-icon select2-text-icon'></i>\" ,\n                \"   </div>\" ,\n                \"</div>\"].join(\"\"));\n            return container;\n        },\n\n        // single\n        opening: function () {\n            this.search.show();\n            this.parent.opening.apply(this, arguments);\n            this.dropdown.removeClass(\"select2-offscreen\");\n        },\n\n        // single\n        close: function () {\n            if (!this.opened()) return;\n            this.parent.close.apply(this, arguments);\n            this.dropdown.removeAttr(\"style\").addClass(\"select2-offscreen\").insertAfter(this.selection).show();\n        },\n\n        // single\n        focus: function () {\n            this.close();\n            this.selection.focus();\n        },\n\n        // single\n        isFocused: function () {\n            return this.selection[0] === document.activeElement;\n        },\n\n        // single\n        cancel: function () {\n            this.parent.cancel.apply(this, arguments);\n            this.selection.focus();\n        },\n\n        // single\n        initContainer: function () {\n\n            var selection,\n                container = this.container,\n                dropdown = this.dropdown,\n                clickingInside = false;\n\n            this.selection = selection = container.find(\".select2-choice\");\n\n            this.search.bind(\"keydown\", this.bind(function (e) {\n                if (!this.enabled) return;\n\n                if (e.which === KEY.PAGE_UP || e.which === KEY.PAGE_DOWN) {\n                    // prevent the page from scrolling\n                    killEvent(e);\n                    return;\n                }\n\n                if (this.opened()) {\n                    switch (e.which) {\n                        case KEY.UP:\n                        case KEY.DOWN:\n                            this.moveHighlight((e.which === KEY.UP) ? -1 : 1);\n                            killEvent(e);\n                            return;\n                        case KEY.TAB:\n                        case KEY.ENTER:\n                            this.selectHighlighted();\n                            killEvent(e);\n                            return;\n                        case KEY.ESC:\n                            this.cancel(e);\n                            killEvent(e);\n                            return;\n                    }\n                } else {\n\n                    if (e.which === KEY.TAB || KEY.isControl(e) || KEY.isFunctionKey(e) || e.which === KEY.ESC) {\n                        return;\n                    }\n\n                    if (this.opts.openOnEnter === false && e.which === KEY.ENTER) {\n                        return;\n                    }\n\n                    this.open();\n\n                    if (e.which === KEY.ENTER) {\n                        // do not propagate the event otherwise we open, and propagate enter which closes\n                        return;\n                    }\n                }\n            }));\n\n            this.search.bind(\"focus\", this.bind(function() {\n                this.selection.attr(\"tabIndex\", \"-1\");\n            }));\n            this.search.bind(\"blur\", this.bind(function() {\n                if (!this.opened()) this.container.removeClass(\"select2-container-active\");\n                window.setTimeout(this.bind(function() {\n                    // restore original tab index\n                    var ti=this.opts.element.attr(\"tabIndex\");\n                    if (ti) {\n                        this.selection.attr(\"tabIndex\", ti);\n                    } else {\n                        this.selection.removeAttr(\"tabIndex\");\n                    }\n                }), 10);\n            }));\n\n            this.free_text.bind(\"keydown\", this.bind(function (e) {\n                var value = $(e.target).val();\n\n                if (!this.enabled) return;\n\n                if (e.which === KEY.PAGE_UP || e.which === KEY.PAGE_DOWN) {\n                    // prevent the page from scrolling\n                    killEvent(e);\n                    return;\n                }\n\n                if (this.opened()) {\n                    switch (e.which) {\n                        case KEY.UP:\n                        case KEY.DOWN:\n                            killEvent(e);\n                            return;\n                        case KEY.TAB:\n                            return;\n                        case KEY.ENTER:\n                            this.onSelect({ id: value, text: value });\n                            killEvent(e);\n                            return;\n                        case KEY.ESC:\n                            this.cancel(e);\n                            killEvent(e);\n                            return;\n                    }\n                }\n            }));\n\n            selection.delegate(\"abbr\", \"mousedown\", this.bind(function (e) {\n                if (!this.enabled) return;\n                this.clear();\n                killEventImmediately(e);\n                this.close();\n                this.triggerChange();\n                this.selection.focus();\n            }));\n\n            selection.bind(\"mousedown\", this.bind(function (e) {\n                clickingInside = true;\n\n                if (this.opened()) {\n                    this.close();\n                    this.selection.focus();\n                } else if (this.enabled) {\n                    this.open();\n                }\n\n                clickingInside = false;\n            }));\n\n            dropdown.bind(\"mousedown\", this.bind(function() { /*this.search.focus();*/ }));\n\n            selection.bind(\"focus\", this.bind(function() {\n                this.container.addClass(\"select2-container-active\");\n                // hide the search so the tab key does not focus on it\n                this.search.attr(\"tabIndex\", \"-1\");\n            }));\n\n            selection.bind(\"blur\", this.bind(function() {\n                if (!this.opened()) {\n                    this.container.removeClass(\"select2-container-active\");\n                }\n                window.setTimeout(this.bind(function() { this.search.attr(\"tabIndex\", this.opts.element.attr(\"tabIndex\")); }), 10);\n            }));\n\n            selection.bind(\"keydown\", this.bind(function(e) {\n                if (!this.enabled) return;\n\n                if (e.which == KEY.DOWN || e.which == KEY.UP\n                    || (e.which == KEY.ENTER && this.opts.openOnEnter)) {\n                    this.open();\n                    killEvent(e);\n                    return;\n                }\n\n                if (e.which == KEY.DELETE || e.which == KEY.BACKSPACE) {\n                    if (this.opts.allowClear) {\n                        this.clear();\n                    }\n                    killEvent(e);\n                    return;\n                }\n            }));\n            selection.bind(\"keypress\", this.bind(function(e) {\n                var key = String.fromCharCode(e.which);\n                this.search.val(key);\n                this.open();\n            }));\n\n            this.setPlaceholder();\n\n            this.search.bind(\"focus\", this.bind(function() {\n                this.container.addClass(\"select2-container-active\");\n            }));\n        },\n\n        // single\n        clear: function() {\n            this.opts.element.val(\"\");\n            this.selection.find(\"span\").empty();\n            this.selection.removeData(\"select2-data\");\n            this.setPlaceholder();\n        },\n\n        /**\n         * Sets selection based on source element's value\n         */\n        // single\n        initSelection: function () {\n            var selected;\n            if (this.opts.element.val() === \"\" && this.opts.element.text() === \"\") {\n                this.close();\n                this.setPlaceholder();\n            } else {\n                var self = this;\n                this.opts.initSelection.call(null, this.opts.element, function(selected){\n                    if (selected !== undefined && selected !== null) {\n                        self.updateSelection(selected);\n                        self.close();\n                        self.setPlaceholder();\n                    }\n                });\n            }\n        },\n\n        // single\n        prepareOpts: function () {\n            var opts = this.parent.prepareOpts.apply(this, arguments);\n\n            if (opts.element.get(0).tagName.toLowerCase() === \"select\") {\n                // install the selection initializer\n                opts.initSelection = function (element, callback) {\n                    var selected = element.find(\":selected\");\n                    // a single select box always has a value, no need to null check 'selected'\n                    if ($.isFunction(callback))\n                        callback({id: selected.attr(\"value\"), text: selected.text(), element:selected});\n                };\n            }\n\n            return opts;\n        },\n\n        // single\n        setPlaceholder: function () {\n            var placeholder = this.getPlaceholder();\n            var data = this.selection.data(\"select2-data\");\n\n            if (this.opts.element.val() === \"\" && placeholder !== undefined && ( data && !data.id && !data.text )) {\n\n                // check for a first blank option if attached to a select\n                if (this.select && this.select.find(\"option:first\").text() !== \"\") return;\n\n                this.selection.find(\"span\").html(this.opts.escapeMarkup(placeholder));\n\n                this.selection.addClass(\"select2-default\");\n\n                this.selection.find(\"abbr\").hide();\n            }\n        },\n\n        // single\n        postprocessResults: function (data, initial) {\n            var selected = 0, self = this, showSearchInput = true, showFreeTextInput = false;\n\n            // find the selected element in the result list\n\n            this.results.find(\".select2-result-selectable\").each2(function (i, elm) {\n                if (equal(self.id(elm.data(\"select2-data\")), self.opts.element.val())) {\n                    selected = i;\n                    return false;\n                }\n            });\n\n            // and highlight it\n\n            this.highlight(selected);\n\n            // hide the search box if this is the first we got the results and there are a few of them\n\n            if (initial === true) {\n                showSearchInput = this.showSearchInput = countResults(data.results) >= this.opts.minimumResultsForSearch;\n                this.dropdown.find(\".select2-search\")[showSearchInput ? \"removeClass\" : \"addClass\"](\"select2-search-hidden\");\n\n                showFreeTextInput = this.showFreeTextInput = this.opts.freeText;\n                this.dropdown.find(\".select2-text\")[showFreeTextInput ? \"removeClass\" : \"addClass\"](\"select2-search-hidden\");\n\n                //add \"select2-with-searchbox\" to the container if search box is shown\n                $(this.dropdown, this.container)[showSearchInput ? \"addClass\" : \"removeClass\"](\"select2-with-searchbox\");\n            }\n\n        },\n\n        // single\n        onSelect: function (data) {\n            var old = this.opts.element.val();\n\n            this.opts.element.val(this.id(data));\n            this.updateSelection(data);\n            this.close();\n            this.selection.focus();\n\n            if (!equal(old, this.id(data))) { this.triggerChange(); }\n        },\n\n        // single\n        updateSelection: function (data) {\n\n            var container=this.selection.find(\"span\"), formatted;\n\n            this.selection.data(\"select2-data\", data);\n\n            container.empty();\n            formatted=this.opts.formatSelection(data, container);\n            if (formatted !== undefined) {\n                container.append(this.opts.escapeMarkup(formatted));\n            }\n\n            this.selection.removeClass(\"select2-default\");\n\n            if (this.opts.allowClear && this.getPlaceholder() !== undefined) {\n                this.selection.find(\"abbr\").show();\n            }\n        },\n\n        // single\n        val: function () {\n            var val, data = null, self = this;\n\n            if (arguments.length === 0) {\n                return this.opts.element.val();\n            }\n\n            val = arguments[0];\n\n            if (this.select) {\n                this.select\n                    .val(val)\n                    .find(\":selected\").each2(function (i, elm) {\n                        data = {id: elm.attr(\"value\"), text: elm.text()};\n                        return false;\n                    });\n\n                if (!data.id && !data.text) {\n                  data = {id: val, text: val };\n                }\n\n                this.updateSelection(data);\n                this.setPlaceholder();\n            } else {\n                if (this.opts.initSelection === undefined) {\n                    throw new Error(\"cannot call val() if initSelection() is not defined\");\n                }\n                // val is an id. !val is true for [undefined,null,'']\n                if (!val) {\n                    this.clear();\n                    return;\n                }\n                this.opts.element.val(val);\n                this.opts.initSelection(this.opts.element, function(data){\n                    self.opts.element.val(!data ? \"\" : self.id(data));\n                    self.updateSelection(data);\n                    self.setPlaceholder();\n                });\n            }\n        },\n\n        // single\n        clearSearch: function () {\n            this.search.val(\"\");\n        },\n\n        // single\n        data: function(value) {\n            var data;\n\n            if (arguments.length === 0) {\n                data = this.selection.data(\"select2-data\");\n                if (data == undefined) data = null;\n                return data;\n            } else {\n                if (!value || value === \"\") {\n                    this.clear();\n                } else {\n                    this.opts.element.val(!value ? \"\" : this.id(value));\n                    this.updateSelection(value);\n                }\n            }\n        }\n    });\n\n    MultiSelect2 = clazz(AbstractSelect2, {\n\n        // multi\n        createContainer: function () {\n            var container = $(\"<div></div>\", {\n                \"class\": \"select2-container select2-container-multi\"\n            }).html([\n                \"    <ul class='select2-choices'>\",\n                //\"<li class='select2-search-choice'><span>California</span><a href=\"javascript:void(0)\" class=\"select2-search-choice-close\"></a></li>\" ,\n                \"  <li class='select2-search-field'>\" ,\n                \"    <input type='text' autocomplete='off' class='select2-input'>\" ,\n                \"  </li>\" ,\n                \"</ul>\" ,\n                \"<div class='select2-drop select2-drop-multi' style='display:none;'>\" ,\n                \"   <ul class='select2-results'>\" ,\n                \"   </ul>\" ,\n                \"</div>\"].join(\"\"));\n      return container;\n        },\n\n        // multi\n        prepareOpts: function () {\n            var opts = this.parent.prepareOpts.apply(this, arguments);\n\n            // TODO validate placeholder is a string if specified\n\n            if (opts.element.get(0).tagName.toLowerCase() === \"select\") {\n                // install sthe selection initializer\n                opts.initSelection = function (element,callback) {\n\n                    var data = [];\n                    element.find(\":selected\").each2(function (i, elm) {\n                        data.push({id: elm.attr(\"value\"), text: elm.text(), element: elm});\n                    });\n\n                    if ($.isFunction(callback))\n                        callback(data);\n                };\n            }\n\n            return opts;\n        },\n\n        // multi\n        initContainer: function () {\n\n            var selector = \".select2-choices\", selection;\n\n            this.searchContainer = this.container.find(\".select2-search-field\");\n            this.selection = selection = this.container.find(selector);\n\n            this.search.bind(\"keydown\", this.bind(function (e) {\n                if (!this.enabled) return;\n\n                if (e.which === KEY.BACKSPACE && this.search.val() === \"\") {\n                    this.close();\n\n                    var choices,\n                        selected = selection.find(\".select2-search-choice-focus\");\n                    if (selected.length > 0) {\n                        this.unselect(selected.first());\n                        this.search.width(10);\n                        killEvent(e);\n                        return;\n                    }\n\n                    choices = selection.find(\".select2-search-choice:not(.select2-locked)\");\n                    if (choices.length > 0) {\n                        choices.last().addClass(\"select2-search-choice-focus\");\n                    }\n                } else {\n                    selection.find(\".select2-search-choice-focus\").removeClass(\"select2-search-choice-focus\");\n                }\n\n                if (this.opened()) {\n                    switch (e.which) {\n                    case KEY.UP:\n                    case KEY.DOWN:\n                        this.moveHighlight((e.which === KEY.UP) ? -1 : 1);\n                        killEvent(e);\n                        return;\n                    case KEY.ENTER:\n                    case KEY.TAB:\n                        this.selectHighlighted();\n                        killEvent(e);\n                        return;\n                    case KEY.ESC:\n                        this.cancel(e);\n                        killEvent(e);\n                        return;\n                    }\n                }\n\n                if (e.which === KEY.TAB || KEY.isControl(e) || KEY.isFunctionKey(e)\n                 || e.which === KEY.BACKSPACE || e.which === KEY.ESC) {\n                    return;\n                }\n\n                if (this.opts.openOnEnter === false && e.which === KEY.ENTER) {\n                    return;\n                }\n\n                this.open();\n\n                if (e.which === KEY.PAGE_UP || e.which === KEY.PAGE_DOWN) {\n                    // prevent the page from scrolling\n                    killEvent(e);\n                }\n            }));\n\n            this.search.bind(\"keyup\", this.bind(this.resizeSearch));\n\n            this.search.bind(\"blur\", this.bind(function(e) {\n                this.container.removeClass(\"select2-container-active\");\n                this.search.removeClass(\"select2-focused\");\n                this.clearSearch();\n                e.stopImmediatePropagation();\n            }));\n\n            this.container.delegate(selector, \"mousedown\", this.bind(function (e) {\n                if (!this.enabled) return;\n                if ($(e.target).closest(\".select2-search-choice\").length > 0) {\n                    // clicked inside a select2 search choice, do not open\n                    return;\n                }\n                this.clearPlaceholder();\n                this.open();\n                this.focusSearch();\n                e.preventDefault();\n            }));\n\n            this.container.delegate(selector, \"focus\", this.bind(function () {\n                if (!this.enabled) return;\n                this.container.addClass(\"select2-container-active\");\n                this.dropdown.addClass(\"select2-drop-active\");\n                this.clearPlaceholder();\n            }));\n\n            // set the placeholder if necessary\n            this.clearSearch();\n        },\n\n        // multi\n        enable: function() {\n            if (this.enabled) return;\n\n            this.parent.enable.apply(this, arguments);\n\n            this.search.removeAttr(\"disabled\");\n        },\n\n        // multi\n        disable: function() {\n            if (!this.enabled) return;\n\n            this.parent.disable.apply(this, arguments);\n\n            this.search.attr(\"disabled\", true);\n        },\n\n        // multi\n        initSelection: function () {\n            var data;\n            if (this.opts.element.val() === \"\" && this.opts.element.text() === \"\") {\n                this.updateSelection([]);\n                this.close();\n                // set the placeholder if necessary\n                this.clearSearch();\n            }\n            if (this.select || this.opts.element.val() !== \"\") {\n                var self = this;\n                this.opts.initSelection.call(null, this.opts.element, function(data){\n                    if (data !== undefined && data !== null) {\n                        self.updateSelection(data);\n                        self.close();\n                        // set the placeholder if necessary\n                        self.clearSearch();\n                    }\n                });\n            }\n        },\n\n        // multi\n        clearSearch: function () {\n            var placeholder = this.getPlaceholder();\n\n            if (placeholder !== undefined  && this.getVal().length === 0 && this.search.hasClass(\"select2-focused\") === false) {\n                this.search.val(placeholder).addClass(\"select2-default\");\n                // stretch the search box to full width of the container so as much of the placeholder is visible as possible\n                this.resizeSearch();\n            } else {\n                // we set this to \" \" instead of \"\" and later clear it on focus() because there is a firefox bug\n                // that does not properly render the caret when the field starts out blank\n                this.search.val(\" \").width(10);\n            }\n        },\n\n        // multi\n        clearPlaceholder: function () {\n            if (this.search.hasClass(\"select2-default\")) {\n                this.search.val(\"\").removeClass(\"select2-default\");\n            } else {\n                // work around for the space character we set to avoid firefox caret bug\n                if (this.search.val() === \" \") this.search.val(\"\");\n            }\n        },\n\n        // multi\n        opening: function () {\n            this.parent.opening.apply(this, arguments);\n\n            this.clearPlaceholder();\n      this.resizeSearch();\n            this.focusSearch();\n        },\n\n        // multi\n        close: function () {\n            if (!this.opened()) return;\n            this.parent.close.apply(this, arguments);\n        },\n\n        // multi\n        focus: function () {\n            this.close();\n            this.search.focus();\n        },\n\n        // multi\n        isFocused: function () {\n            return this.search.hasClass(\"select2-focused\");\n        },\n\n        // multi\n        updateSelection: function (data) {\n            var ids = [], filtered = [], self = this;\n\n            // filter out duplicates\n            $(data).each(function () {\n                if (indexOf(self.id(this), ids) < 0) {\n                    ids.push(self.id(this));\n                    filtered.push(this);\n                }\n            });\n            data = filtered;\n\n            this.selection.find(\".select2-search-choice\").remove();\n            $(data).each(function () {\n                self.addSelectedChoice(this);\n            });\n            self.postprocessResults();\n        },\n\n        tokenize: function() {\n            var input = this.search.val();\n            input = this.opts.tokenizer(input, this.data(), this.bind(this.onSelect), this.opts);\n            if (input != null && input != undefined) {\n                this.search.val(input);\n                if (input.length > 0) {\n                    this.open();\n                }\n            }\n\n        },\n\n        // multi\n        onSelect: function (data) {\n            this.addSelectedChoice(data);\n            if (this.select || !this.opts.closeOnSelect) this.postprocessResults();\n\n            if (this.opts.closeOnSelect) {\n                this.close();\n                this.search.width(10);\n            } else {\n                if (this.countSelectableResults()>0) {\n                    this.search.width(10);\n                    this.resizeSearch();\n                    this.positionDropdown();\n                } else {\n                    // if nothing left to select close\n                    this.close();\n                }\n            }\n\n            // since its not possible to select an element that has already been\n            // added we do not need to check if this is a new element before firing change\n            this.triggerChange({ added: data });\n\n            this.focusSearch();\n        },\n\n        // multi\n        cancel: function () {\n            this.close();\n            this.focusSearch();\n        },\n\n        addSelectedChoice: function (data) {\n            var enableChoice = !data.locked,\n                enabledItem = $(\n                    \"<li class='select2-search-choice'>\" +\n                    \"    <div></div>\" +\n                    \"    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a>\" +\n                    \"</li>\"),\n                disabledItem = $(\n                    \"<li class='select2-search-choice select2-locked'>\" +\n                    \"<div></div>\" +\n                    \"</li>\");\n            var choice = enableChoice ? enabledItem : disabledItem,\n                id = this.id(data),\n                val = this.getVal(),\n                formatted;\n\n            formatted=this.opts.formatSelection(data, choice.find(\"div\"));\n            if (formatted != undefined) {\n                choice.find(\"div\").replaceWith(\"<div>\"+this.opts.escapeMarkup(formatted)+\"</div>\");\n            }\n\n            if(enableChoice){\n              choice.find(\".select2-search-choice-close\")\n                  .bind(\"mousedown\", killEvent)\n                  .bind(\"click dblclick\", this.bind(function (e) {\n                  if (!this.enabled) return;\n\n                  $(e.target).closest(\".select2-search-choice\").fadeOut('fast', this.bind(function(){\n                      this.unselect($(e.target));\n                      this.selection.find(\".select2-search-choice-focus\").removeClass(\"select2-search-choice-focus\");\n                      this.close();\n                      this.focusSearch();\n                  })).dequeue();\n                  killEvent(e);\n              })).bind(\"focus\", this.bind(function () {\n                  if (!this.enabled) return;\n                  this.container.addClass(\"select2-container-active\");\n                  this.dropdown.addClass(\"select2-drop-active\");\n              }));\n            }\n\n            choice.data(\"select2-data\", data);\n            choice.insertBefore(this.searchContainer);\n\n            val.push(id);\n            this.setVal(val);\n        },\n\n        // multi\n        unselect: function (selected) {\n            var val = this.getVal(),\n                data,\n                index;\n\n            selected = selected.closest(\".select2-search-choice\");\n\n            if (selected.length === 0) {\n                throw \"Invalid argument: \" + selected + \". Must be .select2-search-choice\";\n            }\n\n            data = selected.data(\"select2-data\");\n\n            index = indexOf(this.id(data), val);\n\n            if (index >= 0) {\n                val.splice(index, 1);\n                this.setVal(val);\n                if (this.select) this.postprocessResults();\n            }\n            selected.remove();\n            this.triggerChange({ removed: data });\n        },\n\n        // multi\n        postprocessResults: function () {\n            var val = this.getVal(),\n                choices = this.results.find(\".select2-result-selectable\"),\n                compound = this.results.find(\".select2-result-with-children\"),\n                self = this;\n\n            choices.each2(function (i, choice) {\n                var id = self.id(choice.data(\"select2-data\"));\n                if (indexOf(id, val) >= 0) {\n                    choice.addClass(\"select2-disabled\").removeClass(\"select2-result-selectable\");\n                } else {\n                    choice.removeClass(\"select2-disabled\").addClass(\"select2-result-selectable\");\n                }\n            });\n\n            compound.each2(function(i, e) {\n                if (!e.is('.select2-result-selectable') && e.find(\".select2-result-selectable\").length==0) {  // FIX FOR HIRECHAL DATA\n                    e.addClass(\"select2-disabled\");\n                } else {\n                    e.removeClass(\"select2-disabled\");\n                }\n            });\n\n            if (this.highlight() == -1){\n                choices.each2(function (i, choice) {\n                    if (!choice.hasClass(\"select2-disabled\") && choice.hasClass(\"select2-result-selectable\")) {\n                        self.highlight(0);\n                        return false;\n                    }\n                });\n            }\n\n        },\n\n        // multi\n        resizeSearch: function () {\n\n            var minimumWidth, left, maxWidth, containerLeft, searchWidth,\n              sideBorderPadding = getSideBorderPadding(this.search);\n\n            minimumWidth = measureTextWidth(this.search) + 10;\n\n            left = this.search.offset().left;\n\n            maxWidth = this.selection.width();\n            containerLeft = this.selection.offset().left;\n\n            searchWidth = maxWidth - (left - containerLeft) - sideBorderPadding;\n            if (searchWidth < minimumWidth) {\n                searchWidth = maxWidth - sideBorderPadding;\n            }\n\n            if (searchWidth < 40) {\n                searchWidth = maxWidth - sideBorderPadding;\n            }\n            this.search.width(searchWidth);\n        },\n\n        // multi\n        getVal: function () {\n            var val;\n            if (this.select) {\n                val = this.select.val();\n                return val === null ? [] : val;\n            } else {\n                val = this.opts.element.val();\n                return splitVal(val, this.opts.separator);\n            }\n        },\n\n        // multi\n        setVal: function (val) {\n            var unique;\n            if (this.select) {\n                this.select.val(val);\n            } else {\n                unique = [];\n                // filter out duplicates\n                $(val).each(function () {\n                    if (indexOf(this, unique) < 0) unique.push(this);\n                });\n                this.opts.element.val(unique.length === 0 ? \"\" : unique.join(this.opts.separator));\n            }\n        },\n\n        // multi\n        val: function () {\n            var val, data = [], self=this;\n\n            if (arguments.length === 0) {\n                return this.getVal();\n            }\n\n            val = arguments[0];\n\n            if (!val) {\n                this.opts.element.val(\"\");\n                this.updateSelection([]);\n                this.clearSearch();\n                return;\n            }\n\n            // val is a list of ids\n            this.setVal(val);\n\n            if (this.select) {\n                this.select.find(\":selected\").each(function () {\n                    data.push({id: $(this).attr(\"value\"), text: $(this).text()});\n                });\n                this.updateSelection(data);\n            } else {\n                if (this.opts.initSelection === undefined) {\n                    throw new Error(\"val() cannot be called if initSelection() is not defined\")\n                }\n\n                this.opts.initSelection(this.opts.element, function(data){\n                    var ids=$(data).map(self.id);\n                    self.setVal(ids);\n                    self.updateSelection(data);\n                    self.clearSearch();\n                });\n            }\n            this.clearSearch();\n        },\n\n        // multi\n        onSortStart: function() {\n            if (this.select) {\n                throw new Error(\"Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.\");\n            }\n\n            // collapse search field into 0 width so its container can be collapsed as well\n            this.search.width(0);\n            // hide the container\n            this.searchContainer.hide();\n        },\n\n        // multi\n        onSortEnd:function() {\n\n            var val=[], self=this;\n\n            // show search and move it to the end of the list\n            this.searchContainer.show();\n            // make sure the search container is the last item in the list\n            this.searchContainer.appendTo(this.searchContainer.parent());\n            // since we collapsed the width in dragStarted, we resize it here\n            this.resizeSearch();\n\n            // update selection\n\n            this.selection.find(\".select2-search-choice\").each(function() {\n                val.push(self.opts.id($(this).data(\"select2-data\")));\n            });\n            this.setVal(val);\n            this.triggerChange();\n        },\n\n        // multi\n        data: function(values) {\n            var self=this, ids;\n            if (arguments.length === 0) {\n                 return this.selection\n                     .find(\".select2-search-choice\")\n                     .map(function() { return $(this).data(\"select2-data\"); })\n                     .get();\n            } else {\n                if (!values) { values = []; }\n                ids = $.map(values, function(e) { return self.opts.id(e)});\n                this.setVal(ids);\n                this.updateSelection(values);\n                this.clearSearch();\n            }\n        }\n    });\n\n    $.fn.select2 = function () {\n\n        var args = Array.prototype.slice.call(arguments, 0),\n            opts,\n            select2,\n            value, multiple, allowedMethods = [\"val\", \"destroy\", \"opened\", \"open\", \"close\", \"focus\", \"isFocused\", \"container\", \"onSortStart\", \"onSortEnd\", \"enable\", \"disable\", \"positionDropdown\", \"data\"];\n\n        this.each(function () {\n            if (args.length === 0 || typeof(args[0]) === \"object\") {\n                opts = args.length === 0 ? {} : $.extend({}, args[0]);\n                opts.element = $(this);\n\n                if (opts.element.get(0).tagName.toLowerCase() === \"select\") {\n                    multiple = opts.element.attr(\"multiple\");\n                } else {\n                    multiple = opts.multiple || false;\n                    if (\"tags\" in opts) {opts.multiple = multiple = true;}\n                }\n\n                select2 = multiple ? new MultiSelect2() : new SingleSelect2();\n                select2.init(opts);\n            } else if (typeof(args[0]) === \"string\") {\n\n                if (indexOf(args[0], allowedMethods) < 0) {\n                    throw \"Unknown method: \" + args[0];\n                }\n\n                value = undefined;\n                select2 = $(this).data(\"select2\");\n                if (select2 === undefined) return;\n                if (args[0] === \"container\") {\n                    value=select2.container;\n                } else {\n                    value = select2[args[0]].apply(select2, args.slice(1));\n                }\n                if (value !== undefined) {return false;}\n            } else {\n                throw \"Invalid arguments to select2 plugin: \" + args;\n            }\n        });\n        return (value === undefined) ? this : value;\n    };\n\n    // plugin defaults, accessible to users\n    $.fn.select2.defaults = {\n        width: \"copy\",\n        closeOnSelect: true,\n        openOnEnter: true,\n        containerCss: {},\n        dropdownCss: {},\n        containerCssClass: \"\",\n        dropdownCssClass: \"\",\n        formatResult: function(result, container, query) {\n            var markup=[];\n            markMatch(result.text, query.term, markup);\n            return markup.join(\"\");\n        },\n        formatSelection: function (data, container) {\n            return data ? data.text : undefined;\n        },\n        formatResultCssClass: function(data) {return undefined;},\n        formatNoMatches: function () { return \"No matches found\"; },\n        formatInputTooShort: function (input, min) { var n = min - input.length; return \"Please enter \" + n + \" more character\" + (n == 1? \"\" : \"s\"); },\n        formatSelectionTooBig: function (limit) { return \"You can only select \" + limit + \" item\" + (limit == 1 ? \"\" : \"s\"); },\n        formatLoadMore: function (pageNumber) { return \"Loading more results...\"; },\n        formatSearching: function () { return \"Searching...\"; },\n        minimumResultsForSearch: 0,\n        minimumInputLength: 0,\n        maximumSelectionSize: 0,\n        id: function (e) { return e.id; },\n        matcher: function(term, text) {\n            return text.toUpperCase().indexOf(term.toUpperCase()) >= 0;\n        },\n        separator: \",\",\n        tokenSeparators: [],\n        tokenizer: defaultTokenizer,\n        escapeMarkup: function (markup) {\n            if (markup && typeof(markup) === \"string\") {\n                return markup.replace(/&/g, \"&amp;\");\n            }\n            return markup;\n        },\n        blurOnChange: false\n    };\n\n    // exports\n    window.Select2 = {\n        query: {\n            ajax: ajax,\n            local: local,\n            tags: tags\n        }, util: {\n            debounce: debounce,\n            markMatch: markMatch\n        }, \"class\": {\n            \"abstract\": AbstractSelect2,\n            \"single\": SingleSelect2,\n            \"multi\": MultiSelect2\n        }\n    };\n\n}(jQuery));\n","/**\n * jQuery Favicon Notify\n *\n * Updates the favicon to notify the user of changes. In the original tests I\n * had an embedded font collection to allow any charachers - I decided that the\n * ~130Kb and added complexity was overkill. As such it now uses a manual glyph\n * set meaning that only numerical notifications are possible.\n *\n * Dual licensed under the MIT and GPL licenses:\n *\n *    http://www.opensource.org/licenses/mit-license.php\n *    http://www.gnu.org/licenses/gpl.html\n *\n * @author    David King\n * @copyright Copyright (c) 2011 +\n * @url     oodavid.com\n */\n(function($){\n    var canvas;\n    var bg    = '#000000';\n    var fg    = '#FFFFFF';\n    var pos   = 'br';\n  var glyphs  = [\n    [\n      '  ---  ',\n      ' -@@@- ',\n      '-@---@-',\n      '-@- -@-',\n      '-@- -@-',\n      '-@- -@-',\n      '-@---@-',\n      ' -@@@- ',\n      '  ---  '\n    ],[\n      '  -  ',\n      ' -@- ',\n      '-@@- ',\n      ' -@- ',\n      ' -@- ',\n      ' -@- ',\n      ' -@- ',\n      '-@@@-',\n      ' --- '\n    ],[\n      '  ---  ',\n      ' -@@@- ',\n      '-@---@-',\n      ' - --@-',\n      '  -@@- ',\n      ' -@--  ',\n      '-@---- ',\n      '-@@@@@-',\n      ' ----- '\n    ],[\n      '  ---  ',\n      ' -@@@- ',\n      '-@---@-',\n      ' - --@-',\n      '  -@@- ',\n      ' - --@-',\n      '-@---@-',\n      ' -@@@- ',\n      '  ---  '\n    ],[\n      '    -- ',\n      '   -@@-',\n      '  -@-@-',\n      ' -@--@-',\n      '-@---@-',\n      '-@@@@@-',\n      ' ----@-',\n      '    -@-',\n      '     - '\n    ],[\n      ' ----- ',\n      '-@@@@@-',\n      '-@---- ',\n      '-@---  ',\n      '-@@@@- ',\n      ' ----@-',\n      '-@---@-',\n      ' -@@@- ',\n      '  ---  '\n    ],[\n      '  ---  ',\n      ' -@@@- ',\n      '-@---@-',\n      '-@---- ',\n      '-@@@@- ',\n      '-@---@-',\n      '-@---@-',\n      ' -@@@- ',\n      '  ---  '\n    ],[\n      ' ----- ',\n      '-@@@@@-',\n      ' ----@-',\n      '   -@- ',\n      '   -@- ',\n      '  -@-  ',\n      '  -@-  ',\n      '  -@-  ',\n      '   -   '\n    ],[\n      '  ---  ',\n      ' -@@@- ',\n      '-@---@-',\n      '-@---@-',\n      ' -@@@- ',\n      '-@---@-',\n      '-@---@-',\n      ' -@@@- ',\n      '  ---  '\n    ],[\n      '  ---  ',\n      ' -@@@- ',\n      '-@---@-',\n      '-@---@-',\n      ' -@@@@-',\n      ' ----@-',\n      '-@---@-',\n      ' -@@@- ',\n      '  ---  '\n    ],[\n      ' - ',\n      '-@-',\n      '-@-',\n      '-@-',\n      '-@-',\n      '-@-',\n      ' - ',\n      '-@-',\n      ' - '\n    ]\n  ];\n  $.faviconNotify = function(icon, num, myPos, myBg, myFg){\n    // Use the correct options\n    myPos = myPos || pos;\n    myFg  = myFg  || fg;\n    myBg  = myBg  || bg;\n    // Create a canvas if we need one\n    canvas = canvas || $('<canvas />')[0];\n    if (canvas.getContext) {\n      // Load the favicon and manipulate it once it's loaded\n      var img = $('<img />')[0];\n      img.onload = function () {\n        // Get the canvas ready and fill with the original icon\n        canvas.height = canvas.width = 16;\n        var ctx = canvas.getContext('2d');\n        ctx.drawImage(this, 0, 0);\n        // We gots num?\n        if(num != undefined){\n          // Convert the num into a glyphs array\n          if(num > 99){\n            var myGlyphs = [glyphs[9], glyphs[9], glyphs[10]];\n          } else {\n            var myGlyphs = [];\n            num = num.toString();\n            $.each(num, function(k,v){\n              myGlyphs.push(glyphs[v]);\n            });\n          }\n          // Merge the glyphs together\n          var combined = [];\n          var glyphHeight = myGlyphs[0].length;\n          $.each(myGlyphs, function(k,v){\n            for(y=0; y<glyphHeight; y++){\n              // First pass?\n              if(combined[y] == undefined) {\n                combined[y] = v[y];\n              } else {\n                // Merge the glyph parts, careful of the boundaries\n                var l = combined[y].length;\n                if(combined[y][(l-1)] == ' '){\n                  combined[y] = combined[y].substring(0, (l-1)) + v[y];\n                } else {\n                  combined[y] += v[y].substring(1);\n                }\n              }\n            }\n          });\n          // Figure out our starting position\n          var glyphWidth = combined[0].length;\n          var x = (myPos.indexOf('l') != -1) ? 0 : (16 - glyphWidth);\n          var y = (myPos.indexOf('t') != -1) ? 0 : (16 - glyphHeight);\n          // Draw them pixels!\n          for(dX=0; dX<glyphWidth; dX++){\n            for(dY=0; dY<glyphHeight; dY++){\n              var pixel = combined[dY][dX];\n              if(pixel != ' '){\n                ctx.fillStyle = (pixel == '@') ? myFg : myBg;\n                ctx.fillRect((x+dX), (y+dY), 1, 1);\n              }\n            }\n          }\n        }\n        // Update the favicon\n        $('link[rel$=icon]').replaceWith('');\n        $('head').append($('<link rel=\"shortcut icon\" type=\"image/x-icon\"/>').attr('href', canvas.toDataURL('image/png')));\n      };\n      img.src = icon;\n    }\n  };\n\n})(jQuery);","(function(exports){\ncrossfilter.version = \"1.3.11\";\nfunction crossfilter_identity(d) {\n  return d;\n}\ncrossfilter.permute = permute;\n\nfunction permute(array, index) {\n  for (var i = 0, n = index.length, copy = new Array(n); i < n; ++i) {\n    copy[i] = array[index[i]];\n  }\n  return copy;\n}\nvar bisect = crossfilter.bisect = bisect_by(crossfilter_identity);\n\nbisect.by = bisect_by;\n\nfunction bisect_by(f) {\n\n  // Locate the insertion point for x in a to maintain sorted order. The\n  // arguments lo and hi may be used to specify a subset of the array which\n  // should be considered; by default the entire array is used. If x is already\n  // present in a, the insertion point will be before (to the left of) any\n  // existing entries. The return value is suitable for use as the first\n  // argument to `array.splice` assuming that a is already sorted.\n  //\n  // The returned insertion point i partitions the array a into two halves so\n  // that all v < x for v in a[lo:i] for the left side and all v >= x for v in\n  // a[i:hi] for the right side.\n  function bisectLeft(a, x, lo, hi) {\n    while (lo < hi) {\n      var mid = lo + hi >>> 1;\n      if (f(a[mid]) < x) lo = mid + 1;\n      else hi = mid;\n    }\n    return lo;\n  }\n\n  // Similar to bisectLeft, but returns an insertion point which comes after (to\n  // the right of) any existing entries of x in a.\n  //\n  // The returned insertion point i partitions the array into two halves so that\n  // all v <= x for v in a[lo:i] for the left side and all v > x for v in\n  // a[i:hi] for the right side.\n  function bisectRight(a, x, lo, hi) {\n    while (lo < hi) {\n      var mid = lo + hi >>> 1;\n      if (x < f(a[mid])) hi = mid;\n      else lo = mid + 1;\n    }\n    return lo;\n  }\n\n  bisectRight.right = bisectRight;\n  bisectRight.left = bisectLeft;\n  return bisectRight;\n}\nvar heap = crossfilter.heap = heap_by(crossfilter_identity);\n\nheap.by = heap_by;\n\nfunction heap_by(f) {\n\n  // Builds a binary heap within the specified array a[lo:hi]. The heap has the\n  // property such that the parent a[lo+i] is always less than or equal to its\n  // two children: a[lo+2*i+1] and a[lo+2*i+2].\n  function heap(a, lo, hi) {\n    var n = hi - lo,\n        i = (n >>> 1) + 1;\n    while (--i > 0) sift(a, i, n, lo);\n    return a;\n  }\n\n  // Sorts the specified array a[lo:hi] in descending order, assuming it is\n  // already a heap.\n  function sort(a, lo, hi) {\n    var n = hi - lo,\n        t;\n    while (--n > 0) t = a[lo], a[lo] = a[lo + n], a[lo + n] = t, sift(a, 1, n, lo);\n    return a;\n  }\n\n  // Sifts the element a[lo+i-1] down the heap, where the heap is the contiguous\n  // slice of array a[lo:lo+n]. This method can also be used to update the heap\n  // incrementally, without incurring the full cost of reconstructing the heap.\n  function sift(a, i, n, lo) {\n    var d = a[--lo + i],\n        x = f(d),\n        child;\n    while ((child = i << 1) <= n) {\n      if (child < n && f(a[lo + child]) > f(a[lo + child + 1])) child++;\n      if (x <= f(a[lo + child])) break;\n      a[lo + i] = a[lo + child];\n      i = child;\n    }\n    a[lo + i] = d;\n  }\n\n  heap.sort = sort;\n  return heap;\n}\nvar heapselect = crossfilter.heapselect = heapselect_by(crossfilter_identity);\n\nheapselect.by = heapselect_by;\n\nfunction heapselect_by(f) {\n  var heap = heap_by(f);\n\n  // Returns a new array containing the top k elements in the array a[lo:hi].\n  // The returned array is not sorted, but maintains the heap property. If k is\n  // greater than hi - lo, then fewer than k elements will be returned. The\n  // order of elements in a is unchanged by this operation.\n  function heapselect(a, lo, hi, k) {\n    var queue = new Array(k = Math.min(hi - lo, k)),\n        min,\n        i,\n        x,\n        d;\n\n    for (i = 0; i < k; ++i) queue[i] = a[lo++];\n    heap(queue, 0, k);\n\n    if (lo < hi) {\n      min = f(queue[0]);\n      do {\n        if (x = f(d = a[lo]) > min) {\n          queue[0] = d;\n          min = f(heap(queue, 0, k)[0]);\n        }\n      } while (++lo < hi);\n    }\n\n    return queue;\n  }\n\n  return heapselect;\n}\nvar insertionsort = crossfilter.insertionsort = insertionsort_by(crossfilter_identity);\n\ninsertionsort.by = insertionsort_by;\n\nfunction insertionsort_by(f) {\n\n  function insertionsort(a, lo, hi) {\n    for (var i = lo + 1; i < hi; ++i) {\n      for (var j = i, t = a[i], x = f(t); j > lo && f(a[j - 1]) > x; --j) {\n        a[j] = a[j - 1];\n      }\n      a[j] = t;\n    }\n    return a;\n  }\n\n  return insertionsort;\n}\n// Algorithm designed by Vladimir Yaroslavskiy.\n// Implementation based on the Dart project; see lib/dart/LICENSE for details.\n\nvar quicksort = crossfilter.quicksort = quicksort_by(crossfilter_identity);\n\nquicksort.by = quicksort_by;\n\nfunction quicksort_by(f) {\n  var insertionsort = insertionsort_by(f);\n\n  function sort(a, lo, hi) {\n    return (hi - lo < quicksort_sizeThreshold\n        ? insertionsort\n        : quicksort)(a, lo, hi);\n  }\n\n  function quicksort(a, lo, hi) {\n    // Compute the two pivots by looking at 5 elements.\n    var sixth = (hi - lo) / 6 | 0,\n        i1 = lo + sixth,\n        i5 = hi - 1 - sixth,\n        i3 = lo + hi - 1 >> 1,  // The midpoint.\n        i2 = i3 - sixth,\n        i4 = i3 + sixth;\n\n    var e1 = a[i1], x1 = f(e1),\n        e2 = a[i2], x2 = f(e2),\n        e3 = a[i3], x3 = f(e3),\n        e4 = a[i4], x4 = f(e4),\n        e5 = a[i5], x5 = f(e5);\n\n    var t;\n\n    // Sort the selected 5 elements using a sorting network.\n    if (x1 > x2) t = e1, e1 = e2, e2 = t, t = x1, x1 = x2, x2 = t;\n    if (x4 > x5) t = e4, e4 = e5, e5 = t, t = x4, x4 = x5, x5 = t;\n    if (x1 > x3) t = e1, e1 = e3, e3 = t, t = x1, x1 = x3, x3 = t;\n    if (x2 > x3) t = e2, e2 = e3, e3 = t, t = x2, x2 = x3, x3 = t;\n    if (x1 > x4) t = e1, e1 = e4, e4 = t, t = x1, x1 = x4, x4 = t;\n    if (x3 > x4) t = e3, e3 = e4, e4 = t, t = x3, x3 = x4, x4 = t;\n    if (x2 > x5) t = e2, e2 = e5, e5 = t, t = x2, x2 = x5, x5 = t;\n    if (x2 > x3) t = e2, e2 = e3, e3 = t, t = x2, x2 = x3, x3 = t;\n    if (x4 > x5) t = e4, e4 = e5, e5 = t, t = x4, x4 = x5, x5 = t;\n\n    var pivot1 = e2, pivotValue1 = x2,\n        pivot2 = e4, pivotValue2 = x4;\n\n    // e2 and e4 have been saved in the pivot variables. They will be written\n    // back, once the partitioning is finished.\n    a[i1] = e1;\n    a[i2] = a[lo];\n    a[i3] = e3;\n    a[i4] = a[hi - 1];\n    a[i5] = e5;\n\n    var less = lo + 1,   // First element in the middle partition.\n        great = hi - 2;  // Last element in the middle partition.\n\n    // Note that for value comparison, <, <=, >= and > coerce to a primitive via\n    // Object.prototype.valueOf; == and === do not, so in order to be consistent\n    // with natural order (such as for Date objects), we must do two compares.\n    var pivotsEqual = pivotValue1 <= pivotValue2 && pivotValue1 >= pivotValue2;\n    if (pivotsEqual) {\n\n      // Degenerated case where the partitioning becomes a dutch national flag\n      // problem.\n      //\n      // [ |  < pivot  | == pivot | unpartitioned | > pivot  | ]\n      //  ^             ^          ^             ^            ^\n      // left         less         k           great         right\n      //\n      // a[left] and a[right] are undefined and are filled after the\n      // partitioning.\n      //\n      // Invariants:\n      //   1) for x in ]left, less[ : x < pivot.\n      //   2) for x in [less, k[ : x == pivot.\n      //   3) for x in ]great, right[ : x > pivot.\n      for (var k = less; k <= great; ++k) {\n        var ek = a[k], xk = f(ek);\n        if (xk < pivotValue1) {\n          if (k !== less) {\n            a[k] = a[less];\n            a[less] = ek;\n          }\n          ++less;\n        } else if (xk > pivotValue1) {\n\n          // Find the first element <= pivot in the range [k - 1, great] and\n          // put [:ek:] there. We know that such an element must exist:\n          // When k == less, then el3 (which is equal to pivot) lies in the\n          // interval. Otherwise a[k - 1] == pivot and the search stops at k-1.\n          // Note that in the latter case invariant 2 will be violated for a\n          // short amount of time. The invariant will be restored when the\n          // pivots are put into their final positions.\n          while (true) {\n            var greatValue = f(a[great]);\n            if (greatValue > pivotValue1) {\n              great--;\n              // This is the only location in the while-loop where a new\n              // iteration is started.\n              continue;\n            } else if (greatValue < pivotValue1) {\n              // Triple exchange.\n              a[k] = a[less];\n              a[less++] = a[great];\n              a[great--] = ek;\n              break;\n            } else {\n              a[k] = a[great];\n              a[great--] = ek;\n              // Note: if great < k then we will exit the outer loop and fix\n              // invariant 2 (which we just violated).\n              break;\n            }\n          }\n        }\n      }\n    } else {\n\n      // We partition the list into three parts:\n      //  1. < pivot1\n      //  2. >= pivot1 && <= pivot2\n      //  3. > pivot2\n      //\n      // During the loop we have:\n      // [ | < pivot1 | >= pivot1 && <= pivot2 | unpartitioned  | > pivot2  | ]\n      //  ^            ^                        ^              ^             ^\n      // left         less                     k              great        right\n      //\n      // a[left] and a[right] are undefined and are filled after the\n      // partitioning.\n      //\n      // Invariants:\n      //   1. for x in ]left, less[ : x < pivot1\n      //   2. for x in [less, k[ : pivot1 <= x && x <= pivot2\n      //   3. for x in ]great, right[ : x > pivot2\n      for (var k = less; k <= great; k++) {\n        var ek = a[k], xk = f(ek);\n        if (xk < pivotValue1) {\n          if (k !== less) {\n            a[k] = a[less];\n            a[less] = ek;\n          }\n          ++less;\n        } else {\n          if (xk > pivotValue2) {\n            while (true) {\n              var greatValue = f(a[great]);\n              if (greatValue > pivotValue2) {\n                great--;\n                if (great < k) break;\n                // This is the only location inside the loop where a new\n                // iteration is started.\n                continue;\n              } else {\n                // a[great] <= pivot2.\n                if (greatValue < pivotValue1) {\n                  // Triple exchange.\n                  a[k] = a[less];\n                  a[less++] = a[great];\n                  a[great--] = ek;\n                } else {\n                  // a[great] >= pivot1.\n                  a[k] = a[great];\n                  a[great--] = ek;\n                }\n                break;\n              }\n            }\n          }\n        }\n      }\n    }\n\n    // Move pivots into their final positions.\n    // We shrunk the list from both sides (a[left] and a[right] have\n    // meaningless values in them) and now we move elements from the first\n    // and third partition into these locations so that we can store the\n    // pivots.\n    a[lo] = a[less - 1];\n    a[less - 1] = pivot1;\n    a[hi - 1] = a[great + 1];\n    a[great + 1] = pivot2;\n\n    // The list is now partitioned into three partitions:\n    // [ < pivot1   | >= pivot1 && <= pivot2   |  > pivot2   ]\n    //  ^            ^                        ^             ^\n    // left         less                     great        right\n\n    // Recursive descent. (Don't include the pivot values.)\n    sort(a, lo, less - 1);\n    sort(a, great + 2, hi);\n\n    if (pivotsEqual) {\n      // All elements in the second partition are equal to the pivot. No\n      // need to sort them.\n      return a;\n    }\n\n    // In theory it should be enough to call _doSort recursively on the second\n    // partition.\n    // The Android source however removes the pivot elements from the recursive\n    // call if the second partition is too large (more than 2/3 of the list).\n    if (less < i1 && great > i5) {\n      var lessValue, greatValue;\n      while ((lessValue = f(a[less])) <= pivotValue1 && lessValue >= pivotValue1) ++less;\n      while ((greatValue = f(a[great])) <= pivotValue2 && greatValue >= pivotValue2) --great;\n\n      // Copy paste of the previous 3-way partitioning with adaptions.\n      //\n      // We partition the list into three parts:\n      //  1. == pivot1\n      //  2. > pivot1 && < pivot2\n      //  3. == pivot2\n      //\n      // During the loop we have:\n      // [ == pivot1 | > pivot1 && < pivot2 | unpartitioned  | == pivot2 ]\n      //              ^                      ^              ^\n      //            less                     k              great\n      //\n      // Invariants:\n      //   1. for x in [ *, less[ : x == pivot1\n      //   2. for x in [less, k[ : pivot1 < x && x < pivot2\n      //   3. for x in ]great, * ] : x == pivot2\n      for (var k = less; k <= great; k++) {\n        var ek = a[k], xk = f(ek);\n        if (xk <= pivotValue1 && xk >= pivotValue1) {\n          if (k !== less) {\n            a[k] = a[less];\n            a[less] = ek;\n          }\n          less++;\n        } else {\n          if (xk <= pivotValue2 && xk >= pivotValue2) {\n            while (true) {\n              var greatValue = f(a[great]);\n              if (greatValue <= pivotValue2 && greatValue >= pivotValue2) {\n                great--;\n                if (great < k) break;\n                // This is the only location inside the loop where a new\n                // iteration is started.\n                continue;\n              } else {\n                // a[great] < pivot2.\n                if (greatValue < pivotValue1) {\n                  // Triple exchange.\n                  a[k] = a[less];\n                  a[less++] = a[great];\n                  a[great--] = ek;\n                } else {\n                  // a[great] == pivot1.\n                  a[k] = a[great];\n                  a[great--] = ek;\n                }\n                break;\n              }\n            }\n          }\n        }\n      }\n    }\n\n    // The second partition has now been cleared of pivot elements and looks\n    // as follows:\n    // [  *  |  > pivot1 && < pivot2  | * ]\n    //        ^                      ^\n    //       less                  great\n    // Sort the second partition using recursive descent.\n\n    // The second partition looks as follows:\n    // [  *  |  >= pivot1 && <= pivot2  | * ]\n    //        ^                        ^\n    //       less                    great\n    // Simply sort it by recursive descent.\n\n    return sort(a, less, great + 1);\n  }\n\n  return sort;\n}\n\nvar quicksort_sizeThreshold = 32;\nvar crossfilter_array8 = crossfilter_arrayUntyped,\n    crossfilter_array16 = crossfilter_arrayUntyped,\n    crossfilter_array32 = crossfilter_arrayUntyped,\n    crossfilter_arrayLengthen = crossfilter_arrayLengthenUntyped,\n    crossfilter_arrayWiden = crossfilter_arrayWidenUntyped;\n\nif (typeof Uint8Array !== \"undefined\") {\n  crossfilter_array8 = function(n) { return new Uint8Array(n); };\n  crossfilter_array16 = function(n) { return new Uint16Array(n); };\n  crossfilter_array32 = function(n) { return new Uint32Array(n); };\n\n  crossfilter_arrayLengthen = function(array, length) {\n    if (array.length >= length) return array;\n    var copy = new array.constructor(length);\n    copy.set(array);\n    return copy;\n  };\n\n  crossfilter_arrayWiden = function(array, width) {\n    var copy;\n    switch (width) {\n      case 16: copy = crossfilter_array16(array.length); break;\n      case 32: copy = crossfilter_array32(array.length); break;\n      default: throw new Error(\"invalid array width!\");\n    }\n    copy.set(array);\n    return copy;\n  };\n}\n\nfunction crossfilter_arrayUntyped(n) {\n  var array = new Array(n), i = -1;\n  while (++i < n) array[i] = 0;\n  return array;\n}\n\nfunction crossfilter_arrayLengthenUntyped(array, length) {\n  var n = array.length;\n  while (n < length) array[n++] = 0;\n  return array;\n}\n\nfunction crossfilter_arrayWidenUntyped(array, width) {\n  if (width > 32) throw new Error(\"invalid array width!\");\n  return array;\n}\nfunction crossfilter_filterExact(bisect, value) {\n  return function(values) {\n    var n = values.length;\n    return [bisect.left(values, value, 0, n), bisect.right(values, value, 0, n)];\n  };\n}\n\nfunction crossfilter_filterRange(bisect, range) {\n  var min = range[0],\n      max = range[1];\n  return function(values) {\n    var n = values.length;\n    return [bisect.left(values, min, 0, n), bisect.left(values, max, 0, n)];\n  };\n}\n\nfunction crossfilter_filterAll(values) {\n  return [0, values.length];\n}\nfunction crossfilter_null() {\n  return null;\n}\nfunction crossfilter_zero() {\n  return 0;\n}\nfunction crossfilter_reduceIncrement(p) {\n  return p + 1;\n}\n\nfunction crossfilter_reduceDecrement(p) {\n  return p - 1;\n}\n\nfunction crossfilter_reduceAdd(f) {\n  return function(p, v) {\n    return p + +f(v);\n  };\n}\n\nfunction crossfilter_reduceSubtract(f) {\n  return function(p, v) {\n    return p - f(v);\n  };\n}\nexports.crossfilter = crossfilter;\n\nfunction crossfilter() {\n  var crossfilter = {\n    add: add,\n    remove: removeData,\n    dimension: dimension,\n    groupAll: groupAll,\n    size: size\n  };\n\n  var data = [], // the records\n      n = 0, // the number of records; data.length\n      m = 0, // a bit mask representing which dimensions are in use\n      M = 8, // number of dimensions that can fit in `filters`\n      filters = crossfilter_array8(0), // M bits per record; 1 is filtered out\n      filterListeners = [], // when the filters change\n      dataListeners = [], // when data is added\n      removeDataListeners = []; // when data is removed\n\n  // Adds the specified new records to this crossfilter.\n  function add(newData) {\n    var n0 = n,\n        n1 = newData.length;\n\n    // If there's actually new data to add…\n    // Merge the new data into the existing data.\n    // Lengthen the filter bitset to handle the new records.\n    // Notify listeners (dimensions and groups) that new data is available.\n    if (n1) {\n      data = data.concat(newData);\n      filters = crossfilter_arrayLengthen(filters, n += n1);\n      dataListeners.forEach(function(l) { l(newData, n0, n1); });\n    }\n\n    return crossfilter;\n  }\n\n  // Removes all records that match the current filters.\n  function removeData() {\n    var newIndex = crossfilter_index(n, n),\n        removed = [];\n    for (var i = 0, j = 0; i < n; ++i) {\n      if (filters[i]) newIndex[i] = j++;\n      else removed.push(i);\n    }\n\n    // Remove all matching records from groups.\n    filterListeners.forEach(function(l) { l(0, [], removed); });\n\n    // Update indexes.\n    removeDataListeners.forEach(function(l) { l(newIndex); });\n\n    // Remove old filters and data by overwriting.\n    for (var i = 0, j = 0, k; i < n; ++i) {\n      if (k = filters[i]) {\n        if (i !== j) filters[j] = k, data[j] = data[i];\n        ++j;\n      }\n    }\n    data.length = j;\n    while (n > j) filters[--n] = 0;\n  }\n\n  // Adds a new dimension with the specified value accessor function.\n  function dimension(value) {\n    var dimension = {\n      filter: filter,\n      filterExact: filterExact,\n      filterRange: filterRange,\n      filterFunction: filterFunction,\n      filterAll: filterAll,\n      top: top,\n      bottom: bottom,\n      group: group,\n      groupAll: groupAll,\n      dispose: dispose,\n      remove: dispose // for backwards-compatibility\n    };\n\n    var one = ~m & -~m, // lowest unset bit as mask, e.g., 00001000\n        zero = ~one, // inverted one, e.g., 11110111\n        values, // sorted, cached array\n        index, // value rank ↦ object id\n        newValues, // temporary array storing newly-added values\n        newIndex, // temporary array storing newly-added index\n        sort = quicksort_by(function(i) { return newValues[i]; }),\n        refilter = crossfilter_filterAll, // for recomputing filter\n        refilterFunction, // the custom filter function in use\n        indexListeners = [], // when data is added\n        dimensionGroups = [],\n        lo0 = 0,\n        hi0 = 0;\n\n    // Updating a dimension is a two-stage process. First, we must update the\n    // associated filters for the newly-added records. Once all dimensions have\n    // updated their filters, the groups are notified to update.\n    dataListeners.unshift(preAdd);\n    dataListeners.push(postAdd);\n\n    removeDataListeners.push(removeData);\n\n    // Incorporate any existing data into this dimension, and make sure that the\n    // filter bitset is wide enough to handle the new dimension.\n    m |= one;\n    if (M >= 32 ? !one : m & (1 << M) - 1) {\n      filters = crossfilter_arrayWiden(filters, M <<= 1);\n    }\n    preAdd(data, 0, n);\n    postAdd(data, 0, n);\n\n    // Incorporates the specified new records into this dimension.\n    // This function is responsible for updating filters, values, and index.\n    function preAdd(newData, n0, n1) {\n\n      // Permute new values into natural order using a sorted index.\n      newValues = newData.map(value);\n      newIndex = sort(crossfilter_range(n1), 0, n1);\n      newValues = permute(newValues, newIndex);\n\n      // Bisect newValues to determine which new records are selected.\n      var bounds = refilter(newValues), lo1 = bounds[0], hi1 = bounds[1], i;\n      if (refilterFunction) {\n        for (i = 0; i < n1; ++i) {\n          if (!refilterFunction(newValues[i], i)) filters[newIndex[i] + n0] |= one;\n        }\n      } else {\n        for (i = 0; i < lo1; ++i) filters[newIndex[i] + n0] |= one;\n        for (i = hi1; i < n1; ++i) filters[newIndex[i] + n0] |= one;\n      }\n\n      // If this dimension previously had no data, then we don't need to do the\n      // more expensive merge operation; use the new values and index as-is.\n      if (!n0) {\n        values = newValues;\n        index = newIndex;\n        lo0 = lo1;\n        hi0 = hi1;\n        return;\n      }\n\n      var oldValues = values,\n          oldIndex = index,\n          i0 = 0,\n          i1 = 0;\n\n      // Otherwise, create new arrays into which to merge new and old.\n      values = new Array(n);\n      index = crossfilter_index(n, n);\n\n      // Merge the old and new sorted values, and old and new index.\n      for (i = 0; i0 < n0 && i1 < n1; ++i) {\n        if (oldValues[i0] < newValues[i1]) {\n          values[i] = oldValues[i0];\n          index[i] = oldIndex[i0++];\n        } else {\n          values[i] = newValues[i1];\n          index[i] = newIndex[i1++] + n0;\n        }\n      }\n\n      // Add any remaining old values.\n      for (; i0 < n0; ++i0, ++i) {\n        values[i] = oldValues[i0];\n        index[i] = oldIndex[i0];\n      }\n\n      // Add any remaining new values.\n      for (; i1 < n1; ++i1, ++i) {\n        values[i] = newValues[i1];\n        index[i] = newIndex[i1] + n0;\n      }\n\n      // Bisect again to recompute lo0 and hi0.\n      bounds = refilter(values), lo0 = bounds[0], hi0 = bounds[1];\n    }\n\n    // When all filters have updated, notify index listeners of the new values.\n    function postAdd(newData, n0, n1) {\n      indexListeners.forEach(function(l) { l(newValues, newIndex, n0, n1); });\n      newValues = newIndex = null;\n    }\n\n    function removeData(reIndex) {\n      for (var i = 0, j = 0, k; i < n; ++i) {\n        if (filters[k = index[i]]) {\n          if (i !== j) values[j] = values[i];\n          index[j] = reIndex[k];\n          ++j;\n        }\n      }\n      values.length = j;\n      while (j < n) index[j++] = 0;\n\n      // Bisect again to recompute lo0 and hi0.\n      var bounds = refilter(values);\n      lo0 = bounds[0], hi0 = bounds[1];\n    }\n\n    // Updates the selected values based on the specified bounds [lo, hi].\n    // This implementation is used by all the public filter methods.\n    function filterIndexBounds(bounds) {\n      var lo1 = bounds[0],\n          hi1 = bounds[1];\n\n      if (refilterFunction) {\n        refilterFunction = null;\n        filterIndexFunction(function(d, i) { return lo1 <= i && i < hi1; });\n        lo0 = lo1;\n        hi0 = hi1;\n        return dimension;\n      }\n\n      var i,\n          j,\n          k,\n          added = [],\n          removed = [];\n\n      // Fast incremental update based on previous lo index.\n      if (lo1 < lo0) {\n        for (i = lo1, j = Math.min(lo0, hi1); i < j; ++i) {\n          filters[k = index[i]] ^= one;\n          added.push(k);\n        }\n      } else if (lo1 > lo0) {\n        for (i = lo0, j = Math.min(lo1, hi0); i < j; ++i) {\n          filters[k = index[i]] ^= one;\n          removed.push(k);\n        }\n      }\n\n      // Fast incremental update based on previous hi index.\n      if (hi1 > hi0) {\n        for (i = Math.max(lo1, hi0), j = hi1; i < j; ++i) {\n          filters[k = index[i]] ^= one;\n          added.push(k);\n        }\n      } else if (hi1 < hi0) {\n        for (i = Math.max(lo0, hi1), j = hi0; i < j; ++i) {\n          filters[k = index[i]] ^= one;\n          removed.push(k);\n        }\n      }\n\n      lo0 = lo1;\n      hi0 = hi1;\n      filterListeners.forEach(function(l) { l(one, added, removed); });\n      return dimension;\n    }\n\n    // Filters this dimension using the specified range, value, or null.\n    // If the range is null, this is equivalent to filterAll.\n    // If the range is an array, this is equivalent to filterRange.\n    // Otherwise, this is equivalent to filterExact.\n    function filter(range) {\n      return range == null\n          ? filterAll() : Array.isArray(range)\n          ? filterRange(range) : typeof range === \"function\"\n          ? filterFunction(range)\n          : filterExact(range);\n    }\n\n    // Filters this dimension to select the exact value.\n    function filterExact(value) {\n      return filterIndexBounds((refilter = crossfilter_filterExact(bisect, value))(values));\n    }\n\n    // Filters this dimension to select the specified range [lo, hi].\n    // The lower bound is inclusive, and the upper bound is exclusive.\n    function filterRange(range) {\n      return filterIndexBounds((refilter = crossfilter_filterRange(bisect, range))(values));\n    }\n\n    // Clears any filters on this dimension.\n    function filterAll() {\n      return filterIndexBounds((refilter = crossfilter_filterAll)(values));\n    }\n\n    // Filters this dimension using an arbitrary function.\n    function filterFunction(f) {\n      refilter = crossfilter_filterAll;\n\n      filterIndexFunction(refilterFunction = f);\n\n      lo0 = 0;\n      hi0 = n;\n\n      return dimension;\n    }\n\n    function filterIndexFunction(f) {\n      var i,\n          k,\n          x,\n          added = [],\n          removed = [];\n\n      for (i = 0; i < n; ++i) {\n        if (!(filters[k = index[i]] & one) ^ !!(x = f(values[i], i))) {\n          if (x) filters[k] &= zero, added.push(k);\n          else filters[k] |= one, removed.push(k);\n        }\n      }\n      filterListeners.forEach(function(l) { l(one, added, removed); });\n    }\n\n    // Returns the top K selected records based on this dimension's order.\n    // Note: observes this dimension's filter, unlike group and groupAll.\n    function top(k) {\n      var array = [],\n          i = hi0,\n          j;\n\n      while (--i >= lo0 && k > 0) {\n        if (!filters[j = index[i]]) {\n          array.push(data[j]);\n          --k;\n        }\n      }\n\n      return array;\n    }\n\n    // Returns the bottom K selected records based on this dimension's order.\n    // Note: observes this dimension's filter, unlike group and groupAll.\n    function bottom(k) {\n      var array = [],\n          i = lo0,\n          j;\n\n      while (i < hi0 && k > 0) {\n        if (!filters[j = index[i]]) {\n          array.push(data[j]);\n          --k;\n        }\n        i++;\n      }\n\n      return array;\n    }\n\n    // Adds a new group to this dimension, using the specified key function.\n    function group(key) {\n      var group = {\n        top: top,\n        all: all,\n        reduce: reduce,\n        reduceCount: reduceCount,\n        reduceSum: reduceSum,\n        order: order,\n        orderNatural: orderNatural,\n        size: size,\n        dispose: dispose,\n        remove: dispose // for backwards-compatibility\n      };\n\n      // Ensure that this group will be removed when the dimension is removed.\n      dimensionGroups.push(group);\n\n      var groups, // array of {key, value}\n          groupIndex, // object id ↦ group id\n          groupWidth = 8,\n          groupCapacity = crossfilter_capacity(groupWidth),\n          k = 0, // cardinality\n          select,\n          heap,\n          reduceAdd,\n          reduceRemove,\n          reduceInitial,\n          update = crossfilter_null,\n          reset = crossfilter_null,\n          resetNeeded = true,\n          groupAll = key === crossfilter_null;\n\n      if (arguments.length < 1) key = crossfilter_identity;\n\n      // The group listens to the crossfilter for when any dimension changes, so\n      // that it can update the associated reduce values. It must also listen to\n      // the parent dimension for when data is added, and compute new keys.\n      filterListeners.push(update);\n      indexListeners.push(add);\n      removeDataListeners.push(removeData);\n\n      // Incorporate any existing data into the grouping.\n      add(values, index, 0, n);\n\n      // Incorporates the specified new values into this group.\n      // This function is responsible for updating groups and groupIndex.\n      function add(newValues, newIndex, n0, n1) {\n        var oldGroups = groups,\n            reIndex = crossfilter_index(k, groupCapacity),\n            add = reduceAdd,\n            initial = reduceInitial,\n            k0 = k, // old cardinality\n            i0 = 0, // index of old group\n            i1 = 0, // index of new record\n            j, // object id\n            g0, // old group\n            x0, // old key\n            x1, // new key\n            g, // group to add\n            x; // key of group to add\n\n        // If a reset is needed, we don't need to update the reduce values.\n        if (resetNeeded) add = initial = crossfilter_null;\n\n        // Reset the new groups (k is a lower bound).\n        // Also, make sure that groupIndex exists and is long enough.\n        groups = new Array(k), k = 0;\n        groupIndex = k0 > 1 ? crossfilter_arrayLengthen(groupIndex, n) : crossfilter_index(n, groupCapacity);\n\n        // Get the first old key (x0 of g0), if it exists.\n        if (k0) x0 = (g0 = oldGroups[0]).key;\n\n        // Find the first new key (x1), skipping NaN keys.\n        while (i1 < n1 && !((x1 = key(newValues[i1])) >= x1)) ++i1;\n\n        // While new keys remain…\n        while (i1 < n1) {\n\n          // Determine the lesser of the two current keys; new and old.\n          // If there are no old keys remaining, then always add the new key.\n          if (g0 && x0 <= x1) {\n            g = g0, x = x0;\n\n            // Record the new index of the old group.\n            reIndex[i0] = k;\n\n            // Retrieve the next old key.\n            if (g0 = oldGroups[++i0]) x0 = g0.key;\n          } else {\n            g = {key: x1, value: initial()}, x = x1;\n          }\n\n          // Add the lesser group.\n          groups[k] = g;\n\n          // Add any selected records belonging to the added group, while\n          // advancing the new key and populating the associated group index.\n          while (!(x1 > x)) {\n            groupIndex[j = newIndex[i1] + n0] = k;\n            if (!(filters[j] & zero)) g.value = add(g.value, data[j]);\n            if (++i1 >= n1) break;\n            x1 = key(newValues[i1]);\n          }\n\n          groupIncrement();\n        }\n\n        // Add any remaining old groups that were greater than all new keys.\n        // No incremental reduce is needed; these groups have no new records.\n        // Also record the new index of the old group.\n        while (i0 < k0) {\n          groups[reIndex[i0] = k] = oldGroups[i0++];\n          groupIncrement();\n        }\n\n        // If we added any new groups before any old groups,\n        // update the group index of all the old records.\n        if (k > i0) for (i0 = 0; i0 < n0; ++i0) {\n          groupIndex[i0] = reIndex[groupIndex[i0]];\n        }\n\n        // Modify the update and reset behavior based on the cardinality.\n        // If the cardinality is less than or equal to one, then the groupIndex\n        // is not needed. If the cardinality is zero, then there are no records\n        // and therefore no groups to update or reset. Note that we also must\n        // change the registered listener to point to the new method.\n        j = filterListeners.indexOf(update);\n        if (k > 1) {\n          update = updateMany;\n          reset = resetMany;\n        } else {\n          if (!k && groupAll) {\n            k = 1;\n            groups = [{key: null, value: initial()}];\n          }\n          if (k === 1) {\n            update = updateOne;\n            reset = resetOne;\n          } else {\n            update = crossfilter_null;\n            reset = crossfilter_null;\n          }\n          groupIndex = null;\n        }\n        filterListeners[j] = update;\n\n        // Count the number of added groups,\n        // and widen the group index as needed.\n        function groupIncrement() {\n          if (++k === groupCapacity) {\n            reIndex = crossfilter_arrayWiden(reIndex, groupWidth <<= 1);\n            groupIndex = crossfilter_arrayWiden(groupIndex, groupWidth);\n            groupCapacity = crossfilter_capacity(groupWidth);\n          }\n        }\n      }\n\n      function removeData() {\n        if (k > 1) {\n          var oldK = k,\n              oldGroups = groups,\n              seenGroups = crossfilter_index(oldK, oldK);\n\n          // Filter out non-matches by copying matching group index entries to\n          // the beginning of the array.\n          for (var i = 0, j = 0; i < n; ++i) {\n            if (filters[i]) {\n              seenGroups[groupIndex[j] = groupIndex[i]] = 1;\n              ++j;\n            }\n          }\n\n          // Reassemble groups including only those groups that were referred\n          // to by matching group index entries.  Note the new group index in\n          // seenGroups.\n          groups = [], k = 0;\n          for (i = 0; i < oldK; ++i) {\n            if (seenGroups[i]) {\n              seenGroups[i] = k++;\n              groups.push(oldGroups[i]);\n            }\n          }\n\n          if (k > 1) {\n            // Reindex the group index using seenGroups to find the new index.\n            for (var i = 0; i < j; ++i) groupIndex[i] = seenGroups[groupIndex[i]];\n          } else {\n            groupIndex = null;\n          }\n          filterListeners[filterListeners.indexOf(update)] = k > 1\n              ? (reset = resetMany, update = updateMany)\n              : k === 1 ? (reset = resetOne, update = updateOne)\n              : reset = update = crossfilter_null;\n        } else if (k === 1) {\n          if (groupAll) return;\n          for (var i = 0; i < n; ++i) if (filters[i]) return;\n          groups = [], k = 0;\n          filterListeners[filterListeners.indexOf(update)] =\n          update = reset = crossfilter_null;\n        }\n      }\n\n      // Reduces the specified selected or deselected records.\n      // This function is only used when the cardinality is greater than 1.\n      function updateMany(filterOne, added, removed) {\n        if (filterOne === one || resetNeeded) return;\n\n        var i,\n            k,\n            n,\n            g;\n\n        // Add the added values.\n        for (i = 0, n = added.length; i < n; ++i) {\n          if (!(filters[k = added[i]] & zero)) {\n            g = groups[groupIndex[k]];\n            g.value = reduceAdd(g.value, data[k]);\n          }\n        }\n\n        // Remove the removed values.\n        for (i = 0, n = removed.length; i < n; ++i) {\n          if ((filters[k = removed[i]] & zero) === filterOne) {\n            g = groups[groupIndex[k]];\n            g.value = reduceRemove(g.value, data[k]);\n          }\n        }\n      }\n\n      // Reduces the specified selected or deselected records.\n      // This function is only used when the cardinality is 1.\n      function updateOne(filterOne, added, removed) {\n        if (filterOne === one || resetNeeded) return;\n\n        var i,\n            k,\n            n,\n            g = groups[0];\n\n        // Add the added values.\n        for (i = 0, n = added.length; i < n; ++i) {\n          if (!(filters[k = added[i]] & zero)) {\n            g.value = reduceAdd(g.value, data[k]);\n          }\n        }\n\n        // Remove the removed values.\n        for (i = 0, n = removed.length; i < n; ++i) {\n          if ((filters[k = removed[i]] & zero) === filterOne) {\n            g.value = reduceRemove(g.value, data[k]);\n          }\n        }\n      }\n\n      // Recomputes the group reduce values from scratch.\n      // This function is only used when the cardinality is greater than 1.\n      function resetMany() {\n        var i,\n            g;\n\n        // Reset all group values.\n        for (i = 0; i < k; ++i) {\n          groups[i].value = reduceInitial();\n        }\n\n        // Add any selected records.\n        for (i = 0; i < n; ++i) {\n          if (!(filters[i] & zero)) {\n            g = groups[groupIndex[i]];\n            g.value = reduceAdd(g.value, data[i]);\n          }\n        }\n      }\n\n      // Recomputes the group reduce values from scratch.\n      // This function is only used when the cardinality is 1.\n      function resetOne() {\n        var i,\n            g = groups[0];\n\n        // Reset the singleton group values.\n        g.value = reduceInitial();\n\n        // Add any selected records.\n        for (i = 0; i < n; ++i) {\n          if (!(filters[i] & zero)) {\n            g.value = reduceAdd(g.value, data[i]);\n          }\n        }\n      }\n\n      // Returns the array of group values, in the dimension's natural order.\n      function all() {\n        if (resetNeeded) reset(), resetNeeded = false;\n        return groups;\n      }\n\n      // Returns a new array containing the top K group values, in reduce order.\n      function top(k) {\n        var top = select(all(), 0, groups.length, k);\n        return heap.sort(top, 0, top.length);\n      }\n\n      // Sets the reduce behavior for this group to use the specified functions.\n      // This method lazily recomputes the reduce values, waiting until needed.\n      function reduce(add, remove, initial) {\n        reduceAdd = add;\n        reduceRemove = remove;\n        reduceInitial = initial;\n        resetNeeded = true;\n        return group;\n      }\n\n      // A convenience method for reducing by count.\n      function reduceCount() {\n        return reduce(crossfilter_reduceIncrement, crossfilter_reduceDecrement, crossfilter_zero);\n      }\n\n      // A convenience method for reducing by sum(value).\n      function reduceSum(value) {\n        return reduce(crossfilter_reduceAdd(value), crossfilter_reduceSubtract(value), crossfilter_zero);\n      }\n\n      // Sets the reduce order, using the specified accessor.\n      function order(value) {\n        select = heapselect_by(valueOf);\n        heap = heap_by(valueOf);\n        function valueOf(d) { return value(d.value); }\n        return group;\n      }\n\n      // A convenience method for natural ordering by reduce value.\n      function orderNatural() {\n        return order(crossfilter_identity);\n      }\n\n      // Returns the cardinality of this group, irrespective of any filters.\n      function size() {\n        return k;\n      }\n\n      // Removes this group and associated event listeners.\n      function dispose() {\n        var i = filterListeners.indexOf(update);\n        if (i >= 0) filterListeners.splice(i, 1);\n        i = indexListeners.indexOf(add);\n        if (i >= 0) indexListeners.splice(i, 1);\n        i = removeDataListeners.indexOf(removeData);\n        if (i >= 0) removeDataListeners.splice(i, 1);\n        return group;\n      }\n\n      return reduceCount().orderNatural();\n    }\n\n    // A convenience function for generating a singleton group.\n    function groupAll() {\n      var g = group(crossfilter_null), all = g.all;\n      delete g.all;\n      delete g.top;\n      delete g.order;\n      delete g.orderNatural;\n      delete g.size;\n      g.value = function() { return all()[0].value; };\n      return g;\n    }\n\n    // Removes this dimension and associated groups and event listeners.\n    function dispose() {\n      dimensionGroups.forEach(function(group) { group.dispose(); });\n      var i = dataListeners.indexOf(preAdd);\n      if (i >= 0) dataListeners.splice(i, 1);\n      i = dataListeners.indexOf(postAdd);\n      if (i >= 0) dataListeners.splice(i, 1);\n      i = removeDataListeners.indexOf(removeData);\n      if (i >= 0) removeDataListeners.splice(i, 1);\n      m &= zero;\n      return filterAll();\n    }\n\n    return dimension;\n  }\n\n  // A convenience method for groupAll on a dummy dimension.\n  // This implementation can be optimized since it always has cardinality 1.\n  function groupAll() {\n    var group = {\n      reduce: reduce,\n      reduceCount: reduceCount,\n      reduceSum: reduceSum,\n      value: value,\n      dispose: dispose,\n      remove: dispose // for backwards-compatibility\n    };\n\n    var reduceValue,\n        reduceAdd,\n        reduceRemove,\n        reduceInitial,\n        resetNeeded = true;\n\n    // The group listens to the crossfilter for when any dimension changes, so\n    // that it can update the reduce value. It must also listen to the parent\n    // dimension for when data is added.\n    filterListeners.push(update);\n    dataListeners.push(add);\n\n    // For consistency; actually a no-op since resetNeeded is true.\n    add(data, 0, n);\n\n    // Incorporates the specified new values into this group.\n    function add(newData, n0) {\n      var i;\n\n      if (resetNeeded) return;\n\n      // Add the added values.\n      for (i = n0; i < n; ++i) {\n        if (!filters[i]) {\n          reduceValue = reduceAdd(reduceValue, data[i]);\n        }\n      }\n    }\n\n    // Reduces the specified selected or deselected records.\n    function update(filterOne, added, removed) {\n      var i,\n          k,\n          n;\n\n      if (resetNeeded) return;\n\n      // Add the added values.\n      for (i = 0, n = added.length; i < n; ++i) {\n        if (!filters[k = added[i]]) {\n          reduceValue = reduceAdd(reduceValue, data[k]);\n        }\n      }\n\n      // Remove the removed values.\n      for (i = 0, n = removed.length; i < n; ++i) {\n        if (filters[k = removed[i]] === filterOne) {\n          reduceValue = reduceRemove(reduceValue, data[k]);\n        }\n      }\n    }\n\n    // Recomputes the group reduce value from scratch.\n    function reset() {\n      var i;\n\n      reduceValue = reduceInitial();\n\n      for (i = 0; i < n; ++i) {\n        if (!filters[i]) {\n          reduceValue = reduceAdd(reduceValue, data[i]);\n        }\n      }\n    }\n\n    // Sets the reduce behavior for this group to use the specified functions.\n    // This method lazily recomputes the reduce value, waiting until needed.\n    function reduce(add, remove, initial) {\n      reduceAdd = add;\n      reduceRemove = remove;\n      reduceInitial = initial;\n      resetNeeded = true;\n      return group;\n    }\n\n    // A convenience method for reducing by count.\n    function reduceCount() {\n      return reduce(crossfilter_reduceIncrement, crossfilter_reduceDecrement, crossfilter_zero);\n    }\n\n    // A convenience method for reducing by sum(value).\n    function reduceSum(value) {\n      return reduce(crossfilter_reduceAdd(value), crossfilter_reduceSubtract(value), crossfilter_zero);\n    }\n\n    // Returns the computed reduce value.\n    function value() {\n      if (resetNeeded) reset(), resetNeeded = false;\n      return reduceValue;\n    }\n\n    // Removes this group and associated event listeners.\n    function dispose() {\n      var i = filterListeners.indexOf(update);\n      if (i >= 0) filterListeners.splice(i);\n      i = dataListeners.indexOf(add);\n      if (i >= 0) dataListeners.splice(i);\n      return group;\n    }\n\n    return reduceCount();\n  }\n\n  // Returns the number of records in this crossfilter, irrespective of any filters.\n  function size() {\n    return n;\n  }\n\n  return arguments.length\n      ? add(arguments[0])\n      : crossfilter;\n}\n\n// Returns an array of size n, big enough to store ids up to m.\nfunction crossfilter_index(n, m) {\n  return (m < 0x101\n      ? crossfilter_array8 : m < 0x10001\n      ? crossfilter_array16\n      : crossfilter_array32)(n);\n}\n\n// Constructs a new array of size n, with sequential values from 0 to n - 1.\nfunction crossfilter_range(n) {\n  var range = crossfilter_index(n, n);\n  for (var i = -1; ++i < n;) range[i] = i;\n  return range;\n}\n\nfunction crossfilter_capacity(w) {\n  return w === 8\n      ? 0x100 : w === 16\n      ? 0x10000\n      : 0x100000000;\n}\n})(typeof exports !== 'undefined' && exports || this);\n","/*\n * jQuery UI Effects 1.8.3\n *\n * Copyright 2010, AUTHORS.txt (http://jqueryui.com/about)\n * Dual licensed under the MIT or GPL Version 2 licenses.\n * http://jquery.org/license\n *\n * http://docs.jquery.com/UI/Effects/\n */\n;jQuery.effects || (function($, undefined) {\n\n$.effects = {};\n\n\n\n/******************************************************************************/\n/****************************** COLOR ANIMATIONS ******************************/\n/******************************************************************************/\n\n// override the animation for color styles\n$.each(['backgroundColor', 'borderBottomColor', 'borderLeftColor',\n\t'borderRightColor', 'borderTopColor', 'color', 'outlineColor'],\nfunction(i, attr) {\n\t$.fx.step[attr] = function(fx) {\n\t\tif (!fx.colorInit) {\n\t\t\tfx.start = getColor(fx.elem, attr);\n\t\t\tfx.end = getRGB(fx.end);\n\t\t\tfx.colorInit = true;\n\t\t}\n\n\t\tfx.elem.style[attr] = 'rgb(' +\n\t\t\tMath.max(Math.min(parseInt((fx.pos * (fx.end[0] - fx.start[0])) + fx.start[0], 10), 255), 0) + ',' +\n\t\t\tMath.max(Math.min(parseInt((fx.pos * (fx.end[1] - fx.start[1])) + fx.start[1], 10), 255), 0) + ',' +\n\t\t\tMath.max(Math.min(parseInt((fx.pos * (fx.end[2] - fx.start[2])) + fx.start[2], 10), 255), 0) + ')';\n\t};\n});\n\n// Color Conversion functions from highlightFade\n// By Blair Mitchelmore\n// http://jquery.offput.ca/highlightFade/\n\n// Parse strings looking for color tuples [255,255,255]\nfunction getRGB(color) {\n\t\tvar result;\n\n\t\t// Check if we're already dealing with an array of colors\n\t\tif ( color && color.constructor == Array && color.length == 3 )\n\t\t\t\treturn color;\n\n\t\t// Look for rgb(num,num,num)\n\t\tif (result = /rgb\\(\\s*([0-9]{1,3})\\s*,\\s*([0-9]{1,3})\\s*,\\s*([0-9]{1,3})\\s*\\)/.exec(color))\n\t\t\t\treturn [parseInt(result[1],10), parseInt(result[2],10), parseInt(result[3],10)];\n\n\t\t// Look for rgb(num%,num%,num%)\n\t\tif (result = /rgb\\(\\s*([0-9]+(?:\\.[0-9]+)?)\\%\\s*,\\s*([0-9]+(?:\\.[0-9]+)?)\\%\\s*,\\s*([0-9]+(?:\\.[0-9]+)?)\\%\\s*\\)/.exec(color))\n\t\t\t\treturn [parseFloat(result[1])*2.55, parseFloat(result[2])*2.55, parseFloat(result[3])*2.55];\n\n\t\t// Look for #a0b1c2\n\t\tif (result = /#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(color))\n\t\t\t\treturn [parseInt(result[1],16), parseInt(result[2],16), parseInt(result[3],16)];\n\n\t\t// Look for #fff\n\t\tif (result = /#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(color))\n\t\t\t\treturn [parseInt(result[1]+result[1],16), parseInt(result[2]+result[2],16), parseInt(result[3]+result[3],16)];\n\n\t\t// Look for rgba(0, 0, 0, 0) == transparent in Safari 3\n\t\tif (result = /rgba\\(0, 0, 0, 0\\)/.exec(color))\n\t\t\t\treturn colors['transparent'];\n\n\t\t// Otherwise, we're most likely dealing with a named color\n\t\treturn colors[$.trim(color).toLowerCase()];\n}\n\nfunction getColor(elem, attr) {\n\t\tvar color;\n\n\t\tdo {\n\t\t\t\tcolor = $.curCSS(elem, attr);\n\n\t\t\t\t// Keep going until we find an element that has color, or we hit the body\n\t\t\t\tif ( color != '' && color != 'transparent' || $.nodeName(elem, \"body\") )\n\t\t\t\t\t\tbreak;\n\n\t\t\t\tattr = \"backgroundColor\";\n\t\t} while ( elem = elem.parentNode );\n\n\t\treturn getRGB(color);\n};\n\n// Some named colors to work with\n// From Interface by Stefan Petre\n// http://interface.eyecon.ro/\n\nvar colors = {\n\taqua:[0,255,255],\n\tazure:[240,255,255],\n\tbeige:[245,245,220],\n\tblack:[0,0,0],\n\tblue:[0,0,255],\n\tbrown:[165,42,42],\n\tcyan:[0,255,255],\n\tdarkblue:[0,0,139],\n\tdarkcyan:[0,139,139],\n\tdarkgrey:[169,169,169],\n\tdarkgreen:[0,100,0],\n\tdarkkhaki:[189,183,107],\n\tdarkmagenta:[139,0,139],\n\tdarkolivegreen:[85,107,47],\n\tdarkorange:[255,140,0],\n\tdarkorchid:[153,50,204],\n\tdarkred:[139,0,0],\n\tdarksalmon:[233,150,122],\n\tdarkviolet:[148,0,211],\n\tfuchsia:[255,0,255],\n\tgold:[255,215,0],\n\tgreen:[0,128,0],\n\tindigo:[75,0,130],\n\tkhaki:[240,230,140],\n\tlightblue:[173,216,230],\n\tlightcyan:[224,255,255],\n\tlightgreen:[144,238,144],\n\tlightgrey:[211,211,211],\n\tlightpink:[255,182,193],\n\tlightyellow:[255,255,224],\n\tlime:[0,255,0],\n\tmagenta:[255,0,255],\n\tmaroon:[128,0,0],\n\tnavy:[0,0,128],\n\tolive:[128,128,0],\n\torange:[255,165,0],\n\tpink:[255,192,203],\n\tpurple:[128,0,128],\n\tviolet:[128,0,128],\n\tred:[255,0,0],\n\tsilver:[192,192,192],\n\twhite:[255,255,255],\n\tyellow:[255,255,0],\n\ttransparent: [255,255,255]\n};\n\n\n\n/******************************************************************************/\n/****************************** CLASS ANIMATIONS ******************************/\n/******************************************************************************/\n\nvar classAnimationActions = ['add', 'remove', 'toggle'],\n\tshorthandStyles = {\n\t\tborder: 1,\n\t\tborderBottom: 1,\n\t\tborderColor: 1,\n\t\tborderLeft: 1,\n\t\tborderRight: 1,\n\t\tborderTop: 1,\n\t\tborderWidth: 1,\n\t\tmargin: 1,\n\t\tpadding: 1\n\t};\n\nfunction getElementStyles() {\n\tvar style = document.defaultView\n\t\t\t? document.defaultView.getComputedStyle(this, null)\n\t\t\t: this.currentStyle,\n\t\tnewStyle = {},\n\t\tkey,\n\t\tcamelCase;\n\n\t// webkit enumerates style porperties\n\tif (style && style.length && style[0] && style[style[0]]) {\n\t\tvar len = style.length;\n\t\twhile (len--) {\n\t\t\tkey = style[len];\n\t\t\tif (typeof style[key] == 'string') {\n\t\t\t\tcamelCase = key.replace(/\\-(\\w)/g, function(all, letter){\n\t\t\t\t\treturn letter.toUpperCase();\n\t\t\t\t});\n\t\t\t\tnewStyle[camelCase] = style[key];\n\t\t\t}\n\t\t}\n\t} else {\n\t\tfor (key in style) {\n\t\t\tif (typeof style[key] === 'string') {\n\t\t\t\tnewStyle[key] = style[key];\n\t\t\t}\n\t\t}\n\t}\n\t\n\treturn newStyle;\n}\n\nfunction filterStyles(styles) {\n\tvar name, value;\n\tfor (name in styles) {\n\t\tvalue = styles[name];\n\t\tif (\n\t\t\t// ignore null and undefined values\n\t\t\tvalue == null ||\n\t\t\t// ignore functions (when does this occur?)\n\t\t\t$.isFunction(value) ||\n\t\t\t// shorthand styles that need to be expanded\n\t\t\tname in shorthandStyles ||\n\t\t\t// ignore scrollbars (break in IE)\n\t\t\t(/scrollbar/).test(name) ||\n\n\t\t\t// only colors or values that can be converted to numbers\n\t\t\t(!(/color/i).test(name) && isNaN(parseFloat(value)))\n\t\t) {\n\t\t\tdelete styles[name];\n\t\t}\n\t}\n\t\n\treturn styles;\n}\n\nfunction styleDifference(oldStyle, newStyle) {\n\tvar diff = { _: 0 }, // http://dev.jquery.com/ticket/5459\n\t\tname;\n\n\tfor (name in newStyle) {\n\t\tif (oldStyle[name] != newStyle[name]) {\n\t\t\tdiff[name] = newStyle[name];\n\t\t}\n\t}\n\n\treturn diff;\n}\n\n$.effects.animateClass = function(value, duration, easing, callback) {\n\tif ($.isFunction(easing)) {\n\t\tcallback = easing;\n\t\teasing = null;\n\t}\n\n\treturn this.each(function() {\n\n\t\tvar that = $(this),\n\t\t\toriginalStyleAttr = that.attr('style') || ' ',\n\t\t\toriginalStyle = filterStyles(getElementStyles.call(this)),\n\t\t\tnewStyle,\n\t\t\tclassName = that.attr('className');\n\n\t\t$.each(classAnimationActions, function(i, action) {\n\t\t\tif (value[action]) {\n\t\t\t\tthat[action + 'Class'](value[action]);\n\t\t\t}\n\t\t});\n\t\tnewStyle = filterStyles(getElementStyles.call(this));\n\t\tthat.attr('className', className);\n\n\t\tthat.animate(styleDifference(originalStyle, newStyle), duration, easing, function() {\n\t\t\t$.each(classAnimationActions, function(i, action) {\n\t\t\t\tif (value[action]) { that[action + 'Class'](value[action]); }\n\t\t\t});\n\t\t\t// work around bug in IE by clearing the cssText before setting it\n\t\t\tif (typeof that.attr('style') == 'object') {\n\t\t\t\tthat.attr('style').cssText = '';\n\t\t\t\tthat.attr('style').cssText = originalStyleAttr;\n\t\t\t} else {\n\t\t\t\tthat.attr('style', originalStyleAttr);\n\t\t\t}\n\t\t\tif (callback) { callback.apply(this, arguments); }\n\t\t});\n\t});\n};\n\n$.fn.extend({\n\t_addClass: $.fn.addClass,\n\taddClass: function(classNames, speed, easing, callback) {\n\t\treturn speed ? $.effects.animateClass.apply(this, [{ add: classNames },speed,easing,callback]) : this._addClass(classNames);\n\t},\n\n\t_removeClass: $.fn.removeClass,\n\tremoveClass: function(classNames,speed,easing,callback) {\n\t\treturn speed ? $.effects.animateClass.apply(this, [{ remove: classNames },speed,easing,callback]) : this._removeClass(classNames);\n\t},\n\n\t_toggleClass: $.fn.toggleClass,\n\ttoggleClass: function(classNames, force, speed, easing, callback) {\n\t\tif ( typeof force == \"boolean\" || force === undefined ) {\n\t\t\tif ( !speed ) {\n\t\t\t\t// without speed parameter;\n\t\t\t\treturn this._toggleClass(classNames, force);\n\t\t\t} else {\n\t\t\t\treturn $.effects.animateClass.apply(this, [(force?{add:classNames}:{remove:classNames}),speed,easing,callback]);\n\t\t\t}\n\t\t} else {\n\t\t\t// without switch parameter;\n\t\t\treturn $.effects.animateClass.apply(this, [{ toggle: classNames },force,speed,easing]);\n\t\t}\n\t},\n\n\tswitchClass: function(remove,add,speed,easing,callback) {\n\t\treturn $.effects.animateClass.apply(this, [{ add: add, remove: remove },speed,easing,callback]);\n\t}\n});\n\n\n\n/******************************************************************************/\n/*********************************** EFFECTS **********************************/\n/******************************************************************************/\n\n$.extend($.effects, {\n\tversion: \"1.8.3\",\n\n\t// Saves a set of properties in a data storage\n\tsave: function(element, set) {\n\t\tfor(var i=0; i < set.length; i++) {\n\t\t\tif(set[i] !== null) element.data(\"ec.storage.\"+set[i], element[0].style[set[i]]);\n\t\t}\n\t},\n\n\t// Restores a set of previously saved properties from a data storage\n\trestore: function(element, set) {\n\t\tfor(var i=0; i < set.length; i++) {\n\t\t\tif(set[i] !== null) element.css(set[i], element.data(\"ec.storage.\"+set[i]));\n\t\t}\n\t},\n\n\tsetMode: function(el, mode) {\n\t\tif (mode == 'toggle') mode = el.is(':hidden') ? 'show' : 'hide'; // Set for toggle\n\t\treturn mode;\n\t},\n\n\tgetBaseline: function(origin, original) { // Translates a [top,left] array into a baseline value\n\t\t// this should be a little more flexible in the future to handle a string & hash\n\t\tvar y, x;\n\t\tswitch (origin[0]) {\n\t\t\tcase 'top': y = 0; break;\n\t\t\tcase 'middle': y = 0.5; break;\n\t\t\tcase 'bottom': y = 1; break;\n\t\t\tdefault: y = origin[0] / original.height;\n\t\t};\n\t\tswitch (origin[1]) {\n\t\t\tcase 'left': x = 0; break;\n\t\t\tcase 'center': x = 0.5; break;\n\t\t\tcase 'right': x = 1; break;\n\t\t\tdefault: x = origin[1] / original.width;\n\t\t};\n\t\treturn {x: x, y: y};\n\t},\n\n\t// Wraps the element around a wrapper that copies position properties\n\tcreateWrapper: function(element) {\n\n\t\t// if the element is already wrapped, return it\n\t\tif (element.parent().is('.ui-effects-wrapper')) {\n\t\t\treturn element.parent();\n\t\t}\n\n\t\t// wrap the element\n\t\tvar props = {\n\t\t\t\twidth: element.outerWidth(true),\n\t\t\t\theight: element.outerHeight(true),\n\t\t\t\t'float': element.css('float')\n\t\t\t},\n\t\t\twrapper = $('<div></div>')\n\t\t\t\t.addClass('ui-effects-wrapper')\n\t\t\t\t.css({\n\t\t\t\t\tfontSize: '100%',\n\t\t\t\t\tbackground: 'transparent',\n\t\t\t\t\tborder: 'none',\n\t\t\t\t\tmargin: 0,\n\t\t\t\t\tpadding: 0\n\t\t\t\t});\n\n\t\telement.wrap(wrapper);\n\t\twrapper = element.parent(); //Hotfix for jQuery 1.4 since some change in wrap() seems to actually loose the reference to the wrapped element\n\n\t\t// transfer positioning properties to the wrapper\n\t\tif (element.css('position') == 'static') {\n\t\t\twrapper.css({ position: 'relative' });\n\t\t\telement.css({ position: 'relative' });\n\t\t} else {\n\t\t\t$.extend(props, {\n\t\t\t\tposition: element.css('position'),\n\t\t\t\tzIndex: element.css('z-index')\n\t\t\t});\n\t\t\t$.each(['top', 'left', 'bottom', 'right'], function(i, pos) {\n\t\t\t\tprops[pos] = element.css(pos);\n\t\t\t\tif (isNaN(parseInt(props[pos], 10))) {\n\t\t\t\t\tprops[pos] = 'auto';\n\t\t\t\t}\n\t\t\t});\n\t\t\telement.css({position: 'relative', top: 0, left: 0 });\n\t\t}\n\n\t\treturn wrapper.css(props).show();\n\t},\n\n\tremoveWrapper: function(element) {\n\t\tif (element.parent().is('.ui-effects-wrapper'))\n\t\t\treturn element.parent().replaceWith(element);\n\t\treturn element;\n\t},\n\n\tsetTransition: function(element, list, factor, value) {\n\t\tvalue = value || {};\n\t\t$.each(list, function(i, x){\n\t\t\tunit = element.cssUnit(x);\n\t\t\tif (unit[0] > 0) value[x] = unit[0] * factor + unit[1];\n\t\t});\n\t\treturn value;\n\t}\n});\n\n\nfunction _normalizeArguments(effect, options, speed, callback) {\n\t// shift params for method overloading\n\tif (typeof effect == 'object') {\n\t\tcallback = options;\n\t\tspeed = null;\n\t\toptions = effect;\n\t\teffect = options.effect;\n\t}\n\tif ($.isFunction(options)) {\n\t\tcallback = options;\n\t\tspeed = null;\n\t\toptions = {};\n\t}\n        if (typeof options == 'number' || $.fx.speeds[options]) {\n\t\tcallback = speed;\n\t\tspeed = options;\n\t\toptions = {};\n\t}\n\tif ($.isFunction(speed)) {\n\t\tcallback = speed;\n\t\tspeed = null;\n\t}\n\n\toptions = options || {};\n\n\tspeed = speed || options.duration;\n\tspeed = $.fx.off ? 0 : typeof speed == 'number'\n\t\t? speed : $.fx.speeds[speed] || $.fx.speeds._default;\n\n\tcallback = callback || options.complete;\n\n\treturn [effect, options, speed, callback];\n}\n\n$.fn.extend({\n\teffect: function(effect, options, speed, callback) {\n\t\tvar args = _normalizeArguments.apply(this, arguments),\n\t\t\t// TODO: make effects takes actual parameters instead of a hash\n\t\t\targs2 = {\n\t\t\t\toptions: args[1],\n\t\t\t\tduration: args[2],\n\t\t\t\tcallback: args[3]\n\t\t\t},\n\t\t\teffectMethod = $.effects[effect];\n\t\t\n\t\treturn effectMethod && !$.fx.off ? effectMethod.call(this, args2) : this;\n\t},\n\n\t_show: $.fn.show,\n\tshow: function(speed) {\n\t\tif (!speed || typeof speed == 'number' || $.fx.speeds[speed]) {\n\t\t\treturn this._show.apply(this, arguments);\n\t\t} else {\n\t\t\tvar args = _normalizeArguments.apply(this, arguments);\n\t\t\targs[1].mode = 'show';\n\t\t\treturn this.effect.apply(this, args);\n\t\t}\n\t},\n\n\t_hide: $.fn.hide,\n\thide: function(speed) {\n\t\tif (!speed || typeof speed == 'number' || $.fx.speeds[speed]) {\n\t\t\treturn this._hide.apply(this, arguments);\n\t\t} else {\n\t\t\tvar args = _normalizeArguments.apply(this, arguments);\n\t\t\targs[1].mode = 'hide';\n\t\t\treturn this.effect.apply(this, args);\n\t\t}\n\t},\n\n\t// jQuery core overloads toggle and create _toggle\n\t__toggle: $.fn.toggle,\n\ttoggle: function(speed) {\n\t\tif (!speed || typeof speed == 'number' || $.fx.speeds[speed] ||\n\t\t\ttypeof speed == 'boolean' || $.isFunction(speed)) {\n\t\t\treturn this.__toggle.apply(this, arguments);\n\t\t} else {\n\t\t\tvar args = _normalizeArguments.apply(this, arguments);\n\t\t\targs[1].mode = 'toggle';\n\t\t\treturn this.effect.apply(this, args);\n\t\t}\n\t},\n\n\t// helper functions\n\tcssUnit: function(key) {\n\t\tvar style = this.css(key), val = [];\n\t\t$.each( ['em','px','%','pt'], function(i, unit){\n\t\t\tif(style.indexOf(unit) > 0)\n\t\t\t\tval = [parseFloat(style), unit];\n\t\t});\n\t\treturn val;\n\t}\n});\n\n\n\n/******************************************************************************/\n/*********************************** EASING ***********************************/\n/******************************************************************************/\n\n/*\n * jQuery Easing v1.3 - http://gsgd.co.uk/sandbox/jquery/easing/\n *\n * Uses the built in easing capabilities added In jQuery 1.1\n * to offer multiple easing options\n *\n * TERMS OF USE - jQuery Easing\n *\n * Open source under the BSD License.\n *\n * Copyright 2008 George McGinley Smith\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n *\n * Redistributions of source code must retain the above copyright notice, this list of\n * conditions and the following disclaimer.\n * Redistributions in binary form must reproduce the above copyright notice, this list\n * of conditions and the following disclaimer in the documentation and/or other materials\n * provided with the distribution.\n *\n * Neither the name of the author nor the names of contributors may be used to endorse\n * or promote products derived from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY\n * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF\n * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE\n * COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n * GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED\n * AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED\n * OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n*/\n\n// t: current time, b: begInnIng value, c: change In value, d: duration\n$.easing.jswing = $.easing.swing;\n\n$.extend($.easing,\n{\n\tdef: 'easeOutQuad',\n\tswing: function (x, t, b, c, d) {\n\t\t//alert($.easing.default);\n\t\treturn $.easing[$.easing.def](x, t, b, c, d);\n\t},\n\teaseInQuad: function (x, t, b, c, d) {\n\t\treturn c*(t/=d)*t + b;\n\t},\n\teaseOutQuad: function (x, t, b, c, d) {\n\t\treturn -c *(t/=d)*(t-2) + b;\n\t},\n\teaseInOutQuad: function (x, t, b, c, d) {\n\t\tif ((t/=d/2) < 1) return c/2*t*t + b;\n\t\treturn -c/2 * ((--t)*(t-2) - 1) + b;\n\t},\n\teaseInCubic: function (x, t, b, c, d) {\n\t\treturn c*(t/=d)*t*t + b;\n\t},\n\teaseOutCubic: function (x, t, b, c, d) {\n\t\treturn c*((t=t/d-1)*t*t + 1) + b;\n\t},\n\teaseInOutCubic: function (x, t, b, c, d) {\n\t\tif ((t/=d/2) < 1) return c/2*t*t*t + b;\n\t\treturn c/2*((t-=2)*t*t + 2) + b;\n\t},\n\teaseInQuart: function (x, t, b, c, d) {\n\t\treturn c*(t/=d)*t*t*t + b;\n\t},\n\teaseOutQuart: function (x, t, b, c, d) {\n\t\treturn -c * ((t=t/d-1)*t*t*t - 1) + b;\n\t},\n\teaseInOutQuart: function (x, t, b, c, d) {\n\t\tif ((t/=d/2) < 1) return c/2*t*t*t*t + b;\n\t\treturn -c/2 * ((t-=2)*t*t*t - 2) + b;\n\t},\n\teaseInQuint: function (x, t, b, c, d) {\n\t\treturn c*(t/=d)*t*t*t*t + b;\n\t},\n\teaseOutQuint: function (x, t, b, c, d) {\n\t\treturn c*((t=t/d-1)*t*t*t*t + 1) + b;\n\t},\n\teaseInOutQuint: function (x, t, b, c, d) {\n\t\tif ((t/=d/2) < 1) return c/2*t*t*t*t*t + b;\n\t\treturn c/2*((t-=2)*t*t*t*t + 2) + b;\n\t},\n\teaseInSine: function (x, t, b, c, d) {\n\t\treturn -c * Math.cos(t/d * (Math.PI/2)) + c + b;\n\t},\n\teaseOutSine: function (x, t, b, c, d) {\n\t\treturn c * Math.sin(t/d * (Math.PI/2)) + b;\n\t},\n\teaseInOutSine: function (x, t, b, c, d) {\n\t\treturn -c/2 * (Math.cos(Math.PI*t/d) - 1) + b;\n\t},\n\teaseInExpo: function (x, t, b, c, d) {\n\t\treturn (t==0) ? b : c * Math.pow(2, 10 * (t/d - 1)) + b;\n\t},\n\teaseOutExpo: function (x, t, b, c, d) {\n\t\treturn (t==d) ? b+c : c * (-Math.pow(2, -10 * t/d) + 1) + b;\n\t},\n\teaseInOutExpo: function (x, t, b, c, d) {\n\t\tif (t==0) return b;\n\t\tif (t==d) return b+c;\n\t\tif ((t/=d/2) < 1) return c/2 * Math.pow(2, 10 * (t - 1)) + b;\n\t\treturn c/2 * (-Math.pow(2, -10 * --t) + 2) + b;\n\t},\n\teaseInCirc: function (x, t, b, c, d) {\n\t\treturn -c * (Math.sqrt(1 - (t/=d)*t) - 1) + b;\n\t},\n\teaseOutCirc: function (x, t, b, c, d) {\n\t\treturn c * Math.sqrt(1 - (t=t/d-1)*t) + b;\n\t},\n\teaseInOutCirc: function (x, t, b, c, d) {\n\t\tif ((t/=d/2) < 1) return -c/2 * (Math.sqrt(1 - t*t) - 1) + b;\n\t\treturn c/2 * (Math.sqrt(1 - (t-=2)*t) + 1) + b;\n\t},\n\teaseInElastic: function (x, t, b, c, d) {\n\t\tvar s=1.70158;var p=0;var a=c;\n\t\tif (t==0) return b;  if ((t/=d)==1) return b+c;  if (!p) p=d*.3;\n\t\tif (a < Math.abs(c)) { a=c; var s=p/4; }\n\t\telse var s = p/(2*Math.PI) * Math.asin (c/a);\n\t\treturn -(a*Math.pow(2,10*(t-=1)) * Math.sin( (t*d-s)*(2*Math.PI)/p )) + b;\n\t},\n\teaseOutElastic: function (x, t, b, c, d) {\n\t\tvar s=1.70158;var p=0;var a=c;\n\t\tif (t==0) return b;  if ((t/=d)==1) return b+c;  if (!p) p=d*.3;\n\t\tif (a < Math.abs(c)) { a=c; var s=p/4; }\n\t\telse var s = p/(2*Math.PI) * Math.asin (c/a);\n\t\treturn a*Math.pow(2,-10*t) * Math.sin( (t*d-s)*(2*Math.PI)/p ) + c + b;\n\t},\n\teaseInOutElastic: function (x, t, b, c, d) {\n\t\tvar s=1.70158;var p=0;var a=c;\n\t\tif (t==0) return b;  if ((t/=d/2)==2) return b+c;  if (!p) p=d*(.3*1.5);\n\t\tif (a < Math.abs(c)) { a=c; var s=p/4; }\n\t\telse var s = p/(2*Math.PI) * Math.asin (c/a);\n\t\tif (t < 1) return -.5*(a*Math.pow(2,10*(t-=1)) * Math.sin( (t*d-s)*(2*Math.PI)/p )) + b;\n\t\treturn a*Math.pow(2,-10*(t-=1)) * Math.sin( (t*d-s)*(2*Math.PI)/p )*.5 + c + b;\n\t},\n\teaseInBack: function (x, t, b, c, d, s) {\n\t\tif (s == undefined) s = 1.70158;\n\t\treturn c*(t/=d)*t*((s+1)*t - s) + b;\n\t},\n\teaseOutBack: function (x, t, b, c, d, s) {\n\t\tif (s == undefined) s = 1.70158;\n\t\treturn c*((t=t/d-1)*t*((s+1)*t + s) + 1) + b;\n\t},\n\teaseInOutBack: function (x, t, b, c, d, s) {\n\t\tif (s == undefined) s = 1.70158;\n\t\tif ((t/=d/2) < 1) return c/2*(t*t*(((s*=(1.525))+1)*t - s)) + b;\n\t\treturn c/2*((t-=2)*t*(((s*=(1.525))+1)*t + s) + 2) + b;\n\t},\n\teaseInBounce: function (x, t, b, c, d) {\n\t\treturn c - $.easing.easeOutBounce (x, d-t, 0, c, d) + b;\n\t},\n\teaseOutBounce: function (x, t, b, c, d) {\n\t\tif ((t/=d) < (1/2.75)) {\n\t\t\treturn c*(7.5625*t*t) + b;\n\t\t} else if (t < (2/2.75)) {\n\t\t\treturn c*(7.5625*(t-=(1.5/2.75))*t + .75) + b;\n\t\t} else if (t < (2.5/2.75)) {\n\t\t\treturn c*(7.5625*(t-=(2.25/2.75))*t + .9375) + b;\n\t\t} else {\n\t\t\treturn c*(7.5625*(t-=(2.625/2.75))*t + .984375) + b;\n\t\t}\n\t},\n\teaseInOutBounce: function (x, t, b, c, d) {\n\t\tif (t < d/2) return $.easing.easeInBounce (x, t*2, 0, c, d) * .5 + b;\n\t\treturn $.easing.easeOutBounce (x, t*2-d, 0, c, d) * .5 + c*.5 + b;\n\t}\n});\n\n/*\n *\n * TERMS OF USE - EASING EQUATIONS\n *\n * Open source under the BSD License.\n *\n * Copyright 2001 Robert Penner\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n *\n * Redistributions of source code must retain the above copyright notice, this list of\n * conditions and the following disclaimer.\n * Redistributions in binary form must reproduce the above copyright notice, this list\n * of conditions and the following disclaimer in the documentation and/or other materials\n * provided with the distribution.\n *\n * Neither the name of the author nor the names of contributors may be used to endorse\n * or promote products derived from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY\n * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF\n * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE\n * COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\n * GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED\n * AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED\n * OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n */\n\n})(jQuery);\n","/*\n * jQuery UI Effects Blind 1.8.3\n *\n * Copyright 2010, AUTHORS.txt (http://jqueryui.com/about)\n * Dual licensed under the MIT or GPL Version 2 licenses.\n * http://jquery.org/license\n *\n * http://docs.jquery.com/UI/Effects/Blind\n *\n * Depends:\n *\tjquery.effects.core.js\n */\n(function( $, undefined ) {\n\n$.effects.blind = function(o) {\n\n\treturn this.queue(function() {\n\n\t\t// Create element\n\t\tvar el = $(this), props = ['position','top','left'];\n\n\t\t// Set options\n\t\tvar mode = $.effects.setMode(el, o.options.mode || 'hide'); // Set Mode\n\t\tvar direction = o.options.direction || 'vertical'; // Default direction\n\n\t\t// Adjust\n\t\t$.effects.save(el, props); el.show(); // Save & Show\n\t\tvar wrapper = $.effects.createWrapper(el).css({overflow:'hidden'}); // Create Wrapper\n\t\tvar ref = (direction == 'vertical') ? 'height' : 'width';\n\t\tvar distance = (direction == 'vertical') ? wrapper.height() : wrapper.width();\n\t\tif(mode == 'show') wrapper.css(ref, 0); // Shift\n\n\t\t// Animation\n\t\tvar animation = {};\n\t\tanimation[ref] = mode == 'show' ? distance : 0;\n\n\t\t// Animate\n\t\twrapper.animate(animation, o.duration, o.options.easing, function() {\n\t\t\tif(mode == 'hide') el.hide(); // Hide\n\t\t\t$.effects.restore(el, props); $.effects.removeWrapper(el); // Restore\n\t\t\tif(o.callback) o.callback.apply(el[0], arguments); // Callback\n\t\t\tel.dequeue();\n\t\t});\n\n\t});\n\n};\n\n})(jQuery);\n","/*\n * jQuery UI Effects Highlight 1.8.3\n *\n * Copyright 2010, AUTHORS.txt (http://jqueryui.com/about)\n * Dual licensed under the MIT or GPL Version 2 licenses.\n * http://jquery.org/license\n *\n * http://docs.jquery.com/UI/Effects/Highlight\n *\n * Depends:\n *\tjquery.effects.core.js\n */\n(function( $, undefined ) {\n\n$.effects.highlight = function(o) {\n\treturn this.queue(function() {\n\t\tvar elem = $(this),\n\t\t\tprops = ['backgroundImage', 'backgroundColor', 'opacity'],\n\t\t\tmode = $.effects.setMode(elem, o.options.mode || 'show'),\n\t\t\tanimation = {\n\t\t\t\tbackgroundColor: elem.css('backgroundColor')\n\t\t\t};\n\n\t\tif (mode == 'hide') {\n\t\t\tanimation.opacity = 0;\n\t\t}\n\n\t\t$.effects.save(elem, props);\n\t\telem\n\t\t\t.show()\n\t\t\t.css({\n\t\t\t\tbackgroundImage: 'none',\n\t\t\t\tbackgroundColor: o.options.color || '#ffff99'\n\t\t\t})\n\t\t\t.animate(animation, {\n\t\t\t\tqueue: false,\n\t\t\t\tduration: o.duration,\n\t\t\t\teasing: o.options.easing,\n\t\t\t\tcomplete: function() {\n\t\t\t\t\t(mode == 'hide' && elem.hide());\n\t\t\t\t\t$.effects.restore(elem, props);\n\t\t\t\t\t(mode == 'show' && !$.support.opacity && this.style.removeAttribute('filter'));\n\t\t\t\t\t(o.callback && o.callback.apply(this, arguments));\n\t\t\t\t\telem.dequeue();\n\t\t\t\t}\n\t\t\t});\n\t});\n};\n\n})(jQuery);\n","/*!\n * jQuery UI Autocomplete 1.8.23\n *\n * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)\n * Dual licensed under the MIT or GPL Version 2 licenses.\n * http://jquery.org/license\n *\n * http://docs.jquery.com/UI/Autocomplete\n *\n * Depends:\n *\tjquery.ui.core.js\n *\tjquery.ui.widget.js\n *\tjquery.ui.position.js\n */\n(function( $, undefined ) {\n\n// used to prevent race conditions with remote data sources\nvar requestIndex = 0;\n\n$.widget( \"ui.autocomplete\", {\n\toptions: {\n\t\tappendTo: \"body\",\n\t\tautoFocus: false,\n\t\tdelay: 300,\n\t\tminLength: 1,\n\t\tposition: {\n\t\t\tmy: \"left top\",\n\t\t\tat: \"left bottom\",\n\t\t\tcollision: \"none\"\n\t\t},\n\t\tsource: null\n\t},\n\n\tpending: 0,\n\n\t_create: function() {\n\t\tvar self = this,\n\t\t\tdoc = this.element[ 0 ].ownerDocument,\n\t\t\tsuppressKeyPress;\n\t\tthis.isMultiLine = this.element.is( \"textarea\" );\n\n\t\tthis.element\n\t\t\t.addClass( \"ui-autocomplete-input\" )\n\t\t\t.attr( \"autocomplete\", \"off\" )\n\t\t\t// TODO verify these actually work as intended\n\t\t\t.attr({\n\t\t\t\trole: \"textbox\",\n\t\t\t\t\"aria-autocomplete\": \"list\",\n\t\t\t\t\"aria-haspopup\": \"true\"\n\t\t\t})\n\t\t\t.bind( \"keydown.autocomplete\", function( event ) {\n\t\t\t\tif ( self.options.disabled || self.element.propAttr( \"readOnly\" ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tsuppressKeyPress = false;\n\t\t\t\tvar keyCode = $.ui.keyCode;\n\t\t\t\tswitch( event.keyCode ) {\n\t\t\t\tcase keyCode.PAGE_UP:\n\t\t\t\t\tself._move( \"previousPage\", event );\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyCode.PAGE_DOWN:\n\t\t\t\t\tself._move( \"nextPage\", event );\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyCode.UP:\n\t\t\t\t\tself._keyEvent( \"previous\", event );\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyCode.DOWN:\n\t\t\t\t\tself._keyEvent( \"next\", event );\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyCode.ENTER:\n\t\t\t\tcase keyCode.NUMPAD_ENTER:\n\t\t\t\t\t// when menu is open and has focus\n\t\t\t\t\tif ( self.menu.active ) {\n\t\t\t\t\t\t// #6055 - Opera still allows the keypress to occur\n\t\t\t\t\t\t// which causes forms to submit\n\t\t\t\t\t\tsuppressKeyPress = true;\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t\t//passthrough - ENTER and TAB both select the current element\n\t\t\t\tcase keyCode.TAB:\n\t\t\t\t\tif ( !self.menu.active ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tself.menu.select( event );\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyCode.ESCAPE:\n\t\t\t\t\tself.element.val( self.term );\n\t\t\t\t\tself.close( event );\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\t// keypress is triggered before the input value is changed\n\t\t\t\t\tclearTimeout( self.searching );\n\t\t\t\t\tself.searching = setTimeout(function() {\n\t\t\t\t\t\t// only search if the value has changed\n\t\t\t\t\t\tif ( self.term != self.element.val() ) {\n\t\t\t\t\t\t\tself.selectedItem = null;\n\t\t\t\t\t\t\tself.search( null, event );\n\t\t\t\t\t\t}\n\t\t\t\t\t}, self.options.delay );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t})\n\t\t\t.bind( \"keypress.autocomplete\", function( event ) {\n\t\t\t\tif ( suppressKeyPress ) {\n\t\t\t\t\tsuppressKeyPress = false;\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t})\n\t\t\t.bind( \"focus.autocomplete\", function() {\n\t\t\t\tif ( self.options.disabled ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tself.selectedItem = null;\n\t\t\t\tself.previous = self.element.val();\n\t\t\t})\n\t\t\t.bind( \"blur.autocomplete\", function( event ) {\n\t\t\t\tif ( self.options.disabled ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tclearTimeout( self.searching );\n\t\t\t\t// clicks on the menu (or a button to trigger a search) will cause a blur event\n\t\t\t\tself.closing = setTimeout(function() {\n\t\t\t\t\tself.close( event );\n\t\t\t\t\tself._change( event );\n\t\t\t\t}, 150 );\n\t\t\t});\n\t\tthis._initSource();\n\t\tthis.menu = $( \"<ul></ul>\" )\n\t\t\t.addClass( \"ui-autocomplete\" )\n\t\t\t.appendTo( $( this.options.appendTo || \"body\", doc )[0] )\n\t\t\t// prevent the close-on-blur in case of a \"slow\" click on the menu (long mousedown)\n\t\t\t.mousedown(function( event ) {\n\t\t\t\t// clicking on the scrollbar causes focus to shift to the body\n\t\t\t\t// but we can't detect a mouseup or a click immediately afterward\n\t\t\t\t// so we have to track the next mousedown and close the menu if\n\t\t\t\t// the user clicks somewhere outside of the autocomplete\n\t\t\t\tvar menuElement = self.menu.element[ 0 ];\n\t\t\t\tif ( !$( event.target ).closest( \".ui-menu-item\" ).length ) {\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t$( document ).one( 'mousedown', function( event ) {\n\t\t\t\t\t\t\tif ( event.target !== self.element[ 0 ] &&\n\t\t\t\t\t\t\t\tevent.target !== menuElement &&\n\t\t\t\t\t\t\t\t!$.ui.contains( menuElement, event.target ) ) {\n\t\t\t\t\t\t\t\tself.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}, 1 );\n\t\t\t\t}\n\n\t\t\t\t// use another timeout to make sure the blur-event-handler on the input was already triggered\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tclearTimeout( self.closing );\n\t\t\t\t}, 13);\n\t\t\t})\n\t\t\t.menu({\n\t\t\t\tfocus: function( event, ui ) {\n\t\t\t\t\tvar item = ui.item.data( \"item.autocomplete\" );\n\t\t\t\t\tif ( false !== self._trigger( \"focus\", event, { item: item } ) ) {\n\t\t\t\t\t\t// use value to match what will end up in the input, if it was a key event\n\t\t\t\t\t\tif ( /^key/.test(event.originalEvent.type) ) {\n\t\t\t\t\t\t\tself.element.val( item.value );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tselected: function( event, ui ) {\n\t\t\t\t\tvar item = ui.item.data( \"item.autocomplete\" ),\n\t\t\t\t\t\tprevious = self.previous;\n\n\t\t\t\t\t// only trigger when focus was lost (click on menu)\n\t\t\t\t\tif ( self.element[0] !== doc.activeElement ) {\n\t\t\t\t\t\tself.element.focus();\n\t\t\t\t\t\tself.previous = previous;\n\t\t\t\t\t\t// #6109 - IE triggers two focus events and the second\n\t\t\t\t\t\t// is asynchronous, so we need to reset the previous\n\t\t\t\t\t\t// term synchronously and asynchronously :-(\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tself.previous = previous;\n\t\t\t\t\t\t\tself.selectedItem = item;\n\t\t\t\t\t\t}, 1);\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( false !== self._trigger( \"select\", event, { item: item } ) ) {\n\t\t\t\t\t\tself.element.val( item.value );\n\t\t\t\t\t}\n\t\t\t\t\t// reset the term after the select event\n\t\t\t\t\t// this allows custom select handling to work properly\n\t\t\t\t\tself.term = self.element.val();\n\n\t\t\t\t\tself.close( event );\n\t\t\t\t\tself.selectedItem = item;\n\t\t\t\t},\n\t\t\t\tblur: function( event, ui ) {\n\t\t\t\t\t// don't set the value of the text field if it's already correct\n\t\t\t\t\t// this prevents moving the cursor unnecessarily\n\t\t\t\t\tif ( self.menu.element.is(\":visible\") &&\n\t\t\t\t\t\t( self.element.val() !== self.term ) ) {\n\t\t\t\t\t\tself.element.val( self.term );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\t.zIndex( this.element.zIndex() + 1 )\n\t\t\t// workaround for jQuery bug #5781 http://dev.jquery.com/ticket/5781\n\t\t\t.css({ top: 0, left: 0 })\n\t\t\t.hide()\n\t\t\t.data( \"menu\" );\n\t\tif ( $.fn.bgiframe ) {\n\t\t\t this.menu.element.bgiframe();\n\t\t}\n\t\t// turning off autocomplete prevents the browser from remembering the\n\t\t// value when navigating through history, so we re-enable autocomplete\n\t\t// if the page is unloaded before the widget is destroyed. #7790\n\t\tself.beforeunloadHandler = function() {\n\t\t\tself.element.removeAttr( \"autocomplete\" );\n\t\t};\n\t\t$( window ).bind( \"beforeunload\", self.beforeunloadHandler );\n\t},\n\n\tdestroy: function() {\n\t\tthis.element\n\t\t\t.removeClass( \"ui-autocomplete-input\" )\n\t\t\t.removeAttr( \"autocomplete\" )\n\t\t\t.removeAttr( \"role\" )\n\t\t\t.removeAttr( \"aria-autocomplete\" )\n\t\t\t.removeAttr( \"aria-haspopup\" );\n\t\tthis.menu.element.remove();\n\t\t$( window ).unbind( \"beforeunload\", this.beforeunloadHandler );\n\t\t$.Widget.prototype.destroy.call( this );\n\t},\n\n\t_setOption: function( key, value ) {\n\t\t$.Widget.prototype._setOption.apply( this, arguments );\n\t\tif ( key === \"source\" ) {\n\t\t\tthis._initSource();\n\t\t}\n\t\tif ( key === \"appendTo\" ) {\n\t\t\tthis.menu.element.appendTo( $( value || \"body\", this.element[0].ownerDocument )[0] )\n\t\t}\n\t\tif ( key === \"disabled\" && value && this.xhr ) {\n\t\t\tthis.xhr.abort();\n\t\t}\n\t},\n\n\t_initSource: function() {\n\t\tvar self = this,\n\t\t\tarray,\n\t\t\turl;\n\t\tif ( $.isArray(this.options.source) ) {\n\t\t\tarray = this.options.source;\n\t\t\tthis.source = function( request, response ) {\n\t\t\t\tresponse( $.ui.autocomplete.filter(array, request.term) );\n\t\t\t};\n\t\t} else if ( typeof this.options.source === \"string\" ) {\n\t\t\turl = this.options.source;\n\t\t\tthis.source = function( request, response ) {\n\t\t\t\tif ( self.xhr ) {\n\t\t\t\t\tself.xhr.abort();\n\t\t\t\t}\n\t\t\t\tself.xhr = $.ajax({\n\t\t\t\t\turl: url,\n\t\t\t\t\tdata: request,\n\t\t\t\t\tdataType: \"json\",\n\t\t\t\t\tsuccess: function( data, status ) {\n\t\t\t\t\t\tresponse( data );\n\t\t\t\t\t},\n\t\t\t\t\terror: function() {\n\t\t\t\t\t\tresponse( [] );\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\t\t} else {\n\t\t\tthis.source = this.options.source;\n\t\t}\n\t},\n\n\tsearch: function( value, event ) {\n\t\tvalue = value != null ? value : this.element.val();\n\n\t\t// always save the actual value, not the one passed as an argument\n\t\tthis.term = this.element.val();\n\n\t\tif ( value.length < this.options.minLength ) {\n\t\t\treturn this.close( event );\n\t\t}\n\n\t\tclearTimeout( this.closing );\n\t\tif ( this._trigger( \"search\", event ) === false ) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn this._search( value );\n\t},\n\n\t_search: function( value ) {\n\t\tthis.pending++;\n\t\tthis.element.addClass( \"ui-autocomplete-loading\" );\n\n\t\tthis.source( { term: value }, this._response() );\n\t},\n\n\t_response: function() {\n\t\tvar that = this,\n\t\t\tindex = ++requestIndex;\n\n\t\treturn function( content ) {\n\t\t\tif ( index === requestIndex ) {\n\t\t\t\tthat.__response( content );\n\t\t\t}\n\n\t\t\tthat.pending--;\n\t\t\tif ( !that.pending ) {\n\t\t\t\tthat.element.removeClass( \"ui-autocomplete-loading\" );\n\t\t\t}\n\t\t};\n\t},\n\n\t__response: function( content ) {\n\t\tif ( !this.options.disabled && content && content.length ) {\n\t\t\tcontent = this._normalize( content );\n\t\t\tthis._suggest( content );\n\t\t\tthis._trigger( \"open\" );\n\t\t} else {\n\t\t\tthis.close();\n\t\t}\n\t},\n\n\tclose: function( event ) {\n\t\tclearTimeout( this.closing );\n\t\tif ( this.menu.element.is(\":visible\") ) {\n\t\t\tthis.menu.element.hide();\n\t\t\tthis.menu.deactivate();\n\t\t\tthis._trigger( \"close\", event );\n\t\t}\n\t},\n\t\n\t_change: function( event ) {\n\t\tif ( this.previous !== this.element.val() ) {\n\t\t\tthis._trigger( \"change\", event, { item: this.selectedItem } );\n\t\t}\n\t},\n\n\t_normalize: function( items ) {\n\t\t// assume all items have the right format when the first item is complete\n\t\tif ( items.length && items[0].label && items[0].value ) {\n\t\t\treturn items;\n\t\t}\n\t\treturn $.map( items, function(item) {\n\t\t\tif ( typeof item === \"string\" ) {\n\t\t\t\treturn {\n\t\t\t\t\tlabel: item,\n\t\t\t\t\tvalue: item\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn $.extend({\n\t\t\t\tlabel: item.label || item.value,\n\t\t\t\tvalue: item.value || item.label\n\t\t\t}, item );\n\t\t});\n\t},\n\n\t_suggest: function( items ) {\n\t\tvar ul = this.menu.element\n\t\t\t.empty()\n\t\t\t.zIndex( this.element.zIndex() + 1 );\n\t\tthis._renderMenu( ul, items );\n\t\t// TODO refresh should check if the active item is still in the dom, removing the need for a manual deactivate\n\t\tthis.menu.deactivate();\n\t\tthis.menu.refresh();\n\n\t\t// size and position menu\n\t\tul.show();\n\t\tthis._resizeMenu();\n\t\tul.position( $.extend({\n\t\t\tof: this.element\n\t\t}, this.options.position ));\n\n\t\tif ( this.options.autoFocus ) {\n\t\t\tthis.menu.next( new $.Event(\"mouseover\") );\n\t\t}\n\t},\n\n\t_resizeMenu: function() {\n\t\tvar ul = this.menu.element;\n\t\tul.outerWidth( Math.max(\n\t\t\t// Firefox wraps long text (possibly a rounding bug)\n\t\t\t// so we add 1px to avoid the wrapping (#7513)\n\t\t\tul.width( \"\" ).outerWidth() + 1,\n\t\t\tthis.element.outerWidth()\n\t\t) );\n\t},\n\n\t_renderMenu: function( ul, items ) {\n\t\tvar self = this;\n\t\t$.each( items, function( index, item ) {\n\t\t\tself._renderItem( ul, item );\n\t\t});\n\t},\n\n\t_renderItem: function( ul, item) {\n\t\treturn $( \"<li></li>\" )\n\t\t\t.data( \"item.autocomplete\", item )\n\t\t\t.append( $( \"<a></a>\" ).text( item.label ) )\n\t\t\t.appendTo( ul );\n\t},\n\n\t_move: function( direction, event ) {\n\t\tif ( !this.menu.element.is(\":visible\") ) {\n\t\t\tthis.search( null, event );\n\t\t\treturn;\n\t\t}\n\t\tif ( this.menu.first() && /^previous/.test(direction) ||\n\t\t\t\tthis.menu.last() && /^next/.test(direction) ) {\n\t\t\tthis.element.val( this.term );\n\t\t\tthis.menu.deactivate();\n\t\t\treturn;\n\t\t}\n\t\tthis.menu[ direction ]( event );\n\t},\n\n\twidget: function() {\n\t\treturn this.menu.element;\n\t},\n\t_keyEvent: function( keyEvent, event ) {\n\t\tif ( !this.isMultiLine || this.menu.element.is( \":visible\" ) ) {\n\t\t\tthis._move( keyEvent, event );\n\n\t\t\t// prevents moving cursor to beginning/end of the text field in some browsers\n\t\t\tevent.preventDefault();\n\t\t}\n\t}\n});\n\n$.extend( $.ui.autocomplete, {\n\tescapeRegex: function( value ) {\n\t\treturn value.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, \"\\\\$&\");\n\t},\n\tfilter: function(array, term) {\n\t\tvar matcher = new RegExp( $.ui.autocomplete.escapeRegex(term), \"i\" );\n\t\treturn $.grep( array, function(value) {\n\t\t\treturn matcher.test( value.label || value.value || value );\n\t\t});\n\t}\n});\n\n}( jQuery ));\n\n/*\n * jQuery UI Menu (not officially released)\n * \n * This widget isn't yet finished and the API is subject to change. We plan to finish\n * it for the next release. You're welcome to give it a try anyway and give us feedback,\n * as long as you're okay with migrating your code later on. We can help with that, too.\n *\n * Copyright 2010, AUTHORS.txt (http://jqueryui.com/about)\n * Dual licensed under the MIT or GPL Version 2 licenses.\n * http://jquery.org/license\n *\n * http://docs.jquery.com/UI/Menu\n *\n * Depends:\n *\tjquery.ui.core.js\n *  jquery.ui.widget.js\n */\n(function($) {\n\n$.widget(\"ui.menu\", {\n\t_create: function() {\n\t\tvar self = this;\n\t\tthis.element\n\t\t\t.addClass(\"ui-menu ui-widget ui-widget-content ui-corner-all\")\n\t\t\t.attr({\n\t\t\t\trole: \"listbox\",\n\t\t\t\t\"aria-activedescendant\": \"ui-active-menuitem\"\n\t\t\t})\n\t\t\t.click(function( event ) {\n\t\t\t\tif ( !$( event.target ).closest( \".ui-menu-item a\" ).length ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// temporary\n\t\t\t\tevent.preventDefault();\n\t\t\t\tself.select( event );\n\t\t\t});\n\t\tthis.refresh();\n\t},\n\t\n\trefresh: function() {\n\t\tvar self = this;\n\n\t\t// don't refresh list items that are already adapted\n\t\tvar items = this.element.children(\"li:not(.ui-menu-item):has(a)\")\n\t\t\t.addClass(\"ui-menu-item\")\n\t\t\t.attr(\"role\", \"menuitem\");\n\t\t\n\t\titems.children(\"a\")\n\t\t\t.addClass(\"ui-corner-all\")\n\t\t\t.attr(\"tabindex\", -1)\n\t\t\t// mouseenter doesn't work with event delegation\n\t\t\t.mouseenter(function( event ) {\n\t\t\t\tself.activate( event, $(this).parent() );\n\t\t\t})\n\t\t\t.mouseleave(function() {\n\t\t\t\tself.deactivate();\n\t\t\t});\n\t},\n\n\tactivate: function( event, item ) {\n\t\tthis.deactivate();\n\t\tif (this.hasScroll()) {\n\t\t\tvar offset = item.offset().top - this.element.offset().top,\n\t\t\t\tscroll = this.element.scrollTop(),\n\t\t\t\telementHeight = this.element.height();\n\t\t\tif (offset < 0) {\n\t\t\t\tthis.element.scrollTop( scroll + offset);\n\t\t\t} else if (offset >= elementHeight) {\n\t\t\t\tthis.element.scrollTop( scroll + offset - elementHeight + item.height());\n\t\t\t}\n\t\t}\n\t\tthis.active = item.eq(0)\n\t\t\t.children(\"a\")\n\t\t\t\t.addClass(\"ui-state-hover\")\n\t\t\t\t.attr(\"id\", \"ui-active-menuitem\")\n\t\t\t.end();\n\t\tthis._trigger(\"focus\", event, { item: item });\n\t},\n\n\tdeactivate: function() {\n\t\tif (!this.active) { return; }\n\n\t\tthis.active.children(\"a\")\n\t\t\t.removeClass(\"ui-state-hover\")\n\t\t\t.removeAttr(\"id\");\n\t\tthis._trigger(\"blur\");\n\t\tthis.active = null;\n\t},\n\n\tnext: function(event) {\n\t\tthis.move(\"next\", \".ui-menu-item:first\", event);\n\t},\n\n\tprevious: function(event) {\n\t\tthis.move(\"prev\", \".ui-menu-item:last\", event);\n\t},\n\n\tfirst: function() {\n\t\treturn this.active && !this.active.prevAll(\".ui-menu-item\").length;\n\t},\n\n\tlast: function() {\n\t\treturn this.active && !this.active.nextAll(\".ui-menu-item\").length;\n\t},\n\n\tmove: function(direction, edge, event) {\n\t\tif (!this.active) {\n\t\t\tthis.activate(event, this.element.children(edge));\n\t\t\treturn;\n\t\t}\n\t\tvar next = this.active[direction + \"All\"](\".ui-menu-item\").eq(0);\n\t\tif (next.length) {\n\t\t\tthis.activate(event, next);\n\t\t} else {\n\t\t\tthis.activate(event, this.element.children(edge));\n\t\t}\n\t},\n\n\t// TODO merge with previousPage\n\tnextPage: function(event) {\n\t\tif (this.hasScroll()) {\n\t\t\t// TODO merge with no-scroll-else\n\t\t\tif (!this.active || this.last()) {\n\t\t\t\tthis.activate(event, this.element.children(\".ui-menu-item:first\"));\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar base = this.active.offset().top,\n\t\t\t\theight = this.element.height(),\n\t\t\t\tresult = this.element.children(\".ui-menu-item\").filter(function() {\n\t\t\t\t\tvar close = $(this).offset().top - base - height + $(this).height();\n\t\t\t\t\t// TODO improve approximation\n\t\t\t\t\treturn close < 10 && close > -10;\n\t\t\t\t});\n\n\t\t\t// TODO try to catch this earlier when scrollTop indicates the last page anyway\n\t\t\tif (!result.length) {\n\t\t\t\tresult = this.element.children(\".ui-menu-item:last\");\n\t\t\t}\n\t\t\tthis.activate(event, result);\n\t\t} else {\n\t\t\tthis.activate(event, this.element.children(\".ui-menu-item\")\n\t\t\t\t.filter(!this.active || this.last() ? \":first\" : \":last\"));\n\t\t}\n\t},\n\n\t// TODO merge with nextPage\n\tpreviousPage: function(event) {\n\t\tif (this.hasScroll()) {\n\t\t\t// TODO merge with no-scroll-else\n\t\t\tif (!this.active || this.first()) {\n\t\t\t\tthis.activate(event, this.element.children(\".ui-menu-item:last\"));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar base = this.active.offset().top,\n\t\t\t\theight = this.element.height(),\n\t\t\t\tresult = this.element.children(\".ui-menu-item\").filter(function() {\n\t\t\t\t\tvar close = $(this).offset().top - base + height - $(this).height();\n\t\t\t\t\t// TODO improve approximation\n\t\t\t\t\treturn close < 10 && close > -10;\n\t\t\t\t});\n\n\t\t\t// TODO try to catch this earlier when scrollTop indicates the last page anyway\n\t\t\tif (!result.length) {\n\t\t\t\tresult = this.element.children(\".ui-menu-item:first\");\n\t\t\t}\n\t\t\tthis.activate(event, result);\n\t\t} else {\n\t\t\tthis.activate(event, this.element.children(\".ui-menu-item\")\n\t\t\t\t.filter(!this.active || this.first() ? \":last\" : \":first\"));\n\t\t}\n\t},\n\n\thasScroll: function() {\n\t\treturn this.element.height() < this.element[ $.fn.prop ? \"prop\" : \"attr\" ](\"scrollHeight\");\n\t},\n\n\tselect: function( event ) {\n\t\tthis._trigger(\"selected\", event, { item: this.active });\n\t}\n});\n\n}(jQuery));\n","/*!\n * jQuery UI 1.8.23\n *\n * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)\n * Dual licensed under the MIT or GPL Version 2 licenses.\n * http://jquery.org/license\n *\n * http://docs.jquery.com/UI\n */\n(function( $, undefined ) {\n\n// prevent duplicate loading\n// this is only a problem because we proxy existing functions\n// and we don't want to double proxy them\n$.ui = $.ui || {};\nif ( $.ui.version ) {\n\treturn;\n}\n\n$.extend( $.ui, {\n\tversion: \"1.8.23\",\n\n\tkeyCode: {\n\t\tALT: 18,\n\t\tBACKSPACE: 8,\n\t\tCAPS_LOCK: 20,\n\t\tCOMMA: 188,\n\t\tCOMMAND: 91,\n\t\tCOMMAND_LEFT: 91, // COMMAND\n\t\tCOMMAND_RIGHT: 93,\n\t\tCONTROL: 17,\n\t\tDELETE: 46,\n\t\tDOWN: 40,\n\t\tEND: 35,\n\t\tENTER: 13,\n\t\tESCAPE: 27,\n\t\tHOME: 36,\n\t\tINSERT: 45,\n\t\tLEFT: 37,\n\t\tMENU: 93, // COMMAND_RIGHT\n\t\tNUMPAD_ADD: 107,\n\t\tNUMPAD_DECIMAL: 110,\n\t\tNUMPAD_DIVIDE: 111,\n\t\tNUMPAD_ENTER: 108,\n\t\tNUMPAD_MULTIPLY: 106,\n\t\tNUMPAD_SUBTRACT: 109,\n\t\tPAGE_DOWN: 34,\n\t\tPAGE_UP: 33,\n\t\tPERIOD: 190,\n\t\tRIGHT: 39,\n\t\tSHIFT: 16,\n\t\tSPACE: 32,\n\t\tTAB: 9,\n\t\tUP: 38,\n\t\tWINDOWS: 91 // COMMAND\n\t}\n});\n\n// plugins\n$.fn.extend({\n\tpropAttr: $.fn.prop || $.fn.attr,\n\n\t_focus: $.fn.focus,\n\tfocus: function( delay, fn ) {\n\t\treturn typeof delay === \"number\" ?\n\t\t\tthis.each(function() {\n\t\t\t\tvar elem = this;\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t$( elem ).focus();\n\t\t\t\t\tif ( fn ) {\n\t\t\t\t\t\tfn.call( elem );\n\t\t\t\t\t}\n\t\t\t\t}, delay );\n\t\t\t}) :\n\t\t\tthis._focus.apply( this, arguments );\n\t},\n\n\tscrollParent: function() {\n\t\tvar scrollParent;\n\t\tif (($.browser.msie && (/(static|relative)/).test(this.css('position'))) || (/absolute/).test(this.css('position'))) {\n\t\t\tscrollParent = this.parents().filter(function() {\n\t\t\t\treturn (/(relative|absolute|fixed)/).test($.curCSS(this,'position',1)) && (/(auto|scroll)/).test($.curCSS(this,'overflow',1)+$.curCSS(this,'overflow-y',1)+$.curCSS(this,'overflow-x',1));\n\t\t\t}).eq(0);\n\t\t} else {\n\t\t\tscrollParent = this.parents().filter(function() {\n\t\t\t\treturn (/(auto|scroll)/).test($.curCSS(this,'overflow',1)+$.curCSS(this,'overflow-y',1)+$.curCSS(this,'overflow-x',1));\n\t\t\t}).eq(0);\n\t\t}\n\n\t\treturn (/fixed/).test(this.css('position')) || !scrollParent.length ? $(document) : scrollParent;\n\t},\n\n\tzIndex: function( zIndex ) {\n\t\tif ( zIndex !== undefined ) {\n\t\t\treturn this.css( \"zIndex\", zIndex );\n\t\t}\n\n\t\tif ( this.length ) {\n\t\t\tvar elem = $( this[ 0 ] ), position, value;\n\t\t\twhile ( elem.length && elem[ 0 ] !== document ) {\n\t\t\t\t// Ignore z-index if position is set to a value where z-index is ignored by the browser\n\t\t\t\t// This makes behavior of this function consistent across browsers\n\t\t\t\t// WebKit always returns auto if the element is positioned\n\t\t\t\tposition = elem.css( \"position\" );\n\t\t\t\tif ( position === \"absolute\" || position === \"relative\" || position === \"fixed\" ) {\n\t\t\t\t\t// IE returns 0 when zIndex is not specified\n\t\t\t\t\t// other browsers return a string\n\t\t\t\t\t// we ignore the case of nested elements with an explicit value of 0\n\t\t\t\t\t// <div style=\"z-index: -10;\"><div style=\"z-index: 0;\"></div></div>\n\t\t\t\t\tvalue = parseInt( elem.css( \"zIndex\" ), 10 );\n\t\t\t\t\tif ( !isNaN( value ) && value !== 0 ) {\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telem = elem.parent();\n\t\t\t}\n\t\t}\n\n\t\treturn 0;\n\t},\n\n\tdisableSelection: function() {\n\t\treturn this.bind( ( $.support.selectstart ? \"selectstart\" : \"mousedown\" ) +\n\t\t\t\".ui-disableSelection\", function( event ) {\n\t\t\t\tevent.preventDefault();\n\t\t\t});\n\t},\n\n\tenableSelection: function() {\n\t\treturn this.unbind( \".ui-disableSelection\" );\n\t}\n});\n\n// support: jQuery <1.8\nif ( !$( \"<a>\" ).outerWidth( 1 ).jquery ) {\n\t$.each( [ \"Width\", \"Height\" ], function( i, name ) {\n\t\tvar side = name === \"Width\" ? [ \"Left\", \"Right\" ] : [ \"Top\", \"Bottom\" ],\n\t\t\ttype = name.toLowerCase(),\n\t\t\torig = {\n\t\t\t\tinnerWidth: $.fn.innerWidth,\n\t\t\t\tinnerHeight: $.fn.innerHeight,\n\t\t\t\touterWidth: $.fn.outerWidth,\n\t\t\t\touterHeight: $.fn.outerHeight\n\t\t\t};\n\n\t\tfunction reduce( elem, size, border, margin ) {\n\t\t\t$.each( side, function() {\n\t\t\t\tsize -= parseFloat( $.curCSS( elem, \"padding\" + this, true) ) || 0;\n\t\t\t\tif ( border ) {\n\t\t\t\t\tsize -= parseFloat( $.curCSS( elem, \"border\" + this + \"Width\", true) ) || 0;\n\t\t\t\t}\n\t\t\t\tif ( margin ) {\n\t\t\t\t\tsize -= parseFloat( $.curCSS( elem, \"margin\" + this, true) ) || 0;\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn size;\n\t\t}\n\n\t\t$.fn[ \"inner\" + name ] = function( size ) {\n\t\t\tif ( size === undefined ) {\n\t\t\t\treturn orig[ \"inner\" + name ].call( this );\n\t\t\t}\n\n\t\t\treturn this.each(function() {\n\t\t\t\t$( this ).css( type, reduce( this, size ) + \"px\" );\n\t\t\t});\n\t\t};\n\n\t\t$.fn[ \"outer\" + name] = function( size, margin ) {\n\t\t\tif ( typeof size !== \"number\" ) {\n\t\t\t\treturn orig[ \"outer\" + name ].call( this, size );\n\t\t\t}\n\n\t\t\treturn this.each(function() {\n\t\t\t\t$( this).css( type, reduce( this, size, true, margin ) + \"px\" );\n\t\t\t});\n\t\t};\n\t});\n}\n\n// selectors\nfunction focusable( element, isTabIndexNotNaN ) {\n\tvar nodeName = element.nodeName.toLowerCase();\n\tif ( \"area\" === nodeName ) {\n\t\tvar map = element.parentNode,\n\t\t\tmapName = map.name,\n\t\t\timg;\n\t\tif ( !element.href || !mapName || map.nodeName.toLowerCase() !== \"map\" ) {\n\t\t\treturn false;\n\t\t}\n\t\timg = $( \"img[usemap=#\" + mapName + \"]\" )[0];\n\t\treturn !!img && visible( img );\n\t}\n\treturn ( /input|select|textarea|button|object/.test( nodeName )\n\t\t? !element.disabled\n\t\t: \"a\" == nodeName\n\t\t\t? element.href || isTabIndexNotNaN\n\t\t\t: isTabIndexNotNaN)\n\t\t// the element and all of its ancestors must be visible\n\t\t&& visible( element );\n}\n\nfunction visible( element ) {\n\treturn !$( element ).parents().andSelf().filter(function() {\n\t\treturn $.curCSS( this, \"visibility\" ) === \"hidden\" ||\n\t\t\t$.expr.filters.hidden( this );\n\t}).length;\n}\n\n$.extend( $.expr[ \":\" ], {\n\tdata: $.expr.createPseudo ?\n\t\t$.expr.createPseudo(function( dataName ) {\n\t\t\treturn function( elem ) {\n\t\t\t\treturn !!$.data( elem, dataName );\n\t\t\t};\n\t\t}) :\n\t\t// support: jQuery <1.8\n\t\tfunction( elem, i, match ) {\n\t\t\treturn !!$.data( elem, match[ 3 ] );\n\t\t},\n\n\tfocusable: function( element ) {\n\t\treturn focusable( element, !isNaN( $.attr( element, \"tabindex\" ) ) );\n\t},\n\n\ttabbable: function( element ) {\n\t\tvar tabIndex = $.attr( element, \"tabindex\" ),\n\t\t\tisTabIndexNaN = isNaN( tabIndex );\n\t\treturn ( isTabIndexNaN || tabIndex >= 0 ) && focusable( element, !isTabIndexNaN );\n\t}\n});\n\n// support\n$(function() {\n\tvar body = document.body,\n\t\tdiv = body.appendChild( div = document.createElement( \"div\" ) );\n\n\t// access offsetHeight before setting the style to prevent a layout bug\n\t// in IE 9 which causes the elemnt to continue to take up space even\n\t// after it is removed from the DOM (#8026)\n\tdiv.offsetHeight;\n\n\t$.extend( div.style, {\n\t\tminHeight: \"100px\",\n\t\theight: \"auto\",\n\t\tpadding: 0,\n\t\tborderWidth: 0\n\t});\n\n\t$.support.minHeight = div.offsetHeight === 100;\n\t$.support.selectstart = \"onselectstart\" in div;\n\n\t// set display to none to avoid a layout bug in IE\n\t// http://dev.jquery.com/ticket/4014\n\tbody.removeChild( div ).style.display = \"none\";\n});\n\n// jQuery <1.4.3 uses curCSS, in 1.4.3 - 1.7.2 curCSS = css, 1.8+ only has css\nif ( !$.curCSS ) {\n\t$.curCSS = $.css;\n}\n\n\n\n\n\n// deprecated\n$.extend( $.ui, {\n\t// $.ui.plugin is deprecated.  Use the proxy pattern instead.\n\tplugin: {\n\t\tadd: function( module, option, set ) {\n\t\t\tvar proto = $.ui[ module ].prototype;\n\t\t\tfor ( var i in set ) {\n\t\t\t\tproto.plugins[ i ] = proto.plugins[ i ] || [];\n\t\t\t\tproto.plugins[ i ].push( [ option, set[ i ] ] );\n\t\t\t}\n\t\t},\n\t\tcall: function( instance, name, args ) {\n\t\t\tvar set = instance.plugins[ name ];\n\t\t\tif ( !set || !instance.element[ 0 ].parentNode ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tfor ( var i = 0; i < set.length; i++ ) {\n\t\t\t\tif ( instance.options[ set[ i ][ 0 ] ] ) {\n\t\t\t\t\tset[ i ][ 1 ].apply( instance.element, args );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\t\n\t// will be deprecated when we switch to jQuery 1.4 - use jQuery.contains()\n\tcontains: function( a, b ) {\n\t\treturn document.compareDocumentPosition ?\n\t\t\ta.compareDocumentPosition( b ) & 16 :\n\t\t\ta !== b && a.contains( b );\n\t},\n\t\n\t// only used by resizable\n\thasScroll: function( el, a ) {\n\t\n\t\t//If overflow is hidden, the element might have extra content, but the user wants to hide it\n\t\tif ( $( el ).css( \"overflow\" ) === \"hidden\") {\n\t\t\treturn false;\n\t\t}\n\t\n\t\tvar scroll = ( a && a === \"left\" ) ? \"scrollLeft\" : \"scrollTop\",\n\t\t\thas = false;\n\t\n\t\tif ( el[ scroll ] > 0 ) {\n\t\t\treturn true;\n\t\t}\n\t\n\t\t// TODO: determine which cases actually cause this to happen\n\t\t// if the element doesn't have the scroll set, see if it's possible to\n\t\t// set the scroll\n\t\tel[ scroll ] = 1;\n\t\thas = ( el[ scroll ] > 0 );\n\t\tel[ scroll ] = 0;\n\t\treturn has;\n\t},\n\t\n\t// these are odd functions, fix the API or move into individual plugins\n\tisOverAxis: function( x, reference, size ) {\n\t\t//Determines when x coordinate is over \"b\" element axis\n\t\treturn ( x > reference ) && ( x < ( reference + size ) );\n\t},\n\tisOver: function( y, x, top, left, height, width ) {\n\t\t//Determines when x, y coordinates is over \"b\" element\n\t\treturn $.ui.isOverAxis( y, top, height ) && $.ui.isOverAxis( x, left, width );\n\t}\n});\n\n})( jQuery );\n","/*!\n * jQuery UI Draggable 1.8.23\n *\n * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)\n * Dual licensed under the MIT or GPL Version 2 licenses.\n * http://jquery.org/license\n *\n * http://docs.jquery.com/UI/Draggables\n *\n * Depends:\n *\tjquery.ui.core.js\n *\tjquery.ui.mouse.js\n *\tjquery.ui.widget.js\n */\n(function( $, undefined ) {\n\n$.widget(\"ui.draggable\", $.ui.mouse, {\n\twidgetEventPrefix: \"drag\",\n\toptions: {\n\t\taddClasses: true,\n\t\tappendTo: \"parent\",\n\t\taxis: false,\n\t\tconnectToSortable: false,\n\t\tcontainment: false,\n\t\tcursor: \"auto\",\n\t\tcursorAt: false,\n\t\tgrid: false,\n\t\thandle: false,\n\t\thelper: \"original\",\n\t\tiframeFix: false,\n\t\topacity: false,\n\t\trefreshPositions: false,\n\t\trevert: false,\n\t\trevertDuration: 500,\n\t\tscope: \"default\",\n\t\tscroll: true,\n\t\tscrollSensitivity: 20,\n\t\tscrollSpeed: 20,\n\t\tsnap: false,\n\t\tsnapMode: \"both\",\n\t\tsnapTolerance: 20,\n\t\tstack: false,\n\t\tzIndex: false\n\t},\n\t_create: function() {\n\n\t\tif (this.options.helper == 'original' && !(/^(?:r|a|f)/).test(this.element.css(\"position\")))\n\t\t\tthis.element[0].style.position = 'relative';\n\n\t\t(this.options.addClasses && this.element.addClass(\"ui-draggable\"));\n\t\t(this.options.disabled && this.element.addClass(\"ui-draggable-disabled\"));\n\n\t\tthis._mouseInit();\n\n\t},\n\n\tdestroy: function() {\n\t\tif(!this.element.data('draggable')) return;\n\t\tthis.element\n\t\t\t.removeData(\"draggable\")\n\t\t\t.unbind(\".draggable\")\n\t\t\t.removeClass(\"ui-draggable\"\n\t\t\t\t+ \" ui-draggable-dragging\"\n\t\t\t\t+ \" ui-draggable-disabled\");\n\t\tthis._mouseDestroy();\n\n\t\treturn this;\n\t},\n\n\t_mouseCapture: function(event) {\n\n\t\tvar o = this.options;\n\n\t\t// among others, prevent a drag on a resizable-handle\n\t\tif (this.helper || o.disabled || $(event.target).is('.ui-resizable-handle'))\n\t\t\treturn false;\n\n\t\t//Quit if we're not on a valid handle\n\t\tthis.handle = this._getHandle(event);\n\t\tif (!this.handle)\n\t\t\treturn false;\n\t\t\n\t\tif ( o.iframeFix ) {\n\t\t\t$(o.iframeFix === true ? \"iframe\" : o.iframeFix).each(function() {\n\t\t\t\t$('<div class=\"ui-draggable-iframeFix\" style=\"background: #fff;\"></div>')\n\t\t\t\t.css({\n\t\t\t\t\twidth: this.offsetWidth+\"px\", height: this.offsetHeight+\"px\",\n\t\t\t\t\tposition: \"absolute\", opacity: \"0.001\", zIndex: 1000\n\t\t\t\t})\n\t\t\t\t.css($(this).offset())\n\t\t\t\t.appendTo(\"body\");\n\t\t\t});\n\t\t}\n\n\t\treturn true;\n\n\t},\n\n\t_mouseStart: function(event) {\n\n\t\tvar o = this.options;\n\n\t\t//Create and append the visible helper\n\t\tthis.helper = this._createHelper(event);\n\n\t\tthis.helper.addClass(\"ui-draggable-dragging\");\n\n\t\t//Cache the helper size\n\t\tthis._cacheHelperProportions();\n\n\t\t//If ddmanager is used for droppables, set the global draggable\n\t\tif($.ui.ddmanager)\n\t\t\t$.ui.ddmanager.current = this;\n\n\t\t/*\n\t\t * - Position generation -\n\t\t * This block generates everything position related - it's the core of draggables.\n\t\t */\n\n\t\t//Cache the margins of the original element\n\t\tthis._cacheMargins();\n\n\t\t//Store the helper's css position\n\t\tthis.cssPosition = this.helper.css(\"position\");\n\t\tthis.scrollParent = this.helper.scrollParent();\n\n\t\t//The element's absolute position on the page minus margins\n\t\tthis.offset = this.positionAbs = this.element.offset();\n\t\tthis.offset = {\n\t\t\ttop: this.offset.top - this.margins.top,\n\t\t\tleft: this.offset.left - this.margins.left\n\t\t};\n\n\t\t$.extend(this.offset, {\n\t\t\tclick: { //Where the click happened, relative to the element\n\t\t\t\tleft: event.pageX - this.offset.left,\n\t\t\t\ttop: event.pageY - this.offset.top\n\t\t\t},\n\t\t\tparent: this._getParentOffset(),\n\t\t\trelative: this._getRelativeOffset() //This is a relative to absolute position minus the actual position calculation - only used for relative positioned helper\n\t\t});\n\n\t\t//Generate the original position\n\t\tthis.originalPosition = this.position = this._generatePosition(event);\n\t\tthis.originalPageX = event.pageX;\n\t\tthis.originalPageY = event.pageY;\n\n\t\t//Adjust the mouse offset relative to the helper if 'cursorAt' is supplied\n\t\t(o.cursorAt && this._adjustOffsetFromHelper(o.cursorAt));\n\n\t\t//Set a containment if given in the options\n\t\tif(o.containment)\n\t\t\tthis._setContainment();\n\n\t\t//Trigger event + callbacks\n\t\tif(this._trigger(\"start\", event) === false) {\n\t\t\tthis._clear();\n\t\t\treturn false;\n\t\t}\n\n\t\t//Recache the helper size\n\t\tthis._cacheHelperProportions();\n\n\t\t//Prepare the droppable offsets\n\t\tif ($.ui.ddmanager && !o.dropBehaviour)\n\t\t\t$.ui.ddmanager.prepareOffsets(this, event);\n\n\t\t\n\t\tthis._mouseDrag(event, true); //Execute the drag once - this causes the helper not to be visible before getting its correct position\n\t\t\n\t\t//If the ddmanager is used for droppables, inform the manager that dragging has started (see #5003)\n\t\tif ( $.ui.ddmanager ) $.ui.ddmanager.dragStart(this, event);\n\t\t\n\t\treturn true;\n\t},\n\n\t_mouseDrag: function(event, noPropagation) {\n\n\t\t//Compute the helpers position\n\t\tthis.position = this._generatePosition(event);\n\t\tthis.positionAbs = this._convertPositionTo(\"absolute\");\n\n\t\t//Call plugins and callbacks and use the resulting position if something is returned\n\t\tif (!noPropagation) {\n\t\t\tvar ui = this._uiHash();\n\t\t\tif(this._trigger('drag', event, ui) === false) {\n\t\t\t\tthis._mouseUp({});\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.position = ui.position;\n\t\t}\n\n\t\tif(!this.options.axis || this.options.axis != \"y\") this.helper[0].style.left = this.position.left+'px';\n\t\tif(!this.options.axis || this.options.axis != \"x\") this.helper[0].style.top = this.position.top+'px';\n\t\tif($.ui.ddmanager) $.ui.ddmanager.drag(this, event);\n\n\t\treturn false;\n\t},\n\n\t_mouseStop: function(event) {\n\n\t\t//If we are using droppables, inform the manager about the drop\n\t\tvar dropped = false;\n\t\tif ($.ui.ddmanager && !this.options.dropBehaviour)\n\t\t\tdropped = $.ui.ddmanager.drop(this, event);\n\n\t\t//if a drop comes from outside (a sortable)\n\t\tif(this.dropped) {\n\t\t\tdropped = this.dropped;\n\t\t\tthis.dropped = false;\n\t\t}\n\t\t\n\t\t//if the original element is no longer in the DOM don't bother to continue (see #8269)\n\t\tvar element = this.element[0], elementInDom = false;\n\t\twhile ( element && (element = element.parentNode) ) {\n\t\t\tif (element == document ) {\n\t\t\t\telementInDom = true;\n\t\t\t}\n\t\t}\n\t\tif ( !elementInDom && this.options.helper === \"original\" )\n\t\t\treturn false;\n\n\t\tif((this.options.revert == \"invalid\" && !dropped) || (this.options.revert == \"valid\" && dropped) || this.options.revert === true || ($.isFunction(this.options.revert) && this.options.revert.call(this.element, dropped))) {\n\t\t\tvar self = this;\n\t\t\t$(this.helper).animate(this.originalPosition, parseInt(this.options.revertDuration, 10), function() {\n\t\t\t\tif(self._trigger(\"stop\", event) !== false) {\n\t\t\t\t\tself._clear();\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tif(this._trigger(\"stop\", event) !== false) {\n\t\t\t\tthis._clear();\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t},\n\t\n\t_mouseUp: function(event) {\n\t\tif (this.options.iframeFix === true) {\n\t\t\t$(\"div.ui-draggable-iframeFix\").each(function() { \n\t\t\t\tthis.parentNode.removeChild(this); \n\t\t\t}); //Remove frame helpers\n\t\t}\n\t\t\n\t\t//If the ddmanager is used for droppables, inform the manager that dragging has stopped (see #5003)\n\t\tif( $.ui.ddmanager ) $.ui.ddmanager.dragStop(this, event);\n\t\t\n\t\treturn $.ui.mouse.prototype._mouseUp.call(this, event);\n\t},\n\t\n\tcancel: function() {\n\t\t\n\t\tif(this.helper.is(\".ui-draggable-dragging\")) {\n\t\t\tthis._mouseUp({});\n\t\t} else {\n\t\t\tthis._clear();\n\t\t}\n\t\t\n\t\treturn this;\n\t\t\n\t},\n\n\t_getHandle: function(event) {\n\n\t\tvar handle = !this.options.handle || !$(this.options.handle, this.element).length ? true : false;\n\t\t$(this.options.handle, this.element)\n\t\t\t.find(\"*\")\n\t\t\t.andSelf()\n\t\t\t.each(function() {\n\t\t\t\tif(this == event.target) handle = true;\n\t\t\t});\n\n\t\treturn handle;\n\n\t},\n\n\t_createHelper: function(event) {\n\n\t\tvar o = this.options;\n\t\tvar helper = $.isFunction(o.helper) ? $(o.helper.apply(this.element[0], [event])) : (o.helper == 'clone' ? this.element.clone().removeAttr('id') : this.element);\n\n\t\tif(!helper.parents('body').length)\n\t\t\thelper.appendTo((o.appendTo == 'parent' ? this.element[0].parentNode : o.appendTo));\n\n\t\tif(helper[0] != this.element[0] && !(/(fixed|absolute)/).test(helper.css(\"position\")))\n\t\t\thelper.css(\"position\", \"absolute\");\n\n\t\treturn helper;\n\n\t},\n\n\t_adjustOffsetFromHelper: function(obj) {\n\t\tif (typeof obj == 'string') {\n\t\t\tobj = obj.split(' ');\n\t\t}\n\t\tif ($.isArray(obj)) {\n\t\t\tobj = {left: +obj[0], top: +obj[1] || 0};\n\t\t}\n\t\tif ('left' in obj) {\n\t\t\tthis.offset.click.left = obj.left + this.margins.left;\n\t\t}\n\t\tif ('right' in obj) {\n\t\t\tthis.offset.click.left = this.helperProportions.width - obj.right + this.margins.left;\n\t\t}\n\t\tif ('top' in obj) {\n\t\t\tthis.offset.click.top = obj.top + this.margins.top;\n\t\t}\n\t\tif ('bottom' in obj) {\n\t\t\tthis.offset.click.top = this.helperProportions.height - obj.bottom + this.margins.top;\n\t\t}\n\t},\n\n\t_getParentOffset: function() {\n\n\t\t//Get the offsetParent and cache its position\n\t\tthis.offsetParent = this.helper.offsetParent();\n\t\tvar po = this.offsetParent.offset();\n\n\t\t// This is a special case where we need to modify a offset calculated on start, since the following happened:\n\t\t// 1. The position of the helper is absolute, so it's position is calculated based on the next positioned parent\n\t\t// 2. The actual offset parent is a child of the scroll parent, and the scroll parent isn't the document, which means that\n\t\t//    the scroll is included in the initial calculation of the offset of the parent, and never recalculated upon drag\n\t\tif(this.cssPosition == 'absolute' && this.scrollParent[0] != document && $.ui.contains(this.scrollParent[0], this.offsetParent[0])) {\n\t\t\tpo.left += this.scrollParent.scrollLeft();\n\t\t\tpo.top += this.scrollParent.scrollTop();\n\t\t}\n\n\t\tif((this.offsetParent[0] == document.body) //This needs to be actually done for all browsers, since pageX/pageY includes this information\n\t\t|| (this.offsetParent[0].tagName && this.offsetParent[0].tagName.toLowerCase() == 'html' && $.browser.msie)) //Ugly IE fix\n\t\t\tpo = { top: 0, left: 0 };\n\n\t\treturn {\n\t\t\ttop: po.top + (parseInt(this.offsetParent.css(\"borderTopWidth\"),10) || 0),\n\t\t\tleft: po.left + (parseInt(this.offsetParent.css(\"borderLeftWidth\"),10) || 0)\n\t\t};\n\n\t},\n\n\t_getRelativeOffset: function() {\n\n\t\tif(this.cssPosition == \"relative\") {\n\t\t\tvar p = this.element.position();\n\t\t\treturn {\n\t\t\t\ttop: p.top - (parseInt(this.helper.css(\"top\"),10) || 0) + this.scrollParent.scrollTop(),\n\t\t\t\tleft: p.left - (parseInt(this.helper.css(\"left\"),10) || 0) + this.scrollParent.scrollLeft()\n\t\t\t};\n\t\t} else {\n\t\t\treturn { top: 0, left: 0 };\n\t\t}\n\n\t},\n\n\t_cacheMargins: function() {\n\t\tthis.margins = {\n\t\t\tleft: (parseInt(this.element.css(\"marginLeft\"),10) || 0),\n\t\t\ttop: (parseInt(this.element.css(\"marginTop\"),10) || 0),\n\t\t\tright: (parseInt(this.element.css(\"marginRight\"),10) || 0),\n\t\t\tbottom: (parseInt(this.element.css(\"marginBottom\"),10) || 0)\n\t\t};\n\t},\n\n\t_cacheHelperProportions: function() {\n\t\tthis.helperProportions = {\n\t\t\twidth: this.helper.outerWidth(),\n\t\t\theight: this.helper.outerHeight()\n\t\t};\n\t},\n\n\t_setContainment: function() {\n\n\t\tvar o = this.options;\n\t\tif(o.containment == 'parent') o.containment = this.helper[0].parentNode;\n\t\tif(o.containment == 'document' || o.containment == 'window') this.containment = [\n\t\t\to.containment == 'document' ? 0 : $(window).scrollLeft() - this.offset.relative.left - this.offset.parent.left,\n\t\t\to.containment == 'document' ? 0 : $(window).scrollTop() - this.offset.relative.top - this.offset.parent.top,\n\t\t\t(o.containment == 'document' ? 0 : $(window).scrollLeft()) + $(o.containment == 'document' ? document : window).width() - this.helperProportions.width - this.margins.left,\n\t\t\t(o.containment == 'document' ? 0 : $(window).scrollTop()) + ($(o.containment == 'document' ? document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top\n\t\t];\n\n\t\tif(!(/^(document|window|parent)$/).test(o.containment) && o.containment.constructor != Array) {\n\t\t        var c = $(o.containment);\n\t\t\tvar ce = c[0]; if(!ce) return;\n\t\t\tvar co = c.offset();\n\t\t\tvar over = ($(ce).css(\"overflow\") != 'hidden');\n\n\t\t\tthis.containment = [\n\t\t\t\t(parseInt($(ce).css(\"borderLeftWidth\"),10) || 0) + (parseInt($(ce).css(\"paddingLeft\"),10) || 0),\n\t\t\t\t(parseInt($(ce).css(\"borderTopWidth\"),10) || 0) + (parseInt($(ce).css(\"paddingTop\"),10) || 0),\n\t\t\t\t(over ? Math.max(ce.scrollWidth,ce.offsetWidth) : ce.offsetWidth) - (parseInt($(ce).css(\"borderLeftWidth\"),10) || 0) - (parseInt($(ce).css(\"paddingRight\"),10) || 0) - this.helperProportions.width - this.margins.left - this.margins.right,\n\t\t\t\t(over ? Math.max(ce.scrollHeight,ce.offsetHeight) : ce.offsetHeight) - (parseInt($(ce).css(\"borderTopWidth\"),10) || 0) - (parseInt($(ce).css(\"paddingBottom\"),10) || 0) - this.helperProportions.height - this.margins.top  - this.margins.bottom\n\t\t\t];\n\t\t\tthis.relative_container = c;\n\n\t\t} else if(o.containment.constructor == Array) {\n\t\t\tthis.containment = o.containment;\n\t\t}\n\n\t},\n\n\t_convertPositionTo: function(d, pos) {\n\n\t\tif(!pos) pos = this.position;\n\t\tvar mod = d == \"absolute\" ? 1 : -1;\n\t\tvar o = this.options, scroll = this.cssPosition == 'absolute' && !(this.scrollParent[0] != document && $.ui.contains(this.scrollParent[0], this.offsetParent[0])) ? this.offsetParent : this.scrollParent, scrollIsRootNode = (/(html|body)/i).test(scroll[0].tagName);\n\n\t\treturn {\n\t\t\ttop: (\n\t\t\t\tpos.top\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// The absolute mouse position\n\t\t\t\t+ this.offset.relative.top * mod\t\t\t\t\t\t\t\t\t\t// Only for relative positioned nodes: Relative offset from element to offset parent\n\t\t\t\t+ this.offset.parent.top * mod\t\t\t\t\t\t\t\t\t\t\t// The offsetParent's offset without borders (offset + border)\n\t\t\t\t- ($.browser.safari && $.browser.version < 526 && this.cssPosition == 'fixed' ? 0 : ( this.cssPosition == 'fixed' ? -this.scrollParent.scrollTop() : ( scrollIsRootNode ? 0 : scroll.scrollTop() ) ) * mod)\n\t\t\t),\n\t\t\tleft: (\n\t\t\t\tpos.left\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// The absolute mouse position\n\t\t\t\t+ this.offset.relative.left * mod\t\t\t\t\t\t\t\t\t\t// Only for relative positioned nodes: Relative offset from element to offset parent\n\t\t\t\t+ this.offset.parent.left * mod\t\t\t\t\t\t\t\t\t\t\t// The offsetParent's offset without borders (offset + border)\n\t\t\t\t- ($.browser.safari && $.browser.version < 526 && this.cssPosition == 'fixed' ? 0 : ( this.cssPosition == 'fixed' ? -this.scrollParent.scrollLeft() : scrollIsRootNode ? 0 : scroll.scrollLeft() ) * mod)\n\t\t\t)\n\t\t};\n\n\t},\n\n\t_generatePosition: function(event) {\n\n\t\tvar o = this.options, scroll = this.cssPosition == 'absolute' && !(this.scrollParent[0] != document && $.ui.contains(this.scrollParent[0], this.offsetParent[0])) ? this.offsetParent : this.scrollParent, scrollIsRootNode = (/(html|body)/i).test(scroll[0].tagName);\n\t\tvar pageX = event.pageX;\n\t\tvar pageY = event.pageY;\n\n\t\t/*\n\t\t * - Position constraining -\n\t\t * Constrain the position to a mix of grid, containment.\n\t\t */\n\n\t\tif(this.originalPosition) { //If we are not dragging yet, we won't check for options\n\t\t         var containment;\n\t\t         if(this.containment) {\n\t\t\t\t if (this.relative_container){\n\t\t\t\t     var co = this.relative_container.offset();\n\t\t\t\t     containment = [ this.containment[0] + co.left,\n\t\t\t\t\t\t     this.containment[1] + co.top,\n\t\t\t\t\t\t     this.containment[2] + co.left,\n\t\t\t\t\t\t     this.containment[3] + co.top ];\n\t\t\t\t }\n\t\t\t\t else {\n\t\t\t\t     containment = this.containment;\n\t\t\t\t }\n\n\t\t\t\tif(event.pageX - this.offset.click.left < containment[0]) pageX = containment[0] + this.offset.click.left;\n\t\t\t\tif(event.pageY - this.offset.click.top < containment[1]) pageY = containment[1] + this.offset.click.top;\n\t\t\t\tif(event.pageX - this.offset.click.left > containment[2]) pageX = containment[2] + this.offset.click.left;\n\t\t\t\tif(event.pageY - this.offset.click.top > containment[3]) pageY = containment[3] + this.offset.click.top;\n\t\t\t}\n\n\t\t\tif(o.grid) {\n\t\t\t\t//Check for grid elements set to 0 to prevent divide by 0 error causing invalid argument errors in IE (see ticket #6950)\n\t\t\t\tvar top = o.grid[1] ? this.originalPageY + Math.round((pageY - this.originalPageY) / o.grid[1]) * o.grid[1] : this.originalPageY;\n\t\t\t\tpageY = containment ? (!(top - this.offset.click.top < containment[1] || top - this.offset.click.top > containment[3]) ? top : (!(top - this.offset.click.top < containment[1]) ? top - o.grid[1] : top + o.grid[1])) : top;\n\n\t\t\t\tvar left = o.grid[0] ? this.originalPageX + Math.round((pageX - this.originalPageX) / o.grid[0]) * o.grid[0] : this.originalPageX;\n\t\t\t\tpageX = containment ? (!(left - this.offset.click.left < containment[0] || left - this.offset.click.left > containment[2]) ? left : (!(left - this.offset.click.left < containment[0]) ? left - o.grid[0] : left + o.grid[0])) : left;\n\t\t\t}\n\n\t\t}\n\n\t\treturn {\n\t\t\ttop: (\n\t\t\t\tpageY\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// The absolute mouse position\n\t\t\t\t- this.offset.click.top\t\t\t\t\t\t\t\t\t\t\t\t\t// Click offset (relative to the element)\n\t\t\t\t- this.offset.relative.top\t\t\t\t\t\t\t\t\t\t\t\t// Only for relative positioned nodes: Relative offset from element to offset parent\n\t\t\t\t- this.offset.parent.top\t\t\t\t\t\t\t\t\t\t\t\t// The offsetParent's offset without borders (offset + border)\n\t\t\t\t+ ($.browser.safari && $.browser.version < 526 && this.cssPosition == 'fixed' ? 0 : ( this.cssPosition == 'fixed' ? -this.scrollParent.scrollTop() : ( scrollIsRootNode ? 0 : scroll.scrollTop() ) ))\n\t\t\t),\n\t\t\tleft: (\n\t\t\t\tpageX\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// The absolute mouse position\n\t\t\t\t- this.offset.click.left\t\t\t\t\t\t\t\t\t\t\t\t// Click offset (relative to the element)\n\t\t\t\t- this.offset.relative.left\t\t\t\t\t\t\t\t\t\t\t\t// Only for relative positioned nodes: Relative offset from element to offset parent\n\t\t\t\t- this.offset.parent.left\t\t\t\t\t\t\t\t\t\t\t\t// The offsetParent's offset without borders (offset + border)\n\t\t\t\t+ ($.browser.safari && $.browser.version < 526 && this.cssPosition == 'fixed' ? 0 : ( this.cssPosition == 'fixed' ? -this.scrollParent.scrollLeft() : scrollIsRootNode ? 0 : scroll.scrollLeft() ))\n\t\t\t)\n\t\t};\n\n\t},\n\n\t_clear: function() {\n\t\tthis.helper.removeClass(\"ui-draggable-dragging\");\n\t\tif(this.helper[0] != this.element[0] && !this.cancelHelperRemoval) this.helper.remove();\n\t\t//if($.ui.ddmanager) $.ui.ddmanager.current = null;\n\t\tthis.helper = null;\n\t\tthis.cancelHelperRemoval = false;\n\t},\n\n\t// From now on bulk stuff - mainly helpers\n\n\t_trigger: function(type, event, ui) {\n\t\tui = ui || this._uiHash();\n\t\t$.ui.plugin.call(this, type, [event, ui]);\n\t\tif(type == \"drag\") this.positionAbs = this._convertPositionTo(\"absolute\"); //The absolute position has to be recalculated after plugins\n\t\treturn $.Widget.prototype._trigger.call(this, type, event, ui);\n\t},\n\n\tplugins: {},\n\n\t_uiHash: function(event) {\n\t\treturn {\n\t\t\thelper: this.helper,\n\t\t\tposition: this.position,\n\t\t\toriginalPosition: this.originalPosition,\n\t\t\toffset: this.positionAbs\n\t\t};\n\t}\n\n});\n\n$.extend($.ui.draggable, {\n\tversion: \"1.8.23\"\n});\n\n$.ui.plugin.add(\"draggable\", \"connectToSortable\", {\n\tstart: function(event, ui) {\n\n\t\tvar inst = $(this).data(\"draggable\"), o = inst.options,\n\t\t\tuiSortable = $.extend({}, ui, { item: inst.element });\n\t\tinst.sortables = [];\n\t\t$(o.connectToSortable).each(function() {\n\t\t\tvar sortable = $.data(this, 'sortable');\n\t\t\tif (sortable && !sortable.options.disabled) {\n\t\t\t\tinst.sortables.push({\n\t\t\t\t\tinstance: sortable,\n\t\t\t\t\tshouldRevert: sortable.options.revert\n\t\t\t\t});\n\t\t\t\tsortable.refreshPositions();\t// Call the sortable's refreshPositions at drag start to refresh the containerCache since the sortable container cache is used in drag and needs to be up to date (this will ensure it's initialised as well as being kept in step with any changes that might have happened on the page).\n\t\t\t\tsortable._trigger(\"activate\", event, uiSortable);\n\t\t\t}\n\t\t});\n\n\t},\n\tstop: function(event, ui) {\n\n\t\t//If we are still over the sortable, we fake the stop event of the sortable, but also remove helper\n\t\tvar inst = $(this).data(\"draggable\"),\n\t\t\tuiSortable = $.extend({}, ui, { item: inst.element });\n\n\t\t$.each(inst.sortables, function() {\n\t\t\tif(this.instance.isOver) {\n\n\t\t\t\tthis.instance.isOver = 0;\n\n\t\t\t\tinst.cancelHelperRemoval = true; //Don't remove the helper in the draggable instance\n\t\t\t\tthis.instance.cancelHelperRemoval = false; //Remove it in the sortable instance (so sortable plugins like revert still work)\n\n\t\t\t\t//The sortable revert is supported, and we have to set a temporary dropped variable on the draggable to support revert: 'valid/invalid'\n\t\t\t\tif(this.shouldRevert) this.instance.options.revert = true;\n\n\t\t\t\t//Trigger the stop of the sortable\n\t\t\t\tthis.instance._mouseStop(event);\n\n\t\t\t\tthis.instance.options.helper = this.instance.options._helper;\n\n\t\t\t\t//If the helper has been the original item, restore properties in the sortable\n\t\t\t\tif(inst.options.helper == 'original')\n\t\t\t\t\tthis.instance.currentItem.css({ top: 'auto', left: 'auto' });\n\n\t\t\t} else {\n\t\t\t\tthis.instance.cancelHelperRemoval = false; //Remove the helper in the sortable instance\n\t\t\t\tthis.instance._trigger(\"deactivate\", event, uiSortable);\n\t\t\t}\n\n\t\t});\n\n\t},\n\tdrag: function(event, ui) {\n\n\t\tvar inst = $(this).data(\"draggable\"), self = this;\n\n\t\tvar checkPos = function(o) {\n\t\t\tvar dyClick = this.offset.click.top, dxClick = this.offset.click.left;\n\t\t\tvar helperTop = this.positionAbs.top, helperLeft = this.positionAbs.left;\n\t\t\tvar itemHeight = o.height, itemWidth = o.width;\n\t\t\tvar itemTop = o.top, itemLeft = o.left;\n\n\t\t\treturn $.ui.isOver(helperTop + dyClick, helperLeft + dxClick, itemTop, itemLeft, itemHeight, itemWidth);\n\t\t};\n\n\t\t$.each(inst.sortables, function(i) {\n\t\t\t\n\t\t\t//Copy over some variables to allow calling the sortable's native _intersectsWith\n\t\t\tthis.instance.positionAbs = inst.positionAbs;\n\t\t\tthis.instance.helperProportions = inst.helperProportions;\n\t\t\tthis.instance.offset.click = inst.offset.click;\n\t\t\t\n\t\t\tif(this.instance._intersectsWith(this.instance.containerCache)) {\n\n\t\t\t\t//If it intersects, we use a little isOver variable and set it once, so our move-in stuff gets fired only once\n\t\t\t\tif(!this.instance.isOver) {\n\n\t\t\t\t\tthis.instance.isOver = 1;\n\t\t\t\t\t//Now we fake the start of dragging for the sortable instance,\n\t\t\t\t\t//by cloning the list group item, appending it to the sortable and using it as inst.currentItem\n\t\t\t\t\t//We can then fire the start event of the sortable with our passed browser event, and our own helper (so it doesn't create a new one)\n\t\t\t\t\tthis.instance.currentItem = $(self).clone().removeAttr('id').appendTo(this.instance.element).data(\"sortable-item\", true);\n\t\t\t\t\tthis.instance.options._helper = this.instance.options.helper; //Store helper option to later restore it\n\t\t\t\t\tthis.instance.options.helper = function() { return ui.helper[0]; };\n\n\t\t\t\t\tevent.target = this.instance.currentItem[0];\n\t\t\t\t\tthis.instance._mouseCapture(event, true);\n\t\t\t\t\tthis.instance._mouseStart(event, true, true);\n\n\t\t\t\t\t//Because the browser event is way off the new appended portlet, we modify a couple of variables to reflect the changes\n\t\t\t\t\tthis.instance.offset.click.top = inst.offset.click.top;\n\t\t\t\t\tthis.instance.offset.click.left = inst.offset.click.left;\n\t\t\t\t\tthis.instance.offset.parent.left -= inst.offset.parent.left - this.instance.offset.parent.left;\n\t\t\t\t\tthis.instance.offset.parent.top -= inst.offset.parent.top - this.instance.offset.parent.top;\n\n\t\t\t\t\tinst._trigger(\"toSortable\", event);\n\t\t\t\t\tinst.dropped = this.instance.element; //draggable revert needs that\n\t\t\t\t\t//hack so receive/update callbacks work (mostly)\n\t\t\t\t\tinst.currentItem = inst.element;\n\t\t\t\t\tthis.instance.fromOutside = inst;\n\n\t\t\t\t}\n\n\t\t\t\t//Provided we did all the previous steps, we can fire the drag event of the sortable on every draggable drag, when it intersects with the sortable\n\t\t\t\tif(this.instance.currentItem) this.instance._mouseDrag(event);\n\n\t\t\t} else {\n\n\t\t\t\t//If it doesn't intersect with the sortable, and it intersected before,\n\t\t\t\t//we fake the drag stop of the sortable, but make sure it doesn't remove the helper by using cancelHelperRemoval\n\t\t\t\tif(this.instance.isOver) {\n\n\t\t\t\t\tthis.instance.isOver = 0;\n\t\t\t\t\tthis.instance.cancelHelperRemoval = true;\n\t\t\t\t\t\n\t\t\t\t\t//Prevent reverting on this forced stop\n\t\t\t\t\tthis.instance.options.revert = false;\n\t\t\t\t\t\n\t\t\t\t\t// The out event needs to be triggered independently\n\t\t\t\t\tthis.instance._trigger('out', event, this.instance._uiHash(this.instance));\n\t\t\t\t\t\n\t\t\t\t\tthis.instance._mouseStop(event, true);\n\t\t\t\t\tthis.instance.options.helper = this.instance.options._helper;\n\n\t\t\t\t\t//Now we remove our currentItem, the list group clone again, and the placeholder, and animate the helper back to it's original size\n\t\t\t\t\tthis.instance.currentItem.remove();\n\t\t\t\t\tif(this.instance.placeholder) this.instance.placeholder.remove();\n\n\t\t\t\t\tinst._trigger(\"fromSortable\", event);\n\t\t\t\t\tinst.dropped = false; //draggable revert needs that\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t});\n\n\t}\n});\n\n$.ui.plugin.add(\"draggable\", \"cursor\", {\n\tstart: function(event, ui) {\n\t\tvar t = $('body'), o = $(this).data('draggable').options;\n\t\tif (t.css(\"cursor\")) o._cursor = t.css(\"cursor\");\n\t\tt.css(\"cursor\", o.cursor);\n\t},\n\tstop: function(event, ui) {\n\t\tvar o = $(this).data('draggable').options;\n\t\tif (o._cursor) $('body').css(\"cursor\", o._cursor);\n\t}\n});\n\n$.ui.plugin.add(\"draggable\", \"opacity\", {\n\tstart: function(event, ui) {\n\t\tvar t = $(ui.helper), o = $(this).data('draggable').options;\n\t\tif(t.css(\"opacity\")) o._opacity = t.css(\"opacity\");\n\t\tt.css('opacity', o.opacity);\n\t},\n\tstop: function(event, ui) {\n\t\tvar o = $(this).data('draggable').options;\n\t\tif(o._opacity) $(ui.helper).css('opacity', o._opacity);\n\t}\n});\n\n$.ui.plugin.add(\"draggable\", \"scroll\", {\n\tstart: function(event, ui) {\n\t\tvar i = $(this).data(\"draggable\");\n\t\tif(i.scrollParent[0] != document && i.scrollParent[0].tagName != 'HTML') i.overflowOffset = i.scrollParent.offset();\n\t},\n\tdrag: function(event, ui) {\n\n\t\tvar i = $(this).data(\"draggable\"), o = i.options, scrolled = false;\n\n\t\tif(i.scrollParent[0] != document && i.scrollParent[0].tagName != 'HTML') {\n\n\t\t\tif(!o.axis || o.axis != 'x') {\n\t\t\t\tif((i.overflowOffset.top + i.scrollParent[0].offsetHeight) - event.pageY < o.scrollSensitivity)\n\t\t\t\t\ti.scrollParent[0].scrollTop = scrolled = i.scrollParent[0].scrollTop + o.scrollSpeed;\n\t\t\t\telse if(event.pageY - i.overflowOffset.top < o.scrollSensitivity)\n\t\t\t\t\ti.scrollParent[0].scrollTop = scrolled = i.scrollParent[0].scrollTop - o.scrollSpeed;\n\t\t\t}\n\n\t\t\tif(!o.axis || o.axis != 'y') {\n\t\t\t\tif((i.overflowOffset.left + i.scrollParent[0].offsetWidth) - event.pageX < o.scrollSensitivity)\n\t\t\t\t\ti.scrollParent[0].scrollLeft = scrolled = i.scrollParent[0].scrollLeft + o.scrollSpeed;\n\t\t\t\telse if(event.pageX - i.overflowOffset.left < o.scrollSensitivity)\n\t\t\t\t\ti.scrollParent[0].scrollLeft = scrolled = i.scrollParent[0].scrollLeft - o.scrollSpeed;\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif(!o.axis || o.axis != 'x') {\n\t\t\t\tif(event.pageY - $(document).scrollTop() < o.scrollSensitivity)\n\t\t\t\t\tscrolled = $(document).scrollTop($(document).scrollTop() - o.scrollSpeed);\n\t\t\t\telse if($(window).height() - (event.pageY - $(document).scrollTop()) < o.scrollSensitivity)\n\t\t\t\t\tscrolled = $(document).scrollTop($(document).scrollTop() + o.scrollSpeed);\n\t\t\t}\n\n\t\t\tif(!o.axis || o.axis != 'y') {\n\t\t\t\tif(event.pageX - $(document).scrollLeft() < o.scrollSensitivity)\n\t\t\t\t\tscrolled = $(document).scrollLeft($(document).scrollLeft() - o.scrollSpeed);\n\t\t\t\telse if($(window).width() - (event.pageX - $(document).scrollLeft()) < o.scrollSensitivity)\n\t\t\t\t\tscrolled = $(document).scrollLeft($(document).scrollLeft() + o.scrollSpeed);\n\t\t\t}\n\n\t\t}\n\n\t\tif(scrolled !== false && $.ui.ddmanager && !o.dropBehaviour)\n\t\t\t$.ui.ddmanager.prepareOffsets(i, event);\n\n\t}\n});\n\n$.ui.plugin.add(\"draggable\", \"snap\", {\n\tstart: function(event, ui) {\n\n\t\tvar i = $(this).data(\"draggable\"), o = i.options;\n\t\ti.snapElements = [];\n\n\t\t$(o.snap.constructor != String ? ( o.snap.items || ':data(draggable)' ) : o.snap).each(function() {\n\t\t\tvar $t = $(this); var $o = $t.offset();\n\t\t\tif(this != i.element[0]) i.snapElements.push({\n\t\t\t\titem: this,\n\t\t\t\twidth: $t.outerWidth(), height: $t.outerHeight(),\n\t\t\t\ttop: $o.top, left: $o.left\n\t\t\t});\n\t\t});\n\n\t},\n\tdrag: function(event, ui) {\n\n\t\tvar inst = $(this).data(\"draggable\"), o = inst.options;\n\t\tvar d = o.snapTolerance;\n\n\t\tvar x1 = ui.offset.left, x2 = x1 + inst.helperProportions.width,\n\t\t\ty1 = ui.offset.top, y2 = y1 + inst.helperProportions.height;\n\n\t\tfor (var i = inst.snapElements.length - 1; i >= 0; i--){\n\n\t\t\tvar l = inst.snapElements[i].left, r = l + inst.snapElements[i].width,\n\t\t\t\tt = inst.snapElements[i].top, b = t + inst.snapElements[i].height;\n\n\t\t\t//Yes, I know, this is insane ;)\n\t\t\tif(!((l-d < x1 && x1 < r+d && t-d < y1 && y1 < b+d) || (l-d < x1 && x1 < r+d && t-d < y2 && y2 < b+d) || (l-d < x2 && x2 < r+d && t-d < y1 && y1 < b+d) || (l-d < x2 && x2 < r+d && t-d < y2 && y2 < b+d))) {\n\t\t\t\tif(inst.snapElements[i].snapping) (inst.options.snap.release && inst.options.snap.release.call(inst.element, event, $.extend(inst._uiHash(), { snapItem: inst.snapElements[i].item })));\n\t\t\t\tinst.snapElements[i].snapping = false;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(o.snapMode != 'inner') {\n\t\t\t\tvar ts = Math.abs(t - y2) <= d;\n\t\t\t\tvar bs = Math.abs(b - y1) <= d;\n\t\t\t\tvar ls = Math.abs(l - x2) <= d;\n\t\t\t\tvar rs = Math.abs(r - x1) <= d;\n\t\t\t\tif(ts) ui.position.top = inst._convertPositionTo(\"relative\", { top: t - inst.helperProportions.height, left: 0 }).top - inst.margins.top;\n\t\t\t\tif(bs) ui.position.top = inst._convertPositionTo(\"relative\", { top: b, left: 0 }).top - inst.margins.top;\n\t\t\t\tif(ls) ui.position.left = inst._convertPositionTo(\"relative\", { top: 0, left: l - inst.helperProportions.width }).left - inst.margins.left;\n\t\t\t\tif(rs) ui.position.left = inst._convertPositionTo(\"relative\", { top: 0, left: r }).left - inst.margins.left;\n\t\t\t}\n\n\t\t\tvar first = (ts || bs || ls || rs);\n\n\t\t\tif(o.snapMode != 'outer') {\n\t\t\t\tvar ts = Math.abs(t - y1) <= d;\n\t\t\t\tvar bs = Math.abs(b - y2) <= d;\n\t\t\t\tvar ls = Math.abs(l - x1) <= d;\n\t\t\t\tvar rs = Math.abs(r - x2) <= d;\n\t\t\t\tif(ts) ui.position.top = inst._convertPositionTo(\"relative\", { top: t, left: 0 }).top - inst.margins.top;\n\t\t\t\tif(bs) ui.position.top = inst._convertPositionTo(\"relative\", { top: b - inst.helperProportions.height, left: 0 }).top - inst.margins.top;\n\t\t\t\tif(ls) ui.position.left = inst._convertPositionTo(\"relative\", { top: 0, left: l }).left - inst.margins.left;\n\t\t\t\tif(rs) ui.position.left = inst._convertPositionTo(\"relative\", { top: 0, left: r - inst.helperProportions.width }).left - inst.margins.left;\n\t\t\t}\n\n\t\t\tif(!inst.snapElements[i].snapping && (ts || bs || ls || rs || first))\n\t\t\t\t(inst.options.snap.snap && inst.options.snap.snap.call(inst.element, event, $.extend(inst._uiHash(), { snapItem: inst.snapElements[i].item })));\n\t\t\tinst.snapElements[i].snapping = (ts || bs || ls || rs || first);\n\n\t\t};\n\n\t}\n});\n\n$.ui.plugin.add(\"draggable\", \"stack\", {\n\tstart: function(event, ui) {\n\n\t\tvar o = $(this).data(\"draggable\").options;\n\n\t\tvar group = $.makeArray($(o.stack)).sort(function(a,b) {\n\t\t\treturn (parseInt($(a).css(\"zIndex\"),10) || 0) - (parseInt($(b).css(\"zIndex\"),10) || 0);\n\t\t});\n\t\tif (!group.length) { return; }\n\t\t\n\t\tvar min = parseInt(group[0].style.zIndex) || 0;\n\t\t$(group).each(function(i) {\n\t\t\tthis.style.zIndex = min + i;\n\t\t});\n\n\t\tthis[0].style.zIndex = min + group.length;\n\n\t}\n});\n\n$.ui.plugin.add(\"draggable\", \"zIndex\", {\n\tstart: function(event, ui) {\n\t\tvar t = $(ui.helper), o = $(this).data(\"draggable\").options;\n\t\tif(t.css(\"zIndex\")) o._zIndex = t.css(\"zIndex\");\n\t\tt.css('zIndex', o.zIndex);\n\t},\n\tstop: function(event, ui) {\n\t\tvar o = $(this).data(\"draggable\").options;\n\t\tif(o._zIndex) $(ui.helper).css('zIndex', o._zIndex);\n\t}\n});\n\n})(jQuery);\n","/*!\n * jQuery UI Droppable 1.8.23\n *\n * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)\n * Dual licensed under the MIT or GPL Version 2 licenses.\n * http://jquery.org/license\n *\n * http://docs.jquery.com/UI/Droppables\n *\n * Depends:\n *\tjquery.ui.core.js\n *\tjquery.ui.widget.js\n *\tjquery.ui.mouse.js\n *\tjquery.ui.draggable.js\n */\n(function( $, undefined ) {\n\n$.widget(\"ui.droppable\", {\n\twidgetEventPrefix: \"drop\",\n\toptions: {\n\t\taccept: '*',\n\t\tactiveClass: false,\n\t\taddClasses: true,\n\t\tgreedy: false,\n\t\thoverClass: false,\n\t\tscope: 'default',\n\t\ttolerance: 'intersect'\n\t},\n\t_create: function() {\n\n\t\tvar o = this.options, accept = o.accept;\n\t\tthis.isover = 0; this.isout = 1;\n\n\t\tthis.accept = $.isFunction(accept) ? accept : function(d) {\n\t\t\treturn d.is(accept);\n\t\t};\n\n\t\t//Store the droppable's proportions\n\t\tthis.proportions = { width: this.element[0].offsetWidth, height: this.element[0].offsetHeight };\n\n\t\t// Add the reference and positions to the manager\n\t\t$.ui.ddmanager.droppables[o.scope] = $.ui.ddmanager.droppables[o.scope] || [];\n\t\t$.ui.ddmanager.droppables[o.scope].push(this);\n\n\t\t(o.addClasses && this.element.addClass(\"ui-droppable\"));\n\n\t},\n\n\tdestroy: function() {\n\t\tvar drop = $.ui.ddmanager.droppables[this.options.scope];\n\t\tfor ( var i = 0; i < drop.length; i++ )\n\t\t\tif ( drop[i] == this )\n\t\t\t\tdrop.splice(i, 1);\n\n\t\tthis.element\n\t\t\t.removeClass(\"ui-droppable ui-droppable-disabled\")\n\t\t\t.removeData(\"droppable\")\n\t\t\t.unbind(\".droppable\");\n\n\t\treturn this;\n\t},\n\n\t_setOption: function(key, value) {\n\n\t\tif(key == 'accept') {\n\t\t\tthis.accept = $.isFunction(value) ? value : function(d) {\n\t\t\t\treturn d.is(value);\n\t\t\t};\n\t\t}\n\t\t$.Widget.prototype._setOption.apply(this, arguments);\n\t},\n\n\t_activate: function(event) {\n\t\tvar draggable = $.ui.ddmanager.current;\n\t\tif(this.options.activeClass) this.element.addClass(this.options.activeClass);\n\t\t(draggable && this._trigger('activate', event, this.ui(draggable)));\n\t},\n\n\t_deactivate: function(event) {\n\t\tvar draggable = $.ui.ddmanager.current;\n\t\tif(this.options.activeClass) this.element.removeClass(this.options.activeClass);\n\t\t(draggable && this._trigger('deactivate', event, this.ui(draggable)));\n\t},\n\n\t_over: function(event) {\n\n\t\tvar draggable = $.ui.ddmanager.current;\n\t\tif (!draggable || (draggable.currentItem || draggable.element)[0] == this.element[0]) return; // Bail if draggable and droppable are same element\n\n\t\tif (this.accept.call(this.element[0],(draggable.currentItem || draggable.element))) {\n\t\t\tif(this.options.hoverClass) this.element.addClass(this.options.hoverClass);\n\t\t\tthis._trigger('over', event, this.ui(draggable));\n\t\t}\n\n\t},\n\n\t_out: function(event) {\n\n\t\tvar draggable = $.ui.ddmanager.current;\n\t\tif (!draggable || (draggable.currentItem || draggable.element)[0] == this.element[0]) return; // Bail if draggable and droppable are same element\n\n\t\tif (this.accept.call(this.element[0],(draggable.currentItem || draggable.element))) {\n\t\t\tif(this.options.hoverClass) this.element.removeClass(this.options.hoverClass);\n\t\t\tthis._trigger('out', event, this.ui(draggable));\n\t\t}\n\n\t},\n\n\t_drop: function(event,custom) {\n\n\t\tvar draggable = custom || $.ui.ddmanager.current;\n\t\tif (!draggable || (draggable.currentItem || draggable.element)[0] == this.element[0]) return false; // Bail if draggable and droppable are same element\n\n\t\tvar childrenIntersection = false;\n\t\tthis.element.find(\":data(droppable)\").not(\".ui-draggable-dragging\").each(function() {\n\t\t\tvar inst = $.data(this, 'droppable');\n\t\t\tif(\n\t\t\t\tinst.options.greedy\n\t\t\t\t&& !inst.options.disabled\n\t\t\t\t&& inst.options.scope == draggable.options.scope\n\t\t\t\t&& inst.accept.call(inst.element[0], (draggable.currentItem || draggable.element))\n\t\t\t\t&& $.ui.intersect(draggable, $.extend(inst, { offset: inst.element.offset() }), inst.options.tolerance)\n\t\t\t) { childrenIntersection = true; return false; }\n\t\t});\n\t\tif(childrenIntersection) return false;\n\n\t\tif(this.accept.call(this.element[0],(draggable.currentItem || draggable.element))) {\n\t\t\tif(this.options.activeClass) this.element.removeClass(this.options.activeClass);\n\t\t\tif(this.options.hoverClass) this.element.removeClass(this.options.hoverClass);\n\t\t\tthis._trigger('drop', event, this.ui(draggable));\n\t\t\treturn this.element;\n\t\t}\n\n\t\treturn false;\n\n\t},\n\n\tui: function(c) {\n\t\treturn {\n\t\t\tdraggable: (c.currentItem || c.element),\n\t\t\thelper: c.helper,\n\t\t\tposition: c.position,\n\t\t\toffset: c.positionAbs\n\t\t};\n\t}\n\n});\n\n$.extend($.ui.droppable, {\n\tversion: \"1.8.23\"\n});\n\n$.ui.intersect = function(draggable, droppable, toleranceMode) {\n\n\tif (!droppable.offset) return false;\n\n\tvar x1 = (draggable.positionAbs || draggable.position.absolute).left, x2 = x1 + draggable.helperProportions.width,\n\t\ty1 = (draggable.positionAbs || draggable.position.absolute).top, y2 = y1 + draggable.helperProportions.height;\n\tvar l = droppable.offset.left, r = l + droppable.proportions.width,\n\t\tt = droppable.offset.top, b = t + droppable.proportions.height;\n\n\tswitch (toleranceMode) {\n\t\tcase 'fit':\n\t\t\treturn (l <= x1 && x2 <= r\n\t\t\t\t&& t <= y1 && y2 <= b);\n\t\t\tbreak;\n\t\tcase 'intersect':\n\t\t\treturn (l < x1 + (draggable.helperProportions.width / 2) // Right Half\n\t\t\t\t&& x2 - (draggable.helperProportions.width / 2) < r // Left Half\n\t\t\t\t&& t < y1 + (draggable.helperProportions.height / 2) // Bottom Half\n\t\t\t\t&& y2 - (draggable.helperProportions.height / 2) < b ); // Top Half\n\t\t\tbreak;\n\t\tcase 'pointer':\n\t\t\tvar draggableLeft = ((draggable.positionAbs || draggable.position.absolute).left + (draggable.clickOffset || draggable.offset.click).left),\n\t\t\t\tdraggableTop = ((draggable.positionAbs || draggable.position.absolute).top + (draggable.clickOffset || draggable.offset.click).top),\n\t\t\t\tisOver = $.ui.isOver(draggableTop, draggableLeft, t, l, droppable.proportions.height, droppable.proportions.width);\n\t\t\treturn isOver;\n\t\t\tbreak;\n\t\tcase 'touch':\n\t\t\treturn (\n\t\t\t\t\t(y1 >= t && y1 <= b) ||\t// Top edge touching\n\t\t\t\t\t(y2 >= t && y2 <= b) ||\t// Bottom edge touching\n\t\t\t\t\t(y1 < t && y2 > b)\t\t// Surrounded vertically\n\t\t\t\t) && (\n\t\t\t\t\t(x1 >= l && x1 <= r) ||\t// Left edge touching\n\t\t\t\t\t(x2 >= l && x2 <= r) ||\t// Right edge touching\n\t\t\t\t\t(x1 < l && x2 > r)\t\t// Surrounded horizontally\n\t\t\t\t);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn false;\n\t\t\tbreak;\n\t\t}\n\n};\n\n/*\n\tThis manager tracks offsets of draggables and droppables\n*/\n$.ui.ddmanager = {\n\tcurrent: null,\n\tdroppables: { 'default': [] },\n\tprepareOffsets: function(t, event) {\n\n\t\tvar m = $.ui.ddmanager.droppables[t.options.scope] || [];\n\t\tvar type = event ? event.type : null; // workaround for #2317\n\t\tvar list = (t.currentItem || t.element).find(\":data(droppable)\").andSelf();\n\n\t\tdroppablesLoop: for (var i = 0; i < m.length; i++) {\n\n\t\t\tif(m[i].options.disabled || (t && !m[i].accept.call(m[i].element[0],(t.currentItem || t.element)))) continue;\t//No disabled and non-accepted\n\t\t\tfor (var j=0; j < list.length; j++) { if(list[j] == m[i].element[0]) { m[i].proportions.height = 0; continue droppablesLoop; } }; //Filter out elements in the current dragged item\n\t\t\tm[i].visible = m[i].element.css(\"display\") != \"none\"; if(!m[i].visible) continue; \t\t\t\t\t\t\t\t\t//If the element is not visible, continue\n\n\t\t\tif(type == \"mousedown\") m[i]._activate.call(m[i], event); //Activate the droppable if used directly from draggables\n\n\t\t\tm[i].offset = m[i].element.offset();\n\t\t\tm[i].proportions = { width: m[i].element[0].offsetWidth, height: m[i].element[0].offsetHeight };\n\n\t\t}\n\n\t},\n\tdrop: function(draggable, event) {\n\n\t\tvar dropped = false;\n\t\t$.each($.ui.ddmanager.droppables[draggable.options.scope] || [], function() {\n\n\t\t\tif(!this.options) return;\n\t\t\tif (!this.options.disabled && this.visible && $.ui.intersect(draggable, this, this.options.tolerance))\n\t\t\t\tdropped = this._drop.call(this, event) || dropped;\n\n\t\t\tif (!this.options.disabled && this.visible && this.accept.call(this.element[0],(draggable.currentItem || draggable.element))) {\n\t\t\t\tthis.isout = 1; this.isover = 0;\n\t\t\t\tthis._deactivate.call(this, event);\n\t\t\t}\n\n\t\t});\n\t\treturn dropped;\n\n\t},\n\tdragStart: function( draggable, event ) {\n\t\t//Listen for scrolling so that if the dragging causes scrolling the position of the droppables can be recalculated (see #5003)\n\t\tdraggable.element.parents( \":not(body,html)\" ).bind( \"scroll.droppable\", function() {\n\t\t\tif( !draggable.options.refreshPositions ) $.ui.ddmanager.prepareOffsets( draggable, event );\n\t\t});\n\t},\n\tdrag: function(draggable, event) {\n\n\t\t//If you have a highly dynamic page, you might try this option. It renders positions every time you move the mouse.\n\t\tif(draggable.options.refreshPositions) $.ui.ddmanager.prepareOffsets(draggable, event);\n\n\t\t//Run through all droppables and check their positions based on specific tolerance options\n\t\t$.each($.ui.ddmanager.droppables[draggable.options.scope] || [], function() {\n\n\t\t\tif(this.options.disabled || this.greedyChild || !this.visible) return;\n\t\t\tvar intersects = $.ui.intersect(draggable, this, this.options.tolerance);\n\n\t\t\tvar c = !intersects && this.isover == 1 ? 'isout' : (intersects && this.isover == 0 ? 'isover' : null);\n\t\t\tif(!c) return;\n\n\t\t\tvar parentInstance;\n\t\t\tif (this.options.greedy) {\n\t\t\t\tvar parent = this.element.parents(':data(droppable):eq(0)');\n\t\t\t\tif (parent.length) {\n\t\t\t\t\tparentInstance = $.data(parent[0], 'droppable');\n\t\t\t\t\tparentInstance.greedyChild = (c == 'isover' ? 1 : 0);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// we just moved into a greedy child\n\t\t\tif (parentInstance && c == 'isover') {\n\t\t\t\tparentInstance['isover'] = 0;\n\t\t\t\tparentInstance['isout'] = 1;\n\t\t\t\tparentInstance._out.call(parentInstance, event);\n\t\t\t}\n\n\t\t\tthis[c] = 1; this[c == 'isout' ? 'isover' : 'isout'] = 0;\n\t\t\tthis[c == \"isover\" ? \"_over\" : \"_out\"].call(this, event);\n\n\t\t\t// we just moved out of a greedy child\n\t\t\tif (parentInstance && c == 'isout') {\n\t\t\t\tparentInstance['isout'] = 0;\n\t\t\t\tparentInstance['isover'] = 1;\n\t\t\t\tparentInstance._over.call(parentInstance, event);\n\t\t\t}\n\t\t});\n\n\t},\n\tdragStop: function( draggable, event ) {\n\t\tdraggable.element.parents( \":not(body,html)\" ).unbind( \"scroll.droppable\" );\n\t\t//Call prepareOffsets one final time since IE does not fire return scroll events when overflow was caused by drag (see #5003)\n\t\tif( !draggable.options.refreshPositions ) $.ui.ddmanager.prepareOffsets( draggable, event );\n\t}\n};\n\n})(jQuery);\n","/*!\n * jQuery UI Mouse 1.8.23\n *\n * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)\n * Dual licensed under the MIT or GPL Version 2 licenses.\n * http://jquery.org/license\n *\n * http://docs.jquery.com/UI/Mouse\n *\n * Depends:\n *\tjquery.ui.widget.js\n */\n(function( $, undefined ) {\n\nvar mouseHandled = false;\n$( document ).mouseup( function( e ) {\n\tmouseHandled = false;\n});\n\n$.widget(\"ui.mouse\", {\n\toptions: {\n\t\tcancel: ':input,option',\n\t\tdistance: 1,\n\t\tdelay: 0\n\t},\n\t_mouseInit: function() {\n\t\tvar self = this;\n\n\t\tthis.element\n\t\t\t.bind('mousedown.'+this.widgetName, function(event) {\n\t\t\t\treturn self._mouseDown(event);\n\t\t\t})\n\t\t\t.bind('click.'+this.widgetName, function(event) {\n\t\t\t\tif (true === $.data(event.target, self.widgetName + '.preventClickEvent')) {\n\t\t\t\t    $.removeData(event.target, self.widgetName + '.preventClickEvent');\n\t\t\t\t\tevent.stopImmediatePropagation();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\n\t\tthis.started = false;\n\t},\n\n\t// TODO: make sure destroying one instance of mouse doesn't mess with\n\t// other instances of mouse\n\t_mouseDestroy: function() {\n\t\tthis.element.unbind('.'+this.widgetName);\n\t\tif ( this._mouseMoveDelegate ) {\n\t\t\t$(document)\n\t\t\t\t.unbind('mousemove.'+this.widgetName, this._mouseMoveDelegate)\n\t\t\t\t.unbind('mouseup.'+this.widgetName, this._mouseUpDelegate);\n\t\t}\n\t},\n\n\t_mouseDown: function(event) {\n\t\t// don't let more than one widget handle mouseStart\n\t\tif( mouseHandled ) { return };\n\n\t\t// we may have missed mouseup (out of window)\n\t\t(this._mouseStarted && this._mouseUp(event));\n\n\t\tthis._mouseDownEvent = event;\n\n\t\tvar self = this,\n\t\t\tbtnIsLeft = (event.which == 1),\n\t\t\t// event.target.nodeName works around a bug in IE 8 with\n\t\t\t// disabled inputs (#7620)\n\t\t\telIsCancel = (typeof this.options.cancel == \"string\" && event.target.nodeName ? $(event.target).closest(this.options.cancel).length : false);\n\t\tif (!btnIsLeft || elIsCancel || !this._mouseCapture(event)) {\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.mouseDelayMet = !this.options.delay;\n\t\tif (!this.mouseDelayMet) {\n\t\t\tthis._mouseDelayTimer = setTimeout(function() {\n\t\t\t\tself.mouseDelayMet = true;\n\t\t\t}, this.options.delay);\n\t\t}\n\n\t\tif (this._mouseDistanceMet(event) && this._mouseDelayMet(event)) {\n\t\t\tthis._mouseStarted = (this._mouseStart(event) !== false);\n\t\t\tif (!this._mouseStarted) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\t// Click event may never have fired (Gecko & Opera)\n\t\tif (true === $.data(event.target, this.widgetName + '.preventClickEvent')) {\n\t\t\t$.removeData(event.target, this.widgetName + '.preventClickEvent');\n\t\t}\n\n\t\t// these delegates are required to keep context\n\t\tthis._mouseMoveDelegate = function(event) {\n\t\t\treturn self._mouseMove(event);\n\t\t};\n\t\tthis._mouseUpDelegate = function(event) {\n\t\t\treturn self._mouseUp(event);\n\t\t};\n\t\t$(document)\n\t\t\t.bind('mousemove.'+this.widgetName, this._mouseMoveDelegate)\n\t\t\t.bind('mouseup.'+this.widgetName, this._mouseUpDelegate);\n\n\t\tevent.preventDefault();\n\t\t\n\t\tmouseHandled = true;\n\t\treturn true;\n\t},\n\n\t_mouseMove: function(event) {\n\t\t// IE mouseup check - mouseup happened when mouse was out of window\n\t\tif ($.browser.msie && !(document.documentMode >= 9) && !event.button) {\n\t\t\treturn this._mouseUp(event);\n\t\t}\n\n\t\tif (this._mouseStarted) {\n\t\t\tthis._mouseDrag(event);\n\t\t\treturn event.preventDefault();\n\t\t}\n\n\t\tif (this._mouseDistanceMet(event) && this._mouseDelayMet(event)) {\n\t\t\tthis._mouseStarted =\n\t\t\t\t(this._mouseStart(this._mouseDownEvent, event) !== false);\n\t\t\t(this._mouseStarted ? this._mouseDrag(event) : this._mouseUp(event));\n\t\t}\n\n\t\treturn !this._mouseStarted;\n\t},\n\n\t_mouseUp: function(event) {\n\t\t$(document)\n\t\t\t.unbind('mousemove.'+this.widgetName, this._mouseMoveDelegate)\n\t\t\t.unbind('mouseup.'+this.widgetName, this._mouseUpDelegate);\n\n\t\tif (this._mouseStarted) {\n\t\t\tthis._mouseStarted = false;\n\n\t\t\tif (event.target == this._mouseDownEvent.target) {\n\t\t\t    $.data(event.target, this.widgetName + '.preventClickEvent', true);\n\t\t\t}\n\n\t\t\tthis._mouseStop(event);\n\t\t}\n\n\t\treturn false;\n\t},\n\n\t_mouseDistanceMet: function(event) {\n\t\treturn (Math.max(\n\t\t\t\tMath.abs(this._mouseDownEvent.pageX - event.pageX),\n\t\t\t\tMath.abs(this._mouseDownEvent.pageY - event.pageY)\n\t\t\t) >= this.options.distance\n\t\t);\n\t},\n\n\t_mouseDelayMet: function(event) {\n\t\treturn this.mouseDelayMet;\n\t},\n\n\t// These are placeholder methods, to be overriden by extending plugin\n\t_mouseStart: function(event) {},\n\t_mouseDrag: function(event) {},\n\t_mouseStop: function(event) {},\n\t_mouseCapture: function(event) { return true; }\n});\n\n})(jQuery);\n","/*!\n * jQuery UI Position 1.8.23\n *\n * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)\n * Dual licensed under the MIT or GPL Version 2 licenses.\n * http://jquery.org/license\n *\n * http://docs.jquery.com/UI/Position\n */\n(function( $, undefined ) {\n\n$.ui = $.ui || {};\n\nvar horizontalPositions = /left|center|right/,\n\tverticalPositions = /top|center|bottom/,\n\tcenter = \"center\",\n\tsupport = {},\n\t_position = $.fn.position,\n\t_offset = $.fn.offset;\n\n$.fn.position = function( options ) {\n\tif ( !options || !options.of ) {\n\t\treturn _position.apply( this, arguments );\n\t}\n\n\t// make a copy, we don't want to modify arguments\n\toptions = $.extend( {}, options );\n\n\tvar target = $( options.of ),\n\t\ttargetElem = target[0],\n\t\tcollision = ( options.collision || \"flip\" ).split( \" \" ),\n\t\toffset = options.offset ? options.offset.split( \" \" ) : [ 0, 0 ],\n\t\ttargetWidth,\n\t\ttargetHeight,\n\t\tbasePosition;\n\n\tif ( targetElem.nodeType === 9 ) {\n\t\ttargetWidth = target.width();\n\t\ttargetHeight = target.height();\n\t\tbasePosition = { top: 0, left: 0 };\n\t// TODO: use $.isWindow() in 1.9\n\t} else if ( targetElem.setTimeout ) {\n\t\ttargetWidth = target.width();\n\t\ttargetHeight = target.height();\n\t\tbasePosition = { top: target.scrollTop(), left: target.scrollLeft() };\n\t} else if ( targetElem.preventDefault ) {\n\t\t// force left top to allow flipping\n\t\toptions.at = \"left top\";\n\t\ttargetWidth = targetHeight = 0;\n\t\tbasePosition = { top: options.of.pageY, left: options.of.pageX };\n\t} else {\n\t\ttargetWidth = target.outerWidth();\n\t\ttargetHeight = target.outerHeight();\n\t\tbasePosition = target.offset();\n\t}\n\n\t// force my and at to have valid horizontal and veritcal positions\n\t// if a value is missing or invalid, it will be converted to center \n\t$.each( [ \"my\", \"at\" ], function() {\n\t\tvar pos = ( options[this] || \"\" ).split( \" \" );\n\t\tif ( pos.length === 1) {\n\t\t\tpos = horizontalPositions.test( pos[0] ) ?\n\t\t\t\tpos.concat( [center] ) :\n\t\t\t\tverticalPositions.test( pos[0] ) ?\n\t\t\t\t\t[ center ].concat( pos ) :\n\t\t\t\t\t[ center, center ];\n\t\t}\n\t\tpos[ 0 ] = horizontalPositions.test( pos[0] ) ? pos[ 0 ] : center;\n\t\tpos[ 1 ] = verticalPositions.test( pos[1] ) ? pos[ 1 ] : center;\n\t\toptions[ this ] = pos;\n\t});\n\n\t// normalize collision option\n\tif ( collision.length === 1 ) {\n\t\tcollision[ 1 ] = collision[ 0 ];\n\t}\n\n\t// normalize offset option\n\toffset[ 0 ] = parseInt( offset[0], 10 ) || 0;\n\tif ( offset.length === 1 ) {\n\t\toffset[ 1 ] = offset[ 0 ];\n\t}\n\toffset[ 1 ] = parseInt( offset[1], 10 ) || 0;\n\n\tif ( options.at[0] === \"right\" ) {\n\t\tbasePosition.left += targetWidth;\n\t} else if ( options.at[0] === center ) {\n\t\tbasePosition.left += targetWidth / 2;\n\t}\n\n\tif ( options.at[1] === \"bottom\" ) {\n\t\tbasePosition.top += targetHeight;\n\t} else if ( options.at[1] === center ) {\n\t\tbasePosition.top += targetHeight / 2;\n\t}\n\n\tbasePosition.left += offset[ 0 ];\n\tbasePosition.top += offset[ 1 ];\n\n\treturn this.each(function() {\n\t\tvar elem = $( this ),\n\t\t\telemWidth = elem.outerWidth(),\n\t\t\telemHeight = elem.outerHeight(),\n\t\t\tmarginLeft = parseInt( $.curCSS( this, \"marginLeft\", true ) ) || 0,\n\t\t\tmarginTop = parseInt( $.curCSS( this, \"marginTop\", true ) ) || 0,\n\t\t\tcollisionWidth = elemWidth + marginLeft +\n\t\t\t\t( parseInt( $.curCSS( this, \"marginRight\", true ) ) || 0 ),\n\t\t\tcollisionHeight = elemHeight + marginTop +\n\t\t\t\t( parseInt( $.curCSS( this, \"marginBottom\", true ) ) || 0 ),\n\t\t\tposition = $.extend( {}, basePosition ),\n\t\t\tcollisionPosition;\n\n\t\tif ( options.my[0] === \"right\" ) {\n\t\t\tposition.left -= elemWidth;\n\t\t} else if ( options.my[0] === center ) {\n\t\t\tposition.left -= elemWidth / 2;\n\t\t}\n\n\t\tif ( options.my[1] === \"bottom\" ) {\n\t\t\tposition.top -= elemHeight;\n\t\t} else if ( options.my[1] === center ) {\n\t\t\tposition.top -= elemHeight / 2;\n\t\t}\n\n\t\t// prevent fractions if jQuery version doesn't support them (see #5280)\n\t\tif ( !support.fractions ) {\n\t\t\tposition.left = Math.round( position.left );\n\t\t\tposition.top = Math.round( position.top );\n\t\t}\n\n\t\tcollisionPosition = {\n\t\t\tleft: position.left - marginLeft,\n\t\t\ttop: position.top - marginTop\n\t\t};\n\n\t\t$.each( [ \"left\", \"top\" ], function( i, dir ) {\n\t\t\tif ( $.ui.position[ collision[i] ] ) {\n\t\t\t\t$.ui.position[ collision[i] ][ dir ]( position, {\n\t\t\t\t\ttargetWidth: targetWidth,\n\t\t\t\t\ttargetHeight: targetHeight,\n\t\t\t\t\telemWidth: elemWidth,\n\t\t\t\t\telemHeight: elemHeight,\n\t\t\t\t\tcollisionPosition: collisionPosition,\n\t\t\t\t\tcollisionWidth: collisionWidth,\n\t\t\t\t\tcollisionHeight: collisionHeight,\n\t\t\t\t\toffset: offset,\n\t\t\t\t\tmy: options.my,\n\t\t\t\t\tat: options.at\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tif ( $.fn.bgiframe ) {\n\t\t\telem.bgiframe();\n\t\t}\n\t\telem.offset( $.extend( position, { using: options.using } ) );\n\t});\n};\n\n$.ui.position = {\n\tfit: {\n\t\tleft: function( position, data ) {\n\t\t\tvar win = $( window ),\n\t\t\t\tover = data.collisionPosition.left + data.collisionWidth - win.width() - win.scrollLeft();\n\t\t\tposition.left = over > 0 ? position.left - over : Math.max( position.left - data.collisionPosition.left, position.left );\n\t\t},\n\t\ttop: function( position, data ) {\n\t\t\tvar win = $( window ),\n\t\t\t\tover = data.collisionPosition.top + data.collisionHeight - win.height() - win.scrollTop();\n\t\t\tposition.top = over > 0 ? position.top - over : Math.max( position.top - data.collisionPosition.top, position.top );\n\t\t}\n\t},\n\n\tflip: {\n\t\tleft: function( position, data ) {\n\t\t\tif ( data.at[0] === center ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar win = $( window ),\n\t\t\t\tover = data.collisionPosition.left + data.collisionWidth - win.width() - win.scrollLeft(),\n\t\t\t\tmyOffset = data.my[ 0 ] === \"left\" ?\n\t\t\t\t\t-data.elemWidth :\n\t\t\t\t\tdata.my[ 0 ] === \"right\" ?\n\t\t\t\t\t\tdata.elemWidth :\n\t\t\t\t\t\t0,\n\t\t\t\tatOffset = data.at[ 0 ] === \"left\" ?\n\t\t\t\t\tdata.targetWidth :\n\t\t\t\t\t-data.targetWidth,\n\t\t\t\toffset = -2 * data.offset[ 0 ];\n\t\t\tposition.left += data.collisionPosition.left < 0 ?\n\t\t\t\tmyOffset + atOffset + offset :\n\t\t\t\tover > 0 ?\n\t\t\t\t\tmyOffset + atOffset + offset :\n\t\t\t\t\t0;\n\t\t},\n\t\ttop: function( position, data ) {\n\t\t\tif ( data.at[1] === center ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar win = $( window ),\n\t\t\t\tover = data.collisionPosition.top + data.collisionHeight - win.height() - win.scrollTop(),\n\t\t\t\tmyOffset = data.my[ 1 ] === \"top\" ?\n\t\t\t\t\t-data.elemHeight :\n\t\t\t\t\tdata.my[ 1 ] === \"bottom\" ?\n\t\t\t\t\t\tdata.elemHeight :\n\t\t\t\t\t\t0,\n\t\t\t\tatOffset = data.at[ 1 ] === \"top\" ?\n\t\t\t\t\tdata.targetHeight :\n\t\t\t\t\t-data.targetHeight,\n\t\t\t\toffset = -2 * data.offset[ 1 ];\n\t\t\tposition.top += data.collisionPosition.top < 0 ?\n\t\t\t\tmyOffset + atOffset + offset :\n\t\t\t\tover > 0 ?\n\t\t\t\t\tmyOffset + atOffset + offset :\n\t\t\t\t\t0;\n\t\t}\n\t}\n};\n\n// offset setter from jQuery 1.4\nif ( !$.offset.setOffset ) {\n\t$.offset.setOffset = function( elem, options ) {\n\t\t// set position first, in-case top/left are set even on static elem\n\t\tif ( /static/.test( $.curCSS( elem, \"position\" ) ) ) {\n\t\t\telem.style.position = \"relative\";\n\t\t}\n\t\tvar curElem   = $( elem ),\n\t\t\tcurOffset = curElem.offset(),\n\t\t\tcurTop    = parseInt( $.curCSS( elem, \"top\",  true ), 10 ) || 0,\n\t\t\tcurLeft   = parseInt( $.curCSS( elem, \"left\", true ), 10)  || 0,\n\t\t\tprops     = {\n\t\t\t\ttop:  (options.top  - curOffset.top)  + curTop,\n\t\t\t\tleft: (options.left - curOffset.left) + curLeft\n\t\t\t};\n\t\t\n\t\tif ( 'using' in options ) {\n\t\t\toptions.using.call( elem, props );\n\t\t} else {\n\t\t\tcurElem.css( props );\n\t\t}\n\t};\n\n\t$.fn.offset = function( options ) {\n\t\tvar elem = this[ 0 ];\n\t\tif ( !elem || !elem.ownerDocument ) { return null; }\n\t\tif ( options ) {\n\t\t\tif ( $.isFunction( options ) ) {\n\t\t\t\treturn this.each(function( i ) {\n\t\t\t\t\t$( this ).offset( options.call( this, i, $( this ).offset() ) );\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn this.each(function() {\n\t\t\t\t$.offset.setOffset( this, options );\n\t\t\t});\n\t\t}\n\t\treturn _offset.call( this );\n\t};\n}\n\n// jQuery <1.4.3 uses curCSS, in 1.4.3 - 1.7.2 curCSS = css, 1.8+ only has css\nif ( !$.curCSS ) {\n\t$.curCSS = $.css;\n}\n\n// fraction support test (older versions of jQuery don't support fractions)\n(function () {\n\tvar body = document.getElementsByTagName( \"body\" )[ 0 ], \n\t\tdiv = document.createElement( \"div\" ),\n\t\ttestElement, testElementParent, testElementStyle, offset, offsetTotal;\n\n\t//Create a \"fake body\" for testing based on method used in jQuery.support\n\ttestElement = document.createElement( body ? \"div\" : \"body\" );\n\ttestElementStyle = {\n\t\tvisibility: \"hidden\",\n\t\twidth: 0,\n\t\theight: 0,\n\t\tborder: 0,\n\t\tmargin: 0,\n\t\tbackground: \"none\"\n\t};\n\tif ( body ) {\n\t\t$.extend( testElementStyle, {\n\t\t\tposition: \"absolute\",\n\t\t\tleft: \"-1000px\",\n\t\t\ttop: \"-1000px\"\n\t\t});\n\t}\n\tfor ( var i in testElementStyle ) {\n\t\ttestElement.style[ i ] = testElementStyle[ i ];\n\t}\n\ttestElement.appendChild( div );\n\ttestElementParent = body || document.documentElement;\n\ttestElementParent.insertBefore( testElement, testElementParent.firstChild );\n\n\tdiv.style.cssText = \"position: absolute; left: 10.7432222px; top: 10.432325px; height: 30px; width: 201px;\";\n\n\toffset = $( div ).offset( function( _, offset ) {\n\t\treturn offset;\n\t}).offset();\n\n\ttestElement.innerHTML = \"\";\n\ttestElementParent.removeChild( testElement );\n\n\toffsetTotal = offset.top + offset.left + ( body ? 2000 : 0 );\n\tsupport.fractions = offsetTotal > 21 && offsetTotal < 22;\n})();\n\n}( jQuery ));\n","/*! jQuery UI - v1.9.2 - 2012-11-23\n* http://jqueryui.com\n* Includes: jquery.ui.resizable.js\n* Copyright 2012 jQuery Foundation and other contributors; Licensed MIT */\n(function(e,t){e.widget(\"ui.resizable\",e.ui.mouse,{version:\"1.9.2\",widgetEventPrefix:\"resize\",options:{alsoResize:!1,animate:!1,animateDuration:\"slow\",animateEasing:\"swing\",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:\"e,s,se\",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1e3},_create:function(){var t=this,n=this.options;this.element.addClass(\"ui-resizable\"),e.extend(this,{_aspectRatio:!!n.aspectRatio,aspectRatio:n.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:n.helper||n.ghost||n.animate?n.helper||\"ui-resizable-helper\":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e('<div class=\"ui-wrapper\" style=\"overflow: hidden;\"></div>').css({position:this.element.css(\"position\"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css(\"top\"),left:this.element.css(\"left\")})),this.element=this.element.parent().data(\"resizable\",this.element.data(\"resizable\")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css(\"marginLeft\"),marginTop:this.originalElement.css(\"marginTop\"),marginRight:this.originalElement.css(\"marginRight\"),marginBottom:this.originalElement.css(\"marginBottom\")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css(\"resize\"),this.originalElement.css(\"resize\",\"none\"),this._proportionallyResizeElements.push(this.originalElement.css({position:\"static\",zoom:1,display:\"block\"})),this.originalElement.css({margin:this.originalElement.css(\"margin\")}),this._proportionallyResize()),this.handles=n.handles||(e(\".ui-resizable-handle\",this.element).length?{n:\".ui-resizable-n\",e:\".ui-resizable-e\",s:\".ui-resizable-s\",w:\".ui-resizable-w\",se:\".ui-resizable-se\",sw:\".ui-resizable-sw\",ne:\".ui-resizable-ne\",nw:\".ui-resizable-nw\"}:\"e,s,se\");if(this.handles.constructor==String){this.handles==\"all\"&&(this.handles=\"n,e,s,w,se,sw,ne,nw\");var r=this.handles.split(\",\");this.handles={};for(var i=0;i<r.length;i++){var s=e.trim(r[i]),o=\"ui-resizable-\"+s,u=e('<div class=\"ui-resizable-handle '+o+'\"></div>');u.css({zIndex:n.zIndex}),\"se\"==s&&u.addClass(\"ui-icon ui-icon-gripsmall-diagonal-se\"),this.handles[s]=\".ui-resizable-\"+s,this.element.append(u)}}this._renderAxis=function(t){t=t||this.element;for(var n in this.handles){this.handles[n].constructor==String&&(this.handles[n]=e(this.handles[n],this.element).show());if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var r=e(this.handles[n],this.element),i=0;i=/sw|ne|nw|se|n|s/.test(n)?r.outerHeight():r.outerWidth();var s=[\"padding\",/ne|nw|n/.test(n)?\"Top\":/se|sw|s/.test(n)?\"Bottom\":/^e$/.test(n)?\"Right\":\"Left\"].join(\"\");t.css(s,i),this._proportionallyResize()}if(!e(this.handles[n]).length)continue}},this._renderAxis(this.element),this._handles=e(\".ui-resizable-handle\",this.element).disableSelection(),this._handles.mouseover(function(){if(!t.resizing){if(this.className)var e=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);t.axis=e&&e[1]?e[1]:\"se\"}}),n.autoHide&&(this._handles.hide(),e(this.element).addClass(\"ui-resizable-autohide\").mouseenter(function(){if(n.disabled)return;e(this).removeClass(\"ui-resizable-autohide\"),t._handles.show()}).mouseleave(function(){if(n.disabled)return;t.resizing||(e(this).addClass(\"ui-resizable-autohide\"),t._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t=function(t){e(t).removeClass(\"ui-resizable ui-resizable-disabled ui-resizable-resizing\").removeData(\"resizable\").removeData(\"ui-resizable\").unbind(\".resizable\").find(\".ui-resizable-handle\").remove()};if(this.elementIsWrapper){t(this.element);var n=this.element;this.originalElement.css({position:n.css(\"position\"),width:n.outerWidth(),height:n.outerHeight(),top:n.css(\"top\"),left:n.css(\"left\")}).insertAfter(n),n.remove()}return this.originalElement.css(\"resize\",this.originalResizeStyle),t(this.originalElement),this},_mouseCapture:function(t){var n=!1;for(var r in this.handles)e(this.handles[r])[0]==t.target&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(t){var r=this.options,i=this.element.position(),s=this.element;this.resizing=!0,this.documentScroll={top:e(document).scrollTop(),left:e(document).scrollLeft()},(s.is(\".ui-draggable\")||/absolute/.test(s.css(\"position\")))&&s.css({position:\"absolute\",top:i.top,left:i.left}),this._renderProxy();var o=n(this.helper.css(\"left\")),u=n(this.helper.css(\"top\"));r.containment&&(o+=e(r.containment).scrollLeft()||0,u+=e(r.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:o,top:u},this.size=this._helper?{width:s.outerWidth(),height:s.outerHeight()}:{width:s.width(),height:s.height()},this.originalSize=this._helper?{width:s.outerWidth(),height:s.outerHeight()}:{width:s.width(),height:s.height()},this.originalPosition={left:o,top:u},this.sizeDiff={width:s.outerWidth()-s.width(),height:s.outerHeight()-s.height()},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio=typeof r.aspectRatio==\"number\"?r.aspectRatio:this.originalSize.width/this.originalSize.height||1;var a=e(\".ui-resizable-\"+this.axis).css(\"cursor\");return e(\"body\").css(\"cursor\",a==\"auto\"?this.axis+\"-resize\":a),s.addClass(\"ui-resizable-resizing\"),this._propagate(\"start\",t),!0},_mouseDrag:function(e){var t=this.helper,n=this.options,r={},i=this,s=this.originalMousePosition,o=this.axis,u=e.pageX-s.left||0,a=e.pageY-s.top||0,f=this._change[o];if(!f)return!1;var l=f.apply(this,[e,u,a]);this._updateVirtualBoundaries(e.shiftKey);if(this._aspectRatio||e.shiftKey)l=this._updateRatio(l,e);return l=this._respectSize(l,e),this._propagate(\"resize\",e),t.css({top:this.position.top+\"px\",left:this.position.left+\"px\",width:this.size.width+\"px\",height:this.size.height+\"px\"}),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),this._updateCache(l),this._trigger(\"resize\",e,this.ui()),!1},_mouseStop:function(t){this.resizing=!1;var n=this.options,r=this;if(this._helper){var i=this._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),o=s&&e.ui.hasScroll(i[0],\"left\")?0:r.sizeDiff.height,u=s?0:r.sizeDiff.width,a={width:r.helper.width()-u,height:r.helper.height()-o},f=parseInt(r.element.css(\"left\"),10)+(r.position.left-r.originalPosition.left)||null,l=parseInt(r.element.css(\"top\"),10)+(r.position.top-r.originalPosition.top)||null;n.animate||this.element.css(e.extend(a,{top:l,left:f})),r.helper.height(r.size.height),r.helper.width(r.size.width),this._helper&&!n.animate&&this._proportionallyResize()}return e(\"body\").css(\"cursor\",\"auto\"),this.element.removeClass(\"ui-resizable-resizing\"),this._propagate(\"stop\",t),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(e){var t=this.options,n,i,s,o,u;u={minWidth:r(t.minWidth)?t.minWidth:0,maxWidth:r(t.maxWidth)?t.maxWidth:Infinity,minHeight:r(t.minHeight)?t.minHeight:0,maxHeight:r(t.maxHeight)?t.maxHeight:Infinity};if(this._aspectRatio||e)n=u.minHeight*this.aspectRatio,s=u.minWidth/this.aspectRatio,i=u.maxHeight*this.aspectRatio,o=u.maxWidth/this.aspectRatio,n>u.minWidth&&(u.minWidth=n),s>u.minHeight&&(u.minHeight=s),i<u.maxWidth&&(u.maxWidth=i),o<u.maxHeight&&(u.maxHeight=o);this._vBoundaries=u},_updateCache:function(e){var t=this.options;this.offset=this.helper.offset(),r(e.left)&&(this.position.left=e.left),r(e.top)&&(this.position.top=e.top),r(e.height)&&(this.size.height=e.height),r(e.width)&&(this.size.width=e.width)},_updateRatio:function(e,t){var n=this.options,i=this.position,s=this.size,o=this.axis;return r(e.height)?e.width=e.height*this.aspectRatio:r(e.width)&&(e.height=e.width/this.aspectRatio),o==\"sw\"&&(e.left=i.left+(s.width-e.width),e.top=null),o==\"nw\"&&(e.top=i.top+(s.height-e.height),e.left=i.left+(s.width-e.width)),e},_respectSize:function(e,t){var n=this.helper,i=this._vBoundaries,s=this._aspectRatio||t.shiftKey,o=this.axis,u=r(e.width)&&i.maxWidth&&i.maxWidth<e.width,a=r(e.height)&&i.maxHeight&&i.maxHeight<e.height,f=r(e.width)&&i.minWidth&&i.minWidth>e.width,l=r(e.height)&&i.minHeight&&i.minHeight>e.height;f&&(e.width=i.minWidth),l&&(e.height=i.minHeight),u&&(e.width=i.maxWidth),a&&(e.height=i.maxHeight);var c=this.originalPosition.left+this.originalSize.width,h=this.position.top+this.size.height,p=/sw|nw|w/.test(o),d=/nw|ne|n/.test(o);f&&p&&(e.left=c-i.minWidth),u&&p&&(e.left=c-i.maxWidth),l&&d&&(e.top=h-i.minHeight),a&&d&&(e.top=h-i.maxHeight);var v=!e.width&&!e.height;return v&&!e.left&&e.top?e.top=null:v&&!e.top&&e.left&&(e.left=null),e},_proportionallyResize:function(){var t=this.options;if(!this._proportionallyResizeElements.length)return;var n=this.helper||this.element;for(var r=0;r<this._proportionallyResizeElements.length;r++){var i=this._proportionallyResizeElements[r];if(!this.borderDif){var s=[i.css(\"borderTopWidth\"),i.css(\"borderRightWidth\"),i.css(\"borderBottomWidth\"),i.css(\"borderLeftWidth\")],o=[i.css(\"paddingTop\"),i.css(\"paddingRight\"),i.css(\"paddingBottom\"),i.css(\"paddingLeft\")];this.borderDif=e.map(s,function(e,t){var n=parseInt(e,10)||0,r=parseInt(o[t],10)||0;return n+r})}i.css({height:n.height()-this.borderDif[0]-this.borderDif[2]||0,width:n.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var t=this.element,n=this.options;this.elementOffset=t.offset();if(this._helper){this.helper=this.helper||e('<div style=\"overflow:hidden;\"></div>');var r=e.ui.ie6?1:0,i=e.ui.ie6?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+i,height:this.element.outerHeight()+i,position:\"absolute\",left:this.elementOffset.left-r+\"px\",top:this.elementOffset.top-r+\"px\",zIndex:++n.zIndex}),this.helper.appendTo(\"body\").disableSelection()}else this.helper=this.element},_change:{e:function(e,t,n){return{width:this.originalSize.width+t}},w:function(e,t,n){var r=this.options,i=this.originalSize,s=this.originalPosition;return{left:s.left+t,width:i.width-t}},n:function(e,t,n){var r=this.options,i=this.originalSize,s=this.originalPosition;return{top:s.top+n,height:i.height-n}},s:function(e,t,n){return{height:this.originalSize.height+n}},se:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},sw:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,n,r]))},ne:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},nw:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,n,r]))}},_propagate:function(t,n){e.ui.plugin.call(this,t,[n,this.ui()]),t!=\"resize\"&&this._trigger(t,n,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add(\"resizable\",\"alsoResize\",{start:function(t,n){var r=e(this).data(\"resizable\"),i=r.options,s=function(t){e(t).each(function(){var t=e(this);t.data(\"resizable-alsoresize\",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css(\"left\"),10),top:parseInt(t.css(\"top\"),10)})})};typeof i.alsoResize==\"object\"&&!i.alsoResize.parentNode?i.alsoResize.length?(i.alsoResize=i.alsoResize[0],s(i.alsoResize)):e.each(i.alsoResize,function(e){s(e)}):s(i.alsoResize)},resize:function(t,n){var r=e(this).data(\"resizable\"),i=r.options,s=r.originalSize,o=r.originalPosition,u={height:r.size.height-s.height||0,width:r.size.width-s.width||0,top:r.position.top-o.top||0,left:r.position.left-o.left||0},a=function(t,r){e(t).each(function(){var t=e(this),i=e(this).data(\"resizable-alsoresize\"),s={},o=r&&r.length?r:t.parents(n.originalElement[0]).length?[\"width\",\"height\"]:[\"width\",\"height\",\"top\",\"left\"];e.each(o,function(e,t){var n=(i[t]||0)+(u[t]||0);n&&n>=0&&(s[t]=n||null)}),t.css(s)})};typeof i.alsoResize==\"object\"&&!i.alsoResize.nodeType?e.each(i.alsoResize,function(e,t){a(e,t)}):a(i.alsoResize)},stop:function(t,n){e(this).removeData(\"resizable-alsoresize\")}}),e.ui.plugin.add(\"resizable\",\"animate\",{stop:function(t,n){var r=e(this).data(\"resizable\"),i=r.options,s=r._proportionallyResizeElements,o=s.length&&/textarea/i.test(s[0].nodeName),u=o&&e.ui.hasScroll(s[0],\"left\")?0:r.sizeDiff.height,a=o?0:r.sizeDiff.width,f={width:r.size.width-a,height:r.size.height-u},l=parseInt(r.element.css(\"left\"),10)+(r.position.left-r.originalPosition.left)||null,c=parseInt(r.element.css(\"top\"),10)+(r.position.top-r.originalPosition.top)||null;r.element.animate(e.extend(f,c&&l?{top:c,left:l}:{}),{duration:i.animateDuration,easing:i.animateEasing,step:function(){var n={width:parseInt(r.element.css(\"width\"),10),height:parseInt(r.element.css(\"height\"),10),top:parseInt(r.element.css(\"top\"),10),left:parseInt(r.element.css(\"left\"),10)};s&&s.length&&e(s[0]).css({width:n.width,height:n.height}),r._updateCache(n),r._propagate(\"resize\",t)}})}}),e.ui.plugin.add(\"resizable\",\"containment\",{start:function(t,r){var i=e(this).data(\"resizable\"),s=i.options,o=i.element,u=s.containment,a=u instanceof e?u.get(0):/parent/.test(u)?o.parent().get(0):u;if(!a)return;i.containerElement=e(a);if(/document/.test(u)||u==document)i.containerOffset={left:0,top:0},i.containerPosition={left:0,top:0},i.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight};else{var f=e(a),l=[];e([\"Top\",\"Right\",\"Left\",\"Bottom\"]).each(function(e,t){l[e]=n(f.css(\"padding\"+t))}),i.containerOffset=f.offset(),i.containerPosition=f.position(),i.containerSize={height:f.innerHeight()-l[3],width:f.innerWidth()-l[1]};var c=i.containerOffset,h=i.containerSize.height,p=i.containerSize.width,d=e.ui.hasScroll(a,\"left\")?a.scrollWidth:p,v=e.ui.hasScroll(a)?a.scrollHeight:h;i.parentData={element:a,left:c.left,top:c.top,width:d,height:v}}},resize:function(t,n){var r=e(this).data(\"resizable\"),i=r.options,s=r.containerSize,o=r.containerOffset,u=r.size,a=r.position,f=r._aspectRatio||t.shiftKey,l={top:0,left:0},c=r.containerElement;c[0]!=document&&/static/.test(c.css(\"position\"))&&(l=o),a.left<(r._helper?o.left:0)&&(r.size.width=r.size.width+(r._helper?r.position.left-o.left:r.position.left-l.left),f&&(r.size.height=r.size.width/r.aspectRatio),r.position.left=i.helper?o.left:0),a.top<(r._helper?o.top:0)&&(r.size.height=r.size.height+(r._helper?r.position.top-o.top:r.position.top),f&&(r.size.width=r.size.height*r.aspectRatio),r.position.top=r._helper?o.top:0),r.offset.left=r.parentData.left+r.position.left,r.offset.top=r.parentData.top+r.position.top;var h=Math.abs((r._helper?r.offset.left-l.left:r.offset.left-l.left)+r.sizeDiff.width),p=Math.abs((r._helper?r.offset.top-l.top:r.offset.top-o.top)+r.sizeDiff.height),d=r.containerElement.get(0)==r.element.parent().get(0),v=/relative|absolute/.test(r.containerElement.css(\"position\"));d&&v&&(h-=r.parentData.left),h+r.size.width>=r.parentData.width&&(r.size.width=r.parentData.width-h,f&&(r.size.height=r.size.width/r.aspectRatio)),p+r.size.height>=r.parentData.height&&(r.size.height=r.parentData.height-p,f&&(r.size.width=r.size.height*r.aspectRatio))},stop:function(t,n){var r=e(this).data(\"resizable\"),i=r.options,s=r.position,o=r.containerOffset,u=r.containerPosition,a=r.containerElement,f=e(r.helper),l=f.offset(),c=f.outerWidth()-r.sizeDiff.width,h=f.outerHeight()-r.sizeDiff.height;r._helper&&!i.animate&&/relative/.test(a.css(\"position\"))&&e(this).css({left:l.left-u.left-o.left,width:c,height:h}),r._helper&&!i.animate&&/static/.test(a.css(\"position\"))&&e(this).css({left:l.left-u.left-o.left,width:c,height:h})}}),e.ui.plugin.add(\"resizable\",\"ghost\",{start:function(t,n){var r=e(this).data(\"resizable\"),i=r.options,s=r.size;r.ghost=r.originalElement.clone(),r.ghost.css({opacity:.25,display:\"block\",position:\"relative\",height:s.height,width:s.width,margin:0,left:0,top:0}).addClass(\"ui-resizable-ghost\").addClass(typeof i.ghost==\"string\"?i.ghost:\"\"),r.ghost.appendTo(r.helper)},resize:function(t,n){var r=e(this).data(\"resizable\"),i=r.options;r.ghost&&r.ghost.css({position:\"relative\",height:r.size.height,width:r.size.width})},stop:function(t,n){var r=e(this).data(\"resizable\"),i=r.options;r.ghost&&r.helper&&r.helper.get(0).removeChild(r.ghost.get(0))}}),e.ui.plugin.add(\"resizable\",\"grid\",{resize:function(t,n){var r=e(this).data(\"resizable\"),i=r.options,s=r.size,o=r.originalSize,u=r.originalPosition,a=r.axis,f=i._aspectRatio||t.shiftKey;i.grid=typeof i.grid==\"number\"?[i.grid,i.grid]:i.grid;var l=Math.round((s.width-o.width)/(i.grid[0]||1))*(i.grid[0]||1),c=Math.round((s.height-o.height)/(i.grid[1]||1))*(i.grid[1]||1);/^(se|s|e)$/.test(a)?(r.size.width=o.width+l,r.size.height=o.height+c):/^(ne)$/.test(a)?(r.size.width=o.width+l,r.size.height=o.height+c,r.position.top=u.top-c):/^(sw)$/.test(a)?(r.size.width=o.width+l,r.size.height=o.height+c,r.position.left=u.left-l):(r.size.width=o.width+l,r.size.height=o.height+c,r.position.top=u.top-c,r.position.left=u.left-l)}});var n=function(e){return parseInt(e,10)||0},r=function(e){return!isNaN(parseInt(e,10))}})(jQuery);","/*!\n * jQuery UI Slider 1.8.23\n *\n * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)\n * Dual licensed under the MIT or GPL Version 2 licenses.\n * http://jquery.org/license\n *\n * http://docs.jquery.com/UI/Slider\n *\n * Depends:\n *\tjquery.ui.core.js\n *\tjquery.ui.mouse.js\n *\tjquery.ui.widget.js\n */\n(function( $, undefined ) {\n\n// number of pages in a slider\n// (how many times can you page up/down to go through the whole range)\nvar numPages = 5;\n\n$.widget( \"ui.slider\", $.ui.mouse, {\n\n\twidgetEventPrefix: \"slide\",\n\n\toptions: {\n\t\tanimate: false,\n\t\tdistance: 0,\n\t\tmax: 100,\n\t\tmin: 0,\n\t\torientation: \"horizontal\",\n\t\trange: false,\n\t\tstep: 1,\n\t\tvalue: 0,\n\t\tvalues: null\n\t},\n\n\t_create: function() {\n\t\tvar self = this,\n\t\t\to = this.options,\n\t\t\texistingHandles = this.element.find( \".ui-slider-handle\" ).addClass( \"ui-state-default ui-corner-all\" ),\n\t\t\thandle = \"<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>\",\n\t\t\thandleCount = ( o.values && o.values.length ) || 1,\n\t\t\thandles = [];\n\n\t\tthis._keySliding = false;\n\t\tthis._mouseSliding = false;\n\t\tthis._animateOff = true;\n\t\tthis._handleIndex = null;\n\t\tthis._detectOrientation();\n\t\tthis._mouseInit();\n\n\t\tthis.element\n\t\t\t.addClass( \"ui-slider\" +\n\t\t\t\t\" ui-slider-\" + this.orientation +\n\t\t\t\t\" ui-widget\" +\n\t\t\t\t\" ui-widget-content\" +\n\t\t\t\t\" ui-corner-all\" +\n\t\t\t\t( o.disabled ? \" ui-slider-disabled ui-disabled\" : \"\" ) );\n\n\t\tthis.range = $([]);\n\n\t\tif ( o.range ) {\n\t\t\tif ( o.range === true ) {\n\t\t\t\tif ( !o.values ) {\n\t\t\t\t\to.values = [ this._valueMin(), this._valueMin() ];\n\t\t\t\t}\n\t\t\t\tif ( o.values.length && o.values.length !== 2 ) {\n\t\t\t\t\to.values = [ o.values[0], o.values[0] ];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.range = $( \"<div></div>\" )\n\t\t\t\t.appendTo( this.element )\n\t\t\t\t.addClass( \"ui-slider-range\" +\n\t\t\t\t// note: this isn't the most fittingly semantic framework class for this element,\n\t\t\t\t// but worked best visually with a variety of themes\n\t\t\t\t\" ui-widget-header\" + \n\t\t\t\t( ( o.range === \"min\" || o.range === \"max\" ) ? \" ui-slider-range-\" + o.range : \"\" ) );\n\t\t}\n\n\t\tfor ( var i = existingHandles.length; i < handleCount; i += 1 ) {\n\t\t\thandles.push( handle );\n\t\t}\n\n\t\tthis.handles = existingHandles.add( $( handles.join( \"\" ) ).appendTo( self.element ) );\n\n\t\tthis.handle = this.handles.eq( 0 );\n\n\t\tthis.handles.add( this.range ).filter( \"a\" )\n\t\t\t.click(function( event ) {\n\t\t\t\tevent.preventDefault();\n\t\t\t})\n\t\t\t.hover(function() {\n\t\t\t\tif ( !o.disabled ) {\n\t\t\t\t\t$( this ).addClass( \"ui-state-hover\" );\n\t\t\t\t}\n\t\t\t}, function() {\n\t\t\t\t$( this ).removeClass( \"ui-state-hover\" );\n\t\t\t})\n\t\t\t.focus(function() {\n\t\t\t\tif ( !o.disabled ) {\n\t\t\t\t\t$( \".ui-slider .ui-state-focus\" ).removeClass( \"ui-state-focus\" );\n\t\t\t\t\t$( this ).addClass( \"ui-state-focus\" );\n\t\t\t\t} else {\n\t\t\t\t\t$( this ).blur();\n\t\t\t\t}\n\t\t\t})\n\t\t\t.blur(function() {\n\t\t\t\t$( this ).removeClass( \"ui-state-focus\" );\n\t\t\t});\n\n\t\tthis.handles.each(function( i ) {\n\t\t\t$( this ).data( \"index.ui-slider-handle\", i );\n\t\t});\n\n\t\tthis.handles\n\t\t\t.keydown(function( event ) {\n\t\t\t\tvar index = $( this ).data( \"index.ui-slider-handle\" ),\n\t\t\t\t\tallowed,\n\t\t\t\t\tcurVal,\n\t\t\t\t\tnewVal,\n\t\t\t\t\tstep;\n\t\n\t\t\t\tif ( self.options.disabled ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tswitch ( event.keyCode ) {\n\t\t\t\t\tcase $.ui.keyCode.HOME:\n\t\t\t\t\tcase $.ui.keyCode.END:\n\t\t\t\t\tcase $.ui.keyCode.PAGE_UP:\n\t\t\t\t\tcase $.ui.keyCode.PAGE_DOWN:\n\t\t\t\t\tcase $.ui.keyCode.UP:\n\t\t\t\t\tcase $.ui.keyCode.RIGHT:\n\t\t\t\t\tcase $.ui.keyCode.DOWN:\n\t\t\t\t\tcase $.ui.keyCode.LEFT:\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tif ( !self._keySliding ) {\n\t\t\t\t\t\t\tself._keySliding = true;\n\t\t\t\t\t\t\t$( this ).addClass( \"ui-state-active\" );\n\t\t\t\t\t\t\tallowed = self._start( event, index );\n\t\t\t\t\t\t\tif ( allowed === false ) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\n\t\t\t\tstep = self.options.step;\n\t\t\t\tif ( self.options.values && self.options.values.length ) {\n\t\t\t\t\tcurVal = newVal = self.values( index );\n\t\t\t\t} else {\n\t\t\t\t\tcurVal = newVal = self.value();\n\t\t\t\t}\n\t\n\t\t\t\tswitch ( event.keyCode ) {\n\t\t\t\t\tcase $.ui.keyCode.HOME:\n\t\t\t\t\t\tnewVal = self._valueMin();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase $.ui.keyCode.END:\n\t\t\t\t\t\tnewVal = self._valueMax();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase $.ui.keyCode.PAGE_UP:\n\t\t\t\t\t\tnewVal = self._trimAlignValue( curVal + ( (self._valueMax() - self._valueMin()) / numPages ) );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase $.ui.keyCode.PAGE_DOWN:\n\t\t\t\t\t\tnewVal = self._trimAlignValue( curVal - ( (self._valueMax() - self._valueMin()) / numPages ) );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase $.ui.keyCode.UP:\n\t\t\t\t\tcase $.ui.keyCode.RIGHT:\n\t\t\t\t\t\tif ( curVal === self._valueMax() ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnewVal = self._trimAlignValue( curVal + step );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase $.ui.keyCode.DOWN:\n\t\t\t\t\tcase $.ui.keyCode.LEFT:\n\t\t\t\t\t\tif ( curVal === self._valueMin() ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnewVal = self._trimAlignValue( curVal - step );\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\n\t\t\t\tself._slide( event, index, newVal );\n\t\t\t})\n\t\t\t.keyup(function( event ) {\n\t\t\t\tvar index = $( this ).data( \"index.ui-slider-handle\" );\n\t\n\t\t\t\tif ( self._keySliding ) {\n\t\t\t\t\tself._keySliding = false;\n\t\t\t\t\tself._stop( event, index );\n\t\t\t\t\tself._change( event, index );\n\t\t\t\t\t$( this ).removeClass( \"ui-state-active\" );\n\t\t\t\t}\n\t\n\t\t\t});\n\n\t\tthis._refreshValue();\n\n\t\tthis._animateOff = false;\n\t},\n\n\tdestroy: function() {\n\t\tthis.handles.remove();\n\t\tthis.range.remove();\n\n\t\tthis.element\n\t\t\t.removeClass( \"ui-slider\" +\n\t\t\t\t\" ui-slider-horizontal\" +\n\t\t\t\t\" ui-slider-vertical\" +\n\t\t\t\t\" ui-slider-disabled\" +\n\t\t\t\t\" ui-widget\" +\n\t\t\t\t\" ui-widget-content\" +\n\t\t\t\t\" ui-corner-all\" )\n\t\t\t.removeData( \"slider\" )\n\t\t\t.unbind( \".slider\" );\n\n\t\tthis._mouseDestroy();\n\n\t\treturn this;\n\t},\n\n\t_mouseCapture: function( event ) {\n\t\tvar o = this.options,\n\t\t\tposition,\n\t\t\tnormValue,\n\t\t\tdistance,\n\t\t\tclosestHandle,\n\t\t\tself,\n\t\t\tindex,\n\t\t\tallowed,\n\t\t\toffset,\n\t\t\tmouseOverHandle;\n\n\t\tif ( o.disabled ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.elementSize = {\n\t\t\twidth: this.element.outerWidth(),\n\t\t\theight: this.element.outerHeight()\n\t\t};\n\t\tthis.elementOffset = this.element.offset();\n\n\t\tposition = { x: event.pageX, y: event.pageY };\n\t\tnormValue = this._normValueFromMouse( position );\n\t\tdistance = this._valueMax() - this._valueMin() + 1;\n\t\tself = this;\n\t\tthis.handles.each(function( i ) {\n\t\t\tvar thisDistance = Math.abs( normValue - self.values(i) );\n\t\t\tif ( distance > thisDistance ) {\n\t\t\t\tdistance = thisDistance;\n\t\t\t\tclosestHandle = $( this );\n\t\t\t\tindex = i;\n\t\t\t}\n\t\t});\n\n\t\t// workaround for bug #3736 (if both handles of a range are at 0,\n\t\t// the first is always used as the one with least distance,\n\t\t// and moving it is obviously prevented by preventing negative ranges)\n\t\tif( o.range === true && this.values(1) === o.min ) {\n\t\t\tindex += 1;\n\t\t\tclosestHandle = $( this.handles[index] );\n\t\t}\n\n\t\tallowed = this._start( event, index );\n\t\tif ( allowed === false ) {\n\t\t\treturn false;\n\t\t}\n\t\tthis._mouseSliding = true;\n\n\t\tself._handleIndex = index;\n\n\t\tclosestHandle\n\t\t\t.addClass( \"ui-state-active\" )\n\t\t\t.focus();\n\t\t\n\t\toffset = closestHandle.offset();\n\t\tmouseOverHandle = !$( event.target ).parents().andSelf().is( \".ui-slider-handle\" );\n\t\tthis._clickOffset = mouseOverHandle ? { left: 0, top: 0 } : {\n\t\t\tleft: event.pageX - offset.left - ( closestHandle.width() / 2 ),\n\t\t\ttop: event.pageY - offset.top -\n\t\t\t\t( closestHandle.height() / 2 ) -\n\t\t\t\t( parseInt( closestHandle.css(\"borderTopWidth\"), 10 ) || 0 ) -\n\t\t\t\t( parseInt( closestHandle.css(\"borderBottomWidth\"), 10 ) || 0) +\n\t\t\t\t( parseInt( closestHandle.css(\"marginTop\"), 10 ) || 0)\n\t\t};\n\n\t\tif ( !this.handles.hasClass( \"ui-state-hover\" ) ) {\n\t\t\tthis._slide( event, index, normValue );\n\t\t}\n\t\tthis._animateOff = true;\n\t\treturn true;\n\t},\n\n\t_mouseStart: function( event ) {\n\t\treturn true;\n\t},\n\n\t_mouseDrag: function( event ) {\n\t\tvar position = { x: event.pageX, y: event.pageY },\n\t\t\tnormValue = this._normValueFromMouse( position );\n\t\t\n\t\tthis._slide( event, this._handleIndex, normValue );\n\n\t\treturn false;\n\t},\n\n\t_mouseStop: function( event ) {\n\t\tthis.handles.removeClass( \"ui-state-active\" );\n\t\tthis._mouseSliding = false;\n\n\t\tthis._stop( event, this._handleIndex );\n\t\tthis._change( event, this._handleIndex );\n\n\t\tthis._handleIndex = null;\n\t\tthis._clickOffset = null;\n\t\tthis._animateOff = false;\n\n\t\treturn false;\n\t},\n\t\n\t_detectOrientation: function() {\n\t\tthis.orientation = ( this.options.orientation === \"vertical\" ) ? \"vertical\" : \"horizontal\";\n\t},\n\n\t_normValueFromMouse: function( position ) {\n\t\tvar pixelTotal,\n\t\t\tpixelMouse,\n\t\t\tpercentMouse,\n\t\t\tvalueTotal,\n\t\t\tvalueMouse;\n\n\t\tif ( this.orientation === \"horizontal\" ) {\n\t\t\tpixelTotal = this.elementSize.width;\n\t\t\tpixelMouse = position.x - this.elementOffset.left - ( this._clickOffset ? this._clickOffset.left : 0 );\n\t\t} else {\n\t\t\tpixelTotal = this.elementSize.height;\n\t\t\tpixelMouse = position.y - this.elementOffset.top - ( this._clickOffset ? this._clickOffset.top : 0 );\n\t\t}\n\n\t\tpercentMouse = ( pixelMouse / pixelTotal );\n\t\tif ( percentMouse > 1 ) {\n\t\t\tpercentMouse = 1;\n\t\t}\n\t\tif ( percentMouse < 0 ) {\n\t\t\tpercentMouse = 0;\n\t\t}\n\t\tif ( this.orientation === \"vertical\" ) {\n\t\t\tpercentMouse = 1 - percentMouse;\n\t\t}\n\n\t\tvalueTotal = this._valueMax() - this._valueMin();\n\t\tvalueMouse = this._valueMin() + percentMouse * valueTotal;\n\n\t\treturn this._trimAlignValue( valueMouse );\n\t},\n\n\t_start: function( event, index ) {\n\t\tvar uiHash = {\n\t\t\thandle: this.handles[ index ],\n\t\t\tvalue: this.value()\n\t\t};\n\t\tif ( this.options.values && this.options.values.length ) {\n\t\t\tuiHash.value = this.values( index );\n\t\t\tuiHash.values = this.values();\n\t\t}\n\t\treturn this._trigger( \"start\", event, uiHash );\n\t},\n\n\t_slide: function( event, index, newVal ) {\n\t\tvar otherVal,\n\t\t\tnewValues,\n\t\t\tallowed;\n\n\t\tif ( this.options.values && this.options.values.length ) {\n\t\t\totherVal = this.values( index ? 0 : 1 );\n\n\t\t\tif ( ( this.options.values.length === 2 && this.options.range === true ) && \n\t\t\t\t\t( ( index === 0 && newVal > otherVal) || ( index === 1 && newVal < otherVal ) )\n\t\t\t\t) {\n\t\t\t\tnewVal = otherVal;\n\t\t\t}\n\n\t\t\tif ( newVal !== this.values( index ) ) {\n\t\t\t\tnewValues = this.values();\n\t\t\t\tnewValues[ index ] = newVal;\n\t\t\t\t// A slide can be canceled by returning false from the slide callback\n\t\t\t\tallowed = this._trigger( \"slide\", event, {\n\t\t\t\t\thandle: this.handles[ index ],\n\t\t\t\t\tvalue: newVal,\n\t\t\t\t\tvalues: newValues\n\t\t\t\t} );\n\t\t\t\totherVal = this.values( index ? 0 : 1 );\n\t\t\t\tif ( allowed !== false ) {\n\t\t\t\t\tthis.values( index, newVal, true );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif ( newVal !== this.value() ) {\n\t\t\t\t// A slide can be canceled by returning false from the slide callback\n\t\t\t\tallowed = this._trigger( \"slide\", event, {\n\t\t\t\t\thandle: this.handles[ index ],\n\t\t\t\t\tvalue: newVal\n\t\t\t\t} );\n\t\t\t\tif ( allowed !== false ) {\n\t\t\t\t\tthis.value( newVal );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t_stop: function( event, index ) {\n\t\tvar uiHash = {\n\t\t\thandle: this.handles[ index ],\n\t\t\tvalue: this.value()\n\t\t};\n\t\tif ( this.options.values && this.options.values.length ) {\n\t\t\tuiHash.value = this.values( index );\n\t\t\tuiHash.values = this.values();\n\t\t}\n\n\t\tthis._trigger( \"stop\", event, uiHash );\n\t},\n\n\t_change: function( event, index ) {\n\t\tif ( !this._keySliding && !this._mouseSliding ) {\n\t\t\tvar uiHash = {\n\t\t\t\thandle: this.handles[ index ],\n\t\t\t\tvalue: this.value()\n\t\t\t};\n\t\t\tif ( this.options.values && this.options.values.length ) {\n\t\t\t\tuiHash.value = this.values( index );\n\t\t\t\tuiHash.values = this.values();\n\t\t\t}\n\n\t\t\tthis._trigger( \"change\", event, uiHash );\n\t\t}\n\t},\n\n\tvalue: function( newValue ) {\n\t\tif ( arguments.length ) {\n\t\t\tthis.options.value = this._trimAlignValue( newValue );\n\t\t\tthis._refreshValue();\n\t\t\tthis._change( null, 0 );\n\t\t\treturn;\n\t\t}\n\n\t\treturn this._value();\n\t},\n\n\tvalues: function( index, newValue ) {\n\t\tvar vals,\n\t\t\tnewValues,\n\t\t\ti;\n\n\t\tif ( arguments.length > 1 ) {\n\t\t\tthis.options.values[ index ] = this._trimAlignValue( newValue );\n\t\t\tthis._refreshValue();\n\t\t\tthis._change( null, index );\n\t\t\treturn;\n\t\t}\n\n\t\tif ( arguments.length ) {\n\t\t\tif ( $.isArray( arguments[ 0 ] ) ) {\n\t\t\t\tvals = this.options.values;\n\t\t\t\tnewValues = arguments[ 0 ];\n\t\t\t\tfor ( i = 0; i < vals.length; i += 1 ) {\n\t\t\t\t\tvals[ i ] = this._trimAlignValue( newValues[ i ] );\n\t\t\t\t\tthis._change( null, i );\n\t\t\t\t}\n\t\t\t\tthis._refreshValue();\n\t\t\t} else {\n\t\t\t\tif ( this.options.values && this.options.values.length ) {\n\t\t\t\t\treturn this._values( index );\n\t\t\t\t} else {\n\t\t\t\t\treturn this.value();\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\treturn this._values();\n\t\t}\n\t},\n\n\t_setOption: function( key, value ) {\n\t\tvar i,\n\t\t\tvalsLength = 0;\n\n\t\tif ( $.isArray( this.options.values ) ) {\n\t\t\tvalsLength = this.options.values.length;\n\t\t}\n\n\t\t$.Widget.prototype._setOption.apply( this, arguments );\n\n\t\tswitch ( key ) {\n\t\t\tcase \"disabled\":\n\t\t\t\tif ( value ) {\n\t\t\t\t\tthis.handles.filter( \".ui-state-focus\" ).blur();\n\t\t\t\t\tthis.handles.removeClass( \"ui-state-hover\" );\n\t\t\t\t\tthis.handles.propAttr( \"disabled\", true );\n\t\t\t\t\tthis.element.addClass( \"ui-disabled\" );\n\t\t\t\t} else {\n\t\t\t\t\tthis.handles.propAttr( \"disabled\", false );\n\t\t\t\t\tthis.element.removeClass( \"ui-disabled\" );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"orientation\":\n\t\t\t\tthis._detectOrientation();\n\t\t\t\tthis.element\n\t\t\t\t\t.removeClass( \"ui-slider-horizontal ui-slider-vertical\" )\n\t\t\t\t\t.addClass( \"ui-slider-\" + this.orientation );\n\t\t\t\tthis._refreshValue();\n\t\t\t\tbreak;\n\t\t\tcase \"value\":\n\t\t\t\tthis._animateOff = true;\n\t\t\t\tthis._refreshValue();\n\t\t\t\tthis._change( null, 0 );\n\t\t\t\tthis._animateOff = false;\n\t\t\t\tbreak;\n\t\t\tcase \"values\":\n\t\t\t\tthis._animateOff = true;\n\t\t\t\tthis._refreshValue();\n\t\t\t\tfor ( i = 0; i < valsLength; i += 1 ) {\n\t\t\t\t\tthis._change( null, i );\n\t\t\t\t}\n\t\t\t\tthis._animateOff = false;\n\t\t\t\tbreak;\n\t\t}\n\t},\n\n\t//internal value getter\n\t// _value() returns value trimmed by min and max, aligned by step\n\t_value: function() {\n\t\tvar val = this.options.value;\n\t\tval = this._trimAlignValue( val );\n\n\t\treturn val;\n\t},\n\n\t//internal values getter\n\t// _values() returns array of values trimmed by min and max, aligned by step\n\t// _values( index ) returns single value trimmed by min and max, aligned by step\n\t_values: function( index ) {\n\t\tvar val,\n\t\t\tvals,\n\t\t\ti;\n\n\t\tif ( arguments.length ) {\n\t\t\tval = this.options.values[ index ];\n\t\t\tval = this._trimAlignValue( val );\n\n\t\t\treturn val;\n\t\t} else {\n\t\t\t// .slice() creates a copy of the array\n\t\t\t// this copy gets trimmed by min and max and then returned\n\t\t\tvals = this.options.values.slice();\n\t\t\tfor ( i = 0; i < vals.length; i+= 1) {\n\t\t\t\tvals[ i ] = this._trimAlignValue( vals[ i ] );\n\t\t\t}\n\n\t\t\treturn vals;\n\t\t}\n\t},\n\t\n\t// returns the step-aligned value that val is closest to, between (inclusive) min and max\n\t_trimAlignValue: function( val ) {\n\t\tif ( val <= this._valueMin() ) {\n\t\t\treturn this._valueMin();\n\t\t}\n\t\tif ( val >= this._valueMax() ) {\n\t\t\treturn this._valueMax();\n\t\t}\n\t\tvar step = ( this.options.step > 0 ) ? this.options.step : 1,\n\t\t\tvalModStep = (val - this._valueMin()) % step,\n\t\t\talignValue = val - valModStep;\n\n\t\tif ( Math.abs(valModStep) * 2 >= step ) {\n\t\t\talignValue += ( valModStep > 0 ) ? step : ( -step );\n\t\t}\n\n\t\t// Since JavaScript has problems with large floats, round\n\t\t// the final value to 5 digits after the decimal point (see #4124)\n\t\treturn parseFloat( alignValue.toFixed(5) );\n\t},\n\n\t_valueMin: function() {\n\t\treturn this.options.min;\n\t},\n\n\t_valueMax: function() {\n\t\treturn this.options.max;\n\t},\n\t\n\t_refreshValue: function() {\n\t\tvar oRange = this.options.range,\n\t\t\to = this.options,\n\t\t\tself = this,\n\t\t\tanimate = ( !this._animateOff ) ? o.animate : false,\n\t\t\tvalPercent,\n\t\t\t_set = {},\n\t\t\tlastValPercent,\n\t\t\tvalue,\n\t\t\tvalueMin,\n\t\t\tvalueMax;\n\n\t\tif ( this.options.values && this.options.values.length ) {\n\t\t\tthis.handles.each(function( i, j ) {\n\t\t\t\tvalPercent = ( self.values(i) - self._valueMin() ) / ( self._valueMax() - self._valueMin() ) * 100;\n\t\t\t\t_set[ self.orientation === \"horizontal\" ? \"left\" : \"bottom\" ] = valPercent + \"%\";\n\t\t\t\t$( this ).stop( 1, 1 )[ animate ? \"animate\" : \"css\" ]( _set, o.animate );\n\t\t\t\tif ( self.options.range === true ) {\n\t\t\t\t\tif ( self.orientation === \"horizontal\" ) {\n\t\t\t\t\t\tif ( i === 0 ) {\n\t\t\t\t\t\t\tself.range.stop( 1, 1 )[ animate ? \"animate\" : \"css\" ]( { left: valPercent + \"%\" }, o.animate );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( i === 1 ) {\n\t\t\t\t\t\t\tself.range[ animate ? \"animate\" : \"css\" ]( { width: ( valPercent - lastValPercent ) + \"%\" }, { queue: false, duration: o.animate } );\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif ( i === 0 ) {\n\t\t\t\t\t\t\tself.range.stop( 1, 1 )[ animate ? \"animate\" : \"css\" ]( { bottom: ( valPercent ) + \"%\" }, o.animate );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( i === 1 ) {\n\t\t\t\t\t\t\tself.range[ animate ? \"animate\" : \"css\" ]( { height: ( valPercent - lastValPercent ) + \"%\" }, { queue: false, duration: o.animate } );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tlastValPercent = valPercent;\n\t\t\t});\n\t\t} else {\n\t\t\tvalue = this.value();\n\t\t\tvalueMin = this._valueMin();\n\t\t\tvalueMax = this._valueMax();\n\t\t\tvalPercent = ( valueMax !== valueMin ) ?\n\t\t\t\t\t( value - valueMin ) / ( valueMax - valueMin ) * 100 :\n\t\t\t\t\t0;\n\t\t\t_set[ self.orientation === \"horizontal\" ? \"left\" : \"bottom\" ] = valPercent + \"%\";\n\t\t\tthis.handle.stop( 1, 1 )[ animate ? \"animate\" : \"css\" ]( _set, o.animate );\n\n\t\t\tif ( oRange === \"min\" && this.orientation === \"horizontal\" ) {\n\t\t\t\tthis.range.stop( 1, 1 )[ animate ? \"animate\" : \"css\" ]( { width: valPercent + \"%\" }, o.animate );\n\t\t\t}\n\t\t\tif ( oRange === \"max\" && this.orientation === \"horizontal\" ) {\n\t\t\t\tthis.range[ animate ? \"animate\" : \"css\" ]( { width: ( 100 - valPercent ) + \"%\" }, { queue: false, duration: o.animate } );\n\t\t\t}\n\t\t\tif ( oRange === \"min\" && this.orientation === \"vertical\" ) {\n\t\t\t\tthis.range.stop( 1, 1 )[ animate ? \"animate\" : \"css\" ]( { height: valPercent + \"%\" }, o.animate );\n\t\t\t}\n\t\t\tif ( oRange === \"max\" && this.orientation === \"vertical\" ) {\n\t\t\t\tthis.range[ animate ? \"animate\" : \"css\" ]( { height: ( 100 - valPercent ) + \"%\" }, { queue: false, duration: o.animate } );\n\t\t\t}\n\t\t}\n\t}\n\n});\n\n$.extend( $.ui.slider, {\n\tversion: \"1.8.23\"\n});\n\n}(jQuery));\n","/*!\n * jQuery UI Sortable 1.8.23\n *\n * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)\n * Dual licensed under the MIT or GPL Version 2 licenses.\n * http://jquery.org/license\n *\n * http://docs.jquery.com/UI/Sortables\n *\n * Depends:\n *\tjquery.ui.core.js\n *\tjquery.ui.mouse.js\n *\tjquery.ui.widget.js\n */\n(function( $, undefined ) {\n\n$.widget(\"ui.sortable\", $.ui.mouse, {\n\twidgetEventPrefix: \"sort\",\n\tready: false,\n\toptions: {\n\t\tappendTo: \"parent\",\n\t\taxis: false,\n\t\tconnectWith: false,\n\t\tcontainment: false,\n\t\tcursor: 'auto',\n\t\tcursorAt: false,\n\t\tdropOnEmpty: true,\n\t\tforcePlaceholderSize: false,\n\t\tforceHelperSize: false,\n\t\tgrid: false,\n\t\thandle: false,\n\t\thelper: \"original\",\n\t\titems: '> *',\n\t\topacity: false,\n\t\tplaceholder: false,\n\t\trevert: false,\n\t\tscroll: true,\n\t\tscrollSensitivity: 20,\n\t\tscrollSpeed: 20,\n\t\tscope: \"default\",\n\t\ttolerance: \"intersect\",\n\t\tzIndex: 1000\n\t},\n\t_create: function() {\n\n\t\tvar o = this.options;\n\t\tthis.containerCache = {};\n\t\tthis.element.addClass(\"ui-sortable\");\n\n\t\t//Get the items\n\t\tthis.refresh();\n\n\t\t//Let's determine if the items are being displayed horizontally\n\t\tthis.floating = this.items.length ? o.axis === 'x' || (/left|right/).test(this.items[0].item.css('float')) || (/inline|table-cell/).test(this.items[0].item.css('display')) : false;\n\n\t\t//Let's determine the parent's offset\n\t\tthis.offset = this.element.offset();\n\n\t\t//Initialize mouse events for interaction\n\t\tthis._mouseInit();\n\t\t\n\t\t//We're ready to go\n\t\tthis.ready = true\n\n\t},\n\n\tdestroy: function() {\n\t\t$.Widget.prototype.destroy.call( this );\n\t\tthis.element\n\t\t\t.removeClass(\"ui-sortable ui-sortable-disabled\");\n\t\tthis._mouseDestroy();\n\n\t\tfor ( var i = this.items.length - 1; i >= 0; i-- )\n\t\t\tthis.items[i].item.removeData(this.widgetName + \"-item\");\n\n\t\treturn this;\n\t},\n\n\t_setOption: function(key, value){\n\t\tif ( key === \"disabled\" ) {\n\t\t\tthis.options[ key ] = value;\n\t\n\t\t\tthis.widget()\n\t\t\t\t[ value ? \"addClass\" : \"removeClass\"]( \"ui-sortable-disabled\" );\n\t\t} else {\n\t\t\t// Don't call widget base _setOption for disable as it adds ui-state-disabled class\n\t\t\t$.Widget.prototype._setOption.apply(this, arguments);\n\t\t}\n\t},\n\n\t_mouseCapture: function(event, overrideHandle) {\n\t\tvar that = this;\n\n\t\tif (this.reverting) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif(this.options.disabled || this.options.type == 'static') return false;\n\n\t\t//We have to refresh the items data once first\n\t\tthis._refreshItems(event);\n\n\t\t//Find out if the clicked node (or one of its parents) is a actual item in this.items\n\t\tvar currentItem = null, self = this, nodes = $(event.target).parents().each(function() {\n\t\t\tif($.data(this, that.widgetName + '-item') == self) {\n\t\t\t\tcurrentItem = $(this);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t\tif($.data(event.target, that.widgetName + '-item') == self) currentItem = $(event.target);\n\n\t\tif(!currentItem) return false;\n\t\tif(this.options.handle && !overrideHandle) {\n\t\t\tvar validHandle = false;\n\n\t\t\t$(this.options.handle, currentItem).find(\"*\").andSelf().each(function() { if(this == event.target) validHandle = true; });\n\t\t\tif(!validHandle) return false;\n\t\t}\n\n\t\tthis.currentItem = currentItem;\n\t\tthis._removeCurrentsFromItems();\n\t\treturn true;\n\n\t},\n\n\t_mouseStart: function(event, overrideHandle, noActivation) {\n\n\t\tvar o = this.options, self = this;\n\t\tthis.currentContainer = this;\n\n\t\t//We only need to call refreshPositions, because the refreshItems call has been moved to mouseCapture\n\t\tthis.refreshPositions();\n\n\t\t//Create and append the visible helper\n\t\tthis.helper = this._createHelper(event);\n\n\t\t//Cache the helper size\n\t\tthis._cacheHelperProportions();\n\n\t\t/*\n\t\t * - Position generation -\n\t\t * This block generates everything position related - it's the core of draggables.\n\t\t */\n\n\t\t//Cache the margins of the original element\n\t\tthis._cacheMargins();\n\n\t\t//Get the next scrolling parent\n\t\tthis.scrollParent = this.helper.scrollParent();\n\n\t\t//The element's absolute position on the page minus margins\n\t\tthis.offset = this.currentItem.offset();\n\t\tthis.offset = {\n\t\t\ttop: this.offset.top - this.margins.top,\n\t\t\tleft: this.offset.left - this.margins.left\n\t\t};\n\n\t\t$.extend(this.offset, {\n\t\t\tclick: { //Where the click happened, relative to the element\n\t\t\t\tleft: event.pageX - this.offset.left,\n\t\t\t\ttop: event.pageY - this.offset.top\n\t\t\t},\n\t\t\tparent: this._getParentOffset(),\n\t\t\trelative: this._getRelativeOffset() //This is a relative to absolute position minus the actual position calculation - only used for relative positioned helper\n\t\t});\n\n\t\t// Only after we got the offset, we can change the helper's position to absolute\n\t\t// TODO: Still need to figure out a way to make relative sorting possible\n\t\tthis.helper.css(\"position\", \"absolute\");\n\t\tthis.cssPosition = this.helper.css(\"position\");\n\t\t\n\t\t//Generate the original position\n\t\tthis.originalPosition = this._generatePosition(event);\n\t\tthis.originalPageX = event.pageX;\n\t\tthis.originalPageY = event.pageY;\n\n\t\t//Adjust the mouse offset relative to the helper if 'cursorAt' is supplied\n\t\t(o.cursorAt && this._adjustOffsetFromHelper(o.cursorAt));\n\n\t\t//Cache the former DOM position\n\t\tthis.domPosition = { prev: this.currentItem.prev()[0], parent: this.currentItem.parent()[0] };\n\n\t\t//If the helper is not the original, hide the original so it's not playing any role during the drag, won't cause anything bad this way\n\t\tif(this.helper[0] != this.currentItem[0]) {\n\t\t\tthis.currentItem.hide();\n\t\t}\n\n\t\t//Create the placeholder\n\t\tthis._createPlaceholder();\n\n\t\t//Set a containment if given in the options\n\t\tif(o.containment)\n\t\t\tthis._setContainment();\n\n\t\tif(o.cursor) { // cursor option\n\t\t\tif ($('body').css(\"cursor\")) this._storedCursor = $('body').css(\"cursor\");\n\t\t\t$('body').css(\"cursor\", o.cursor);\n\t\t}\n\n\t\tif(o.opacity) { // opacity option\n\t\t\tif (this.helper.css(\"opacity\")) this._storedOpacity = this.helper.css(\"opacity\");\n\t\t\tthis.helper.css(\"opacity\", o.opacity);\n\t\t}\n\n\t\tif(o.zIndex) { // zIndex option\n\t\t\tif (this.helper.css(\"zIndex\")) this._storedZIndex = this.helper.css(\"zIndex\");\n\t\t\tthis.helper.css(\"zIndex\", o.zIndex);\n\t\t}\n\n\t\t//Prepare scrolling\n\t\tif(this.scrollParent[0] != document && this.scrollParent[0].tagName != 'HTML')\n\t\t\tthis.overflowOffset = this.scrollParent.offset();\n\n\t\t//Call callbacks\n\t\tthis._trigger(\"start\", event, this._uiHash());\n\n\t\t//Recache the helper size\n\t\tif(!this._preserveHelperProportions)\n\t\t\tthis._cacheHelperProportions();\n\n\n\t\t//Post 'activate' events to possible containers\n\t\tif(!noActivation) {\n\t\t\t for (var i = this.containers.length - 1; i >= 0; i--) { this.containers[i]._trigger(\"activate\", event, self._uiHash(this)); }\n\t\t}\n\n\t\t//Prepare possible droppables\n\t\tif($.ui.ddmanager)\n\t\t\t$.ui.ddmanager.current = this;\n\n\t\tif ($.ui.ddmanager && !o.dropBehaviour)\n\t\t\t$.ui.ddmanager.prepareOffsets(this, event);\n\n\t\tthis.dragging = true;\n\n\t\tthis.helper.addClass(\"ui-sortable-helper\");\n\t\tthis._mouseDrag(event); //Execute the drag once - this causes the helper not to be visible before getting its correct position\n\t\treturn true;\n\n\t},\n\n\t_mouseDrag: function(event) {\n\n\t\t//Compute the helpers position\n\t\tthis.position = this._generatePosition(event);\n\t\tthis.positionAbs = this._convertPositionTo(\"absolute\");\n\n\t\tif (!this.lastPositionAbs) {\n\t\t\tthis.lastPositionAbs = this.positionAbs;\n\t\t}\n\n\t\t//Do scrolling\n\t\tif(this.options.scroll) {\n\t\t\tvar o = this.options, scrolled = false;\n\t\t\tif(this.scrollParent[0] != document && this.scrollParent[0].tagName != 'HTML') {\n\n\t\t\t\tif((this.overflowOffset.top + this.scrollParent[0].offsetHeight) - event.pageY < o.scrollSensitivity)\n\t\t\t\t\tthis.scrollParent[0].scrollTop = scrolled = this.scrollParent[0].scrollTop + o.scrollSpeed;\n\t\t\t\telse if(event.pageY - this.overflowOffset.top < o.scrollSensitivity)\n\t\t\t\t\tthis.scrollParent[0].scrollTop = scrolled = this.scrollParent[0].scrollTop - o.scrollSpeed;\n\n\t\t\t\tif((this.overflowOffset.left + this.scrollParent[0].offsetWidth) - event.pageX < o.scrollSensitivity)\n\t\t\t\t\tthis.scrollParent[0].scrollLeft = scrolled = this.scrollParent[0].scrollLeft + o.scrollSpeed;\n\t\t\t\telse if(event.pageX - this.overflowOffset.left < o.scrollSensitivity)\n\t\t\t\t\tthis.scrollParent[0].scrollLeft = scrolled = this.scrollParent[0].scrollLeft - o.scrollSpeed;\n\n\t\t\t} else {\n\n\t\t\t\tif(event.pageY - $(document).scrollTop() < o.scrollSensitivity)\n\t\t\t\t\tscrolled = $(document).scrollTop($(document).scrollTop() - o.scrollSpeed);\n\t\t\t\telse if($(window).height() - (event.pageY - $(document).scrollTop()) < o.scrollSensitivity)\n\t\t\t\t\tscrolled = $(document).scrollTop($(document).scrollTop() + o.scrollSpeed);\n\n\t\t\t\tif(event.pageX - $(document).scrollLeft() < o.scrollSensitivity)\n\t\t\t\t\tscrolled = $(document).scrollLeft($(document).scrollLeft() - o.scrollSpeed);\n\t\t\t\telse if($(window).width() - (event.pageX - $(document).scrollLeft()) < o.scrollSensitivity)\n\t\t\t\t\tscrolled = $(document).scrollLeft($(document).scrollLeft() + o.scrollSpeed);\n\n\t\t\t}\n\n\t\t\tif(scrolled !== false && $.ui.ddmanager && !o.dropBehaviour)\n\t\t\t\t$.ui.ddmanager.prepareOffsets(this, event);\n\t\t}\n\n\t\t//Regenerate the absolute position used for position checks\n\t\tthis.positionAbs = this._convertPositionTo(\"absolute\");\n\n\t\t//Set the helper position\n\t\tif(!this.options.axis || this.options.axis != \"y\") this.helper[0].style.left = this.position.left+'px';\n\t\tif(!this.options.axis || this.options.axis != \"x\") this.helper[0].style.top = this.position.top+'px';\n\n\t\t//Rearrange\n\t\tfor (var i = this.items.length - 1; i >= 0; i--) {\n\n\t\t\t//Cache variables and intersection, continue if no intersection\n\t\t\tvar item = this.items[i], itemElement = item.item[0], intersection = this._intersectsWithPointer(item);\n\t\t\tif (!intersection) continue;\n\n\t\t\tif(itemElement != this.currentItem[0] //cannot intersect with itself\n\t\t\t\t&&\tthis.placeholder[intersection == 1 ? \"next\" : \"prev\"]()[0] != itemElement //no useless actions that have been done before\n\t\t\t\t&&\t!$.ui.contains(this.placeholder[0], itemElement) //no action if the item moved is the parent of the item checked\n\t\t\t\t&& (this.options.type == 'semi-dynamic' ? !$.ui.contains(this.element[0], itemElement) : true)\n\t\t\t\t//&& itemElement.parentNode == this.placeholder[0].parentNode // only rearrange items within the same container\n\t\t\t) {\n\n\t\t\t\tthis.direction = intersection == 1 ? \"down\" : \"up\";\n\n\t\t\t\tif (this.options.tolerance == \"pointer\" || this._intersectsWithSides(item)) {\n\t\t\t\t\tthis._rearrange(event, item);\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tthis._trigger(\"change\", event, this._uiHash());\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\t//Post events to containers\n\t\tthis._contactContainers(event);\n\n\t\t//Interconnect with droppables\n\t\tif($.ui.ddmanager) $.ui.ddmanager.drag(this, event);\n\n\t\t//Call callbacks\n\t\tthis._trigger('sort', event, this._uiHash());\n\n\t\tthis.lastPositionAbs = this.positionAbs;\n\t\treturn false;\n\n\t},\n\n\t_mouseStop: function(event, noPropagation) {\n\n\t\tif(!event) return;\n\n\t\t//If we are using droppables, inform the manager about the drop\n\t\tif ($.ui.ddmanager && !this.options.dropBehaviour)\n\t\t\t$.ui.ddmanager.drop(this, event);\n\n\t\tif(this.options.revert) {\n\t\t\tvar self = this;\n\t\t\tvar cur = self.placeholder.offset();\n\n\t\t\tself.reverting = true;\n\n\t\t\t$(this.helper).animate({\n\t\t\t\tleft: cur.left - this.offset.parent.left - self.margins.left + (this.offsetParent[0] == document.body ? 0 : this.offsetParent[0].scrollLeft),\n\t\t\t\ttop: cur.top - this.offset.parent.top - self.margins.top + (this.offsetParent[0] == document.body ? 0 : this.offsetParent[0].scrollTop)\n\t\t\t}, parseInt(this.options.revert, 10) || 500, function() {\n\t\t\t\tself._clear(event);\n\t\t\t});\n\t\t} else {\n\t\t\tthis._clear(event, noPropagation);\n\t\t}\n\n\t\treturn false;\n\n\t},\n\n\tcancel: function() {\n\n\t\tvar self = this;\n\n\t\tif(this.dragging) {\n\n\t\t\tthis._mouseUp({ target: null });\n\n\t\t\tif(this.options.helper == \"original\")\n\t\t\t\tthis.currentItem.css(this._storedCSS).removeClass(\"ui-sortable-helper\");\n\t\t\telse\n\t\t\t\tthis.currentItem.show();\n\n\t\t\t//Post deactivating events to containers\n\t\t\tfor (var i = this.containers.length - 1; i >= 0; i--){\n\t\t\t\tthis.containers[i]._trigger(\"deactivate\", null, self._uiHash(this));\n\t\t\t\tif(this.containers[i].containerCache.over) {\n\t\t\t\t\tthis.containers[i]._trigger(\"out\", null, self._uiHash(this));\n\t\t\t\t\tthis.containers[i].containerCache.over = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\tif (this.placeholder) {\n\t\t\t//$(this.placeholder[0]).remove(); would have been the jQuery way - unfortunately, it unbinds ALL events from the original node!\n\t\t\tif(this.placeholder[0].parentNode) this.placeholder[0].parentNode.removeChild(this.placeholder[0]);\n\t\t\tif(this.options.helper != \"original\" && this.helper && this.helper[0].parentNode) this.helper.remove();\n\n\t\t\t$.extend(this, {\n\t\t\t\thelper: null,\n\t\t\t\tdragging: false,\n\t\t\t\treverting: false,\n\t\t\t\t_noFinalSort: null\n\t\t\t});\n\n\t\t\tif(this.domPosition.prev) {\n\t\t\t\t$(this.domPosition.prev).after(this.currentItem);\n\t\t\t} else {\n\t\t\t\t$(this.domPosition.parent).prepend(this.currentItem);\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tserialize: function(o) {\n\n\t\tvar items = this._getItemsAsjQuery(o && o.connected);\n\t\tvar str = []; o = o || {};\n\n\t\t$(items).each(function() {\n\t\t\tvar res = ($(o.item || this).attr(o.attribute || 'id') || '').match(o.expression || (/(.+)[-=_](.+)/));\n\t\t\tif(res) str.push((o.key || res[1]+'[]')+'='+(o.key && o.expression ? res[1] : res[2]));\n\t\t});\n\n\t\tif(!str.length && o.key) {\n\t\t\tstr.push(o.key + '=');\n\t\t}\n\n\t\treturn str.join('&');\n\n\t},\n\n\ttoArray: function(o) {\n\n\t\tvar items = this._getItemsAsjQuery(o && o.connected);\n\t\tvar ret = []; o = o || {};\n\n\t\titems.each(function() { ret.push($(o.item || this).attr(o.attribute || 'id') || ''); });\n\t\treturn ret;\n\n\t},\n\n\t/* Be careful with the following core functions */\n\t_intersectsWith: function(item) {\n\n\t\tvar x1 = this.positionAbs.left,\n\t\t\tx2 = x1 + this.helperProportions.width,\n\t\t\ty1 = this.positionAbs.top,\n\t\t\ty2 = y1 + this.helperProportions.height;\n\n\t\tvar l = item.left,\n\t\t\tr = l + item.width,\n\t\t\tt = item.top,\n\t\t\tb = t + item.height;\n\n\t\tvar dyClick = this.offset.click.top,\n\t\t\tdxClick = this.offset.click.left;\n\n\t\tvar isOverElement = (y1 + dyClick) > t && (y1 + dyClick) < b && (x1 + dxClick) > l && (x1 + dxClick) < r;\n\n\t\tif(\t   this.options.tolerance == \"pointer\"\n\t\t\t|| this.options.forcePointerForContainers\n\t\t\t|| (this.options.tolerance != \"pointer\" && this.helperProportions[this.floating ? 'width' : 'height'] > item[this.floating ? 'width' : 'height'])\n\t\t) {\n\t\t\treturn isOverElement;\n\t\t} else {\n\n\t\t\treturn (l < x1 + (this.helperProportions.width / 2) // Right Half\n\t\t\t\t&& x2 - (this.helperProportions.width / 2) < r // Left Half\n\t\t\t\t&& t < y1 + (this.helperProportions.height / 2) // Bottom Half\n\t\t\t\t&& y2 - (this.helperProportions.height / 2) < b ); // Top Half\n\n\t\t}\n\t},\n\n\t_intersectsWithPointer: function(item) {\n\n\t\tvar isOverElementHeight = (this.options.axis === 'x') || $.ui.isOverAxis(this.positionAbs.top + this.offset.click.top, item.top, item.height),\n\t\t\tisOverElementWidth = (this.options.axis === 'y') || $.ui.isOverAxis(this.positionAbs.left + this.offset.click.left, item.left, item.width),\n\t\t\tisOverElement = isOverElementHeight && isOverElementWidth,\n\t\t\tverticalDirection = this._getDragVerticalDirection(),\n\t\t\thorizontalDirection = this._getDragHorizontalDirection();\n\n\t\tif (!isOverElement)\n\t\t\treturn false;\n\n\t\treturn this.floating ?\n\t\t\t( ((horizontalDirection && horizontalDirection == \"right\") || verticalDirection == \"down\") ? 2 : 1 )\n\t\t\t: ( verticalDirection && (verticalDirection == \"down\" ? 2 : 1) );\n\n\t},\n\n\t_intersectsWithSides: function(item) {\n\n\t\tvar isOverBottomHalf = $.ui.isOverAxis(this.positionAbs.top + this.offset.click.top, item.top + (item.height/2), item.height),\n\t\t\tisOverRightHalf = $.ui.isOverAxis(this.positionAbs.left + this.offset.click.left, item.left + (item.width/2), item.width),\n\t\t\tverticalDirection = this._getDragVerticalDirection(),\n\t\t\thorizontalDirection = this._getDragHorizontalDirection();\n\n\t\tif (this.floating && horizontalDirection) {\n\t\t\treturn ((horizontalDirection == \"right\" && isOverRightHalf) || (horizontalDirection == \"left\" && !isOverRightHalf));\n\t\t} else {\n\t\t\treturn verticalDirection && ((verticalDirection == \"down\" && isOverBottomHalf) || (verticalDirection == \"up\" && !isOverBottomHalf));\n\t\t}\n\n\t},\n\n\t_getDragVerticalDirection: function() {\n\t\tvar delta = this.positionAbs.top - this.lastPositionAbs.top;\n\t\treturn delta != 0 && (delta > 0 ? \"down\" : \"up\");\n\t},\n\n\t_getDragHorizontalDirection: function() {\n\t\tvar delta = this.positionAbs.left - this.lastPositionAbs.left;\n\t\treturn delta != 0 && (delta > 0 ? \"right\" : \"left\");\n\t},\n\n\trefresh: function(event) {\n\t\tthis._refreshItems(event);\n\t\tthis.refreshPositions();\n\t\treturn this;\n\t},\n\n\t_connectWith: function() {\n\t\tvar options = this.options;\n\t\treturn options.connectWith.constructor == String\n\t\t\t? [options.connectWith]\n\t\t\t: options.connectWith;\n\t},\n\t\n\t_getItemsAsjQuery: function(connected) {\n\n\t\tvar self = this;\n\t\tvar items = [];\n\t\tvar queries = [];\n\t\tvar connectWith = this._connectWith();\n\n\t\tif(connectWith && connected) {\n\t\t\tfor (var i = connectWith.length - 1; i >= 0; i--){\n\t\t\t\tvar cur = $(connectWith[i]);\n\t\t\t\tfor (var j = cur.length - 1; j >= 0; j--){\n\t\t\t\t\tvar inst = $.data(cur[j], this.widgetName);\n\t\t\t\t\tif(inst && inst != this && !inst.options.disabled) {\n\t\t\t\t\t\tqueries.push([$.isFunction(inst.options.items) ? inst.options.items.call(inst.element) : $(inst.options.items, inst.element).not(\".ui-sortable-helper\").not('.ui-sortable-placeholder'), inst]);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t};\n\t\t}\n\n\t\tqueries.push([$.isFunction(this.options.items) ? this.options.items.call(this.element, null, { options: this.options, item: this.currentItem }) : $(this.options.items, this.element).not(\".ui-sortable-helper\").not('.ui-sortable-placeholder'), this]);\n\n\t\tfor (var i = queries.length - 1; i >= 0; i--){\n\t\t\tqueries[i][0].each(function() {\n\t\t\t\titems.push(this);\n\t\t\t});\n\t\t};\n\n\t\treturn $(items);\n\n\t},\n\n\t_removeCurrentsFromItems: function() {\n\n\t\tvar list = this.currentItem.find(\":data(\" + this.widgetName + \"-item)\");\n\n\t\tfor (var i=0; i < this.items.length; i++) {\n\n\t\t\tfor (var j=0; j < list.length; j++) {\n\t\t\t\tif(list[j] == this.items[i].item[0])\n\t\t\t\t\tthis.items.splice(i,1);\n\t\t\t};\n\n\t\t};\n\n\t},\n\n\t_refreshItems: function(event) {\n\n\t\tthis.items = [];\n\t\tthis.containers = [this];\n\t\tvar items = this.items;\n\t\tvar self = this;\n\t\tvar queries = [[$.isFunction(this.options.items) ? this.options.items.call(this.element[0], event, { item: this.currentItem }) : $(this.options.items, this.element), this]];\n\t\tvar connectWith = this._connectWith();\n\n\t\tif(connectWith && this.ready) { //Shouldn't be run the first time through due to massive slow-down\n\t\t\tfor (var i = connectWith.length - 1; i >= 0; i--){\n\t\t\t\tvar cur = $(connectWith[i]);\n\t\t\t\tfor (var j = cur.length - 1; j >= 0; j--){\n\t\t\t\t\tvar inst = $.data(cur[j], this.widgetName);\n\t\t\t\t\tif(inst && inst != this && !inst.options.disabled) {\n\t\t\t\t\t\tqueries.push([$.isFunction(inst.options.items) ? inst.options.items.call(inst.element[0], event, { item: this.currentItem }) : $(inst.options.items, inst.element), inst]);\n\t\t\t\t\t\tthis.containers.push(inst);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t};\n\t\t}\n\n\t\tfor (var i = queries.length - 1; i >= 0; i--) {\n\t\t\tvar targetData = queries[i][1];\n\t\t\tvar _queries = queries[i][0];\n\n\t\t\tfor (var j=0, queriesLength = _queries.length; j < queriesLength; j++) {\n\t\t\t\tvar item = $(_queries[j]);\n\n\t\t\t\titem.data(this.widgetName + '-item', targetData); // Data for target checking (mouse manager)\n\n\t\t\t\titems.push({\n\t\t\t\t\titem: item,\n\t\t\t\t\tinstance: targetData,\n\t\t\t\t\twidth: 0, height: 0,\n\t\t\t\t\tleft: 0, top: 0\n\t\t\t\t});\n\t\t\t};\n\t\t};\n\n\t},\n\n\trefreshPositions: function(fast) {\n\n\t\t//This has to be redone because due to the item being moved out/into the offsetParent, the offsetParent's position will change\n\t\tif(this.offsetParent && this.helper) {\n\t\t\tthis.offset.parent = this._getParentOffset();\n\t\t}\n\n\t\tfor (var i = this.items.length - 1; i >= 0; i--){\n\t\t\tvar item = this.items[i];\n\n\t\t\t//We ignore calculating positions of all connected containers when we're not over them\n\t\t\tif(item.instance != this.currentContainer && this.currentContainer && item.item[0] != this.currentItem[0])\n\t\t\t\tcontinue;\n\n\t\t\tvar t = this.options.toleranceElement ? $(this.options.toleranceElement, item.item) : item.item;\n\n\t\t\tif (!fast) {\n\t\t\t\titem.width = t.outerWidth();\n\t\t\t\titem.height = t.outerHeight();\n\t\t\t}\n\n\t\t\tvar p = t.offset();\n\t\t\titem.left = p.left;\n\t\t\titem.top = p.top;\n\t\t};\n\n\t\tif(this.options.custom && this.options.custom.refreshContainers) {\n\t\t\tthis.options.custom.refreshContainers.call(this);\n\t\t} else {\n\t\t\tfor (var i = this.containers.length - 1; i >= 0; i--){\n\t\t\t\tvar p = this.containers[i].element.offset();\n\t\t\t\tthis.containers[i].containerCache.left = p.left;\n\t\t\t\tthis.containers[i].containerCache.top = p.top;\n\t\t\t\tthis.containers[i].containerCache.width\t= this.containers[i].element.outerWidth();\n\t\t\t\tthis.containers[i].containerCache.height = this.containers[i].element.outerHeight();\n\t\t\t};\n\t\t}\n\n\t\treturn this;\n\t},\n\n\t_createPlaceholder: function(that) {\n\n\t\tvar self = that || this, o = self.options;\n\n\t\tif(!o.placeholder || o.placeholder.constructor == String) {\n\t\t\tvar className = o.placeholder;\n\t\t\to.placeholder = {\n\t\t\t\telement: function() {\n\n\t\t\t\t\tvar el = $(document.createElement(self.currentItem[0].nodeName))\n\t\t\t\t\t\t.addClass(className || self.currentItem[0].className+\" ui-sortable-placeholder\")\n\t\t\t\t\t\t.removeClass(\"ui-sortable-helper\")[0];\n\n\t\t\t\t\tif(!className)\n\t\t\t\t\t\tel.style.visibility = \"hidden\";\n\n\t\t\t\t\treturn el;\n\t\t\t\t},\n\t\t\t\tupdate: function(container, p) {\n\n\t\t\t\t\t// 1. If a className is set as 'placeholder option, we don't force sizes - the class is responsible for that\n\t\t\t\t\t// 2. The option 'forcePlaceholderSize can be enabled to force it even if a class name is specified\n\t\t\t\t\tif(className && !o.forcePlaceholderSize) return;\n\n\t\t\t\t\t//If the element doesn't have a actual height by itself (without styles coming from a stylesheet), it receives the inline height from the dragged item\n\t\t\t\t\tif(!p.height()) { p.height(self.currentItem.innerHeight() - parseInt(self.currentItem.css('paddingTop')||0, 10) - parseInt(self.currentItem.css('paddingBottom')||0, 10)); };\n\t\t\t\t\tif(!p.width()) { p.width(self.currentItem.innerWidth() - parseInt(self.currentItem.css('paddingLeft')||0, 10) - parseInt(self.currentItem.css('paddingRight')||0, 10)); };\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t//Create the placeholder\n\t\tself.placeholder = $(o.placeholder.element.call(self.element, self.currentItem));\n\n\t\t//Append it after the actual current item\n\t\tself.currentItem.after(self.placeholder);\n\n\t\t//Update the size of the placeholder (TODO: Logic to fuzzy, see line 316/317)\n\t\to.placeholder.update(self, self.placeholder);\n\n\t},\n\n\t_contactContainers: function(event) {\n\t\t\n\t\t// get innermost container that intersects with item \n\t\tvar innermostContainer = null, innermostIndex = null;\t\t\n\t\t\n\t\t\n\t\tfor (var i = this.containers.length - 1; i >= 0; i--){\n\n\t\t\t// never consider a container that's located within the item itself \n\t\t\tif($.ui.contains(this.currentItem[0], this.containers[i].element[0]))\n\t\t\t\tcontinue;\n\n\t\t\tif(this._intersectsWith(this.containers[i].containerCache)) {\n\n\t\t\t\t// if we've already found a container and it's more \"inner\" than this, then continue \n\t\t\t\tif(innermostContainer && $.ui.contains(this.containers[i].element[0], innermostContainer.element[0]))\n\t\t\t\t\tcontinue;\n\n\t\t\t\tinnermostContainer = this.containers[i]; \n\t\t\t\tinnermostIndex = i;\n\t\t\t\t\t\n\t\t\t} else {\n\t\t\t\t// container doesn't intersect. trigger \"out\" event if necessary \n\t\t\t\tif(this.containers[i].containerCache.over) {\n\t\t\t\t\tthis.containers[i]._trigger(\"out\", event, this._uiHash(this));\n\t\t\t\t\tthis.containers[i].containerCache.over = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t\t\n\t\t// if no intersecting containers found, return \n\t\tif(!innermostContainer) return; \n\n\t\t// move the item into the container if it's not there already\n\t\tif(this.containers.length === 1) {\n\t\t\tthis.containers[innermostIndex]._trigger(\"over\", event, this._uiHash(this));\n\t\t\tthis.containers[innermostIndex].containerCache.over = 1;\n\t\t} else if(this.currentContainer != this.containers[innermostIndex]) {\n\n\t\t\t//When entering a new container, we will find the item with the least distance and append our item near it\n\t\t\tvar dist = 10000; var itemWithLeastDistance = null; var base = this.positionAbs[this.containers[innermostIndex].floating ? 'left' : 'top'];\n\t\t\tfor (var j = this.items.length - 1; j >= 0; j--) {\n\t\t\t\tif(!$.ui.contains(this.containers[innermostIndex].element[0], this.items[j].item[0])) continue;\n\t\t\t\tvar cur = this.containers[innermostIndex].floating ? this.items[j].item.offset().left : this.items[j].item.offset().top;\n\t\t\t\tif(Math.abs(cur - base) < dist) {\n\t\t\t\t\tdist = Math.abs(cur - base); itemWithLeastDistance = this.items[j];\n\t\t\t\t\tthis.direction = (cur - base > 0) ? 'down' : 'up';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(!itemWithLeastDistance && !this.options.dropOnEmpty) //Check if dropOnEmpty is enabled\n\t\t\t\treturn;\n\n\t\t\tthis.currentContainer = this.containers[innermostIndex];\n\t\t\titemWithLeastDistance ? this._rearrange(event, itemWithLeastDistance, null, true) : this._rearrange(event, null, this.containers[innermostIndex].element, true);\n\t\t\tthis._trigger(\"change\", event, this._uiHash());\n\t\t\tthis.containers[innermostIndex]._trigger(\"change\", event, this._uiHash(this));\n\n\t\t\t//Update the placeholder\n\t\t\tthis.options.placeholder.update(this.currentContainer, this.placeholder);\n\n\t\t\tthis.containers[innermostIndex]._trigger(\"over\", event, this._uiHash(this));\n\t\t\tthis.containers[innermostIndex].containerCache.over = 1;\n\t\t} \n\t\n\t\t\n\t},\n\n\t_createHelper: function(event) {\n\n\t\tvar o = this.options;\n\t\tvar helper = $.isFunction(o.helper) ? $(o.helper.apply(this.element[0], [event, this.currentItem])) : (o.helper == 'clone' ? this.currentItem.clone() : this.currentItem);\n\n\t\tif(!helper.parents('body').length) //Add the helper to the DOM if that didn't happen already\n\t\t\t$(o.appendTo != 'parent' ? o.appendTo : this.currentItem[0].parentNode)[0].appendChild(helper[0]);\n\n\t\tif(helper[0] == this.currentItem[0])\n\t\t\tthis._storedCSS = { width: this.currentItem[0].style.width, height: this.currentItem[0].style.height, position: this.currentItem.css(\"position\"), top: this.currentItem.css(\"top\"), left: this.currentItem.css(\"left\") };\n\n\t\tif(helper[0].style.width == '' || o.forceHelperSize) helper.width(this.currentItem.width());\n\t\tif(helper[0].style.height == '' || o.forceHelperSize) helper.height(this.currentItem.height());\n\n\t\treturn helper;\n\n\t},\n\n\t_adjustOffsetFromHelper: function(obj) {\n\t\tif (typeof obj == 'string') {\n\t\t\tobj = obj.split(' ');\n\t\t}\n\t\tif ($.isArray(obj)) {\n\t\t\tobj = {left: +obj[0], top: +obj[1] || 0};\n\t\t}\n\t\tif ('left' in obj) {\n\t\t\tthis.offset.click.left = obj.left + this.margins.left;\n\t\t}\n\t\tif ('right' in obj) {\n\t\t\tthis.offset.click.left = this.helperProportions.width - obj.right + this.margins.left;\n\t\t}\n\t\tif ('top' in obj) {\n\t\t\tthis.offset.click.top = obj.top + this.margins.top;\n\t\t}\n\t\tif ('bottom' in obj) {\n\t\t\tthis.offset.click.top = this.helperProportions.height - obj.bottom + this.margins.top;\n\t\t}\n\t},\n\n\t_getParentOffset: function() {\n\n\n\t\t//Get the offsetParent and cache its position\n\t\tthis.offsetParent = this.helper.offsetParent();\n\t\tvar po = this.offsetParent.offset();\n\n\t\t// This is a special case where we need to modify a offset calculated on start, since the following happened:\n\t\t// 1. The position of the helper is absolute, so it's position is calculated based on the next positioned parent\n\t\t// 2. The actual offset parent is a child of the scroll parent, and the scroll parent isn't the document, which means that\n\t\t//    the scroll is included in the initial calculation of the offset of the parent, and never recalculated upon drag\n\t\tif(this.cssPosition == 'absolute' && this.scrollParent[0] != document && $.ui.contains(this.scrollParent[0], this.offsetParent[0])) {\n\t\t\tpo.left += this.scrollParent.scrollLeft();\n\t\t\tpo.top += this.scrollParent.scrollTop();\n\t\t}\n\n\t\tif((this.offsetParent[0] == document.body) //This needs to be actually done for all browsers, since pageX/pageY includes this information\n\t\t|| (this.offsetParent[0].tagName && this.offsetParent[0].tagName.toLowerCase() == 'html' && $.browser.msie)) //Ugly IE fix\n\t\t\tpo = { top: 0, left: 0 };\n\n\t\treturn {\n\t\t\ttop: po.top + (parseInt(this.offsetParent.css(\"borderTopWidth\"),10) || 0),\n\t\t\tleft: po.left + (parseInt(this.offsetParent.css(\"borderLeftWidth\"),10) || 0)\n\t\t};\n\n\t},\n\n\t_getRelativeOffset: function() {\n\n\t\tif(this.cssPosition == \"relative\") {\n\t\t\tvar p = this.currentItem.position();\n\t\t\treturn {\n\t\t\t\ttop: p.top - (parseInt(this.helper.css(\"top\"),10) || 0) + this.scrollParent.scrollTop(),\n\t\t\t\tleft: p.left - (parseInt(this.helper.css(\"left\"),10) || 0) + this.scrollParent.scrollLeft()\n\t\t\t};\n\t\t} else {\n\t\t\treturn { top: 0, left: 0 };\n\t\t}\n\n\t},\n\n\t_cacheMargins: function() {\n\t\tthis.margins = {\n\t\t\tleft: (parseInt(this.currentItem.css(\"marginLeft\"),10) || 0),\n\t\t\ttop: (parseInt(this.currentItem.css(\"marginTop\"),10) || 0)\n\t\t};\n\t},\n\n\t_cacheHelperProportions: function() {\n\t\tthis.helperProportions = {\n\t\t\twidth: this.helper.outerWidth(),\n\t\t\theight: this.helper.outerHeight()\n\t\t};\n\t},\n\n\t_setContainment: function() {\n\n\t\tvar o = this.options;\n\t\tif(o.containment == 'parent') o.containment = this.helper[0].parentNode;\n\t\tif(o.containment == 'document' || o.containment == 'window') this.containment = [\n\t\t\t0 - this.offset.relative.left - this.offset.parent.left,\n\t\t\t0 - this.offset.relative.top - this.offset.parent.top,\n\t\t\t$(o.containment == 'document' ? document : window).width() - this.helperProportions.width - this.margins.left,\n\t\t\t($(o.containment == 'document' ? document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top\n\t\t];\n\n\t\tif(!(/^(document|window|parent)$/).test(o.containment)) {\n\t\t\tvar ce = $(o.containment)[0];\n\t\t\tvar co = $(o.containment).offset();\n\t\t\tvar over = ($(ce).css(\"overflow\") != 'hidden');\n\n\t\t\tthis.containment = [\n\t\t\t\tco.left + (parseInt($(ce).css(\"borderLeftWidth\"),10) || 0) + (parseInt($(ce).css(\"paddingLeft\"),10) || 0) - this.margins.left,\n\t\t\t\tco.top + (parseInt($(ce).css(\"borderTopWidth\"),10) || 0) + (parseInt($(ce).css(\"paddingTop\"),10) || 0) - this.margins.top,\n\t\t\t\tco.left+(over ? Math.max(ce.scrollWidth,ce.offsetWidth) : ce.offsetWidth) - (parseInt($(ce).css(\"borderLeftWidth\"),10) || 0) - (parseInt($(ce).css(\"paddingRight\"),10) || 0) - this.helperProportions.width - this.margins.left,\n\t\t\t\tco.top+(over ? Math.max(ce.scrollHeight,ce.offsetHeight) : ce.offsetHeight) - (parseInt($(ce).css(\"borderTopWidth\"),10) || 0) - (parseInt($(ce).css(\"paddingBottom\"),10) || 0) - this.helperProportions.height - this.margins.top\n\t\t\t];\n\t\t}\n\n\t},\n\n\t_convertPositionTo: function(d, pos) {\n\n\t\tif(!pos) pos = this.position;\n\t\tvar mod = d == \"absolute\" ? 1 : -1;\n\t\tvar o = this.options, scroll = this.cssPosition == 'absolute' && !(this.scrollParent[0] != document && $.ui.contains(this.scrollParent[0], this.offsetParent[0])) ? this.offsetParent : this.scrollParent, scrollIsRootNode = (/(html|body)/i).test(scroll[0].tagName);\n\n\t\treturn {\n\t\t\ttop: (\n\t\t\t\tpos.top\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// The absolute mouse position\n\t\t\t\t+ this.offset.relative.top * mod\t\t\t\t\t\t\t\t\t\t// Only for relative positioned nodes: Relative offset from element to offset parent\n\t\t\t\t+ this.offset.parent.top * mod\t\t\t\t\t\t\t\t\t\t\t// The offsetParent's offset without borders (offset + border)\n\t\t\t\t- ($.browser.safari && this.cssPosition == 'fixed' ? 0 : ( this.cssPosition == 'fixed' ? -this.scrollParent.scrollTop() : ( scrollIsRootNode ? 0 : scroll.scrollTop() ) ) * mod)\n\t\t\t),\n\t\t\tleft: (\n\t\t\t\tpos.left\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// The absolute mouse position\n\t\t\t\t+ this.offset.relative.left * mod\t\t\t\t\t\t\t\t\t\t// Only for relative positioned nodes: Relative offset from element to offset parent\n\t\t\t\t+ this.offset.parent.left * mod\t\t\t\t\t\t\t\t\t\t\t// The offsetParent's offset without borders (offset + border)\n\t\t\t\t- ($.browser.safari && this.cssPosition == 'fixed' ? 0 : ( this.cssPosition == 'fixed' ? -this.scrollParent.scrollLeft() : scrollIsRootNode ? 0 : scroll.scrollLeft() ) * mod)\n\t\t\t)\n\t\t};\n\n\t},\n\n\t_generatePosition: function(event) {\n\n\t\tvar o = this.options, scroll = this.cssPosition == 'absolute' && !(this.scrollParent[0] != document && $.ui.contains(this.scrollParent[0], this.offsetParent[0])) ? this.offsetParent : this.scrollParent, scrollIsRootNode = (/(html|body)/i).test(scroll[0].tagName);\n\n\t\t// This is another very weird special case that only happens for relative elements:\n\t\t// 1. If the css position is relative\n\t\t// 2. and the scroll parent is the document or similar to the offset parent\n\t\t// we have to refresh the relative offset during the scroll so there are no jumps\n\t\tif(this.cssPosition == 'relative' && !(this.scrollParent[0] != document && this.scrollParent[0] != this.offsetParent[0])) {\n\t\t\tthis.offset.relative = this._getRelativeOffset();\n\t\t}\n\n\t\tvar pageX = event.pageX;\n\t\tvar pageY = event.pageY;\n\n\t\t/*\n\t\t * - Position constraining -\n\t\t * Constrain the position to a mix of grid, containment.\n\t\t */\n\n\t\tif(this.originalPosition) { //If we are not dragging yet, we won't check for options\n\n\t\t\tif(this.containment) {\n\t\t\t\tif(event.pageX - this.offset.click.left < this.containment[0]) pageX = this.containment[0] + this.offset.click.left;\n\t\t\t\tif(event.pageY - this.offset.click.top < this.containment[1]) pageY = this.containment[1] + this.offset.click.top;\n\t\t\t\tif(event.pageX - this.offset.click.left > this.containment[2]) pageX = this.containment[2] + this.offset.click.left;\n\t\t\t\tif(event.pageY - this.offset.click.top > this.containment[3]) pageY = this.containment[3] + this.offset.click.top;\n\t\t\t}\n\n\t\t\tif(o.grid) {\n\t\t\t\tvar top = this.originalPageY + Math.round((pageY - this.originalPageY) / o.grid[1]) * o.grid[1];\n\t\t\t\tpageY = this.containment ? (!(top - this.offset.click.top < this.containment[1] || top - this.offset.click.top > this.containment[3]) ? top : (!(top - this.offset.click.top < this.containment[1]) ? top - o.grid[1] : top + o.grid[1])) : top;\n\n\t\t\t\tvar left = this.originalPageX + Math.round((pageX - this.originalPageX) / o.grid[0]) * o.grid[0];\n\t\t\t\tpageX = this.containment ? (!(left - this.offset.click.left < this.containment[0] || left - this.offset.click.left > this.containment[2]) ? left : (!(left - this.offset.click.left < this.containment[0]) ? left - o.grid[0] : left + o.grid[0])) : left;\n\t\t\t}\n\n\t\t}\n\n\t\treturn {\n\t\t\ttop: (\n\t\t\t\tpageY\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// The absolute mouse position\n\t\t\t\t- this.offset.click.top\t\t\t\t\t\t\t\t\t\t\t\t\t// Click offset (relative to the element)\n\t\t\t\t- this.offset.relative.top\t\t\t\t\t\t\t\t\t\t\t\t// Only for relative positioned nodes: Relative offset from element to offset parent\n\t\t\t\t- this.offset.parent.top\t\t\t\t\t\t\t\t\t\t\t\t// The offsetParent's offset without borders (offset + border)\n\t\t\t\t+ ($.browser.safari && this.cssPosition == 'fixed' ? 0 : ( this.cssPosition == 'fixed' ? -this.scrollParent.scrollTop() : ( scrollIsRootNode ? 0 : scroll.scrollTop() ) ))\n\t\t\t),\n\t\t\tleft: (\n\t\t\t\tpageX\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// The absolute mouse position\n\t\t\t\t- this.offset.click.left\t\t\t\t\t\t\t\t\t\t\t\t// Click offset (relative to the element)\n\t\t\t\t- this.offset.relative.left\t\t\t\t\t\t\t\t\t\t\t\t// Only for relative positioned nodes: Relative offset from element to offset parent\n\t\t\t\t- this.offset.parent.left\t\t\t\t\t\t\t\t\t\t\t\t// The offsetParent's offset without borders (offset + border)\n\t\t\t\t+ ($.browser.safari && this.cssPosition == 'fixed' ? 0 : ( this.cssPosition == 'fixed' ? -this.scrollParent.scrollLeft() : scrollIsRootNode ? 0 : scroll.scrollLeft() ))\n\t\t\t)\n\t\t};\n\n\t},\n\n\t_rearrange: function(event, i, a, hardRefresh) {\n\n\t\ta ? a[0].appendChild(this.placeholder[0]) : i.item[0].parentNode.insertBefore(this.placeholder[0], (this.direction == 'down' ? i.item[0] : i.item[0].nextSibling));\n\n\t\t//Various things done here to improve the performance:\n\t\t// 1. we create a setTimeout, that calls refreshPositions\n\t\t// 2. on the instance, we have a counter variable, that get's higher after every append\n\t\t// 3. on the local scope, we copy the counter variable, and check in the timeout, if it's still the same\n\t\t// 4. this lets only the last addition to the timeout stack through\n\t\tthis.counter = this.counter ? ++this.counter : 1;\n\t\tvar self = this, counter = this.counter;\n\n\t\twindow.setTimeout(function() {\n\t\t\tif(counter == self.counter) self.refreshPositions(!hardRefresh); //Precompute after each DOM insertion, NOT on mousemove\n\t\t},0);\n\n\t},\n\n\t_clear: function(event, noPropagation) {\n\n\t\tthis.reverting = false;\n\t\t// We delay all events that have to be triggered to after the point where the placeholder has been removed and\n\t\t// everything else normalized again\n\t\tvar delayedTriggers = [], self = this;\n\n\t\t// We first have to update the dom position of the actual currentItem\n\t\t// Note: don't do it if the current item is already removed (by a user), or it gets reappended (see #4088)\n\t\tif(!this._noFinalSort && this.currentItem.parent().length) this.placeholder.before(this.currentItem);\n\t\tthis._noFinalSort = null;\n\n\t\tif(this.helper[0] == this.currentItem[0]) {\n\t\t\tfor(var i in this._storedCSS) {\n\t\t\t\tif(this._storedCSS[i] == 'auto' || this._storedCSS[i] == 'static') this._storedCSS[i] = '';\n\t\t\t}\n\t\t\tthis.currentItem.css(this._storedCSS).removeClass(\"ui-sortable-helper\");\n\t\t} else {\n\t\t\tthis.currentItem.show();\n\t\t}\n\n\t\tif(this.fromOutside && !noPropagation) delayedTriggers.push(function(event) { this._trigger(\"receive\", event, this._uiHash(this.fromOutside)); });\n\t\tif((this.fromOutside || this.domPosition.prev != this.currentItem.prev().not(\".ui-sortable-helper\")[0] || this.domPosition.parent != this.currentItem.parent()[0]) && !noPropagation) delayedTriggers.push(function(event) { this._trigger(\"update\", event, this._uiHash()); }); //Trigger update callback if the DOM position has changed\n\t\tif(!$.ui.contains(this.element[0], this.currentItem[0])) { //Node was moved out of the current element\n\t\t\tif(!noPropagation) delayedTriggers.push(function(event) { this._trigger(\"remove\", event, this._uiHash()); });\n\t\t\tfor (var i = this.containers.length - 1; i >= 0; i--){\n\t\t\t\tif($.ui.contains(this.containers[i].element[0], this.currentItem[0]) && !noPropagation) {\n\t\t\t\t\tdelayedTriggers.push((function(c) { return function(event) { c._trigger(\"receive\", event, this._uiHash(this)); };  }).call(this, this.containers[i]));\n\t\t\t\t\tdelayedTriggers.push((function(c) { return function(event) { c._trigger(\"update\", event, this._uiHash(this));  }; }).call(this, this.containers[i]));\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\n\t\t//Post events to containers\n\t\tfor (var i = this.containers.length - 1; i >= 0; i--){\n\t\t\tif(!noPropagation) delayedTriggers.push((function(c) { return function(event) { c._trigger(\"deactivate\", event, this._uiHash(this)); };  }).call(this, this.containers[i]));\n\t\t\tif(this.containers[i].containerCache.over) {\n\t\t\t\tdelayedTriggers.push((function(c) { return function(event) { c._trigger(\"out\", event, this._uiHash(this)); };  }).call(this, this.containers[i]));\n\t\t\t\tthis.containers[i].containerCache.over = 0;\n\t\t\t}\n\t\t}\n\n\t\t//Do what was originally in plugins\n\t\tif(this._storedCursor) $('body').css(\"cursor\", this._storedCursor); //Reset cursor\n\t\tif(this._storedOpacity) this.helper.css(\"opacity\", this._storedOpacity); //Reset opacity\n\t\tif(this._storedZIndex) this.helper.css(\"zIndex\", this._storedZIndex == 'auto' ? '' : this._storedZIndex); //Reset z-index\n\n\t\tthis.dragging = false;\n\t\tif(this.cancelHelperRemoval) {\n\t\t\tif(!noPropagation) {\n\t\t\t\tthis._trigger(\"beforeStop\", event, this._uiHash());\n\t\t\t\tfor (var i=0; i < delayedTriggers.length; i++) { delayedTriggers[i].call(this, event); }; //Trigger all delayed events\n\t\t\t\tthis._trigger(\"stop\", event, this._uiHash());\n\t\t\t}\n\n\t\t\tthis.fromOutside = false;\n\t\t\treturn false;\n\t\t}\n\n\t\tif(!noPropagation) this._trigger(\"beforeStop\", event, this._uiHash());\n\n\t\t//$(this.placeholder[0]).remove(); would have been the jQuery way - unfortunately, it unbinds ALL events from the original node!\n\t\tthis.placeholder[0].parentNode && this.placeholder[0].parentNode.removeChild(this.placeholder[0]);\n\n\n\t\tif(this.helper && this.helper[0] != this.currentItem[0]) this.helper.remove(); this.helper = null;\n\n\t\tif(!noPropagation) {\n\t\t\tfor (var i=0; i < delayedTriggers.length; i++) { delayedTriggers[i].call(this, event); }; //Trigger all delayed events\n\t\t\tthis._trigger(\"stop\", event, this._uiHash());\n\t\t}\n\n\t\tthis.fromOutside = false;\n\t\treturn true;\n\n\t},\n\n\t_trigger: function() {\n\t\tif ($.Widget.prototype._trigger.apply(this, arguments) === false) {\n\t\t\tthis.cancel();\n\t\t}\n\t},\n\n\t_uiHash: function(inst) {\n\t\tvar self = inst || this;\n\t\treturn {\n\t\t\thelper: self.helper,\n\t\t\tplaceholder: self.placeholder || $([]),\n\t\t\tposition: self.position,\n\t\t\toriginalPosition: self.originalPosition,\n\t\t\toffset: self.positionAbs,\n\t\t\titem: self.currentItem,\n\t\t\tsender: inst ? inst.element : null\n\t\t};\n\t}\n\n});\n\n$.extend($.ui.sortable, {\n\tversion: \"1.8.23\"\n});\n\n})(jQuery);\n","/*!\n * jQuery UI Widget 1.8.23\n *\n * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)\n * Dual licensed under the MIT or GPL Version 2 licenses.\n * http://jquery.org/license\n *\n * http://docs.jquery.com/UI/Widget\n */\n(function( $, undefined ) {\n\n// jQuery 1.4+\nif ( $.cleanData ) {\n\tvar _cleanData = $.cleanData;\n\t$.cleanData = function( elems ) {\n\t\tfor ( var i = 0, elem; (elem = elems[i]) != null; i++ ) {\n\t\t\ttry {\n\t\t\t\t$( elem ).triggerHandler( \"remove\" );\n\t\t\t// http://bugs.jquery.com/ticket/8235\n\t\t\t} catch( e ) {}\n\t\t}\n\t\t_cleanData( elems );\n\t};\n} else {\n\tvar _remove = $.fn.remove;\n\t$.fn.remove = function( selector, keepData ) {\n\t\treturn this.each(function() {\n\t\t\tif ( !keepData ) {\n\t\t\t\tif ( !selector || $.filter( selector, [ this ] ).length ) {\n\t\t\t\t\t$( \"*\", this ).add( [ this ] ).each(function() {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t$( this ).triggerHandler( \"remove\" );\n\t\t\t\t\t\t// http://bugs.jquery.com/ticket/8235\n\t\t\t\t\t\t} catch( e ) {}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn _remove.call( $(this), selector, keepData );\n\t\t});\n\t};\n}\n\n$.widget = function( name, base, prototype ) {\n\tvar namespace = name.split( \".\" )[ 0 ],\n\t\tfullName;\n\tname = name.split( \".\" )[ 1 ];\n\tfullName = namespace + \"-\" + name;\n\n\tif ( !prototype ) {\n\t\tprototype = base;\n\t\tbase = $.Widget;\n\t}\n\n\t// create selector for plugin\n\t$.expr[ \":\" ][ fullName ] = function( elem ) {\n\t\treturn !!$.data( elem, name );\n\t};\n\n\t$[ namespace ] = $[ namespace ] || {};\n\t$[ namespace ][ name ] = function( options, element ) {\n\t\t// allow instantiation without initializing for simple inheritance\n\t\tif ( arguments.length ) {\n\t\t\tthis._createWidget( options, element );\n\t\t}\n\t};\n\n\tvar basePrototype = new base();\n\t// we need to make the options hash a property directly on the new instance\n\t// otherwise we'll modify the options hash on the prototype that we're\n\t// inheriting from\n//\t$.each( basePrototype, function( key, val ) {\n//\t\tif ( $.isPlainObject(val) ) {\n//\t\t\tbasePrototype[ key ] = $.extend( {}, val );\n//\t\t}\n//\t});\n\tbasePrototype.options = $.extend( true, {}, basePrototype.options );\n\t$[ namespace ][ name ].prototype = $.extend( true, basePrototype, {\n\t\tnamespace: namespace,\n\t\twidgetName: name,\n\t\twidgetEventPrefix: $[ namespace ][ name ].prototype.widgetEventPrefix || name,\n\t\twidgetBaseClass: fullName\n\t}, prototype );\n\n\t$.widget.bridge( name, $[ namespace ][ name ] );\n};\n\n$.widget.bridge = function( name, object ) {\n\t$.fn[ name ] = function( options ) {\n\t\tvar isMethodCall = typeof options === \"string\",\n\t\t\targs = Array.prototype.slice.call( arguments, 1 ),\n\t\t\treturnValue = this;\n\n\t\t// allow multiple hashes to be passed on init\n\t\toptions = !isMethodCall && args.length ?\n\t\t\t$.extend.apply( null, [ true, options ].concat(args) ) :\n\t\t\toptions;\n\n\t\t// prevent calls to internal methods\n\t\tif ( isMethodCall && options.charAt( 0 ) === \"_\" ) {\n\t\t\treturn returnValue;\n\t\t}\n\n\t\tif ( isMethodCall ) {\n\t\t\tthis.each(function() {\n\t\t\t\tvar instance = $.data( this, name ),\n\t\t\t\t\tmethodValue = instance && $.isFunction( instance[options] ) ?\n\t\t\t\t\t\tinstance[ options ].apply( instance, args ) :\n\t\t\t\t\t\tinstance;\n\t\t\t\t// TODO: add this back in 1.9 and use $.error() (see #5972)\n//\t\t\t\tif ( !instance ) {\n//\t\t\t\t\tthrow \"cannot call methods on \" + name + \" prior to initialization; \" +\n//\t\t\t\t\t\t\"attempted to call method '\" + options + \"'\";\n//\t\t\t\t}\n//\t\t\t\tif ( !$.isFunction( instance[options] ) ) {\n//\t\t\t\t\tthrow \"no such method '\" + options + \"' for \" + name + \" widget instance\";\n//\t\t\t\t}\n//\t\t\t\tvar methodValue = instance[ options ].apply( instance, args );\n\t\t\t\tif ( methodValue !== instance && methodValue !== undefined ) {\n\t\t\t\t\treturnValue = methodValue;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tthis.each(function() {\n\t\t\t\tvar instance = $.data( this, name );\n\t\t\t\tif ( instance ) {\n\t\t\t\t\tinstance.option( options || {} )._init();\n\t\t\t\t} else {\n\t\t\t\t\t$.data( this, name, new object( options, this ) );\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn returnValue;\n\t};\n};\n\n$.Widget = function( options, element ) {\n\t// allow instantiation without initializing for simple inheritance\n\tif ( arguments.length ) {\n\t\tthis._createWidget( options, element );\n\t}\n};\n\n$.Widget.prototype = {\n\twidgetName: \"widget\",\n\twidgetEventPrefix: \"\",\n\toptions: {\n\t\tdisabled: false\n\t},\n\t_createWidget: function( options, element ) {\n\t\t// $.widget.bridge stores the plugin instance, but we do it anyway\n\t\t// so that it's stored even before the _create function runs\n\t\t$.data( element, this.widgetName, this );\n\t\tthis.element = $( element );\n\t\tthis.options = $.extend( true, {},\n\t\t\tthis.options,\n\t\t\tthis._getCreateOptions(),\n\t\t\toptions );\n\n\t\tvar self = this;\n\t\tthis.element.bind( \"remove.\" + this.widgetName, function() {\n\t\t\tself.destroy();\n\t\t});\n\n\t\tthis._create();\n\t\tthis._trigger( \"create\" );\n\t\tthis._init();\n\t},\n\t_getCreateOptions: function() {\n\t\treturn $.metadata && $.metadata.get( this.element[0] )[ this.widgetName ];\n\t},\n\t_create: function() {},\n\t_init: function() {},\n\n\tdestroy: function() {\n\t\tthis.element\n\t\t\t.unbind( \".\" + this.widgetName )\n\t\t\t.removeData( this.widgetName );\n\t\tthis.widget()\n\t\t\t.unbind( \".\" + this.widgetName )\n\t\t\t.removeAttr( \"aria-disabled\" )\n\t\t\t.removeClass(\n\t\t\t\tthis.widgetBaseClass + \"-disabled \" +\n\t\t\t\t\"ui-state-disabled\" );\n\t},\n\n\twidget: function() {\n\t\treturn this.element;\n\t},\n\n\toption: function( key, value ) {\n\t\tvar options = key;\n\n\t\tif ( arguments.length === 0 ) {\n\t\t\t// don't return a reference to the internal hash\n\t\t\treturn $.extend( {}, this.options );\n\t\t}\n\n\t\tif  (typeof key === \"string\" ) {\n\t\t\tif ( value === undefined ) {\n\t\t\t\treturn this.options[ key ];\n\t\t\t}\n\t\t\toptions = {};\n\t\t\toptions[ key ] = value;\n\t\t}\n\n\t\tthis._setOptions( options );\n\n\t\treturn this;\n\t},\n\t_setOptions: function( options ) {\n\t\tvar self = this;\n\t\t$.each( options, function( key, value ) {\n\t\t\tself._setOption( key, value );\n\t\t});\n\n\t\treturn this;\n\t},\n\t_setOption: function( key, value ) {\n\t\tthis.options[ key ] = value;\n\n\t\tif ( key === \"disabled\" ) {\n\t\t\tthis.widget()\n\t\t\t\t[ value ? \"addClass\" : \"removeClass\"](\n\t\t\t\t\tthis.widgetBaseClass + \"-disabled\" + \" \" +\n\t\t\t\t\t\"ui-state-disabled\" )\n\t\t\t\t.attr( \"aria-disabled\", value );\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tenable: function() {\n\t\treturn this._setOption( \"disabled\", false );\n\t},\n\tdisable: function() {\n\t\treturn this._setOption( \"disabled\", true );\n\t},\n\n\t_trigger: function( type, event, data ) {\n\t\tvar prop, orig,\n\t\t\tcallback = this.options[ type ];\n\n\t\tdata = data || {};\n\t\tevent = $.Event( event );\n\t\tevent.type = ( type === this.widgetEventPrefix ?\n\t\t\ttype :\n\t\t\tthis.widgetEventPrefix + type ).toLowerCase();\n\t\t// the original event may come from any element\n\t\t// so we need to reset the target on the new event\n\t\tevent.target = this.element[ 0 ];\n\n\t\t// copy original event properties over to the new event\n\t\torig = event.originalEvent;\n\t\tif ( orig ) {\n\t\t\tfor ( prop in orig ) {\n\t\t\t\tif ( !( prop in event ) ) {\n\t\t\t\t\tevent[ prop ] = orig[ prop ];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.element.trigger( event, data );\n\n\t\treturn !( $.isFunction(callback) &&\n\t\t\tcallback.call( this.element[0], event, data ) === false ||\n\t\t\tevent.isDefaultPrevented() );\n\t}\n};\n\n})( jQuery );\n","/*\n *\n * Copyright (c) 2010 C. F., Wong (<a href=\"http://cloudgen.w0ng.hk\">Cloudgen Examplet Store</a>)\n * Licensed under the MIT License:\n * http://www.opensource.org/licenses/mit-license.php\n *\n */\n(function($,len,createRange,duplicate){\n  $.fn.caret=function(options,opt2){\n    var start,end,t=this[0],browser=$.browser.msie;\n    if(typeof options===\"object\" && typeof options.start===\"number\" && typeof options.end===\"number\") {\n      start=options.start;\n      end=options.end;\n    } else if(typeof options===\"number\" && typeof opt2===\"number\"){\n      start=options;\n      end=opt2;\n    } else if(typeof options===\"string\"){\n      if((start=t.value.indexOf(options))>-1) end=start+options[len];\n      else start=null;\n    } else if(Object.prototype.toString.call(options)===\"[object RegExp]\"){\n      var re=options.exec(t.value);\n      if(re != null) {\n        start=re.index;\n        end=start+re[0][len];\n      }\n    }\n    if(typeof start!=\"undefined\"){\n      if(browser){\n        var selRange = this[0].createTextRange();\n        selRange.collapse(true);\n        selRange.moveStart('character', start);\n        selRange.moveEnd('character', end-start);\n        selRange.select();\n      } else {\n        this[0].selectionStart=start;\n        this[0].selectionEnd=end;\n      }\n      this[0].focus();\n      return this\n    } else {\n           if(browser){\n        var selection=document.selection;\n                if (this[0].tagName.toLowerCase() != \"textarea\") {\n                    var val = this.val(),\n                    range = selection[createRange]()[duplicate]();\n                    range.moveEnd(\"character\", val[len]);\n                    var s = (range.text == \"\" ? val[len]:val.lastIndexOf(range.text));\n                    range = selection[createRange]()[duplicate]();\n                    range.moveStart(\"character\", -val[len]);\n                    var e = range.text[len];\n                } else {\n                    var range = selection[createRange](),\n                    stored_range = range[duplicate]();\n                    stored_range.moveToElementText(this[0]);\n                    stored_range.setEndPoint('EndToEnd', range);\n                    var s = stored_range.text[len] - range.text[len],\n                    e = s + range.text[len]\n                }\n            } else {\n        var s=t.selectionStart,\n          e=t.selectionEnd;\n      }\n      var te=t.value.substring(s,e);\n      return {start:s,end:e,text:te,replace:function(st){\n        return t.value.substring(0,s)+st+t.value.substring(e,t.value[len])\n      }}\n    }\n  }\n})(jQuery,\"length\",\"createRange\",\"duplicate\");\n","//! moment.js\n//! version : 2.10.2\n//! authors : Tim Wood, Iskren Chernev, Moment.js contributors\n//! license : MIT\n//! momentjs.com\n\n(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define(factory) :\n    global.moment = factory()\n}(this, function () { 'use strict';\n\n    var hookCallback;\n\n    function utils_hooks__hooks () {\n        return hookCallback.apply(null, arguments);\n    }\n\n    // This is done to register the method called with moment()\n    // without creating circular dependencies.\n    function setHookCallback (callback) {\n        hookCallback = callback;\n    }\n\n    function defaultParsingFlags() {\n        // We need to deep clone this object.\n        return {\n            empty           : false,\n            unusedTokens    : [],\n            unusedInput     : [],\n            overflow        : -2,\n            charsLeftOver   : 0,\n            nullInput       : false,\n            invalidMonth    : null,\n            invalidFormat   : false,\n            userInvalidated : false,\n            iso             : false\n        };\n    }\n\n    function isArray(input) {\n        return Object.prototype.toString.call(input) === '[object Array]';\n    }\n\n    function isDate(input) {\n        return Object.prototype.toString.call(input) === '[object Date]' || input instanceof Date;\n    }\n\n    function map(arr, fn) {\n        var res = [], i;\n        for (i = 0; i < arr.length; ++i) {\n            res.push(fn(arr[i], i));\n        }\n        return res;\n    }\n\n    function hasOwnProp(a, b) {\n        return Object.prototype.hasOwnProperty.call(a, b);\n    }\n\n    function extend(a, b) {\n        for (var i in b) {\n            if (hasOwnProp(b, i)) {\n                a[i] = b[i];\n            }\n        }\n\n        if (hasOwnProp(b, 'toString')) {\n            a.toString = b.toString;\n        }\n\n        if (hasOwnProp(b, 'valueOf')) {\n            a.valueOf = b.valueOf;\n        }\n\n        return a;\n    }\n\n    function create_utc__createUTC (input, format, locale, strict) {\n        return createLocalOrUTC(input, format, locale, strict, true).utc();\n    }\n\n    function valid__isValid(m) {\n        if (m._isValid == null) {\n            m._isValid = !isNaN(m._d.getTime()) &&\n                m._pf.overflow < 0 &&\n                !m._pf.empty &&\n                !m._pf.invalidMonth &&\n                !m._pf.nullInput &&\n                !m._pf.invalidFormat &&\n                !m._pf.userInvalidated;\n\n            if (m._strict) {\n                m._isValid = m._isValid &&\n                    m._pf.charsLeftOver === 0 &&\n                    m._pf.unusedTokens.length === 0 &&\n                    m._pf.bigHour === undefined;\n            }\n        }\n        return m._isValid;\n    }\n\n    function valid__createInvalid (flags) {\n        var m = create_utc__createUTC(NaN);\n        if (flags != null) {\n            extend(m._pf, flags);\n        }\n        else {\n            m._pf.userInvalidated = true;\n        }\n\n        return m;\n    }\n\n    var momentProperties = utils_hooks__hooks.momentProperties = [];\n\n    function copyConfig(to, from) {\n        var i, prop, val;\n\n        if (typeof from._isAMomentObject !== 'undefined') {\n            to._isAMomentObject = from._isAMomentObject;\n        }\n        if (typeof from._i !== 'undefined') {\n            to._i = from._i;\n        }\n        if (typeof from._f !== 'undefined') {\n            to._f = from._f;\n        }\n        if (typeof from._l !== 'undefined') {\n            to._l = from._l;\n        }\n        if (typeof from._strict !== 'undefined') {\n            to._strict = from._strict;\n        }\n        if (typeof from._tzm !== 'undefined') {\n            to._tzm = from._tzm;\n        }\n        if (typeof from._isUTC !== 'undefined') {\n            to._isUTC = from._isUTC;\n        }\n        if (typeof from._offset !== 'undefined') {\n            to._offset = from._offset;\n        }\n        if (typeof from._pf !== 'undefined') {\n            to._pf = from._pf;\n        }\n        if (typeof from._locale !== 'undefined') {\n            to._locale = from._locale;\n        }\n\n        if (momentProperties.length > 0) {\n            for (i in momentProperties) {\n                prop = momentProperties[i];\n                val = from[prop];\n                if (typeof val !== 'undefined') {\n                    to[prop] = val;\n                }\n            }\n        }\n\n        return to;\n    }\n\n    var updateInProgress = false;\n\n    // Moment prototype object\n    function Moment(config) {\n        copyConfig(this, config);\n        this._d = new Date(+config._d);\n        // Prevent infinite loop in case updateOffset creates new moment\n        // objects.\n        if (updateInProgress === false) {\n            updateInProgress = true;\n            utils_hooks__hooks.updateOffset(this);\n            updateInProgress = false;\n        }\n    }\n\n    function isMoment (obj) {\n        return obj instanceof Moment || (obj != null && hasOwnProp(obj, '_isAMomentObject'));\n    }\n\n    function toInt(argumentForCoercion) {\n        var coercedNumber = +argumentForCoercion,\n            value = 0;\n\n        if (coercedNumber !== 0 && isFinite(coercedNumber)) {\n            if (coercedNumber >= 0) {\n                value = Math.floor(coercedNumber);\n            } else {\n                value = Math.ceil(coercedNumber);\n            }\n        }\n\n        return value;\n    }\n\n    function compareArrays(array1, array2, dontConvert) {\n        var len = Math.min(array1.length, array2.length),\n            lengthDiff = Math.abs(array1.length - array2.length),\n            diffs = 0,\n            i;\n        for (i = 0; i < len; i++) {\n            if ((dontConvert && array1[i] !== array2[i]) ||\n                (!dontConvert && toInt(array1[i]) !== toInt(array2[i]))) {\n                diffs++;\n            }\n        }\n        return diffs + lengthDiff;\n    }\n\n    function Locale() {\n    }\n\n    var locales = {};\n    var globalLocale;\n\n    function normalizeLocale(key) {\n        return key ? key.toLowerCase().replace('_', '-') : key;\n    }\n\n    // pick the locale from the array\n    // try ['en-au', 'en-gb'] as 'en-au', 'en-gb', 'en', as in move through the list trying each\n    // substring from most specific to least, but move to the next array item if it's a more specific variant than the current root\n    function chooseLocale(names) {\n        var i = 0, j, next, locale, split;\n\n        while (i < names.length) {\n            split = normalizeLocale(names[i]).split('-');\n            j = split.length;\n            next = normalizeLocale(names[i + 1]);\n            next = next ? next.split('-') : null;\n            while (j > 0) {\n                locale = loadLocale(split.slice(0, j).join('-'));\n                if (locale) {\n                    return locale;\n                }\n                if (next && next.length >= j && compareArrays(split, next, true) >= j - 1) {\n                    //the next array item is better than a shallower substring of this one\n                    break;\n                }\n                j--;\n            }\n            i++;\n        }\n        return null;\n    }\n\n    function loadLocale(name) {\n        var oldLocale = null;\n        // TODO: Find a better way to register and load all the locales in Node\n        if (!locales[name] && typeof module !== 'undefined' &&\n                module && module.exports) {\n            try {\n                oldLocale = globalLocale._abbr;\n                require('./locale/' + name);\n                // because defineLocale currently also sets the global locale, we\n                // want to undo that for lazy loaded locales\n                locale_locales__getSetGlobalLocale(oldLocale);\n            } catch (e) { }\n        }\n        return locales[name];\n    }\n\n    // This function will load locale and then set the global locale.  If\n    // no arguments are passed in, it will simply return the current global\n    // locale key.\n    function locale_locales__getSetGlobalLocale (key, values) {\n        var data;\n        if (key) {\n            if (typeof values === 'undefined') {\n                data = locale_locales__getLocale(key);\n            }\n            else {\n                data = defineLocale(key, values);\n            }\n\n            if (data) {\n                // moment.duration._locale = moment._locale = data;\n                globalLocale = data;\n            }\n        }\n\n        return globalLocale._abbr;\n    }\n\n    function defineLocale (name, values) {\n        if (values !== null) {\n            values.abbr = name;\n            if (!locales[name]) {\n                locales[name] = new Locale();\n            }\n            locales[name].set(values);\n\n            // backwards compat for now: also set the locale\n            locale_locales__getSetGlobalLocale(name);\n\n            return locales[name];\n        } else {\n            // useful for testing\n            delete locales[name];\n            return null;\n        }\n    }\n\n    // returns locale data\n    function locale_locales__getLocale (key) {\n        var locale;\n\n        if (key && key._locale && key._locale._abbr) {\n            key = key._locale._abbr;\n        }\n\n        if (!key) {\n            return globalLocale;\n        }\n\n        if (!isArray(key)) {\n            //short-circuit everything else\n            locale = loadLocale(key);\n            if (locale) {\n                return locale;\n            }\n            key = [key];\n        }\n\n        return chooseLocale(key);\n    }\n\n    var aliases = {};\n\n    function addUnitAlias (unit, shorthand) {\n        var lowerCase = unit.toLowerCase();\n        aliases[lowerCase] = aliases[lowerCase + 's'] = aliases[shorthand] = unit;\n    }\n\n    function normalizeUnits(units) {\n        return typeof units === 'string' ? aliases[units] || aliases[units.toLowerCase()] : undefined;\n    }\n\n    function normalizeObjectUnits(inputObject) {\n        var normalizedInput = {},\n            normalizedProp,\n            prop;\n\n        for (prop in inputObject) {\n            if (hasOwnProp(inputObject, prop)) {\n                normalizedProp = normalizeUnits(prop);\n                if (normalizedProp) {\n                    normalizedInput[normalizedProp] = inputObject[prop];\n                }\n            }\n        }\n\n        return normalizedInput;\n    }\n\n    function makeGetSet (unit, keepTime) {\n        return function (value) {\n            if (value != null) {\n                get_set__set(this, unit, value);\n                utils_hooks__hooks.updateOffset(this, keepTime);\n                return this;\n            } else {\n                return get_set__get(this, unit);\n            }\n        };\n    }\n\n    function get_set__get (mom, unit) {\n        return mom._d['get' + (mom._isUTC ? 'UTC' : '') + unit]();\n    }\n\n    function get_set__set (mom, unit, value) {\n        return mom._d['set' + (mom._isUTC ? 'UTC' : '') + unit](value);\n    }\n\n    // MOMENTS\n\n    function getSet (units, value) {\n        var unit;\n        if (typeof units === 'object') {\n            for (unit in units) {\n                this.set(unit, units[unit]);\n            }\n        } else {\n            units = normalizeUnits(units);\n            if (typeof this[units] === 'function') {\n                return this[units](value);\n            }\n        }\n        return this;\n    }\n\n    function zeroFill(number, targetLength, forceSign) {\n        var output = '' + Math.abs(number),\n            sign = number >= 0;\n\n        while (output.length < targetLength) {\n            output = '0' + output;\n        }\n        return (sign ? (forceSign ? '+' : '') : '-') + output;\n    }\n\n    var formattingTokens = /(\\[[^\\[]*\\])|(\\\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g;\n\n    var localFormattingTokens = /(\\[[^\\[]*\\])|(\\\\)?(LTS|LT|LL?L?L?|l{1,4})/g;\n\n    var formatFunctions = {};\n\n    var formatTokenFunctions = {};\n\n    // token:    'M'\n    // padded:   ['MM', 2]\n    // ordinal:  'Mo'\n    // callback: function () { this.month() + 1 }\n    function addFormatToken (token, padded, ordinal, callback) {\n        var func = callback;\n        if (typeof callback === 'string') {\n            func = function () {\n                return this[callback]();\n            };\n        }\n        if (token) {\n            formatTokenFunctions[token] = func;\n        }\n        if (padded) {\n            formatTokenFunctions[padded[0]] = function () {\n                return zeroFill(func.apply(this, arguments), padded[1], padded[2]);\n            };\n        }\n        if (ordinal) {\n            formatTokenFunctions[ordinal] = function () {\n                return this.localeData().ordinal(func.apply(this, arguments), token);\n            };\n        }\n    }\n\n    function removeFormattingTokens(input) {\n        if (input.match(/\\[[\\s\\S]/)) {\n            return input.replace(/^\\[|\\]$/g, '');\n        }\n        return input.replace(/\\\\/g, '');\n    }\n\n    function makeFormatFunction(format) {\n        var array = format.match(formattingTokens), i, length;\n\n        for (i = 0, length = array.length; i < length; i++) {\n            if (formatTokenFunctions[array[i]]) {\n                array[i] = formatTokenFunctions[array[i]];\n            } else {\n                array[i] = removeFormattingTokens(array[i]);\n            }\n        }\n\n        return function (mom) {\n            var output = '';\n            for (i = 0; i < length; i++) {\n                output += array[i] instanceof Function ? array[i].call(mom, format) : array[i];\n            }\n            return output;\n        };\n    }\n\n    // format date using native date object\n    function formatMoment(m, format) {\n        if (!m.isValid()) {\n            return m.localeData().invalidDate();\n        }\n\n        format = expandFormat(format, m.localeData());\n\n        if (!formatFunctions[format]) {\n            formatFunctions[format] = makeFormatFunction(format);\n        }\n\n        return formatFunctions[format](m);\n    }\n\n    function expandFormat(format, locale) {\n        var i = 5;\n\n        function replaceLongDateFormatTokens(input) {\n            return locale.longDateFormat(input) || input;\n        }\n\n        localFormattingTokens.lastIndex = 0;\n        while (i >= 0 && localFormattingTokens.test(format)) {\n            format = format.replace(localFormattingTokens, replaceLongDateFormatTokens);\n            localFormattingTokens.lastIndex = 0;\n            i -= 1;\n        }\n\n        return format;\n    }\n\n    var match1         = /\\d/;            //       0 - 9\n    var match2         = /\\d\\d/;          //      00 - 99\n    var match3         = /\\d{3}/;         //     000 - 999\n    var match4         = /\\d{4}/;         //    0000 - 9999\n    var match6         = /[+-]?\\d{6}/;    // -999999 - 999999\n    var match1to2      = /\\d\\d?/;         //       0 - 99\n    var match1to3      = /\\d{1,3}/;       //       0 - 999\n    var match1to4      = /\\d{1,4}/;       //       0 - 9999\n    var match1to6      = /[+-]?\\d{1,6}/;  // -999999 - 999999\n\n    var matchUnsigned  = /\\d+/;           //       0 - inf\n    var matchSigned    = /[+-]?\\d+/;      //    -inf - inf\n\n    var matchOffset    = /Z|[+-]\\d\\d:?\\d\\d/gi; // +00:00 -00:00 +0000 -0000 or Z\n\n    var matchTimestamp = /[+-]?\\d+(\\.\\d{1,3})?/; // 123456789 123456789.123\n\n    // any word (or two) characters or numbers including two/three word month in arabic.\n    var matchWord = /[0-9]*['a-z\\u00A0-\\u05FF\\u0700-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]+|[\\u0600-\\u06FF\\/]+(\\s*?[\\u0600-\\u06FF]+){1,2}/i;\n\n    var regexes = {};\n\n    function addRegexToken (token, regex, strictRegex) {\n        regexes[token] = typeof regex === 'function' ? regex : function (isStrict) {\n            return (isStrict && strictRegex) ? strictRegex : regex;\n        };\n    }\n\n    function getParseRegexForToken (token, config) {\n        if (!hasOwnProp(regexes, token)) {\n            return new RegExp(unescapeFormat(token));\n        }\n\n        return regexes[token](config._strict, config._locale);\n    }\n\n    // Code from http://stackoverflow.com/questions/3561493/is-there-a-regexp-escape-function-in-javascript\n    function unescapeFormat(s) {\n        return s.replace('\\\\', '').replace(/\\\\(\\[)|\\\\(\\])|\\[([^\\]\\[]*)\\]|\\\\(.)/g, function (matched, p1, p2, p3, p4) {\n            return p1 || p2 || p3 || p4;\n        }).replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n    }\n\n    var tokens = {};\n\n    function addParseToken (token, callback) {\n        var i, func = callback;\n        if (typeof token === 'string') {\n            token = [token];\n        }\n        if (typeof callback === 'number') {\n            func = function (input, array) {\n                array[callback] = toInt(input);\n            };\n        }\n        for (i = 0; i < token.length; i++) {\n            tokens[token[i]] = func;\n        }\n    }\n\n    function addWeekParseToken (token, callback) {\n        addParseToken(token, function (input, array, config, token) {\n            config._w = config._w || {};\n            callback(input, config._w, config, token);\n        });\n    }\n\n    function addTimeToArrayFromToken(token, input, config) {\n        if (input != null && hasOwnProp(tokens, token)) {\n            tokens[token](input, config._a, config, token);\n        }\n    }\n\n    var YEAR = 0;\n    var MONTH = 1;\n    var DATE = 2;\n    var HOUR = 3;\n    var MINUTE = 4;\n    var SECOND = 5;\n    var MILLISECOND = 6;\n\n    function daysInMonth(year, month) {\n        return new Date(Date.UTC(year, month + 1, 0)).getUTCDate();\n    }\n\n    // FORMATTING\n\n    addFormatToken('M', ['MM', 2], 'Mo', function () {\n        return this.month() + 1;\n    });\n\n    addFormatToken('MMM', 0, 0, function (format) {\n        return this.localeData().monthsShort(this, format);\n    });\n\n    addFormatToken('MMMM', 0, 0, function (format) {\n        return this.localeData().months(this, format);\n    });\n\n    // ALIASES\n\n    addUnitAlias('month', 'M');\n\n    // PARSING\n\n    addRegexToken('M',    match1to2);\n    addRegexToken('MM',   match1to2, match2);\n    addRegexToken('MMM',  matchWord);\n    addRegexToken('MMMM', matchWord);\n\n    addParseToken(['M', 'MM'], function (input, array) {\n        array[MONTH] = toInt(input) - 1;\n    });\n\n    addParseToken(['MMM', 'MMMM'], function (input, array, config, token) {\n        var month = config._locale.monthsParse(input, token, config._strict);\n        // if we didn't find a month name, mark the date as invalid.\n        if (month != null) {\n            array[MONTH] = month;\n        } else {\n            config._pf.invalidMonth = input;\n        }\n    });\n\n    // LOCALES\n\n    var defaultLocaleMonths = 'January_February_March_April_May_June_July_August_September_October_November_December'.split('_');\n    function localeMonths (m) {\n        return this._months[m.month()];\n    }\n\n    var defaultLocaleMonthsShort = 'Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec'.split('_');\n    function localeMonthsShort (m) {\n        return this._monthsShort[m.month()];\n    }\n\n    function localeMonthsParse (monthName, format, strict) {\n        var i, mom, regex;\n\n        if (!this._monthsParse) {\n            this._monthsParse = [];\n            this._longMonthsParse = [];\n            this._shortMonthsParse = [];\n        }\n\n        for (i = 0; i < 12; i++) {\n            // make the regex if we don't have it already\n            mom = create_utc__createUTC([2000, i]);\n            if (strict && !this._longMonthsParse[i]) {\n                this._longMonthsParse[i] = new RegExp('^' + this.months(mom, '').replace('.', '') + '$', 'i');\n                this._shortMonthsParse[i] = new RegExp('^' + this.monthsShort(mom, '').replace('.', '') + '$', 'i');\n            }\n            if (!strict && !this._monthsParse[i]) {\n                regex = '^' + this.months(mom, '') + '|^' + this.monthsShort(mom, '');\n                this._monthsParse[i] = new RegExp(regex.replace('.', ''), 'i');\n            }\n            // test the regex\n            if (strict && format === 'MMMM' && this._longMonthsParse[i].test(monthName)) {\n                return i;\n            } else if (strict && format === 'MMM' && this._shortMonthsParse[i].test(monthName)) {\n                return i;\n            } else if (!strict && this._monthsParse[i].test(monthName)) {\n                return i;\n            }\n        }\n    }\n\n    // MOMENTS\n\n    function setMonth (mom, value) {\n        var dayOfMonth;\n\n        // TODO: Move this out of here!\n        if (typeof value === 'string') {\n            value = mom.localeData().monthsParse(value);\n            // TODO: Another silent failure?\n            if (typeof value !== 'number') {\n                return mom;\n            }\n        }\n\n        dayOfMonth = Math.min(mom.date(), daysInMonth(mom.year(), value));\n        mom._d['set' + (mom._isUTC ? 'UTC' : '') + 'Month'](value, dayOfMonth);\n        return mom;\n    }\n\n    function getSetMonth (value) {\n        if (value != null) {\n            setMonth(this, value);\n            utils_hooks__hooks.updateOffset(this, true);\n            return this;\n        } else {\n            return get_set__get(this, 'Month');\n        }\n    }\n\n    function getDaysInMonth () {\n        return daysInMonth(this.year(), this.month());\n    }\n\n    function checkOverflow (m) {\n        var overflow;\n        var a = m._a;\n\n        if (a && m._pf.overflow === -2) {\n            overflow =\n                a[MONTH]       < 0 || a[MONTH]       > 11  ? MONTH :\n                a[DATE]        < 1 || a[DATE]        > daysInMonth(a[YEAR], a[MONTH]) ? DATE :\n                a[HOUR]        < 0 || a[HOUR]        > 24 || (a[HOUR] === 24 && (a[MINUTE] !== 0 || a[SECOND] !== 0 || a[MILLISECOND] !== 0)) ? HOUR :\n                a[MINUTE]      < 0 || a[MINUTE]      > 59  ? MINUTE :\n                a[SECOND]      < 0 || a[SECOND]      > 59  ? SECOND :\n                a[MILLISECOND] < 0 || a[MILLISECOND] > 999 ? MILLISECOND :\n                -1;\n\n            if (m._pf._overflowDayOfYear && (overflow < YEAR || overflow > DATE)) {\n                overflow = DATE;\n            }\n\n            m._pf.overflow = overflow;\n        }\n\n        return m;\n    }\n\n    function warn(msg) {\n        if (utils_hooks__hooks.suppressDeprecationWarnings === false && typeof console !== 'undefined' && console.warn) {\n            console.warn('Deprecation warning: ' + msg);\n        }\n    }\n\n    function deprecate(msg, fn) {\n        var firstTime = true;\n        return extend(function () {\n            if (firstTime) {\n                warn(msg);\n                firstTime = false;\n            }\n            return fn.apply(this, arguments);\n        }, fn);\n    }\n\n    var deprecations = {};\n\n    function deprecateSimple(name, msg) {\n        if (!deprecations[name]) {\n            warn(msg);\n            deprecations[name] = true;\n        }\n    }\n\n    utils_hooks__hooks.suppressDeprecationWarnings = false;\n\n    var from_string__isoRegex = /^\\s*(?:[+-]\\d{6}|\\d{4})-(?:(\\d\\d-\\d\\d)|(W\\d\\d$)|(W\\d\\d-\\d)|(\\d\\d\\d))((T| )(\\d\\d(:\\d\\d(:\\d\\d(\\.\\d+)?)?)?)?([\\+\\-]\\d\\d(?::?\\d\\d)?|\\s*Z)?)?$/;\n\n    var isoDates = [\n        ['YYYYYY-MM-DD', /[+-]\\d{6}-\\d{2}-\\d{2}/],\n        ['YYYY-MM-DD', /\\d{4}-\\d{2}-\\d{2}/],\n        ['GGGG-[W]WW-E', /\\d{4}-W\\d{2}-\\d/],\n        ['GGGG-[W]WW', /\\d{4}-W\\d{2}/],\n        ['YYYY-DDD', /\\d{4}-\\d{3}/]\n    ];\n\n    // iso time formats and regexes\n    var isoTimes = [\n        ['HH:mm:ss.SSSS', /(T| )\\d\\d:\\d\\d:\\d\\d\\.\\d+/],\n        ['HH:mm:ss', /(T| )\\d\\d:\\d\\d:\\d\\d/],\n        ['HH:mm', /(T| )\\d\\d:\\d\\d/],\n        ['HH', /(T| )\\d\\d/]\n    ];\n\n    var aspNetJsonRegex = /^\\/?Date\\((\\-?\\d+)/i;\n\n    // date from iso format\n    function configFromISO(config) {\n        var i, l,\n            string = config._i,\n            match = from_string__isoRegex.exec(string);\n\n        if (match) {\n            config._pf.iso = true;\n            for (i = 0, l = isoDates.length; i < l; i++) {\n                if (isoDates[i][1].exec(string)) {\n                    // match[5] should be 'T' or undefined\n                    config._f = isoDates[i][0] + (match[6] || ' ');\n                    break;\n                }\n            }\n            for (i = 0, l = isoTimes.length; i < l; i++) {\n                if (isoTimes[i][1].exec(string)) {\n                    config._f += isoTimes[i][0];\n                    break;\n                }\n            }\n            if (string.match(matchOffset)) {\n                config._f += 'Z';\n            }\n            configFromStringAndFormat(config);\n        } else {\n            config._isValid = false;\n        }\n    }\n\n    // date from iso format or fallback\n    function configFromString(config) {\n        var matched = aspNetJsonRegex.exec(config._i);\n\n        if (matched !== null) {\n            config._d = new Date(+matched[1]);\n            return;\n        }\n\n        configFromISO(config);\n        if (config._isValid === false) {\n            delete config._isValid;\n            utils_hooks__hooks.createFromInputFallback(config);\n        }\n    }\n\n    utils_hooks__hooks.createFromInputFallback = deprecate(\n        'moment construction falls back to js Date. This is ' +\n        'discouraged and will be removed in upcoming major ' +\n        'release. Please refer to ' +\n        'https://github.com/moment/moment/issues/1407 for more info.',\n        function (config) {\n            config._d = new Date(config._i + (config._useUTC ? ' UTC' : ''));\n        }\n    );\n\n    function createDate (y, m, d, h, M, s, ms) {\n        //can't just apply() to create a date:\n        //http://stackoverflow.com/questions/181348/instantiating-a-javascript-object-by-calling-prototype-constructor-apply\n        var date = new Date(y, m, d, h, M, s, ms);\n\n        //the date constructor doesn't accept years < 1970\n        if (y < 1970) {\n            date.setFullYear(y);\n        }\n        return date;\n    }\n\n    function createUTCDate (y) {\n        var date = new Date(Date.UTC.apply(null, arguments));\n        if (y < 1970) {\n            date.setUTCFullYear(y);\n        }\n        return date;\n    }\n\n    addFormatToken(0, ['YY', 2], 0, function () {\n        return this.year() % 100;\n    });\n\n    addFormatToken(0, ['YYYY',   4],       0, 'year');\n    addFormatToken(0, ['YYYYY',  5],       0, 'year');\n    addFormatToken(0, ['YYYYYY', 6, true], 0, 'year');\n\n    // ALIASES\n\n    addUnitAlias('year', 'y');\n\n    // PARSING\n\n    addRegexToken('Y',      matchSigned);\n    addRegexToken('YY',     match1to2, match2);\n    addRegexToken('YYYY',   match1to4, match4);\n    addRegexToken('YYYYY',  match1to6, match6);\n    addRegexToken('YYYYYY', match1to6, match6);\n\n    addParseToken(['YYYY', 'YYYYY', 'YYYYYY'], YEAR);\n    addParseToken('YY', function (input, array) {\n        array[YEAR] = utils_hooks__hooks.parseTwoDigitYear(input);\n    });\n\n    // HELPERS\n\n    function daysInYear(year) {\n        return isLeapYear(year) ? 366 : 365;\n    }\n\n    function isLeapYear(year) {\n        return (year % 4 === 0 && year % 100 !== 0) || year % 400 === 0;\n    }\n\n    // HOOKS\n\n    utils_hooks__hooks.parseTwoDigitYear = function (input) {\n        return toInt(input) + (toInt(input) > 68 ? 1900 : 2000);\n    };\n\n    // MOMENTS\n\n    var getSetYear = makeGetSet('FullYear', false);\n\n    function getIsLeapYear () {\n        return isLeapYear(this.year());\n    }\n\n    addFormatToken('w', ['ww', 2], 'wo', 'week');\n    addFormatToken('W', ['WW', 2], 'Wo', 'isoWeek');\n\n    // ALIASES\n\n    addUnitAlias('week', 'w');\n    addUnitAlias('isoWeek', 'W');\n\n    // PARSING\n\n    addRegexToken('w',  match1to2);\n    addRegexToken('ww', match1to2, match2);\n    addRegexToken('W',  match1to2);\n    addRegexToken('WW', match1to2, match2);\n\n    addWeekParseToken(['w', 'ww', 'W', 'WW'], function (input, week, config, token) {\n        week[token.substr(0, 1)] = toInt(input);\n    });\n\n    // HELPERS\n\n    // firstDayOfWeek       0 = sun, 6 = sat\n    //                      the day of the week that starts the week\n    //                      (usually sunday or monday)\n    // firstDayOfWeekOfYear 0 = sun, 6 = sat\n    //                      the first week is the week that contains the first\n    //                      of this day of the week\n    //                      (eg. ISO weeks use thursday (4))\n    function weekOfYear(mom, firstDayOfWeek, firstDayOfWeekOfYear) {\n        var end = firstDayOfWeekOfYear - firstDayOfWeek,\n            daysToDayOfWeek = firstDayOfWeekOfYear - mom.day(),\n            adjustedMoment;\n\n\n        if (daysToDayOfWeek > end) {\n            daysToDayOfWeek -= 7;\n        }\n\n        if (daysToDayOfWeek < end - 7) {\n            daysToDayOfWeek += 7;\n        }\n\n        adjustedMoment = local__createLocal(mom).add(daysToDayOfWeek, 'd');\n        return {\n            week: Math.ceil(adjustedMoment.dayOfYear() / 7),\n            year: adjustedMoment.year()\n        };\n    }\n\n    // LOCALES\n\n    function localeWeek (mom) {\n        return weekOfYear(mom, this._week.dow, this._week.doy).week;\n    }\n\n    var defaultLocaleWeek = {\n        dow : 0, // Sunday is the first day of the week.\n        doy : 6  // The week that contains Jan 1st is the first week of the year.\n    };\n\n    function localeFirstDayOfWeek () {\n        return this._week.dow;\n    }\n\n    function localeFirstDayOfYear () {\n        return this._week.doy;\n    }\n\n    // MOMENTS\n\n    function getSetWeek (input) {\n        var week = this.localeData().week(this);\n        return input == null ? week : this.add((input - week) * 7, 'd');\n    }\n\n    function getSetISOWeek (input) {\n        var week = weekOfYear(this, 1, 4).week;\n        return input == null ? week : this.add((input - week) * 7, 'd');\n    }\n\n    addFormatToken('DDD', ['DDDD', 3], 'DDDo', 'dayOfYear');\n\n    // ALIASES\n\n    addUnitAlias('dayOfYear', 'DDD');\n\n    // PARSING\n\n    addRegexToken('DDD',  match1to3);\n    addRegexToken('DDDD', match3);\n    addParseToken(['DDD', 'DDDD'], function (input, array, config) {\n        config._dayOfYear = toInt(input);\n    });\n\n    // HELPERS\n\n    //http://en.wikipedia.org/wiki/ISO_week_date#Calculating_a_date_given_the_year.2C_week_number_and_weekday\n    function dayOfYearFromWeeks(year, week, weekday, firstDayOfWeekOfYear, firstDayOfWeek) {\n        var d = createUTCDate(year, 0, 1).getUTCDay();\n        var daysToAdd;\n        var dayOfYear;\n\n        d = d === 0 ? 7 : d;\n        weekday = weekday != null ? weekday : firstDayOfWeek;\n        daysToAdd = firstDayOfWeek - d + (d > firstDayOfWeekOfYear ? 7 : 0) - (d < firstDayOfWeek ? 7 : 0);\n        dayOfYear = 7 * (week - 1) + (weekday - firstDayOfWeek) + daysToAdd + 1;\n\n        return {\n            year      : dayOfYear > 0 ? year      : year - 1,\n            dayOfYear : dayOfYear > 0 ? dayOfYear : daysInYear(year - 1) + dayOfYear\n        };\n    }\n\n    // MOMENTS\n\n    function getSetDayOfYear (input) {\n        var dayOfYear = Math.round((this.clone().startOf('day') - this.clone().startOf('year')) / 864e5) + 1;\n        return input == null ? dayOfYear : this.add((input - dayOfYear), 'd');\n    }\n\n    // Pick the first defined of two or three arguments.\n    function defaults(a, b, c) {\n        if (a != null) {\n            return a;\n        }\n        if (b != null) {\n            return b;\n        }\n        return c;\n    }\n\n    function currentDateArray(config) {\n        var now = new Date();\n        if (config._useUTC) {\n            return [now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate()];\n        }\n        return [now.getFullYear(), now.getMonth(), now.getDate()];\n    }\n\n    // convert an array to a date.\n    // the array should mirror the parameters below\n    // note: all values past the year are optional and will default to the lowest possible value.\n    // [year, month, day , hour, minute, second, millisecond]\n    function configFromArray (config) {\n        var i, date, input = [], currentDate, yearToUse;\n\n        if (config._d) {\n            return;\n        }\n\n        currentDate = currentDateArray(config);\n\n        //compute day of the year from weeks and weekdays\n        if (config._w && config._a[DATE] == null && config._a[MONTH] == null) {\n            dayOfYearFromWeekInfo(config);\n        }\n\n        //if the day of the year is set, figure out what it is\n        if (config._dayOfYear) {\n            yearToUse = defaults(config._a[YEAR], currentDate[YEAR]);\n\n            if (config._dayOfYear > daysInYear(yearToUse)) {\n                config._pf._overflowDayOfYear = true;\n            }\n\n            date = createUTCDate(yearToUse, 0, config._dayOfYear);\n            config._a[MONTH] = date.getUTCMonth();\n            config._a[DATE] = date.getUTCDate();\n        }\n\n        // Default to current date.\n        // * if no year, month, day of month are given, default to today\n        // * if day of month is given, default month and year\n        // * if month is given, default only year\n        // * if year is given, don't default anything\n        for (i = 0; i < 3 && config._a[i] == null; ++i) {\n            config._a[i] = input[i] = currentDate[i];\n        }\n\n        // Zero out whatever was not defaulted, including time\n        for (; i < 7; i++) {\n            config._a[i] = input[i] = (config._a[i] == null) ? (i === 2 ? 1 : 0) : config._a[i];\n        }\n\n        // Check for 24:00:00.000\n        if (config._a[HOUR] === 24 &&\n                config._a[MINUTE] === 0 &&\n                config._a[SECOND] === 0 &&\n                config._a[MILLISECOND] === 0) {\n            config._nextDay = true;\n            config._a[HOUR] = 0;\n        }\n\n        config._d = (config._useUTC ? createUTCDate : createDate).apply(null, input);\n        // Apply timezone offset from input. The actual utcOffset can be changed\n        // with parseZone.\n        if (config._tzm != null) {\n            config._d.setUTCMinutes(config._d.getUTCMinutes() - config._tzm);\n        }\n\n        if (config._nextDay) {\n            config._a[HOUR] = 24;\n        }\n    }\n\n    function dayOfYearFromWeekInfo(config) {\n        var w, weekYear, week, weekday, dow, doy, temp;\n\n        w = config._w;\n        if (w.GG != null || w.W != null || w.E != null) {\n            dow = 1;\n            doy = 4;\n\n            // TODO: We need to take the current isoWeekYear, but that depends on\n            // how we interpret now (local, utc, fixed offset). So create\n            // a now version of current config (take local/utc/offset flags, and\n            // create now).\n            weekYear = defaults(w.GG, config._a[YEAR], weekOfYear(local__createLocal(), 1, 4).year);\n            week = defaults(w.W, 1);\n            weekday = defaults(w.E, 1);\n        } else {\n            dow = config._locale._week.dow;\n            doy = config._locale._week.doy;\n\n            weekYear = defaults(w.gg, config._a[YEAR], weekOfYear(local__createLocal(), dow, doy).year);\n            week = defaults(w.w, 1);\n\n            if (w.d != null) {\n                // weekday -- low day numbers are considered next week\n                weekday = w.d;\n                if (weekday < dow) {\n                    ++week;\n                }\n            } else if (w.e != null) {\n                // local weekday -- counting starts from begining of week\n                weekday = w.e + dow;\n            } else {\n                // default to begining of week\n                weekday = dow;\n            }\n        }\n        temp = dayOfYearFromWeeks(weekYear, week, weekday, doy, dow);\n\n        config._a[YEAR] = temp.year;\n        config._dayOfYear = temp.dayOfYear;\n    }\n\n    utils_hooks__hooks.ISO_8601 = function () {};\n\n    // date from string and format string\n    function configFromStringAndFormat(config) {\n        // TODO: Move this to another part of the creation flow to prevent circular deps\n        if (config._f === utils_hooks__hooks.ISO_8601) {\n            configFromISO(config);\n            return;\n        }\n\n        config._a = [];\n        config._pf.empty = true;\n\n        // This array is used to make a Date, either with `new Date` or `Date.UTC`\n        var string = '' + config._i,\n            i, parsedInput, tokens, token, skipped,\n            stringLength = string.length,\n            totalParsedInputLength = 0;\n\n        tokens = expandFormat(config._f, config._locale).match(formattingTokens) || [];\n\n        for (i = 0; i < tokens.length; i++) {\n            token = tokens[i];\n            parsedInput = (string.match(getParseRegexForToken(token, config)) || [])[0];\n            if (parsedInput) {\n                skipped = string.substr(0, string.indexOf(parsedInput));\n                if (skipped.length > 0) {\n                    config._pf.unusedInput.push(skipped);\n                }\n                string = string.slice(string.indexOf(parsedInput) + parsedInput.length);\n                totalParsedInputLength += parsedInput.length;\n            }\n            // don't parse if it's not a known token\n            if (formatTokenFunctions[token]) {\n                if (parsedInput) {\n                    config._pf.empty = false;\n                }\n                else {\n                    config._pf.unusedTokens.push(token);\n                }\n                addTimeToArrayFromToken(token, parsedInput, config);\n            }\n            else if (config._strict && !parsedInput) {\n                config._pf.unusedTokens.push(token);\n            }\n        }\n\n        // add remaining unparsed input length to the string\n        config._pf.charsLeftOver = stringLength - totalParsedInputLength;\n        if (string.length > 0) {\n            config._pf.unusedInput.push(string);\n        }\n\n        // clear _12h flag if hour is <= 12\n        if (config._pf.bigHour === true && config._a[HOUR] <= 12) {\n            config._pf.bigHour = undefined;\n        }\n        // handle meridiem\n        config._a[HOUR] = meridiemFixWrap(config._locale, config._a[HOUR], config._meridiem);\n\n        configFromArray(config);\n        checkOverflow(config);\n    }\n\n\n    function meridiemFixWrap (locale, hour, meridiem) {\n        var isPm;\n\n        if (meridiem == null) {\n            // nothing to do\n            return hour;\n        }\n        if (locale.meridiemHour != null) {\n            return locale.meridiemHour(hour, meridiem);\n        } else if (locale.isPM != null) {\n            // Fallback\n            isPm = locale.isPM(meridiem);\n            if (isPm && hour < 12) {\n                hour += 12;\n            }\n            if (!isPm && hour === 12) {\n                hour = 0;\n            }\n            return hour;\n        } else {\n            // this is not supposed to happen\n            return hour;\n        }\n    }\n\n    function configFromStringAndArray(config) {\n        var tempConfig,\n            bestMoment,\n\n            scoreToBeat,\n            i,\n            currentScore;\n\n        if (config._f.length === 0) {\n            config._pf.invalidFormat = true;\n            config._d = new Date(NaN);\n            return;\n        }\n\n        for (i = 0; i < config._f.length; i++) {\n            currentScore = 0;\n            tempConfig = copyConfig({}, config);\n            if (config._useUTC != null) {\n                tempConfig._useUTC = config._useUTC;\n            }\n            tempConfig._pf = defaultParsingFlags();\n            tempConfig._f = config._f[i];\n            configFromStringAndFormat(tempConfig);\n\n            if (!valid__isValid(tempConfig)) {\n                continue;\n            }\n\n            // if there is any input that was not parsed add a penalty for that format\n            currentScore += tempConfig._pf.charsLeftOver;\n\n            //or tokens\n            currentScore += tempConfig._pf.unusedTokens.length * 10;\n\n            tempConfig._pf.score = currentScore;\n\n            if (scoreToBeat == null || currentScore < scoreToBeat) {\n                scoreToBeat = currentScore;\n                bestMoment = tempConfig;\n            }\n        }\n\n        extend(config, bestMoment || tempConfig);\n    }\n\n    function configFromObject(config) {\n        if (config._d) {\n            return;\n        }\n\n        var i = normalizeObjectUnits(config._i);\n        config._a = [i.year, i.month, i.day || i.date, i.hour, i.minute, i.second, i.millisecond];\n\n        configFromArray(config);\n    }\n\n    function createFromConfig (config) {\n        var input = config._i,\n            format = config._f,\n            res;\n\n        config._locale = config._locale || locale_locales__getLocale(config._l);\n\n        if (input === null || (format === undefined && input === '')) {\n            return valid__createInvalid({nullInput: true});\n        }\n\n        if (typeof input === 'string') {\n            config._i = input = config._locale.preparse(input);\n        }\n\n        if (isMoment(input)) {\n            return new Moment(checkOverflow(input));\n        } else if (isArray(format)) {\n            configFromStringAndArray(config);\n        } else if (format) {\n            configFromStringAndFormat(config);\n        } else {\n            configFromInput(config);\n        }\n\n        res = new Moment(checkOverflow(config));\n        if (res._nextDay) {\n            // Adding is smart enough around DST\n            res.add(1, 'd');\n            res._nextDay = undefined;\n        }\n\n        return res;\n    }\n\n    function configFromInput(config) {\n        var input = config._i;\n        if (input === undefined) {\n            config._d = new Date();\n        } else if (isDate(input)) {\n            config._d = new Date(+input);\n        } else if (typeof input === 'string') {\n            configFromString(config);\n        } else if (isArray(input)) {\n            config._a = map(input.slice(0), function (obj) {\n                return parseInt(obj, 10);\n            });\n            configFromArray(config);\n        } else if (typeof(input) === 'object') {\n            configFromObject(config);\n        } else if (typeof(input) === 'number') {\n            // from milliseconds\n            config._d = new Date(input);\n        } else {\n            utils_hooks__hooks.createFromInputFallback(config);\n        }\n    }\n\n    function createLocalOrUTC (input, format, locale, strict, isUTC) {\n        var c = {};\n\n        if (typeof(locale) === 'boolean') {\n            strict = locale;\n            locale = undefined;\n        }\n        // object construction must be done this way.\n        // https://github.com/moment/moment/issues/1423\n        c._isAMomentObject = true;\n        c._useUTC = c._isUTC = isUTC;\n        c._l = locale;\n        c._i = input;\n        c._f = format;\n        c._strict = strict;\n        c._pf = defaultParsingFlags();\n\n        return createFromConfig(c);\n    }\n\n    function local__createLocal (input, format, locale, strict) {\n        return createLocalOrUTC(input, format, locale, strict, false);\n    }\n\n    var prototypeMin = deprecate(\n         'moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548',\n         function () {\n             var other = local__createLocal.apply(null, arguments);\n             return other < this ? this : other;\n         }\n     );\n\n    var prototypeMax = deprecate(\n        'moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548',\n        function () {\n            var other = local__createLocal.apply(null, arguments);\n            return other > this ? this : other;\n        }\n    );\n\n    // Pick a moment m from moments so that m[fn](other) is true for all\n    // other. This relies on the function fn to be transitive.\n    //\n    // moments should either be an array of moment objects or an array, whose\n    // first element is an array of moment objects.\n    function pickBy(fn, moments) {\n        var res, i;\n        if (moments.length === 1 && isArray(moments[0])) {\n            moments = moments[0];\n        }\n        if (!moments.length) {\n            return local__createLocal();\n        }\n        res = moments[0];\n        for (i = 1; i < moments.length; ++i) {\n            if (moments[i][fn](res)) {\n                res = moments[i];\n            }\n        }\n        return res;\n    }\n\n    // TODO: Use [].sort instead?\n    function min () {\n        var args = [].slice.call(arguments, 0);\n\n        return pickBy('isBefore', args);\n    }\n\n    function max () {\n        var args = [].slice.call(arguments, 0);\n\n        return pickBy('isAfter', args);\n    }\n\n    function Duration (duration) {\n        var normalizedInput = normalizeObjectUnits(duration),\n            years = normalizedInput.year || 0,\n            quarters = normalizedInput.quarter || 0,\n            months = normalizedInput.month || 0,\n            weeks = normalizedInput.week || 0,\n            days = normalizedInput.day || 0,\n            hours = normalizedInput.hour || 0,\n            minutes = normalizedInput.minute || 0,\n            seconds = normalizedInput.second || 0,\n            milliseconds = normalizedInput.millisecond || 0;\n\n        // representation for dateAddRemove\n        this._milliseconds = +milliseconds +\n            seconds * 1e3 + // 1000\n            minutes * 6e4 + // 1000 * 60\n            hours * 36e5; // 1000 * 60 * 60\n        // Because of dateAddRemove treats 24 hours as different from a\n        // day when working around DST, we need to store them separately\n        this._days = +days +\n            weeks * 7;\n        // It is impossible translate months into days without knowing\n        // which months you are are talking about, so we have to store\n        // it separately.\n        this._months = +months +\n            quarters * 3 +\n            years * 12;\n\n        this._data = {};\n\n        this._locale = locale_locales__getLocale();\n\n        this._bubble();\n    }\n\n    function isDuration (obj) {\n        return obj instanceof Duration;\n    }\n\n    function offset (token, separator) {\n        addFormatToken(token, 0, 0, function () {\n            var offset = this.utcOffset();\n            var sign = '+';\n            if (offset < 0) {\n                offset = -offset;\n                sign = '-';\n            }\n            return sign + zeroFill(~~(offset / 60), 2) + separator + zeroFill(~~(offset) % 60, 2);\n        });\n    }\n\n    offset('Z', ':');\n    offset('ZZ', '');\n\n    // PARSING\n\n    addRegexToken('Z',  matchOffset);\n    addRegexToken('ZZ', matchOffset);\n    addParseToken(['Z', 'ZZ'], function (input, array, config) {\n        config._useUTC = true;\n        config._tzm = offsetFromString(input);\n    });\n\n    // HELPERS\n\n    // timezone chunker\n    // '+10:00' > ['10',  '00']\n    // '-1530'  > ['-15', '30']\n    var chunkOffset = /([\\+\\-]|\\d\\d)/gi;\n\n    function offsetFromString(string) {\n        var matches = ((string || '').match(matchOffset) || []);\n        var chunk   = matches[matches.length - 1] || [];\n        var parts   = (chunk + '').match(chunkOffset) || ['-', 0, 0];\n        var minutes = +(parts[1] * 60) + toInt(parts[2]);\n\n        return parts[0] === '+' ? minutes : -minutes;\n    }\n\n    // Return a moment from input, that is local/utc/zone equivalent to model.\n    function cloneWithOffset(input, model) {\n        var res, diff;\n        if (model._isUTC) {\n            res = model.clone();\n            diff = (isMoment(input) || isDate(input) ? +input : +local__createLocal(input)) - (+res);\n            // Use low-level api, because this fn is low-level api.\n            res._d.setTime(+res._d + diff);\n            utils_hooks__hooks.updateOffset(res, false);\n            return res;\n        } else {\n            return local__createLocal(input).local();\n        }\n        return model._isUTC ? local__createLocal(input).zone(model._offset || 0) : local__createLocal(input).local();\n    }\n\n    function getDateOffset (m) {\n        // On Firefox.24 Date#getTimezoneOffset returns a floating point.\n        // https://github.com/moment/moment/pull/1871\n        return -Math.round(m._d.getTimezoneOffset() / 15) * 15;\n    }\n\n    // HOOKS\n\n    // This function will be called whenever a moment is mutated.\n    // It is intended to keep the offset in sync with the timezone.\n    utils_hooks__hooks.updateOffset = function () {};\n\n    // MOMENTS\n\n    // keepLocalTime = true means only change the timezone, without\n    // affecting the local hour. So 5:31:26 +0300 --[utcOffset(2, true)]-->\n    // 5:31:26 +0200 It is possible that 5:31:26 doesn't exist with offset\n    // +0200, so we adjust the time as needed, to be valid.\n    //\n    // Keeping the time actually adds/subtracts (one hour)\n    // from the actual represented time. That is why we call updateOffset\n    // a second time. In case it wants us to change the offset again\n    // _changeInProgress == true case, then we have to adjust, because\n    // there is no such time in the given timezone.\n    function getSetOffset (input, keepLocalTime) {\n        var offset = this._offset || 0,\n            localAdjust;\n        if (input != null) {\n            if (typeof input === 'string') {\n                input = offsetFromString(input);\n            }\n            if (Math.abs(input) < 16) {\n                input = input * 60;\n            }\n            if (!this._isUTC && keepLocalTime) {\n                localAdjust = getDateOffset(this);\n            }\n            this._offset = input;\n            this._isUTC = true;\n            if (localAdjust != null) {\n                this.add(localAdjust, 'm');\n            }\n            if (offset !== input) {\n                if (!keepLocalTime || this._changeInProgress) {\n                    add_subtract__addSubtract(this, create__createDuration(input - offset, 'm'), 1, false);\n                } else if (!this._changeInProgress) {\n                    this._changeInProgress = true;\n                    utils_hooks__hooks.updateOffset(this, true);\n                    this._changeInProgress = null;\n                }\n            }\n            return this;\n        } else {\n            return this._isUTC ? offset : getDateOffset(this);\n        }\n    }\n\n    function getSetZone (input, keepLocalTime) {\n        if (input != null) {\n            if (typeof input !== 'string') {\n                input = -input;\n            }\n\n            this.utcOffset(input, keepLocalTime);\n\n            return this;\n        } else {\n            return -this.utcOffset();\n        }\n    }\n\n    function setOffsetToUTC (keepLocalTime) {\n        return this.utcOffset(0, keepLocalTime);\n    }\n\n    function setOffsetToLocal (keepLocalTime) {\n        if (this._isUTC) {\n            this.utcOffset(0, keepLocalTime);\n            this._isUTC = false;\n\n            if (keepLocalTime) {\n                this.subtract(getDateOffset(this), 'm');\n            }\n        }\n        return this;\n    }\n\n    function setOffsetToParsedOffset () {\n        if (this._tzm) {\n            this.utcOffset(this._tzm);\n        } else if (typeof this._i === 'string') {\n            this.utcOffset(offsetFromString(this._i));\n        }\n        return this;\n    }\n\n    function hasAlignedHourOffset (input) {\n        if (!input) {\n            input = 0;\n        }\n        else {\n            input = local__createLocal(input).utcOffset();\n        }\n\n        return (this.utcOffset() - input) % 60 === 0;\n    }\n\n    function isDaylightSavingTime () {\n        return (\n            this.utcOffset() > this.clone().month(0).utcOffset() ||\n            this.utcOffset() > this.clone().month(5).utcOffset()\n        );\n    }\n\n    function isDaylightSavingTimeShifted () {\n        if (this._a) {\n            var other = this._isUTC ? create_utc__createUTC(this._a) : local__createLocal(this._a);\n            return this.isValid() && compareArrays(this._a, other.toArray()) > 0;\n        }\n\n        return false;\n    }\n\n    function isLocal () {\n        return !this._isUTC;\n    }\n\n    function isUtcOffset () {\n        return this._isUTC;\n    }\n\n    function isUtc () {\n        return this._isUTC && this._offset === 0;\n    }\n\n    var aspNetRegex = /(\\-)?(?:(\\d*)\\.)?(\\d+)\\:(\\d+)(?:\\:(\\d+)\\.?(\\d{3})?)?/;\n\n    // from http://docs.closure-library.googlecode.com/git/closure_goog_date_date.js.source.html\n    // somewhat more in line with 4.4.3.2 2004 spec, but allows decimal anywhere\n    var create__isoRegex = /^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/;\n\n    function create__createDuration (input, key) {\n        var duration = input,\n            // matching against regexp is expensive, do it on demand\n            match = null,\n            sign,\n            ret,\n            diffRes;\n\n        if (isDuration(input)) {\n            duration = {\n                ms : input._milliseconds,\n                d  : input._days,\n                M  : input._months\n            };\n        } else if (typeof input === 'number') {\n            duration = {};\n            if (key) {\n                duration[key] = input;\n            } else {\n                duration.milliseconds = input;\n            }\n        } else if (!!(match = aspNetRegex.exec(input))) {\n            sign = (match[1] === '-') ? -1 : 1;\n            duration = {\n                y  : 0,\n                d  : toInt(match[DATE])        * sign,\n                h  : toInt(match[HOUR])        * sign,\n                m  : toInt(match[MINUTE])      * sign,\n                s  : toInt(match[SECOND])      * sign,\n                ms : toInt(match[MILLISECOND]) * sign\n            };\n        } else if (!!(match = create__isoRegex.exec(input))) {\n            sign = (match[1] === '-') ? -1 : 1;\n            duration = {\n                y : parseIso(match[2], sign),\n                M : parseIso(match[3], sign),\n                d : parseIso(match[4], sign),\n                h : parseIso(match[5], sign),\n                m : parseIso(match[6], sign),\n                s : parseIso(match[7], sign),\n                w : parseIso(match[8], sign)\n            };\n        } else if (duration == null) {// checks for null or undefined\n            duration = {};\n        } else if (typeof duration === 'object' && ('from' in duration || 'to' in duration)) {\n            diffRes = momentsDifference(local__createLocal(duration.from), local__createLocal(duration.to));\n\n            duration = {};\n            duration.ms = diffRes.milliseconds;\n            duration.M = diffRes.months;\n        }\n\n        ret = new Duration(duration);\n\n        if (isDuration(input) && hasOwnProp(input, '_locale')) {\n            ret._locale = input._locale;\n        }\n\n        return ret;\n    }\n\n    create__createDuration.fn = Duration.prototype;\n\n    function parseIso (inp, sign) {\n        // We'd normally use ~~inp for this, but unfortunately it also\n        // converts floats to ints.\n        // inp may be undefined, so careful calling replace on it.\n        var res = inp && parseFloat(inp.replace(',', '.'));\n        // apply sign while we're at it\n        return (isNaN(res) ? 0 : res) * sign;\n    }\n\n    function positiveMomentsDifference(base, other) {\n        var res = {milliseconds: 0, months: 0};\n\n        res.months = other.month() - base.month() +\n            (other.year() - base.year()) * 12;\n        if (base.clone().add(res.months, 'M').isAfter(other)) {\n            --res.months;\n        }\n\n        res.milliseconds = +other - +(base.clone().add(res.months, 'M'));\n\n        return res;\n    }\n\n    function momentsDifference(base, other) {\n        var res;\n        other = cloneWithOffset(other, base);\n        if (base.isBefore(other)) {\n            res = positiveMomentsDifference(base, other);\n        } else {\n            res = positiveMomentsDifference(other, base);\n            res.milliseconds = -res.milliseconds;\n            res.months = -res.months;\n        }\n\n        return res;\n    }\n\n    function createAdder(direction, name) {\n        return function (val, period) {\n            var dur, tmp;\n            //invert the arguments, but complain about it\n            if (period !== null && !isNaN(+period)) {\n                deprecateSimple(name, 'moment().' + name  + '(period, number) is deprecated. Please use moment().' + name + '(number, period).');\n                tmp = val; val = period; period = tmp;\n            }\n\n            val = typeof val === 'string' ? +val : val;\n            dur = create__createDuration(val, period);\n            add_subtract__addSubtract(this, dur, direction);\n            return this;\n        };\n    }\n\n    function add_subtract__addSubtract (mom, duration, isAdding, updateOffset) {\n        var milliseconds = duration._milliseconds,\n            days = duration._days,\n            months = duration._months;\n        updateOffset = updateOffset == null ? true : updateOffset;\n\n        if (milliseconds) {\n            mom._d.setTime(+mom._d + milliseconds * isAdding);\n        }\n        if (days) {\n            get_set__set(mom, 'Date', get_set__get(mom, 'Date') + days * isAdding);\n        }\n        if (months) {\n            setMonth(mom, get_set__get(mom, 'Month') + months * isAdding);\n        }\n        if (updateOffset) {\n            utils_hooks__hooks.updateOffset(mom, days || months);\n        }\n    }\n\n    var add_subtract__add      = createAdder(1, 'add');\n    var add_subtract__subtract = createAdder(-1, 'subtract');\n\n    function moment_calendar__calendar (time) {\n        // We want to compare the start of today, vs this.\n        // Getting start-of-today depends on whether we're local/utc/offset or not.\n        var now = time || local__createLocal(),\n            sod = cloneWithOffset(now, this).startOf('day'),\n            diff = this.diff(sod, 'days', true),\n            format = diff < -6 ? 'sameElse' :\n                diff < -1 ? 'lastWeek' :\n                diff < 0 ? 'lastDay' :\n                diff < 1 ? 'sameDay' :\n                diff < 2 ? 'nextDay' :\n                diff < 7 ? 'nextWeek' : 'sameElse';\n        return this.format(this.localeData().calendar(format, this, local__createLocal(now)));\n    }\n\n    function clone () {\n        return new Moment(this);\n    }\n\n    function isAfter (input, units) {\n        var inputMs;\n        units = normalizeUnits(typeof units !== 'undefined' ? units : 'millisecond');\n        if (units === 'millisecond') {\n            input = isMoment(input) ? input : local__createLocal(input);\n            return +this > +input;\n        } else {\n            inputMs = isMoment(input) ? +input : +local__createLocal(input);\n            return inputMs < +this.clone().startOf(units);\n        }\n    }\n\n    function isBefore (input, units) {\n        var inputMs;\n        units = normalizeUnits(typeof units !== 'undefined' ? units : 'millisecond');\n        if (units === 'millisecond') {\n            input = isMoment(input) ? input : local__createLocal(input);\n            return +this < +input;\n        } else {\n            inputMs = isMoment(input) ? +input : +local__createLocal(input);\n            return +this.clone().endOf(units) < inputMs;\n        }\n    }\n\n    function isBetween (from, to, units) {\n        return this.isAfter(from, units) && this.isBefore(to, units);\n    }\n\n    function isSame (input, units) {\n        var inputMs;\n        units = normalizeUnits(units || 'millisecond');\n        if (units === 'millisecond') {\n            input = isMoment(input) ? input : local__createLocal(input);\n            return +this === +input;\n        } else {\n            inputMs = +local__createLocal(input);\n            return +(this.clone().startOf(units)) <= inputMs && inputMs <= +(this.clone().endOf(units));\n        }\n    }\n\n    function absFloor (number) {\n        if (number < 0) {\n            return Math.ceil(number);\n        } else {\n            return Math.floor(number);\n        }\n    }\n\n    function diff (input, units, asFloat) {\n        var that = cloneWithOffset(input, this),\n            zoneDelta = (that.utcOffset() - this.utcOffset()) * 6e4,\n            delta, output;\n\n        units = normalizeUnits(units);\n\n        if (units === 'year' || units === 'month' || units === 'quarter') {\n            output = monthDiff(this, that);\n            if (units === 'quarter') {\n                output = output / 3;\n            } else if (units === 'year') {\n                output = output / 12;\n            }\n        } else {\n            delta = this - that;\n            output = units === 'second' ? delta / 1e3 : // 1000\n                units === 'minute' ? delta / 6e4 : // 1000 * 60\n                units === 'hour' ? delta / 36e5 : // 1000 * 60 * 60\n                units === 'day' ? (delta - zoneDelta) / 864e5 : // 1000 * 60 * 60 * 24, negate dst\n                units === 'week' ? (delta - zoneDelta) / 6048e5 : // 1000 * 60 * 60 * 24 * 7, negate dst\n                delta;\n        }\n        return asFloat ? output : absFloor(output);\n    }\n\n    function monthDiff (a, b) {\n        // difference in months\n        var wholeMonthDiff = ((b.year() - a.year()) * 12) + (b.month() - a.month()),\n            // b is in (anchor - 1 month, anchor + 1 month)\n            anchor = a.clone().add(wholeMonthDiff, 'months'),\n            anchor2, adjust;\n\n        if (b - anchor < 0) {\n            anchor2 = a.clone().add(wholeMonthDiff - 1, 'months');\n            // linear across the month\n            adjust = (b - anchor) / (anchor - anchor2);\n        } else {\n            anchor2 = a.clone().add(wholeMonthDiff + 1, 'months');\n            // linear across the month\n            adjust = (b - anchor) / (anchor2 - anchor);\n        }\n\n        return -(wholeMonthDiff + adjust);\n    }\n\n    utils_hooks__hooks.defaultFormat = 'YYYY-MM-DDTHH:mm:ssZ';\n\n    function toString () {\n        return this.clone().locale('en').format('ddd MMM DD YYYY HH:mm:ss [GMT]ZZ');\n    }\n\n    function moment_format__toISOString () {\n        var m = this.clone().utc();\n        if (0 < m.year() && m.year() <= 9999) {\n            if ('function' === typeof Date.prototype.toISOString) {\n                // native implementation is ~50x faster, use it when we can\n                return this.toDate().toISOString();\n            } else {\n                return formatMoment(m, 'YYYY-MM-DD[T]HH:mm:ss.SSS[Z]');\n            }\n        } else {\n            return formatMoment(m, 'YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]');\n        }\n    }\n\n    function format (inputString) {\n        var output = formatMoment(this, inputString || utils_hooks__hooks.defaultFormat);\n        return this.localeData().postformat(output);\n    }\n\n    function from (time, withoutSuffix) {\n        return create__createDuration({to: this, from: time}).locale(this.locale()).humanize(!withoutSuffix);\n    }\n\n    function fromNow (withoutSuffix) {\n        return this.from(local__createLocal(), withoutSuffix);\n    }\n\n    function locale (key) {\n        var newLocaleData;\n\n        if (key === undefined) {\n            return this._locale._abbr;\n        } else {\n            newLocaleData = locale_locales__getLocale(key);\n            if (newLocaleData != null) {\n                this._locale = newLocaleData;\n            }\n            return this;\n        }\n    }\n\n    var lang = deprecate(\n        'moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.',\n        function (key) {\n            if (key === undefined) {\n                return this.localeData();\n            } else {\n                return this.locale(key);\n            }\n        }\n    );\n\n    function localeData () {\n        return this._locale;\n    }\n\n    function startOf (units) {\n        units = normalizeUnits(units);\n        // the following switch intentionally omits break keywords\n        // to utilize falling through the cases.\n        switch (units) {\n        case 'year':\n            this.month(0);\n            /* falls through */\n        case 'quarter':\n        case 'month':\n            this.date(1);\n            /* falls through */\n        case 'week':\n        case 'isoWeek':\n        case 'day':\n            this.hours(0);\n            /* falls through */\n        case 'hour':\n            this.minutes(0);\n            /* falls through */\n        case 'minute':\n            this.seconds(0);\n            /* falls through */\n        case 'second':\n            this.milliseconds(0);\n        }\n\n        // weeks are a special case\n        if (units === 'week') {\n            this.weekday(0);\n        }\n        if (units === 'isoWeek') {\n            this.isoWeekday(1);\n        }\n\n        // quarters are also special\n        if (units === 'quarter') {\n            this.month(Math.floor(this.month() / 3) * 3);\n        }\n\n        return this;\n    }\n\n    function endOf (units) {\n        units = normalizeUnits(units);\n        if (units === undefined || units === 'millisecond') {\n            return this;\n        }\n        return this.startOf(units).add(1, (units === 'isoWeek' ? 'week' : units)).subtract(1, 'ms');\n    }\n\n    function to_type__valueOf () {\n        return +this._d - ((this._offset || 0) * 60000);\n    }\n\n    function unix () {\n        return Math.floor(+this / 1000);\n    }\n\n    function toDate () {\n        return this._offset ? new Date(+this) : this._d;\n    }\n\n    function toArray () {\n        var m = this;\n        return [m.year(), m.month(), m.date(), m.hour(), m.minute(), m.second(), m.millisecond()];\n    }\n\n    function moment_valid__isValid () {\n        return valid__isValid(this);\n    }\n\n    function parsingFlags () {\n        return extend({}, this._pf);\n    }\n\n    function invalidAt () {\n        return this._pf.overflow;\n    }\n\n    addFormatToken(0, ['gg', 2], 0, function () {\n        return this.weekYear() % 100;\n    });\n\n    addFormatToken(0, ['GG', 2], 0, function () {\n        return this.isoWeekYear() % 100;\n    });\n\n    function addWeekYearFormatToken (token, getter) {\n        addFormatToken(0, [token, token.length], 0, getter);\n    }\n\n    addWeekYearFormatToken('gggg',     'weekYear');\n    addWeekYearFormatToken('ggggg',    'weekYear');\n    addWeekYearFormatToken('GGGG',  'isoWeekYear');\n    addWeekYearFormatToken('GGGGG', 'isoWeekYear');\n\n    // ALIASES\n\n    addUnitAlias('weekYear', 'gg');\n    addUnitAlias('isoWeekYear', 'GG');\n\n    // PARSING\n\n    addRegexToken('G',      matchSigned);\n    addRegexToken('g',      matchSigned);\n    addRegexToken('GG',     match1to2, match2);\n    addRegexToken('gg',     match1to2, match2);\n    addRegexToken('GGGG',   match1to4, match4);\n    addRegexToken('gggg',   match1to4, match4);\n    addRegexToken('GGGGG',  match1to6, match6);\n    addRegexToken('ggggg',  match1to6, match6);\n\n    addWeekParseToken(['gggg', 'ggggg', 'GGGG', 'GGGGG'], function (input, week, config, token) {\n        week[token.substr(0, 2)] = toInt(input);\n    });\n\n    addWeekParseToken(['gg', 'GG'], function (input, week, config, token) {\n        week[token] = utils_hooks__hooks.parseTwoDigitYear(input);\n    });\n\n    // HELPERS\n\n    function weeksInYear(year, dow, doy) {\n        return weekOfYear(local__createLocal([year, 11, 31 + dow - doy]), dow, doy).week;\n    }\n\n    // MOMENTS\n\n    function getSetWeekYear (input) {\n        var year = weekOfYear(this, this.localeData()._week.dow, this.localeData()._week.doy).year;\n        return input == null ? year : this.add((input - year), 'y');\n    }\n\n    function getSetISOWeekYear (input) {\n        var year = weekOfYear(this, 1, 4).year;\n        return input == null ? year : this.add((input - year), 'y');\n    }\n\n    function getISOWeeksInYear () {\n        return weeksInYear(this.year(), 1, 4);\n    }\n\n    function getWeeksInYear () {\n        var weekInfo = this.localeData()._week;\n        return weeksInYear(this.year(), weekInfo.dow, weekInfo.doy);\n    }\n\n    addFormatToken('Q', 0, 0, 'quarter');\n\n    // ALIASES\n\n    addUnitAlias('quarter', 'Q');\n\n    // PARSING\n\n    addRegexToken('Q', match1);\n    addParseToken('Q', function (input, array) {\n        array[MONTH] = (toInt(input) - 1) * 3;\n    });\n\n    // MOMENTS\n\n    function getSetQuarter (input) {\n        return input == null ? Math.ceil((this.month() + 1) / 3) : this.month((input - 1) * 3 + this.month() % 3);\n    }\n\n    addFormatToken('D', ['DD', 2], 'Do', 'date');\n\n    // ALIASES\n\n    addUnitAlias('date', 'D');\n\n    // PARSING\n\n    addRegexToken('D',  match1to2);\n    addRegexToken('DD', match1to2, match2);\n    addRegexToken('Do', function (isStrict, locale) {\n        return isStrict ? locale._ordinalParse : locale._ordinalParseLenient;\n    });\n\n    addParseToken(['D', 'DD'], DATE);\n    addParseToken('Do', function (input, array) {\n        array[DATE] = toInt(input.match(match1to2)[0], 10);\n    });\n\n    // MOMENTS\n\n    var getSetDayOfMonth = makeGetSet('Date', true);\n\n    addFormatToken('d', 0, 'do', 'day');\n\n    addFormatToken('dd', 0, 0, function (format) {\n        return this.localeData().weekdaysMin(this, format);\n    });\n\n    addFormatToken('ddd', 0, 0, function (format) {\n        return this.localeData().weekdaysShort(this, format);\n    });\n\n    addFormatToken('dddd', 0, 0, function (format) {\n        return this.localeData().weekdays(this, format);\n    });\n\n    addFormatToken('e', 0, 0, 'weekday');\n    addFormatToken('E', 0, 0, 'isoWeekday');\n\n    // ALIASES\n\n    addUnitAlias('day', 'd');\n    addUnitAlias('weekday', 'e');\n    addUnitAlias('isoWeekday', 'E');\n\n    // PARSING\n\n    addRegexToken('d',    match1to2);\n    addRegexToken('e',    match1to2);\n    addRegexToken('E',    match1to2);\n    addRegexToken('dd',   matchWord);\n    addRegexToken('ddd',  matchWord);\n    addRegexToken('dddd', matchWord);\n\n    addWeekParseToken(['dd', 'ddd', 'dddd'], function (input, week, config) {\n        var weekday = config._locale.weekdaysParse(input);\n        // if we didn't get a weekday name, mark the date as invalid\n        if (weekday != null) {\n            week.d = weekday;\n        } else {\n            config._pf.invalidWeekday = input;\n        }\n    });\n\n    addWeekParseToken(['d', 'e', 'E'], function (input, week, config, token) {\n        week[token] = toInt(input);\n    });\n\n    // HELPERS\n\n    function parseWeekday(input, locale) {\n        if (typeof input === 'string') {\n            if (!isNaN(input)) {\n                input = parseInt(input, 10);\n            }\n            else {\n                input = locale.weekdaysParse(input);\n                if (typeof input !== 'number') {\n                    return null;\n                }\n            }\n        }\n        return input;\n    }\n\n    // LOCALES\n\n    var defaultLocaleWeekdays = 'Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday'.split('_');\n    function localeWeekdays (m) {\n        return this._weekdays[m.day()];\n    }\n\n    var defaultLocaleWeekdaysShort = 'Sun_Mon_Tue_Wed_Thu_Fri_Sat'.split('_');\n    function localeWeekdaysShort (m) {\n        return this._weekdaysShort[m.day()];\n    }\n\n    var defaultLocaleWeekdaysMin = 'Su_Mo_Tu_We_Th_Fr_Sa'.split('_');\n    function localeWeekdaysMin (m) {\n        return this._weekdaysMin[m.day()];\n    }\n\n    function localeWeekdaysParse (weekdayName) {\n        var i, mom, regex;\n\n        if (!this._weekdaysParse) {\n            this._weekdaysParse = [];\n        }\n\n        for (i = 0; i < 7; i++) {\n            // make the regex if we don't have it already\n            if (!this._weekdaysParse[i]) {\n                mom = local__createLocal([2000, 1]).day(i);\n                regex = '^' + this.weekdays(mom, '') + '|^' + this.weekdaysShort(mom, '') + '|^' + this.weekdaysMin(mom, '');\n                this._weekdaysParse[i] = new RegExp(regex.replace('.', ''), 'i');\n            }\n            // test the regex\n            if (this._weekdaysParse[i].test(weekdayName)) {\n                return i;\n            }\n        }\n    }\n\n    // MOMENTS\n\n    function getSetDayOfWeek (input) {\n        var day = this._isUTC ? this._d.getUTCDay() : this._d.getDay();\n        if (input != null) {\n            input = parseWeekday(input, this.localeData());\n            return this.add(input - day, 'd');\n        } else {\n            return day;\n        }\n    }\n\n    function getSetLocaleDayOfWeek (input) {\n        var weekday = (this.day() + 7 - this.localeData()._week.dow) % 7;\n        return input == null ? weekday : this.add(input - weekday, 'd');\n    }\n\n    function getSetISODayOfWeek (input) {\n        // behaves the same as moment#day except\n        // as a getter, returns 7 instead of 0 (1-7 range instead of 0-6)\n        // as a setter, sunday should belong to the previous week.\n        return input == null ? this.day() || 7 : this.day(this.day() % 7 ? input : input - 7);\n    }\n\n    addFormatToken('H', ['HH', 2], 0, 'hour');\n    addFormatToken('h', ['hh', 2], 0, function () {\n        return this.hours() % 12 || 12;\n    });\n\n    function meridiem (token, lowercase) {\n        addFormatToken(token, 0, 0, function () {\n            return this.localeData().meridiem(this.hours(), this.minutes(), lowercase);\n        });\n    }\n\n    meridiem('a', true);\n    meridiem('A', false);\n\n    // ALIASES\n\n    addUnitAlias('hour', 'h');\n\n    // PARSING\n\n    function matchMeridiem (isStrict, locale) {\n        return locale._meridiemParse;\n    }\n\n    addRegexToken('a',  matchMeridiem);\n    addRegexToken('A',  matchMeridiem);\n    addRegexToken('H',  match1to2);\n    addRegexToken('h',  match1to2);\n    addRegexToken('HH', match1to2, match2);\n    addRegexToken('hh', match1to2, match2);\n\n    addParseToken(['H', 'HH'], HOUR);\n    addParseToken(['a', 'A'], function (input, array, config) {\n        config._isPm = config._locale.isPM(input);\n        config._meridiem = input;\n    });\n    addParseToken(['h', 'hh'], function (input, array, config) {\n        array[HOUR] = toInt(input);\n        config._pf.bigHour = true;\n    });\n\n    // LOCALES\n\n    function localeIsPM (input) {\n        // IE8 Quirks Mode & IE7 Standards Mode do not allow accessing strings like arrays\n        // Using charAt should be more compatible.\n        return ((input + '').toLowerCase().charAt(0) === 'p');\n    }\n\n    var defaultLocaleMeridiemParse = /[ap]\\.?m?\\.?/i;\n    function localeMeridiem (hours, minutes, isLower) {\n        if (hours > 11) {\n            return isLower ? 'pm' : 'PM';\n        } else {\n            return isLower ? 'am' : 'AM';\n        }\n    }\n\n\n    // MOMENTS\n\n    // Setting the hour should keep the time, because the user explicitly\n    // specified which hour he wants. So trying to maintain the same hour (in\n    // a new timezone) makes sense. Adding/subtracting hours does not follow\n    // this rule.\n    var getSetHour = makeGetSet('Hours', true);\n\n    addFormatToken('m', ['mm', 2], 0, 'minute');\n\n    // ALIASES\n\n    addUnitAlias('minute', 'm');\n\n    // PARSING\n\n    addRegexToken('m',  match1to2);\n    addRegexToken('mm', match1to2, match2);\n    addParseToken(['m', 'mm'], MINUTE);\n\n    // MOMENTS\n\n    var getSetMinute = makeGetSet('Minutes', false);\n\n    addFormatToken('s', ['ss', 2], 0, 'second');\n\n    // ALIASES\n\n    addUnitAlias('second', 's');\n\n    // PARSING\n\n    addRegexToken('s',  match1to2);\n    addRegexToken('ss', match1to2, match2);\n    addParseToken(['s', 'ss'], SECOND);\n\n    // MOMENTS\n\n    var getSetSecond = makeGetSet('Seconds', false);\n\n    addFormatToken('S', 0, 0, function () {\n        return ~~(this.millisecond() / 100);\n    });\n\n    addFormatToken(0, ['SS', 2], 0, function () {\n        return ~~(this.millisecond() / 10);\n    });\n\n    function millisecond__milliseconds (token) {\n        addFormatToken(0, [token, 3], 0, 'millisecond');\n    }\n\n    millisecond__milliseconds('SSS');\n    millisecond__milliseconds('SSSS');\n\n    // ALIASES\n\n    addUnitAlias('millisecond', 'ms');\n\n    // PARSING\n\n    addRegexToken('S',    match1to3, match1);\n    addRegexToken('SS',   match1to3, match2);\n    addRegexToken('SSS',  match1to3, match3);\n    addRegexToken('SSSS', matchUnsigned);\n    addParseToken(['S', 'SS', 'SSS', 'SSSS'], function (input, array) {\n        array[MILLISECOND] = toInt(('0.' + input) * 1000);\n    });\n\n    // MOMENTS\n\n    var getSetMillisecond = makeGetSet('Milliseconds', false);\n\n    addFormatToken('z',  0, 0, 'zoneAbbr');\n    addFormatToken('zz', 0, 0, 'zoneName');\n\n    // MOMENTS\n\n    function getZoneAbbr () {\n        return this._isUTC ? 'UTC' : '';\n    }\n\n    function getZoneName () {\n        return this._isUTC ? 'Coordinated Universal Time' : '';\n    }\n\n    var momentPrototype__proto = Moment.prototype;\n\n    momentPrototype__proto.add          = add_subtract__add;\n    momentPrototype__proto.calendar     = moment_calendar__calendar;\n    momentPrototype__proto.clone        = clone;\n    momentPrototype__proto.diff         = diff;\n    momentPrototype__proto.endOf        = endOf;\n    momentPrototype__proto.format       = format;\n    momentPrototype__proto.from         = from;\n    momentPrototype__proto.fromNow      = fromNow;\n    momentPrototype__proto.get          = getSet;\n    momentPrototype__proto.invalidAt    = invalidAt;\n    momentPrototype__proto.isAfter      = isAfter;\n    momentPrototype__proto.isBefore     = isBefore;\n    momentPrototype__proto.isBetween    = isBetween;\n    momentPrototype__proto.isSame       = isSame;\n    momentPrototype__proto.isValid      = moment_valid__isValid;\n    momentPrototype__proto.lang         = lang;\n    momentPrototype__proto.locale       = locale;\n    momentPrototype__proto.localeData   = localeData;\n    momentPrototype__proto.max          = prototypeMax;\n    momentPrototype__proto.min          = prototypeMin;\n    momentPrototype__proto.parsingFlags = parsingFlags;\n    momentPrototype__proto.set          = getSet;\n    momentPrototype__proto.startOf      = startOf;\n    momentPrototype__proto.subtract     = add_subtract__subtract;\n    momentPrototype__proto.toArray      = toArray;\n    momentPrototype__proto.toDate       = toDate;\n    momentPrototype__proto.toISOString  = moment_format__toISOString;\n    momentPrototype__proto.toJSON       = moment_format__toISOString;\n    momentPrototype__proto.toString     = toString;\n    momentPrototype__proto.unix         = unix;\n    momentPrototype__proto.valueOf      = to_type__valueOf;\n\n    // Year\n    momentPrototype__proto.year       = getSetYear;\n    momentPrototype__proto.isLeapYear = getIsLeapYear;\n\n    // Week Year\n    momentPrototype__proto.weekYear    = getSetWeekYear;\n    momentPrototype__proto.isoWeekYear = getSetISOWeekYear;\n\n    // Quarter\n    momentPrototype__proto.quarter = momentPrototype__proto.quarters = getSetQuarter;\n\n    // Month\n    momentPrototype__proto.month       = getSetMonth;\n    momentPrototype__proto.daysInMonth = getDaysInMonth;\n\n    // Week\n    momentPrototype__proto.week           = momentPrototype__proto.weeks        = getSetWeek;\n    momentPrototype__proto.isoWeek        = momentPrototype__proto.isoWeeks     = getSetISOWeek;\n    momentPrototype__proto.weeksInYear    = getWeeksInYear;\n    momentPrototype__proto.isoWeeksInYear = getISOWeeksInYear;\n\n    // Day\n    momentPrototype__proto.date       = getSetDayOfMonth;\n    momentPrototype__proto.day        = momentPrototype__proto.days             = getSetDayOfWeek;\n    momentPrototype__proto.weekday    = getSetLocaleDayOfWeek;\n    momentPrototype__proto.isoWeekday = getSetISODayOfWeek;\n    momentPrototype__proto.dayOfYear  = getSetDayOfYear;\n\n    // Hour\n    momentPrototype__proto.hour = momentPrototype__proto.hours = getSetHour;\n\n    // Minute\n    momentPrototype__proto.minute = momentPrototype__proto.minutes = getSetMinute;\n\n    // Second\n    momentPrototype__proto.second = momentPrototype__proto.seconds = getSetSecond;\n\n    // Millisecond\n    momentPrototype__proto.millisecond = momentPrototype__proto.milliseconds = getSetMillisecond;\n\n    // Offset\n    momentPrototype__proto.utcOffset            = getSetOffset;\n    momentPrototype__proto.utc                  = setOffsetToUTC;\n    momentPrototype__proto.local                = setOffsetToLocal;\n    momentPrototype__proto.parseZone            = setOffsetToParsedOffset;\n    momentPrototype__proto.hasAlignedHourOffset = hasAlignedHourOffset;\n    momentPrototype__proto.isDST                = isDaylightSavingTime;\n    momentPrototype__proto.isDSTShifted         = isDaylightSavingTimeShifted;\n    momentPrototype__proto.isLocal              = isLocal;\n    momentPrototype__proto.isUtcOffset          = isUtcOffset;\n    momentPrototype__proto.isUtc                = isUtc;\n    momentPrototype__proto.isUTC                = isUtc;\n\n    // Timezone\n    momentPrototype__proto.zoneAbbr = getZoneAbbr;\n    momentPrototype__proto.zoneName = getZoneName;\n\n    // Deprecations\n    momentPrototype__proto.dates  = deprecate('dates accessor is deprecated. Use date instead.', getSetDayOfMonth);\n    momentPrototype__proto.months = deprecate('months accessor is deprecated. Use month instead', getSetMonth);\n    momentPrototype__proto.years  = deprecate('years accessor is deprecated. Use year instead', getSetYear);\n    momentPrototype__proto.zone   = deprecate('moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779', getSetZone);\n\n    var momentPrototype = momentPrototype__proto;\n\n    function moment__createUnix (input) {\n        return local__createLocal(input * 1000);\n    }\n\n    function moment__createInZone () {\n        return local__createLocal.apply(null, arguments).parseZone();\n    }\n\n    var defaultCalendar = {\n        sameDay : '[Today at] LT',\n        nextDay : '[Tomorrow at] LT',\n        nextWeek : 'dddd [at] LT',\n        lastDay : '[Yesterday at] LT',\n        lastWeek : '[Last] dddd [at] LT',\n        sameElse : 'L'\n    };\n\n    function locale_calendar__calendar (key, mom, now) {\n        var output = this._calendar[key];\n        return typeof output === 'function' ? output.call(mom, now) : output;\n    }\n\n    var defaultLongDateFormat = {\n        LTS  : 'h:mm:ss A',\n        LT   : 'h:mm A',\n        L    : 'MM/DD/YYYY',\n        LL   : 'MMMM D, YYYY',\n        LLL  : 'MMMM D, YYYY LT',\n        LLLL : 'dddd, MMMM D, YYYY LT'\n    };\n\n    function longDateFormat (key) {\n        var output = this._longDateFormat[key];\n        if (!output && this._longDateFormat[key.toUpperCase()]) {\n            output = this._longDateFormat[key.toUpperCase()].replace(/MMMM|MM|DD|dddd/g, function (val) {\n                return val.slice(1);\n            });\n            this._longDateFormat[key] = output;\n        }\n        return output;\n    }\n\n    var defaultInvalidDate = 'Invalid date';\n\n    function invalidDate () {\n        return this._invalidDate;\n    }\n\n    var defaultOrdinal = '%d';\n    var defaultOrdinalParse = /\\d{1,2}/;\n\n    function ordinal (number) {\n        return this._ordinal.replace('%d', number);\n    }\n\n    function preParsePostFormat (string) {\n        return string;\n    }\n\n    var defaultRelativeTime = {\n        future : 'in %s',\n        past   : '%s ago',\n        s  : 'a few seconds',\n        m  : 'a minute',\n        mm : '%d minutes',\n        h  : 'an hour',\n        hh : '%d hours',\n        d  : 'a day',\n        dd : '%d days',\n        M  : 'a month',\n        MM : '%d months',\n        y  : 'a year',\n        yy : '%d years'\n    };\n\n    function relative__relativeTime (number, withoutSuffix, string, isFuture) {\n        var output = this._relativeTime[string];\n        return (typeof output === 'function') ?\n            output(number, withoutSuffix, string, isFuture) :\n            output.replace(/%d/i, number);\n    }\n\n    function pastFuture (diff, output) {\n        var format = this._relativeTime[diff > 0 ? 'future' : 'past'];\n        return typeof format === 'function' ? format(output) : format.replace(/%s/i, output);\n    }\n\n    function locale_set__set (config) {\n        var prop, i;\n        for (i in config) {\n            prop = config[i];\n            if (typeof prop === 'function') {\n                this[i] = prop;\n            } else {\n                this['_' + i] = prop;\n            }\n        }\n        // Lenient ordinal parsing accepts just a number in addition to\n        // number + (possibly) stuff coming from _ordinalParseLenient.\n        this._ordinalParseLenient = new RegExp(this._ordinalParse.source + '|' + /\\d{1,2}/.source);\n    }\n\n    var prototype__proto = Locale.prototype;\n\n    prototype__proto._calendar       = defaultCalendar;\n    prototype__proto.calendar        = locale_calendar__calendar;\n    prototype__proto._longDateFormat = defaultLongDateFormat;\n    prototype__proto.longDateFormat  = longDateFormat;\n    prototype__proto._invalidDate    = defaultInvalidDate;\n    prototype__proto.invalidDate     = invalidDate;\n    prototype__proto._ordinal        = defaultOrdinal;\n    prototype__proto.ordinal         = ordinal;\n    prototype__proto._ordinalParse   = defaultOrdinalParse;\n    prototype__proto.preparse        = preParsePostFormat;\n    prototype__proto.postformat      = preParsePostFormat;\n    prototype__proto._relativeTime   = defaultRelativeTime;\n    prototype__proto.relativeTime    = relative__relativeTime;\n    prototype__proto.pastFuture      = pastFuture;\n    prototype__proto.set             = locale_set__set;\n\n    // Month\n    prototype__proto.months       =        localeMonths;\n    prototype__proto._months      = defaultLocaleMonths;\n    prototype__proto.monthsShort  =        localeMonthsShort;\n    prototype__proto._monthsShort = defaultLocaleMonthsShort;\n    prototype__proto.monthsParse  =        localeMonthsParse;\n\n    // Week\n    prototype__proto.week = localeWeek;\n    prototype__proto._week = defaultLocaleWeek;\n    prototype__proto.firstDayOfYear = localeFirstDayOfYear;\n    prototype__proto.firstDayOfWeek = localeFirstDayOfWeek;\n\n    // Day of Week\n    prototype__proto.weekdays       =        localeWeekdays;\n    prototype__proto._weekdays      = defaultLocaleWeekdays;\n    prototype__proto.weekdaysMin    =        localeWeekdaysMin;\n    prototype__proto._weekdaysMin   = defaultLocaleWeekdaysMin;\n    prototype__proto.weekdaysShort  =        localeWeekdaysShort;\n    prototype__proto._weekdaysShort = defaultLocaleWeekdaysShort;\n    prototype__proto.weekdaysParse  =        localeWeekdaysParse;\n\n    // Hours\n    prototype__proto.isPM = localeIsPM;\n    prototype__proto._meridiemParse = defaultLocaleMeridiemParse;\n    prototype__proto.meridiem = localeMeridiem;\n\n    function lists__get (format, index, field, setter) {\n        var locale = locale_locales__getLocale();\n        var utc = create_utc__createUTC().set(setter, index);\n        return locale[field](utc, format);\n    }\n\n    function list (format, index, field, count, setter) {\n        if (typeof format === 'number') {\n            index = format;\n            format = undefined;\n        }\n\n        format = format || '';\n\n        if (index != null) {\n            return lists__get(format, index, field, setter);\n        }\n\n        var i;\n        var out = [];\n        for (i = 0; i < count; i++) {\n            out[i] = lists__get(format, i, field, setter);\n        }\n        return out;\n    }\n\n    function lists__listMonths (format, index) {\n        return list(format, index, 'months', 12, 'month');\n    }\n\n    function lists__listMonthsShort (format, index) {\n        return list(format, index, 'monthsShort', 12, 'month');\n    }\n\n    function lists__listWeekdays (format, index) {\n        return list(format, index, 'weekdays', 7, 'day');\n    }\n\n    function lists__listWeekdaysShort (format, index) {\n        return list(format, index, 'weekdaysShort', 7, 'day');\n    }\n\n    function lists__listWeekdaysMin (format, index) {\n        return list(format, index, 'weekdaysMin', 7, 'day');\n    }\n\n    locale_locales__getSetGlobalLocale('en', {\n        ordinalParse: /\\d{1,2}(th|st|nd|rd)/,\n        ordinal : function (number) {\n            var b = number % 10,\n                output = (toInt(number % 100 / 10) === 1) ? 'th' :\n                (b === 1) ? 'st' :\n                (b === 2) ? 'nd' :\n                (b === 3) ? 'rd' : 'th';\n            return number + output;\n        }\n    });\n\n    // Side effect imports\n    utils_hooks__hooks.lang = deprecate('moment.lang is deprecated. Use moment.locale instead.', locale_locales__getSetGlobalLocale);\n    utils_hooks__hooks.langData = deprecate('moment.langData is deprecated. Use moment.localeData instead.', locale_locales__getLocale);\n\n    var mathAbs = Math.abs;\n\n    function duration_abs__abs () {\n        var data           = this._data;\n\n        this._milliseconds = mathAbs(this._milliseconds);\n        this._days         = mathAbs(this._days);\n        this._months       = mathAbs(this._months);\n\n        data.milliseconds  = mathAbs(data.milliseconds);\n        data.seconds       = mathAbs(data.seconds);\n        data.minutes       = mathAbs(data.minutes);\n        data.hours         = mathAbs(data.hours);\n        data.months        = mathAbs(data.months);\n        data.years         = mathAbs(data.years);\n\n        return this;\n    }\n\n    function duration_add_subtract__addSubtract (duration, input, value, direction) {\n        var other = create__createDuration(input, value);\n\n        duration._milliseconds += direction * other._milliseconds;\n        duration._days         += direction * other._days;\n        duration._months       += direction * other._months;\n\n        return duration._bubble();\n    }\n\n    // supports only 2.0-style add(1, 's') or add(duration)\n    function duration_add_subtract__add (input, value) {\n        return duration_add_subtract__addSubtract(this, input, value, 1);\n    }\n\n    // supports only 2.0-style subtract(1, 's') or subtract(duration)\n    function duration_add_subtract__subtract (input, value) {\n        return duration_add_subtract__addSubtract(this, input, value, -1);\n    }\n\n    function bubble () {\n        var milliseconds = this._milliseconds;\n        var days         = this._days;\n        var months       = this._months;\n        var data         = this._data;\n        var seconds, minutes, hours, years = 0;\n\n        // The following code bubbles up values, see the tests for\n        // examples of what that means.\n        data.milliseconds = milliseconds % 1000;\n\n        seconds           = absFloor(milliseconds / 1000);\n        data.seconds      = seconds % 60;\n\n        minutes           = absFloor(seconds / 60);\n        data.minutes      = minutes % 60;\n\n        hours             = absFloor(minutes / 60);\n        data.hours        = hours % 24;\n\n        days += absFloor(hours / 24);\n\n        // Accurately convert days to years, assume start from year 0.\n        years = absFloor(daysToYears(days));\n        days -= absFloor(yearsToDays(years));\n\n        // 30 days to a month\n        // TODO (iskren): Use anchor date (like 1st Jan) to compute this.\n        months += absFloor(days / 30);\n        days   %= 30;\n\n        // 12 months -> 1 year\n        years  += absFloor(months / 12);\n        months %= 12;\n\n        data.days   = days;\n        data.months = months;\n        data.years  = years;\n\n        return this;\n    }\n\n    function daysToYears (days) {\n        // 400 years have 146097 days (taking into account leap year rules)\n        return days * 400 / 146097;\n    }\n\n    function yearsToDays (years) {\n        // years * 365 + absFloor(years / 4) -\n        //     absFloor(years / 100) + absFloor(years / 400);\n        return years * 146097 / 400;\n    }\n\n    function as (units) {\n        var days;\n        var months;\n        var milliseconds = this._milliseconds;\n\n        units = normalizeUnits(units);\n\n        if (units === 'month' || units === 'year') {\n            days   = this._days   + milliseconds / 864e5;\n            months = this._months + daysToYears(days) * 12;\n            return units === 'month' ? months : months / 12;\n        } else {\n            // handle milliseconds separately because of floating point math errors (issue #1867)\n            days = this._days + Math.round(yearsToDays(this._months / 12));\n            switch (units) {\n                case 'week'   : return days / 7            + milliseconds / 6048e5;\n                case 'day'    : return days                + milliseconds / 864e5;\n                case 'hour'   : return days * 24           + milliseconds / 36e5;\n                case 'minute' : return days * 24 * 60      + milliseconds / 6e4;\n                case 'second' : return days * 24 * 60 * 60 + milliseconds / 1000;\n                // Math.floor prevents floating point math errors here\n                case 'millisecond': return Math.floor(days * 24 * 60 * 60 * 1000) + milliseconds;\n                default: throw new Error('Unknown unit ' + units);\n            }\n        }\n    }\n\n    // TODO: Use this.as('ms')?\n    function duration_as__valueOf () {\n        return (\n            this._milliseconds +\n            this._days * 864e5 +\n            (this._months % 12) * 2592e6 +\n            toInt(this._months / 12) * 31536e6\n        );\n    }\n\n    function makeAs (alias) {\n        return function () {\n            return this.as(alias);\n        };\n    }\n\n    var asMilliseconds = makeAs('ms');\n    var asSeconds      = makeAs('s');\n    var asMinutes      = makeAs('m');\n    var asHours        = makeAs('h');\n    var asDays         = makeAs('d');\n    var asWeeks        = makeAs('w');\n    var asMonths       = makeAs('M');\n    var asYears        = makeAs('y');\n\n    function duration_get__get (units) {\n        units = normalizeUnits(units);\n        return this[units + 's']();\n    }\n\n    function makeGetter(name) {\n        return function () {\n            return this._data[name];\n        };\n    }\n\n    var duration_get__milliseconds = makeGetter('milliseconds');\n    var seconds      = makeGetter('seconds');\n    var minutes      = makeGetter('minutes');\n    var hours        = makeGetter('hours');\n    var days         = makeGetter('days');\n    var months       = makeGetter('months');\n    var years        = makeGetter('years');\n\n    function weeks () {\n        return absFloor(this.days() / 7);\n    }\n\n    var round = Math.round;\n    var thresholds = {\n        s: 45,  // seconds to minute\n        m: 45,  // minutes to hour\n        h: 22,  // hours to day\n        d: 26,  // days to month\n        M: 11   // months to year\n    };\n\n    // helper function for moment.fn.from, moment.fn.fromNow, and moment.duration.fn.humanize\n    function substituteTimeAgo(string, number, withoutSuffix, isFuture, locale) {\n        return locale.relativeTime(number || 1, !!withoutSuffix, string, isFuture);\n    }\n\n    function duration_humanize__relativeTime (posNegDuration, withoutSuffix, locale) {\n        var duration = create__createDuration(posNegDuration).abs();\n        var seconds  = round(duration.as('s'));\n        var minutes  = round(duration.as('m'));\n        var hours    = round(duration.as('h'));\n        var days     = round(duration.as('d'));\n        var months   = round(duration.as('M'));\n        var years    = round(duration.as('y'));\n\n        var a = seconds < thresholds.s && ['s', seconds]  ||\n                minutes === 1          && ['m']           ||\n                minutes < thresholds.m && ['mm', minutes] ||\n                hours   === 1          && ['h']           ||\n                hours   < thresholds.h && ['hh', hours]   ||\n                days    === 1          && ['d']           ||\n                days    < thresholds.d && ['dd', days]    ||\n                months  === 1          && ['M']           ||\n                months  < thresholds.M && ['MM', months]  ||\n                years   === 1          && ['y']           || ['yy', years];\n\n        a[2] = withoutSuffix;\n        a[3] = +posNegDuration > 0;\n        a[4] = locale;\n        return substituteTimeAgo.apply(null, a);\n    }\n\n    // This function allows you to set a threshold for relative time strings\n    function duration_humanize__getSetRelativeTimeThreshold (threshold, limit) {\n        if (thresholds[threshold] === undefined) {\n            return false;\n        }\n        if (limit === undefined) {\n            return thresholds[threshold];\n        }\n        thresholds[threshold] = limit;\n        return true;\n    }\n\n    function humanize (withSuffix) {\n        var locale = this.localeData();\n        var output = duration_humanize__relativeTime(this, !withSuffix, locale);\n\n        if (withSuffix) {\n            output = locale.pastFuture(+this, output);\n        }\n\n        return locale.postformat(output);\n    }\n\n    var iso_string__abs = Math.abs;\n\n    function iso_string__toISOString() {\n        // inspired by https://github.com/dordille/moment-isoduration/blob/master/moment.isoduration.js\n        var Y = iso_string__abs(this.years());\n        var M = iso_string__abs(this.months());\n        var D = iso_string__abs(this.days());\n        var h = iso_string__abs(this.hours());\n        var m = iso_string__abs(this.minutes());\n        var s = iso_string__abs(this.seconds() + this.milliseconds() / 1000);\n        var total = this.asSeconds();\n\n        if (!total) {\n            // this is the same as C#'s (Noda) and python (isodate)...\n            // but not other JS (goog.date)\n            return 'P0D';\n        }\n\n        return (total < 0 ? '-' : '') +\n            'P' +\n            (Y ? Y + 'Y' : '') +\n            (M ? M + 'M' : '') +\n            (D ? D + 'D' : '') +\n            ((h || m || s) ? 'T' : '') +\n            (h ? h + 'H' : '') +\n            (m ? m + 'M' : '') +\n            (s ? s + 'S' : '');\n    }\n\n    var duration_prototype__proto = Duration.prototype;\n\n    duration_prototype__proto.abs            = duration_abs__abs;\n    duration_prototype__proto.add            = duration_add_subtract__add;\n    duration_prototype__proto.subtract       = duration_add_subtract__subtract;\n    duration_prototype__proto.as             = as;\n    duration_prototype__proto.asMilliseconds = asMilliseconds;\n    duration_prototype__proto.asSeconds      = asSeconds;\n    duration_prototype__proto.asMinutes      = asMinutes;\n    duration_prototype__proto.asHours        = asHours;\n    duration_prototype__proto.asDays         = asDays;\n    duration_prototype__proto.asWeeks        = asWeeks;\n    duration_prototype__proto.asMonths       = asMonths;\n    duration_prototype__proto.asYears        = asYears;\n    duration_prototype__proto.valueOf        = duration_as__valueOf;\n    duration_prototype__proto._bubble        = bubble;\n    duration_prototype__proto.get            = duration_get__get;\n    duration_prototype__proto.milliseconds   = duration_get__milliseconds;\n    duration_prototype__proto.seconds        = seconds;\n    duration_prototype__proto.minutes        = minutes;\n    duration_prototype__proto.hours          = hours;\n    duration_prototype__proto.days           = days;\n    duration_prototype__proto.weeks          = weeks;\n    duration_prototype__proto.months         = months;\n    duration_prototype__proto.years          = years;\n    duration_prototype__proto.humanize       = humanize;\n    duration_prototype__proto.toISOString    = iso_string__toISOString;\n    duration_prototype__proto.toString       = iso_string__toISOString;\n    duration_prototype__proto.toJSON         = iso_string__toISOString;\n    duration_prototype__proto.locale         = locale;\n    duration_prototype__proto.localeData     = localeData;\n\n    // Deprecations\n    duration_prototype__proto.toIsoString = deprecate('toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)', iso_string__toISOString);\n    duration_prototype__proto.lang = lang;\n\n    // Side effect imports\n\n    addFormatToken('X', 0, 0, 'unix');\n    addFormatToken('x', 0, 0, 'valueOf');\n\n    // PARSING\n\n    addRegexToken('x', matchSigned);\n    addRegexToken('X', matchTimestamp);\n    addParseToken('X', function (input, array, config) {\n        config._d = new Date(parseFloat(input, 10) * 1000);\n    });\n    addParseToken('x', function (input, array, config) {\n        config._d = new Date(toInt(input));\n    });\n\n    // Side effect imports\n\n\n    utils_hooks__hooks.version = '2.10.2';\n\n    setHookCallback(local__createLocal);\n\n    utils_hooks__hooks.fn                    = momentPrototype;\n    utils_hooks__hooks.min                   = min;\n    utils_hooks__hooks.max                   = max;\n    utils_hooks__hooks.utc                   = create_utc__createUTC;\n    utils_hooks__hooks.unix                  = moment__createUnix;\n    utils_hooks__hooks.months                = lists__listMonths;\n    utils_hooks__hooks.isDate                = isDate;\n    utils_hooks__hooks.locale                = locale_locales__getSetGlobalLocale;\n    utils_hooks__hooks.invalid               = valid__createInvalid;\n    utils_hooks__hooks.duration              = create__createDuration;\n    utils_hooks__hooks.isMoment              = isMoment;\n    utils_hooks__hooks.weekdays              = lists__listWeekdays;\n    utils_hooks__hooks.parseZone             = moment__createInZone;\n    utils_hooks__hooks.localeData            = locale_locales__getLocale;\n    utils_hooks__hooks.isDuration            = isDuration;\n    utils_hooks__hooks.monthsShort           = lists__listMonthsShort;\n    utils_hooks__hooks.weekdaysMin           = lists__listWeekdaysMin;\n    utils_hooks__hooks.defineLocale          = defineLocale;\n    utils_hooks__hooks.weekdaysShort         = lists__listWeekdaysShort;\n    utils_hooks__hooks.normalizeUnits        = normalizeUnits;\n    utils_hooks__hooks.relativeTimeThreshold = duration_humanize__getSetRelativeTimeThreshold;\n\n    var _moment = utils_hooks__hooks;\n\n    return _moment;\n\n}));","/*\n * zClip :: jQuery ZeroClipboard v1.1.1\n * http://steamdev.com/zclip\n *\n * Copyright 2011, SteamDev\n * Released under the MIT license.\n * http://www.opensource.org/licenses/mit-license.php\n *\n * Date: Wed Jun 01, 2011\n */\n\n(function(a){a.fn.zclip=function(c){if(typeof c==\"object\"&&!c.length){var b=a.extend({path:\"/javascripts/plugins/ZeroClipboard.swf\",copy:null,beforeCopy:null,afterCopy:null,clickAfter:true,setHandCursor:true,setCSSEffects:true},c);return this.each(function(){var e=a(this);if(e.is(\":visible\")&&(typeof b.copy==\"string\"||a.isFunction(b.copy))){ZeroClipboard.setMoviePath(b.path);var d=new ZeroClipboard.Client();if(a.isFunction(b.copy)){e.bind(\"zClip_copy\",b.copy)}if(a.isFunction(b.beforeCopy)){e.bind(\"zClip_beforeCopy\",b.beforeCopy)}if(a.isFunction(b.afterCopy)){e.bind(\"zClip_afterCopy\",b.afterCopy)}d.setHandCursor(b.setHandCursor);d.setCSSEffects(b.setCSSEffects);d.addEventListener(\"mouseOver\",function(f){e.trigger(\"mouseenter\")});d.addEventListener(\"mouseOut\",function(f){e.trigger(\"mouseleave\")});d.addEventListener(\"mouseDown\",function(f){e.trigger(\"mousedown\");if(!a.isFunction(b.copy)){d.setText(b.copy)}else{d.setText(e.triggerHandler(\"zClip_copy\"))}if(a.isFunction(b.beforeCopy)){e.trigger(\"zClip_beforeCopy\")}});d.addEventListener(\"complete\",function(f,g){if(a.isFunction(b.afterCopy)){e.trigger(\"zClip_afterCopy\")}else{if(g.length>500){g=g.substr(0,500)+\"...\\n\\n(\"+(g.length-500)+\" characters not shown)\"}e.removeClass(\"hover\");}if(b.clickAfter){e.trigger(\"click\")}});d.glue(e[0],e.parent()[0]);a(window).bind(\"load resize\",function(){d.reposition()})}})}else{if(typeof c==\"string\"){return this.each(function(){var f=a(this);c=c.toLowerCase();var e=f.data(\"zclipId\");var d=a(\"#\"+e+\".zclip\");if(c==\"remove\"){d.remove();f.removeClass(\"active hover\")}else{if(c==\"hide\"){d.hide();f.removeClass(\"active hover\")}else{if(c==\"show\"){d.show()}}}})}}}})(jQuery);var ZeroClipboard={version:\"1.0.7\",clients:{},moviePath:\"ZeroClipboard.swf\",nextId:1,$:function(a){if(typeof(a)==\"string\"){a=document.getElementById(a)}if(!a.addClass){a.hide=function(){this.style.display=\"none\"};a.show=function(){this.style.display=\"\"};a.addClass=function(b){this.removeClass(b);this.className+=\" \"+b};a.removeClass=function(d){var e=this.className.split(/\\s+/);var b=-1;for(var c=0;c<e.length;c++){if(e[c]==d){b=c;c=e.length}}if(b>-1){e.splice(b,1);this.className=e.join(\" \")}return this};a.hasClass=function(b){return !!this.className.match(new RegExp(\"\\\\s*\"+b+\"\\\\s*\"))}}return a},setMoviePath:function(a){this.moviePath=a},dispatch:function(d,b,c){var a=this.clients[d];if(a){a.receiveEvent(b,c)}},register:function(b,a){this.clients[b]=a},getDOMObjectPosition:function(c,a){var b={left:0,top:0,width:c.width?c.width:c.offsetWidth,height:c.height?c.height:c.offsetHeight};if(c&&(c!=a)){b.left+=c.offsetLeft;b.top+=c.offsetTop}return b},Client:function(a){this.handlers={};this.id=ZeroClipboard.nextId++;this.movieId=\"ZeroClipboardMovie_\"+this.id;ZeroClipboard.register(this.id,this);if(a){this.glue(a)}}};ZeroClipboard.Client.prototype={id:0,ready:false,movie:null,clipText:\"\",handCursorEnabled:true,cssEffects:true,handlers:null,glue:function(d,b,e){this.domElement=ZeroClipboard.$(d);var f=99;if(this.domElement.style.zIndex){f=parseInt(this.domElement.style.zIndex,10)+1}if(typeof(b)==\"string\"){b=ZeroClipboard.$(b)}else{if(typeof(b)==\"undefined\"){b=document.getElementsByTagName(\"body\")[0]}}var c=ZeroClipboard.getDOMObjectPosition(this.domElement,b);this.div=document.createElement(\"div\");this.div.className=\"zclip\";this.div.id=\"zclip-\"+this.movieId;$(this.domElement).data(\"zclipId\",\"zclip-\"+this.movieId);var a=this.div.style;a.position=\"absolute\";a.left=\"\"+c.left+\"px\";a.top=\"\"+c.top+\"px\";a.width=\"\"+c.width+\"px\";a.height=\"\"+c.height+\"px\";a.zIndex=f;if(typeof(e)==\"object\"){for(addedStyle in e){a[addedStyle]=e[addedStyle]}}b.appendChild(this.div);this.div.innerHTML=this.getHTML(c.width,c.height)},getHTML:function(d,a){var c=\"\";var b=\"id=\"+this.id+\"&width=\"+d+\"&height=\"+a;if(navigator.userAgent.match(/MSIE/)){var e=location.href.match(/^https/i)?\"https://\":\"http://\";c+='<object classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\" codebase=\"'+e+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0\" width=\"'+d+'\" height=\"'+a+'\" id=\"'+this.movieId+'\" align=\"middle\"><param name=\"allowScriptAccess\" value=\"always\" /><param name=\"allowFullScreen\" value=\"false\" /><param name=\"movie\" value=\"'+ZeroClipboard.moviePath+'\" /><param name=\"loop\" value=\"false\" /><param name=\"menu\" value=\"false\" /><param name=\"quality\" value=\"best\" /><param name=\"bgcolor\" value=\"#ffffff\" /><param name=\"flashvars\" value=\"'+b+'\"/><param name=\"wmode\" value=\"transparent\"/></object>'}else{c+='<embed id=\"'+this.movieId+'\" src=\"'+ZeroClipboard.moviePath+'\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\"'+d+'\" height=\"'+a+'\" name=\"'+this.movieId+'\" align=\"middle\" allowScriptAccess=\"always\" allowFullScreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\"'+b+'\" wmode=\"transparent\" />'}return c},hide:function(){if(this.div){this.div.style.left=\"-2000px\"}},show:function(){this.reposition()},destroy:function(){if(this.domElement&&this.div){this.hide();this.div.innerHTML=\"\";var a=document.getElementsByTagName(\"body\")[0];try{a.removeChild(this.div)}catch(b){}this.domElement=null;this.div=null}},reposition:function(c){if(c){this.domElement=ZeroClipboard.$(c);if(!this.domElement){this.hide()}}if(this.domElement&&this.div){var b=ZeroClipboard.getDOMObjectPosition(this.domElement);var a=this.div.style;a.left=\"\"+b.left+\"px\";a.top=\"\"+b.top+\"px\"}},setText:function(a){this.clipText=a;if(this.ready){this.movie.setText(a)}},addEventListener:function(a,b){a=a.toString().toLowerCase().replace(/^on/,\"\");if(!this.handlers[a]){this.handlers[a]=[]}this.handlers[a].push(b)},setHandCursor:function(a){this.handCursorEnabled=a;if(this.ready){this.movie.setHandCursor(a)}},setCSSEffects:function(a){this.cssEffects=!!a},receiveEvent:function(d,f){d=d.toString().toLowerCase().replace(/^on/,\"\");switch(d){case\"load\":this.movie=document.getElementById(this.movieId);if(!this.movie){var c=this;setTimeout(function(){c.receiveEvent(\"load\",null)},1);return}if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/)){var c=this;setTimeout(function(){c.receiveEvent(\"load\",null)},100);this.ready=true;return}this.ready=true;try{this.movie.setText(this.clipText)}catch(h){}try{this.movie.setHandCursor(this.handCursorEnabled)}catch(h){}break;case\"mouseover\":if(this.domElement&&this.cssEffects){this.domElement.addClass(\"hover\");if(this.recoverActive){this.domElement.addClass(\"active\")}}break;case\"mouseout\":if(this.domElement&&this.cssEffects){this.recoverActive=false;if(this.domElement.hasClass(\"active\")){this.domElement.removeClass(\"active\");this.recoverActive=true}this.domElement.removeClass(\"hover\")}break;case\"mousedown\":if(this.domElement&&this.cssEffects){this.domElement.addClass(\"active\")}break;case\"mouseup\":if(this.domElement&&this.cssEffects){this.domElement.removeClass(\"active\");this.recoverActive=false}break}if(this.handlers[d]){for(var b=0,a=this.handlers[d].length;b<a;b++){var g=this.handlers[d][b];if(typeof(g)==\"function\"){g(this,f)}else{if((typeof(g)==\"object\")&&(g.length==2)){g[0][g[1]](this,f)}else{if(typeof(g)==\"string\"){window[g](this,f)}}}}}}};","/*\n* jQuery UI Tag-it!\n*\n* @version v2.0 (06/2011)\n*\n* Copyright 2011, Levy Carneiro Jr.\n* Released under the MIT license.\n* http://aehlke.github.com/tag-it/LICENSE\n*\n* Homepage:\n*   http://aehlke.github.com/tag-it/\n*\n* Authors:\n*   Levy Carneiro Jr.\n*   Martin Rehfeld\n*   Tobias Schmidt\n*   Skylar Challand\n*   Alex Ehlke\n*\n* Maintainer:\n*   Alex Ehlke - Twitter: @aehlke\n*\n* Dependencies:\n*   jQuery v1.4+\n*   jQuery UI v1.8+\n*/\n(function($) {\n\n    $.widget('ui.tagit', {\n        options: {\n            allowDuplicates   : false,\n            caseSensitive     : true,\n            fieldName         : 'tags',\n            placeholderText   : null,   // Sets `placeholder` attr on input field.\n            readOnly          : false,  // Disables editing.\n            removeConfirmation: false,  // Require confirmation to remove tags.\n            tagLimit          : null,   // Max number of tags allowed (null for unlimited).\n\n            // Used for autocomplete, unless you override `autocomplete.source`.\n            availableTags     : [],\n\n            // Use to override or add any options to the autocomplete widget.\n            //\n            // By default, autocomplete.source will map to availableTags,\n            // unless overridden.\n            autocomplete: {},\n\n            // Shows autocomplete before the user even types anything.\n            showAutocompleteOnFocus: false,\n\n            // When enabled, quotes are unneccesary for inputting multi-word tags.\n            allowSpaces: false,\n\n            // The below options are for using a single field instead of several\n            // for our form values.\n            //\n            // When enabled, will use a single hidden field for the form,\n            // rather than one per tag. It will delimit tags in the field\n            // with singleFieldDelimiter.\n            //\n            // The easiest way to use singleField is to just instantiate tag-it\n            // on an INPUT element, in which case singleField is automatically\n            // set to true, and singleFieldNode is set to that element. This\n            // way, you don't need to fiddle with these options.\n            singleField: false,\n\n            // This is just used when preloading data from the field, and for\n            // populating the field with delimited tags as the user adds them.\n            singleFieldDelimiter: ',',\n\n            // Set this to an input DOM node to use an existing form field.\n            // Any text in it will be erased on init. But it will be\n            // populated with the text of tags as they are created,\n            // delimited by singleFieldDelimiter.\n            //\n            // If this is not set, we create an input node for it,\n            // with the name given in settings.fieldName.\n            singleFieldNode: null,\n\n            // Whether to animate tag removals or not.\n            animate: true,\n\n            // Optionally set a tabindex attribute on the input that gets\n            // created for tag-it.\n            tabIndex: null,\n\n            // Event callbacks.\n            beforeTagAdded      : null,\n            afterTagAdded       : null,\n\n            beforeTagRemoved    : null,\n            afterTagRemoved     : null,\n\n            onTagClicked        : null,\n            onTagLimitExceeded  : null,\n\n\n            // DEPRECATED:\n            //\n            // /!\\ These event callbacks are deprecated and WILL BE REMOVED at some\n            // point in the future. They're here for backwards-compatibility.\n            // Use the above before/after event callbacks instead.\n            onTagAdded  : null,\n            onTagRemoved: null,\n            // `autocomplete.source` is the replacement for tagSource.\n            tagSource: null,\n            onSubmitTags: null,\n            onFocus: null,\n            onBlur: null\n            // Do not use the above deprecated options.\n        },\n\n        _create: function() {\n            // for handling static scoping inside callbacks\n            var that = this;\n\n            // There are 2 kinds of DOM nodes this widget can be instantiated on:\n            //     1. UL, OL, or some element containing either of these.\n            //     2. INPUT, in which case 'singleField' is overridden to true,\n            //        a UL is created and the INPUT is hidden.\n            if (this.element.is('input')) {\n                this.tagList = $('<ul></ul>').insertAfter(this.element);\n                this.options.singleField = true;\n                this.options.singleFieldNode = this.element;\n                this.element.addClass('tagit-hidden-field');\n            } else {\n                this.tagList = this.element.find('ul, ol').andSelf().last();\n            }\n\n            this.tagInput = $('<input type=\"text\" />').addClass('ui-widget-content');\n\n            if (this.options.readOnly) this.tagInput.attr('disabled', 'disabled');\n\n            if (this.options.tabIndex) {\n                this.tagInput.attr('tabindex', this.options.tabIndex);\n            }\n\n            if (this.options.placeholderText) {\n                this.tagInput.attr('placeholder', this.options.placeholderText);\n            }\n\n            if (!this.options.autocomplete.source) {\n                this.options.autocomplete.source = function(search, showChoices) {\n                    var filter = search.term.toLowerCase();\n                    var choices = $.grep(this.options.availableTags, function(element) {\n                        // Only match autocomplete options that begin with the search term.\n                        // (Case insensitive.)\n                        return (element.toLowerCase().indexOf(filter) === 0);\n                    });\n                    if (!this.options.allowDuplicates) {\n                        choices = this._subtractArray(choices, this.assignedTags());\n                    }\n                    showChoices(choices);\n                };\n            }\n\n            if (this.options.showAutocompleteOnFocus) {\n                this.tagInput.focus(function(event, ui) {\n                    that._showAutocomplete();\n                });\n\n                if (typeof this.options.autocomplete.minLength === 'undefined') {\n                    this.options.autocomplete.minLength = 0;\n                }\n            }\n\n            // Bind autocomplete.source callback functions to this context.\n            if ($.isFunction(this.options.autocomplete.source)) {\n                this.options.autocomplete.source = $.proxy(this.options.autocomplete.source, this);\n            }\n\n            // DEPRECATED.\n            if ($.isFunction(this.options.tagSource)) {\n                this.options.tagSource = $.proxy(this.options.tagSource, this);\n            }\n\n            this.tagList\n                .addClass('tagit')\n                .addClass('ui-widget ui-widget-content ui-corner-all')\n                // Create the input field.\n                .append($('<li class=\"tagit-new\"></li>').append(this.tagInput))\n                .click(function(e) {\n                    var target = $(e.target);\n                    if (target.hasClass('tagit-label')) {\n                        var tag = target.closest('.tagit-choice');\n                        if (!tag.hasClass('removed')) {\n                            that._trigger('onTagClicked', e, {tag: tag, tagLabel: that.tagLabel(tag)});\n                        }\n                    } else {\n                        // Sets the focus() to the input field, if the user\n                        // clicks anywhere inside the UL. This is needed\n                        // because the input field needs to be of a small size.\n                        that.tagInput.focus();\n                    }\n                });\n\n            // Single field support.\n            var addedExistingFromSingleFieldNode = false;\n            if (this.options.singleField) {\n                if (this.options.singleFieldNode) {\n                    // Add existing tags from the input field.\n                    var node = $(this.options.singleFieldNode);\n                    var tags = node.val().split(this.options.singleFieldDelimiter);\n                    node.val('');\n                    $.each(tags, function(index, tag) {\n                        that.createTag(tag, null, true);\n                        addedExistingFromSingleFieldNode = true;\n                    });\n                } else {\n                    // Create our single field input after our list.\n                    this.options.singleFieldNode = $('<input type=\"hidden\" style=\"display:none;\" value=\"\" name=\"' + this.options.fieldName + '\" />');\n                    this.tagList.after(this.options.singleFieldNode);\n                }\n            }\n\n            // Add existing tags from the list, if any.\n            if (!addedExistingFromSingleFieldNode) {\n                this.tagList.children('li').each(function() {\n                    if (!$(this).hasClass('tagit-new')) {\n                        that.createTag($(this).text(), $(this).attr('class'), true);\n                        $(this).remove();\n                    }\n                });\n            }\n\n            // Events.\n            this.tagInput\n                .keydown(function(event) {\n                    // Backspace is not detected within a keypress, so it must use keydown.\n                    if (event.which == $.ui.keyCode.BACKSPACE && that.tagInput.val() === '') {\n                        var tag = that._lastTag();\n                        if (!that.options.removeConfirmation || tag.hasClass('remove')) {\n                            // When backspace is pressed, the last tag is deleted.\n                            that.removeTag(tag);\n                        } else if (that.options.removeConfirmation) {\n                            tag.addClass('remove ui-state-highlight');\n                        }\n                    } else if (that.options.removeConfirmation) {\n                        that._lastTag().removeClass('remove ui-state-highlight');\n                    } else if (event.which == $.ui.keyCode.ENTER && that.tagInput.val() === \"\") {\n                        that._trigger('onSubmitTags', null, that.tagList);\n                    }\n\n                    // Comma/Space/Enter are all valid delimiters for new tags,\n                    // except when there is an open quote or if setting allowSpaces = true.\n                    // Tab will also create a tag, unless the tag input is empty,\n                    // in which case it isn't caught.\n                    if (\n                        (event.which === $.ui.keyCode.COMMA && event.shiftKey === false) ||\n                        event.which === $.ui.keyCode.ENTER ||\n                        (\n                            event.which == $.ui.keyCode.TAB &&\n                            that.tagInput.val() !== ''\n                        ) ||\n                        (\n                            event.which == $.ui.keyCode.SPACE &&\n                            that.options.allowSpaces !== true &&\n                            (\n                                $.trim(that.tagInput.val()).replace( /^s*/, '' ).charAt(0) != '\"' ||\n                                (\n                                    $.trim(that.tagInput.val()).charAt(0) == '\"' &&\n                                    $.trim(that.tagInput.val()).charAt($.trim(that.tagInput.val()).length - 1) == '\"' &&\n                                    $.trim(that.tagInput.val()).length - 1 !== 0\n                                )\n                            )\n                        )\n                    ) {\n                        // Enter submits the form if there's no text in the input.\n                        if (!(event.which === $.ui.keyCode.ENTER && that.tagInput.val() === '')) {\n                            event.preventDefault();\n                        }\n\n                        // Autocomplete will create its own tag from a selection and close automatically.\n                        if (!(that.options.autocomplete.autoFocus && that.tagInput.data('autocomplete-open'))) {\n                            that.tagInput.autocomplete('close');\n                            that.createTag(that._cleanedInput());\n                        }\n                    }\n                }).blur(function(e){\n                    that._trigger('onBlur', null, null);\n                    // Create a tag when the element loses focus.\n                    // If autocomplete is enabled and suggestion was clicked, don't add it.\n                    if (!that.tagInput.data('autocomplete-open')) {\n                        that.createTag(that._cleanedInput());\n                    }\n                }).focus(function(e) {\n                    that._trigger('onFocus', null, null);\n                })\n\n            // Autocomplete.\n            if (this.options.availableTags || this.options.tagSource || this.options.autocomplete.source) {\n                var autocompleteOptions = {\n                    select: function(event, ui) {\n                        that.createTag(ui.item.value);\n                        // Preventing the tag input to be updated with the chosen value.\n                        return false;\n                    }\n                };\n                $.extend(autocompleteOptions, this.options.autocomplete);\n\n                // tagSource is deprecated, but takes precedence here since autocomplete.source is set by default,\n                // while tagSource is left null by default.\n                autocompleteOptions.source = this.options.tagSource || autocompleteOptions.source;\n\n                this.tagInput.autocomplete(autocompleteOptions).bind('autocompleteopen.tagit', function(event, ui) {\n                    that.tagInput.data('autocomplete-open', true);\n                }).bind('autocompleteclose.tagit', function(event, ui) {\n                    that.tagInput.data('autocomplete-open', false);\n                });\n\n                this.tagInput.autocomplete('widget').addClass('tagit-autocomplete');\n            }\n        },\n\n        destroy: function() {\n            $.Widget.prototype.destroy.call(this);\n\n            this.element.unbind('.tagit');\n            this.tagList.unbind('.tagit');\n\n            this.tagInput.removeData('autocomplete-open');\n\n            this.tagList.removeClass([\n                'tagit',\n                'ui-widget',\n                'ui-widget-content',\n                'ui-corner-all',\n                'tagit-hidden-field'\n            ].join(' '));\n\n            if (this.element.is('input')) {\n                this.element.removeClass('tagit-hidden-field');\n                this.tagList.remove();\n            } else {\n                this.element.children('li').each(function() {\n                    if ($(this).hasClass('tagit-new')) {\n                        $(this).remove();\n                    } else {\n                        $(this).removeClass([\n                            'tagit-choice',\n                            'ui-widget-content',\n                            'ui-state-default',\n                            'ui-state-highlight',\n                            'ui-corner-all',\n                            'remove',\n                            'tagit-choice-editable',\n                            'tagit-choice-read-only'\n                        ].join(' '));\n\n                        $(this).text($(this).children('.tagit-label').text());\n                    }\n                });\n\n                if (this.singleFieldNode) {\n                    this.singleFieldNode.remove();\n                }\n            }\n\n            return this;\n        },\n\n        _cleanedInput: function() {\n            // Returns the contents of the tag input, cleaned and ready to be passed to createTag\n            return $.trim(this.tagInput.val().replace(/^\"(.*)\"$/, '$1'));\n        },\n\n        _lastTag: function() {\n            return this.tagList.find('.tagit-choice:last:not(.removed)');\n        },\n\n        _tags: function() {\n            return this.tagList.find('.tagit-choice:not(.removed)');\n        },\n\n        assignedTags: function() {\n            // Returns an array of tag string values\n            var that = this;\n            var tags = [];\n            if (this.options.singleField) {\n                tags = $(this.options.singleFieldNode).val().split(this.options.singleFieldDelimiter);\n                if (tags[0] === '') {\n                    tags = [];\n                }\n            } else {\n                this._tags().each(function() {\n                    tags.push(that.tagLabel(this));\n                });\n            }\n            return tags;\n        },\n\n        _updateSingleTagsField: function(tags) {\n            // Takes a list of tag string values, updates this.options.singleFieldNode.val to the tags delimited by this.options.singleFieldDelimiter\n            $(this.options.singleFieldNode).val(tags.join(this.options.singleFieldDelimiter)).trigger('change');\n        },\n\n        _subtractArray: function(a1, a2) {\n            var result = [];\n            for (var i = 0; i < a1.length; i++) {\n                if ($.inArray(a1[i], a2) == -1) {\n                    result.push(a1[i]);\n                }\n            }\n            return result;\n        },\n\n        tagLabel: function(tag) {\n            // Returns the tag's string label.\n            if (this.options.singleField) {\n                return $(tag).find('.tagit-label:first').text();\n            } else {\n                return $(tag).find('input:first').val();\n            }\n        },\n\n        _showAutocomplete: function() {\n            this.tagInput.autocomplete('search', '');\n        },\n\n        _findTagByLabel: function(name) {\n            var that = this;\n            var tag = null;\n            this._tags().each(function(i) {\n                if (that._formatStr(name) == that._formatStr(that.tagLabel(this))) {\n                    tag = $(this);\n                    return false;\n                }\n            });\n            return tag;\n        },\n\n        _isNew: function(name) {\n            return !this._findTagByLabel(name);\n        },\n\n        _formatStr: function(str) {\n            if (this.options.caseSensitive) {\n                return str;\n            }\n            return $.trim(str.toLowerCase());\n        },\n\n        _effectExists: function(name) {\n            return Boolean($.effects && ($.effects[name] || ($.effects.effect && $.effects.effect[name])));\n        },\n\n        createTag: function(value, additionalClass, duringInitialization) {\n            var that = this;\n\n            value = $.trim(value);\n\n            if(this.options.preprocessTag) {\n                value = this.options.preprocessTag(value);\n            }\n\n            if (value === '') {\n                return false;\n            }\n\n            if (!this.options.allowDuplicates && !this._isNew(value)) {\n                var existingTag = this._findTagByLabel(value);\n                if (this._trigger('onTagExists', null, {\n                    existingTag: existingTag,\n                    duringInitialization: duringInitialization\n                }) !== false) {\n                    if (this._effectExists('highlight')) {\n                        existingTag.effect('highlight');\n                    }\n                }\n                return false;\n            }\n\n            if (this.options.tagLimit && this._tags().length >= this.options.tagLimit) {\n                this._trigger('onTagLimitExceeded', null, {duringInitialization: duringInitialization});\n                return false;\n            }\n\n            var label = $(this.options.onTagClicked ? '<a class=\"tagit-label\"></a>' : '<span class=\"tagit-label\"></span>').text(value);\n\n            // Create tag.\n            var tag = $('<li></li>')\n                .addClass('tagit-choice ui-widget-content ui-state-default ui-corner-all')\n                .addClass(additionalClass)\n                .append(label);\n\n            if (this.options.readOnly){\n                tag.addClass('tagit-choice-read-only');\n            } else {\n                tag.addClass('tagit-choice-editable');\n                // Button for removing the tag.\n                var removeTagIcon = $('<span></span>')\n                    .addClass('ui-icon ui-icon-close');\n                var removeTag = $('<a><span class=\"text-icon\">\\xd7</span></a>') // \\xd7 is an X\n                    .addClass('tagit-close')\n                    .append(removeTagIcon)\n                    .click(function(e) {\n                        // Removes a tag when the little 'x' is clicked.\n                        that.removeTag(tag);\n                    });\n                tag.append(removeTag);\n            }\n\n            // Unless options.singleField is set, each tag has a hidden input field inline.\n            if (!this.options.singleField) {\n                var escapedValue = label.html();\n                tag.append('<input type=\"hidden\" value=\"' + escapedValue + '\" name=\"' + this.options.fieldName + '\" class=\"tagit-hidden-field\" />');\n            }\n\n            if (this._trigger('beforeTagAdded', null, {\n                tag: tag,\n                tagLabel: this.tagLabel(tag),\n                duringInitialization: duringInitialization\n            }) === false) {\n                return;\n            }\n\n            if (this.options.singleField) {\n                var tags = this.assignedTags();\n                tags.push(value);\n                this._updateSingleTagsField(tags);\n            }\n\n            // DEPRECATED.\n            this._trigger('onTagAdded', null, tag);\n\n            this.tagInput.val('');\n\n            // Insert tag.\n            this.tagInput.parent().before(tag);\n\n            this._trigger('afterTagAdded', null, {\n                tag: tag,\n                tagLabel: this.tagLabel(tag),\n                duringInitialization: duringInitialization\n            });\n\n            if (this.options.showAutocompleteOnFocus && !duringInitialization) {\n                setTimeout(function () { that._showAutocomplete(); }, 0);\n            }\n        },\n\n        removeTag: function(tag, animate) {\n            animate = typeof animate === 'undefined' ? this.options.animate : animate;\n\n            tag = $(tag);\n\n            // DEPRECATED.\n            this._trigger('onTagRemoved', null, tag);\n\n            if (this._trigger('beforeTagRemoved', null, {tag: tag, tagLabel: this.tagLabel(tag)}) === false) {\n                return;\n            }\n\n            if (this.options.singleField) {\n                var tags = this.assignedTags();\n                var removedTagLabel = this.tagLabel(tag);\n                tags = $.grep(tags, function(el){\n                    return el != removedTagLabel;\n                });\n                this._updateSingleTagsField(tags);\n            }\n\n            if (animate) {\n                tag.addClass('removed'); // Excludes this tag from _tags.\n                var hide_args = this._effectExists('blind') ? ['blind', {direction: 'horizontal'}, 'fast'] : ['fast'];\n\n                var thisTag = this;\n                hide_args.push(function() {\n                    tag.remove();\n                    thisTag._trigger('afterTagRemoved', null, {tag: tag, tagLabel: thisTag.tagLabel(tag)});\n                });\n\n                tag.fadeOut('fast').hide.apply(tag, hide_args).dequeue();\n            } else {\n                tag.remove();\n                this._trigger('afterTagRemoved', null, {tag: tag, tagLabel: this.tagLabel(tag)});\n            }\n\n        },\n\n        removeTagByLabel: function(tagLabel, animate) {\n            var toRemove = this._findTagByLabel(tagLabel);\n            if (!toRemove) {\n                throw \"No such tag exists with the name '\" + tagLabel + \"'\";\n            }\n            this.removeTag(toRemove, animate);\n        },\n\n        removeAll: function() {\n            // Removes all tags.\n            var that = this;\n            this._tags().each(function(index, tag) {\n                that.removeTag(tag, false);\n            });\n        }\n\n    });\n})(jQuery);\n","// tipsy, facebook style tooltips for jquery with fancy fading\n// version 1.0.0a\n// (c) 2008-2010 jason frame [jason@onehackoranother.com] and modificated by Sergio Alvarez @saleiva\n// released under the MIT license\n//\n//  Changes:\n//  April 27 2016: fixed problem with element size.\n//  June 3 2013: Added the custom class before the calc of the position.\n\n(function($) {\n\n  var MOVE_OFFSET = 6;\n\n  function maybeCall(thing, ctx) {\n    return (typeof thing == 'function') ? (thing.call(ctx)) : thing;\n  };\n\n  function isElementInDOM(ele) {\n    while (ele = ele.parentNode) {\n      if (ele == document) return true;\n    }\n    return false;\n  };\n\n  function Tipsy(element, options) {\n    this.$element = $(element);\n    this.options = options;\n    this.enabled = true;\n    this.fixTitle();\n  };\n\n  Tipsy.prototype = {\n    show: function() {\n      var title = this.getTitle();\n      if (title && this.enabled) {\n        var $tip = this.tip();\n\n        $tip.find('.tipsy-inner')[this.options.html ? 'html' : 'text'](title);\n            $tip[0].className = 'tipsy'; // reset classname in case of dynamic gravity\n            $tip.remove().css({top: 0, left: 0, visibility: 'hidden', display: 'block'}).prependTo(document.body);\n\n            // Modified so we can use custom class names\n            if (this.options.className) {\n              $tip.addClass(maybeCall(this.options.className, this.$element[0]));\n            }\n\n            // Modified\n            var pos = $.extend({}, this.$element.offset(), {\n              width: this.$element[0].getBoundingClientRect().width,\n              height: this.$element[0].getBoundingClientRect().height\n            });\n\n            var actualWidth = $tip[0].offsetWidth,\n            actualHeight = $tip[0].offsetHeight,\n            gravity = maybeCall(this.options.gravity, this.$element[0]);\n\n            var tp;\n            switch (gravity.charAt(0)) {\n              case 'n':\n              tp = {top: pos.top + pos.height + this.options.offset, left: pos.left + pos.width / 2 - actualWidth / 2};\n              mo = {top: parseInt(pos.top + pos.height + this.options.offset + MOVE_OFFSET), opacity: this.options.opacity};\n              break;\n              case 's':\n              tp = {top: pos.top - actualHeight - this.options.offset, left: pos.left + pos.width / 2 - actualWidth / 2};\n              mo = {top: parseInt(pos.top - actualHeight - this.options.offset - MOVE_OFFSET), opacity: this.options.opacity};\n              break;\n              case 'e':\n              tp = {top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left - actualWidth - this.options.offset};\n              mo = {left: parseInt(pos.left - actualWidth - this.options.offset - MOVE_OFFSET), opacity: this.options.opacity};\n              break;\n              case 'w':\n              tp = {top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left + pos.width + this.options.offset};\n              mo = {left: parseInt(pos.left + pos.width + this.options.offset + MOVE_OFFSET), opacity: this.options.opacity};\n              break;\n            }\n\n            if (gravity.length == 2) {\n              if (gravity.charAt(1) == 'w') {\n                tp.left = pos.left + pos.width / 2 - 15;\n              } else {\n                tp.left = pos.left + pos.width / 2 - actualWidth + 15;\n              }\n            }\n\n            $tip.css(tp).addClass('tipsy-' + gravity);\n            $tip.find('.tipsy-arrow')[0].className = 'tipsy-arrow tipsy-arrow-' + gravity.charAt(0);\n\n            if (this.options.fade) {\n              $tip.stop().css({opacity: 0, display: 'block', visibility: 'visible'}).animate(mo, 200);\n            } else {\n              $tip.css({visibility: 'visible', opacity: this.options.opacity});\n            }\n          }\n        },\n\n        hide: function() {\n\n          gravity = maybeCall(this.options.gravity, this.$element[0]);\n\n          switch (gravity.charAt(0)) {\n            case 'n':\n            mo = {top: parseInt(this.tip().css(\"top\")) + MOVE_OFFSET, opacity: 0};\n            break;\n            case 's':\n            mo = {top: parseInt(this.tip().css(\"top\")) - MOVE_OFFSET, opacity: 0};\n            break;\n            case 'e':\n            mo = {left: parseInt(this.tip().css(\"left\")) - MOVE_OFFSET, opacity: 0};\n            break;\n            case 'w':\n            mo = {left: parseInt(this.tip().css(\"left\")) + MOVE_OFFSET, opacity: 0};\n            break;\n          }\n\n          if (this.options.fade) {\n            this.tip().stop().animate(mo, 200, function(){$(this).remove();});\n          } else {\n            this.tip().remove();\n          }\n        },\n\n        fixTitle: function() {\n          var $e = this.$element;\n          if ($e.attr('title') || typeof($e.attr('original-title')) != 'string') {\n            $e.attr('original-title', $e.attr('title') || '').removeAttr('title');\n          }\n        },\n\n        getTitle: function() {\n          var title, $e = this.$element, o = this.options;\n          this.fixTitle();\n          var title, o = this.options;\n          if (typeof o.title == 'string') {\n            title = $e.attr(o.title == 'title' ? 'original-title' : o.title);\n          } else if (typeof o.title == 'function') {\n            title = o.title.call($e[0]);\n          }\n          title = ('' + title).replace(/(^\\s*|\\s*$)/, \"\");\n          return title || o.fallback;\n        },\n\n        tip: function() {\n          if (!this.$tip) {\n            this.$tip = $('<div class=\"tipsy\"></div>').html('<div class=\"tipsy-arrow\"></div><div class=\"tipsy-inner\"></div>');\n            this.$tip.data('tipsy-pointee', this.$element[0]);\n          }\n          return this.$tip;\n        },\n\n        validate: function() {\n          if (!this.$element[0].parentNode) {\n            this.hide();\n            this.$element = null;\n            this.options = null;\n          }\n        },\n\n        remove: function() { this.enabled = false; this.$tip && this.$tip.remove(); },\n        enable: function() { this.enabled = true; },\n        disable: function() { this.enabled = false; },\n        toggleEnabled: function() { this.enabled = !this.enabled; }\n      };\n\n      $.fn.tipsy = function(options) {\n\n        if (options === true) {\n          return this.data('tipsy');\n        } else if (typeof options == 'string') {\n          var tipsy = this.data('tipsy');\n          if (tipsy) tipsy[options]();\n          return this;\n        }\n\n        options = $.extend({}, $.fn.tipsy.defaults, options);\n\n        function get(ele) {\n          var tipsy = $.data(ele, 'tipsy');\n          if (!tipsy) {\n            tipsy = new Tipsy(ele, $.fn.tipsy.elementOptions(ele, options));\n            $.data(ele, 'tipsy', tipsy);\n          }\n          return tipsy;\n        }\n\n        function enter() {\n          var tipsy = get(this);\n          tipsy.hoverState = 'in';\n          if (options.delayIn == 0) {\n            tipsy.show();\n          } else {\n            tipsy.fixTitle();\n            setTimeout(function() { if (tipsy.hoverState == 'in') tipsy.show(); }, options.delayIn);\n          }\n        };\n\n        function leave() {\n          var tipsy = get(this);\n          tipsy.hoverState = 'out';\n          if (options.delayOut == 0) {\n            tipsy.hide();\n          } else {\n            setTimeout(function() { if (tipsy.hoverState == 'out') tipsy.hide(); }, options.delayOut);\n          }\n        };\n\n        if (!options.live) this.each(function() { get(this); });\n\n        if (options.trigger != 'manual') {\n          var binder   = options.live ? 'live' : 'bind',\n          eventIn  = options.trigger == 'hover' ? 'mouseenter' : 'focus',\n          eventOut = options.trigger == 'hover' ? 'mouseleave' : 'blur';\n          this[binder](eventIn, enter)[binder](eventOut, leave);\n        }\n\n        return this;\n\n      };\n\n      $.fn.tipsy.defaults = {\n        className: null,\n        delayIn: 0,\n        delayOut: 0,\n        fade: false,\n        fallback: '',\n        gravity: 'n',\n        html: false,\n        live: false,\n        offset: 0,\n        opacity: 0.8,\n        title: 'title',\n        trigger: 'hover'\n      };\n\n      $.fn.tipsy.revalidate = function() {\n        $('.tipsy').each(function() {\n          var pointee = $.data(this, 'tipsy-pointee');\n          if (!pointee || !isElementInDOM(pointee)) {\n            $(this).remove();\n          }\n        });\n      };\n\n    // Overwrite this method to provide options on a per-element basis.\n    // For example, you could store the gravity in a 'tipsy-gravity' attribute:\n    // return $.extend({}, options, {gravity: $(ele).attr('tipsy-gravity') || 'n' });\n    // (remember - do not modify 'options' in place!)\n    $.fn.tipsy.elementOptions = function(ele, options) {\n      return $.metadata ? $.extend({}, options, $(ele).metadata()) : options;\n    };\n\n    $.fn.tipsy.autoNS = function() {\n      return $(this).offset().top > ($(document).scrollTop() + $(window).height() / 2) ? 's' : 'n';\n    };\n\n    $.fn.tipsy.autoWE = function() {\n      return $(this).offset().left > ($(document).scrollLeft() + $(window).width() / 2) ? 'e' : 'w';\n    };\n\n    /**\n     * yields a closure of the supplied parameters, producing a function that takes\n     * no arguments and is suitable for use as an autogravity function like so:\n     *\n     * @param margin (int) - distance from the viewable region edge that an\n     *        element should be before setting its tooltip's gravity to be away\n     *        from that edge.\n     * @param prefer (string, e.g. 'n', 'sw', 'w') - the direction to prefer\n     *        if there are no viewable region edges effecting the tooltip's\n     *        gravity. It will try to vary from this minimally, for example,\n     *        if 'sw' is preferred and an element is near the right viewable\n     *        region edge, but not the top edge, it will set the gravity for\n     *        that element's tooltip to be 'se', preserving the southern\n     *        component.\n     */\n     $.fn.tipsy.autoBounds = function(margin, prefer) {\n      return function() {\n       var dir = {ns: prefer[0], ew: (prefer.length > 1 ? prefer[1] : false)},\n       boundTop = $(document).scrollTop() + margin,\n       boundLeft = $(document).scrollLeft() + margin,\n       $this = $(this);\n\n       if ($this.offset().top < boundTop) dir.ns = 'n';\n       if ($this.offset().left < boundLeft) dir.ew = 'w';\n       if ($(window).width() + $(document).scrollLeft() - $this.offset().left < margin) dir.ew = 'e';\n       if ($(window).height() + $(document).scrollTop() - $this.offset().top < margin) dir.ns = 's';\n\n       return dir.ns + (dir.ew ? dir.ew : '');\n     }\n   };\n\n })(jQuery);\n","(function(){if (!Date.now) Date.now = function() {\n  return +new Date;\n};\ntry {\n  document.createElement(\"div\").style.setProperty(\"opacity\", 0, \"\");\n} catch (error) {\n  var d3_style_prototype = CSSStyleDeclaration.prototype,\n      d3_style_setProperty = d3_style_prototype.setProperty;\n  d3_style_prototype.setProperty = function(name, value, priority) {\n    d3_style_setProperty.call(this, name, value + \"\", priority);\n  };\n}\nd3 = {version: \"2.9.6\"}; // semver\nfunction d3_class(ctor, properties) {\n  try {\n    for (var key in properties) {\n      Object.defineProperty(ctor.prototype, key, {\n        value: properties[key],\n        enumerable: false\n      });\n    }\n  } catch (e) {\n    ctor.prototype = properties;\n  }\n}\nvar d3_array = d3_arraySlice; // conversion for NodeLists\n\nfunction d3_arrayCopy(pseudoarray) {\n  var i = -1, n = pseudoarray.length, array = [];\n  while (++i < n) array.push(pseudoarray[i]);\n  return array;\n}\n\nfunction d3_arraySlice(pseudoarray) {\n  return Array.prototype.slice.call(pseudoarray);\n}\n\ntry {\n  d3_array(document.documentElement.childNodes)[0].nodeType;\n} catch(e) {\n  d3_array = d3_arrayCopy;\n}\n\nvar d3_arraySubclass = [].__proto__?\n\n// Until ECMAScript supports array subclassing, prototype injection works well.\nfunction(array, prototype) {\n  array.__proto__ = prototype;\n}:\n\n// And if your browser doesn't support __proto__, we'll use direct extension.\nfunction(array, prototype) {\n  for (var property in prototype) array[property] = prototype[property];\n};\nd3.map = function(object) {\n  var map = new d3_Map;\n  for (var key in object) map.set(key, object[key]);\n  return map;\n};\n\nfunction d3_Map() {}\n\nd3_class(d3_Map, {\n  has: function(key) {\n    return d3_map_prefix + key in this;\n  },\n  get: function(key) {\n    return this[d3_map_prefix + key];\n  },\n  set: function(key, value) {\n    return this[d3_map_prefix + key] = value;\n  },\n  remove: function(key) {\n    key = d3_map_prefix + key;\n    return key in this && delete this[key];\n  },\n  keys: function() {\n    var keys = [];\n    this.forEach(function(key) { keys.push(key); });\n    return keys;\n  },\n  values: function() {\n    var values = [];\n    this.forEach(function(key, value) { values.push(value); });\n    return values;\n  },\n  entries: function() {\n    var entries = [];\n    this.forEach(function(key, value) { entries.push({key: key, value: value}); });\n    return entries;\n  },\n  forEach: function(f) {\n    for (var key in this) {\n      if (key.charCodeAt(0) === d3_map_prefixCode) {\n        f.call(this, key.substring(1), this[key]);\n      }\n    }\n  }\n});\n\nvar d3_map_prefix = \"\\0\", // prevent collision with built-ins\n    d3_map_prefixCode = d3_map_prefix.charCodeAt(0);\nfunction d3_identity(d) {\n  return d;\n}\nfunction d3_this() {\n  return this;\n}\nfunction d3_true() {\n  return true;\n}\nfunction d3_functor(v) {\n  return typeof v === \"function\" ? v : function() { return v; };\n}\n\nd3.functor = d3_functor;\n// Copies a variable number of methods from source to target.\nd3.rebind = function(target, source) {\n  var i = 1, n = arguments.length, method;\n  while (++i < n) target[method = arguments[i]] = d3_rebind(target, source, source[method]);\n  return target;\n};\n\n// Method is assumed to be a standard D3 getter-setter:\n// If passed with no arguments, gets the value.\n// If passed with arguments, sets the value and returns the target.\nfunction d3_rebind(target, source, method) {\n  return function() {\n    var value = method.apply(source, arguments);\n    return arguments.length ? target : value;\n  };\n}\nd3.ascending = function(a, b) {\n  return a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;\n};\nd3.descending = function(a, b) {\n  return b < a ? -1 : b > a ? 1 : b >= a ? 0 : NaN;\n};\nd3.mean = function(array, f) {\n  var n = array.length,\n      a,\n      m = 0,\n      i = -1,\n      j = 0;\n  if (arguments.length === 1) {\n    while (++i < n) if (d3_number(a = array[i])) m += (a - m) / ++j;\n  } else {\n    while (++i < n) if (d3_number(a = f.call(array, array[i], i))) m += (a - m) / ++j;\n  }\n  return j ? m : undefined;\n};\nd3.median = function(array, f) {\n  if (arguments.length > 1) array = array.map(f);\n  array = array.filter(d3_number);\n  return array.length ? d3.quantile(array.sort(d3.ascending), .5) : undefined;\n};\nd3.min = function(array, f) {\n  var i = -1,\n      n = array.length,\n      a,\n      b;\n  if (arguments.length === 1) {\n    while (++i < n && ((a = array[i]) == null || a != a)) a = undefined;\n    while (++i < n) if ((b = array[i]) != null && a > b) a = b;\n  } else {\n    while (++i < n && ((a = f.call(array, array[i], i)) == null || a != a)) a = undefined;\n    while (++i < n) if ((b = f.call(array, array[i], i)) != null && a > b) a = b;\n  }\n  return a;\n};\nd3.max = function(array, f) {\n  var i = -1,\n      n = array.length,\n      a,\n      b;\n  if (arguments.length === 1) {\n    while (++i < n && ((a = array[i]) == null || a != a)) a = undefined;\n    while (++i < n) if ((b = array[i]) != null && b > a) a = b;\n  } else {\n    while (++i < n && ((a = f.call(array, array[i], i)) == null || a != a)) a = undefined;\n    while (++i < n) if ((b = f.call(array, array[i], i)) != null && b > a) a = b;\n  }\n  return a;\n};\nd3.extent = function(array, f) {\n  var i = -1,\n      n = array.length,\n      a,\n      b,\n      c;\n  if (arguments.length === 1) {\n    while (++i < n && ((a = c = array[i]) == null || a != a)) a = c = undefined;\n    while (++i < n) if ((b = array[i]) != null) {\n      if (a > b) a = b;\n      if (c < b) c = b;\n    }\n  } else {\n    while (++i < n && ((a = c = f.call(array, array[i], i)) == null || a != a)) a = undefined;\n    while (++i < n) if ((b = f.call(array, array[i], i)) != null) {\n      if (a > b) a = b;\n      if (c < b) c = b;\n    }\n  }\n  return [a, c];\n};\nd3.random = {\n  normal: function(mean, deviation) {\n    if (arguments.length < 2) deviation = 1;\n    if (arguments.length < 1) mean = 0;\n    return function() {\n      var x, y, r;\n      do {\n        x = Math.random() * 2 - 1;\n        y = Math.random() * 2 - 1;\n        r = x * x + y * y;\n      } while (!r || r > 1);\n      return mean + deviation * x * Math.sqrt(-2 * Math.log(r) / r);\n    };\n  }\n};\nfunction d3_number(x) {\n  return x != null && !isNaN(x);\n}\nd3.sum = function(array, f) {\n  var s = 0,\n      n = array.length,\n      a,\n      i = -1;\n\n  if (arguments.length === 1) {\n    while (++i < n) if (!isNaN(a = +array[i])) s += a;\n  } else {\n    while (++i < n) if (!isNaN(a = +f.call(array, array[i], i))) s += a;\n  }\n\n  return s;\n};\n// R-7 per <http://en.wikipedia.org/wiki/Quantile>\nd3.quantile = function(values, p) {\n  var H = (values.length - 1) * p + 1,\n      h = Math.floor(H),\n      v = values[h - 1],\n      e = H - h;\n  return e ? v + e * (values[h] - v) : v;\n};\nd3.transpose = function(matrix) {\n  return d3.zip.apply(d3, matrix);\n};\nd3.zip = function() {\n  if (!(n = arguments.length)) return [];\n  for (var i = -1, m = d3.min(arguments, d3_zipLength), zips = new Array(m); ++i < m;) {\n    for (var j = -1, n, zip = zips[i] = new Array(n); ++j < n;) {\n      zip[j] = arguments[j][i];\n    }\n  }\n  return zips;\n};\n\nfunction d3_zipLength(d) {\n  return d.length;\n}\nd3.bisector = function(f) {\n  return {\n    left: function(a, x, lo, hi) {\n      if (arguments.length < 3) lo = 0;\n      if (arguments.length < 4) hi = a.length;\n      while (lo < hi) {\n        var mid = lo + hi >> 1;\n        if (f.call(a, a[mid], mid) < x) lo = mid + 1;\n        else hi = mid;\n      }\n      return lo;\n    },\n    right: function(a, x, lo, hi) {\n      if (arguments.length < 3) lo = 0;\n      if (arguments.length < 4) hi = a.length;\n      while (lo < hi) {\n        var mid = lo + hi >> 1;\n        if (x < f.call(a, a[mid], mid)) hi = mid;\n        else lo = mid + 1;\n      }\n      return lo;\n    }\n  };\n};\n\nvar d3_bisector = d3.bisector(function(d) { return d; });\nd3.bisectLeft = d3_bisector.left;\nd3.bisect = d3.bisectRight = d3_bisector.right;\nd3.first = function(array, f) {\n  var i = 0,\n      n = array.length,\n      a = array[0],\n      b;\n  if (arguments.length === 1) f = d3.ascending;\n  while (++i < n) {\n    if (f.call(array, a, b = array[i]) > 0) {\n      a = b;\n    }\n  }\n  return a;\n};\nd3.last = function(array, f) {\n  var i = 0,\n      n = array.length,\n      a = array[0],\n      b;\n  if (arguments.length === 1) f = d3.ascending;\n  while (++i < n) {\n    if (f.call(array, a, b = array[i]) <= 0) {\n      a = b;\n    }\n  }\n  return a;\n};\nd3.nest = function() {\n  var nest = {},\n      keys = [],\n      sortKeys = [],\n      sortValues,\n      rollup;\n\n  function map(array, depth) {\n    if (depth >= keys.length) return rollup\n        ? rollup.call(nest, array) : (sortValues\n        ? array.sort(sortValues)\n        : array);\n\n    var i = -1,\n        n = array.length,\n        key = keys[depth++],\n        keyValue,\n        object,\n        valuesByKey = new d3_Map,\n        values,\n        o = {};\n\n    while (++i < n) {\n      if (values = valuesByKey.get(keyValue = key(object = array[i]))) {\n        values.push(object);\n      } else {\n        valuesByKey.set(keyValue, [object]);\n      }\n    }\n\n    valuesByKey.forEach(function(keyValue) {\n      o[keyValue] = map(valuesByKey.get(keyValue), depth);\n    });\n\n    return o;\n  }\n\n  function entries(map, depth) {\n    if (depth >= keys.length) return map;\n\n    var a = [],\n        sortKey = sortKeys[depth++],\n        key;\n\n    for (key in map) {\n      a.push({key: key, values: entries(map[key], depth)});\n    }\n\n    if (sortKey) a.sort(function(a, b) {\n      return sortKey(a.key, b.key);\n    });\n\n    return a;\n  }\n\n  nest.map = function(array) {\n    return map(array, 0);\n  };\n\n  nest.entries = function(array) {\n    return entries(map(array, 0), 0);\n  };\n\n  nest.key = function(d) {\n    keys.push(d);\n    return nest;\n  };\n\n  // Specifies the order for the most-recently specified key.\n  // Note: only applies to entries. Map keys are unordered!\n  nest.sortKeys = function(order) {\n    sortKeys[keys.length - 1] = order;\n    return nest;\n  };\n\n  // Specifies the order for leaf values.\n  // Applies to both maps and entries array.\n  nest.sortValues = function(order) {\n    sortValues = order;\n    return nest;\n  };\n\n  nest.rollup = function(f) {\n    rollup = f;\n    return nest;\n  };\n\n  return nest;\n};\nd3.keys = function(map) {\n  var keys = [];\n  for (var key in map) keys.push(key);\n  return keys;\n};\nd3.values = function(map) {\n  var values = [];\n  for (var key in map) values.push(map[key]);\n  return values;\n};\nd3.entries = function(map) {\n  var entries = [];\n  for (var key in map) entries.push({key: key, value: map[key]});\n  return entries;\n};\nd3.permute = function(array, indexes) {\n  var permutes = [],\n      i = -1,\n      n = indexes.length;\n  while (++i < n) permutes[i] = array[indexes[i]];\n  return permutes;\n};\nd3.merge = function(arrays) {\n  return Array.prototype.concat.apply([], arrays);\n};\nd3.split = function(array, f) {\n  var arrays = [],\n      values = [],\n      value,\n      i = -1,\n      n = array.length;\n  if (arguments.length < 2) f = d3_splitter;\n  while (++i < n) {\n    if (f.call(values, value = array[i], i)) {\n      values = [];\n    } else {\n      if (!values.length) arrays.push(values);\n      values.push(value);\n    }\n  }\n  return arrays;\n};\n\nfunction d3_splitter(d) {\n  return d == null;\n}\nfunction d3_collapse(s) {\n  return s.replace(/^\\s+|\\s+$/g, \"\").replace(/\\s+/g, \" \");\n}\nd3.range = function(start, stop, step) {\n  if (arguments.length < 3) {\n    step = 1;\n    if (arguments.length < 2) {\n      stop = start;\n      start = 0;\n    }\n  }\n  if ((stop - start) / step === Infinity) throw new Error(\"infinite range\");\n  var range = [],\n       k = d3_range_integerScale(Math.abs(step)),\n       i = -1,\n       j;\n  start *= k, stop *= k, step *= k;\n  if (step < 0) while ((j = start + step * ++i) > stop) range.push(j / k);\n  else while ((j = start + step * ++i) < stop) range.push(j / k);\n  return range;\n};\n\nfunction d3_range_integerScale(x) {\n  var k = 1;\n  while (x * k % 1) k *= 10;\n  return k;\n}\nd3.requote = function(s) {\n  return s.replace(d3_requote_re, \"\\\\$&\");\n};\n\nvar d3_requote_re = /[\\\\\\^\\$\\*\\+\\?\\|\\[\\]\\(\\)\\.\\{\\}]/g;\nd3.round = function(x, n) {\n  return n\n      ? Math.round(x * (n = Math.pow(10, n))) / n\n      : Math.round(x);\n};\nd3.xhr = function(url, mime, callback) {\n  var req = new XMLHttpRequest;\n  if (arguments.length < 3) callback = mime, mime = null;\n  else if (mime && req.overrideMimeType) req.overrideMimeType(mime);\n  req.open(\"GET\", url, true);\n  if (mime) req.setRequestHeader(\"Accept\", mime);\n  req.onreadystatechange = function() {\n    if (req.readyState === 4) {\n      var s = req.status;\n      callback(!s && req.response || s >= 200 && s < 300 || s === 304 ? req : null);\n    }\n  };\n  req.send(null);\n};\nd3.text = function(url, mime, callback) {\n  function ready(req) {\n    callback(req && req.responseText);\n  }\n  if (arguments.length < 3) {\n    callback = mime;\n    mime = null;\n  }\n  d3.xhr(url, mime, ready);\n};\nd3.json = function(url, callback) {\n  d3.text(url, \"application/json\", function(text) {\n    callback(text ? JSON.parse(text) : null);\n  });\n};\nd3.html = function(url, callback) {\n  d3.text(url, \"text/html\", function(text) {\n    if (text != null) { // Treat empty string as valid HTML.\n      var range = document.createRange();\n      range.selectNode(document.body);\n      text = range.createContextualFragment(text);\n    }\n    callback(text);\n  });\n};\nd3.xml = function(url, mime, callback) {\n  function ready(req) {\n    callback(req && req.responseXML);\n  }\n  if (arguments.length < 3) {\n    callback = mime;\n    mime = null;\n  }\n  d3.xhr(url, mime, ready);\n};\nvar d3_nsPrefix = {\n  svg: \"http://www.w3.org/2000/svg\",\n  xhtml: \"http://www.w3.org/1999/xhtml\",\n  xlink: \"http://www.w3.org/1999/xlink\",\n  xml: \"http://www.w3.org/XML/1998/namespace\",\n  xmlns: \"http://www.w3.org/2000/xmlns/\"\n};\n\nd3.ns = {\n  prefix: d3_nsPrefix,\n  qualify: function(name) {\n    var i = name.indexOf(\":\"),\n        prefix = name;\n    if (i >= 0) {\n      prefix = name.substring(0, i);\n      name = name.substring(i + 1);\n    }\n    return d3_nsPrefix.hasOwnProperty(prefix)\n        ? {space: d3_nsPrefix[prefix], local: name}\n        : name;\n  }\n};\nd3.dispatch = function() {\n  var dispatch = new d3_dispatch,\n      i = -1,\n      n = arguments.length;\n  while (++i < n) dispatch[arguments[i]] = d3_dispatch_event(dispatch);\n  return dispatch;\n};\n\nfunction d3_dispatch() {}\n\nd3_dispatch.prototype.on = function(type, listener) {\n  var i = type.indexOf(\".\"),\n      name = \"\";\n\n  // Extract optional namespace, e.g., \"click.foo\"\n  if (i > 0) {\n    name = type.substring(i + 1);\n    type = type.substring(0, i);\n  }\n\n  return arguments.length < 2\n      ? this[type].on(name)\n      : this[type].on(name, listener);\n};\n\nfunction d3_dispatch_event(dispatch) {\n  var listeners = [],\n      listenerByName = new d3_Map;\n\n  function event() {\n    var z = listeners, // defensive reference\n        i = -1,\n        n = z.length,\n        l;\n    while (++i < n) if (l = z[i].on) l.apply(this, arguments);\n    return dispatch;\n  }\n\n  event.on = function(name, listener) {\n    var l = listenerByName.get(name),\n        i;\n\n    // return the current listener, if any\n    if (arguments.length < 2) return l && l.on;\n\n    // remove the old listener, if any (with copy-on-write)\n    if (l) {\n      l.on = null;\n      listeners = listeners.slice(0, i = listeners.indexOf(l)).concat(listeners.slice(i + 1));\n      listenerByName.remove(name);\n    }\n\n    // add the new listener, if any\n    if (listener) listeners.push(listenerByName.set(name, {on: listener}));\n\n    return dispatch;\n  };\n\n  return event;\n}\n// TODO align\nd3.format = function(specifier) {\n  var match = d3_format_re.exec(specifier),\n      fill = match[1] || \" \",\n      sign = match[3] || \"\",\n      zfill = match[5],\n      width = +match[6],\n      comma = match[7],\n      precision = match[8],\n      type = match[9],\n      scale = 1,\n      suffix = \"\",\n      integer = false;\n\n  if (precision) precision = +precision.substring(1);\n\n  if (zfill) {\n    fill = \"0\"; // TODO align = \"=\";\n    if (comma) width -= Math.floor((width - 1) / 4);\n  }\n\n  switch (type) {\n    case \"n\": comma = true; type = \"g\"; break;\n    case \"%\": scale = 100; suffix = \"%\"; type = \"f\"; break;\n    case \"p\": scale = 100; suffix = \"%\"; type = \"r\"; break;\n    case \"d\": integer = true; precision = 0; break;\n    case \"s\": scale = -1; type = \"r\"; break;\n  }\n\n  // If no precision is specified for r, fallback to general notation.\n  if (type == \"r\" && !precision) type = \"g\";\n\n  type = d3_format_types.get(type) || d3_format_typeDefault;\n\n  return function(value) {\n\n    // Return the empty string for floats formatted as ints.\n    if (integer && (value % 1)) return \"\";\n\n    // Convert negative to positive, and record the sign prefix.\n    var negative = (value < 0) && (value = -value) ? \"\\u2212\" : sign;\n\n    // Apply the scale, computing it from the value's exponent for si format.\n    if (scale < 0) {\n      var prefix = d3.formatPrefix(value, precision);\n      value = prefix.scale(value);\n      suffix = prefix.symbol;\n    } else {\n      value *= scale;\n    }\n\n    // Convert to the desired precision.\n    value = type(value, precision);\n\n    // If the fill character is 0, the sign and group is applied after the fill.\n    if (zfill) {\n      var length = value.length + negative.length;\n      if (length < width) value = new Array(width - length + 1).join(fill) + value;\n      if (comma) value = d3_format_group(value);\n      value = negative + value;\n    }\n\n    // Otherwise (e.g., space-filling), the sign and group is applied before.\n    else {\n      if (comma) value = d3_format_group(value);\n      value = negative + value;\n      var length = value.length;\n      if (length < width) value = new Array(width - length + 1).join(fill) + value;\n    }\n\n    return value + suffix;\n  };\n};\n\n// [[fill]align][sign][#][0][width][,][.precision][type]\nvar d3_format_re = /(?:([^{])?([<>=^]))?([+\\- ])?(#)?(0)?([0-9]+)?(,)?(\\.[0-9]+)?([a-zA-Z%])?/;\n\nvar d3_format_types = d3.map({\n  g: function(x, p) { return x.toPrecision(p); },\n  e: function(x, p) { return x.toExponential(p); },\n  f: function(x, p) { return x.toFixed(p); },\n  r: function(x, p) { return d3.round(x, p = d3_format_precision(x, p)).toFixed(Math.max(0, Math.min(20, p))); }\n});\n\nfunction d3_format_precision(x, p) {\n  return p - (x ? 1 + Math.floor(Math.log(x + Math.pow(10, 1 + Math.floor(Math.log(x) / Math.LN10) - p)) / Math.LN10) : 1);\n}\n\nfunction d3_format_typeDefault(x) {\n  return x + \"\";\n}\n\n// Apply comma grouping for thousands.\nfunction d3_format_group(value) {\n  var i = value.lastIndexOf(\".\"),\n      f = i >= 0 ? value.substring(i) : (i = value.length, \"\"),\n      t = [];\n  while (i > 0) t.push(value.substring(i -= 3, i + 3));\n  return t.reverse().join(\",\") + f;\n}\nvar d3_formatPrefixes = [\"y\",\"z\",\"a\",\"f\",\"p\",\"n\",\"Î¼\",\"m\",\"\",\"k\",\"M\",\"G\",\"T\",\"P\",\"E\",\"Z\",\"Y\"].map(d3_formatPrefix);\n\nd3.formatPrefix = function(value, precision) {\n  var i = 0;\n  if (value) {\n    if (value < 0) value *= -1;\n    if (precision) value = d3.round(value, d3_format_precision(value, precision));\n    i = 1 + Math.floor(1e-12 + Math.log(value) / Math.LN10);\n    i = Math.max(-24, Math.min(24, Math.floor((i <= 0 ? i + 1 : i - 1) / 3) * 3));\n  }\n  return d3_formatPrefixes[8 + i / 3];\n};\n\nfunction d3_formatPrefix(d, i) {\n  var k = Math.pow(10, Math.abs(8 - i) * 3);\n  return {\n    scale: i > 8 ? function(d) { return d / k; } : function(d) { return d * k; },\n    symbol: d\n  };\n}\n/*\n * TERMS OF USE - EASING EQUATIONS\n *\n * Open source under the BSD License.\n *\n * Copyright 2001 Robert Penner\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * - Redistributions of source code must retain the above copyright notice, this\n *   list of conditions and the following disclaimer.\n *\n * - Redistributions in binary form must reproduce the above copyright notice,\n *   this list of conditions and the following disclaimer in the documentation\n *   and/or other materials provided with the distribution.\n *\n * - Neither the name of the author nor the names of contributors may be used to\n *   endorse or promote products derived from this software without specific\n *   prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n */\n\nvar d3_ease_quad = d3_ease_poly(2),\n    d3_ease_cubic = d3_ease_poly(3),\n    d3_ease_default = function() { return d3_ease_identity; };\n\nvar d3_ease = d3.map({\n  linear: d3_ease_default,\n  poly: d3_ease_poly,\n  quad: function() { return d3_ease_quad; },\n  cubic: function() { return d3_ease_cubic; },\n  sin: function() { return d3_ease_sin; },\n  exp: function() { return d3_ease_exp; },\n  circle: function() { return d3_ease_circle; },\n  elastic: d3_ease_elastic,\n  back: d3_ease_back,\n  bounce: function() { return d3_ease_bounce; }\n});\n\nvar d3_ease_mode = d3.map({\n  \"in\": d3_ease_identity,\n  \"out\": d3_ease_reverse,\n  \"in-out\": d3_ease_reflect,\n  \"out-in\": function(f) { return d3_ease_reflect(d3_ease_reverse(f)); }\n});\n\nd3.ease = function(name) {\n  var i = name.indexOf(\"-\"),\n      t = i >= 0 ? name.substring(0, i) : name,\n      m = i >= 0 ? name.substring(i + 1) : \"in\";\n  t = d3_ease.get(t) || d3_ease_default;\n  m = d3_ease_mode.get(m) || d3_ease_identity;\n  return d3_ease_clamp(m(t.apply(null, Array.prototype.slice.call(arguments, 1))));\n};\n\nfunction d3_ease_clamp(f) {\n  return function(t) {\n    return t <= 0 ? 0 : t >= 1 ? 1 : f(t);\n  };\n}\n\nfunction d3_ease_reverse(f) {\n  return function(t) {\n    return 1 - f(1 - t);\n  };\n}\n\nfunction d3_ease_reflect(f) {\n  return function(t) {\n    return .5 * (t < .5 ? f(2 * t) : (2 - f(2 - 2 * t)));\n  };\n}\n\nfunction d3_ease_identity(t) {\n  return t;\n}\n\nfunction d3_ease_poly(e) {\n  return function(t) {\n    return Math.pow(t, e);\n  };\n}\n\nfunction d3_ease_sin(t) {\n  return 1 - Math.cos(t * Math.PI / 2);\n}\n\nfunction d3_ease_exp(t) {\n  return Math.pow(2, 10 * (t - 1));\n}\n\nfunction d3_ease_circle(t) {\n  return 1 - Math.sqrt(1 - t * t);\n}\n\nfunction d3_ease_elastic(a, p) {\n  var s;\n  if (arguments.length < 2) p = 0.45;\n  if (arguments.length < 1) { a = 1; s = p / 4; }\n  else s = p / (2 * Math.PI) * Math.asin(1 / a);\n  return function(t) {\n    return 1 + a * Math.pow(2, 10 * -t) * Math.sin((t - s) * 2 * Math.PI / p);\n  };\n}\n\nfunction d3_ease_back(s) {\n  if (!s) s = 1.70158;\n  return function(t) {\n    return t * t * ((s + 1) * t - s);\n  };\n}\n\nfunction d3_ease_bounce(t) {\n  return t < 1 / 2.75 ? 7.5625 * t * t\n      : t < 2 / 2.75 ? 7.5625 * (t -= 1.5 / 2.75) * t + .75\n      : t < 2.5 / 2.75 ? 7.5625 * (t -= 2.25 / 2.75) * t + .9375\n      : 7.5625 * (t -= 2.625 / 2.75) * t + .984375;\n}\nd3.event = null;\n\nfunction d3_eventCancel() {\n  d3.event.stopPropagation();\n  d3.event.preventDefault();\n}\n\nfunction d3_eventSource() {\n  var e = d3.event, s;\n  while (s = e.sourceEvent) e = s;\n  return e;\n}\n\n// Like d3.dispatch, but for custom events abstracting native UI events. These\n// events have a target component (such as a brush), a target element (such as\n// the svg:g element containing the brush) and the standard arguments `d` (the\n// target element's data) and `i` (the selection index of the target element).\nfunction d3_eventDispatch(target) {\n  var dispatch = new d3_dispatch,\n      i = 0,\n      n = arguments.length;\n\n  while (++i < n) dispatch[arguments[i]] = d3_dispatch_event(dispatch);\n\n  // Creates a dispatch context for the specified `thiz` (typically, the target\n  // DOM element that received the source event) and `argumentz` (typically, the\n  // data `d` and index `i` of the target element). The returned function can be\n  // used to dispatch an event to any registered listeners; the function takes a\n  // single argument as input, being the event to dispatch. The event must have\n  // a \"type\" attribute which corresponds to a type registered in the\n  // constructor. This context will automatically populate the \"sourceEvent\" and\n  // \"target\" attributes of the event, as well as setting the `d3.event` global\n  // for the duration of the notification.\n  dispatch.of = function(thiz, argumentz) {\n    return function(e1) {\n      try {\n        var e0 =\n        e1.sourceEvent = d3.event;\n        e1.target = target;\n        d3.event = e1;\n        dispatch[e1.type].apply(thiz, argumentz);\n      } finally {\n        d3.event = e0;\n      }\n    };\n  };\n\n  return dispatch;\n}\nd3.interpolate = function(a, b) {\n  var i = d3.interpolators.length, f;\n  while (--i >= 0 && !(f = d3.interpolators[i](a, b)));\n  return f;\n};\n\nd3.interpolateNumber = function(a, b) {\n  b -= a;\n  return function(t) { return a + b * t; };\n};\n\nd3.interpolateRound = function(a, b) {\n  b -= a;\n  return function(t) { return Math.round(a + b * t); };\n};\n\nd3.interpolateString = function(a, b) {\n  var m, // current match\n      i, // current index\n      j, // current index (for coallescing)\n      s0 = 0, // start index of current string prefix\n      s1 = 0, // end index of current string prefix\n      s = [], // string constants and placeholders\n      q = [], // number interpolators\n      n, // q.length\n      o;\n\n  // Reset our regular expression!\n  d3_interpolate_number.lastIndex = 0;\n\n  // Find all numbers in b.\n  for (i = 0; m = d3_interpolate_number.exec(b); ++i) {\n    if (m.index) s.push(b.substring(s0, s1 = m.index));\n    q.push({i: s.length, x: m[0]});\n    s.push(null);\n    s0 = d3_interpolate_number.lastIndex;\n  }\n  if (s0 < b.length) s.push(b.substring(s0));\n\n  // Find all numbers in a.\n  for (i = 0, n = q.length; (m = d3_interpolate_number.exec(a)) && i < n; ++i) {\n    o = q[i];\n    if (o.x == m[0]) { // The numbers match, so coallesce.\n      if (o.i) {\n        if (s[o.i + 1] == null) { // This match is followed by another number.\n          s[o.i - 1] += o.x;\n          s.splice(o.i, 1);\n          for (j = i + 1; j < n; ++j) q[j].i--;\n        } else { // This match is followed by a string, so coallesce twice.\n          s[o.i - 1] += o.x + s[o.i + 1];\n          s.splice(o.i, 2);\n          for (j = i + 1; j < n; ++j) q[j].i -= 2;\n        }\n      } else {\n          if (s[o.i + 1] == null) { // This match is followed by another number.\n          s[o.i] = o.x;\n        } else { // This match is followed by a string, so coallesce twice.\n          s[o.i] = o.x + s[o.i + 1];\n          s.splice(o.i + 1, 1);\n          for (j = i + 1; j < n; ++j) q[j].i--;\n        }\n      }\n      q.splice(i, 1);\n      n--;\n      i--;\n    } else {\n      o.x = d3.interpolateNumber(parseFloat(m[0]), parseFloat(o.x));\n    }\n  }\n\n  // Remove any numbers in b not found in a.\n  while (i < n) {\n    o = q.pop();\n    if (s[o.i + 1] == null) { // This match is followed by another number.\n      s[o.i] = o.x;\n    } else { // This match is followed by a string, so coallesce twice.\n      s[o.i] = o.x + s[o.i + 1];\n      s.splice(o.i + 1, 1);\n    }\n    n--;\n  }\n\n  // Special optimization for only a single match.\n  if (s.length === 1) {\n    return s[0] == null ? q[0].x : function() { return b; };\n  }\n\n  // Otherwise, interpolate each of the numbers and rejoin the string.\n  return function(t) {\n    for (i = 0; i < n; ++i) s[(o = q[i]).i] = o.x(t);\n    return s.join(\"\");\n  };\n};\n\nd3.interpolateTransform = function(a, b) {\n  var s = [], // string constants and placeholders\n      q = [], // number interpolators\n      n,\n      A = d3.transform(a),\n      B = d3.transform(b),\n      ta = A.translate,\n      tb = B.translate,\n      ra = A.rotate,\n      rb = B.rotate,\n      wa = A.skew,\n      wb = B.skew,\n      ka = A.scale,\n      kb = B.scale;\n\n  if (ta[0] != tb[0] || ta[1] != tb[1]) {\n    s.push(\"translate(\", null, \",\", null, \")\");\n    q.push({i: 1, x: d3.interpolateNumber(ta[0], tb[0])}, {i: 3, x: d3.interpolateNumber(ta[1], tb[1])});\n  } else if (tb[0] || tb[1]) {\n    s.push(\"translate(\" + tb + \")\");\n  } else {\n    s.push(\"\");\n  }\n\n  if (ra != rb) {\n    if (ra - rb > 180) rb += 360; else if (rb - ra > 180) ra += 360; // shortest path\n    q.push({i: s.push(s.pop() + \"rotate(\", null, \")\") - 2, x: d3.interpolateNumber(ra, rb)});\n  } else if (rb) {\n    s.push(s.pop() + \"rotate(\" + rb + \")\");\n  }\n\n  if (wa != wb) {\n    q.push({i: s.push(s.pop() + \"skewX(\", null, \")\") - 2, x: d3.interpolateNumber(wa, wb)});\n  } else if (wb) {\n    s.push(s.pop() + \"skewX(\" + wb + \")\");\n  }\n\n  if (ka[0] != kb[0] || ka[1] != kb[1]) {\n    n = s.push(s.pop() + \"scale(\", null, \",\", null, \")\");\n    q.push({i: n - 4, x: d3.interpolateNumber(ka[0], kb[0])}, {i: n - 2, x: d3.interpolateNumber(ka[1], kb[1])});\n  } else if (kb[0] != 1 || kb[1] != 1) {\n    s.push(s.pop() + \"scale(\" + kb + \")\");\n  }\n\n  n = q.length;\n  return function(t) {\n    var i = -1, o;\n    while (++i < n) s[(o = q[i]).i] = o.x(t);\n    return s.join(\"\");\n  };\n};\n\nd3.interpolateRgb = function(a, b) {\n  a = d3.rgb(a);\n  b = d3.rgb(b);\n  var ar = a.r,\n      ag = a.g,\n      ab = a.b,\n      br = b.r - ar,\n      bg = b.g - ag,\n      bb = b.b - ab;\n  return function(t) {\n    return \"#\"\n        + d3_rgb_hex(Math.round(ar + br * t))\n        + d3_rgb_hex(Math.round(ag + bg * t))\n        + d3_rgb_hex(Math.round(ab + bb * t));\n  };\n};\n\n// interpolates HSL space, but outputs RGB string (for compatibility)\nd3.interpolateHsl = function(a, b) {\n  a = d3.hsl(a);\n  b = d3.hsl(b);\n  var h0 = a.h,\n      s0 = a.s,\n      l0 = a.l,\n      h1 = b.h - h0,\n      s1 = b.s - s0,\n      l1 = b.l - l0;\n  if (h1 > 180) h1 -= 360; else if (h1 < -180) h1 += 360; // shortest path\n  return function(t) {\n    return d3_hsl_rgb(h0 + h1 * t, s0 + s1 * t, l0 + l1 * t).toString();\n  };\n};\n\nd3.interpolateArray = function(a, b) {\n  var x = [],\n      c = [],\n      na = a.length,\n      nb = b.length,\n      n0 = Math.min(a.length, b.length),\n      i;\n  for (i = 0; i < n0; ++i) x.push(d3.interpolate(a[i], b[i]));\n  for (; i < na; ++i) c[i] = a[i];\n  for (; i < nb; ++i) c[i] = b[i];\n  return function(t) {\n    for (i = 0; i < n0; ++i) c[i] = x[i](t);\n    return c;\n  };\n};\n\nd3.interpolateObject = function(a, b) {\n  var i = {},\n      c = {},\n      k;\n  for (k in a) {\n    if (k in b) {\n      i[k] = d3_interpolateByName(k)(a[k], b[k]);\n    } else {\n      c[k] = a[k];\n    }\n  }\n  for (k in b) {\n    if (!(k in a)) {\n      c[k] = b[k];\n    }\n  }\n  return function(t) {\n    for (k in i) c[k] = i[k](t);\n    return c;\n  };\n}\n\nvar d3_interpolate_number = /[-+]?(?:\\d+\\.?\\d*|\\.?\\d+)(?:[eE][-+]?\\d+)?/g;\n\nfunction d3_interpolateByName(n) {\n  return n == \"transform\"\n      ? d3.interpolateTransform\n      : d3.interpolate;\n}\n\nd3.interpolators = [\n  d3.interpolateObject,\n  function(a, b) { return (b instanceof Array) && d3.interpolateArray(a, b); },\n  function(a, b) { return (typeof a === \"string\" || typeof b === \"string\") && d3.interpolateString(a + \"\", b + \"\"); },\n  function(a, b) { return (typeof b === \"string\" ? d3_rgb_names.has(b) || /^(#|rgb\\(|hsl\\()/.test(b) : b instanceof d3_Rgb || b instanceof d3_Hsl) && d3.interpolateRgb(a, b); },\n  function(a, b) { return !isNaN(a = +a) && !isNaN(b = +b) && d3.interpolateNumber(a, b); }\n];\nfunction d3_uninterpolateNumber(a, b) {\n  b = b - (a = +a) ? 1 / (b - a) : 0;\n  return function(x) { return (x - a) * b; };\n}\n\nfunction d3_uninterpolateClamp(a, b) {\n  b = b - (a = +a) ? 1 / (b - a) : 0;\n  return function(x) { return Math.max(0, Math.min(1, (x - a) * b)); };\n}\nd3.rgb = function(r, g, b) {\n  return arguments.length === 1\n      ? (r instanceof d3_Rgb ? d3_rgb(r.r, r.g, r.b)\n      : d3_rgb_parse(\"\" + r, d3_rgb, d3_hsl_rgb))\n      : d3_rgb(~~r, ~~g, ~~b);\n};\n\nfunction d3_rgb(r, g, b) {\n  return new d3_Rgb(r, g, b);\n}\n\nfunction d3_Rgb(r, g, b) {\n  this.r = r;\n  this.g = g;\n  this.b = b;\n}\n\nd3_Rgb.prototype.brighter = function(k) {\n  k = Math.pow(0.7, arguments.length ? k : 1);\n  var r = this.r,\n      g = this.g,\n      b = this.b,\n      i = 30;\n  if (!r && !g && !b) return d3_rgb(i, i, i);\n  if (r && r < i) r = i;\n  if (g && g < i) g = i;\n  if (b && b < i) b = i;\n  return d3_rgb(\n      Math.min(255, Math.floor(r / k)),\n      Math.min(255, Math.floor(g / k)),\n      Math.min(255, Math.floor(b / k)));\n};\n\nd3_Rgb.prototype.darker = function(k) {\n  k = Math.pow(0.7, arguments.length ? k : 1);\n  return d3_rgb(\n      Math.floor(k * this.r),\n      Math.floor(k * this.g),\n      Math.floor(k * this.b));\n};\n\nd3_Rgb.prototype.hsl = function() {\n  return d3_rgb_hsl(this.r, this.g, this.b);\n};\n\nd3_Rgb.prototype.toString = function() {\n  return \"#\" + d3_rgb_hex(this.r) + d3_rgb_hex(this.g) + d3_rgb_hex(this.b);\n};\n\nfunction d3_rgb_hex(v) {\n  return v < 0x10\n      ? \"0\" + Math.max(0, v).toString(16)\n      : Math.min(255, v).toString(16);\n}\n\nfunction d3_rgb_parse(format, rgb, hsl) {\n  var r = 0, // red channel; int in [0, 255]\n      g = 0, // green channel; int in [0, 255]\n      b = 0, // blue channel; int in [0, 255]\n      m1, // CSS color specification match\n      m2, // CSS color specification type (e.g., rgb)\n      name;\n\n  /* Handle hsl, rgb. */\n  m1 = /([a-z]+)\\((.*)\\)/i.exec(format);\n  if (m1) {\n    m2 = m1[2].split(\",\");\n    switch (m1[1]) {\n      case \"hsl\": {\n        return hsl(\n          parseFloat(m2[0]), // degrees\n          parseFloat(m2[1]) / 100, // percentage\n          parseFloat(m2[2]) / 100 // percentage\n        );\n      }\n      case \"rgb\": {\n        return rgb(\n          d3_rgb_parseNumber(m2[0]),\n          d3_rgb_parseNumber(m2[1]),\n          d3_rgb_parseNumber(m2[2])\n        );\n      }\n    }\n  }\n\n  /* Named colors. */\n  if (name = d3_rgb_names.get(format)) return rgb(name.r, name.g, name.b);\n\n  /* Hexadecimal colors: #rgb and #rrggbb. */\n  if (format != null && format.charAt(0) === \"#\") {\n    if (format.length === 4) {\n      r = format.charAt(1); r += r;\n      g = format.charAt(2); g += g;\n      b = format.charAt(3); b += b;\n    } else if (format.length === 7) {\n      r = format.substring(1, 3);\n      g = format.substring(3, 5);\n      b = format.substring(5, 7);\n    }\n    r = parseInt(r, 16);\n    g = parseInt(g, 16);\n    b = parseInt(b, 16);\n  }\n\n  return rgb(r, g, b);\n}\n\nfunction d3_rgb_hsl(r, g, b) {\n  var min = Math.min(r /= 255, g /= 255, b /= 255),\n      max = Math.max(r, g, b),\n      d = max - min,\n      h,\n      s,\n      l = (max + min) / 2;\n  if (d) {\n    s = l < .5 ? d / (max + min) : d / (2 - max - min);\n    if (r == max) h = (g - b) / d + (g < b ? 6 : 0);\n    else if (g == max) h = (b - r) / d + 2;\n    else h = (r - g) / d + 4;\n    h *= 60;\n  } else {\n    s = h = 0;\n  }\n  return d3_hsl(h, s, l);\n}\n\nfunction d3_rgb_parseNumber(c) { // either integer or percentage\n  var f = parseFloat(c);\n  return c.charAt(c.length - 1) === \"%\" ? Math.round(f * 2.55) : f;\n}\n\nvar d3_rgb_names = d3.map({\n  aliceblue: \"#f0f8ff\",\n  antiquewhite: \"#faebd7\",\n  aqua: \"#00ffff\",\n  aquamarine: \"#7fffd4\",\n  azure: \"#f0ffff\",\n  beige: \"#f5f5dc\",\n  bisque: \"#ffe4c4\",\n  black: \"#000000\",\n  blanchedalmond: \"#ffebcd\",\n  blue: \"#0000ff\",\n  blueviolet: \"#8a2be2\",\n  brown: \"#a52a2a\",\n  burlywood: \"#deb887\",\n  cadetblue: \"#5f9ea0\",\n  chartreuse: \"#7fff00\",\n  chocolate: \"#d2691e\",\n  coral: \"#ff7f50\",\n  cornflowerblue: \"#6495ed\",\n  cornsilk: \"#fff8dc\",\n  crimson: \"#dc143c\",\n  cyan: \"#00ffff\",\n  darkblue: \"#00008b\",\n  darkcyan: \"#008b8b\",\n  darkgoldenrod: \"#b8860b\",\n  darkgray: \"#a9a9a9\",\n  darkgreen: \"#006400\",\n  darkgrey: \"#a9a9a9\",\n  darkkhaki: \"#bdb76b\",\n  darkmagenta: \"#8b008b\",\n  darkolivegreen: \"#556b2f\",\n  darkorange: \"#ff8c00\",\n  darkorchid: \"#9932cc\",\n  darkred: \"#8b0000\",\n  darksalmon: \"#e9967a\",\n  darkseagreen: \"#8fbc8f\",\n  darkslateblue: \"#483d8b\",\n  darkslategray: \"#2f4f4f\",\n  darkslategrey: \"#2f4f4f\",\n  darkturquoise: \"#00ced1\",\n  darkviolet: \"#9400d3\",\n  deeppink: \"#ff1493\",\n  deepskyblue: \"#00bfff\",\n  dimgray: \"#696969\",\n  dimgrey: \"#696969\",\n  dodgerblue: \"#1e90ff\",\n  firebrick: \"#b22222\",\n  floralwhite: \"#fffaf0\",\n  forestgreen: \"#228b22\",\n  fuchsia: \"#ff00ff\",\n  gainsboro: \"#dcdcdc\",\n  ghostwhite: \"#f8f8ff\",\n  gold: \"#ffd700\",\n  goldenrod: \"#daa520\",\n  gray: \"#808080\",\n  green: \"#008000\",\n  greenyellow: \"#adff2f\",\n  grey: \"#808080\",\n  honeydew: \"#f0fff0\",\n  hotpink: \"#ff69b4\",\n  indianred: \"#cd5c5c\",\n  indigo: \"#4b0082\",\n  ivory: \"#fffff0\",\n  khaki: \"#f0e68c\",\n  lavender: \"#e6e6fa\",\n  lavenderblush: \"#fff0f5\",\n  lawngreen: \"#7cfc00\",\n  lemonchiffon: \"#fffacd\",\n  lightblue: \"#add8e6\",\n  lightcoral: \"#f08080\",\n  lightcyan: \"#e0ffff\",\n  lightgoldenrodyellow: \"#fafad2\",\n  lightgray: \"#d3d3d3\",\n  lightgreen: \"#90ee90\",\n  lightgrey: \"#d3d3d3\",\n  lightpink: \"#ffb6c1\",\n  lightsalmon: \"#ffa07a\",\n  lightseagreen: \"#20b2aa\",\n  lightskyblue: \"#87cefa\",\n  lightslategray: \"#778899\",\n  lightslategrey: \"#778899\",\n  lightsteelblue: \"#b0c4de\",\n  lightyellow: \"#ffffe0\",\n  lime: \"#00ff00\",\n  limegreen: \"#32cd32\",\n  linen: \"#faf0e6\",\n  magenta: \"#ff00ff\",\n  maroon: \"#800000\",\n  mediumaquamarine: \"#66cdaa\",\n  mediumblue: \"#0000cd\",\n  mediumorchid: \"#ba55d3\",\n  mediumpurple: \"#9370db\",\n  mediumseagreen: \"#3cb371\",\n  mediumslateblue: \"#7b68ee\",\n  mediumspringgreen: \"#00fa9a\",\n  mediumturquoise: \"#48d1cc\",\n  mediumvioletred: \"#c71585\",\n  midnightblue: \"#191970\",\n  mintcream: \"#f5fffa\",\n  mistyrose: \"#ffe4e1\",\n  moccasin: \"#ffe4b5\",\n  navajowhite: \"#ffdead\",\n  navy: \"#000080\",\n  oldlace: \"#fdf5e6\",\n  olive: \"#808000\",\n  olivedrab: \"#6b8e23\",\n  orange: \"#ffa500\",\n  orangered: \"#ff4500\",\n  orchid: \"#da70d6\",\n  palegoldenrod: \"#eee8aa\",\n  palegreen: \"#98fb98\",\n  paleturquoise: \"#afeeee\",\n  palevioletred: \"#db7093\",\n  papayawhip: \"#ffefd5\",\n  peachpuff: \"#ffdab9\",\n  peru: \"#cd853f\",\n  pink: \"#ffc0cb\",\n  plum: \"#dda0dd\",\n  powderblue: \"#b0e0e6\",\n  purple: \"#800080\",\n  red: \"#ff0000\",\n  rosybrown: \"#bc8f8f\",\n  royalblue: \"#4169e1\",\n  saddlebrown: \"#8b4513\",\n  salmon: \"#fa8072\",\n  sandybrown: \"#f4a460\",\n  seagreen: \"#2e8b57\",\n  seashell: \"#fff5ee\",\n  sienna: \"#a0522d\",\n  silver: \"#c0c0c0\",\n  skyblue: \"#87ceeb\",\n  slateblue: \"#6a5acd\",\n  slategray: \"#708090\",\n  slategrey: \"#708090\",\n  snow: \"#fffafa\",\n  springgreen: \"#00ff7f\",\n  steelblue: \"#4682b4\",\n  tan: \"#d2b48c\",\n  teal: \"#008080\",\n  thistle: \"#d8bfd8\",\n  tomato: \"#ff6347\",\n  turquoise: \"#40e0d0\",\n  violet: \"#ee82ee\",\n  wheat: \"#f5deb3\",\n  white: \"#ffffff\",\n  whitesmoke: \"#f5f5f5\",\n  yellow: \"#ffff00\",\n  yellowgreen: \"#9acd32\"\n});\n\nd3_rgb_names.forEach(function(key, value) {\n  d3_rgb_names.set(key, d3_rgb_parse(value, d3_rgb, d3_hsl_rgb));\n});\nd3.hsl = function(h, s, l) {\n  return arguments.length === 1\n      ? (h instanceof d3_Hsl ? d3_hsl(h.h, h.s, h.l)\n      : d3_rgb_parse(\"\" + h, d3_rgb_hsl, d3_hsl))\n      : d3_hsl(+h, +s, +l);\n};\n\nfunction d3_hsl(h, s, l) {\n  return new d3_Hsl(h, s, l);\n}\n\nfunction d3_Hsl(h, s, l) {\n  this.h = h;\n  this.s = s;\n  this.l = l;\n}\n\nd3_Hsl.prototype.brighter = function(k) {\n  k = Math.pow(0.7, arguments.length ? k : 1);\n  return d3_hsl(this.h, this.s, this.l / k);\n};\n\nd3_Hsl.prototype.darker = function(k) {\n  k = Math.pow(0.7, arguments.length ? k : 1);\n  return d3_hsl(this.h, this.s, k * this.l);\n};\n\nd3_Hsl.prototype.rgb = function() {\n  return d3_hsl_rgb(this.h, this.s, this.l);\n};\n\nd3_Hsl.prototype.toString = function() {\n  return this.rgb().toString();\n};\n\nfunction d3_hsl_rgb(h, s, l) {\n  var m1,\n      m2;\n\n  /* Some simple corrections for h, s and l. */\n  h = h % 360; if (h < 0) h += 360;\n  s = s < 0 ? 0 : s > 1 ? 1 : s;\n  l = l < 0 ? 0 : l > 1 ? 1 : l;\n\n  /* From FvD 13.37, CSS Color Module Level 3 */\n  m2 = l <= .5 ? l * (1 + s) : l + s - l * s;\n  m1 = 2 * l - m2;\n\n  function v(h) {\n    if (h > 360) h -= 360;\n    else if (h < 0) h += 360;\n    if (h < 60) return m1 + (m2 - m1) * h / 60;\n    if (h < 180) return m2;\n    if (h < 240) return m1 + (m2 - m1) * (240 - h) / 60;\n    return m1;\n  }\n\n  function vv(h) {\n    return Math.round(v(h) * 255);\n  }\n\n  return d3_rgb(vv(h + 120), vv(h), vv(h - 120));\n}\nfunction d3_selection(groups) {\n  d3_arraySubclass(groups, d3_selectionPrototype);\n  return groups;\n}\n\nvar d3_select = function(s, n) { return n.querySelector(s); },\n    d3_selectAll = function(s, n) { return n.querySelectorAll(s); },\n    d3_selectRoot = document.documentElement,\n    d3_selectMatcher = d3_selectRoot.matchesSelector || d3_selectRoot.webkitMatchesSelector || d3_selectRoot.mozMatchesSelector || d3_selectRoot.msMatchesSelector || d3_selectRoot.oMatchesSelector,\n    d3_selectMatches = function(n, s) { return d3_selectMatcher.call(n, s); };\n\n// Prefer Sizzle, if available.\nif (typeof Sizzle === \"function\") {\n  d3_select = function(s, n) { return Sizzle(s, n)[0] || null; };\n  d3_selectAll = function(s, n) { return Sizzle.uniqueSort(Sizzle(s, n)); };\n  d3_selectMatches = Sizzle.matchesSelector;\n}\n\nvar d3_selectionPrototype = [];\n\nd3.selection = function() {\n  return d3_selectionRoot;\n};\n\nd3.selection.prototype = d3_selectionPrototype;\nd3_selectionPrototype.select = function(selector) {\n  var subgroups = [],\n      subgroup,\n      subnode,\n      group,\n      node;\n\n  if (typeof selector !== \"function\") selector = d3_selection_selector(selector);\n\n  for (var j = -1, m = this.length; ++j < m;) {\n    subgroups.push(subgroup = []);\n    subgroup.parentNode = (group = this[j]).parentNode;\n    for (var i = -1, n = group.length; ++i < n;) {\n      if (node = group[i]) {\n        subgroup.push(subnode = selector.call(node, node.__data__, i));\n        if (subnode && \"__data__\" in node) subnode.__data__ = node.__data__;\n      } else {\n        subgroup.push(null);\n      }\n    }\n  }\n\n  return d3_selection(subgroups);\n};\n\nfunction d3_selection_selector(selector) {\n  return function() {\n    return d3_select(selector, this);\n  };\n}\nd3_selectionPrototype.selectAll = function(selector) {\n  var subgroups = [],\n      subgroup,\n      node;\n\n  if (typeof selector !== \"function\") selector = d3_selection_selectorAll(selector);\n\n  for (var j = -1, m = this.length; ++j < m;) {\n    for (var group = this[j], i = -1, n = group.length; ++i < n;) {\n      if (node = group[i]) {\n        subgroups.push(subgroup = d3_array(selector.call(node, node.__data__, i)));\n        subgroup.parentNode = node;\n      }\n    }\n  }\n\n  return d3_selection(subgroups);\n};\n\nfunction d3_selection_selectorAll(selector) {\n  return function() {\n    return d3_selectAll(selector, this);\n  };\n}\nd3_selectionPrototype.attr = function(name, value) {\n  name = d3.ns.qualify(name);\n\n  // If no value is specified, return the first value.\n  if (arguments.length < 2) {\n    var node = this.node();\n    return name.local\n        ? node.getAttributeNS(name.space, name.local)\n        : node.getAttribute(name);\n  }\n\n  function attrNull() {\n    this.removeAttribute(name);\n  }\n\n  function attrNullNS() {\n    this.removeAttributeNS(name.space, name.local);\n  }\n\n  function attrConstant() {\n    this.setAttribute(name, value);\n  }\n\n  function attrConstantNS() {\n    this.setAttributeNS(name.space, name.local, value);\n  }\n\n  function attrFunction() {\n    var x = value.apply(this, arguments);\n    if (x == null) this.removeAttribute(name);\n    else this.setAttribute(name, x);\n  }\n\n  function attrFunctionNS() {\n    var x = value.apply(this, arguments);\n    if (x == null) this.removeAttributeNS(name.space, name.local);\n    else this.setAttributeNS(name.space, name.local, x);\n  }\n\n  return this.each(value == null\n      ? (name.local ? attrNullNS : attrNull) : (typeof value === \"function\"\n      ? (name.local ? attrFunctionNS : attrFunction)\n      : (name.local ? attrConstantNS : attrConstant)));\n};\nd3_selectionPrototype.classed = function(name, value) {\n  var names = d3_collapse(name).split(\" \"),\n      n = names.length,\n      i = -1;\n  if (arguments.length > 1) {\n    while (++i < n) d3_selection_classed.call(this, names[i], value);\n    return this;\n  } else {\n    while (++i < n) if (!d3_selection_classed.call(this, names[i])) return false;\n    return true;\n  }\n};\n\nfunction d3_selection_classed(name, value) {\n  var re = new RegExp(\"(^|\\\\s+)\" + d3.requote(name) + \"(\\\\s+|$)\", \"g\");\n\n  // If no value is specified, return the first value.\n  if (arguments.length < 2) {\n    var node = this.node();\n    if (c = node.classList) return c.contains(name);\n    var c = node.className;\n    re.lastIndex = 0;\n    return re.test(c.baseVal != null ? c.baseVal : c);\n  }\n\n  function classedAdd() {\n    if (c = this.classList) return c.add(name);\n    var c = this.className,\n        cb = c.baseVal != null,\n        cv = cb ? c.baseVal : c;\n    re.lastIndex = 0;\n    if (!re.test(cv)) {\n      cv = d3_collapse(cv + \" \" + name);\n      if (cb) c.baseVal = cv;\n      else this.className = cv;\n    }\n  }\n\n  function classedRemove() {\n    if (c = this.classList) return c.remove(name);\n    var c = this.className,\n        cb = c.baseVal != null,\n        cv = cb ? c.baseVal : c;\n    cv = d3_collapse(cv.replace(re, \" \"));\n    if (cb) c.baseVal = cv;\n    else this.className = cv;\n  }\n\n  function classedFunction() {\n    (value.apply(this, arguments)\n        ? classedAdd\n        : classedRemove).call(this);\n  }\n\n  return this.each(typeof value === \"function\"\n      ? classedFunction : value\n      ? classedAdd\n      : classedRemove);\n}\nd3_selectionPrototype.style = function(name, value, priority) {\n  if (arguments.length < 3) priority = \"\";\n\n  // If no value is specified, return the first value.\n  if (arguments.length < 2) return window\n      .getComputedStyle(this.node(), null)\n      .getPropertyValue(name);\n\n  function styleNull() {\n    this.style.removeProperty(name);\n  }\n\n  function styleConstant() {\n    this.style.setProperty(name, value, priority);\n  }\n\n  function styleFunction() {\n    var x = value.apply(this, arguments);\n    if (x == null) this.style.removeProperty(name);\n    else this.style.setProperty(name, x, priority);\n  }\n\n  return this.each(value == null\n      ? styleNull : (typeof value === \"function\"\n      ? styleFunction : styleConstant));\n};\nd3_selectionPrototype.property = function(name, value) {\n\n  // If no value is specified, return the first value.\n  if (arguments.length < 2) return this.node()[name];\n\n  function propertyNull() {\n    delete this[name];\n  }\n\n  function propertyConstant() {\n    this[name] = value;\n  }\n\n  function propertyFunction() {\n    var x = value.apply(this, arguments);\n    if (x == null) delete this[name];\n    else this[name] = x;\n  }\n\n  return this.each(value == null\n      ? propertyNull : (typeof value === \"function\"\n      ? propertyFunction : propertyConstant));\n};\nd3_selectionPrototype.text = function(value) {\n  return arguments.length < 1\n      ? this.node().textContent : this.each(typeof value === \"function\"\n      ? function() { var v = value.apply(this, arguments); this.textContent = v == null ? \"\" : v; } : value == null\n      ? function() { this.textContent = \"\"; }\n      : function() { this.textContent = value; });\n};\nd3_selectionPrototype.html = function(value) {\n  return arguments.length < 1\n      ? this.node().innerHTML : this.each(typeof value === \"function\"\n      ? function() { var v = value.apply(this, arguments); this.innerHTML = v == null ? \"\" : v; } : value == null\n      ? function() { this.innerHTML = \"\"; }\n      : function() { this.innerHTML = value; });\n};\n// TODO append(node)?\n// TODO append(function)?\nd3_selectionPrototype.append = function(name) {\n  name = d3.ns.qualify(name);\n\n  function append() {\n    return this.appendChild(document.createElementNS(this.namespaceURI, name));\n  }\n\n  function appendNS() {\n    return this.appendChild(document.createElementNS(name.space, name.local));\n  }\n\n  return this.select(name.local ? appendNS : append);\n};\n// TODO insert(node, function)?\n// TODO insert(function, string)?\n// TODO insert(function, function)?\nd3_selectionPrototype.insert = function(name, before) {\n  name = d3.ns.qualify(name);\n\n  function insert() {\n    return this.insertBefore(\n        document.createElementNS(this.namespaceURI, name),\n        d3_select(before, this));\n  }\n\n  function insertNS() {\n    return this.insertBefore(\n        document.createElementNS(name.space, name.local),\n        d3_select(before, this));\n  }\n\n  return this.select(name.local ? insertNS : insert);\n};\n// TODO remove(selector)?\n// TODO remove(node)?\n// TODO remove(function)?\nd3_selectionPrototype.remove = function() {\n  return this.each(function() {\n    var parent = this.parentNode;\n    if (parent) parent.removeChild(this);\n  });\n};\nd3_selectionPrototype.data = function(value, key) {\n  var i = -1,\n      n = this.length,\n      group,\n      node;\n\n  // If no value is specified, return the first value.\n  if (!arguments.length) {\n    value = new Array(n = (group = this[0]).length);\n    while (++i < n) {\n      if (node = group[i]) {\n        value[i] = node.__data__;\n      }\n    }\n    return value;\n  }\n\n  function bind(group, groupData) {\n    var i,\n        n = group.length,\n        m = groupData.length,\n        n0 = Math.min(n, m),\n        n1 = Math.max(n, m),\n        updateNodes = [],\n        enterNodes = [],\n        exitNodes = [],\n        node,\n        nodeData;\n\n    if (key) {\n      var nodeByKeyValue = new d3_Map,\n          keyValues = [],\n          keyValue,\n          j = groupData.length;\n\n      for (i = -1; ++i < n;) {\n        keyValue = key.call(node = group[i], node.__data__, i);\n        if (nodeByKeyValue.has(keyValue)) {\n          exitNodes[j++] = node; // duplicate key\n        } else {\n          nodeByKeyValue.set(keyValue, node);\n        }\n        keyValues.push(keyValue);\n      }\n\n      for (i = -1; ++i < m;) {\n        keyValue = key.call(groupData, nodeData = groupData[i], i)\n        if (nodeByKeyValue.has(keyValue)) {\n          updateNodes[i] = node = nodeByKeyValue.get(keyValue);\n          node.__data__ = nodeData;\n          enterNodes[i] = exitNodes[i] = null;\n        } else {\n          enterNodes[i] = d3_selection_dataNode(nodeData);\n          updateNodes[i] = exitNodes[i] = null;\n        }\n        nodeByKeyValue.remove(keyValue);\n      }\n\n      for (i = -1; ++i < n;) {\n        if (nodeByKeyValue.has(keyValues[i])) {\n          exitNodes[i] = group[i];\n        }\n      }\n    } else {\n      for (i = -1; ++i < n0;) {\n        node = group[i];\n        nodeData = groupData[i];\n        if (node) {\n          node.__data__ = nodeData;\n          updateNodes[i] = node;\n          enterNodes[i] = exitNodes[i] = null;\n        } else {\n          enterNodes[i] = d3_selection_dataNode(nodeData);\n          updateNodes[i] = exitNodes[i] = null;\n        }\n      }\n      for (; i < m; ++i) {\n        enterNodes[i] = d3_selection_dataNode(groupData[i]);\n        updateNodes[i] = exitNodes[i] = null;\n      }\n      for (; i < n1; ++i) {\n        exitNodes[i] = group[i];\n        enterNodes[i] = updateNodes[i] = null;\n      }\n    }\n\n    enterNodes.update\n        = updateNodes;\n\n    enterNodes.parentNode\n        = updateNodes.parentNode\n        = exitNodes.parentNode\n        = group.parentNode;\n\n    enter.push(enterNodes);\n    update.push(updateNodes);\n    exit.push(exitNodes);\n  }\n\n  var enter = d3_selection_enter([]),\n      update = d3_selection([]),\n      exit = d3_selection([]);\n\n  if (typeof value === \"function\") {\n    while (++i < n) {\n      bind(group = this[i], value.call(group, group.parentNode.__data__, i));\n    }\n  } else {\n    while (++i < n) {\n      bind(group = this[i], value);\n    }\n  }\n\n  update.enter = function() { return enter; };\n  update.exit = function() { return exit; };\n  return update;\n};\n\nfunction d3_selection_dataNode(data) {\n  return {__data__: data};\n}\nd3_selectionPrototype.datum =\nd3_selectionPrototype.map = function(value) {\n  return arguments.length < 1\n      ? this.property(\"__data__\")\n      : this.property(\"__data__\", value);\n};\nd3_selectionPrototype.filter = function(filter) {\n  var subgroups = [],\n      subgroup,\n      group,\n      node;\n\n  if (typeof filter !== \"function\") filter = d3_selection_filter(filter);\n\n  for (var j = 0, m = this.length; j < m; j++) {\n    subgroups.push(subgroup = []);\n    subgroup.parentNode = (group = this[j]).parentNode;\n    for (var i = 0, n = group.length; i < n; i++) {\n      if ((node = group[i]) && filter.call(node, node.__data__, i)) {\n        subgroup.push(node);\n      }\n    }\n  }\n\n  return d3_selection(subgroups);\n};\n\nfunction d3_selection_filter(selector) {\n  return function() {\n    return d3_selectMatches(this, selector);\n  };\n}\nd3_selectionPrototype.order = function() {\n  for (var j = -1, m = this.length; ++j < m;) {\n    for (var group = this[j], i = group.length - 1, next = group[i], node; --i >= 0;) {\n      if (node = group[i]) {\n        if (next && next !== node.nextSibling) next.parentNode.insertBefore(node, next);\n        next = node;\n      }\n    }\n  }\n  return this;\n};\nd3_selectionPrototype.sort = function(comparator) {\n  comparator = d3_selection_sortComparator.apply(this, arguments);\n  for (var j = -1, m = this.length; ++j < m;) this[j].sort(comparator);\n  return this.order();\n};\n\nfunction d3_selection_sortComparator(comparator) {\n  if (!arguments.length) comparator = d3.ascending;\n  return function(a, b) {\n    return comparator(a && a.__data__, b && b.__data__);\n  };\n}\n// type can be namespaced, e.g., \"click.foo\"\n// listener can be null for removal\nd3_selectionPrototype.on = function(type, listener, capture) {\n  if (arguments.length < 3) capture = false;\n\n  // parse the type specifier\n  var name = \"__on\" + type, i = type.indexOf(\".\");\n  if (i > 0) type = type.substring(0, i);\n\n  // if called with only one argument, return the current listener\n  if (arguments.length < 2) return (i = this.node()[name]) && i._;\n\n  // remove the old event listener, and add the new event listener\n  return this.each(function(d, i) {\n    var node = this,\n        o = node[name];\n\n    // remove the old listener, if any (using the previously-set capture)\n    if (o) {\n      node.removeEventListener(type, o, o.$);\n      delete node[name];\n    }\n\n    // add the new listener, if any (remembering the capture flag)\n    if (listener) {\n      node.addEventListener(type, node[name] = l, l.$ = capture);\n      l._ = listener; // stash the unwrapped listener for get\n    }\n\n    // wrapped event listener that preserves i\n    function l(e) {\n      var o = d3.event; // Events can be reentrant (e.g., focus).\n      d3.event = e;\n      try {\n        listener.call(node, node.__data__, i);\n      } finally {\n        d3.event = o;\n      }\n    }\n  });\n};\nd3_selectionPrototype.each = function(callback) {\n  return d3_selection_each(this, function(node, i, j) {\n    callback.call(node, node.__data__, i, j);\n  });\n};\n\nfunction d3_selection_each(groups, callback) {\n  for (var j = 0, m = groups.length; j < m; j++) {\n    for (var group = groups[j], i = 0, n = group.length, node; i < n; i++) {\n      if (node = group[i]) callback(node, i, j);\n    }\n  }\n  return groups;\n}\n//\n// Note: assigning to the arguments array simultaneously changes the value of\n// the corresponding argument!\n//\n// TODO The `this` argument probably shouldn't be the first argument to the\n// callback, anyway, since it's redundant. However, that will require a major\n// version bump due to backwards compatibility, so I'm not changing it right\n// away.\n//\nd3_selectionPrototype.call = function(callback) {\n  callback.apply(this, (arguments[0] = this, arguments));\n  return this;\n};\nd3_selectionPrototype.empty = function() {\n  return !this.node();\n};\nd3_selectionPrototype.node = function(callback) {\n  for (var j = 0, m = this.length; j < m; j++) {\n    for (var group = this[j], i = 0, n = group.length; i < n; i++) {\n      var node = group[i];\n      if (node) return node;\n    }\n  }\n  return null;\n};\nd3_selectionPrototype.transition = function() {\n  var subgroups = [],\n      subgroup,\n      node;\n\n  for (var j = -1, m = this.length; ++j < m;) {\n    subgroups.push(subgroup = []);\n    for (var group = this[j], i = -1, n = group.length; ++i < n;) {\n      subgroup.push((node = group[i]) ? {node: node, delay: d3_transitionDelay, duration: d3_transitionDuration} : null);\n    }\n  }\n\n  return d3_transition(subgroups, d3_transitionId || ++d3_transitionNextId, Date.now());\n};\nvar d3_selectionRoot = d3_selection([[document]]);\n\nd3_selectionRoot[0].parentNode = d3_selectRoot;\n\n// TODO fast singleton implementation!\n// TODO select(function)\nd3.select = function(selector) {\n  return typeof selector === \"string\"\n      ? d3_selectionRoot.select(selector)\n      : d3_selection([[selector]]); // assume node\n};\n\n// TODO selectAll(function)\nd3.selectAll = function(selector) {\n  return typeof selector === \"string\"\n      ? d3_selectionRoot.selectAll(selector)\n      : d3_selection([d3_array(selector)]); // assume node[]\n};\nfunction d3_selection_enter(selection) {\n  d3_arraySubclass(selection, d3_selection_enterPrototype);\n  return selection;\n}\n\nvar d3_selection_enterPrototype = [];\n\nd3.selection.enter = d3_selection_enter;\nd3.selection.enter.prototype = d3_selection_enterPrototype;\n\nd3_selection_enterPrototype.append = d3_selectionPrototype.append;\nd3_selection_enterPrototype.insert = d3_selectionPrototype.insert;\nd3_selection_enterPrototype.empty = d3_selectionPrototype.empty;\nd3_selection_enterPrototype.node = d3_selectionPrototype.node;\nd3_selection_enterPrototype.select = function(selector) {\n  var subgroups = [],\n      subgroup,\n      subnode,\n      upgroup,\n      group,\n      node;\n\n  for (var j = -1, m = this.length; ++j < m;) {\n    upgroup = (group = this[j]).update;\n    subgroups.push(subgroup = []);\n    subgroup.parentNode = group.parentNode;\n    for (var i = -1, n = group.length; ++i < n;) {\n      if (node = group[i]) {\n        subgroup.push(upgroup[i] = subnode = selector.call(group.parentNode, node.__data__, i));\n        subnode.__data__ = node.__data__;\n      } else {\n        subgroup.push(null);\n      }\n    }\n  }\n\n  return d3_selection(subgroups);\n};\nfunction d3_transition(groups, id, time) {\n  d3_arraySubclass(groups, d3_transitionPrototype);\n\n  var tweens = new d3_Map,\n      event = d3.dispatch(\"start\", \"end\"),\n      ease = d3_transitionEase;\n\n  groups.id = id;\n\n  groups.time = time;\n\n  groups.tween = function(name, tween) {\n    if (arguments.length < 2) return tweens.get(name);\n    if (tween == null) tweens.remove(name);\n    else tweens.set(name, tween);\n    return groups;\n  };\n\n  groups.ease = function(value) {\n    if (!arguments.length) return ease;\n    ease = typeof value === \"function\" ? value : d3.ease.apply(d3, arguments);\n    return groups;\n  };\n\n  groups.each = function(type, listener) {\n    if (arguments.length < 2) return d3_transition_each.call(groups, type);\n    event.on(type, listener);\n    return groups;\n  };\n\n  d3.timer(function(elapsed) {\n    return d3_selection_each(groups, function(node, i, j) {\n      var tweened = [],\n          delay = node.delay,\n          duration = node.duration,\n          lock = (node = node.node).__transition__ || (node.__transition__ = {active: 0, count: 0}),\n          d = node.__data__;\n\n      ++lock.count;\n\n      delay <= elapsed ? start(elapsed) : d3.timer(start, delay, time);\n\n      function start(elapsed) {\n        if (lock.active > id) return stop();\n        lock.active = id;\n\n        tweens.forEach(function(key, value) {\n          if (value = value.call(node, d, i)) {\n            tweened.push(value);\n          }\n        });\n\n        event.start.call(node, d, i);\n        if (!tick(elapsed)) d3.timer(tick, 0, time);\n        return 1;\n      }\n\n      function tick(elapsed) {\n        if (lock.active !== id) return stop();\n\n        var t = (elapsed - delay) / duration,\n            e = ease(t),\n            n = tweened.length;\n\n        while (n > 0) {\n          tweened[--n].call(node, e);\n        }\n\n        if (t >= 1) {\n          stop();\n          d3_transitionId = id;\n          event.end.call(node, d, i);\n          d3_transitionId = 0;\n          return 1;\n        }\n      }\n\n      function stop() {\n        if (!--lock.count) delete node.__transition__;\n        return 1;\n      }\n    });\n  }, 0, time);\n\n  return groups;\n}\n\nvar d3_transitionRemove = {};\n\nfunction d3_transitionNull(d, i, a) {\n  return a != \"\" && d3_transitionRemove;\n}\n\nfunction d3_transitionTween(name, b) {\n  var interpolate = d3_interpolateByName(name);\n\n  function transitionFunction(d, i, a) {\n    var v = b.call(this, d, i);\n    return v == null\n        ? a != \"\" && d3_transitionRemove\n        : a != v && interpolate(a, v);\n  }\n\n  function transitionString(d, i, a) {\n    return a != b && interpolate(a, b);\n  }\n\n  return typeof b === \"function\" ? transitionFunction\n      : b == null ? d3_transitionNull\n      : (b += \"\", transitionString);\n}\n\nvar d3_transitionPrototype = [],\n    d3_transitionNextId = 0,\n    d3_transitionId = 0,\n    d3_transitionDefaultDelay = 0,\n    d3_transitionDefaultDuration = 250,\n    d3_transitionDefaultEase = d3.ease(\"cubic-in-out\"),\n    d3_transitionDelay = d3_transitionDefaultDelay,\n    d3_transitionDuration = d3_transitionDefaultDuration,\n    d3_transitionEase = d3_transitionDefaultEase;\n\nd3_transitionPrototype.call = d3_selectionPrototype.call;\n\nd3.transition = function(selection) {\n  return arguments.length\n      ? (d3_transitionId ? selection.transition() : selection)\n      : d3_selectionRoot.transition();\n};\n\nd3.transition.prototype = d3_transitionPrototype;\nd3_transitionPrototype.select = function(selector) {\n  var subgroups = [],\n      subgroup,\n      subnode,\n      node;\n\n  if (typeof selector !== \"function\") selector = d3_selection_selector(selector);\n\n  for (var j = -1, m = this.length; ++j < m;) {\n    subgroups.push(subgroup = []);\n    for (var group = this[j], i = -1, n = group.length; ++i < n;) {\n      if ((node = group[i]) && (subnode = selector.call(node.node, node.node.__data__, i))) {\n        if (\"__data__\" in node.node) subnode.__data__ = node.node.__data__;\n        subgroup.push({node: subnode, delay: node.delay, duration: node.duration});\n      } else {\n        subgroup.push(null);\n      }\n    }\n  }\n\n  return d3_transition(subgroups, this.id, this.time).ease(this.ease());\n};\nd3_transitionPrototype.selectAll = function(selector) {\n  var subgroups = [],\n      subgroup,\n      subnodes,\n      node;\n\n  if (typeof selector !== \"function\") selector = d3_selection_selectorAll(selector);\n\n  for (var j = -1, m = this.length; ++j < m;) {\n    for (var group = this[j], i = -1, n = group.length; ++i < n;) {\n      if (node = group[i]) {\n        subnodes = selector.call(node.node, node.node.__data__, i);\n        subgroups.push(subgroup = []);\n        for (var k = -1, o = subnodes.length; ++k < o;) {\n          subgroup.push({node: subnodes[k], delay: node.delay, duration: node.duration});\n        }\n      }\n    }\n  }\n\n  return d3_transition(subgroups, this.id, this.time).ease(this.ease());\n};\nd3_transitionPrototype.attr = function(name, value) {\n  return this.attrTween(name, d3_transitionTween(name, value));\n};\n\nd3_transitionPrototype.attrTween = function(nameNS, tween) {\n  var name = d3.ns.qualify(nameNS);\n\n  function attrTween(d, i) {\n    var f = tween.call(this, d, i, this.getAttribute(name));\n    return f === d3_transitionRemove\n        ? (this.removeAttribute(name), null)\n        : f && function(t) { this.setAttribute(name, f(t)); };\n  }\n\n  function attrTweenNS(d, i) {\n    var f = tween.call(this, d, i, this.getAttributeNS(name.space, name.local));\n    return f === d3_transitionRemove\n        ? (this.removeAttributeNS(name.space, name.local), null)\n        : f && function(t) { this.setAttributeNS(name.space, name.local, f(t)); };\n  }\n\n  return this.tween(\"attr.\" + nameNS, name.local ? attrTweenNS : attrTween);\n};\nd3_transitionPrototype.style = function(name, value, priority) {\n  if (arguments.length < 3) priority = \"\";\n  return this.styleTween(name, d3_transitionTween(name, value), priority);\n};\n\nd3_transitionPrototype.styleTween = function(name, tween, priority) {\n  if (arguments.length < 3) priority = \"\";\n  return this.tween(\"style.\" + name, function(d, i) {\n    var f = tween.call(this, d, i, window.getComputedStyle(this, null).getPropertyValue(name));\n    return f === d3_transitionRemove\n        ? (this.style.removeProperty(name), null)\n        : f && function(t) { this.style.setProperty(name, f(t), priority); };\n  });\n};\nd3_transitionPrototype.text = function(value) {\n  return this.tween(\"text\", function(d, i) {\n    this.textContent = typeof value === \"function\"\n        ? value.call(this, d, i)\n        : value;\n  });\n};\nd3_transitionPrototype.remove = function() {\n  return this.each(\"end.transition\", function() {\n    var p;\n    if (!this.__transition__ && (p = this.parentNode)) p.removeChild(this);\n  });\n};\nd3_transitionPrototype.delay = function(value) {\n  return d3_selection_each(this, typeof value === \"function\"\n      ? function(node, i, j) { node.delay = value.call(node = node.node, node.__data__, i, j) | 0; }\n      : (value = value | 0, function(node) { node.delay = value; }));\n};\nd3_transitionPrototype.duration = function(value) {\n  return d3_selection_each(this, typeof value === \"function\"\n      ? function(node, i, j) { node.duration = Math.max(1, value.call(node = node.node, node.__data__, i, j) | 0); }\n      : (value = Math.max(1, value | 0), function(node) { node.duration = value; }));\n};\nfunction d3_transition_each(callback) {\n  var id = d3_transitionId,\n      ease = d3_transitionEase,\n      delay = d3_transitionDelay,\n      duration = d3_transitionDuration;\n\n  d3_transitionId = this.id;\n  d3_transitionEase = this.ease();\n  d3_selection_each(this, function(node, i, j) {\n    d3_transitionDelay = node.delay;\n    d3_transitionDuration = node.duration;\n    callback.call(node = node.node, node.__data__, i, j);\n  });\n\n  d3_transitionId = id;\n  d3_transitionEase = ease;\n  d3_transitionDelay = delay;\n  d3_transitionDuration = duration;\n  return this;\n}\nd3_transitionPrototype.transition = function() {\n  return this.select(d3_this);\n};\nvar d3_timer_queue = null,\n    d3_timer_interval, // is an interval (or frame) active?\n    d3_timer_timeout; // is a timeout active?\n\n// The timer will continue to fire until callback returns true.\nd3.timer = function(callback, delay, then) {\n  var found = false,\n      t0,\n      t1 = d3_timer_queue;\n\n  if (arguments.length < 3) {\n    if (arguments.length < 2) delay = 0;\n    else if (!isFinite(delay)) return;\n    then = Date.now();\n  }\n\n  // See if the callback's already in the queue.\n  while (t1) {\n    if (t1.callback === callback) {\n      t1.then = then;\n      t1.delay = delay;\n      found = true;\n      break;\n    }\n    t0 = t1;\n    t1 = t1.next;\n  }\n\n  // Otherwise, add the callback to the queue.\n  if (!found) d3_timer_queue = {\n    callback: callback,\n    then: then,\n    delay: delay,\n    next: d3_timer_queue\n  };\n\n  // Start animatin'!\n  if (!d3_timer_interval) {\n    d3_timer_timeout = clearTimeout(d3_timer_timeout);\n    d3_timer_interval = 1;\n    d3_timer_frame(d3_timer_step);\n  }\n}\n\nfunction d3_timer_step() {\n  var elapsed,\n      now = Date.now(),\n      t1 = d3_timer_queue;\n\n  while (t1) {\n    elapsed = now - t1.then;\n    if (elapsed >= t1.delay) t1.flush = t1.callback(elapsed);\n    t1 = t1.next;\n  }\n\n  var delay = d3_timer_flush() - now;\n  if (delay > 24) {\n    if (isFinite(delay)) {\n      clearTimeout(d3_timer_timeout);\n      d3_timer_timeout = setTimeout(d3_timer_step, delay);\n    }\n    d3_timer_interval = 0;\n  } else {\n    d3_timer_interval = 1;\n    d3_timer_frame(d3_timer_step);\n  }\n}\n\nd3.timer.flush = function() {\n  var elapsed,\n      now = Date.now(),\n      t1 = d3_timer_queue;\n\n  while (t1) {\n    elapsed = now - t1.then;\n    if (!t1.delay) t1.flush = t1.callback(elapsed);\n    t1 = t1.next;\n  }\n\n  d3_timer_flush();\n};\n\n// Flush after callbacks, to avoid concurrent queue modification.\nfunction d3_timer_flush() {\n  var t0 = null,\n      t1 = d3_timer_queue,\n      then = Infinity;\n  while (t1) {\n    if (t1.flush) {\n      t1 = t0 ? t0.next = t1.next : d3_timer_queue = t1.next;\n    } else {\n      then = Math.min(then, t1.then + t1.delay);\n      t1 = (t0 = t1).next;\n    }\n  }\n  return then;\n}\n\nvar d3_timer_frame = window.requestAnimationFrame\n    || window.webkitRequestAnimationFrame\n    || window.mozRequestAnimationFrame\n    || window.oRequestAnimationFrame\n    || window.msRequestAnimationFrame\n    || function(callback) { setTimeout(callback, 17); };\nd3.transform = function(string) {\n  var g = document.createElementNS(d3.ns.prefix.svg, \"g\"),\n      identity = {a: 1, b: 0, c: 0, d: 1, e: 0, f: 0};\n  return (d3.transform = function(string) {\n    g.setAttribute(\"transform\", string);\n    var t = g.transform.baseVal.consolidate();\n    return new d3_transform(t ? t.matrix : identity);\n  })(string);\n};\n\n// Compute x-scale and normalize the first row.\n// Compute shear and make second row orthogonal to first.\n// Compute y-scale and normalize the second row.\n// Finally, compute the rotation.\nfunction d3_transform(m) {\n  var r0 = [m.a, m.b],\n      r1 = [m.c, m.d],\n      kx = d3_transformNormalize(r0),\n      kz = d3_transformDot(r0, r1),\n      ky = d3_transformNormalize(d3_transformCombine(r1, r0, -kz)) || 0;\n  if (r0[0] * r1[1] < r1[0] * r0[1]) {\n    r0[0] *= -1;\n    r0[1] *= -1;\n    kx *= -1;\n    kz *= -1;\n  }\n  this.rotate = (kx ? Math.atan2(r0[1], r0[0]) : Math.atan2(-r1[0], r1[1])) * d3_transformDegrees;\n  this.translate = [m.e, m.f];\n  this.scale = [kx, ky];\n  this.skew = ky ? Math.atan2(kz, ky) * d3_transformDegrees : 0;\n};\n\nd3_transform.prototype.toString = function() {\n  return \"translate(\" + this.translate\n      + \")rotate(\" + this.rotate\n      + \")skewX(\" + this.skew\n      + \")scale(\" + this.scale\n      + \")\";\n};\n\nfunction d3_transformDot(a, b) {\n  return a[0] * b[0] + a[1] * b[1];\n}\n\nfunction d3_transformNormalize(a) {\n  var k = Math.sqrt(d3_transformDot(a, a));\n  if (k) {\n    a[0] /= k;\n    a[1] /= k;\n  }\n  return k;\n}\n\nfunction d3_transformCombine(a, b, k) {\n  a[0] += k * b[0];\n  a[1] += k * b[1];\n  return a;\n}\n\nvar d3_transformDegrees = 180 / Math.PI;\nd3.mouse = function(container) {\n  return d3_mousePoint(container, d3_eventSource());\n};\n\n// https://bugs.webkit.org/show_bug.cgi?id=44083\nvar d3_mouse_bug44083 = /WebKit/.test(navigator.userAgent) ? -1 : 0;\n\nfunction d3_mousePoint(container, e) {\n  var svg = container.ownerSVGElement || container;\n  if (svg.createSVGPoint) {\n    var point = svg.createSVGPoint();\n    if ((d3_mouse_bug44083 < 0) && (window.scrollX || window.scrollY)) {\n      svg = d3.select(document.body)\n        .append(\"svg\")\n          .style(\"position\", \"absolute\")\n          .style(\"top\", 0)\n          .style(\"left\", 0);\n      var ctm = svg[0][0].getScreenCTM();\n      d3_mouse_bug44083 = !(ctm.f || ctm.e);\n      svg.remove();\n    }\n    if (d3_mouse_bug44083) {\n      point.x = e.pageX;\n      point.y = e.pageY;\n    } else {\n      point.x = e.clientX;\n      point.y = e.clientY;\n    }\n    point = point.matrixTransform(container.getScreenCTM().inverse());\n    return [point.x, point.y];\n  }\n  var rect = container.getBoundingClientRect();\n  return [e.clientX - rect.left - container.clientLeft, e.clientY - rect.top - container.clientTop];\n};\nd3.touches = function(container, touches) {\n  if (arguments.length < 2) touches = d3_eventSource().touches;\n  return touches ? d3_array(touches).map(function(touch) {\n    var point = d3_mousePoint(container, touch);\n    point.identifier = touch.identifier;\n    return point;\n  }) : [];\n};\nfunction d3_noop() {}\nd3.scale = {};\n\nfunction d3_scaleExtent(domain) {\n  var start = domain[0], stop = domain[domain.length - 1];\n  return start < stop ? [start, stop] : [stop, start];\n}\n\nfunction d3_scaleRange(scale) {\n  return scale.rangeExtent ? scale.rangeExtent() : d3_scaleExtent(scale.range());\n}\nfunction d3_scale_nice(domain, nice) {\n  var i0 = 0,\n      i1 = domain.length - 1,\n      x0 = domain[i0],\n      x1 = domain[i1],\n      dx;\n\n  if (x1 < x0) {\n    dx = i0; i0 = i1; i1 = dx;\n    dx = x0; x0 = x1; x1 = dx;\n  }\n\n  if (dx = x1 - x0) {\n    nice = nice(dx);\n    domain[i0] = nice.floor(x0);\n    domain[i1] = nice.ceil(x1);\n  }\n\n  return domain;\n}\n\nfunction d3_scale_niceDefault() {\n  return Math;\n}\nd3.scale.linear = function() {\n  return d3_scale_linear([0, 1], [0, 1], d3.interpolate, false);\n};\n\nfunction d3_scale_linear(domain, range, interpolate, clamp) {\n  var output,\n      input;\n\n  function rescale() {\n    var linear = Math.min(domain.length, range.length) > 2 ? d3_scale_polylinear : d3_scale_bilinear,\n        uninterpolate = clamp ? d3_uninterpolateClamp : d3_uninterpolateNumber;\n    output = linear(domain, range, uninterpolate, interpolate);\n    input = linear(range, domain, uninterpolate, d3.interpolate);\n    return scale;\n  }\n\n  function scale(x) {\n    return output(x);\n  }\n\n  // Note: requires range is coercible to number!\n  scale.invert = function(y) {\n    return input(y);\n  };\n\n  scale.domain = function(x) {\n    if (!arguments.length) return domain;\n    domain = x.map(Number);\n    return rescale();\n  };\n\n  scale.range = function(x) {\n    if (!arguments.length) return range;\n    range = x;\n    return rescale();\n  };\n\n  scale.rangeRound = function(x) {\n    return scale.range(x).interpolate(d3.interpolateRound);\n  };\n\n  scale.clamp = function(x) {\n    if (!arguments.length) return clamp;\n    clamp = x;\n    return rescale();\n  };\n\n  scale.interpolate = function(x) {\n    if (!arguments.length) return interpolate;\n    interpolate = x;\n    return rescale();\n  };\n\n  scale.ticks = function(m) {\n    return d3_scale_linearTicks(domain, m);\n  };\n\n  scale.tickFormat = function(m) {\n    return d3_scale_linearTickFormat(domain, m);\n  };\n\n  scale.nice = function() {\n    d3_scale_nice(domain, d3_scale_linearNice);\n    return rescale();\n  };\n\n  scale.copy = function() {\n    return d3_scale_linear(domain, range, interpolate, clamp);\n  };\n\n  return rescale();\n}\n\nfunction d3_scale_linearRebind(scale, linear) {\n  return d3.rebind(scale, linear, \"range\", \"rangeRound\", \"interpolate\", \"clamp\");\n}\n\nfunction d3_scale_linearNice(dx) {\n  dx = Math.pow(10, Math.round(Math.log(dx) / Math.LN10) - 1);\n  return {\n    floor: function(x) { return Math.floor(x / dx) * dx; },\n    ceil: function(x) { return Math.ceil(x / dx) * dx; }\n  };\n}\n\nfunction d3_scale_linearTickRange(domain, m) {\n  var extent = d3_scaleExtent(domain),\n      span = extent[1] - extent[0],\n      step = Math.pow(10, Math.floor(Math.log(span / m) / Math.LN10)),\n      err = m / span * step;\n\n  // Filter ticks to get closer to the desired count.\n  if (err <= .15) step *= 10;\n  else if (err <= .35) step *= 5;\n  else if (err <= .75) step *= 2;\n\n  // Round start and stop values to step interval.\n  extent[0] = Math.ceil(extent[0] / step) * step;\n  extent[1] = Math.floor(extent[1] / step) * step + step * .5; // inclusive\n  extent[2] = step;\n  return extent;\n}\n\nfunction d3_scale_linearTicks(domain, m) {\n  return d3.range.apply(d3, d3_scale_linearTickRange(domain, m));\n}\n\nfunction d3_scale_linearTickFormat(domain, m) {\n  return d3.format(\",.\" + Math.max(0, -Math.floor(Math.log(d3_scale_linearTickRange(domain, m)[2]) / Math.LN10 + .01)) + \"f\");\n}\nfunction d3_scale_bilinear(domain, range, uninterpolate, interpolate) {\n  var u = uninterpolate(domain[0], domain[1]),\n      i = interpolate(range[0], range[1]);\n  return function(x) {\n    return i(u(x));\n  };\n}\nfunction d3_scale_polylinear(domain, range, uninterpolate, interpolate) {\n  var u = [],\n      i = [],\n      j = 0,\n      k = Math.min(domain.length, range.length) - 1;\n\n  // Handle descending domains.\n  if (domain[k] < domain[0]) {\n    domain = domain.slice().reverse();\n    range = range.slice().reverse();\n  }\n\n  while (++j <= k) {\n    u.push(uninterpolate(domain[j - 1], domain[j]));\n    i.push(interpolate(range[j - 1], range[j]));\n  }\n\n  return function(x) {\n    var j = d3.bisect(domain, x, 1, k) - 1;\n    return i[j](u[j](x));\n  };\n}\nd3.scale.log = function() {\n  return d3_scale_log(d3.scale.linear(), d3_scale_logp);\n};\n\nfunction d3_scale_log(linear, log) {\n  var pow = log.pow;\n\n  function scale(x) {\n    return linear(log(x));\n  }\n\n  scale.invert = function(x) {\n    return pow(linear.invert(x));\n  };\n\n  scale.domain = function(x) {\n    if (!arguments.length) return linear.domain().map(pow);\n    log = x[0] < 0 ? d3_scale_logn : d3_scale_logp;\n    pow = log.pow;\n    linear.domain(x.map(log));\n    return scale;\n  };\n\n  scale.nice = function() {\n    linear.domain(d3_scale_nice(linear.domain(), d3_scale_niceDefault));\n    return scale;\n  };\n\n  scale.ticks = function() {\n    var extent = d3_scaleExtent(linear.domain()),\n        ticks = [];\n    if (extent.every(isFinite)) {\n      var i = Math.floor(extent[0]),\n          j = Math.ceil(extent[1]),\n          u = pow(extent[0]),\n          v = pow(extent[1]);\n      if (log === d3_scale_logn) {\n        ticks.push(pow(i));\n        for (; i++ < j;) for (var k = 9; k > 0; k--) ticks.push(pow(i) * k);\n      } else {\n        for (; i < j; i++) for (var k = 1; k < 10; k++) ticks.push(pow(i) * k);\n        ticks.push(pow(i));\n      }\n      for (i = 0; ticks[i] < u; i++) {} // strip small values\n      for (j = ticks.length; ticks[j - 1] > v; j--) {} // strip big values\n      ticks = ticks.slice(i, j);\n    }\n    return ticks;\n  };\n\n  scale.tickFormat = function(n, format) {\n    if (arguments.length < 2) format = d3_scale_logFormat;\n    if (arguments.length < 1) return format;\n    var k = Math.max(.1, n / scale.ticks().length),\n        f = log === d3_scale_logn ? (e = -1e-12, Math.floor) : (e = 1e-12, Math.ceil),\n        e;\n    return function(d) {\n      return d / pow(f(log(d) + e)) <= k ? format(d) : \"\";\n    };\n  };\n\n  scale.copy = function() {\n    return d3_scale_log(linear.copy(), log);\n  };\n\n  return d3_scale_linearRebind(scale, linear);\n}\n\nvar d3_scale_logFormat = d3.format(\".0e\");\n\nfunction d3_scale_logp(x) {\n  return Math.log(x < 0 ? 0 : x) / Math.LN10;\n}\n\nfunction d3_scale_logn(x) {\n  return -Math.log(x > 0 ? 0 : -x) / Math.LN10;\n}\n\nd3_scale_logp.pow = function(x) {\n  return Math.pow(10, x);\n};\n\nd3_scale_logn.pow = function(x) {\n  return -Math.pow(10, -x);\n};\nd3.scale.pow = function() {\n  return d3_scale_pow(d3.scale.linear(), 1);\n};\n\nfunction d3_scale_pow(linear, exponent) {\n  var powp = d3_scale_powPow(exponent),\n      powb = d3_scale_powPow(1 / exponent);\n\n  function scale(x) {\n    return linear(powp(x));\n  }\n\n  scale.invert = function(x) {\n    return powb(linear.invert(x));\n  };\n\n  scale.domain = function(x) {\n    if (!arguments.length) return linear.domain().map(powb);\n    linear.domain(x.map(powp));\n    return scale;\n  };\n\n  scale.ticks = function(m) {\n    return d3_scale_linearTicks(scale.domain(), m);\n  };\n\n  scale.tickFormat = function(m) {\n    return d3_scale_linearTickFormat(scale.domain(), m);\n  };\n\n  scale.nice = function() {\n    return scale.domain(d3_scale_nice(scale.domain(), d3_scale_linearNice));\n  };\n\n  scale.exponent = function(x) {\n    if (!arguments.length) return exponent;\n    var domain = scale.domain();\n    powp = d3_scale_powPow(exponent = x);\n    powb = d3_scale_powPow(1 / exponent);\n    return scale.domain(domain);\n  };\n\n  scale.copy = function() {\n    return d3_scale_pow(linear.copy(), exponent);\n  };\n\n  return d3_scale_linearRebind(scale, linear);\n}\n\nfunction d3_scale_powPow(e) {\n  return function(x) {\n    return x < 0 ? -Math.pow(-x, e) : Math.pow(x, e);\n  };\n}\nd3.scale.sqrt = function() {\n  return d3.scale.pow().exponent(.5);\n};\nd3.scale.ordinal = function() {\n  return d3_scale_ordinal([], {t: \"range\", x: []});\n};\n\nfunction d3_scale_ordinal(domain, ranger) {\n  var index,\n      range,\n      rangeBand;\n\n  function scale(x) {\n    return range[((index.get(x) || index.set(x, domain.push(x))) - 1) % range.length];\n  }\n\n  function steps(start, step) {\n    return d3.range(domain.length).map(function(i) { return start + step * i; });\n  }\n\n  scale.domain = function(x) {\n    if (!arguments.length) return domain;\n    domain = [];\n    index = new d3_Map;\n    var i = -1, n = x.length, xi;\n    while (++i < n) if (!index.has(xi = x[i])) index.set(xi, domain.push(xi));\n    return scale[ranger.t](ranger.x, ranger.p);\n  };\n\n  scale.range = function(x) {\n    if (!arguments.length) return range;\n    range = x;\n    rangeBand = 0;\n    ranger = {t: \"range\", x: x};\n    return scale;\n  };\n\n  scale.rangePoints = function(x, padding) {\n    if (arguments.length < 2) padding = 0;\n    var start = x[0],\n        stop = x[1],\n        step = (stop - start) / (domain.length - 1 + padding);\n    range = steps(domain.length < 2 ? (start + stop) / 2 : start + step * padding / 2, step);\n    rangeBand = 0;\n    ranger = {t: \"rangePoints\", x: x, p: padding};\n    return scale;\n  };\n\n  scale.rangeBands = function(x, padding) {\n    if (arguments.length < 2) padding = 0;\n    var reverse = x[1] < x[0],\n        start = x[reverse - 0],\n        stop = x[1 - reverse],\n        step = (stop - start) / (domain.length + padding);\n    range = steps(start + step * padding, step);\n    if (reverse) range.reverse();\n    rangeBand = step * (1 - padding);\n    ranger = {t: \"rangeBands\", x: x, p: padding};\n    return scale;\n  };\n\n  scale.rangeRoundBands = function(x, padding) {\n    if (arguments.length < 2) padding = 0;\n    var reverse = x[1] < x[0],\n        start = x[reverse - 0],\n        stop = x[1 - reverse],\n        step = Math.floor((stop - start) / (domain.length + padding)),\n        error = stop - start - (domain.length - padding) * step;\n    range = steps(start + Math.round(error / 2), step);\n    if (reverse) range.reverse();\n    rangeBand = Math.round(step * (1 - padding));\n    ranger = {t: \"rangeRoundBands\", x: x, p: padding};\n    return scale;\n  };\n\n  scale.rangeBand = function() {\n    return rangeBand;\n  };\n\n  scale.rangeExtent = function() {\n    return d3_scaleExtent(ranger.x);\n  };\n\n  scale.copy = function() {\n    return d3_scale_ordinal(domain, ranger);\n  };\n\n  return scale.domain(domain);\n}\n/*\n * This product includes color specifications and designs developed by Cynthia\n * Brewer (http://colorbrewer.org/). See lib/colorbrewer for more information.\n */\n\nd3.scale.category10 = function() {\n  return d3.scale.ordinal().range(d3_category10);\n};\n\nd3.scale.category20 = function() {\n  return d3.scale.ordinal().range(d3_category20);\n};\n\nd3.scale.category20b = function() {\n  return d3.scale.ordinal().range(d3_category20b);\n};\n\nd3.scale.category20c = function() {\n  return d3.scale.ordinal().range(d3_category20c);\n};\n\nvar d3_category10 = [\n  \"#1f77b4\", \"#ff7f0e\", \"#2ca02c\", \"#d62728\", \"#9467bd\",\n  \"#8c564b\", \"#e377c2\", \"#7f7f7f\", \"#bcbd22\", \"#17becf\"\n];\n\nvar d3_category20 = [\n  \"#1f77b4\", \"#aec7e8\",\n  \"#ff7f0e\", \"#ffbb78\",\n  \"#2ca02c\", \"#98df8a\",\n  \"#d62728\", \"#ff9896\",\n  \"#9467bd\", \"#c5b0d5\",\n  \"#8c564b\", \"#c49c94\",\n  \"#e377c2\", \"#f7b6d2\",\n  \"#7f7f7f\", \"#c7c7c7\",\n  \"#bcbd22\", \"#dbdb8d\",\n  \"#17becf\", \"#9edae5\"\n];\n\nvar d3_category20b = [\n  \"#393b79\", \"#5254a3\", \"#6b6ecf\", \"#9c9ede\",\n  \"#637939\", \"#8ca252\", \"#b5cf6b\", \"#cedb9c\",\n  \"#8c6d31\", \"#bd9e39\", \"#e7ba52\", \"#e7cb94\",\n  \"#843c39\", \"#ad494a\", \"#d6616b\", \"#e7969c\",\n  \"#7b4173\", \"#a55194\", \"#ce6dbd\", \"#de9ed6\"\n];\n\nvar d3_category20c = [\n  \"#3182bd\", \"#6baed6\", \"#9ecae1\", \"#c6dbef\",\n  \"#e6550d\", \"#fd8d3c\", \"#fdae6b\", \"#fdd0a2\",\n  \"#31a354\", \"#74c476\", \"#a1d99b\", \"#c7e9c0\",\n  \"#756bb1\", \"#9e9ac8\", \"#bcbddc\", \"#dadaeb\",\n  \"#636363\", \"#969696\", \"#bdbdbd\", \"#d9d9d9\"\n];\nd3.scale.quantile = function() {\n  return d3_scale_quantile([], []);\n};\n\nfunction d3_scale_quantile(domain, range) {\n  var thresholds;\n\n  function rescale() {\n    var k = 0,\n        n = domain.length,\n        q = range.length;\n    thresholds = [];\n    while (++k < q) thresholds[k - 1] = d3.quantile(domain, k / q);\n    return scale;\n  }\n\n  function scale(x) {\n    if (isNaN(x = +x)) return NaN;\n    return range[d3.bisect(thresholds, x)];\n  }\n\n  scale.domain = function(x) {\n    if (!arguments.length) return domain;\n    domain = x.filter(function(d) { return !isNaN(d); }).sort(d3.ascending);\n    return rescale();\n  };\n\n  scale.range = function(x) {\n    if (!arguments.length) return range;\n    range = x;\n    return rescale();\n  };\n\n  scale.quantiles = function() {\n    return thresholds;\n  };\n\n  scale.copy = function() {\n    return d3_scale_quantile(domain, range); // copy on write!\n  };\n\n  return rescale();\n}\nd3.scale.quantize = function() {\n  return d3_scale_quantize(0, 1, [0, 1]);\n};\n\nfunction d3_scale_quantize(x0, x1, range) {\n  var kx, i;\n\n  function scale(x) {\n    return range[Math.max(0, Math.min(i, Math.floor(kx * (x - x0))))];\n  }\n\n  function rescale() {\n    kx = range.length / (x1 - x0);\n    i = range.length - 1;\n    return scale;\n  }\n\n  scale.domain = function(x) {\n    if (!arguments.length) return [x0, x1];\n    x0 = +x[0];\n    x1 = +x[x.length - 1];\n    return rescale();\n  };\n\n  scale.range = function(x) {\n    if (!arguments.length) return range;\n    range = x;\n    return rescale();\n  };\n\n  scale.copy = function() {\n    return d3_scale_quantize(x0, x1, range); // copy on write\n  };\n\n  return rescale();\n}\nd3.scale.identity = function() {\n  return d3_scale_identity([0, 1]);\n};\n\nfunction d3_scale_identity(domain) {\n\n  function identity(x) { return +x; }\n\n  identity.invert = identity;\n\n  identity.domain = identity.range = function(x) {\n    if (!arguments.length) return domain;\n    domain = x.map(identity);\n    return identity;\n  };\n\n  identity.ticks = function(m) {\n    return d3_scale_linearTicks(domain, m);\n  };\n\n  identity.tickFormat = function(m) {\n    return d3_scale_linearTickFormat(domain, m);\n  };\n\n  identity.copy = function() {\n    return d3_scale_identity(domain);\n  };\n\n  return identity;\n}\nd3.svg = {};\nd3.svg.arc = function() {\n  var innerRadius = d3_svg_arcInnerRadius,\n      outerRadius = d3_svg_arcOuterRadius,\n      startAngle = d3_svg_arcStartAngle,\n      endAngle = d3_svg_arcEndAngle;\n\n  function arc() {\n    var r0 = innerRadius.apply(this, arguments),\n        r1 = outerRadius.apply(this, arguments),\n        a0 = startAngle.apply(this, arguments) + d3_svg_arcOffset,\n        a1 = endAngle.apply(this, arguments) + d3_svg_arcOffset,\n        da = (a1 < a0 && (da = a0, a0 = a1, a1 = da), a1 - a0),\n        df = da < Math.PI ? \"0\" : \"1\",\n        c0 = Math.cos(a0),\n        s0 = Math.sin(a0),\n        c1 = Math.cos(a1),\n        s1 = Math.sin(a1);\n    return da >= d3_svg_arcMax\n      ? (r0\n      ? \"M0,\" + r1\n      + \"A\" + r1 + \",\" + r1 + \" 0 1,1 0,\" + (-r1)\n      + \"A\" + r1 + \",\" + r1 + \" 0 1,1 0,\" + r1\n      + \"M0,\" + r0\n      + \"A\" + r0 + \",\" + r0 + \" 0 1,0 0,\" + (-r0)\n      + \"A\" + r0 + \",\" + r0 + \" 0 1,0 0,\" + r0\n      + \"Z\"\n      : \"M0,\" + r1\n      + \"A\" + r1 + \",\" + r1 + \" 0 1,1 0,\" + (-r1)\n      + \"A\" + r1 + \",\" + r1 + \" 0 1,1 0,\" + r1\n      + \"Z\")\n      : (r0\n      ? \"M\" + r1 * c0 + \",\" + r1 * s0\n      + \"A\" + r1 + \",\" + r1 + \" 0 \" + df + \",1 \" + r1 * c1 + \",\" + r1 * s1\n      + \"L\" + r0 * c1 + \",\" + r0 * s1\n      + \"A\" + r0 + \",\" + r0 + \" 0 \" + df + \",0 \" + r0 * c0 + \",\" + r0 * s0\n      + \"Z\"\n      : \"M\" + r1 * c0 + \",\" + r1 * s0\n      + \"A\" + r1 + \",\" + r1 + \" 0 \" + df + \",1 \" + r1 * c1 + \",\" + r1 * s1\n      + \"L0,0\"\n      + \"Z\");\n  }\n\n  arc.innerRadius = function(v) {\n    if (!arguments.length) return innerRadius;\n    innerRadius = d3_functor(v);\n    return arc;\n  };\n\n  arc.outerRadius = function(v) {\n    if (!arguments.length) return outerRadius;\n    outerRadius = d3_functor(v);\n    return arc;\n  };\n\n  arc.startAngle = function(v) {\n    if (!arguments.length) return startAngle;\n    startAngle = d3_functor(v);\n    return arc;\n  };\n\n  arc.endAngle = function(v) {\n    if (!arguments.length) return endAngle;\n    endAngle = d3_functor(v);\n    return arc;\n  };\n\n  arc.centroid = function() {\n    var r = (innerRadius.apply(this, arguments)\n        + outerRadius.apply(this, arguments)) / 2,\n        a = (startAngle.apply(this, arguments)\n        + endAngle.apply(this, arguments)) / 2 + d3_svg_arcOffset;\n    return [Math.cos(a) * r, Math.sin(a) * r];\n  };\n\n  return arc;\n};\n\nvar d3_svg_arcOffset = -Math.PI / 2,\n    d3_svg_arcMax = 2 * Math.PI - 1e-6;\n\nfunction d3_svg_arcInnerRadius(d) {\n  return d.innerRadius;\n}\n\nfunction d3_svg_arcOuterRadius(d) {\n  return d.outerRadius;\n}\n\nfunction d3_svg_arcStartAngle(d) {\n  return d.startAngle;\n}\n\nfunction d3_svg_arcEndAngle(d) {\n  return d.endAngle;\n}\nfunction d3_svg_line(projection) {\n  var x = d3_svg_lineX,\n      y = d3_svg_lineY,\n      defined = d3_true,\n      interpolate = d3_svg_lineInterpolatorDefault,\n      interpolator = d3_svg_lineLinear,\n      tension = .7;\n\n  function line(data) {\n    var segments = [],\n        points = [],\n        i = -1,\n        n = data.length,\n        d,\n        fx = d3_functor(x),\n        fy = d3_functor(y);\n\n    function segment() {\n      segments.push(\"M\", interpolator(projection(points), tension));\n    }\n\n    while (++i < n) {\n      if (defined.call(this, d = data[i], i)) {\n        points.push([+fx.call(this, d, i), +fy.call(this, d, i)]);\n      } else if (points.length) {\n        segment();\n        points = [];\n      }\n    }\n\n    if (points.length) segment();\n\n    return segments.length ? segments.join(\"\") : null;\n  }\n\n  line.x = function(_) {\n    if (!arguments.length) return x;\n    x = _;\n    return line;\n  };\n\n  line.y = function(_) {\n    if (!arguments.length) return y;\n    y = _;\n    return line;\n  };\n\n  line.defined  = function(_) {\n    if (!arguments.length) return defined;\n    defined = _;\n    return line;\n  };\n\n  line.interpolate = function(_) {\n    if (!arguments.length) return interpolate;\n    if (!d3_svg_lineInterpolators.has(_ += \"\")) _ = d3_svg_lineInterpolatorDefault;\n    interpolator = d3_svg_lineInterpolators.get(interpolate = _);\n    return line;\n  };\n\n  line.tension = function(_) {\n    if (!arguments.length) return tension;\n    tension = _;\n    return line;\n  };\n\n  return line;\n}\n\nd3.svg.line = function() {\n  return d3_svg_line(d3_identity);\n};\n\n// The default `x` property, which references d[0].\nfunction d3_svg_lineX(d) {\n  return d[0];\n}\n\n// The default `y` property, which references d[1].\nfunction d3_svg_lineY(d) {\n  return d[1];\n}\n\nvar d3_svg_lineInterpolatorDefault = \"linear\";\n\n// The various interpolators supported by the `line` class.\nvar d3_svg_lineInterpolators = d3.map({\n  \"linear\": d3_svg_lineLinear,\n  \"step-before\": d3_svg_lineStepBefore,\n  \"step-after\": d3_svg_lineStepAfter,\n  \"basis\": d3_svg_lineBasis,\n  \"basis-open\": d3_svg_lineBasisOpen,\n  \"basis-closed\": d3_svg_lineBasisClosed,\n  \"bundle\": d3_svg_lineBundle,\n  \"cardinal\": d3_svg_lineCardinal,\n  \"cardinal-open\": d3_svg_lineCardinalOpen,\n  \"cardinal-closed\": d3_svg_lineCardinalClosed,\n  \"monotone\": d3_svg_lineMonotone\n});\n\n// Linear interpolation; generates \"L\" commands.\nfunction d3_svg_lineLinear(points) {\n  var i = 0,\n      n = points.length,\n      p = points[0],\n      path = [p[0], \",\", p[1]];\n  while (++i < n) path.push(\"L\", (p = points[i])[0], \",\", p[1]);\n  return path.join(\"\");\n}\n\n// Step interpolation; generates \"H\" and \"V\" commands.\nfunction d3_svg_lineStepBefore(points) {\n  var i = 0,\n      n = points.length,\n      p = points[0],\n      path = [p[0], \",\", p[1]];\n  while (++i < n) path.push(\"V\", (p = points[i])[1], \"H\", p[0]);\n  return path.join(\"\");\n}\n\n// Step interpolation; generates \"H\" and \"V\" commands.\nfunction d3_svg_lineStepAfter(points) {\n  var i = 0,\n      n = points.length,\n      p = points[0],\n      path = [p[0], \",\", p[1]];\n  while (++i < n) path.push(\"H\", (p = points[i])[0], \"V\", p[1]);\n  return path.join(\"\");\n}\n\n// Open cardinal spline interpolation; generates \"C\" commands.\nfunction d3_svg_lineCardinalOpen(points, tension) {\n  return points.length < 4\n      ? d3_svg_lineLinear(points)\n      : points[1] + d3_svg_lineHermite(points.slice(1, points.length - 1),\n        d3_svg_lineCardinalTangents(points, tension));\n}\n\n// Closed cardinal spline interpolation; generates \"C\" commands.\nfunction d3_svg_lineCardinalClosed(points, tension) {\n  return points.length < 3\n      ? d3_svg_lineLinear(points)\n      : points[0] + d3_svg_lineHermite((points.push(points[0]), points),\n        d3_svg_lineCardinalTangents([points[points.length - 2]]\n        .concat(points, [points[1]]), tension));\n}\n\n// Cardinal spline interpolation; generates \"C\" commands.\nfunction d3_svg_lineCardinal(points, tension, closed) {\n  return points.length < 3\n      ? d3_svg_lineLinear(points)\n      : points[0] + d3_svg_lineHermite(points,\n        d3_svg_lineCardinalTangents(points, tension));\n}\n\n// Hermite spline construction; generates \"C\" commands.\nfunction d3_svg_lineHermite(points, tangents) {\n  if (tangents.length < 1\n      || (points.length != tangents.length\n      && points.length != tangents.length + 2)) {\n    return d3_svg_lineLinear(points);\n  }\n\n  var quad = points.length != tangents.length,\n      path = \"\",\n      p0 = points[0],\n      p = points[1],\n      t0 = tangents[0],\n      t = t0,\n      pi = 1;\n\n  if (quad) {\n    path += \"Q\" + (p[0] - t0[0] * 2 / 3) + \",\" + (p[1] - t0[1] * 2 / 3)\n        + \",\" + p[0] + \",\" + p[1];\n    p0 = points[1];\n    pi = 2;\n  }\n\n  if (tangents.length > 1) {\n    t = tangents[1];\n    p = points[pi];\n    pi++;\n    path += \"C\" + (p0[0] + t0[0]) + \",\" + (p0[1] + t0[1])\n        + \",\" + (p[0] - t[0]) + \",\" + (p[1] - t[1])\n        + \",\" + p[0] + \",\" + p[1];\n    for (var i = 2; i < tangents.length; i++, pi++) {\n      p = points[pi];\n      t = tangents[i];\n      path += \"S\" + (p[0] - t[0]) + \",\" + (p[1] - t[1])\n          + \",\" + p[0] + \",\" + p[1];\n    }\n  }\n\n  if (quad) {\n    var lp = points[pi];\n    path += \"Q\" + (p[0] + t[0] * 2 / 3) + \",\" + (p[1] + t[1] * 2 / 3)\n        + \",\" + lp[0] + \",\" + lp[1];\n  }\n\n  return path;\n}\n\n// Generates tangents for a cardinal spline.\nfunction d3_svg_lineCardinalTangents(points, tension) {\n  var tangents = [],\n      a = (1 - tension) / 2,\n      p0,\n      p1 = points[0],\n      p2 = points[1],\n      i = 1,\n      n = points.length;\n  while (++i < n) {\n    p0 = p1;\n    p1 = p2;\n    p2 = points[i];\n    tangents.push([a * (p2[0] - p0[0]), a * (p2[1] - p0[1])]);\n  }\n  return tangents;\n}\n\n// B-spline interpolation; generates \"C\" commands.\nfunction d3_svg_lineBasis(points) {\n  if (points.length < 3) return d3_svg_lineLinear(points);\n  var i = 1,\n      n = points.length,\n      pi = points[0],\n      x0 = pi[0],\n      y0 = pi[1],\n      px = [x0, x0, x0, (pi = points[1])[0]],\n      py = [y0, y0, y0, pi[1]],\n      path = [x0, \",\", y0];\n  d3_svg_lineBasisBezier(path, px, py);\n  while (++i < n) {\n    pi = points[i];\n    px.shift(); px.push(pi[0]);\n    py.shift(); py.push(pi[1]);\n    d3_svg_lineBasisBezier(path, px, py);\n  }\n  i = -1;\n  while (++i < 2) {\n    px.shift(); px.push(pi[0]);\n    py.shift(); py.push(pi[1]);\n    d3_svg_lineBasisBezier(path, px, py);\n  }\n  return path.join(\"\");\n}\n\n// Open B-spline interpolation; generates \"C\" commands.\nfunction d3_svg_lineBasisOpen(points) {\n  if (points.length < 4) return d3_svg_lineLinear(points);\n  var path = [],\n      i = -1,\n      n = points.length,\n      pi,\n      px = [0],\n      py = [0];\n  while (++i < 3) {\n    pi = points[i];\n    px.push(pi[0]);\n    py.push(pi[1]);\n  }\n  path.push(d3_svg_lineDot4(d3_svg_lineBasisBezier3, px)\n    + \",\" + d3_svg_lineDot4(d3_svg_lineBasisBezier3, py));\n  --i; while (++i < n) {\n    pi = points[i];\n    px.shift(); px.push(pi[0]);\n    py.shift(); py.push(pi[1]);\n    d3_svg_lineBasisBezier(path, px, py);\n  }\n  return path.join(\"\");\n}\n\n// Closed B-spline interpolation; generates \"C\" commands.\nfunction d3_svg_lineBasisClosed(points) {\n  var path,\n      i = -1,\n      n = points.length,\n      m = n + 4,\n      pi,\n      px = [],\n      py = [];\n  while (++i < 4) {\n    pi = points[i % n];\n    px.push(pi[0]);\n    py.push(pi[1]);\n  }\n  path = [\n    d3_svg_lineDot4(d3_svg_lineBasisBezier3, px), \",\",\n    d3_svg_lineDot4(d3_svg_lineBasisBezier3, py)\n  ];\n  --i; while (++i < m) {\n    pi = points[i % n];\n    px.shift(); px.push(pi[0]);\n    py.shift(); py.push(pi[1]);\n    d3_svg_lineBasisBezier(path, px, py);\n  }\n  return path.join(\"\");\n}\n\nfunction d3_svg_lineBundle(points, tension) {\n  var n = points.length - 1;\n  if (n) {\n    var x0 = points[0][0],\n        y0 = points[0][1],\n        dx = points[n][0] - x0,\n        dy = points[n][1] - y0,\n        i = -1,\n        p,\n        t;\n    while (++i <= n) {\n      p = points[i];\n      t = i / n;\n      p[0] = tension * p[0] + (1 - tension) * (x0 + t * dx);\n      p[1] = tension * p[1] + (1 - tension) * (y0 + t * dy);\n    }\n  }\n  return d3_svg_lineBasis(points);\n}\n\n// Returns the dot product of the given four-element vectors.\nfunction d3_svg_lineDot4(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n}\n\n// Matrix to transform basis (b-spline) control points to bezier\n// control points. Derived from FvD 11.2.8.\nvar d3_svg_lineBasisBezier1 = [0, 2/3, 1/3, 0],\n    d3_svg_lineBasisBezier2 = [0, 1/3, 2/3, 0],\n    d3_svg_lineBasisBezier3 = [0, 1/6, 2/3, 1/6];\n\n// Pushes a \"C\" BÃ©zier curve onto the specified path array, given the\n// two specified four-element arrays which define the control points.\nfunction d3_svg_lineBasisBezier(path, x, y) {\n  path.push(\n      \"C\", d3_svg_lineDot4(d3_svg_lineBasisBezier1, x),\n      \",\", d3_svg_lineDot4(d3_svg_lineBasisBezier1, y),\n      \",\", d3_svg_lineDot4(d3_svg_lineBasisBezier2, x),\n      \",\", d3_svg_lineDot4(d3_svg_lineBasisBezier2, y),\n      \",\", d3_svg_lineDot4(d3_svg_lineBasisBezier3, x),\n      \",\", d3_svg_lineDot4(d3_svg_lineBasisBezier3, y));\n}\n\n// Computes the slope from points p0 to p1.\nfunction d3_svg_lineSlope(p0, p1) {\n  return (p1[1] - p0[1]) / (p1[0] - p0[0]);\n}\n\n// Compute three-point differences for the given points.\n// http://en.wikipedia.org/wiki/Cubic_Hermite_spline#Finite_difference\nfunction d3_svg_lineFiniteDifferences(points) {\n  var i = 0,\n      j = points.length - 1,\n      m = [],\n      p0 = points[0],\n      p1 = points[1],\n      d = m[0] = d3_svg_lineSlope(p0, p1);\n  while (++i < j) {\n    m[i] = d + (d = d3_svg_lineSlope(p0 = p1, p1 = points[i + 1]));\n  }\n  m[i] = d;\n  return m;\n}\n\n// Interpolates the given points using Fritsch-Carlson Monotone cubic Hermite\n// interpolation. Returns an array of tangent vectors. For details, see\n// http://en.wikipedia.org/wiki/Monotone_cubic_interpolation\nfunction d3_svg_lineMonotoneTangents(points) {\n  var tangents = [],\n      d,\n      a,\n      b,\n      s,\n      m = d3_svg_lineFiniteDifferences(points),\n      i = -1,\n      j = points.length - 1;\n\n  // The first two steps are done by computing finite-differences:\n  // 1. Compute the slopes of the secant lines between successive points.\n  // 2. Initialize the tangents at every point as the average of the secants.\n\n  // Then, for each segmentâ€¦\n  while (++i < j) {\n    d = d3_svg_lineSlope(points[i], points[i + 1]);\n\n    // 3. If two successive yk = y{k + 1} are equal (i.e., d is zero), then set\n    // mk = m{k + 1} = 0 as the spline connecting these points must be flat to\n    // preserve monotonicity. Ignore step 4 and 5 for those k.\n\n    if (Math.abs(d) < 1e-6) {\n      m[i] = m[i + 1] = 0;\n    } else {\n      // 4. Let ak = mk / dk and bk = m{k + 1} / dk.\n      a = m[i] / d;\n      b = m[i + 1] / d;\n\n      // 5. Prevent overshoot and ensure monotonicity by restricting the\n      // magnitude of vector <ak, bk> to a circle of radius 3.\n      s = a * a + b * b;\n      if (s > 9) {\n        s = d * 3 / Math.sqrt(s);\n        m[i] = s * a;\n        m[i + 1] = s * b;\n      }\n    }\n  }\n\n  // Compute the normalized tangent vector from the slopes. Note that if x is\n  // not monotonic, it's possible that the slope will be infinite, so we protect\n  // against NaN by setting the coordinate to zero.\n  i = -1; while (++i <= j) {\n    s = (points[Math.min(j, i + 1)][0] - points[Math.max(0, i - 1)][0]) / (6 * (1 + m[i] * m[i]));\n    tangents.push([s || 0, m[i] * s || 0]);\n  }\n\n  return tangents;\n}\n\nfunction d3_svg_lineMonotone(points) {\n  return points.length < 3\n      ? d3_svg_lineLinear(points)\n      : points[0] + d3_svg_lineHermite(points, d3_svg_lineMonotoneTangents(points));\n}\nd3.svg.line.radial = function() {\n  var line = d3_svg_line(d3_svg_lineRadial);\n  line.radius = line.x, delete line.x;\n  line.angle = line.y, delete line.y;\n  return line;\n};\n\nfunction d3_svg_lineRadial(points) {\n  var point,\n      i = -1,\n      n = points.length,\n      r,\n      a;\n  while (++i < n) {\n    point = points[i];\n    r = point[0];\n    a = point[1] + d3_svg_arcOffset;\n    point[0] = r * Math.cos(a);\n    point[1] = r * Math.sin(a);\n  }\n  return points;\n}\nfunction d3_svg_area(projection) {\n  var x0 = d3_svg_lineX,\n      x1 = d3_svg_lineX,\n      y0 = 0,\n      y1 = d3_svg_lineY,\n      defined = d3_true,\n      interpolate = d3_svg_lineInterpolatorDefault,\n      i0 = d3_svg_lineLinear,\n      i1 = d3_svg_lineLinear,\n      L = \"L\",\n      tension = .7;\n\n  function area(data) {\n    var segments = [],\n        points0 = [],\n        points1 = [],\n        i = -1,\n        n = data.length,\n        d,\n        fx0 = d3_functor(x0),\n        fy0 = d3_functor(y0),\n        fx1 = x0 === x1 ? function() { return x; } : d3_functor(x1),\n        fy1 = y0 === y1 ? function() { return y; } : d3_functor(y1),\n        x,\n        y;\n\n    function segment() {\n      segments.push(\"M\", i0(projection(points1), tension),\n          L, i1(projection(points0.reverse()), tension),\n          \"Z\");\n    }\n\n    while (++i < n) {\n      if (defined.call(this, d = data[i], i)) {\n        points0.push([x = +fx0.call(this, d, i), y = +fy0.call(this, d, i)]);\n        points1.push([+fx1.call(this, d, i), +fy1.call(this, d, i)]);\n      } else if (points0.length) {\n        segment();\n        points0 = [];\n        points1 = [];\n      }\n    }\n\n    if (points0.length) segment();\n\n    return segments.length ? segments.join(\"\") : null;\n  }\n\n  area.x = function(_) {\n    if (!arguments.length) return x1;\n    x0 = x1 = _;\n    return area;\n  };\n\n  area.x0 = function(_) {\n    if (!arguments.length) return x0;\n    x0 = _;\n    return area;\n  };\n\n  area.x1 = function(_) {\n    if (!arguments.length) return x1;\n    x1 = _;\n    return area;\n  };\n\n  area.y = function(_) {\n    if (!arguments.length) return y1;\n    y0 = y1 = _;\n    return area;\n  };\n\n  area.y0 = function(_) {\n    if (!arguments.length) return y0;\n    y0 = _;\n    return area;\n  };\n\n  area.y1 = function(_) {\n    if (!arguments.length) return y1;\n    y1 = _;\n    return area;\n  };\n\n  area.defined  = function(_) {\n    if (!arguments.length) return defined;\n    defined = _;\n    return area;\n  };\n\n  area.interpolate = function(_) {\n    if (!arguments.length) return interpolate;\n    if (!d3_svg_lineInterpolators.has(_ += \"\")) _ = d3_svg_lineInterpolatorDefault;\n    i0 = d3_svg_lineInterpolators.get(interpolate = _);\n    i1 = i0.reverse || i0;\n    L = /-closed$/.test(_) ? \"M\" : \"L\";\n    return area;\n  };\n\n  area.tension = function(_) {\n    if (!arguments.length) return tension;\n    tension = _;\n    return area;\n  };\n\n  return area;\n}\n\nd3_svg_lineStepBefore.reverse = d3_svg_lineStepAfter;\nd3_svg_lineStepAfter.reverse = d3_svg_lineStepBefore;\n\nd3.svg.area = function() {\n  return d3_svg_area(Object);\n};\nd3.svg.area.radial = function() {\n  var area = d3_svg_area(d3_svg_lineRadial);\n  area.radius = area.x, delete area.x;\n  area.innerRadius = area.x0, delete area.x0;\n  area.outerRadius = area.x1, delete area.x1;\n  area.angle = area.y, delete area.y;\n  area.startAngle = area.y0, delete area.y0;\n  area.endAngle = area.y1, delete area.y1;\n  return area;\n};\nd3.svg.chord = function() {\n  var source = d3_svg_chordSource,\n      target = d3_svg_chordTarget,\n      radius = d3_svg_chordRadius,\n      startAngle = d3_svg_arcStartAngle,\n      endAngle = d3_svg_arcEndAngle;\n\n  // TODO Allow control point to be customized.\n\n  function chord(d, i) {\n    var s = subgroup(this, source, d, i),\n        t = subgroup(this, target, d, i);\n    return \"M\" + s.p0\n      + arc(s.r, s.p1, s.a1 - s.a0) + (equals(s, t)\n      ? curve(s.r, s.p1, s.r, s.p0)\n      : curve(s.r, s.p1, t.r, t.p0)\n      + arc(t.r, t.p1, t.a1 - t.a0)\n      + curve(t.r, t.p1, s.r, s.p0))\n      + \"Z\";\n  }\n\n  function subgroup(self, f, d, i) {\n    var subgroup = f.call(self, d, i),\n        r = radius.call(self, subgroup, i),\n        a0 = startAngle.call(self, subgroup, i) + d3_svg_arcOffset,\n        a1 = endAngle.call(self, subgroup, i) + d3_svg_arcOffset;\n    return {\n      r: r,\n      a0: a0,\n      a1: a1,\n      p0: [r * Math.cos(a0), r * Math.sin(a0)],\n      p1: [r * Math.cos(a1), r * Math.sin(a1)]\n    };\n  }\n\n  function equals(a, b) {\n    return a.a0 == b.a0 && a.a1 == b.a1;\n  }\n\n  function arc(r, p, a) {\n    return \"A\" + r + \",\" + r + \" 0 \" + +(a > Math.PI) + \",1 \" + p;\n  }\n\n  function curve(r0, p0, r1, p1) {\n    return \"Q 0,0 \" + p1;\n  }\n\n  chord.radius = function(v) {\n    if (!arguments.length) return radius;\n    radius = d3_functor(v);\n    return chord;\n  };\n\n  chord.source = function(v) {\n    if (!arguments.length) return source;\n    source = d3_functor(v);\n    return chord;\n  };\n\n  chord.target = function(v) {\n    if (!arguments.length) return target;\n    target = d3_functor(v);\n    return chord;\n  };\n\n  chord.startAngle = function(v) {\n    if (!arguments.length) return startAngle;\n    startAngle = d3_functor(v);\n    return chord;\n  };\n\n  chord.endAngle = function(v) {\n    if (!arguments.length) return endAngle;\n    endAngle = d3_functor(v);\n    return chord;\n  };\n\n  return chord;\n};\n\nfunction d3_svg_chordSource(d) {\n  return d.source;\n}\n\nfunction d3_svg_chordTarget(d) {\n  return d.target;\n}\n\nfunction d3_svg_chordRadius(d) {\n  return d.radius;\n}\n\nfunction d3_svg_chordStartAngle(d) {\n  return d.startAngle;\n}\n\nfunction d3_svg_chordEndAngle(d) {\n  return d.endAngle;\n}\nd3.svg.diagonal = function() {\n  var source = d3_svg_chordSource,\n      target = d3_svg_chordTarget,\n      projection = d3_svg_diagonalProjection;\n\n  function diagonal(d, i) {\n    var p0 = source.call(this, d, i),\n        p3 = target.call(this, d, i),\n        m = (p0.y + p3.y) / 2,\n        p = [p0, {x: p0.x, y: m}, {x: p3.x, y: m}, p3];\n    p = p.map(projection);\n    return \"M\" + p[0] + \"C\" + p[1] + \" \" + p[2] + \" \" + p[3];\n  }\n\n  diagonal.source = function(x) {\n    if (!arguments.length) return source;\n    source = d3_functor(x);\n    return diagonal;\n  };\n\n  diagonal.target = function(x) {\n    if (!arguments.length) return target;\n    target = d3_functor(x);\n    return diagonal;\n  };\n\n  diagonal.projection = function(x) {\n    if (!arguments.length) return projection;\n    projection = x;\n    return diagonal;\n  };\n\n  return diagonal;\n};\n\nfunction d3_svg_diagonalProjection(d) {\n  return [d.x, d.y];\n}\nd3.svg.diagonal.radial = function() {\n  var diagonal = d3.svg.diagonal(),\n      projection = d3_svg_diagonalProjection,\n      projection_ = diagonal.projection;\n\n  diagonal.projection = function(x) {\n    return arguments.length\n        ? projection_(d3_svg_diagonalRadialProjection(projection = x))\n        : projection;\n  };\n\n  return diagonal;\n};\n\nfunction d3_svg_diagonalRadialProjection(projection) {\n  return function() {\n    var d = projection.apply(this, arguments),\n        r = d[0],\n        a = d[1] + d3_svg_arcOffset;\n    return [r * Math.cos(a), r * Math.sin(a)];\n  };\n}\nd3.svg.mouse = d3.mouse;\nd3.svg.touches = d3.touches;\nd3.svg.symbol = function() {\n  var type = d3_svg_symbolType,\n      size = d3_svg_symbolSize;\n\n  function symbol(d, i) {\n    return (d3_svg_symbols.get(type.call(this, d, i))\n        || d3_svg_symbolCircle)\n        (size.call(this, d, i));\n  }\n\n  symbol.type = function(x) {\n    if (!arguments.length) return type;\n    type = d3_functor(x);\n    return symbol;\n  };\n\n  // size of symbol in square pixels\n  symbol.size = function(x) {\n    if (!arguments.length) return size;\n    size = d3_functor(x);\n    return symbol;\n  };\n\n  return symbol;\n};\n\nfunction d3_svg_symbolSize() {\n  return 64;\n}\n\nfunction d3_svg_symbolType() {\n  return \"circle\";\n}\n\nfunction d3_svg_symbolCircle(size) {\n  var r = Math.sqrt(size / Math.PI);\n  return \"M0,\" + r\n      + \"A\" + r + \",\" + r + \" 0 1,1 0,\" + (-r)\n      + \"A\" + r + \",\" + r + \" 0 1,1 0,\" + r\n      + \"Z\";\n}\n\n// TODO cross-diagonal?\nvar d3_svg_symbols = d3.map({\n  \"circle\": d3_svg_symbolCircle,\n  \"cross\": function(size) {\n    var r = Math.sqrt(size / 5) / 2;\n    return \"M\" + -3 * r + \",\" + -r\n        + \"H\" + -r\n        + \"V\" + -3 * r\n        + \"H\" + r\n        + \"V\" + -r\n        + \"H\" + 3 * r\n        + \"V\" + r\n        + \"H\" + r\n        + \"V\" + 3 * r\n        + \"H\" + -r\n        + \"V\" + r\n        + \"H\" + -3 * r\n        + \"Z\";\n  },\n  \"diamond\": function(size) {\n    var ry = Math.sqrt(size / (2 * d3_svg_symbolTan30)),\n        rx = ry * d3_svg_symbolTan30;\n    return \"M0,\" + -ry\n        + \"L\" + rx + \",0\"\n        + \" 0,\" + ry\n        + \" \" + -rx + \",0\"\n        + \"Z\";\n  },\n  \"square\": function(size) {\n    var r = Math.sqrt(size) / 2;\n    return \"M\" + -r + \",\" + -r\n        + \"L\" + r + \",\" + -r\n        + \" \" + r + \",\" + r\n        + \" \" + -r + \",\" + r\n        + \"Z\";\n  },\n  \"triangle-down\": function(size) {\n    var rx = Math.sqrt(size / d3_svg_symbolSqrt3),\n        ry = rx * d3_svg_symbolSqrt3 / 2;\n    return \"M0,\" + ry\n        + \"L\" + rx +\",\" + -ry\n        + \" \" + -rx + \",\" + -ry\n        + \"Z\";\n  },\n  \"triangle-up\": function(size) {\n    var rx = Math.sqrt(size / d3_svg_symbolSqrt3),\n        ry = rx * d3_svg_symbolSqrt3 / 2;\n    return \"M0,\" + -ry\n        + \"L\" + rx +\",\" + ry\n        + \" \" + -rx + \",\" + ry\n        + \"Z\";\n  }\n});\n\nd3.svg.symbolTypes = d3_svg_symbols.keys();\n\nvar d3_svg_symbolSqrt3 = Math.sqrt(3),\n    d3_svg_symbolTan30 = Math.tan(30 * Math.PI / 180);\nd3.svg.axis = function() {\n  var scale = d3.scale.linear(),\n      orient = \"bottom\",\n      tickMajorSize = 6,\n      tickMinorSize = 6,\n      tickEndSize = 6,\n      tickPadding = 3,\n      tickArguments_ = [10],\n      tickValues = null,\n      tickFormat_,\n      tickSubdivide = 0;\n\n  function axis(g) {\n    g.each(function() {\n      var g = d3.select(this);\n\n      // Ticks, or domain values for ordinal scales.\n      var ticks = tickValues == null ? (scale.ticks ? scale.ticks.apply(scale, tickArguments_) : scale.domain()) : tickValues,\n          tickFormat = tickFormat_ == null ? (scale.tickFormat ? scale.tickFormat.apply(scale, tickArguments_) : String) : tickFormat_;\n\n      // Minor ticks.\n      var subticks = d3_svg_axisSubdivide(scale, ticks, tickSubdivide),\n          subtick = g.selectAll(\".minor\").data(subticks, String),\n          subtickEnter = subtick.enter().insert(\"line\", \"g\").attr(\"class\", \"tick minor\").style(\"opacity\", 1e-6),\n          subtickExit = d3.transition(subtick.exit()).style(\"opacity\", 1e-6).remove(),\n          subtickUpdate = d3.transition(subtick).style(\"opacity\", 1);\n\n      // Major ticks.\n      var tick = g.selectAll(\"g\").data(ticks, String),\n          tickEnter = tick.enter().insert(\"g\", \"path\").style(\"opacity\", 1e-6),\n          tickExit = d3.transition(tick.exit()).style(\"opacity\", 1e-6).remove(),\n          tickUpdate = d3.transition(tick).style(\"opacity\", 1),\n          tickTransform;\n\n      // Domain.\n      var range = d3_scaleRange(scale),\n          path = g.selectAll(\".domain\").data([0]),\n          pathEnter = path.enter().append(\"path\").attr(\"class\", \"domain\"),\n          pathUpdate = d3.transition(path);\n\n      // Stash a snapshot of the new scale, and retrieve the old snapshot.\n      var scale1 = scale.copy(),\n          scale0 = this.__chart__ || scale1;\n      this.__chart__ = scale1;\n\n      tickEnter.append(\"line\").attr(\"class\", \"tick\");\n      tickEnter.append(\"text\");\n\n      var lineEnter = tickEnter.select(\"line\"),\n          lineUpdate = tickUpdate.select(\"line\"),\n          text = tick.select(\"text\").text(tickFormat),\n          textEnter = tickEnter.select(\"text\"),\n          textUpdate = tickUpdate.select(\"text\");\n\n      switch (orient) {\n        case \"bottom\": {\n          tickTransform = d3_svg_axisX;\n          subtickEnter.attr(\"y2\", tickMinorSize);\n          subtickUpdate.attr(\"x2\", 0).attr(\"y2\", tickMinorSize);\n          lineEnter.attr(\"y2\", tickMajorSize);\n          textEnter.attr(\"y\", Math.max(tickMajorSize, 0) + tickPadding);\n          lineUpdate.attr(\"x2\", 0).attr(\"y2\", tickMajorSize);\n          textUpdate.attr(\"x\", 0).attr(\"y\", Math.max(tickMajorSize, 0) + tickPadding);\n          text.attr(\"dy\", \".71em\").attr(\"text-anchor\", \"middle\");\n          pathUpdate.attr(\"d\", \"M\" + range[0] + \",\" + tickEndSize + \"V0H\" + range[1] + \"V\" + tickEndSize);\n          break;\n        }\n        case \"top\": {\n          tickTransform = d3_svg_axisX;\n          subtickEnter.attr(\"y2\", -tickMinorSize);\n          subtickUpdate.attr(\"x2\", 0).attr(\"y2\", -tickMinorSize);\n          lineEnter.attr(\"y2\", -tickMajorSize);\n          textEnter.attr(\"y\", -(Math.max(tickMajorSize, 0) + tickPadding));\n          lineUpdate.attr(\"x2\", 0).attr(\"y2\", -tickMajorSize);\n          textUpdate.attr(\"x\", 0).attr(\"y\", -(Math.max(tickMajorSize, 0) + tickPadding));\n          text.attr(\"dy\", \"0em\").attr(\"text-anchor\", \"middle\");\n          pathUpdate.attr(\"d\", \"M\" + range[0] + \",\" + -tickEndSize + \"V0H\" + range[1] + \"V\" + -tickEndSize);\n          break;\n        }\n        case \"left\": {\n          tickTransform = d3_svg_axisY;\n          subtickEnter.attr(\"x2\", -tickMinorSize);\n          subtickUpdate.attr(\"x2\", -tickMinorSize).attr(\"y2\", 0);\n          lineEnter.attr(\"x2\", -tickMajorSize);\n          textEnter.attr(\"x\", -(Math.max(tickMajorSize, 0) + tickPadding));\n          lineUpdate.attr(\"x2\", -tickMajorSize).attr(\"y2\", 0);\n          textUpdate.attr(\"x\", -(Math.max(tickMajorSize, 0) + tickPadding)).attr(\"y\", 0);\n          text.attr(\"dy\", \".32em\").attr(\"text-anchor\", \"end\");\n          pathUpdate.attr(\"d\", \"M\" + -tickEndSize + \",\" + range[0] + \"H0V\" + range[1] + \"H\" + -tickEndSize);\n          break;\n        }\n        case \"right\": {\n          tickTransform = d3_svg_axisY;\n          subtickEnter.attr(\"x2\", tickMinorSize);\n          subtickUpdate.attr(\"x2\", tickMinorSize).attr(\"y2\", 0);\n          lineEnter.attr(\"x2\", tickMajorSize);\n          textEnter.attr(\"x\", Math.max(tickMajorSize, 0) + tickPadding);\n          lineUpdate.attr(\"x2\", tickMajorSize).attr(\"y2\", 0);\n          textUpdate.attr(\"x\", Math.max(tickMajorSize, 0) + tickPadding).attr(\"y\", 0);\n          text.attr(\"dy\", \".32em\").attr(\"text-anchor\", \"start\");\n          pathUpdate.attr(\"d\", \"M\" + tickEndSize + \",\" + range[0] + \"H0V\" + range[1] + \"H\" + tickEndSize);\n          break;\n        }\n      }\n\n      // For quantitative scales:\n      // - enter new ticks from the old scale\n      // - exit old ticks to the new scale\n      if (scale.ticks) {\n        tickEnter.call(tickTransform, scale0);\n        tickUpdate.call(tickTransform, scale1);\n        tickExit.call(tickTransform, scale1);\n        subtickEnter.call(tickTransform, scale0);\n        subtickUpdate.call(tickTransform, scale1);\n        subtickExit.call(tickTransform, scale1);\n      }\n\n      // For ordinal scales:\n      // - any entering ticks are undefined in the old scale\n      // - any exiting ticks are undefined in the new scale\n      // Therefore, we only need to transition updating ticks.\n      else {\n        var dx = scale1.rangeBand() / 2, x = function(d) { return scale1(d) + dx; };\n        tickEnter.call(tickTransform, x);\n        tickUpdate.call(tickTransform, x);\n      }\n    });\n  }\n\n  axis.scale = function(x) {\n    if (!arguments.length) return scale;\n    scale = x;\n    return axis;\n  };\n\n  axis.orient = function(x) {\n    if (!arguments.length) return orient;\n    orient = x;\n    return axis;\n  };\n\n  axis.ticks = function() {\n    if (!arguments.length) return tickArguments_;\n    tickArguments_ = arguments;\n    return axis;\n  };\n\n  axis.tickValues = function(x) {\n    if (!arguments.length) return tickValues;\n    tickValues = x;\n    return axis;\n  };\n\n  axis.tickFormat = function(x) {\n    if (!arguments.length) return tickFormat_;\n    tickFormat_ = x;\n    return axis;\n  };\n\n  axis.tickSize = function(x, y, z) {\n    if (!arguments.length) return tickMajorSize;\n    var n = arguments.length - 1;\n    tickMajorSize = +x;\n    tickMinorSize = n > 1 ? +y : tickMajorSize;\n    tickEndSize = n > 0 ? +arguments[n] : tickMajorSize;\n    return axis;\n  };\n\n  axis.tickPadding = function(x) {\n    if (!arguments.length) return tickPadding;\n    tickPadding = +x;\n    return axis;\n  };\n\n  axis.tickSubdivide = function(x) {\n    if (!arguments.length) return tickSubdivide;\n    tickSubdivide = +x;\n    return axis;\n  };\n\n  return axis;\n};\n\nfunction d3_svg_axisX(selection, x) {\n  selection.attr(\"transform\", function(d) { return \"translate(\" + x(d) + \",0)\"; });\n}\n\nfunction d3_svg_axisY(selection, y) {\n  selection.attr(\"transform\", function(d) { return \"translate(0,\" + y(d) + \")\"; });\n}\n\nfunction d3_svg_axisSubdivide(scale, ticks, m) {\n  subticks = [];\n  if (m && ticks.length > 1) {\n    var extent = d3_scaleExtent(scale.domain()),\n        subticks,\n        i = -1,\n        n = ticks.length,\n        d = (ticks[1] - ticks[0]) / ++m,\n        j,\n        v;\n    while (++i < n) {\n      for (j = m; --j > 0;) {\n        if ((v = +ticks[i] - j * d) >= extent[0]) {\n          subticks.push(v);\n        }\n      }\n    }\n    for (--i, j = 0; ++j < m && (v = +ticks[i] + j * d) < extent[1];) {\n      subticks.push(v);\n    }\n  }\n  return subticks;\n}\nd3.svg.brush = function() {\n  var event = d3_eventDispatch(brush, \"brushstart\", \"brush\", \"brushend\"),\n      x = null, // x-scale, optional\n      y = null, // y-scale, optional\n      resizes = d3_svg_brushResizes[0],\n      extent = [[0, 0], [0, 0]], // [x0, y0], [x1, y1], in pixels (integers)\n      extentDomain; // the extent in data space, lazily created\n\n  function brush(g) {\n    g.each(function() {\n      var g = d3.select(this),\n          bg = g.selectAll(\".background\").data([0]),\n          fg = g.selectAll(\".extent\").data([0]),\n          tz = g.selectAll(\".resize\").data(resizes, String),\n          e;\n\n      // Prepare the brush container for events.\n      g\n          .style(\"pointer-events\", \"all\")\n          .on(\"mousedown.brush\", brushstart)\n          .on(\"touchstart.brush\", brushstart);\n\n      // An invisible, mouseable area for starting a new brush.\n      bg.enter().append(\"rect\")\n          .attr(\"class\", \"background\")\n          .style(\"visibility\", \"hidden\")\n          .style(\"cursor\", \"crosshair\");\n\n      // The visible brush extent; style this as you like!\n      fg.enter().append(\"rect\")\n          .attr(\"class\", \"extent\")\n          .style(\"cursor\", \"move\");\n\n      // More invisible rects for resizing the extent.\n      tz.enter().append(\"g\")\n          .attr(\"class\", function(d) { return \"resize \" + d; })\n          .style(\"cursor\", function(d) { return d3_svg_brushCursor[d]; })\n        .append(\"rect\")\n          .attr(\"x\", function(d) { return /[ew]$/.test(d) ? -3 : null; })\n          .attr(\"y\", function(d) { return /^[ns]/.test(d) ? -3 : null; })\n          .attr(\"width\", 6)\n          .attr(\"height\", 6)\n          .style(\"visibility\", \"hidden\");\n\n      // Show or hide the resizers.\n      tz.style(\"display\", brush.empty() ? \"none\" : null);\n\n      // Remove any superfluous resizers.\n      tz.exit().remove();\n\n      // Initialize the background to fill the defined range.\n      // If the range isn't defined, you can post-process.\n      if (x) {\n        e = d3_scaleRange(x);\n        bg.attr(\"x\", e[0]).attr(\"width\", e[1] - e[0]);\n        redrawX(g);\n      }\n      if (y) {\n        e = d3_scaleRange(y);\n        bg.attr(\"y\", e[0]).attr(\"height\", e[1] - e[0]);\n        redrawY(g);\n      }\n      redraw(g);\n    });\n  }\n\n  function redraw(g) {\n    g.selectAll(\".resize\").attr(\"transform\", function(d) {\n      return \"translate(\" + extent[+/e$/.test(d)][0] + \",\" + extent[+/^s/.test(d)][1] + \")\";\n    });\n  }\n\n  function redrawX(g) {\n    g.select(\".extent\").attr(\"x\", extent[0][0]);\n    g.selectAll(\".extent,.n>rect,.s>rect\").attr(\"width\", extent[1][0] - extent[0][0]);\n  }\n\n  function redrawY(g) {\n    g.select(\".extent\").attr(\"y\", extent[0][1]);\n    g.selectAll(\".extent,.e>rect,.w>rect\").attr(\"height\", extent[1][1] - extent[0][1]);\n  }\n\n  function brushstart() {\n    var target = this,\n        eventTarget = d3.select(d3.event.target),\n        event_ = event.of(target, arguments),\n        g = d3.select(target),\n        resizing = eventTarget.datum(),\n        resizingX = !/^(n|s)$/.test(resizing) && x,\n        resizingY = !/^(e|w)$/.test(resizing) && y,\n        dragging = eventTarget.classed(\"extent\"),\n        center,\n        origin = mouse(),\n        offset;\n\n    var w = d3.select(window)\n        .on(\"mousemove.brush\", brushmove)\n        .on(\"mouseup.brush\", brushend)\n        .on(\"touchmove.brush\", brushmove)\n        .on(\"touchend.brush\", brushend)\n        .on(\"keydown.brush\", keydown)\n        .on(\"keyup.brush\", keyup);\n\n    // If the extent was clicked on, drag rather than brush;\n    // store the point between the mouse and extent origin instead.\n    if (dragging) {\n      origin[0] = extent[0][0] - origin[0];\n      origin[1] = extent[0][1] - origin[1];\n    }\n\n    // If a resizer was clicked on, record which side is to be resized.\n    // Also, set the origin to the opposite side.\n    else if (resizing) {\n      var ex = +/w$/.test(resizing),\n          ey = +/^n/.test(resizing);\n      offset = [extent[1 - ex][0] - origin[0], extent[1 - ey][1] - origin[1]];\n      origin[0] = extent[ex][0];\n      origin[1] = extent[ey][1];\n    }\n\n    // If the ALT key is down when starting a brush, the center is at the mouse.\n    else if (d3.event.altKey) center = origin.slice();\n\n    // Propagate the active cursor to the body for the drag duration.\n    g.style(\"pointer-events\", \"none\").selectAll(\".resize\").style(\"display\", null);\n    d3.select(\"body\").style(\"cursor\", eventTarget.style(\"cursor\"));\n\n    // Notify listeners.\n    event_({type: \"brushstart\"});\n    brushmove();\n    d3_eventCancel();\n\n    function mouse() {\n      var touches = d3.event.changedTouches;\n      return touches ? d3.touches(target, touches)[0] : d3.mouse(target);\n    }\n\n    function keydown() {\n      if (d3.event.keyCode == 32) {\n        if (!dragging) {\n          center = null;\n          origin[0] -= extent[1][0];\n          origin[1] -= extent[1][1];\n          dragging = 2;\n        }\n        d3_eventCancel();\n      }\n    }\n\n    function keyup() {\n      if (d3.event.keyCode == 32 && dragging == 2) {\n        origin[0] += extent[1][0];\n        origin[1] += extent[1][1];\n        dragging = 0;\n        d3_eventCancel();\n      }\n    }\n\n    function brushmove() {\n      var point = mouse(),\n          moved = false;\n\n      // Preserve the offset for thick resizers.\n      if (offset) {\n        point[0] += offset[0];\n        point[1] += offset[1];\n      }\n\n      if (!dragging) {\n\n        // If needed, determine the center from the current extent.\n        if (d3.event.altKey) {\n          if (!center) center = [(extent[0][0] + extent[1][0]) / 2, (extent[0][1] + extent[1][1]) / 2];\n\n          // Update the origin, for when the ALT key is released.\n          origin[0] = extent[+(point[0] < center[0])][0];\n          origin[1] = extent[+(point[1] < center[1])][1];\n        }\n\n        // When the ALT key is released, we clear the center.\n        else center = null;\n      }\n\n      // Update the brush extent for each dimension.\n      if (resizingX && move1(point, x, 0)) {\n        redrawX(g);\n        moved = true;\n      }\n      if (resizingY && move1(point, y, 1)) {\n        redrawY(g);\n        moved = true;\n      }\n\n      // Final redraw and notify listeners.\n      if (moved) {\n        redraw(g);\n        event_({type: \"brush\", mode: dragging ? \"move\" : \"resize\"});\n      }\n    }\n\n    function move1(point, scale, i) {\n      var range = d3_scaleRange(scale),\n          r0 = range[0],\n          r1 = range[1],\n          position = origin[i],\n          size = extent[1][i] - extent[0][i],\n          min,\n          max;\n\n      // When dragging, reduce the range by the extent size and position.\n      if (dragging) {\n        r0 -= position;\n        r1 -= size + position;\n      }\n\n      // Clamp the point so that the extent fits within the range extent.\n      min = Math.max(r0, Math.min(r1, point[i]));\n\n      // Compute the new extent bounds.\n      if (dragging) {\n        max = (min += position) + size;\n      } else {\n\n        // If the ALT key is pressed, then preserve the center of the extent.\n        if (center) position = Math.max(r0, Math.min(r1, 2 * center[i] - min));\n\n        // Compute the min and max of the position and point.\n        if (position < min) {\n          max = min;\n          min = position;\n        } else {\n          max = position;\n        }\n      }\n\n      // Update the stored bounds.\n      if (extent[0][i] !== min || extent[1][i] !== max) {\n        extentDomain = null;\n        extent[0][i] = min;\n        extent[1][i] = max;\n        return true;\n      }\n    }\n\n    function brushend() {\n      brushmove();\n\n      // reset the cursor styles\n      g.style(\"pointer-events\", \"all\").selectAll(\".resize\").style(\"display\", brush.empty() ? \"none\" : null);\n      d3.select(\"body\").style(\"cursor\", null);\n\n      w .on(\"mousemove.brush\", null)\n        .on(\"mouseup.brush\", null)\n        .on(\"touchmove.brush\", null)\n        .on(\"touchend.brush\", null)\n        .on(\"keydown.brush\", null)\n        .on(\"keyup.brush\", null);\n\n      event_({type: \"brushend\"});\n      d3_eventCancel();\n    }\n  }\n\n  brush.x = function(z) {\n    if (!arguments.length) return x;\n    x = z;\n    resizes = d3_svg_brushResizes[!x << 1 | !y]; // fore!\n    return brush;\n  };\n\n  brush.y = function(z) {\n    if (!arguments.length) return y;\n    y = z;\n    resizes = d3_svg_brushResizes[!x << 1 | !y]; // fore!\n    return brush;\n  };\n\n  brush.extent = function(z) {\n    var x0, x1, y0, y1, t;\n\n    // Invert the pixel extent to data-space.\n    if (!arguments.length) {\n      z = extentDomain || extent;\n      if (x) {\n        x0 = z[0][0], x1 = z[1][0];\n        if (!extentDomain) {\n          x0 = extent[0][0], x1 = extent[1][0];\n          if (x.invert) x0 = x.invert(x0), x1 = x.invert(x1);\n          if (x1 < x0) t = x0, x0 = x1, x1 = t;\n        }\n      }\n      if (y) {\n        y0 = z[0][1], y1 = z[1][1];\n        if (!extentDomain) {\n          y0 = extent[0][1], y1 = extent[1][1];\n          if (y.invert) y0 = y.invert(y0), y1 = y.invert(y1);\n          if (y1 < y0) t = y0, y0 = y1, y1 = t;\n        }\n      }\n      return x && y ? [[x0, y0], [x1, y1]] : x ? [x0, x1] : y && [y0, y1];\n    }\n\n    // Scale the data-space extent to pixels.\n    extentDomain = [[0, 0], [0, 0]];\n    if (x) {\n      x0 = z[0], x1 = z[1];\n      if (y) x0 = x0[0], x1 = x1[0];\n      extentDomain[0][0] = x0, extentDomain[1][0] = x1;\n      if (x.invert) x0 = x(x0), x1 = x(x1);\n      if (x1 < x0) t = x0, x0 = x1, x1 = t;\n      extent[0][0] = x0 | 0, extent[1][0] = x1 | 0;\n    }\n    if (y) {\n      y0 = z[0], y1 = z[1];\n      if (x) y0 = y0[1], y1 = y1[1];\n      extentDomain[0][1] = y0, extentDomain[1][1] = y1;\n      if (y.invert) y0 = y(y0), y1 = y(y1);\n      if (y1 < y0) t = y0, y0 = y1, y1 = t;\n      extent[0][1] = y0 | 0, extent[1][1] = y1 | 0;\n    }\n\n    return brush;\n  };\n\n  brush.clear = function() {\n    extentDomain = null;\n    extent[0][0] =\n    extent[0][1] =\n    extent[1][0] =\n    extent[1][1] = 0;\n    return brush;\n  };\n\n  brush.empty = function() {\n    return (x && extent[0][0] === extent[1][0])\n        || (y && extent[0][1] === extent[1][1]);\n  };\n\n  return d3.rebind(brush, event, \"on\");\n};\n\nvar d3_svg_brushCursor = {\n  n: \"ns-resize\",\n  e: \"ew-resize\",\n  s: \"ns-resize\",\n  w: \"ew-resize\",\n  nw: \"nwse-resize\",\n  ne: \"nesw-resize\",\n  se: \"nwse-resize\",\n  sw: \"nesw-resize\"\n};\n\nvar d3_svg_brushResizes = [\n  [\"n\", \"e\", \"s\", \"w\", \"nw\", \"ne\", \"se\", \"sw\"],\n  [\"e\", \"w\"],\n  [\"n\", \"s\"],\n  []\n];\nd3.behavior = {};\n// TODO Track touch points by identifier.\n\nd3.behavior.drag = function() {\n  var event = d3_eventDispatch(drag, \"drag\", \"dragstart\", \"dragend\"),\n      origin = null;\n\n  function drag() {\n    this.on(\"mousedown.drag\", mousedown)\n        .on(\"touchstart.drag\", mousedown);\n  }\n\n  function mousedown() {\n    var target = this,\n        event_ = event.of(target, arguments),\n        eventTarget = d3.event.target,\n        offset,\n        origin_ = point(),\n        moved = 0;\n\n    var w = d3.select(window)\n        .on(\"mousemove.drag\", dragmove)\n        .on(\"touchmove.drag\", dragmove)\n        .on(\"mouseup.drag\", dragend, true)\n        .on(\"touchend.drag\", dragend, true);\n\n    if (origin) {\n      offset = origin.apply(target, arguments);\n      offset = [offset.x - origin_[0], offset.y - origin_[1]];\n    } else {\n      offset = [0, 0];\n    }\n\n    d3_eventCancel();\n    event_({type: \"dragstart\"});\n\n    function point() {\n      var p = target.parentNode,\n          t = d3.event.changedTouches;\n      return t ? d3.touches(p, t)[0] : d3.mouse(p);\n    }\n\n    function dragmove() {\n      if (!target.parentNode) return dragend(); // target removed from DOM\n\n      var p = point(),\n          dx = p[0] - origin_[0],\n          dy = p[1] - origin_[1];\n\n      moved |= dx | dy;\n      origin_ = p;\n      d3_eventCancel();\n\n      event_({type: \"drag\", x: p[0] + offset[0], y: p[1] + offset[1], dx: dx, dy: dy});\n    }\n\n    function dragend() {\n      event_({type: \"dragend\"});\n\n      // if moved, prevent the mouseup (and possibly click) from propagating\n      if (moved) {\n        d3_eventCancel();\n        if (d3.event.target === eventTarget) w.on(\"click.drag\", click, true);\n      }\n\n      w .on(\"mousemove.drag\", null)\n        .on(\"touchmove.drag\", null)\n        .on(\"mouseup.drag\", null)\n        .on(\"touchend.drag\", null);\n    }\n\n    // prevent the subsequent click from propagating (e.g., for anchors)\n    function click() {\n      d3_eventCancel();\n      w.on(\"click.drag\", null);\n    }\n  }\n\n  drag.origin = function(x) {\n    if (!arguments.length) return origin;\n    origin = x;\n    return drag;\n  };\n\n  return d3.rebind(drag, event, \"on\");\n};\nd3.behavior.zoom = function() {\n  var translate = [0, 0],\n      translate0, // translate when we started zooming (to avoid drift)\n      scale = 1,\n      scale0, // scale when we started touching\n      scaleExtent = d3_behavior_zoomInfinity,\n      event = d3_eventDispatch(zoom, \"zoom\"),\n      x0,\n      x1,\n      y0,\n      y1,\n      touchtime; // time of last touchstart (to detect double-tap)\n\n  function zoom() {\n    this\n        .on(\"mousedown.zoom\", mousedown)\n        .on(\"mousewheel.zoom\", mousewheel)\n        .on(\"mousemove.zoom\", mousemove)\n        .on(\"DOMMouseScroll.zoom\", mousewheel)\n        .on(\"dblclick.zoom\", dblclick)\n        .on(\"touchstart.zoom\", touchstart)\n        .on(\"touchmove.zoom\", touchmove)\n        .on(\"touchend.zoom\", touchstart);\n  }\n\n  zoom.translate = function(x) {\n    if (!arguments.length) return translate;\n    translate = x.map(Number);\n    return zoom;\n  };\n\n  zoom.scale = function(x) {\n    if (!arguments.length) return scale;\n    scale = +x;\n    return zoom;\n  };\n\n  zoom.scaleExtent = function(x) {\n    if (!arguments.length) return scaleExtent;\n    scaleExtent = x == null ? d3_behavior_zoomInfinity : x.map(Number);\n    return zoom;\n  };\n\n  zoom.x = function(z) {\n    if (!arguments.length) return x1;\n    x1 = z;\n    x0 = z.copy();\n    return zoom;\n  };\n\n  zoom.y = function(z) {\n    if (!arguments.length) return y1;\n    y1 = z;\n    y0 = z.copy();\n    return zoom;\n  };\n\n  function location(p) {\n    return [(p[0] - translate[0]) / scale, (p[1] - translate[1]) / scale];\n  }\n\n  function point(l) {\n    return [l[0] * scale + translate[0], l[1] * scale + translate[1]];\n  }\n\n  function scaleTo(s) {\n    scale = Math.max(scaleExtent[0], Math.min(scaleExtent[1], s));\n  }\n\n  function translateTo(p, l) {\n    l = point(l);\n    translate[0] += p[0] - l[0];\n    translate[1] += p[1] - l[1];\n  }\n\n  function dispatch(event) {\n    if (x1) x1.domain(x0.range().map(function(x) { return (x - translate[0]) / scale; }).map(x0.invert));\n    if (y1) y1.domain(y0.range().map(function(y) { return (y - translate[1]) / scale; }).map(y0.invert));\n    d3.event.preventDefault();\n    event({type: \"zoom\", scale: scale, translate: translate});\n  }\n\n  function mousedown() {\n    var target = this,\n        event_ = event.of(target, arguments),\n        eventTarget = d3.event.target,\n        moved = 0,\n        w = d3.select(window).on(\"mousemove.zoom\", mousemove).on(\"mouseup.zoom\", mouseup),\n        l = location(d3.mouse(target));\n\n    window.focus();\n    d3_eventCancel();\n\n    function mousemove() {\n      moved = 1;\n      translateTo(d3.mouse(target), l);\n      dispatch(event_);\n    }\n\n    function mouseup() {\n      if (moved) d3_eventCancel();\n      w.on(\"mousemove.zoom\", null).on(\"mouseup.zoom\", null);\n      if (moved && d3.event.target === eventTarget) w.on(\"click.zoom\", click, true);\n    }\n\n    function click() {\n      d3_eventCancel();\n      w.on(\"click.zoom\", null);\n    }\n  }\n\n  function mousewheel() {\n    if (!translate0) translate0 = location(d3.mouse(this));\n    scaleTo(Math.pow(2, d3_behavior_zoomDelta() * .002) * scale);\n    translateTo(d3.mouse(this), translate0);\n    dispatch(event.of(this, arguments));\n  }\n\n  function mousemove() {\n    translate0 = null;\n  }\n\n  function dblclick() {\n    var p = d3.mouse(this), l = location(p);\n    scaleTo(d3.event.shiftKey ? scale / 2 : scale * 2);\n    translateTo(p, l);\n    dispatch(event.of(this, arguments));\n  }\n\n  function touchstart() {\n    var touches = d3.touches(this),\n        now = Date.now();\n\n    scale0 = scale;\n    translate0 = {};\n    touches.forEach(function(t) { translate0[t.identifier] = location(t); });\n    d3_eventCancel();\n\n    if ((touches.length === 1) && (now - touchtime < 500)) { // dbltap\n      var p = touches[0], l = location(touches[0]);\n      scaleTo(scale * 2);\n      translateTo(p, l);\n      dispatch(event.of(this, arguments));\n    }\n    touchtime = now;\n  }\n\n  function touchmove() {\n    var touches = d3.touches(this),\n        p0 = touches[0],\n        l0 = translate0[p0.identifier];\n    if (p1 = touches[1]) {\n      var p1, l1 = translate0[p1.identifier];\n      p0 = [(p0[0] + p1[0]) / 2, (p0[1] + p1[1]) / 2];\n      l0 = [(l0[0] + l1[0]) / 2, (l0[1] + l1[1]) / 2];\n      scaleTo(d3.event.scale * scale0);\n    }\n    translateTo(p0, l0);\n    dispatch(event.of(this, arguments));\n  }\n\n  return d3.rebind(zoom, event, \"on\");\n};\n\nvar d3_behavior_zoomDiv, // for interpreting mousewheel events\n    d3_behavior_zoomInfinity = [0, Infinity]; // default scale extent\n\nfunction d3_behavior_zoomDelta() {\n\n  // mousewheel events are totally broken!\n  // https://bugs.webkit.org/show_bug.cgi?id=40441\n  // not only that, but Chrome and Safari differ in re. to acceleration!\n  if (!d3_behavior_zoomDiv) {\n    d3_behavior_zoomDiv = d3.select(\"body\").append(\"div\")\n        .style(\"visibility\", \"hidden\")\n        .style(\"top\", 0)\n        .style(\"height\", 0)\n        .style(\"width\", 0)\n        .style(\"overflow-y\", \"scroll\")\n      .append(\"div\")\n        .style(\"height\", \"2000px\")\n      .node().parentNode;\n  }\n\n  var e = d3.event, delta;\n  try {\n    d3_behavior_zoomDiv.scrollTop = 1000;\n    d3_behavior_zoomDiv.dispatchEvent(e);\n    delta = 1000 - d3_behavior_zoomDiv.scrollTop;\n  } catch (error) {\n    delta = e.wheelDelta || (-e.detail * 5);\n  }\n\n  return delta;\n}\nd3.layout = {};\n// Implements hierarchical edge bundling using Holten's algorithm. For each\n// input link, a path is computed that travels through the tree, up the parent\n// hierarchy to the least common ancestor, and then back down to the destination\n// node. Each path is simply an array of nodes.\nd3.layout.bundle = function() {\n  return function(links) {\n    var paths = [],\n        i = -1,\n        n = links.length;\n    while (++i < n) paths.push(d3_layout_bundlePath(links[i]));\n    return paths;\n  };\n};\n\nfunction d3_layout_bundlePath(link) {\n  var start = link.source,\n      end = link.target,\n      lca = d3_layout_bundleLeastCommonAncestor(start, end),\n      points = [start];\n  while (start !== lca) {\n    start = start.parent;\n    points.push(start);\n  }\n  var k = points.length;\n  while (end !== lca) {\n    points.splice(k, 0, end);\n    end = end.parent;\n  }\n  return points;\n}\n\nfunction d3_layout_bundleAncestors(node) {\n  var ancestors = [],\n      parent = node.parent;\n  while (parent != null) {\n    ancestors.push(node);\n    node = parent;\n    parent = parent.parent;\n  }\n  ancestors.push(node);\n  return ancestors;\n}\n\nfunction d3_layout_bundleLeastCommonAncestor(a, b) {\n  if (a === b) return a;\n  var aNodes = d3_layout_bundleAncestors(a),\n      bNodes = d3_layout_bundleAncestors(b),\n      aNode = aNodes.pop(),\n      bNode = bNodes.pop(),\n      sharedNode = null;\n  while (aNode === bNode) {\n    sharedNode = aNode;\n    aNode = aNodes.pop();\n    bNode = bNodes.pop();\n  }\n  return sharedNode;\n}\nd3.layout.chord = function() {\n  var chord = {},\n      chords,\n      groups,\n      matrix,\n      n,\n      padding = 0,\n      sortGroups,\n      sortSubgroups,\n      sortChords;\n\n  function relayout() {\n    var subgroups = {},\n        groupSums = [],\n        groupIndex = d3.range(n),\n        subgroupIndex = [],\n        k,\n        x,\n        x0,\n        i,\n        j;\n\n    chords = [];\n    groups = [];\n\n    // Compute the sum.\n    k = 0, i = -1; while (++i < n) {\n      x = 0, j = -1; while (++j < n) {\n        x += matrix[i][j];\n      }\n      groupSums.push(x);\n      subgroupIndex.push(d3.range(n));\n      k += x;\n    }\n\n    // Sort groupsâ€¦\n    if (sortGroups) {\n      groupIndex.sort(function(a, b) {\n        return sortGroups(groupSums[a], groupSums[b]);\n      });\n    }\n\n    // Sort subgroupsâ€¦\n    if (sortSubgroups) {\n      subgroupIndex.forEach(function(d, i) {\n        d.sort(function(a, b) {\n          return sortSubgroups(matrix[i][a], matrix[i][b]);\n        });\n      });\n    }\n\n    // Convert the sum to scaling factor for [0, 2pi].\n    // TODO Allow start and end angle to be specified.\n    // TODO Allow padding to be specified as percentage?\n    k = (2 * Math.PI - padding * n) / k;\n\n    // Compute the start and end angle for each group and subgroup.\n    // Note: Opera has a bug reordering object literal properties!\n    x = 0, i = -1; while (++i < n) {\n      x0 = x, j = -1; while (++j < n) {\n        var di = groupIndex[i],\n            dj = subgroupIndex[di][j],\n            v = matrix[di][dj],\n            a0 = x,\n            a1 = x += v * k;\n        subgroups[di + \"-\" + dj] = {\n          index: di,\n          subindex: dj,\n          startAngle: a0,\n          endAngle: a1,\n          value: v\n        };\n      }\n      groups[di] = {\n        index: di,\n        startAngle: x0,\n        endAngle: x,\n        value: (x - x0) / k\n      };\n      x += padding;\n    }\n\n    // Generate chords for each (non-empty) subgroup-subgroup link.\n    i = -1; while (++i < n) {\n      j = i - 1; while (++j < n) {\n        var source = subgroups[i + \"-\" + j],\n            target = subgroups[j + \"-\" + i];\n        if (source.value || target.value) {\n          chords.push(source.value < target.value\n              ? {source: target, target: source}\n              : {source: source, target: target});\n        }\n      }\n    }\n\n    if (sortChords) resort();\n  }\n\n  function resort() {\n    chords.sort(function(a, b) {\n      return sortChords(\n          (a.source.value + a.target.value) / 2,\n          (b.source.value + b.target.value) / 2);\n    });\n  }\n\n  chord.matrix = function(x) {\n    if (!arguments.length) return matrix;\n    n = (matrix = x) && matrix.length;\n    chords = groups = null;\n    return chord;\n  };\n\n  chord.padding = function(x) {\n    if (!arguments.length) return padding;\n    padding = x;\n    chords = groups = null;\n    return chord;\n  };\n\n  chord.sortGroups = function(x) {\n    if (!arguments.length) return sortGroups;\n    sortGroups = x;\n    chords = groups = null;\n    return chord;\n  };\n\n  chord.sortSubgroups = function(x) {\n    if (!arguments.length) return sortSubgroups;\n    sortSubgroups = x;\n    chords = null;\n    return chord;\n  };\n\n  chord.sortChords = function(x) {\n    if (!arguments.length) return sortChords;\n    sortChords = x;\n    if (chords) resort();\n    return chord;\n  };\n\n  chord.chords = function() {\n    if (!chords) relayout();\n    return chords;\n  };\n\n  chord.groups = function() {\n    if (!groups) relayout();\n    return groups;\n  };\n\n  return chord;\n};\n// A rudimentary force layout using Gauss-Seidel.\nd3.layout.force = function() {\n  var force = {},\n      event = d3.dispatch(\"start\", \"tick\", \"end\"),\n      size = [1, 1],\n      drag,\n      alpha,\n      friction = .9,\n      linkDistance = d3_layout_forceLinkDistance,\n      linkStrength = d3_layout_forceLinkStrength,\n      charge = -30,\n      gravity = .1,\n      theta = .8,\n      interval,\n      nodes = [],\n      links = [],\n      distances,\n      strengths,\n      charges;\n\n  function repulse(node) {\n    return function(quad, x1, y1, x2, y2) {\n      if (quad.point !== node) {\n        var dx = quad.cx - node.x,\n            dy = quad.cy - node.y,\n            dn = 1 / Math.sqrt(dx * dx + dy * dy);\n\n        /* Barnes-Hut criterion. */\n        if ((x2 - x1) * dn < theta) {\n          var k = quad.charge * dn * dn;\n          node.px -= dx * k;\n          node.py -= dy * k;\n          return true;\n        }\n\n        if (quad.point && isFinite(dn)) {\n          var k = quad.pointCharge * dn * dn;\n          node.px -= dx * k;\n          node.py -= dy * k;\n        }\n      }\n      return !quad.charge;\n    };\n  }\n\n  force.tick = function() {\n    // simulated annealing, basically\n    if ((alpha *= .99) < .005) {\n      event.end({type: \"end\", alpha: alpha = 0});\n      return true;\n    }\n\n    var n = nodes.length,\n        m = links.length,\n        q,\n        i, // current index\n        o, // current object\n        s, // current source\n        t, // current target\n        l, // current distance\n        k, // current force\n        x, // x-distance\n        y; // y-distance\n\n    // gauss-seidel relaxation for links\n    for (i = 0; i < m; ++i) {\n      o = links[i];\n      s = o.source;\n      t = o.target;\n      x = t.x - s.x;\n      y = t.y - s.y;\n      if (l = (x * x + y * y)) {\n        l = alpha * strengths[i] * ((l = Math.sqrt(l)) - distances[i]) / l;\n        x *= l;\n        y *= l;\n        t.x -= x * (k = s.weight / (t.weight + s.weight));\n        t.y -= y * k;\n        s.x += x * (k = 1 - k);\n        s.y += y * k;\n      }\n    }\n\n    // apply gravity forces\n    if (k = alpha * gravity) {\n      x = size[0] / 2;\n      y = size[1] / 2;\n      i = -1; if (k) while (++i < n) {\n        o = nodes[i];\n        o.x += (x - o.x) * k;\n        o.y += (y - o.y) * k;\n      }\n    }\n\n    // compute quadtree center of mass and apply charge forces\n    if (charge) {\n      d3_layout_forceAccumulate(q = d3.geom.quadtree(nodes), alpha, charges);\n      i = -1; while (++i < n) {\n        if (!(o = nodes[i]).fixed) {\n          q.visit(repulse(o));\n        }\n      }\n    }\n\n    // position verlet integration\n    i = -1; while (++i < n) {\n      o = nodes[i];\n      if (o.fixed) {\n        o.x = o.px;\n        o.y = o.py;\n      } else {\n        o.x -= (o.px - (o.px = o.x)) * friction;\n        o.y -= (o.py - (o.py = o.y)) * friction;\n      }\n    }\n\n    event.tick({type: \"tick\", alpha: alpha});\n  };\n\n  force.nodes = function(x) {\n    if (!arguments.length) return nodes;\n    nodes = x;\n    return force;\n  };\n\n  force.links = function(x) {\n    if (!arguments.length) return links;\n    links = x;\n    return force;\n  };\n\n  force.size = function(x) {\n    if (!arguments.length) return size;\n    size = x;\n    return force;\n  };\n\n  force.linkDistance = function(x) {\n    if (!arguments.length) return linkDistance;\n    linkDistance = d3_functor(x);\n    return force;\n  };\n\n  // For backwards-compatibility.\n  force.distance = force.linkDistance;\n\n  force.linkStrength = function(x) {\n    if (!arguments.length) return linkStrength;\n    linkStrength = d3_functor(x);\n    return force;\n  };\n\n  force.friction = function(x) {\n    if (!arguments.length) return friction;\n    friction = x;\n    return force;\n  };\n\n  force.charge = function(x) {\n    if (!arguments.length) return charge;\n    charge = typeof x === \"function\" ? x : +x;\n    return force;\n  };\n\n  force.gravity = function(x) {\n    if (!arguments.length) return gravity;\n    gravity = x;\n    return force;\n  };\n\n  force.theta = function(x) {\n    if (!arguments.length) return theta;\n    theta = x;\n    return force;\n  };\n\n  force.alpha = function(x) {\n    if (!arguments.length) return alpha;\n\n    if (alpha) { // if we're already running\n      if (x > 0) alpha = x; // we might keep it hot\n      else alpha = 0; // or, next tick will dispatch \"end\"\n    } else if (x > 0) { // otherwise, fire it up!\n      event.start({type: \"start\", alpha: alpha = x});\n      d3.timer(force.tick);\n    }\n\n    return force;\n  };\n\n  force.start = function() {\n    var i,\n        j,\n        n = nodes.length,\n        m = links.length,\n        w = size[0],\n        h = size[1],\n        neighbors,\n        o;\n\n    for (i = 0; i < n; ++i) {\n      (o = nodes[i]).index = i;\n      o.weight = 0;\n    }\n\n    distances = [];\n    strengths = [];\n    for (i = 0; i < m; ++i) {\n      o = links[i];\n      if (typeof o.source == \"number\") o.source = nodes[o.source];\n      if (typeof o.target == \"number\") o.target = nodes[o.target];\n      distances[i] = linkDistance.call(this, o, i);\n      strengths[i] = linkStrength.call(this, o, i);\n      ++o.source.weight;\n      ++o.target.weight;\n    }\n\n    for (i = 0; i < n; ++i) {\n      o = nodes[i];\n      if (isNaN(o.x)) o.x = position(\"x\", w);\n      if (isNaN(o.y)) o.y = position(\"y\", h);\n      if (isNaN(o.px)) o.px = o.x;\n      if (isNaN(o.py)) o.py = o.y;\n    }\n\n    charges = [];\n    if (typeof charge === \"function\") {\n      for (i = 0; i < n; ++i) {\n        charges[i] = +charge.call(this, nodes[i], i);\n      }\n    } else {\n      for (i = 0; i < n; ++i) {\n        charges[i] = charge;\n      }\n    }\n\n    // initialize node position based on first neighbor\n    function position(dimension, size) {\n      var neighbors = neighbor(i),\n          j = -1,\n          m = neighbors.length,\n          x;\n      while (++j < m) if (!isNaN(x = neighbors[j][dimension])) return x;\n      return Math.random() * size;\n    }\n\n    // initialize neighbors lazily\n    function neighbor() {\n      if (!neighbors) {\n        neighbors = [];\n        for (j = 0; j < n; ++j) {\n          neighbors[j] = [];\n        }\n        for (j = 0; j < m; ++j) {\n          var o = links[j];\n          neighbors[o.source.index].push(o.target);\n          neighbors[o.target.index].push(o.source);\n        }\n      }\n      return neighbors[i];\n    }\n\n    return force.resume();\n  };\n\n  force.resume = function() {\n    return force.alpha(.1);\n  };\n\n  force.stop = function() {\n    return force.alpha(0);\n  };\n\n  // use `node.call(force.drag)` to make nodes draggable\n  force.drag = function() {\n    if (!drag) drag = d3.behavior.drag()\n        .origin(d3_identity)\n        .on(\"dragstart\", dragstart)\n        .on(\"drag\", d3_layout_forceDrag)\n        .on(\"dragend\", d3_layout_forceDragEnd);\n\n    this.on(\"mouseover.force\", d3_layout_forceDragOver)\n        .on(\"mouseout.force\", d3_layout_forceDragOut)\n        .call(drag);\n  };\n\n  function dragstart(d) {\n    d3_layout_forceDragOver(d3_layout_forceDragNode = d);\n    d3_layout_forceDragForce = force;\n  }\n\n  return d3.rebind(force, event, \"on\");\n};\n\nvar d3_layout_forceDragForce,\n    d3_layout_forceDragNode;\n\nfunction d3_layout_forceDragOver(d) {\n  d.fixed |= 2;\n}\n\nfunction d3_layout_forceDragOut(d) {\n  if (d !== d3_layout_forceDragNode) d.fixed &= 1;\n}\n\nfunction d3_layout_forceDragEnd() {\n  d3_layout_forceDragNode.fixed &= 1;\n  d3_layout_forceDragForce = d3_layout_forceDragNode = null;\n}\n\nfunction d3_layout_forceDrag() {\n  d3_layout_forceDragNode.px = d3.event.x;\n  d3_layout_forceDragNode.py = d3.event.y;\n  d3_layout_forceDragForce.resume(); // restart annealing\n}\n\nfunction d3_layout_forceAccumulate(quad, alpha, charges) {\n  var cx = 0,\n      cy = 0;\n  quad.charge = 0;\n  if (!quad.leaf) {\n    var nodes = quad.nodes,\n        n = nodes.length,\n        i = -1,\n        c;\n    while (++i < n) {\n      c = nodes[i];\n      if (c == null) continue;\n      d3_layout_forceAccumulate(c, alpha, charges);\n      quad.charge += c.charge;\n      cx += c.charge * c.cx;\n      cy += c.charge * c.cy;\n    }\n  }\n  if (quad.point) {\n    // jitter internal nodes that are coincident\n    if (!quad.leaf) {\n      quad.point.x += Math.random() - .5;\n      quad.point.y += Math.random() - .5;\n    }\n    var k = alpha * charges[quad.point.index];\n    quad.charge += quad.pointCharge = k;\n    cx += k * quad.point.x;\n    cy += k * quad.point.y;\n  }\n  quad.cx = cx / quad.charge;\n  quad.cy = cy / quad.charge;\n}\n\nfunction d3_layout_forceLinkDistance(link) {\n  return 20;\n}\n\nfunction d3_layout_forceLinkStrength(link) {\n  return 1;\n}\nd3.layout.partition = function() {\n  var hierarchy = d3.layout.hierarchy(),\n      size = [1, 1]; // width, height\n\n  function position(node, x, dx, dy) {\n    var children = node.children;\n    node.x = x;\n    node.y = node.depth * dy;\n    node.dx = dx;\n    node.dy = dy;\n    if (children && (n = children.length)) {\n      var i = -1,\n          n,\n          c,\n          d;\n      dx = node.value ? dx / node.value : 0;\n      while (++i < n) {\n        position(c = children[i], x, d = c.value * dx, dy);\n        x += d;\n      }\n    }\n  }\n\n  function depth(node) {\n    var children = node.children,\n        d = 0;\n    if (children && (n = children.length)) {\n      var i = -1,\n          n;\n      while (++i < n) d = Math.max(d, depth(children[i]));\n    }\n    return 1 + d;\n  }\n\n  function partition(d, i) {\n    var nodes = hierarchy.call(this, d, i);\n    position(nodes[0], 0, size[0], size[1] / depth(nodes[0]));\n    return nodes;\n  }\n\n  partition.size = function(x) {\n    if (!arguments.length) return size;\n    size = x;\n    return partition;\n  };\n\n  return d3_layout_hierarchyRebind(partition, hierarchy);\n};\nd3.layout.pie = function() {\n  var value = Number,\n      sort = d3_layout_pieSortByValue,\n      startAngle = 0,\n      endAngle = 2 * Math.PI;\n\n  function pie(data, i) {\n\n    // Compute the numeric values for each data element.\n    var values = data.map(function(d, i) { return +value.call(pie, d, i); });\n\n    // Compute the start angle.\n    var a = +(typeof startAngle === \"function\"\n        ? startAngle.apply(this, arguments)\n        : startAngle);\n\n    // Compute the angular scale factor: from value to radians.\n    var k = ((typeof endAngle === \"function\"\n        ? endAngle.apply(this, arguments)\n        : endAngle) - startAngle)\n        / d3.sum(values);\n\n    // Optionally sort the data.\n    var index = d3.range(data.length);\n    if (sort != null) index.sort(sort === d3_layout_pieSortByValue\n        ? function(i, j) { return values[j] - values[i]; }\n        : function(i, j) { return sort(data[i], data[j]); });\n\n    // Compute the arcs!\n    // They are stored in the original data's order.\n    var arcs = [];\n    index.forEach(function(i) {\n      var d;\n      arcs[i] = {\n        data: data[i],\n        value: d = values[i],\n        startAngle: a,\n        endAngle: a += d * k\n      };\n    });\n    return arcs;\n  }\n\n  /**\n   * Specifies the value function *x*, which returns a nonnegative numeric value\n   * for each datum. The default value function is `Number`. The value function\n   * is passed two arguments: the current datum and the current index.\n   */\n  pie.value = function(x) {\n    if (!arguments.length) return value;\n    value = x;\n    return pie;\n  };\n\n  /**\n   * Specifies a sort comparison operator *x*. The comparator is passed two data\n   * elements from the data array, a and b; it returns a negative value if a is\n   * less than b, a positive value if a is greater than b, and zero if a equals\n   * b.\n   */\n  pie.sort = function(x) {\n    if (!arguments.length) return sort;\n    sort = x;\n    return pie;\n  };\n\n  /**\n   * Specifies the overall start angle of the pie chart. Defaults to 0. The\n   * start angle can be specified either as a constant or as a function; in the\n   * case of a function, it is evaluated once per array (as opposed to per\n   * element).\n   */\n  pie.startAngle = function(x) {\n    if (!arguments.length) return startAngle;\n    startAngle = x;\n    return pie;\n  };\n\n  /**\n   * Specifies the overall end angle of the pie chart. Defaults to 2Ï€. The\n   * end angle can be specified either as a constant or as a function; in the\n   * case of a function, it is evaluated once per array (as opposed to per\n   * element).\n   */\n  pie.endAngle = function(x) {\n    if (!arguments.length) return endAngle;\n    endAngle = x;\n    return pie;\n  };\n\n  return pie;\n};\n\nvar d3_layout_pieSortByValue = {};\n// data is two-dimensional array of x,y; we populate y0\nd3.layout.stack = function() {\n  var values = d3_identity,\n      order = d3_layout_stackOrderDefault,\n      offset = d3_layout_stackOffsetZero,\n      out = d3_layout_stackOut,\n      x = d3_layout_stackX,\n      y = d3_layout_stackY;\n\n  function stack(data, index) {\n\n    // Convert series to canonical two-dimensional representation.\n    var series = data.map(function(d, i) {\n      return values.call(stack, d, i);\n    });\n\n    // Convert each series to canonical [[x,y]] representation.\n    var points = series.map(function(d, i) {\n      return d.map(function(v, i) {\n        return [x.call(stack, v, i), y.call(stack, v, i)];\n      });\n    });\n\n    // Compute the order of series, and permute them.\n    var orders = order.call(stack, points, index);\n    series = d3.permute(series, orders);\n    points = d3.permute(points, orders);\n\n    // Compute the baselineâ€¦\n    var offsets = offset.call(stack, points, index);\n\n    // And propagate it to other series.\n    var n = series.length,\n        m = series[0].length,\n        i,\n        j,\n        o;\n    for (j = 0; j < m; ++j) {\n      out.call(stack, series[0][j], o = offsets[j], points[0][j][1]);\n      for (i = 1; i < n; ++i) {\n        out.call(stack, series[i][j], o += points[i - 1][j][1], points[i][j][1]);\n      }\n    }\n\n    return data;\n  }\n\n  stack.values = function(x) {\n    if (!arguments.length) return values;\n    values = x;\n    return stack;\n  };\n\n  stack.order = function(x) {\n    if (!arguments.length) return order;\n    order = typeof x === \"function\" ? x : d3_layout_stackOrders.get(x) || d3_layout_stackOrderDefault;\n    return stack;\n  };\n\n  stack.offset = function(x) {\n    if (!arguments.length) return offset;\n    offset = typeof x === \"function\" ? x : d3_layout_stackOffsets.get(x) || d3_layout_stackOffsetZero;\n    return stack;\n  };\n\n  stack.x = function(z) {\n    if (!arguments.length) return x;\n    x = z;\n    return stack;\n  };\n\n  stack.y = function(z) {\n    if (!arguments.length) return y;\n    y = z;\n    return stack;\n  };\n\n  stack.out = function(z) {\n    if (!arguments.length) return out;\n    out = z;\n    return stack;\n  };\n\n  return stack;\n}\n\nfunction d3_layout_stackX(d) {\n  return d.x;\n}\n\nfunction d3_layout_stackY(d) {\n  return d.y;\n}\n\nfunction d3_layout_stackOut(d, y0, y) {\n  d.y0 = y0;\n  d.y = y;\n}\n\nvar d3_layout_stackOrders = d3.map({\n\n  \"inside-out\": function(data) {\n    var n = data.length,\n        i,\n        j,\n        max = data.map(d3_layout_stackMaxIndex),\n        sums = data.map(d3_layout_stackReduceSum),\n        index = d3.range(n).sort(function(a, b) { return max[a] - max[b]; }),\n        top = 0,\n        bottom = 0,\n        tops = [],\n        bottoms = [];\n    for (i = 0; i < n; ++i) {\n      j = index[i];\n      if (top < bottom) {\n        top += sums[j];\n        tops.push(j);\n      } else {\n        bottom += sums[j];\n        bottoms.push(j);\n      }\n    }\n    return bottoms.reverse().concat(tops);\n  },\n\n  \"reverse\": function(data) {\n    return d3.range(data.length).reverse();\n  },\n\n  \"default\": d3_layout_stackOrderDefault\n\n});\n\nvar d3_layout_stackOffsets = d3.map({\n\n  \"silhouette\": function(data) {\n    var n = data.length,\n        m = data[0].length,\n        sums = [],\n        max = 0,\n        i,\n        j,\n        o,\n        y0 = [];\n    for (j = 0; j < m; ++j) {\n      for (i = 0, o = 0; i < n; i++) o += data[i][j][1];\n      if (o > max) max = o;\n      sums.push(o);\n    }\n    for (j = 0; j < m; ++j) {\n      y0[j] = (max - sums[j]) / 2;\n    }\n    return y0;\n  },\n\n  \"wiggle\": function(data) {\n    var n = data.length,\n        x = data[0],\n        m = x.length,\n        max = 0,\n        i,\n        j,\n        k,\n        s1,\n        s2,\n        s3,\n        dx,\n        o,\n        o0,\n        y0 = [];\n    y0[0] = o = o0 = 0;\n    for (j = 1; j < m; ++j) {\n      for (i = 0, s1 = 0; i < n; ++i) s1 += data[i][j][1];\n      for (i = 0, s2 = 0, dx = x[j][0] - x[j - 1][0]; i < n; ++i) {\n        for (k = 0, s3 = (data[i][j][1] - data[i][j - 1][1]) / (2 * dx); k < i; ++k) {\n          s3 += (data[k][j][1] - data[k][j - 1][1]) / dx;\n        }\n        s2 += s3 * data[i][j][1];\n      }\n      y0[j] = o -= s1 ? s2 / s1 * dx : 0;\n      if (o < o0) o0 = o;\n    }\n    for (j = 0; j < m; ++j) y0[j] -= o0;\n    return y0;\n  },\n\n  \"expand\": function(data) {\n    var n = data.length,\n        m = data[0].length,\n        k = 1 / n,\n        i,\n        j,\n        o,\n        y0 = [];\n    for (j = 0; j < m; ++j) {\n      for (i = 0, o = 0; i < n; i++) o += data[i][j][1];\n      if (o) for (i = 0; i < n; i++) data[i][j][1] /= o;\n      else for (i = 0; i < n; i++) data[i][j][1] = k;\n    }\n    for (j = 0; j < m; ++j) y0[j] = 0;\n    return y0;\n  },\n\n  \"zero\": d3_layout_stackOffsetZero\n\n});\n\nfunction d3_layout_stackOrderDefault(data) {\n  return d3.range(data.length);\n}\n\nfunction d3_layout_stackOffsetZero(data) {\n  var j = -1,\n      m = data[0].length,\n      y0 = [];\n  while (++j < m) y0[j] = 0;\n  return y0;\n}\n\nfunction d3_layout_stackMaxIndex(array) {\n  var i = 1,\n      j = 0,\n      v = array[0][1],\n      k,\n      n = array.length;\n  for (; i < n; ++i) {\n    if ((k = array[i][1]) > v) {\n      j = i;\n      v = k;\n    }\n  }\n  return j;\n}\n\nfunction d3_layout_stackReduceSum(d) {\n  return d.reduce(d3_layout_stackSum, 0);\n}\n\nfunction d3_layout_stackSum(p, d) {\n  return p + d[1];\n}\nd3.layout.histogram = function() {\n  var frequency = true,\n      valuer = Number,\n      ranger = d3_layout_histogramRange,\n      binner = d3_layout_histogramBinSturges;\n\n  function histogram(data, i) {\n    var bins = [],\n        values = data.map(valuer, this),\n        range = ranger.call(this, values, i),\n        thresholds = binner.call(this, range, values, i),\n        bin,\n        i = -1,\n        n = values.length,\n        m = thresholds.length - 1,\n        k = frequency ? 1 : 1 / n,\n        x;\n\n    // Initialize the bins.\n    while (++i < m) {\n      bin = bins[i] = [];\n      bin.dx = thresholds[i + 1] - (bin.x = thresholds[i]);\n      bin.y = 0;\n    }\n\n    // Fill the bins, ignoring values outside the range.\n    if (m > 0) {\n      i = -1; while(++i < n) {\n        x = values[i];\n        if ((x >= range[0]) && (x <= range[1])) {\n          bin = bins[d3.bisect(thresholds, x, 1, m) - 1];\n          bin.y += k;\n          bin.push(data[i]);\n        }\n      }\n    }\n\n    return bins;\n  }\n\n  // Specifies how to extract a value from the associated data. The default\n  // value function is `Number`, which is equivalent to the identity function.\n  histogram.value = function(x) {\n    if (!arguments.length) return valuer;\n    valuer = x;\n    return histogram;\n  };\n\n  // Specifies the range of the histogram. Values outside the specified range\n  // will be ignored. The argument `x` may be specified either as a two-element\n  // array representing the minimum and maximum value of the range, or as a\n  // function that returns the range given the array of values and the current\n  // index `i`. The default range is the extent (minimum and maximum) of the\n  // values.\n  histogram.range = function(x) {\n    if (!arguments.length) return ranger;\n    ranger = d3_functor(x);\n    return histogram;\n  };\n\n  // Specifies how to bin values in the histogram. The argument `x` may be\n  // specified as a number, in which case the range of values will be split\n  // uniformly into the given number of bins. Or, `x` may be an array of\n  // threshold values, defining the bins; the specified array must contain the\n  // rightmost (upper) value, thus specifying n + 1 values for n bins. Or, `x`\n  // may be a function which is evaluated, being passed the range, the array of\n  // values, and the current index `i`, returning an array of thresholds. The\n  // default bin function will divide the values into uniform bins using\n  // Sturges' formula.\n  histogram.bins = function(x) {\n    if (!arguments.length) return binner;\n    binner = typeof x === \"number\"\n        ? function(range) { return d3_layout_histogramBinFixed(range, x); }\n        : d3_functor(x);\n    return histogram;\n  };\n\n  // Specifies whether the histogram's `y` value is a count (frequency) or a\n  // probability (density). The default value is true.\n  histogram.frequency = function(x) {\n    if (!arguments.length) return frequency;\n    frequency = !!x;\n    return histogram;\n  };\n\n  return histogram;\n};\n\nfunction d3_layout_histogramBinSturges(range, values) {\n  return d3_layout_histogramBinFixed(range, Math.ceil(Math.log(values.length) / Math.LN2 + 1));\n}\n\nfunction d3_layout_histogramBinFixed(range, n) {\n  var x = -1,\n      b = +range[0],\n      m = (range[1] - b) / n,\n      f = [];\n  while (++x <= n) f[x] = m * x + b;\n  return f;\n}\n\nfunction d3_layout_histogramRange(values) {\n  return [d3.min(values), d3.max(values)];\n}\nd3.layout.hierarchy = function() {\n  var sort = d3_layout_hierarchySort,\n      children = d3_layout_hierarchyChildren,\n      value = d3_layout_hierarchyValue;\n\n  // Recursively compute the node depth and value.\n  // Also converts the data representation into a standard hierarchy structure.\n  function recurse(data, depth, nodes) {\n    var childs = children.call(hierarchy, data, depth),\n        node = d3_layout_hierarchyInline ? data : {data: data};\n    node.depth = depth;\n    nodes.push(node);\n    if (childs && (n = childs.length)) {\n      var i = -1,\n          n,\n          c = node.children = [],\n          v = 0,\n          j = depth + 1,\n          d;\n      while (++i < n) {\n        d = recurse(childs[i], j, nodes);\n        d.parent = node;\n        c.push(d);\n        v += d.value;\n      }\n      if (sort) c.sort(sort);\n      if (value) node.value = v;\n    } else if (value) {\n      node.value = +value.call(hierarchy, data, depth) || 0;\n    }\n    return node;\n  }\n\n  // Recursively re-evaluates the node value.\n  function revalue(node, depth) {\n    var children = node.children,\n        v = 0;\n    if (children && (n = children.length)) {\n      var i = -1,\n          n,\n          j = depth + 1;\n      while (++i < n) v += revalue(children[i], j);\n    } else if (value) {\n      v = +value.call(hierarchy, d3_layout_hierarchyInline ? node : node.data, depth) || 0;\n    }\n    if (value) node.value = v;\n    return v;\n  }\n\n  function hierarchy(d) {\n    var nodes = [];\n    recurse(d, 0, nodes);\n    return nodes;\n  }\n\n  hierarchy.sort = function(x) {\n    if (!arguments.length) return sort;\n    sort = x;\n    return hierarchy;\n  };\n\n  hierarchy.children = function(x) {\n    if (!arguments.length) return children;\n    children = x;\n    return hierarchy;\n  };\n\n  hierarchy.value = function(x) {\n    if (!arguments.length) return value;\n    value = x;\n    return hierarchy;\n  };\n\n  // Re-evaluates the `value` property for the specified hierarchy.\n  hierarchy.revalue = function(root) {\n    revalue(root, 0);\n    return root;\n  };\n\n  return hierarchy;\n};\n\n// A method assignment helper for hierarchy subclasses.\nfunction d3_layout_hierarchyRebind(object, hierarchy) {\n  d3.rebind(object, hierarchy, \"sort\", \"children\", \"value\");\n\n  // Add an alias for links, for convenience.\n  object.links = d3_layout_hierarchyLinks;\n\n  // If the new API is used, enabling inlining.\n  object.nodes = function(d) {\n    d3_layout_hierarchyInline = true;\n    return (object.nodes = object)(d);\n  };\n\n  return object;\n}\n\nfunction d3_layout_hierarchyChildren(d) {\n  return d.children;\n}\n\nfunction d3_layout_hierarchyValue(d) {\n  return d.value;\n}\n\nfunction d3_layout_hierarchySort(a, b) {\n  return b.value - a.value;\n}\n\n// Returns an array source+target objects for the specified nodes.\nfunction d3_layout_hierarchyLinks(nodes) {\n  return d3.merge(nodes.map(function(parent) {\n    return (parent.children || []).map(function(child) {\n      return {source: parent, target: child};\n    });\n  }));\n}\n\n// For backwards-compatibility, don't enable inlining by default.\nvar d3_layout_hierarchyInline = false;\nd3.layout.pack = function() {\n  var hierarchy = d3.layout.hierarchy().sort(d3_layout_packSort),\n      size = [1, 1];\n\n  function pack(d, i) {\n    var nodes = hierarchy.call(this, d, i),\n        root = nodes[0];\n\n    // Recursively compute the layout.\n    root.x = 0;\n    root.y = 0;\n    d3_layout_packTree(root);\n\n    // Scale the layout to fit the requested size.\n    var w = size[0],\n        h = size[1],\n        k = 1 / Math.max(2 * root.r / w, 2 * root.r / h);\n    d3_layout_packTransform(root, w / 2, h / 2, k);\n\n    return nodes;\n  }\n\n  pack.size = function(x) {\n    if (!arguments.length) return size;\n    size = x;\n    return pack;\n  };\n\n  return d3_layout_hierarchyRebind(pack, hierarchy);\n};\n\nfunction d3_layout_packSort(a, b) {\n  return a.value - b.value;\n}\n\nfunction d3_layout_packInsert(a, b) {\n  var c = a._pack_next;\n  a._pack_next = b;\n  b._pack_prev = a;\n  b._pack_next = c;\n  c._pack_prev = b;\n}\n\nfunction d3_layout_packSplice(a, b) {\n  a._pack_next = b;\n  b._pack_prev = a;\n}\n\nfunction d3_layout_packIntersects(a, b) {\n  var dx = b.x - a.x,\n      dy = b.y - a.y,\n      dr = a.r + b.r;\n  return dr * dr - dx * dx - dy * dy > .001; // within epsilon\n}\n\nfunction d3_layout_packCircle(nodes) {\n  var xMin = Infinity,\n      xMax = -Infinity,\n      yMin = Infinity,\n      yMax = -Infinity,\n      n = nodes.length,\n      a, b, c, j, k;\n\n  function bound(node) {\n    xMin = Math.min(node.x - node.r, xMin);\n    xMax = Math.max(node.x + node.r, xMax);\n    yMin = Math.min(node.y - node.r, yMin);\n    yMax = Math.max(node.y + node.r, yMax);\n  }\n\n  // Create node links.\n  nodes.forEach(d3_layout_packLink);\n\n  // Create first node.\n  a = nodes[0];\n  a.x = -a.r;\n  a.y = 0;\n  bound(a);\n\n  // Create second node.\n  if (n > 1) {\n    b = nodes[1];\n    b.x = b.r;\n    b.y = 0;\n    bound(b);\n\n    // Create third node and build chain.\n    if (n > 2) {\n      c = nodes[2];\n      d3_layout_packPlace(a, b, c);\n      bound(c);\n      d3_layout_packInsert(a, c);\n      a._pack_prev = c;\n      d3_layout_packInsert(c, b);\n      b = a._pack_next;\n\n      // Now iterate through the rest.\n      for (var i = 3; i < n; i++) {\n        d3_layout_packPlace(a, b, c = nodes[i]);\n\n        // Search for the closest intersection.\n        var isect = 0, s1 = 1, s2 = 1;\n        for (j = b._pack_next; j !== b; j = j._pack_next, s1++) {\n          if (d3_layout_packIntersects(j, c)) {\n            isect = 1;\n            break;\n          }\n        }\n        if (isect == 1) {\n          for (k = a._pack_prev; k !== j._pack_prev; k = k._pack_prev, s2++) {\n            if (d3_layout_packIntersects(k, c)) {\n              break;\n            }\n          }\n        }\n\n        // Update node chain.\n        if (isect) {\n          if (s1 < s2 || (s1 == s2 && b.r < a.r)) d3_layout_packSplice(a, b = j);\n          else d3_layout_packSplice(a = k, b);\n          i--;\n        } else {\n          d3_layout_packInsert(a, c);\n          b = c;\n          bound(c);\n        }\n      }\n    }\n  }\n\n  // Re-center the circles and return the encompassing radius.\n  var cx = (xMin + xMax) / 2,\n      cy = (yMin + yMax) / 2,\n      cr = 0;\n  for (var i = 0; i < n; i++) {\n    var node = nodes[i];\n    node.x -= cx;\n    node.y -= cy;\n    cr = Math.max(cr, node.r + Math.sqrt(node.x * node.x + node.y * node.y));\n  }\n\n  // Remove node links.\n  nodes.forEach(d3_layout_packUnlink);\n\n  return cr;\n}\n\nfunction d3_layout_packLink(node) {\n  node._pack_next = node._pack_prev = node;\n}\n\nfunction d3_layout_packUnlink(node) {\n  delete node._pack_next;\n  delete node._pack_prev;\n}\n\nfunction d3_layout_packTree(node) {\n  var children = node.children;\n  if (children && children.length) {\n    children.forEach(d3_layout_packTree);\n    node.r = d3_layout_packCircle(children);\n  } else {\n    node.r = Math.sqrt(node.value);\n  }\n}\n\nfunction d3_layout_packTransform(node, x, y, k) {\n  var children = node.children;\n  node.x = (x += k * node.x);\n  node.y = (y += k * node.y);\n  node.r *= k;\n  if (children) {\n    var i = -1, n = children.length;\n    while (++i < n) d3_layout_packTransform(children[i], x, y, k);\n  }\n}\n\nfunction d3_layout_packPlace(a, b, c) {\n  var db = a.r + c.r,\n      dx = b.x - a.x,\n      dy = b.y - a.y;\n  if (db && (dx || dy)) {\n    var da = b.r + c.r,\n        dc = Math.sqrt(dx * dx + dy * dy),\n        cos = Math.max(-1, Math.min(1, (db * db + dc * dc - da * da) / (2 * db * dc))),\n        theta = Math.acos(cos),\n        x = cos * (db /= dc),\n        y = Math.sin(theta) * db;\n    c.x = a.x + x * dx + y * dy;\n    c.y = a.y + x * dy - y * dx;\n  } else {\n    c.x = a.x + db;\n    c.y = a.y;\n  }\n}\n// Implements a hierarchical layout using the cluster (or dendrogram)\n// algorithm.\nd3.layout.cluster = function() {\n  var hierarchy = d3.layout.hierarchy().sort(null).value(null),\n      separation = d3_layout_treeSeparation,\n      size = [1, 1]; // width, height\n\n  function cluster(d, i) {\n    var nodes = hierarchy.call(this, d, i),\n        root = nodes[0],\n        previousNode,\n        x = 0,\n        kx,\n        ky;\n\n    // First walk, computing the initial x & y values.\n    d3_layout_treeVisitAfter(root, function(node) {\n      var children = node.children;\n      if (children && children.length) {\n        node.x = d3_layout_clusterX(children);\n        node.y = d3_layout_clusterY(children);\n      } else {\n        node.x = previousNode ? x += separation(node, previousNode) : 0;\n        node.y = 0;\n        previousNode = node;\n      }\n    });\n\n    // Compute the left-most, right-most, and depth-most nodes for extents.\n    var left = d3_layout_clusterLeft(root),\n        right = d3_layout_clusterRight(root),\n        x0 = left.x - separation(left, right) / 2,\n        x1 = right.x + separation(right, left) / 2;\n\n    // Second walk, normalizing x & y to the desired size.\n    d3_layout_treeVisitAfter(root, function(node) {\n      node.x = (node.x - x0) / (x1 - x0) * size[0];\n      node.y = (1 - (root.y ? node.y / root.y : 1)) * size[1];\n    });\n\n    return nodes;\n  }\n\n  cluster.separation = function(x) {\n    if (!arguments.length) return separation;\n    separation = x;\n    return cluster;\n  };\n\n  cluster.size = function(x) {\n    if (!arguments.length) return size;\n    size = x;\n    return cluster;\n  };\n\n  return d3_layout_hierarchyRebind(cluster, hierarchy);\n};\n\nfunction d3_layout_clusterY(children) {\n  return 1 + d3.max(children, function(child) {\n    return child.y;\n  });\n}\n\nfunction d3_layout_clusterX(children) {\n  return children.reduce(function(x, child) {\n    return x + child.x;\n  }, 0) / children.length;\n}\n\nfunction d3_layout_clusterLeft(node) {\n  var children = node.children;\n  return children && children.length ? d3_layout_clusterLeft(children[0]) : node;\n}\n\nfunction d3_layout_clusterRight(node) {\n  var children = node.children, n;\n  return children && (n = children.length) ? d3_layout_clusterRight(children[n - 1]) : node;\n}\n// Node-link tree diagram using the Reingold-Tilford \"tidy\" algorithm\nd3.layout.tree = function() {\n  var hierarchy = d3.layout.hierarchy().sort(null).value(null),\n      separation = d3_layout_treeSeparation,\n      size = [1, 1]; // width, height\n\n  function tree(d, i) {\n    var nodes = hierarchy.call(this, d, i),\n        root = nodes[0];\n\n    function firstWalk(node, previousSibling) {\n      var children = node.children,\n          layout = node._tree;\n      if (children && (n = children.length)) {\n        var n,\n            firstChild = children[0],\n            previousChild,\n            ancestor = firstChild,\n            child,\n            i = -1;\n        while (++i < n) {\n          child = children[i];\n          firstWalk(child, previousChild);\n          ancestor = apportion(child, previousChild, ancestor);\n          previousChild = child;\n        }\n        d3_layout_treeShift(node);\n        var midpoint = .5 * (firstChild._tree.prelim + child._tree.prelim);\n        if (previousSibling) {\n          layout.prelim = previousSibling._tree.prelim + separation(node, previousSibling);\n          layout.mod = layout.prelim - midpoint;\n        } else {\n          layout.prelim = midpoint;\n        }\n      } else {\n        if (previousSibling) {\n          layout.prelim = previousSibling._tree.prelim + separation(node, previousSibling);\n        }\n      }\n    }\n\n    function secondWalk(node, x) {\n      node.x = node._tree.prelim + x;\n      var children = node.children;\n      if (children && (n = children.length)) {\n        var i = -1,\n            n;\n        x += node._tree.mod;\n        while (++i < n) {\n          secondWalk(children[i], x);\n        }\n      }\n    }\n\n    function apportion(node, previousSibling, ancestor) {\n      if (previousSibling) {\n        var vip = node,\n            vop = node,\n            vim = previousSibling,\n            vom = node.parent.children[0],\n            sip = vip._tree.mod,\n            sop = vop._tree.mod,\n            sim = vim._tree.mod,\n            som = vom._tree.mod,\n            shift;\n        while (vim = d3_layout_treeRight(vim), vip = d3_layout_treeLeft(vip), vim && vip) {\n          vom = d3_layout_treeLeft(vom);\n          vop = d3_layout_treeRight(vop);\n          vop._tree.ancestor = node;\n          shift = vim._tree.prelim + sim - vip._tree.prelim - sip + separation(vim, vip);\n          if (shift > 0) {\n            d3_layout_treeMove(d3_layout_treeAncestor(vim, node, ancestor), node, shift);\n            sip += shift;\n            sop += shift;\n          }\n          sim += vim._tree.mod;\n          sip += vip._tree.mod;\n          som += vom._tree.mod;\n          sop += vop._tree.mod;\n        }\n        if (vim && !d3_layout_treeRight(vop)) {\n          vop._tree.thread = vim;\n          vop._tree.mod += sim - sop;\n        }\n        if (vip && !d3_layout_treeLeft(vom)) {\n          vom._tree.thread = vip;\n          vom._tree.mod += sip - som;\n          ancestor = node;\n        }\n      }\n      return ancestor;\n    }\n\n    // Initialize temporary layout variables.\n    d3_layout_treeVisitAfter(root, function(node, previousSibling) {\n      node._tree = {\n        ancestor: node,\n        prelim: 0,\n        mod: 0,\n        change: 0,\n        shift: 0,\n        number: previousSibling ? previousSibling._tree.number + 1 : 0\n      };\n    });\n\n    // Compute the layout using Buchheim et al.'s algorithm.\n    firstWalk(root);\n    secondWalk(root, -root._tree.prelim);\n\n    // Compute the left-most, right-most, and depth-most nodes for extents.\n    var left = d3_layout_treeSearch(root, d3_layout_treeLeftmost),\n        right = d3_layout_treeSearch(root, d3_layout_treeRightmost),\n        deep = d3_layout_treeSearch(root, d3_layout_treeDeepest),\n        x0 = left.x - separation(left, right) / 2,\n        x1 = right.x + separation(right, left) / 2,\n        y1 = deep.depth || 1;\n\n    // Clear temporary layout variables; transform x and y.\n    d3_layout_treeVisitAfter(root, function(node) {\n      node.x = (node.x - x0) / (x1 - x0) * size[0];\n      node.y = node.depth / y1 * size[1];\n      delete node._tree;\n    });\n\n    return nodes;\n  }\n\n  tree.separation = function(x) {\n    if (!arguments.length) return separation;\n    separation = x;\n    return tree;\n  };\n\n  tree.size = function(x) {\n    if (!arguments.length) return size;\n    size = x;\n    return tree;\n  };\n\n  return d3_layout_hierarchyRebind(tree, hierarchy);\n};\n\nfunction d3_layout_treeSeparation(a, b) {\n  return a.parent == b.parent ? 1 : 2;\n}\n\n// function d3_layout_treeSeparationRadial(a, b) {\n//   return (a.parent == b.parent ? 1 : 2) / a.depth;\n// }\n\nfunction d3_layout_treeLeft(node) {\n  var children = node.children;\n  return children && children.length ? children[0] : node._tree.thread;\n}\n\nfunction d3_layout_treeRight(node) {\n  var children = node.children,\n      n;\n  return children && (n = children.length) ? children[n - 1] : node._tree.thread;\n}\n\nfunction d3_layout_treeSearch(node, compare) {\n  var children = node.children;\n  if (children && (n = children.length)) {\n    var child,\n        n,\n        i = -1;\n    while (++i < n) {\n      if (compare(child = d3_layout_treeSearch(children[i], compare), node) > 0) {\n        node = child;\n      }\n    }\n  }\n  return node;\n}\n\nfunction d3_layout_treeRightmost(a, b) {\n  return a.x - b.x;\n}\n\nfunction d3_layout_treeLeftmost(a, b) {\n  return b.x - a.x;\n}\n\nfunction d3_layout_treeDeepest(a, b) {\n  return a.depth - b.depth;\n}\n\nfunction d3_layout_treeVisitAfter(node, callback) {\n  function visit(node, previousSibling) {\n    var children = node.children;\n    if (children && (n = children.length)) {\n      var child,\n          previousChild = null,\n          i = -1,\n          n;\n      while (++i < n) {\n        child = children[i];\n        visit(child, previousChild);\n        previousChild = child;\n      }\n    }\n    callback(node, previousSibling);\n  }\n  visit(node, null);\n}\n\nfunction d3_layout_treeShift(node) {\n  var shift = 0,\n      change = 0,\n      children = node.children,\n      i = children.length,\n      child;\n  while (--i >= 0) {\n    child = children[i]._tree;\n    child.prelim += shift;\n    child.mod += shift;\n    shift += child.shift + (change += child.change);\n  }\n}\n\nfunction d3_layout_treeMove(ancestor, node, shift) {\n  ancestor = ancestor._tree;\n  node = node._tree;\n  var change = shift / (node.number - ancestor.number);\n  ancestor.change += change;\n  node.change -= change;\n  node.shift += shift;\n  node.prelim += shift;\n  node.mod += shift;\n}\n\nfunction d3_layout_treeAncestor(vim, node, ancestor) {\n  return vim._tree.ancestor.parent == node.parent\n      ? vim._tree.ancestor\n      : ancestor;\n}\n// Squarified Treemaps by Mark Bruls, Kees Huizing, and Jarke J. van Wijk\n// Modified to support a target aspect ratio by Jeff Heer\nd3.layout.treemap = function() {\n  var hierarchy = d3.layout.hierarchy(),\n      round = Math.round,\n      size = [1, 1], // width, height\n      padding = null,\n      pad = d3_layout_treemapPadNull,\n      sticky = false,\n      stickies,\n      ratio = 0.5 * (1 + Math.sqrt(5)); // golden ratio\n\n  // Compute the area for each child based on value & scale.\n  function scale(children, k) {\n    var i = -1,\n        n = children.length,\n        child,\n        area;\n    while (++i < n) {\n      area = (child = children[i]).value * (k < 0 ? 0 : k);\n      child.area = isNaN(area) || area <= 0 ? 0 : area;\n    }\n  }\n\n  // Recursively arranges the specified node's children into squarified rows.\n  function squarify(node) {\n    var children = node.children;\n    if (children && children.length) {\n      var rect = pad(node),\n          row = [],\n          remaining = children.slice(), // copy-on-write\n          child,\n          best = Infinity, // the best row score so far\n          score, // the current row score\n          u = Math.min(rect.dx, rect.dy), // initial orientation\n          n;\n      scale(remaining, rect.dx * rect.dy / node.value);\n      row.area = 0;\n      while ((n = remaining.length) > 0) {\n        row.push(child = remaining[n - 1]);\n        row.area += child.area;\n        if ((score = worst(row, u)) <= best) { // continue with this orientation\n          remaining.pop();\n          best = score;\n        } else { // abort, and try a different orientation\n          row.area -= row.pop().area;\n          position(row, u, rect, false);\n          u = Math.min(rect.dx, rect.dy);\n          row.length = row.area = 0;\n          best = Infinity;\n        }\n      }\n      if (row.length) {\n        position(row, u, rect, true);\n        row.length = row.area = 0;\n      }\n      children.forEach(squarify);\n    }\n  }\n\n  // Recursively resizes the specified node's children into existing rows.\n  // Preserves the existing layout!\n  function stickify(node) {\n    var children = node.children;\n    if (children && children.length) {\n      var rect = pad(node),\n          remaining = children.slice(), // copy-on-write\n          child,\n          row = [];\n      scale(remaining, rect.dx * rect.dy / node.value);\n      row.area = 0;\n      while (child = remaining.pop()) {\n        row.push(child);\n        row.area += child.area;\n        if (child.z != null) {\n          position(row, child.z ? rect.dx : rect.dy, rect, !remaining.length);\n          row.length = row.area = 0;\n        }\n      }\n      children.forEach(stickify);\n    }\n  }\n\n  // Computes the score for the specified row, as the worst aspect ratio.\n  function worst(row, u) {\n    var s = row.area,\n        r,\n        rmax = 0,\n        rmin = Infinity,\n        i = -1,\n        n = row.length;\n    while (++i < n) {\n      if (!(r = row[i].area)) continue;\n      if (r < rmin) rmin = r;\n      if (r > rmax) rmax = r;\n    }\n    s *= s;\n    u *= u;\n    return s\n        ? Math.max((u * rmax * ratio) / s, s / (u * rmin * ratio))\n        : Infinity;\n  }\n\n  // Positions the specified row of nodes. Modifies `rect`.\n  function position(row, u, rect, flush) {\n    var i = -1,\n        n = row.length,\n        x = rect.x,\n        y = rect.y,\n        v = u ? round(row.area / u) : 0,\n        o;\n    if (u == rect.dx) { // horizontal subdivision\n      if (flush || v > rect.dy) v = rect.dy; // over+underflow\n      while (++i < n) {\n        o = row[i];\n        o.x = x;\n        o.y = y;\n        o.dy = v;\n        x += o.dx = Math.min(rect.x + rect.dx - x, v ? round(o.area / v) : 0);\n      }\n      o.z = true;\n      o.dx += rect.x + rect.dx - x; // rounding error\n      rect.y += v;\n      rect.dy -= v;\n    } else { // vertical subdivision\n      if (flush || v > rect.dx) v = rect.dx; // over+underflow\n      while (++i < n) {\n        o = row[i];\n        o.x = x;\n        o.y = y;\n        o.dx = v;\n        y += o.dy = Math.min(rect.y + rect.dy - y, v ? round(o.area / v) : 0);\n      }\n      o.z = false;\n      o.dy += rect.y + rect.dy - y; // rounding error\n      rect.x += v;\n      rect.dx -= v;\n    }\n  }\n\n  function treemap(d) {\n    var nodes = stickies || hierarchy(d),\n        root = nodes[0];\n    root.x = 0;\n    root.y = 0;\n    root.dx = size[0];\n    root.dy = size[1];\n    if (stickies) hierarchy.revalue(root);\n    scale([root], root.dx * root.dy / root.value);\n    (stickies ? stickify : squarify)(root);\n    if (sticky) stickies = nodes;\n    return nodes;\n  }\n\n  treemap.size = function(x) {\n    if (!arguments.length) return size;\n    size = x;\n    return treemap;\n  };\n\n  treemap.padding = function(x) {\n    if (!arguments.length) return padding;\n\n    function padFunction(node) {\n      var p = x.call(treemap, node, node.depth);\n      return p == null\n          ? d3_layout_treemapPadNull(node)\n          : d3_layout_treemapPad(node, typeof p === \"number\" ? [p, p, p, p] : p);\n    }\n\n    function padConstant(node) {\n      return d3_layout_treemapPad(node, x);\n    }\n\n    var type;\n    pad = (padding = x) == null ? d3_layout_treemapPadNull\n        : (type = typeof x) === \"function\" ? padFunction\n        : type === \"number\" ? (x = [x, x, x, x], padConstant)\n        : padConstant;\n    return treemap;\n  };\n\n  treemap.round = function(x) {\n    if (!arguments.length) return round != Number;\n    round = x ? Math.round : Number;\n    return treemap;\n  };\n\n  treemap.sticky = function(x) {\n    if (!arguments.length) return sticky;\n    sticky = x;\n    stickies = null;\n    return treemap;\n  };\n\n  treemap.ratio = function(x) {\n    if (!arguments.length) return ratio;\n    ratio = x;\n    return treemap;\n  };\n\n  return d3_layout_hierarchyRebind(treemap, hierarchy);\n};\n\nfunction d3_layout_treemapPadNull(node) {\n  return {x: node.x, y: node.y, dx: node.dx, dy: node.dy};\n}\n\nfunction d3_layout_treemapPad(node, padding) {\n  var x = node.x + padding[3],\n      y = node.y + padding[0],\n      dx = node.dx - padding[1] - padding[3],\n      dy = node.dy - padding[0] - padding[2];\n  if (dx < 0) { x += dx / 2; dx = 0; }\n  if (dy < 0) { y += dy / 2; dy = 0; }\n  return {x: x, y: y, dx: dx, dy: dy};\n}\nd3.csv = function(url, callback) {\n  d3.text(url, \"text/csv\", function(text) {\n    callback(text && d3.csv.parse(text));\n  });\n};\nd3.csv.parse = function(text) {\n  var header;\n  return d3.csv.parseRows(text, function(row, i) {\n    if (i) {\n      var o = {}, j = -1, m = header.length;\n      while (++j < m) o[header[j]] = row[j];\n      return o;\n    } else {\n      header = row;\n      return null;\n    }\n  });\n};\n\nd3.csv.parseRows = function(text, f) {\n  var EOL = {}, // sentinel value for end-of-line\n      EOF = {}, // sentinel value for end-of-file\n      rows = [], // output rows\n      re = /\\r\\n|[,\\r\\n]/g, // field separator regex\n      n = 0, // the current line number\n      t, // the current token\n      eol; // is the current token followed by EOL?\n\n  re.lastIndex = 0; // work-around bug in FF 3.6\n\n  /** @private Returns the next token. */\n  function token() {\n    if (re.lastIndex >= text.length) return EOF; // special case: end of file\n    if (eol) { eol = false; return EOL; } // special case: end of line\n\n    // special case: quotes\n    var j = re.lastIndex;\n    if (text.charCodeAt(j) === 34) {\n      var i = j;\n      while (i++ < text.length) {\n        if (text.charCodeAt(i) === 34) {\n          if (text.charCodeAt(i + 1) !== 34) break;\n          i++;\n        }\n      }\n      re.lastIndex = i + 2;\n      var c = text.charCodeAt(i + 1);\n      if (c === 13) {\n        eol = true;\n        if (text.charCodeAt(i + 2) === 10) re.lastIndex++;\n      } else if (c === 10) {\n        eol = true;\n      }\n      return text.substring(j + 1, i).replace(/\"\"/g, \"\\\"\");\n    }\n\n    // common case\n    var m = re.exec(text);\n    if (m) {\n      eol = m[0].charCodeAt(0) !== 44;\n      return text.substring(j, m.index);\n    }\n    re.lastIndex = text.length;\n    return text.substring(j);\n  }\n\n  while ((t = token()) !== EOF) {\n    var a = [];\n    while ((t !== EOL) && (t !== EOF)) {\n      a.push(t);\n      t = token();\n    }\n    if (f && !(a = f(a, n++))) continue;\n    rows.push(a);\n  }\n\n  return rows;\n};\nd3.csv.format = function(rows) {\n  return rows.map(d3_csv_formatRow).join(\"\\n\");\n};\n\nfunction d3_csv_formatRow(row) {\n  return row.map(d3_csv_formatValue).join(\",\");\n}\n\nfunction d3_csv_formatValue(text) {\n  return /[\",\\n]/.test(text)\n      ? \"\\\"\" + text.replace(/\\\"/g, \"\\\"\\\"\") + \"\\\"\"\n      : text;\n}\nd3.geo = {};\n\nvar d3_geo_radians = Math.PI / 180;\n// TODO clip input coordinates on opposite hemisphere\nd3.geo.azimuthal = function() {\n  var mode = \"orthographic\", // or stereographic, gnomonic, equidistant or equalarea\n      origin,\n      scale = 200,\n      translate = [480, 250],\n      x0,\n      y0,\n      cy0,\n      sy0;\n\n  function azimuthal(coordinates) {\n    var x1 = coordinates[0] * d3_geo_radians - x0,\n        y1 = coordinates[1] * d3_geo_radians,\n        cx1 = Math.cos(x1),\n        sx1 = Math.sin(x1),\n        cy1 = Math.cos(y1),\n        sy1 = Math.sin(y1),\n        cc = mode !== \"orthographic\" ? sy0 * sy1 + cy0 * cy1 * cx1 : null,\n        c,\n        k = mode === \"stereographic\" ? 1 / (1 + cc)\n          : mode === \"gnomonic\" ? 1 / cc\n          : mode === \"equidistant\" ? (c = Math.acos(cc), c ? c / Math.sin(c) : 0)\n          : mode === \"equalarea\" ? Math.sqrt(2 / (1 + cc))\n          : 1,\n        x = k * cy1 * sx1,\n        y = k * (sy0 * cy1 * cx1 - cy0 * sy1);\n    return [\n      scale * x + translate[0],\n      scale * y + translate[1]\n    ];\n  }\n\n  azimuthal.invert = function(coordinates) {\n    var x = (coordinates[0] - translate[0]) / scale,\n        y = (coordinates[1] - translate[1]) / scale,\n        p = Math.sqrt(x * x + y * y),\n        c = mode === \"stereographic\" ? 2 * Math.atan(p)\n          : mode === \"gnomonic\" ? Math.atan(p)\n          : mode === \"equidistant\" ? p\n          : mode === \"equalarea\" ? 2 * Math.asin(.5 * p)\n          : Math.asin(p),\n        sc = Math.sin(c),\n        cc = Math.cos(c);\n    return [\n      (x0 + Math.atan2(x * sc, p * cy0 * cc + y * sy0 * sc)) / d3_geo_radians,\n      Math.asin(cc * sy0 - (p ? (y * sc * cy0) / p : 0)) / d3_geo_radians\n    ];\n  };\n\n  azimuthal.mode = function(x) {\n    if (!arguments.length) return mode;\n    mode = x + \"\";\n    return azimuthal;\n  };\n\n  azimuthal.origin = function(x) {\n    if (!arguments.length) return origin;\n    origin = x;\n    x0 = origin[0] * d3_geo_radians;\n    y0 = origin[1] * d3_geo_radians;\n    cy0 = Math.cos(y0);\n    sy0 = Math.sin(y0);\n    return azimuthal;\n  };\n\n  azimuthal.scale = function(x) {\n    if (!arguments.length) return scale;\n    scale = +x;\n    return azimuthal;\n  };\n\n  azimuthal.translate = function(x) {\n    if (!arguments.length) return translate;\n    translate = [+x[0], +x[1]];\n    return azimuthal;\n  };\n\n  return azimuthal.origin([0, 0]);\n};\n// Derived from Tom Carden's Albers implementation for Protovis.\n// http://gist.github.com/476238\n// http://mathworld.wolfram.com/AlbersEqual-AreaConicProjection.html\n\nd3.geo.albers = function() {\n  var origin = [-98, 38],\n      parallels = [29.5, 45.5],\n      scale = 1000,\n      translate = [480, 250],\n      lng0, // d3_geo_radians * origin[0]\n      n,\n      C,\n      p0;\n\n  function albers(coordinates) {\n    var t = n * (d3_geo_radians * coordinates[0] - lng0),\n        p = Math.sqrt(C - 2 * n * Math.sin(d3_geo_radians * coordinates[1])) / n;\n    return [\n      scale * p * Math.sin(t) + translate[0],\n      scale * (p * Math.cos(t) - p0) + translate[1]\n    ];\n  }\n\n  albers.invert = function(coordinates) {\n    var x = (coordinates[0] - translate[0]) / scale,\n        y = (coordinates[1] - translate[1]) / scale,\n        p0y = p0 + y,\n        t = Math.atan2(x, p0y),\n        p = Math.sqrt(x * x + p0y * p0y);\n    return [\n      (lng0 + t / n) / d3_geo_radians,\n      Math.asin((C - p * p * n * n) / (2 * n)) / d3_geo_radians\n    ];\n  };\n\n  function reload() {\n    var phi1 = d3_geo_radians * parallels[0],\n        phi2 = d3_geo_radians * parallels[1],\n        lat0 = d3_geo_radians * origin[1],\n        s = Math.sin(phi1),\n        c = Math.cos(phi1);\n    lng0 = d3_geo_radians * origin[0];\n    n = .5 * (s + Math.sin(phi2));\n    C = c * c + 2 * n * s;\n    p0 = Math.sqrt(C - 2 * n * Math.sin(lat0)) / n;\n    return albers;\n  }\n\n  albers.origin = function(x) {\n    if (!arguments.length) return origin;\n    origin = [+x[0], +x[1]];\n    return reload();\n  };\n\n  albers.parallels = function(x) {\n    if (!arguments.length) return parallels;\n    parallels = [+x[0], +x[1]];\n    return reload();\n  };\n\n  albers.scale = function(x) {\n    if (!arguments.length) return scale;\n    scale = +x;\n    return albers;\n  };\n\n  albers.translate = function(x) {\n    if (!arguments.length) return translate;\n    translate = [+x[0], +x[1]];\n    return albers;\n  };\n\n  return reload();\n};\n\n// A composite projection for the United States, 960x500. The set of standard\n// parallels for each region comes from USGS, which is published here:\n// http://egsc.usgs.gov/isb/pubs/MapProjections/projections.html#albers\n// TODO allow the composite projection to be rescaled?\nd3.geo.albersUsa = function() {\n  var lower48 = d3.geo.albers();\n\n  var alaska = d3.geo.albers()\n      .origin([-160, 60])\n      .parallels([55, 65]);\n\n  var hawaii = d3.geo.albers()\n      .origin([-160, 20])\n      .parallels([8, 18]);\n\n  var puertoRico = d3.geo.albers()\n      .origin([-60, 10])\n      .parallels([8, 18]);\n\n  function albersUsa(coordinates) {\n    var lon = coordinates[0],\n        lat = coordinates[1];\n    return (lat > 50 ? alaska\n        : lon < -140 ? hawaii\n        : lat < 21 ? puertoRico\n        : lower48)(coordinates);\n  }\n\n  albersUsa.scale = function(x) {\n    if (!arguments.length) return lower48.scale();\n    lower48.scale(x);\n    alaska.scale(x * .6);\n    hawaii.scale(x);\n    puertoRico.scale(x * 1.5);\n    return albersUsa.translate(lower48.translate());\n  };\n\n  albersUsa.translate = function(x) {\n    if (!arguments.length) return lower48.translate();\n    var dz = lower48.scale() / 1000,\n        dx = x[0],\n        dy = x[1];\n    lower48.translate(x);\n    alaska.translate([dx - 400 * dz, dy + 170 * dz]);\n    hawaii.translate([dx - 190 * dz, dy + 200 * dz]);\n    puertoRico.translate([dx + 580 * dz, dy + 430 * dz]);\n    return albersUsa;\n  };\n\n  return albersUsa.scale(lower48.scale());\n};\nd3.geo.bonne = function() {\n  var scale = 200,\n      translate = [480, 250],\n      x0, // origin longitude in radians\n      y0, // origin latitude in radians\n      y1, // parallel latitude in radians\n      c1; // cot(y1)\n\n  function bonne(coordinates) {\n    var x = coordinates[0] * d3_geo_radians - x0,\n        y = coordinates[1] * d3_geo_radians - y0;\n    if (y1) {\n      var p = c1 + y1 - y, E = x * Math.cos(y) / p;\n      x = p * Math.sin(E);\n      y = p * Math.cos(E) - c1;\n    } else {\n      x *= Math.cos(y);\n      y *= -1;\n    }\n    return [\n      scale * x + translate[0],\n      scale * y + translate[1]\n    ];\n  }\n\n  bonne.invert = function(coordinates) {\n    var x = (coordinates[0] - translate[0]) / scale,\n        y = (coordinates[1] - translate[1]) / scale;\n    if (y1) {\n      var c = c1 + y, p = Math.sqrt(x * x + c * c);\n      y = c1 + y1 - p;\n      x = x0 + p * Math.atan2(x, c) / Math.cos(y);\n    } else {\n      y *= -1;\n      x /= Math.cos(y);\n    }\n    return [\n      x / d3_geo_radians,\n      y / d3_geo_radians\n    ];\n  };\n\n  // 90Â° for Werner, 0Â° for Sinusoidal\n  bonne.parallel = function(x) {\n    if (!arguments.length) return y1 / d3_geo_radians;\n    c1 = 1 / Math.tan(y1 = x * d3_geo_radians);\n    return bonne;\n  };\n\n  bonne.origin = function(x) {\n    if (!arguments.length) return [x0 / d3_geo_radians, y0 / d3_geo_radians];\n    x0 = x[0] * d3_geo_radians;\n    y0 = x[1] * d3_geo_radians;\n    return bonne;\n  };\n\n  bonne.scale = function(x) {\n    if (!arguments.length) return scale;\n    scale = +x;\n    return bonne;\n  };\n\n  bonne.translate = function(x) {\n    if (!arguments.length) return translate;\n    translate = [+x[0], +x[1]];\n    return bonne;\n  };\n\n  return bonne.origin([0, 0]).parallel(45);\n};\nd3.geo.equirectangular = function() {\n  var scale = 500,\n      translate = [480, 250];\n\n  function equirectangular(coordinates) {\n    var x = coordinates[0] / 360,\n        y = -coordinates[1] / 360;\n    return [\n      scale * x + translate[0],\n      scale * y + translate[1]\n    ];\n  }\n\n  equirectangular.invert = function(coordinates) {\n    var x = (coordinates[0] - translate[0]) / scale,\n        y = (coordinates[1] - translate[1]) / scale;\n    return [\n      360 * x,\n      -360 * y\n    ];\n  };\n\n  equirectangular.scale = function(x) {\n    if (!arguments.length) return scale;\n    scale = +x;\n    return equirectangular;\n  };\n\n  equirectangular.translate = function(x) {\n    if (!arguments.length) return translate;\n    translate = [+x[0], +x[1]];\n    return equirectangular;\n  };\n\n  return equirectangular;\n};\nd3.geo.mercator = function() {\n  var scale = 500,\n      translate = [480, 250];\n\n  function mercator(coordinates) {\n    var x = coordinates[0] / 360,\n        y = -(Math.log(Math.tan(Math.PI / 4 + coordinates[1] * d3_geo_radians / 2)) / d3_geo_radians) / 360;\n    return [\n      scale * x + translate[0],\n      scale * Math.max(-.5, Math.min(.5, y)) + translate[1]\n    ];\n  }\n\n  mercator.invert = function(coordinates) {\n    var x = (coordinates[0] - translate[0]) / scale,\n        y = (coordinates[1] - translate[1]) / scale;\n    return [\n      360 * x,\n      2 * Math.atan(Math.exp(-360 * y * d3_geo_radians)) / d3_geo_radians - 90\n    ];\n  };\n\n  mercator.scale = function(x) {\n    if (!arguments.length) return scale;\n    scale = +x;\n    return mercator;\n  };\n\n  mercator.translate = function(x) {\n    if (!arguments.length) return translate;\n    translate = [+x[0], +x[1]];\n    return mercator;\n  };\n\n  return mercator;\n};\nfunction d3_geo_type(types, defaultValue) {\n  return function(object) {\n    return object && types.hasOwnProperty(object.type) ? types[object.type](object) : defaultValue;\n  };\n}\n/**\n * Returns a function that, given a GeoJSON object (e.g., a feature), returns\n * the corresponding SVG path. The function can be customized by overriding the\n * projection. Point features are mapped to circles with a default radius of\n * 4.5px; the radius can be specified either as a constant or a function that\n * is evaluated per object.\n */\nd3.geo.path = function() {\n  var pointRadius = 4.5,\n      pointCircle = d3_path_circle(pointRadius),\n      projection = d3.geo.albersUsa(),\n      buffer = [];\n\n  function path(d, i) {\n    if (typeof pointRadius === \"function\") pointCircle = d3_path_circle(pointRadius.apply(this, arguments));\n    pathType(d);\n    var result = buffer.length ? buffer.join(\"\") : null;\n    buffer = [];\n    return result;\n  }\n\n  function project(coordinates) {\n    return projection(coordinates).join(\",\");\n  }\n\n  var pathType = d3_geo_type({\n\n    FeatureCollection: function(o) {\n      var features = o.features,\n          i = -1, // features.index\n          n = features.length;\n      while (++i < n) buffer.push(pathType(features[i].geometry));\n    },\n\n    Feature: function(o) {\n      pathType(o.geometry);\n    },\n\n    Point: function(o) {\n      buffer.push(\"M\", project(o.coordinates), pointCircle);\n    },\n\n    MultiPoint: function(o) {\n      var coordinates = o.coordinates,\n          i = -1, // coordinates.index\n          n = coordinates.length;\n      while (++i < n) buffer.push(\"M\", project(coordinates[i]), pointCircle);\n    },\n\n    LineString: function(o) {\n      var coordinates = o.coordinates,\n          i = -1, // coordinates.index\n          n = coordinates.length;\n      buffer.push(\"M\");\n      while (++i < n) buffer.push(project(coordinates[i]), \"L\");\n      buffer.pop();\n    },\n\n    MultiLineString: function(o) {\n      var coordinates = o.coordinates,\n          i = -1, // coordinates.index\n          n = coordinates.length,\n          subcoordinates, // coordinates[i]\n          j, // subcoordinates.index\n          m; // subcoordinates.length\n      while (++i < n) {\n        subcoordinates = coordinates[i];\n        j = -1;\n        m = subcoordinates.length;\n        buffer.push(\"M\");\n        while (++j < m) buffer.push(project(subcoordinates[j]), \"L\");\n        buffer.pop();\n      }\n    },\n\n    Polygon: function(o) {\n      var coordinates = o.coordinates,\n          i = -1, // coordinates.index\n          n = coordinates.length,\n          subcoordinates, // coordinates[i]\n          j, // subcoordinates.index\n          m; // subcoordinates.length\n      while (++i < n) {\n        subcoordinates = coordinates[i];\n        j = -1;\n        if ((m = subcoordinates.length - 1) > 0) {\n          buffer.push(\"M\");\n          while (++j < m) buffer.push(project(subcoordinates[j]), \"L\");\n          buffer[buffer.length - 1] = \"Z\";\n        }\n      }\n    },\n\n    MultiPolygon: function(o) {\n      var coordinates = o.coordinates,\n          i = -1, // coordinates index\n          n = coordinates.length,\n          subcoordinates, // coordinates[i]\n          j, // subcoordinates index\n          m, // subcoordinates.length\n          subsubcoordinates, // subcoordinates[j]\n          k, // subsubcoordinates index\n          p; // subsubcoordinates.length\n      while (++i < n) {\n        subcoordinates = coordinates[i];\n        j = -1;\n        m = subcoordinates.length;\n        while (++j < m) {\n          subsubcoordinates = subcoordinates[j];\n          k = -1;\n          if ((p = subsubcoordinates.length - 1) > 0) {\n            buffer.push(\"M\");\n            while (++k < p) buffer.push(project(subsubcoordinates[k]), \"L\");\n            buffer[buffer.length - 1] = \"Z\";\n          }\n        }\n      }\n    },\n\n    GeometryCollection: function(o) {\n      var geometries = o.geometries,\n          i = -1, // geometries index\n          n = geometries.length;\n      while (++i < n) buffer.push(pathType(geometries[i]));\n    }\n\n  });\n\n  var areaType = path.area = d3_geo_type({\n\n    FeatureCollection: function(o) {\n      var area = 0,\n          features = o.features,\n          i = -1, // features.index\n          n = features.length;\n      while (++i < n) area += areaType(features[i]);\n      return area;\n    },\n\n    Feature: function(o) {\n      return areaType(o.geometry);\n    },\n\n    Polygon: function(o) {\n      return polygonArea(o.coordinates);\n    },\n\n    MultiPolygon: function(o) {\n      var sum = 0,\n          coordinates = o.coordinates,\n          i = -1, // coordinates index\n          n = coordinates.length;\n      while (++i < n) sum += polygonArea(coordinates[i]);\n      return sum;\n    },\n\n    GeometryCollection: function(o) {\n      var sum = 0,\n          geometries = o.geometries,\n          i = -1, // geometries index\n          n = geometries.length;\n      while (++i < n) sum += areaType(geometries[i]);\n      return sum;\n    }\n\n  }, 0);\n\n  function polygonArea(coordinates) {\n    var sum = area(coordinates[0]), // exterior ring\n        i = 0, // coordinates.index\n        n = coordinates.length;\n    while (++i < n) sum -= area(coordinates[i]); // holes\n    return sum;\n  }\n\n  function polygonCentroid(coordinates) {\n    var polygon = d3.geom.polygon(coordinates[0].map(projection)), // exterior ring\n        area = polygon.area(),\n        centroid = polygon.centroid(area < 0 ? (area *= -1, 1) : -1),\n        x = centroid[0],\n        y = centroid[1],\n        z = area,\n        i = 0, // coordinates index\n        n = coordinates.length;\n    while (++i < n) {\n      polygon = d3.geom.polygon(coordinates[i].map(projection)); // holes\n      area = polygon.area();\n      centroid = polygon.centroid(area < 0 ? (area *= -1, 1) : -1);\n      x -= centroid[0];\n      y -= centroid[1];\n      z -= area;\n    }\n    return [x, y, 6 * z]; // weighted centroid\n  }\n\n  var centroidType = path.centroid = d3_geo_type({\n\n    // TODO FeatureCollection\n    // TODO Point\n    // TODO MultiPoint\n    // TODO LineString\n    // TODO MultiLineString\n    // TODO GeometryCollection\n\n    Feature: function(o) {\n      return centroidType(o.geometry);\n    },\n\n    Polygon: function(o) {\n      var centroid = polygonCentroid(o.coordinates);\n      return [centroid[0] / centroid[2], centroid[1] / centroid[2]];\n    },\n\n    MultiPolygon: function(o) {\n      var area = 0,\n          coordinates = o.coordinates,\n          centroid,\n          x = 0,\n          y = 0,\n          z = 0,\n          i = -1, // coordinates index\n          n = coordinates.length;\n      while (++i < n) {\n        centroid = polygonCentroid(coordinates[i]);\n        x += centroid[0];\n        y += centroid[1];\n        z += centroid[2];\n      }\n      return [x / z, y / z];\n    }\n\n  });\n\n  function area(coordinates) {\n    return Math.abs(d3.geom.polygon(coordinates.map(projection)).area());\n  }\n\n  path.projection = function(x) {\n    projection = x;\n    return path;\n  };\n\n  path.pointRadius = function(x) {\n    if (typeof x === \"function\") pointRadius = x;\n    else {\n      pointRadius = +x;\n      pointCircle = d3_path_circle(pointRadius);\n    }\n    return path;\n  };\n\n  return path;\n};\n\nfunction d3_path_circle(radius) {\n  return \"m0,\" + radius\n      + \"a\" + radius + \",\" + radius + \" 0 1,1 0,\" + (-2 * radius)\n      + \"a\" + radius + \",\" + radius + \" 0 1,1 0,\" + (+2 * radius)\n      + \"z\";\n}\n/**\n * Given a GeoJSON object, returns the corresponding bounding box. The bounding\n * box is represented by a two-dimensional array: [[left, bottom], [right,\n * top]], where left is the minimum longitude, bottom is the minimum latitude,\n * right is maximum longitude, and top is the maximum latitude.\n */\nd3.geo.bounds = function(feature) {\n  var left = Infinity,\n      bottom = Infinity,\n      right = -Infinity,\n      top = -Infinity;\n  d3_geo_bounds(feature, function(x, y) {\n    if (x < left) left = x;\n    if (x > right) right = x;\n    if (y < bottom) bottom = y;\n    if (y > top) top = y;\n  });\n  return [[left, bottom], [right, top]];\n};\n\nfunction d3_geo_bounds(o, f) {\n  if (d3_geo_boundsTypes.hasOwnProperty(o.type)) d3_geo_boundsTypes[o.type](o, f);\n}\n\nvar d3_geo_boundsTypes = {\n  Feature: d3_geo_boundsFeature,\n  FeatureCollection: d3_geo_boundsFeatureCollection,\n  GeometryCollection: d3_geo_boundsGeometryCollection,\n  LineString: d3_geo_boundsLineString,\n  MultiLineString: d3_geo_boundsMultiLineString,\n  MultiPoint: d3_geo_boundsLineString,\n  MultiPolygon: d3_geo_boundsMultiPolygon,\n  Point: d3_geo_boundsPoint,\n  Polygon: d3_geo_boundsPolygon\n};\n\nfunction d3_geo_boundsFeature(o, f) {\n  d3_geo_bounds(o.geometry, f);\n}\n\nfunction d3_geo_boundsFeatureCollection(o, f) {\n  for (var a = o.features, i = 0, n = a.length; i < n; i++) {\n    d3_geo_bounds(a[i].geometry, f);\n  }\n}\n\nfunction d3_geo_boundsGeometryCollection(o, f) {\n  for (var a = o.geometries, i = 0, n = a.length; i < n; i++) {\n    d3_geo_bounds(a[i], f);\n  }\n}\n\nfunction d3_geo_boundsLineString(o, f) {\n  for (var a = o.coordinates, i = 0, n = a.length; i < n; i++) {\n    f.apply(null, a[i]);\n  }\n}\n\nfunction d3_geo_boundsMultiLineString(o, f) {\n  for (var a = o.coordinates, i = 0, n = a.length; i < n; i++) {\n    for (var b = a[i], j = 0, m = b.length; j < m; j++) {\n      f.apply(null, b[j]);\n    }\n  }\n}\n\nfunction d3_geo_boundsMultiPolygon(o, f) {\n  for (var a = o.coordinates, i = 0, n = a.length; i < n; i++) {\n    for (var b = a[i][0], j = 0, m = b.length; j < m; j++) {\n      f.apply(null, b[j]);\n    }\n  }\n}\n\nfunction d3_geo_boundsPoint(o, f) {\n  f.apply(null, o.coordinates);\n}\n\nfunction d3_geo_boundsPolygon(o, f) {\n  for (var a = o.coordinates[0], i = 0, n = a.length; i < n; i++) {\n    f.apply(null, a[i]);\n  }\n}\n// TODO breakAtDateLine?\n\nd3.geo.circle = function() {\n  var origin = [0, 0],\n      degrees = 90 - 1e-2,\n      radians = degrees * d3_geo_radians,\n      arc = d3.geo.greatArc().source(origin).target(d3_identity);\n\n  function circle() {\n    // TODO render a circle as a Polygon\n  }\n\n  function visible(point) {\n    return arc.distance(point) < radians;\n  }\n\n  circle.clip = function(d) {\n    if (typeof origin === \"function\") arc.source(origin.apply(this, arguments));\n    return clipType(d) || null;\n  };\n\n  var clipType = d3_geo_type({\n\n    FeatureCollection: function(o) {\n      var features = o.features.map(clipType).filter(d3_identity);\n      return features && (o = Object.create(o), o.features = features, o);\n    },\n\n    Feature: function(o) {\n      var geometry = clipType(o.geometry);\n      return geometry && (o = Object.create(o), o.geometry = geometry, o);\n    },\n\n    Point: function(o) {\n      return visible(o.coordinates) && o;\n    },\n\n    MultiPoint: function(o) {\n      var coordinates = o.coordinates.filter(visible);\n      return coordinates.length && {\n        type: o.type,\n        coordinates: coordinates\n      };\n    },\n\n    LineString: function(o) {\n      var coordinates = clip(o.coordinates);\n      return coordinates.length && (o = Object.create(o), o.coordinates = coordinates, o);\n    },\n\n    MultiLineString: function(o) {\n      var coordinates = o.coordinates.map(clip).filter(function(d) { return d.length; });\n      return coordinates.length && (o = Object.create(o), o.coordinates = coordinates, o);\n    },\n\n    Polygon: function(o) {\n      var coordinates = o.coordinates.map(clip);\n      return coordinates[0].length && (o = Object.create(o), o.coordinates = coordinates, o);\n    },\n\n    MultiPolygon: function(o) {\n      var coordinates = o.coordinates.map(function(d) { return d.map(clip); }).filter(function(d) { return d[0].length; });\n      return coordinates.length && (o = Object.create(o), o.coordinates = coordinates, o);\n    },\n\n    GeometryCollection: function(o) {\n      var geometries = o.geometries.map(clipType).filter(d3_identity);\n      return geometries.length && (o = Object.create(o), o.geometries = geometries, o);\n    }\n\n  });\n\n  function clip(coordinates) {\n    var i = -1,\n        n = coordinates.length,\n        clipped = [],\n        p0,\n        p1,\n        p2,\n        d0,\n        d1;\n\n    while (++i < n) {\n      d1 = arc.distance(p2 = coordinates[i]);\n      if (d1 < radians) {\n        if (p1) clipped.push(d3_geo_greatArcInterpolate(p1, p2)((d0 - radians) / (d0 - d1)));\n        clipped.push(p2);\n        p0 = p1 = null;\n      } else {\n        p1 = p2;\n        if (!p0 && clipped.length) {\n          clipped.push(d3_geo_greatArcInterpolate(clipped[clipped.length - 1], p1)((radians - d0) / (d1 - d0)));\n          p0 = p1;\n        }\n      }\n      d0 = d1;\n    }\n\n    // Close the clipped polygon if necessary.\n    p0 = coordinates[0];\n    p1 = clipped[0];\n    if (p1 && p2[0] === p0[0] && p2[1] === p0[1] && !(p2[0] === p1[0] && p2[1] === p1[1])) {\n      clipped.push(p1);\n    }\n\n    return resample(clipped);\n  }\n\n  // Resample coordinates, creating great arcs between each.\n  function resample(coordinates) {\n    var i = 0,\n        n = coordinates.length,\n        j,\n        m,\n        resampled = n ? [coordinates[0]] : coordinates,\n        resamples,\n        origin = arc.source();\n\n    while (++i < n) {\n      resamples = arc.source(coordinates[i - 1])(coordinates[i]).coordinates;\n      for (j = 0, m = resamples.length; ++j < m;) resampled.push(resamples[j]);\n    }\n\n    arc.source(origin);\n    return resampled;\n  }\n\n  circle.origin = function(x) {\n    if (!arguments.length) return origin;\n    origin = x;\n    if (typeof origin !== \"function\") arc.source(origin);\n    return circle;\n  };\n\n  circle.angle = function(x) {\n    if (!arguments.length) return degrees;\n    radians = (degrees = +x) * d3_geo_radians;\n    return circle;\n  };\n\n  return d3.rebind(circle, arc, \"precision\");\n}\nd3.geo.greatArc = function() {\n  var source = d3_geo_greatArcSource, p0,\n      target = d3_geo_greatArcTarget, p1,\n      precision = 6 * d3_geo_radians,\n      interpolate = d3_geo_greatArcInterpolator();\n\n  function greatArc() {\n    var d = greatArc.distance.apply(this, arguments), // initializes the interpolator, too\n        t = 0,\n        dt = precision / d,\n        coordinates = [p0];\n    while ((t += dt) < 1) coordinates.push(interpolate(t));\n    coordinates.push(p1);\n    return {type: \"LineString\", coordinates: coordinates};\n  }\n\n  // Length returned in radians; multiply by radius for distance.\n  greatArc.distance = function() {\n    if (typeof source === \"function\") interpolate.source(p0 = source.apply(this, arguments));\n    if (typeof target === \"function\") interpolate.target(p1 = target.apply(this, arguments));\n    return interpolate.distance();\n  };\n\n  greatArc.source = function(_) {\n    if (!arguments.length) return source;\n    source = _;\n    if (typeof source !== \"function\") interpolate.source(p0 = source);\n    return greatArc;\n  };\n\n  greatArc.target = function(_) {\n    if (!arguments.length) return target;\n    target = _;\n    if (typeof target !== \"function\") interpolate.target(p1 = target);\n    return greatArc;\n  };\n\n  // Precision is specified in degrees.\n  greatArc.precision = function(_) {\n    if (!arguments.length) return precision / d3_geo_radians;\n    precision = _ * d3_geo_radians;\n    return greatArc;\n  };\n\n  return greatArc;\n};\n\nfunction d3_geo_greatArcSource(d) {\n  return d.source;\n}\n\nfunction d3_geo_greatArcTarget(d) {\n  return d.target;\n}\n\nfunction d3_geo_greatArcInterpolator() {\n  var x0, y0, cy0, sy0, kx0, ky0,\n      x1, y1, cy1, sy1, kx1, ky1,\n      d,\n      k;\n\n  function interpolate(t) {\n    var B = Math.sin(t *= d) * k,\n        A = Math.sin(d - t) * k,\n        x = A * kx0 + B * kx1,\n        y = A * ky0 + B * ky1,\n        z = A * sy0 + B * sy1;\n    return [\n      Math.atan2(y, x) / d3_geo_radians,\n      Math.atan2(z, Math.sqrt(x * x + y * y)) / d3_geo_radians\n    ];\n  }\n\n  interpolate.distance = function() {\n    if (d == null) k = 1 / Math.sin(d = Math.acos(Math.max(-1, Math.min(1, sy0 * sy1 + cy0 * cy1 * Math.cos(x1 - x0)))));\n    return d;\n  };\n\n  interpolate.source = function(_) {\n    var cx0 = Math.cos(x0 = _[0] * d3_geo_radians),\n        sx0 = Math.sin(x0);\n    cy0 = Math.cos(y0 = _[1] * d3_geo_radians);\n    sy0 = Math.sin(y0);\n    kx0 = cy0 * cx0;\n    ky0 = cy0 * sx0;\n    d = null;\n    return interpolate;\n  };\n\n  interpolate.target = function(_) {\n    var cx1 = Math.cos(x1 = _[0] * d3_geo_radians),\n        sx1 = Math.sin(x1);\n    cy1 = Math.cos(y1 = _[1] * d3_geo_radians);\n    sy1 = Math.sin(y1);\n    kx1 = cy1 * cx1;\n    ky1 = cy1 * sx1;\n    d = null;\n    return interpolate;\n  };\n\n  return interpolate;\n}\n\nfunction d3_geo_greatArcInterpolate(a, b) {\n  var i = d3_geo_greatArcInterpolator().source(a).target(b);\n  i.distance();\n  return i;\n}\nd3.geo.greatCircle = d3.geo.circle;\nd3.geom = {};\n/**\n * Computes a contour for a given input grid function using the <a\n * href=\"http://en.wikipedia.org/wiki/Marching_squares\">marching\n * squares</a> algorithm. Returns the contour polygon as an array of points.\n *\n * @param grid a two-input function(x, y) that returns true for values\n * inside the contour and false for values outside the contour.\n * @param start an optional starting point [x, y] on the grid.\n * @returns polygon [[x1, y1], [x2, y2], â€¦]\n */\nd3.geom.contour = function(grid, start) {\n  var s = start || d3_geom_contourStart(grid), // starting point\n      c = [],    // contour polygon\n      x = s[0],  // current x position\n      y = s[1],  // current y position\n      dx = 0,    // next x direction\n      dy = 0,    // next y direction\n      pdx = NaN, // previous x direction\n      pdy = NaN, // previous y direction\n      i = 0;\n\n  do {\n    // determine marching squares index\n    i = 0;\n    if (grid(x-1, y-1)) i += 1;\n    if (grid(x,   y-1)) i += 2;\n    if (grid(x-1, y  )) i += 4;\n    if (grid(x,   y  )) i += 8;\n\n    // determine next direction\n    if (i === 6) {\n      dx = pdy === -1 ? -1 : 1;\n      dy = 0;\n    } else if (i === 9) {\n      dx = 0;\n      dy = pdx === 1 ? -1 : 1;\n    } else {\n      dx = d3_geom_contourDx[i];\n      dy = d3_geom_contourDy[i];\n    }\n\n    // update contour polygon\n    if (dx != pdx && dy != pdy) {\n      c.push([x, y]);\n      pdx = dx;\n      pdy = dy;\n    }\n\n    x += dx;\n    y += dy;\n  } while (s[0] != x || s[1] != y);\n\n  return c;\n};\n\n// lookup tables for marching directions\nvar d3_geom_contourDx = [1, 0, 1, 1,-1, 0,-1, 1,0, 0,0,0,-1, 0,-1,NaN],\n    d3_geom_contourDy = [0,-1, 0, 0, 0,-1, 0, 0,1,-1,1,1, 0,-1, 0,NaN];\n\nfunction d3_geom_contourStart(grid) {\n  var x = 0,\n      y = 0;\n\n  // search for a starting point; begin at origin\n  // and proceed along outward-expanding diagonals\n  while (true) {\n    if (grid(x,y)) {\n      return [x,y];\n    }\n    if (x === 0) {\n      x = y + 1;\n      y = 0;\n    } else {\n      x = x - 1;\n      y = y + 1;\n    }\n  }\n}\n/**\n * Computes the 2D convex hull of a set of points using Graham's scanning\n * algorithm. The algorithm has been implemented as described in Cormen,\n * Leiserson, and Rivest's Introduction to Algorithms. The running time of\n * this algorithm is O(n log n), where n is the number of input points.\n *\n * @param vertices [[x1, y1], [x2, y2], â€¦]\n * @returns polygon [[x1, y1], [x2, y2], â€¦]\n */\nd3.geom.hull = function(vertices) {\n  if (vertices.length < 3) return [];\n\n  var len = vertices.length,\n      plen = len - 1,\n      points = [],\n      stack = [],\n      i, j, h = 0, x1, y1, x2, y2, u, v, a, sp;\n\n  // find the starting ref point: leftmost point with the minimum y coord\n  for (i=1; i<len; ++i) {\n    if (vertices[i][1] < vertices[h][1]) {\n      h = i;\n    } else if (vertices[i][1] == vertices[h][1]) {\n      h = (vertices[i][0] < vertices[h][0] ? i : h);\n    }\n  }\n\n  // calculate polar angles from ref point and sort\n  for (i=0; i<len; ++i) {\n    if (i === h) continue;\n    y1 = vertices[i][1] - vertices[h][1];\n    x1 = vertices[i][0] - vertices[h][0];\n    points.push({angle: Math.atan2(y1, x1), index: i});\n  }\n  points.sort(function(a, b) { return a.angle - b.angle; });\n\n  // toss out duplicate angles\n  a = points[0].angle;\n  v = points[0].index;\n  u = 0;\n  for (i=1; i<plen; ++i) {\n    j = points[i].index;\n    if (a == points[i].angle) {\n      // keep angle for point most distant from the reference\n      x1 = vertices[v][0] - vertices[h][0];\n      y1 = vertices[v][1] - vertices[h][1];\n      x2 = vertices[j][0] - vertices[h][0];\n      y2 = vertices[j][1] - vertices[h][1];\n      if ((x1*x1 + y1*y1) >= (x2*x2 + y2*y2)) {\n        points[i].index = -1;\n      } else {\n        points[u].index = -1;\n        a = points[i].angle;\n        u = i;\n        v = j;\n      }\n    } else {\n      a = points[i].angle;\n      u = i;\n      v = j;\n    }\n  }\n\n  // initialize the stack\n  stack.push(h);\n  for (i=0, j=0; i<2; ++j) {\n    if (points[j].index !== -1) {\n      stack.push(points[j].index);\n      i++;\n    }\n  }\n  sp = stack.length;\n\n  // do graham's scan\n  for (; j<plen; ++j) {\n    if (points[j].index === -1) continue; // skip tossed out points\n    while (!d3_geom_hullCCW(stack[sp-2], stack[sp-1], points[j].index, vertices)) {\n      --sp;\n    }\n    stack[sp++] = points[j].index;\n  }\n\n  // construct the hull\n  var poly = [];\n  for (i=0; i<sp; ++i) {\n    poly.push(vertices[stack[i]]);\n  }\n  return poly;\n}\n\n// are three points in counter-clockwise order?\nfunction d3_geom_hullCCW(i1, i2, i3, v) {\n  var t, a, b, c, d, e, f;\n  t = v[i1]; a = t[0]; b = t[1];\n  t = v[i2]; c = t[0]; d = t[1];\n  t = v[i3]; e = t[0]; f = t[1];\n  return ((f-b)*(c-a) - (d-b)*(e-a)) > 0;\n}\n// Note: requires coordinates to be counterclockwise and convex!\nd3.geom.polygon = function(coordinates) {\n\n  coordinates.area = function() {\n    var i = 0,\n        n = coordinates.length,\n        a = coordinates[n - 1][0] * coordinates[0][1],\n        b = coordinates[n - 1][1] * coordinates[0][0];\n    while (++i < n) {\n      a += coordinates[i - 1][0] * coordinates[i][1];\n      b += coordinates[i - 1][1] * coordinates[i][0];\n    }\n    return (b - a) * .5;\n  };\n\n  coordinates.centroid = function(k) {\n    var i = -1,\n        n = coordinates.length,\n        x = 0,\n        y = 0,\n        a,\n        b = coordinates[n - 1],\n        c;\n    if (!arguments.length) k = -1 / (6 * coordinates.area());\n    while (++i < n) {\n      a = b;\n      b = coordinates[i];\n      c = a[0] * b[1] - b[0] * a[1];\n      x += (a[0] + b[0]) * c;\n      y += (a[1] + b[1]) * c;\n    }\n    return [x * k, y * k];\n  };\n\n  // The Sutherland-Hodgman clipping algorithm.\n  coordinates.clip = function(subject) {\n    var input,\n        i = -1,\n        n = coordinates.length,\n        j,\n        m,\n        a = coordinates[n - 1],\n        b,\n        c,\n        d;\n    while (++i < n) {\n      input = subject.slice();\n      subject.length = 0;\n      b = coordinates[i];\n      c = input[(m = input.length) - 1];\n      j = -1;\n      while (++j < m) {\n        d = input[j];\n        if (d3_geom_polygonInside(d, a, b)) {\n          if (!d3_geom_polygonInside(c, a, b)) {\n            subject.push(d3_geom_polygonIntersect(c, d, a, b));\n          }\n          subject.push(d);\n        } else if (d3_geom_polygonInside(c, a, b)) {\n          subject.push(d3_geom_polygonIntersect(c, d, a, b));\n        }\n        c = d;\n      }\n      a = b;\n    }\n    return subject;\n  };\n\n  return coordinates;\n};\n\nfunction d3_geom_polygonInside(p, a, b) {\n  return (b[0] - a[0]) * (p[1] - a[1]) < (b[1] - a[1]) * (p[0] - a[0]);\n}\n\n// Intersect two infinite lines cd and ab.\nfunction d3_geom_polygonIntersect(c, d, a, b) {\n  var x1 = c[0], x2 = d[0], x3 = a[0], x4 = b[0],\n      y1 = c[1], y2 = d[1], y3 = a[1], y4 = b[1],\n      x13 = x1 - x3,\n      x21 = x2 - x1,\n      x43 = x4 - x3,\n      y13 = y1 - y3,\n      y21 = y2 - y1,\n      y43 = y4 - y3,\n      ua = (x43 * y13 - y43 * x13) / (y43 * x21 - x43 * y21);\n  return [x1 + ua * x21, y1 + ua * y21];\n}\n// Adapted from Nicolas Garcia Belmonte's JIT implementation:\n// http://blog.thejit.org/2010/02/12/voronoi-tessellation/\n// http://blog.thejit.org/assets/voronoijs/voronoi.js\n// See lib/jit/LICENSE for details.\n\n// Notes:\n//\n// This implementation does not clip the returned polygons, so if you want to\n// clip them to a particular shape you will need to do that either in SVG or by\n// post-processing with d3.geom.polygon's clip method.\n//\n// If any vertices are coincident or have NaN positions, the behavior of this\n// method is undefined. Most likely invalid polygons will be returned. You\n// should filter invalid points, and consolidate coincident points, before\n// computing the tessellation.\n\n/**\n * @param vertices [[x1, y1], [x2, y2], â€¦]\n * @returns polygons [[[x1, y1], [x2, y2], â€¦], â€¦]\n */\nd3.geom.voronoi = function(vertices) {\n  var polygons = vertices.map(function() { return []; });\n\n  d3_voronoi_tessellate(vertices, function(e) {\n    var s1,\n        s2,\n        x1,\n        x2,\n        y1,\n        y2;\n    if (e.a === 1 && e.b >= 0) {\n      s1 = e.ep.r;\n      s2 = e.ep.l;\n    } else {\n      s1 = e.ep.l;\n      s2 = e.ep.r;\n    }\n    if (e.a === 1) {\n      y1 = s1 ? s1.y : -1e6;\n      x1 = e.c - e.b * y1;\n      y2 = s2 ? s2.y : 1e6;\n      x2 = e.c - e.b * y2;\n    } else {\n      x1 = s1 ? s1.x : -1e6;\n      y1 = e.c - e.a * x1;\n      x2 = s2 ? s2.x : 1e6;\n      y2 = e.c - e.a * x2;\n    }\n    var v1 = [x1, y1],\n        v2 = [x2, y2];\n    polygons[e.region.l.index].push(v1, v2);\n    polygons[e.region.r.index].push(v1, v2);\n  });\n\n  // Reconnect the polygon segments into counterclockwise loops.\n  return polygons.map(function(polygon, i) {\n    var cx = vertices[i][0],\n        cy = vertices[i][1];\n    polygon.forEach(function(v) {\n      v.angle = Math.atan2(v[0] - cx, v[1] - cy);\n    });\n    return polygon.sort(function(a, b) {\n      return a.angle - b.angle;\n    }).filter(function(d, i) {\n      return !i || (d.angle - polygon[i - 1].angle > 1e-10);\n    });\n  });\n};\n\nvar d3_voronoi_opposite = {\"l\": \"r\", \"r\": \"l\"};\n\nfunction d3_voronoi_tessellate(vertices, callback) {\n\n  var Sites = {\n    list: vertices\n      .map(function(v, i) {\n        return {\n          index: i,\n          x: v[0],\n          y: v[1]\n        };\n      })\n      .sort(function(a, b) {\n        return a.y < b.y ? -1\n          : a.y > b.y ? 1\n          : a.x < b.x ? -1\n          : a.x > b.x ? 1\n          : 0;\n      }),\n    bottomSite: null\n  };\n\n  var EdgeList = {\n    list: [],\n    leftEnd: null,\n    rightEnd: null,\n\n    init: function() {\n      EdgeList.leftEnd = EdgeList.createHalfEdge(null, \"l\");\n      EdgeList.rightEnd = EdgeList.createHalfEdge(null, \"l\");\n      EdgeList.leftEnd.r = EdgeList.rightEnd;\n      EdgeList.rightEnd.l = EdgeList.leftEnd;\n      EdgeList.list.unshift(EdgeList.leftEnd, EdgeList.rightEnd);\n    },\n\n    createHalfEdge: function(edge, side) {\n      return {\n        edge: edge,\n        side: side,\n        vertex: null,\n        \"l\": null,\n        \"r\": null\n      };\n    },\n\n    insert: function(lb, he) {\n      he.l = lb;\n      he.r = lb.r;\n      lb.r.l = he;\n      lb.r = he;\n    },\n\n    leftBound: function(p) {\n      var he = EdgeList.leftEnd;\n      do {\n        he = he.r;\n      } while (he != EdgeList.rightEnd && Geom.rightOf(he, p));\n      he = he.l;\n      return he;\n    },\n\n    del: function(he) {\n      he.l.r = he.r;\n      he.r.l = he.l;\n      he.edge = null;\n    },\n\n    right: function(he) {\n      return he.r;\n    },\n\n    left: function(he) {\n      return he.l;\n    },\n\n    leftRegion: function(he) {\n      return he.edge == null\n          ? Sites.bottomSite\n          : he.edge.region[he.side];\n    },\n\n    rightRegion: function(he) {\n      return he.edge == null\n          ? Sites.bottomSite\n          : he.edge.region[d3_voronoi_opposite[he.side]];\n    }\n  };\n\n  var Geom = {\n\n    bisect: function(s1, s2) {\n      var newEdge = {\n        region: {\"l\": s1, \"r\": s2},\n        ep: {\"l\": null, \"r\": null}\n      };\n\n      var dx = s2.x - s1.x,\n          dy = s2.y - s1.y,\n          adx = dx > 0 ? dx : -dx,\n          ady = dy > 0 ? dy : -dy;\n\n      newEdge.c = s1.x * dx + s1.y * dy\n          + (dx * dx + dy * dy) * .5;\n\n      if (adx > ady) {\n        newEdge.a = 1;\n        newEdge.b = dy / dx;\n        newEdge.c /= dx;\n      } else {\n        newEdge.b = 1;\n        newEdge.a = dx / dy;\n        newEdge.c /= dy;\n      }\n\n      return newEdge;\n    },\n\n    intersect: function(el1, el2) {\n      var e1 = el1.edge,\n          e2 = el2.edge;\n      if (!e1 || !e2 || (e1.region.r == e2.region.r)) {\n        return null;\n      }\n      var d = (e1.a * e2.b) - (e1.b * e2.a);\n      if (Math.abs(d) < 1e-10) {\n        return null;\n      }\n      var xint = (e1.c * e2.b - e2.c * e1.b) / d,\n          yint = (e2.c * e1.a - e1.c * e2.a) / d,\n          e1r = e1.region.r,\n          e2r = e2.region.r,\n          el,\n          e;\n      if ((e1r.y < e2r.y) ||\n         (e1r.y == e2r.y && e1r.x < e2r.x)) {\n        el = el1;\n        e = e1;\n      } else {\n        el = el2;\n        e = e2;\n      }\n      var rightOfSite = (xint >= e.region.r.x);\n      if ((rightOfSite && (el.side === \"l\")) ||\n        (!rightOfSite && (el.side === \"r\"))) {\n        return null;\n      }\n      return {\n        x: xint,\n        y: yint\n      };\n    },\n\n    rightOf: function(he, p) {\n      var e = he.edge,\n          topsite = e.region.r,\n          rightOfSite = (p.x > topsite.x);\n\n      if (rightOfSite && (he.side === \"l\")) {\n        return 1;\n      }\n      if (!rightOfSite && (he.side === \"r\")) {\n        return 0;\n      }\n      if (e.a === 1) {\n        var dyp = p.y - topsite.y,\n            dxp = p.x - topsite.x,\n            fast = 0,\n            above = 0;\n\n        if ((!rightOfSite && (e.b < 0)) ||\n          (rightOfSite && (e.b >= 0))) {\n          above = fast = (dyp >= e.b * dxp);\n        } else {\n          above = ((p.x + p.y * e.b) > e.c);\n          if (e.b < 0) {\n            above = !above;\n          }\n          if (!above) {\n            fast = 1;\n          }\n        }\n        if (!fast) {\n          var dxs = topsite.x - e.region.l.x;\n          above = (e.b * (dxp * dxp - dyp * dyp)) <\n            (dxs * dyp * (1 + 2 * dxp / dxs + e.b * e.b));\n\n          if (e.b < 0) {\n            above = !above;\n          }\n        }\n      } else /* e.b == 1 */ {\n        var yl = e.c - e.a * p.x,\n            t1 = p.y - yl,\n            t2 = p.x - topsite.x,\n            t3 = yl - topsite.y;\n\n        above = (t1 * t1) > (t2 * t2 + t3 * t3);\n      }\n      return he.side === \"l\" ? above : !above;\n    },\n\n    endPoint: function(edge, side, site) {\n      edge.ep[side] = site;\n      if (!edge.ep[d3_voronoi_opposite[side]]) return;\n      callback(edge);\n    },\n\n    distance: function(s, t) {\n      var dx = s.x - t.x,\n          dy = s.y - t.y;\n      return Math.sqrt(dx * dx + dy * dy);\n    }\n  };\n\n  var EventQueue = {\n    list: [],\n\n    insert: function(he, site, offset) {\n      he.vertex = site;\n      he.ystar = site.y + offset;\n      for (var i=0, list=EventQueue.list, l=list.length; i<l; i++) {\n        var next = list[i];\n        if (he.ystar > next.ystar ||\n          (he.ystar == next.ystar &&\n          site.x > next.vertex.x)) {\n          continue;\n        } else {\n          break;\n        }\n      }\n      list.splice(i, 0, he);\n    },\n\n    del: function(he) {\n      for (var i=0, ls=EventQueue.list, l=ls.length; i<l && (ls[i] != he); ++i) {}\n      ls.splice(i, 1);\n    },\n\n    empty: function() { return EventQueue.list.length === 0; },\n\n    nextEvent: function(he) {\n      for (var i=0, ls=EventQueue.list, l=ls.length; i<l; ++i) {\n        if (ls[i] == he) return ls[i+1];\n      }\n      return null;\n    },\n\n    min: function() {\n      var elem = EventQueue.list[0];\n      return {\n        x: elem.vertex.x,\n        y: elem.ystar\n      };\n    },\n\n    extractMin: function() {\n      return EventQueue.list.shift();\n    }\n  };\n\n  EdgeList.init();\n  Sites.bottomSite = Sites.list.shift();\n\n  var newSite = Sites.list.shift(), newIntStar;\n  var lbnd, rbnd, llbnd, rrbnd, bisector;\n  var bot, top, temp, p, v;\n  var e, pm;\n\n  while (true) {\n    if (!EventQueue.empty()) {\n      newIntStar = EventQueue.min();\n    }\n    if (newSite && (EventQueue.empty()\n      || newSite.y < newIntStar.y\n      || (newSite.y == newIntStar.y\n      && newSite.x < newIntStar.x))) { //new site is smallest\n      lbnd = EdgeList.leftBound(newSite);\n      rbnd = EdgeList.right(lbnd);\n      bot = EdgeList.rightRegion(lbnd);\n      e = Geom.bisect(bot, newSite);\n      bisector = EdgeList.createHalfEdge(e, \"l\");\n      EdgeList.insert(lbnd, bisector);\n      p = Geom.intersect(lbnd, bisector);\n      if (p) {\n        EventQueue.del(lbnd);\n        EventQueue.insert(lbnd, p, Geom.distance(p, newSite));\n      }\n      lbnd = bisector;\n      bisector = EdgeList.createHalfEdge(e, \"r\");\n      EdgeList.insert(lbnd, bisector);\n      p = Geom.intersect(bisector, rbnd);\n      if (p) {\n        EventQueue.insert(bisector, p, Geom.distance(p, newSite));\n      }\n      newSite = Sites.list.shift();\n    } else if (!EventQueue.empty()) { //intersection is smallest\n      lbnd = EventQueue.extractMin();\n      llbnd = EdgeList.left(lbnd);\n      rbnd = EdgeList.right(lbnd);\n      rrbnd = EdgeList.right(rbnd);\n      bot = EdgeList.leftRegion(lbnd);\n      top = EdgeList.rightRegion(rbnd);\n      v = lbnd.vertex;\n      Geom.endPoint(lbnd.edge, lbnd.side, v);\n      Geom.endPoint(rbnd.edge, rbnd.side, v);\n      EdgeList.del(lbnd);\n      EventQueue.del(rbnd);\n      EdgeList.del(rbnd);\n      pm = \"l\";\n      if (bot.y > top.y) {\n        temp = bot;\n        bot = top;\n        top = temp;\n        pm = \"r\";\n      }\n      e = Geom.bisect(bot, top);\n      bisector = EdgeList.createHalfEdge(e, pm);\n      EdgeList.insert(llbnd, bisector);\n      Geom.endPoint(e, d3_voronoi_opposite[pm], v);\n      p = Geom.intersect(llbnd, bisector);\n      if (p) {\n        EventQueue.del(llbnd);\n        EventQueue.insert(llbnd, p, Geom.distance(p, bot));\n      }\n      p = Geom.intersect(bisector, rrbnd);\n      if (p) {\n        EventQueue.insert(bisector, p, Geom.distance(p, bot));\n      }\n    } else {\n      break;\n    }\n  }//end while\n\n  for (lbnd = EdgeList.right(EdgeList.leftEnd);\n      lbnd != EdgeList.rightEnd;\n      lbnd = EdgeList.right(lbnd)) {\n    callback(lbnd.edge);\n  }\n}\n/**\n* @param vertices [[x1, y1], [x2, y2], â€¦]\n* @returns triangles [[[x1, y1], [x2, y2], [x3, y3]], â€¦]\n */\nd3.geom.delaunay = function(vertices) {\n  var edges = vertices.map(function() { return []; }),\n      triangles = [];\n\n  // Use the Voronoi tessellation to determine Delaunay edges.\n  d3_voronoi_tessellate(vertices, function(e) {\n    edges[e.region.l.index].push(vertices[e.region.r.index]);\n  });\n\n  // Reconnect the edges into counterclockwise triangles.\n  edges.forEach(function(edge, i) {\n    var v = vertices[i],\n        cx = v[0],\n        cy = v[1];\n    edge.forEach(function(v) {\n      v.angle = Math.atan2(v[0] - cx, v[1] - cy);\n    });\n    edge.sort(function(a, b) {\n      return a.angle - b.angle;\n    });\n    for (var j = 0, m = edge.length - 1; j < m; j++) {\n      triangles.push([v, edge[j], edge[j + 1]]);\n    }\n  });\n\n  return triangles;\n};\n// Constructs a new quadtree for the specified array of points. A quadtree is a\n// two-dimensional recursive spatial subdivision. This implementation uses\n// square partitions, dividing each square into four equally-sized squares. Each\n// point exists in a unique node; if multiple points are in the same position,\n// some points may be stored on internal nodes rather than leaf nodes. Quadtrees\n// can be used to accelerate various spatial operations, such as the Barnes-Hut\n// approximation for computing n-body forces, or collision detection.\nd3.geom.quadtree = function(points, x1, y1, x2, y2) {\n  var p,\n      i = -1,\n      n = points.length;\n\n  // Type conversion for deprecated API.\n  if (n && isNaN(points[0].x)) points = points.map(d3_geom_quadtreePoint);\n\n  // Allow bounds to be specified explicitly.\n  if (arguments.length < 5) {\n    if (arguments.length === 3) {\n      y2 = x2 = y1;\n      y1 = x1;\n    } else {\n      x1 = y1 = Infinity;\n      x2 = y2 = -Infinity;\n\n      // Compute bounds.\n      while (++i < n) {\n        p = points[i];\n        if (p.x < x1) x1 = p.x;\n        if (p.y < y1) y1 = p.y;\n        if (p.x > x2) x2 = p.x;\n        if (p.y > y2) y2 = p.y;\n      }\n\n      // Squarify the bounds.\n      var dx = x2 - x1,\n          dy = y2 - y1;\n      if (dx > dy) y2 = y1 + dx;\n      else x2 = x1 + dy;\n    }\n  }\n\n  // Recursively inserts the specified point p at the node n or one of its\n  // descendants. The bounds are defined by [x1, x2] and [y1, y2].\n  function insert(n, p, x1, y1, x2, y2) {\n    if (isNaN(p.x) || isNaN(p.y)) return; // ignore invalid points\n    if (n.leaf) {\n      var v = n.point;\n      if (v) {\n        // If the point at this leaf node is at the same position as the new\n        // point we are adding, we leave the point associated with the\n        // internal node while adding the new point to a child node. This\n        // avoids infinite recursion.\n        if ((Math.abs(v.x - p.x) + Math.abs(v.y - p.y)) < .01) {\n          insertChild(n, p, x1, y1, x2, y2);\n        } else {\n          n.point = null;\n          insertChild(n, v, x1, y1, x2, y2);\n          insertChild(n, p, x1, y1, x2, y2);\n        }\n      } else {\n        n.point = p;\n      }\n    } else {\n      insertChild(n, p, x1, y1, x2, y2);\n    }\n  }\n\n  // Recursively inserts the specified point p into a descendant of node n. The\n  // bounds are defined by [x1, x2] and [y1, y2].\n  function insertChild(n, p, x1, y1, x2, y2) {\n    // Compute the split point, and the quadrant in which to insert p.\n    var sx = (x1 + x2) * .5,\n        sy = (y1 + y2) * .5,\n        right = p.x >= sx,\n        bottom = p.y >= sy,\n        i = (bottom << 1) + right;\n\n    // Recursively insert into the child node.\n    n.leaf = false;\n    n = n.nodes[i] || (n.nodes[i] = d3_geom_quadtreeNode());\n\n    // Update the bounds as we recurse.\n    if (right) x1 = sx; else x2 = sx;\n    if (bottom) y1 = sy; else y2 = sy;\n    insert(n, p, x1, y1, x2, y2);\n  }\n\n  // Create the root node.\n  var root = d3_geom_quadtreeNode();\n\n  root.add = function(p) {\n    insert(root, p, x1, y1, x2, y2);\n  };\n\n  root.visit = function(f) {\n    d3_geom_quadtreeVisit(f, root, x1, y1, x2, y2);\n  };\n\n  // Insert all points.\n  points.forEach(root.add);\n  return root;\n};\n\nfunction d3_geom_quadtreeNode() {\n  return {\n    leaf: true,\n    nodes: [],\n    point: null\n  };\n}\n\nfunction d3_geom_quadtreeVisit(f, node, x1, y1, x2, y2) {\n  if (!f(node, x1, y1, x2, y2)) {\n    var sx = (x1 + x2) * .5,\n        sy = (y1 + y2) * .5,\n        children = node.nodes;\n    if (children[0]) d3_geom_quadtreeVisit(f, children[0], x1, y1, sx, sy);\n    if (children[1]) d3_geom_quadtreeVisit(f, children[1], sx, y1, x2, sy);\n    if (children[2]) d3_geom_quadtreeVisit(f, children[2], x1, sy, sx, y2);\n    if (children[3]) d3_geom_quadtreeVisit(f, children[3], sx, sy, x2, y2);\n  }\n}\n\nfunction d3_geom_quadtreePoint(p) {\n  return {\n    x: p[0],\n    y: p[1]\n  };\n}\nd3.time = {};\n\nvar d3_time = Date;\n\nfunction d3_time_utc() {\n  this._ = new Date(arguments.length > 1\n      ? Date.UTC.apply(this, arguments)\n      : arguments[0]);\n}\n\nd3_time_utc.prototype = {\n  getDate: function() { return this._.getUTCDate(); },\n  getDay: function() { return this._.getUTCDay(); },\n  getFullYear: function() { return this._.getUTCFullYear(); },\n  getHours: function() { return this._.getUTCHours(); },\n  getMilliseconds: function() { return this._.getUTCMilliseconds(); },\n  getMinutes: function() { return this._.getUTCMinutes(); },\n  getMonth: function() { return this._.getUTCMonth(); },\n  getSeconds: function() { return this._.getUTCSeconds(); },\n  getTime: function() { return this._.getTime(); },\n  getTimezoneOffset: function() { return 0; },\n  valueOf: function() { return this._.valueOf(); },\n  setDate: function() { d3_time_prototype.setUTCDate.apply(this._, arguments); },\n  setDay: function() { d3_time_prototype.setUTCDay.apply(this._, arguments); },\n  setFullYear: function() { d3_time_prototype.setUTCFullYear.apply(this._, arguments); },\n  setHours: function() { d3_time_prototype.setUTCHours.apply(this._, arguments); },\n  setMilliseconds: function() { d3_time_prototype.setUTCMilliseconds.apply(this._, arguments); },\n  setMinutes: function() { d3_time_prototype.setUTCMinutes.apply(this._, arguments); },\n  setMonth: function() { d3_time_prototype.setUTCMonth.apply(this._, arguments); },\n  setSeconds: function() { d3_time_prototype.setUTCSeconds.apply(this._, arguments); },\n  setTime: function() { d3_time_prototype.setTime.apply(this._, arguments); }\n};\n\nvar d3_time_prototype = Date.prototype;\nd3.time.format = function(template) {\n  var n = template.length;\n\n  function format(date) {\n    var string = [],\n        i = -1,\n        j = 0,\n        c,\n        f;\n    while (++i < n) {\n      if (template.charCodeAt(i) == 37) {\n        string.push(\n            template.substring(j, i),\n            (f = d3_time_formats[c = template.charAt(++i)])\n            ? f(date) : c);\n        j = i + 1;\n      }\n    }\n    string.push(template.substring(j, i));\n    return string.join(\"\");\n  }\n\n  format.parse = function(string) {\n    var d = {y: 1900, m: 0, d: 1, H: 0, M: 0, S: 0, L: 0},\n        i = d3_time_parse(d, template, string, 0);\n    if (i != string.length) return null;\n\n    // The am-pm flag is 0 for AM, and 1 for PM.\n    if (\"p\" in d) d.H = d.H % 12 + d.p * 12;\n\n    var date = new d3_time();\n    date.setFullYear(d.y, d.m, d.d);\n    date.setHours(d.H, d.M, d.S, d.L);\n    return date;\n  };\n\n  format.toString = function() {\n    return template;\n  };\n\n  return format;\n};\n\nfunction d3_time_parse(date, template, string, j) {\n  var c,\n      p,\n      i = 0,\n      n = template.length,\n      m = string.length;\n  while (i < n) {\n    if (j >= m) return -1;\n    c = template.charCodeAt(i++);\n    if (c == 37) {\n      p = d3_time_parsers[template.charAt(i++)];\n      if (!p || ((j = p(date, string, j)) < 0)) return -1;\n    } else if (c != string.charCodeAt(j++)) {\n      return -1;\n    }\n  }\n  return j;\n}\n\nvar d3_time_zfill2 = d3.format(\"02d\"),\n    d3_time_zfill3 = d3.format(\"03d\"),\n    d3_time_zfill4 = d3.format(\"04d\"),\n    d3_time_sfill2 = d3.format(\"2d\");\n\nvar d3_time_formats = {\n  a: function(d) { return d3_time_weekdays[d.getDay()].substring(0, 3); },\n  A: function(d) { return d3_time_weekdays[d.getDay()]; },\n  b: function(d) { return d3_time_months[d.getMonth()].substring(0, 3); },\n  B: function(d) { return d3_time_months[d.getMonth()]; },\n  c: d3.time.format(\"%a %b %e %H:%M:%S %Y\"),\n  d: function(d) { return d3_time_zfill2(d.getDate()); },\n  e: function(d) { return d3_time_sfill2(d.getDate()); },\n  H: function(d) { return d3_time_zfill2(d.getHours()); },\n  I: function(d) { return d3_time_zfill2(d.getHours() % 12 || 12); },\n  j: function(d) { return d3_time_zfill3(1 + d3.time.dayOfYear(d)); },\n  L: function(d) { return d3_time_zfill3(d.getMilliseconds()); },\n  m: function(d) { return d3_time_zfill2(d.getMonth() + 1); },\n  M: function(d) { return d3_time_zfill2(d.getMinutes()); },\n  p: function(d) { return d.getHours() >= 12 ? \"PM\" : \"AM\"; },\n  S: function(d) { return d3_time_zfill2(d.getSeconds()); },\n  U: function(d) { return d3_time_zfill2(d3.time.sundayOfYear(d)); },\n  w: function(d) { return d.getDay(); },\n  W: function(d) { return d3_time_zfill2(d3.time.mondayOfYear(d)); },\n  x: d3.time.format(\"%m/%d/%y\"),\n  X: d3.time.format(\"%H:%M:%S\"),\n  y: function(d) { return d3_time_zfill2(d.getFullYear() % 100); },\n  Y: function(d) { return d3_time_zfill4(d.getFullYear() % 10000); },\n  Z: d3_time_zone,\n  \"%\": function(d) { return \"%\"; }\n};\n\nvar d3_time_parsers = {\n  a: d3_time_parseWeekdayAbbrev,\n  A: d3_time_parseWeekday,\n  b: d3_time_parseMonthAbbrev,\n  B: d3_time_parseMonth,\n  c: d3_time_parseLocaleFull,\n  d: d3_time_parseDay,\n  e: d3_time_parseDay,\n  H: d3_time_parseHour24,\n  I: d3_time_parseHour24,\n  // j: function(d, s, i) { /*TODO day of year [001,366] */ return i; },\n  L: d3_time_parseMilliseconds,\n  m: d3_time_parseMonthNumber,\n  M: d3_time_parseMinutes,\n  p: d3_time_parseAmPm,\n  S: d3_time_parseSeconds,\n  // U: function(d, s, i) { /*TODO week number (sunday) [00,53] */ return i; },\n  // w: function(d, s, i) { /*TODO weekday [0,6] */ return i; },\n  // W: function(d, s, i) { /*TODO week number (monday) [00,53] */ return i; },\n  x: d3_time_parseLocaleDate,\n  X: d3_time_parseLocaleTime,\n  y: d3_time_parseYear,\n  Y: d3_time_parseFullYear\n  // ,\n  // Z: function(d, s, i) { /*TODO time zone */ return i; },\n  // \"%\": function(d, s, i) { /*TODO literal % */ return i; }\n};\n\n// Note: weekday is validated, but does not set the date.\nfunction d3_time_parseWeekdayAbbrev(date, string, i) {\n  return d3_time_weekdayAbbrevRe.test(string.substring(i, i += 3)) ? i : -1;\n}\n\n// Note: weekday is validated, but does not set the date.\nfunction d3_time_parseWeekday(date, string, i) {\n  d3_time_weekdayRe.lastIndex = 0;\n  var n = d3_time_weekdayRe.exec(string.substring(i, i + 10));\n  return n ? i += n[0].length : -1;\n}\n\nvar d3_time_weekdayAbbrevRe = /^(?:sun|mon|tue|wed|thu|fri|sat)/i,\n    d3_time_weekdayRe = /^(?:Sunday|Monday|Tuesday|Wednesday|Thursday|Friday|Saturday)/i,\n    d3_time_weekdays = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"];\n\nfunction d3_time_parseMonthAbbrev(date, string, i) {\n  var n = d3_time_monthAbbrevLookup.get(string.substring(i, i += 3).toLowerCase());\n  return n == null ? -1 : (date.m = n, i);\n}\n\nvar d3_time_monthAbbrevLookup = d3.map({\n  jan: 0,\n  feb: 1,\n  mar: 2,\n  apr: 3,\n  may: 4,\n  jun: 5,\n  jul: 6,\n  aug: 7,\n  sep: 8,\n  oct: 9,\n  nov: 10,\n  dec: 11\n});\n\nfunction d3_time_parseMonth(date, string, i) {\n  d3_time_monthRe.lastIndex = 0;\n  var n = d3_time_monthRe.exec(string.substring(i, i + 12));\n  return n ? (date.m = d3_time_monthLookup.get(n[0].toLowerCase()), i += n[0].length) : -1;\n}\n\nvar d3_time_monthRe = /^(?:January|February|March|April|May|June|July|August|September|October|November|December)/ig;\n\nvar d3_time_monthLookup = d3.map({\n  january: 0,\n  february: 1,\n  march: 2,\n  april: 3,\n  may: 4,\n  june: 5,\n  july: 6,\n  august: 7,\n  september: 8,\n  october: 9,\n  november: 10,\n  december: 11\n});\n\nvar d3_time_months = [\n  \"January\",\n  \"February\",\n  \"March\",\n  \"April\",\n  \"May\",\n  \"June\",\n  \"July\",\n  \"August\",\n  \"September\",\n  \"October\",\n  \"November\",\n  \"December\"\n];\n\nfunction d3_time_parseLocaleFull(date, string, i) {\n  return d3_time_parse(date, d3_time_formats.c.toString(), string, i);\n}\n\nfunction d3_time_parseLocaleDate(date, string, i) {\n  return d3_time_parse(date, d3_time_formats.x.toString(), string, i);\n}\n\nfunction d3_time_parseLocaleTime(date, string, i) {\n  return d3_time_parse(date, d3_time_formats.X.toString(), string, i);\n}\n\nfunction d3_time_parseFullYear(date, string, i) {\n  d3_time_numberRe.lastIndex = 0;\n  var n = d3_time_numberRe.exec(string.substring(i, i + 4));\n  return n ? (date.y = +n[0], i += n[0].length) : -1;\n}\n\nfunction d3_time_parseYear(date, string, i) {\n  d3_time_numberRe.lastIndex = 0;\n  var n = d3_time_numberRe.exec(string.substring(i, i + 2));\n  return n ? (date.y = d3_time_century() + +n[0], i += n[0].length) : -1;\n}\n\nfunction d3_time_century() {\n  return ~~(new Date().getFullYear() / 1000) * 1000;\n}\n\nfunction d3_time_parseMonthNumber(date, string, i) {\n  d3_time_numberRe.lastIndex = 0;\n  var n = d3_time_numberRe.exec(string.substring(i, i + 2));\n  return n ? (date.m = n[0] - 1, i += n[0].length) : -1;\n}\n\nfunction d3_time_parseDay(date, string, i) {\n  d3_time_numberRe.lastIndex = 0;\n  var n = d3_time_numberRe.exec(string.substring(i, i + 2));\n  return n ? (date.d = +n[0], i += n[0].length) : -1;\n}\n\n// Note: we don't validate that the hour is in the range [0,23] or [1,12].\nfunction d3_time_parseHour24(date, string, i) {\n  d3_time_numberRe.lastIndex = 0;\n  var n = d3_time_numberRe.exec(string.substring(i, i + 2));\n  return n ? (date.H = +n[0], i += n[0].length) : -1;\n}\n\nfunction d3_time_parseMinutes(date, string, i) {\n  d3_time_numberRe.lastIndex = 0;\n  var n = d3_time_numberRe.exec(string.substring(i, i + 2));\n  return n ? (date.M = +n[0], i += n[0].length) : -1;\n}\n\nfunction d3_time_parseSeconds(date, string, i) {\n  d3_time_numberRe.lastIndex = 0;\n  var n = d3_time_numberRe.exec(string.substring(i, i + 2));\n  return n ? (date.S = +n[0], i += n[0].length) : -1;\n}\n\nfunction d3_time_parseMilliseconds(date, string, i) {\n  d3_time_numberRe.lastIndex = 0;\n  var n = d3_time_numberRe.exec(string.substring(i, i + 3));\n  return n ? (date.L = +n[0], i += n[0].length) : -1;\n}\n\n// Note: we don't look at the next directive.\nvar d3_time_numberRe = /\\s*\\d+/;\n\nfunction d3_time_parseAmPm(date, string, i) {\n  var n = d3_time_amPmLookup.get(string.substring(i, i += 2).toLowerCase());\n  return n == null ? -1 : (date.p = n, i);\n}\n\nvar d3_time_amPmLookup = d3.map({\n  am: 0,\n  pm: 1\n});\n\n// TODO table of time zone offset names?\nfunction d3_time_zone(d) {\n  var z = d.getTimezoneOffset(),\n      zs = z > 0 ? \"-\" : \"+\",\n      zh = ~~(Math.abs(z) / 60),\n      zm = Math.abs(z) % 60;\n  return zs + d3_time_zfill2(zh) + d3_time_zfill2(zm);\n}\nd3.time.format.utc = function(template) {\n  var local = d3.time.format(template);\n\n  function format(date) {\n    try {\n      d3_time = d3_time_utc;\n      var utc = new d3_time();\n      utc._ = date;\n      return local(utc);\n    } finally {\n      d3_time = Date;\n    }\n  }\n\n  format.parse = function(string) {\n    try {\n      d3_time = d3_time_utc;\n      var date = local.parse(string);\n      return date && date._;\n    } finally {\n      d3_time = Date;\n    }\n  };\n\n  format.toString = local.toString;\n\n  return format;\n};\nvar d3_time_formatIso = d3.time.format.utc(\"%Y-%m-%dT%H:%M:%S.%LZ\");\n\nd3.time.format.iso = Date.prototype.toISOString ? d3_time_formatIsoNative : d3_time_formatIso;\n\nfunction d3_time_formatIsoNative(date) {\n  return date.toISOString();\n}\n\nd3_time_formatIsoNative.parse = function(string) {\n  var date = new Date(string);\n  return isNaN(date) ? null : date;\n};\n\nd3_time_formatIsoNative.toString = d3_time_formatIso.toString;\nfunction d3_time_interval(local, step, number) {\n\n  function round(date) {\n    var d0 = local(date), d1 = offset(d0, 1);\n    return date - d0 < d1 - date ? d0 : d1;\n  }\n\n  function ceil(date) {\n    step(date = local(new d3_time(date - 1)), 1);\n    return date;\n  }\n\n  function offset(date, k) {\n    step(date = new d3_time(+date), k);\n    return date;\n  }\n\n  function range(t0, t1, dt) {\n    var time = ceil(t0), times = [];\n    if (dt > 1) {\n      while (time < t1) {\n        if (!(number(time) % dt)) times.push(new Date(+time));\n        step(time, 1);\n      }\n    } else {\n      while (time < t1) times.push(new Date(+time)), step(time, 1);\n    }\n    return times;\n  }\n\n  function range_utc(t0, t1, dt) {\n    try {\n      d3_time = d3_time_utc;\n      var utc = new d3_time_utc();\n      utc._ = t0;\n      return range(utc, t1, dt);\n    } finally {\n      d3_time = Date;\n    }\n  }\n\n  local.floor = local;\n  local.round = round;\n  local.ceil = ceil;\n  local.offset = offset;\n  local.range = range;\n\n  var utc = local.utc = d3_time_interval_utc(local);\n  utc.floor = utc;\n  utc.round = d3_time_interval_utc(round);\n  utc.ceil = d3_time_interval_utc(ceil);\n  utc.offset = d3_time_interval_utc(offset);\n  utc.range = range_utc;\n\n  return local;\n}\n\nfunction d3_time_interval_utc(method) {\n  return function(date, k) {\n    try {\n      d3_time = d3_time_utc;\n      var utc = new d3_time_utc();\n      utc._ = date;\n      return method(utc, k)._;\n    } finally {\n      d3_time = Date;\n    }\n  };\n}\nd3.time.second = d3_time_interval(function(date) {\n  return new d3_time(Math.floor(date / 1e3) * 1e3);\n}, function(date, offset) {\n  date.setTime(date.getTime() + Math.floor(offset) * 1e3); // DST breaks setSeconds\n}, function(date) {\n  return date.getSeconds();\n});\n\nd3.time.seconds = d3.time.second.range;\nd3.time.seconds.utc = d3.time.second.utc.range;\nd3.time.minute = d3_time_interval(function(date) {\n  return new d3_time(Math.floor(date / 6e4) * 6e4);\n}, function(date, offset) {\n  date.setTime(date.getTime() + Math.floor(offset) * 6e4); // DST breaks setMinutes\n}, function(date) {\n  return date.getMinutes();\n});\n\nd3.time.minutes = d3.time.minute.range;\nd3.time.minutes.utc = d3.time.minute.utc.range;\nd3.time.hour = d3_time_interval(function(date) {\n  var timezone = date.getTimezoneOffset() / 60;\n  return new d3_time((Math.floor(date / 36e5 - timezone) + timezone) * 36e5);\n}, function(date, offset) {\n  date.setTime(date.getTime() + Math.floor(offset) * 36e5); // DST breaks setHours\n}, function(date) {\n  return date.getHours();\n});\n\nd3.time.hours = d3.time.hour.range;\nd3.time.hours.utc = d3.time.hour.utc.range;\nd3.time.day = d3_time_interval(function(date) {\n  return new d3_time(date.getFullYear(), date.getMonth(), date.getDate());\n}, function(date, offset) {\n  date.setDate(date.getDate() + offset);\n}, function(date) {\n  return date.getDate() - 1;\n});\n\nd3.time.days = d3.time.day.range;\nd3.time.days.utc = d3.time.day.utc.range;\n\nd3.time.dayOfYear = function(date) {\n  var year = d3.time.year(date);\n  return Math.floor((date - year) / 864e5 - (date.getTimezoneOffset() - year.getTimezoneOffset()) / 1440);\n};\nd3_time_weekdays.forEach(function(day, i) {\n  day = day.toLowerCase();\n  i = 7 - i;\n\n  var interval = d3.time[day] = d3_time_interval(function(date) {\n    (date = d3.time.day(date)).setDate(date.getDate() - (date.getDay() + i) % 7);\n    return date;\n  }, function(date, offset) {\n    date.setDate(date.getDate() + Math.floor(offset) * 7);\n  }, function(date) {\n    var day = d3.time.year(date).getDay();\n    return Math.floor((d3.time.dayOfYear(date) + (day + i) % 7) / 7) - (day !== i);\n  });\n\n  d3.time[day + \"s\"] = interval.range;\n  d3.time[day + \"s\"].utc = interval.utc.range;\n\n  d3.time[day + \"OfYear\"] = function(date) {\n    var day = d3.time.year(date).getDay();\n    return Math.floor((d3.time.dayOfYear(date) + (day + i) % 7) / 7);\n  };\n});\n\nd3.time.week = d3.time.sunday;\nd3.time.weeks = d3.time.sunday.range;\nd3.time.weeks.utc = d3.time.sunday.utc.range;\nd3.time.weekOfYear = d3.time.sundayOfYear;\nd3.time.month = d3_time_interval(function(date) {\n  return new d3_time(date.getFullYear(), date.getMonth(), 1);\n}, function(date, offset) {\n  date.setMonth(date.getMonth() + offset);\n}, function(date) {\n  return date.getMonth();\n});\n\nd3.time.months = d3.time.month.range;\nd3.time.months.utc = d3.time.month.utc.range;\nd3.time.year = d3_time_interval(function(date) {\n  return new d3_time(date.getFullYear(), 0, 1);\n}, function(date, offset) {\n  date.setFullYear(date.getFullYear() + offset);\n}, function(date) {\n  return date.getFullYear();\n});\n\nd3.time.years = d3.time.year.range;\nd3.time.years.utc = d3.time.year.utc.range;\nfunction d3_time_scale(linear, methods, format) {\n\n  function scale(x) {\n    return linear(x);\n  }\n\n  scale.invert = function(x) {\n    return d3_time_scaleDate(linear.invert(x));\n  };\n\n  scale.domain = function(x) {\n    if (!arguments.length) return linear.domain().map(d3_time_scaleDate);\n    linear.domain(x);\n    return scale;\n  };\n\n  scale.nice = function(m) {\n    var extent = d3_time_scaleExtent(scale.domain());\n    return scale.domain([m.floor(extent[0]), m.ceil(extent[1])]);\n  };\n\n  scale.ticks = function(m, k) {\n    var extent = d3_time_scaleExtent(scale.domain());\n    if (typeof m !== \"function\") {\n      var span = extent[1] - extent[0],\n          target = span / m,\n          i = d3.bisect(d3_time_scaleSteps, target);\n      if (i == d3_time_scaleSteps.length) return methods.year(extent, m);\n      if (!i) return linear.ticks(m).map(d3_time_scaleDate);\n      if (Math.log(target / d3_time_scaleSteps[i - 1]) < Math.log(d3_time_scaleSteps[i] / target)) --i;\n      m = methods[i];\n      k = m[1];\n      m = m[0].range;\n    }\n    return m(extent[0], new Date(+extent[1] + 1), k); // inclusive upper bound\n  };\n\n  scale.tickFormat = function() {\n    return format;\n  };\n\n  scale.copy = function() {\n    return d3_time_scale(linear.copy(), methods, format);\n  };\n\n  // TOOD expose d3_scale_linear_rebind?\n  return d3.rebind(scale, linear, \"range\", \"rangeRound\", \"interpolate\", \"clamp\");\n}\n\n// TODO expose d3_scaleExtent?\nfunction d3_time_scaleExtent(domain) {\n  var start = domain[0], stop = domain[domain.length - 1];\n  return start < stop ? [start, stop] : [stop, start];\n}\n\nfunction d3_time_scaleDate(t) {\n  return new Date(t);\n}\n\nfunction d3_time_scaleFormat(formats) {\n  return function(date) {\n    var i = formats.length - 1, f = formats[i];\n    while (!f[1](date)) f = formats[--i];\n    return f[0](date);\n  };\n}\n\nfunction d3_time_scaleSetYear(y) {\n  var d = new Date(y, 0, 1);\n  d.setFullYear(y); // Y2K fail\n  return d;\n}\n\nfunction d3_time_scaleGetYear(d) {\n  var y = d.getFullYear(),\n      d0 = d3_time_scaleSetYear(y),\n      d1 = d3_time_scaleSetYear(y + 1);\n  return y + (d - d0) / (d1 - d0);\n}\n\nvar d3_time_scaleSteps = [\n  1e3,    // 1-second\n  5e3,    // 5-second\n  15e3,   // 15-second\n  3e4,    // 30-second\n  6e4,    // 1-minute\n  3e5,    // 5-minute\n  9e5,    // 15-minute\n  18e5,   // 30-minute\n  36e5,   // 1-hour\n  108e5,  // 3-hour\n  216e5,  // 6-hour\n  432e5,  // 12-hour\n  864e5,  // 1-day\n  1728e5, // 2-day\n  6048e5, // 1-week\n  2592e6, // 1-month\n  7776e6, // 3-month\n  31536e6 // 1-year\n];\n\nvar d3_time_scaleLocalMethods = [\n  [d3.time.second, 1],\n  [d3.time.second, 5],\n  [d3.time.second, 15],\n  [d3.time.second, 30],\n  [d3.time.minute, 1],\n  [d3.time.minute, 5],\n  [d3.time.minute, 15],\n  [d3.time.minute, 30],\n  [d3.time.hour, 1],\n  [d3.time.hour, 3],\n  [d3.time.hour, 6],\n  [d3.time.hour, 12],\n  [d3.time.day, 1],\n  [d3.time.day, 2],\n  [d3.time.week, 1],\n  [d3.time.month, 1],\n  [d3.time.month, 3],\n  [d3.time.year, 1]\n];\n\nvar d3_time_scaleLocalFormats = [\n  [d3.time.format(\"%Y\"), function(d) { return true; }],\n  [d3.time.format(\"%B\"), function(d) { return d.getMonth(); }],\n  [d3.time.format(\"%b %d\"), function(d) { return d.getDate() != 1; }],\n  [d3.time.format(\"%a %d\"), function(d) { return d.getDay() && d.getDate() != 1; }],\n  [d3.time.format(\"%I %p\"), function(d) { return d.getHours(); }],\n  [d3.time.format(\"%I:%M\"), function(d) { return d.getMinutes(); }],\n  [d3.time.format(\":%S\"), function(d) { return d.getSeconds(); }],\n  [d3.time.format(\".%L\"), function(d) { return d.getMilliseconds(); }]\n];\n\nvar d3_time_scaleLinear = d3.scale.linear(),\n    d3_time_scaleLocalFormat = d3_time_scaleFormat(d3_time_scaleLocalFormats);\n\nd3_time_scaleLocalMethods.year = function(extent, m) {\n  return d3_time_scaleLinear.domain(extent.map(d3_time_scaleGetYear)).ticks(m).map(d3_time_scaleSetYear);\n};\n\nd3.time.scale = function() {\n  return d3_time_scale(d3.scale.linear(), d3_time_scaleLocalMethods, d3_time_scaleLocalFormat);\n};\nvar d3_time_scaleUTCMethods = d3_time_scaleLocalMethods.map(function(m) {\n  return [m[0].utc, m[1]];\n});\n\nvar d3_time_scaleUTCFormats = [\n  [d3.time.format.utc(\"%Y\"), function(d) { return true; }],\n  [d3.time.format.utc(\"%B\"), function(d) { return d.getUTCMonth(); }],\n  [d3.time.format.utc(\"%b %d\"), function(d) { return d.getUTCDate() != 1; }],\n  [d3.time.format.utc(\"%a %d\"), function(d) { return d.getUTCDay() && d.getUTCDate() != 1; }],\n  [d3.time.format.utc(\"%I %p\"), function(d) { return d.getUTCHours(); }],\n  [d3.time.format.utc(\"%I:%M\"), function(d) { return d.getUTCMinutes(); }],\n  [d3.time.format.utc(\":%S\"), function(d) { return d.getUTCSeconds(); }],\n  [d3.time.format.utc(\".%L\"), function(d) { return d.getUTCMilliseconds(); }]\n];\n\nvar d3_time_scaleUTCFormat = d3_time_scaleFormat(d3_time_scaleUTCFormats);\n\nfunction d3_time_scaleUTCSetYear(y) {\n  var d = new Date(Date.UTC(y, 0, 1));\n  d.setUTCFullYear(y); // Y2K fail\n  return d;\n}\n\nfunction d3_time_scaleUTCGetYear(d) {\n  var y = d.getUTCFullYear(),\n      d0 = d3_time_scaleUTCSetYear(y),\n      d1 = d3_time_scaleUTCSetYear(y + 1);\n  return y + (d - d0) / (d1 - d0);\n}\n\nd3_time_scaleUTCMethods.year = function(extent, m) {\n  return d3_time_scaleLinear.domain(extent.map(d3_time_scaleUTCGetYear)).ticks(m).map(d3_time_scaleUTCSetYear);\n};\n\nd3.time.scale.utc = function() {\n  return d3_time_scale(d3.scale.linear(), d3_time_scaleUTCMethods, d3_time_scaleUTCFormat);\n};\n})();","/**\r\n * ColorPicker - pure JavaScript color picker without using images, external CSS or 1px divs.\r\n * Copyright © 2011 David Durman, All rights reserved.\r\n */\r\n(function(window, document, undefined) {\r\n\r\n    var type = (window.SVGAngle || document.implementation.hasFeature(\"http://www.w3.org/TR/SVG11/feature#BasicStructure\", \"1.1\") ? \"SVG\" : \"VML\"),\r\n        picker, slide, hueOffset = 15,\r\n        svgNS = 'http://www.w3.org/2000/svg';\r\n\r\n    // This HTML snippet is inserted into the innerHTML property of the passed color picker element\r\n    // when the no-hassle call to ColorPicker() is used, i.e. ColorPicker(function(hex, hsv, rgb) { ... });\r\n\r\n    var colorpickerHTMLSnippet = [\r\n\r\n        '<div class=\"picker-wrapper\">',\r\n        '<div class=\"picker\"></div>',\r\n        '<div class=\"picker-indicator\"></div>',\r\n        '</div>',\r\n        '<div class=\"slide-wrapper\">',\r\n        '<div class=\"slide\"></div>',\r\n        '<div class=\"slide-indicator\"></div>',\r\n        '</div>'\r\n\r\n    ].join('');\r\n\r\n    /**\r\n     * Return mouse position relative to the element el.\r\n     */\r\n\r\n    function mousePosition(evt) {\r\n        // IE:\r\n        if (window.event && window.event.contentOverflow !== undefined) {\r\n            return {\r\n                x: window.event.offsetX,\r\n                y: window.event.offsetY\r\n            };\r\n        }\r\n        // Webkit:\r\n        if (evt.offsetX !== undefined && evt.offsetY !== undefined) {\r\n            return {\r\n                x: evt.offsetX,\r\n                y: evt.offsetY\r\n            };\r\n        }\r\n        // Firefox:\r\n        var wrapper = evt.target.parentNode.parentNode;\r\n        return {\r\n            x: evt.layerX - wrapper.offsetLeft,\r\n            y: evt.layerY - wrapper.offsetTop\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Create SVG element.\r\n     */\r\n\r\n    function $(el, attrs, children) {\r\n        el = document.createElementNS(svgNS, el);\r\n        for (var key in attrs)\r\n            el.setAttribute(key, attrs[key]);\r\n        if (Object.prototype.toString.call(children) != '[object Array]') children = [children];\r\n        var i = 0,\r\n            len = (children[0] && children.length) || 0;\r\n        for (; i < len; i++)\r\n            el.appendChild(children[i]);\r\n        return el;\r\n    }\r\n\r\n    /**\r\n     * Create slide and picker markup depending on the supported technology.\r\n     */\r\n    if (type == 'SVG') {\r\n\r\n        slide = $('svg', {\r\n            xmlns: 'http://www.w3.org/2000/svg',\r\n            version: '1.1',\r\n            width: '100%',\r\n            height: '100%'\r\n        }, [\r\n            $('defs', {},\r\n                $('linearGradient', {\r\n                    id: 'gradient-hsv',\r\n                    x1: '0%',\r\n                    y1: '100%',\r\n                    x2: '0%',\r\n                    y2: '0%'\r\n                }, [\r\n                    $('stop', {\r\n                        offset: '0%',\r\n                        'stop-color': '#FF0000',\r\n                        'stop-opacity': '1'\r\n                    }),\r\n                    $('stop', {\r\n                        offset: '13%',\r\n                        'stop-color': '#FF00FF',\r\n                        'stop-opacity': '1'\r\n                    }),\r\n                    $('stop', {\r\n                        offset: '25%',\r\n                        'stop-color': '#8000FF',\r\n                        'stop-opacity': '1'\r\n                    }),\r\n                    $('stop', {\r\n                        offset: '38%',\r\n                        'stop-color': '#0040FF',\r\n                        'stop-opacity': '1'\r\n                    }),\r\n                    $('stop', {\r\n                        offset: '50%',\r\n                        'stop-color': '#00FFFF',\r\n                        'stop-opacity': '1'\r\n                    }),\r\n                    $('stop', {\r\n                        offset: '63%',\r\n                        'stop-color': '#00FF40',\r\n                        'stop-opacity': '1'\r\n                    }),\r\n                    $('stop', {\r\n                        offset: '75%',\r\n                        'stop-color': '#0BED00',\r\n                        'stop-opacity': '1'\r\n                    }),\r\n                    $('stop', {\r\n                        offset: '88%',\r\n                        'stop-color': '#FFFF00',\r\n                        'stop-opacity': '1'\r\n                    }),\r\n                    $('stop', {\r\n                        offset: '100%',\r\n                        'stop-color': '#FF0000',\r\n                        'stop-opacity': '1'\r\n                    })\r\n                ])\r\n            ),\r\n            $('rect', {\r\n                x: '0',\r\n                y: '0',\r\n                width: '100%',\r\n                height: '100%',\r\n                fill: 'url(#gradient-hsv)'\r\n            })\r\n        ]);\r\n\r\n        picker = $('svg', {\r\n            xmlns: 'http://www.w3.org/2000/svg',\r\n            version: '1.1',\r\n            width: '100%',\r\n            height: '100%'\r\n        }, [\r\n            $('defs', {}, [\r\n                $('linearGradient', {\r\n                    id: 'gradient-black',\r\n                    x1: '0%',\r\n                    y1: '100%',\r\n                    x2: '0%',\r\n                    y2: '0%'\r\n                }, [\r\n                    $('stop', {\r\n                        offset: '0%',\r\n                        'stop-color': '#000000',\r\n                        'stop-opacity': '1'\r\n                    }),\r\n                    $('stop', {\r\n                        offset: '100%',\r\n                        'stop-color': '#CC9A81',\r\n                        'stop-opacity': '0'\r\n                    })\r\n                ]),\r\n                $('linearGradient', {\r\n                    id: 'gradient-white',\r\n                    x1: '0%',\r\n                    y1: '100%',\r\n                    x2: '100%',\r\n                    y2: '100%'\r\n                }, [\r\n                    $('stop', {\r\n                        offset: '0%',\r\n                        'stop-color': '#FFFFFF',\r\n                        'stop-opacity': '1'\r\n                    }),\r\n                    $('stop', {\r\n                        offset: '100%',\r\n                        'stop-color': '#CC9A81',\r\n                        'stop-opacity': '0'\r\n                    })\r\n                ])\r\n            ]),\r\n            $('rect', {\r\n                x: '0',\r\n                y: '0',\r\n                width: '100%',\r\n                height: '100%',\r\n                fill: 'url(#gradient-white)'\r\n            }),\r\n            $('rect', {\r\n                x: '0',\r\n                y: '0',\r\n                width: '100%',\r\n                height: '100%',\r\n                fill: 'url(#gradient-black)'\r\n            })\r\n        ]);\r\n\r\n    } else if (type == 'VML') {\r\n        slide = [\r\n            '<DIV style=\"position: relative; width: 100%; height: 100%\">',\r\n            '<v:rect style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%\" stroked=\"f\" filled=\"t\">',\r\n            '<v:fill type=\"gradient\" method=\"none\" angle=\"0\" color=\"red\" color2=\"red\" colors=\"8519f fuchsia;.25 #8000ff;24903f #0040ff;.5 aqua;41287f #00ff40;.75 #0bed00;57671f yellow\"></v:fill>',\r\n            '</v:rect>',\r\n            '</DIV>'\r\n        ].join('');\r\n\r\n        picker = [\r\n            '<DIV style=\"position: relative; width: 100%; height: 100%\">',\r\n            '<v:rect style=\"position: absolute; left: -1px; top: -1px; width: 101%; height: 101%\" stroked=\"f\" filled=\"t\">',\r\n            '<v:fill type=\"gradient\" method=\"none\" angle=\"270\" color=\"#FFFFFF\" opacity=\"100%\" color2=\"#CC9A81\" o:opacity2=\"0%\"></v:fill>',\r\n            '</v:rect>',\r\n            '<v:rect style=\"position: absolute; left: 0px; top: 0px; width: 100%; height: 101%\" stroked=\"f\" filled=\"t\">',\r\n            '<v:fill type=\"gradient\" method=\"none\" angle=\"0\" color=\"#000000\" opacity=\"100%\" color2=\"#CC9A81\" o:opacity2=\"0%\"></v:fill>',\r\n            '</v:rect>',\r\n            '</DIV>'\r\n        ].join('');\r\n\r\n        if (!document.namespaces['v'])\r\n            document.namespaces.add('v', 'urn:schemas-microsoft-com:vml', '#default#VML');\r\n    }\r\n\r\n    /**\r\n     * Convert HSV representation to RGB HEX string.\r\n     * Credits to http://www.raphaeljs.com\r\n     */\r\n\r\n    function hsv2rgb(hsv) {\r\n        var R, G, B, X, C;\r\n        var h = (hsv.h % 360) / 60;\r\n\r\n        C = hsv.v * hsv.s;\r\n        X = C * (1 - Math.abs(h % 2 - 1));\r\n        R = G = B = hsv.v - C;\r\n\r\n        h = ~~h;\r\n        R += [C, X, 0, 0, X, C][h];\r\n        G += [X, C, C, X, 0, 0][h];\r\n        B += [0, 0, X, C, C, X][h];\r\n\r\n        var r = Math.floor(R * 255);\r\n        var g = Math.floor(G * 255);\r\n        var b = Math.floor(B * 255);\r\n        return {\r\n            r: r,\r\n            g: g,\r\n            b: b,\r\n            hex: \"#\" + (16777216 | b | (g << 8) | (r << 16)).toString(16).slice(1)\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Convert RGB representation to HSV.\r\n     * r, g, b can be either in <0,1> range or <0,255> range.\r\n     * Credits to http://www.raphaeljs.com\r\n     */\r\n\r\n    function rgb2hsv(rgb) {\r\n\r\n        var r = rgb.r;\r\n        var g = rgb.g;\r\n        var b = rgb.b;\r\n\r\n        if (rgb.r > 1 || rgb.g > 1 || rgb.b > 1) {\r\n            r /= 255;\r\n            g /= 255;\r\n            b /= 255;\r\n        }\r\n\r\n        var H, S, V, C;\r\n        V = Math.max(r, g, b);\r\n        C = V - Math.min(r, g, b);\r\n        H = (C == 0 ? null :\r\n            V == r ? (g - b) / C + (g < b ? 6 : 0) :\r\n            V == g ? (b - r) / C + 2 :\r\n            (r - g) / C + 4);\r\n        H = (H % 6) * 60;\r\n        S = C == 0 ? 0 : C / V;\r\n        return {\r\n            h: H,\r\n            s: S,\r\n            v: V\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Return click event handler for the slider.\r\n     * Sets picker background color and calls ctx.callback if provided.\r\n     */\r\n\r\n    function slideListener(ctx, slideElement, pickerElement) {\r\n        return function(evt) {\r\n            evt = evt || window.event;\r\n            var mouse = mousePosition(evt);\r\n            ctx.h = mouse.y / slideElement.offsetHeight * 360 + hueOffset;\r\n            ctx.s = ctx.v = 1;\r\n            var c = hsv2rgb({\r\n                h: ctx.h,\r\n                s: 1,\r\n                v: 1\r\n            });\r\n            pickerElement.style.backgroundColor = c.hex;\r\n            ctx.callback && ctx.callback(c.hex, {\r\n                h: ctx.h - hueOffset,\r\n                s: ctx.s,\r\n                v: ctx.v\r\n            }, {\r\n                r: c.r,\r\n                g: c.g,\r\n                b: c.b\r\n            }, undefined, mouse);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Return click event handler for the picker.\r\n     * Calls ctx.callback if provided.\r\n     */\r\n\r\n    function pickerListener(ctx, pickerElement) {\r\n        return function(evt) {\r\n            evt = evt || window.event;\r\n            var mouse = mousePosition(evt),\r\n                width = pickerElement.offsetWidth,\r\n                height = pickerElement.offsetHeight;\r\n\r\n            ctx.s = mouse.x / width;\r\n            ctx.v = (height - mouse.y) / height;\r\n            var c = hsv2rgb(ctx);\r\n            ctx.callback && ctx.callback(c.hex, {\r\n                h: ctx.h - hueOffset,\r\n                s: ctx.s,\r\n                v: ctx.v\r\n            }, {\r\n                r: c.r,\r\n                g: c.g,\r\n                b: c.b\r\n            }, mouse);\r\n        }\r\n    };\r\n\r\n    var uniqID = 0;\r\n\r\n    /**\r\n     * ColorPicker.\r\n     * @param {DOMElement} slideElement HSV slide element.\r\n     * @param {DOMElement} pickerElement HSV picker element.\r\n     * @param {Function} callback Called whenever the color is changed provided chosen color in RGB HEX format as the only argument.\r\n     */\r\n\r\n    function ColorPicker(slideElement, pickerElement, callback) {\r\n\r\n        if (!(this instanceof ColorPicker)) return new ColorPicker(slideElement, pickerElement, callback);\r\n\r\n        this.h = 0;\r\n        this.s = 1;\r\n        this.v = 1;\r\n\r\n        if (!callback) {\r\n            // call of the form ColorPicker(element, funtion(hex, hsv, rgb) { ... }), i.e. the no-hassle call.\r\n\r\n            var element = slideElement;\r\n            element.innerHTML = colorpickerHTMLSnippet;\r\n\r\n            this.slideElement = element.getElementsByClassName('slide')[0];\r\n            this.pickerElement = element.getElementsByClassName('picker')[0];\r\n            var slideIndicator = element.getElementsByClassName('slide-indicator')[0];\r\n            var pickerIndicator = element.getElementsByClassName('picker-indicator')[0];\r\n\r\n            ColorPicker.fixIndicators(slideIndicator, pickerIndicator);\r\n\r\n            this.callback = function(hex, hsv, rgb, pickerCoordinate, slideCoordinate) {\r\n\r\n                ColorPicker.positionIndicators(slideIndicator, pickerIndicator, slideCoordinate, pickerCoordinate);\r\n\r\n                pickerElement(hex, hsv, rgb);\r\n            };\r\n\r\n        } else {\r\n\r\n            this.callback = callback;\r\n            this.pickerElement = pickerElement;\r\n            this.slideElement = slideElement;\r\n        }\r\n\r\n        if (type == 'SVG') {\r\n\r\n            // Generate uniq IDs for linearGradients so that we don't have the same IDs within one document.\r\n            // Then reference those gradients in the associated rectangles.\r\n\r\n            var slideClone = slide.cloneNode(true);\r\n            var pickerClone = picker.cloneNode(true);\r\n            var hsvGradient = slideClone.getElementById('gradient-hsv');\r\n            var hsvRect = slideClone.getElementsByTagName('rect')[0];\r\n\r\n            if (hsvGradient) {\r\n              hsvGradient.id = 'gradient-hsv-' + uniqID;\r\n              hsvRect.setAttribute('fill', 'url(#' + hsvGradient.id + ')');\r\n            }\r\n\r\n            var blackAndWhiteGradients = [pickerClone.getElementById('gradient-black'), pickerClone.getElementById('gradient-white')];\r\n            var whiteAndBlackRects = pickerClone.getElementsByTagName('rect');\r\n\r\n            if (blackAndWhiteGradients[0]) {\r\n              blackAndWhiteGradients[0].id = 'gradient-black-' + uniqID;\r\n              whiteAndBlackRects[1].setAttribute('fill', 'url(#' + blackAndWhiteGradients[0].id + ')');\r\n            }\r\n\r\n            if (blackAndWhiteGradients[1]) {\r\n              blackAndWhiteGradients[1].id = 'gradient-white-' + uniqID;\r\n              whiteAndBlackRects[0].setAttribute('fill', 'url(#' + blackAndWhiteGradients[1].id + ')');\r\n            }\r\n\r\n            this.slideElement.appendChild(slideClone);\r\n            this.pickerElement.appendChild(pickerClone);\r\n\r\n            uniqID++;\r\n\r\n        } else {\r\n\r\n            this.slideElement.innerHTML = slide;\r\n            this.pickerElement.innerHTML = picker;\r\n        }\r\n\r\n        addEventListener(this.slideElement, 'click', slideListener(this, this.slideElement, this.pickerElement));\r\n        addEventListener(this.pickerElement, 'click', pickerListener(this, this.pickerElement));\r\n\r\n        enableDragging(this, this.slideElement, slideListener(this, this.slideElement, this.pickerElement));\r\n        enableDragging(this, this.pickerElement, pickerListener(this, this.pickerElement));\r\n    };\r\n\r\n    function addEventListener(element, event, listener) {\r\n\r\n        if (element.attachEvent) {\r\n\r\n            element.attachEvent('on' + event, listener);\r\n\r\n        } else if (element.addEventListener) {\r\n\r\n            element.addEventListener(event, listener, false);\r\n        }\r\n    }\r\n\r\n    function removeEventListener(element, event, listener) {\r\n\r\n        if (element.attachEvent) {\r\n\r\n            element.detachEvent('on' + event, listener);\r\n\r\n        } else if (element.addEventListener) {\r\n\r\n            element.removeEventListener(event, listener, false);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Enable drag&drop color selection.\r\n     * @param {object} ctx ColorPicker instance.\r\n     * @param {DOMElement} element HSV slide element or HSV picker element.\r\n     * @param {Function} listener Function that will be called whenever mouse is dragged over the element with event object as argument.\r\n     */\r\n\r\n    function enableDragging(ctx, element, listener) {\r\n\r\n        var mousedown = false;\r\n\r\n        addEventListener(element, 'mousedown', function(evt) {\r\n            mousedown = true;\r\n        });\r\n        addEventListener(element, 'mouseup', function(evt) {\r\n            mousedown = false;\r\n        });\r\n        addEventListener(element, 'mouseout', function(evt) {\r\n            mousedown = false;\r\n        });\r\n        addEventListener(element, 'mousemove', function(evt) {\r\n\r\n            if (mousedown) {\r\n\r\n                listener(evt);\r\n            }\r\n        });\r\n    }\r\n\r\n    function disableDragging(ctx, element, listener) {\r\n        removeEventListener(element, 'mousedown');\r\n        removeEventListener(element, 'mouseup');\r\n        removeEventListener(element, 'mouseout');\r\n        removeEventListener(element, 'mousemove');\r\n    }\r\n\r\n\r\n    ColorPicker.hsv2rgb = function(hsv) {\r\n        var rgbHex = hsv2rgb(hsv);\r\n        delete rgbHex.hex;\r\n        return rgbHex;\r\n    };\r\n\r\n    ColorPicker.hsv2hex = function(hsv) {\r\n        return hsv2rgb(hsv).hex;\r\n    };\r\n\r\n    ColorPicker.rgb2hsv = rgb2hsv;\r\n\r\n    ColorPicker.rgb2hex = function(rgb) {\r\n        return hsv2rgb(rgb2hsv(rgb)).hex;\r\n    };\r\n\r\n    ColorPicker.hex2hsv = function(hex) {\r\n        return rgb2hsv(ColorPicker.hex2rgb(hex));\r\n    };\r\n\r\n    ColorPicker.hex2rgb = function(hex) {\r\n        return {\r\n            r: parseInt(hex.substr(1, 2), 16),\r\n            g: parseInt(hex.substr(3, 2), 16),\r\n            b: parseInt(hex.substr(5, 2), 16)\r\n        };\r\n    };\r\n\r\n    /**\r\n     * Sets color of the picker in hsv/rgb/hex format.\r\n     * @param {object} ctx ColorPicker instance.\r\n     * @param {object} hsv Object of the form: { h: <hue>, s: <saturation>, v: <value> }.\r\n     * @param {object} rgb Object of the form: { r: <red>, g: <green>, b: <blue> }.\r\n     * @param {string} hex String of the form: #RRGGBB.\r\n     */\r\n\r\n    function setColor(ctx, hsv, rgb, hex) {\r\n        ctx.h = hsv.h % 360;\r\n        ctx.s = hsv.s;\r\n        ctx.v = hsv.v;\r\n\r\n        var c = hsv2rgb(ctx);\r\n\r\n        var mouseSlide = {\r\n            y: (ctx.h * ctx.slideElement.offsetHeight) / 360,\r\n            x: 0 // not important\r\n        };\r\n\r\n        var pickerHeight = ctx.pickerElement.offsetHeight;\r\n\r\n        var mousePicker = {\r\n            x: ctx.s * ctx.pickerElement.offsetWidth,\r\n            y: pickerHeight - ctx.v * pickerHeight\r\n        };\r\n\r\n        ctx.pickerElement.style.backgroundColor = hsv2rgb({\r\n            h: ctx.h,\r\n            s: 1,\r\n            v: 1\r\n        }).hex;\r\n        ctx.callback && ctx.callback(hex || c.hex, {\r\n            h: ctx.h,\r\n            s: ctx.s,\r\n            v: ctx.v\r\n        }, rgb || {\r\n            r: c.r,\r\n            g: c.g,\r\n            b: c.b\r\n        }, mousePicker, mouseSlide);\r\n\r\n        return ctx;\r\n    };\r\n\r\n    /**\r\n     * Sets color of the picker in rgb format.\r\n     * @param {object} rgb Object of the form: { r: <red>, g: <green>, b: <blue> }.\r\n     */\r\n    ColorPicker.prototype.setHsv = function(hsv) {\r\n        return setColor(this, hsv);\r\n    };\r\n\r\n    /**\r\n     * Sets color of the picker in rgb format.\r\n     * @param {object} rgb Object of the form: { r: <red>, g: <green>, b: <blue> }.\r\n     */\r\n    ColorPicker.prototype.setRgb = function(rgb) {\r\n        return setColor(this, rgb2hsv(rgb), rgb);\r\n    };\r\n\r\n    /**\r\n     * Sets color of the picker in hex format.\r\n     * @param {string} hex Hex color format #RRGGBB.\r\n     */\r\n    ColorPicker.prototype.setHex = function(hex) {\r\n        return setColor(this, ColorPicker.hex2hsv(hex), undefined, hex);\r\n    };\r\n\r\n    /**\r\n     * Helper to position indicators.\r\n     * @param {HTMLElement} slideIndicator DOM element representing the indicator of the slide area.\r\n     * @param {HTMLElement} pickerIndicator DOM element representing the indicator of the picker area.\r\n     * @param {object} mouseSlide Coordinates of the mouse cursor in the slide area.\r\n     * @param {object} mousePicker Coordinates of the mouse cursor in the picker area.\r\n     */\r\n    ColorPicker.positionIndicators = function(slideIndicator, pickerIndicator, mouseSlide, mousePicker) {\r\n\r\n        if (mouseSlide) {\r\n            pickerIndicator.style.left = 'auto';\r\n            pickerIndicator.style.right = '0px';\r\n            pickerIndicator.style.top = '0px';\r\n            slideIndicator.style.top = (mouseSlide.y - slideIndicator.offsetHeight / 2) + 'px';\r\n        }\r\n        if (mousePicker) {\r\n            pickerIndicator.style.top = (mousePicker.y - pickerIndicator.offsetHeight / 2) + 'px';\r\n            pickerIndicator.style.left = (mousePicker.x - pickerIndicator.offsetWidth / 2) + 'px';\r\n        }\r\n    };\r\n\r\n    ColorPicker.prototype.unBind = function() {\r\n        removeEventListener(this.slideElement, 'click', slideListener(this, this.slideElement, this.pickerElement));\r\n        removeEventListener(this.pickerElement, 'click', pickerListener(this, this.pickerElement));\r\n\r\n        disableDragging(this, this.slideElement, slideListener(this, this.slideElement, this.pickerElement));\r\n        disableDragging(this, this.pickerElement, pickerListener(this, this.pickerElement));\r\n    }\r\n\r\n    /**\r\n     * Helper to fix indicators - this is recommended (and needed) for dragable color selection (see enabledDragging()).\r\n     */\r\n    ColorPicker.fixIndicators = function(slideIndicator, pickerIndicator) {\r\n\r\n        pickerIndicator.style.pointerEvents = 'none';\r\n        slideIndicator.style.pointerEvents = 'none';\r\n    };\r\n\r\n    window.ColorPicker = ColorPicker;\r\n\r\n})(window, window.document);\r\n","/*\n\tLeaflet.draw, a plugin that adds drawing and editing tools to Leaflet powered maps.\n\t(c) 2012-2013, Jacob Toye, Smartrak\n\n\thttps://github.com/Leaflet/Leaflet.draw\n\thttp://leafletjs.com\n\thttps://github.com/jacobtoye\n*/\n(function (window, document, undefined) {/*\n * Leaflet.draw assumes that you have already included the Leaflet library.\n */\n\nL.drawVersion = '0.2.3';\n\nL.drawLocal = {\n\tdraw: {\n\t\ttoolbar: {\n\t\t\tactions: {\n\t\t\t\ttitle: 'Cancel drawing',\n\t\t\t\ttext: 'Cancel'\n\t\t\t},\n\t\t\tundo: {\n\t\t\t\ttitle: 'Delete last point drawn',\n\t\t\t\ttext: 'Delete last point'\n\t\t\t},\n\t\t\tbuttons: {\n\t\t\t\tpolyline: 'Draw a polyline',\n\t\t\t\tpolygon: 'Draw a polygon',\n\t\t\t\trectangle: 'Draw a rectangle',\n\t\t\t\tcircle: 'Draw a circle',\n\t\t\t\tmarker: 'Draw a marker'\n\t\t\t}\n\t\t},\n\t\thandlers: {\n\t\t\tcircle: {\n\t\t\t\ttooltip: {\n\t\t\t\t\tstart: 'Click and drag to draw circle.'\n\t\t\t\t}\n\t\t\t},\n\t\t\tmarker: {\n\t\t\t\ttooltip: {\n\t\t\t\t\tstart: 'Click map to place marker.'\n\t\t\t\t}\n\t\t\t},\n\t\t\tpolygon: {\n\t\t\t\ttooltip: {\n\t\t\t\t\tstart: 'Click to start drawing shape.',\n\t\t\t\t\tcont: 'Click to continue drawing shape.',\n\t\t\t\t\tend: 'Click first point to close this shape.'\n\t\t\t\t}\n\t\t\t},\n\t\t\tpolyline: {\n\t\t\t\terror: '<strong>Error:</strong> shape edges cannot cross!',\n\t\t\t\ttooltip: {\n\t\t\t\t\tstart: 'Click to start drawing line.',\n\t\t\t\t\tcont: 'Click to continue drawing line.',\n\t\t\t\t\tend: 'Click last point to finish line.'\n\t\t\t\t}\n\t\t\t},\n\t\t\trectangle: {\n\t\t\t\ttooltip: {\n\t\t\t\t\tstart: 'Click and drag to draw rectangle.'\n\t\t\t\t}\n\t\t\t},\n\t\t\tsimpleshape: {\n\t\t\t\ttooltip: {\n\t\t\t\t\tend: 'Release mouse to finish drawing.'\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\tedit: {\n\t\ttoolbar: {\n\t\t\tactions: {\n\t\t\t\tsave: {\n\t\t\t\t\ttitle: 'Save changes.',\n\t\t\t\t\ttext: 'Save'\n\t\t\t\t},\n\t\t\t\tcancel: {\n\t\t\t\t\ttitle: 'Cancel editing, discards all changes.',\n\t\t\t\t\ttext: 'Cancel'\n\t\t\t\t}\n\t\t\t},\n\t\t\tbuttons: {\n\t\t\t\tedit: 'Edit layers.',\n\t\t\t\teditDisabled: 'No layers to edit.',\n\t\t\t\tremove: 'Delete layers.',\n\t\t\t\tremoveDisabled: 'No layers to delete.'\n\t\t\t}\n\t\t},\n\t\thandlers: {\n\t\t\tedit: {\n\t\t\t\ttooltip: {\n\t\t\t\t\ttext: 'Drag handles, or marker to edit feature.',\n\t\t\t\t\tsubtext: 'Click cancel to undo changes.'\n\t\t\t\t}\n\t\t\t},\n\t\t\tremove: {\n\t\t\t\ttooltip: {\n\t\t\t\t\ttext: 'Click on a feature to remove'\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n};\n\n\nL.Draw = {};\n\nL.Draw.Feature = L.Handler.extend({\n\tincludes: L.Mixin.Events,\n\n\tinitialize: function (map, options) {\n\t\tthis._map = map;\n\t\tthis._container = map._container;\n\t\tthis._overlayPane = map._panes.overlayPane;\n\t\tthis._popupPane = map._panes.popupPane;\n\n\t\t// Merge default shapeOptions options with custom shapeOptions\n\t\tif (options && options.shapeOptions) {\n\t\t\toptions.shapeOptions = L.Util.extend({}, this.options.shapeOptions, options.shapeOptions);\n\t\t}\n\t\tL.setOptions(this, options);\n\t},\n\n\tenable: function () {\n\t\tif (this._enabled) { return; }\n\n\t\tthis.fire('enabled', { handler: this.type });\n\n\t\tthis._map.fire('draw:drawstart', { layerType: this.type });\n\n\t\tL.Handler.prototype.enable.call(this);\n\t},\n\n\tdisable: function () {\n\t\tif (!this._enabled) { return; }\n\n\t\tL.Handler.prototype.disable.call(this);\n\n\t\tthis._map.fire('draw:drawstop', { layerType: this.type });\n\n\t\tthis.fire('disabled', { handler: this.type });\n\t},\n\n\taddHooks: function () {\n\t\tvar map = this._map;\n\n\t\tif (map) {\n\t\t\tL.DomUtil.disableTextSelection();\n\n\t\t\tmap.getContainer().focus();\n\n\t\t\tthis._tooltip = new L.Tooltip(this._map);\n\n\t\t\tL.DomEvent.on(this._container, 'keyup', this._cancelDrawing, this);\n\t\t}\n\t},\n\n\tremoveHooks: function () {\n\t\tif (this._map) {\n\t\t\tL.DomUtil.enableTextSelection();\n\n\t\t\tthis._tooltip.dispose();\n\t\t\tthis._tooltip = null;\n\n\t\t\tL.DomEvent.off(this._container, 'keyup', this._cancelDrawing, this);\n\t\t}\n\t},\n\n\tsetOptions: function (options) {\n\t\tL.setOptions(this, options);\n\t},\n\n\t_fireCreatedEvent: function (layer) {\n\t\tthis._map.fire('draw:created', { layer: layer, layerType: this.type });\n\t},\n\n\t// Cancel drawing when the escape key is pressed\n\t_cancelDrawing: function (e) {\n\t\tif (e.keyCode === 27) {\n\t\t\tthis.disable();\n\t\t}\n\t}\n});\n\nL.Draw.Polyline = L.Draw.Feature.extend({\n\tstatics: {\n\t\tTYPE: 'polyline'\n\t},\n\n\tPoly: L.Polyline,\n\n\toptions: {\n\t\tallowIntersection: true,\n\t\trepeatMode: false,\n\t\tdrawError: {\n\t\t\tcolor: '#b00b00',\n\t\t\ttimeout: 2500\n\t\t},\n\t\ticon: new L.DivIcon({\n\t\t\ticonSize: new L.Point(8, 8),\n\t\t\tclassName: 'leaflet-div-icon leaflet-editing-icon'\n\t\t}),\n\t\tguidelineDistance: 20,\n\t\tmaxGuideLineLength: 4000,\n\t\tshapeOptions: {\n\t\t\tstroke: true,\n\t\t\tcolor: '#f06eaa',\n\t\t\tweight: 4,\n\t\t\topacity: 0.5,\n\t\t\tfill: false,\n\t\t\tclickable: true\n\t\t},\n\t\tmetric: true, // Whether to use the metric meaurement system or imperial\n\t\tshowLength: true, // Whether to display distance in the tooltip\n\t\tzIndexOffset: 2000 // This should be > than the highest z-index any map layers\n\t},\n\n\tinitialize: function (map, options) {\n\t\t// Need to set this here to ensure the correct message is used.\n\t\tthis.options.drawError.message = L.drawLocal.draw.handlers.polyline.error;\n\n\t\t// Merge default drawError options with custom options\n\t\tif (options && options.drawError) {\n\t\t\toptions.drawError = L.Util.extend({}, this.options.drawError, options.drawError);\n\t\t}\n\n\t\t// Save the type so super can fire, need to do this as cannot do this.TYPE :(\n\t\tthis.type = L.Draw.Polyline.TYPE;\n\n\t\tL.Draw.Feature.prototype.initialize.call(this, map, options);\n\t},\n\n\taddHooks: function () {\n\t\tL.Draw.Feature.prototype.addHooks.call(this);\n\t\tif (this._map) {\n\t\t\tthis._markers = [];\n\n\t\t\tthis._markerGroup = new L.LayerGroup();\n\t\t\tthis._map.addLayer(this._markerGroup);\n\n\t\t\tthis._poly = new L.Polyline([], this.options.shapeOptions);\n\n\t\t\tthis._tooltip.updateContent(this._getTooltipText());\n\n\t\t\t// Make a transparent marker that will used to catch click events. These click\n\t\t\t// events will create the vertices. We need to do this so we can ensure that\n\t\t\t// we can create vertices over other map layers (markers, vector layers). We\n\t\t\t// also do not want to trigger any click handlers of objects we are clicking on\n\t\t\t// while drawing.\n\t\t\tif (!this._mouseMarker) {\n\t\t\t\tthis._mouseMarker = L.marker(this._map.getCenter(), {\n\t\t\t\t\ticon: L.divIcon({\n\t\t\t\t\t\tclassName: 'leaflet-mouse-marker',\n\t\t\t\t\t\ticonAnchor: [20, 20],\n\t\t\t\t\t\ticonSize: [40, 40]\n\t\t\t\t\t}),\n\t\t\t\t\topacity: 0,\n\t\t\t\t\tzIndexOffset: this.options.zIndexOffset\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis._mouseMarker\n\t\t\t\t.on('mousedown', this._onMouseDown, this)\n\t\t\t\t.addTo(this._map);\n\n\t\t\tthis._map\n\t\t\t\t.on('mousemove', this._onMouseMove, this)\n\t\t\t\t.on('mouseup', this._onMouseUp, this)\n\t\t\t\t.on('zoomend', this._onZoomEnd, this);\n\t\t}\n\t},\n\n\tremoveHooks: function () {\n\t\tL.Draw.Feature.prototype.removeHooks.call(this);\n\n\t\tthis._clearHideErrorTimeout();\n\n\t\tthis._cleanUpShape();\n\n\t\t// remove markers from map\n\t\tthis._map.removeLayer(this._markerGroup);\n\t\tdelete this._markerGroup;\n\t\tdelete this._markers;\n\n\t\tthis._map.removeLayer(this._poly);\n\t\tdelete this._poly;\n\n\t\tthis._mouseMarker\n\t\t\t.off('mousedown', this._onMouseDown, this)\n\t\t\t.off('mouseup', this._onMouseUp, this);\n\t\tthis._map.removeLayer(this._mouseMarker);\n\t\tdelete this._mouseMarker;\n\n\t\t// clean up DOM\n\t\tthis._clearGuides();\n\n\t\tthis._map\n\t\t\t.off('mousemove', this._onMouseMove, this)\n\t\t\t.off('zoomend', this._onZoomEnd, this);\n\t},\n\n\tdeleteLastVertex: function () {\n\t\tif (this._markers.length <= 1) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar lastMarker = this._markers.pop(),\n\t\t\tpoly = this._poly,\n\t\t\tlatlng = this._poly.spliceLatLngs(poly.getLatLngs().length - 1, 1)[0];\n\n\t\tthis._markerGroup.removeLayer(lastMarker);\n\n\t\tif (poly.getLatLngs().length < 2) {\n\t\t\tthis._map.removeLayer(poly);\n\t\t}\n\n\t\tthis._vertexChanged(latlng, false);\n\t},\n\n\taddVertex: function (latlng) {\n\t\tvar markersLength = this._markers.length;\n\n\t\tif (markersLength > 0 && !this.options.allowIntersection && this._poly.newLatLngIntersects(latlng)) {\n\t\t\tthis._showErrorTooltip();\n\t\t\treturn;\n\t\t}\n\t\telse if (this._errorShown) {\n\t\t\tthis._hideErrorTooltip();\n\t\t}\n\n\t\tthis._markers.push(this._createMarker(latlng));\n\n\t\tthis._poly.addLatLng(latlng);\n\n\t\tif (this._poly.getLatLngs().length === 2) {\n\t\t\tthis._map.addLayer(this._poly);\n\t\t}\n\n\t\tthis._vertexChanged(latlng, true);\n\t},\n\n\t_finishShape: function () {\n\t\tvar intersects = this._poly.newLatLngIntersects(this._poly.getLatLngs()[0], true);\n\n\t\tif ((!this.options.allowIntersection && intersects) || !this._shapeIsValid()) {\n\t\t\tthis._showErrorTooltip();\n\t\t\treturn;\n\t\t}\n\n\t\tthis._fireCreatedEvent();\n\t\tthis.disable();\n\t\tif (this.options.repeatMode) {\n\t\t\tthis.enable();\n\t\t}\n\t},\n\n\t//Called to verify the shape is valid when the user tries to finish it\n\t//Return false if the shape is not valid\n\t_shapeIsValid: function () {\n\t\treturn true;\n\t},\n\n\t_onZoomEnd: function () {\n\t\tthis._updateGuide();\n\t},\n\n\t_onMouseMove: function (e) {\n\t\tvar newPos = e.layerPoint,\n\t\t\tlatlng = e.latlng;\n\n\t\t// Save latlng\n\t\t// should this be moved to _updateGuide() ?\n\t\tthis._currentLatLng = latlng;\n\n\t\tthis._updateTooltip(latlng);\n\n\t\t// Update the guide line\n\t\tthis._updateGuide(newPos);\n\n\t\t// Update the mouse marker position\n\t\tthis._mouseMarker.setLatLng(latlng);\n\n\t\tL.DomEvent.preventDefault(e.originalEvent);\n\t},\n\n\t_vertexChanged: function (latlng, added) {\n\t\tthis._updateFinishHandler();\n\n\t\tthis._updateRunningMeasure(latlng, added);\n\n\t\tthis._clearGuides();\n\n\t\tthis._updateTooltip();\n\t},\n\n\t_onMouseDown: function (e) {\n\t\tvar originalEvent = e.originalEvent;\n\t\tthis._mouseDownOrigin = L.point(originalEvent.clientX, originalEvent.clientY);\n\t},\n\n\t_onMouseUp: function (e) {\n\t\tif (this._mouseDownOrigin) {\n\t\t\t// We detect clicks within a certain tolerance, otherwise let it\n\t\t\t// be interpreted as a drag by the map\n\t\t\tvar distance = L.point(e.originalEvent.clientX, e.originalEvent.clientY)\n\t\t\t\t.distanceTo(this._mouseDownOrigin);\n\t\t\tif (Math.abs(distance) < 9 * (window.devicePixelRatio || 1)) {\n\t\t\t\tthis.addVertex(e.latlng);\n\t\t\t}\n\t\t}\n\t\tthis._mouseDownOrigin = null;\n\t},\n\n\t_updateFinishHandler: function () {\n\t\tvar markerCount = this._markers.length;\n\t\t// The last marker should have a click handler to close the polyline\n\t\tif (markerCount > 1) {\n\t\t\tthis._markers[markerCount - 1].on('click', this._finishShape, this);\n\t\t}\n\n\t\t// Remove the old marker click handler (as only the last point should close the polyline)\n\t\tif (markerCount > 2) {\n\t\t\tthis._markers[markerCount - 2].off('click', this._finishShape, this);\n\t\t}\n\t},\n\n\t_createMarker: function (latlng) {\n\t\tvar marker = new L.Marker(latlng, {\n\t\t\ticon: this.options.icon,\n\t\t\tzIndexOffset: this.options.zIndexOffset * 2\n\t\t});\n\n\t\tthis._markerGroup.addLayer(marker);\n\n\t\treturn marker;\n\t},\n\n\t_updateGuide: function (newPos) {\n\t\tvar markerCount = this._markers.length;\n\n\t\tif (markerCount > 0) {\n\t\t\tnewPos = newPos || this._map.latLngToLayerPoint(this._currentLatLng);\n\n\t\t\t// draw the guide line\n\t\t\tthis._clearGuides();\n\t\t\tthis._drawGuide(\n\t\t\t\tthis._map.latLngToLayerPoint(this._markers[markerCount - 1].getLatLng()),\n\t\t\t\tnewPos\n\t\t\t);\n\t\t}\n\t},\n\n\t_updateTooltip: function (latLng) {\n\t\tvar text = this._getTooltipText();\n\n\t\tif (latLng) {\n\t\t\tthis._tooltip.updatePosition(latLng);\n\t\t}\n\n\t\tif (!this._errorShown) {\n\t\t\tthis._tooltip.updateContent(text);\n\t\t}\n\t},\n\n\t_drawGuide: function (pointA, pointB) {\n\t\tvar length = Math.floor(Math.sqrt(Math.pow((pointB.x - pointA.x), 2) + Math.pow((pointB.y - pointA.y), 2))),\n\t\t\tguidelineDistance = this.options.guidelineDistance,\n\t\t\tmaxGuideLineLength = this.options.maxGuideLineLength,\n\t\t\t// Only draw a guideline with a max length\n\t\t\ti = length > maxGuideLineLength ? length - maxGuideLineLength : guidelineDistance,\n\t\t\tfraction,\n\t\t\tdashPoint,\n\t\t\tdash;\n\n\t\t//create the guides container if we haven't yet\n\t\tif (!this._guidesContainer) {\n\t\t\tthis._guidesContainer = L.DomUtil.create('div', 'leaflet-draw-guides', this._overlayPane);\n\t\t}\n\n\t\t//draw a dash every GuildeLineDistance\n\t\tfor (; i < length; i += this.options.guidelineDistance) {\n\t\t\t//work out fraction along line we are\n\t\t\tfraction = i / length;\n\n\t\t\t//calculate new x,y point\n\t\t\tdashPoint = {\n\t\t\t\tx: Math.floor((pointA.x * (1 - fraction)) + (fraction * pointB.x)),\n\t\t\t\ty: Math.floor((pointA.y * (1 - fraction)) + (fraction * pointB.y))\n\t\t\t};\n\n\t\t\t//add guide dash to guide container\n\t\t\tdash = L.DomUtil.create('div', 'leaflet-draw-guide-dash', this._guidesContainer);\n\t\t\tdash.style.backgroundColor =\n\t\t\t\t!this._errorShown ? this.options.shapeOptions.color : this.options.drawError.color;\n\n\t\t\tL.DomUtil.setPosition(dash, dashPoint);\n\t\t}\n\t},\n\n\t_updateGuideColor: function (color) {\n\t\tif (this._guidesContainer) {\n\t\t\tfor (var i = 0, l = this._guidesContainer.childNodes.length; i < l; i++) {\n\t\t\t\tthis._guidesContainer.childNodes[i].style.backgroundColor = color;\n\t\t\t}\n\t\t}\n\t},\n\n\t// removes all child elements (guide dashes) from the guides container\n\t_clearGuides: function () {\n\t\tif (this._guidesContainer) {\n\t\t\twhile (this._guidesContainer.firstChild) {\n\t\t\t\tthis._guidesContainer.removeChild(this._guidesContainer.firstChild);\n\t\t\t}\n\t\t}\n\t},\n\n\t_getTooltipText: function () {\n\t\tvar showLength = this.options.showLength,\n\t\t\tlabelText, distanceStr;\n\n\t\tif (this._markers.length === 0) {\n\t\t\tlabelText = {\n\t\t\t\ttext: L.drawLocal.draw.handlers.polyline.tooltip.start\n\t\t\t};\n\t\t} else {\n\t\t\tdistanceStr = showLength ? this._getMeasurementString() : '';\n\n\t\t\tif (this._markers.length === 1) {\n\t\t\t\tlabelText = {\n\t\t\t\t\ttext: L.drawLocal.draw.handlers.polyline.tooltip.cont,\n\t\t\t\t\tsubtext: distanceStr\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tlabelText = {\n\t\t\t\t\ttext: L.drawLocal.draw.handlers.polyline.tooltip.end,\n\t\t\t\t\tsubtext: distanceStr\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\treturn labelText;\n\t},\n\n\t_updateRunningMeasure: function (latlng, added) {\n\t\tvar markersLength = this._markers.length,\n\t\t\tpreviousMarkerIndex, distance;\n\n\t\tif (this._markers.length === 1) {\n\t\t\tthis._measurementRunningTotal = 0;\n\t\t} else {\n\t\t\tpreviousMarkerIndex = markersLength - (added ? 2 : 1);\n\t\t\tdistance = latlng.distanceTo(this._markers[previousMarkerIndex].getLatLng());\n\n\t\t\tthis._measurementRunningTotal += distance * (added ? 1 : -1);\n\t\t}\n\t},\n\n\t_getMeasurementString: function () {\n\t\tvar currentLatLng = this._currentLatLng,\n\t\t\tpreviousLatLng = this._markers[this._markers.length - 1].getLatLng(),\n\t\t\tdistance;\n\n\t\t// calculate the distance from the last fixed point to the mouse position\n\t\tdistance = this._measurementRunningTotal + currentLatLng.distanceTo(previousLatLng);\n\n\t\treturn L.GeometryUtil.readableDistance(distance, this.options.metric);\n\t},\n\n\t_showErrorTooltip: function () {\n\t\tthis._errorShown = true;\n\n\t\t// Update tooltip\n\t\tthis._tooltip\n\t\t\t.showAsError()\n\t\t\t.updateContent({ text: this.options.drawError.message });\n\n\t\t// Update shape\n\t\tthis._updateGuideColor(this.options.drawError.color);\n\t\tthis._poly.setStyle({ color: this.options.drawError.color });\n\n\t\t// Hide the error after 2 seconds\n\t\tthis._clearHideErrorTimeout();\n\t\tthis._hideErrorTimeout = setTimeout(L.Util.bind(this._hideErrorTooltip, this), this.options.drawError.timeout);\n\t},\n\n\t_hideErrorTooltip: function () {\n\t\tthis._errorShown = false;\n\n\t\tthis._clearHideErrorTimeout();\n\n\t\t// Revert tooltip\n\t\tthis._tooltip\n\t\t\t.removeError()\n\t\t\t.updateContent(this._getTooltipText());\n\n\t\t// Revert shape\n\t\tthis._updateGuideColor(this.options.shapeOptions.color);\n\t\tthis._poly.setStyle({ color: this.options.shapeOptions.color });\n\t},\n\n\t_clearHideErrorTimeout: function () {\n\t\tif (this._hideErrorTimeout) {\n\t\t\tclearTimeout(this._hideErrorTimeout);\n\t\t\tthis._hideErrorTimeout = null;\n\t\t}\n\t},\n\n\t_cleanUpShape: function () {\n\t\tif (this._markers.length > 1) {\n\t\t\tthis._markers[this._markers.length - 1].off('click', this._finishShape, this);\n\t\t}\n\t},\n\n\t_fireCreatedEvent: function () {\n\t\tvar poly = new this.Poly(this._poly.getLatLngs(), this.options.shapeOptions);\n\t\tL.Draw.Feature.prototype._fireCreatedEvent.call(this, poly);\n\t}\n});\n\n\nL.Draw.Polygon = L.Draw.Polyline.extend({\n\tstatics: {\n\t\tTYPE: 'polygon'\n\t},\n\n\tPoly: L.Polygon,\n\n\toptions: {\n\t\tshowArea: false,\n\t\tshapeOptions: {\n\t\t\tstroke: true,\n\t\t\tcolor: '#f06eaa',\n\t\t\tweight: 4,\n\t\t\topacity: 0.5,\n\t\t\tfill: true,\n\t\t\tfillColor: null, //same as color by default\n\t\t\tfillOpacity: 0.2,\n\t\t\tclickable: true\n\t\t}\n\t},\n\n\tinitialize: function (map, options) {\n\t\tL.Draw.Polyline.prototype.initialize.call(this, map, options);\n\n\t\t// Save the type so super can fire, need to do this as cannot do this.TYPE :(\n\t\tthis.type = L.Draw.Polygon.TYPE;\n\t},\n\n\t_updateFinishHandler: function () {\n\t\tvar markerCount = this._markers.length;\n\n\t\t// The first marker should have a click handler to close the polygon\n\t\tif (markerCount === 1) {\n\t\t\tthis._markers[0].on('click', this._finishShape, this);\n\t\t}\n\n\t\t// Add and update the double click handler\n\t\tif (markerCount > 2) {\n\t\t\tthis._markers[markerCount - 1].on('dblclick', this._finishShape, this);\n\t\t\t// Only need to remove handler if has been added before\n\t\t\tif (markerCount > 3) {\n\t\t\t\tthis._markers[markerCount - 2].off('dblclick', this._finishShape, this);\n\t\t\t}\n\t\t}\n\t},\n\n\t_getTooltipText: function () {\n\t\tvar text, subtext;\n\n\t\tif (this._markers.length === 0) {\n\t\t\ttext = L.drawLocal.draw.handlers.polygon.tooltip.start;\n\t\t} else if (this._markers.length < 3) {\n\t\t\ttext = L.drawLocal.draw.handlers.polygon.tooltip.cont;\n\t\t} else {\n\t\t\ttext = L.drawLocal.draw.handlers.polygon.tooltip.end;\n\t\t\tsubtext = this._getMeasurementString();\n\t\t}\n\n\t\treturn {\n\t\t\ttext: text,\n\t\t\tsubtext: subtext\n\t\t};\n\t},\n\n\t_getMeasurementString: function () {\n\t\tvar area = this._area;\n\n\t\tif (!area) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn L.GeometryUtil.readableArea(area, this.options.metric);\n\t},\n\n\t_shapeIsValid: function () {\n\t\treturn this._markers.length >= 3;\n\t},\n\n\t_vertexAdded: function () {\n\t\t// Check to see if we should show the area\n\t\tif (this.options.allowIntersection || !this.options.showArea) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar latLngs = this._poly.getLatLngs();\n\n\t\tthis._area = L.GeometryUtil.geodesicArea(latLngs);\n\t},\n\n\t_cleanUpShape: function () {\n\t\tvar markerCount = this._markers.length;\n\n\t\tif (markerCount > 0) {\n\t\t\tthis._markers[0].off('click', this._finishShape, this);\n\n\t\t\tif (markerCount > 2) {\n\t\t\t\tthis._markers[markerCount - 1].off('dblclick', this._finishShape, this);\n\t\t\t}\n\t\t}\n\t}\n});\n\n\nL.SimpleShape = {};\n\nL.Draw.SimpleShape = L.Draw.Feature.extend({\n\toptions: {\n\t\trepeatMode: false\n\t},\n\n\tinitialize: function (map, options) {\n\t\tthis._endLabelText = L.drawLocal.draw.handlers.simpleshape.tooltip.end;\n\n\t\tL.Draw.Feature.prototype.initialize.call(this, map, options);\n\t},\n\n\taddHooks: function () {\n\t\tL.Draw.Feature.prototype.addHooks.call(this);\n\t\tif (this._map) {\n\t\t\tthis._mapDraggable = this._map.dragging.enabled();\n\n\t\t\tif (this._mapDraggable) {\n\t\t\t\tthis._map.dragging.disable();\n\t\t\t}\n\n\t\t\t//TODO refactor: move cursor to styles\n\t\t\tthis._container.style.cursor = 'crosshair';\n\n\t\t\tthis._tooltip.updateContent({ text: this._initialLabelText });\n\n\t\t\tthis._map\n\t\t\t\t.on('mousedown', this._onMouseDown, this)\n\t\t\t\t.on('mousemove', this._onMouseMove, this);\n\t\t}\n\t},\n\n\tremoveHooks: function () {\n\t\tL.Draw.Feature.prototype.removeHooks.call(this);\n\t\tif (this._map) {\n\t\t\tif (this._mapDraggable) {\n\t\t\t\tthis._map.dragging.enable();\n\t\t\t}\n\n\t\t\t//TODO refactor: move cursor to styles\n\t\t\tthis._container.style.cursor = '';\n\n\t\t\tthis._map\n\t\t\t\t.off('mousedown', this._onMouseDown, this)\n\t\t\t\t.off('mousemove', this._onMouseMove, this);\n\n\t\t\tL.DomEvent.off(document, 'mouseup', this._onMouseUp, this);\n\n\t\t\t// If the box element doesn't exist they must not have moved the mouse, so don't need to destroy/return\n\t\t\tif (this._shape) {\n\t\t\t\tthis._map.removeLayer(this._shape);\n\t\t\t\tdelete this._shape;\n\t\t\t}\n\t\t}\n\t\tthis._isDrawing = false;\n\t},\n\n\t_onMouseDown: function (e) {\n\t\tthis._isDrawing = true;\n\t\tthis._startLatLng = e.latlng;\n\n\t\tL.DomEvent\n\t\t\t.on(document, 'mouseup', this._onMouseUp, this)\n\t\t\t.preventDefault(e.originalEvent);\n\t},\n\n\t_onMouseMove: function (e) {\n\t\tvar latlng = e.latlng;\n\n\t\tthis._tooltip.updatePosition(latlng);\n\t\tif (this._isDrawing) {\n\t\t\tthis._tooltip.updateContent({ text: this._endLabelText });\n\t\t\tthis._drawShape(latlng);\n\t\t}\n\t},\n\n\t_onMouseUp: function () {\n\t\tif (this._shape) {\n\t\t\tthis._fireCreatedEvent();\n\t\t}\n\n\t\tthis.disable();\n\t\tif (this.options.repeatMode) {\n\t\t\tthis.enable();\n\t\t}\n\t}\n});\n\nL.Draw.Rectangle = L.Draw.SimpleShape.extend({\n\tstatics: {\n\t\tTYPE: 'rectangle'\n\t},\n\n\toptions: {\n\t\tshapeOptions: {\n\t\t\tstroke: true,\n\t\t\tcolor: '#f06eaa',\n\t\t\tweight: 4,\n\t\t\topacity: 0.5,\n\t\t\tfill: true,\n\t\t\tfillColor: null, //same as color by default\n\t\t\tfillOpacity: 0.2,\n\t\t\tclickable: true\n\t\t}\n\t},\n\n\tinitialize: function (map, options) {\n\t\t// Save the type so super can fire, need to do this as cannot do this.TYPE :(\n\t\tthis.type = L.Draw.Rectangle.TYPE;\n\n\t\tthis._initialLabelText = L.drawLocal.draw.handlers.rectangle.tooltip.start;\n\n\t\tL.Draw.SimpleShape.prototype.initialize.call(this, map, options);\n\t},\n\n\t_drawShape: function (latlng) {\n\t\tif (!this._shape) {\n\t\t\tthis._shape = new L.Rectangle(new L.LatLngBounds(this._startLatLng, latlng), this.options.shapeOptions);\n\t\t\tthis._map.addLayer(this._shape);\n\t\t} else {\n\t\t\tthis._shape.setBounds(new L.LatLngBounds(this._startLatLng, latlng));\n\t\t}\n\t},\n\n\t_fireCreatedEvent: function () {\n\t\tvar rectangle = new L.Rectangle(this._shape.getBounds(), this.options.shapeOptions);\n\t\tL.Draw.SimpleShape.prototype._fireCreatedEvent.call(this, rectangle);\n\t}\n});\n\n\nL.Draw.Circle = L.Draw.SimpleShape.extend({\n\tstatics: {\n\t\tTYPE: 'circle'\n\t},\n\n\toptions: {\n\t\tshapeOptions: {\n\t\t\tstroke: true,\n\t\t\tcolor: '#f06eaa',\n\t\t\tweight: 4,\n\t\t\topacity: 0.5,\n\t\t\tfill: true,\n\t\t\tfillColor: null, //same as color by default\n\t\t\tfillOpacity: 0.2,\n\t\t\tclickable: true\n\t\t},\n\t\tshowRadius: true,\n\t\tmetric: true // Whether to use the metric meaurement system or imperial\n\t},\n\n\tinitialize: function (map, options) {\n\t\t// Save the type so super can fire, need to do this as cannot do this.TYPE :(\n\t\tthis.type = L.Draw.Circle.TYPE;\n\n\t\tthis._initialLabelText = L.drawLocal.draw.handlers.circle.tooltip.start;\n\n\t\tL.Draw.SimpleShape.prototype.initialize.call(this, map, options);\n\t},\n\n\t_drawShape: function (latlng) {\n\t\tif (!this._shape) {\n\t\t\tthis._shape = new L.Circle(this._startLatLng, this._startLatLng.distanceTo(latlng), this.options.shapeOptions);\n\t\t\tthis._map.addLayer(this._shape);\n\t\t} else {\n\t\t\tthis._shape.setRadius(this._startLatLng.distanceTo(latlng));\n\t\t}\n\t},\n\n\t_fireCreatedEvent: function () {\n\t\tvar circle = new L.Circle(this._startLatLng, this._shape.getRadius(), this.options.shapeOptions);\n\t\tL.Draw.SimpleShape.prototype._fireCreatedEvent.call(this, circle);\n\t},\n\n\t_onMouseMove: function (e) {\n\t\tvar latlng = e.latlng,\n\t\t\tshowRadius = this.options.showRadius,\n\t\t\tuseMetric = this.options.metric,\n\t\t\tradius;\n\n\t\tthis._tooltip.updatePosition(latlng);\n\t\tif (this._isDrawing) {\n\t\t\tthis._drawShape(latlng);\n\n\t\t\t// Get the new radius (rounded to 1 dp)\n\t\t\tradius = this._shape.getRadius().toFixed(1);\n\n\t\t\tthis._tooltip.updateContent({\n\t\t\t\ttext: this._endLabelText,\n\t\t\t\tsubtext: showRadius ? 'Radius: ' + L.GeometryUtil.readableDistance(radius, useMetric) : ''\n\t\t\t});\n\t\t}\n\t}\n});\n\n\nL.Draw.Marker = L.Draw.Feature.extend({\n\tstatics: {\n\t\tTYPE: 'marker'\n\t},\n\n\toptions: {\n\t\ticon: new L.Icon.Default(),\n\t\trepeatMode: false,\n\t\tzIndexOffset: 2000 // This should be > than the highest z-index any markers\n\t},\n\n\tinitialize: function (map, options) {\n\t\t// Save the type so super can fire, need to do this as cannot do this.TYPE :(\n\t\tthis.type = L.Draw.Marker.TYPE;\n\n\t\tL.Draw.Feature.prototype.initialize.call(this, map, options);\n\t},\n\n\taddHooks: function () {\n\t\tL.Draw.Feature.prototype.addHooks.call(this);\n\n\t\tif (this._map) {\n\t\t\tthis._tooltip.updateContent({ text: L.drawLocal.draw.handlers.marker.tooltip.start });\n\n\t\t\t// Same mouseMarker as in Draw.Polyline\n\t\t\tif (!this._mouseMarker) {\n\t\t\t\tthis._mouseMarker = L.marker(this._map.getCenter(), {\n\t\t\t\t\ticon: L.divIcon({\n\t\t\t\t\t\tclassName: 'leaflet-mouse-marker',\n\t\t\t\t\t\ticonAnchor: [20, 20],\n\t\t\t\t\t\ticonSize: [40, 40]\n\t\t\t\t\t}),\n\t\t\t\t\topacity: 0,\n\t\t\t\t\tzIndexOffset: this.options.zIndexOffset\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis._mouseMarker\n\t\t\t\t.on('click', this._onClick, this)\n\t\t\t\t.addTo(this._map);\n\n\t\t\tthis._map.on('mousemove', this._onMouseMove, this);\n\t\t}\n\t},\n\n\tremoveHooks: function () {\n\t\tL.Draw.Feature.prototype.removeHooks.call(this);\n\n\t\tif (this._map) {\n\t\t\tif (this._marker) {\n\t\t\t\tthis._marker.off('click', this._onClick, this);\n\t\t\t\tthis._map\n\t\t\t\t\t.off('click', this._onClick, this)\n\t\t\t\t\t.removeLayer(this._marker);\n\t\t\t\tdelete this._marker;\n\t\t\t}\n\n\t\t\tthis._mouseMarker.off('click', this._onClick, this);\n\t\t\tthis._map.removeLayer(this._mouseMarker);\n\t\t\tdelete this._mouseMarker;\n\n\t\t\tthis._map.off('mousemove', this._onMouseMove, this);\n\t\t}\n\t},\n\n\t_onMouseMove: function (e) {\n\t\tvar latlng = e.latlng;\n\n\t\tthis._tooltip.updatePosition(latlng);\n\t\tthis._mouseMarker.setLatLng(latlng);\n\n\t\tif (!this._marker) {\n\t\t\tthis._marker = new L.Marker(latlng, {\n\t\t\t\ticon: this.options.icon,\n\t\t\t\tzIndexOffset: this.options.zIndexOffset\n\t\t\t});\n\t\t\t// Bind to both marker and map to make sure we get the click event.\n\t\t\tthis._marker.on('click', this._onClick, this);\n\t\t\tthis._map\n\t\t\t\t.on('click', this._onClick, this)\n\t\t\t\t.addLayer(this._marker);\n\t\t}\n\t\telse {\n\t\t\tlatlng = this._mouseMarker.getLatLng();\n\t\t\tthis._marker.setLatLng(latlng);\n\t\t}\n\t},\n\n\t_onClick: function () {\n\t\tthis._fireCreatedEvent();\n\n\t\tthis.disable();\n\t\tif (this.options.repeatMode) {\n\t\t\tthis.enable();\n\t\t}\n\t},\n\n\t_fireCreatedEvent: function () {\n\t\tvar marker = new L.Marker(this._marker.getLatLng(), { icon: this.options.icon });\n\t\tL.Draw.Feature.prototype._fireCreatedEvent.call(this, marker);\n\t}\n});\n\n\nL.Edit = L.Edit || {};\n\n/*\n * L.Edit.Poly is an editing handler for polylines and polygons.\n */\n\nL.Edit.Poly = L.Handler.extend({\n\toptions: {\n\t\ticon: new L.DivIcon({\n\t\t\ticonSize: new L.Point(8, 8),\n\t\t\tclassName: 'leaflet-div-icon leaflet-editing-icon'\n\t\t})\n\t},\n\n\tinitialize: function (poly, options) {\n\t\tthis._poly = poly;\n\t\tL.setOptions(this, options);\n\t},\n\n\taddHooks: function () {\n\t\tif (this._poly._map) {\n\t\t\tif (!this._markerGroup) {\n\t\t\t\tthis._initMarkers();\n\t\t\t}\n\t\t\tthis._poly._map.addLayer(this._markerGroup);\n\t\t}\n\t},\n\n\tremoveHooks: function () {\n\t\tif (this._poly._map) {\n\t\t\tthis._poly._map.removeLayer(this._markerGroup);\n\t\t\tdelete this._markerGroup;\n\t\t\tdelete this._markers;\n\t\t}\n\t},\n\n\tupdateMarkers: function () {\n\t\tthis._markerGroup.clearLayers();\n\t\tthis._initMarkers();\n\t},\n\n\t_initMarkers: function () {\n\t\tif (!this._markerGroup) {\n\t\t\tthis._markerGroup = new L.LayerGroup();\n\t\t}\n\t\tthis._markers = [];\n\n\t\tvar latlngs = this._poly._latlngs,\n\t\t\ti, j, len, marker;\n\n\t\t// TODO refactor holes implementation in Polygon to support it here\n\n\t\tfor (i = 0, len = latlngs.length; i < len; i++) {\n\n\t\t\tmarker = this._createMarker(latlngs[i], i);\n\t\t\tmarker.on('click', this._onMarkerClick, this);\n\t\t\tthis._markers.push(marker);\n\t\t}\n\n\t\tvar markerLeft, markerRight;\n\n\t\tfor (i = 0, j = len - 1; i < len; j = i++) {\n\t\t\tif (i === 0 && !(L.Polygon && (this._poly instanceof L.Polygon))) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tmarkerLeft = this._markers[j];\n\t\t\tmarkerRight = this._markers[i];\n\n\t\t\tthis._createMiddleMarker(markerLeft, markerRight);\n\t\t\tthis._updatePrevNext(markerLeft, markerRight);\n\t\t}\n\t},\n\n\t_createMarker: function (latlng, index) {\n\t\tvar marker = new L.Marker(latlng, {\n\t\t\tdraggable: true,\n\t\t\ticon: this.options.icon\n\t\t});\n\n\t\tmarker._origLatLng = latlng;\n\t\tmarker._index = index;\n\n\t\tmarker.on('drag', this._onMarkerDrag, this);\n\t\tmarker.on('dragend', this._fireEdit, this);\n\n\t\tthis._markerGroup.addLayer(marker);\n\n\t\treturn marker;\n\t},\n\n\t_removeMarker: function (marker) {\n\t\tvar i = marker._index;\n\n\t\tthis._markerGroup.removeLayer(marker);\n\t\tthis._markers.splice(i, 1);\n\t\tthis._poly.spliceLatLngs(i, 1);\n\t\tthis._updateIndexes(i, -1);\n\n\t\tmarker\n\t\t\t.off('drag', this._onMarkerDrag, this)\n\t\t\t.off('dragend', this._fireEdit, this)\n\t\t\t.off('click', this._onMarkerClick, this);\n\t},\n\n\t_fireEdit: function () {\n\t\tthis._poly.edited = true;\n\t\tthis._poly.fire('edit');\n\t},\n\n\t_onMarkerDrag: function (e) {\n\t\tvar marker = e.target;\n\n\t\tL.extend(marker._origLatLng, marker._latlng);\n\n\t\tif (marker._middleLeft) {\n\t\t\tmarker._middleLeft.setLatLng(this._getMiddleLatLng(marker._prev, marker));\n\t\t}\n\t\tif (marker._middleRight) {\n\t\t\tmarker._middleRight.setLatLng(this._getMiddleLatLng(marker, marker._next));\n\t\t}\n\n\t\tthis._poly.redraw();\n\t},\n\n\t_onMarkerClick: function (e) {\n\t\tvar minPoints = L.Polygon && (this._poly instanceof L.Polygon) ? 4 : 3,\n\t\t\tmarker = e.target;\n\n\t\t// If removing this point would create an invalid polyline/polygon don't remove\n\t\tif (this._poly._latlngs.length < minPoints) {\n\t\t\treturn;\n\t\t}\n\n\t\t// remove the marker\n\t\tthis._removeMarker(marker);\n\n\t\t// update prev/next links of adjacent markers\n\t\tthis._updatePrevNext(marker._prev, marker._next);\n\n\t\t// remove ghost markers near the removed marker\n\t\tif (marker._middleLeft) {\n\t\t\tthis._markerGroup.removeLayer(marker._middleLeft);\n\t\t}\n\t\tif (marker._middleRight) {\n\t\t\tthis._markerGroup.removeLayer(marker._middleRight);\n\t\t}\n\n\t\t// create a ghost marker in place of the removed one\n\t\tif (marker._prev && marker._next) {\n\t\t\tthis._createMiddleMarker(marker._prev, marker._next);\n\n\t\t} else if (!marker._prev) {\n\t\t\tmarker._next._middleLeft = null;\n\n\t\t} else if (!marker._next) {\n\t\t\tmarker._prev._middleRight = null;\n\t\t}\n\n\t\tthis._fireEdit();\n\t},\n\n\t_updateIndexes: function (index, delta) {\n\t\tthis._markerGroup.eachLayer(function (marker) {\n\t\t\tif (marker._index > index) {\n\t\t\t\tmarker._index += delta;\n\t\t\t}\n\t\t});\n\t},\n\n\t_createMiddleMarker: function (marker1, marker2) {\n\t\tvar latlng = this._getMiddleLatLng(marker1, marker2),\n\t\t    marker = this._createMarker(latlng),\n\t\t    onClick,\n\t\t    onDragStart,\n\t\t    onDragEnd;\n\n\t\tmarker.setOpacity(0.6);\n\n\t\tmarker1._middleRight = marker2._middleLeft = marker;\n\n\t\tonDragStart = function () {\n\t\t\tvar i = marker2._index;\n\n\t\t\tmarker._index = i;\n\n\t\t\tmarker\n\t\t\t    .off('click', onClick, this)\n\t\t\t    .on('click', this._onMarkerClick, this);\n\n\t\t\tlatlng.lat = marker.getLatLng().lat;\n\t\t\tlatlng.lng = marker.getLatLng().lng;\n\t\t\tthis._poly.spliceLatLngs(i, 0, latlng);\n\t\t\tthis._markers.splice(i, 0, marker);\n\n\t\t\tmarker.setOpacity(1);\n\n\t\t\tthis._updateIndexes(i, 1);\n\t\t\tmarker2._index++;\n\t\t\tthis._updatePrevNext(marker1, marker);\n\t\t\tthis._updatePrevNext(marker, marker2);\n\n\t\t\tthis._poly.fire('editstart');\n\t\t};\n\n\t\tonDragEnd = function () {\n\t\t\tmarker.off('dragstart', onDragStart, this);\n\t\t\tmarker.off('dragend', onDragEnd, this);\n\n\t\t\tthis._createMiddleMarker(marker1, marker);\n\t\t\tthis._createMiddleMarker(marker, marker2);\n\t\t};\n\n\t\tonClick = function () {\n\t\t\tonDragStart.call(this);\n\t\t\tonDragEnd.call(this);\n\t\t\tthis._fireEdit();\n\t\t};\n\n\t\tmarker\n\t\t    .on('click', onClick, this)\n\t\t    .on('dragstart', onDragStart, this)\n\t\t    .on('dragend', onDragEnd, this);\n\n\t\tthis._markerGroup.addLayer(marker);\n\t},\n\n\t_updatePrevNext: function (marker1, marker2) {\n\t\tif (marker1) {\n\t\t\tmarker1._next = marker2;\n\t\t}\n\t\tif (marker2) {\n\t\t\tmarker2._prev = marker1;\n\t\t}\n\t},\n\n\t_getMiddleLatLng: function (marker1, marker2) {\n\t\tvar map = this._poly._map,\n\t\t    p1 = map.project(marker1.getLatLng()),\n\t\t    p2 = map.project(marker2.getLatLng());\n\n\t\treturn map.unproject(p1._add(p2)._divideBy(2));\n\t}\n});\n\nL.Polyline.addInitHook(function () {\n\n\t// Check to see if handler has already been initialized. This is to support versions of Leaflet that still have L.Handler.PolyEdit\n\tif (this.editing) {\n\t\treturn;\n\t}\n\n\tif (L.Edit.Poly) {\n\t\tthis.editing = new L.Edit.Poly(this);\n\n\t\tif (this.options.editable) {\n\t\t\tthis.editing.enable();\n\t\t}\n\t}\n\n\tthis.on('add', function () {\n\t\tif (this.editing && this.editing.enabled()) {\n\t\t\tthis.editing.addHooks();\n\t\t}\n\t});\n\n\tthis.on('remove', function () {\n\t\tif (this.editing && this.editing.enabled()) {\n\t\t\tthis.editing.removeHooks();\n\t\t}\n\t});\n});\n\n\nL.Edit = L.Edit || {};\n\nL.Edit.SimpleShape = L.Handler.extend({\n\toptions: {\n\t\tmoveIcon: new L.DivIcon({\n\t\t\ticonSize: new L.Point(8, 8),\n\t\t\tclassName: 'leaflet-div-icon leaflet-editing-icon leaflet-edit-move'\n\t\t}),\n\t\tresizeIcon: new L.DivIcon({\n\t\t\ticonSize: new L.Point(8, 8),\n\t\t\tclassName: 'leaflet-div-icon leaflet-editing-icon leaflet-edit-resize'\n\t\t})\n\t},\n\n\tinitialize: function (shape, options) {\n\t\tthis._shape = shape;\n\t\tL.Util.setOptions(this, options);\n\t},\n\n\taddHooks: function () {\n\t\tif (this._shape._map) {\n\t\t\tthis._map = this._shape._map;\n\n\t\t\tif (!this._markerGroup) {\n\t\t\t\tthis._initMarkers();\n\t\t\t}\n\t\t\tthis._map.addLayer(this._markerGroup);\n\t\t}\n\t},\n\n\tremoveHooks: function () {\n\t\tif (this._shape._map) {\n\t\t\tthis._unbindMarker(this._moveMarker);\n\n\t\t\tfor (var i = 0, l = this._resizeMarkers.length; i < l; i++) {\n\t\t\t\tthis._unbindMarker(this._resizeMarkers[i]);\n\t\t\t}\n\t\t\tthis._resizeMarkers = null;\n\n\t\t\tthis._map.removeLayer(this._markerGroup);\n\t\t\tdelete this._markerGroup;\n\t\t}\n\n\t\tthis._map = null;\n\t},\n\n\tupdateMarkers: function () {\n\t\tthis._markerGroup.clearLayers();\n\t\tthis._initMarkers();\n\t},\n\n\t_initMarkers: function () {\n\t\tif (!this._markerGroup) {\n\t\t\tthis._markerGroup = new L.LayerGroup();\n\t\t}\n\n\t\t// Create center marker\n\t\tthis._createMoveMarker();\n\n\t\t// Create edge marker\n\t\tthis._createResizeMarker();\n\t},\n\n\t_createMoveMarker: function () {\n\t\t// Children override\n\t},\n\n\t_createResizeMarker: function () {\n\t\t// Children override\n\t},\n\n\t_createMarker: function (latlng, icon) {\n\t\tvar marker = new L.Marker(latlng, {\n\t\t\tdraggable: true,\n\t\t\ticon: icon,\n\t\t\tzIndexOffset: 10\n\t\t});\n\n\t\tthis._bindMarker(marker);\n\n\t\tthis._markerGroup.addLayer(marker);\n\n\t\treturn marker;\n\t},\n\n\t_bindMarker: function (marker) {\n\t\tmarker\n\t\t\t.on('dragstart', this._onMarkerDragStart, this)\n\t\t\t.on('drag', this._onMarkerDrag, this)\n\t\t\t.on('dragend', this._onMarkerDragEnd, this);\n\t},\n\n\t_unbindMarker: function (marker) {\n\t\tmarker\n\t\t\t.off('dragstart', this._onMarkerDragStart, this)\n\t\t\t.off('drag', this._onMarkerDrag, this)\n\t\t\t.off('dragend', this._onMarkerDragEnd, this);\n\t},\n\n\t_onMarkerDragStart: function (e) {\n\t\tvar marker = e.target;\n\t\tmarker.setOpacity(0);\n\n\t\tthis._shape.fire('editstart');\n\t},\n\n\t_fireEdit: function () {\n\t\tthis._shape.edited = true;\n\t\tthis._shape.fire('edit');\n\t},\n\n\t_onMarkerDrag: function (e) {\n\t\tvar marker = e.target,\n\t\t\tlatlng = marker.getLatLng();\n\n\t\tif (marker === this._moveMarker) {\n\t\t\tthis._move(latlng);\n\t\t} else {\n\t\t\tthis._resize(latlng);\n\t\t}\n\n\t\tthis._shape.redraw();\n\t},\n\n\t_onMarkerDragEnd: function (e) {\n\t\tvar marker = e.target;\n\t\tmarker.setOpacity(1);\n\n\t\tthis._fireEdit();\n\t},\n\n\t_move: function () {\n\t\t// Children override\n\t},\n\n\t_resize: function () {\n\t\t// Children override\n\t}\n});\n\n\nL.Edit = L.Edit || {};\n\nL.Edit.Rectangle = L.Edit.SimpleShape.extend({\n\t_createMoveMarker: function () {\n\t\tvar bounds = this._shape.getBounds(),\n\t\t\tcenter = bounds.getCenter();\n\n\t\tthis._moveMarker = this._createMarker(center, this.options.moveIcon);\n\t},\n\n\t_createResizeMarker: function () {\n\t\tvar corners = this._getCorners();\n\n\t\tthis._resizeMarkers = [];\n\n\t\tfor (var i = 0, l = corners.length; i < l; i++) {\n\t\t\tthis._resizeMarkers.push(this._createMarker(corners[i], this.options.resizeIcon));\n\t\t\t// Monkey in the corner index as we will need to know this for dragging\n\t\t\tthis._resizeMarkers[i]._cornerIndex = i;\n\t\t}\n\t},\n\n\t_onMarkerDragStart: function (e) {\n\t\tL.Edit.SimpleShape.prototype._onMarkerDragStart.call(this, e);\n\n\t\t// Save a reference to the opposite point\n\t\tvar corners = this._getCorners(),\n\t\t\tmarker = e.target,\n\t\t\tcurrentCornerIndex = marker._cornerIndex;\n\n\t\tthis._oppositeCorner = corners[(currentCornerIndex + 2) % 4];\n\n\t\tthis._toggleCornerMarkers(0, currentCornerIndex);\n\t},\n\n\t_onMarkerDragEnd: function (e) {\n\t\tvar marker = e.target,\n\t\t\tbounds, center;\n\n\t\t// Reset move marker position to the center\n\t\tif (marker === this._moveMarker) {\n\t\t\tbounds = this._shape.getBounds();\n\t\t\tcenter = bounds.getCenter();\n\n\t\t\tmarker.setLatLng(center);\n\t\t}\n\n\t\tthis._toggleCornerMarkers(1);\n\n\t\tthis._repositionCornerMarkers();\n\n\t\tL.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this, e);\n\t},\n\n\t_move: function (newCenter) {\n\t\tvar latlngs = this._shape.getLatLngs(),\n\t\t\tbounds = this._shape.getBounds(),\n\t\t\tcenter = bounds.getCenter(),\n\t\t\toffset, newLatLngs = [];\n\n\t\t// Offset the latlngs to the new center\n\t\tfor (var i = 0, l = latlngs.length; i < l; i++) {\n\t\t\toffset = [latlngs[i].lat - center.lat, latlngs[i].lng - center.lng];\n\t\t\tnewLatLngs.push([newCenter.lat + offset[0], newCenter.lng + offset[1]]);\n\t\t}\n\n\t\tthis._shape.setLatLngs(newLatLngs);\n\n\t\t// Reposition the resize markers\n\t\tthis._repositionCornerMarkers();\n\t},\n\n\t_resize: function (latlng) {\n\t\tvar bounds;\n\n\t\t// Update the shape based on the current position of this corner and the opposite point\n\t\tthis._shape.setBounds(L.latLngBounds(latlng, this._oppositeCorner));\n\n\t\t// Reposition the move marker\n\t\tbounds = this._shape.getBounds();\n\t\tthis._moveMarker.setLatLng(bounds.getCenter());\n\t},\n\n\t_getCorners: function () {\n\t\tvar bounds = this._shape.getBounds(),\n\t\t\tnw = bounds.getNorthWest(),\n\t\t\tne = bounds.getNorthEast(),\n\t\t\tse = bounds.getSouthEast(),\n\t\t\tsw = bounds.getSouthWest();\n\n\t\treturn [nw, ne, se, sw];\n\t},\n\n\t_toggleCornerMarkers: function (opacity) {\n\t\tfor (var i = 0, l = this._resizeMarkers.length; i < l; i++) {\n\t\t\tthis._resizeMarkers[i].setOpacity(opacity);\n\t\t}\n\t},\n\n\t_repositionCornerMarkers: function () {\n\t\tvar corners = this._getCorners();\n\n\t\tfor (var i = 0, l = this._resizeMarkers.length; i < l; i++) {\n\t\t\tthis._resizeMarkers[i].setLatLng(corners[i]);\n\t\t}\n\t}\n});\n\nL.Rectangle.addInitHook(function () {\n\tif (L.Edit.Rectangle) {\n\t\tthis.editing = new L.Edit.Rectangle(this);\n\n\t\tif (this.options.editable) {\n\t\t\tthis.editing.enable();\n\t\t}\n\t}\n});\n\n\nL.Edit = L.Edit || {};\n\nL.Edit.Circle = L.Edit.SimpleShape.extend({\n\t_createMoveMarker: function () {\n\t\tvar center = this._shape.getLatLng();\n\n\t\tthis._moveMarker = this._createMarker(center, this.options.moveIcon);\n\t},\n\n\t_createResizeMarker: function () {\n\t\tvar center = this._shape.getLatLng(),\n\t\t\tresizemarkerPoint = this._getResizeMarkerPoint(center);\n\n\t\tthis._resizeMarkers = [];\n\t\tthis._resizeMarkers.push(this._createMarker(resizemarkerPoint, this.options.resizeIcon));\n\t},\n\n\t_getResizeMarkerPoint: function (latlng) {\n\t\t// From L.shape.getBounds()\n\t\tvar delta = this._shape._radius * Math.cos(Math.PI / 4),\n\t\t\tpoint = this._map.project(latlng);\n\t\treturn this._map.unproject([point.x + delta, point.y - delta]);\n\t},\n\n\t_move: function (latlng) {\n\t\tvar resizemarkerPoint = this._getResizeMarkerPoint(latlng);\n\n\t\t// Move the resize marker\n\t\tthis._resizeMarkers[0].setLatLng(resizemarkerPoint);\n\n\t\t// Move the circle\n\t\tthis._shape.setLatLng(latlng);\n\t},\n\n\t_resize: function (latlng) {\n\t\tvar moveLatLng = this._moveMarker.getLatLng(),\n\t\t\tradius = moveLatLng.distanceTo(latlng);\n\n\t\tthis._shape.setRadius(radius);\n\t}\n});\n\nL.Circle.addInitHook(function () {\n\tif (L.Edit.Circle) {\n\t\tthis.editing = new L.Edit.Circle(this);\n\n\t\tif (this.options.editable) {\n\t\t\tthis.editing.enable();\n\t\t}\n\t}\n\n\tthis.on('add', function () {\n\t\tif (this.editing && this.editing.enabled()) {\n\t\t\tthis.editing.addHooks();\n\t\t}\n\t});\n\n\tthis.on('remove', function () {\n\t\tif (this.editing && this.editing.enabled()) {\n\t\t\tthis.editing.removeHooks();\n\t\t}\n\t});\n});\n\n/*\n * L.LatLngUtil contains different utility functions for LatLngs.\n */\n\nL.LatLngUtil = {\n\t// Clones a LatLngs[], returns [][]\n\tcloneLatLngs: function (latlngs) {\n\t\tvar clone = [];\n\t\tfor (var i = 0, l = latlngs.length; i < l; i++) {\n\t\t\tclone.push(this.cloneLatLng(latlngs[i]));\n\t\t}\n\t\treturn clone;\n\t},\n\n\tcloneLatLng: function (latlng) {\n\t\treturn L.latLng(latlng.lat, latlng.lng);\n\t}\n};\n\nL.GeometryUtil = L.extend(L.GeometryUtil || {}, {\n\t// Ported from the OpenLayers implementation. See https://github.com/openlayers/openlayers/blob/master/lib/OpenLayers/Geometry/LinearRing.js#L270\n\tgeodesicArea: function (latLngs) {\n\t\tvar pointsCount = latLngs.length,\n\t\t\tarea = 0.0,\n\t\t\td2r = L.LatLng.DEG_TO_RAD,\n\t\t\tp1, p2;\n\n\t\tif (pointsCount > 2) {\n\t\t\tfor (var i = 0; i < pointsCount; i++) {\n\t\t\t\tp1 = latLngs[i];\n\t\t\t\tp2 = latLngs[(i + 1) % pointsCount];\n\t\t\t\tarea += ((p2.lng - p1.lng) * d2r) *\n\t\t\t\t\t\t(2 + Math.sin(p1.lat * d2r) + Math.sin(p2.lat * d2r));\n\t\t\t}\n\t\t\tarea = area * 6378137.0 * 6378137.0 / 2.0;\n\t\t}\n\n\t\treturn Math.abs(area);\n\t},\n\n\treadableArea: function (area, isMetric) {\n\t\tvar areaStr;\n\n\t\tif (isMetric) {\n\t\t\tif (area >= 10000) {\n\t\t\t\tareaStr = (area * 0.0001).toFixed(2) + ' ha';\n\t\t\t} else {\n\t\t\t\tareaStr = area.toFixed(2) + ' m&sup2;';\n\t\t\t}\n\t\t} else {\n\t\t\tarea *= 0.836127; // Square yards in 1 meter\n\n\t\t\tif (area >= 3097600) { //3097600 square yards in 1 square mile\n\t\t\t\tareaStr = (area / 3097600).toFixed(2) + ' mi&sup2;';\n\t\t\t} else if (area >= 4840) {//48040 square yards in 1 acre\n\t\t\t\tareaStr = (area / 4840).toFixed(2) + ' acres';\n\t\t\t} else {\n\t\t\t\tareaStr = Math.ceil(area) + ' yd&sup2;';\n\t\t\t}\n\t\t}\n\n\t\treturn areaStr;\n\t},\n\n\treadableDistance: function (distance, isMetric) {\n\t\tvar distanceStr;\n\n\t\tif (isMetric) {\n\t\t\t// show metres when distance is < 1km, then show km\n\t\t\tif (distance > 1000) {\n\t\t\t\tdistanceStr = (distance  / 1000).toFixed(2) + ' km';\n\t\t\t} else {\n\t\t\t\tdistanceStr = Math.ceil(distance) + ' m';\n\t\t\t}\n\t\t} else {\n\t\t\tdistance *= 1.09361;\n\n\t\t\tif (distance > 1760) {\n\t\t\t\tdistanceStr = (distance / 1760).toFixed(2) + ' miles';\n\t\t\t} else {\n\t\t\t\tdistanceStr = Math.ceil(distance) + ' yd';\n\t\t\t}\n\t\t}\n\n\t\treturn distanceStr;\n\t}\n});\n\nL.Util.extend(L.LineUtil, {\n\t// Checks to see if two line segments intersect. Does not handle degenerate cases.\n\t// http://compgeom.cs.uiuc.edu/~jeffe/teaching/373/notes/x06-sweepline.pdf\n\tsegmentsIntersect: function (/*Point*/ p, /*Point*/ p1, /*Point*/ p2, /*Point*/ p3) {\n\t\treturn\tthis._checkCounterclockwise(p, p2, p3) !==\n\t\t\t\tthis._checkCounterclockwise(p1, p2, p3) &&\n\t\t\t\tthis._checkCounterclockwise(p, p1, p2) !==\n\t\t\t\tthis._checkCounterclockwise(p, p1, p3);\n\t},\n\n\t// check to see if points are in counterclockwise order\n\t_checkCounterclockwise: function (/*Point*/ p, /*Point*/ p1, /*Point*/ p2) {\n\t\treturn (p2.y - p.y) * (p1.x - p.x) > (p1.y - p.y) * (p2.x - p.x);\n\t}\n});\n\nL.Polyline.include({\n\t// Check to see if this polyline has any linesegments that intersect.\n\t// NOTE: does not support detecting intersection for degenerate cases.\n\tintersects: function () {\n\t\tvar points = this._originalPoints,\n\t\t\tlen = points ? points.length : 0,\n\t\t\ti, p, p1;\n\n\t\tif (this._tooFewPointsForIntersection()) {\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (i = len - 1; i >= 3; i--) {\n\t\t\tp = points[i - 1];\n\t\t\tp1 = points[i];\n\n\n\t\t\tif (this._lineSegmentsIntersectsRange(p, p1, i - 2)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t},\n\n\t// Check for intersection if new latlng was added to this polyline.\n\t// NOTE: does not support detecting intersection for degenerate cases.\n\tnewLatLngIntersects: function (latlng, skipFirst) {\n\t\t// Cannot check a polyline for intersecting lats/lngs when not added to the map\n\t\tif (!this._map) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.newPointIntersects(this._map.latLngToLayerPoint(latlng), skipFirst);\n\t},\n\n\t// Check for intersection if new point was added to this polyline.\n\t// newPoint must be a layer point.\n\t// NOTE: does not support detecting intersection for degenerate cases.\n\tnewPointIntersects: function (newPoint, skipFirst) {\n\t\tvar points = this._originalPoints,\n\t\t\tlen = points ? points.length : 0,\n\t\t\tlastPoint = points ? points[len - 1] : null,\n\t\t\t// The previous previous line segment. Previous line segment doesn't need testing.\n\t\t\tmaxIndex = len - 2;\n\n\t\tif (this._tooFewPointsForIntersection(1)) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this._lineSegmentsIntersectsRange(lastPoint, newPoint, maxIndex, skipFirst ? 1 : 0);\n\t},\n\n\t// Polylines with 2 sides can only intersect in cases where points are collinear (we don't support detecting these).\n\t// Cannot have intersection when < 3 line segments (< 4 points)\n\t_tooFewPointsForIntersection: function (extraPoints) {\n\t\tvar points = this._originalPoints,\n\t\t\tlen = points ? points.length : 0;\n\t\t// Increment length by extraPoints if present\n\t\tlen += extraPoints || 0;\n\n\t\treturn !this._originalPoints || len <= 3;\n\t},\n\n\t// Checks a line segment intersections with any line segments before its predecessor.\n\t// Don't need to check the predecessor as will never intersect.\n\t_lineSegmentsIntersectsRange: function (p, p1, maxIndex, minIndex) {\n\t\tvar points = this._originalPoints,\n\t\t\tp2, p3;\n\n\t\tminIndex = minIndex || 0;\n\n\t\t// Check all previous line segments (beside the immediately previous) for intersections\n\t\tfor (var j = maxIndex; j > minIndex; j--) {\n\t\t\tp2 = points[j - 1];\n\t\t\tp3 = points[j];\n\n\t\t\tif (L.LineUtil.segmentsIntersect(p, p1, p2, p3)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n});\n\n\nL.Polygon.include({\n\t// Checks a polygon for any intersecting line segments. Ignores holes.\n\tintersects: function () {\n\t\tvar polylineIntersects,\n\t\t\tpoints = this._originalPoints,\n\t\t\tlen, firstPoint, lastPoint, maxIndex;\n\n\t\tif (this._tooFewPointsForIntersection()) {\n\t\t\treturn false;\n\t\t}\n\n\t\tpolylineIntersects = L.Polyline.prototype.intersects.call(this);\n\n\t\t// If already found an intersection don't need to check for any more.\n\t\tif (polylineIntersects) {\n\t\t\treturn true;\n\t\t}\n\n\t\tlen = points.length;\n\t\tfirstPoint = points[0];\n\t\tlastPoint = points[len - 1];\n\t\tmaxIndex = len - 2;\n\n\t\t// Check the line segment between last and first point. Don't need to check the first line segment (minIndex = 1)\n\t\treturn this._lineSegmentsIntersectsRange(lastPoint, firstPoint, maxIndex, 1);\n\t}\n});\n\nL.Control.Draw = L.Control.extend({\n\n\toptions: {\n\t\tposition: 'topleft',\n\t\tdraw: {},\n\t\tedit: false\n\t},\n\n\tinitialize: function (options) {\n\t\tif (L.version < '0.7') {\n\t\t\tthrow new Error('Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/');\n\t\t}\n\n\t\tL.Control.prototype.initialize.call(this, options);\n\n\t\tvar id, toolbar;\n\n\t\tthis._toolbars = {};\n\n\t\t// Initialize toolbars\n\t\tif (L.DrawToolbar && this.options.draw) {\n\t\t\ttoolbar = new L.DrawToolbar(this.options.draw);\n\t\t\tid = L.stamp(toolbar);\n\t\t\tthis._toolbars[id] = toolbar;\n\n\t\t\t// Listen for when toolbar is enabled\n\t\t\tthis._toolbars[id].on('enable', this._toolbarEnabled, this);\n\t\t}\n\n\t\tif (L.EditToolbar && this.options.edit) {\n\t\t\ttoolbar = new L.EditToolbar(this.options.edit);\n\t\t\tid = L.stamp(toolbar);\n\t\t\tthis._toolbars[id] = toolbar;\n\n\t\t\t// Listen for when toolbar is enabled\n\t\t\tthis._toolbars[id].on('enable', this._toolbarEnabled, this);\n\t\t}\n\t},\n\n\tonAdd: function (map) {\n\t\tvar container = L.DomUtil.create('div', 'leaflet-draw'),\n\t\t\taddedTopClass = false,\n\t\t\ttopClassName = 'leaflet-draw-toolbar-top',\n\t\t\ttoolbarContainer;\n\n\t\tfor (var toolbarId in this._toolbars) {\n\t\t\tif (this._toolbars.hasOwnProperty(toolbarId)) {\n\t\t\t\ttoolbarContainer = this._toolbars[toolbarId].addToolbar(map);\n\n\t\t\t\tif (toolbarContainer) {\n\t\t\t\t\t// Add class to the first toolbar to remove the margin\n\t\t\t\t\tif (!addedTopClass) {\n\t\t\t\t\t\tif (!L.DomUtil.hasClass(toolbarContainer, topClassName)) {\n\t\t\t\t\t\t\tL.DomUtil.addClass(toolbarContainer.childNodes[0], topClassName);\n\t\t\t\t\t\t}\n\t\t\t\t\t\taddedTopClass = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tcontainer.appendChild(toolbarContainer);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn container;\n\t},\n\n\tonRemove: function () {\n\t\tfor (var toolbarId in this._toolbars) {\n\t\t\tif (this._toolbars.hasOwnProperty(toolbarId)) {\n\t\t\t\tthis._toolbars[toolbarId].removeToolbar();\n\t\t\t}\n\t\t}\n\t},\n\n\tsetDrawingOptions: function (options) {\n\t\tfor (var toolbarId in this._toolbars) {\n\t\t\tif (this._toolbars[toolbarId] instanceof L.DrawToolbar) {\n\t\t\t\tthis._toolbars[toolbarId].setOptions(options);\n\t\t\t}\n\t\t}\n\t},\n\n\t_toolbarEnabled: function (e) {\n\t\tvar id = '' + L.stamp(e.target);\n\n\t\tfor (var toolbarId in this._toolbars) {\n\t\t\tif (this._toolbars.hasOwnProperty(toolbarId) && toolbarId !== id) {\n\t\t\t\tthis._toolbars[toolbarId].disable();\n\t\t\t}\n\t\t}\n\t}\n});\n\nL.Map.mergeOptions({\n\tdrawControlTooltips: true,\n\tdrawControl: false\n});\n\nL.Map.addInitHook(function () {\n\tif (this.options.drawControl) {\n\t\tthis.drawControl = new L.Control.Draw();\n\t\tthis.addControl(this.drawControl);\n\t}\n});\n\n\nL.Toolbar = L.Class.extend({\n\tincludes: [L.Mixin.Events],\n\n\tinitialize: function (options) {\n\t\tL.setOptions(this, options);\n\n\t\tthis._modes = {};\n\t\tthis._actionButtons = [];\n\t\tthis._activeMode = null;\n\t},\n\n\tenabled: function () {\n\t\treturn this._activeMode !== null;\n\t},\n\n\tdisable: function () {\n\t\tif (!this.enabled()) { return; }\n\n\t\tthis._activeMode.handler.disable();\n\t},\n\n\taddToolbar: function (map) {\n\t\tvar container = L.DomUtil.create('div', 'leaflet-draw-section'),\n\t\t\tbuttonIndex = 0,\n\t\t\tbuttonClassPrefix = this._toolbarClass || '',\n\t\t\tmodeHandlers = this.getModeHandlers(map),\n\t\t\ti;\n\n\t\tthis._toolbarContainer = L.DomUtil.create('div', 'leaflet-draw-toolbar leaflet-bar');\n\t\tthis._map = map;\n\n\t\tfor (i = 0; i < modeHandlers.length; i++) {\n\t\t\tif (modeHandlers[i].enabled) {\n\t\t\t\tthis._initModeHandler(\n\t\t\t\t\tmodeHandlers[i].handler,\n\t\t\t\t\tthis._toolbarContainer,\n\t\t\t\t\tbuttonIndex++,\n\t\t\t\t\tbuttonClassPrefix,\n\t\t\t\t\tmodeHandlers[i].title\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\t// if no buttons were added, do not add the toolbar\n\t\tif (!buttonIndex) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Save button index of the last button, -1 as we would have ++ after the last button\n\t\tthis._lastButtonIndex = --buttonIndex;\n\n\t\t// Create empty actions part of the toolbar\n\t\tthis._actionsContainer = L.DomUtil.create('ul', 'leaflet-draw-actions');\n\n\t\t// Add draw and cancel containers to the control container\n\t\tcontainer.appendChild(this._toolbarContainer);\n\t\tcontainer.appendChild(this._actionsContainer);\n\n\t\treturn container;\n\t},\n\n\tremoveToolbar: function () {\n\t\t// Dispose each handler\n\t\tfor (var handlerId in this._modes) {\n\t\t\tif (this._modes.hasOwnProperty(handlerId)) {\n\t\t\t\t// Unbind handler button\n\t\t\t\tthis._disposeButton(\n\t\t\t\t\tthis._modes[handlerId].button,\n\t\t\t\t\tthis._modes[handlerId].handler.enable,\n\t\t\t\t\tthis._modes[handlerId].handler\n\t\t\t\t);\n\n\t\t\t\t// Make sure is disabled\n\t\t\t\tthis._modes[handlerId].handler.disable();\n\n\t\t\t\t// Unbind handler\n\t\t\t\tthis._modes[handlerId].handler\n\t\t\t\t\t.off('enabled', this._handlerActivated, this)\n\t\t\t\t\t.off('disabled', this._handlerDeactivated, this);\n\t\t\t}\n\t\t}\n\t\tthis._modes = {};\n\n\t\t// Dispose the actions toolbar\n\t\tfor (var i = 0, l = this._actionButtons.length; i < l; i++) {\n\t\t\tthis._disposeButton(\n\t\t\t\tthis._actionButtons[i].button,\n\t\t\t\tthis._actionButtons[i].callback,\n\t\t\t\tthis\n\t\t\t);\n\t\t}\n\t\tthis._actionButtons = [];\n\t\tthis._actionsContainer = null;\n\t},\n\n\t_initModeHandler: function (handler, container, buttonIndex, classNamePredix, buttonTitle) {\n\t\tvar type = handler.type;\n\n\t\tthis._modes[type] = {};\n\n\t\tthis._modes[type].handler = handler;\n\n\t\tthis._modes[type].button = this._createButton({\n\t\t\ttitle: buttonTitle,\n\t\t\tclassName: classNamePredix + '-' + type,\n\t\t\tcontainer: container,\n\t\t\tcallback: this._modes[type].handler.enable,\n\t\t\tcontext: this._modes[type].handler\n\t\t});\n\n\t\tthis._modes[type].buttonIndex = buttonIndex;\n\n\t\tthis._modes[type].handler\n\t\t\t.on('enabled', this._handlerActivated, this)\n\t\t\t.on('disabled', this._handlerDeactivated, this);\n\t},\n\n\t_createButton: function (options) {\n\t\tvar link = L.DomUtil.create('a', options.className || '', options.container);\n\t\tlink.href = '#';\n\n\t\tif (options.text) {\n\t\t\tlink.innerHTML = options.text;\n\t\t}\n\n\t\tif (options.title) {\n\t\t\tlink.title = options.title;\n\t\t}\n\n\t\tL.DomEvent\n\t\t\t.on(link, 'click', L.DomEvent.stopPropagation)\n\t\t\t.on(link, 'mousedown', L.DomEvent.stopPropagation)\n\t\t\t.on(link, 'dblclick', L.DomEvent.stopPropagation)\n\t\t\t.on(link, 'click', L.DomEvent.preventDefault)\n\t\t\t.on(link, 'click', options.callback, options.context);\n\n\t\treturn link;\n\t},\n\n\t_disposeButton: function (button, callback) {\n\t\tL.DomEvent\n\t\t\t.off(button, 'click', L.DomEvent.stopPropagation)\n\t\t\t.off(button, 'mousedown', L.DomEvent.stopPropagation)\n\t\t\t.off(button, 'dblclick', L.DomEvent.stopPropagation)\n\t\t\t.off(button, 'click', L.DomEvent.preventDefault)\n\t\t\t.off(button, 'click', callback);\n\t},\n\n\t_handlerActivated: function (e) {\n\t\t// Disable active mode (if present)\n\t\tthis.disable();\n\n\t\t// Cache new active feature\n\t\tthis._activeMode = this._modes[e.handler];\n\n\t\tL.DomUtil.addClass(this._activeMode.button, 'leaflet-draw-toolbar-button-enabled');\n\n\t\tthis._showActionsToolbar();\n\n\t\tthis.fire('enable');\n\t},\n\n\t_handlerDeactivated: function () {\n\t\tthis._hideActionsToolbar();\n\n\t\tL.DomUtil.removeClass(this._activeMode.button, 'leaflet-draw-toolbar-button-enabled');\n\n\t\tthis._activeMode = null;\n\n\t\tthis.fire('disable');\n\t},\n\n\t_createActions: function (handler) {\n\t\tvar container = this._actionsContainer,\n\t\t\tbuttons = this.getActions(handler),\n\t\t\tl = buttons.length,\n\t\t\tli, di, dl, button;\n\n\t\t// Dispose the actions toolbar (todo: dispose only not used buttons)\n\t\tfor (di = 0, dl = this._actionButtons.length; di < dl; di++) {\n\t\t\tthis._disposeButton(this._actionButtons[di].button, this._actionButtons[di].callback);\n\t\t}\n\t\tthis._actionButtons = [];\n\n\t\t// Remove all old buttons\n\t\twhile (container.firstChild) {\n\t\t\tcontainer.removeChild(container.firstChild);\n\t\t}\n\n\t\tfor (var i = 0; i < l; i++) {\n\t\t\tif ('enabled' in buttons[i] && !buttons[i].enabled) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tli = L.DomUtil.create('li', '', container);\n\n\t\t\tbutton = this._createButton({\n\t\t\t\ttitle: buttons[i].title,\n\t\t\t\ttext: buttons[i].text,\n\t\t\t\tcontainer: li,\n\t\t\t\tcallback: buttons[i].callback,\n\t\t\t\tcontext: buttons[i].context\n\t\t\t});\n\n\t\t\tthis._actionButtons.push({\n\t\t\t\tbutton: button,\n\t\t\t\tcallback: buttons[i].callback\n\t\t\t});\n\t\t}\n\t},\n\n\t_showActionsToolbar: function () {\n\t\tvar buttonIndex = this._activeMode.buttonIndex,\n\t\t\tlastButtonIndex = this._lastButtonIndex,\n\t\t\ttoolbarPosition = this._activeMode.button.offsetTop - 1;\n\n\t\t// Recreate action buttons on every click\n\t\tthis._createActions(this._activeMode.handler);\n\n\t\t// Correctly position the cancel button\n\t\tthis._actionsContainer.style.top = toolbarPosition + 'px';\n\n\t\tif (buttonIndex === 0) {\n\t\t\tL.DomUtil.addClass(this._toolbarContainer, 'leaflet-draw-toolbar-notop');\n\t\t\tL.DomUtil.addClass(this._actionsContainer, 'leaflet-draw-actions-top');\n\t\t}\n\n\t\tif (buttonIndex === lastButtonIndex) {\n\t\t\tL.DomUtil.addClass(this._toolbarContainer, 'leaflet-draw-toolbar-nobottom');\n\t\t\tL.DomUtil.addClass(this._actionsContainer, 'leaflet-draw-actions-bottom');\n\t\t}\n\n\t\tthis._actionsContainer.style.display = 'block';\n\t},\n\n\t_hideActionsToolbar: function () {\n\t\tthis._actionsContainer.style.display = 'none';\n\n\t\tL.DomUtil.removeClass(this._toolbarContainer, 'leaflet-draw-toolbar-notop');\n\t\tL.DomUtil.removeClass(this._toolbarContainer, 'leaflet-draw-toolbar-nobottom');\n\t\tL.DomUtil.removeClass(this._actionsContainer, 'leaflet-draw-actions-top');\n\t\tL.DomUtil.removeClass(this._actionsContainer, 'leaflet-draw-actions-bottom');\n\t}\n});\n\n\nL.Tooltip = L.Class.extend({\n\tinitialize: function (map) {\n\t\tthis._map = map;\n\t\tthis._popupPane = map._panes.popupPane;\n\n\t\tthis._container = map.options.drawControlTooltips ? L.DomUtil.create('div', 'leaflet-draw-tooltip', this._popupPane) : null;\n\t\tthis._singleLineLabel = false;\n\t},\n\n\tdispose: function () {\n\t\tif (this._container) {\n\t\t\tthis._popupPane.removeChild(this._container);\n\t\t\tthis._container = null;\n\t\t}\n\t},\n\n\tupdateContent: function (labelText) {\n\t\tif (!this._container) {\n\t\t\treturn this;\n\t\t}\n\t\tlabelText.subtext = labelText.subtext || '';\n\n\t\t// update the vertical position (only if changed)\n\t\tif (labelText.subtext.length === 0 && !this._singleLineLabel) {\n\t\t\tL.DomUtil.addClass(this._container, 'leaflet-draw-tooltip-single');\n\t\t\tthis._singleLineLabel = true;\n\t\t}\n\t\telse if (labelText.subtext.length > 0 && this._singleLineLabel) {\n\t\t\tL.DomUtil.removeClass(this._container, 'leaflet-draw-tooltip-single');\n\t\t\tthis._singleLineLabel = false;\n\t\t}\n\n\t\tthis._container.innerHTML =\n\t\t\t(labelText.subtext.length > 0 ? '<span class=\"leaflet-draw-tooltip-subtext\">' + labelText.subtext + '</span>' + '<br />' : '') +\n\t\t\t'<span>' + labelText.text + '</span>';\n\n\t\treturn this;\n\t},\n\n\tupdatePosition: function (latlng) {\n\t\tvar pos = this._map.latLngToLayerPoint(latlng),\n\t\t\ttooltipContainer = this._container;\n\n\t\tif (this._container) {\n\t\t\ttooltipContainer.style.visibility = 'inherit';\n\t\t\tL.DomUtil.setPosition(tooltipContainer, pos);\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tshowAsError: function () {\n\t\tif (this._container) {\n\t\t\tL.DomUtil.addClass(this._container, 'leaflet-error-draw-tooltip');\n\t\t}\n\t\treturn this;\n\t},\n\n\tremoveError: function () {\n\t\tif (this._container) {\n\t\t\tL.DomUtil.removeClass(this._container, 'leaflet-error-draw-tooltip');\n\t\t}\n\t\treturn this;\n\t}\n});\n\nL.DrawToolbar = L.Toolbar.extend({\n\n\toptions: {\n\t\tpolyline: {},\n\t\tpolygon: {},\n\t\trectangle: {},\n\t\tcircle: {},\n\t\tmarker: {}\n\t},\n\n\tinitialize: function (options) {\n\t\t// Ensure that the options are merged correctly since L.extend is only shallow\n\t\tfor (var type in this.options) {\n\t\t\tif (this.options.hasOwnProperty(type)) {\n\t\t\t\tif (options[type]) {\n\t\t\t\t\toptions[type] = L.extend({}, this.options[type], options[type]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._toolbarClass = 'leaflet-draw-draw';\n\t\tL.Toolbar.prototype.initialize.call(this, options);\n\t},\n\n\tgetModeHandlers: function (map) {\n\t\treturn [\n\t\t\t{\n\t\t\t\tenabled: this.options.polyline,\n\t\t\t\thandler: new L.Draw.Polyline(map, this.options.polyline),\n\t\t\t\ttitle: L.drawLocal.draw.toolbar.buttons.polyline\n\t\t\t},\n\t\t\t{\n\t\t\t\tenabled: this.options.polygon,\n\t\t\t\thandler: new L.Draw.Polygon(map, this.options.polygon),\n\t\t\t\ttitle: L.drawLocal.draw.toolbar.buttons.polygon\n\t\t\t},\n\t\t\t{\n\t\t\t\tenabled: this.options.rectangle,\n\t\t\t\thandler: new L.Draw.Rectangle(map, this.options.rectangle),\n\t\t\t\ttitle: L.drawLocal.draw.toolbar.buttons.rectangle\n\t\t\t},\n\t\t\t{\n\t\t\t\tenabled: this.options.circle,\n\t\t\t\thandler: new L.Draw.Circle(map, this.options.circle),\n\t\t\t\ttitle: L.drawLocal.draw.toolbar.buttons.circle\n\t\t\t},\n\t\t\t{\n\t\t\t\tenabled: this.options.marker,\n\t\t\t\thandler: new L.Draw.Marker(map, this.options.marker),\n\t\t\t\ttitle: L.drawLocal.draw.toolbar.buttons.marker\n\t\t\t}\n\t\t];\n\t},\n\n\t// Get the actions part of the toolbar\n\tgetActions: function (handler) {\n\t\treturn [\n\t\t\t{\n\t\t\t\tenabled: handler.deleteLastVertex,\n\t\t\t\ttitle: L.drawLocal.draw.toolbar.undo.title,\n\t\t\t\ttext: L.drawLocal.draw.toolbar.undo.text,\n\t\t\t\tcallback: handler.deleteLastVertex,\n\t\t\t\tcontext: handler\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: L.drawLocal.draw.toolbar.actions.title,\n\t\t\t\ttext: L.drawLocal.draw.toolbar.actions.text,\n\t\t\t\tcallback: this.disable,\n\t\t\t\tcontext: this\n\t\t\t}\n\t\t];\n\t},\n\n\tsetOptions: function (options) {\n\t\tL.setOptions(this, options);\n\n\t\tfor (var type in this._modes) {\n\t\t\tif (this._modes.hasOwnProperty(type) && options.hasOwnProperty(type)) {\n\t\t\t\tthis._modes[type].handler.setOptions(options[type]);\n\t\t\t}\n\t\t}\n\t}\n});\n\n\n/*L.Map.mergeOptions({\n\teditControl: true\n});*/\n\nL.EditToolbar = L.Toolbar.extend({\n\toptions: {\n\t\tedit: {\n\t\t\tselectedPathOptions: {\n\t\t\t\tcolor: '#fe57a1', /* Hot pink all the things! */\n\t\t\t\topacity: 0.6,\n\t\t\t\tdashArray: '10, 10',\n\n\t\t\t\tfill: true,\n\t\t\t\tfillColor: '#fe57a1',\n\t\t\t\tfillOpacity: 0.1\n\t\t\t}\n\t\t},\n\t\tremove: {},\n\t\tfeatureGroup: null /* REQUIRED! TODO: perhaps if not set then all layers on the map are selectable? */\n\t},\n\n\tinitialize: function (options) {\n\t\t// Need to set this manually since null is an acceptable value here\n\t\tif (options.edit) {\n\t\t\tif (typeof options.edit.selectedPathOptions === 'undefined') {\n\t\t\t\toptions.edit.selectedPathOptions = this.options.edit.selectedPathOptions;\n\t\t\t}\n\t\t\toptions.edit = L.extend({}, this.options.edit, options.edit);\n\t\t}\n\n\t\tif (options.remove) {\n\t\t\toptions.remove = L.extend({}, this.options.remove, options.remove);\n\t\t}\n\n\t\tthis._toolbarClass = 'leaflet-draw-edit';\n\t\tL.Toolbar.prototype.initialize.call(this, options);\n\n\t\tthis._selectedFeatureCount = 0;\n\t},\n\n\tgetModeHandlers: function (map) {\n\t\tvar featureGroup = this.options.featureGroup;\n\t\treturn [\n\t\t\t{\n\t\t\t\tenabled: this.options.edit,\n\t\t\t\thandler: new L.EditToolbar.Edit(map, {\n\t\t\t\t\tfeatureGroup: featureGroup,\n\t\t\t\t\tselectedPathOptions: this.options.edit.selectedPathOptions\n\t\t\t\t}),\n\t\t\t\ttitle: L.drawLocal.edit.toolbar.buttons.edit\n\t\t\t},\n\t\t\t{\n\t\t\t\tenabled: this.options.remove,\n\t\t\t\thandler: new L.EditToolbar.Delete(map, {\n\t\t\t\t\tfeatureGroup: featureGroup\n\t\t\t\t}),\n\t\t\t\ttitle: L.drawLocal.edit.toolbar.buttons.remove\n\t\t\t}\n\t\t];\n\t},\n\n\tgetActions: function () {\n\t\treturn [\n\t\t\t{\n\t\t\t\ttitle: L.drawLocal.edit.toolbar.actions.save.title,\n\t\t\t\ttext: L.drawLocal.edit.toolbar.actions.save.text,\n\t\t\t\tcallback: this._save,\n\t\t\t\tcontext: this\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: L.drawLocal.edit.toolbar.actions.cancel.title,\n\t\t\t\ttext: L.drawLocal.edit.toolbar.actions.cancel.text,\n\t\t\t\tcallback: this.disable,\n\t\t\t\tcontext: this\n\t\t\t}\n\t\t];\n\t},\n\n\taddToolbar: function (map) {\n\t\tvar container = L.Toolbar.prototype.addToolbar.call(this, map);\n\n\t\tthis._checkDisabled();\n\n\t\tthis.options.featureGroup.on('layeradd layerremove', this._checkDisabled, this);\n\n\t\treturn container;\n\t},\n\n\tremoveToolbar: function () {\n\t\tthis.options.featureGroup.off('layeradd layerremove', this._checkDisabled, this);\n\n\t\tL.Toolbar.prototype.removeToolbar.call(this);\n\t},\n\n\tdisable: function () {\n\t\tif (!this.enabled()) { return; }\n\n\t\tthis._activeMode.handler.revertLayers();\n\n\t\tL.Toolbar.prototype.disable.call(this);\n\t},\n\n\t_save: function () {\n\t\tthis._activeMode.handler.save();\n\t\tthis._activeMode.handler.disable();\n\t},\n\n\t_checkDisabled: function () {\n\t\tvar featureGroup = this.options.featureGroup,\n\t\t\thasLayers = featureGroup.getLayers().length !== 0,\n\t\t\tbutton;\n\n\t\tif (this.options.edit) {\n\t\t\tbutton = this._modes[L.EditToolbar.Edit.TYPE].button;\n\n\t\t\tif (hasLayers) {\n\t\t\t\tL.DomUtil.removeClass(button, 'leaflet-disabled');\n\t\t\t} else {\n\t\t\t\tL.DomUtil.addClass(button, 'leaflet-disabled');\n\t\t\t}\n\n\t\t\tbutton.setAttribute(\n\t\t\t\t'title',\n\t\t\t\thasLayers ?\n\t\t\t\tL.drawLocal.edit.toolbar.buttons.edit\n\t\t\t\t: L.drawLocal.edit.toolbar.buttons.editDisabled\n\t\t\t);\n\t\t}\n\n\t\tif (this.options.remove) {\n\t\t\tbutton = this._modes[L.EditToolbar.Delete.TYPE].button;\n\n\t\t\tif (hasLayers) {\n\t\t\t\tL.DomUtil.removeClass(button, 'leaflet-disabled');\n\t\t\t} else {\n\t\t\t\tL.DomUtil.addClass(button, 'leaflet-disabled');\n\t\t\t}\n\n\t\t\tbutton.setAttribute(\n\t\t\t\t'title',\n\t\t\t\thasLayers ?\n\t\t\t\tL.drawLocal.edit.toolbar.buttons.remove\n\t\t\t\t: L.drawLocal.edit.toolbar.buttons.removeDisabled\n\t\t\t);\n\t\t}\n\t}\n});\n\n\nL.EditToolbar.Edit = L.Handler.extend({\n\tstatics: {\n\t\tTYPE: 'edit'\n\t},\n\n\tincludes: L.Mixin.Events,\n\n\tinitialize: function (map, options) {\n\t\tL.Handler.prototype.initialize.call(this, map);\n\n\t\t// Set options to the default unless already set\n\t\tthis._selectedPathOptions = options.selectedPathOptions;\n\n\t\t// Store the selectable layer group for ease of access\n\t\tthis._featureGroup = options.featureGroup;\n\n\t\tif (!(this._featureGroup instanceof L.FeatureGroup)) {\n\t\t\tthrow new Error('options.featureGroup must be a L.FeatureGroup');\n\t\t}\n\n\t\tthis._uneditedLayerProps = {};\n\n\t\t// Save the type so super can fire, need to do this as cannot do this.TYPE :(\n\t\tthis.type = L.EditToolbar.Edit.TYPE;\n\t},\n\n\tenable: function () {\n\t\tif (this._enabled || !this._hasAvailableLayers()) {\n\t\t\treturn;\n\t\t}\n\t\tthis.fire('enabled', {handler: this.type});\n\t\t\t//this disable other handlers\n\n\t\tthis._map.fire('draw:editstart', { handler: this.type });\n\t\t\t//allow drawLayer to be updated before beginning edition.\n\n\t\tL.Handler.prototype.enable.call(this);\n\t\tthis._featureGroup\n\t\t\t.on('layeradd', this._enableLayerEdit, this)\n\t\t\t.on('layerremove', this._disableLayerEdit, this);\n\t},\n\n\tdisable: function () {\n\t\tif (!this._enabled) { return; }\n\t\tthis._featureGroup\n\t\t\t.off('layeradd', this._enableLayerEdit, this)\n\t\t\t.off('layerremove', this._disableLayerEdit, this);\n\t\tL.Handler.prototype.disable.call(this);\n\t\tthis._map.fire('draw:editstop', { handler: this.type });\n\t\tthis.fire('disabled', {handler: this.type});\n\t},\n\n\taddHooks: function () {\n\t\tvar map = this._map;\n\n\t\tif (map) {\n\t\t\tmap.getContainer().focus();\n\n\t\t\tthis._featureGroup.eachLayer(this._enableLayerEdit, this);\n\n\t\t\tthis._tooltip = new L.Tooltip(this._map);\n\t\t\tthis._tooltip.updateContent({\n\t\t\t\ttext: L.drawLocal.edit.handlers.edit.tooltip.text,\n\t\t\t\tsubtext: L.drawLocal.edit.handlers.edit.tooltip.subtext\n\t\t\t});\n\n\t\t\tthis._map.on('mousemove', this._onMouseMove, this);\n\t\t}\n\t},\n\n\tremoveHooks: function () {\n\t\tif (this._map) {\n\t\t\t// Clean up selected layers.\n\t\t\tthis._featureGroup.eachLayer(this._disableLayerEdit, this);\n\n\t\t\t// Clear the backups of the original layers\n\t\t\tthis._uneditedLayerProps = {};\n\n\t\t\tthis._tooltip.dispose();\n\t\t\tthis._tooltip = null;\n\n\t\t\tthis._map.off('mousemove', this._onMouseMove, this);\n\t\t}\n\t},\n\n\trevertLayers: function () {\n\t\tthis._featureGroup.eachLayer(function (layer) {\n\t\t\tthis._revertLayer(layer);\n\t\t}, this);\n\t},\n\n\tsave: function () {\n\t\tvar editedLayers = new L.LayerGroup();\n\t\tthis._featureGroup.eachLayer(function (layer) {\n\t\t\tif (layer.edited) {\n\t\t\t\teditedLayers.addLayer(layer);\n\t\t\t\tlayer.edited = false;\n\t\t\t}\n\t\t});\n\t\tthis._map.fire('draw:edited', {layers: editedLayers});\n\t},\n\n\t_backupLayer: function (layer) {\n\t\tvar id = L.Util.stamp(layer);\n\n\t\tif (!this._uneditedLayerProps[id]) {\n\t\t\t// Polyline, Polygon or Rectangle\n\t\t\tif (layer instanceof L.Polyline || layer instanceof L.Polygon || layer instanceof L.Rectangle) {\n\t\t\t\tthis._uneditedLayerProps[id] = {\n\t\t\t\t\tlatlngs: L.LatLngUtil.cloneLatLngs(layer.getLatLngs())\n\t\t\t\t};\n\t\t\t} else if (layer instanceof L.Circle) {\n\t\t\t\tthis._uneditedLayerProps[id] = {\n\t\t\t\t\tlatlng: L.LatLngUtil.cloneLatLng(layer.getLatLng()),\n\t\t\t\t\tradius: layer.getRadius()\n\t\t\t\t};\n\t\t\t} else if (layer instanceof L.Marker) { // Marker\n\t\t\t\tthis._uneditedLayerProps[id] = {\n\t\t\t\t\tlatlng: L.LatLngUtil.cloneLatLng(layer.getLatLng())\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t},\n\n\t_revertLayer: function (layer) {\n\t\tvar id = L.Util.stamp(layer);\n\t\tlayer.edited = false;\n\t\tif (this._uneditedLayerProps.hasOwnProperty(id)) {\n\t\t\t// Polyline, Polygon or Rectangle\n\t\t\tif (layer instanceof L.Polyline || layer instanceof L.Polygon || layer instanceof L.Rectangle) {\n\t\t\t\tlayer.setLatLngs(this._uneditedLayerProps[id].latlngs);\n\t\t\t} else if (layer instanceof L.Circle) {\n\t\t\t\tlayer.setLatLng(this._uneditedLayerProps[id].latlng);\n\t\t\t\tlayer.setRadius(this._uneditedLayerProps[id].radius);\n\t\t\t} else if (layer instanceof L.Marker) { // Marker\n\t\t\t\tlayer.setLatLng(this._uneditedLayerProps[id].latlng);\n\t\t\t}\n\t\t}\n\t},\n\n\t_toggleMarkerHighlight: function (marker) {\n\t\tif (!marker._icon) {\n\t\t\treturn;\n\t\t}\n\t\t// This is quite naughty, but I don't see another way of doing it. (short of setting a new icon)\n\t\tvar icon = marker._icon;\n\n\t\ticon.style.display = 'none';\n\n\t\tif (L.DomUtil.hasClass(icon, 'leaflet-edit-marker-selected')) {\n\t\t\tL.DomUtil.removeClass(icon, 'leaflet-edit-marker-selected');\n\t\t\t// Offset as the border will make the icon move.\n\t\t\tthis._offsetMarker(icon, -4);\n\n\t\t} else {\n\t\t\tL.DomUtil.addClass(icon, 'leaflet-edit-marker-selected');\n\t\t\t// Offset as the border will make the icon move.\n\t\t\tthis._offsetMarker(icon, 4);\n\t\t}\n\n\t\ticon.style.display = '';\n\t},\n\n\t_offsetMarker: function (icon, offset) {\n\t\tvar iconMarginTop = parseInt(icon.style.marginTop, 10) - offset,\n\t\t\ticonMarginLeft = parseInt(icon.style.marginLeft, 10) - offset;\n\n\t\ticon.style.marginTop = iconMarginTop + 'px';\n\t\ticon.style.marginLeft = iconMarginLeft + 'px';\n\t},\n\n\t_enableLayerEdit: function (e) {\n\t\tvar layer = e.layer || e.target || e,\n\t\t\tisMarker = layer instanceof L.Marker,\n\t\t\tpathOptions;\n\n\t\t// Don't do anything if this layer is a marker but doesn't have an icon. Markers\n\t\t// should usually have icons. If using Leaflet.draw with Leafler.markercluster there\n\t\t// is a chance that a marker doesn't.\n\t\tif (isMarker && !layer._icon) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Back up this layer (if haven't before)\n\t\tthis._backupLayer(layer);\n\n\t\t// Update layer style so appears editable\n\t\tif (this._selectedPathOptions) {\n\t\t\tpathOptions = L.Util.extend({}, this._selectedPathOptions);\n\n\t\t\tif (isMarker) {\n\t\t\t\tthis._toggleMarkerHighlight(layer);\n\t\t\t} else {\n\t\t\t\tlayer.options.previousOptions = L.Util.extend({ dashArray: null }, layer.options);\n\n\t\t\t\t// Make sure that Polylines are not filled\n\t\t\t\tif (!(layer instanceof L.Circle) && !(layer instanceof L.Polygon) && !(layer instanceof L.Rectangle)) {\n\t\t\t\t\tpathOptions.fill = false;\n\t\t\t\t}\n\n\t\t\t\tlayer.setStyle(pathOptions);\n\t\t\t}\n\t\t}\n\n\t\tif (isMarker) {\n\t\t\tlayer.dragging.enable();\n\t\t\tlayer.on('dragend', this._onMarkerDragEnd);\n\t\t} else {\n\t\t\tlayer.editing.enable();\n\t\t}\n\t},\n\n\t_disableLayerEdit: function (e) {\n\t\tvar layer = e.layer || e.target || e;\n\t\tlayer.edited = false;\n\n\t\t// Reset layer styles to that of before select\n\t\tif (this._selectedPathOptions) {\n\t\t\tif (layer instanceof L.Marker) {\n\t\t\t\tthis._toggleMarkerHighlight(layer);\n\t\t\t} else {\n\t\t\t\t// reset the layer style to what is was before being selected\n\t\t\t\tlayer.setStyle(layer.options.previousOptions);\n\t\t\t\t// remove the cached options for the layer object\n\t\t\t\tdelete layer.options.previousOptions;\n\t\t\t}\n\t\t}\n\n\t\tif (layer instanceof L.Marker) {\n\t\t\tlayer.dragging.disable();\n\t\t\tlayer.off('dragend', this._onMarkerDragEnd, this);\n\t\t} else {\n\t\t\tlayer.editing.disable();\n\t\t}\n\t},\n\n\t_onMarkerDragEnd: function (e) {\n\t\tvar layer = e.target;\n\t\tlayer.edited = true;\n\t},\n\n\t_onMouseMove: function (e) {\n\t\tthis._tooltip.updatePosition(e.latlng);\n\t},\n\n\t_hasAvailableLayers: function () {\n\t\treturn this._featureGroup.getLayers().length !== 0;\n\t}\n});\n\n\nL.EditToolbar.Delete = L.Handler.extend({\n\tstatics: {\n\t\tTYPE: 'remove' // not delete as delete is reserved in js\n\t},\n\n\tincludes: L.Mixin.Events,\n\n\tinitialize: function (map, options) {\n\t\tL.Handler.prototype.initialize.call(this, map);\n\n\t\tL.Util.setOptions(this, options);\n\n\t\t// Store the selectable layer group for ease of access\n\t\tthis._deletableLayers = this.options.featureGroup;\n\n\t\tif (!(this._deletableLayers instanceof L.FeatureGroup)) {\n\t\t\tthrow new Error('options.featureGroup must be a L.FeatureGroup');\n\t\t}\n\n\t\t// Save the type so super can fire, need to do this as cannot do this.TYPE :(\n\t\tthis.type = L.EditToolbar.Delete.TYPE;\n\t},\n\n\tenable: function () {\n\t\tif (this._enabled || !this._hasAvailableLayers()) {\n\t\t\treturn;\n\t\t}\n\t\tthis.fire('enabled', { handler: this.type});\n\n\t\tthis._map.fire('draw:deletestart', { handler: this.type });\n\n\t\tL.Handler.prototype.enable.call(this);\n\n\t\tthis._deletableLayers\n\t\t\t.on('layeradd', this._enableLayerDelete, this)\n\t\t\t.on('layerremove', this._disableLayerDelete, this);\n\t},\n\n\tdisable: function () {\n\t\tif (!this._enabled) { return; }\n\n\t\tthis._deletableLayers\n\t\t\t.off('layeradd', this._enableLayerDelete, this)\n\t\t\t.off('layerremove', this._disableLayerDelete, this);\n\n\t\tL.Handler.prototype.disable.call(this);\n\n\t\tthis._map.fire('draw:deletestop', { handler: this.type });\n\n\t\tthis.fire('disabled', { handler: this.type});\n\t},\n\n\taddHooks: function () {\n\t\tvar map = this._map;\n\n\t\tif (map) {\n\t\t\tmap.getContainer().focus();\n\n\t\t\tthis._deletableLayers.eachLayer(this._enableLayerDelete, this);\n\t\t\tthis._deletedLayers = new L.layerGroup();\n\n\t\t\tthis._tooltip = new L.Tooltip(this._map);\n\t\t\tthis._tooltip.updateContent({ text: L.drawLocal.edit.handlers.remove.tooltip.text });\n\n\t\t\tthis._map.on('mousemove', this._onMouseMove, this);\n\t\t}\n\t},\n\n\tremoveHooks: function () {\n\t\tif (this._map) {\n\t\t\tthis._deletableLayers.eachLayer(this._disableLayerDelete, this);\n\t\t\tthis._deletedLayers = null;\n\n\t\t\tthis._tooltip.dispose();\n\t\t\tthis._tooltip = null;\n\n\t\t\tthis._map.off('mousemove', this._onMouseMove, this);\n\t\t}\n\t},\n\n\trevertLayers: function () {\n\t\t// Iterate of the deleted layers and add them back into the featureGroup\n\t\tthis._deletedLayers.eachLayer(function (layer) {\n\t\t\tthis._deletableLayers.addLayer(layer);\n\t\t}, this);\n\t},\n\n\tsave: function () {\n\t\tthis._map.fire('draw:deleted', { layers: this._deletedLayers });\n\t},\n\n\t_enableLayerDelete: function (e) {\n\t\tvar layer = e.layer || e.target || e;\n\n\t\tlayer.on('click', this._removeLayer, this);\n\t},\n\n\t_disableLayerDelete: function (e) {\n\t\tvar layer = e.layer || e.target || e;\n\n\t\tlayer.off('click', this._removeLayer, this);\n\n\t\t// Remove from the deleted layers so we can't accidently revert if the user presses cancel\n\t\tthis._deletedLayers.removeLayer(layer);\n\t},\n\n\t_removeLayer: function (e) {\n\t\tvar layer = e.layer || e.target || e;\n\n\t\tthis._deletableLayers.removeLayer(layer);\n\n\t\tthis._deletedLayers.addLayer(layer);\n\t},\n\n\t_onMouseMove: function (e) {\n\t\tthis._tooltip.updatePosition(e.latlng);\n\t},\n\n\t_hasAvailableLayers: function () {\n\t\treturn this._deletableLayers.getLayers().length !== 0;\n\t}\n});\n\n\n}(window, document));","// Released under MIT license\n// Copyright (c) 2009-2010 Dominic Baggott\n// Copyright (c) 2009-2010 Ash Berlin\n// Copyright (c) 2011 Christoph Dorn <christoph@christophdorn.com> (http://www.christophdorn.com)\n\n/*jshint browser:true, devel:true */\n\n(function( expose ) {\n\n/**\n *  class Markdown\n *\n *  Markdown processing in Javascript done right. We have very particular views\n *  on what constitutes 'right' which include:\n *\n *  - produces well-formed HTML (this means that em and strong nesting is\n *    important)\n *\n *  - has an intermediate representation to allow processing of parsed data (We\n *    in fact have two, both as [JsonML]: a markdown tree and an HTML tree).\n *\n *  - is easily extensible to add new dialects without having to rewrite the\n *    entire parsing mechanics\n *\n *  - has a good test suite\n *\n *  This implementation fulfills all of these (except that the test suite could\n *  do with expanding to automatically run all the fixtures from other Markdown\n *  implementations.)\n *\n *  ##### Intermediate Representation\n *\n *  *TODO* Talk about this :) Its JsonML, but document the node names we use.\n *\n *  [JsonML]: http://jsonml.org/ \"JSON Markup Language\"\n **/\nvar Markdown = expose.Markdown = function(dialect) {\n  switch (typeof dialect) {\n    case \"undefined\":\n      this.dialect = Markdown.dialects.Gruber;\n      break;\n    case \"object\":\n      this.dialect = dialect;\n      break;\n    default:\n      if ( dialect in Markdown.dialects ) {\n        this.dialect = Markdown.dialects[dialect];\n      }\n      else {\n        throw new Error(\"Unknown Markdown dialect '\" + String(dialect) + \"'\");\n      }\n      break;\n  }\n  this.em_state = [];\n  this.strong_state = [];\n  this.debug_indent = \"\";\n};\n\n/**\n *  parse( markdown, [dialect] ) -> JsonML\n *  - markdown (String): markdown string to parse\n *  - dialect (String | Dialect): the dialect to use, defaults to gruber\n *\n *  Parse `markdown` and return a markdown document as a Markdown.JsonML tree.\n **/\nexpose.parse = function( source, dialect ) {\n  // dialect will default if undefined\n  var md = new Markdown( dialect );\n  return md.toTree( source );\n};\n\n/**\n *  toHTML( markdown, [dialect]  ) -> String\n *  toHTML( md_tree ) -> String\n *  - markdown (String): markdown string to parse\n *  - md_tree (Markdown.JsonML): parsed markdown tree\n *\n *  Take markdown (either as a string or as a JsonML tree) and run it through\n *  [[toHTMLTree]] then turn it into a well-formated HTML fragment.\n **/\nexpose.toHTML = function toHTML( source , dialect , options ) {\n  var input = expose.toHTMLTree( source , dialect , options );\n\n  return expose.renderJsonML( input );\n};\n\n/**\n *  toHTMLTree( markdown, [dialect] ) -> JsonML\n *  toHTMLTree( md_tree ) -> JsonML\n *  - markdown (String): markdown string to parse\n *  - dialect (String | Dialect): the dialect to use, defaults to gruber\n *  - md_tree (Markdown.JsonML): parsed markdown tree\n *\n *  Turn markdown into HTML, represented as a JsonML tree. If a string is given\n *  to this function, it is first parsed into a markdown tree by calling\n *  [[parse]].\n **/\nexpose.toHTMLTree = function toHTMLTree( input, dialect , options ) {\n  // convert string input to an MD tree\n  if ( typeof input ===\"string\" ) input = this.parse( input, dialect );\n\n  // Now convert the MD tree to an HTML tree\n\n  // remove references from the tree\n  var attrs = extract_attr( input ),\n      refs = {};\n\n  if ( attrs && attrs.references ) {\n    refs = attrs.references;\n  }\n\n  var html = convert_tree_to_html( input, refs , options );\n  merge_text_nodes( html );\n  return html;\n};\n\n// For Spidermonkey based engines\nfunction mk_block_toSource() {\n  return \"Markdown.mk_block( \" +\n          uneval(this.toString()) +\n          \", \" +\n          uneval(this.trailing) +\n          \", \" +\n          uneval(this.lineNumber) +\n          \" )\";\n}\n\n// node\nfunction mk_block_inspect() {\n  var util = require(\"util\");\n  return \"Markdown.mk_block( \" +\n          util.inspect(this.toString()) +\n          \", \" +\n          util.inspect(this.trailing) +\n          \", \" +\n          util.inspect(this.lineNumber) +\n          \" )\";\n\n}\n\nvar mk_block = Markdown.mk_block = function(block, trail, line) {\n  // Be helpful for default case in tests.\n  if ( arguments.length == 1 ) trail = \"\\n\\n\";\n\n  var s = new String(block);\n  s.trailing = trail;\n  // To make it clear its not just a string\n  s.inspect = mk_block_inspect;\n  s.toSource = mk_block_toSource;\n\n  if ( line != undefined )\n    s.lineNumber = line;\n\n  return s;\n};\n\nfunction count_lines( str ) {\n  var n = 0, i = -1;\n  while ( ( i = str.indexOf(\"\\n\", i + 1) ) !== -1 ) n++;\n  return n;\n}\n\n// Internal - split source into rough blocks\nMarkdown.prototype.split_blocks = function splitBlocks( input, startLine ) {\n  input = input.replace(/(\\r\\n|\\n|\\r)/g, \"\\n\");\n  // [\\s\\S] matches _anything_ (newline or space)\n  // [^] is equivalent but doesn't work in IEs.\n  var re = /([\\s\\S]+?)($|\\n#|\\n(?:\\s*\\n|$)+)/g,\n      blocks = [],\n      m;\n\n  var line_no = 1;\n\n  if ( ( m = /^(\\s*\\n)/.exec(input) ) != null ) {\n    // skip (but count) leading blank lines\n    line_no += count_lines( m[0] );\n    re.lastIndex = m[0].length;\n  }\n\n  while ( ( m = re.exec(input) ) !== null ) {\n    if (m[2] == \"\\n#\") {\n      m[2] = \"\\n\";\n      re.lastIndex--;\n    }\n    blocks.push( mk_block( m[1], m[2], line_no ) );\n    line_no += count_lines( m[0] );\n  }\n\n  return blocks;\n};\n\n/**\n *  Markdown#processBlock( block, next ) -> undefined | [ JsonML, ... ]\n *  - block (String): the block to process\n *  - next (Array): the following blocks\n *\n * Process `block` and return an array of JsonML nodes representing `block`.\n *\n * It does this by asking each block level function in the dialect to process\n * the block until one can. Succesful handling is indicated by returning an\n * array (with zero or more JsonML nodes), failure by a false value.\n *\n * Blocks handlers are responsible for calling [[Markdown#processInline]]\n * themselves as appropriate.\n *\n * If the blocks were split incorrectly or adjacent blocks need collapsing you\n * can adjust `next` in place using shift/splice etc.\n *\n * If any of this default behaviour is not right for the dialect, you can\n * define a `__call__` method on the dialect that will get invoked to handle\n * the block processing.\n */\nMarkdown.prototype.processBlock = function processBlock( block, next ) {\n  var cbs = this.dialect.block,\n      ord = cbs.__order__;\n\n  if ( \"__call__\" in cbs ) {\n    return cbs.__call__.call(this, block, next);\n  }\n\n  for ( var i = 0; i < ord.length; i++ ) {\n    //D:this.debug( \"Testing\", ord[i] );\n    var res = cbs[ ord[i] ].call( this, block, next );\n    if ( res ) {\n      //D:this.debug(\"  matched\");\n      if ( !isArray(res) || ( res.length > 0 && !( isArray(res[0]) ) ) )\n        this.debug(ord[i], \"didn't return a proper array\");\n      //D:this.debug( \"\" );\n      return res;\n    }\n  }\n\n  // Uhoh! no match! Should we throw an error?\n  return [];\n};\n\nMarkdown.prototype.processInline = function processInline( block ) {\n  return this.dialect.inline.__call__.call( this, String( block ) );\n};\n\n/**\n *  Markdown#toTree( source ) -> JsonML\n *  - source (String): markdown source to parse\n *\n *  Parse `source` into a JsonML tree representing the markdown document.\n **/\n// custom_tree means set this.tree to `custom_tree` and restore old value on return\nMarkdown.prototype.toTree = function toTree( source, custom_root ) {\n  var blocks = source instanceof Array ? source : this.split_blocks( source );\n\n  // Make tree a member variable so its easier to mess with in extensions\n  var old_tree = this.tree;\n  try {\n    this.tree = custom_root || this.tree || [ \"markdown\" ];\n\n    blocks:\n    while ( blocks.length ) {\n      var b = this.processBlock( blocks.shift(), blocks );\n\n      // Reference blocks and the like won't return any content\n      if ( !b.length ) continue blocks;\n\n      this.tree.push.apply( this.tree, b );\n    }\n    return this.tree;\n  }\n  finally {\n    if ( custom_root ) {\n      this.tree = old_tree;\n    }\n  }\n};\n\n// Noop by default\nMarkdown.prototype.debug = function () {\n  var args = Array.prototype.slice.call( arguments);\n  args.unshift(this.debug_indent);\n  if ( typeof print !== \"undefined\" )\n      print.apply( print, args );\n  if ( typeof console !== \"undefined\" && typeof console.log !== \"undefined\" )\n      console.log.apply( null, args );\n}\n\nMarkdown.prototype.loop_re_over_block = function( re, block, cb ) {\n  // Dont use /g regexps with this\n  var m,\n      b = block.valueOf();\n\n  while ( b.length && (m = re.exec(b) ) != null ) {\n    b = b.substr( m[0].length );\n    cb.call(this, m);\n  }\n  return b;\n};\n\n/**\n * Markdown.dialects\n *\n * Namespace of built-in dialects.\n **/\nMarkdown.dialects = {};\n\n/**\n * Markdown.dialects.Gruber\n *\n * The default dialect that follows the rules set out by John Gruber's\n * markdown.pl as closely as possible. Well actually we follow the behaviour of\n * that script which in some places is not exactly what the syntax web page\n * says.\n **/\nMarkdown.dialects.Gruber = {\n  block: {\n    atxHeader: function atxHeader( block, next ) {\n      var m = block.match( /^(#{1,6})\\s*(.*?)\\s*#*\\s*(?:\\n|$)/ );\n\n      if ( !m ) return undefined;\n\n      var header = [ \"header\", { level: m[ 1 ].length } ];\n      Array.prototype.push.apply(header, this.processInline(m[ 2 ]));\n\n      if ( m[0].length < block.length )\n        next.unshift( mk_block( block.substr( m[0].length ), block.trailing, block.lineNumber + 2 ) );\n\n      return [ header ];\n    },\n\n    setextHeader: function setextHeader( block, next ) {\n      var m = block.match( /^(.*)\\n([-=])\\2\\2+(?:\\n|$)/ );\n\n      if ( !m ) return undefined;\n\n      var level = ( m[ 2 ] === \"=\" ) ? 1 : 2;\n      var header = [ \"header\", { level : level }, m[ 1 ] ];\n\n      if ( m[0].length < block.length )\n        next.unshift( mk_block( block.substr( m[0].length ), block.trailing, block.lineNumber + 2 ) );\n\n      return [ header ];\n    },\n\n    code: function code( block, next ) {\n      // |    Foo\n      // |bar\n      // should be a code block followed by a paragraph. Fun\n      //\n      // There might also be adjacent code block to merge.\n\n      var ret = [],\n          re = /^(?: {0,3}\\t| {4})(.*)\\n?/,\n          lines;\n\n      // 4 spaces + content\n      if ( !block.match( re ) ) return undefined;\n\n      block_search:\n      do {\n        // Now pull out the rest of the lines\n        var b = this.loop_re_over_block(\n                  re, block.valueOf(), function( m ) { ret.push( m[1] ); } );\n\n        if ( b.length ) {\n          // Case alluded to in first comment. push it back on as a new block\n          next.unshift( mk_block(b, block.trailing) );\n          break block_search;\n        }\n        else if ( next.length ) {\n          // Check the next block - it might be code too\n          if ( !next[0].match( re ) ) break block_search;\n\n          // Pull how how many blanks lines follow - minus two to account for .join\n          ret.push ( block.trailing.replace(/[^\\n]/g, \"\").substring(2) );\n\n          block = next.shift();\n        }\n        else {\n          break block_search;\n        }\n      } while ( true );\n\n      return [ [ \"code_block\", ret.join(\"\\n\") ] ];\n    },\n\n    horizRule: function horizRule( block, next ) {\n      // this needs to find any hr in the block to handle abutting blocks\n      var m = block.match( /^(?:([\\s\\S]*?)\\n)?[ \\t]*([-_*])(?:[ \\t]*\\2){2,}[ \\t]*(?:\\n([\\s\\S]*))?$/ );\n\n      if ( !m ) {\n        return undefined;\n      }\n\n      var jsonml = [ [ \"hr\" ] ];\n\n      // if there's a leading abutting block, process it\n      if ( m[ 1 ] ) {\n        jsonml.unshift.apply( jsonml, this.processBlock( m[ 1 ], [] ) );\n      }\n\n      // if there's a trailing abutting block, stick it into next\n      if ( m[ 3 ] ) {\n        next.unshift( mk_block( m[ 3 ] ) );\n      }\n\n      return jsonml;\n    },\n\n    // There are two types of lists. Tight and loose. Tight lists have no whitespace\n    // between the items (and result in text just in the <li>) and loose lists,\n    // which have an empty line between list items, resulting in (one or more)\n    // paragraphs inside the <li>.\n    //\n    // There are all sorts weird edge cases about the original markdown.pl's\n    // handling of lists:\n    //\n    // * Nested lists are supposed to be indented by four chars per level. But\n    //   if they aren't, you can get a nested list by indenting by less than\n    //   four so long as the indent doesn't match an indent of an existing list\n    //   item in the 'nest stack'.\n    //\n    // * The type of the list (bullet or number) is controlled just by the\n    //    first item at the indent. Subsequent changes are ignored unless they\n    //    are for nested lists\n    //\n    lists: (function( ) {\n      // Use a closure to hide a few variables.\n      var any_list = \"[*+-]|\\\\d+\\\\.\",\n          bullet_list = /[*+-]/,\n          number_list = /\\d+\\./,\n          // Capture leading indent as it matters for determining nested lists.\n          is_list_re = new RegExp( \"^( {0,3})(\" + any_list + \")[ \\t]+\" ),\n          indent_re = \"(?: {0,3}\\\\t| {4})\";\n\n      // TODO: Cache this regexp for certain depths.\n      // Create a regexp suitable for matching an li for a given stack depth\n      function regex_for_depth( depth ) {\n\n        return new RegExp(\n          // m[1] = indent, m[2] = list_type\n          \"(?:^(\" + indent_re + \"{0,\" + depth + \"} {0,3})(\" + any_list + \")\\\\s+)|\" +\n          // m[3] = cont\n          \"(^\" + indent_re + \"{0,\" + (depth-1) + \"}[ ]{0,4})\"\n        );\n      }\n      function expand_tab( input ) {\n        return input.replace( / {0,3}\\t/g, \"    \" );\n      }\n\n      // Add inline content `inline` to `li`. inline comes from processInline\n      // so is an array of content\n      function add(li, loose, inline, nl) {\n        if ( loose ) {\n          li.push( [ \"para\" ].concat(inline) );\n          return;\n        }\n        // Hmmm, should this be any block level element or just paras?\n        var add_to = li[li.length -1] instanceof Array && li[li.length - 1][0] == \"para\"\n                   ? li[li.length -1]\n                   : li;\n\n        // If there is already some content in this list, add the new line in\n        if ( nl && li.length > 1 ) inline.unshift(nl);\n\n        for ( var i = 0; i < inline.length; i++ ) {\n          var what = inline[i],\n              is_str = typeof what == \"string\";\n          if ( is_str && add_to.length > 1 && typeof add_to[add_to.length-1] == \"string\" ) {\n            add_to[ add_to.length-1 ] += what;\n          }\n          else {\n            add_to.push( what );\n          }\n        }\n      }\n\n      // contained means have an indent greater than the current one. On\n      // *every* line in the block\n      function get_contained_blocks( depth, blocks ) {\n\n        var re = new RegExp( \"^(\" + indent_re + \"{\" + depth + \"}.*?\\\\n?)*$\" ),\n            replace = new RegExp(\"^\" + indent_re + \"{\" + depth + \"}\", \"gm\"),\n            ret = [];\n\n        while ( blocks.length > 0 ) {\n          if ( re.exec( blocks[0] ) ) {\n            var b = blocks.shift(),\n                // Now remove that indent\n                x = b.replace( replace, \"\");\n\n            ret.push( mk_block( x, b.trailing, b.lineNumber ) );\n          }\n          else {\n            break;\n          }\n        }\n        return ret;\n      }\n\n      // passed to stack.forEach to turn list items up the stack into paras\n      function paragraphify(s, i, stack) {\n        var list = s.list;\n        var last_li = list[list.length-1];\n\n        if ( last_li[1] instanceof Array && last_li[1][0] == \"para\" ) {\n          return;\n        }\n        if ( i + 1 == stack.length ) {\n          // Last stack frame\n          // Keep the same array, but replace the contents\n          last_li.push( [\"para\"].concat( last_li.splice(1, last_li.length - 1) ) );\n        }\n        else {\n          var sublist = last_li.pop();\n          last_li.push( [\"para\"].concat( last_li.splice(1, last_li.length - 1) ), sublist );\n        }\n      }\n\n      // The matcher function\n      return function( block, next ) {\n        var m = block.match( is_list_re );\n        if ( !m ) return undefined;\n\n        function make_list( m ) {\n          var list = bullet_list.exec( m[2] )\n                   ? [\"bulletlist\"]\n                   : [\"numberlist\"];\n\n          stack.push( { list: list, indent: m[1] } );\n          return list;\n        }\n\n\n        var stack = [], // Stack of lists for nesting.\n            list = make_list( m ),\n            last_li,\n            loose = false,\n            ret = [ stack[0].list ],\n            i;\n\n        // Loop to search over block looking for inner block elements and loose lists\n        loose_search:\n        while ( true ) {\n          // Split into lines preserving new lines at end of line\n          var lines = block.split( /(?=\\n)/ );\n\n          // We have to grab all lines for a li and call processInline on them\n          // once as there are some inline things that can span lines.\n          var li_accumulate = \"\";\n\n          // Loop over the lines in this block looking for tight lists.\n          tight_search:\n          for ( var line_no = 0; line_no < lines.length; line_no++ ) {\n            var nl = \"\",\n                l = lines[line_no].replace(/^\\n/, function(n) { nl = n; return \"\"; });\n\n            // TODO: really should cache this\n            var line_re = regex_for_depth( stack.length );\n\n            m = l.match( line_re );\n            //print( \"line:\", uneval(l), \"\\nline match:\", uneval(m) );\n\n            // We have a list item\n            if ( m[1] !== undefined ) {\n              // Process the previous list item, if any\n              if ( li_accumulate.length ) {\n                add( last_li, loose, this.processInline( li_accumulate ), nl );\n                // Loose mode will have been dealt with. Reset it\n                loose = false;\n                li_accumulate = \"\";\n              }\n\n              m[1] = expand_tab( m[1] );\n              var wanted_depth = Math.floor(m[1].length/4)+1;\n              //print( \"want:\", wanted_depth, \"stack:\", stack.length);\n              if ( wanted_depth > stack.length ) {\n                // Deep enough for a nested list outright\n                //print ( \"new nested list\" );\n                list = make_list( m );\n                last_li.push( list );\n                last_li = list[1] = [ \"listitem\" ];\n              }\n              else {\n                // We aren't deep enough to be strictly a new level. This is\n                // where Md.pl goes nuts. If the indent matches a level in the\n                // stack, put it there, else put it one deeper then the\n                // wanted_depth deserves.\n                var found = false;\n                for ( i = 0; i < stack.length; i++ ) {\n                  if ( stack[ i ].indent != m[1] ) continue;\n                  list = stack[ i ].list;\n                  stack.splice( i+1, stack.length - (i+1) );\n                  found = true;\n                  break;\n                }\n\n                if (!found) {\n                  //print(\"not found. l:\", uneval(l));\n                  wanted_depth++;\n                  if ( wanted_depth <= stack.length ) {\n                    stack.splice(wanted_depth, stack.length - wanted_depth);\n                    //print(\"Desired depth now\", wanted_depth, \"stack:\", stack.length);\n                    list = stack[wanted_depth-1].list;\n                    //print(\"list:\", uneval(list) );\n                  }\n                  else {\n                    //print (\"made new stack for messy indent\");\n                    list = make_list(m);\n                    last_li.push(list);\n                  }\n                }\n\n                //print( uneval(list), \"last\", list === stack[stack.length-1].list );\n                last_li = [ \"listitem\" ];\n                list.push(last_li);\n              } // end depth of shenegains\n              nl = \"\";\n            }\n\n            // Add content\n            if ( l.length > m[0].length ) {\n              li_accumulate += nl + l.substr( m[0].length );\n            }\n          } // tight_search\n\n          if ( li_accumulate.length ) {\n            add( last_li, loose, this.processInline( li_accumulate ), nl );\n            // Loose mode will have been dealt with. Reset it\n            loose = false;\n            li_accumulate = \"\";\n          }\n\n          // Look at the next block - we might have a loose list. Or an extra\n          // paragraph for the current li\n          var contained = get_contained_blocks( stack.length, next );\n\n          // Deal with code blocks or properly nested lists\n          if ( contained.length > 0 ) {\n            // Make sure all listitems up the stack are paragraphs\n            forEach( stack, paragraphify, this);\n\n            last_li.push.apply( last_li, this.toTree( contained, [] ) );\n          }\n\n          var next_block = next[0] && next[0].valueOf() || \"\";\n\n          if ( next_block.match(is_list_re) || next_block.match( /^ / ) ) {\n            block = next.shift();\n\n            // Check for an HR following a list: features/lists/hr_abutting\n            var hr = this.dialect.block.horizRule( block, next );\n\n            if ( hr ) {\n              ret.push.apply(ret, hr);\n              break;\n            }\n\n            // Make sure all listitems up the stack are paragraphs\n            forEach( stack, paragraphify, this);\n\n            loose = true;\n            continue loose_search;\n          }\n          break;\n        } // loose_search\n\n        return ret;\n      };\n    })(),\n\n    blockquote: function blockquote( block, next ) {\n      if ( !block.match( /^>/m ) )\n        return undefined;\n\n      var jsonml = [];\n\n      // separate out the leading abutting block, if any. I.e. in this case:\n      //\n      //  a\n      //  > b\n      //\n      if ( block[ 0 ] != \">\" ) {\n        var lines = block.split( /\\n/ ),\n            prev = [],\n            line_no = block.lineNumber;\n\n        // keep shifting lines until you find a crotchet\n        while ( lines.length && lines[ 0 ][ 0 ] != \">\" ) {\n            prev.push( lines.shift() );\n            line_no++;\n        }\n\n        var abutting = mk_block( prev.join( \"\\n\" ), \"\\n\", block.lineNumber );\n        jsonml.push.apply( jsonml, this.processBlock( abutting, [] ) );\n        // reassemble new block of just block quotes!\n        block = mk_block( lines.join( \"\\n\" ), block.trailing, line_no );\n      }\n\n\n      // if the next block is also a blockquote merge it in\n      while ( next.length && next[ 0 ][ 0 ] == \">\" ) {\n        var b = next.shift();\n        block = mk_block( block + block.trailing + b, b.trailing, block.lineNumber );\n      }\n\n      // Strip off the leading \"> \" and re-process as a block.\n      var input = block.replace( /^> ?/gm, \"\" ),\n          old_tree = this.tree,\n          processedBlock = this.toTree( input, [ \"blockquote\" ] ),\n          attr = extract_attr( processedBlock );\n\n      // If any link references were found get rid of them\n      if ( attr && attr.references ) {\n        delete attr.references;\n        // And then remove the attribute object if it's empty\n        if ( isEmpty( attr ) ) {\n          processedBlock.splice( 1, 1 );\n        }\n      }\n\n      jsonml.push( processedBlock );\n      return jsonml;\n    },\n\n    referenceDefn: function referenceDefn( block, next) {\n      var re = /^\\s*\\[(.*?)\\]:\\s*(\\S+)(?:\\s+(?:(['\"])(.*?)\\3|\\((.*?)\\)))?\\n?/;\n      // interesting matches are [ , ref_id, url, , title, title ]\n\n      if ( !block.match(re) )\n        return undefined;\n\n      // make an attribute node if it doesn't exist\n      if ( !extract_attr( this.tree ) ) {\n        this.tree.splice( 1, 0, {} );\n      }\n\n      var attrs = extract_attr( this.tree );\n\n      // make a references hash if it doesn't exist\n      if ( attrs.references === undefined ) {\n        attrs.references = {};\n      }\n\n      var b = this.loop_re_over_block(re, block, function( m ) {\n\n        if ( m[2] && m[2][0] == \"<\" && m[2][m[2].length-1] == \">\" )\n          m[2] = m[2].substring( 1, m[2].length - 1 );\n\n        var ref = attrs.references[ m[1].toLowerCase() ] = {\n          href: m[2]\n        };\n\n        if ( m[4] !== undefined )\n          ref.title = m[4];\n        else if ( m[5] !== undefined )\n          ref.title = m[5];\n\n      } );\n\n      if ( b.length )\n        next.unshift( mk_block( b, block.trailing ) );\n\n      return [];\n    },\n\n    para: function para( block, next ) {\n      // everything's a para!\n      return [ [\"para\"].concat( this.processInline( block ) ) ];\n    }\n  }\n};\n\nMarkdown.dialects.Gruber.inline = {\n\n    __oneElement__: function oneElement( text, patterns_or_re, previous_nodes ) {\n      var m,\n          res,\n          lastIndex = 0;\n\n      patterns_or_re = patterns_or_re || this.dialect.inline.__patterns__;\n      var re = new RegExp( \"([\\\\s\\\\S]*?)(\" + (patterns_or_re.source || patterns_or_re) + \")\" );\n\n      m = re.exec( text );\n      if (!m) {\n        // Just boring text\n        return [ text.length, text ];\n      }\n      else if ( m[1] ) {\n        // Some un-interesting text matched. Return that first\n        return [ m[1].length, m[1] ];\n      }\n\n      var res;\n      if ( m[2] in this.dialect.inline ) {\n        res = this.dialect.inline[ m[2] ].call(\n                  this,\n                  text.substr( m.index ), m, previous_nodes || [] );\n      }\n      // Default for now to make dev easier. just slurp special and output it.\n      res = res || [ m[2].length, m[2] ];\n      return res;\n    },\n\n    __call__: function inline( text, patterns ) {\n\n      var out = [],\n          res;\n\n      function add(x) {\n        //D:self.debug(\"  adding output\", uneval(x));\n        if ( typeof x == \"string\" && typeof out[out.length-1] == \"string\" )\n          out[ out.length-1 ] += x;\n        else\n          out.push(x);\n      }\n\n      while ( text.length > 0 ) {\n        res = this.dialect.inline.__oneElement__.call(this, text, patterns, out );\n        text = text.substr( res.shift() );\n        forEach(res, add )\n      }\n\n      return out;\n    },\n\n    // These characters are intersting elsewhere, so have rules for them so that\n    // chunks of plain text blocks don't include them\n    \"]\": function () {},\n    \"}\": function () {},\n\n    __escape__ : /^\\\\[\\\\`\\*_{}\\[\\]()#\\+.!\\-]/,\n\n    \"\\\\\": function escaped( text ) {\n      // [ length of input processed, node/children to add... ]\n      // Only esacape: \\ ` * _ { } [ ] ( ) # * + - . !\n      if ( this.dialect.inline.__escape__.exec( text ) )\n        return [ 2, text.charAt( 1 ) ];\n      else\n        // Not an esacpe\n        return [ 1, \"\\\\\" ];\n    },\n\n    \"![\": function image( text ) {\n\n      // Unlike images, alt text is plain text only. no other elements are\n      // allowed in there\n\n      // ![Alt text](/path/to/img.jpg \"Optional title\")\n      //      1          2            3       4         <--- captures\n      var m = text.match( /^!\\[(.*?)\\][ \\t]*\\([ \\t]*([^\")]*?)(?:[ \\t]+([\"'])(.*?)\\3)?[ \\t]*\\)/ );\n\n      if ( m ) {\n        if ( m[2] && m[2][0] == \"<\" && m[2][m[2].length-1] == \">\" )\n          m[2] = m[2].substring( 1, m[2].length - 1 );\n\n        m[2] = this.dialect.inline.__call__.call( this, m[2], /\\\\/ )[0];\n\n        var attrs = { alt: m[1], href: m[2] || \"\" };\n        if ( m[4] !== undefined)\n          attrs.title = m[4];\n\n        return [ m[0].length, [ \"img\", attrs ] ];\n      }\n\n      // ![Alt text][id]\n      m = text.match( /^!\\[(.*?)\\][ \\t]*\\[(.*?)\\]/ );\n\n      if ( m ) {\n        // We can't check if the reference is known here as it likely wont be\n        // found till after. Check it in md tree->hmtl tree conversion\n        return [ m[0].length, [ \"img_ref\", { alt: m[1], ref: m[2].toLowerCase(), original: m[0] } ] ];\n      }\n\n      // Just consume the '!['\n      return [ 2, \"![\" ];\n    },\n\n    \"[\": function link( text ) {\n\n      var orig = String(text);\n      // Inline content is possible inside `link text`\n      var res = Markdown.DialectHelpers.inline_until_char.call( this, text.substr(1), \"]\" );\n\n      // No closing ']' found. Just consume the [\n      if ( !res ) return [ 1, \"[\" ];\n\n      var consumed = 1 + res[ 0 ],\n          children = res[ 1 ],\n          link,\n          attrs;\n\n      // At this point the first [...] has been parsed. See what follows to find\n      // out which kind of link we are (reference or direct url)\n      text = text.substr( consumed );\n\n      // [link text](/path/to/img.jpg \"Optional title\")\n      //                 1            2       3         <--- captures\n      // This will capture up to the last paren in the block. We then pull\n      // back based on if there a matching ones in the url\n      //    ([here](/url/(test))\n      // The parens have to be balanced\n      var m = text.match( /^\\s*\\([ \\t]*([^\"']*)(?:[ \\t]+([\"'])(.*?)\\2)?[ \\t]*\\)/ );\n      if ( m ) {\n        var url = m[1];\n        consumed += m[0].length;\n\n        if ( url && url[0] == \"<\" && url[url.length-1] == \">\" )\n          url = url.substring( 1, url.length - 1 );\n\n        // If there is a title we don't have to worry about parens in the url\n        if ( !m[3] ) {\n          var open_parens = 1; // One open that isn't in the capture\n          for ( var len = 0; len < url.length; len++ ) {\n            switch ( url[len] ) {\n            case \"(\":\n              open_parens++;\n              break;\n            case \")\":\n              if ( --open_parens == 0) {\n                consumed -= url.length - len;\n                url = url.substring(0, len);\n              }\n              break;\n            }\n          }\n        }\n\n        // Process escapes only\n        url = this.dialect.inline.__call__.call( this, url, /\\\\/ )[0];\n\n        attrs = { href: url || \"\" };\n        if ( m[3] !== undefined)\n          attrs.title = m[3];\n\n        link = [ \"link\", attrs ].concat( children );\n        return [ consumed, link ];\n      }\n\n      // [Alt text][id]\n      // [Alt text] [id]\n      m = text.match( /^\\s*\\[(.*?)\\]/ );\n\n      if ( m ) {\n\n        consumed += m[ 0 ].length;\n\n        // [links][] uses links as its reference\n        attrs = { ref: ( m[ 1 ] || String(children) ).toLowerCase(),  original: orig.substr( 0, consumed ) };\n\n        link = [ \"link_ref\", attrs ].concat( children );\n\n        // We can't check if the reference is known here as it likely wont be\n        // found till after. Check it in md tree->hmtl tree conversion.\n        // Store the original so that conversion can revert if the ref isn't found.\n        return [ consumed, link ];\n      }\n\n      // [id]\n      // Only if id is plain (no formatting.)\n      if ( children.length == 1 && typeof children[0] == \"string\" ) {\n\n        attrs = { ref: children[0].toLowerCase(),  original: orig.substr( 0, consumed ) };\n        link = [ \"link_ref\", attrs, children[0] ];\n        return [ consumed, link ];\n      }\n\n      // Just consume the \"[\"\n      return [ 1, \"[\" ];\n    },\n\n\n    \"<\": function autoLink( text ) {\n      var m;\n\n      if ( ( m = text.match( /^<(?:((https?|ftp|mailto):[^>]+)|(.*?@.*?\\.[a-zA-Z]+))>/ ) ) != null ) {\n        if ( m[3] ) {\n          return [ m[0].length, [ \"link\", { href: \"mailto:\" + m[3] }, m[3] ] ];\n\n        }\n        else if ( m[2] == \"mailto\" ) {\n          return [ m[0].length, [ \"link\", { href: m[1] }, m[1].substr(\"mailto:\".length ) ] ];\n        }\n        else\n          return [ m[0].length, [ \"link\", { href: m[1] }, m[1] ] ];\n      }\n\n      return [ 1, \"<\" ];\n    },\n\n    \"`\": function inlineCode( text ) {\n      // Inline code block. as many backticks as you like to start it\n      // Always skip over the opening ticks.\n      var m = text.match( /(`+)(([\\s\\S]*?)\\1)/ );\n\n      if ( m && m[2] )\n        return [ m[1].length + m[2].length, [ \"inlinecode\", m[3] ] ];\n      else {\n        // TODO: No matching end code found - warn!\n        return [ 1, \"`\" ];\n      }\n    },\n\n    \"  \\n\": function lineBreak( text ) {\n      return [ 3, [ \"linebreak\" ] ];\n    }\n\n};\n\n// Meta Helper/generator method for em and strong handling\nfunction strong_em( tag, md ) {\n\n  var state_slot = tag + \"_state\",\n      other_slot = tag == \"strong\" ? \"em_state\" : \"strong_state\";\n\n  function CloseTag(len) {\n    this.len_after = len;\n    this.name = \"close_\" + md;\n  }\n\n  return function ( text, orig_match ) {\n\n    if ( this[state_slot][0] == md ) {\n      // Most recent em is of this type\n      //D:this.debug(\"closing\", md);\n      this[state_slot].shift();\n\n      // \"Consume\" everything to go back to the recrusion in the else-block below\n      return[ text.length, new CloseTag(text.length-md.length) ];\n    }\n    else {\n      // Store a clone of the em/strong states\n      var other = this[other_slot].slice(),\n          state = this[state_slot].slice();\n\n      this[state_slot].unshift(md);\n\n      //D:this.debug_indent += \"  \";\n\n      // Recurse\n      var res = this.processInline( text.substr( md.length ) );\n      //D:this.debug_indent = this.debug_indent.substr(2);\n\n      var last = res[res.length - 1];\n\n      //D:this.debug(\"processInline from\", tag + \": \", uneval( res ) );\n\n      var check = this[state_slot].shift();\n      if ( last instanceof CloseTag ) {\n        res.pop();\n        // We matched! Huzzah.\n        var consumed = text.length - last.len_after;\n        return [ consumed, [ tag ].concat(res) ];\n      }\n      else {\n        // Restore the state of the other kind. We might have mistakenly closed it.\n        this[other_slot] = other;\n        this[state_slot] = state;\n\n        // We can't reuse the processed result as it could have wrong parsing contexts in it.\n        return [ md.length, md ];\n      }\n    }\n  }; // End returned function\n}\n\nMarkdown.dialects.Gruber.inline[\"**\"] = strong_em(\"strong\", \"**\");\nMarkdown.dialects.Gruber.inline[\"__\"] = strong_em(\"strong\", \"__\");\nMarkdown.dialects.Gruber.inline[\"*\"]  = strong_em(\"em\", \"*\");\nMarkdown.dialects.Gruber.inline[\"_\"]  = strong_em(\"em\", \"_\");\n\n\n// Build default order from insertion order.\nMarkdown.buildBlockOrder = function(d) {\n  var ord = [];\n  for ( var i in d ) {\n    if ( i == \"__order__\" || i == \"__call__\" ) continue;\n    ord.push( i );\n  }\n  d.__order__ = ord;\n};\n\n// Build patterns for inline matcher\nMarkdown.buildInlinePatterns = function(d) {\n  var patterns = [];\n\n  for ( var i in d ) {\n    // __foo__ is reserved and not a pattern\n    if ( i.match( /^__.*__$/) ) continue;\n    var l = i.replace( /([\\\\.*+?|()\\[\\]{}])/g, \"\\\\$1\" )\n             .replace( /\\n/, \"\\\\n\" );\n    patterns.push( i.length == 1 ? l : \"(?:\" + l + \")\" );\n  }\n\n  patterns = patterns.join(\"|\");\n  d.__patterns__ = patterns;\n  //print(\"patterns:\", uneval( patterns ) );\n\n  var fn = d.__call__;\n  d.__call__ = function(text, pattern) {\n    if ( pattern != undefined ) {\n      return fn.call(this, text, pattern);\n    }\n    else\n    {\n      return fn.call(this, text, patterns);\n    }\n  };\n};\n\nMarkdown.DialectHelpers = {};\nMarkdown.DialectHelpers.inline_until_char = function( text, want ) {\n  var consumed = 0,\n      nodes = [];\n\n  while ( true ) {\n    if ( text.charAt( consumed ) == want ) {\n      // Found the character we were looking for\n      consumed++;\n      return [ consumed, nodes ];\n    }\n\n    if ( consumed >= text.length ) {\n      // No closing char found. Abort.\n      return null;\n    }\n\n    var res = this.dialect.inline.__oneElement__.call(this, text.substr( consumed ) );\n    consumed += res[ 0 ];\n    // Add any returned nodes.\n    nodes.push.apply( nodes, res.slice( 1 ) );\n  }\n}\n\n// Helper function to make sub-classing a dialect easier\nMarkdown.subclassDialect = function( d ) {\n  function Block() {}\n  Block.prototype = d.block;\n  function Inline() {}\n  Inline.prototype = d.inline;\n\n  return { block: new Block(), inline: new Inline() };\n};\n\nMarkdown.buildBlockOrder ( Markdown.dialects.Gruber.block );\nMarkdown.buildInlinePatterns( Markdown.dialects.Gruber.inline );\n\nMarkdown.dialects.Maruku = Markdown.subclassDialect( Markdown.dialects.Gruber );\n\nMarkdown.dialects.Maruku.processMetaHash = function processMetaHash( meta_string ) {\n  var meta = split_meta_hash( meta_string ),\n      attr = {};\n\n  for ( var i = 0; i < meta.length; ++i ) {\n    // id: #foo\n    if ( /^#/.test( meta[ i ] ) ) {\n      attr.id = meta[ i ].substring( 1 );\n    }\n    // class: .foo\n    else if ( /^\\./.test( meta[ i ] ) ) {\n      // if class already exists, append the new one\n      if ( attr[\"class\"] ) {\n        attr[\"class\"] = attr[\"class\"] + meta[ i ].replace( /./, \" \" );\n      }\n      else {\n        attr[\"class\"] = meta[ i ].substring( 1 );\n      }\n    }\n    // attribute: foo=bar\n    else if ( /\\=/.test( meta[ i ] ) ) {\n      var s = meta[ i ].split( /\\=/ );\n      attr[ s[ 0 ] ] = s[ 1 ];\n    }\n  }\n\n  return attr;\n}\n\nfunction split_meta_hash( meta_string ) {\n  var meta = meta_string.split( \"\" ),\n      parts = [ \"\" ],\n      in_quotes = false;\n\n  while ( meta.length ) {\n    var letter = meta.shift();\n    switch ( letter ) {\n      case \" \" :\n        // if we're in a quoted section, keep it\n        if ( in_quotes ) {\n          parts[ parts.length - 1 ] += letter;\n        }\n        // otherwise make a new part\n        else {\n          parts.push( \"\" );\n        }\n        break;\n      case \"'\" :\n      case '\"' :\n        // reverse the quotes and move straight on\n        in_quotes = !in_quotes;\n        break;\n      case \"\\\\\" :\n        // shift off the next letter to be used straight away.\n        // it was escaped so we'll keep it whatever it is\n        letter = meta.shift();\n      default :\n        parts[ parts.length - 1 ] += letter;\n        break;\n    }\n  }\n\n  return parts;\n}\n\nMarkdown.dialects.Maruku.block.document_meta = function document_meta( block, next ) {\n  // we're only interested in the first block\n  if ( block.lineNumber > 1 ) return undefined;\n\n  // document_meta blocks consist of one or more lines of `Key: Value\\n`\n  if ( ! block.match( /^(?:\\w+:.*\\n)*\\w+:.*$/ ) ) return undefined;\n\n  // make an attribute node if it doesn't exist\n  if ( !extract_attr( this.tree ) ) {\n    this.tree.splice( 1, 0, {} );\n  }\n\n  var pairs = block.split( /\\n/ );\n  for ( p in pairs ) {\n    var m = pairs[ p ].match( /(\\w+):\\s*(.*)$/ ),\n        key = m[ 1 ].toLowerCase(),\n        value = m[ 2 ];\n\n    this.tree[ 1 ][ key ] = value;\n  }\n\n  // document_meta produces no content!\n  return [];\n};\n\nMarkdown.dialects.Maruku.block.block_meta = function block_meta( block, next ) {\n  // check if the last line of the block is an meta hash\n  var m = block.match( /(^|\\n) {0,3}\\{:\\s*((?:\\\\\\}|[^\\}])*)\\s*\\}$/ );\n  if ( !m ) return undefined;\n\n  // process the meta hash\n  var attr = this.dialect.processMetaHash( m[ 2 ] );\n\n  var hash;\n\n  // if we matched ^ then we need to apply meta to the previous block\n  if ( m[ 1 ] === \"\" ) {\n    var node = this.tree[ this.tree.length - 1 ];\n    hash = extract_attr( node );\n\n    // if the node is a string (rather than JsonML), bail\n    if ( typeof node === \"string\" ) return undefined;\n\n    // create the attribute hash if it doesn't exist\n    if ( !hash ) {\n      hash = {};\n      node.splice( 1, 0, hash );\n    }\n\n    // add the attributes in\n    for ( a in attr ) {\n      hash[ a ] = attr[ a ];\n    }\n\n    // return nothing so the meta hash is removed\n    return [];\n  }\n\n  // pull the meta hash off the block and process what's left\n  var b = block.replace( /\\n.*$/, \"\" ),\n      result = this.processBlock( b, [] );\n\n  // get or make the attributes hash\n  hash = extract_attr( result[ 0 ] );\n  if ( !hash ) {\n    hash = {};\n    result[ 0 ].splice( 1, 0, hash );\n  }\n\n  // attach the attributes to the block\n  for ( a in attr ) {\n    hash[ a ] = attr[ a ];\n  }\n\n  return result;\n};\n\nMarkdown.dialects.Maruku.block.definition_list = function definition_list( block, next ) {\n  // one or more terms followed by one or more definitions, in a single block\n  var tight = /^((?:[^\\s:].*\\n)+):\\s+([\\s\\S]+)$/,\n      list = [ \"dl\" ],\n      i, m;\n\n  // see if we're dealing with a tight or loose block\n  if ( ( m = block.match( tight ) ) ) {\n    // pull subsequent tight DL blocks out of `next`\n    var blocks = [ block ];\n    while ( next.length && tight.exec( next[ 0 ] ) ) {\n      blocks.push( next.shift() );\n    }\n\n    for ( var b = 0; b < blocks.length; ++b ) {\n      var m = blocks[ b ].match( tight ),\n          terms = m[ 1 ].replace( /\\n$/, \"\" ).split( /\\n/ ),\n          defns = m[ 2 ].split( /\\n:\\s+/ );\n\n      // print( uneval( m ) );\n\n      for ( i = 0; i < terms.length; ++i ) {\n        list.push( [ \"dt\", terms[ i ] ] );\n      }\n\n      for ( i = 0; i < defns.length; ++i ) {\n        // run inline processing over the definition\n        list.push( [ \"dd\" ].concat( this.processInline( defns[ i ].replace( /(\\n)\\s+/, \"$1\" ) ) ) );\n      }\n    }\n  }\n  else {\n    return undefined;\n  }\n\n  return [ list ];\n};\n\n// splits on unescaped instances of @ch. If @ch is not a character the result\n// can be unpredictable\n\nMarkdown.dialects.Maruku.block.table = function table (block, next) {\n\n    var _split_on_unescaped = function(s, ch) {\n        ch = ch || '\\\\s';\n        if (ch.match(/^[\\\\|\\[\\]{}?*.+^$]$/)) { ch = '\\\\' + ch; }\n        var res = [ ],\n            r = new RegExp('^((?:\\\\\\\\.|[^\\\\\\\\' + ch + '])*)' + ch + '(.*)'),\n            m;\n        while(m = s.match(r)) {\n            res.push(m[1]);\n            s = m[2];\n        }\n        res.push(s);\n        return res;\n    }\n\n    var leading_pipe = /^ {0,3}\\|(.+)\\n {0,3}\\|\\s*([\\-:]+[\\-| :]*)\\n((?:\\s*\\|.*(?:\\n|$))*)(?=\\n|$)/,\n        // find at least an unescaped pipe in each line\n        no_leading_pipe = /^ {0,3}(\\S(?:\\\\.|[^\\\\|])*\\|.*)\\n {0,3}([\\-:]+\\s*\\|[\\-| :]*)\\n((?:(?:\\\\.|[^\\\\|])*\\|.*(?:\\n|$))*)(?=\\n|$)/,\n        i, m;\n    if (m = block.match(leading_pipe)) {\n        // remove leading pipes in contents\n        // (header and horizontal rule already have the leading pipe left out)\n        m[3] = m[3].replace(/^\\s*\\|/gm, '');\n    } else if (! ( m = block.match(no_leading_pipe))) {\n        return undefined;\n    }\n\n    var table = [ \"table\", [ \"thead\", [ \"tr\" ] ], [ \"tbody\" ] ];\n\n    // remove trailing pipes, then split on pipes\n    // (no escaped pipes are allowed in horizontal rule)\n    m[2] = m[2].replace(/\\|\\s*$/, '').split('|');\n\n    // process alignment\n    var html_attrs = [ ];\n    forEach (m[2], function (s) {\n        if (s.match(/^\\s*-+:\\s*$/))       html_attrs.push({align: \"right\"});\n        else if (s.match(/^\\s*:-+\\s*$/))  html_attrs.push({align: \"left\"});\n        else if (s.match(/^\\s*:-+:\\s*$/)) html_attrs.push({align: \"center\"});\n        else                              html_attrs.push({});\n    });\n\n    // now for the header, avoid escaped pipes\n    m[1] = _split_on_unescaped(m[1].replace(/\\|\\s*$/, ''), '|');\n    for (i = 0; i < m[1].length; i++) {\n        table[1][1].push(['th', html_attrs[i] || {}].concat(\n            this.processInline(m[1][i].trim())));\n    }\n\n    // now for body contents\n    forEach (m[3].replace(/\\|\\s*$/mg, '').split('\\n'), function (row) {\n        var html_row = ['tr'];\n        row = _split_on_unescaped(row, '|');\n        for (i = 0; i < row.length; i++) {\n            html_row.push(['td', html_attrs[i] || {}].concat(this.processInline(row[i].trim())));\n        }\n        table[2].push(html_row);\n    }, this);\n\n    return [table];\n}\n\nMarkdown.dialects.Maruku.inline[ \"{:\" ] = function inline_meta( text, matches, out ) {\n  if ( !out.length ) {\n    return [ 2, \"{:\" ];\n  }\n\n  // get the preceeding element\n  var before = out[ out.length - 1 ];\n\n  if ( typeof before === \"string\" ) {\n    return [ 2, \"{:\" ];\n  }\n\n  // match a meta hash\n  var m = text.match( /^\\{:\\s*((?:\\\\\\}|[^\\}])*)\\s*\\}/ );\n\n  // no match, false alarm\n  if ( !m ) {\n    return [ 2, \"{:\" ];\n  }\n\n  // attach the attributes to the preceeding element\n  var meta = this.dialect.processMetaHash( m[ 1 ] ),\n      attr = extract_attr( before );\n\n  if ( !attr ) {\n    attr = {};\n    before.splice( 1, 0, attr );\n  }\n\n  for ( var k in meta ) {\n    attr[ k ] = meta[ k ];\n  }\n\n  // cut out the string and replace it with nothing\n  return [ m[ 0 ].length, \"\" ];\n};\n\nMarkdown.dialects.Maruku.inline.__escape__ = /^\\\\[\\\\`\\*_{}\\[\\]()#\\+.!\\-|:]/;\n\nMarkdown.buildBlockOrder ( Markdown.dialects.Maruku.block );\nMarkdown.buildInlinePatterns( Markdown.dialects.Maruku.inline );\n\nvar isArray = Array.isArray || function(obj) {\n  return Object.prototype.toString.call(obj) == \"[object Array]\";\n};\n\nvar forEach;\n// Don't mess with Array.prototype. Its not friendly\nif ( Array.prototype.forEach ) {\n  forEach = function( arr, cb, thisp ) {\n    return arr.forEach( cb, thisp );\n  };\n}\nelse {\n  forEach = function(arr, cb, thisp) {\n    for (var i = 0; i < arr.length; i++) {\n      cb.call(thisp || arr, arr[i], i, arr);\n    }\n  }\n}\n\nvar isEmpty = function( obj ) {\n  for ( var key in obj ) {\n    if ( hasOwnProperty.call( obj, key ) ) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction extract_attr( jsonml ) {\n  return isArray(jsonml)\n      && jsonml.length > 1\n      && typeof jsonml[ 1 ] === \"object\"\n      && !( isArray(jsonml[ 1 ]) )\n      ? jsonml[ 1 ]\n      : undefined;\n}\n\n\n\n/**\n *  renderJsonML( jsonml[, options] ) -> String\n *  - jsonml (Array): JsonML array to render to XML\n *  - options (Object): options\n *\n *  Converts the given JsonML into well-formed XML.\n *\n *  The options currently understood are:\n *\n *  - root (Boolean): wether or not the root node should be included in the\n *    output, or just its children. The default `false` is to not include the\n *    root itself.\n */\nexpose.renderJsonML = function( jsonml, options ) {\n  options = options || {};\n  // include the root element in the rendered output?\n  options.root = options.root || false;\n\n  var content = [];\n\n  if ( options.root ) {\n    content.push( render_tree( jsonml ) );\n  }\n  else {\n    jsonml.shift(); // get rid of the tag\n    if ( jsonml.length && typeof jsonml[ 0 ] === \"object\" && !( jsonml[ 0 ] instanceof Array ) ) {\n      jsonml.shift(); // get rid of the attributes\n    }\n\n    while ( jsonml.length ) {\n      content.push( render_tree( jsonml.shift() ) );\n    }\n  }\n\n  return content.join( \"\\n\\n\" );\n};\n\nfunction escapeHTML( text ) {\n  return text.replace( /&/g, \"&amp;\" )\n             .replace( /</g, \"&lt;\" )\n             .replace( />/g, \"&gt;\" )\n             .replace( /\"/g, \"&quot;\" )\n             .replace( /'/g, \"&#39;\" );\n}\n\nfunction render_tree( jsonml ) {\n  // basic case\n  if ( typeof jsonml === \"string\" ) {\n    return escapeHTML( jsonml );\n  }\n\n  var tag = jsonml.shift(),\n      attributes = {},\n      content = [];\n\n  if ( jsonml.length && typeof jsonml[ 0 ] === \"object\" && !( jsonml[ 0 ] instanceof Array ) ) {\n    attributes = jsonml.shift();\n  }\n\n  while ( jsonml.length ) {\n    content.push( render_tree( jsonml.shift() ) );\n  }\n\n  var tag_attrs = \"\";\n  for ( var a in attributes ) {\n    tag_attrs += \" \" + a + '=\"' + escapeHTML( attributes[ a ] ) + '\"';\n  }\n\n  // be careful about adding whitespace here for inline elements\n  if ( tag == \"img\" || tag == \"br\" || tag == \"hr\" ) {\n    return \"<\"+ tag + tag_attrs + \"/>\";\n  }\n  else {\n    return \"<\"+ tag + tag_attrs + \">\" + content.join( \"\" ) + \"</\" + tag + \">\";\n  }\n}\n\nfunction convert_tree_to_html( tree, references, options ) {\n  var i;\n  options = options || {};\n\n  // shallow clone\n  var jsonml = tree.slice( 0 );\n\n  if ( typeof options.preprocessTreeNode === \"function\" ) {\n      jsonml = options.preprocessTreeNode(jsonml, references);\n  }\n\n  // Clone attributes if they exist\n  var attrs = extract_attr( jsonml );\n  if ( attrs ) {\n    jsonml[ 1 ] = {};\n    for ( i in attrs ) {\n      jsonml[ 1 ][ i ] = attrs[ i ];\n    }\n    attrs = jsonml[ 1 ];\n  }\n\n  // basic case\n  if ( typeof jsonml === \"string\" ) {\n    return jsonml;\n  }\n\n  // convert this node\n  switch ( jsonml[ 0 ] ) {\n    case \"header\":\n      jsonml[ 0 ] = \"h\" + jsonml[ 1 ].level;\n      delete jsonml[ 1 ].level;\n      break;\n    case \"bulletlist\":\n      jsonml[ 0 ] = \"ul\";\n      break;\n    case \"numberlist\":\n      jsonml[ 0 ] = \"ol\";\n      break;\n    case \"listitem\":\n      jsonml[ 0 ] = \"li\";\n      break;\n    case \"para\":\n      jsonml[ 0 ] = \"p\";\n      break;\n    case \"markdown\":\n      jsonml[ 0 ] = \"html\";\n      if ( attrs ) delete attrs.references;\n      break;\n    case \"code_block\":\n      jsonml[ 0 ] = \"pre\";\n      i = attrs ? 2 : 1;\n      var code = [ \"code\" ];\n      code.push.apply( code, jsonml.splice( i, jsonml.length - i ) );\n      jsonml[ i ] = code;\n      break;\n    case \"inlinecode\":\n      jsonml[ 0 ] = \"code\";\n      break;\n    case \"img\":\n      jsonml[ 1 ].src = jsonml[ 1 ].href;\n      delete jsonml[ 1 ].href;\n      break;\n    case \"linebreak\":\n      jsonml[ 0 ] = \"br\";\n    break;\n    case \"link\":\n      jsonml[ 0 ] = \"a\";\n      break;\n    case \"link_ref\":\n      jsonml[ 0 ] = \"a\";\n\n      // grab this ref and clean up the attribute node\n      var ref = references[ attrs.ref ];\n\n      // if the reference exists, make the link\n      if ( ref ) {\n        delete attrs.ref;\n\n        // add in the href and title, if present\n        attrs.href = ref.href;\n        if ( ref.title ) {\n          attrs.title = ref.title;\n        }\n\n        // get rid of the unneeded original text\n        delete attrs.original;\n      }\n      // the reference doesn't exist, so revert to plain text\n      else {\n        return attrs.original;\n      }\n      break;\n    case \"img_ref\":\n      jsonml[ 0 ] = \"img\";\n\n      // grab this ref and clean up the attribute node\n      var ref = references[ attrs.ref ];\n\n      // if the reference exists, make the link\n      if ( ref ) {\n        delete attrs.ref;\n\n        // add in the href and title, if present\n        attrs.src = ref.href;\n        if ( ref.title ) {\n          attrs.title = ref.title;\n        }\n\n        // get rid of the unneeded original text\n        delete attrs.original;\n      }\n      // the reference doesn't exist, so revert to plain text\n      else {\n        return attrs.original;\n      }\n      break;\n  }\n\n  // convert all the children\n  i = 1;\n\n  // deal with the attribute node, if it exists\n  if ( attrs ) {\n    // if there are keys, skip over it\n    for ( var key in jsonml[ 1 ] ) {\n        i = 2;\n        break;\n    }\n    // if there aren't, remove it\n    if ( i === 1 ) {\n      jsonml.splice( i, 1 );\n    }\n  }\n\n  for ( ; i < jsonml.length; ++i ) {\n    jsonml[ i ] = convert_tree_to_html( jsonml[ i ], references, options );\n  }\n\n  return jsonml;\n}\n\n\n// merges adjacent text nodes into a single node\nfunction merge_text_nodes( jsonml ) {\n  // skip the tag name and attribute hash\n  var i = extract_attr( jsonml ) ? 2 : 1;\n\n  while ( i < jsonml.length ) {\n    // if it's a string check the next item too\n    if ( typeof jsonml[ i ] === \"string\" ) {\n      if ( i + 1 < jsonml.length && typeof jsonml[ i + 1 ] === \"string\" ) {\n        // merge the second string into the first and remove it\n        jsonml[ i ] += jsonml.splice( i + 1, 1 )[ 0 ];\n      }\n      else {\n        ++i;\n      }\n    }\n    // if it's not a string recurse\n    else {\n      merge_text_nodes( jsonml[ i ] );\n      ++i;\n    }\n  }\n}\n\n} )( (function() {\n  if ( typeof exports === \"undefined\" ) {\n    window.markdown = {};\n    return window.markdown;\n  }\n  else {\n    return exports;\n  }\n} )() );\n","/**\r\n *\r\n * Date picker\r\n * Author: Stefan Petre www.eyecon.ro\r\n * \r\n * Dual licensed under the MIT and GPL licenses\r\n * \r\n */\r\n(function ($) {\r\n\tvar DatePicker = function () {\r\n\t\tvar\tids = {},\r\n\t\t\tviews = {\r\n\t\t\t\tyears: 'datepickerViewYears',\r\n\t\t\t\tmoths: 'datepickerViewMonths',\r\n\t\t\t\tdays: 'datepickerViewDays'\r\n\t\t\t},\r\n\t\t\ttpl = {\r\n\t\t\t\twrapper: '<div class=\"datepicker\"><div class=\"datepickerBorderT\" /><div class=\"datepickerBorderB\" /><div class=\"datepickerBorderL\" /><div class=\"datepickerBorderR\" /><div class=\"datepickerBorderTL\" /><div class=\"datepickerBorderTR\" /><div class=\"datepickerBorderBL\" /><div class=\"datepickerBorderBR\" /><div class=\"datepickerContainer\"><table cellspacing=\"0\" cellpadding=\"0\"><tbody><tr></tr></tbody></table></div></div>',\r\n\t\t\t\thead: [\r\n\t\t\t\t\t'<td>',\r\n\t\t\t\t\t'<table cellspacing=\"0\" cellpadding=\"0\">',\r\n\t\t\t\t\t\t'<thead>',\r\n\t\t\t\t\t\t\t'<tr>',\r\n\t\t\t\t\t\t\t\t'<th class=\"datepickerGoPrev\"><a href=\"#\"><span><%=prev%></span></a></th>',\r\n\t\t\t\t\t\t\t\t'<th colspan=\"5\" class=\"datepickerMonth\"><a href=\"#\"><span></span></a></th>',\r\n\t\t\t\t\t\t\t\t'<th class=\"datepickerGoNext\"><a href=\"#\"><span><%=next%></span></a></th>',\r\n\t\t\t\t\t\t\t'</tr>',\r\n\t\t\t\t\t\t\t'<tr class=\"datepickerDoW\">',\r\n\t\t\t\t\t\t\t\t'<th><span><%=week%></span></th>',\r\n\t\t\t\t\t\t\t\t'<th><span><%=day1%></span></th>',\r\n\t\t\t\t\t\t\t\t'<th><span><%=day2%></span></th>',\r\n\t\t\t\t\t\t\t\t'<th><span><%=day3%></span></th>',\r\n\t\t\t\t\t\t\t\t'<th><span><%=day4%></span></th>',\r\n\t\t\t\t\t\t\t\t'<th><span><%=day5%></span></th>',\r\n\t\t\t\t\t\t\t\t'<th><span><%=day6%></span></th>',\r\n\t\t\t\t\t\t\t\t'<th><span><%=day7%></span></th>',\r\n\t\t\t\t\t\t\t'</tr>',\r\n\t\t\t\t\t\t'</thead>',\r\n\t\t\t\t\t'</table></td>'\r\n\t\t\t\t],\r\n\t\t\t\tspace : '<td class=\"datepickerSpace\"><div></div></td>',\r\n\t\t\t\tdays: [\r\n\t\t\t\t\t'<tbody class=\"datepickerDays\">',\r\n\t\t\t\t\t\t'<tr>',\r\n\t\t\t\t\t\t\t'<th class=\"datepickerWeek\"><a href=\"#\"><span><%=weeks[0].week%></span></a></th>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[0].days[0].classname%>\"><a href=\"#\"><span><%=weeks[0].days[0].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[0].days[1].classname%>\"><a href=\"#\"><span><%=weeks[0].days[1].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[0].days[2].classname%>\"><a href=\"#\"><span><%=weeks[0].days[2].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[0].days[3].classname%>\"><a href=\"#\"><span><%=weeks[0].days[3].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[0].days[4].classname%>\"><a href=\"#\"><span><%=weeks[0].days[4].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[0].days[5].classname%>\"><a href=\"#\"><span><%=weeks[0].days[5].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[0].days[6].classname%>\"><a href=\"#\"><span><%=weeks[0].days[6].text%></span></a></td>',\r\n\t\t\t\t\t\t'</tr>',\r\n\t\t\t\t\t\t'<tr>',\r\n\t\t\t\t\t\t\t'<th class=\"datepickerWeek\"><a href=\"#\"><span><%=weeks[1].week%></span></a></th>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[1].days[0].classname%>\"><a href=\"#\"><span><%=weeks[1].days[0].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[1].days[1].classname%>\"><a href=\"#\"><span><%=weeks[1].days[1].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[1].days[2].classname%>\"><a href=\"#\"><span><%=weeks[1].days[2].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[1].days[3].classname%>\"><a href=\"#\"><span><%=weeks[1].days[3].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[1].days[4].classname%>\"><a href=\"#\"><span><%=weeks[1].days[4].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[1].days[5].classname%>\"><a href=\"#\"><span><%=weeks[1].days[5].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[1].days[6].classname%>\"><a href=\"#\"><span><%=weeks[1].days[6].text%></span></a></td>',\r\n\t\t\t\t\t\t'</tr>',\r\n\t\t\t\t\t\t'<tr>',\r\n\t\t\t\t\t\t\t'<th class=\"datepickerWeek\"><a href=\"#\"><span><%=weeks[2].week%></span></a></th>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[2].days[0].classname%>\"><a href=\"#\"><span><%=weeks[2].days[0].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[2].days[1].classname%>\"><a href=\"#\"><span><%=weeks[2].days[1].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[2].days[2].classname%>\"><a href=\"#\"><span><%=weeks[2].days[2].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[2].days[3].classname%>\"><a href=\"#\"><span><%=weeks[2].days[3].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[2].days[4].classname%>\"><a href=\"#\"><span><%=weeks[2].days[4].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[2].days[5].classname%>\"><a href=\"#\"><span><%=weeks[2].days[5].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[2].days[6].classname%>\"><a href=\"#\"><span><%=weeks[2].days[6].text%></span></a></td>',\r\n\t\t\t\t\t\t'</tr>',\r\n\t\t\t\t\t\t'<tr>',\r\n\t\t\t\t\t\t\t'<th class=\"datepickerWeek\"><a href=\"#\"><span><%=weeks[3].week%></span></a></th>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[3].days[0].classname%>\"><a href=\"#\"><span><%=weeks[3].days[0].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[3].days[1].classname%>\"><a href=\"#\"><span><%=weeks[3].days[1].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[3].days[2].classname%>\"><a href=\"#\"><span><%=weeks[3].days[2].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[3].days[3].classname%>\"><a href=\"#\"><span><%=weeks[3].days[3].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[3].days[4].classname%>\"><a href=\"#\"><span><%=weeks[3].days[4].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[3].days[5].classname%>\"><a href=\"#\"><span><%=weeks[3].days[5].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[3].days[6].classname%>\"><a href=\"#\"><span><%=weeks[3].days[6].text%></span></a></td>',\r\n\t\t\t\t\t\t'</tr>',\r\n\t\t\t\t\t\t'<tr>',\r\n\t\t\t\t\t\t\t'<th class=\"datepickerWeek\"><a href=\"#\"><span><%=weeks[4].week%></span></a></th>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[4].days[0].classname%>\"><a href=\"#\"><span><%=weeks[4].days[0].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[4].days[1].classname%>\"><a href=\"#\"><span><%=weeks[4].days[1].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[4].days[2].classname%>\"><a href=\"#\"><span><%=weeks[4].days[2].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[4].days[3].classname%>\"><a href=\"#\"><span><%=weeks[4].days[3].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[4].days[4].classname%>\"><a href=\"#\"><span><%=weeks[4].days[4].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[4].days[5].classname%>\"><a href=\"#\"><span><%=weeks[4].days[5].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[4].days[6].classname%>\"><a href=\"#\"><span><%=weeks[4].days[6].text%></span></a></td>',\r\n\t\t\t\t\t\t'</tr>',\r\n\t\t\t\t\t\t'<tr>',\r\n\t\t\t\t\t\t\t'<th class=\"datepickerWeek\"><a href=\"#\"><span><%=weeks[5].week%></span></a></th>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[5].days[0].classname%>\"><a href=\"#\"><span><%=weeks[5].days[0].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[5].days[1].classname%>\"><a href=\"#\"><span><%=weeks[5].days[1].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[5].days[2].classname%>\"><a href=\"#\"><span><%=weeks[5].days[2].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[5].days[3].classname%>\"><a href=\"#\"><span><%=weeks[5].days[3].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[5].days[4].classname%>\"><a href=\"#\"><span><%=weeks[5].days[4].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[5].days[5].classname%>\"><a href=\"#\"><span><%=weeks[5].days[5].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[5].days[6].classname%>\"><a href=\"#\"><span><%=weeks[5].days[6].text%></span></a></td>',\r\n\t\t\t\t\t\t'</tr>',\r\n\t\t\t\t\t'</tbody>'\r\n\t\t\t\t],\r\n\t\t\t\tmonths: [\r\n\t\t\t\t\t'<tbody class=\"<%=className%>\">',\r\n\t\t\t\t\t\t'<tr>',\r\n\t\t\t\t\t\t\t'<td colspan=\"2\"><a href=\"#\"><span><%=data[0]%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td colspan=\"2\"><a href=\"#\"><span><%=data[1]%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td colspan=\"2\"><a href=\"#\"><span><%=data[2]%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td colspan=\"2\"><a href=\"#\"><span><%=data[3]%></span></a></td>',\r\n\t\t\t\t\t\t'</tr>',\r\n\t\t\t\t\t\t'<tr>',\r\n\t\t\t\t\t\t\t'<td colspan=\"2\"><a href=\"#\"><span><%=data[4]%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td colspan=\"2\"><a href=\"#\"><span><%=data[5]%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td colspan=\"2\"><a href=\"#\"><span><%=data[6]%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td colspan=\"2\"><a href=\"#\"><span><%=data[7]%></span></a></td>',\r\n\t\t\t\t\t\t'</tr>',\r\n\t\t\t\t\t\t'<tr>',\r\n\t\t\t\t\t\t\t'<td colspan=\"2\"><a href=\"#\"><span><%=data[8]%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td colspan=\"2\"><a href=\"#\"><span><%=data[9]%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td colspan=\"2\"><a href=\"#\"><span><%=data[10]%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td colspan=\"2\"><a href=\"#\"><span><%=data[11]%></span></a></td>',\r\n\t\t\t\t\t\t'</tr>',\r\n\t\t\t\t\t'</tbody>'\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\tdefaults = {\r\n\t\t\t\tflat: false,\r\n\t\t\t\tstarts: 1,\r\n\t\t\t\tprev: '&#9664;',\r\n\t\t\t\tnext: '&#9654;',\r\n\t\t\t\tlastSel: false,\r\n\t\t\t\tmode: 'single',\r\n\t\t\t\tview: 'days',\r\n\t\t\t\tcalendars: 1,\r\n\t\t\t\tformat: 'Y-m-d',\r\n\t\t\t\tposition: 'bottom',\r\n\t\t\t\teventName: 'click',\r\n\t\t\t\tonRender: function(){return {};},\r\n\t\t\t\tonChange: function(){return true;},\r\n\t\t\t\tonShow: function(){return true;},\r\n\t\t\t\tonBeforeShow: function(){return true;},\r\n\t\t\t\tonHide: function(){return true;},\r\n\t\t\t\tlocale: {\r\n\t\t\t\t\tdays: [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\", \"Sunday\"],\r\n\t\t\t\t\tdaysShort: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\"],\r\n\t\t\t\t\tdaysMin: [\"Su\", \"Mo\", \"Tu\", \"We\", \"Th\", \"Fr\", \"Sa\", \"Su\"],\r\n\t\t\t\t\tmonths: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\r\n\t\t\t\t\tmonthsShort: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\r\n\t\t\t\t\tweekMin: 'wk'\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tfill = function(el) {\r\n\t\t\t\tvar options = $(el).data('datepicker');\r\n\t\t\t\tvar cal = $(el);\r\n\t\t\t\tvar currentCal = Math.floor(options.calendars/2), date, data, dow, month, cnt = 0, week, days, indic, indic2, html, tblCal;\r\n\t\t\t\tcal.find('td>table tbody').remove();\r\n\t\t\t\tfor (var i = 0; i < options.calendars; i++) {\r\n\t\t\t\t\tdate = new Date(options.current);\r\n\t\t\t\t\tdate.addMonths(-currentCal + i);\r\n\t\t\t\t\ttblCal = cal.find('table').eq(i+1);\r\n\t\t\t\t\tswitch (tblCal[0].className) {\r\n\t\t\t\t\t\tcase 'datepickerViewDays':\r\n\t\t\t\t\t\t\tdow = formatDate(date, 'B, Y');\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'datepickerViewMonths':\r\n\t\t\t\t\t\t\tdow = date.getFullYear();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'datepickerViewYears':\r\n\t\t\t\t\t\t\tdow = (date.getFullYear()-6) + ' - ' + (date.getFullYear()+5);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t} \r\n\t\t\t\t\ttblCal.find('thead tr:first th:eq(1) span').text(dow);\r\n\t\t\t\t\tdow = date.getFullYear()-6;\r\n\t\t\t\t\tdata = {\r\n\t\t\t\t\t\tdata: [],\r\n\t\t\t\t\t\tclassName: 'datepickerYears'\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor ( var j = 0; j < 12; j++) {\r\n\t\t\t\t\t\tdata.data.push(dow + j);\r\n\t\t\t\t\t}\r\n\t\t\t\t\thtml = tmpl(tpl.months.join(''), data);\r\n\t\t\t\t\tdate.setDate(1);\r\n\t\t\t\t\tdata = {weeks:[], test: 10};\r\n\t\t\t\t\tmonth = date.getMonth();\r\n\t\t\t\t\tvar dow = (date.getDay() - options.starts) % 7;\r\n\t\t\t\t\tdate.addDays(-(dow + (dow < 0 ? 7 : 0)));\r\n\t\t\t\t\tweek = -1;\r\n\t\t\t\t\tcnt = 0;\r\n\t\t\t\t\twhile (cnt < 42) {\r\n\t\t\t\t\t\tindic = parseInt(cnt/7,10);\r\n\t\t\t\t\t\tindic2 = cnt%7;\r\n\t\t\t\t\t\tif (!data.weeks[indic]) {\r\n\t\t\t\t\t\t\tweek = date.getWeekNumber();\r\n\t\t\t\t\t\t\tdata.weeks[indic] = {\r\n\t\t\t\t\t\t\t\tweek: week,\r\n\t\t\t\t\t\t\t\tdays: []\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdata.weeks[indic].days[indic2] = {\r\n\t\t\t\t\t\t\ttext: date.getDate(),\r\n\t\t\t\t\t\t\tclassname: []\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tif (month != date.getMonth()) {\r\n\t\t\t\t\t\t\tdata.weeks[indic].days[indic2].classname.push('datepickerNotInMonth');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (date.getDay() == 0) {\r\n\t\t\t\t\t\t\tdata.weeks[indic].days[indic2].classname.push('datepickerSunday');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (date.getDay() == 6) {\r\n\t\t\t\t\t\t\tdata.weeks[indic].days[indic2].classname.push('datepickerSaturday');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar fromUser = options.onRender(date);\r\n\t\t\t\t\t\tvar val = date.valueOf();\r\n\r\n\t\t\t\t\t\tif (val === options.date[0]) {\r\n\t\t\t\t\t\t\tdata.weeks[indic].days[indic2].classname.push('datepickerSelectedFirst');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ((val + 86399000) === options.date[1]) {\r\n\t\t\t\t\t\t\tdata.weeks[indic].days[indic2].classname.push('datepickerSelectedLast');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (fromUser.selected || options.date == val || $.inArray(val, options.date) > -1 || (options.mode == 'range' && val >= options.date[0] && val <= options.date[1])) {\r\n\t\t\t\t\t\t\tdata.weeks[indic].days[indic2].classname.push('datepickerSelected');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (fromUser.disabled) {\r\n\t\t\t\t\t\t\tdata.weeks[indic].days[indic2].classname.push('datepickerDisabled');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (fromUser.className) {\r\n\t\t\t\t\t\t\tdata.weeks[indic].days[indic2].classname.push(fromUser.className);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdata.weeks[indic].days[indic2].classname = data.weeks[indic].days[indic2].classname.join(' ');\r\n\t\t\t\t\t\tcnt++;\r\n\t\t\t\t\t\tdate.addDays(1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\thtml = tmpl(tpl.days.join(''), data) + html;\r\n\t\t\t\t\tdata = {\r\n\t\t\t\t\t\tdata: options.locale.monthsShort,\r\n\t\t\t\t\t\tclassName: 'datepickerMonths'\r\n\t\t\t\t\t};\r\n\t\t\t\t\thtml = tmpl(tpl.months.join(''), data) + html;\r\n\t\t\t\t\ttblCal.append(html);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tparseDate = function (date, format) {\r\n\t\t\t\tif (date.constructor == Date) {\r\n\t\t\t\t\treturn new Date(date);\r\n\t\t\t\t}\r\n\t\t\t\tvar parts = date.split(/\\W+/);\r\n\t\t\t\tvar against = format.split(/\\W+/), d, m, y, h, min, now = new Date();\r\n\t\t\t\tfor (var i = 0; i < parts.length; i++) {\r\n\t\t\t\t\tswitch (against[i]) {\r\n\t\t\t\t\t\tcase 'd':\r\n\t\t\t\t\t\tcase 'e':\r\n\t\t\t\t\t\t\td = parseInt(parts[i],10);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'm':\r\n\t\t\t\t\t\t\tm = parseInt(parts[i], 10)-1;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'Y':\r\n\t\t\t\t\t\tcase 'y':\r\n\t\t\t\t\t\t\ty = parseInt(parts[i], 10);\r\n\t\t\t\t\t\t\ty += y > 100 ? 0 : (y < 29 ? 2000 : 1900);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'H':\r\n\t\t\t\t\t\tcase 'I':\r\n\t\t\t\t\t\tcase 'k':\r\n\t\t\t\t\t\tcase 'l':\r\n\t\t\t\t\t\t\th = parseInt(parts[i], 10);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'P':\r\n\t\t\t\t\t\tcase 'p':\r\n\t\t\t\t\t\t\tif (/pm/i.test(parts[i]) && h < 12) {\r\n\t\t\t\t\t\t\t\th += 12;\r\n\t\t\t\t\t\t\t} else if (/am/i.test(parts[i]) && h >= 12) {\r\n\t\t\t\t\t\t\t\th -= 12;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'M':\r\n\t\t\t\t\t\t\tmin = parseInt(parts[i], 10);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn new Date(\r\n\t\t\t\t\ty === undefined ? now.getFullYear() : y,\r\n\t\t\t\t\tm === undefined ? now.getMonth() : m,\r\n\t\t\t\t\td === undefined ? now.getDate() : d,\r\n\t\t\t\t\th === undefined ? now.getHours() : h,\r\n\t\t\t\t\tmin === undefined ? now.getMinutes() : min,\r\n\t\t\t\t\t0\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tformatDate = function(date, format) {\r\n\t\t\t\tvar m = date.getMonth();\r\n\t\t\t\tvar d = date.getDate();\r\n\t\t\t\tvar y = date.getFullYear();\r\n\t\t\t\tvar wn = date.getWeekNumber();\r\n\t\t\t\tvar w = date.getDay();\r\n\t\t\t\tvar s = {};\r\n\t\t\t\tvar hr = date.getHours();\r\n\t\t\t\tvar pm = (hr >= 12);\r\n\t\t\t\tvar ir = (pm) ? (hr - 12) : hr;\r\n\t\t\t\tvar dy = date.getDayOfYear();\r\n\t\t\t\tif (ir == 0) {\r\n\t\t\t\t\tir = 12;\r\n\t\t\t\t}\r\n\t\t\t\tvar min = date.getMinutes();\r\n\t\t\t\tvar sec = date.getSeconds();\r\n\t\t\t\tvar parts = format.split(''), part;\r\n\t\t\t\tfor ( var i = 0; i < parts.length; i++ ) {\r\n\t\t\t\t\tpart = parts[i];\r\n\t\t\t\t\tswitch (parts[i]) {\r\n\t\t\t\t\t\tcase 'a':\r\n\t\t\t\t\t\t\tpart = date.getDayName();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'A':\r\n\t\t\t\t\t\t\tpart = date.getDayName(true);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'b':\r\n\t\t\t\t\t\t\tpart = date.getMonthName();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'B':\r\n\t\t\t\t\t\t\tpart = date.getMonthName(true);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'C':\r\n\t\t\t\t\t\t\tpart = 1 + Math.floor(y / 100);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'd':\r\n\t\t\t\t\t\t\tpart = (d < 10) ? (\"0\" + d) : d;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'e':\r\n\t\t\t\t\t\t\tpart = d;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'H':\r\n\t\t\t\t\t\t\tpart = (hr < 10) ? (\"0\" + hr) : hr;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'I':\r\n\t\t\t\t\t\t\tpart = (ir < 10) ? (\"0\" + ir) : ir;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'j':\r\n\t\t\t\t\t\t\tpart = (dy < 100) ? ((dy < 10) ? (\"00\" + dy) : (\"0\" + dy)) : dy;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'k':\r\n\t\t\t\t\t\t\tpart = hr;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'l':\r\n\t\t\t\t\t\t\tpart = ir;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'm':\r\n\t\t\t\t\t\t\tpart = (m < 9) ? (\"0\" + (1+m)) : (1+m);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'M':\r\n\t\t\t\t\t\t\tpart = (min < 10) ? (\"0\" + min) : min;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'p':\r\n\t\t\t\t\t\tcase 'P':\r\n\t\t\t\t\t\t\tpart = pm ? \"PM\" : \"AM\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 's':\r\n\t\t\t\t\t\t\tpart = Math.floor(date.getTime() / 1000);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'S':\r\n\t\t\t\t\t\t\tpart = (sec < 10) ? (\"0\" + sec) : sec;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'u':\r\n\t\t\t\t\t\t\tpart = w + 1;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'w':\r\n\t\t\t\t\t\t\tpart = w;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'y':\r\n\t\t\t\t\t\t\tpart = ('' + y).substr(2, 2);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'Y':\r\n\t\t\t\t\t\t\tpart = y;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tparts[i] = part;\r\n\t\t\t\t}\r\n\t\t\t\treturn parts.join('');\r\n\t\t\t},\r\n\t\t\textendDate = function(options) {\r\n\t\t\t\tif (Date.prototype.tempDate) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tDate.prototype.tempDate = null;\r\n\t\t\t\tDate.prototype.months = options.months;\r\n\t\t\t\tDate.prototype.monthsShort = options.monthsShort;\r\n\t\t\t\tDate.prototype.days = options.days;\r\n\t\t\t\tDate.prototype.daysShort = options.daysShort;\r\n\t\t\t\tDate.prototype.getMonthName = function(fullName) {\r\n\t\t\t\t\treturn this[fullName ? 'months' : 'monthsShort'][this.getMonth()];\r\n\t\t\t\t};\r\n\t\t\t\tDate.prototype.getDayName = function(fullName) {\r\n\t\t\t\t\treturn this[fullName ? 'days' : 'daysShort'][this.getDay()];\r\n\t\t\t\t};\r\n\t\t\t\tDate.prototype.addDays = function (n) {\r\n\t\t\t\t\tthis.setDate(this.getDate() + n);\r\n\t\t\t\t\tthis.tempDate = this.getDate();\r\n\t\t\t\t};\r\n\t\t\t\tDate.prototype.addMonths = function (n) {\r\n\t\t\t\t\tif (this.tempDate == null) {\r\n\t\t\t\t\t\tthis.tempDate = this.getDate();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.setDate(1);\r\n\t\t\t\t\tthis.setMonth(this.getMonth() + n);\r\n\t\t\t\t\tthis.setDate(Math.min(this.tempDate, this.getMaxDays()));\r\n\t\t\t\t};\r\n\t\t\t\tDate.prototype.addYears = function (n) {\r\n\t\t\t\t\tif (this.tempDate == null) {\r\n\t\t\t\t\t\tthis.tempDate = this.getDate();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.setDate(1);\r\n\t\t\t\t\tthis.setFullYear(this.getFullYear() + n);\r\n\t\t\t\t\tthis.setDate(Math.min(this.tempDate, this.getMaxDays()));\r\n\t\t\t\t};\r\n\t\t\t\tDate.prototype.getMaxDays = function() {\r\n\t\t\t\t\tvar tmpDate = new Date(Date.parse(this)),\r\n\t\t\t\t\t\td = 28, m;\r\n\t\t\t\t\tm = tmpDate.getMonth();\r\n\t\t\t\t\td = 28;\r\n\t\t\t\t\twhile (tmpDate.getMonth() == m) {\r\n\t\t\t\t\t\td ++;\r\n\t\t\t\t\t\ttmpDate.setDate(d);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn d - 1;\r\n\t\t\t\t};\r\n\t\t\t\tDate.prototype.getFirstDay = function() {\r\n\t\t\t\t\tvar tmpDate = new Date(Date.parse(this));\r\n\t\t\t\t\ttmpDate.setDate(1);\r\n\t\t\t\t\treturn tmpDate.getDay();\r\n\t\t\t\t};\r\n\t\t\t\tDate.prototype.getWeekNumber = function() {\r\n\t\t\t\t\tvar tempDate = new Date(this);\r\n\t\t\t\t\ttempDate.setDate(tempDate.getDate() - (tempDate.getDay() + 6) % 7 + 3);\r\n\t\t\t\t\tvar dms = tempDate.valueOf();\r\n\t\t\t\t\ttempDate.setMonth(0);\r\n\t\t\t\t\ttempDate.setDate(4);\r\n\t\t\t\t\treturn Math.round((dms - tempDate.valueOf()) / (604800000)) + 1;\r\n\t\t\t\t};\r\n\t\t\t\tDate.prototype.getDayOfYear = function() {\r\n\t\t\t\t\tvar now = new Date(this.getFullYear(), this.getMonth(), this.getDate(), 0, 0, 0);\r\n\t\t\t\t\tvar then = new Date(this.getFullYear(), 0, 0, 0, 0, 0);\r\n\t\t\t\t\tvar time = now - then;\r\n\t\t\t\t\treturn Math.floor(time / 24*60*60*1000);\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tlayout = function (el) {\r\n\t\t\t\tvar options = $(el).data('datepicker');\r\n\t\t\t\tvar cal = $('#' + options.id);\r\n\t\t\t\tif (!options.extraHeight) {\r\n\t\t\t\t\tvar divs = $(el).find('div');\r\n\t\t\t\t\toptions.extraHeight = divs.get(0).offsetHeight + divs.get(1).offsetHeight;\r\n\t\t\t\t\toptions.extraWidth = divs.get(2).offsetWidth + divs.get(3).offsetWidth;\r\n\t\t\t\t}\r\n\t\t\t\tvar tbl = cal.find('table:first').get(0);\r\n\t\t\t\tvar width = tbl.offsetWidth;\r\n\t\t\t\tvar height = tbl.offsetHeight;\r\n\t\t\t\tcal.css({\r\n\t\t\t\t\twidth: width + options.extraWidth + 'px',\r\n\t\t\t\t\theight: height + options.extraHeight + 'px'\r\n\t\t\t\t}).find('div.datepickerContainer').css({\r\n\t\t\t\t\twidth: width + 'px',\r\n\t\t\t\t\theight: height + 'px'\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tclick = function(ev) {\r\n\t\t\t\tif ($(ev.target).is('span')) {\r\n\t\t\t\t\tev.target = ev.target.parentNode;\r\n\t\t\t\t}\r\n\t\t\t\tvar el = $(ev.target);\r\n\t\t\t\tif (el.is('a')) {\r\n\t\t\t\t\tev.target.blur();\r\n\t\t\t\t\tif (el.hasClass('datepickerDisabled')) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar options = $(this).data('datepicker');\r\n\t\t\t\t\tvar parentEl = el.parent();\r\n\t\t\t\t\tvar tblEl = parentEl.parent().parent().parent();\r\n\t\t\t\t\tvar tblIndex = $('table', this).index(tblEl.get(0)) - 1;\r\n\t\t\t\t\tvar tmp = new Date(options.current);\r\n\t\t\t\t\tvar changed = false;\r\n\t\t\t\t\tvar fillIt = false;\r\n\t\t\t\t\tif (parentEl.is('th')) {\r\n\t\t\t\t\t\tif (parentEl.hasClass('datepickerWeek') && options.mode == 'range' && !parentEl.next().hasClass('datepickerDisabled')) {\r\n\t\t\t\t\t\t\tvar val = parseInt(parentEl.next().text(), 10);\r\n\t\t\t\t\t\t\ttmp.addMonths(tblIndex - Math.floor(options.calendars/2));\r\n\t\t\t\t\t\t\tif (parentEl.next().hasClass('datepickerNotInMonth')) {\r\n\t\t\t\t\t\t\t\ttmp.addMonths(val > 15 ? -1 : 1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttmp.setDate(val);\r\n\t\t\t\t\t\t\toptions.date[0] = (tmp.setHours(0,0,0,0)).valueOf();\r\n\t\t\t\t\t\t\ttmp.setHours(23,59,59,0);\r\n\t\t\t\t\t\t\ttmp.addDays(6);\r\n\t\t\t\t\t\t\toptions.date[1] = tmp.valueOf();\r\n\t\t\t\t\t\t\tfillIt = true;\r\n\t\t\t\t\t\t\tchanged = true;\r\n\t\t\t\t\t\t\toptions.lastSel = false;\r\n\t\t\t\t\t\t} else if (parentEl.hasClass('datepickerMonth')) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t// tmp.addMonths(tblIndex - Math.floor(options.calendars/2));\r\n\t\t\t\t\t\t\t// switch (tblEl.get(0).className) {\r\n\t\t\t\t\t\t\t// \tcase 'datepickerViewDays':\r\n\t\t\t\t\t\t\t// \t\ttblEl.get(0).className = 'datepickerViewMonths';\r\n\t\t\t\t\t\t\t// \t\tel.find('span').text(tmp.getFullYear());\r\n\t\t\t\t\t\t\t// \t\tbreak;\r\n\t\t\t\t\t\t\t// \tcase 'datepickerViewMonths':\r\n\t\t\t\t\t\t\t// \t\ttblEl.get(0).className = 'datepickerViewYears';\r\n\t\t\t\t\t\t\t// \t\tel.find('span').text((tmp.getFullYear()-6) + ' - ' + (tmp.getFullYear()+5));\r\n\t\t\t\t\t\t\t// \t\tbreak;\r\n\t\t\t\t\t\t\t// \tcase 'datepickerViewYears':\r\n\t\t\t\t\t\t\t// \t\ttblEl.get(0).className = 'datepickerViewDays';\r\n\t\t\t\t\t\t\t// \t\tel.find('span').text(formatDate(tmp, 'B, Y'));\r\n\t\t\t\t\t\t\t// \t\tbreak;\r\n\t\t\t\t\t\t\t// }\r\n\t\t\t\t\t\t} else if (parentEl.parent().parent().is('thead')) {\r\n\t\t\t\t\t\t\tswitch (tblEl.get(0).className) {\r\n\t\t\t\t\t\t\t\tcase 'datepickerViewDays':\r\n\t\t\t\t\t\t\t\t\toptions.current.addMonths(parentEl.hasClass('datepickerGoPrev') ? -1 : 1);\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 'datepickerViewMonths':\r\n\t\t\t\t\t\t\t\t\toptions.current.addYears(parentEl.hasClass('datepickerGoPrev') ? -1 : 1);\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 'datepickerViewYears':\r\n\t\t\t\t\t\t\t\t\toptions.current.addYears(parentEl.hasClass('datepickerGoPrev') ? -12 : 12);\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfillIt = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (parentEl.is('td') && !parentEl.hasClass('datepickerDisabled')) {\r\n\t\t\t\t\t\tswitch (tblEl.get(0).className) {\r\n\t\t\t\t\t\t\tcase 'datepickerViewMonths':\r\n\t\t\t\t\t\t\t\toptions.current.setMonth(tblEl.find('tbody.datepickerMonths td').index(parentEl));\r\n\t\t\t\t\t\t\t\toptions.current.setFullYear(parseInt(tblEl.find('thead th.datepickerMonth span').text(), 10));\r\n\t\t\t\t\t\t\t\toptions.current.addMonths(Math.floor(options.calendars/2) - tblIndex);\r\n\t\t\t\t\t\t\t\ttblEl.get(0).className = 'datepickerViewDays';\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'datepickerViewYears':\r\n\t\t\t\t\t\t\t\toptions.current.setFullYear(parseInt(el.text(), 10));\r\n\t\t\t\t\t\t\t\ttblEl.get(0).className = 'datepickerViewMonths';\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\tvar val = parseInt(el.text(), 10);\r\n\t\t\t\t\t\t\t\ttmp.addMonths(tblIndex - Math.floor(options.calendars/2));\r\n\t\t\t\t\t\t\t\tif (parentEl.hasClass('datepickerNotInMonth')) {\r\n\t\t\t\t\t\t\t\t\ttmp.addMonths(val > 15 ? -1 : 1);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\ttmp.setDate(val);\r\n\t\t\t\t\t\t\t\tswitch (options.mode) {\r\n\t\t\t\t\t\t\t\t\tcase 'multiple':\r\n\t\t\t\t\t\t\t\t\t\tval = (tmp.setHours(0,0,0,0)).valueOf();\r\n\t\t\t\t\t\t\t\t\t\tif ($.inArray(val, options.date) > -1) {\r\n\t\t\t\t\t\t\t\t\t\t\t$.each(options.date, function(nr, dat){\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (dat == val) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\toptions.date.splice(nr,1);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\toptions.date.push(val);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\tcase 'range':\r\n\t\t\t\t\t\t\t\t\t\tif (!options.lastSel) {\r\n\t\t\t\t\t\t\t\t\t\t\toptions.date[0] = (tmp.setHours(0,0,0,0)).valueOf();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tval = (tmp.setHours(23,59,59,0)).valueOf();\r\n\t\t\t\t\t\t\t\t\t\tif (val < options.date[0]) {\r\n\t\t\t\t\t\t\t\t\t\t\toptions.date[1] = options.date[0] + 86399000;\r\n\t\t\t\t\t\t\t\t\t\t\toptions.date[0] = val - 86399000;\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\toptions.date[1] = val;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\toptions.lastSel = !options.lastSel;\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\t\t\toptions.date = tmp.valueOf();\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfillIt = true;\r\n\t\t\t\t\t\tchanged = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (fillIt) {\r\n\t\t\t\t\t\tfill(this);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (changed) {\r\n\t\t\t\t\t\toptions.onChange.apply(this, prepareDate(options));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tprepareDate = function (options) {\r\n\t\t\t\tvar tmp;\r\n\t\t\t\tif (options.mode == 'single') {\r\n\t\t\t\t\ttmp = new Date(options.date);\r\n\t\t\t\t\treturn [formatDate(tmp, options.format), tmp, options.el];\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttmp = [[],[], options.el];\r\n\t\t\t\t\t$.each(options.date, function(nr, val){\r\n\t\t\t\t\t\tvar date = new Date(val);\r\n\t\t\t\t\t\ttmp[0].push(formatDate(date, options.format));\r\n\t\t\t\t\t\ttmp[1].push(date);\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn tmp;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetViewport = function () {\r\n\t\t\t\tvar m = document.compatMode == 'CSS1Compat';\r\n\t\t\t\treturn {\r\n\t\t\t\t\tl : window.pageXOffset || (m ? document.documentElement.scrollLeft : document.body.scrollLeft),\r\n\t\t\t\t\tt : window.pageYOffset || (m ? document.documentElement.scrollTop : document.body.scrollTop),\r\n\t\t\t\t\tw : window.innerWidth || (m ? document.documentElement.clientWidth : document.body.clientWidth),\r\n\t\t\t\t\th : window.innerHeight || (m ? document.documentElement.clientHeight : document.body.clientHeight)\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tisChildOf = function(parentEl, el, container) {\r\n\t\t\t\tif (parentEl == el) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\tif (parentEl.contains) {\r\n\t\t\t\t\treturn parentEl.contains(el);\r\n\t\t\t\t}\r\n\t\t\t\tif ( parentEl.compareDocumentPosition ) {\r\n\t\t\t\t\treturn !!(parentEl.compareDocumentPosition(el) & 16);\r\n\t\t\t\t}\r\n\t\t\t\tvar prEl = el.parentNode;\r\n\t\t\t\twhile(prEl && prEl != container) {\r\n\t\t\t\t\tif (prEl == parentEl)\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\tprEl = prEl.parentNode;\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tshow = function (ev) {\r\n\t\t\t\tvar cal = $('#' + $(this).data('datepickerId'));\r\n\t\t\t\tif (!cal.is(':visible')) {\r\n\t\t\t\t\tvar calEl = cal.get(0);\r\n\t\t\t\t\tfill(calEl);\r\n\t\t\t\t\tvar options = cal.data('datepicker');\r\n\t\t\t\t\toptions.onBeforeShow.apply(this, [cal.get(0)]);\r\n\t\t\t\t\tvar pos = $(this).offset();\r\n\t\t\t\t\tvar viewPort = getViewport();\r\n\t\t\t\t\tvar top = pos.top;\r\n\t\t\t\t\tvar left = pos.left;\r\n\t\t\t\t\tvar oldDisplay = $.curCSS(calEl, 'display');\r\n\t\t\t\t\tcal.css({\r\n\t\t\t\t\t\tvisibility: 'hidden',\r\n\t\t\t\t\t\tdisplay: 'block'\r\n\t\t\t\t\t});\r\n\t\t\t\t\tlayout(calEl);\r\n\t\t\t\t\tswitch (options.position){\r\n\t\t\t\t\t\tcase 'top':\r\n\t\t\t\t\t\t\ttop -= calEl.offsetHeight;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'left':\r\n\t\t\t\t\t\t\tleft -= calEl.offsetWidth;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'right':\r\n\t\t\t\t\t\t\tleft += this.offsetWidth;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'bottom':\r\n\t\t\t\t\t\t\ttop += this.offsetHeight;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (top + calEl.offsetHeight > viewPort.t + viewPort.h) {\r\n\t\t\t\t\t\ttop = pos.top  - calEl.offsetHeight;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (top < viewPort.t) {\r\n\t\t\t\t\t\ttop = pos.top + this.offsetHeight + calEl.offsetHeight;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (left + calEl.offsetWidth > viewPort.l + viewPort.w) {\r\n\t\t\t\t\t\tleft = pos.left - calEl.offsetWidth;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (left < viewPort.l) {\r\n\t\t\t\t\t\tleft = pos.left + this.offsetWidth\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcal.css({\r\n\t\t\t\t\t\tvisibility: 'visible',\r\n\t\t\t\t\t\tdisplay: 'block',\r\n\t\t\t\t\t\ttop: top + 'px',\r\n\t\t\t\t\t\tleft: left + 'px'\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (options.onShow.apply(this, [cal.get(0)]) != false) {\r\n\t\t\t\t\t\tcal.show();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$(document).bind('mousedown', {cal: cal, trigger: this}, hide);\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\thide = function (ev) {\r\n\t\t\t\tif (ev.target != ev.data.trigger && !isChildOf(ev.data.cal.get(0), ev.target, ev.data.cal.get(0))) {\r\n\t\t\t\t\tif (ev.data.cal.data('datepicker').onHide.apply(this, [ev.data.cal.get(0)]) != false) {\r\n\t\t\t\t\t\tev.data.cal.hide();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$(document).unbind('mousedown', hide);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\treturn {\r\n\t\t\tinit: function(options){\r\n\t\t\t\toptions = $.extend({}, defaults, options||{});\r\n\t\t\t\textendDate(options.locale);\r\n\t\t\t\toptions.calendars = Math.max(1, parseInt(options.calendars,10)||1);\r\n\t\t\t\toptions.mode = /single|multiple|range/.test(options.mode) ? options.mode : 'single';\r\n\t\t\t\treturn this.each(function(){\r\n\t\t\t\t\tif (!$(this).data('datepicker')) {\r\n\t\t\t\t\t\toptions.el = this;\r\n\t\t\t\t\t\tif (options.date.constructor == String) {\r\n\t\t\t\t\t\t\toptions.date = parseDate(options.date, options.format);\r\n\t\t\t\t\t\t\toptions.date.setHours(0,0,0,0);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (options.mode != 'single') {\r\n\t\t\t\t\t\t\tif (options.date.constructor != Array) {\r\n\t\t\t\t\t\t\t\toptions.date = [options.date.valueOf()];\r\n\t\t\t\t\t\t\t\tif (options.mode == 'range') {\r\n\t\t\t\t\t\t\t\t\toptions.date.push(((new Date(options.date[0])).setHours(23,59,59,0)).valueOf());\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tfor (var i = 0; i < options.date.length; i++) {\r\n\t\t\t\t\t\t\t\t\toptions.date[i] = (parseDate(options.date[i], options.format).setHours(0,0,0,0)).valueOf();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (options.mode == 'range') {\r\n\t\t\t\t\t\t\t\t\toptions.date[1] = ((new Date(options.date[1])).setHours(23,59,59,0)).valueOf();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\toptions.date = options.date.valueOf();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!options.current) {\r\n\t\t\t\t\t\t\toptions.current = new Date();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\toptions.current = parseDate(options.current, options.format);\r\n\t\t\t\t\t\t} \r\n\t\t\t\t\t\toptions.current.setDate(1);\r\n\t\t\t\t\t\toptions.current.setHours(0,0,0,0);\r\n\t\t\t\t\t\tvar id = 'datepicker_' + parseInt(Math.random() * 1000), cnt;\r\n\t\t\t\t\t\toptions.id = id;\r\n\t\t\t\t\t\t$(this).data('datepickerId', options.id);\r\n\t\t\t\t\t\tvar cal = $(tpl.wrapper).attr('id', id).bind('click', click).data('datepicker', options);\r\n\t\t\t\t\t\tif (options.className) {\r\n\t\t\t\t\t\t\tcal.addClass(options.className);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = '';\r\n\t\t\t\t\t\tfor (var i = 0; i < options.calendars; i++) {\r\n\t\t\t\t\t\t\tcnt = options.starts;\r\n\t\t\t\t\t\t\tif (i > 0) {\r\n\t\t\t\t\t\t\t\thtml += tpl.space;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\thtml += tmpl(tpl.head.join(''), {\r\n\t\t\t\t\t\t\t\t\tweek: options.locale.weekMin,\r\n\t\t\t\t\t\t\t\t\tprev: options.prev,\r\n\t\t\t\t\t\t\t\t\tnext: options.next,\r\n\t\t\t\t\t\t\t\t\tday1: options.locale.daysMin[(cnt++)%7],\r\n\t\t\t\t\t\t\t\t\tday2: options.locale.daysMin[(cnt++)%7],\r\n\t\t\t\t\t\t\t\t\tday3: options.locale.daysMin[(cnt++)%7],\r\n\t\t\t\t\t\t\t\t\tday4: options.locale.daysMin[(cnt++)%7],\r\n\t\t\t\t\t\t\t\t\tday5: options.locale.daysMin[(cnt++)%7],\r\n\t\t\t\t\t\t\t\t\tday6: options.locale.daysMin[(cnt++)%7],\r\n\t\t\t\t\t\t\t\t\tday7: options.locale.daysMin[(cnt++)%7]\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcal\r\n\t\t\t\t\t\t\t.find('tr:first').append(html)\r\n\t\t\t\t\t\t\t\t.find('table').addClass(views[options.view]);\r\n\t\t\t\t\t\tfill(cal.get(0));\r\n\t\t\t\t\t\tif (options.flat) {\r\n\t\t\t\t\t\t\tcal.appendTo(this).show().css('position', 'relative');\r\n\t\t\t\t\t\t\tlayout(cal.get(0));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcal.appendTo(document.body);\r\n\t\t\t\t\t\t\t$(this).bind(options.eventName, show);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tshowPicker: function() {\r\n\t\t\t\treturn this.each( function () {\r\n\t\t\t\t\tif ($(this).data('datepickerId')) {\r\n\t\t\t\t\t\tshow.apply(this);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\thidePicker: function() {\r\n\t\t\t\treturn this.each( function () {\r\n\t\t\t\t\tif ($(this).data('datepickerId')) {\r\n\t\t\t\t\t\t$('#' + $(this).data('datepickerId')).hide();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tsetDate: function(date, shiftTo){\r\n\t\t\t\treturn this.each(function(){\r\n\t\t\t\t\tif ($(this).data('datepickerId')) {\r\n\t\t\t\t\t\tvar cal = $('#' + $(this).data('datepickerId'));\r\n\t\t\t\t\t\tvar options = cal.data('datepicker');\r\n\t\t\t\t\t\toptions.date = date;\r\n\t\t\t\t\t\tif (options.date.constructor == String) {\r\n\t\t\t\t\t\t\toptions.date = parseDate(options.date, options.format);\r\n\t\t\t\t\t\t\toptions.date.setHours(0,0,0,0);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (options.mode != 'single') {\r\n\t\t\t\t\t\t\tif (options.date.constructor != Array) {\r\n\t\t\t\t\t\t\t\toptions.date = [options.date.valueOf()];\r\n\t\t\t\t\t\t\t\tif (options.mode == 'range') {\r\n\t\t\t\t\t\t\t\t\toptions.date.push(((new Date(options.date[0])).setHours(23,59,59,0)).valueOf());\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tfor (var i = 0; i < options.date.length; i++) {\r\n\t\t\t\t\t\t\t\t\toptions.date[i] = (parseDate(options.date[i], options.format).setHours(0,0,0,0)).valueOf();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (options.mode == 'range') {\r\n\t\t\t\t\t\t\t\t\toptions.date[1] = ((new Date(options.date[1])).setHours(23,59,59,0)).valueOf();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\toptions.date = options.date.valueOf();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (shiftTo) {\r\n\t\t\t\t\t\t\toptions.current = new Date (options.mode != 'single' ? options.date[0] : options.date);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfill(cal.get(0));\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tgetDate: function(formated) {\r\n\t\t\t\tif (this.size() > 0) {\r\n\t\t\t\t\treturn prepareDate($('#' + $(this).data('datepickerId')).data('datepicker'))[formated ? 0 : 1];\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tclear: function(){\r\n\t\t\t\treturn this.each(function(){\r\n\t\t\t\t\tif ($(this).data('datepickerId')) {\r\n\t\t\t\t\t\tvar cal = $('#' + $(this).data('datepickerId'));\r\n\t\t\t\t\t\tvar options = cal.data('datepicker');\r\n\t\t\t\t\t\tif (options.mode != 'single') {\r\n\t\t\t\t\t\t\toptions.date = [];\r\n\t\t\t\t\t\t\tfill(cal.get(0));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tfixLayout: function(){\r\n\t\t\t\treturn this.each(function(){\r\n\t\t\t\t\tif ($(this).data('datepickerId')) {\r\n\t\t\t\t\t\tvar cal = $('#' + $(this).data('datepickerId'));\r\n\t\t\t\t\t\tvar options = cal.data('datepicker');\r\n\t\t\t\t\t\tif (options.flat) {\r\n\t\t\t\t\t\t\tlayout(cal.get(0));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\t}();\r\n\t$.fn.extend({\r\n\t\tDatePicker: DatePicker.init,\r\n\t\tDatePickerHide: DatePicker.hidePicker,\r\n\t\tDatePickerShow: DatePicker.showPicker,\r\n\t\tDatePickerSetDate: DatePicker.setDate,\r\n\t\tDatePickerGetDate: DatePicker.getDate,\r\n\t\tDatePickerClear: DatePicker.clear,\r\n\t\tDatePickerLayout: DatePicker.fixLayout\r\n\t});\r\n})(jQuery);\r\n\r\n(function(){\r\n  var cache = {};\r\n \r\n  this.tmpl = function tmpl(str, data){\r\n    // Figure out if we're getting a template, or if we need to\r\n    // load the template - and be sure to cache the result.\r\n    var fn = !/\\W/.test(str) ?\r\n      cache[str] = cache[str] ||\r\n        tmpl(document.getElementById(str).innerHTML) :\r\n     \r\n      // Generate a reusable function that will serve as a template\r\n      // generator (and which will be cached).\r\n      new Function(\"obj\",\r\n        \"var p=[],print=function(){p.push.apply(p,arguments);};\" +\r\n       \r\n        // Introduce the data as local variables using with(){}\r\n        \"with(obj){p.push('\" +\r\n       \r\n        // Convert the template into pure JavaScript\r\n        str\r\n          .replace(/[\\r\\t\\n]/g, \" \")\r\n          .split(\"<%\").join(\"\\t\")\r\n          .replace(/((^|%>)[^\\t]*)'/g, \"$1\\r\")\r\n          .replace(/\\t=(.*?)%>/g, \"',$1,'\")\r\n          .split(\"\\t\").join(\"');\")\r\n          .split(\"%>\").join(\"p.push('\")\r\n          .split(\"\\r\").join(\"\\\\'\")\r\n      + \"');}return p.join('');\");\r\n   \r\n    // Provide some basic currying to the user\r\n    return data ? fn( data ) : fn;\r\n  };\r\n})();","\n(function() {\n  var Dragster,\n    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };\n\n  Dragster = (function() {\n    function Dragster(el) {\n      this.el = el;\n      this.dragleave = __bind(this.dragleave, this);\n      this.dragenter = __bind(this.dragenter, this);\n      if (this.supportsEventConstructors()) {\n        this.first = false;\n        this.second = false;\n        this.el.addEventListener(\"dragenter\", this.dragenter, false);\n        this.el.addEventListener(\"dragleave\", this.dragleave, false);\n      }\n    }\n\n    Dragster.prototype.dragenter = function(event) {\n      if (this.first) {\n        return this.second = true;\n      } else {\n        this.first = true;\n        return this.el.dispatchEvent(new CustomEvent(\"dragster:enter\", {\n          bubbles: true,\n          cancelable: true,\n          detail: {\n            dataTransfer: event.dataTransfer\n          }\n        }));\n      }\n    };\n\n    Dragster.prototype.dragleave = function(event) {\n      if (this.second) {\n        this.second = false;\n      } else if (this.first) {\n        this.first = false;\n      }\n      if (!this.first && !this.second) {\n        return this.el.dispatchEvent(new CustomEvent(\"dragster:leave\", {\n          bubbles: true,\n          cancelable: true,\n          detail: {\n            dataTransfer: event.dataTransfer\n          }\n        }));\n      }\n    };\n\n    Dragster.prototype.removeListeners = function() {\n      this.el.removeEventListener(\"dragenter\", this.dragenter, false);\n      return this.el.removeEventListener(\"dragleave\", this.dragleave, false);\n    };\n\n    Dragster.prototype.supportsEventConstructors = function() {\n      try {\n        new CustomEvent(\"z\");\n      } catch (_error) {\n        return false;\n      }\n      return true;\n    };\n\n    Dragster.prototype.reset = function() {\n      this.first = false;\n      return this.second = false;\n    };\n\n    return Dragster;\n\n  })();\n\n  window.Dragster = Dragster;\n\n}).call(this);\n","\n/*\n *\n * More info at [www.dropzonejs.com](http://www.dropzonejs.com)\n *\n * Copyright (c) 2012, Matias Meno\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n *\n */\n\n(function() {\n  var Dropzone, Emitter, camelize, contentLoaded, detectVerticalSquash, drawImageIOSFix, noop, without,\n    __slice = [].slice,\n    __hasProp = {}.hasOwnProperty,\n    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\n  noop = function() {};\n\n  Emitter = (function() {\n    function Emitter() {}\n\n    Emitter.prototype.addEventListener = Emitter.prototype.on;\n\n    Emitter.prototype.on = function(event, fn) {\n      this._callbacks = this._callbacks || {};\n      if (!this._callbacks[event]) {\n        this._callbacks[event] = [];\n      }\n      this._callbacks[event].push(fn);\n      return this;\n    };\n\n    Emitter.prototype.emit = function() {\n      var args, callback, callbacks, event, _i, _len;\n      event = arguments[0], args = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n      this._callbacks = this._callbacks || {};\n      callbacks = this._callbacks[event];\n      if (callbacks) {\n        for (_i = 0, _len = callbacks.length; _i < _len; _i++) {\n          callback = callbacks[_i];\n          callback.apply(this, args);\n        }\n      }\n      return this;\n    };\n\n    Emitter.prototype.removeListener = Emitter.prototype.off;\n\n    Emitter.prototype.removeAllListeners = Emitter.prototype.off;\n\n    Emitter.prototype.removeEventListener = Emitter.prototype.off;\n\n    Emitter.prototype.off = function(event, fn) {\n      var callback, callbacks, i, _i, _len;\n      if (!this._callbacks || arguments.length === 0) {\n        this._callbacks = {};\n        return this;\n      }\n      callbacks = this._callbacks[event];\n      if (!callbacks) {\n        return this;\n      }\n      if (arguments.length === 1) {\n        delete this._callbacks[event];\n        return this;\n      }\n      for (i = _i = 0, _len = callbacks.length; _i < _len; i = ++_i) {\n        callback = callbacks[i];\n        if (callback === fn) {\n          callbacks.splice(i, 1);\n          break;\n        }\n      }\n      return this;\n    };\n\n    return Emitter;\n\n  })();\n\n  Dropzone = (function(_super) {\n    var extend, resolveOption;\n\n    __extends(Dropzone, _super);\n\n    Dropzone.prototype.Emitter = Emitter;\n\n\n    /*\n    This is a list of all available events you can register on a dropzone object.\n    \n    You can register an event handler like this:\n    \n        dropzone.on(\"dragEnter\", function() { });\n     */\n\n    Dropzone.prototype.events = [\"drop\", \"dragstart\", \"dragend\", \"dragenter\", \"dragover\", \"dragleave\", \"addedfile\", \"removedfile\", \"thumbnail\", \"error\", \"errormultiple\", \"processing\", \"processingmultiple\", \"uploadprogress\", \"totaluploadprogress\", \"sending\", \"sendingmultiple\", \"success\", \"successmultiple\", \"canceled\", \"canceledmultiple\", \"complete\", \"completemultiple\", \"reset\", \"maxfilesexceeded\", \"maxfilesreached\", \"queuecomplete\"];\n\n    Dropzone.prototype.defaultOptions = {\n      url: null,\n      method: \"post\",\n      withCredentials: false,\n      parallelUploads: 2,\n      uploadMultiple: false,\n      maxFilesize: 256,\n      paramName: \"file\",\n      createImageThumbnails: true,\n      maxThumbnailFilesize: 10,\n      thumbnailWidth: 120,\n      thumbnailHeight: 120,\n      filesizeBase: 1000,\n      maxFiles: null,\n      filesizeBase: 1000,\n      params: {},\n      clickable: true,\n      ignoreHiddenFiles: true,\n      acceptedFiles: null,\n      acceptedMimeTypes: null,\n      autoProcessQueue: true,\n      autoQueue: true,\n      addRemoveLinks: false,\n      previewsContainer: null,\n      capture: null,\n      dictDefaultMessage: \"Drop files here to upload\",\n      dictFallbackMessage: \"Your browser does not support drag'n'drop file uploads.\",\n      dictFallbackText: \"Please use the fallback form below to upload your files like in the olden days.\",\n      dictFileTooBig: \"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.\",\n      dictInvalidFileType: \"You can't upload files of this type.\",\n      dictResponseError: \"Server responded with {{statusCode}} code.\",\n      dictCancelUpload: \"Cancel upload\",\n      dictCancelUploadConfirmation: \"Are you sure you want to cancel this upload?\",\n      dictRemoveFile: \"Remove file\",\n      dictRemoveFileConfirmation: null,\n      dictMaxFilesExceeded: \"You can not upload any more files.\",\n      accept: function(file, done) {\n        return done();\n      },\n      init: function() {\n        return noop;\n      },\n      forceFallback: false,\n      fallback: function() {\n        var child, messageElement, span, _i, _len, _ref;\n        this.element.className = \"\" + this.element.className + \" dz-browser-not-supported\";\n        _ref = this.element.getElementsByTagName(\"div\");\n        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n          child = _ref[_i];\n          if (/(^| )dz-message($| )/.test(child.className)) {\n            messageElement = child;\n            child.className = \"dz-message\";\n            continue;\n          }\n        }\n        if (!messageElement) {\n          messageElement = Dropzone.createElement(\"<div class=\\\"dz-message\\\"><span></span></div>\");\n          this.element.appendChild(messageElement);\n        }\n        span = messageElement.getElementsByTagName(\"span\")[0];\n        if (span) {\n          span.textContent = this.options.dictFallbackMessage;\n        }\n        return this.element.appendChild(this.getFallbackForm());\n      },\n      resize: function(file) {\n        var info, srcRatio, trgRatio;\n        info = {\n          srcX: 0,\n          srcY: 0,\n          srcWidth: file.width,\n          srcHeight: file.height\n        };\n        srcRatio = file.width / file.height;\n        info.optWidth = this.options.thumbnailWidth;\n        info.optHeight = this.options.thumbnailHeight;\n        if ((info.optWidth == null) && (info.optHeight == null)) {\n          info.optWidth = info.srcWidth;\n          info.optHeight = info.srcHeight;\n        } else if (info.optWidth == null) {\n          info.optWidth = srcRatio * info.optHeight;\n        } else if (info.optHeight == null) {\n          info.optHeight = (1 / srcRatio) * info.optWidth;\n        }\n        trgRatio = info.optWidth / info.optHeight;\n        if (file.height < info.optHeight || file.width < info.optWidth) {\n          info.trgHeight = info.srcHeight;\n          info.trgWidth = info.srcWidth;\n        } else {\n          if (srcRatio > trgRatio) {\n            info.srcHeight = file.height;\n            info.srcWidth = info.srcHeight * trgRatio;\n          } else {\n            info.srcWidth = file.width;\n            info.srcHeight = info.srcWidth / trgRatio;\n          }\n        }\n        info.srcX = (file.width - info.srcWidth) / 2;\n        info.srcY = (file.height - info.srcHeight) / 2;\n        return info;\n      },\n\n      /*\n      Those functions register themselves to the events on init and handle all\n      the user interface specific stuff. Overwriting them won't break the upload\n      but can break the way it's displayed.\n      You can overwrite them if you don't like the default behavior. If you just\n      want to add an additional event handler, register it on the dropzone object\n      and don't overwrite those options.\n       */\n      drop: function(e) {\n        return this.element.classList.remove(\"dz-drag-hover\");\n      },\n      dragstart: noop,\n      dragend: function(e) {\n        return this.element.classList.remove(\"dz-drag-hover\");\n      },\n      dragenter: function(e) {\n        return this.element.classList.add(\"dz-drag-hover\");\n      },\n      dragover: function(e) {\n        return this.element.classList.add(\"dz-drag-hover\");\n      },\n      dragleave: function(e) {\n        return this.element.classList.remove(\"dz-drag-hover\");\n      },\n      paste: noop,\n      reset: function() {\n        return this.element.classList.remove(\"dz-started\");\n      },\n      addedfile: function(file) {\n        var node, removeFileEvent, removeLink, _i, _j, _k, _len, _len1, _len2, _ref, _ref1, _ref2, _results;\n        if (this.element === this.previewsContainer) {\n          this.element.classList.add(\"dz-started\");\n        }\n        if (this.previewsContainer) {\n          file.previewElement = Dropzone.createElement(this.options.previewTemplate.trim());\n          file.previewTemplate = file.previewElement;\n          this.previewsContainer.appendChild(file.previewElement);\n          _ref = file.previewElement.querySelectorAll(\"[data-dz-name]\");\n          for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n            node = _ref[_i];\n            node.textContent = file.name;\n          }\n          _ref1 = file.previewElement.querySelectorAll(\"[data-dz-size]\");\n          for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {\n            node = _ref1[_j];\n            node.innerHTML = this.filesize(file.size);\n          }\n          if (this.options.addRemoveLinks) {\n            file._removeLink = Dropzone.createElement(\"<a class=\\\"dz-remove\\\" href=\\\"javascript:undefined;\\\" data-dz-remove>\" + this.options.dictRemoveFile + \"</a>\");\n            file.previewElement.appendChild(file._removeLink);\n          }\n          removeFileEvent = (function(_this) {\n            return function(e) {\n              e.preventDefault();\n              e.stopPropagation();\n              if (file.status === Dropzone.UPLOADING) {\n                return Dropzone.confirm(_this.options.dictCancelUploadConfirmation, function() {\n                  return _this.removeFile(file);\n                });\n              } else {\n                if (_this.options.dictRemoveFileConfirmation) {\n                  return Dropzone.confirm(_this.options.dictRemoveFileConfirmation, function() {\n                    return _this.removeFile(file);\n                  });\n                } else {\n                  return _this.removeFile(file);\n                }\n              }\n            };\n          })(this);\n          _ref2 = file.previewElement.querySelectorAll(\"[data-dz-remove]\");\n          _results = [];\n          for (_k = 0, _len2 = _ref2.length; _k < _len2; _k++) {\n            removeLink = _ref2[_k];\n            _results.push(removeLink.addEventListener(\"click\", removeFileEvent));\n          }\n          return _results;\n        }\n      },\n      removedfile: function(file) {\n        var _ref;\n        if (file.previewElement) {\n          if ((_ref = file.previewElement) != null) {\n            _ref.parentNode.removeChild(file.previewElement);\n          }\n        }\n        return this._updateMaxFilesReachedClass();\n      },\n      thumbnail: function(file, dataUrl) {\n        var thumbnailElement, _i, _len, _ref;\n        if (file.previewElement) {\n          file.previewElement.classList.remove(\"dz-file-preview\");\n          _ref = file.previewElement.querySelectorAll(\"[data-dz-thumbnail]\");\n          for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n            thumbnailElement = _ref[_i];\n            thumbnailElement.alt = file.name;\n            thumbnailElement.src = dataUrl;\n          }\n          return setTimeout(((function(_this) {\n            return function() {\n              return file.previewElement.classList.add(\"dz-image-preview\");\n            };\n          })(this)), 1);\n        }\n      },\n      error: function(file, message) {\n        var node, _i, _len, _ref, _results;\n        if (file.previewElement) {\n          file.previewElement.classList.add(\"dz-error\");\n          if (typeof message !== \"String\" && message.error) {\n            message = message.error;\n          }\n          _ref = file.previewElement.querySelectorAll(\"[data-dz-errormessage]\");\n          _results = [];\n          for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n            node = _ref[_i];\n            _results.push(node.textContent = message);\n          }\n          return _results;\n        }\n      },\n      errormultiple: noop,\n      processing: function(file) {\n        if (file.previewElement) {\n          file.previewElement.classList.add(\"dz-processing\");\n          if (file._removeLink) {\n            return file._removeLink.textContent = this.options.dictCancelUpload;\n          }\n        }\n      },\n      processingmultiple: noop,\n      uploadprogress: function(file, progress, bytesSent) {\n        var node, _i, _len, _ref, _results;\n        if (file.previewElement) {\n          _ref = file.previewElement.querySelectorAll(\"[data-dz-uploadprogress]\");\n          _results = [];\n          for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n            node = _ref[_i];\n            if (node.nodeName === 'PROGRESS') {\n              _results.push(node.value = progress);\n            } else {\n              _results.push(node.style.width = \"\" + progress + \"%\");\n            }\n          }\n          return _results;\n        }\n      },\n      totaluploadprogress: noop,\n      sending: noop,\n      sendingmultiple: noop,\n      success: function(file) {\n        if (file.previewElement) {\n          return file.previewElement.classList.add(\"dz-success\");\n        }\n      },\n      successmultiple: noop,\n      canceled: function(file) {\n        return this.emit(\"error\", file, \"Upload canceled.\");\n      },\n      canceledmultiple: noop,\n      complete: function(file) {\n        if (file._removeLink) {\n          file._removeLink.textContent = this.options.dictRemoveFile;\n        }\n        if (file.previewElement) {\n          return file.previewElement.classList.add(\"dz-complete\");\n        }\n      },\n      completemultiple: noop,\n      maxfilesexceeded: noop,\n      maxfilesreached: noop,\n      queuecomplete: noop,\n      previewTemplate: \"<div class=\\\"dz-preview dz-file-preview\\\">\\n  <div class=\\\"dz-image\\\"><img data-dz-thumbnail /></div>\\n  <div class=\\\"dz-details\\\">\\n    <div class=\\\"dz-size\\\"><span data-dz-size></span></div>\\n    <div class=\\\"dz-filename\\\"><span data-dz-name></span></div>\\n  </div>\\n  <div class=\\\"dz-progress\\\"><span class=\\\"dz-upload\\\" data-dz-uploadprogress></span></div>\\n  <div class=\\\"dz-error-message\\\"><span data-dz-errormessage></span></div>\\n  <div class=\\\"dz-success-mark\\\">\\n    <svg width=\\\"54px\\\" height=\\\"54px\\\" viewBox=\\\"0 0 54 54\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" xmlns:sketch=\\\"http://www.bohemiancoding.com/sketch/ns\\\">\\n      <title>Check</title>\\n      <defs></defs>\\n      <g id=\\\"Page-1\\\" stroke=\\\"none\\\" stroke-width=\\\"1\\\" fill=\\\"none\\\" fill-rule=\\\"evenodd\\\" sketch:type=\\\"MSPage\\\">\\n        <path d=\\\"M23.5,31.8431458 L17.5852419,25.9283877 C16.0248253,24.3679711 13.4910294,24.366835 11.9289322,25.9289322 C10.3700136,27.4878508 10.3665912,30.0234455 11.9283877,31.5852419 L20.4147581,40.0716123 C20.5133999,40.1702541 20.6159315,40.2626649 20.7218615,40.3488435 C22.2835669,41.8725651 24.794234,41.8626202 26.3461564,40.3106978 L43.3106978,23.3461564 C44.8771021,21.7797521 44.8758057,19.2483887 43.3137085,17.6862915 C41.7547899,16.1273729 39.2176035,16.1255422 37.6538436,17.6893022 L23.5,31.8431458 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z\\\" id=\\\"Oval-2\\\" stroke-opacity=\\\"0.198794158\\\" stroke=\\\"#747474\\\" fill-opacity=\\\"0.816519475\\\" fill=\\\"#FFFFFF\\\" sketch:type=\\\"MSShapeGroup\\\"></path>\\n      </g>\\n    </svg>\\n  </div>\\n  <div class=\\\"dz-error-mark\\\">\\n    <svg width=\\\"54px\\\" height=\\\"54px\\\" viewBox=\\\"0 0 54 54\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" xmlns:sketch=\\\"http://www.bohemiancoding.com/sketch/ns\\\">\\n      <title>Error</title>\\n      <defs></defs>\\n      <g id=\\\"Page-1\\\" stroke=\\\"none\\\" stroke-width=\\\"1\\\" fill=\\\"none\\\" fill-rule=\\\"evenodd\\\" sketch:type=\\\"MSPage\\\">\\n        <g id=\\\"Check-+-Oval-2\\\" sketch:type=\\\"MSLayerGroup\\\" stroke=\\\"#747474\\\" stroke-opacity=\\\"0.198794158\\\" fill=\\\"#FFFFFF\\\" fill-opacity=\\\"0.816519475\\\">\\n          <path d=\\\"M32.6568542,29 L38.3106978,23.3461564 C39.8771021,21.7797521 39.8758057,19.2483887 38.3137085,17.6862915 C36.7547899,16.1273729 34.2176035,16.1255422 32.6538436,17.6893022 L27,23.3431458 L21.3461564,17.6893022 C19.7823965,16.1255422 17.2452101,16.1273729 15.6862915,17.6862915 C14.1241943,19.2483887 14.1228979,21.7797521 15.6893022,23.3461564 L21.3431458,29 L15.6893022,34.6538436 C14.1228979,36.2202479 14.1241943,38.7516113 15.6862915,40.3137085 C17.2452101,41.8726271 19.7823965,41.8744578 21.3461564,40.3106978 L27,34.6568542 L32.6538436,40.3106978 C34.2176035,41.8744578 36.7547899,41.8726271 38.3137085,40.3137085 C39.8758057,38.7516113 39.8771021,36.2202479 38.3106978,34.6538436 L32.6568542,29 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z\\\" id=\\\"Oval-2\\\" sketch:type=\\\"MSShapeGroup\\\"></path>\\n        </g>\\n      </g>\\n    </svg>\\n  </div>\\n</div>\"\n    };\n\n    extend = function() {\n      var key, object, objects, target, val, _i, _len;\n      target = arguments[0], objects = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n      for (_i = 0, _len = objects.length; _i < _len; _i++) {\n        object = objects[_i];\n        for (key in object) {\n          val = object[key];\n          target[key] = val;\n        }\n      }\n      return target;\n    };\n\n    function Dropzone(element, options) {\n      var elementOptions, fallback, _ref;\n      this.element = element;\n      this.version = Dropzone.version;\n      this.defaultOptions.previewTemplate = this.defaultOptions.previewTemplate.replace(/\\n*/g, \"\");\n      this.clickableElements = [];\n      this.listeners = [];\n      this.files = [];\n      if (typeof this.element === \"string\") {\n        this.element = document.querySelector(this.element);\n      }\n      if (!(this.element && (this.element.nodeType != null))) {\n        throw new Error(\"Invalid dropzone element.\");\n      }\n      if (this.element.dropzone) {\n        throw new Error(\"Dropzone already attached.\");\n      }\n      Dropzone.instances.push(this);\n      this.element.dropzone = this;\n      elementOptions = (_ref = Dropzone.optionsForElement(this.element)) != null ? _ref : {};\n      this.options = extend({}, this.defaultOptions, elementOptions, options != null ? options : {});\n      if (this.options.forceFallback || !Dropzone.isBrowserSupported()) {\n        return this.options.fallback.call(this);\n      }\n      if (this.options.url == null) {\n        this.options.url = this.element.getAttribute(\"action\");\n      }\n      if (!this.options.url) {\n        throw new Error(\"No URL provided.\");\n      }\n      if (this.options.acceptedFiles && this.options.acceptedMimeTypes) {\n        throw new Error(\"You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.\");\n      }\n      if (this.options.acceptedMimeTypes) {\n        this.options.acceptedFiles = this.options.acceptedMimeTypes;\n        delete this.options.acceptedMimeTypes;\n      }\n      this.options.method = this.options.method.toUpperCase();\n      if ((fallback = this.getExistingFallback()) && fallback.parentNode) {\n        fallback.parentNode.removeChild(fallback);\n      }\n      if (this.options.previewsContainer !== false) {\n        if (this.options.previewsContainer) {\n          this.previewsContainer = Dropzone.getElement(this.options.previewsContainer, \"previewsContainer\");\n        } else {\n          this.previewsContainer = this.element;\n        }\n      }\n      if (this.options.clickable) {\n        if (this.options.clickable === true) {\n          this.clickableElements = [this.element];\n        } else {\n          this.clickableElements = Dropzone.getElements(this.options.clickable, \"clickable\");\n        }\n      }\n      this.init();\n    }\n\n    Dropzone.prototype.getAcceptedFiles = function() {\n      var file, _i, _len, _ref, _results;\n      _ref = this.files;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        file = _ref[_i];\n        if (file.accepted) {\n          _results.push(file);\n        }\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.getRejectedFiles = function() {\n      var file, _i, _len, _ref, _results;\n      _ref = this.files;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        file = _ref[_i];\n        if (!file.accepted) {\n          _results.push(file);\n        }\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.getFilesWithStatus = function(status) {\n      var file, _i, _len, _ref, _results;\n      _ref = this.files;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        file = _ref[_i];\n        if (file.status === status) {\n          _results.push(file);\n        }\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.getQueuedFiles = function() {\n      return this.getFilesWithStatus(Dropzone.QUEUED);\n    };\n\n    Dropzone.prototype.getUploadingFiles = function() {\n      return this.getFilesWithStatus(Dropzone.UPLOADING);\n    };\n\n    Dropzone.prototype.getActiveFiles = function() {\n      var file, _i, _len, _ref, _results;\n      _ref = this.files;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        file = _ref[_i];\n        if (file.status === Dropzone.UPLOADING || file.status === Dropzone.QUEUED) {\n          _results.push(file);\n        }\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.init = function() {\n      var eventName, noPropagation, setupHiddenFileInput, _i, _len, _ref, _ref1;\n      if (this.element.tagName === \"form\") {\n        this.element.setAttribute(\"enctype\", \"multipart/form-data\");\n      }\n      if (this.element.classList.contains(\"dropzone\") && !this.element.querySelector(\".dz-message\")) {\n        this.element.appendChild(Dropzone.createElement(\"<div class=\\\"dz-default dz-message\\\"><span>\" + this.options.dictDefaultMessage + \"</span></div>\"));\n      }\n      if (this.clickableElements.length) {\n        setupHiddenFileInput = (function(_this) {\n          return function() {\n            if (_this.hiddenFileInput) {\n              document.body.removeChild(_this.hiddenFileInput);\n            }\n            _this.hiddenFileInput = document.createElement(\"input\");\n            _this.hiddenFileInput.setAttribute(\"type\", \"file\");\n            if ((_this.options.maxFiles == null) || _this.options.maxFiles > 1) {\n              _this.hiddenFileInput.setAttribute(\"multiple\", \"multiple\");\n            }\n            _this.hiddenFileInput.className = \"dz-hidden-input\";\n            if (_this.options.acceptedFiles != null) {\n              _this.hiddenFileInput.setAttribute(\"accept\", _this.options.acceptedFiles);\n            }\n            if (_this.options.capture != null) {\n              _this.hiddenFileInput.setAttribute(\"capture\", _this.options.capture);\n            }\n            _this.hiddenFileInput.style.visibility = \"hidden\";\n            _this.hiddenFileInput.style.position = \"absolute\";\n            _this.hiddenFileInput.style.top = \"0\";\n            _this.hiddenFileInput.style.left = \"0\";\n            _this.hiddenFileInput.style.height = \"0\";\n            _this.hiddenFileInput.style.width = \"0\";\n            document.body.appendChild(_this.hiddenFileInput);\n            return _this.hiddenFileInput.addEventListener(\"change\", function() {\n              var file, files, _i, _len;\n              files = _this.hiddenFileInput.files;\n              if (files.length) {\n                for (_i = 0, _len = files.length; _i < _len; _i++) {\n                  file = files[_i];\n                  _this.addFile(file);\n                }\n              }\n              return setupHiddenFileInput();\n            });\n          };\n        })(this);\n        setupHiddenFileInput();\n      }\n      this.URL = (_ref = window.URL) != null ? _ref : window.webkitURL;\n      _ref1 = this.events;\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        eventName = _ref1[_i];\n        this.on(eventName, this.options[eventName]);\n      }\n      this.on(\"uploadprogress\", (function(_this) {\n        return function() {\n          return _this.updateTotalUploadProgress();\n        };\n      })(this));\n      this.on(\"removedfile\", (function(_this) {\n        return function() {\n          return _this.updateTotalUploadProgress();\n        };\n      })(this));\n      this.on(\"canceled\", (function(_this) {\n        return function(file) {\n          return _this.emit(\"complete\", file);\n        };\n      })(this));\n      this.on(\"complete\", (function(_this) {\n        return function(file) {\n          if (_this.getUploadingFiles().length === 0 && _this.getQueuedFiles().length === 0) {\n            return setTimeout((function() {\n              return _this.emit(\"queuecomplete\");\n            }), 0);\n          }\n        };\n      })(this));\n      noPropagation = function(e) {\n        e.stopPropagation();\n        if (e.preventDefault) {\n          return e.preventDefault();\n        } else {\n          return e.returnValue = false;\n        }\n      };\n      this.listeners = [\n        {\n          element: this.element,\n          events: {\n            \"dragstart\": (function(_this) {\n              return function(e) {\n                return _this.emit(\"dragstart\", e);\n              };\n            })(this),\n            \"dragenter\": (function(_this) {\n              return function(e) {\n                noPropagation(e);\n                return _this.emit(\"dragenter\", e);\n              };\n            })(this),\n            \"dragover\": (function(_this) {\n              return function(e) {\n                var efct;\n                try {\n                  efct = e.dataTransfer.effectAllowed;\n                } catch (_error) {}\n                e.dataTransfer.dropEffect = 'move' === efct || 'linkMove' === efct ? 'move' : 'copy';\n                noPropagation(e);\n                return _this.emit(\"dragover\", e);\n              };\n            })(this),\n            \"dragleave\": (function(_this) {\n              return function(e) {\n                return _this.emit(\"dragleave\", e);\n              };\n            })(this),\n            \"drop\": (function(_this) {\n              return function(e) {\n                noPropagation(e);\n                return _this.drop(e);\n              };\n            })(this),\n            \"dragend\": (function(_this) {\n              return function(e) {\n                return _this.emit(\"dragend\", e);\n              };\n            })(this)\n          }\n        }\n      ];\n      this.clickableElements.forEach((function(_this) {\n        return function(clickableElement) {\n          return _this.listeners.push({\n            element: clickableElement,\n            events: {\n              \"click\": function(evt) {\n                if ((clickableElement !== _this.element) || (evt.target === _this.element || Dropzone.elementInside(evt.target, _this.element.querySelector(\".dz-message\")))) {\n                  return _this.hiddenFileInput.click();\n                }\n              }\n            }\n          });\n        };\n      })(this));\n      this.enable();\n      return this.options.init.call(this);\n    };\n\n    Dropzone.prototype.destroy = function() {\n      var _ref;\n      this.disable();\n      this.removeAllFiles(true);\n      if ((_ref = this.hiddenFileInput) != null ? _ref.parentNode : void 0) {\n        this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput);\n        this.hiddenFileInput = null;\n      }\n      delete this.element.dropzone;\n      return Dropzone.instances.splice(Dropzone.instances.indexOf(this), 1);\n    };\n\n    Dropzone.prototype.updateTotalUploadProgress = function() {\n      var activeFiles, file, totalBytes, totalBytesSent, totalUploadProgress, _i, _len, _ref;\n      totalBytesSent = 0;\n      totalBytes = 0;\n      activeFiles = this.getActiveFiles();\n      if (activeFiles.length) {\n        _ref = this.getActiveFiles();\n        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n          file = _ref[_i];\n          totalBytesSent += file.upload.bytesSent;\n          totalBytes += file.upload.total;\n        }\n        totalUploadProgress = 100 * totalBytesSent / totalBytes;\n      } else {\n        totalUploadProgress = 100;\n      }\n      return this.emit(\"totaluploadprogress\", totalUploadProgress, totalBytes, totalBytesSent);\n    };\n\n    Dropzone.prototype._getParamName = function(n) {\n      if (typeof this.options.paramName === \"function\") {\n        return this.options.paramName(n);\n      } else {\n        return \"\" + this.options.paramName + (this.options.uploadMultiple ? \"[\" + n + \"]\" : \"\");\n      }\n    };\n\n    Dropzone.prototype.getFallbackForm = function() {\n      var existingFallback, fields, fieldsString, form;\n      if (existingFallback = this.getExistingFallback()) {\n        return existingFallback;\n      }\n      fieldsString = \"<div class=\\\"dz-fallback\\\">\";\n      if (this.options.dictFallbackText) {\n        fieldsString += \"<p>\" + this.options.dictFallbackText + \"</p>\";\n      }\n      fieldsString += \"<input type=\\\"file\\\" name=\\\"\" + (this._getParamName(0)) + \"\\\" \" + (this.options.uploadMultiple ? 'multiple=\"multiple\"' : void 0) + \" /><input type=\\\"submit\\\" value=\\\"Upload!\\\"></div>\";\n      fields = Dropzone.createElement(fieldsString);\n      if (this.element.tagName !== \"FORM\") {\n        form = Dropzone.createElement(\"<form action=\\\"\" + this.options.url + \"\\\" enctype=\\\"multipart/form-data\\\" method=\\\"\" + this.options.method + \"\\\"></form>\");\n        form.appendChild(fields);\n      } else {\n        this.element.setAttribute(\"enctype\", \"multipart/form-data\");\n        this.element.setAttribute(\"method\", this.options.method);\n      }\n      return form != null ? form : fields;\n    };\n\n    Dropzone.prototype.getExistingFallback = function() {\n      var fallback, getFallback, tagName, _i, _len, _ref;\n      getFallback = function(elements) {\n        var el, _i, _len;\n        for (_i = 0, _len = elements.length; _i < _len; _i++) {\n          el = elements[_i];\n          if (/(^| )fallback($| )/.test(el.className)) {\n            return el;\n          }\n        }\n      };\n      _ref = [\"div\", \"form\"];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        tagName = _ref[_i];\n        if (fallback = getFallback(this.element.getElementsByTagName(tagName))) {\n          return fallback;\n        }\n      }\n    };\n\n    Dropzone.prototype.setupEventListeners = function() {\n      var elementListeners, event, listener, _i, _len, _ref, _results;\n      _ref = this.listeners;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        elementListeners = _ref[_i];\n        _results.push((function() {\n          var _ref1, _results1;\n          _ref1 = elementListeners.events;\n          _results1 = [];\n          for (event in _ref1) {\n            listener = _ref1[event];\n            _results1.push(elementListeners.element.addEventListener(event, listener, false));\n          }\n          return _results1;\n        })());\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.removeEventListeners = function() {\n      var elementListeners, event, listener, _i, _len, _ref, _results;\n      _ref = this.listeners;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        elementListeners = _ref[_i];\n        _results.push((function() {\n          var _ref1, _results1;\n          _ref1 = elementListeners.events;\n          _results1 = [];\n          for (event in _ref1) {\n            listener = _ref1[event];\n            _results1.push(elementListeners.element.removeEventListener(event, listener, false));\n          }\n          return _results1;\n        })());\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.disable = function() {\n      var file, _i, _len, _ref, _results;\n      this.clickableElements.forEach(function(element) {\n        return element.classList.remove(\"dz-clickable\");\n      });\n      this.removeEventListeners();\n      _ref = this.files;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        file = _ref[_i];\n        _results.push(this.cancelUpload(file));\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.enable = function() {\n      this.clickableElements.forEach(function(element) {\n        return element.classList.add(\"dz-clickable\");\n      });\n      return this.setupEventListeners();\n    };\n\n    Dropzone.prototype.filesize = function(size) {\n      var cutoff, i, selectedSize, selectedUnit, unit, units, _i, _len;\n      units = ['TB', 'GB', 'MB', 'KB', 'b'];\n      selectedSize = selectedUnit = null;\n      for (i = _i = 0, _len = units.length; _i < _len; i = ++_i) {\n        unit = units[i];\n        cutoff = Math.pow(this.options.filesizeBase, 4 - i) / 10;\n        if (size >= cutoff) {\n          selectedSize = size / Math.pow(this.options.filesizeBase, 4 - i);\n          selectedUnit = unit;\n          break;\n        }\n      }\n      selectedSize = Math.round(10 * selectedSize) / 10;\n      return \"<strong>\" + selectedSize + \"</strong> \" + selectedUnit;\n    };\n\n    Dropzone.prototype._updateMaxFilesReachedClass = function() {\n      if ((this.options.maxFiles != null) && this.getAcceptedFiles().length >= this.options.maxFiles) {\n        if (this.getAcceptedFiles().length === this.options.maxFiles) {\n          this.emit('maxfilesreached', this.files);\n        }\n        return this.element.classList.add(\"dz-max-files-reached\");\n      } else {\n        return this.element.classList.remove(\"dz-max-files-reached\");\n      }\n    };\n\n    Dropzone.prototype.drop = function(e) {\n      var files, items;\n      if (!e.dataTransfer) {\n        return;\n      }\n      this.emit(\"drop\", e);\n      files = e.dataTransfer.files;\n      if (files.length) {\n        items = e.dataTransfer.items;\n        if (items && items.length && (items[0].webkitGetAsEntry != null)) {\n          this._addFilesFromItems(items);\n        } else {\n          this.handleFiles(files);\n        }\n      }\n    };\n\n    Dropzone.prototype.paste = function(e) {\n      var items, _ref;\n      if ((e != null ? (_ref = e.clipboardData) != null ? _ref.items : void 0 : void 0) == null) {\n        return;\n      }\n      this.emit(\"paste\", e);\n      items = e.clipboardData.items;\n      if (items.length) {\n        return this._addFilesFromItems(items);\n      }\n    };\n\n    Dropzone.prototype.handleFiles = function(files) {\n      var file, _i, _len, _results;\n      _results = [];\n      for (_i = 0, _len = files.length; _i < _len; _i++) {\n        file = files[_i];\n        _results.push(this.addFile(file));\n      }\n      return _results;\n    };\n\n    Dropzone.prototype._addFilesFromItems = function(items) {\n      var entry, item, _i, _len, _results;\n      _results = [];\n      for (_i = 0, _len = items.length; _i < _len; _i++) {\n        item = items[_i];\n        if ((item.webkitGetAsEntry != null) && (entry = item.webkitGetAsEntry())) {\n          if (entry.isFile) {\n            _results.push(this.addFile(item.getAsFile()));\n          } else if (entry.isDirectory) {\n            _results.push(this._addFilesFromDirectory(entry, entry.name));\n          } else {\n            _results.push(void 0);\n          }\n        } else if (item.getAsFile != null) {\n          if ((item.kind == null) || item.kind === \"file\") {\n            _results.push(this.addFile(item.getAsFile()));\n          } else {\n            _results.push(void 0);\n          }\n        } else {\n          _results.push(void 0);\n        }\n      }\n      return _results;\n    };\n\n    Dropzone.prototype._addFilesFromDirectory = function(directory, path) {\n      var dirReader, entriesReader;\n      dirReader = directory.createReader();\n      entriesReader = (function(_this) {\n        return function(entries) {\n          var entry, _i, _len;\n          for (_i = 0, _len = entries.length; _i < _len; _i++) {\n            entry = entries[_i];\n            if (entry.isFile) {\n              entry.file(function(file) {\n                if (_this.options.ignoreHiddenFiles && file.name.substring(0, 1) === '.') {\n                  return;\n                }\n                file.fullPath = \"\" + path + \"/\" + file.name;\n                return _this.addFile(file);\n              });\n            } else if (entry.isDirectory) {\n              _this._addFilesFromDirectory(entry, \"\" + path + \"/\" + entry.name);\n            }\n          }\n        };\n      })(this);\n      return dirReader.readEntries(entriesReader, function(error) {\n        return typeof console !== \"undefined\" && console !== null ? typeof console.log === \"function\" ? console.log(error) : void 0 : void 0;\n      });\n    };\n\n    Dropzone.prototype.accept = function(file, done) {\n      if (file.size > this.options.maxFilesize * 1024 * 1024) {\n        return done(this.options.dictFileTooBig.replace(\"{{filesize}}\", Math.round(file.size / 1024 / 10.24) / 100).replace(\"{{maxFilesize}}\", this.options.maxFilesize));\n      } else if (!Dropzone.isValidFile(file, this.options.acceptedFiles)) {\n        return done(this.options.dictInvalidFileType);\n      } else if ((this.options.maxFiles != null) && this.getAcceptedFiles().length >= this.options.maxFiles) {\n        done(this.options.dictMaxFilesExceeded.replace(\"{{maxFiles}}\", this.options.maxFiles));\n        return this.emit(\"maxfilesexceeded\", file);\n      } else {\n        return this.options.accept.call(this, file, done);\n      }\n    };\n\n    Dropzone.prototype.addFile = function(file) {\n      file.upload = {\n        progress: 0,\n        total: file.size,\n        bytesSent: 0\n      };\n      this.files.push(file);\n      file.status = Dropzone.ADDED;\n      this.emit(\"addedfile\", file);\n      this._enqueueThumbnail(file);\n      return this.accept(file, (function(_this) {\n        return function(error) {\n          if (error) {\n            file.accepted = false;\n            _this._errorProcessing([file], error);\n          } else {\n            file.accepted = true;\n            if (_this.options.autoQueue) {\n              _this.enqueueFile(file);\n            }\n          }\n          return _this._updateMaxFilesReachedClass();\n        };\n      })(this));\n    };\n\n    Dropzone.prototype.enqueueFiles = function(files) {\n      var file, _i, _len;\n      for (_i = 0, _len = files.length; _i < _len; _i++) {\n        file = files[_i];\n        this.enqueueFile(file);\n      }\n      return null;\n    };\n\n    Dropzone.prototype.enqueueFile = function(file) {\n      if (file.status === Dropzone.ADDED && file.accepted === true) {\n        file.status = Dropzone.QUEUED;\n        if (this.options.autoProcessQueue) {\n          return setTimeout(((function(_this) {\n            return function() {\n              return _this.processQueue();\n            };\n          })(this)), 0);\n        }\n      } else {\n        throw new Error(\"This file can't be queued because it has already been processed or was rejected.\");\n      }\n    };\n\n    Dropzone.prototype._thumbnailQueue = [];\n\n    Dropzone.prototype._processingThumbnail = false;\n\n    Dropzone.prototype._enqueueThumbnail = function(file) {\n      if (this.options.createImageThumbnails && file.type.match(/image.*/) && file.size <= this.options.maxThumbnailFilesize * 1024 * 1024) {\n        this._thumbnailQueue.push(file);\n        return setTimeout(((function(_this) {\n          return function() {\n            return _this._processThumbnailQueue();\n          };\n        })(this)), 0);\n      }\n    };\n\n    Dropzone.prototype._processThumbnailQueue = function() {\n      if (this._processingThumbnail || this._thumbnailQueue.length === 0) {\n        return;\n      }\n      this._processingThumbnail = true;\n      return this.createThumbnail(this._thumbnailQueue.shift(), (function(_this) {\n        return function() {\n          _this._processingThumbnail = false;\n          return _this._processThumbnailQueue();\n        };\n      })(this));\n    };\n\n    Dropzone.prototype.removeFile = function(file) {\n      if (file.status === Dropzone.UPLOADING) {\n        this.cancelUpload(file);\n      }\n      this.files = without(this.files, file);\n      this.emit(\"removedfile\", file);\n      if (this.files.length === 0) {\n        return this.emit(\"reset\");\n      }\n    };\n\n    Dropzone.prototype.removeAllFiles = function(cancelIfNecessary) {\n      var file, _i, _len, _ref;\n      if (cancelIfNecessary == null) {\n        cancelIfNecessary = false;\n      }\n      _ref = this.files.slice();\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        file = _ref[_i];\n        if (file.status !== Dropzone.UPLOADING || cancelIfNecessary) {\n          this.removeFile(file);\n        }\n      }\n      return null;\n    };\n\n    Dropzone.prototype.createThumbnail = function(file, callback) {\n      var fileReader;\n      fileReader = new FileReader;\n      fileReader.onload = (function(_this) {\n        return function() {\n          if (file.type === \"image/svg+xml\") {\n            _this.emit(\"thumbnail\", file, fileReader.result);\n            if (callback != null) {\n              callback();\n            }\n            return;\n          }\n          return _this.createThumbnailFromUrl(file, fileReader.result, callback);\n        };\n      })(this);\n      return fileReader.readAsDataURL(file);\n    };\n\n    Dropzone.prototype.createThumbnailFromUrl = function(file, imageUrl, callback) {\n      var img;\n      img = document.createElement(\"img\");\n      img.onload = (function(_this) {\n        return function() {\n          var canvas, ctx, resizeInfo, thumbnail, _ref, _ref1, _ref2, _ref3;\n          file.width = img.width;\n          file.height = img.height;\n          resizeInfo = _this.options.resize.call(_this, file);\n          if (resizeInfo.trgWidth == null) {\n            resizeInfo.trgWidth = resizeInfo.optWidth;\n          }\n          if (resizeInfo.trgHeight == null) {\n            resizeInfo.trgHeight = resizeInfo.optHeight;\n          }\n          canvas = document.createElement(\"canvas\");\n          ctx = canvas.getContext(\"2d\");\n          canvas.width = resizeInfo.trgWidth;\n          canvas.height = resizeInfo.trgHeight;\n          drawImageIOSFix(ctx, img, (_ref = resizeInfo.srcX) != null ? _ref : 0, (_ref1 = resizeInfo.srcY) != null ? _ref1 : 0, resizeInfo.srcWidth, resizeInfo.srcHeight, (_ref2 = resizeInfo.trgX) != null ? _ref2 : 0, (_ref3 = resizeInfo.trgY) != null ? _ref3 : 0, resizeInfo.trgWidth, resizeInfo.trgHeight);\n          thumbnail = canvas.toDataURL(\"image/png\");\n          _this.emit(\"thumbnail\", file, thumbnail);\n          if (callback != null) {\n            return callback();\n          }\n        };\n      })(this);\n      if (callback != null) {\n        img.onerror = callback;\n      }\n      return img.src = imageUrl;\n    };\n\n    Dropzone.prototype.processQueue = function() {\n      var i, parallelUploads, processingLength, queuedFiles;\n      parallelUploads = this.options.parallelUploads;\n      processingLength = this.getUploadingFiles().length;\n      i = processingLength;\n      if (processingLength >= parallelUploads) {\n        return;\n      }\n      queuedFiles = this.getQueuedFiles();\n      if (!(queuedFiles.length > 0)) {\n        return;\n      }\n      if (this.options.uploadMultiple) {\n        return this.processFiles(queuedFiles.slice(0, parallelUploads - processingLength));\n      } else {\n        while (i < parallelUploads) {\n          if (!queuedFiles.length) {\n            return;\n          }\n          this.processFile(queuedFiles.shift());\n          i++;\n        }\n      }\n    };\n\n    Dropzone.prototype.processFile = function(file) {\n      return this.processFiles([file]);\n    };\n\n    Dropzone.prototype.processFiles = function(files) {\n      var file, _i, _len;\n      for (_i = 0, _len = files.length; _i < _len; _i++) {\n        file = files[_i];\n        file.processing = true;\n        file.status = Dropzone.UPLOADING;\n        this.emit(\"processing\", file);\n      }\n      if (this.options.uploadMultiple) {\n        this.emit(\"processingmultiple\", files);\n      }\n      return this.uploadFiles(files);\n    };\n\n    Dropzone.prototype._getFilesWithXhr = function(xhr) {\n      var file, files;\n      return files = (function() {\n        var _i, _len, _ref, _results;\n        _ref = this.files;\n        _results = [];\n        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n          file = _ref[_i];\n          if (file.xhr === xhr) {\n            _results.push(file);\n          }\n        }\n        return _results;\n      }).call(this);\n    };\n\n    Dropzone.prototype.cancelUpload = function(file) {\n      var groupedFile, groupedFiles, _i, _j, _len, _len1, _ref;\n      if (file.status === Dropzone.UPLOADING) {\n        groupedFiles = this._getFilesWithXhr(file.xhr);\n        for (_i = 0, _len = groupedFiles.length; _i < _len; _i++) {\n          groupedFile = groupedFiles[_i];\n          groupedFile.status = Dropzone.CANCELED;\n        }\n        file.xhr.abort();\n        for (_j = 0, _len1 = groupedFiles.length; _j < _len1; _j++) {\n          groupedFile = groupedFiles[_j];\n          this.emit(\"canceled\", groupedFile);\n        }\n        if (this.options.uploadMultiple) {\n          this.emit(\"canceledmultiple\", groupedFiles);\n        }\n      } else if ((_ref = file.status) === Dropzone.ADDED || _ref === Dropzone.QUEUED) {\n        file.status = Dropzone.CANCELED;\n        this.emit(\"canceled\", file);\n        if (this.options.uploadMultiple) {\n          this.emit(\"canceledmultiple\", [file]);\n        }\n      }\n      if (this.options.autoProcessQueue) {\n        return this.processQueue();\n      }\n    };\n\n    resolveOption = function() {\n      var args, option;\n      option = arguments[0], args = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n      if (typeof option === 'function') {\n        return option.apply(this, args);\n      }\n      return option;\n    };\n\n    Dropzone.prototype.uploadFile = function(file) {\n      return this.uploadFiles([file]);\n    };\n\n    Dropzone.prototype.uploadFiles = function(files) {\n      var file, formData, handleError, headerName, headerValue, headers, i, input, inputName, inputType, key, method, option, progressObj, response, updateProgress, url, value, xhr, _i, _j, _k, _l, _len, _len1, _len2, _len3, _m, _ref, _ref1, _ref2, _ref3, _ref4, _ref5;\n      xhr = new XMLHttpRequest();\n      for (_i = 0, _len = files.length; _i < _len; _i++) {\n        file = files[_i];\n        file.xhr = xhr;\n      }\n      method = resolveOption(this.options.method, files);\n      url = resolveOption(this.options.url, files);\n      xhr.open(method, url, true);\n      xhr.withCredentials = !!this.options.withCredentials;\n      response = null;\n      handleError = (function(_this) {\n        return function() {\n          var _j, _len1, _results;\n          _results = [];\n          for (_j = 0, _len1 = files.length; _j < _len1; _j++) {\n            file = files[_j];\n            _results.push(_this._errorProcessing(files, response || _this.options.dictResponseError.replace(\"{{statusCode}}\", xhr.status), xhr));\n          }\n          return _results;\n        };\n      })(this);\n      updateProgress = (function(_this) {\n        return function(e) {\n          var allFilesFinished, progress, _j, _k, _l, _len1, _len2, _len3, _results;\n          if (e != null) {\n            progress = 100 * e.loaded / e.total;\n            for (_j = 0, _len1 = files.length; _j < _len1; _j++) {\n              file = files[_j];\n              file.upload = {\n                progress: progress,\n                total: e.total,\n                bytesSent: e.loaded\n              };\n            }\n          } else {\n            allFilesFinished = true;\n            progress = 100;\n            for (_k = 0, _len2 = files.length; _k < _len2; _k++) {\n              file = files[_k];\n              if (!(file.upload.progress === 100 && file.upload.bytesSent === file.upload.total)) {\n                allFilesFinished = false;\n              }\n              file.upload.progress = progress;\n              file.upload.bytesSent = file.upload.total;\n            }\n            if (allFilesFinished) {\n              return;\n            }\n          }\n          _results = [];\n          for (_l = 0, _len3 = files.length; _l < _len3; _l++) {\n            file = files[_l];\n            _results.push(_this.emit(\"uploadprogress\", file, progress, file.upload.bytesSent));\n          }\n          return _results;\n        };\n      })(this);\n      xhr.onload = (function(_this) {\n        return function(e) {\n          var _ref;\n          if (files[0].status === Dropzone.CANCELED) {\n            return;\n          }\n          if (xhr.readyState !== 4) {\n            return;\n          }\n          response = xhr.responseText;\n          if (xhr.getResponseHeader(\"content-type\") && ~xhr.getResponseHeader(\"content-type\").indexOf(\"application/json\")) {\n            try {\n              response = JSON.parse(response);\n            } catch (_error) {\n              e = _error;\n              response = \"Invalid JSON response from server.\";\n            }\n          }\n          updateProgress();\n          if (!((200 <= (_ref = xhr.status) && _ref < 300))) {\n            return handleError();\n          } else {\n            return _this._finished(files, response, e);\n          }\n        };\n      })(this);\n      xhr.onerror = (function(_this) {\n        return function() {\n          if (files[0].status === Dropzone.CANCELED) {\n            return;\n          }\n          return handleError();\n        };\n      })(this);\n      progressObj = (_ref = xhr.upload) != null ? _ref : xhr;\n      progressObj.onprogress = updateProgress;\n      headers = {\n        \"Accept\": \"application/json\",\n        \"Cache-Control\": \"no-cache\",\n        \"X-Requested-With\": \"XMLHttpRequest\"\n      };\n      if (this.options.headers) {\n        extend(headers, this.options.headers);\n      }\n      for (headerName in headers) {\n        headerValue = headers[headerName];\n        xhr.setRequestHeader(headerName, headerValue);\n      }\n      formData = new FormData();\n      if (this.options.params) {\n        _ref1 = this.options.params;\n        for (key in _ref1) {\n          value = _ref1[key];\n          formData.append(key, value);\n        }\n      }\n      for (_j = 0, _len1 = files.length; _j < _len1; _j++) {\n        file = files[_j];\n        this.emit(\"sending\", file, xhr, formData);\n      }\n      if (this.options.uploadMultiple) {\n        this.emit(\"sendingmultiple\", files, xhr, formData);\n      }\n      if (this.element.tagName === \"FORM\") {\n        _ref2 = this.element.querySelectorAll(\"input, textarea, select, button\");\n        for (_k = 0, _len2 = _ref2.length; _k < _len2; _k++) {\n          input = _ref2[_k];\n          inputName = input.getAttribute(\"name\");\n          inputType = input.getAttribute(\"type\");\n          if (input.tagName === \"SELECT\" && input.hasAttribute(\"multiple\")) {\n            _ref3 = input.options;\n            for (_l = 0, _len3 = _ref3.length; _l < _len3; _l++) {\n              option = _ref3[_l];\n              if (option.selected) {\n                formData.append(inputName, option.value);\n              }\n            }\n          } else if (!inputType || ((_ref4 = inputType.toLowerCase()) !== \"checkbox\" && _ref4 !== \"radio\") || input.checked) {\n            formData.append(inputName, input.value);\n          }\n        }\n      }\n      for (i = _m = 0, _ref5 = files.length - 1; 0 <= _ref5 ? _m <= _ref5 : _m >= _ref5; i = 0 <= _ref5 ? ++_m : --_m) {\n        formData.append(this._getParamName(i), files[i], files[i].name);\n      }\n      return xhr.send(formData);\n    };\n\n    Dropzone.prototype._finished = function(files, responseText, e) {\n      var file, _i, _len;\n      for (_i = 0, _len = files.length; _i < _len; _i++) {\n        file = files[_i];\n        file.status = Dropzone.SUCCESS;\n        this.emit(\"success\", file, responseText, e);\n        this.emit(\"complete\", file);\n      }\n      if (this.options.uploadMultiple) {\n        this.emit(\"successmultiple\", files, responseText, e);\n        this.emit(\"completemultiple\", files);\n      }\n      if (this.options.autoProcessQueue) {\n        return this.processQueue();\n      }\n    };\n\n    Dropzone.prototype._errorProcessing = function(files, message, xhr) {\n      var file, _i, _len;\n      for (_i = 0, _len = files.length; _i < _len; _i++) {\n        file = files[_i];\n        file.status = Dropzone.ERROR;\n        this.emit(\"error\", file, message, xhr);\n        this.emit(\"complete\", file);\n      }\n      if (this.options.uploadMultiple) {\n        this.emit(\"errormultiple\", files, message, xhr);\n        this.emit(\"completemultiple\", files);\n      }\n      if (this.options.autoProcessQueue) {\n        return this.processQueue();\n      }\n    };\n\n    return Dropzone;\n\n  })(Emitter);\n\n  Dropzone.version = \"4.0.1\";\n\n  Dropzone.options = {};\n\n  Dropzone.optionsForElement = function(element) {\n    if (element.getAttribute(\"id\")) {\n      return Dropzone.options[camelize(element.getAttribute(\"id\"))];\n    } else {\n      return void 0;\n    }\n  };\n\n  Dropzone.instances = [];\n\n  Dropzone.forElement = function(element) {\n    if (typeof element === \"string\") {\n      element = document.querySelector(element);\n    }\n    if ((element != null ? element.dropzone : void 0) == null) {\n      throw new Error(\"No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.\");\n    }\n    return element.dropzone;\n  };\n\n  Dropzone.autoDiscover = true;\n\n  Dropzone.discover = function() {\n    var checkElements, dropzone, dropzones, _i, _len, _results;\n    if (document.querySelectorAll) {\n      dropzones = document.querySelectorAll(\".dropzone\");\n    } else {\n      dropzones = [];\n      checkElements = function(elements) {\n        var el, _i, _len, _results;\n        _results = [];\n        for (_i = 0, _len = elements.length; _i < _len; _i++) {\n          el = elements[_i];\n          if (/(^| )dropzone($| )/.test(el.className)) {\n            _results.push(dropzones.push(el));\n          } else {\n            _results.push(void 0);\n          }\n        }\n        return _results;\n      };\n      checkElements(document.getElementsByTagName(\"div\"));\n      checkElements(document.getElementsByTagName(\"form\"));\n    }\n    _results = [];\n    for (_i = 0, _len = dropzones.length; _i < _len; _i++) {\n      dropzone = dropzones[_i];\n      if (Dropzone.optionsForElement(dropzone) !== false) {\n        _results.push(new Dropzone(dropzone));\n      } else {\n        _results.push(void 0);\n      }\n    }\n    return _results;\n  };\n\n  Dropzone.blacklistedBrowsers = [/opera.*Macintosh.*version\\/12/i];\n\n  Dropzone.isBrowserSupported = function() {\n    var capableBrowser, regex, _i, _len, _ref;\n    capableBrowser = true;\n    if (window.File && window.FileReader && window.FileList && window.Blob && window.FormData && document.querySelector) {\n      if (!(\"classList\" in document.createElement(\"a\"))) {\n        capableBrowser = false;\n      } else {\n        _ref = Dropzone.blacklistedBrowsers;\n        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n          regex = _ref[_i];\n          if (regex.test(navigator.userAgent)) {\n            capableBrowser = false;\n            continue;\n          }\n        }\n      }\n    } else {\n      capableBrowser = false;\n    }\n    return capableBrowser;\n  };\n\n  without = function(list, rejectedItem) {\n    var item, _i, _len, _results;\n    _results = [];\n    for (_i = 0, _len = list.length; _i < _len; _i++) {\n      item = list[_i];\n      if (item !== rejectedItem) {\n        _results.push(item);\n      }\n    }\n    return _results;\n  };\n\n  camelize = function(str) {\n    return str.replace(/[\\-_](\\w)/g, function(match) {\n      return match.charAt(1).toUpperCase();\n    });\n  };\n\n  Dropzone.createElement = function(string) {\n    var div;\n    div = document.createElement(\"div\");\n    div.innerHTML = string;\n    return div.childNodes[0];\n  };\n\n  Dropzone.elementInside = function(element, container) {\n    if (element === container) {\n      return true;\n    }\n    while (element = element.parentNode) {\n      if (element === container) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  Dropzone.getElement = function(el, name) {\n    var element;\n    if (typeof el === \"string\") {\n      element = document.querySelector(el);\n    } else if (el.nodeType != null) {\n      element = el;\n    }\n    if (element == null) {\n      throw new Error(\"Invalid `\" + name + \"` option provided. Please provide a CSS selector or a plain HTML element.\");\n    }\n    return element;\n  };\n\n  Dropzone.getElements = function(els, name) {\n    var e, el, elements, _i, _j, _len, _len1, _ref;\n    if (els instanceof Array) {\n      elements = [];\n      try {\n        for (_i = 0, _len = els.length; _i < _len; _i++) {\n          el = els[_i];\n          elements.push(this.getElement(el, name));\n        }\n      } catch (_error) {\n        e = _error;\n        elements = null;\n      }\n    } else if (typeof els === \"string\") {\n      elements = [];\n      _ref = document.querySelectorAll(els);\n      for (_j = 0, _len1 = _ref.length; _j < _len1; _j++) {\n        el = _ref[_j];\n        elements.push(el);\n      }\n    } else if (els.nodeType != null) {\n      elements = [els];\n    }\n    if (!((elements != null) && elements.length)) {\n      throw new Error(\"Invalid `\" + name + \"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.\");\n    }\n    return elements;\n  };\n\n  Dropzone.confirm = function(question, accepted, rejected) {\n    if (window.confirm(question)) {\n      return accepted();\n    } else if (rejected != null) {\n      return rejected();\n    }\n  };\n\n  Dropzone.isValidFile = function(file, acceptedFiles) {\n    var baseMimeType, mimeType, validType, _i, _len;\n    if (!acceptedFiles) {\n      return true;\n    }\n    acceptedFiles = acceptedFiles.split(\",\");\n    mimeType = file.type;\n    baseMimeType = mimeType.replace(/\\/.*$/, \"\");\n    for (_i = 0, _len = acceptedFiles.length; _i < _len; _i++) {\n      validType = acceptedFiles[_i];\n      validType = validType.trim();\n      if (validType.charAt(0) === \".\") {\n        if (file.name.toLowerCase().indexOf(validType.toLowerCase(), file.name.length - validType.length) !== -1) {\n          return true;\n        }\n      } else if (/\\/\\*$/.test(validType)) {\n        if (baseMimeType === validType.replace(/\\/.*$/, \"\")) {\n          return true;\n        }\n      } else {\n        if (mimeType === validType) {\n          return true;\n        }\n      }\n    }\n    return false;\n  };\n\n  if (typeof jQuery !== \"undefined\" && jQuery !== null) {\n    jQuery.fn.dropzone = function(options) {\n      return this.each(function() {\n        return new Dropzone(this, options);\n      });\n    };\n  }\n\n  if (typeof module !== \"undefined\" && module !== null) {\n    module.exports = Dropzone;\n  } else {\n    window.Dropzone = Dropzone;\n  }\n\n  Dropzone.ADDED = \"added\";\n\n  Dropzone.QUEUED = \"queued\";\n\n  Dropzone.ACCEPTED = Dropzone.QUEUED;\n\n  Dropzone.UPLOADING = \"uploading\";\n\n  Dropzone.PROCESSING = Dropzone.UPLOADING;\n\n  Dropzone.CANCELED = \"canceled\";\n\n  Dropzone.ERROR = \"error\";\n\n  Dropzone.SUCCESS = \"success\";\n\n\n  /*\n  \n  Bugfix for iOS 6 and 7\n  Source: http://stackoverflow.com/questions/11929099/html5-canvas-drawimage-ratio-bug-ios\n  based on the work of https://github.com/stomita/ios-imagefile-megapixel\n   */\n\n  detectVerticalSquash = function(img) {\n    var alpha, canvas, ctx, data, ey, ih, iw, py, ratio, sy;\n    iw = img.naturalWidth;\n    ih = img.naturalHeight;\n    canvas = document.createElement(\"canvas\");\n    canvas.width = 1;\n    canvas.height = ih;\n    ctx = canvas.getContext(\"2d\");\n    ctx.drawImage(img, 0, 0);\n    data = ctx.getImageData(0, 0, 1, ih).data;\n    sy = 0;\n    ey = ih;\n    py = ih;\n    while (py > sy) {\n      alpha = data[(py - 1) * 4 + 3];\n      if (alpha === 0) {\n        ey = py;\n      } else {\n        sy = py;\n      }\n      py = (ey + sy) >> 1;\n    }\n    ratio = py / ih;\n    if (ratio === 0) {\n      return 1;\n    } else {\n      return ratio;\n    }\n  };\n\n  drawImageIOSFix = function(ctx, img, sx, sy, sw, sh, dx, dy, dw, dh) {\n    var vertSquashRatio;\n    vertSquashRatio = detectVerticalSquash(img);\n    return ctx.drawImage(img, sx, sy, sw, sh, dx, dy, dw, dh / vertSquashRatio);\n  };\n\n\n  /*\n   * contentloaded.js\n   *\n   * Author: Diego Perini (diego.perini at gmail.com)\n   * Summary: cross-browser wrapper for DOMContentLoaded\n   * Updated: 20101020\n   * License: MIT\n   * Version: 1.2\n   *\n   * URL:\n   * http://javascript.nwbox.com/ContentLoaded/\n   * http://javascript.nwbox.com/ContentLoaded/MIT-LICENSE\n   */\n\n  contentLoaded = function(win, fn) {\n    var add, doc, done, init, poll, pre, rem, root, top;\n    done = false;\n    top = true;\n    doc = win.document;\n    root = doc.documentElement;\n    add = (doc.addEventListener ? \"addEventListener\" : \"attachEvent\");\n    rem = (doc.addEventListener ? \"removeEventListener\" : \"detachEvent\");\n    pre = (doc.addEventListener ? \"\" : \"on\");\n    init = function(e) {\n      if (e.type === \"readystatechange\" && doc.readyState !== \"complete\") {\n        return;\n      }\n      (e.type === \"load\" ? win : doc)[rem](pre + e.type, init, false);\n      if (!done && (done = true)) {\n        return fn.call(win, e.type || e);\n      }\n    };\n    poll = function() {\n      var e;\n      try {\n        root.doScroll(\"left\");\n      } catch (_error) {\n        e = _error;\n        setTimeout(poll, 50);\n        return;\n      }\n      return init(\"poll\");\n    };\n    if (doc.readyState !== \"complete\") {\n      if (doc.createEventObject && root.doScroll) {\n        try {\n          top = !win.frameElement;\n        } catch (_error) {}\n        if (top) {\n          poll();\n        }\n      }\n      doc[add](pre + \"DOMContentLoaded\", init, false);\n      doc[add](pre + \"readystatechange\", init, false);\n      return win[add](pre + \"load\", init, false);\n    }\n  };\n\n  Dropzone._autoDiscoverFunction = function() {\n    if (Dropzone.autoDiscover) {\n      return Dropzone.discover();\n    }\n  };\n\n  contentLoaded(window, Dropzone._autoDiscoverFunction);\n\n}).call(this);","//     Backbone.Model File Upload v0.5.3\n//     by Joe Vu - joe.vu@homeslicesolutions.com\n//     For all details and documentation:\n//     https://github.com/homeslicesolutions/backbone-model-file-upload\n//     Contributors:\n//       lutherism - Alex Jansen - alex.openrobot.net\n//       bildja - Dima Bildin - github.com/bildja\n//       Minjung - Alejandro - github.com/Minjung\n\n(function(root, factory) {\n\n  // AMD\n  if (typeof define === 'function' && define.amd) {\n    define(['underscore', 'jquery', 'backbone'], function(_, $, Backbone){\n      factory(root, Backbone, _, $);\n    });\n\n  // NodeJS/CommonJS\n  } else if (typeof exports !== 'undefined') {\n    var _ = require('underscore'), $ = require('jquery-cdb-v3'), Backbone = require('backbone-cdb-v3');\n    factory(root, _, $, Backbone);\n\n  // Browser global\n  } else {\n    factory(root, root.Backbone, root._, root.$);\n  }\n\n}(this, function(root, Backbone, _, $) {\n  'use strict';\n\n  // Clone the original Backbone.Model.prototype as superClass\n  var _superClass = _.clone( Backbone.Model.prototype );\n\n  // Extending out\n  var BackboneModelFileUpload = Backbone.Model.extend({\n\n    // ! Default file attribute - can be overwritten\n    fileAttribute: 'file',\n\n    // @ Save - overwritten\n    save: function(key, val, options) {\n\n      // Variables\n      var attrs, attributes = this.attributes;\n\n      // Signature parsing - taken directly from original Backbone.Model.save\n      // and it states: 'Handle both \"key\", value and {key: value} -style arguments.'\n      if (key == null || typeof key === 'object') {\n        attrs = key;\n        options = val;\n      } else {\n        (attrs = {})[key] = val;\n      }\n\n      // Validate & wait options - taken directly from original Backbone.Model.save\n      options = _.extend({validate: true}, options);\n      if (attrs && !options.wait) {\n        if (!this.set(attrs, options)) return false;\n      } else {\n        if (!this._validate(attrs, options)) return false;\n      }\n\n      // Merge data temporarily for formdata\n      var mergedAttrs = _.extend({}, attributes, attrs);\n\n      if (attrs && options.wait) {\n        this.attributes = mergedAttrs;\n      }\n\n      // Check for \"formData\" flag and check for if file exist.\n      if ( options.formData === true\n        || options.formData !== false\n        && mergedAttrs[ this.fileAttribute ]\n        && mergedAttrs[ this.fileAttribute ] instanceof File\n        || mergedAttrs[ this.fileAttribute ] instanceof FileList\n        || mergedAttrs[ this.fileAttribute ] instanceof Blob ) {\n\n        // Flatten Attributes reapplying File Object\n        var formAttrs = _.clone( mergedAttrs ),\n          fileAttr = mergedAttrs[ this.fileAttribute ];\n        formAttrs = Backbone.Model.prototype._flatten( formAttrs );\n        formAttrs[ this.fileAttribute ] = fileAttr;\n\n        // Converting Attributes to Form Data\n        var formData = new FormData();\n        _.each( formAttrs, function( value, key ){\n          if (value instanceof FileList) {\n            _.each(value, function(file) {\n              formData.append( key, file );\n            });\n            return;\n          }\n          formData.append( key, value );\n        });\n\n        // Set options for AJAX call\n        options.data = formData;\n        options.processData = false;\n        options.contentType = false;\n\n        // Apply custom XHR for processing status & listen to \"progress\"\n        var that = this;\n        options.xhr = function() {\n          var xhr = $.ajaxSettings.xhr();\n          xhr.upload.addEventListener('progress', that._progressHandler.bind(that), false);\n          return xhr;\n        }\n      }\n\n      // Resume back to original state\n      if (attrs && options.wait) this.attributes = attributes;\n\n      // Continue to call the existing \"save\" method\n      return _superClass.save.call(this, attrs, options);\n\n    },\n\n    // _ FlattenObject gist by \"penguinboy\".  Thank You!\n    // https://gist.github.com/penguinboy/762197\n    _flatten: function( obj ) {\n      var output = {};\n      for (var i in obj) {\n        if (!obj.hasOwnProperty(i)) continue;\n        if (typeof obj[i] == 'object') {\n          var flatObject = this._flatten(obj[i]);\n          for (var x in flatObject) {\n            if (!flatObject.hasOwnProperty(x)) continue;\n            output[i + '.' + x] = flatObject[x];\n          }\n        } else {\n          output[i] = obj[i];\n        }\n      }\n      return output;\n\n    },\n\n    // _ Get the Progress of the uploading file\n    _progressHandler: function( event ) {\n      if (event.lengthComputable) {\n        var percentComplete = event.loaded / event.total;\n        this.trigger( 'progress', percentComplete );\n      }\n    }\n  });\n\n  // Export out to override Backbone Model\n  Backbone.Model = BackboneModelFileUpload;\n\n}));","/*\r\n  html2canvas 0.5.0-alpha1 <http://html2canvas.hertzen.com>\r\n  Copyright (c) 2015 Niklas von Hertzen\r\n\r\n  Released under MIT License\r\n*/\r\n\r\n(function(window, document, exports, global, define, undefined){\r\n\r\n/*!\r\n * @overview es6-promise - a tiny implementation of Promises/A+.\r\n * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)\r\n * @license   Licensed under MIT license\r\n *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE\r\n * @version   2.0.1\r\n */\r\n\r\n(function(){function r(a,b){n[l]=a;n[l+1]=b;l+=2;2===l&&A()}function s(a){return\"function\"===typeof a}function F(){return function(){process.nextTick(t)}}function G(){var a=0,b=new B(t),c=document.createTextNode(\"\");b.observe(c,{characterData:!0});return function(){c.data=a=++a%2}}function H(){var a=new MessageChannel;a.port1.onmessage=t;return function(){a.port2.postMessage(0)}}function I(){return function(){setTimeout(t,1)}}function t(){for(var a=0;a<l;a+=2)(0,n[a])(n[a+1]),n[a]=void 0,n[a+1]=void 0;\r\nl=0}function p(){}function J(a,b,c,d){try{a.call(b,c,d)}catch(e){return e}}function K(a,b,c){r(function(a){var e=!1,f=J(c,b,function(c){e||(e=!0,b!==c?q(a,c):m(a,c))},function(b){e||(e=!0,g(a,b))});!e&&f&&(e=!0,g(a,f))},a)}function L(a,b){1===b.a?m(a,b.b):2===a.a?g(a,b.b):u(b,void 0,function(b){q(a,b)},function(b){g(a,b)})}function q(a,b){if(a===b)g(a,new TypeError(\"You cannot resolve a promise with itself\"));else if(\"function\"===typeof b||\"object\"===typeof b&&null!==b)if(b.constructor===a.constructor)L(a,\r\nb);else{var c;try{c=b.then}catch(d){v.error=d,c=v}c===v?g(a,v.error):void 0===c?m(a,b):s(c)?K(a,b,c):m(a,b)}else m(a,b)}function M(a){a.f&&a.f(a.b);x(a)}function m(a,b){void 0===a.a&&(a.b=b,a.a=1,0!==a.e.length&&r(x,a))}function g(a,b){void 0===a.a&&(a.a=2,a.b=b,r(M,a))}function u(a,b,c,d){var e=a.e,f=e.length;a.f=null;e[f]=b;e[f+1]=c;e[f+2]=d;0===f&&a.a&&r(x,a)}function x(a){var b=a.e,c=a.a;if(0!==b.length){for(var d,e,f=a.b,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?C(c,d,e,f):e(f);a.e.length=0}}function D(){this.error=\r\nnull}function C(a,b,c,d){var e=s(c),f,k,h,l;if(e){try{f=c(d)}catch(n){y.error=n,f=y}f===y?(l=!0,k=f.error,f=null):h=!0;if(b===f){g(b,new TypeError(\"A promises callback cannot return that same promise.\"));return}}else f=d,h=!0;void 0===b.a&&(e&&h?q(b,f):l?g(b,k):1===a?m(b,f):2===a&&g(b,f))}function N(a,b){try{b(function(b){q(a,b)},function(b){g(a,b)})}catch(c){g(a,c)}}function k(a,b,c,d){this.n=a;this.c=new a(p,d);this.i=c;this.o(b)?(this.m=b,this.d=this.length=b.length,this.l(),0===this.length?m(this.c,\r\nthis.b):(this.length=this.length||0,this.k(),0===this.d&&m(this.c,this.b))):g(this.c,this.p())}function h(a){O++;this.b=this.a=void 0;this.e=[];if(p!==a){if(!s(a))throw new TypeError(\"You must pass a resolver function as the first argument to the promise constructor\");if(!(this instanceof h))throw new TypeError(\"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.\");N(this,a)}}var E=Array.isArray?Array.isArray:function(a){return\"[object Array]\"===\r\nObject.prototype.toString.call(a)},l=0,w=\"undefined\"!==typeof window?window:{},B=w.MutationObserver||w.WebKitMutationObserver,w=\"undefined\"!==typeof Uint8ClampedArray&&\"undefined\"!==typeof importScripts&&\"undefined\"!==typeof MessageChannel,n=Array(1E3),A;A=\"undefined\"!==typeof process&&\"[object process]\"==={}.toString.call(process)?F():B?G():w?H():I();var v=new D,y=new D;k.prototype.o=function(a){return E(a)};k.prototype.p=function(){return Error(\"Array Methods must be provided an Array\")};k.prototype.l=\r\nfunction(){this.b=Array(this.length)};k.prototype.k=function(){for(var a=this.length,b=this.c,c=this.m,d=0;void 0===b.a&&d<a;d++)this.j(c[d],d)};k.prototype.j=function(a,b){var c=this.n;\"object\"===typeof a&&null!==a?a.constructor===c&&void 0!==a.a?(a.f=null,this.g(a.a,b,a.b)):this.q(c.resolve(a),b):(this.d--,this.b[b]=this.h(a))};k.prototype.g=function(a,b,c){var d=this.c;void 0===d.a&&(this.d--,this.i&&2===a?g(d,c):this.b[b]=this.h(c));0===this.d&&m(d,this.b)};k.prototype.h=function(a){return a};\r\nk.prototype.q=function(a,b){var c=this;u(a,void 0,function(a){c.g(1,b,a)},function(a){c.g(2,b,a)})};var O=0;h.all=function(a,b){return(new k(this,a,!0,b)).c};h.race=function(a,b){function c(a){q(e,a)}function d(a){g(e,a)}var e=new this(p,b);if(!E(a))return (g(e,new TypeError(\"You must pass an array to race.\")), e);for(var f=a.length,h=0;void 0===e.a&&h<f;h++)u(this.resolve(a[h]),void 0,c,d);return e};h.resolve=function(a,b){if(a&&\"object\"===typeof a&&a.constructor===this)return a;var c=new this(p,b);\r\nq(c,a);return c};h.reject=function(a,b){var c=new this(p,b);g(c,a);return c};h.prototype={constructor:h,then:function(a,b){var c=this.a;if(1===c&&!a||2===c&&!b)return this;var d=new this.constructor(p),e=this.b;if(c){var f=arguments[c-1];r(function(){C(c,d,f,e)})}else u(this,d,a,b);return d},\"catch\":function(a){return this.then(null,a)}};var z={Promise:h,polyfill:function(){var a;a=\"undefined\"!==typeof global?global:\"undefined\"!==typeof window&&window.document?window:self;\"Promise\"in a&&\"resolve\"in\r\na.Promise&&\"reject\"in a.Promise&&\"all\"in a.Promise&&\"race\"in a.Promise&&function(){var b;new a.Promise(function(a){b=a});return s(b)}()||(a.Promise=h)}};\"function\"===typeof define&&define.amd?define(function(){return z}):\"undefined\"!==typeof module&&module.exports?module.exports=z:\"undefined\"!==typeof this&&(this.ES6Promise=z);}).call(window);\r\nif (window) {\r\n    window.ES6Promise.polyfill();\r\n}\r\n\r\n\r\nif (typeof(document) === \"undefined\" || typeof(Object.create) !== \"function\" || typeof(document.createElement(\"canvas\").getContext) !== \"function\") {\r\n    (window || module.exports).html2canvas = function() {\r\n        return Promise.reject(\"No canvas support\");\r\n    };\r\n    return;\r\n}\r\n\r\n/*! https://mths.be/punycode v1.3.1 by @mathias */\r\n;(function(root) {\r\n\r\n\t/** Detect free variables */\r\n\tvar freeExports = typeof exports == 'object' && exports &&\r\n\t\t!exports.nodeType && exports;\r\n\tvar freeModule = typeof module == 'object' && module &&\r\n\t\t!module.nodeType && module;\r\n\tvar freeGlobal = typeof global == 'object' && global;\r\n\tif (\r\n\t\tfreeGlobal.global === freeGlobal ||\r\n\t\tfreeGlobal.window === freeGlobal ||\r\n\t\tfreeGlobal.self === freeGlobal\r\n\t) {\r\n\t\troot = freeGlobal;\r\n\t}\r\n\r\n\t/**\r\n\t * The `punycode` object.\r\n\t * @name punycode\r\n\t * @type Object\r\n\t */\r\n\tvar punycode,\r\n\r\n\t/** Highest positive signed 32-bit float value */\r\n\tmaxInt = 2147483647, // aka. 0x7FFFFFFF or 2^31-1\r\n\r\n\t/** Bootstring parameters */\r\n\tbase = 36,\r\n\ttMin = 1,\r\n\ttMax = 26,\r\n\tskew = 38,\r\n\tdamp = 700,\r\n\tinitialBias = 72,\r\n\tinitialN = 128, // 0x80\r\n\tdelimiter = '-', // '\\x2D'\r\n\r\n\t/** Regular expressions */\r\n\tregexPunycode = /^xn--/,\r\n\tregexNonASCII = /[^\\x20-\\x7E]/, // unprintable ASCII chars + non-ASCII chars\r\n\tregexSeparators = /[\\x2E\\u3002\\uFF0E\\uFF61]/g, // RFC 3490 separators\r\n\r\n\t/** Error messages */\r\n\terrors = {\r\n\t\t'overflow': 'Overflow: input needs wider integers to process',\r\n\t\t'not-basic': 'Illegal input >= 0x80 (not a basic code point)',\r\n\t\t'invalid-input': 'Invalid input'\r\n\t},\r\n\r\n\t/** Convenience shortcuts */\r\n\tbaseMinusTMin = base - tMin,\r\n\tfloor = Math.floor,\r\n\tstringFromCharCode = String.fromCharCode,\r\n\r\n\t/** Temporary variable */\r\n\tkey;\r\n\r\n\t/*--------------------------------------------------------------------------*/\r\n\r\n\t/**\r\n\t * A generic error utility function.\r\n\t * @private\r\n\t * @param {String} type The error type.\r\n\t * @returns {Error} Throws a `RangeError` with the applicable error message.\r\n\t */\r\n\tfunction error(type) {\r\n\t\tthrow RangeError(errors[type]);\r\n\t}\r\n\r\n\t/**\r\n\t * A generic `Array#map` utility function.\r\n\t * @private\r\n\t * @param {Array} array The array to iterate over.\r\n\t * @param {Function} callback The function that gets called for every array\r\n\t * item.\r\n\t * @returns {Array} A new array of values returned by the callback function.\r\n\t */\r\n\tfunction map(array, fn) {\r\n\t\tvar length = array.length;\r\n\t\tvar result = [];\r\n\t\twhile (length--) {\r\n\t\t\tresult[length] = fn(array[length]);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\t/**\r\n\t * A simple `Array#map`-like wrapper to work with domain name strings or email\r\n\t * addresses.\r\n\t * @private\r\n\t * @param {String} domain The domain name or email address.\r\n\t * @param {Function} callback The function that gets called for every\r\n\t * character.\r\n\t * @returns {Array} A new string of characters returned by the callback\r\n\t * function.\r\n\t */\r\n\tfunction mapDomain(string, fn) {\r\n\t\tvar parts = string.split('@');\r\n\t\tvar result = '';\r\n\t\tif (parts.length > 1) {\r\n\t\t\t// In email addresses, only the domain name should be punycoded. Leave\r\n\t\t\t// the local part (i.e. everything up to `@`) intact.\r\n\t\t\tresult = parts[0] + '@';\r\n\t\t\tstring = parts[1];\r\n\t\t}\r\n\t\tvar labels = string.split(regexSeparators);\r\n\t\tvar encoded = map(labels, fn).join('.');\r\n\t\treturn result + encoded;\r\n\t}\r\n\r\n\t/**\r\n\t * Creates an array containing the numeric code points of each Unicode\r\n\t * character in the string. While JavaScript uses UCS-2 internally,\r\n\t * this function will convert a pair of surrogate halves (each of which\r\n\t * UCS-2 exposes as separate characters) into a single code point,\r\n\t * matching UTF-16.\r\n\t * @see `punycode.ucs2.encode`\r\n\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\r\n\t * @memberOf punycode.ucs2\r\n\t * @name decode\r\n\t * @param {String} string The Unicode input string (UCS-2).\r\n\t * @returns {Array} The new array of code points.\r\n\t */\r\n\tfunction ucs2decode(string) {\r\n\t\tvar output = [],\r\n\t\t    counter = 0,\r\n\t\t    length = string.length,\r\n\t\t    value,\r\n\t\t    extra;\r\n\t\twhile (counter < length) {\r\n\t\t\tvalue = string.charCodeAt(counter++);\r\n\t\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\r\n\t\t\t\t// high surrogate, and there is a next character\r\n\t\t\t\textra = string.charCodeAt(counter++);\r\n\t\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\r\n\t\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\r\n\t\t\t\t\t// code unit is the high surrogate of a surrogate pair\r\n\t\t\t\t\toutput.push(value);\r\n\t\t\t\t\tcounter--;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\toutput.push(value);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn output;\r\n\t}\r\n\r\n\t/**\r\n\t * Creates a string based on an array of numeric code points.\r\n\t * @see `punycode.ucs2.decode`\r\n\t * @memberOf punycode.ucs2\r\n\t * @name encode\r\n\t * @param {Array} codePoints The array of numeric code points.\r\n\t * @returns {String} The new Unicode string (UCS-2).\r\n\t */\r\n\tfunction ucs2encode(array) {\r\n\t\treturn map(array, function(value) {\r\n\t\t\tvar output = '';\r\n\t\t\tif (value > 0xFFFF) {\r\n\t\t\t\tvalue -= 0x10000;\r\n\t\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\r\n\t\t\t\tvalue = 0xDC00 | value & 0x3FF;\r\n\t\t\t}\r\n\t\t\toutput += stringFromCharCode(value);\r\n\t\t\treturn output;\r\n\t\t}).join('');\r\n\t}\r\n\r\n\t/**\r\n\t * Converts a basic code point into a digit/integer.\r\n\t * @see `digitToBasic()`\r\n\t * @private\r\n\t * @param {Number} codePoint The basic numeric code point value.\r\n\t * @returns {Number} The numeric value of a basic code point (for use in\r\n\t * representing integers) in the range `0` to `base - 1`, or `base` if\r\n\t * the code point does not represent a value.\r\n\t */\r\n\tfunction basicToDigit(codePoint) {\r\n\t\tif (codePoint - 48 < 10) {\r\n\t\t\treturn codePoint - 22;\r\n\t\t}\r\n\t\tif (codePoint - 65 < 26) {\r\n\t\t\treturn codePoint - 65;\r\n\t\t}\r\n\t\tif (codePoint - 97 < 26) {\r\n\t\t\treturn codePoint - 97;\r\n\t\t}\r\n\t\treturn base;\r\n\t}\r\n\r\n\t/**\r\n\t * Converts a digit/integer into a basic code point.\r\n\t * @see `basicToDigit()`\r\n\t * @private\r\n\t * @param {Number} digit The numeric value of a basic code point.\r\n\t * @returns {Number} The basic code point whose value (when used for\r\n\t * representing integers) is `digit`, which needs to be in the range\r\n\t * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\r\n\t * used; else, the lowercase form is used. The behavior is undefined\r\n\t * if `flag` is non-zero and `digit` has no uppercase form.\r\n\t */\r\n\tfunction digitToBasic(digit, flag) {\r\n\t\t//  0..25 map to ASCII a..z or A..Z\r\n\t\t// 26..35 map to ASCII 0..9\r\n\t\treturn digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);\r\n\t}\r\n\r\n\t/**\r\n\t * Bias adaptation function as per section 3.4 of RFC 3492.\r\n\t * http://tools.ietf.org/html/rfc3492#section-3.4\r\n\t * @private\r\n\t */\r\n\tfunction adapt(delta, numPoints, firstTime) {\r\n\t\tvar k = 0;\r\n\t\tdelta = firstTime ? floor(delta / damp) : delta >> 1;\r\n\t\tdelta += floor(delta / numPoints);\r\n\t\tfor (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {\r\n\t\t\tdelta = floor(delta / baseMinusTMin);\r\n\t\t}\r\n\t\treturn floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\r\n\t}\r\n\r\n\t/**\r\n\t * Converts a Punycode string of ASCII-only symbols to a string of Unicode\r\n\t * symbols.\r\n\t * @memberOf punycode\r\n\t * @param {String} input The Punycode string of ASCII-only symbols.\r\n\t * @returns {String} The resulting string of Unicode symbols.\r\n\t */\r\n\tfunction decode(input) {\r\n\t\t// Don't use UCS-2\r\n\t\tvar output = [],\r\n\t\t    inputLength = input.length,\r\n\t\t    out,\r\n\t\t    i = 0,\r\n\t\t    n = initialN,\r\n\t\t    bias = initialBias,\r\n\t\t    basic,\r\n\t\t    j,\r\n\t\t    index,\r\n\t\t    oldi,\r\n\t\t    w,\r\n\t\t    k,\r\n\t\t    digit,\r\n\t\t    t,\r\n\t\t    /** Cached calculation results */\r\n\t\t    baseMinusT;\r\n\r\n\t\t// Handle the basic code points: let `basic` be the number of input code\r\n\t\t// points before the last delimiter, or `0` if there is none, then copy\r\n\t\t// the first basic code points to the output.\r\n\r\n\t\tbasic = input.lastIndexOf(delimiter);\r\n\t\tif (basic < 0) {\r\n\t\t\tbasic = 0;\r\n\t\t}\r\n\r\n\t\tfor (j = 0; j < basic; ++j) {\r\n\t\t\t// if it's not a basic code point\r\n\t\t\tif (input.charCodeAt(j) >= 0x80) {\r\n\t\t\t\terror('not-basic');\r\n\t\t\t}\r\n\t\t\toutput.push(input.charCodeAt(j));\r\n\t\t}\r\n\r\n\t\t// Main decoding loop: start just after the last delimiter if any basic code\r\n\t\t// points were copied; start at the beginning otherwise.\r\n\r\n\t\tfor (index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {\r\n\r\n\t\t\t// `index` is the index of the next character to be consumed.\r\n\t\t\t// Decode a generalized variable-length integer into `delta`,\r\n\t\t\t// which gets added to `i`. The overflow checking is easier\r\n\t\t\t// if we increase `i` as we go, then subtract off its starting\r\n\t\t\t// value at the end to obtain `delta`.\r\n\t\t\tfor (oldi = i, w = 1, k = base; /* no condition */; k += base) {\r\n\r\n\t\t\t\tif (index >= inputLength) {\r\n\t\t\t\t\terror('invalid-input');\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdigit = basicToDigit(input.charCodeAt(index++));\r\n\r\n\t\t\t\tif (digit >= base || digit > floor((maxInt - i) / w)) {\r\n\t\t\t\t\terror('overflow');\r\n\t\t\t\t}\r\n\r\n\t\t\t\ti += digit * w;\r\n\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\r\n\r\n\t\t\t\tif (digit < t) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbaseMinusT = base - t;\r\n\t\t\t\tif (w > floor(maxInt / baseMinusT)) {\r\n\t\t\t\t\terror('overflow');\r\n\t\t\t\t}\r\n\r\n\t\t\t\tw *= baseMinusT;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tout = output.length + 1;\r\n\t\t\tbias = adapt(i - oldi, out, oldi == 0);\r\n\r\n\t\t\t// `i` was supposed to wrap around from `out` to `0`,\r\n\t\t\t// incrementing `n` each time, so we'll fix that now:\r\n\t\t\tif (floor(i / out) > maxInt - n) {\r\n\t\t\t\terror('overflow');\r\n\t\t\t}\r\n\r\n\t\t\tn += floor(i / out);\r\n\t\t\ti %= out;\r\n\r\n\t\t\t// Insert `n` at position `i` of the output\r\n\t\t\toutput.splice(i++, 0, n);\r\n\r\n\t\t}\r\n\r\n\t\treturn ucs2encode(output);\r\n\t}\r\n\r\n\t/**\r\n\t * Converts a string of Unicode symbols (e.g. a domain name label) to a\r\n\t * Punycode string of ASCII-only symbols.\r\n\t * @memberOf punycode\r\n\t * @param {String} input The string of Unicode symbols.\r\n\t * @returns {String} The resulting Punycode string of ASCII-only symbols.\r\n\t */\r\n\tfunction encode(input) {\r\n\t\tvar n,\r\n\t\t    delta,\r\n\t\t    handledCPCount,\r\n\t\t    basicLength,\r\n\t\t    bias,\r\n\t\t    j,\r\n\t\t    m,\r\n\t\t    q,\r\n\t\t    k,\r\n\t\t    t,\r\n\t\t    currentValue,\r\n\t\t    output = [],\r\n\t\t    /** `inputLength` will hold the number of code points in `input`. */\r\n\t\t    inputLength,\r\n\t\t    /** Cached calculation results */\r\n\t\t    handledCPCountPlusOne,\r\n\t\t    baseMinusT,\r\n\t\t    qMinusT;\r\n\r\n\t\t// Convert the input in UCS-2 to Unicode\r\n\t\tinput = ucs2decode(input);\r\n\r\n\t\t// Cache the length\r\n\t\tinputLength = input.length;\r\n\r\n\t\t// Initialize the state\r\n\t\tn = initialN;\r\n\t\tdelta = 0;\r\n\t\tbias = initialBias;\r\n\r\n\t\t// Handle the basic code points\r\n\t\tfor (j = 0; j < inputLength; ++j) {\r\n\t\t\tcurrentValue = input[j];\r\n\t\t\tif (currentValue < 0x80) {\r\n\t\t\t\toutput.push(stringFromCharCode(currentValue));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\thandledCPCount = basicLength = output.length;\r\n\r\n\t\t// `handledCPCount` is the number of code points that have been handled;\r\n\t\t// `basicLength` is the number of basic code points.\r\n\r\n\t\t// Finish the basic string - if it is not empty - with a delimiter\r\n\t\tif (basicLength) {\r\n\t\t\toutput.push(delimiter);\r\n\t\t}\r\n\r\n\t\t// Main encoding loop:\r\n\t\twhile (handledCPCount < inputLength) {\r\n\r\n\t\t\t// All non-basic code points < n have been handled already. Find the next\r\n\t\t\t// larger one:\r\n\t\t\tfor (m = maxInt, j = 0; j < inputLength; ++j) {\r\n\t\t\t\tcurrentValue = input[j];\r\n\t\t\t\tif (currentValue >= n && currentValue < m) {\r\n\t\t\t\t\tm = currentValue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\r\n\t\t\t// but guard against overflow\r\n\t\t\thandledCPCountPlusOne = handledCPCount + 1;\r\n\t\t\tif (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\r\n\t\t\t\terror('overflow');\r\n\t\t\t}\r\n\r\n\t\t\tdelta += (m - n) * handledCPCountPlusOne;\r\n\t\t\tn = m;\r\n\r\n\t\t\tfor (j = 0; j < inputLength; ++j) {\r\n\t\t\t\tcurrentValue = input[j];\r\n\r\n\t\t\t\tif (currentValue < n && ++delta > maxInt) {\r\n\t\t\t\t\terror('overflow');\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (currentValue == n) {\r\n\t\t\t\t\t// Represent delta as a generalized variable-length integer\r\n\t\t\t\t\tfor (q = delta, k = base; /* no condition */; k += base) {\r\n\t\t\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\r\n\t\t\t\t\t\tif (q < t) {\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tqMinusT = q - t;\r\n\t\t\t\t\t\tbaseMinusT = base - t;\r\n\t\t\t\t\t\toutput.push(\r\n\t\t\t\t\t\t\tstringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tq = floor(qMinusT / baseMinusT);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\toutput.push(stringFromCharCode(digitToBasic(q, 0)));\r\n\t\t\t\t\tbias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\r\n\t\t\t\t\tdelta = 0;\r\n\t\t\t\t\t++handledCPCount;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t++delta;\r\n\t\t\t++n;\r\n\r\n\t\t}\r\n\t\treturn output.join('');\r\n\t}\r\n\r\n\t/**\r\n\t * Converts a Punycode string representing a domain name or an email address\r\n\t * to Unicode. Only the Punycoded parts of the input will be converted, i.e.\r\n\t * it doesn't matter if you call it on a string that has already been\r\n\t * converted to Unicode.\r\n\t * @memberOf punycode\r\n\t * @param {String} input The Punycoded domain name or email address to\r\n\t * convert to Unicode.\r\n\t * @returns {String} The Unicode representation of the given Punycode\r\n\t * string.\r\n\t */\r\n\tfunction toUnicode(input) {\r\n\t\treturn mapDomain(input, function(string) {\r\n\t\t\treturn regexPunycode.test(string)\r\n\t\t\t\t? decode(string.slice(4).toLowerCase())\r\n\t\t\t\t: string;\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Converts a Unicode string representing a domain name or an email address to\r\n\t * Punycode. Only the non-ASCII parts of the domain name will be converted,\r\n\t * i.e. it doesn't matter if you call it with a domain that's already in\r\n\t * ASCII.\r\n\t * @memberOf punycode\r\n\t * @param {String} input The domain name or email address to convert, as a\r\n\t * Unicode string.\r\n\t * @returns {String} The Punycode representation of the given domain name or\r\n\t * email address.\r\n\t */\r\n\tfunction toASCII(input) {\r\n\t\treturn mapDomain(input, function(string) {\r\n\t\t\treturn regexNonASCII.test(string)\r\n\t\t\t\t? 'xn--' + encode(string)\r\n\t\t\t\t: string;\r\n\t\t});\r\n\t}\r\n\r\n\t/*--------------------------------------------------------------------------*/\r\n\r\n\t/** Define the public API */\r\n\tpunycode = {\r\n\t\t/**\r\n\t\t * A string representing the current Punycode.js version number.\r\n\t\t * @memberOf punycode\r\n\t\t * @type String\r\n\t\t */\r\n\t\t'version': '1.3.1',\r\n\t\t/**\r\n\t\t * An object of methods to convert from JavaScript's internal character\r\n\t\t * representation (UCS-2) to Unicode code points, and back.\r\n\t\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\r\n\t\t * @memberOf punycode\r\n\t\t * @type Object\r\n\t\t */\r\n\t\t'ucs2': {\r\n\t\t\t'decode': ucs2decode,\r\n\t\t\t'encode': ucs2encode\r\n\t\t},\r\n\t\t'decode': decode,\r\n\t\t'encode': encode,\r\n\t\t'toASCII': toASCII,\r\n\t\t'toUnicode': toUnicode\r\n\t};\r\n\r\n\t/** Expose `punycode` */\r\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\r\n\t// like the following:\r\n\tif (\r\n\t\ttypeof define == 'function' &&\r\n\t\ttypeof define.amd == 'object' &&\r\n\t\tdefine.amd\r\n\t) {\r\n\t\tdefine('punycode', function() {\r\n\t\t\treturn punycode;\r\n\t\t});\r\n\t} else if (freeExports && freeModule) {\r\n\t\tif (module.exports == freeExports) { // in Node.js or RingoJS v0.8.0+\r\n\t\t\tfreeModule.exports = punycode;\r\n\t\t} else { // in Narwhal or RingoJS v0.7.0-\r\n\t\t\tfor (key in punycode) {\r\n\t\t\t\tpunycode.hasOwnProperty(key) && (freeExports[key] = punycode[key]);\r\n\t\t\t}\r\n\t\t}\r\n\t} else { // in Rhino or a web browser\r\n\t\troot.punycode = punycode;\r\n\t}\r\n\r\n}(this));\r\n\r\nvar html2canvasNodeAttribute = \"data-html2canvas-node\";\r\nvar html2canvasCanvasCloneAttribute = \"data-html2canvas-canvas-clone\";\r\nvar html2canvasCanvasCloneIndex = 0;\r\nvar html2canvasCloneIndex = 0;\r\n\r\nwindow.html2canvas = function(nodeList, options) {\r\n    var index = html2canvasCloneIndex++;\r\n    options = options || {};\r\n    if (options.logging) {\r\n        window.html2canvas.logging = true;\r\n        window.html2canvas.start = Date.now();\r\n    }\r\n\r\n    options.async = typeof(options.async) === \"undefined\" ? true : options.async;\r\n    options.allowTaint = typeof(options.allowTaint) === \"undefined\" ? false : options.allowTaint;\r\n    options.removeContainer = typeof(options.removeContainer) === \"undefined\" ? true : options.removeContainer;\r\n    options.javascriptEnabled = typeof(options.javascriptEnabled) === \"undefined\" ? false : options.javascriptEnabled;\r\n    options.imageTimeout = typeof(options.imageTimeout) === \"undefined\" ? 10000 : options.imageTimeout;\r\n    options.renderer = typeof(options.renderer) === \"function\" ? options.renderer : CanvasRenderer;\r\n    options.strict = !!options.strict;\r\n\r\n    if (typeof(nodeList) === \"string\") {\r\n        if (typeof(options.proxy) !== \"string\") {\r\n            return Promise.reject(\"Proxy must be used when rendering url\");\r\n        }\r\n        var width = options.width != null ? options.width : window.innerWidth;\r\n        var height = options.height != null ? options.height : window.innerHeight;\r\n        return loadUrlDocument(absoluteUrl(nodeList), options.proxy, document, width, height, options).then(function(container) {\r\n            return renderWindow(container.contentWindow.document.documentElement, container, options, width, height);\r\n        });\r\n    }\r\n\r\n    var node = ((nodeList === undefined) ? [document.documentElement] : ((nodeList.length) ? nodeList : [nodeList]))[0];\r\n    node.setAttribute(html2canvasNodeAttribute + index, index);\r\n    return renderDocument(node.ownerDocument, options, node.ownerDocument.defaultView.innerWidth, node.ownerDocument.defaultView.innerHeight, index).then(function(canvas) {\r\n        if (typeof(options.onrendered) === \"function\") {\r\n            log(\"options.onrendered is deprecated, html2canvas returns a Promise containing the canvas\");\r\n            options.onrendered(canvas);\r\n        }\r\n        return canvas;\r\n    });\r\n};\r\n\r\nwindow.html2canvas.punycode = this.punycode;\r\nwindow.html2canvas.proxy = {};\r\n\r\nfunction renderDocument(document, options, windowWidth, windowHeight, html2canvasIndex) {\r\n    return createWindowClone(document, document, windowWidth, windowHeight, options, document.defaultView.pageXOffset, document.defaultView.pageYOffset).then(function(container) {\r\n        log(\"Document cloned\");\r\n        var attributeName = html2canvasNodeAttribute + html2canvasIndex;\r\n        var selector = \"[\" + attributeName + \"='\" + html2canvasIndex + \"']\";\r\n        document.querySelector(selector).removeAttribute(attributeName);\r\n        var clonedWindow = container.contentWindow;\r\n        var node = clonedWindow.document.querySelector(selector);\r\n        var oncloneHandler = (typeof(options.onclone) === \"function\") ? Promise.resolve(options.onclone(clonedWindow.document)) : Promise.resolve(true);\r\n        return oncloneHandler.then(function() {\r\n            return renderWindow(node, container, options, windowWidth, windowHeight);\r\n        });\r\n    });\r\n}\r\n\r\nfunction renderWindow(node, container, options, windowWidth, windowHeight) {\r\n    var clonedWindow = container.contentWindow;\r\n    var support = new Support(clonedWindow.document);\r\n    var imageLoader = new ImageLoader(options, support);\r\n    var bounds = getBounds(node);\r\n    var width = options.type === \"view\" ? windowWidth : documentWidth(clonedWindow.document);\r\n    var height = options.type === \"view\" ? windowHeight : documentHeight(clonedWindow.document);\r\n    var renderer = new options.renderer(width, height, imageLoader, options, document);\r\n    var parser = new NodeParser(node, renderer, support, imageLoader, options);\r\n    return parser.ready.then(function() {\r\n        log(\"Finished rendering\");\r\n        var canvas;\r\n\r\n        if (options.type === \"view\") {\r\n            canvas = crop(renderer.canvas, {width: renderer.canvas.width, height: renderer.canvas.height, top: 0, left: 0, x: 0, y: 0});\r\n        } else if (node === clonedWindow.document.body || node === clonedWindow.document.documentElement || options.canvas != null) {\r\n            canvas = renderer.canvas;\r\n        } else {\r\n            canvas = crop(renderer.canvas, {width:  options.width != null ? options.width : bounds.width, height: options.height != null ? options.height : bounds.height, top: bounds.top, left: bounds.left, x: clonedWindow.pageXOffset, y: clonedWindow.pageYOffset});\r\n        }\r\n\r\n        cleanupContainer(container, options);\r\n        return canvas;\r\n    });\r\n}\r\n\r\nfunction cleanupContainer(container, options) {\r\n    if (options.removeContainer) {\r\n        container.parentNode.removeChild(container);\r\n        log(\"Cleaned up container\");\r\n    }\r\n}\r\n\r\nfunction crop(canvas, bounds) {\r\n    var croppedCanvas = document.createElement(\"canvas\");\r\n    var x1 = Math.min(canvas.width - 1, Math.max(0, bounds.left));\r\n    var x2 = Math.min(canvas.width, Math.max(1, bounds.left + bounds.width));\r\n    var y1 = Math.min(canvas.height - 1, Math.max(0, bounds.top));\r\n    var y2 = Math.min(canvas.height, Math.max(1, bounds.top + bounds.height));\r\n    croppedCanvas.width = bounds.width;\r\n    croppedCanvas.height =  bounds.height;\r\n    log(\"Cropping canvas at:\", \"left:\", bounds.left, \"top:\", bounds.top, \"width:\", (x2-x1), \"height:\", (y2-y1));\r\n    log(\"Resulting crop with width\", bounds.width, \"and height\", bounds.height, \" with x\", x1, \"and y\", y1);\r\n    croppedCanvas.getContext(\"2d\").drawImage(canvas, x1, y1, x2-x1, y2-y1, bounds.x, bounds.y, x2-x1, y2-y1);\r\n    return croppedCanvas;\r\n}\r\n\r\nfunction documentWidth (doc) {\r\n    return Math.max(\r\n        Math.max(doc.body.scrollWidth, doc.documentElement.scrollWidth),\r\n        Math.max(doc.body.offsetWidth, doc.documentElement.offsetWidth),\r\n        Math.max(doc.body.clientWidth, doc.documentElement.clientWidth)\r\n    );\r\n}\r\n\r\nfunction documentHeight (doc) {\r\n    return Math.max(\r\n        Math.max(doc.body.scrollHeight, doc.documentElement.scrollHeight),\r\n        Math.max(doc.body.offsetHeight, doc.documentElement.offsetHeight),\r\n        Math.max(doc.body.clientHeight, doc.documentElement.clientHeight)\r\n    );\r\n}\r\n\r\nfunction smallImage() {\r\n    return \"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\";\r\n}\r\n\r\nfunction isIE9() {\r\n    return document.documentMode && document.documentMode <= 9;\r\n}\r\n\r\n// https://github.com/niklasvh/html2canvas/issues/503\r\nfunction cloneNodeIE9(node, javascriptEnabled) {\r\n    var clone = node.nodeType === 3 ? document.createTextNode(node.nodeValue) : node.cloneNode(false);\r\n\r\n    var child = node.firstChild;\r\n    while(child) {\r\n        if (javascriptEnabled === true || child.nodeType !== 1 || child.nodeName !== 'SCRIPT') {\r\n            clone.appendChild(cloneNodeIE9(child, javascriptEnabled));\r\n        }\r\n        child = child.nextSibling;\r\n    }\r\n\r\n    return clone;\r\n}\r\n\r\nfunction createWindowClone(ownerDocument, containerDocument, width, height, options, x ,y) {\r\n    labelCanvasElements(ownerDocument);\r\n    var documentElement = isIE9() ? cloneNodeIE9(ownerDocument.documentElement, options.javascriptEnabled) : ownerDocument.documentElement.cloneNode(true);\r\n    var container = containerDocument.createElement(\"iframe\");\r\n\r\n    container.className = \"html2canvas-container\";\r\n    container.style.visibility = \"hidden\";\r\n    container.style.position = \"fixed\";\r\n    container.style.left = \"-10000px\";\r\n    container.style.top = \"0px\";\r\n    container.style.border = \"0\";\r\n    container.width = width;\r\n    container.height = height;\r\n    container.scrolling = \"no\"; // ios won't scroll without it\r\n    containerDocument.body.appendChild(container);\r\n\r\n\r\n    return new Promise(function(resolve) {\r\n        var documentClone = container.contentWindow.document;\r\n\r\n        cloneNodeValues(ownerDocument.documentElement, documentElement, \"textarea\");\r\n        cloneNodeValues(ownerDocument.documentElement, documentElement, \"select\");\r\n\r\n        /* Chrome doesn't detect relative background-images assigned in inline <style> sheets when fetched through getComputedStyle\r\n         if window url is about:blank, we can assign the url to current by writing onto the document\r\n         */\r\n        container.contentWindow.onload = container.onload = function() {\r\n            var interval = setInterval(function() {\r\n                if (documentClone.body.childNodes.length > 0) {\r\n                    cloneCanvasContents(ownerDocument, documentClone);\r\n                    clearInterval(interval);\r\n                    if (options.type === \"view\") {\r\n                        container.contentWindow.scrollTo(x, y);\r\n                    }\r\n                    resolve(container);\r\n                }\r\n            }, 50);\r\n        };\r\n\r\n        documentClone.open();\r\n        documentClone.write(\"<!DOCTYPE html><html></html>\");\r\n        // Chrome scrolls the parent document for some reason after the write to the cloned window???\r\n        restoreOwnerScroll(ownerDocument, x, y);\r\n        documentClone.replaceChild(options.javascriptEnabled === true ? documentClone.adoptNode(documentElement) : removeScriptNodes(documentClone.adoptNode(documentElement)), documentClone.documentElement);\r\n        documentClone.close();\r\n    });\r\n}\r\n\r\nfunction cloneNodeValues(document, clone, nodeName) {\r\n    var originalNodes = document.getElementsByTagName(nodeName);\r\n    var clonedNodes = clone.getElementsByTagName(nodeName);\r\n    var count = originalNodes.length;\r\n    for (var i = 0; i < count; i++) {\r\n        clonedNodes[i].value = originalNodes[i].value;\r\n    }\r\n}\r\n\r\nfunction restoreOwnerScroll(ownerDocument, x, y) {\r\n    if (ownerDocument.defaultView && (x !== ownerDocument.defaultView.pageXOffset || y !== ownerDocument.defaultView.pageYOffset)) {\r\n        ownerDocument.defaultView.scrollTo(x, y);\r\n    }\r\n}\r\n\r\nfunction loadUrlDocument(src, proxy, document, width, height, options) {\r\n    return new Proxy(src, proxy, window.document).then(documentFromHTML(src)).then(function(doc) {\r\n        return createWindowClone(doc, document, width, height, options, 0, 0);\r\n    });\r\n}\r\n\r\nfunction documentFromHTML(src) {\r\n    return function(html) {\r\n        var parser = new DOMParser(), doc;\r\n        try {\r\n            doc = parser.parseFromString(html, \"text/html\");\r\n        } catch(e) {\r\n            log(\"DOMParser not supported, falling back to createHTMLDocument\");\r\n            doc = document.implementation.createHTMLDocument(\"\");\r\n            try {\r\n                doc.open();\r\n                doc.write(html);\r\n                doc.close();\r\n            } catch(ee) {\r\n                log(\"createHTMLDocument write not supported, falling back to document.body.innerHTML\");\r\n                doc.body.innerHTML = html; // ie9 doesnt support writing to documentElement\r\n            }\r\n        }\r\n\r\n        var b = doc.querySelector(\"base\");\r\n        if (!b || !b.href.host) {\r\n            var base = doc.createElement(\"base\");\r\n            base.href = src;\r\n            doc.head.insertBefore(base, doc.head.firstChild);\r\n        }\r\n\r\n        return doc;\r\n    };\r\n}\r\n\r\n\r\nfunction labelCanvasElements(ownerDocument) {\r\n    [].slice.call(ownerDocument.querySelectorAll(\"canvas\"), 0).forEach(function(canvas) {\r\n        canvas.setAttribute(html2canvasCanvasCloneAttribute, \"canvas-\" + html2canvasCanvasCloneIndex++);\r\n    });\r\n}\r\n\r\nfunction cloneCanvasContents(ownerDocument, documentClone) {\r\n    [].slice.call(ownerDocument.querySelectorAll(\"[\" + html2canvasCanvasCloneAttribute + \"]\"), 0).forEach(function(canvas) {\r\n        try {\r\n            var clonedCanvas = documentClone.querySelector('[' + html2canvasCanvasCloneAttribute + '=\"' + canvas.getAttribute(html2canvasCanvasCloneAttribute) + '\"]');\r\n            if (clonedCanvas) {\r\n                clonedCanvas.width = canvas.width;\r\n                clonedCanvas.height = canvas.height;\r\n                clonedCanvas.getContext(\"2d\").putImageData(canvas.getContext(\"2d\").getImageData(0, 0, canvas.width, canvas.height), 0, 0);\r\n            }\r\n        } catch(e) {\r\n            log(\"Unable to copy canvas content from\", canvas, e);\r\n        }\r\n        canvas.removeAttribute(html2canvasCanvasCloneAttribute);\r\n    });\r\n}\r\n\r\nfunction removeScriptNodes(parent) {\r\n    [].slice.call(parent.childNodes, 0).filter(isElementNode).forEach(function(node) {\r\n        if (node.tagName === \"SCRIPT\") {\r\n            parent.removeChild(node);\r\n        } else {\r\n            removeScriptNodes(node);\r\n        }\r\n    });\r\n    return parent;\r\n}\r\n\r\nfunction isElementNode(node) {\r\n    return node.nodeType === Node.ELEMENT_NODE;\r\n}\r\n\r\nfunction absoluteUrl(url) {\r\n    var link = document.createElement(\"a\");\r\n    link.href = url;\r\n    link.href = link.href;\r\n    return link;\r\n}\r\n\r\n// http://dev.w3.org/csswg/css-color/\r\n\r\nfunction Color(value) {\r\n    this.r = 0;\r\n    this.g = 0;\r\n    this.b = 0;\r\n    this.a = null;\r\n    var result = this.fromArray(value) ||\r\n        this.namedColor(value) ||\r\n        this.rgb(value) ||\r\n        this.rgba(value) ||\r\n        this.hex6(value) ||\r\n        this.hex3(value);\r\n}\r\n\r\nColor.prototype.darken = function(amount) {\r\n    var a = 1 - amount;\r\n    return  new Color([\r\n        Math.round(this.r * a),\r\n        Math.round(this.g * a),\r\n        Math.round(this.b * a),\r\n        this.a\r\n    ]);\r\n};\r\n\r\nColor.prototype.isTransparent = function() {\r\n    return this.a === 0;\r\n};\r\n\r\nColor.prototype.isBlack = function() {\r\n    return this.r === 0 && this.g === 0 && this.b === 0;\r\n};\r\n\r\nColor.prototype.fromArray = function(array) {\r\n    if (Array.isArray(array)) {\r\n        this.r = Math.min(array[0], 255);\r\n        this.g = Math.min(array[1], 255);\r\n        this.b = Math.min(array[2], 255);\r\n        if (array.length > 3) {\r\n            this.a = array[3];\r\n        }\r\n    }\r\n\r\n    return (Array.isArray(array));\r\n};\r\n\r\nvar _hex3 = /^#([a-f0-9]{3})$/i;\r\n\r\nColor.prototype.hex3 = function(value) {\r\n    var match = null;\r\n    if ((match = value.match(_hex3)) !== null) {\r\n        this.r = parseInt(match[1][0] + match[1][0], 16);\r\n        this.g = parseInt(match[1][1] + match[1][1], 16);\r\n        this.b = parseInt(match[1][2] + match[1][2], 16);\r\n    }\r\n    return match !== null;\r\n};\r\n\r\nvar _hex6 = /^#([a-f0-9]{6})$/i;\r\n\r\nColor.prototype.hex6 = function(value) {\r\n    var match = null;\r\n    if ((match = value.match(_hex6)) !== null) {\r\n        this.r = parseInt(match[1].substring(0, 2), 16);\r\n        this.g = parseInt(match[1].substring(2, 4), 16);\r\n        this.b = parseInt(match[1].substring(4, 6), 16);\r\n    }\r\n    return match !== null;\r\n};\r\n\r\n\r\nvar _rgb = /^rgb\\((\\d{1,3}) *, *(\\d{1,3}) *, *(\\d{1,3})\\)$/;\r\n\r\nColor.prototype.rgb = function(value) {\r\n    var match = null;\r\n    if ((match = value.match(_rgb)) !== null) {\r\n        this.r = Number(match[1]);\r\n        this.g = Number(match[2]);\r\n        this.b = Number(match[3]);\r\n    }\r\n    return match !== null;\r\n};\r\n\r\nvar _rgba = /^rgba\\((\\d{1,3}) *, *(\\d{1,3}) *, *(\\d{1,3}) *, *(\\d+\\.?\\d*)\\)$/;\r\n\r\nColor.prototype.rgba = function(value) {\r\n    var match = null;\r\n    if ((match = value.match(_rgba)) !== null) {\r\n        this.r = Number(match[1]);\r\n        this.g = Number(match[2]);\r\n        this.b = Number(match[3]);\r\n        this.a = Number(match[4]);\r\n    }\r\n    return match !== null;\r\n};\r\n\r\nColor.prototype.toString = function() {\r\n    return this.a !== null && this.a !== 1 ?\r\n    \"rgba(\" + [this.r, this.g, this.b, this.a].join(\",\") + \")\" :\r\n    \"rgb(\" + [this.r, this.g, this.b].join(\",\") + \")\";\r\n};\r\n\r\nColor.prototype.namedColor = function(value) {\r\n    var color = colors[value.toLowerCase()];\r\n    if (color) {\r\n        this.r = color[0];\r\n        this.g = color[1];\r\n        this.b = color[2];\r\n    } else if (value.toLowerCase() === \"transparent\") {\r\n        this.r = this.g = this.b = this.a = 0;\r\n        return true;\r\n    }\r\n\r\n    return !!color;\r\n};\r\n\r\nColor.prototype.isColor = true;\r\n\r\n// JSON.stringify([].slice.call($$('.named-color-table tr'), 1).map(function(row) { return [row.childNodes[3].textContent, row.childNodes[5].textContent.trim().split(\",\").map(Number)] }).reduce(function(data, row) {data[row[0]] = row[1]; return data}, {}))\r\nvar colors = {\r\n    \"aliceblue\": [240, 248, 255],\r\n    \"antiquewhite\": [250, 235, 215],\r\n    \"aqua\": [0, 255, 255],\r\n    \"aquamarine\": [127, 255, 212],\r\n    \"azure\": [240, 255, 255],\r\n    \"beige\": [245, 245, 220],\r\n    \"bisque\": [255, 228, 196],\r\n    \"black\": [0, 0, 0],\r\n    \"blanchedalmond\": [255, 235, 205],\r\n    \"blue\": [0, 0, 255],\r\n    \"blueviolet\": [138, 43, 226],\r\n    \"brown\": [165, 42, 42],\r\n    \"burlywood\": [222, 184, 135],\r\n    \"cadetblue\": [95, 158, 160],\r\n    \"chartreuse\": [127, 255, 0],\r\n    \"chocolate\": [210, 105, 30],\r\n    \"coral\": [255, 127, 80],\r\n    \"cornflowerblue\": [100, 149, 237],\r\n    \"cornsilk\": [255, 248, 220],\r\n    \"crimson\": [220, 20, 60],\r\n    \"cyan\": [0, 255, 255],\r\n    \"darkblue\": [0, 0, 139],\r\n    \"darkcyan\": [0, 139, 139],\r\n    \"darkgoldenrod\": [184, 134, 11],\r\n    \"darkgray\": [169, 169, 169],\r\n    \"darkgreen\": [0, 100, 0],\r\n    \"darkgrey\": [169, 169, 169],\r\n    \"darkkhaki\": [189, 183, 107],\r\n    \"darkmagenta\": [139, 0, 139],\r\n    \"darkolivegreen\": [85, 107, 47],\r\n    \"darkorange\": [255, 140, 0],\r\n    \"darkorchid\": [153, 50, 204],\r\n    \"darkred\": [139, 0, 0],\r\n    \"darksalmon\": [233, 150, 122],\r\n    \"darkseagreen\": [143, 188, 143],\r\n    \"darkslateblue\": [72, 61, 139],\r\n    \"darkslategray\": [47, 79, 79],\r\n    \"darkslategrey\": [47, 79, 79],\r\n    \"darkturquoise\": [0, 206, 209],\r\n    \"darkviolet\": [148, 0, 211],\r\n    \"deeppink\": [255, 20, 147],\r\n    \"deepskyblue\": [0, 191, 255],\r\n    \"dimgray\": [105, 105, 105],\r\n    \"dimgrey\": [105, 105, 105],\r\n    \"dodgerblue\": [30, 144, 255],\r\n    \"firebrick\": [178, 34, 34],\r\n    \"floralwhite\": [255, 250, 240],\r\n    \"forestgreen\": [34, 139, 34],\r\n    \"fuchsia\": [255, 0, 255],\r\n    \"gainsboro\": [220, 220, 220],\r\n    \"ghostwhite\": [248, 248, 255],\r\n    \"gold\": [255, 215, 0],\r\n    \"goldenrod\": [218, 165, 32],\r\n    \"gray\": [128, 128, 128],\r\n    \"green\": [0, 128, 0],\r\n    \"greenyellow\": [173, 255, 47],\r\n    \"grey\": [128, 128, 128],\r\n    \"honeydew\": [240, 255, 240],\r\n    \"hotpink\": [255, 105, 180],\r\n    \"indianred\": [205, 92, 92],\r\n    \"indigo\": [75, 0, 130],\r\n    \"ivory\": [255, 255, 240],\r\n    \"khaki\": [240, 230, 140],\r\n    \"lavender\": [230, 230, 250],\r\n    \"lavenderblush\": [255, 240, 245],\r\n    \"lawngreen\": [124, 252, 0],\r\n    \"lemonchiffon\": [255, 250, 205],\r\n    \"lightblue\": [173, 216, 230],\r\n    \"lightcoral\": [240, 128, 128],\r\n    \"lightcyan\": [224, 255, 255],\r\n    \"lightgoldenrodyellow\": [250, 250, 210],\r\n    \"lightgray\": [211, 211, 211],\r\n    \"lightgreen\": [144, 238, 144],\r\n    \"lightgrey\": [211, 211, 211],\r\n    \"lightpink\": [255, 182, 193],\r\n    \"lightsalmon\": [255, 160, 122],\r\n    \"lightseagreen\": [32, 178, 170],\r\n    \"lightskyblue\": [135, 206, 250],\r\n    \"lightslategray\": [119, 136, 153],\r\n    \"lightslategrey\": [119, 136, 153],\r\n    \"lightsteelblue\": [176, 196, 222],\r\n    \"lightyellow\": [255, 255, 224],\r\n    \"lime\": [0, 255, 0],\r\n    \"limegreen\": [50, 205, 50],\r\n    \"linen\": [250, 240, 230],\r\n    \"magenta\": [255, 0, 255],\r\n    \"maroon\": [128, 0, 0],\r\n    \"mediumaquamarine\": [102, 205, 170],\r\n    \"mediumblue\": [0, 0, 205],\r\n    \"mediumorchid\": [186, 85, 211],\r\n    \"mediumpurple\": [147, 112, 219],\r\n    \"mediumseagreen\": [60, 179, 113],\r\n    \"mediumslateblue\": [123, 104, 238],\r\n    \"mediumspringgreen\": [0, 250, 154],\r\n    \"mediumturquoise\": [72, 209, 204],\r\n    \"mediumvioletred\": [199, 21, 133],\r\n    \"midnightblue\": [25, 25, 112],\r\n    \"mintcream\": [245, 255, 250],\r\n    \"mistyrose\": [255, 228, 225],\r\n    \"moccasin\": [255, 228, 181],\r\n    \"navajowhite\": [255, 222, 173],\r\n    \"navy\": [0, 0, 128],\r\n    \"oldlace\": [253, 245, 230],\r\n    \"olive\": [128, 128, 0],\r\n    \"olivedrab\": [107, 142, 35],\r\n    \"orange\": [255, 165, 0],\r\n    \"orangered\": [255, 69, 0],\r\n    \"orchid\": [218, 112, 214],\r\n    \"palegoldenrod\": [238, 232, 170],\r\n    \"palegreen\": [152, 251, 152],\r\n    \"paleturquoise\": [175, 238, 238],\r\n    \"palevioletred\": [219, 112, 147],\r\n    \"papayawhip\": [255, 239, 213],\r\n    \"peachpuff\": [255, 218, 185],\r\n    \"peru\": [205, 133, 63],\r\n    \"pink\": [255, 192, 203],\r\n    \"plum\": [221, 160, 221],\r\n    \"powderblue\": [176, 224, 230],\r\n    \"purple\": [128, 0, 128],\r\n    \"rebeccapurple\": [102, 51, 153],\r\n    \"red\": [255, 0, 0],\r\n    \"rosybrown\": [188, 143, 143],\r\n    \"royalblue\": [65, 105, 225],\r\n    \"saddlebrown\": [139, 69, 19],\r\n    \"salmon\": [250, 128, 114],\r\n    \"sandybrown\": [244, 164, 96],\r\n    \"seagreen\": [46, 139, 87],\r\n    \"seashell\": [255, 245, 238],\r\n    \"sienna\": [160, 82, 45],\r\n    \"silver\": [192, 192, 192],\r\n    \"skyblue\": [135, 206, 235],\r\n    \"slateblue\": [106, 90, 205],\r\n    \"slategray\": [112, 128, 144],\r\n    \"slategrey\": [112, 128, 144],\r\n    \"snow\": [255, 250, 250],\r\n    \"springgreen\": [0, 255, 127],\r\n    \"steelblue\": [70, 130, 180],\r\n    \"tan\": [210, 180, 140],\r\n    \"teal\": [0, 128, 128],\r\n    \"thistle\": [216, 191, 216],\r\n    \"tomato\": [255, 99, 71],\r\n    \"turquoise\": [64, 224, 208],\r\n    \"violet\": [238, 130, 238],\r\n    \"wheat\": [245, 222, 179],\r\n    \"white\": [255, 255, 255],\r\n    \"whitesmoke\": [245, 245, 245],\r\n    \"yellow\": [255, 255, 0],\r\n    \"yellowgreen\": [154, 205, 50]\r\n};\r\n\r\n\r\nfunction DummyImageContainer(src) {\r\n    this.src = src;\r\n    log(\"DummyImageContainer for\", src);\r\n    if (!this.promise || !this.image) {\r\n        log(\"Initiating DummyImageContainer\");\r\n        DummyImageContainer.prototype.image = new Image();\r\n        var image = this.image;\r\n        DummyImageContainer.prototype.promise = new Promise(function(resolve, reject) {\r\n            image.onload = resolve;\r\n            image.onerror = reject;\r\n            image.src = smallImage();\r\n            if (image.complete === true) {\r\n                resolve(image);\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nfunction Font(family, size) {\r\n    var container = document.createElement('div'),\r\n        img = document.createElement('img'),\r\n        span = document.createElement('span'),\r\n        sampleText = 'Hidden Text',\r\n        baseline,\r\n        middle;\r\n\r\n    container.style.visibility = \"hidden\";\r\n    container.style.fontFamily = family;\r\n    container.style.fontSize = size;\r\n    container.style.margin = 0;\r\n    container.style.padding = 0;\r\n\r\n    document.body.appendChild(container);\r\n\r\n    img.src = smallImage();\r\n    img.width = 1;\r\n    img.height = 1;\r\n\r\n    img.style.margin = 0;\r\n    img.style.padding = 0;\r\n    img.style.verticalAlign = \"baseline\";\r\n\r\n    span.style.fontFamily = family;\r\n    span.style.fontSize = size;\r\n    span.style.margin = 0;\r\n    span.style.padding = 0;\r\n\r\n    span.appendChild(document.createTextNode(sampleText));\r\n    container.appendChild(span);\r\n    container.appendChild(img);\r\n    baseline = (img.offsetTop - span.offsetTop) + 1;\r\n\r\n    container.removeChild(span);\r\n    container.appendChild(document.createTextNode(sampleText));\r\n\r\n    container.style.lineHeight = \"normal\";\r\n    img.style.verticalAlign = \"super\";\r\n\r\n    middle = (img.offsetTop-container.offsetTop) + 1;\r\n\r\n    document.body.removeChild(container);\r\n\r\n    this.baseline = baseline;\r\n    this.lineWidth = 1;\r\n    this.middle = middle;\r\n}\r\n\r\nfunction FontMetrics() {\r\n    this.data = {};\r\n}\r\n\r\nFontMetrics.prototype.getMetrics = function(family, size) {\r\n    if (this.data[family + \"-\" + size] === undefined) {\r\n        this.data[family + \"-\" + size] = new Font(family, size);\r\n    }\r\n    return this.data[family + \"-\" + size];\r\n};\r\n\r\nfunction FrameContainer(container, sameOrigin, options) {\r\n    this.image = null;\r\n    this.src = container;\r\n    var self = this;\r\n    var bounds = getBounds(container);\r\n    this.promise = (!sameOrigin ? this.proxyLoad(options.proxy, bounds, options) : new Promise(function(resolve) {\r\n        if (container.contentWindow.document.URL === \"about:blank\" || container.contentWindow.document.documentElement == null) {\r\n            container.contentWindow.onload = container.onload = function() {\r\n                resolve(container);\r\n            };\r\n        } else {\r\n            resolve(container);\r\n        }\r\n    })).then(function(container) {\r\n        return html2canvas(container.contentWindow.document.documentElement, {type: 'view', width: container.width, height: container.height, proxy: options.proxy, javascriptEnabled: options.javascriptEnabled, removeContainer: options.removeContainer, allowTaint: options.allowTaint, imageTimeout: options.imageTimeout / 2});\r\n    }).then(function(canvas) {\r\n        return self.image = canvas;\r\n    });\r\n}\r\n\r\nFrameContainer.prototype.proxyLoad = function(proxy, bounds, options) {\r\n    var container = this.src;\r\n    return loadUrlDocument(container.src, proxy, container.ownerDocument, bounds.width, bounds.height, options);\r\n};\r\n\r\nfunction GradientContainer(imageData) {\r\n    this.src = imageData.value;\r\n    this.colorStops = [];\r\n    this.type = null;\r\n    this.x0 = 0.5;\r\n    this.y0 = 0.5;\r\n    this.x1 = 0.5;\r\n    this.y1 = 0.5;\r\n    this.promise = Promise.resolve(true);\r\n}\r\n\r\nGradientContainer.prototype.TYPES = {\r\n    LINEAR: 1,\r\n    RADIAL: 2\r\n};\r\n\r\nfunction ImageContainer(src, cors) {\r\n    this.src = src;\r\n    this.image = new Image();\r\n    var self = this;\r\n    this.tainted = null;\r\n    this.promise = new Promise(function(resolve, reject) {\r\n        self.image.onload = resolve;\r\n        self.image.onerror = reject;\r\n        if (cors) {\r\n            self.image.crossOrigin = \"anonymous\";\r\n        }\r\n        self.image.src = src;\r\n        if (self.image.complete === true) {\r\n            resolve(self.image);\r\n        }\r\n    });\r\n}\r\n\r\nfunction ImageLoader(options, support) {\r\n    this.link = null;\r\n    this.options = options;\r\n    this.support = support;\r\n    this.origin = this.getOrigin(window.location.href);\r\n}\r\n\r\nImageLoader.prototype.findImages = function(nodes) {\r\n    var images = [];\r\n    nodes.reduce(function(imageNodes, container) {\r\n        switch(container.node.nodeName) {\r\n        case \"IMG\":\r\n            return imageNodes.concat([{\r\n                args: [container.node.src],\r\n                method: \"url\"\r\n            }]);\r\n        case \"svg\":\r\n        case \"IFRAME\":\r\n            return imageNodes.concat([{\r\n                args: [container.node],\r\n                method: container.node.nodeName\r\n            }]);\r\n        }\r\n        return imageNodes;\r\n    }, []).forEach(this.addImage(images, this.loadImage), this);\r\n    return images;\r\n};\r\n\r\nImageLoader.prototype.findBackgroundImage = function(images, container) {\r\n    container.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(images, this.loadImage), this);\r\n    return images;\r\n};\r\n\r\nImageLoader.prototype.addImage = function(images, callback) {\r\n    return function(newImage) {\r\n        newImage.args.forEach(function(image) {\r\n            if (!this.imageExists(images, image)) {\r\n                images.splice(0, 0, callback.call(this, newImage));\r\n                log('Added image #' + (images.length), typeof(image) === \"string\" ? image.substring(0, 100) : image);\r\n            }\r\n        }, this);\r\n    };\r\n};\r\n\r\nImageLoader.prototype.hasImageBackground = function(imageData) {\r\n    return imageData.method !== \"none\";\r\n};\r\n\r\nImageLoader.prototype.loadImage = function(imageData) {\r\n    if (imageData.method === \"url\") {\r\n        var src = imageData.args[0];\r\n        if (this.isSVG(src) && !this.support.svg && !this.options.allowTaint) {\r\n            return new SVGContainer(src);\r\n        } else if (src.match(/data:image\\/.*;base64,/i)) {\r\n            return new ImageContainer(src.replace(/url\\(['\"]{0,}|['\"]{0,}\\)$/ig, ''), false);\r\n        } else if (this.isSameOrigin(src) || this.options.allowTaint === true || this.isSVG(src)) {\r\n            return new ImageContainer(src, false);\r\n        } else if (this.support.cors && !this.options.allowTaint && this.options.useCORS) {\r\n            return new ImageContainer(src, true);\r\n        } else if (this.options.proxy) {\r\n            return new ProxyImageContainer(src, this.options.proxy);\r\n        } else {\r\n            return new DummyImageContainer(src);\r\n        }\r\n    } else if (imageData.method === \"linear-gradient\") {\r\n        return new LinearGradientContainer(imageData);\r\n    } else if (imageData.method === \"gradient\") {\r\n        return new WebkitGradientContainer(imageData);\r\n    } else if (imageData.method === \"svg\") {\r\n        return new SVGNodeContainer(imageData.args[0], this.support.svg);\r\n    } else if (imageData.method === \"IFRAME\") {\r\n        return new FrameContainer(imageData.args[0], this.isSameOrigin(imageData.args[0].src), this.options);\r\n    } else {\r\n        return new DummyImageContainer(imageData);\r\n    }\r\n};\r\n\r\nImageLoader.prototype.isSVG = function(src) {\r\n    return src.substring(src.length - 3).toLowerCase() === \"svg\" || SVGContainer.prototype.isInline(src);\r\n};\r\n\r\nImageLoader.prototype.imageExists = function(images, src) {\r\n    return images.some(function(image) {\r\n        return image.src === src;\r\n    });\r\n};\r\n\r\nImageLoader.prototype.isSameOrigin = function(url) {\r\n    return (this.getOrigin(url) === this.origin);\r\n};\r\n\r\nImageLoader.prototype.getOrigin = function(url) {\r\n    var link = this.link || (this.link = document.createElement(\"a\"));\r\n    link.href = url;\r\n    link.href = link.href; // IE9, LOL! - http://jsfiddle.net/niklasvh/2e48b/\r\n    return link.protocol + link.hostname + link.port;\r\n};\r\n\r\nImageLoader.prototype.getPromise = function(container) {\r\n    return this.timeout(container, this.options.imageTimeout)['catch'](function() {\r\n        var dummy = new DummyImageContainer(container.src);\r\n        return dummy.promise.then(function(image) {\r\n            container.image = image;\r\n        });\r\n    });\r\n};\r\n\r\nImageLoader.prototype.get = function(src) {\r\n    var found = null;\r\n    return this.images.some(function(img) {\r\n        return (found = img).src === src;\r\n    }) ? found : null;\r\n};\r\n\r\nImageLoader.prototype.fetch = function(nodes) {\r\n    this.images = nodes.reduce(bind(this.findBackgroundImage, this), this.findImages(nodes));\r\n    this.images.forEach(function(image, index) {\r\n        image.promise.then(function() {\r\n            log(\"Succesfully loaded image #\"+ (index+1), image);\r\n        }, function(e) {\r\n            log(\"Failed loading image #\"+ (index+1), image, e);\r\n        });\r\n    });\r\n    this.ready = Promise.all(this.images.map(this.getPromise, this));\r\n    log(\"Finished searching images\");\r\n    return this;\r\n};\r\n\r\nImageLoader.prototype.timeout = function(container, timeout) {\r\n    var timer;\r\n    var promise = Promise.race([container.promise, new Promise(function(res, reject) {\r\n        timer = setTimeout(function() {\r\n            log(\"Timed out loading image\", container);\r\n            reject(container);\r\n        }, timeout);\r\n    })]).then(function(container) {\r\n        clearTimeout(timer);\r\n        return container;\r\n    });\r\n    promise['catch'](function() {\r\n        clearTimeout(timer);\r\n    });\r\n    return promise;\r\n};\r\n\r\nfunction LinearGradientContainer(imageData) {\r\n    GradientContainer.apply(this, arguments);\r\n    this.type = this.TYPES.LINEAR;\r\n\r\n    var hasDirection = imageData.args[0].match(this.stepRegExp) === null;\r\n\r\n    if (hasDirection) {\r\n        imageData.args[0].split(\" \").reverse().forEach(function(position) {\r\n            switch(position) {\r\n            case \"left\":\r\n                this.x0 = 0;\r\n                this.x1 = 1;\r\n                break;\r\n            case \"top\":\r\n                this.y0 = 0;\r\n                this.y1 = 1;\r\n                break;\r\n            case \"right\":\r\n                this.x0 = 1;\r\n                this.x1 = 0;\r\n                break;\r\n            case \"bottom\":\r\n                this.y0 = 1;\r\n                this.y1 = 0;\r\n                break;\r\n            case \"to\":\r\n                var y0 = this.y0;\r\n                var x0 = this.x0;\r\n                this.y0 = this.y1;\r\n                this.x0 = this.x1;\r\n                this.x1 = x0;\r\n                this.y1 = y0;\r\n                break;\r\n            }\r\n        }, this);\r\n    } else {\r\n        this.y0 = 0;\r\n        this.y1 = 1;\r\n    }\r\n\r\n    this.colorStops = imageData.args.slice(hasDirection ? 1 : 0).map(function(colorStop) {\r\n        var colorStopMatch = colorStop.match(this.stepRegExp);\r\n        return {\r\n            color: new Color(colorStopMatch[1]),\r\n            stop: colorStopMatch[3] === \"%\" ? colorStopMatch[2] / 100 : null\r\n        };\r\n    }, this);\r\n\r\n    if (this.colorStops[0].stop === null) {\r\n        this.colorStops[0].stop = 0;\r\n    }\r\n\r\n    if (this.colorStops[this.colorStops.length - 1].stop === null) {\r\n        this.colorStops[this.colorStops.length - 1].stop = 1;\r\n    }\r\n\r\n    this.colorStops.forEach(function(colorStop, index) {\r\n        if (colorStop.stop === null) {\r\n            this.colorStops.slice(index).some(function(find, count) {\r\n                if (find.stop !== null) {\r\n                    colorStop.stop = ((find.stop - this.colorStops[index - 1].stop) / (count + 1)) + this.colorStops[index - 1].stop;\r\n                    return true;\r\n                } else {\r\n                    return false;\r\n                }\r\n            }, this);\r\n        }\r\n    }, this);\r\n}\r\n\r\nLinearGradientContainer.prototype = Object.create(GradientContainer.prototype);\r\n\r\nLinearGradientContainer.prototype.stepRegExp = /((?:rgb|rgba)\\(\\d{1,3},\\s\\d{1,3},\\s\\d{1,3}(?:,\\s[0-9\\.]+)?\\))\\s*(\\d{1,3})?(%|px)?/;\r\n\r\nfunction log() {\r\n    if (window.html2canvas.logging && window.console && window.console.log) {\r\n        Function.prototype.bind.call(window.console.log, (window.console)).apply(window.console, [(Date.now() - window.html2canvas.start) + \"ms\", \"html2canvas:\"].concat([].slice.call(arguments, 0)));\r\n    }\r\n}\r\n\r\nfunction NodeContainer(node, parent) {\r\n    this.node = node;\r\n    this.parent = parent;\r\n    this.stack = null;\r\n    this.bounds = null;\r\n    this.borders = null;\r\n    this.clip = [];\r\n    this.backgroundClip = [];\r\n    this.offsetBounds = null;\r\n    this.visible = null;\r\n    this.computedStyles = null;\r\n    this.colors = {};\r\n    this.styles = {};\r\n    this.backgroundImages = null;\r\n    this.transformData = null;\r\n    this.transformMatrix = null;\r\n    this.isPseudoElement = false;\r\n    this.opacity = null;\r\n}\r\n\r\nNodeContainer.prototype.cloneTo = function(stack) {\r\n    stack.visible = this.visible;\r\n    stack.borders = this.borders;\r\n    stack.bounds = this.bounds;\r\n    stack.clip = this.clip;\r\n    stack.backgroundClip = this.backgroundClip;\r\n    stack.computedStyles = this.computedStyles;\r\n    stack.styles = this.styles;\r\n    stack.backgroundImages = this.backgroundImages;\r\n    stack.opacity = this.opacity;\r\n};\r\n\r\nNodeContainer.prototype.getOpacity = function() {\r\n    return this.opacity === null ? (this.opacity = this.cssFloat('opacity')) : this.opacity;\r\n};\r\n\r\nNodeContainer.prototype.assignStack = function(stack) {\r\n    this.stack = stack;\r\n    stack.children.push(this);\r\n};\r\n\r\nNodeContainer.prototype.isElementVisible = function() {\r\n    return this.node.nodeType === Node.TEXT_NODE ? this.parent.visible : (\r\n        this.css('display') !== \"none\" &&\r\n        this.css('visibility') !== \"hidden\" &&\r\n        !this.node.hasAttribute(\"data-html2canvas-ignore\") &&\r\n        (this.node.nodeName !== \"INPUT\" || this.node.getAttribute(\"type\") !== \"hidden\")\r\n    );\r\n};\r\n\r\nNodeContainer.prototype.css = function(attribute) {\r\n    if (!this.computedStyles) {\r\n        this.computedStyles = this.isPseudoElement ? this.parent.computedStyle(this.before ? \":before\" : \":after\") : this.computedStyle(null);\r\n    }\r\n\r\n    return this.styles[attribute] || (this.styles[attribute] = this.computedStyles[attribute]);\r\n};\r\n\r\nNodeContainer.prototype.prefixedCss = function(attribute) {\r\n    var prefixes = [\"webkit\", \"moz\", \"ms\", \"o\"];\r\n    var value = this.css(attribute);\r\n    if (value === undefined) {\r\n        prefixes.some(function(prefix) {\r\n            value = this.css(prefix + attribute.substr(0, 1).toUpperCase() + attribute.substr(1));\r\n            return value !== undefined;\r\n        }, this);\r\n    }\r\n    return value === undefined ? null : value;\r\n};\r\n\r\nNodeContainer.prototype.computedStyle = function(type) {\r\n    return this.node.ownerDocument.defaultView.getComputedStyle(this.node, type);\r\n};\r\n\r\nNodeContainer.prototype.cssInt = function(attribute) {\r\n    var value = parseInt(this.css(attribute), 10);\r\n    return (isNaN(value)) ? 0 : value; // borders in old IE are throwing 'medium' for demo.html\r\n};\r\n\r\nNodeContainer.prototype.color = function(attribute) {\r\n    return this.colors[attribute] || (this.colors[attribute] = new Color(this.css(attribute)));\r\n};\r\n\r\nNodeContainer.prototype.cssFloat = function(attribute) {\r\n    var value = parseFloat(this.css(attribute));\r\n    return (isNaN(value)) ? 0 : value;\r\n};\r\n\r\nNodeContainer.prototype.fontWeight = function() {\r\n    var weight = this.css(\"fontWeight\");\r\n    switch(parseInt(weight, 10)){\r\n    case 401:\r\n        weight = \"bold\";\r\n        break;\r\n    case 400:\r\n        weight = \"normal\";\r\n        break;\r\n    }\r\n    return weight;\r\n};\r\n\r\nNodeContainer.prototype.parseClip = function() {\r\n    var matches = this.css('clip').match(this.CLIP);\r\n    if (matches) {\r\n        return {\r\n            top: parseInt(matches[1], 10),\r\n            right: parseInt(matches[2], 10),\r\n            bottom: parseInt(matches[3], 10),\r\n            left: parseInt(matches[4], 10)\r\n        };\r\n    }\r\n    return null;\r\n};\r\n\r\nNodeContainer.prototype.parseBackgroundImages = function() {\r\n    return this.backgroundImages || (this.backgroundImages = parseBackgrounds(this.css(\"backgroundImage\")));\r\n};\r\n\r\nNodeContainer.prototype.cssList = function(property, index) {\r\n    var value = (this.css(property) || '').split(',');\r\n    value = value[index || 0] || value[0] || 'auto';\r\n    value = value.trim().split(' ');\r\n    if (value.length === 1) {\r\n        value = [value[0], value[0]];\r\n    }\r\n    return value;\r\n};\r\n\r\nNodeContainer.prototype.parseBackgroundSize = function(bounds, image, index) {\r\n    var size = this.cssList(\"backgroundSize\", index);\r\n    var width, height;\r\n\r\n    if (isPercentage(size[0])) {\r\n        width = bounds.width * parseFloat(size[0]) / 100;\r\n    } else if (/contain|cover/.test(size[0])) {\r\n        var targetRatio = bounds.width / bounds.height, currentRatio = image.width / image.height;\r\n        return (targetRatio < currentRatio ^ size[0] === 'contain') ?  {width: bounds.height * currentRatio, height: bounds.height} : {width: bounds.width, height: bounds.width / currentRatio};\r\n    } else {\r\n        width = parseInt(size[0], 10);\r\n    }\r\n\r\n    if (size[0] === 'auto' && size[1] === 'auto') {\r\n        height = image.height;\r\n    } else if (size[1] === 'auto') {\r\n        height = width / image.width * image.height;\r\n    } else if (isPercentage(size[1])) {\r\n        height =  bounds.height * parseFloat(size[1]) / 100;\r\n    } else {\r\n        height = parseInt(size[1], 10);\r\n    }\r\n\r\n    if (size[0] === 'auto') {\r\n        width = height / image.height * image.width;\r\n    }\r\n\r\n    return {width: width, height: height};\r\n};\r\n\r\nNodeContainer.prototype.parseBackgroundPosition = function(bounds, image, index, backgroundSize) {\r\n    var position = this.cssList('backgroundPosition', index);\r\n    var left, top;\r\n\r\n    if (isPercentage(position[0])){\r\n        left = (bounds.width - (backgroundSize || image).width) * (parseFloat(position[0]) / 100);\r\n    } else {\r\n        left = parseInt(position[0], 10);\r\n    }\r\n\r\n    if (position[1] === 'auto') {\r\n        top = left / image.width * image.height;\r\n    } else if (isPercentage(position[1])){\r\n        top =  (bounds.height - (backgroundSize || image).height) * parseFloat(position[1]) / 100;\r\n    } else {\r\n        top = parseInt(position[1], 10);\r\n    }\r\n\r\n    if (position[0] === 'auto') {\r\n        left = top / image.height * image.width;\r\n    }\r\n\r\n    return {left: left, top: top};\r\n};\r\n\r\nNodeContainer.prototype.parseBackgroundRepeat = function(index) {\r\n    return this.cssList(\"backgroundRepeat\", index)[0];\r\n};\r\n\r\nNodeContainer.prototype.parseTextShadows = function() {\r\n    var textShadow = this.css(\"textShadow\");\r\n    var results = [];\r\n\r\n    if (textShadow && textShadow !== 'none') {\r\n        var shadows = textShadow.match(this.TEXT_SHADOW_PROPERTY);\r\n        for (var i = 0; shadows && (i < shadows.length); i++) {\r\n            var s = shadows[i].match(this.TEXT_SHADOW_VALUES);\r\n            results.push({\r\n                color: new Color(s[0]),\r\n                offsetX: s[1] ? parseFloat(s[1].replace('px', '')) : 0,\r\n                offsetY: s[2] ? parseFloat(s[2].replace('px', '')) : 0,\r\n                blur: s[3] ? s[3].replace('px', '') : 0\r\n            });\r\n        }\r\n    }\r\n    return results;\r\n};\r\n\r\nNodeContainer.prototype.parseTransform = function() {\r\n    if (!this.transformData) {\r\n        if (this.hasTransform()) {\r\n            var offset = this.parseBounds();\r\n            var origin = this.prefixedCss(\"transformOrigin\").split(\" \").map(removePx).map(asFloat);\r\n            origin[0] += offset.left;\r\n            origin[1] += offset.top;\r\n            this.transformData = {\r\n                origin: origin,\r\n                matrix: this.parseTransformMatrix()\r\n            };\r\n        } else {\r\n            this.transformData = {\r\n                origin: [0, 0],\r\n                matrix: [1, 0, 0, 1, 0, 0]\r\n            };\r\n        }\r\n    }\r\n    return this.transformData;\r\n};\r\n\r\nNodeContainer.prototype.parseTransformMatrix = function() {\r\n    if (!this.transformMatrix) {\r\n        var transform = this.prefixedCss(\"transform\");\r\n        var matrix = transform ? parseMatrix(transform.match(this.MATRIX_PROPERTY)) : null;\r\n        this.transformMatrix = matrix ? matrix : [1, 0, 0, 1, 0, 0];\r\n    }\r\n    return this.transformMatrix;\r\n};\r\n\r\nNodeContainer.prototype.parseBounds = function() {\r\n    return this.bounds || (this.bounds = this.hasTransform() ? offsetBounds(this.node) : getBounds(this.node));\r\n};\r\n\r\nNodeContainer.prototype.hasTransform = function() {\r\n    return this.parseTransformMatrix().join(\",\") !== \"1,0,0,1,0,0\" || (this.parent && this.parent.hasTransform());\r\n};\r\n\r\nNodeContainer.prototype.getValue = function() {\r\n    var value = this.node.value || \"\";\r\n    if (this.node.tagName === \"SELECT\") {\r\n        value = selectionValue(this.node);\r\n    } else if (this.node.type === \"password\") {\r\n        value = Array(value.length + 1).join('\\u2022'); // jshint ignore:line\r\n    }\r\n    return value.length === 0 ? (this.node.placeholder || \"\") : value;\r\n};\r\n\r\nNodeContainer.prototype.MATRIX_PROPERTY = /(matrix)\\((.+)\\)/;\r\nNodeContainer.prototype.TEXT_SHADOW_PROPERTY = /((rgba|rgb)\\([^\\)]+\\)(\\s-?\\d+px){0,})/g;\r\nNodeContainer.prototype.TEXT_SHADOW_VALUES = /(-?\\d+px)|(#.+)|(rgb\\(.+\\))|(rgba\\(.+\\))/g;\r\nNodeContainer.prototype.CLIP = /^rect\\((\\d+)px,? (\\d+)px,? (\\d+)px,? (\\d+)px\\)$/;\r\n\r\nfunction selectionValue(node) {\r\n    var option = node.options[node.selectedIndex || 0];\r\n    return option ? (option.text || \"\") : \"\";\r\n}\r\n\r\nfunction parseMatrix(match) {\r\n    if (match && match[1] === \"matrix\") {\r\n        return match[2].split(\",\").map(function(s) {\r\n            return parseFloat(s.trim());\r\n        });\r\n    }\r\n}\r\n\r\nfunction isPercentage(value) {\r\n    return value.toString().indexOf(\"%\") !== -1;\r\n}\r\n\r\nfunction parseBackgrounds(backgroundImage) {\r\n    var whitespace = ' \\r\\n\\t',\r\n        method, definition, prefix, prefix_i, block, results = [],\r\n        mode = 0, numParen = 0, quote, args;\r\n    var appendResult = function() {\r\n        if(method) {\r\n            if (definition.substr(0, 1) === '\"') {\r\n                definition = definition.substr(1, definition.length - 2);\r\n            }\r\n            if (definition) {\r\n                args.push(definition);\r\n            }\r\n            if (method.substr(0, 1) === '-' && (prefix_i = method.indexOf('-', 1 ) + 1) > 0) {\r\n                prefix = method.substr(0, prefix_i);\r\n                method = method.substr(prefix_i);\r\n            }\r\n            results.push({\r\n                prefix: prefix,\r\n                method: method.toLowerCase(),\r\n                value: block,\r\n                args: args,\r\n                image: null\r\n            });\r\n        }\r\n        args = [];\r\n        method = prefix = definition = block = '';\r\n    };\r\n    args = [];\r\n    method = prefix = definition = block = '';\r\n    backgroundImage.split(\"\").forEach(function(c) {\r\n        if (mode === 0 && whitespace.indexOf(c) > -1) {\r\n            return;\r\n        }\r\n        switch(c) {\r\n        case '\"':\r\n            if(!quote) {\r\n                quote = c;\r\n            } else if(quote === c) {\r\n                quote = null;\r\n            }\r\n            break;\r\n        case '(':\r\n            if(quote) {\r\n                break;\r\n            } else if(mode === 0) {\r\n                mode = 1;\r\n                block += c;\r\n                return;\r\n            } else {\r\n                numParen++;\r\n            }\r\n            break;\r\n        case ')':\r\n            if (quote) {\r\n                break;\r\n            } else if(mode === 1) {\r\n                if(numParen === 0) {\r\n                    mode = 0;\r\n                    block += c;\r\n                    appendResult();\r\n                    return;\r\n                } else {\r\n                    numParen--;\r\n                }\r\n            }\r\n            break;\r\n\r\n        case ',':\r\n            if (quote) {\r\n                break;\r\n            } else if(mode === 0) {\r\n                appendResult();\r\n                return;\r\n            } else if (mode === 1) {\r\n                if (numParen === 0 && !method.match(/^url$/i)) {\r\n                    args.push(definition);\r\n                    definition = '';\r\n                    block += c;\r\n                    return;\r\n                }\r\n            }\r\n            break;\r\n        }\r\n\r\n        block += c;\r\n        if (mode === 0) {\r\n            method += c;\r\n        } else {\r\n            definition += c;\r\n        }\r\n    });\r\n\r\n    appendResult();\r\n    return results;\r\n}\r\n\r\nfunction removePx(str) {\r\n    return str.replace(\"px\", \"\");\r\n}\r\n\r\nfunction asFloat(str) {\r\n    return parseFloat(str);\r\n}\r\n\r\nfunction getBounds(node) {\r\n    if (node.getBoundingClientRect) {\r\n        var clientRect = node.getBoundingClientRect();\r\n        var width = node.offsetWidth == null ? clientRect.width : node.offsetWidth;\r\n        return {\r\n            top: clientRect.top,\r\n            bottom: clientRect.bottom || (clientRect.top + clientRect.height),\r\n            right: clientRect.left + width,\r\n            left: clientRect.left,\r\n            width:  width,\r\n            height: node.offsetHeight == null ? clientRect.height : node.offsetHeight\r\n        };\r\n    }\r\n    return {};\r\n}\r\n\r\nfunction offsetBounds(node) {\r\n    var parent = node.offsetParent ? offsetBounds(node.offsetParent) : {top: 0, left: 0};\r\n\r\n    return {\r\n        top: node.offsetTop + parent.top,\r\n        bottom: node.offsetTop + node.offsetHeight + parent.top,\r\n        right: node.offsetLeft + parent.left + node.offsetWidth,\r\n        left: node.offsetLeft + parent.left,\r\n        width: node.offsetWidth,\r\n        height: node.offsetHeight\r\n    };\r\n}\r\n\r\nfunction NodeParser(element, renderer, support, imageLoader, options) {\r\n    log(\"Starting NodeParser\");\r\n    this.renderer = renderer;\r\n    this.options = options;\r\n    this.range = null;\r\n    this.support = support;\r\n    this.renderQueue = [];\r\n    this.stack = new StackingContext(true, 1, element.ownerDocument, null);\r\n    var parent = new NodeContainer(element, null);\r\n    if (options.background) {\r\n        renderer.rectangle(0, 0, renderer.width, renderer.height, new Color(options.background));\r\n    }\r\n    if (element === element.ownerDocument.documentElement) {\r\n        // http://www.w3.org/TR/css3-background/#special-backgrounds\r\n        var canvasBackground = new NodeContainer(parent.color('backgroundColor').isTransparent() ? element.ownerDocument.body : element.ownerDocument.documentElement, null);\r\n        renderer.rectangle(0, 0, renderer.width, renderer.height, canvasBackground.color('backgroundColor'));\r\n    }\r\n    parent.visibile = parent.isElementVisible();\r\n    this.createPseudoHideStyles(element.ownerDocument);\r\n    this.disableAnimations(element.ownerDocument);\r\n    this.nodes = flatten([parent].concat(this.getChildren(parent)).filter(function(container) {\r\n        return container.visible = container.isElementVisible();\r\n    }).map(this.getPseudoElements, this));\r\n    this.fontMetrics = new FontMetrics();\r\n    log(\"Fetched nodes, total:\", this.nodes.length);\r\n    log(\"Calculate overflow clips\");\r\n    this.calculateOverflowClips();\r\n    log(\"Start fetching images\");\r\n    this.images = imageLoader.fetch(this.nodes.filter(isElement));\r\n    this.ready = this.images.ready.then(bind(function() {\r\n        log(\"Images loaded, starting parsing\");\r\n        log(\"Creating stacking contexts\");\r\n        this.createStackingContexts();\r\n        log(\"Sorting stacking contexts\");\r\n        this.sortStackingContexts(this.stack);\r\n        this.parse(this.stack);\r\n        log(\"Render queue created with \" + this.renderQueue.length + \" items\");\r\n        return new Promise(bind(function(resolve) {\r\n            if (!options.async) {\r\n                this.renderQueue.forEach(this.paint, this);\r\n                resolve();\r\n            } else if (typeof(options.async) === \"function\") {\r\n                options.async.call(this, this.renderQueue, resolve);\r\n            } else if (this.renderQueue.length > 0){\r\n                this.renderIndex = 0;\r\n                this.asyncRenderer(this.renderQueue, resolve);\r\n            } else {\r\n                resolve();\r\n            }\r\n        }, this));\r\n    }, this));\r\n}\r\n\r\nNodeParser.prototype.calculateOverflowClips = function() {\r\n    this.nodes.forEach(function(container) {\r\n        if (isElement(container)) {\r\n            if (isPseudoElement(container)) {\r\n                container.appendToDOM();\r\n            }\r\n            container.borders = this.parseBorders(container);\r\n            var clip = (container.css('overflow') === \"hidden\") ? [container.borders.clip] : [];\r\n            var cssClip = container.parseClip();\r\n            if (cssClip && [\"absolute\", \"fixed\"].indexOf(container.css('position')) !== -1) {\r\n                clip.push([[\"rect\",\r\n                        container.bounds.left + cssClip.left,\r\n                        container.bounds.top + cssClip.top,\r\n                        cssClip.right - cssClip.left,\r\n                        cssClip.bottom - cssClip.top\r\n                ]]);\r\n            }\r\n            container.clip = hasParentClip(container) ? container.parent.clip.concat(clip) : clip;\r\n            container.backgroundClip = (container.css('overflow') !== \"hidden\") ? container.clip.concat([container.borders.clip]) : container.clip;\r\n            if (isPseudoElement(container)) {\r\n                container.cleanDOM();\r\n            }\r\n        } else if (isTextNode(container)) {\r\n            container.clip = hasParentClip(container) ? container.parent.clip : [];\r\n        }\r\n        if (!isPseudoElement(container)) {\r\n            container.bounds = null;\r\n        }\r\n    }, this);\r\n};\r\n\r\nfunction hasParentClip(container) {\r\n    return container.parent && container.parent.clip.length;\r\n}\r\n\r\nNodeParser.prototype.asyncRenderer = function(queue, resolve, asyncTimer) {\r\n    asyncTimer = asyncTimer || Date.now();\r\n    this.paint(queue[this.renderIndex++]);\r\n    if (queue.length === this.renderIndex) {\r\n        resolve();\r\n    } else if (asyncTimer + 20 > Date.now()) {\r\n        this.asyncRenderer(queue, resolve, asyncTimer);\r\n    } else {\r\n        setTimeout(bind(function() {\r\n            this.asyncRenderer(queue, resolve);\r\n        }, this), 0);\r\n    }\r\n};\r\n\r\nNodeParser.prototype.createPseudoHideStyles = function(document) {\r\n    this.createStyles(document, '.' + PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE + ':before { content: \"\" !important; display: none !important; }' +\r\n        '.' + PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER + ':after { content: \"\" !important; display: none !important; }');\r\n};\r\n\r\nNodeParser.prototype.disableAnimations = function(document) {\r\n    this.createStyles(document, '* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; ' +\r\n        '-webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}');\r\n};\r\n\r\nNodeParser.prototype.createStyles = function(document, styles) {\r\n    var hidePseudoElements = document.createElement('style');\r\n    hidePseudoElements.innerHTML = styles;\r\n    document.body.appendChild(hidePseudoElements);\r\n};\r\n\r\nNodeParser.prototype.getPseudoElements = function(container) {\r\n    var nodes = [[container]];\r\n    if (container.node.nodeType === Node.ELEMENT_NODE) {\r\n        var before = this.getPseudoElement(container, \":before\");\r\n        var after = this.getPseudoElement(container, \":after\");\r\n\r\n        if (before) {\r\n            nodes.push(before);\r\n        }\r\n\r\n        if (after) {\r\n            nodes.push(after);\r\n        }\r\n    }\r\n    return flatten(nodes);\r\n};\r\n\r\nfunction toCamelCase(str) {\r\n    return str.replace(/(\\-[a-z])/g, function(match){\r\n        return match.toUpperCase().replace('-','');\r\n    });\r\n}\r\n\r\nNodeParser.prototype.getPseudoElement = function(container, type) {\r\n    var style = container.computedStyle(type);\r\n    if(!style || !style.content || style.content === \"none\" || style.content === \"-moz-alt-content\" || style.display === \"none\") {\r\n        return null;\r\n    }\r\n\r\n    var content = stripQuotes(style.content);\r\n    var isImage = content.substr(0, 3) === 'url';\r\n    var pseudoNode = document.createElement(isImage ? 'img' : 'html2canvaspseudoelement');\r\n    var pseudoContainer = new PseudoElementContainer(pseudoNode, container, type);\r\n\r\n    for (var i = style.length-1; i >= 0; i--) {\r\n        var property = toCamelCase(style.item(i));\r\n        pseudoNode.style[property] = style[property];\r\n    }\r\n\r\n    pseudoNode.className = PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE + \" \" + PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER;\r\n\r\n    if (isImage) {\r\n        pseudoNode.src = parseBackgrounds(content)[0].args[0];\r\n        return [pseudoContainer];\r\n    } else {\r\n        var text = document.createTextNode(content);\r\n        pseudoNode.appendChild(text);\r\n        return [pseudoContainer, new TextContainer(text, pseudoContainer)];\r\n    }\r\n};\r\n\r\n\r\nNodeParser.prototype.getChildren = function(parentContainer) {\r\n    return flatten([].filter.call(parentContainer.node.childNodes, renderableNode).map(function(node) {\r\n        var container = [node.nodeType === Node.TEXT_NODE ? new TextContainer(node, parentContainer) : new NodeContainer(node, parentContainer)].filter(nonIgnoredElement);\r\n        return node.nodeType === Node.ELEMENT_NODE && container.length && node.tagName !== \"TEXTAREA\" ? (container[0].isElementVisible() ? container.concat(this.getChildren(container[0])) : []) : container;\r\n    }, this));\r\n};\r\n\r\nNodeParser.prototype.newStackingContext = function(container, hasOwnStacking) {\r\n    var stack = new StackingContext(hasOwnStacking, container.getOpacity(), container.node, container.parent);\r\n    container.cloneTo(stack);\r\n    var parentStack = hasOwnStacking ? stack.getParentStack(this) : stack.parent.stack;\r\n    parentStack.contexts.push(stack);\r\n    container.stack = stack;\r\n};\r\n\r\nNodeParser.prototype.createStackingContexts = function() {\r\n    this.nodes.forEach(function(container) {\r\n        if (isElement(container) && (this.isRootElement(container) || hasOpacity(container) || isPositionedForStacking(container) || this.isBodyWithTransparentRoot(container) || container.hasTransform())) {\r\n            this.newStackingContext(container, true);\r\n        } else if (isElement(container) && ((isPositioned(container) && zIndex0(container)) || isInlineBlock(container) || isFloating(container))) {\r\n            this.newStackingContext(container, false);\r\n        } else {\r\n            container.assignStack(container.parent.stack);\r\n        }\r\n    }, this);\r\n};\r\n\r\nNodeParser.prototype.isBodyWithTransparentRoot = function(container) {\r\n    return container.node.nodeName === \"BODY\" && container.parent.color('backgroundColor').isTransparent();\r\n};\r\n\r\nNodeParser.prototype.isRootElement = function(container) {\r\n    return container.parent === null;\r\n};\r\n\r\nNodeParser.prototype.sortStackingContexts = function(stack) {\r\n    stack.contexts.sort(zIndexSort(stack.contexts.slice(0)));\r\n    stack.contexts.forEach(this.sortStackingContexts, this);\r\n};\r\n\r\nNodeParser.prototype.parseTextBounds = function(container) {\r\n    return function(text, index, textList) {\r\n        if (container.parent.css(\"textDecoration\").substr(0, 4) !== \"none\" || text.trim().length !== 0) {\r\n            if (this.support.rangeBounds && !container.parent.hasTransform()) {\r\n                var offset = textList.slice(0, index).join(\"\").length;\r\n                return this.getRangeBounds(container.node, offset, text.length);\r\n            } else if (container.node && typeof(container.node.data) === \"string\") {\r\n                var replacementNode = container.node.splitText(text.length);\r\n                var bounds = this.getWrapperBounds(container.node, container.parent.hasTransform());\r\n                container.node = replacementNode;\r\n                return bounds;\r\n            }\r\n        } else if(!this.support.rangeBounds || container.parent.hasTransform()){\r\n            container.node = container.node.splitText(text.length);\r\n        }\r\n        return {};\r\n    };\r\n};\r\n\r\nNodeParser.prototype.getWrapperBounds = function(node, transform) {\r\n    var wrapper = node.ownerDocument.createElement('html2canvaswrapper');\r\n    var parent = node.parentNode,\r\n        backupText = node.cloneNode(true);\r\n\r\n    wrapper.appendChild(node.cloneNode(true));\r\n    parent.replaceChild(wrapper, node);\r\n    var bounds = transform ? offsetBounds(wrapper) : getBounds(wrapper);\r\n    parent.replaceChild(backupText, wrapper);\r\n    return bounds;\r\n};\r\n\r\nNodeParser.prototype.getRangeBounds = function(node, offset, length) {\r\n    var range = this.range || (this.range = node.ownerDocument.createRange());\r\n    range.setStart(node, offset);\r\n    range.setEnd(node, offset + length);\r\n    return range.getBoundingClientRect();\r\n};\r\n\r\nfunction ClearTransform() {}\r\n\r\nNodeParser.prototype.parse = function(stack) {\r\n    // http://www.w3.org/TR/CSS21/visuren.html#z-index\r\n    var negativeZindex = stack.contexts.filter(negativeZIndex); // 2. the child stacking contexts with negative stack levels (most negative first).\r\n    var descendantElements = stack.children.filter(isElement);\r\n    var descendantNonFloats = descendantElements.filter(not(isFloating));\r\n    var nonInlineNonPositionedDescendants = descendantNonFloats.filter(not(isPositioned)).filter(not(inlineLevel)); // 3 the in-flow, non-inline-level, non-positioned descendants.\r\n    var nonPositionedFloats = descendantElements.filter(not(isPositioned)).filter(isFloating); // 4. the non-positioned floats.\r\n    var inFlow = descendantNonFloats.filter(not(isPositioned)).filter(inlineLevel); // 5. the in-flow, inline-level, non-positioned descendants, including inline tables and inline blocks.\r\n    var stackLevel0 = stack.contexts.concat(descendantNonFloats.filter(isPositioned)).filter(zIndex0); // 6. the child stacking contexts with stack level 0 and the positioned descendants with stack level 0.\r\n    var text = stack.children.filter(isTextNode).filter(hasText);\r\n    var positiveZindex = stack.contexts.filter(positiveZIndex); // 7. the child stacking contexts with positive stack levels (least positive first).\r\n    negativeZindex.concat(nonInlineNonPositionedDescendants).concat(nonPositionedFloats)\r\n        .concat(inFlow).concat(stackLevel0).concat(text).concat(positiveZindex).forEach(function(container) {\r\n            this.renderQueue.push(container);\r\n            if (isStackingContext(container)) {\r\n                this.parse(container);\r\n                this.renderQueue.push(new ClearTransform());\r\n            }\r\n        }, this);\r\n};\r\n\r\nNodeParser.prototype.paint = function(container) {\r\n    try {\r\n        if (container instanceof ClearTransform) {\r\n            this.renderer.ctx.restore();\r\n        } else if (isTextNode(container)) {\r\n            if (isPseudoElement(container.parent)) {\r\n                container.parent.appendToDOM();\r\n            }\r\n            this.paintText(container);\r\n            if (isPseudoElement(container.parent)) {\r\n                container.parent.cleanDOM();\r\n            }\r\n        } else {\r\n            this.paintNode(container);\r\n        }\r\n    } catch(e) {\r\n        log(e);\r\n        if (this.options.strict) {\r\n            throw e;\r\n        }\r\n    }\r\n};\r\n\r\nNodeParser.prototype.paintNode = function(container) {\r\n    if (isStackingContext(container)) {\r\n        this.renderer.setOpacity(container.opacity);\r\n        this.renderer.ctx.save();\r\n        if (container.hasTransform()) {\r\n            this.renderer.setTransform(container.parseTransform());\r\n        }\r\n    }\r\n\r\n    if (container.node.nodeName === \"INPUT\" && container.node.type === \"checkbox\") {\r\n        this.paintCheckbox(container);\r\n    } else if (container.node.nodeName === \"INPUT\" && container.node.type === \"radio\") {\r\n        this.paintRadio(container);\r\n    } else {\r\n        this.paintElement(container);\r\n    }\r\n};\r\n\r\nNodeParser.prototype.paintElement = function(container) {\r\n    var bounds = container.parseBounds();\r\n    this.renderer.clip(container.backgroundClip, function() {\r\n        this.renderer.renderBackground(container, bounds, container.borders.borders.map(getWidth));\r\n    }, this);\r\n\r\n    this.renderer.clip(container.clip, function() {\r\n        this.renderer.renderBorders(container.borders.borders);\r\n    }, this);\r\n\r\n    this.renderer.clip(container.backgroundClip, function() {\r\n        switch (container.node.nodeName) {\r\n        case \"svg\":\r\n        case \"IFRAME\":\r\n            var imgContainer = this.images.get(container.node);\r\n            if (imgContainer) {\r\n                this.renderer.renderImage(container, bounds, container.borders, imgContainer);\r\n            } else {\r\n                log(\"Error loading <\" + container.node.nodeName + \">\", container.node);\r\n            }\r\n            break;\r\n        case \"IMG\":\r\n            var imageContainer = this.images.get(container.node.src);\r\n            if (imageContainer) {\r\n                this.renderer.renderImage(container, bounds, container.borders, imageContainer);\r\n            } else {\r\n                log(\"Error loading <img>\", container.node.src);\r\n            }\r\n            break;\r\n        case \"CANVAS\":\r\n            this.renderer.renderImage(container, bounds, container.borders, {image: container.node});\r\n            break;\r\n        case \"SELECT\":\r\n        case \"INPUT\":\r\n        case \"TEXTAREA\":\r\n            this.paintFormValue(container);\r\n            break;\r\n        }\r\n    }, this);\r\n};\r\n\r\nNodeParser.prototype.paintCheckbox = function(container) {\r\n    var b = container.parseBounds();\r\n\r\n    var size = Math.min(b.width, b.height);\r\n    var bounds = {width: size - 1, height: size - 1, top: b.top, left: b.left};\r\n    var r = [3, 3];\r\n    var radius = [r, r, r, r];\r\n    var borders = [1,1,1,1].map(function(w) {\r\n        return {color: new Color('#A5A5A5'), width: w};\r\n    });\r\n\r\n    var borderPoints = calculateCurvePoints(bounds, radius, borders);\r\n\r\n    this.renderer.clip(container.backgroundClip, function() {\r\n        this.renderer.rectangle(bounds.left + 1, bounds.top + 1, bounds.width - 2, bounds.height - 2, new Color(\"#DEDEDE\"));\r\n        this.renderer.renderBorders(calculateBorders(borders, bounds, borderPoints, radius));\r\n        if (container.node.checked) {\r\n            this.renderer.font(new Color('#424242'), 'normal', 'normal', 'bold', (size - 3) + \"px\", 'arial');\r\n            this.renderer.text(\"\\u2714\", bounds.left + size / 6, bounds.top + size - 1);\r\n        }\r\n    }, this);\r\n};\r\n\r\nNodeParser.prototype.paintRadio = function(container) {\r\n    var bounds = container.parseBounds();\r\n\r\n    var size = Math.min(bounds.width, bounds.height) - 2;\r\n\r\n    this.renderer.clip(container.backgroundClip, function() {\r\n        this.renderer.circleStroke(bounds.left + 1, bounds.top + 1, size, new Color('#DEDEDE'), 1, new Color('#A5A5A5'));\r\n        if (container.node.checked) {\r\n            this.renderer.circle(Math.ceil(bounds.left + size / 4) + 1, Math.ceil(bounds.top + size / 4) + 1, Math.floor(size / 2), new Color('#424242'));\r\n        }\r\n    }, this);\r\n};\r\n\r\nNodeParser.prototype.paintFormValue = function(container) {\r\n    var value = container.getValue();\r\n    if (value.length > 0) {\r\n        var document = container.node.ownerDocument;\r\n        var wrapper = document.createElement('html2canvaswrapper');\r\n        var properties = ['lineHeight', 'textAlign', 'fontFamily', 'fontWeight', 'fontSize', 'color',\r\n            'paddingLeft', 'paddingTop', 'paddingRight', 'paddingBottom',\r\n            'width', 'height', 'borderLeftStyle', 'borderTopStyle', 'borderLeftWidth', 'borderTopWidth',\r\n            'boxSizing', 'whiteSpace', 'wordWrap'];\r\n\r\n        properties.forEach(function(property) {\r\n            try {\r\n                wrapper.style[property] = container.css(property);\r\n            } catch(e) {\r\n                // Older IE has issues with \"border\"\r\n                log(\"html2canvas: Parse: Exception caught in renderFormValue: \" + e.message);\r\n            }\r\n        });\r\n        var bounds = container.parseBounds();\r\n        wrapper.style.position = \"fixed\";\r\n        wrapper.style.left = bounds.left + \"px\";\r\n        wrapper.style.top = bounds.top + \"px\";\r\n        wrapper.textContent = value;\r\n        document.body.appendChild(wrapper);\r\n        this.paintText(new TextContainer(wrapper.firstChild, container));\r\n        document.body.removeChild(wrapper);\r\n    }\r\n};\r\n\r\nNodeParser.prototype.paintText = function(container) {\r\n    container.applyTextTransform();\r\n    var characters = window.html2canvas.punycode.ucs2.decode(container.node.data);\r\n    var textList = (!this.options.letterRendering || noLetterSpacing(container)) && !hasUnicode(container.node.data) ? getWords(characters) : characters.map(function(character) {\r\n        return window.html2canvas.punycode.ucs2.encode([character]);\r\n    });\r\n\r\n    var weight = container.parent.fontWeight();\r\n    var size = container.parent.css('fontSize');\r\n    var family = container.parent.css('fontFamily');\r\n    var shadows = container.parent.parseTextShadows();\r\n\r\n    this.renderer.font(container.parent.color('color'), container.parent.css('fontStyle'), container.parent.css('fontVariant'), weight, size, family);\r\n    this.renderer.setOpacity(container.parent.opacity);\r\n    if (shadows.length) {\r\n        // TODO: support multiple text shadows\r\n        this.renderer.fontShadow(shadows[0].color, shadows[0].offsetX, shadows[0].offsetY, shadows[0].blur);\r\n    } else {\r\n        this.renderer.clearShadow();\r\n    }\r\n\r\n    this.renderer.clip(container.parent.clip, function() {\r\n        textList.map(this.parseTextBounds(container), this).forEach(function(bounds, index) {\r\n            if (bounds) {\r\n                this.renderer.text(textList[index], bounds.left, bounds.bottom);\r\n                this.renderTextDecoration(container.parent, bounds, this.fontMetrics.getMetrics(family, size));\r\n            }\r\n        }, this);\r\n    }, this);\r\n};\r\n\r\nNodeParser.prototype.renderTextDecoration = function(container, bounds, metrics) {\r\n    switch(container.css(\"textDecoration\").split(\" \")[0]) {\r\n    case \"underline\":\r\n        // Draws a line at the baseline of the font\r\n        // TODO As some browsers display the line as more than 1px if the font-size is big, need to take that into account both in position and size\r\n        this.renderer.rectangle(bounds.left, Math.round(bounds.top + metrics.baseline + metrics.lineWidth), bounds.width, 1, container.color(\"color\"));\r\n        break;\r\n    case \"overline\":\r\n        this.renderer.rectangle(bounds.left, Math.round(bounds.top), bounds.width, 1, container.color(\"color\"));\r\n        break;\r\n    case \"line-through\":\r\n        // TODO try and find exact position for line-through\r\n        this.renderer.rectangle(bounds.left, Math.ceil(bounds.top + metrics.middle + metrics.lineWidth), bounds.width, 1, container.color(\"color\"));\r\n        break;\r\n    }\r\n};\r\n\r\nvar borderColorTransforms = {\r\n    inset: [\r\n        [\"darken\", 0.60],\r\n        [\"darken\", 0.10],\r\n        [\"darken\", 0.10],\r\n        [\"darken\", 0.60]\r\n    ]\r\n};\r\n\r\nNodeParser.prototype.parseBorders = function(container) {\r\n    var nodeBounds = container.parseBounds();\r\n    var radius = getBorderRadiusData(container);\r\n    var borders = [\"Top\", \"Right\", \"Bottom\", \"Left\"].map(function(side, index) {\r\n        var style = container.css('border' + side + 'Style');\r\n        var color = container.color('border' + side + 'Color');\r\n        if (style === \"inset\" && color.isBlack()) {\r\n            color = new Color([255, 255, 255, color.a]); // this is wrong, but\r\n        }\r\n        var colorTransform = borderColorTransforms[style] ? borderColorTransforms[style][index] : null;\r\n        return {\r\n            width: container.cssInt('border' + side + 'Width'),\r\n            color: colorTransform ? color[colorTransform[0]](colorTransform[1]) : color,\r\n            args: null\r\n        };\r\n    });\r\n    var borderPoints = calculateCurvePoints(nodeBounds, radius, borders);\r\n\r\n    return {\r\n        clip: this.parseBackgroundClip(container, borderPoints, borders, radius, nodeBounds),\r\n        borders: calculateBorders(borders, nodeBounds, borderPoints, radius)\r\n    };\r\n};\r\n\r\nfunction calculateBorders(borders, nodeBounds, borderPoints, radius) {\r\n    return borders.map(function(border, borderSide) {\r\n        if (border.width > 0) {\r\n            var bx = nodeBounds.left;\r\n            var by = nodeBounds.top;\r\n            var bw = nodeBounds.width;\r\n            var bh = nodeBounds.height - (borders[2].width);\r\n\r\n            switch(borderSide) {\r\n            case 0:\r\n                // top border\r\n                bh = borders[0].width;\r\n                border.args = drawSide({\r\n                        c1: [bx, by],\r\n                        c2: [bx + bw, by],\r\n                        c3: [bx + bw - borders[1].width, by + bh],\r\n                        c4: [bx + borders[3].width, by + bh]\r\n                    }, radius[0], radius[1],\r\n                    borderPoints.topLeftOuter, borderPoints.topLeftInner, borderPoints.topRightOuter, borderPoints.topRightInner);\r\n                break;\r\n            case 1:\r\n                // right border\r\n                bx = nodeBounds.left + nodeBounds.width - (borders[1].width);\r\n                bw = borders[1].width;\r\n\r\n                border.args = drawSide({\r\n                        c1: [bx + bw, by],\r\n                        c2: [bx + bw, by + bh + borders[2].width],\r\n                        c3: [bx, by + bh],\r\n                        c4: [bx, by + borders[0].width]\r\n                    }, radius[1], radius[2],\r\n                    borderPoints.topRightOuter, borderPoints.topRightInner, borderPoints.bottomRightOuter, borderPoints.bottomRightInner);\r\n                break;\r\n            case 2:\r\n                // bottom border\r\n                by = (by + nodeBounds.height) - (borders[2].width);\r\n                bh = borders[2].width;\r\n                border.args = drawSide({\r\n                        c1: [bx + bw, by + bh],\r\n                        c2: [bx, by + bh],\r\n                        c3: [bx + borders[3].width, by],\r\n                        c4: [bx + bw - borders[3].width, by]\r\n                    }, radius[2], radius[3],\r\n                    borderPoints.bottomRightOuter, borderPoints.bottomRightInner, borderPoints.bottomLeftOuter, borderPoints.bottomLeftInner);\r\n                break;\r\n            case 3:\r\n                // left border\r\n                bw = borders[3].width;\r\n                border.args = drawSide({\r\n                        c1: [bx, by + bh + borders[2].width],\r\n                        c2: [bx, by],\r\n                        c3: [bx + bw, by + borders[0].width],\r\n                        c4: [bx + bw, by + bh]\r\n                    }, radius[3], radius[0],\r\n                    borderPoints.bottomLeftOuter, borderPoints.bottomLeftInner, borderPoints.topLeftOuter, borderPoints.topLeftInner);\r\n                break;\r\n            }\r\n        }\r\n        return border;\r\n    });\r\n}\r\n\r\nNodeParser.prototype.parseBackgroundClip = function(container, borderPoints, borders, radius, bounds) {\r\n    var backgroundClip = container.css('backgroundClip'),\r\n        borderArgs = [];\r\n\r\n    switch(backgroundClip) {\r\n    case \"content-box\":\r\n    case \"padding-box\":\r\n        parseCorner(borderArgs, radius[0], radius[1], borderPoints.topLeftInner, borderPoints.topRightInner, bounds.left + borders[3].width, bounds.top + borders[0].width);\r\n        parseCorner(borderArgs, radius[1], radius[2], borderPoints.topRightInner, borderPoints.bottomRightInner, bounds.left + bounds.width - borders[1].width, bounds.top + borders[0].width);\r\n        parseCorner(borderArgs, radius[2], radius[3], borderPoints.bottomRightInner, borderPoints.bottomLeftInner, bounds.left + bounds.width - borders[1].width, bounds.top + bounds.height - borders[2].width);\r\n        parseCorner(borderArgs, radius[3], radius[0], borderPoints.bottomLeftInner, borderPoints.topLeftInner, bounds.left + borders[3].width, bounds.top + bounds.height - borders[2].width);\r\n        break;\r\n\r\n    default:\r\n        parseCorner(borderArgs, radius[0], radius[1], borderPoints.topLeftOuter, borderPoints.topRightOuter, bounds.left, bounds.top);\r\n        parseCorner(borderArgs, radius[1], radius[2], borderPoints.topRightOuter, borderPoints.bottomRightOuter, bounds.left + bounds.width, bounds.top);\r\n        parseCorner(borderArgs, radius[2], radius[3], borderPoints.bottomRightOuter, borderPoints.bottomLeftOuter, bounds.left + bounds.width, bounds.top + bounds.height);\r\n        parseCorner(borderArgs, radius[3], radius[0], borderPoints.bottomLeftOuter, borderPoints.topLeftOuter, bounds.left, bounds.top + bounds.height);\r\n        break;\r\n    }\r\n\r\n    return borderArgs;\r\n};\r\n\r\nfunction getCurvePoints(x, y, r1, r2) {\r\n    var kappa = 4 * ((Math.sqrt(2) - 1) / 3);\r\n    var ox = (r1) * kappa, // control point offset horizontal\r\n        oy = (r2) * kappa, // control point offset vertical\r\n        xm = x + r1, // x-middle\r\n        ym = y + r2; // y-middle\r\n    return {\r\n        topLeft: bezierCurve({x: x, y: ym}, {x: x, y: ym - oy}, {x: xm - ox, y: y}, {x: xm, y: y}),\r\n        topRight: bezierCurve({x: x, y: y}, {x: x + ox,y: y}, {x: xm, y: ym - oy}, {x: xm, y: ym}),\r\n        bottomRight: bezierCurve({x: xm, y: y}, {x: xm, y: y + oy}, {x: x + ox, y: ym}, {x: x, y: ym}),\r\n        bottomLeft: bezierCurve({x: xm, y: ym}, {x: xm - ox, y: ym}, {x: x, y: y + oy}, {x: x, y:y})\r\n    };\r\n}\r\n\r\nfunction calculateCurvePoints(bounds, borderRadius, borders) {\r\n    var x = bounds.left,\r\n        y = bounds.top,\r\n        width = bounds.width,\r\n        height = bounds.height,\r\n\r\n        tlh = borderRadius[0][0],\r\n        tlv = borderRadius[0][1],\r\n        trh = borderRadius[1][0],\r\n        trv = borderRadius[1][1],\r\n        brh = borderRadius[2][0],\r\n        brv = borderRadius[2][1],\r\n        blh = borderRadius[3][0],\r\n        blv = borderRadius[3][1];\r\n\r\n    var topWidth = width - trh,\r\n        rightHeight = height - brv,\r\n        bottomWidth = width - brh,\r\n        leftHeight = height - blv;\r\n\r\n    return {\r\n        topLeftOuter: getCurvePoints(x, y, tlh, tlv).topLeft.subdivide(0.5),\r\n        topLeftInner: getCurvePoints(x + borders[3].width, y + borders[0].width, Math.max(0, tlh - borders[3].width), Math.max(0, tlv - borders[0].width)).topLeft.subdivide(0.5),\r\n        topRightOuter: getCurvePoints(x + topWidth, y, trh, trv).topRight.subdivide(0.5),\r\n        topRightInner: getCurvePoints(x + Math.min(topWidth, width + borders[3].width), y + borders[0].width, (topWidth > width + borders[3].width) ? 0 :trh - borders[3].width, trv - borders[0].width).topRight.subdivide(0.5),\r\n        bottomRightOuter: getCurvePoints(x + bottomWidth, y + rightHeight, brh, brv).bottomRight.subdivide(0.5),\r\n        bottomRightInner: getCurvePoints(x + Math.min(bottomWidth, width - borders[3].width), y + Math.min(rightHeight, height + borders[0].width), Math.max(0, brh - borders[1].width),  brv - borders[2].width).bottomRight.subdivide(0.5),\r\n        bottomLeftOuter: getCurvePoints(x, y + leftHeight, blh, blv).bottomLeft.subdivide(0.5),\r\n        bottomLeftInner: getCurvePoints(x + borders[3].width, y + leftHeight, Math.max(0, blh - borders[3].width), blv - borders[2].width).bottomLeft.subdivide(0.5)\r\n    };\r\n}\r\n\r\nfunction bezierCurve(start, startControl, endControl, end) {\r\n    var lerp = function (a, b, t) {\r\n        return {\r\n            x: a.x + (b.x - a.x) * t,\r\n            y: a.y + (b.y - a.y) * t\r\n        };\r\n    };\r\n\r\n    return {\r\n        start: start,\r\n        startControl: startControl,\r\n        endControl: endControl,\r\n        end: end,\r\n        subdivide: function(t) {\r\n            var ab = lerp(start, startControl, t),\r\n                bc = lerp(startControl, endControl, t),\r\n                cd = lerp(endControl, end, t),\r\n                abbc = lerp(ab, bc, t),\r\n                bccd = lerp(bc, cd, t),\r\n                dest = lerp(abbc, bccd, t);\r\n            return [bezierCurve(start, ab, abbc, dest), bezierCurve(dest, bccd, cd, end)];\r\n        },\r\n        curveTo: function(borderArgs) {\r\n            borderArgs.push([\"bezierCurve\", startControl.x, startControl.y, endControl.x, endControl.y, end.x, end.y]);\r\n        },\r\n        curveToReversed: function(borderArgs) {\r\n            borderArgs.push([\"bezierCurve\", endControl.x, endControl.y, startControl.x, startControl.y, start.x, start.y]);\r\n        }\r\n    };\r\n}\r\n\r\nfunction drawSide(borderData, radius1, radius2, outer1, inner1, outer2, inner2) {\r\n    var borderArgs = [];\r\n\r\n    if (radius1[0] > 0 || radius1[1] > 0) {\r\n        borderArgs.push([\"line\", outer1[1].start.x, outer1[1].start.y]);\r\n        outer1[1].curveTo(borderArgs);\r\n    } else {\r\n        borderArgs.push([ \"line\", borderData.c1[0], borderData.c1[1]]);\r\n    }\r\n\r\n    if (radius2[0] > 0 || radius2[1] > 0) {\r\n        borderArgs.push([\"line\", outer2[0].start.x, outer2[0].start.y]);\r\n        outer2[0].curveTo(borderArgs);\r\n        borderArgs.push([\"line\", inner2[0].end.x, inner2[0].end.y]);\r\n        inner2[0].curveToReversed(borderArgs);\r\n    } else {\r\n        borderArgs.push([\"line\", borderData.c2[0], borderData.c2[1]]);\r\n        borderArgs.push([\"line\", borderData.c3[0], borderData.c3[1]]);\r\n    }\r\n\r\n    if (radius1[0] > 0 || radius1[1] > 0) {\r\n        borderArgs.push([\"line\", inner1[1].end.x, inner1[1].end.y]);\r\n        inner1[1].curveToReversed(borderArgs);\r\n    } else {\r\n        borderArgs.push([\"line\", borderData.c4[0], borderData.c4[1]]);\r\n    }\r\n\r\n    return borderArgs;\r\n}\r\n\r\nfunction parseCorner(borderArgs, radius1, radius2, corner1, corner2, x, y) {\r\n    if (radius1[0] > 0 || radius1[1] > 0) {\r\n        borderArgs.push([\"line\", corner1[0].start.x, corner1[0].start.y]);\r\n        corner1[0].curveTo(borderArgs);\r\n        corner1[1].curveTo(borderArgs);\r\n    } else {\r\n        borderArgs.push([\"line\", x, y]);\r\n    }\r\n\r\n    if (radius2[0] > 0 || radius2[1] > 0) {\r\n        borderArgs.push([\"line\", corner2[0].start.x, corner2[0].start.y]);\r\n    }\r\n}\r\n\r\nfunction negativeZIndex(container) {\r\n    return container.cssInt(\"zIndex\") < 0;\r\n}\r\n\r\nfunction positiveZIndex(container) {\r\n    return container.cssInt(\"zIndex\") > 0;\r\n}\r\n\r\nfunction zIndex0(container) {\r\n    return container.cssInt(\"zIndex\") === 0;\r\n}\r\n\r\nfunction inlineLevel(container) {\r\n    return [\"inline\", \"inline-block\", \"inline-table\"].indexOf(container.css(\"display\")) !== -1;\r\n}\r\n\r\nfunction isStackingContext(container) {\r\n    return (container instanceof StackingContext);\r\n}\r\n\r\nfunction hasText(container) {\r\n    return container.node.data.trim().length > 0;\r\n}\r\n\r\nfunction noLetterSpacing(container) {\r\n    return (/^(normal|none|0px)$/.test(container.parent.css(\"letterSpacing\")));\r\n}\r\n\r\nfunction getBorderRadiusData(container) {\r\n  return [\"TopLeft\", \"TopRight\", \"BottomRight\", \"BottomLeft\"].map(function(side) {\r\n      var value = container.css('border' + side + 'Radius');\r\n\r\n      var arr = value.split(\" \");\r\n      if (arr.length <= 1) {\r\n          arr[1] = arr[0];\r\n      }\r\n      //check for percentage radius and get relative values\r\n      if(value.indexOf('%')>=0)\r\n      {\r\n           var currentVal = parseInt(arr[0]);\r\n           if(!isNaN(currentVal)){\r\n              arr[0] = container.bounds.width * currentVal / 100;\r\n              arr[1] = container.bounds.height * currentVal / 100;\r\n           }\r\n      }\r\n      return arr.map(asInt);\r\n  });\r\n}\r\n\r\nfunction renderableNode(node) {\r\n    return (node.nodeType === Node.TEXT_NODE || node.nodeType === Node.ELEMENT_NODE);\r\n}\r\n\r\nfunction isPositionedForStacking(container) {\r\n    var position = container.css(\"position\");\r\n    var zIndex = ([\"absolute\", \"relative\", \"fixed\"].indexOf(position) !== -1) ? container.css(\"zIndex\") : \"auto\";\r\n    return zIndex !== \"auto\";\r\n}\r\n\r\nfunction isPositioned(container) {\r\n    return container.css(\"position\") !== \"static\";\r\n}\r\n\r\nfunction isFloating(container) {\r\n    return container.css(\"float\") !== \"none\";\r\n}\r\n\r\nfunction isInlineBlock(container) {\r\n    return [\"inline-block\", \"inline-table\"].indexOf(container.css(\"display\")) !== -1;\r\n}\r\n\r\nfunction not(callback) {\r\n    var context = this;\r\n    return function() {\r\n        return !callback.apply(context, arguments);\r\n    };\r\n}\r\n\r\nfunction isElement(container) {\r\n    return container.node.nodeType === Node.ELEMENT_NODE;\r\n}\r\n\r\nfunction isPseudoElement(container) {\r\n    return container.isPseudoElement === true;\r\n}\r\n\r\nfunction isTextNode(container) {\r\n    return container.node.nodeType === Node.TEXT_NODE;\r\n}\r\n\r\nfunction zIndexSort(contexts) {\r\n    return function(a, b) {\r\n        return (a.cssInt(\"zIndex\") + (contexts.indexOf(a) / contexts.length)) - (b.cssInt(\"zIndex\") + (contexts.indexOf(b) / contexts.length));\r\n    };\r\n}\r\n\r\nfunction hasOpacity(container) {\r\n    return container.getOpacity() < 1;\r\n}\r\n\r\nfunction bind(callback, context) {\r\n    return function() {\r\n        return callback.apply(context, arguments);\r\n    };\r\n}\r\n\r\nfunction asInt(value) {\r\n    return parseInt(value, 10);\r\n}\r\n\r\nfunction getWidth(border) {\r\n    return border.width;\r\n}\r\n\r\nfunction nonIgnoredElement(nodeContainer) {\r\n    return (nodeContainer.node.nodeType !== Node.ELEMENT_NODE || [\"SCRIPT\", \"HEAD\", \"TITLE\", \"OBJECT\", \"BR\", \"OPTION\"].indexOf(nodeContainer.node.nodeName) === -1);\r\n}\r\n\r\nfunction flatten(arrays) {\r\n    return [].concat.apply([], arrays);\r\n}\r\n\r\nfunction stripQuotes(content) {\r\n    var first = content.substr(0, 1);\r\n    return (first === content.substr(content.length - 1) && first.match(/'|\"/)) ? content.substr(1, content.length - 2) : content;\r\n}\r\n\r\nfunction getWords(characters) {\r\n    var words = [], i = 0, onWordBoundary = false, word;\r\n    while(characters.length) {\r\n        if (isWordBoundary(characters[i]) === onWordBoundary) {\r\n            word = characters.splice(0, i);\r\n            if (word.length) {\r\n                words.push(window.html2canvas.punycode.ucs2.encode(word));\r\n            }\r\n            onWordBoundary =! onWordBoundary;\r\n            i = 0;\r\n        } else {\r\n            i++;\r\n        }\r\n\r\n        if (i >= characters.length) {\r\n            word = characters.splice(0, i);\r\n            if (word.length) {\r\n                words.push(window.html2canvas.punycode.ucs2.encode(word));\r\n            }\r\n        }\r\n    }\r\n    return words;\r\n}\r\n\r\nfunction isWordBoundary(characterCode) {\r\n    return [\r\n        32, // <space>\r\n        13, // \\r\r\n        10, // \\n\r\n        9, // \\t\r\n        45 // -\r\n    ].indexOf(characterCode) !== -1;\r\n}\r\n\r\nfunction hasUnicode(string) {\r\n    return (/[^\\u0000-\\u00ff]/).test(string);\r\n}\r\n\r\nfunction Proxy(src, proxy, document) {\r\n    if (!proxy.url) {\r\n        return Promise.reject(\"No proxy configured\");\r\n    }\r\n    var callback = createCallback(supportsCORS);\r\n    var url = createProxyUrl(proxy.url, src, callback);\r\n\r\n    return supportsCORS ? XHR(url) : (jsonp(document, url, callback).then(function(response) {\r\n        return decode64(response.content);\r\n    }));\r\n}\r\nvar proxyCount = 0;\r\n\r\nvar supportsCORS = ('withCredentials' in new XMLHttpRequest());\r\nvar supportsCORSImage = ('crossOrigin' in new Image());\r\n\r\nfunction ProxyURL(src, proxy, document) {\r\n    var callback = createCallback(supportsCORSImage);\r\n    var url = createProxyUrl(proxy, src, callback);\r\n    return (supportsCORSImage ? Promise.resolve(url) : jsonp(document, url, callback).then(function(response) {\r\n        return \"data:\" + response.type + \";base64,\" + response.content;\r\n    }));\r\n}\r\n\r\nfunction jsonp(document, url, callback) {\r\n    return new Promise(function(resolve, reject) {\r\n        var s = document.createElement(\"script\");\r\n        var cleanup = function() {\r\n            delete window.html2canvas.proxy[callback];\r\n            document.body.removeChild(s);\r\n        };\r\n        window.html2canvas.proxy[callback] = function(response) {\r\n            cleanup();\r\n            resolve(response);\r\n        };\r\n        s.src = url;\r\n        s.onerror = function(e) {\r\n            cleanup();\r\n            reject(e);\r\n        };\r\n        document.body.appendChild(s);\r\n    });\r\n}\r\n\r\nfunction createCallback(useCORS) {\r\n    return !useCORS ? \"html2canvas_\" + Date.now() + \"_\" + (++proxyCount) + \"_\" + Math.round(Math.random() * 100000) : \"\";\r\n}\r\n\r\nfunction createProxyUrl(proxy, src, callback) {\r\n    var url = proxy.url + \"?url=\" + encodeURIComponent(src) + (callback.length ? \"&callback=html2canvas.proxy.\" + callback : \"\");\r\n    if (proxy.api_key) {\r\n      url += \"&api_key=\" + proxy.api_key;\r\n    }\r\n    return url;\r\n}\r\n\r\nfunction ProxyImageContainer(src, proxy) {\r\n    var script = document.createElement(\"script\");\r\n    var link = document.createElement(\"a\");\r\n    link.href = src;\r\n    src = link.href;\r\n    this.src = src;\r\n    this.image = new Image();\r\n    var self = this;\r\n    this.promise = new Promise(function(resolve, reject) {\r\n        self.image.crossOrigin = \"Anonymous\";\r\n        self.image.onload = resolve;\r\n        self.image.onerror = reject;\r\n\r\n        new ProxyURL(src, proxy, document).then(function(url) {\r\n            self.image.src = url;\r\n        })['catch'](reject);\r\n    });\r\n}\r\n\r\nfunction PseudoElementContainer(node, parent, type) {\r\n    NodeContainer.call(this, node, parent);\r\n    this.isPseudoElement = true;\r\n    this.before = type === \":before\";\r\n}\r\n\r\nPseudoElementContainer.prototype.cloneTo = function(stack) {\r\n    PseudoElementContainer.prototype.cloneTo.call(this, stack);\r\n    stack.isPseudoElement = true;\r\n    stack.before = this.before;\r\n};\r\n\r\nPseudoElementContainer.prototype = Object.create(NodeContainer.prototype);\r\n\r\nPseudoElementContainer.prototype.appendToDOM = function() {\r\n    if (this.before) {\r\n        this.parent.node.insertBefore(this.node, this.parent.node.firstChild);\r\n    } else {\r\n        this.parent.node.appendChild(this.node);\r\n    }\r\n    this.parent.node.className += \" \" + this.getHideClass();\r\n};\r\n\r\nPseudoElementContainer.prototype.cleanDOM = function() {\r\n    this.node.parentNode.removeChild(this.node);\r\n    this.parent.node.className = this.parent.node.className.replace(this.getHideClass(), \"\");\r\n};\r\n\r\nPseudoElementContainer.prototype.getHideClass = function() {\r\n    return this[\"PSEUDO_HIDE_ELEMENT_CLASS_\" + (this.before ? \"BEFORE\" : \"AFTER\")];\r\n};\r\n\r\nPseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE = \"___html2canvas___pseudoelement_before\";\r\nPseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER = \"___html2canvas___pseudoelement_after\";\r\n\r\nfunction Renderer(width, height, images, options, document) {\r\n    this.width = width;\r\n    this.height = height;\r\n    this.images = images;\r\n    this.options = options;\r\n    this.document = document;\r\n}\r\n\r\nRenderer.prototype.renderImage = function(container, bounds, borderData, imageContainer) {\r\n    var paddingLeft = container.cssInt('paddingLeft'),\r\n        paddingTop = container.cssInt('paddingTop'),\r\n        paddingRight = container.cssInt('paddingRight'),\r\n        paddingBottom = container.cssInt('paddingBottom'),\r\n        borders = borderData.borders;\r\n\r\n    var width = bounds.width - (borders[1].width + borders[3].width + paddingLeft + paddingRight);\r\n    var height = bounds.height - (borders[0].width + borders[2].width + paddingTop + paddingBottom);\r\n    this.drawImage(\r\n        imageContainer,\r\n        0,\r\n        0,\r\n        imageContainer.image.width || width,\r\n        imageContainer.image.height || height,\r\n        bounds.left + paddingLeft + borders[3].width,\r\n        bounds.top + paddingTop + borders[0].width,\r\n        width,\r\n        height\r\n    );\r\n};\r\n\r\nRenderer.prototype.renderBackground = function(container, bounds, borderData) {\r\n    if (bounds.height > 0 && bounds.width > 0) {\r\n        this.renderBackgroundColor(container, bounds);\r\n        this.renderBackgroundImage(container, bounds, borderData);\r\n    }\r\n};\r\n\r\nRenderer.prototype.renderBackgroundColor = function(container, bounds) {\r\n    var color = container.color(\"backgroundColor\");\r\n    if (!color.isTransparent()) {\r\n        this.rectangle(bounds.left, bounds.top, bounds.width, bounds.height, color);\r\n    }\r\n};\r\n\r\nRenderer.prototype.renderBorders = function(borders) {\r\n    borders.forEach(this.renderBorder, this);\r\n};\r\n\r\nRenderer.prototype.renderBorder = function(data) {\r\n    if (!data.color.isTransparent() && data.args !== null) {\r\n        this.drawShape(data.args, data.color);\r\n    }\r\n};\r\n\r\nRenderer.prototype.renderBackgroundImage = function(container, bounds, borderData) {\r\n    var backgroundImages = container.parseBackgroundImages();\r\n    backgroundImages.reverse().forEach(function(backgroundImage, index, arr) {\r\n        switch(backgroundImage.method) {\r\n        case \"url\":\r\n            var image = this.images.get(backgroundImage.args[0]);\r\n            if (image) {\r\n                this.renderBackgroundRepeating(container, bounds, image, arr.length - (index+1), borderData);\r\n            } else {\r\n                log(\"Error loading background-image\", backgroundImage.args[0]);\r\n            }\r\n            break;\r\n        case \"linear-gradient\":\r\n        case \"gradient\":\r\n            var gradientImage = this.images.get(backgroundImage.value);\r\n            if (gradientImage) {\r\n                this.renderBackgroundGradient(gradientImage, bounds, borderData);\r\n            } else {\r\n                log(\"Error loading background-image\", backgroundImage.args[0]);\r\n            }\r\n            break;\r\n        case \"none\":\r\n            break;\r\n        default:\r\n            log(\"Unknown background-image type\", backgroundImage.args[0]);\r\n        }\r\n    }, this);\r\n};\r\n\r\nRenderer.prototype.renderBackgroundRepeating = function(container, bounds, imageContainer, index, borderData) {\r\n    var size = container.parseBackgroundSize(bounds, imageContainer.image, index);\r\n    var position = container.parseBackgroundPosition(bounds, imageContainer.image, index, size);\r\n    var repeat = container.parseBackgroundRepeat(index);\r\n    switch (repeat) {\r\n    case \"repeat-x\":\r\n    case \"repeat no-repeat\":\r\n        this.backgroundRepeatShape(imageContainer, position, size, bounds, bounds.left + borderData[3], bounds.top + position.top + borderData[0], 99999, size.height, borderData);\r\n        break;\r\n    case \"repeat-y\":\r\n    case \"no-repeat repeat\":\r\n        this.backgroundRepeatShape(imageContainer, position, size, bounds, bounds.left + position.left + borderData[3], bounds.top + borderData[0], size.width, 99999, borderData);\r\n        break;\r\n    case \"no-repeat\":\r\n        this.backgroundRepeatShape(imageContainer, position, size, bounds, bounds.left + position.left + borderData[3], bounds.top + position.top + borderData[0], size.width, size.height, borderData);\r\n        break;\r\n    default:\r\n        this.renderBackgroundRepeat(imageContainer, position, size, {top: bounds.top, left: bounds.left}, borderData[3], borderData[0]);\r\n        break;\r\n    }\r\n};\r\n\r\nfunction StackingContext(hasOwnStacking, opacity, element, parent) {\r\n    NodeContainer.call(this, element, parent);\r\n    this.ownStacking = hasOwnStacking;\r\n    this.contexts = [];\r\n    this.children = [];\r\n    this.opacity = (this.parent ? this.parent.stack.opacity : 1) * opacity;\r\n}\r\n\r\nStackingContext.prototype = Object.create(NodeContainer.prototype);\r\n\r\nStackingContext.prototype.getParentStack = function(context) {\r\n    var parentStack = (this.parent) ? this.parent.stack : null;\r\n    return parentStack ? (parentStack.ownStacking ? parentStack : parentStack.getParentStack(context)) : context.stack;\r\n};\r\n\r\nfunction Support(document) {\r\n    this.rangeBounds = this.testRangeBounds(document);\r\n    this.cors = this.testCORS();\r\n    this.svg = this.testSVG();\r\n}\r\n\r\nSupport.prototype.testRangeBounds = function(document) {\r\n    var range, testElement, rangeBounds, rangeHeight, support = false;\r\n\r\n    if (document.createRange) {\r\n        range = document.createRange();\r\n        if (range.getBoundingClientRect) {\r\n            testElement = document.createElement('boundtest');\r\n            testElement.style.height = \"123px\";\r\n            testElement.style.display = \"block\";\r\n            document.body.appendChild(testElement);\r\n\r\n            range.selectNode(testElement);\r\n            rangeBounds = range.getBoundingClientRect();\r\n            rangeHeight = rangeBounds.height;\r\n\r\n            if (rangeHeight === 123) {\r\n                support = true;\r\n            }\r\n            document.body.removeChild(testElement);\r\n        }\r\n    }\r\n\r\n    return support;\r\n};\r\n\r\nSupport.prototype.testCORS = function() {\r\n    return typeof((new Image()).crossOrigin) !== \"undefined\";\r\n};\r\n\r\nSupport.prototype.testSVG = function() {\r\n    var img = new Image();\r\n    var canvas = document.createElement(\"canvas\");\r\n    var ctx =  canvas.getContext(\"2d\");\r\n    img.src = \"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>\";\r\n\r\n    try {\r\n        ctx.drawImage(img, 0, 0);\r\n        canvas.toDataURL();\r\n    } catch(e) {\r\n        return false;\r\n    }\r\n    return true;\r\n};\r\n\r\nfunction SVGContainer(src) {\r\n    this.src = src;\r\n    this.image = null;\r\n    var self = this;\r\n\r\n    this.promise = this.hasFabric().then(function() {\r\n        return (self.isInline(src) ? Promise.resolve(self.inlineFormatting(src)) : XHR(src));\r\n    }).then(function(svg) {\r\n        return new Promise(function(resolve) {\r\n            html2canvas.fabric.loadSVGFromString(svg, self.createCanvas.call(self, resolve));\r\n        });\r\n    });\r\n}\r\n\r\nSVGContainer.prototype.hasFabric = function() {\r\n    return !html2canvas.fabric ? Promise.reject(new Error(\"html2canvas.svg.js is not loaded, cannot render svg\")) : Promise.resolve();\r\n};\r\n\r\nSVGContainer.prototype.inlineFormatting = function(src) {\r\n    return (/^data:image\\/svg\\+xml;base64,/.test(src)) ? this.decode64(this.removeContentType(src)) : this.removeContentType(src);\r\n};\r\n\r\nSVGContainer.prototype.removeContentType = function(src) {\r\n    return src.replace(/^data:image\\/svg\\+xml(;base64)?,/,'');\r\n};\r\n\r\nSVGContainer.prototype.isInline = function(src) {\r\n    return (/^data:image\\/svg\\+xml/i.test(src));\r\n};\r\n\r\nSVGContainer.prototype.createCanvas = function(resolve) {\r\n    var self = this;\r\n    return function (objects, options) {\r\n        var canvas = new html2canvas.fabric.StaticCanvas('c');\r\n        self.image = canvas.lowerCanvasEl;\r\n        canvas\r\n            .setWidth(options.width)\r\n            .setHeight(options.height)\r\n            .add(html2canvas.fabric.util.groupSVGElements(objects, options))\r\n            .renderAll();\r\n        resolve(canvas.lowerCanvasEl);\r\n    };\r\n};\r\n\r\nSVGContainer.prototype.decode64 = function(str) {\r\n    return (typeof(window.atob) === \"function\") ? window.atob(str) : decode64(str);\r\n};\r\n\r\n/*\r\n * base64-arraybuffer\r\n * https://github.com/niklasvh/base64-arraybuffer\r\n *\r\n * Copyright (c) 2012 Niklas von Hertzen\r\n * Licensed under the MIT license.\r\n */\r\n\r\nfunction decode64(base64) {\r\n    var chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\r\n    var len = base64.length, i, encoded1, encoded2, encoded3, encoded4, byte1, byte2, byte3;\r\n\r\n    var output = \"\";\r\n\r\n    for (i = 0; i < len; i+=4) {\r\n        encoded1 = chars.indexOf(base64[i]);\r\n        encoded2 = chars.indexOf(base64[i+1]);\r\n        encoded3 = chars.indexOf(base64[i+2]);\r\n        encoded4 = chars.indexOf(base64[i+3]);\r\n\r\n        byte1 = (encoded1 << 2) | (encoded2 >> 4);\r\n        byte2 = ((encoded2 & 15) << 4) | (encoded3 >> 2);\r\n        byte3 = ((encoded3 & 3) << 6) | encoded4;\r\n        if (encoded3 === 64) {\r\n            output += String.fromCharCode(byte1);\r\n        } else if (encoded4 === 64 || encoded4 === -1) {\r\n            output += String.fromCharCode(byte1, byte2);\r\n        } else{\r\n            output += String.fromCharCode(byte1, byte2, byte3);\r\n        }\r\n    }\r\n\r\n    return output;\r\n}\r\n\r\nfunction SVGNodeContainer(node, native) {\r\n    this.src = node;\r\n    this.image = null;\r\n    var self = this;\r\n\r\n    this.promise = native ? new Promise(function(resolve, reject) {\r\n        self.image = new Image();\r\n        self.image.onload = resolve;\r\n        self.image.onerror = reject;\r\n        self.image.src = \"data:image/svg+xml,\" + (new XMLSerializer()).serializeToString(node);\r\n        if (self.image.complete === true) {\r\n            resolve(self.image);\r\n        }\r\n    }) : this.hasFabric().then(function() {\r\n        return new Promise(function(resolve) {\r\n            html2canvas.fabric.parseSVGDocument(node, self.createCanvas.call(self, resolve));\r\n        });\r\n    });\r\n}\r\n\r\nSVGNodeContainer.prototype = Object.create(SVGContainer.prototype);\r\n\r\nfunction TextContainer(node, parent) {\r\n    NodeContainer.call(this, node, parent);\r\n}\r\n\r\nTextContainer.prototype = Object.create(NodeContainer.prototype);\r\n\r\nTextContainer.prototype.applyTextTransform = function() {\r\n    this.node.data = this.transform(this.parent.css(\"textTransform\"));\r\n};\r\n\r\nTextContainer.prototype.transform = function(transform) {\r\n    var text = this.node.data;\r\n    switch(transform){\r\n        case \"lowercase\":\r\n            return text.toLowerCase();\r\n        case \"capitalize\":\r\n            return text.replace(/(^|\\s|:|-|\\(|\\))([a-z])/g, capitalize);\r\n        case \"uppercase\":\r\n            return text.toUpperCase();\r\n        default:\r\n            return text;\r\n    }\r\n};\r\n\r\nfunction capitalize(m, p1, p2) {\r\n    if (m.length > 0) {\r\n        return p1 + p2.toUpperCase();\r\n    }\r\n}\r\n\r\nfunction WebkitGradientContainer(imageData) {\r\n    GradientContainer.apply(this, arguments);\r\n    this.type = (imageData.args[0] === \"linear\") ? this.TYPES.LINEAR : this.TYPES.RADIAL;\r\n}\r\n\r\nWebkitGradientContainer.prototype = Object.create(GradientContainer.prototype);\r\n\r\nfunction XHR(url) {\r\n    return new Promise(function(resolve, reject) {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open('GET', url);\r\n\r\n        xhr.onload = function() {\r\n            if (xhr.status === 200) {\r\n                resolve(xhr.responseText);\r\n            } else {\r\n                reject(new Error(xhr.statusText));\r\n            }\r\n        };\r\n\r\n        xhr.onerror = function() {\r\n            reject(new Error(\"Network Error\"));\r\n        };\r\n\r\n        xhr.send();\r\n    });\r\n}\r\n\r\nfunction CanvasRenderer(width, height) {\r\n    Renderer.apply(this, arguments);\r\n    this.canvas = this.options.canvas || this.document.createElement(\"canvas\");\r\n    if (!this.options.canvas) {\r\n        this.canvas.width = width;\r\n        this.canvas.height = height;\r\n    }\r\n    this.ctx = this.canvas.getContext(\"2d\");\r\n    this.taintCtx = this.document.createElement(\"canvas\").getContext(\"2d\");\r\n    this.ctx.textBaseline = \"bottom\";\r\n    this.variables = {};\r\n    log(\"Initialized CanvasRenderer with size\", width, \"x\", height);\r\n}\r\n\r\nCanvasRenderer.prototype = Object.create(Renderer.prototype);\r\n\r\nCanvasRenderer.prototype.setFillStyle = function(fillStyle) {\r\n    this.ctx.fillStyle = typeof(fillStyle) === \"object\" && !!fillStyle.isColor ? fillStyle.toString() : fillStyle;\r\n    return this.ctx;\r\n};\r\n\r\nCanvasRenderer.prototype.rectangle = function(left, top, width, height, color) {\r\n    this.setFillStyle(color).fillRect(left, top, width, height);\r\n};\r\n\r\nCanvasRenderer.prototype.circle = function(left, top, size, color) {\r\n    this.setFillStyle(color);\r\n    this.ctx.beginPath();\r\n    this.ctx.arc(left + size / 2, top + size / 2, size / 2, 0, Math.PI*2, true);\r\n    this.ctx.closePath();\r\n    this.ctx.fill();\r\n};\r\n\r\nCanvasRenderer.prototype.circleStroke = function(left, top, size, color, stroke, strokeColor) {\r\n    this.circle(left, top, size, color);\r\n    this.ctx.strokeStyle = strokeColor.toString();\r\n    this.ctx.stroke();\r\n};\r\n\r\nCanvasRenderer.prototype.drawShape = function(shape, color) {\r\n    this.shape(shape);\r\n    this.setFillStyle(color).fill();\r\n};\r\n\r\nCanvasRenderer.prototype.taints = function(imageContainer) {\r\n    if (imageContainer.tainted === null) {\r\n        this.taintCtx.drawImage(imageContainer.image, 0, 0);\r\n        try {\r\n            this.taintCtx.getImageData(0, 0, 1, 1);\r\n            imageContainer.tainted = false;\r\n        } catch(e) {\r\n            this.taintCtx = document.createElement(\"canvas\").getContext(\"2d\");\r\n            imageContainer.tainted = true;\r\n        }\r\n    }\r\n\r\n    return imageContainer.tainted;\r\n};\r\n\r\nCanvasRenderer.prototype.drawImage = function(imageContainer, sx, sy, sw, sh, dx, dy, dw, dh) {\r\n    if (!this.taints(imageContainer) || this.options.allowTaint) {\r\n        this.ctx.drawImage(imageContainer.image, sx, sy, sw, sh, dx, dy, dw, dh);\r\n    }\r\n};\r\n\r\nCanvasRenderer.prototype.clip = function(shapes, callback, context) {\r\n    this.ctx.save();\r\n    shapes.filter(hasEntries).forEach(function(shape) {\r\n        this.shape(shape).clip();\r\n    }, this);\r\n    callback.call(context);\r\n    this.ctx.restore();\r\n};\r\n\r\nCanvasRenderer.prototype.shape = function(shape) {\r\n    this.ctx.beginPath();\r\n    shape.forEach(function(point, index) {\r\n        if (point[0] === \"rect\") {\r\n            this.ctx.rect.apply(this.ctx, point.slice(1));\r\n        } else {\r\n            this.ctx[(index === 0) ? \"moveTo\" : point[0] + \"To\" ].apply(this.ctx, point.slice(1));\r\n        }\r\n    }, this);\r\n    this.ctx.closePath();\r\n    return this.ctx;\r\n};\r\n\r\nCanvasRenderer.prototype.font = function(color, style, variant, weight, size, family) {\r\n    this.setFillStyle(color).font = [style, variant, weight, size, family].join(\" \").split(\",\")[0];\r\n};\r\n\r\nCanvasRenderer.prototype.fontShadow = function(color, offsetX, offsetY, blur) {\r\n    this.setVariable(\"shadowColor\", color.toString())\r\n        .setVariable(\"shadowOffsetY\", offsetX)\r\n        .setVariable(\"shadowOffsetX\", offsetY)\r\n        .setVariable(\"shadowBlur\", blur);\r\n};\r\n\r\nCanvasRenderer.prototype.clearShadow = function() {\r\n    this.setVariable(\"shadowColor\", \"rgba(0,0,0,0)\");\r\n};\r\n\r\nCanvasRenderer.prototype.setOpacity = function(opacity) {\r\n    this.ctx.globalAlpha = opacity;\r\n};\r\n\r\nCanvasRenderer.prototype.setTransform = function(transform) {\r\n    this.ctx.translate(transform.origin[0], transform.origin[1]);\r\n    this.ctx.transform.apply(this.ctx, transform.matrix);\r\n    this.ctx.translate(-transform.origin[0], -transform.origin[1]);\r\n};\r\n\r\nCanvasRenderer.prototype.setVariable = function(property, value) {\r\n    if (this.variables[property] !== value) {\r\n        this.variables[property] = this.ctx[property] = value;\r\n    }\r\n\r\n    return this;\r\n};\r\n\r\nCanvasRenderer.prototype.text = function(text, left, bottom) {\r\n    this.ctx.fillText(text, left, bottom);\r\n};\r\n\r\nCanvasRenderer.prototype.backgroundRepeatShape = function(imageContainer, backgroundPosition, size, bounds, left, top, width, height, borderData) {\r\n    var shape = [\r\n        [\"line\", Math.round(left), Math.round(top)],\r\n        [\"line\", Math.round(left + width), Math.round(top)],\r\n        [\"line\", Math.round(left + width), Math.round(height + top)],\r\n        [\"line\", Math.round(left), Math.round(height + top)]\r\n    ];\r\n    this.clip([shape], function() {\r\n        this.renderBackgroundRepeat(imageContainer, backgroundPosition, size, bounds, borderData[3], borderData[0]);\r\n    }, this);\r\n};\r\n\r\nCanvasRenderer.prototype.renderBackgroundRepeat = function(imageContainer, backgroundPosition, size, bounds, borderLeft, borderTop) {\r\n    var offsetX = Math.round(bounds.left + backgroundPosition.left + borderLeft), offsetY = Math.round(bounds.top + backgroundPosition.top + borderTop);\r\n    this.setFillStyle(this.ctx.createPattern(this.resizeImage(imageContainer, size), \"repeat\"));\r\n    this.ctx.translate(offsetX, offsetY);\r\n    this.ctx.fill();\r\n    this.ctx.translate(-offsetX, -offsetY);\r\n};\r\n\r\nCanvasRenderer.prototype.renderBackgroundGradient = function(gradientImage, bounds) {\r\n    if (gradientImage instanceof LinearGradientContainer) {\r\n        var gradient = this.ctx.createLinearGradient(\r\n            bounds.left + bounds.width * gradientImage.x0,\r\n            bounds.top + bounds.height * gradientImage.y0,\r\n            bounds.left +  bounds.width * gradientImage.x1,\r\n            bounds.top +  bounds.height * gradientImage.y1);\r\n        gradientImage.colorStops.forEach(function(colorStop) {\r\n            gradient.addColorStop(colorStop.stop, colorStop.color.toString());\r\n        });\r\n        this.rectangle(bounds.left, bounds.top, bounds.width, bounds.height, gradient);\r\n    }\r\n};\r\n\r\nCanvasRenderer.prototype.resizeImage = function(imageContainer, size) {\r\n    var image = imageContainer.image;\r\n    if(image.width === size.width && image.height === size.height) {\r\n        return image;\r\n    }\r\n\r\n    var ctx, canvas = document.createElement('canvas');\r\n    canvas.width = size.width;\r\n    canvas.height = size.height;\r\n    ctx = canvas.getContext(\"2d\");\r\n    ctx.drawImage(image, 0, 0, image.width, image.height, 0, 0, size.width, size.height );\r\n    return canvas;\r\n};\r\n\r\nfunction hasEntries(array) {\r\n    return array.length > 0;\r\n}\r\n\r\n}).call({}, typeof(window) !== \"undefined\" ? window : undefined, typeof(document) !== \"undefined\" ? document : undefined);\r\n","/*\n * Postgres Model for codemirror based on:\n *  MySQL Mode for CodeMirror 2 by MySQL-Tools\n *    @author James Thorne (partydroid)\n *    @link   http://github.com/partydroid/MySQL-Tools\n *    @link   http://mysqltools.org\n *    @version 02/Jan/2012\n*/\nCodeMirror.defineMode(\"postgres\", function(config) {\n  var indentUnit = config.indentUnit;\n  var curPunc;\n\n  function wordRegexp(words) {\n    return new RegExp(\"^(?:\" + words.join(\"|\") + \")$\", \"i\");\n  }\n  var ops = wordRegexp([\"str\", \"lang\", \"langmatches\", \"datatype\", \"bound\", \"sameterm\", \"isiri\", \"isuri\",\n                        \"isblank\", \"isliteral\", \"union\", \"a\"]);\n  var keywords = wordRegexp([\n    ('ABS'),('ACCESSIBLE'),('ADD'),('ALL'),('ALTER'),('ANALYZE'),('AND'),('ANY'),('ARRAY'),('ARRAY_AGG'),('ARRAY_MAX_CARDINALITY'),('AS'),('ASC'),('ASENSITIVE'),('AT'),('AVG'),('BEFORE'),('BEGIN'),\n    ('BETWEEN'),('BIGINT'),('BINARY'),('BLOB'),('BOOLEAN'),('BOTH'),('BY'),('CALL'),('CASCADE'),('CASE'),('CAST'),('CEIL'),('CEILING'),('CHANGE'),('CHAR'),('CHARACTER'),('CHARACTER_LENGTH'),\n    ('CHAR_LENGTH'),('CHECK'),('CLOB'),('CLOSE'),('COLLATE'),('COLLECT'),('COLUMN'),('COLUMNS'),('CONDITION'),('CONSTRAINT'),('CONTAINS'),('CONTINUE'),('CONVERT'),('CORR'),('COUNT'),('CREATE'),\n    ('CROSS'),('CUBE'),('CURRENT_DATE'),('CURRENT_TIME'),('CURRENT_TIMESTAMP'),('CURRENT_USER'),('CURSOR'),('CYCLE'),('DATABASE'),('DATABASES'),('DATE'),('DAY'),('DAY_HOUR'),('DAY_MICROSECOND'),\n    ('DAY_MINUTE'),('DAY_SECOND'),('DEC'),('DECIMAL'),('DECLARE'),('DEFAULT'),('DELAYED'),('DELETE'),('DESC'),('DESCRIBE'),('DETERMINISTIC'),('DISTINCT'),('DISTINCTROW'),('DIV'),('DOUBLE'),('DROP'),\n    ('DUAL'),('EACH'),('ELEMENT'),('ELSE'),('ELSEIF'),('ENCLOSED'),('END'),('EQUALS'),('ESCAPE'),('ESCAPED'),('EVERY'),('EXCEPT'),('EXEC'),('EXISTS'),('EXIT'),('EXP'),('EXPLAIN'),('EXTRACT'),\n    ('FALSE'),('FETCH'),('FILTER'),('FLOAT'),('FLOAT4'),('FLOAT8'),('FLOOR'),('FOR'),('FORCE'),('FOREIGN'),('FROM'),('FULL'),('FULLTEXT'),('GRANT'),('GROUP'),('GROUPS'),('HAVING'),('HIGH_PRIORITY'),\n    ('HOLD'),('HOUR'),('HOUR_MICROSECOND'),('HOUR_MINUTE'),('HOUR_SECOND'),('IDENTITY'),('IF'),('IGNORE'),('ILIKE'),('IN'),('INDEX'),('INFILE'),('INNER'),('INOUT'),('INSENSITIVE'),('INSERT'),('INT'),\n    ('INT1'),('INT2'),('INT3'),('INT4'),('INT8'),('INTEGER'),('INTERSECT'),('INTERSECTION'),('INTERVAL'),('INTO'),('IS'),('ITERATE'),('JOIN'),('KEY'),('KEYS'),('KILL'),('LAG'),('LARGE'),('LEADING'),\n    ('LEAVE'),('LEFT'),('LIKE'),('LIKE_REGEX'),('LIMIT'),('LINEAR'),('LINES'),('LN'),('LOAD'),('LOCALTIME'),('LOCALTIMESTAMP'),('LOCK'),('LONG'),('LONGBLOB'),('LONGTEXT'),('LOOP'),('LOWER'),\n    ('LOW_PRIORITY'),('MASTER_SSL_VERIFY_SERVER_CERT'),('MATCH'),('MAX'),('MEDIUMBLOB'),('MEDIUMINT'),('MEDIUMTEXT'),('MIDDLEINT'),('MIN'),('MINUTE'),('MINUTE_MICROSECOND'),('MINUTE_SECOND'),('MOD'),\n    ('MODIFIES'),('MODULE'),('MONTH'),('MULTISET'),('NATURAL'),('NO'),('NONE'),('NORMALIZE'),('NOT'),('NO_WRITE_TO_BINLOG'),('NULL'),('NULLIF'),('NUMERIC'),('OF'),('OFFSET'),('OLD'),('ON'),('ONLY'),\n    ('OPEN'),('OPTIMIZE'),('OPTION'),('OPTIONALLY'),('OR'),('ORDER'),('OUT'),('OUTER'),('OUTFILE'),('OVER'),('OVERLAY'),('PARAMETER'),('PERCENT'),('PERIOD'),('POSITION'),('POWER'),('PRECISION'),\n    ('PRIMARY'),('PROCEDURE'),('PURGE'),('RANGE'),('READ'),('READS'),('READ_WRITE'),('REAL'),('REFERENCES'),('REGEXP'),('RELEASE'),('RENAME'),('REPEAT'),('REPLACE'),('REQUIRE'),('RESTRICT'),\n    ('RESULT'),('RETURN'),('REVOKE'),('RIGHT'),('RLIKE'),('ROWS'),('SCHEMA'),('SCHEMAS'),('SECOND_MICROSECOND'),('SELECT'),('SENSITIVE'),('SEPARATOR'),('SET'),('SHOW'),('SIMILAR'),('SMALLINT'),\n    ('SOME'),('SPATIAL'),('SPECIFIC'),('SQL'),('SQLEXCEPTION'),('SQLSTATE'),('SQLWARNING'),('SQL_BIG_RESULT'),('SQL_CALC_FOUND_ROWS'),('SQL_SMALL_RESULT'),('SQRT'),('SSL'),('STARTING'),('STDEV'),\n    ('STRAIGHT_JOIN'),('SUBSTRING'),('SUM'),('TABLE'),('TERMINATED'),('THEN'),('TIME'),('TIMESTAMP'),('TINYBLOB'),('TINYINT'),('TINYTEXT'),('TO'),('TRAILING'),('TRIGGER'),('TRIM'),('TRIM_ARRAY'),\n    ('TRUE'),('TRUNCATE'),('UNDO'),('UNION'),('UNIQUE'),('UNKNOWN'),('UNLOCK'),('UNSIGNED'),('UPDATE'),('UPPER'),('USAGE'),('USE'),('USING'),('UTC_DATE'),('UTC_TIME'),('UTC_TIMESTAMP'),('VALUE'),\n    ('VALUES'),('VALUE_OF'),('VARBINARY'),('VARCHAR'),('VARCHARACTER'),('VARYING'),('WHEN'),('WHENEVER'),('WHERE'),('WHILE'),('WITH'),('WITHIN'),('WITHOUT'),('WRITE'),('XOR'),('YEAR_MONTH'),('ZEROFILL')\n  ]);\n  var operatorChars = /[*+\\-<>=&|]/;\n\n  function tokenBase(stream, state) {\n    var ch = stream.next();\n    curPunc = null;\n    if (ch == \"$\" || ch == \"?\") {\n      stream.match(/^[\\w\\d]*/);\n      return \"variable-2\";\n    }\n    else if (ch == \"<\" && !stream.match(/^[\\s\\u00a0=]/, false)) {\n      stream.match(/^[^\\s\\u00a0>]*>?/);\n      return \"atom\";\n    }\n    else if (ch == \"\\\"\" || ch == \"'\") {\n      state.tokenize = tokenLiteral(ch);\n      return state.tokenize(stream, state);\n    }\n    else if (ch == \"`\") {\n      state.tokenize = tokenOpLiteral(ch);\n      return state.tokenize(stream, state);\n    }\n    else if (/[{}\\(\\),\\.;\\[\\]]/.test(ch)) {\n      curPunc = ch;\n      return null;\n    }\n    else if (ch == \"-\") {\n      var ch2 = stream.next();\n      if (ch2==\"-\") {\n        stream.skipToEnd();\n        return \"comment\";\n      }\n    }\n    else if (operatorChars.test(ch)) {\n      stream.eatWhile(operatorChars);\n      return null;\n    }\n    else if (ch == \":\") {\n      stream.eatWhile(/[\\w\\d\\._\\-]/);\n      return \"atom\";\n    }\n    else {\n      stream.eatWhile(/[_\\w\\d]/);\n      if (stream.eat(\":\")) {\n        stream.eatWhile(/[\\w\\d_\\-]/);\n        return \"atom\";\n      }\n      var word = stream.current(), type;\n      if (ops.test(word))\n        return null;\n      else if (keywords.test(word))\n        return \"keyword\";\n      else\n        return \"variable\";\n    }\n  }\n\n  function tokenLiteral(quote) {\n    return function(stream, state) {\n      var escaped = false, ch;\n      while ((ch = stream.next()) != null) {\n        if (ch == quote && !escaped) {\n          state.tokenize = tokenBase;\n          break;\n        }\n        escaped = !escaped && ch == \"\\\\\";\n      }\n      return \"string\";\n    };\n  }\n\n  function tokenOpLiteral(quote) {\n    return function(stream, state) {\n      var escaped = false, ch;\n      while ((ch = stream.next()) != null) {\n        if (ch == quote && !escaped) {\n          state.tokenize = tokenBase;\n          break;\n        }\n        escaped = !escaped && ch == \"\\\\\";\n      }\n      return \"variable-2\";\n    };\n  }\n\n\n  function pushContext(state, type, col) {\n    state.context = {prev: state.context, indent: state.indent, col: col, type: type};\n  }\n  function popContext(state) {\n    state.indent = state.context.indent;\n    state.context = state.context.prev;\n  }\n\n  return {\n    startState: function(base) {\n      return {tokenize: tokenBase,\n              context: null,\n              indent: 0,\n              col: 0};\n    },\n\n    token: function(stream, state) {\n      if (stream.sol()) {\n        if (state.context && state.context.align == null) state.context.align = false;\n        state.indent = stream.indentation();\n      }\n      if (stream.eatSpace()) return null;\n      var style = state.tokenize(stream, state);\n\n      if (style != \"comment\" && state.context && state.context.align == null && state.context.type != \"pattern\") {\n        state.context.align = true;\n      }\n\n      if (curPunc == \"(\") pushContext(state, \")\", stream.column());\n      else if (curPunc == \"[\") pushContext(state, \"]\", stream.column());\n      else if (curPunc == \"{\") pushContext(state, \"}\", stream.column());\n      else if (/[\\]\\}\\)]/.test(curPunc)) {\n        while (state.context && state.context.type == \"pattern\") popContext(state);\n        if (state.context && curPunc == state.context.type) popContext(state);\n      }\n      else if (curPunc == \".\" && state.context && state.context.type == \"pattern\") popContext(state);\n      else if (/atom|string|variable/.test(style) && state.context) {\n        if (/[\\}\\]]/.test(state.context.type))\n          pushContext(state, \"pattern\", stream.column());\n        else if (state.context.type == \"pattern\" && !state.context.align) {\n          state.context.align = true;\n          state.context.col = stream.column();\n        }\n      }\n\n      return style;\n    },\n\n    indent: function(state, textAfter) {\n      var firstChar = textAfter && textAfter.charAt(0);\n      var context = state.context;\n      if (/[\\]\\}]/.test(firstChar))\n        while (context && context.type == \"pattern\") context = context.prev;\n\n      var closing = context && firstChar == context.type;\n      if (!context)\n        return 0;\n      else if (context.type == \"pattern\")\n        return context.col;\n      else if (context.align)\n        return context.col + (closing ? 0 : 1);\n      else\n        return context.indent + (closing ? 0 : indentUnit);\n    }\n  };\n});\n\nCodeMirror.defineMIME(\"text/x-postgres\", \"postgres\");\n","(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n\"use strict\";\n\nCodeMirror.defineMode(\"xml\", function(config, parserConfig) {\n  var indentUnit = config.indentUnit;\n  var multilineTagIndentFactor = parserConfig.multilineTagIndentFactor || 1;\n  var multilineTagIndentPastTag = parserConfig.multilineTagIndentPastTag;\n  if (multilineTagIndentPastTag == null) multilineTagIndentPastTag = true;\n\n  var Kludges = parserConfig.htmlMode ? {\n    autoSelfClosers: {'area': true, 'base': true, 'br': true, 'col': true, 'command': true,\n                      'embed': true, 'frame': true, 'hr': true, 'img': true, 'input': true,\n                      'keygen': true, 'link': true, 'meta': true, 'param': true, 'source': true,\n                      'track': true, 'wbr': true},\n    implicitlyClosed: {'dd': true, 'li': true, 'optgroup': true, 'option': true, 'p': true,\n                       'rp': true, 'rt': true, 'tbody': true, 'td': true, 'tfoot': true,\n                       'th': true, 'tr': true},\n    contextGrabbers: {\n      'dd': {'dd': true, 'dt': true},\n      'dt': {'dd': true, 'dt': true},\n      'li': {'li': true},\n      'option': {'option': true, 'optgroup': true},\n      'optgroup': {'optgroup': true},\n      'p': {'address': true, 'article': true, 'aside': true, 'blockquote': true, 'dir': true,\n            'div': true, 'dl': true, 'fieldset': true, 'footer': true, 'form': true,\n            'h1': true, 'h2': true, 'h3': true, 'h4': true, 'h5': true, 'h6': true,\n            'header': true, 'hgroup': true, 'hr': true, 'menu': true, 'nav': true, 'ol': true,\n            'p': true, 'pre': true, 'section': true, 'table': true, 'ul': true},\n      'rp': {'rp': true, 'rt': true},\n      'rt': {'rp': true, 'rt': true},\n      'tbody': {'tbody': true, 'tfoot': true},\n      'td': {'td': true, 'th': true},\n      'tfoot': {'tbody': true},\n      'th': {'td': true, 'th': true},\n      'thead': {'tbody': true, 'tfoot': true},\n      'tr': {'tr': true}\n    },\n    doNotIndent: {\"pre\": true},\n    allowUnquoted: true,\n    allowMissing: true,\n    caseFold: true\n  } : {\n    autoSelfClosers: {},\n    implicitlyClosed: {},\n    contextGrabbers: {},\n    doNotIndent: {},\n    allowUnquoted: false,\n    allowMissing: false,\n    caseFold: false\n  };\n  var alignCDATA = parserConfig.alignCDATA;\n\n  // Return variables for tokenizers\n  var type, setStyle;\n\n  function inText(stream, state) {\n    function chain(parser) {\n      state.tokenize = parser;\n      return parser(stream, state);\n    }\n\n    var ch = stream.next();\n    if (ch == \"<\") {\n      if (stream.eat(\"!\")) {\n        if (stream.eat(\"[\")) {\n          if (stream.match(\"CDATA[\")) return chain(inBlock(\"atom\", \"]]>\"));\n          else return null;\n        } else if (stream.match(\"--\")) {\n          return chain(inBlock(\"comment\", \"-->\"));\n        } else if (stream.match(\"DOCTYPE\", true, true)) {\n          stream.eatWhile(/[\\w\\._\\-]/);\n          return chain(doctype(1));\n        } else {\n          return null;\n        }\n      } else if (stream.eat(\"?\")) {\n        stream.eatWhile(/[\\w\\._\\-]/);\n        state.tokenize = inBlock(\"meta\", \"?>\");\n        return \"meta\";\n      } else {\n        type = stream.eat(\"/\") ? \"closeTag\" : \"openTag\";\n        state.tokenize = inTag;\n        return \"tag bracket\";\n      }\n    } else if (ch == \"&\") {\n      var ok;\n      if (stream.eat(\"#\")) {\n        if (stream.eat(\"x\")) {\n          ok = stream.eatWhile(/[a-fA-F\\d]/) && stream.eat(\";\");\n        } else {\n          ok = stream.eatWhile(/[\\d]/) && stream.eat(\";\");\n        }\n      } else {\n        ok = stream.eatWhile(/[\\w\\.\\-:]/) && stream.eat(\";\");\n      }\n      return ok ? \"atom\" : \"error\";\n    } else {\n      stream.eatWhile(/[^&<]/);\n      return null;\n    }\n  }\n\n  function inTag(stream, state) {\n    var ch = stream.next();\n    if (ch == \">\" || (ch == \"/\" && stream.eat(\">\"))) {\n      state.tokenize = inText;\n      type = ch == \">\" ? \"endTag\" : \"selfcloseTag\";\n      return \"tag bracket\";\n    } else if (ch == \"=\") {\n      type = \"equals\";\n      return null;\n    } else if (ch == \"<\") {\n      state.tokenize = inText;\n      state.state = baseState;\n      state.tagName = state.tagStart = null;\n      var next = state.tokenize(stream, state);\n      return next ? next + \" error\" : \"error\";\n    } else if (/[\\'\\\"]/.test(ch)) {\n      state.tokenize = inAttribute(ch);\n      state.stringStartCol = stream.column();\n      return state.tokenize(stream, state);\n    } else {\n      stream.match(/^[^\\s\\u00a0=<>\\\"\\']*[^\\s\\u00a0=<>\\\"\\'\\/]/);\n      return \"word\";\n    }\n  }\n\n  function inAttribute(quote) {\n    var closure = function(stream, state) {\n      while (!stream.eol()) {\n        if (stream.next() == quote) {\n          state.tokenize = inTag;\n          break;\n        }\n      }\n      return \"string\";\n    };\n    closure.isInAttribute = true;\n    return closure;\n  }\n\n  function inBlock(style, terminator) {\n    return function(stream, state) {\n      while (!stream.eol()) {\n        if (stream.match(terminator)) {\n          state.tokenize = inText;\n          break;\n        }\n        stream.next();\n      }\n      return style;\n    };\n  }\n  function doctype(depth) {\n    return function(stream, state) {\n      var ch;\n      while ((ch = stream.next()) != null) {\n        if (ch == \"<\") {\n          state.tokenize = doctype(depth + 1);\n          return state.tokenize(stream, state);\n        } else if (ch == \">\") {\n          if (depth == 1) {\n            state.tokenize = inText;\n            break;\n          } else {\n            state.tokenize = doctype(depth - 1);\n            return state.tokenize(stream, state);\n          }\n        }\n      }\n      return \"meta\";\n    };\n  }\n\n  function Context(state, tagName, startOfLine) {\n    this.prev = state.context;\n    this.tagName = tagName;\n    this.indent = state.indented;\n    this.startOfLine = startOfLine;\n    if (Kludges.doNotIndent.hasOwnProperty(tagName) || (state.context && state.context.noIndent))\n      this.noIndent = true;\n  }\n  function popContext(state) {\n    if (state.context) state.context = state.context.prev;\n  }\n  function maybePopContext(state, nextTagName) {\n    var parentTagName;\n    while (true) {\n      if (!state.context) {\n        return;\n      }\n      parentTagName = state.context.tagName;\n      if (!Kludges.contextGrabbers.hasOwnProperty(parentTagName) ||\n          !Kludges.contextGrabbers[parentTagName].hasOwnProperty(nextTagName)) {\n        return;\n      }\n      popContext(state);\n    }\n  }\n\n  function baseState(type, stream, state) {\n    if (type == \"openTag\") {\n      state.tagStart = stream.column();\n      return tagNameState;\n    } else if (type == \"closeTag\") {\n      return closeTagNameState;\n    } else {\n      return baseState;\n    }\n  }\n  function tagNameState(type, stream, state) {\n    if (type == \"word\") {\n      state.tagName = stream.current();\n      setStyle = \"tag\";\n      return attrState;\n    } else {\n      setStyle = \"error\";\n      return tagNameState;\n    }\n  }\n  function closeTagNameState(type, stream, state) {\n    if (type == \"word\") {\n      var tagName = stream.current();\n      if (state.context && state.context.tagName != tagName &&\n          Kludges.implicitlyClosed.hasOwnProperty(state.context.tagName))\n        popContext(state);\n      if (state.context && state.context.tagName == tagName) {\n        setStyle = \"tag\";\n        return closeState;\n      } else {\n        setStyle = \"tag error\";\n        return closeStateErr;\n      }\n    } else {\n      setStyle = \"error\";\n      return closeStateErr;\n    }\n  }\n\n  function closeState(type, _stream, state) {\n    if (type != \"endTag\") {\n      setStyle = \"error\";\n      return closeState;\n    }\n    popContext(state);\n    return baseState;\n  }\n  function closeStateErr(type, stream, state) {\n    setStyle = \"error\";\n    return closeState(type, stream, state);\n  }\n\n  function attrState(type, _stream, state) {\n    if (type == \"word\") {\n      setStyle = \"attribute\";\n      return attrEqState;\n    } else if (type == \"endTag\" || type == \"selfcloseTag\") {\n      var tagName = state.tagName, tagStart = state.tagStart;\n      state.tagName = state.tagStart = null;\n      if (type == \"selfcloseTag\" ||\n          Kludges.autoSelfClosers.hasOwnProperty(tagName)) {\n        maybePopContext(state, tagName);\n      } else {\n        maybePopContext(state, tagName);\n        state.context = new Context(state, tagName, tagStart == state.indented);\n      }\n      return baseState;\n    }\n    setStyle = \"error\";\n    return attrState;\n  }\n  function attrEqState(type, stream, state) {\n    if (type == \"equals\") return attrValueState;\n    if (!Kludges.allowMissing) setStyle = \"error\";\n    return attrState(type, stream, state);\n  }\n  function attrValueState(type, stream, state) {\n    if (type == \"string\") return attrContinuedState;\n    if (type == \"word\" && Kludges.allowUnquoted) {setStyle = \"string\"; return attrState;}\n    setStyle = \"error\";\n    return attrState(type, stream, state);\n  }\n  function attrContinuedState(type, stream, state) {\n    if (type == \"string\") return attrContinuedState;\n    return attrState(type, stream, state);\n  }\n\n  return {\n    startState: function() {\n      return {tokenize: inText,\n              state: baseState,\n              indented: 0,\n              tagName: null, tagStart: null,\n              context: null};\n    },\n\n    token: function(stream, state) {\n      if (!state.tagName && stream.sol())\n        state.indented = stream.indentation();\n\n      if (stream.eatSpace()) return null;\n      type = null;\n      var style = state.tokenize(stream, state);\n      if ((style || type) && style != \"comment\") {\n        setStyle = null;\n        state.state = state.state(type || style, stream, state);\n        if (setStyle)\n          style = setStyle == \"error\" ? style + \" error\" : setStyle;\n      }\n      return style;\n    },\n\n    indent: function(state, textAfter, fullLine) {\n      var context = state.context;\n      // Indent multi-line strings (e.g. css).\n      if (state.tokenize.isInAttribute) {\n        if (state.tagStart == state.indented)\n          return state.stringStartCol + 1;\n        else\n          return state.indented + indentUnit;\n      }\n      if (context && context.noIndent) return CodeMirror.Pass;\n      if (state.tokenize != inTag && state.tokenize != inText)\n        return fullLine ? fullLine.match(/^(\\s*)/)[0].length : 0;\n      // Indent the starts of attribute names.\n      if (state.tagName) {\n        if (multilineTagIndentPastTag)\n          return state.tagStart + state.tagName.length + 2;\n        else\n          return state.tagStart + indentUnit * multilineTagIndentFactor;\n      }\n      if (alignCDATA && /<!\\[CDATA\\[/.test(textAfter)) return 0;\n      var tagAfter = textAfter && /^<(\\/)?([\\w_:\\.-]*)/.exec(textAfter);\n      if (tagAfter && tagAfter[1]) { // Closing tag spotted\n        while (context) {\n          if (context.tagName == tagAfter[2]) {\n            context = context.prev;\n            break;\n          } else if (Kludges.implicitlyClosed.hasOwnProperty(context.tagName)) {\n            context = context.prev;\n          } else {\n            break;\n          }\n        }\n      } else if (tagAfter) { // Opening tag spotted\n        while (context) {\n          var grabbers = Kludges.contextGrabbers[context.tagName];\n          if (grabbers && grabbers.hasOwnProperty(tagAfter[2]))\n            context = context.prev;\n          else\n            break;\n        }\n      }\n      while (context && !context.startOfLine)\n        context = context.prev;\n      if (context) return context.indent + indentUnit;\n      else return 0;\n    },\n\n    electricInput: /<\\/[\\s\\w:]+>$/,\n    blockCommentStart: \"<!--\",\n    blockCommentEnd: \"-->\",\n\n    configuration: parserConfig.htmlMode ? \"html\" : \"xml\",\n    helperType: parserConfig.htmlMode ? \"html\" : \"xml\"\n  };\n});\n\nCodeMirror.defineMIME(\"text/xml\", \"xml\");\nCodeMirror.defineMIME(\"application/xml\", \"xml\");\nif (!CodeMirror.mimeModes.hasOwnProperty(\"text/html\"))\n  CodeMirror.defineMIME(\"text/html\", {name: \"xml\", htmlMode: true});\n\n});","$.fn.draggableOverlay = function(opt) {\n\n  var self      = this;\n  var $rule     = null;\n  var $ruleH    = null;\n  var $elements = this;\n\n  if (opt === \"disable\" || opt.container == undefined) {\n\n    this.addClass(\"disabled\");\n    this.css('cursor', '')\n\n    return;\n\n  }\n\n  opt = $.extend({ horizontal_guides: [], vertical_guides: [], padding: 0, stickiness: 7, cursor: \"move\" }, opt);\n\n  var $container = opt.container;\n\n  // Guide offsets\n  var horizontal_guides = opt.horizontal_guides;\n  var vertical_guides   = opt.vertical_guides;\n\n  var vertical_limits, horizontal_limits, verticals, horizontals = []; \n\n  $(\".rule\").remove();\n\n  $rule = $(\"<div class='rule' />\");\n  $container.append($rule)\n  $rule.offset({ top: 0 }).css( { left: 0 });\n\n  $ruleH = $(\"<div class='rule horizontal' />\");\n  $container.append($ruleH);\n  $ruleH.offset({ top: 0 }).css( { left: 0 });\n\n  for (var i = 0; i < horizontal_guides.length; i++) {\n\n    var position = horizontal_guides[i];\n\n    var $el = $(\"<div class='guide horizontal' />\");\n\n    $container.append($el)\n\n    $el.offset( { top: position }).css( { left: 0 });\n\n  }\n\n  for (var i = 0; i < vertical_guides.length; i++) {\n\n    var position = vertical_guides[i];\n\n    var $el = $(\"<div class='guide vertical' />\");\n    $container.append($el)\n    $el.offset( { left: position }).css( { top: 0 });\n  }\n\n  var onMouseDown = function(e) {\n\n    if (self.hasClass(\"disabled\")) {\n\n      e.stopPropagation();\n\n      return;\n    }\n\n    e.stopPropagation();\n\n    var $drag = $(this).addClass('draggable');\n\n    $(this).css({ bottom: \"auto\", right: \"auto\", left: $(this).position().left, top: $(this).position().top })\n\n    var\n    //z_idx    = $drag.css('z-index'),\n    drg_h    = $drag.outerHeight(),\n    drg_w    = $drag.outerWidth(),\n    pos_y    = $drag.offset().top  + drg_h - e.pageY,\n    pos_x    = $drag.offset().left + drg_w - e.pageX,\n    container_x = $container.offset().left,\n    container_y = $container.offset().top,\n    container_w = $container.width(),\n    container_h = $container.height();\n\n    verticals = [];\n    horizontals = [];\n    vertical_limits   = [];\n    horizontal_limits = [];\n\n    var device = $(this).hasClass(\"desktop\") ? \"desktop\" : \"mobile\";\n\n    if ($(this).hasClass(\"snap\")) {\n      $elements.each(function(i, e) {\n        if (!$(e).hasClass(\"draggable\") && $(e).hasClass(device) && !$(e).hasClass(\"disabled\") && $(e).hasClass(\"snap\")) {\n\n          var t = $(e).offset().top;\n          horizontal_limits.push(t);\n          horizontal_limits.push(t + $(e).height());\n\n          var l = $(e).offset().left;\n          vertical_limits.push(l);\n          vertical_limits.push(l + $(e).width());\n        }\n      });\n\n      verticals   = verticals.concat(vertical_limits, vertical_guides);\n      horizontals = horizontals.concat(horizontal_limits, horizontal_guides);\n    }\n\n    var onMouseMove = function(e) {\n\n      var top  = e.pageY + pos_y - drg_h;\n      var left = e.pageX + pos_x - drg_w;\n\n      var otop  = top; \n      var oleft = left;\n\n      var container_right  = container_x + container_w;\n      var container_bottom = container_y + container_h;\n\n      // CHECK GUIDES\n      for (var i = 0; i < horizontals.length; i++) {\n\n        var target_l = horizontals[i];\n\n        if ( ( top >= target_l - opt.stickiness - opt.padding ) && ( top <= target_l + opt.stickiness + opt.padding) ) {\n          top = target_l;\n          $ruleH.offset( { top: top }).css({ left: 0, opacity: 1 })\n          break;\n        } else if ( ( top + drg_h <= target_l + opt.stickiness + opt.padding ) && ( top + drg_h >= target_l - opt.stickiness - opt.padding ) ) {\n          top = target_l - drg_h ;\n          $ruleH.offset( { top: top + drg_h }).css({ left: 0, opacity: 1 })\n          break;\n        }\n\n      }\n\n      for (var i = 0; i < verticals.length; i++) {\n\n        var target_l = verticals[i];\n\n        if ( ( left >= target_l - opt.stickiness - opt.padding) && ( left <= target_l + opt.stickiness + opt.padding ) ) {\n          left = target_l;\n          $rule.offset( { left: left }).css({ top: 0, opacity: 1 })\n          break;\n        } else if ( ( left + drg_w <= target_l + opt.stickiness + opt.padding ) && ( left + drg_w >= target_l - opt.stickiness - opt.padding) ) {\n          left = target_l - drg_w ;\n          $rule.offset( { left: left + drg_w }).css({ top: 0, opacity: 1 })\n          break;\n        } \n\n      }\n\n      // LEFT\n      if (left - opt.stickiness < container_x) {\n        left = container_x;\n      } else if (left + drg_w + opt.stickiness >  container_right ) {\n        left = container_right - drg_w;\n      }\n\n      // TOP\n      if (top - opt.stickiness < container_y) {\n        top = container_y;\n      } else if (top + drg_h + opt.stickiness >  container_bottom ) {\n        top = container_bottom - drg_h;\n      } \n\n\n      if (top == otop && left == oleft) {\n        $(this).find(\".draggable\").removeClass(\"sticky\");\n        $(\".rule\").css({ opacity: 0 });\n      } else {\n        $(this).find(\".draggable\").addClass(\"sticky\");\n      }\n\n      var offset = { top: top, left: left };\n\n      $('.draggable').offset(offset);\n\n      var updateLayout = _.throttle(function(e) {\n        opt.drag && opt.drag();\n      }, 100); \n      updateLayout();\n\n    }\n\n    $drag.parents().on(\"mousemove\", onMouseMove);\n\n  };\n\n  var onExit = function() {\n\n    $(\".draggable\").parents().off(\"mousemove\");\n    $(\".rule\").css({ opacity: 0 });\n\n    $(\".draggable\").removeClass('sticky');\n    $(\".draggable\").removeClass('draggable');\n\n  };\n\n  $(\"body\").on(\"mouseup\", onExit);\n\n  return this.on(\"mousedown\", onMouseDown).on(\"mouseup\", onExit);\n\n}\n","/*\n  LESS mode - http://www.lesscss.org/\n  Ported to CodeMirror by Peter Kroon <plakroon@gmail.com>\n  Report bugs/issues here: https://github.com/marijnh/CodeMirror/issues  GitHub: @peterkroon\n*/\n\nCodeMirror.defineMode(\"carto\", function(config) {\n  var indentUnit = config.indentUnit, type;\n  function ret(style, tp) {type = tp; return style;}\n  //html tags\n  var tags = \"a abbr acronym address applet area article aside audio b base basefont bdi bdo big blockquote body br button canvas caption cite code col colgroup command datalist dd del details dfn dir div dl dt em embed fieldset figcaption figure font footer form frame frameset h1 h2 h3 h4 h5 h6 head header hgroup hr html i iframe img input ins keygen kbd label legend li link map mark menu meta meter nav noframes noscript object ol optgroup option output p param pre progress q rp rt ruby s samp script section select small source span strike strong style sub summary sup table tbody td textarea tfoot th thead time title tr track tt u ul var video wbr\".split(' ');\n  var colorKeywords = keySet(color_keywords);\n\n  function inTagsArray(val){\n    for(var i=0; i<tags.length; i++)if(val === tags[i])return true;\n  }\n\n  var selectors = /(^\\:root$|^\\:nth\\-child$|^\\:nth\\-last\\-child$|^\\:nth\\-of\\-type$|^\\:nth\\-last\\-of\\-type$|^\\:first\\-child$|^\\:last\\-child$|^\\:first\\-of\\-type$|^\\:last\\-of\\-type$|^\\:only\\-child$|^\\:only\\-of\\-type$|^\\:empty$|^\\:link|^\\:visited$|^\\:active$|^\\:hover$|^\\:focus$|^\\:target$|^\\:lang$|^\\:enabled^\\:disabled$|^\\:checked$|^\\:first\\-line$|^\\:first\\-letter$|^\\:before$|^\\:after$|^\\:not$|^\\:required$|^\\:invalid$)/;\n\n  function tokenBase(stream, state) {\n    var ch = stream.next();\n\n    if (ch == \"@\") {stream.eatWhile(/[\\w\\-]/); return ret(\"meta\", stream.current());}\n    else if (ch == \"/\" && stream.eat(\"*\")) {\n      state.tokenize = tokenCComment;\n      return tokenCComment(stream, state);\n    }\n    else if (ch == \"<\" && stream.eat(\"!\")) {\n      state.tokenize = tokenSGMLComment;\n      return tokenSGMLComment(stream, state);\n    }\n    else if (ch == \"=\") ret(null, \"compare\");\n    else if (ch == \"|\" && stream.eat(\"=\")) return ret(null, \"compare\");\n    else if (ch == \"\\\"\" || ch == \"'\") {\n      state.tokenize = tokenString(ch);\n      return state.tokenize(stream, state);\n    }\n    else if (ch == \"/\") { // e.g.: .png will not be parsed as a class\n      if(stream.eat(\"/\")){\n        state.tokenize = tokenSComment;\n        return tokenSComment(stream, state);\n      }else{\n        if(type == \"string\" || type == \"(\")return ret(\"string\", \"string\");\n        if(state.stack[state.stack.length-1] != undefined)return ret(null, ch);\n        stream.eatWhile(/[\\a-zA-Z0-9\\-_.\\s]/);\n        if( /\\/|\\)|#/.test(stream.peek() || (stream.eatSpace() && stream.peek() == \")\"))  || stream.eol() )return ret(\"string\", \"string\"); // let url(/images/logo.png) without quotes return as string\n      }\n    }\n    else if (ch == \"!\") {\n      stream.match(/^\\s*\\w*/);\n      return ret(\"keyword\", \"important\");\n    }\n    else if (/\\d/.test(ch)) {\n      stream.eatWhile(/[\\w.%]/);\n      return ret(\"number\", \"unit\");\n    }\n    else if (/[,+<>*\\/]/.test(ch)) {\n      if(stream.peek() == \"=\" || type == \"a\")return ret(\"string\", \"string\");\n      return ret(null, \"select-op\");\n    }\n    else if (/[;{}:\\[\\]()~\\|]/.test(ch)) {\n      if(ch == \":\"){\n        stream.eatWhile(/[a-z\\\\\\-]/);\n        if( selectors.test(stream.current()) ){\n          return ret(\"tag\", \"tag\");\n        }else if(stream.peek() == \":\"){//::-webkit-search-decoration\n          stream.next();\n          stream.eatWhile(/[a-z\\\\\\-]/);\n          if(stream.current().match(/\\:\\:\\-(o|ms|moz|webkit)\\-/))return ret(\"string\", \"string\");\n          if( selectors.test(stream.current().substring(1)) )return ret(\"tag\", \"tag\");\n          return ret(null, ch);\n        }else{\n          return ret(null, ch);\n        }\n      }else if(ch == \"~\"){\n        if(type == \"r\")return ret(\"string\", \"string\");\n      }else{\n        return ret(null, ch);\n      }\n    }\n    else if (ch == \".\") {\n      if(type == \"(\" || type == \"string\")return ret(\"string\", \"string\"); // allow url(../image.png)\n      stream.eatWhile(/[\\a-zA-Z0-9\\-_]/);\n      if(stream.peek() == \" \")stream.eatSpace();\n      if(stream.peek() == \")\")return ret(\"number\", \"unit\");//rgba(0,0,0,.25);\n      return ret(\"tag\", \"tag\");\n    }\n    else if (ch == \"#\") {\n      //we don't eat white-space, we want the hex color and or id only\n      stream.eatWhile(/[A-Za-z0-9]/);\n      //check if there is a proper hex color length e.g. #eee || #eeeEEE\n      if(stream.current().length == 4 || stream.current().length == 7){\n        if(stream.current().match(/[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3}/,false) != null){//is there a valid hex color value present in the current stream\n          //when not a valid hex value, parse as id\n          if(stream.current().substring(1) != stream.current().match(/[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3}/,false))return ret(\"atom\", \"tag\");\n          //eat white-space\n          stream.eatSpace();\n          //when hex value declaration doesn't end with [;,] but is does with a slash/cc comment treat it as an id, just like the other hex values that don't end with[;,]\n          if( /[\\/<>.(){!$%^&*_\\-\\\\?=+\\|#'~`]/.test(stream.peek()) )return ret(\"atom\", \"tag\");\n          //#time { color: #aaa }\n          else if(stream.peek() == \"}\" )return ret(\"color\", \"unit\");\n          //we have a valid hex color value, parse as id whenever an element/class is defined after the hex(id) value e.g. #eee aaa || #eee .aaa\n          else if( /[a-zA-Z\\\\]/.test(stream.peek()) )return ret(\"color\", \"unit\");\n          //when a hex value is on the end of a line, parse as id\n          else if(stream.eol())return ret(\"color\", \"unit\");\n          //default\n          else return ret(\"color\", \"unit\");\n        }else{//when not a valid hexvalue in the current stream e.g. #footer\n          stream.eatWhile(/[\\w\\\\\\-]/);\n          return ret(\"atom\", \"tag\");\n        }\n      }else{//when not a valid hexvalue length\n        stream.eatWhile(/[\\w\\\\\\-]/);\n        return ret(\"atom\", \"tag\");\n      }\n    }\n    else if (ch == \"&\") {\n      stream.eatWhile(/[\\w\\-]/);\n      return ret(null, ch);\n    }\n    else {\n      stream.eatWhile(/[\\w\\\\\\-_%.{]/);\n      if(type == \"string\"){\n        return ret(\"string\", \"string\");\n      }else if(stream.current().match(/(^http$|^https$)/) != null){\n        stream.eatWhile(/[\\w\\\\\\-_%.{:\\/]/);\n        return ret(\"string\", \"string\");\n      }else if(stream.peek() == \"<\" || stream.peek() == \">\"){\n        return ret(\"tag\", \"tag\");\n      }else if( /\\(/.test(stream.peek()) ){\n        return ret(null, ch);\n      }else if (stream.peek() == \"/\" && state.stack[state.stack.length-1] != undefined){ // url(dir/center/image.png)\n        return ret(\"string\", \"string\");\n      }else if( stream.current().match(/\\-\\d|\\-.\\d/) ){ // match e.g.: -5px -0.4 etc... only colorize the minus sign\n        //commment out these 2 comment if you want the minus sign to be parsed as null -500px\n        //stream.backUp(stream.current().length-1);\n        //return ret(null, ch); //console.log( stream.current() );\n        return ret(\"number\", \"unit\");\n      }else if( inTagsArray(stream.current().toLowerCase()) ){ // match html tags\n        return ret(\"tag\", \"tag\");\n      }else if( /\\/|[\\s\\)]/.test(stream.peek() || stream.eol() || (stream.eatSpace() && stream.peek() == \"/\")) && stream.current().indexOf(\".\") !== -1){\n        if(stream.current().substring(stream.current().length-1,stream.current().length) == \"{\"){\n          stream.backUp(1);\n          return ret(\"tag\", \"tag\");\n        }//end if\n        stream.eatSpace();\n        if( /[{<>.a-zA-Z\\/]/.test(stream.peek())  || stream.eol() )return ret(\"tag\", \"tag\"); // e.g. button.icon-plus\n        return ret(\"string\", \"string\"); // let url(/images/logo.png) without quotes return as string\n      }else if( stream.eol() || stream.peek() == \"[\" || stream.peek() == \"#\" || type == \"tag\" ){\n        if(stream.current().substring(stream.current().length-1,stream.current().length) == \"{\")stream.backUp(1);\n        return ret(\"tag\", \"tag\");\n      }else if(type == \"compare\" || type == \"a\" || type == \"(\"){\n        return ret(\"string\", \"string\");\n      }else if(type == \"|\" || stream.current() == \"-\" || type == \"[\"){\n        return ret(null, ch);\n      }else if(stream.peek() == \":\") {\n        stream.next();\n        var t_v = stream.peek() == \":\" ? true : false;\n        if(!t_v){\n          var old_pos = stream.pos;\n          var sc = stream.current().length;\n          stream.eatWhile(/[a-z\\\\\\-]/);\n          var new_pos = stream.pos;\n          if(stream.current().substring(sc-1).match(selectors) != null){\n            stream.backUp(new_pos-(old_pos-1));\n          return ret(\"tag\", \"tag\");\n          } else stream.backUp(new_pos-(old_pos-1));\n        }else{\n          stream.backUp(1);\n        }\n        if(t_v)return ret(\"tag\", \"tag\"); else return ret(\"variable\", \"variable\");\n\n      // It is a color variable?\n      } else if (colorKeywords.hasOwnProperty(stream.current())) {\n       return ret('color', 'unit');\n      }else{\n        return ret(\"variable\", \"variable\");\n      }\n    }\n  }\n\n  function keySet(array) {\n    var keys = {};\n    for (var i = 0; i < array.length; ++i) {\n      keys[array[i]] = true;\n    }\n    return keys;\n  }\n\n  function tokenSComment(stream, state) { // SComment = Slash comment\n    stream.skipToEnd();\n    state.tokenize = tokenBase;\n    return ret(\"comment\", \"comment\");\n  }\n\n  function tokenCComment(stream, state) {\n    var maybeEnd = false, ch;\n    while ((ch = stream.next()) != null) {\n      if (maybeEnd && ch == \"/\") {\n        state.tokenize = tokenBase;\n        break;\n      }\n      maybeEnd = (ch == \"*\");\n    }\n    return ret(\"comment\", \"comment\");\n  }\n\n  function tokenSGMLComment(stream, state) {\n    var dashes = 0, ch;\n    while ((ch = stream.next()) != null) {\n      if (dashes >= 2 && ch == \">\") {\n        state.tokenize = tokenBase;\n        break;\n      }\n      dashes = (ch == \"-\") ? dashes + 1 : 0;\n    }\n    return ret(\"comment\", \"comment\");\n  }\n\n  function tokenString(quote) {\n    return function(stream, state) {\n      var escaped = false, ch;\n      while ((ch = stream.next()) != null) {\n        if (ch == quote && !escaped)\n          break;\n        escaped = !escaped && ch == \"\\\\\";\n      }\n      if (!escaped) state.tokenize = tokenBase;\n      return ret(\"string\", \"string\");\n    };\n  }\n\n  return {\n    startState: function(base) {\n      return {tokenize: tokenBase,\n              baseIndent: base || 0,\n              stack: []};\n    },\n\n    token: function(stream, state) {\n      if (stream.eatSpace()) return null;\n      var style = state.tokenize(stream, state);\n\n      var context = state.stack[state.stack.length-1];\n      if (type == \"hash\" && context == \"rule\") style = \"atom\";\n      else if (style == \"variable\") {\n        if (context == \"rule\") style = null; //\"tag\"\n        else if (!context || context == \"@media{\") {\n          style = stream.current() == \"when\"  ? \"variable\" :\n          /[\\s,|\\s\\)|\\s]/.test(stream.peek()) ? \"tag\"      : type;\n        }\n      }\n\n      if (context == \"rule\" && /^[\\{\\};]$/.test(type))\n        state.stack.pop();\n      if (type == \"{\") {\n        if (context == \"@media\") state.stack[state.stack.length-1] = \"@media{\";\n        else state.stack.push(\"{\");\n      }\n      else if (type == \"}\") state.stack.pop();\n      else if (type == \"@media\") state.stack.push(\"@media\");\n      else if (context == \"{\" && type != \"comment\") state.stack.push(\"rule\");\n      return style;\n    },\n\n    indent: function(state, textAfter) {\n      var n = state.stack.length;\n      if (/^\\}/.test(textAfter))\n        n -= state.stack[state.stack.length-1] == \"rule\" ? 2 : 1;\n      return state.baseIndent + n * indentUnit;\n    },\n\n    electricChars: \"}\"\n  };\n});\n\nCodeMirror.defineMIME(\"text/x-carto\", \"carto\");","var color_keywords = [\n      \"aliceblue\", \"antiquewhite\", \"aqua\", \"aquamarine\", \"azure\", \"beige\",\n      \"bisque\", \"black\", \"blanchedalmond\", \"blue\", \"blueviolet\", \"brown\",\n      \"burlywood\", \"cadetblue\", \"chartreuse\", \"chocolate\", \"coral\", \"cornflowerblue\",\n      \"cornsilk\", \"crimson\", \"cyan\", \"darkblue\", \"darkcyan\", \"darkgoldenrod\",\n      \"darkgray\", \"darkgreen\", \"darkkhaki\", \"darkmagenta\", \"darkolivegreen\",\n      \"darkorange\", \"darkorchid\", \"darkred\", \"darksalmon\", \"darkseagreen\",\n      \"darkslateblue\", \"darkslategray\", \"darkturquoise\", \"darkviolet\",\n      \"deeppink\", \"deepskyblue\", \"dimgray\", \"dodgerblue\", \"firebrick\",\n      \"floralwhite\", \"forestgreen\", \"fuchsia\", \"gainsboro\", \"ghostwhite\",\n      \"gold\", \"goldenrod\", \"gray\", \"grey\", \"green\", \"greenyellow\", \"honeydew\",\n      \"hotpink\", \"indianred\", \"indigo\", \"ivory\", \"khaki\", \"lavender\",\n      \"lavenderblush\", \"lawngreen\", \"lemonchiffon\", \"lightblue\", \"lightcoral\",\n      \"lightcyan\", \"lightgoldenrodyellow\", \"lightgray\", \"lightgreen\", \"lightpink\",\n      \"lightsalmon\", \"lightseagreen\", \"lightskyblue\", \"lightslategray\",\n      \"lightsteelblue\", \"lightyellow\", \"lime\", \"limegreen\", \"linen\", \"magenta\",\n      \"maroon\", \"mediumaquamarine\", \"mediumblue\", \"mediumorchid\", \"mediumpurple\",\n      \"mediumseagreen\", \"mediumslateblue\", \"mediumspringgreen\", \"mediumturquoise\",\n      \"mediumvioletred\", \"midnightblue\", \"mintcream\", \"mistyrose\", \"moccasin\",\n      \"navajowhite\", \"navy\", \"oldlace\", \"olive\", \"olivedrab\", \"orange\", \"orangered\",\n      \"orchid\", \"palegoldenrod\", \"palegreen\", \"paleturquoise\", \"palevioletred\",\n      \"papayawhip\", \"peachpuff\", \"peru\", \"pink\", \"plum\", \"powderblue\",\n      \"purple\", \"red\", \"rosybrown\", \"royalblue\", \"saddlebrown\", \"salmon\",\n      \"sandybrown\", \"seagreen\", \"seashell\", \"sienna\", \"silver\", \"skyblue\",\n      \"slateblue\", \"slategray\", \"snow\", \"springgreen\", \"steelblue\", \"tan\",\n      \"teal\", \"thistle\", \"tomato\", \"turquoise\", \"violet\", \"wheat\", \"white\",\n      \"whitesmoke\", \"yellow\", \"yellowgreen\"\n  ];","\n/**\n * this is a monkey patch for leaflet removeLayer\n * this method version is the same than leaflet 0.7.3 but adds a check to finish the zoom animation when there are no layers (see comments)\n *\n */\n\nif (L.version !== '0.7.3') {\n  throw new Error(\"remove leaflet_monkeypatch.js file\");\n}\n\nL.Map.prototype.removeLayer = function (layer) {\n  var id = L.stamp(layer);\n\n  if (!this._layers[id]) { return this; }\n\n  if (this._loaded) {\n      layer.onRemove(this);\n  }\n\n  delete this._layers[id];\n\n  if (this._loaded) {\n      this.fire('layerremove', {layer: layer});\n  }\n\n  if (this._zoomBoundLayers[id]) {\n      delete this._zoomBoundLayers[id];\n      this._updateZoomLevels();\n  }\n\n  // TODO looks ugly, refactor\n  if (this.options.zoomAnimation && L.TileLayer && (layer instanceof L.TileLayer)) {\n      /** patch code **/\n      if (this._tryAnimatedZoom && this._animatingZoom) {\n        if (this._nothingToAnimate()) {\n          this._onZoomTransitionEnd();\n        }\n      }\n      /** ~patch code **/\n      this._tileLayersNum--;\n      this._tileLayersToLoad--;\n      layer.off('load', this._onTileLayerLoad, this);\n  }\n\n  return this;\n};\n","\n\n  /*\n   *  Utils for CartoDB App\n   */\n\n  cdb.Utils = {};\n\n\n  /*\n   *  Strip html tags from a value.\n   *  input ->  string with input text (example: '<a href=\"#whoknows\">Jamon</a> </br> <p>Vamos</p>')\n   *  allowed -> allowed html tags in the result (example: '<a>')\n   *\n   *  return -> '<a href=\"#whoknows\">Jamon</a> Vamos'\n   */\n\n  cdb.Utils.stripHTML = function(input, allowed) {\n    allowed = (((allowed || \"\") + \"\").toLowerCase().match(/<[a-z][a-z0-9]*>/g) || []).join('');\n    var tags = /<\\/?([a-z][a-z0-9]*)\\b[^>]*>/gi;\n    if (!input || (typeof input != \"string\")) return '';\n    return input.replace(tags, function ($0, $1) {\n      return allowed.indexOf('<' + $1.toLowerCase() + '>') > -1 ? $0 : '';\n    });\n  }\n\n\n  /*\n   *  Remove events attached in html code.\n   *  input ->  string with input text (example: '<a href=\"#whoknows\" onClick=\"alert('jamon')\">Jamon</a>')\n   *\n   *  return -> '<a href=\"#whoknows\">Jamon</a>'\n   */\n\n  cdb.Utils.removeHTMLEvents = function(input) {\n    if (input) {\n      return input.replace(/ on\\w+=\"[^\"]*\"/g, '');\n    } else {\n      return '';\n    }\n  }\n\n  /*\n   *  Truncate a string\n   *  input -> string with input text\n   *  length -> length of the output string\n   *\n   *  return -> true\n   */\n\n  cdb.Utils.truncate = function(input, length) {\n    return input.substr(0, length-1) + (input.length > length ? '&hellip;' : '');\n  }\n\n\n  /*\n   *  Simple regex to check if string is an url/ftp\n   *  input ->  string with input text (example: 'https://carto.com')\n   *\n   *  return -> true\n   */\n\n  cdb.Utils.isURL = function(input) {\n    var urlregex = /^((http|https|ftp)\\:\\/\\/)/g;\n    if (input) {\n      return urlregex.test(input);\n    } else {\n      return false;\n    }\n  }\n\n\n  cdb.Utils.encodeURLParams = function(url) {\n    if (this.isURL(url)) {\n      var urlParts = url.split('?');\n      if (urlParts.length > 1) {\n        return urlParts[0] + '?' + encodeURIComponent(urlParts[1]);\n      } else {\n        return url;\n      }\n    }\n    return url;\n  }\n\n\n  /*\n   *  Transform bytes to a readable format, like MB, GB\n   *  input ->  34234244\n   *\n   *  return -> 3 MB\n   */\n\n  cdb.Utils.readablizeBytes = function(bytes, round) {\n    if (!bytes || isNaN(bytes)) {\n      return 0;\n    }\n    var s = ['bytes', 'kB', 'MB', 'GB', 'TB', 'PB'];\n    var e = Math.floor(Math.log(bytes)/Math.log(1024));\n    var value = (bytes/Math.pow(1024, Math.floor(e))).toFixed(2);\n\n    if (round) { value = parseInt(value) }\n\n    return value + \" \" + s[e];\n  }\n\n  /*\n   * isEmpty\n   *\n   */\n  cdb.Utils.isEmpty = function(str) {\n    return (!str || 0 === str.length);\n  }\n\n  /*\n   * isBlank\n   *\n   */\n  cdb.Utils.isBlank = function(str) {\n    return (!str || /^\\s*$/.test(str));\n  }\n\n  /*\n   * formatNumber: adds thousands separators\n   * @return a string\n   *\n   */\n  cdb.Utils.formatNumber = function(x) {\n    if (!x) return \"0\";\n    var parts = x.toString().split(\".\");\n    parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n    return parts.join(\".\");\n  }\n\n  /*\n   * rgbToHex\n   *\n   */\n  cdb.Utils.rgbToHex = function(r, g, b) {\n\n    function componentToHex(c) {\n      var hex = c.toString(16);\n      return hex.length == 1 ? \"0\" + hex : hex;\n    }\n\n    return \"#\" + componentToHex(r) + componentToHex(g) + componentToHex(b);\n  }\n\n  /*\n   * hexToRGB\n   *\n   */\n  cdb.Utils.hexToRGB = function(hex) {\n\n    var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n\n    return result ? {\n      r: parseInt(result[1], 16),\n      g: parseInt(result[2], 16),\n      b: parseInt(result[3], 16)\n    } : null;\n\n  }\n\n\n  /*\n   *  Generate random password\n   *\n   */\n\n  cdb.Utils.genRandomPass = function(length) {\n\n    function getRandomNum() {\n      // between 0 - 1\n      var rndNum = Math.random()\n      // rndNum from 0 - 1000\n      rndNum = parseInt(rndNum * 1000);\n      // rndNum from 33 - 127\n      rndNum = (rndNum % 94) + 33;\n      return rndNum;\n    }\n\n    function checkPunc(num) {\n      if ((num >=33) && (num <=47)) { return true; }\n      if ((num >=58) && (num <=64)) { return true; }\n      if ((num >=91) && (num <=96)) { return true; }\n      if ((num >=123) && (num <=126)) { return true; }\n      return false;\n    }\n\n    length = isNaN(length) ? \"\" : length\n    var pass = \"\";\n    var randomLength = !length ? true : false;\n\n    if (randomLength) {\n      length = Math.random();\n      length = parseInt(length * 100);\n      length = (length % 7) + 6\n    }\n\n    for (i=0; i < length; i++) {\n      numI = getRandomNum();\n      while (checkPunc(numI)) { numI = getRandomNum() }\n      pass = pass + String.fromCharCode(numI);\n    }\n\n    return pass;\n  }\n\n\n  /**\n   *  Add leading zeros to numbers\n   *\n   */\n  cdb.Utils.pad = function(num, size) {\n    var s = num+\"\";\n    while (s.length < size) s = \"0\" + s;\n    return s;\n  }\n\n\n  /**\n   *  Remove all non-common characters like\n   *  spaces, quotes, accents, etc...\n   *\n   */\n  cdb.Utils.sanitizeString = function(str) {\n    return str.replace(/[^a-z0-9\\s]/gi, '').replace(/[_\\s]/g, '-');\n  }\n\n  /**\n   *  Convert long numbers to\n   *  readizable numbers.\n   *\n   */\n  cdb.Utils.readizableNumber = function(num) {\n    if (num >= 1000000000) return (num / 1000000000).toFixed(1) + 'G';\n    if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';\n    if (num >= 1000) return (num / 1000).toFixed(1) + 'K';\n    return num;\n  }\n\n  /**\n   *  Get the extension of a string\n   *\n   */\n  cdb.Utils.getFileExtension = function(str) {\n    if (!str) return '';\n\n    return str.substr(str.lastIndexOf('.') + 1);\n  }\n\n\n  /**\n   *  Get ordinal string from a number\n   *\n   */\n  cdb.Utils.getGetOrdinal = function(n) {\n    if (!n) {\n      return '';\n    }\n    var s = [\"th\",\"st\",\"nd\",\"rd\"];\n    var v = n%100;\n    return n+(s[(v-20)%10]||s[v]||s[0]);\n  }\n\n  cdb.Utils.capitalize = function(str) {\n    return str.charAt(0).toUpperCase() + str.slice(1);\n  };\n\n  cdb.Utils.isValidEmail = function(str) {\n    var re = /^([^@]+)@([^@]+)\\.([^@\\.]+)$/i;\n    return re.test(str);\n  }\n\n  /**\n   * Similar to _.result, but also allows passing arbitrary arguments to the property if it's function.\n   * This makes code more terse  when one just wants to use a value if it's available, no if-checks required.\n   *\n   * @example Expected output\n   *   model.set('something', 'yay');\n   *   cdb.Utils.result(model, 'get', 'something') // => 'yay'\n   *   cdb.Utils.result(model, 'nonexisting', 'else') // => undefined\n   *   cdb.Utils.result(undefinedVar, 'get') // => null\n   *\n   * @example Of usage\n   *  return cdb.Utils.result(model, 'get', 'mightNotExist') === 'OK'\n   *\n   * @param {*} maybeFn\n   * @return {*} Result from called maybeFn if a function, null otherwise\n   */\n  cdb.Utils.result = function(object, property) {\n    if (object == null) return null;\n    var value = object[property];\n    return _.isFunction(value) ? value.apply(object, Array.prototype.slice.call(arguments, 2)) : value;\n  };\n\n  /*\n   * Returns a (double) quoted table name if needed (if it contains a dash, for example).\n   * Coupled to backend lib/carto/table_utils.rb#safe_table_name_quoting.\n   * Duplicated at lib/assets/javascripts/cartodb3/helpers/utils.js to make it available for older models.\n   */\n  cdb.Utils.safeTableNameQuoting = function (table_name) {\n    if (table_name === undefined || table_name.indexOf('-') === -1 || table_name[0] === '\"' || table_name[table_name.length - 1] === '\"') {\n      return table_name;\n    } else {\n      return '\"' + table_name + '\"';\n    }\n  };\n","\n\n  /**\n   * User options dropdown (extends Dropdown)\n   *\n   * It shows the content in a dropdown (or dropup) with a special effect.\n   *\n   * Usage example:\n   *\n      var user_menu = new cdb.admin.DropdownMenu({\n        target: $('a.account'),\n        model: {username: username}, // No necessary indeed\n        template_base: 'common/views/settings_item'\n      });\n   *\n   */\n\n\n  cdb.admin.DropdownMenu = cdb.ui.common.Dropdown.extend({\n\n    show: function() {\n      var dfd = $.Deferred();\n      var self = this;\n      //sometimes this dialog is child of a node that is removed\n      //for that reason we link again DOM events just in case\n      this.delegateEvents();\n      this.$el\n        .css({\n          marginTop: self.options.vertical_position == \"down\" ? \"-10px\" : \"10px\",\n          opacity:0,\n          display:\"block\"\n        })\n        .animate({\n          margin: \"0\",\n          opacity: 1\n        }, {\n          \"duration\": this.options.speedIn,\n          \"complete\": function(){\n            dfd.resolve();\n          }\n        });\n      this.trigger(\"onDropdownShown\",this.el);\n\n      return dfd.promise();\n    },\n\n    /**\n     * open the dialog at x, y\n     */\n    openAt: function(x, y) {\n      var dfd = $.Deferred();\n\n      this.$el.css({\n        top: y,\n        left: x,\n        width: this.options.width\n      })\n      .addClass(\n        (this.options.vertical_position == \"up\" ? \"vertical_top\" : \"vertical_bottom\" )\n        + \" \" +\n        (this.options.horizontal_position == \"right\" ? \"horizontal_right\" : \"horizontal_left\" )\n        + \" \" +\n        // Add tick class\n        \"tick_\" + this.options.tick\n      )\n\n      this.isOpen = true;\n\n      // Show\n      $.when(this.show()).done(function(){ dfd.resolve();})\n      // xabel: I've add the deferred to make it easily testable\n\n      return dfd.promise();\n    },\n\n\n    hide: function(done) {\n\n      // don't attempt to hide the dropdown if it's already hidden\n      if (!this.isOpen) { done && done(); return; }\n\n      var self    = this;\n      this.isOpen = false;\n\n      this.$el.animate({\n\n        marginTop: self.options.vertical_position == \"down\" ? \"10px\" : \"-10px\",\n        opacity: 0\n\n      }, this.options.speedOut, function(){\n\n        // Remove selected class\n        $(self.options.target).removeClass(\"selected\");\n\n        // And hide it\n        self.$el.hide();\n        done && done();\n\n        self.trigger(\"onDropdownHidden\", self.el);\n\n      });\n    }\n  });\n","\n  /**\n   *  String field -> Place to edit and capture string editions\n   *  - It accepts a model with {attribute: 'colum', value: 'jamón'}\n   *  var string = new cdb.admin.StringField({ model: model })\n   */\n\n  cdb.admin.StringField = cdb.core.View.extend({\n\n    tagName: 'div',\n    className: 'field string',\n\n    default_options: {\n      template_name:  'old_common/views/forms/string_field',\n      label:          false,\n      autoResize:     true,\n      readOnly:       false\n    },\n\n    events: {\n      'change textarea':    '_onChange',\n      'keydown textarea':  '_onKeyDown'\n    },\n\n    initialize: function() {\n      _.defaults(this.options, this.default_options);\n\n      _.bindAll(this, '_onChange', '_onKeyDown');\n\n      this.template_base = this.options.template_base ? _.template(this.options.template_base) : cdb.templates.getTemplate(this.options.template_name);\n\n      // Setting valid value from the beginning\n      this.valid = true;\n\n      // Get Operating System\n      this._setOS();\n    },\n\n    render: function() {\n      this.$el.html(this.template_base(_.extend(this.model.toJSON(), this.options)));\n\n      if (this.options.readOnly) {\n        this.undelegateEvents();\n      }\n\n      // Hack to resize correctly the textarea\n      if (this.options.autoResize)\n        this._resize();\n\n      return this;\n    },\n\n    _setOS: function() {\n      // Check if the SO is Mac or rest in order to use Ctrl or CMD + ENTER to save the value\n      var ua = navigator.userAgent.toLowerCase();\n\n      this.so = \"rest\";\n      if (/mac os/.test(ua)) {\n        this.so = \"mac\";\n      }\n    },\n\n    // Public function to answer if the editor is valid or not\n    isValid: function() {\n      return this.valid;\n    },\n\n    _onChange: function(e) {\n      var value = $(e.target).val();\n      this.model.set('value', value);\n    },\n\n    _onKeyDown: function(e) {\n      if (((this.so==\"mac\" && e.metaKey) || (this.so==\"rest\" && e.ctrlKey)) && e.keyCode == 13 ) {\n        e.preventDefault();\n        this._triggerEvent('ENTER');\n        return false;\n      }\n\n      var value = $(e.target).val();\n\n      this.model.set('value', value);\n\n      if (this.options.autoResize)\n        this._resize();\n    },\n\n    // Hack function to resize automatially textarea\n    _resize: function() {\n      var $textarea = this.$(\"textarea\");\n\n      // Hello hacky boy\n      if ($textarea)\n        setTimeout(function() {\n          $textarea.height(20);\n          $textarea.height($textarea[0].scrollHeight - 22);\n        });\n    },\n\n    _triggerEvent: function(eventName, values) {\n      this.trigger(eventName, values, this);\n    }\n  })\n","\n/**\n *  Color form view\n *\n *  - It is used in 'Marker fill', 'Polygon fill',...\n *\n */\n\ncdb.forms.Color = cdb.core.View.extend({\n  className: 'form-view form_color',\n\n  events: {\n    'click .image-picker' : '_openImagePicker',\n    'click .color-picker' : '_openColorPicker'\n  },\n\n  initialize: function() {\n    this.template = cdb.templates.getTemplate('old_common/views/color_form');\n    this.property = this.options.property;\n    this.model.bind('change', this.render, this);\n    this.image_property = this.options.extra ? this.options.extra.image_property: null;\n    this.image_kind = this.options.extra ? this.options.extra.image_kind: null;\n    this.image_kind = this.image_kind || 'marker';\n  },\n\n  render: function() {\n    this.$el.html(\n      this.template({\n        image_kind:     this.image_kind,\n        image_property: this.image_property,\n        image_value:    this.model.get(this.image_property),\n        color:          this.model.get(this.property)\n      })\n    );\n\n    if (this.image_property)\n      this._createTooltips();\n\n    return this;\n  },\n\n  _createTooltips: function() {\n    this.addView(new cdb.common.TipsyTooltip({\n      el: this.$(\".image-picker\"),\n      delayIn:  100\n    }));\n  },\n\n  _createPicker: function() {\n\n    var tick, vertical_position, horizontal_position;\n\n    if (this.options.extra) {\n\n      if (this.options.extra.tick) {\n        tick   = this.options.extra.tick;\n      }\n\n      if (this.options.extra.picker_vertical_position) {\n        vertical_position   = this.options.extra.picker_vertical_position;\n      }\n\n      if (this.options.extra.picker_horizontal_position) {\n        horizontal_position = this.options.extra.picker_horizontal_position;\n      }\n    }\n\n    this.color_picker = new cdb.admin.ColorPicker({\n\n      target: this.$el,\n      colors: this.options.colors,\n      extra_colors: this.options.extra_colors,\n      tick: tick,\n      vertical_position: vertical_position,\n      horizontal_position: horizontal_position\n\n    }).bind(\"colorChosen\", function(color, close) {\n\n      if (this.image_property == this.property) {\n        this.model.set(this.property, color);\n      } else {\n        this.model.unset(this.image_property, { silent: true });\n        this.model.set(this.property, color);\n      }\n\n      if (close) this._destroyPicker();\n\n    }, this);\n\n    this._bindColorPicker();\n    this.addView(this.color_picker);\n  },\n\n  _destroyPicker: function() {\n    if (this.color_picker) {\n      this._unbindColorPicker();\n      this.removeView(this.color_picker);\n      this.color_picker.hide();\n      delete this.color_picker;\n    }\n  },\n\n  _bindColorPicker: function() {\n    cdb.god.bind(\"closeDialogs\",        this._destroyPicker, this);\n    cdb.god.bind(\"closeDialogs:color\",  this._destroyPicker, this);\n  },\n\n  _unbindColorPicker: function() {\n    cdb.god.unbind(\"closeDialogs\",        this._destroyPicker, this);\n    cdb.god.unbind(\"closeDialogs:color\",  this._destroyPicker, this);\n  },\n\n  setExtraColors: function(colors) {\n    if (this.color_picker)\n      this.color_picker.setColors('extra_colors', colors);\n  },\n  setColors: function(colors) {\n    if (this.color_picker)\n      this.color_picker.setColors('colors', colors);\n  },\n\n  _openImagePicker: function(e) {\n    this.killEvent(e);\n\n    if (!this.image_property) return this;\n\n    cdb.god.trigger(\"closeDialogs:color\");\n\n    this.user = new cdb.admin.User(window.user_data);\n\n    var dialog = new cdb.editor.ImagePickerView({\n      user: this.user,\n      kind: this.image_kind\n    });\n    dialog.appendToBody();\n    dialog.bind('fileChosen', this._onImageFileChosen, this);\n  },\n\n  _onImageFileChosen: function(url) {\n    if (this.image_property) {\n      if (this.image_property !== this.property) {\n        this.model.unset(this.property, { silent: true });\n      }\n      this.model.set(this.image_property, 'url(' + url + ')');\n    }\n  },\n\n  _openColorPicker: function(e) {\n    this.killEvent(e);\n\n    if (this.color_picker) this._destroyPicker();\n\n    cdb.god.trigger(\"closeDialogs:color\");\n\n    if (!this.color_picker) {\n      this._createPicker();\n      $('body').append(this.color_picker.render().el);\n      this.color_picker.init(this.model.get(this.property));\n    }\n  }\n\n});\n\n\n/**\n *  Color widget with color picker showing\n *  all colors applied in the style.\n */\ncdb.forms.ColorWizard = cdb.forms.Color.extend({\n\n  _createPicker: function() {\n    // Get wizard applied colors\n    if (this.model.layer && this.model.layer.get('tile_style')) {\n      var style = this.model.layer.get(\"tile_style\");\n      var cartoParser = new cdb.admin.CartoParser(style);\n      this.options.extra_colors = cartoParser.colorsUsed({ mode: \"hex\" });\n    }\n\n    cdb.forms.Color.prototype._createPicker.call(this);\n  },\n\n});\n\n\n/**\n * dummy view for hidden fields\n */\ncdb.forms.Hidden = cdb.core.View.extend({\n  className: 'form-view form_hidden',\n  initialize: function() {\n    this.add_related_model(this.model);\n  }\n});\n\n\ncdb.forms.SimpleNumber = cdb.core.View.extend({\n\n  className: 'form-view form_spinner',\n\n  defaults: {\n    max: 999999999999,\n    min: -999999999999,\n    inc: 1,\n    width: 25,\n    pattern: /^-?[0-9]+\\.?[0-9]*$/,\n    debounce_time: 200,\n    disable_triggering: false\n  },\n\n  events: {\n    'click .plus': '_plus',\n    'click .minus': '_minus',\n    'keypress input.value': '_checkInputPress',\n    'keydown input.value': '_checkInputPress',\n    'keyup input.value': '_checkInputUp',\n    'change .value': '_checkValueChange',\n    'click': '_showSlider'\n  },\n\n  initialize: function() {\n    _.bindAll(this, '_fireChange', '_checkNumber');\n    this.property = this.options.property;\n    this.model.bind('change', this.render, this);\n\n    // Check pattern, if it is empty or not valid,\n    // delete the option before extending defaults\n    if (!this.options.pattern ||\n        typeof this.options.pattern !== \"object\" ||\n        (typeof this.options.pattern === \"object\" && !this.options.pattern.test)\n      )\n    {\n      delete this.options.pattern;\n    }\n\n    _.defaults(this.options, this.defaults);\n\n    // Create slider\n    if(!this.options.noSlider) {\n      this._initSlider();\n    }\n\n    if(this.options.debounce_time > 0) {\n      this._fireChange = _.debounce(this._fireChange, this.options.debounce_time);\n    }\n  },\n\n  render: function(prop) {\n    var value = this.options.initValue || this.model.get(this.property);\n\n    if (prop && _.isNumber(prop)) {\n      value = prop;\n    }\n\n    this.$el.html('<input class=\"value\" ' + (this.options.disabled ? 'readonly' : '') + ' value=\"\" style=\"width:' + (this.options.width) + 'px!important\"/><a href=\"#\" class=\"plus\">+</a><a href=\"#\" class=\"minus\">-</a>');\n    this.$('.value').val(value);\n\n    if (this.options.classes) this.$el.addClass(this.options.classes);\n\n    if (this.options.disabled) {\n      this.undelegateEvents();\n      this.$el\n      .addClass('disabled')\n      .find('a').bind('click', this.killEvent);\n    }\n\n    return this;\n  },\n\n  _fireChange: function() {\n    this.model.change();\n  },\n\n  _changeValue: function(a) {\n    this.model.set(a, { silent: true });\n    this._fireChange();\n  },\n\n  inc: function(c) {\n    var a = {};\n    var v = a[this.property] = parseFloat(this.model.get(this.property)) + c;\n    v = a[this.property] = Math.min(this.options.max, v.toFixed? v.toFixed(1): 1*v);\n    a[this.property] = Math.max(this.options.min, v);\n    this._changeValue(a);\n    // don't wait to be notified by model, render as fast as the user changes the value\n    this.render(a[this.property]);\n  },\n\n  _plus: function(e) {\n    e && e.preventDefault();\n    this.trigger(\"saved\", this);\n    this.inc(this.options.inc);\n    return false;\n  },\n\n  _minus: function(e) {\n    e && e.preventDefault();\n    this.trigger(\"saved\", this);\n    this.inc(-this.options.inc);\n    return false;\n  },\n\n  _initSlider: function() {\n    var self = this;\n\n    this.spinner_slider = new cdb.admin.SpinnerSlider({\n      target: this.$el,\n      template_base: 'old_common/views/spinner_slider'\n    }).bind(\"valueSet\", function(value) {\n      // Set new model\n      var a = {};\n      a[self.property] = value;\n      self.model.set(a);\n    }).bind(\"valueChanged\", function(value) {\n      // Set new value\n      self.$el.find(\".value\").val(value);\n    });\n    this.addView(this.spinner_slider);\n  },\n\n  _checkNumber: function(number) {\n    return this.options.pattern.test(number);\n  },\n\n  _checkInputPress: function(ev) {\n    var newChar = String.fromCharCode(ev.charCode);\n\n    if(newChar == '-' || newChar == '.' || 1*newChar !== NaN) {\n      return true;\n    } else {\n      ev.preventDefault();\n      ev.stopPropagation();\n      return false;\n    }\n  },\n\n  _checkInputUp: function(ev) {\n    this.value? null : this.value = this.model.get(this.property);\n    var number = $(ev.target).val();\n\n    if (ev.keyCode == 40) {\n      ev.preventDefault();\n      ev.stopPropagation();\n      this.inc(-this.options.inc);\n      this._saveValue(ev);\n      this.$el.find(\"input\").focus();\n      return false;\n    }\n\n    if (ev.keyCode == 38) {\n      ev.preventDefault();\n      ev.stopPropagation();\n      this.inc(this.options.inc);\n      this._saveValue(ev);\n      this.$el.find(\"input\").focus();\n      return false;\n    }\n\n    // If it is an ENTER -> saves!\n    if (ev.keyCode === 13) {\n      this._saveValue(ev, true);\n      return false;\n    }\n    // If not, check the key\n    if (!this._checkNumber(number) && number != '-' && number != '') {\n      this.$el.find(\"input.value\").val(this.value);\n      // ev.stopPropagation();\n      // ev.preventDefault();\n    } else {\n      if(number != '-' && number != '') {\n        this.value = $(ev.target).val();\n      }\n    }\n    return true;\n  },\n\n  _checkValueChange: function(ev) {\n    var number = $(ev.target).val();\n    number = (number == '' || number == '-')? 0 : 1*number\n    if (!this._checkNumber(number)) {\n      this.$el.find(\"input.value\").val(this.value);\n    } else {\n      this._saveValue(ev, true);\n      this.value = $(ev.target).val();\n    }\n    return true;\n  },\n\n  _saveValue: function(ev, close) {\n    var a = {};\n    var val = this.$el.find(\"input.value\").val()\n    var baseNumber = (this.options.min < 0 && this.options.max > 0)?\n      0:\n      this.options.min;\n\n    var number = (val == '' || val == '-') ? baseNumber : 1*val;\n\n    if (number < this.options.min) number = this.options.min;\n    if (number > this.options.max) number = this.options.max;\n\n    this.$el.find(\"input.value\").val(number);\n\n    a[this.property] = number;\n    this.model.set(a);\n\n    this.trigger(\"saved\", this);\n\n    if (close && !this.options.disable_triggering) {\n      cdb.god.trigger(\"closeDialogs\");\n    }\n  },\n\n  _showSlider: function(ev) {\n    ev.preventDefault();\n    ev.stopPropagation();\n\n    this.$el.find(\"input\").focus();\n\n  }\n});\n\ncdb.forms.SimpleNumberWithLabel = cdb.forms.SimpleNumber.extend({\n\n  className: 'form-view form_spinner with-label',\n\n  render: function(prop) {\n    var value = this.options.initValue || this.model.get(this.property);\n\n    if (prop && _.isNumber(prop)) {\n      value = prop;\n    }\n\n    this.$el.html(\n      this.getTemplate('old_common/forms/widget_simple_number_with_label')({\n        label: this.options.label,\n        isDisabled: this.options.disabled,\n        width: this.options.width\n      })\n    );\n    this.$('.value').val(value);\n\n    if (this.options.classes) this.$el.addClass(this.options.classes);\n\n    if (this.options.disabled) {\n      this.undelegateEvents();\n      this.$el\n      .addClass('disabled')\n      .find('a').bind('click', this.killEvent);\n    }\n\n    return this;\n  }\n\n});\n\ncdb.forms.Spinner = cdb.core.View.extend({\n  className: 'form-view form_spinner',\n\n  defaults: {\n    max: 999999999999,\n    min: -999999999999,\n    inc: 1,\n    width: 25,\n    pattern: /^-?[0-9]+\\.?[0-9]*$/,\n    debounce_time: 200\n  },\n\n  events: {\n    'click .plus': '_plus',\n    'click .minus': '_minus',\n    'keypress input.value': '_checkInputPress',\n    'keydown input.value': '_checkInputPress',\n    'keyup input.value': '_checkInputUp',\n    'change .value': '_checkValueChange',\n    'click': '_showSlider'\n  },\n\n  initialize: function() {\n    _.bindAll(this, '_fireChange', '_checkNumber');\n    this.property = this.options.property;\n    this.model.bind('change', this.render, this);\n\n    // Check pattern, if it is empty or not valid,\n    // delete the option before extending defaults\n    if (!this.options.pattern ||\n        typeof this.options.pattern !== \"object\" ||\n        (typeof this.options.pattern === \"object\" && !this.options.pattern.test)\n      )\n    {\n      delete this.options.pattern;\n    }\n\n    _.defaults(this.options, this.defaults);\n\n    // Create slider\n    if(!this.options.noSlider) {\n      this._initSlider();\n    }\n\n    if(this.options.debounce_time > 0) {\n      this._fireChange = _.debounce(this._fireChange, this.options.debounce_time);\n    }\n  },\n\n  render: function(prop) {\n    var value = this.options.initValue || this.model.get(this.property);\n\n    if (prop && _.isNumber(prop)) {\n      value = prop;\n    }\n\n    this.$el.html('<input class=\"value\" ' + (this.options.disabled ? 'readonly' : '') + ' value=\"\" style=\"width:' + (this.options.width) + 'px!important\"/><a href=\"#\" class=\"plus\">+</a><a href=\"#\" class=\"minus\">-</a>');\n    this.$('.value').val(value);\n\n    if (this.options.disabled) {\n      this.undelegateEvents();\n      this.$el\n      .addClass('disabled')\n      .find('a').bind('click', this.killEvent);\n    }\n\n    return this;\n  },\n\n  _fireChange: function() {\n    this.model.change();\n  },\n\n  _changeValue: function(a) {\n    this.model.set(a, { silent: true });\n    this._fireChange();\n  },\n\n  inc: function(c) {\n    var a = {};\n    var v = a[this.property] = this.model.get(this.property) + c;\n    v = a[this.property] = Math.min(this.options.max, v.toFixed? v.toFixed(1): 1*v);\n    a[this.property] = Math.max(this.options.min, v);\n    this._changeValue(a);\n    // don't wait to be notified by model, render as fast as the user changes the value\n    this.render(a[this.property]);\n  },\n\n  _plus: function(e) {\n    e && e.preventDefault();\n    this.inc(this.options.inc);\n    return false;\n  },\n\n  _minus: function(e) {\n    e && e.preventDefault();\n    this.inc(-this.options.inc);\n    return false;\n  },\n\n  _initSlider: function() {\n    var self = this;\n\n    this.spinner_slider = new cdb.admin.SpinnerSlider({\n      target: this.$el,\n      template_base: 'old_common/views/spinner_slider'\n    }).bind(\"valueSet\", function(value) {\n      // Set new model\n      var a = {};\n      a[self.property] = value;\n      self.model.set(a);\n    }).bind(\"valueChanged\", function(value) {\n      // Set new value\n      self.$el.find(\".value\").val(value);\n    });\n    this.addView(this.spinner_slider);\n  },\n\n  _checkNumber: function(number) {\n    return this.options.pattern.test(number);\n  },\n\n  _checkInputPress: function(ev) {\n    var newChar = String.fromCharCode(ev.charCode);\n\n    if(newChar == '-' || newChar == '.' || 1*newChar !== NaN) {\n      return true;\n    } else {\n      ev.preventDefault();\n      ev.stopPropagation();\n      return false;\n    }\n  },\n\n  _checkInputUp: function(ev) {\n    this.value? null : this.value = this.model.get(this.property);\n    var number = $(ev.target).val();\n\n    // If it is an ENTER -> saves!\n    if (ev.keyCode === 13) {\n      this._saveValue(ev);\n      return false;\n    }\n\n    // If not, check the key\n    if (!this._checkNumber(number) && number != '-' && number != '') {\n      this.$el.find(\"input.value\").val(this.value);\n      // ev.stopPropagation();\n      // ev.preventDefault();\n    } else {\n      if(number != '-' && number != '') {\n        this.value = $(ev.target).val();\n      }\n    }\n    return true;\n  },\n\n  _checkValueChange: function(ev) {\n    var number = $(ev.target).val();\n    number = (number == '' || number == '-')? 0 : 1*number\n    if (!this._checkNumber(number)) {\n      this.$el.find(\"input.value\").val(this.value);\n    } else {\n      this._saveValue(ev);\n      this.value = $(ev.target).val();\n    }\n    return true;\n  },\n\n  _saveValue: function(ev) {\n    var a = {};\n    var val = this.$el.find(\"input.value\").val()\n    var baseNumber = (this.options.min < 0 && this.options.max > 0)?\n      0:\n      this.options.min;\n\n    var number = (val == '' || val == '-') ? baseNumber : 1*val;\n\n    this.$el.find(\"input.value\").val(number);\n\n    a[this.property] = number;\n    this.model.set(a);\n\n    cdb.god.trigger(\"closeDialogs\");\n  },\n\n  _showSlider: function(ev) {\n    if(!this.options.noSlider) {\n      ev.stopPropagation();\n\n      cdb.god.unbind(\"closeDialogs\", this.spinner_slider.hide, this.spinner_slider);\n      cdb.god.trigger(\"closeDialogs\");\n\n      if (!this.spinner_slider.el.parentElement) {\n        $('body').append(this.spinner_slider.render().el);\n\n        this.spinner_slider.init(this.options.max, this.options.min, this.options.inc, this.$el.find(\"input.value\").val());\n\n        cdb.god.bind(\"closeDialogs\", this.spinner_slider.hide, this.spinner_slider);\n        cdb.god.bind(\"closeDialogs:color\", this.spinner_slider.hide, this.spinner_slider);\n      }\n\n      this.$el.find(\"input.value\").focus();\n    }\n  }\n});\n\ncdb.forms.Opacity = cdb.forms.Spinner.extend({\n  initialize: function() {\n    _.defaults(this.options, {\n      max: 1, min: 0, inc: 0.1\n    });\n    // Added correct class to the spinner\n    this.$el.addClass(\"opacity\");\n\n    cdb.forms.Spinner.prototype.initialize.call(this);\n  }\n});\n\ncdb.forms.SimpleOpacity = cdb.forms.SimpleNumber.extend({\n  initialize: function() {\n    _.defaults(this.options, {\n      max: 1, min: 0, inc: 0.1\n    });\n    // Added correct class to the spinner\n    this.$el.addClass(\"opacity\");\n\n    cdb.forms.Spinner.prototype.initialize.call(this);\n  }\n});\n\n// same as Opacity but manages the case when the cartocss\n// contains a polygon-pattern\ncdb.forms.OpacityPolygon = cdb.forms.Spinner.extend({\n  initialize: function() {\n    _.defaults(this.options, {\n      max: 1, min: 0, inc: 0.1\n    });\n    // Added correct class to the spinner\n    this.$el.addClass(\"opacity\");\n\n    this.model.bind('change', function() {\n      this.switchProperty();\n    }, this);\n\n    cdb.forms.Spinner.prototype.initialize.call(this);\n    //this.switchProperty();\n\n  },\n\n  switchProperty: function() {\n    if(this.model.get('polygon-pattern-file')) {\n      if(!this.originalProperty) {\n        this.originalProperty = this.property;\n        this.property = 'polygon-pattern-opacity';\n        var val = this.model.get(this.property);\n        this.model.set(this.property, val === undefined ? this.model.get(this.originalProperty): val);\n        this.model.unset(this.originalProperty);\n      }\n    } else {\n      if(this.property === 'polygon-pattern-opacity') {\n        this.property = this.originalProperty;\n        this.originalProperty = null;\n        this.model.set(this.property, this.model.get('polygon-pattern-opacity'));\n        this.model.unset('polygon-pattern-opacity');\n      }\n    }\n  }\n\n\n});\n\ncdb.forms.Width = cdb.forms.Spinner.extend({\n  initialize: function() {\n    _.defaults(this.options, {\n      max: 40, min: 0, inc: 0.5\n    });\n    cdb.forms.Spinner.prototype.initialize.call(this);\n  }\n});\n\n\ncdb.forms.Combo = cdb.core.View.extend({\n\n  className: 'form-view form_combo',\n\n  options: {\n    minimumResultsForSearch: 20,\n    placeholder: '',\n    formatResult: false,\n    formatSelection: false,\n    matcher: false,\n    dropdownCssClass: ''\n  },\n\n  events: {\n    'change select': '_changeSelection'\n  },\n\n  initialize: function() {\n\n    _.bindAll(this, \"_onUpdate\", \"_changeSelection\");\n\n    this.data        = this.options.extra;\n\n\n    if (this.model) {\n      this.add_related_model(this.model);\n      this.model.bind(\"change:\" + this.options.property, this._onUpdate, this);\n    }\n\n  },\n\n  deselect: function() {\n    this.$el.find(\"select\").val(\"\").change();\n  },\n\n  updateData: function(data) {\n\n    this.data = data;\n    this._onUpdate();\n\n  },\n\n  _onUpdate: function() {\n\n    this.render();\n\n  },\n\n  _getOptions: function() {\n\n    var options = _.map(this.data, function(option) {\n\n      if (_.isArray(option)) {\n        return '<option value=\"' + option[1] + '\">' + option[0] + '</option>';\n      } else {\n        return '<option>' + option + '</option>';\n      }\n\n    }).join(\"\");\n\n    if (this.options.placeholder) options = \"<option></option>\" + options;\n\n    return options;\n\n  },\n\n  _setValue: function(value) {\n\n    this.$select.val(value);\n\n  },\n\n  render: function() {\n\n    var self = this;\n\n    // Options\n    this.$select = $('<select>' + this._getOptions() + '</select>');\n\n    // Method\n    var method = this.model && this.model.get(\"method\") && this.model.get(\"method\").replace(/ /g,\"_\").toLowerCase();\n\n    // Attributes\n    this.$select.attr({\n      style: (this.options.width ? \"width:\" + this.options.width  : '')\n    });\n\n    this.$select.addClass(this.options.property + (method ? ' ' + method : ''));\n\n    // Disabled?\n    if (this.options.disabled) this.$select.attr(\"disabled\", '');\n\n    // Sets the value\n    this._setValue(this.model && this.model.get(this.options.property) || this.options.property);\n\n    // Append\n    this.$el.html(this.$select);\n\n    // Apply select2, but before destroy the bindings\n    if (!this.options || !this.options.plainSelect) {\n\n      var $select = this.$(\"select\");\n      $select.select2(\"destroy\");\n\n      var combo_options = {\n        minimumResultsForSearch:  this.options.minimumResultsForSearch,\n        placeholder:              this.options.placeholder,\n        dropdownCssClass:         this.options.dropdownCssClass\n      };\n\n      if (this.options.formatResult)\n        combo_options.formatResult = this._formatResult;\n\n      if (this.options.formatSelection)\n        combo_options.formatSelection = this._formatSelection;\n\n      if (this.options.matcher)\n        combo_options.matcher = this._matcher;\n\n      $select.select2(combo_options);\n    }\n\n    return this;\n  },\n\n  _changeSelection: function(e) {\n    var a = {};\n\n    var val = this.$('select').val();\n\n    a[this.options.property] = val;\n\n    if (this.model) {\n      if (val) this.model.set(a);\n      else this.model.set(a, { silent: true });\n    }\n\n    // Send trigger\n    if (val) this.trigger('change', a[this.options.property]);\n  },\n\n  _formatResult: function(data) {\n    return data.id || data.text;\n  },\n\n  _matcher: function(term, text, option) {\n    return text.toUpperCase().indexOf(term.toUpperCase())>=0;\n  },\n\n  clean: function() {\n    this.$select.select2(\"destroy\");\n    cdb.core.View.prototype.clean.call(this);\n  }\n\n});\n\ncdb.forms.Switch = cdb.core.View.extend({\n\n  events: {\n    'click': '_onClick'\n  },\n\n  tagName: 'a',\n  className: 'form-view form_switch',\n\n  initialize: function() {\n    this.property = this.options.property;\n    this.model.bind('change:' + this.property, this._change, this);\n  },\n\n  _onClick: function(e) {\n    e.preventDefault();\n\n    if (!this.$el.hasClass(\"inactive\")) {\n\n      var a = {};\n      var value = !this.model.get(this.property);\n      a[this.property] = value;\n      this.model.set(a);\n\n      this.trigger(\"switched\", this.property, value);\n    }\n\n    return false;\n  },\n\n  _change: function() {\n    if(this.model.get(this.property)) {\n      this.$el.removeClass('disabled').addClass('enabled');\n    } else {\n      this.$el.removeClass('enabled').addClass('disabled');\n    }\n  },\n\n  render: function() {\n    this.$el.append(\"<span class='handle'></span>\");\n    this._change();\n    return this;\n  }\n\n});\n\ncdb.forms.TextAlign = cdb.core.View.extend({\n\n  className: 'form-view form_align',\n\n  defaults: {\n    debounce_time: 200\n  },\n\n  events: {\n    'click .align': '_align'\n  },\n\n  initialize: function() {\n\n    _.bindAll(this, '_fireChange');\n\n    this.property = this.options.property;\n\n    this.template = cdb.templates.getTemplate('old_common/views/text_align');\n\n    this.model.bind('change', this.render, this);\n\n    // Check pattern, if it is empty or not valid,\n    // delete the option before extending defaults\n    if (!this.options.pattern ||\n        typeof this.options.pattern !== \"object\" ||\n        (typeof this.options.pattern === \"object\" && !this.options.pattern.test)\n      )\n    {\n      delete this.options.pattern;\n    }\n\n    _.defaults(this.options, this.defaults);\n\n    if(this.options.debounce_time > 0) {\n      this._fireChange = _.debounce(this._fireChange, this.options.debounce_time);\n    }\n  },\n\n  _fireChange: function() {\n    this.model.change();\n  },\n\n  _align: function(e) {\n\n    e && e.preventDefault();\n\n    var align = $(e.target).attr(\"data-align\");\n\n    var a = {};\n\n    a[this.property] = align;\n\n    this.model.set(a, { silent: true });\n    this._fireChange();\n\n  },\n\n  render: function(prop) {\n\n    var value = this.options.initValue || this.model.get(this.property);\n\n    var alignments = this.options.alignments || {};\n\n    var left   = alignments.left   === undefined ? true : alignments.left;\n    var right  = alignments.right  === undefined ? true : alignments.right;\n    var center = alignments.center === undefined ? true : alignments.center;\n\n    this.$el.html(this.template({ left: left, right: right, center: center }));\n\n    this.$el.find(\"a[data-align='\"+ value +\"']\").addClass(\"selected\");\n\n    if (this.options.disabled) {\n      this.undelegateEvents();\n      this.$el\n      .addClass('disabled')\n      .find('a').bind('click', this.killEvent);\n    }\n\n    return this;\n  },\n\n\n});\n","cdb.admin.overlays.Text = cdb.geo.ui.Text.extend({\n\n  className: \"text overlay snap\",\n\n  template_name: 'table/views/overlays/text',\n\n  events: {\n\n    \"mouseenter .text\":  \"_onMouseEnter\",\n\n    \"click .close\":      \"_close\",\n    \"click .content\":    \"_onClickEdit\",\n    \"click .text\":       \"_onClickEdit\",\n    \"dblclick .content\": \"_onDblClick\",\n    \"dblclick .text\":    \"_onDblClick\",\n\n    \"keyup .text\":       \"_onKeyUp\",\n    \"paste .text\":       \"_onPaste\"\n\n  },\n\n  form_data: [{\n    name: 'Text',\n    form: {\n      'font-size':  { type: 'simple_number', value: 12, min: 5, max: 50, inc: 2, disable_triggering: true },\n      'color':      { type: 'color', value: '#FFF', extra: { tick: \"left\", picker_horizontal_position: \"left\", picker_vertical_position: \"down\" }},\n      'font-family-name': {\n        type: 'select',\n        value: \"Helvetica\",\n        extra: [\"Helvetica\", \"Droid Sans\", \"Vollkorn\", \"Roboto\", \"Open Sans\", \"Lato\", \"Graduate\", \"Gravitas One\", \"Old Standard TT\"]\n\n      },\n      'text-align':      { type: 'text_align', value: 'left' }\n    }\n  }, {\n    name: 'Box',\n    form: {\n      'box-color':   { type: 'color', value: '#000', extra: { tick: \"left\", picker_horizontal_position: \"left\", picker_vertical_position: \"down\" }},\n      'box-opacity': { type: 'simple_opacity', value: .7, min:0, max:1, inc: .1, disable_triggering: true },\n      'box-padding': { type: 'simple_number_with_label', value: 10, min: 5, max: 200, inc: 1, label: \"P\", disable_triggering: true }\n    }\n  }, {\n    name: 'Max Width',\n    form: {\n      'box-width':  { type: 'simple_number', value: 300, min: 50, max: 2000, inc: 10, disable_triggering: true },\n    }\n  }],\n\n  initialize: function() {\n\n    _.bindAll(this, \"_close\", \"_onChangeMode\", \"_onKeyDown\");\n\n    this.template = this.getTemplate(this.template_name);\n\n    this._setupModels();\n\n  },\n\n  // Setup the internal and custom model\n  _setupModels: function() {\n\n    var self  = this;\n    var extra = this.model.get(\"extra\");\n\n    this.model.set({ text: extra.text }, { silent: true });\n\n    var applyStyle = function() {\n      self._applyStyle(true);\n    };\n\n    // Binding\n    this.model.bind('remove',   this.hide, this);\n\n    this.model.bind('change:style',   applyStyle,            this);\n    this.model.bind('change:text',    this._setText,         this);\n    this.model.bind('change:display', this._onChangeDisplay, this);\n    this.model.bind('change:extra',   this._onChangeExtra,   this);\n    this.model.bind('change:selected', this._onChangeSelected, this);\n\n    // Internal model to store the editing state\n    this.editModel = new cdb.core.Model({ mode: \"\" });\n    this.editModel.bind('change:mode', this._onChangeMode, this);\n\n    this.add_related_model(this.editModel);\n\n  },\n\n  // Element events \n  _onKeyUp: function(e) {\n\n    if (this.timeout) {\n      clearTimeout(this.timeout);\n    }\n\n    this.model.set({ text: this.$text.html() }, { silent: true });\n\n  },\n\n  _onClickEdit: function(e) {\n\n    this.killEvent(e);\n\n    cdb.god.trigger(\"closeOverlayDropdown\");\n\n    $(document).bind('keydown', this._onKeyDown);\n\n    this._savePosition(false);\n\n    this.trigger(\"clickEdit\", this.model, this.form_data);\n\n    this.model.set(\"selected\", true);\n\n  },\n\n  _onKeyDown: function(e) {\n\n    var selected = this.model.get(\"selected\");\n\n    if (selected) {\n      var editable = this.editModel.get(\"mode\") == \"editable\";\n      var focus    = this.$(\".overlay_text\").is(\":focus\");\n\n      // hitting the backspace removes the overlay\n      if ($(e.target).hasClass(\"overlay_text\") || $(e.target).hasClass(\"cartodb-map\")) {\n        if (e.keyCode === $.ui.keyCode.BACKSPACE && (!editable || !focus)) {\n          this.killEvent(e);\n          this._close();\n        }\n      }\n\n      if (!focus) {\n        if (e.which == 67 && (e.ctrlKey || e.metaKey)) {\n          this.trigger('duplicate', this.model, this);\n        }\n      }\n    }\n\n    if (e.keyCode === $.ui.keyCode.ESCAPE) { \n      this.editModel.set(\"mode\", \"\");\n    }\n\n  },\n\n  _onPaste: function(e) {\n\n    var self = this;\n\n    setTimeout(function() {\n\n      var text = cdb.Utils.stripHTML(self.model.get(\"text\"));\n      self.model.set(\"text\", text)\n\n    }, 200);\n\n  },\n\n  _onDblClick: function(e) {\n\n    this.killEvent(e);\n    this._savePosition(true);\n\n  },\n\n  _savePosition: function(editable) {\n\n    var extra = this.model.get(\"extra\");\n\n    var x     = this.model.get(\"x\");\n    var y     = this.model.get(\"y\");\n\n    var oldX  = this.$el.position().left;\n    var oldY  = this.$el.position().top;\n\n    var portrait_direction  = extra.portrait_dominant_side;\n    var landscape_direction = extra.landscape_dominant_side;\n\n    if (y === 0 && portrait_dominant_side === \"bottom\") oldY = y;\n    if (x === 0 && landscape_dominant_side === \"right\") oldX = x;\n\n    var moved = true;\n      // If we didn't move the overlay\n   if (oldX === x && y === oldY || x === 0 && landscape_dominant_side === \"right\" && y === oldY || y == 0 && portrait_dominant_side === \"bottom\" && oldX === x) {\n\n      moved = false;\n\n      this.$el.addClass(\"selected\");\n\n      if (editable) {\n        this.editModel.set(\"mode\", \"editable\");\n        return;\n      }\n\n    }\n\n    x = this.$el.position().left;\n    y = this.$el.position().top;\n\n    var width  = this.$el.width();\n    var height = this.$el.height();\n\n    var right  = $(\".cartodb-map\").width()  - x;\n    var bottom = $(\".cartodb-map\").height() - y;\n\n    var right_position          = right  - width;\n    var bottom_position         = bottom - height;\n\n    var map_width               = $(\".cartodb-map\").width();\n    var map_height              = $(\".cartodb-map\").width();\n\n    var left_percentage         = (x + (width/2))  / map_width  * 100;\n    var top_percentage          = (y + (height/2)) / map_height * 100;\n\n    var landscape_dominant_side = x <= right_position ? \"left\" : \"right\";\n    var portrait_dominant_side  = y <= bottom_position ? \"top\" : \"bottom\";\n\n    // Default positions\n    extra.default_position        = false;\n    extra.landscape_dominant_side = landscape_dominant_side;\n    extra.portrait_dominant_side  = portrait_dominant_side;\n    extra.top_percentage          = top_percentage;\n    extra.left_percentage         = left_percentage;\n    extra.right_position          = right_position;\n    extra.bottom_position         = bottom_position;\n    extra.right                   = right;\n    extra.bottom                  = bottom;\n    extra.width                   = width;\n    extra.height                  = height;\n\n    this.model.set({ extra: extra }, { silent: true});\n    this.model.set({ x: x, y: y });\n\n    if (moved) {\n      this.model.save();\n    }\n\n  },\n\n  _onMouseDown: function() { },\n\n  _onMouseEnter: function() {\n\n    this.$el.addClass(\"hover\");\n\n    if (this.editModel.get(\"mode\") === \"editable\") {\n      if (this.timeout) clearTimeout(this.timeout);\n    }\n\n  },\n\n  show: function(animated) {\n\n    this.$el.show();\n\n    if (true) this.$el.addClass('animated bounceIn');\n\n  },\n\n  hide: function(callback) {\n\n    var self = this;\n\n    this.$el\n    .removeClass('animated bounceIn')\n    .addClass('animated bounceOut')\n    .removeClass('selected');\n\n    callback && _.isFunction(callback) && callback();\n\n    $(document).unbind('keydown', this._onKeyDown);\n\n    cdb.god.unbind(\"closeDialogs\", this._onCloseDialogs, this);\n\n    // Give it some time to complete the animation\n    setTimeout(function() {\n      self.clean();\n    }, 550);\n\n  },\n\n  _close: function(e) {\n\n    this.killEvent(e);\n\n    var self = this;\n\n    this.hide(function() {\n      self.trigger(\"remove\", self);\n    });\n\n  },\n\n  _onChangeDisplay: function() {\n\n    var display = this.model.get(\"display\");\n\n    if (display) {\n      this.show();\n    } else {\n      this.$el.hide();\n    }\n\n  },\n\n  _onChangeExtra: function() {\n\n    var extra  = this.model.get(\"extra\");\n    extra.text = this.model.get(\"text\");\n\n    this.model.set({ extra: extra }, { silent: true });\n\n  },\n\n  /*\n   * Applies style to the content of the widget\n   */\n\n  _applyStyle: function(save) {\n\n    var style      = this.model.get(\"style\");\n\n    var boxColor   = style[\"box-color\"];\n    var boxOpacity = style[\"box-opacity\"];\n    var boxWidth   = style[\"box-width\"];\n    var boxPadding = style[\"box-padding\"];\n\n    var fontFamily = style[\"font-family-name\"];\n\n    this.$text.css(style);\n\n    this.$(\".content\").css(\"padding\", boxPadding);\n    this.$text.css(\"font-size\", style[\"font-size\"] + \"px\");\n    this.$el.css(\"z-index\", style[\"z-index\"]);\n\n    var rgbaCol = 'rgba(' + parseInt(boxColor.slice(-6,-4),16)\n    + ',' + parseInt(boxColor.slice(-4,-2),16)\n    + ',' + parseInt(boxColor.slice(-2),16)\n    +', ' + boxOpacity + ' )';\n\n    this.$el.css(\"background-color\", rgbaCol);\n    this.$el.css(\"max-width\", boxWidth);\n\n    var fontFamilyClass = \"\";\n\n    if      (fontFamily  == \"Droid Sans\")       fontFamilyClass = \"droid\";\n    else if (fontFamily  == \"Vollkorn\")         fontFamilyClass = \"vollkorn\";\n    else if (fontFamily  == \"Open Sans\")        fontFamilyClass = \"open_sans\";\n    else if (fontFamily  == \"Roboto\")           fontFamilyClass = \"roboto\";\n    else if (fontFamily  == \"Lato\")             fontFamilyClass = \"lato\";\n    else if (fontFamily  == \"Graduate\")         fontFamilyClass = \"graduate\";\n    else if (fontFamily  == \"Gravitas One\")     fontFamilyClass = \"gravitas_one\";\n    else if (fontFamily  == \"Old Standard TT\")  fontFamilyClass = \"old_standard_tt\";\n    this.$el.css(\"width\", \"auto\");\n\n    this.$el\n    .removeClass(\"droid\")\n    .removeClass(\"vollkorn\")\n    .removeClass(\"roboto\")\n    .removeClass(\"open_sans\")\n    .removeClass(\"lato\")\n    .removeClass(\"graduate\")\n    .removeClass(\"gravitas_one\")\n    .removeClass(\"old_standard_tt\");\n\n    this.$el.addClass(fontFamilyClass);\n\n    if (save) this.model.save();\n\n  },\n\n  _onChangeSelected: function() {\n\n    var selected = this.model.get(\"selected\");\n\n    if (selected) {\n\n      this.$el.addClass(\"selected\");\n\n    } else {\n\n      this.$el.removeClass(\"selected\");\n      this._disableEditingMode();\n\n    }\n\n  },\n\n  _onChangeMode: function() {\n\n    var mode = this.editModel.get(\"mode\");\n\n    this.trigger('editing', mode === 'editable', this);\n\n    if (mode === \"editable\") {\n      this._enableEditingMode();\n    } else {\n      this._disableEditingMode();\n    }\n\n  },\n\n  _enableEditingMode: function() {\n\n    this.$el\n    .addClass(\"editable\")\n    .addClass(\"disabled\");\n\n    this.$text.attr(\"contenteditable\", true).focus();\n\n    var style = this.model.get(\"style\");\n    var width = style[\"box-width\"];\n\n    var text = this.model.get(\"text\");\n\n    this.$el.css(\"width\", \"auto\");\n    this.$el.css(\"max-width\", width);\n    this.$text.html(text);\n    this.$(\".hint\").fadeIn(150);\n\n  },\n\n  _isEmptyText: function(text) {\n    var regexp = new RegExp(/^(<div>)*(<br ?\\/?>)*(<\\/div>)*$/);\n\n    if (text.trim() && !text.trim().match(regexp)) {\n      return false;\n    } else {\n      return true;\n    }\n  },\n\n  _disableEditingMode: function() {\n\n    $(document).unbind('keydown', this._onKeyDown);\n\n    var text = this._transformToMarkdown(this.model.get(\"text\"));\n\n    this.editModel.set(\"mode\", \"\");\n\n    if (!this._isEmptyText(text)) {\n\n      var self = this;\n\n      self.$(\".hint\").fadeOut(150, function() {\n\n        self.$el\n        .removeClass(\"editable\")\n        .removeClass(\"disabled\");\n\n        self.$text.attr(\"contenteditable\", false);\n        self.$el.css(\"width\", \"auto\");\n\n        setTimeout(function() {\n\n          var width = self.$el.width();\n          var extra = self.model.get(\"extra\");\n\n          extra.width = width;\n\n          self.model.set({ extra: extra }, { silent: true });\n\n          if (!self.model.isNew()) {\n            self.model.save();\n          }\n\n          self.$text.html(text);\n\n          self.$el.css(\"width\", \"auto\");\n\n        }, 100);\n\n        if (!self.model.isNew()) {\n          self.model.save();\n        }\n\n      });\n\n    } else {\n      this._close();\n    }\n\n  },\n\n  _setText: function() {\n\n    var text          = this.model.get(\"text\");\n    var rendered_text = this._transformToMarkdown(text);\n\n    var extra = this.model.get(\"extra\");\n\n    extra.text          = text;\n    extra.rendered_text = rendered_text\n\n    this.model.set({ extra: extra }, { silent: true });\n\n    if (rendered_text) {\n      this.$text.html(rendered_text);\n    }\n\n  },\n\n  _transformToMarkdown: function(text) {\n\n    text = markdown.toHTML(text)\n\n    text = text.replace(/&lt;/g, \"<\");\n    text = text.replace(/&gt;/g, \">\");\n    text = text.replace(/<p>/g, \"\");\n    text = text.replace(/&amp;nbsp;/g, \" \");\n    text = text.replace(/<\\/p>/g, \"\");\n\n    return text;\n\n  },\n\n  _place: function() {\n\n    var mode  = this.editModel.get(\"mode\");\n    var extra = this.model.get(\"extra\");\n\n    if (mode === \"editable\" || !extra) {\n      return;\n    }\n\n    var landscape_dominant_side = extra.landscape_dominant_side;\n    var portrait_dominant_side  = extra.portrait_dominant_side;\n\n    if (portrait_dominant_side === 'bottom') {\n\n      this.$el.offset({\n        bottom: extra.bottom_position\n      });\n\n      this.$el.css({\n        top: \"auto\",\n        bottom: extra.bottom_position\n      });\n\n    } else {\n\n      this.$el.offset({\n        top: this.model.get(\"y\"),\n        bottom: \"auto\"\n      });\n\n    }\n\n    if (landscape_dominant_side === 'right') {\n\n      this.$el.offset({\n        right: extra.right_position\n      });\n\n      this.$el.css({\n        left: \"auto\",\n        right: extra.right_position\n      });\n\n    } else {\n\n      this.$el.offset({\n        left: this.model.get(\"x\"),\n        right: \"auto\"\n      });\n\n    }\n\n  },\n\n  _onCloseDialogs: function() {\n    if (this.model.get(\"selected\") !== undefined) this.model.set(\"selected\", false);\n  },\n\n  render: function() {\n\n    this._place();\n\n    this.$el.append(this.template(this.model.attributes));\n\n    this.$text = this.$(\".content div.text\");\n    var text   = this._transformToMarkdown(this.model.get(\"text\"));\n\n    this.$text.html(text);\n\n    this._applyStyle(false);\n    this._onChangeExtra();\n\n    this.$el.addClass(this.model.get(\"device\"));\n\n    cdb.god.unbind(\"closeDialogs\", this._onCloseDialogs, this);\n    cdb.god.bind(\"closeDialogs\", this._onCloseDialogs, this);\n\n    return this;\n\n  }\n\n});\n","\n/**\n * Represents a URL.\n * Provides common semantics to manipulate a URL without having to resort to manipulating strings manually.\n * Rather don't subclass but you composition if you need to extend some functionality.\n *\n * Can safely be coerced into a string implicitly, e.g.:\n *   var myUrl = cdb.common.Url.byBasePath('http://foobar.com/some/path')\n *   alert(myUrl); // will output 'http://foobar.com/some/path'\n */\ncdb.common.Url = cdb.core.Model.extend({\n\n  initialize: function (attrs) {\n    if (!attrs.base_url) {\n      throw new Error('base_url is required')\n    }\n  },\n\n  /**\n   * Get a new URL object with new basepath.\n   * @param {String,*} path new sub path. Slashes are not necessary, e.g. 'my_path'\n   * @return {Object} instance of cdb.common.Url\n   */\n  urlToPath: function() {\n    return cdb.common.Url.byBaseUrl(this.toString.apply(this, arguments));\n  },\n\n  /**\n   * @return {String} Path of this URL, e.g. '/some/path'\n   */\n  pathname: function() {\n    return this.toString().match(/^.+\\/\\/[^\\/]+(.*)$/)[1];\n  },\n\n  toString: function() {\n    return this._joinArgumentsWithSlashes(\n      this.get('base_url'),\n      Array.prototype.slice.call(arguments, 0)\n    );\n  },\n\n  _joinArgumentsWithSlashes: function() {\n    return _.chain(arguments).flatten().compact().value().join('/');\n  }\n\n}, {\n\n  byBaseUrl: function(url) {\n    return new cdb.common.Url({ base_url: url });\n  }\n});\n","/**\n * URLs associated with the dashboard visualizations.\n */\ncdb.common.DashboardVisUrl = cdb.common.Url.extend({\n\n  lockedItems: function() {\n    return this.urlToPath('locked');\n  },\n\n  sharedItems: function() {\n    return this.urlToPath('shared');\n  },\n\n  likedItems: function() {\n    return this.urlToPath('liked');\n  }\n});\n","/**\n *  Custom scroll for blocks\n *  - el: scrollable element\n *  - parent: where to put span shadows :)\n */\n\ncdb.admin.CustomScrolls = cdb.core.View.extend({\n\n  events: {\n    'scroll': 'checkScroll'\n  },\n\n  initialize: function() {\n    var self = this;\n\n    // Render it\n    this.render();\n\n    // Hack to check scroll form the beginning :)\n    this.timeout = setTimeout(function(){\n      self.checkScroll();\n    },300)\n  },\n\n  render: function() {\n    this.options.parent.append('<span class=\"top scroll\"></span><span class=\"bottom scroll\"></span>');\n    return this;\n  },\n\n  checkScroll: function(ev) {\n    var height_ = this.$el.outerHeight()\n      , scroll_y = this.$el[0].scrollTop\n      , scroll_x = this.$el[0].scrollLeft\n      , scroll_y_height = this.$el[0].scrollHeight - height_\n      , $parent = this.options.parent\n      , $top = $parent.find('span.top')\n      , $bottom = $parent.find('span.bottom');\n\n    // Y axis for the moment\n    if (scroll_y == 0) {\n      $top.hide();\n    } else {\n      $top.show();\n    }\n\n    if (scroll_y == scroll_y_height) {\n      $bottom.hide();\n    } else {\n      $bottom.show();\n    }\n  }\n\n});\n","\n/**\n *  Class for javascript errors in CartoDB App\n *\n *  - It controls JS errors and save them into the\n *    service we set at the begining.\n */\n\ncdb.admin.ErrorStats = cdb.core.Model.extend({\n\n  defaults: {\n    name:        'trackJs',              // Name of the service\n    people:      'configure',            // Internal service function for setting people configuration\n    template:    'old_common/views/trackjs', // Template for setting people configuration\n    enable_logs: false                   // Sends the errors to the logger\n  },\n\n  initialize: function(opts) {\n    if (opts && opts.user_data) {\n      this.user_data = opts.user_data;  \n    }\n\n    if (window[this.get('name')]) {\n      this._setService();\n    }\n  },\n\n  _setService: function() {\n    // Set people?\n    if (this.get('people') && this.user_data) {\n      var template = cdb.templates.getTemplate(this.get('template'));\n      window[this.get('name')][this.get('people')](JSON.parse(template(this.user_data)));\n    }\n    // Save logs?\n    if (this.get('enable_logs')) {\n      cdb.log = window[this.get('name')];\n    }\n  }\n\n});\n","\n  /**\n   *  Boolean field -> Place to choose any boolean value\n   *  - It accepts a model with {attribute: 'colum', value: true}\n   *  var boolean = new cdb.admin.BooleanField({ model: model })\n   */\n\n  cdb.admin.BooleanField = cdb.admin.StringField.extend({\n\n    className: 'field boolean',\n\n    default_options: {\n      template_name: 'old_common/views/forms/boolean_field',\n      label:          false,\n      readOnly:       false\n    },\n\n    events: {\n      'click a.radiobutton': '_onChange'\n    },\n\n    _onChange: function(e) {\n      e.preventDefault();\n\n      var $radio = $(e.target).closest('a.radiobutton') // Always within the view!\n        , value = $radio.text().toLowerCase();\n      \n      if (this.model.get('value') != value) {\n        this.model.set('value', value);\n        this._setSelected($radio)\n      }\n    },\n\n    _setSelected: function($radio) {\n      this.$('a.selected').removeClass('selected');\n      $radio.addClass('selected');\n    },\n\n    _resize: function() {},\n\n    _triggerEvent: function(eventName, values) {\n      this.trigger(eventName, values, this);\n    }\n  })","\n  /**\n   *  Color picker dropdown (extends Dropdown)\n   *\n   *  It shows the color options with a drop(up).\n   *\n   *  Usage example:\n   *\n   *  var color_picker = new cdb.admin.ColorPicker({\n   *    target: $('a.account'),\n   *    model: {},\n   *    template_base: 'common/views/color_picker'\n   *  });\n   *\n   */\n\n\n  cdb.admin.ColorPicker = cdb.admin.DropdownMenu.extend({\n\n    className: 'CDB-Text dropdown color_picker border',\n\n    _PICKER_DELAY: 800,\n\n    _COLORS: [\n      // First file\n      \"#136400\",\"#229A00\",\"#B81609\",\"#D6301D\",\n      \"#F84F40\",\"#41006D\",\"#7B00B4\",\"#A53ED5\",\"#2E5387\",\"#3E7BB6\",\n      \"#5CA2D1\",\"#FF6600\",\"#FF9900\",\"#FFCC00\",\"#FFFFFF\",\n      // Second file\n      \"#012700\",\"#055D00\",\"#850200\",\"#B40903\",\"#F11810\",\n      \"#11002F\",\"#3B007F\",\"#6B0FB2\",\"#081B47\",\"#0F3B82\",\"#2167AB\",\n      \"#FF2900\",\"#FF5C00\",\"#FFA300\",\"#000000\"\n    ],\n\n    default_options: {\n      width: 197,\n      speedIn: 150,\n      speedOut: 300,\n      vertical_position: \"up\",\n      horizontal_position: \"right\",\n      horizontal_offset: 5,\n      vertical_offset: 0,\n      tick: \"right\",\n      dragUpdate: false,\n      template_base: 'old_common/views/color_picker'\n    },\n\n    events: {\n      'click a.advanced'          : '_openAdvanced',\n      'click .default-colors li a': '_clickedColor',\n      'keyup input.text'          : '_checkColor',\n      'change input.text'         : '_checkColor',\n      'submit form'               : '_submitColor',\n      'click'                     : 'stopPropagation'\n    },\n\n    initialize: function() {\n      cdb.admin.DropdownMenu.prototype.initialize.call(this);\n\n      // Create a model with colors and \"extra colors\"\n      this.model = new cdb.core.Model({\n        visible:      false,\n        colors:       this._COLORS,\n        extra_colors: this.options.extra_colors,\n        color:        \"\"\n      });\n\n      if (this.options.target)\n        $(this.options.target).off(\"click\", this._handleClick);\n\n      this._initBinds();\n    },\n\n    _initBinds: function() {\n      _.bindAll(this, \"open\", \"hide\", \"_handleClick\", \"_keydown\",\n        '_openAdvanced', '_setPicker', '_setColor', '_onPickerMouseMove',\n        '_onPickerMouseUp', '_submitColor');\n      this.model.bind(\"change:colors change:extra_colors change:color\", this.render, this);\n    },\n\n    render: function() {\n      // Render element\n      var d = this.model.toJSON();\n      var self = this;\n\n      if (d.extra_colors) {\n        // Filter colors already present in default list\n        d.extra_colors = _.filter(\n          _.uniq( this.options.extra_colors ),\n          function(c) {\n            return  !_.contains( self._COLORS, c.toUpperCase() )\n          }\n        );\n      }\n\n      this.$el\n        .html(this.template_base(d))\n        .css({ width: this.options.width });\n\n      // Init and render color picker\n      ColorPicker.fixIndicators(\n        this.$('.slider-indicator').get(0),\n        this.$('.picker-indicator').get(0)\n      );\n\n      this.color_picker = ColorPicker(\n        this.$('.slider').get(0),\n        this.$('.picker').get(0),\n        this._setPicker\n      );\n\n      return this;\n    },\n\n    stopPropagation: function(e) {\n      e.stopPropagation();\n    },\n\n    _checkColor: function(e) {\n      e.preventDefault();\n\n      var color = new RGBColor(this.$(\"input.text\").val());\n\n      if (color.ok) {\n        this.$(\"input.text\").removeClass(\"error\");\n        this.$(\"form > span.color\").css(\"background\", color.toHex());\n      } else {\n        this.$(\"input.text\").addClass(\"error\");\n      }\n    },\n\n    setColors: function(attr, value) {\n      if (!attr || !value) {\n        cdb.log.info('No attribute or value for color picker model');\n        return false;\n      }\n\n      this.model.set(attr, value);\n    },\n\n    init: function(color) {\n      color = color || '#FFFFFF';\n      this.model.set('color', color);\n      this._setColor(color);\n      this.open();\n    },\n\n    _clickedColor: function(e) {\n      e.preventDefault();\n      var color = $(e.target).attr(\"href\");\n      this._triggerColor(color, true);\n      this.hide();\n    },\n\n    _setPicker: function(hex, hsv, rgb, mousePicker, mouseSlide) {\n      this._setColor(hex);\n      ColorPicker.positionIndicators(\n        this.$('.slider-indicator').get(0),\n        this.$('.picker-indicator').get(0),\n        mouseSlide, mousePicker\n      );\n    },\n\n    _setColor: function(color) {\n      this.$(\"form > span.color\").css(\"background\", color);\n      this.$(\"input.text\").val(color);\n    },\n\n    _submitColor: function(e) {\n      if (e) e.preventDefault();\n      var color = new RGBColor(this.$(\"input.text\").val());\n\n      if (color.ok) {\n        this._triggerColor(color.toHex(), true);\n        this.hide();\n      }\n    },\n\n    _onPickerMouseMove: function() {\n      if (this.options.dragUpdate) {\n        var color = new RGBColor(this.$(\"input.text\").val());\n        if (color.ok) this._triggerColor(color.toHex(), false);\n      }\n    },\n\n    _onPickerMouseUp: function() {\n      var color = new RGBColor(this.$(\"input.text\").val());\n      if (color.ok) this._triggerColor(color.toHex(), false);\n    },\n\n    _bindAdvancedPicker: function() {\n      this.$('.slider').bind('mousemove', this._onPickerMouseMove);\n      this.$('.picker').bind('mousemove', this._onPickerMouseMove);\n      this.$('.picker').bind('mouseup',   this._onPickerMouseUp);\n      this.$('.slider').bind('mouseup',   this._onPickerMouseUp);\n    },\n\n    _destroyAdvancedPicker: function() {\n      this.$('.slider').unbind('mousemove', this._onPickerMouseMove);\n      this.$('.picker').unbind('mousemove', this._onPickerMouseMove);\n      this.$('.picker').unbind('mouseup',   this._onPickerMouseUp);\n      this.$('.slider').unbind('mouseup',   this._onPickerMouseUp);\n    },\n\n    _openAdvanced: function(e) {\n      if (e) e.preventDefault();\n\n      this._bindAdvancedPicker();\n\n      this.$('div.top').addClass('advanced');\n      this.positionate(e);\n      // Set color in picker\n      var color = new RGBColor(this.$(\"input.text\").val());\n      if (color.ok) this.color_picker.setHex(color.toHex())\n    },\n\n    _triggerColor: function(color, close) {\n      // It triggers the color and if the parent\n      // should close the picker or not.\n      this.trigger('colorChosen', color, close, this.el);\n    },\n\n    positionate: function(e,target) {\n      var $target = this.options.target;\n\n      // Positionate\n      var targetPos     = $target[this.options.position || 'offset']()\n        , targetWidth   = $target.outerWidth()\n        , targetHeight  = $target.outerHeight()\n        , elementWidth  = this.$el.outerWidth()\n        , elementHeight = this.$el.outerHeight();\n\n      this.$el.css({\n        top: targetPos.top + parseInt((this.options.vertical_position == \"up\") ? (- elementHeight - 10 - this.options.vertical_offset) : (targetHeight + 10 - this.options.vertical_offset)),\n        left: targetPos.left + parseInt((this.options.horizontal_position == \"left\") ? (this.options.horizontal_offset - 15) : (targetWidth - elementWidth + 15 - this.options.horizontal_offset))\n      }).addClass(\n        // Add vertical and horizontal position class\n        (this.options.vertical_position == \"up\" ? \"vertical_top\" : \"vertical_bottom\" )\n        + \" \" +\n        (this.options.horizontal_position == \"right\" ? \"horizontal_right\" : \"horizontal_left\" )\n        + \" \" +\n        // Add tick class\n        \"tick_\" + this.options.tick\n      )\n    },\n\n    open: function(e,target) {\n      // Target\n      var $target = target && $(target) || this.options.target;\n\n      this.positionate(e,target);\n\n      // Show it\n      this.show();\n\n      // Dropdown openned\n      this.model.set('visible', true);\n    },\n\n    hide: function(ev) {\n      var self = this;\n\n      this.$el.animate({\n        marginTop: self.options.vertical_position == \"down\" ? \"10px\" : \"-10px\",\n        opacity: 0\n      },this.options.speedOut, function(){\n        // Remove selected class\n        $(self.options.target).removeClass(\"selected\");\n        // And clean it ;)\n        self.clean();\n      });\n\n      // Dropdown hidden\n      this.model.set('visible', false);\n    },\n\n    clean: function() {\n      if (this.color_picker) {\n        this.color_picker.unBind();\n      }\n\n      if (this.options.target)\n        $(this.options.target).unbind(\"click\", this._handleClick);\n\n      cdb.admin.DropdownMenu.prototype.clean.call(this);\n    }\n  });\n","\n  /**\n   *  Date field -> Place to choose and edit date field\n   *  - It accepts a model with {attribute: 'colum', value: '2013-02-12T12:19:58+01:00'}\n   *  - It will create a new model to split this value into {day, month, year and time}\n   *  var date = new cdb.admin.DateField({ model: model })\n   */\n\n  cdb.admin.DateField = cdb.admin.StringField.extend({\n\n    className: 'field date',\n\n    timezone: \"00:00\",\n\n    default_options: {\n      template_name: 'old_common/views/forms/date_field',\n      label:          false,\n      readOnly:       false\n    },\n\n    events: {\n      'change input.time': '_onChange',\n      'keyup input.time':  '_onKeyUp'\n    },\n\n    initialize: function() {\n      _.defaults(this.options, this.default_options);\n\n      _.bindAll(this, '_onChange', '_onKeyUp', '_onChangeModel');\n\n      this.template_base = this.options.template_base ? _.template(this.options.template_base) : cdb.templates.getTemplate(this.options.template_name);\n\n      // Get date\n      var date = this._splitDate((this.model.get('value')));\n\n      this.timezone = this._getTimeZone(this.model.get('value'));\n\n      // Generate a new date Model (later it will be removed and destroyed)\n      this.date_model = new cdb.core.Model();\n\n      // Begins as valid\n      this.valid = true;\n\n      // Bind changes\n      this.date_model.bind('change', this._onChangeModel);\n\n      // Date model data set\n      this.date_model.set(date);\n\n      // On clean\n      this.bind('clean', this._reClean);\n    },\n\n    render: function() {\n      this.$el.html(this.template_base(_.extend(this.model.toJSON(), this.options)));\n\n      // Apply views\n      this._initViews();\n\n      // Check readOnly and unbind all events\n      if (this.options.readOnly) {\n        this.undelegateEvents();\n      }\n\n      return this;\n    },\n\n    _initViews: function() {\n\n      // Days spinner\n      var days = this.days = new cdb.forms.Spinner({\n        el: this.$el.find('div.day'),\n        model:    this.date_model,\n        disabled: this.options.readOnly,\n        property: 'day',\n        min:      1,\n        max:      31,\n        inc:      1,\n        width:    15,\n        noSlider: true,\n        pattern:  /^([12]?\\d{0,1}|3[01]{0,2})$/\n      });\n\n      this.addView(this.days);\n      this.$(\"div.day\").append(days.render());\n\n      // Year spinner\n      var years = this.years = new cdb.forms.Spinner({\n        el: this.$el.find('div.year'),\n        model:    this.date_model,\n        disabled: this.options.readOnly,\n        property: 'year',\n        min:      1900,\n        max:      2100,\n        width:    28,\n        noSlider: true,\n        pattern:  /^([0-9]{0,4})$/\n      });\n      this.addView(this.years);\n      this.$(\"div.year\").append(years.render());\n\n      // Month selector\n      var months = this.months = new cdb.forms.Combo({\n        el: this.$el.find('div.month'),\n        model:      this.date_model,\n        disabled:   this.options.readOnly,\n        property:   'month',\n        width:      '140px',\n        extra:      [['January',1], ['February',2], ['March',3], ['April',4], ['May',5], ['June',6], ['July',7], ['August',8], ['September',9], ['October',10], ['November',11], ['December',12]]\n      });\n      this.addView(this.months);\n      this.$(\"div.month\").append(months.render());\n\n      // Time input\n      this.$('input.time').val(this.date_model.get('time'));\n    },\n\n    /**\n     *  Extracts the timezone from a date\n     */\n    _getTimeZone: function(date) {\n\n      if (date) {\n        var match = date.match(/\\+(.*)$/);\n        if (match && match.length == 2) return match[1];\n      }\n\n      return this.timezone;\n\n    },\n\n    /**\n     *  Split the date string\n     */\n    _splitDate: function(str) {\n      var date = {};\n\n      // Get default date and time\n      var today = new Date();\n\n      var day   = today.getDate();\n      var month = today.getMonth() + 1;\n      var year  = today.getFullYear();\n\n      var time = today.getHours() + \":\" + today.getMinutes() + \":\" + today.getSeconds();\n\n      if (str == '') {\n        date.day   = day;\n        date.month = month;\n        date.year  = year;\n        date.time  = time;\n      } else {\n        try {\n          var split_date_hour = str.split('T');\n\n          if (split_date_hour.length > 1) {\n\n            var split_date = split_date_hour[0].split('-');\n\n            date.time  = split_date_hour[1].substr(0,8);\n            date.day   = parseInt(split_date[2]);\n            date.month = parseInt(split_date[1]);\n            date.year  = parseInt(split_date[0]);\n\n          } else {\n            date.day   = day;\n            date.month = month;\n            date.year  = year;\n            date.time  = time;\n          }\n\n        } catch (e) {\n          date.day   = day;\n          date.month = month;\n          date.year  = year;\n          date.time  = time;\n        }\n      }\n\n      return date;\n\n    },\n\n    /**\n     *  Get the date model and converts to date string\n     */\n    _toDate: function(date) {\n      return date.year + \"-\" + date.month + \"-\" + date.day + \"T\" + date.time + \"+\" + this.timezone;\n    },\n\n    /**\n     *  Check if the time is well formed or not\n     */\n    _checkTime: function(time) {\n      var pattern = /^([01]{1}[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]$/;\n      if (pattern.test(time)) {\n        return true\n      } else {\n        return false\n      }\n    },\n\n\n    // Events\n    _onChange: function(e) {\n      var time = this.$('input.time').val();\n\n      if (this._checkTime(time)) {\n        this.date_model.set('time', time);\n      }\n    },\n\n    _onChangeModel: function(m) {\n      this.model.set('value', this._toDate(this.date_model.toJSON()));\n    },\n\n\n    _onKeyDown: function() {},\n\n\n    _onKeyUp: function(e) {\n      var time = $(e.target).val();\n\n      if (this._checkTime(time)) {\n\n        if (e.keyCode === 13) {\n          e.preventDefault();\n          this._triggerEvent('ENTER');\n          return false;\n        }\n\n        this.valid = true;\n        this.date_model.set('time', time);\n        $(e.target).removeClass(\"error\");\n      } else {\n        this.valid = false;\n        $(e.target).addClass(\"error\");\n      }\n    },\n\n    _reClean: function() {\n      this.date_model.unbind('change');\n      this.date_model.destroy();\n    }\n  })\n","\ncdb.admin.EditInPlace = cdb.core.View.extend({\n\n  events: {\n    \"click .value\": \"_onClick\",\n    \"keyup input\":  \"_onKeyUp\",\n    \"blur input\":   \"_onBlur\"\n  },\n\n  initialize: function() {\n\n    this.options = _.extend({\n      disabled: false,\n      stripHTML: false\n    }, this.options);\n\n    _.bindAll(this, \"_close\", \"_onKeyUp\");\n\n    this._observedField = this.options.observe;\n\n    this.disabled  = this.options.disabled;\n    this.stripHTML = this.options.stripHTML;\n\n    this.template = this.options.template_name ? this.getTemplate(this.options.template_name) : this.getTemplate('table/menu_modules/legends/views/edit_in_place');\n\n    this._setupConfig();\n\n    this.add_related_model(this.model);\n    this.model.bind(\"change:\" + this._observedField, this._updateValue, this);\n\n    this.render();\n\n  },\n\n  _setupConfig: function() {\n\n    this.config = new cdb.core.Model({\n      mode: \"view\"\n    });\n\n    this.add_related_model(this.config);\n    this.config.bind(\"change:mode\", this._updateMode, this);\n\n  },\n\n  _updateMode: function(mode) {\n\n    if (this.config.get(\"mode\") == 'edit') {\n\n      this.$el.find(\".value\").hide();\n\n      this.$input.show();\n      this.$input.focus();\n\n    } else {\n\n      this.$el.find(\".value\").show();\n      this.$input.hide();\n\n      var value = this.model.get(this._observedField);\n\n      this.$input.val(value);\n      this.$el.find(\".value span\").html(value);\n\n    }\n  },\n\n  _updateValue: function() {\n\n    var value = this.model.get(this._observedField);\n\n    if (this.stripHTML) {\n      value = cdb.Utils.stripHTML(value);\n    }\n\n    if (cdb.Utils.isBlank(value)) {\n\n      this.$input.text(\"\");\n      this.$el.find(\".value\").addClass(\"empty\");\n      this.$el.find(\".value span\").text(\"empty\");\n      this.trigger(\"change\", null, this);\n\n      return;\n    }\n\n    this.$input.text(value);\n    this.$el.find(\".value span\").html(value);\n    this.$el.find(\".value\").removeClass(\"empty\");\n\n    this.trigger(\"change\", value, this);\n\n  },\n\n  _close: function(e) {\n\n    e && e.preventDefault();\n    e && e.stopPropagation();\n\n    this.config.set(\"mode\", \"view\");\n\n    this._preventEmptyValue();\n  },\n\n  _preventEmptyValue: function() {\n\n    var value = this.model.get(this._observedField);\n\n    if (cdb.Utils.isBlank(value)) {\n      this.$el.find(\".value\").addClass(\"empty\");\n      this.$el.find(\".value span\").text(\"empty\");\n    } else {\n      this.$el.find(\".value\").removeClass(\"empty\");\n    }\n\n  },\n\n  _onBlur: function(e) {\n\n    var value = this.$el.find(\"input\").val();\n\n    if (this.stripHTML) {\n      value = cdb.Utils.stripHTML(value);\n    }\n\n    this.model.set(this._observedField, value);\n    this._close();\n  },\n\n  _onKeyUp: function(e) {\n\n    if (e.keyCode == 13) { // Enter\n\n      var value = this.$el.find(\"input\").val();\n\n      if (this.stripHTML) {\n        value = cdb.Utils.stripHTML(value);\n      }\n\n      this.model.set(this._observedField, value);\n      this._close();\n\n    } else if (e.keyCode == 27) { // Esc\n      this._close();\n    }\n\n  },\n\n  _onClick: function(e) {\n\n    e && e.preventDefault();\n    e && e.stopPropagation();\n\n    if (!this.disabled) this.config.set(\"mode\", \"edit\");\n  },\n\n  render: function() {\n\n    var isEmpty = true;\n    var value = this.model.get(this._observedField);\n\n    if (this.stripHTML) {\n      value = cdb.Utils.stripHTML(value);\n    }\n\n    if (cdb.Utils.isBlank(value)) {\n      value = \"empty\";\n      this.$el.append('<input type=\"text\" value=\"\" />');\n    } else {\n      isEmpty = false;\n      this.$el.append('<input type=\"text\" value=\"' + _.escape(value) + '\" />');\n    }\n\n    this.$el.append(this.template({ value: value }));\n    this.$el.addClass(\"edit_in_place\");\n\n    if (this.disabled) this.$el.addClass(\"disabled\");\n\n    if (isEmpty) {\n      this.$el.find(\".value\").addClass(\"empty\");\n    } else {\n      this.$el.find(\".value\").removeClass(\"empty\");\n    }\n\n    this.$input = this.$el.find(\"input\");\n\n    if (this.options.maxWidth) this.$el.find(\"span\").css(\"max-width\", this.options.maxWidth);\n\n\n  }\n\n});\n","\n  /**\n   *  Advanced combo with extra parameters\n   *\n   */\n\n\n  cdb.forms.ColumnTypeCombo = cdb.forms.Combo.extend({\n\n    options: {\n      minimumResultsForSearch: 20,\n      placeholder: '',\n      formatResult: true,\n      matcher: true,\n      dropdownCssClass: 'column-type'\n    },\n\n    _formatResult: function(data) {\n      return  '<span class=\"value\">' + data.id + '</span>' + '<span class=\"type\">' + (data.text && data.text.charAt(0)) + '</span>'\n    },\n\n    _matcher: function(term, text, option) {\n      var val = $(option).val();\n      return val.toUpperCase().indexOf(term.toUpperCase())>=0;\n    }\n\n  });\n","\n/**\n * renders a form given fields\n *\n * var form = new cdb.forms.Form({\n *  form_data: [\n      {\n         name: 'Marker Fill',\n         form: {\n           'polygon-fill': {\n                 type: 'color' ,\n                 value: '#00FF00'\n            },\n            'polygon-opacity': {\n                 type: 'opacity' ,\n                 value: 0.6\n            }\n        }\n      }\n    ]\n * });\n */\n\ncdb.forms.Form = cdb.core.View.extend({\n  tagName: 'ul',\n\n  widgets: {\n   'color': 'ColorWizard',\n   'opacity': 'Opacity',\n   'simple_opacity': 'SimpleOpacity',\n   'opacity_polygon': 'OpacityPolygon',\n   'number': 'Spinner',\n   'simple_number': 'SimpleNumber',\n   'simple_number_with_label': 'SimpleNumberWithLabel',\n   'width': 'Width',\n   'select': 'Combo',\n   'hidden': 'Hidden',\n   'switch': 'Switch',\n   'text_align': 'TextAlign'\n  },\n\n  field_template: _.template('<li <% if (className) { %>class=\"<%- className %>\"<% } %>><span><%-name %></span><span class=\"field\"></li>'),\n\n  initialize: function() {\n    var self = this;\n    this.fields = {};\n\n    this.form_data = this.options.form_data;\n\n    this.bind('clean', function() {\n      this.fields = null;\n    }, this);\n  },\n\n  updateForm: function(form) {\n    this.form_data = form;\n  },\n\n  _renderField: function(field) {\n    var self = this;\n    var e = $(this.field_template({ name: field.title || field.name, className: field.className || false }));\n    _(field.form).each(function(form, name) {\n\n      // create the class for this data type and add it to view\n      var Class = window.cdb.forms[self.widgets[form.type]];\n      if (Class) {\n        var opts = form;\n        _.extend(opts, {\n          property: name,\n          model: self.model,\n          extra: form.extra,\n          field_name: field.name\n        });\n        var v = new Class(opts);\n        e.find('.field').append(v.render().el);\n\n        v.on(\"saved\", function() {\n          self.trigger(\"saved\", self);\n        });\n\n        self.addView(v);\n      } else {\n        cdb.log.error(\"field class not found \"  + form.type);\n      }\n    });\n\n    // Render text if it exists after first form\n    // TODO: create a new type of field called text\n    if (field.text) {\n      $(\"<span class='text light'>\" + field.text + \"</span>\").insertAfter(e.find('.field div:eq(0)'));\n    }\n\n    return e;\n  },\n\n  /**\n   * return the jquery element for a field\n   * (wraps each subfield)\n   */\n  getFieldByName: function(name) {\n    return this.fields[name];\n  },\n\n  /**\n   * returns the views inside each field\n   */\n  getFieldsByName: function(name) {\n    return _.filter(this._subviews, function(v) {\n      if(v.options.field_name === name) {\n        return v;\n      }\n    });\n  },\n\n  render: function() {\n    var self = this;\n    this.clearSubViews();\n    _(this.filter).each(function(e) {\n      e.destroy();\n    });\n    this.$el.html('');\n    _(this.form_data).each(function(field) {\n      var f= self._renderField(field);\n      self.fields[field.name] = f;\n\n      self.$el.append(f);\n    });\n    return this;\n  }\n\n});\n\n","\n  /**\n   *  Geometry field -> Place to choose and edit geometry field\n   *  - It accepts a model with {attribute: 'the_geom', value: '{{ \"type\": \"Point\", \"coordinates\": [100.0, 0.0] }}'}\n   *  var geometry = new cdb.admin.GeometryField({ model: model, row: row, rowNumber: rowNumber })\n   */\n\n  cdb.admin.GeometryField = cdb.admin.StringField.extend({\n\n    className: 'field geometry',\n\n    default_options: {\n      template_name: 'old_common/views/forms/geometry_field',\n      label:          false,\n      readOnly:       false\n    },\n\n    events: {\n      'click .switch':    '_chooseEditor',\n      'keyup input':      '_onKeyInputUp',\n      'keydown textarea': '_onKeyTextareaDown',\n      'change textarea':  '_onChange'\n    },\n\n    initialize: function() {\n      _.defaults(this.options, this.default_options);\n\n      _.bindAll(this, '_chooseEditor', '_onKeyInputUp', '_onKeyTextareaDown');\n\n      this.template_base = this.options.template_base ? _.template(this.options.template_base) : cdb.templates.getTemplate(this.options.template_name);\n\n      // Set important variables\n      this.valid = true;\n      this.row = this.options.row;\n\n      // Get OS variable\n      this._setOS();\n    },\n\n    render: function() {\n      this.$el.html(this.template_base(_.extend(this.model.toJSON(), this.options)));\n\n      // Apply views\n      this._initViews();\n\n      // Check readOnly and unbind all events\n      if (this.options.readOnly) {\n        this.undelegateEvents();\n      }\n\n      return this;\n    },\n\n    _initViews: function() {\n      var geojson = this.model.get('value');\n\n      if (!this.row.isGeomLoaded()) {\n        // the_geom contents still haven't been loaded\n        this._loadGeom();\n      } else {\n        this._chooseGeom();\n      }\n    },\n\n    /**\n     *  Load geom if it is not loaded\n     */\n    _loadGeom: function() {\n      var self = this;\n      this.row.bind('change', function() {\n        self.model.set('value', self.row.get(\"the_geom\"));\n        self._chooseGeom();\n      }, this);\n      this.row.fetch({\n        rowNumber: this.options.rowNumber\n      });\n    },\n\n\n    /**\n     *  Choose scenario for the editor\n     */\n    _chooseGeom: function() {\n      var geom = null;\n\n      try {\n        geom = JSON.parse(this.model.get('value'));\n      } catch(err) {\n        // if the geom is not a valid json value\n      }\n\n      if (!this.options.readOnly) {\n        if (!geom || geom.type.toLowerCase() == \"point\") {\n          // Set status to point\n          this.status = \"point\";\n          // Remove loader\n          this.$(\".loader\").remove();\n          // Fill inputs\n          this.$(\".point\").show();\n          this.$(\".selector\").show();\n\n          if (geom) {\n            this.$(\"input.longitude\").val(geom.coordinates[0]);\n            this.$(\"input.latitude\").val(geom.coordinates[1]);\n            this.$(\"textarea\").val(JSON.stringify(geom));\n          }\n        } else {\n          // Set status to rest\n          this.status = \"rest\";\n          // Remove loader\n          this.$(\".loader\").remove();\n          // Fill textarea\n          this.$(\".rest\").show();\n          this.$(\"textarea\").val(this.model.get('value'));\n        }\n      } else {\n        this.$(\".loader\").remove();\n        this.$(\".selector\").show();\n        this.$(\"textarea\").val(this.model.get('value'));\n      }\n    },\n\n    _chooseEditor: function(ev) {\n      this.killEvent(ev);\n\n      var $el = $(ev.target).closest(\"a\");\n\n      // Change status value\n      this.status = (this.status == \"point\") ? \"rest\" : \"point\";\n\n      // Change switch\n      $el\n        .removeClass(this.status == \"rest\" ? \"disabled\" : \"enabled\")\n        .addClass(this.status == \"rest\" ? \"enabled\" : \"disabled\");\n\n      this.updateInputs();\n\n      // Change between point to geom editor\n      if (this.status == \"rest\") {\n        this.$('.point').hide();\n        this.$('.rest').show();\n        this.valid = true;\n      } else {\n        this.$('.point').show();\n        this.$('.rest').hide();\n        this.valid = this._checkInputs();\n      }\n    },\n\n    updateInputs: function() {\n      if(this.model.get('value')) {\n        try {\n          var geom = JSON.parse(this.model.get('value'));\n          this.$(\"input.longitude\").val(geom.coordinates[0]);\n          this.$(\"input.latitude\").val(geom.coordinates[1]);\n          this.$(\"textarea\").val(JSON.stringify(geom));\n        } catch(error) {\n          return false;\n        }\n      }\n    },\n\n    /**\n     *  Check if the number is well formed or not\n     */\n    _checkNumber: function(number, type) {\n      var pattern = /^-?(?:[0-9]+|[0-9]*\\.[0-9]+)$/;\n      if (pattern.test(number)) {\n\n        if (type === \"lat\") {\n          if ( number >= -90 && number <= 90 ) {\n            return true\n          } else {\n            return false\n          }\n        }\n\n        if (type === \"lon\") {\n          if ( number >= -180 && number <= 180 ) {\n            return true\n          } else {\n            return false\n          }\n        }\n\n        return true\n      } else {\n        return false\n      }\n    },\n\n\n    /**\n     *  Check latitude and longitude inputs\n     */\n    _checkInputs: function() {\n      var enable = true\n        , $lat = this.$(\"input.latitude\")\n        , $lon = this.$(\"input.longitude\");\n\n      if (this._checkNumber($lat.val(), 'lat')) {\n        $lat.removeClass(\"error\");\n      } else {\n        $lat.addClass(\"error\");\n        enable = false;\n      }\n\n      if (this._checkNumber($lon.val(), 'lon')) {\n        $lon.removeClass(\"error\");\n      } else {\n        $lon.addClass(\"error\");\n        enable = false;\n      }\n\n      return enable;\n    },\n\n    /**\n     *  When user type any number we check it if it is correct\n     */\n    _onKeyInputUp: function(e) {\n\n      if (this._checkInputs()) {\n\n        if (e.keyCode === 13) {\n          e.preventDefault();\n          this._triggerEvent('ENTER');\n          return false;\n        }\n\n        this.valid = true;\n\n        // Save model\n        var lat = parseFloat(this.$(\"input.latitude\").val())\n          , lon = parseFloat(this.$(\"input.longitude\").val());\n\n        this.model.set('value', JSON.stringify({\"type\": \"Point\", \"coordinates\": [lon,lat]}));\n\n      } else {\n        this.valid = false;\n      }\n    },\n\n    /**\n     *  Key press binding for textarea\n     */\n    _onKeyTextareaDown: function(e) {\n      if (((this.so==\"mac\" && e.metaKey) || (this.so==\"rest\" && e.ctrlKey)) && e.keyCode == 13 ) {\n        e.preventDefault();\n        this._triggerEvent('ENTER');\n        return false;\n      }\n\n      var value = $(e.target).val();\n\n      this.model.set('value', value);\n    },\n  })\n","\n  /**\n   *  Number field -> Place to edit and capture number editions\n   *  - It accepts a model with {attribute: 'colum', value: '1235'}\n   *  - It validates the number before saving it\n   *  var string = new cdb.admin.NumberField({ model: model })\n   *\n   */\n\n  cdb.admin.NumberField = cdb.admin.StringField.extend({\n\n    className: 'field number',\n\n    default_options: {\n      template_name: 'old_common/views/forms/number_field',\n      label:          false,\n      readOnly:       false\n    },\n\n    events: {\n      'change input':   '_onChange',\n      'keyup input':    '_onKeyUp',\n      'keydown input':  '_onKeyDown'\n    },\n\n    // Check if the number is well formed or not\n    _checkNumber: function(number) {\n      var pattern = /^-?(?:[0-9]+|[0-9]*\\.[0-9]+)$/;\n      if (pattern.test(number))\n        return true\n      else\n        return false\n    },\n\n    _onChange: function(e) {\n      var value = $(e.target).val();\n      if (this._checkNumber(value)) {\n        this.model.set('value', value);\n      }\n    },\n\n    _onKeyDown: function(e) {\n      var number = $(e.target).val();\n      if ((((this.so==\"mac\" && e.metaKey) || (this.so==\"rest\" && e.ctrlKey)) && e.keyCode == 13) || e.keyCode == 13) {\n        if (number === '' || this._checkNumber(number)) {\n          this._setValid(number);\n          this._triggerEvent('ENTER');\n        }\n      }\n    },\n\n    _onKeyUp: function(e) {\n      var number = $(e.target).val();\n\n      if (number === '' || this._checkNumber(number)) {\n        this._setValid(number);\n      } else {\n        this._setInvalid(number);\n      }\n    },\n\n    _setInvalid: function(number) {\n      this.valid = false;\n      this.$('input[type=\"text\"]').addClass(\"error\");\n    },\n\n    _setValid: function(number) {\n      this.valid = true;\n\n      if (number === '') {\n        number = 'null';\n      }\n\n      this.$('input[type=\"text\"]').removeClass(\"error\");\n      this.model.set('value', number);\n    },\n\n    _resize: function() {}\n\n  })\n","\n\n  /**\n   * Spinner slider (extends Dropdown)\n   *\n   * It shows the spinner slider.\n   *\n   * Usage example:\n   *\n      var spinner_slider = new cdb.admin.SpinnerSlider({\n        target: $('a.account'),\n        model: {},\n        template_base: 'common/views/spinner_slider'\n      });\n   *\n   */\n\n\n  cdb.admin.SpinnerSlider = cdb.admin.DropdownMenu.extend({\n\n    className: 'dropdown spinner_slider border',\n\n    default_options: {\n      width: 26,\n      speedIn: 150,\n      speedOut: 300,\n      vertical_position: \"up\",\n      horizontal_position: \"right\",\n      horizontal_offset: 32,\n      vertical_offset: 0,\n      tick: \"top\"\n    },\n\n    events: {\n      'click' : '_stopPropagation',\n    },\n\n    _stopPropagation: function(ev) {\n      ev.stopPropagation();\n      ev.preventDefault();\n    },\n\n    init: function(max,min,inc,value) {\n      var self = this;\n\n      this.$el.find(\"div.slider-ui\").slider({\n        orientation: \"vertical\",\n        max: max,\n        min: min,\n        step: inc,\n        value: value,\n        slide: function(ev, ui) { self.trigger(\"valueChanged\", ui.value, this.el); },\n        change: function(ev, ui) { self.trigger(\"valueSet\", ui.value, this.el); }\n      });\n\n      this.open();\n    },\n\n    hide: function(ev) {\n      var self = this;\n      this.isOpen = false;\n\n      this.$el.animate({\n        marginTop: self.options.vertical_position == \"down\" ? \"10px\" : \"-10px\",\n        opacity: 0\n      },this.options.speedOut, function(){\n        // Remove selected class\n        $(self.options.target).removeClass(\"selected\");\n        // And hide it\n        self.$el.hide();\n        self.$el.find(\"div.slider-ui\").slider(\"destroy\");\n        self.remove();\n      });\n    }\n  });\n","  \n  /**\n   *  Custom combo which it lets you to add a custom value\n   *  extended from filters combo.\n   *\n   */\n  \n\n  cdb.forms.CustomTextCombo = cdb.forms.ColumnTypeCombo.extend({\n\n    className: 'form_combo form_custom_text_combo',\n\n    options: {\n      minimumResultsForSearch: 20,\n      placeholder: '',\n      formatResult: true,\n      formatSelection: true,\n      matcher: true,\n      freeText: true,\n      dropdownCssClass: 'column-type custom_text_combo'\n    },\n\n    render: function() {    \n      var self = this;\n\n      // Options\n      this.$select = $('<select>' + this._getOptions() + '</select>');\n\n      // Method\n      var method = this.model && this.model.get(\"method\") && this.model.get(\"method\").replace(/ /g,\"_\").toLowerCase();\n\n      // Attributes\n      this.$select.attr({\n        style: (this.options.width ? \"width:\" + this.options.width  : '')\n      });\n\n      this.$select.addClass(this.options.property + (method ? ' ' + method : ''));\n\n      // Disabled?\n      if (this.options.disabled) this.$select.attr(\"disabled\", '');\n\n      // Sets the value\n      this._setValue(this.model && this.model.get(this.options.property) || this.options.property);\n\n      // Append\n      this.$el.html(this.$select);\n\n      // Apply select2, but before destroy the bindings\n      if (!this.options || !this.options.plainSelect) {\n\n        var $select = this.$(\"select\");\n        $select.select2(\"destroy\");\n\n        var combo_options = {\n          minimumResultsForSearch:  this.options.minimumResultsForSearch,\n          placeholder:              this.options.placeholder,\n          dropdownCssClass:         this.options.dropdownCssClass,\n          freeText:                 this.options.freeText\n        };\n\n        if (this.options.formatSelection)\n          combo_options.formatSelection = this._formatSelection;\n\n        if (this.options.formatResult)\n          combo_options.formatResult = this._formatResult;\n\n        if (this.options.matcher)\n          combo_options.matcher = this._matcher;\n\n        $select.select2(combo_options);\n      }\n\n      // Set value for the combo if it is not defined as an option\n      var actual_value = this.model.get(this.options.property);\n      if ( actual_value !== \"\" && !this._valueAsOption(this.model.get(this.options.property))) {\n        $select.select2('val', this.model.get(this.options.property))\n      }\n\n      return this;\n    },\n\n    // Does that value exist as an option?\n    _valueAsOption: function(value) {\n      return _.find(this.options.extra, function(opt) { return opt[1] === value }) !== undefined\n    },\n\n    _formatSelection: function(data) {\n      return data ? data.id : data.text;\n    },\n\n    _changeSelection: function(e) {\n      var val = this.$('select').val() || this.$('select').data('select2').data().id;\n      // Check if val is from text or value\n      var isText = !this._valueAsOption(val);\n\n      // Set model\n      var a = {};\n      a[this.options.property] = val;\n      a[this.options.text || 'text'] = isText ? true : false;\n\n      if (val) this.model.set(a);\n\n      // Set icon\n      this.$('.select2-choice > div')\n        .removeClass()\n        .addClass( isText ? 'free-text-icon' : 'combo-option-icon' )\n    }\n\n  });","\n/**\n * Small moving label used to show errors in operations\n */\n\ncdb.admin.GlobalError = cdb.core.View.extend({\n  \n  DEFAULT_TAG: '',\n\n  initialize: function() {\n    _.bindAll(this, 'hide');\n    this._lastType = -1;\n    this._lastTag = this.DEFAULT_TAG;\n  },\n\n  templates: {\n    'info': 'old_common/views/notifications/info',\n    'warn': 'old_common/views/notifications/info',\n    'error': 'old_common/views/notifications/info',\n    'load': 'old_common/views/notifications/loading'\n  },\n\n  priority: {\n    'error': 3,\n    'warn': 2,\n    'info': 1,\n    'load': 0\n  },\n\n  /**\n   * Returns the fetched template of the passed type\n   * @param  {String} type\n   * @return {Function}\n   */\n  getTypeTemplate: function(type) {\n    var url = this.templates[type]? this.templates[type] : this.templates[\"info\"];\n    var tmpl = this.getTemplate(url);\n    return tmpl;\n  },\n  // type can be: 'info', 'error'\n  showError: function(text, type, timeout, tag) {\n    tag = tag || this.DEFAULT_TAG;\n    timeout = timeout === undefined ? 2000: timeout;\n    type || (type = 'info')\n\n    var priority = this.priority[type] || 0;\n    var currentPriority = this.priority[this._lastType] || 0;\n    if(priority < currentPriority) {\n      return;\n    }\n    this._lastType = type;\n    this._lastTag = tag;\n\n    this.$el.html(this.getTypeTemplate(type)({text: text, type: type}));\n\n    if(this._timer) {\n      clearTimeout(this._timer);\n    }\n    if(timeout > 0) {\n      this._timer = setTimeout(this.hide, timeout);\n    }\n    this.show();\n  },\n\n  show: function() {\n    this.$el.find(\"p\").stop().animate({marginTop: 0}, 500);\n  },\n\n  hide: function(tag) {\n    tag = tag || this.DEFAULT_TAG;\n    if(this._lastTag !== tag) return;\n    this.$el.find(\"p\").stop().animate({marginTop: 40}, 500);\n    this._timer = 0;\n    this._lastType = -1;\n    this._lastTag = this.DEFAULT_TAG;\n  },\n\n  listenGlobal: function() {\n    cdb.god.bind('error', this.showError, this);\n  }\n\n});\n","\n/**\n *  Common header for vis view ( table | derived )\n *\n *  - It needs a visualization model, config and user data.\n *\n *    var header = new cdb.admin.Header({\n *      el:       this.$('header'),\n *      model:    visusalization_model,\n *      user:     user_model,\n *      config:   config,\n *      geocoder: geocoder\n *    });\n *\n */\n\ncdb.admin.Header = cdb.core.View.extend({\n\n  _TEXTS: {\n    saving:         _t('Saving...'),\n    saved:          _t('Saved'),\n    error:          _t('Something went wrong, try again later'),\n    metadata: {\n      edit:         _t('Edit metadata...'),\n      view:         _t('View metadata...')\n    },\n    visualization: {\n      loader:       _t('Changing to visualization'),\n      created:      _t('Visualization created')\n    },\n    share: {\n      publish:        _t('PUBLISH'),\n      visualize:    _t('VISUALIZE')\n    },\n    share_privacy: {\n      ok_next:      _t('Share it now!')\n    },\n    rename: {\n      readonly:     _t('It is not possible to rename<br/>the dataset in <%- mode %> mode'),\n      owner:        _t('It is not possible to rename<br/>the dataset if you are not the owner')\n    }\n  },\n\n  _MAX_DESCRIPTION_LENGTH: 200,\n\n  events: {\n    'click a.title':        '_changeTitle',\n    'click .metadata a':    '_changeMetadata',\n    'click a.options':      '_openOptionsMenu',\n    'click a.share':        '_shareVisualization',\n    'click a.privacy':      '_showPrivacyDialog',\n    'click header nav a':   '_onTabClick'\n  },\n\n  initialize: function(options) {\n\n    _.bindAll(this, '_changeTitle', '_setPrivacy');\n\n    this.$body = $('body');\n    this.dataLayer = null;\n    this.globalError = this.options.globalError;\n    this._initBinds();\n\n    // Display all the visualization info\n    this.setInfo();\n  },\n\n  // Set new dataLayer from the current layerView\n  setActiveLayer: function(layerView) {\n    // Clean before bindings\n    if (this.dataLayer) {\n      this.dataLayer.unbind('applySQLView applyFilter errorSQLView clearSQLView', this.setEditableInfo,  this);\n      this.dataLayer.table.unbind('change:isSync', this.setEditableInfo, this);\n      this.dataLayer.table.unbind('change:permission', this.setInfo, this);\n    }\n\n    // Set new datalayer\n    this.dataLayer = layerView.model;\n\n    // Apply bindings if model is not a visualization\n    if (!this.model.isVisualization()) {\n      this.dataLayer.bind('applySQLView applyFilter errorSQLView clearSQLView', this.setEditableInfo,  this);\n      this.dataLayer.table.bind('change:isSync', this.setEditableInfo, this);\n      this.dataLayer.table.bind('change:permission', this.setInfo, this);\n      this.setEditableInfo();\n    }\n\n  },\n\n  _initBinds: function() {\n    this.model.bind('change:name',        this._setName,            this);\n    this.model.bind('change:type',        this.setInfo,             this);\n    this.model.bind('change:privacy',     this._setPrivacy,      this);\n    this.model.bind('change:permission',  this._setSharedCount,  this);\n  },\n\n  _openOptionsMenu: function(e) {\n    this.killEvent(e);\n\n    var self = this;\n    var $target = $(e.target);\n\n    // Options menu\n    this.options_menu = new cdb.admin.HeaderOptionsMenu({\n      target: $(e.target),\n      model: this.model, // master_vis\n      dataLayer: this.dataLayer,\n      user: this.options.user,\n      private_tables: this.options.user.get(\"actions\").private_tables,\n      geocoder: this.options.geocoder,\n      backgroundPollingModel: this.options.backgroundPollingModel,\n      globalError: this.options.globalError,\n      template_base: 'table/header/views/options_menu'\n    }).bind(\"onDropdownShown\",function(ev) {\n      cdb.god.unbind(\"closeDialogs\", self.options_menu.hide, self.options_menu);\n      cdb.god.trigger(\"closeDialogs\");\n      cdb.god.bind(\"closeDialogs\", self.options_menu.hide, self.options_menu);\n    }).bind('onDropdownHidden', function() {\n      this.clean();\n      $target.unbind('click');\n      cdb.god.unbind(null, null, self.options_menu);\n    });\n\n    this.$body.append(this.options_menu.render().el);\n    this.options_menu.open(e);\n  },\n\n  /**\n   *  Share visualization function, it could show\n   *  the name dialog to create a new visualization\n   *  or directly the share dialog :).\n   */\n  _shareVisualization: function(e) {\n    this.killEvent(e);\n\n    var view;\n    if (this.model.isVisualization()) {\n      view = new cdb.editor.PublishView({\n        clean_on_hide: true,\n        enter_to_confirm: true,\n        user: this.options.user,\n        model: this.model // vis\n      });\n    } else {\n      view = new cdb.editor.CreateVisFirstView({\n        clean_on_hide: true,\n        enter_to_confirm: true,\n        model: this.model,\n        router: window.table_router,\n        title: 'A map is required to publish',\n        explanation: 'A map is a shareable mix of layers, styles and queries. You can view all your maps in your dashboard.'\n      });\n    }\n    view.appendToBody();\n  },\n\n  _showPrivacyDialog: function(e) {\n    if (e) this.killEvent(e);\n\n    if (this.model.isOwnedByUser(this.options.user)) {\n      var dialog = new cdb.editor.ChangePrivacyView({\n        vis: this.model, //vis\n        user: this.options.user,\n        enter_to_confirm: true,\n        clean_on_hide: true\n      });\n      dialog.appendToBody();\n    }\n  },\n\n  /**\n   *  Set visualization info\n   */\n  setInfo: function() {\n    this._setName();\n    this._setSyncInfo();\n    this._setVisualization();\n    this._setMetadata();\n  },\n\n  /**\n   *  Set editable visualization info\n   */\n  setEditableInfo: function() {\n    this._setName();\n    this._setSyncInfo();\n    this._setMetadata();\n  },\n\n  _setPrivacy: function() {\n\n    var $share  = this.$('a.privacy');\n\n    // Update shared count if it is neccessary\n    this._setSharedCount();\n\n    var privacy = this.model.get(\"privacy\").toLowerCase();\n\n    if (privacy == \"public\") {\n\n      $share\n      .removeClass(\"private\")\n      .removeClass(\"link_protected\")\n      .removeClass(\"password_protected\")\n      .removeClass(\"organization\")\n      .addClass(\"public\");\n\n    } else if (privacy == \"link\"){\n\n      $share\n      .removeClass(\"public\")\n      .removeClass(\"private\")\n      .removeClass(\"password_protected\")\n      .removeClass(\"organization\")\n      .addClass(\"link_protected\");\n\n    } else if (privacy == \"private\"){\n\n      $share\n      .removeClass(\"public\")\n      .removeClass(\"link_protected\")\n      .removeClass(\"password_protected\")\n      .removeClass(\"organization\")\n      .addClass(\"private\");\n\n    } else if (privacy == \"password\"){\n\n      $share\n      .removeClass(\"private\")\n      .removeClass(\"link_protected\")\n      .removeClass(\"public\")\n      .removeClass(\"organization\")\n      .addClass(\"password_protected\");\n\n    } else if (privacy == \"organization\"){\n\n      $share\n      .removeClass(\"private\")\n      .removeClass(\"link_protected\")\n      .removeClass(\"public\")\n      .removeClass(\"password_protected\")\n      .addClass(\"organization\");\n\n    }\n\n    // User is owner of this visualization (table or derived)?\n    var isOwner = this.model.permission.isOwner(this.options.user);\n    $share.find('i')[ isOwner ? 'removeClass' : 'addClass' ]('disabled');\n\n  },\n\n  _setSharedCount: function() {\n    var isOwner = this.model.permission.isOwner(this.options.user);\n    var $share  = this.$('a.privacy i');\n\n    $share.empty();\n\n    if (isOwner) {\n      var $count = $('<span>').addClass('shared_users');\n\n      if (this.model.permission.acl.size() > 0) {\n        // Get total shared users or if the whole organization has access\n        var shared_users = 0;\n        var users_perm = this.model.permission.getUsersWithAnyPermission();\n\n        if (this.model.permission.isSharedWithOrganization()) {\n          shared_users = 'ORG';\n        } else {\n          shared_users = users_perm.length;\n        }\n\n        $count.text( (shared_users !== 0) ? shared_users : '' );\n\n        $share.append($count);\n      }\n    }\n  },\n\n  /**\n   *  Change metadata link text\n   */\n  _setMetadata: function() {\n    var isOwner = this.model.permission.isOwner(this.options.user);\n    var $metadata = this.$('.metadata a');\n\n    var text = this._TEXTS.metadata.edit;\n    var href = \"#/edit-metadata\";\n\n    if (!isOwner) {\n      text = this._TEXTS.metadata.view;\n      href = \"#/view-metadata\";\n    }\n\n    $metadata\n      .attr('href', href)\n      .text(text);\n  },\n\n  /**\n   *  Set layer sync info if it is needed\n   */\n  _setSyncInfo: function() {\n    this.sync_info && this.sync_info.clean();\n\n    if (!this.model.isVisualization() && this.isSyncTable()) {\n      this.$el.addClass('synced');\n\n      this.sync_info = new cdb.admin.SyncInfo({\n        dataLayer: this.dataLayer,\n        user: this.options.user\n      });\n\n      this.$('.sync_status').append(this.sync_info.render().el);\n      this.addView(this.sync_info);\n\n    } else {\n      this.$el.removeClass('synced');\n    }\n  },\n\n  /**\n   *  Set name of the visualization\n   */\n  _setName: function() {\n    var $title = this.$('h1 a.title');\n\n    $title\n      [(this.isVisEditable() && !this.isSyncTable()) ? 'removeClass' : 'addClass' ]('disabled')\n      .text(this.model.get('name'))\n\n    document.title = this.model.get('name') + \" | CARTO\";\n  },\n\n\n  /**\n   *  Set visualization type and change share button\n   */\n  _setVisualization: function() {\n    // Change visualization type\n    var $back            = this.$('a.back');\n    var $share           = this.$('a.share');\n    var is_visualization = this.model.isVisualization();\n\n    if (is_visualization) {\n      $share.find(\"span\").text(this._TEXTS.share.publish);\n      this._setPrivacy();\n      var route = cdb.config.prefixUrl() + \"/dashboard/maps\";\n      $back.attr(\"href\", route );\n    } else {\n      $share.find(\"span\").text(this._TEXTS.share.visualize);\n      this._setPrivacy();\n      var route = cdb.config.prefixUrl() + \"/dashboard/datasets\";\n      $back.attr(\"href\", route );\n    }\n  },\n\n  /**\n   *  Change visualization metadata\n   */\n  _changeMetadata: function(ev) {\n    ev.preventDefault();\n\n    var dlg = new cdb.editor.EditVisMetadataView({\n      maxLength: this._MAX_DESCRIPTION_LENGTH,\n      vis: this.model,\n      dataLayer: this.dataLayer && this.dataLayer.table,\n      user: this.options.user,\n      clean_on_hide: true,\n      enter_to_confirm: false,\n      onShowPrivacy: this._showPrivacyDialog.bind(this),\n      onDone: this._onChangeMetadata.bind(this)\n    });\n\n    dlg.appendToBody();\n  },\n\n  _onChangeMetadata: function(nameChanged) {\n    // Check if attr saved is name to change url when\n    // visualization is table type\n    if (nameChanged && !this.model.isVisualization()) {\n      window.table_router.navigate(this._generateTableUrl(), {trigger: false});\n      window.table_router.addToHistory();\n    }\n  },\n\n  /**\n   *  Change visualization title\n   */\n  _changeTitle: function(e) {\n    this.killEvent(e);\n\n    var self = this;\n    var isOwner = this.model.permission.isOwner(this.options.user);\n\n    if (this.isVisEditable()) {\n      this.title_dialog && this.title_dialog.clean();\n      cdb.god.trigger(\"closeDialogs\");\n\n      var title_dialog = this.title_dialog = new cdb.admin.EditTextDialog({\n        initial_value: this.model.get('name'),\n        template_name: 'table/views/edit_name',\n        clean_on_hide: true,\n        modal_class: 'edit_name_dialog',\n        onResponse: setTitle\n      });\n\n      cdb.god.bind(\"closeDialogs\", title_dialog.hide, title_dialog);\n\n      // Set position and show\n      var pos = $(e.target).offset();\n      pos.left -= $(window).scrollLeft()\n      pos.top -= $(window).scrollTop()\n      var w = Math.max($(e.target).width() + 100, 280);\n      title_dialog.showAt(pos.left - 20, pos.top - 10, w);\n    } else {\n      var $el = $(e.target);\n      $el\n        .bind('mouseleave', destroyTipsy)\n        .tipsy({\n          fade:     true,\n          trigger:  'manual',\n          html:     true,\n          title:    function() {\n            var mode = self.isSyncTable() ? 'sync' : 'read-only';\n            return _.template(self._TEXTS.rename[ !isOwner ? 'owner' : 'readonly' ])({ mode: mode })\n          }\n        })\n        .tipsy('show')\n    }\n\n    function destroyTipsy() {\n      var $el = $(this);\n      var tipsy = $el.data('tipsy');\n      if (tipsy) {\n        $el\n          .tipsy('hide')\n          .unbind('mouseleave', destroyTipsy);\n      }\n    }\n\n    function setTitle(val) {\n      if (val !== self.model.get('name') && val != '') {\n        // Sanitize description (html and events)\n        var title = cdb.Utils.stripHTML(val,'');\n\n        if (self.model.isVisualization()) {\n          self._onSetAttributes({ name: title });\n        } else {\n          // close any prev modal if existing\n          if (self.change_confirmation) {\n            self.change_confirmation.clean();\n          }\n          self.change_confirmation = cdb.editor.ViewFactory.createDialogByTemplate('common/dialogs/confirm_rename_dataset');\n\n          // If user confirms, app set the new name\n          self.change_confirmation.ok = function() {\n            self._onSetAttributes({ name: title });\n            if (_.isFunction(this.close)) {\n              this.close();\n            }\n          };\n\n          self.change_confirmation\n            .appendToBody()\n            .open();\n        }\n      }\n    }\n  },\n\n\n\n  /**\n   *  Wait function before set new visualization attributes\n   */\n  _onSetAttributes: function(d) {\n\n    var old_data = this.model.toJSON();\n    var new_data = d;\n\n    this.model.set(d, { silent: true });\n\n    // Check if there is any difference\n    if (this.model.hasChanged()) {\n      var self = this;\n\n      this.globalError.showError(this._TEXTS.saving, 'load', -1);\n\n      this.model.save({},{\n        wait: true,\n        success: function(m) {\n          // Check if attr saved is name to change url\n          if (new_data.name !== old_data.name && !self.model.isVisualization()) {\n            window.table_router.navigate(self._generateTableUrl(), {trigger: false});\n            window.table_router.addToHistory();\n          }\n\n          self.globalError.showError(self._TEXTS.saved, 'info', 3000);\n        },\n        error: function(msg, resp) {\n          var err =  resp && JSON.parse(resp.responseText).errors[0];\n          self.globalError.showError(err, 'error', 3000);\n          self.model.set(old_data, { silent: true });\n          self.setInfo();\n        }\n      });\n    }\n\n\n  },\n\n  /**\n   *  Check if visualization/table is editable\n   *  (Checking if it is visualization and/or data layer is in sql view)\n   */\n  isVisEditable: function() {\n    if (this.model.isVisualization()) {\n      return true;\n    } else {\n      var table = this.dataLayer && this.dataLayer.table;\n\n      if (!table) {\n        return false;\n      } else if (table && (table.isReadOnly() || !table.permission.isOwner(this.options.user))) {\n        return false;\n      } else {\n        return true;\n      }\n    }\n  },\n\n\n  isSyncTable: function() {\n    if (this.dataLayer && this.dataLayer.table) {\n      return this.dataLayer.table.isSync();\n    }\n    return false;\n  },\n\n\n  _generateTableUrl: function(e) {\n    // Let's create the url ourselves //\n    var url = '';\n\n    // Check visualization type and get table or viz id\n    if (this.model.isVisualization()) {\n      url += '/viz/' + this.model.get('id');\n    } else {\n      var isOwner = this.model.permission.isOwner(this.options.user);\n      var table = new cdb.admin.CartoDBTableMetadata(this.model.get('table'));\n\n      // Qualify table urls if user is not the owner\n      if (!isOwner) {\n        var owner_username = this.model.permission.owner.get('username');\n        url += '/tables/' + owner_username + '.' + table.getUnqualifiedName();\n      } else {\n        url += '/tables/' + table.getUnqualifiedName();\n      }\n    }\n\n    // Get scenario parameter from event or current url (table or map)\n    var current = e ? $(e.target).attr('href') : window.location.pathname;\n    if (current.search('/map') != -1) {\n      url += '/map'\n    } else {\n      url += '/table'\n    }\n\n    return url;\n  },\n\n\n  _onTabClick: function(e) {\n    e.preventDefault();\n    window.table_router.navigate(this._generateTableUrl(e), {trigger: true});\n  }\n});\n","\n/**\n * use as global hotkey watcher:\n *\n * cdb.god.bind('hotkey:s', function() ...\n */\n\ncdb.admin.hotkeys = {\n\n  _keyMap: {\n    68: 's',\n    67: 'c',\n    83: 's'\n  },\n\n  enable: function() {\n    $('body').bind('keydown', function(e) {\n      if(e.altKey && e.ctrlKey) {\n        var evt = cdb.admin.hotkeys._keyMap[e.keyCode];\n        if(evt) {\n          cdb.god.trigger('hotkey:' + evt, e);\n          e.preventDefault();\n          e.stopPropagation();\n          return false;\n        }\n      }\n    });\n  }\n};\n","(function(){\n  var localStorageWrapper = function(name) {\n    this.name = name;\n  }\n\n  localStorageWrapper.prototype.get = function(n) {\n\n    if (localStorage.getItem(this.name)) {\n\n      if (n === undefined) {\n        return JSON.parse(localStorage.getItem(this.name));\n      } else {\n        var data = JSON.parse(localStorage.getItem(this.name));\n        return data[n];\n      }\n    } else {\n      return [];\n    }\n\n  }\n\n  localStorageWrapper.prototype.search = function(searchTerm) {\n    var wholeArray = JSON.parse(localStorage.getItem(this.name));\n    for(var i in wholeArray) {\n      if(wholeArray[i][searchTerm]) {\n        return wholeArray[i][searchTerm];\n      }\n    }\n    return null;\n  }\n\n  localStorageWrapper.prototype.set = function(data) {\n\n    if (!localStorage.getItem(this.name)) {\n      localStorage.setItem(this.name, \"[]\");\n    }\n    return localStorage.setItem(this.name, JSON.stringify(data));\n  }\n\n  localStorageWrapper.prototype.add = function(obj) {\n    var data = this.get();\n    if (data) {\n      data.push(obj);\n      return this.set(data);\n    }\n  }\n\n  localStorageWrapper.prototype.remove = function(n) {\n    var data = this.get();\n    data.splice(n,n);\n    return this.set(data);\n  }\n\n  localStorageWrapper.prototype.destroy = function() {\n    localStorage.removeItem(this.name);\n  }\n\n  cdb.admin.localStorage = localStorageWrapper;\n}())\n","\n  /**\n   *  Metrics class for CartoDB\n   *\n   *  - Track user events in CartoDB.\n   *  - When an event is launched, you can use our God to\n   *  save the action (cdb.god.trigger('metrics', '{{ metric_name }}', { email: {{ email }}, data: {{ data }} });).\n   *\n   *  new cdb.admin.Metrics();\n   */\n\n  cdb.admin.Metrics = cdb.core.Model.extend({\n\n    initialize: function(opts) {\n      this.bindEvents();\n    },\n\n    bindEvents: function() {\n      cdb.god.bind(\"metrics\", this._setTrack, this);\n    },\n\n    _setTrack: function(name, obj) {\n\n      // HubSpot tracking\n      if (window.hubspot_token) {\n        window._hsq = window._hsq || [];\n        window._hsq.push(['identify', {\n          email: obj.email\n        }]);\n\n        var event_id;\n\n        switch(name) {\n          case 'published_visualization':\n            event_id = window.hubspot_ids.published_visualization\n            break;\n          case 'visited_dashboard':\n            event_id = window.hubspot_ids.visited_dashboard\n            break;\n          case 'connect_dataset':\n            event_id = window.hubspot_ids.connect_dataset\n            break;\n          case 'create_map':\n            event_id = window.hubspot_ids.create_map\n            break;\n          case 'export_table':\n            event_id = window.hubspot_ids.export_table\n            break;\n          case 'export_map':\n            event_id = window.hubspot_ids.export_map;\n            break;\n          case 'select_wms':\n            event_id = window.hubspot_ids.select_wms\n            break;\n          case 'color_basemap':\n            event_id = window.hubspot_ids.color_basemap\n            break;\n          case 'pattern_basemap':\n            event_id = window.hubspot_ids.pattern_basemap\n            break;\n          case 'geocoding':\n            event_id = window.hubspot_ids.geocoding\n            break;\n          case 'visual_merge':\n            event_id = window.hubspot_ids.visual_merge\n            break;\n          case 'common_data':\n            event_id = window.hubspot_ids.common_data\n            break;\n          case 'cartocss_manually':\n            event_id = window.hubspot_ids.cartocss_manually\n            break;\n          case 'wizard':\n            event_id = window.hubspot_ids.wizard\n            break;\n          case 'filter':\n            event_id = window.hubspot_ids.filter\n            break;\n          case 'query':\n            event_id = window.hubspot_ids.query\n            break;\n          case 'logged_in':\n            event_id = window.hubspot_ids.logged_in\n            break;\n          case 'visited_dashboard_first_time':\n            event_id = window.hubspot_ids.visited_dashboard_first_time\n            break;\n          case 'applied_pecan':\n            event_id = window.hubspot_ids.applied_pecan\n            break;\n          case 'open_pecan_list':\n            event_id = window.hubspot_ids.open_pecan_list\n            break;\n\n        }\n\n        window._hsq.push(['trackEvent', {\n          id: event_id\n        }]);\n      }\n\n    }\n\n  });\n","/**\n * base class for all small dialogs\n * inherit from this class, see EditTextDialog\n * for an example\n */\ncdb.admin.SmallDialog = cdb.ui.common.Dialog.extend({\n\n  className: 'floating',\n\n  initialize: function() {\n    _.extend(this.options, {\n              title: '',\n              description: '',\n              clean_on_hide: true\n    });\n    cdb.ui.common.Dialog.prototype.initialize.apply(this);\n    this.render();\n    $(document.body).append(this.el);\n  },\n\n  /** show at position */\n  showAt: function(x, y, width, fix) {\n    this.$el.css({\n      top: y,\n      left: x,\n      minWidth: width\n    });\n\n    if (fix) {\n      this.$el.find(\"> textarea, > input\").css({\n        minWidth: width - 22\n      })\n    }\n\n    this.show();\n  },\n\n  /**\n   * show the dialog on top of an element\n   * useful in events:\n      dlg.showAtElement(e.target);\n   */\n  showAtElement: function(el) {\n    var pos = $(el).offset();\n    this.showAt(pos.left, pos.top);\n  }\n});\n\ncdb.admin.EditTextDialog = cdb.admin.SmallDialog.extend({\n\n  events: cdb.core.View.extendEvents({\n    'keypress input': '_keyPress',\n    'click': '_stopPropagation'\n  }),\n\n  initialize: function() {\n    _.defaults(this.options, {\n      template_name: 'old_common/views/dialog_small_edit',\n      ok_title: 'Save',\n      modal_class: 'edit_text_dialog',\n      clean_on_hide: true\n    });\n    this.constructor.__super__.initialize.apply(this);\n  },\n\n  render_content: function() {\n    this._focusInput();\n    var input = '<input value=\"' + this.options.initial_value.replace(/\\\"/g,'&quot;').replace(/\\'/g,\"&#39;\") + '\" ';\n    if(this.options.maxLength) {\n      input += 'maxLength = ' + this.options.maxLength;\n    }\n    input += ' type=\"text\"/>';\n    return input;\n  },\n\n  _stopPropagation: function(e) {\n    e.stopPropagation();\n  },\n\n  _focusInput: function() {\n    var self = this;\n    setTimeout(function(){\n      var width = self.$el.outerWidth() - self.$el.find(\"a.button\").outerWidth() - 35;\n      self.$el.find(\"input\").width(width).focus();\n    },0);\n  },\n\n  _keyPress: function(e) {\n    if(e.keyCode === 13) {\n      this._ok();\n    }\n  },\n\n  ok: function() {\n    if(this.options.onResponse) {\n      this.options.onResponse(this.$('input').val());\n    }\n  }\n});\n\ncdb.admin.EditMarkdownDialog = cdb.admin.SmallDialog.extend({\n\n  events: cdb.core.View.extendEvents({\n    'keypress input': '_keyPress',\n    'click': '_stopPropagation'\n  }),\n\n  initialize: function() {\n    _.defaults(this.options, {\n      old_template_name: 'old_common/views/dialog_markdown_edit',\n      ok_title: 'Save',\n      modal_class: 'edit_name_dialog markdown',\n      clean_on_hide: true\n    });\n    this.constructor.__super__.initialize.apply(this);\n  },\n\n  render_content: function() {\n    this._focusInput();\n    var input = '<div class=\"input_field\"><input value=\"' + this.options.initial_value.replace(/\\\"/g,'&quot;').replace(/\\'/g,\"&#39;\") + '\" ';\n    if(this.options.maxLength) {\n      input += 'maxLength = ' + this.options.maxLength;\n    }\n    input += ' type=\"text\"/><div class=\"hint\"><strong>**bold**</strong> <em>*italics*</em> [link title](url)</div></div>';\n    return input;\n  },\n\n  _stopPropagation: function(e) {\n    e.stopPropagation();\n  },\n\n  _focusInput: function() {\n    var self = this;\n    setTimeout(function(){\n      var width = self.$el.outerWidth() - self.$el.find(\"a.button\").outerWidth() - 35;\n      self.$el.find(\".input_field\").width(width);\n      self.$el.find(\".input_field input\").focus();\n    },0);\n  },\n\n  _keyPress: function(e) {\n    if(e.keyCode === 13) {\n      this._ok();\n    }\n  },\n\n  ok: function() {\n    if(this.options.onResponse) {\n      this.options.onResponse(this.$('input').val());\n    }\n  }\n\n \n});","\ncdb.admin.Tabs = cdb.core.View.extend({\n\n    events: {\n      'click': '_click'\n    },\n\n    initialize: function() {\n      _.bindAll(this, 'activate');\n      this.preventDefault = false;\n    },\n\n    activate: function(name) {\n      this.$('a').removeClass('selected');\n      this.$('a[href$=\"#'+ ((this.options.slash) ? '/' : '') + name + '\"]').addClass('selected');\n    },\n\n    desactivate: function(name) {\n      this.$('a[href$=\"#' + ((this.options.slash) ? '/' : '') + name + '\"]').removeClass('selected');\n    },\n\n    disable: function(name) {\n      this.$('a[href$=\"#' + ((this.options.slash) ? '/' : '') + name + '\"]').addClass('disabled');\n    },\n\n    enable: function(name) {\n      this.$('a[href$=\"#' + ((this.options.slash) ? '/' : '') + name + '\"]').removeClass('disabled');\n    },\n\n    getTab: function(name) {\n      return this.$('a[href$=\"#' + ((this.options.slash) ? '/' : '') + name + '\"]');\n    },\n\n    disableAll: function() {\n      this.$('a').addClass('disabled');\n    },\n\n    removeDisabled: function() {\n      this.$('.disabled').parent().remove();\n    },\n\n    _click: function(e) {\n      if (e && this.preventDefault) e.preventDefault();\n\n      var\n      t    = $(e.target).closest('a'),\n      href = t.attr('href');\n\n      if (!t.hasClass('disabled') && href) {\n        var name = href.replace('#/', '#').split('#')[1];\n        this.trigger('click', name);\n      }\n    },\n\n    linkToPanel: function(panel) {\n      this.preventDefault = true;\n      panel.bind('tabEnabled', this.activate, this);\n      this.bind('click', panel.active, panel);\n    }\n\n});\n","\n  /**\n   *  Tipsy tooltip view.\n   *\n   *  - Needs an element to work.\n   *  - Inits tipsy library.\n   *  - Clean bastard tipsy bindings easily.\n   *\n   */\n\n\n  cdb.common.TipsyTooltip = cdb.core.View.extend({\n\n    options: {\n      gravity:  's',\n      fade:     true\n    },\n\n    initialize: function(opts) {\n      if (opts.el === undefined) {\n        cdb.log.info('Element is needed to have tipsy tooltip working');\n        return false;\n      }\n      this._tipsyOpenedManually = opts.trigger === 'manual';\n\n      this._initTipsy();\n    },\n\n    showTipsy: function() {\n      this.$el.tipsy('show');\n    },\n\n    hideTipsy: function() {\n      this.$el.tipsy('hide');\n    },\n\n    _initTipsy: function() {\n      this.$el.tipsy(this.options);\n      this.tipsy = this.$el.data('tipsy');\n    },\n\n    _destroyTipsy: function() {\n      if (this.tipsy) {\n        // tipsy does not return this\n        this.tipsy.hide();\n        this.$el.unbind('mouseleave mouseenter');\n      }\n      if (this._tipsyOpenedManually) {\n        this.$el.tipsy('hide');\n      }\n    },\n\n    clean: function() {\n      this._destroyTipsy();\n      cdb.core.View.prototype.clean.call(this);\n    }\n\n  });\n","\n  /**\n   *  Tooltip that follows the mouse while dragging, you have\n   *   to use jQuery UI lib to get events when dragging.\n   */\n\n  cdb.admin.TooltipTrails = cdb.core.View.extend({\n\n    className: 'tooltip-trails',\n    tagName: 'div',\n\n    options: {\n      msg: _t('Checking tooltip-trails'),\n      offset: [15,5] // X,Y\n    },\n\n    render: function() {\n      this.$el.append(this.options.msg);\n      return this;\n    },\n\n    show: function(pos) {\n      this.$el.css({\n        'margin-left': this.options.offset[0],\n        'margin-top': this.options.offset[1],\n        'left':  pos.left,\n        'top': pos.top\n      })\n\n      this.$el.show();\n    },\n\n    // Needs left and top object\n    move: function(pos) {\n      this.$el.css(pos);\n    },\n\n    hide: function() {\n      this.$el.hide();\n      this.clean();\n    }\n\n  })","/**\n * URL representing dashboard datasets\n */\ncdb.common.DashboardDatasetsUrl = cdb.common.DashboardVisUrl.extend({\n\n  dataLibrary: function() {\n    return this.urlToPath('library');\n  }\n});\n","/**\n * URLs associated with the dashboard.\n */\ncdb.common.DashboardUrl = cdb.common.Url.extend({\n\n  datasets: function() {\n    return new cdb.common.DashboardDatasetsUrl({\n      base_url: this.urlToPath('datasets')\n    });\n  },\n\n  maps: function() {\n    return new cdb.common.DashboardVisUrl({\n      base_url: this.urlToPath('maps')\n    });\n  },\n\n  deepInsights: function() {\n    return new cdb.common.DashboardVisUrl({\n      base_url: this.urlToPath('deep-insights')\n    });\n  }\n});\n","/**\n * URL for a dataset (standard vis).\n */\ncdb.common.DatasetUrl = cdb.common.Url.extend({\n\n  edit: function() {\n    return this.urlToPath();\n  },\n\n  public: function() {\n    return this.urlToPath('public');\n  }\n});\n","/**\n * URL for a map (derived vis).\n */\ncdb.common.MapUrl = cdb.common.Url.extend({\n\n  edit: function() {\n    return this.urlToPath('map');\n  },\n\n  public: function() {\n    return this.urlToPath('public_map');\n  },\n\n  deepInsights: function() {\n    return this.urlToPath('deep-insights');\n  }\n});\n","/**\n * URL for a map (derived vis).\n */\ncdb.common.OrganizationUrl = cdb.common.Url.extend({\n\n  edit: function(user) {\n    if (!user) {\n      throw new Error('User is needed to create the url');\n    }\n    return this.urlToPath(user.get('username') + '/edit');\n  },\n\n  create: function() {\n    return this.urlToPath('new');\n  },\n\n  groups: function() {\n    return this.urlToPath('groups');\n  }\n\n});\n","/**\n * URLs associated with a particular user.\n */\ncdb.common.UserUrl = cdb.common.Url.extend({\n\n  initialize: function (attrs) {\n    cdb.common.Url.prototype.initialize.apply(this, arguments);\n    if (_.isUndefined(attrs.is_org_admin)) {\n      throw new Error('is_org_admin is required')\n    }\n  },\n\n  organization: function() {\n    if (this.get('is_org_admin')) {\n      return new cdb.common.OrganizationUrl({\n        base_url: this.urlToPath('organization')\n      });\n    } else {\n      return this.urlToPath('account');\n    }\n  },\n\n  accountSettings: function() {\n    return this.urlToPath('profile');\n  },\n\n  publicProfile: function() {\n    return this.urlToPath('me');\n  },\n\n  apiKeys: function() {\n    return this.urlToPath('your_apps');\n  },\n\n  logout: function() {\n    return this.urlToPath('logout');\n  },\n\n  dashboard: function() {\n    return new cdb.common.DashboardUrl({\n      base_url: this.urlToPath('dashboard')\n    });\n  }\n});\n","/**\n *  Video player\n *\n */\ncdb.admin.VideoModel = cdb.core.Model.extend({\n\n  defaults: {\n    minimized: true,\n    size: {\n      minimized: {\n        width: 420,\n        height: 236\n      },\n      maximized: {\n        width : 700,\n        height: 393\n      }\n    },\n  },\n\n  initialize: function () {\n\n    this._initLocalStorage();\n\n    var minimized = this.defaults.minimized;\n\n    if (this.videoData && this.videoData.minimized !== undefined) {\n      minimized = this.videoData.minimized;\n    }\n\n    var defaults = this.defaults.size[minimized ? \"minimized\" : \"maximized\"];\n\n    this.set({\n      minimized: minimized,\n      width: defaults.width,\n      height: defaults.height,\n      seconds: this.videoData ? this.videoData.seconds : 0,\n      top: this.videoData ? this.videoData.top : null,\n      left: this.videoData ? this.videoData.left : 20,\n      bottom: this.videoData ? this.videoData.bottom : 20\n    });\n\n    this.bind('change',  this._onChangeProperty, this);\n    this.bind('change:minimized', this._onChangeMinimized, this);\n\n  },\n\n  _initLocalStorage: function() {\n\n    this.localStorage = new cdb.admin.localStorage(\"VideoPlayer\");\n\n    this.videoData = this.localStorage.get(\"currentVideo\") || {};\n\n    var video_id = this.get(\"video_id\");\n\n    if (video_id) {\n      this._storeVideoID(video_id);\n      this.videoData = this.localStorage.get(\"currentVideo\");\n    } else {\n      this.set(\"video_id\", this.videoData.video_id);\n    }\n\n  },\n\n  _onChangeMinimized: function() {\n    var defaults = this.defaults.size[this.get(\"minimized\") ? \"minimized\" : \"maximized\"];\n    this.set(\"width\", defaults.width);\n    this.set(\"height\", defaults.height);\n\n  }, \n\n  _onChangeProperty: function(m) {\n    this.videoData = m.attributes;\n    this._saveVideoData();\n  },\n\n  _saveVideoData: function() {\n    this.set(this.videoData);\n    this.localStorage.set({ currentVideo: this.videoData });\n  },\n\n  _storeVideoID: function(id) {\n    this.videoData.video_id = id;\n    this._saveVideoData();\n  },\n\n  clearStoredData: function(status) {\n    this.set(\"video_id\", null);\n    this.videoData = {};\n    this.localStorage.set({ currentVideo: null });\n  }\n\n});\n\ncdb.admin.VideoPlayer = cdb.core.View.extend({\n\n  className: 'VideoPlayer',\n\n  events: {\n    \"dblclick\": \"_toggle\",\n    \"click .js-toggle\": \"_toggle\",\n    \"click .js-close\": \"close\",\n    \"mouseenter\": \"_mouseEnter\",\n    \"mouseleave\": \"_mouseLeave\"\n  },\n\n  initialize: function(id) {\n\n    _.bindAll(this, \"_onInitDraggable\", \"_onStopDragging\", \"_onCloseAnimationFinished\");\n\n    this.template = cdb.templates.getTemplate('dashboard/views/video_player');\n\n    this._initModel();\n  },\n\n  render: function() {\n\n    var self = this;\n\n    this.clearSubViews();\n\n    if (this.hasVideoData()) {\n\n      this.$el.html(\n        this.template({\n        id: this.model.get(\"video_id\")\n      }));\n\n      this.$el.draggable({\n        stop: self._onStopDragging,\n        create: self._onInitDraggable\n      });\n\n      this.video = this.$el.find(\"iframe\");\n      this._loadScript();\n\n    }\n\n    return this;\n\n  },\n\n  _initModel: function() {\n    this.model = new cdb.admin.VideoModel({ video_id: this.options.id });\n    this.model.bind('change:minimized', this._onChangeMinimized, this);\n  },\n\n  _loadScript: function() {\n    var self = this;\n    $.getScript('//f.vimeocdn.com/js/froogaloop2.min.js', function() {\n      self._initVideoBinds();\n    });\n  },\n\n  _initVideoBinds: function() {\n    var self = this;\n\n    this.player = $f(this.video[0]);\n\n    this.player.addEvent('ready', function() {\n\n      self._seekToStoredPosition();\n\n      self.player.addEvent('pause', function(m) {\n        self.model.set(\"status\", \"stop\");\n      });\n\n      self.player.addEvent('finish', function(m) {\n        self.model.set(\"status\", \"stop\");\n        self.close(false, { dontHide: true });\n      });\n\n      self.player.addEvent('play', function(m) {\n        self.model.set(\"status\", \"play\");\n      });\n\n      self.player.addEvent('playProgress', function(m) {\n        self.model.set(\"seconds\", m.seconds);\n      });\n\n    });\n  },\n\n  _removeVideoBinds: function() {\n    if (this.player) {\n      this.player.removeEvent('ready');\n    }\n  },\n\n  _onInitDraggable: function(e, ui) {\n\n    var bottom       = this.model.get(\"bottom\");\n    var left         = this.model.get(\"left\");\n    var elHeight     = this.model.get(\"height\");\n    var elWidth      = this.model.get(\"width\");\n    var windowWidth  = $(window).width();\n\n    if ((left + elWidth) > windowWidth) {\n      left = windowWidth - elWidth - 20;\n    }\n\n    this.$el.css({\n      position: \"fixed\",\n      left: left,\n      bottom: bottom\n    });\n\n    if (bottom < 0) {\n      this.$el.animate({ bottom: 20, width: elWidth, height: elHeight }, { easing: \"easeOutQuad\", duration: 200 });\n    } else {\n      this.$el.animate({ width: elWidth, height: elHeight }, { easing: \"easeOutQuad\", duration: 200 });\n    }\n\n  },\n\n  _onStopDragging: function(e, ui) {\n\n    var windowHeight = $(window).height();\n    var top          = ui.position.top;\n    var left         = ui.position.left;\n    var bottom       = windowHeight - (top + this.$el.outerHeight(true));\n\n    this.$el.css({ bottom: \"auto\"})\n\n    this.model.set({ top: top, left: left, bottom: bottom });\n  },\n\n  _mouseEnter: function() {\n    this.$el.find(\".VideoControls\").fadeIn(150);\n  },\n\n  _mouseLeave: function() {\n    this.$el.find(\".VideoControls\").fadeOut(150);\n  },\n\n  hasVideoData: function() {\n    if (this.model.get(\"video_id\")) {\n      return true;\n    } else {\n      return false;\n    }\n  },\n\n  _seekToStoredPosition: function() {\n\n    var self = this;\n\n    var seconds = this.model.get(\"seconds\");\n\n    if (seconds) {\n      this.player.api('seekTo', seconds);\n    }\n\n    if (this.model.get(\"status\") === \"stop\") {\n\n      setTimeout(function() {\n        self.player.api('pause');\n      }, 100);\n\n    }\n\n  },\n\n  close: function(e, opts) {\n\n    if (e) this.killEvent(e);\n\n    if (opts && opts.dontHide) {\n      this.model.clearStoredData();\n    } else {\n      this.$el.animate({ width: 0, height: 0, opacity: 0 }, { easing: \"easeInQuad\", duration: 200, complete: this._onCloseAnimationFinished });\n    }\n\n  },\n\n  _onCloseAnimationFinished: function() {\n    this.model.clearStoredData();\n    this._removeVideoBinds();\n    this.remove();\n  },\n\n  _toggle: function(e) {\n\n    if (e) this.killEvent(e);\n\n    this.model.set(\"minimized\", !!!this.model.get(\"minimized\"));\n  },\n\n  _onChangeMinimized: function() {\n\n    var self = this;\n\n    var windowWidth    = $(window).width();\n    var windowHeight   = $(window).height();\n    var documentHeight = $(document).height();\n\n    var bottom = this.model.get(\"bottom\");\n    var top    = this.model.get(\"top\");\n\n    var elTop  = this.$el.offset().top;\n    var elLeft = this.$el.position().left;\n\n    function setHorizontalPosition(w) {\n      if ((elLeft + w) > windowWidth) {\n        var right = windowWidth - elLeft - self.$el.outerWidth(true);\n        self.$el.css({ left: \"auto\", right: right });\n      }\n    }\n\n    function setVerticalPosition(h) {\n       if (top < 0 || self.$el.offset().top < 0) {\n        self.$el.animate({ top: 20 }, 100);\n       } else if (top - h < 0 || self.$el.offset().top - h < 0) {\n        self.$el.css({ bottom: \"auto\", top: top });\n      } else if (bottom < 0) {\n        self.$el.css({ top: \"auto\", bottom: 20 });\n      } else if ((top + h) > windowHeight) {\n        self.$el.css({ top: \"auto\", bottom: bottom });\n      } \n    }\n\n    var width  = this.model.get(\"width\");\n    var height = this.model.get(\"height\");\n\n    setHorizontalPosition(width);\n    setVerticalPosition(height);\n\n    this.$el.animate({ width: width, height: height }, { easing: \"easeOutQuad\", duration: 200, complete: function() {\n      var bottom = $(window).height() - ($(\".VideoPlayer\").offset().top + $(\".VideoPlayer\").outerHeight(true));\n      self.model.set(\"bottom\", bottom);\n    } });\n\n  }\n\n});\n","\n\ncdb.admin.WizardDialog = cdb.ui.common.Dialog.extend({\n});\n","\n/**\n * this class allows to have a menu where you can add new views as modules\n *\n * each view should have a method or a property to get buttonClass\n */\n\n\n(function() {\n\n  var Button = cdb.core.View.extend({\n\n    tagName: 'a',\n\n    events: {\n      'click': 'click'\n    },\n\n    initialize: function() {\n      _.bindAll(this, 'click');\n      this.elder('initialize');\n      this.enabled = true;\n    },\n\n    render: function() {\n      this.$el.addClass(this.className);\n      this.$el.append(this.className);\n      this.$el.attr(\"href\", \"#\" + this.className);\n      this.$el.append($('<span>').addClass(\"error\"));\n      this.$el.append($('<span>').addClass(\"run\"));\n      // Add tipsy\n      this.$el.tipsy({\n        gravity: \"e\",\n        fade: true,\n        offset: -10,\n        title: function() {\n          return $(this).attr(\"class\").replace(\"_mod\", \"\").replace(/_/g,\" \").replace(\"selected\", \"\")\n        }\n      });\n\n      return this;\n    },\n\n    show: function() {\n      this.$el.css('display', 'block');\n    },\n\n    /**\n     * Add a css class to the button, to preserve modularity\n     * @param {srting} className\n     */\n    addClass: function(className) {\n      this.$el.addClass(className);\n    },\n\n    /**\n     * Removes a css class from the button\n     * @param  {string} className\n     */\n    removeClass: function(className) {\n      this.$el.removeClass(className);\n    },\n\n    enable: function(b) {\n      this.enabled = b;\n      if(b) {\n        this.$el.removeClass('disabled');\n      } else {\n        this.$el.addClass('disabled');\n      }\n    },\n\n    click: function(e) {\n      if (e) e.preventDefault();\n      this.$el.tipsy(\"hide\");\n      if(this.enabled)\n        this.trigger('click', this.className);\n      return false;\n    }\n  });\n\n  cdb.admin.RightMenu = cdb.core.View.extend({\n\n    tagName: 'section',\n\n    initialize: function() {\n      this.panels = new cdb.ui.common.TabPane();\n      this.tabs = new cdb.admin.Tabs();\n      this.buttons = [];\n      this.addView(this.panels);\n      this.template = this.getTemplate('table/views/right_panel');\n      this.isOpen = true;\n    },\n\n    render: function() {\n      this.$el.append(this.template({}));\n      this.panels.setElement(this.$('.layer-views'));\n      this.tabs.setElement(this.$('.layer-sidebar'));\n      return this;\n    },\n\n    addToolButton: function(type, sections) {\n      var b = this._addButton(type, sections);\n      buttons = this.$('.edit');\n      buttons.append(b.render().$el);\n      return b;\n    },\n\n    _addButton: function(type, sections) {\n      var b = new Button();\n      b.className = type;\n      b.sections = _.isArray(sections) ? sections: [sections];\n      this.addView(b);\n\n      this.buttons.push(b);\n      b.show();\n      if(this.activeSection) {\n        if(!_.include(b.sections, this.activeSection)) {\n          b.hide();\n        }\n      }\n      return b;\n    },\n\n    /**\n     * Add a css class to a button\n     * @param {String} buttonType\n     * @param {String} className\n     */\n    addClassToButton: function(buttonType, className) {\n      var button = this.getButtonByClass(buttonType);\n      if (button)\n        button.addClass(className);\n    },\n    /**\n     * Remove a css class from a button\n     * @param {String} buttonType\n     * @param {String} className\n     */\n    removeClassFromButton: function(buttonType, className) {\n      var button = this.getButtonByClass(buttonType);\n      if (button)\n        button.removeClass(className);\n    },\n\n\n    addModule: function(v, sections) {\n      sections = sections || ['table'];\n      this.panels.addTab(v.buttonClass, v);\n\n      var b = this._addButton(v.buttonClass, sections);\n\n      var buttons = this.$('.tools');\n      buttons.append(b.render().$el);\n\n      // check if should be enabled\n      if(this.activeSection) {\n        if(!_.include(b.sections, this.activeSection)) {\n          b.hide();\n        }\n      }\n\n      // call togle before activate panel\n      b.bind('click', this.toggle, this);\n      b.bind('click', this.panels.active, this.panels);\n    },\n\n    active: function(modName) {\n      this.panels.active(modName);\n      this.tabs.activate(modName);\n    },\n\n    showTools: function(section) {\n      this.activeSection = section;\n      _(this.buttons).each(function(b) {\n        if(_.include(b.sections, section)) {\n          b.show();\n        } else {\n          b.hide();\n        }\n      });\n    },\n\n    enabledButtonsForSection: function(section) {\n      return _(this.buttons).filter(function(b) {\n        return _.include(b.sections, section);\n      });\n    },\n\n    disableModule: function(name) {\n      var button = this.getButtonByClass(name);\n      if(button) {\n        button.enable(false);\n        var p = this.panels.getPane(name);\n        if(p && p.disabled) {\n          p.disabled();\n        }\n      }\n    },\n\n    enableModule: function(name) {\n      var button = this.getButtonByClass(name);\n      if(button) {\n        button.enable(true);\n        var p = this.panels.getPane(name);\n        if(p && p.enabled) {\n          p.enabled();\n        }\n      }\n    },\n\n    toggle: function(modName) {\n      this.trigger('toggle', modName);\n    },\n\n    /**\n    * Return the menu button whose class is the received className\n    * @method getButtonByClass\n    * @param className {String}\n    * @returns Button\n    */\n    getButtonByClass: function(className) {\n      for(var i = 0, l = this.buttons.length; i < l; i++) {\n        if(this.buttons[i].className === className) {\n          return this.buttons[i]\n        }\n      }\n      return null;\n    }\n\n  });\n\n})();\n","cdb.admin.DEFAULT_BASEMAPS = {\n'CartoDB': [{\n    url: 'http://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png',\n    subdomains: 'abcd',\n    minZoom: 0,\n    maxZoom: 18,\n    name: 'Positron',\n    className: \"positron_rainbow_labels\",\n    attribution: '© <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors © <a href=\"https://carto.com/attributions\">CARTO</a>',\n    labels: {\n      url: 'http://{s}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}.png'\n    }\n  }, {\n    url: 'http://{s}.basemaps.cartocdn.com/dark_nolabels/{z}/{x}/{y}.png',\n    subdomains: 'abcd',\n    minZoom: 0,\n    maxZoom: 18,\n    name: '',\n    className: \"dark_matter_rainbow_labels\",\n    attribution: '© <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors © <a href=\"https://carto.com/attributions\">CARTO</a>',\n    labels: {\n      url: 'http://{s}.basemaps.cartocdn.com/dark_only_labels/{z}/{x}/{y}.png'\n    }\n  }, {\n    url: 'http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png',\n    subdomains: 'abcd',\n    minZoom: 0,\n    maxZoom: 18,\n    name: 'Positron (labels below)',\n    className: \"positron_rainbow\",\n    attribution: '© <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors © <a href=\"https://carto.com/attributions\">CARTO</a>'\n  }, {\n    url: 'http://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png',\n    subdomains: 'abcd',\n    minZoom: 0,\n    maxZoom: 18,\n    name: 'Dark matter (labels below)',\n    className: \"dark_matter_rainbow\",\n    attribution: '© <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors © <a href=\"https://carto.com/attributions\">CARTO</a>'\n  }, {\n    url: 'http://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png',\n    subdomains: 'abcd',\n    minZoom: 0,\n    maxZoom: 18,\n    name: 'Positron (lite)',\n    className: \"positron_lite_rainbow\",\n    attribution: '© <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors © <a href=\"https://carto.com/attributions\">CARTO</a>'\n  }, {\n    url: 'http://{s}.basemaps.cartocdn.com/dark_nolabels/{z}/{x}/{y}.png',\n    subdomains: 'abcd',\n    minZoom: 0,\n    maxZoom: 18,\n    name: 'Dark matter (lite)',\n    className: \"dark_matter_lite_rainbow\",\n    attribution: '© <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors © <a href=\"https://carto.com/attributions\">CARTO</a>'\n  }, {\n    url: 'https://cartocdn_{s}.global.ssl.fastly.net/base-antique/{z}/{x}/{y}.png',\n    subdomains: 'abcd',\n    minZoom: 0,\n    maxZoom: 10,\n    name: 'CartoDB World Antique',\n    className: \"antique_cartodb\",\n    attribution: \"\"\n  }, {\n    url: 'https://cartocdn_{s}.global.ssl.fastly.net/base-eco/{z}/{x}/{y}.png',\n    subdomains: 'abcd',\n    minZoom: 0,\n    maxZoom: 10,\n    name: 'CartoDB World Eco',\n    className: \"eco_cartodb\",\n    attribution: \"\"\n  }, {\n    url: 'https://cartocdn_{s}.global.ssl.fastly.net/base-flatblue/{z}/{x}/{y}.png',\n    subdomains: 'abcd',\n    minZoom: 0,\n    maxZoom: 10,\n    name: 'CartoDB World Flat Blue',\n    className: \"flat_blue\",\n    attribution: \"\"\n  }, {\n    url: 'https://cartocdn_{s}.global.ssl.fastly.net/base-midnight/{z}/{x}/{y}.png',\n    subdomains: 'abcd',\n    minZoom: 0,\n    maxZoom: 10,\n    name: 'CartoDB World Midnight Commander',\n    className: \"midnight_cartodb\",\n    attribution: \"\"\n  }\n],\n\n'Stamen': [{\n    url: 'https://stamen-tiles-{s}.a.ssl.fastly.net/toner-background/{z}/{x}/{y}.png',\n    subdomains: 'abcd',\n    minZoom: 0,\n    maxZoom: 18,\n    name: 'Toner',\n    className: \"toner_stamen_labels\",\n    attribution: 'Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, under <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a>. Data by <a href=\"http://openstreetmap.org\">OpenStreetMap</a>, under <a href=\"http://www.openstreetmap.org/copyright\">ODbL</a>.',\n    labels: {\n      url: 'http://{s}.tile.stamen.com/toner-labels/{z}/{x}/{y}.png'\n    }\n  }, {\n    url: 'https://stamen-tiles-{s}.a.ssl.fastly.net/toner/{z}/{x}/{y}.png',\n    subdomains: 'abcd',\n    minZoom: 0,\n    maxZoom: 18,\n    name: 'Toner (labels below)',\n    className: \"toner_stamen\",\n    attribution: 'Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, under <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a>. Data by <a href=\"http://openstreetmap.org\">OpenStreetMap</a>, under <a href=\"http://www.openstreetmap.org/copyright\">ODbL</a>.'\n  }, {\n    url: 'https://stamen-tiles-{s}.a.ssl.fastly.net/toner-background/{z}/{x}/{y}.png',\n    subdomains: 'abcd',\n    minZoom: 0,\n    maxZoom: 18,\n    name: 'Toner Background',\n    className: \"toner_background_stamen\",\n    attribution: 'Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, under <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a>. Data by <a href=\"http://openstreetmap.org\">OpenStreetMap</a>, under <a href=\"http://www.openstreetmap.org/copyright\">ODbL</a>.'\n  }, {\n    url: 'https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}.png',\n    subdomains: 'abcd',\n    minZoom: 0,\n    maxZoom: 18,\n    name: 'Toner Lite',\n    className: \"toner_lite_stamen\",\n    attribution: 'Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, under <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a>. Data by <a href=\"http://openstreetmap.org\">OpenStreetMap</a>, under <a href=\"http://www.openstreetmap.org/copyright\">ODbL</a>.'\n  }, {\n    url: 'https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lines/{z}/{x}/{y}.png',\n    subdomains: 'abcd',\n    minZoom: 0,\n    maxZoom: 18,\n    name: 'Toner Lines',\n    className: \"toner_lines_stamen\",\n    attribution: 'Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, under <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a>. Data by <a href=\"http://openstreetmap.org\">OpenStreetMap</a>, under <a href=\"http://www.openstreetmap.org/copyright\">ODbL</a>.'\n  }, {\n    url: 'https://stamen-tiles-{s}.a.ssl.fastly.net/toner-hybrid/{z}/{x}/{y}.png',\n    subdomains: 'abcd',\n    minZoom: 0,\n    maxZoom: 18,\n    name: 'Toner Hybrid',\n    className: \"toner_hybrid_stamen\",\n    attribution: 'Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, under <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a>. Data by <a href=\"http://openstreetmap.org\">OpenStreetMap</a>, under <a href=\"http://www.openstreetmap.org/copyright\">ODbL</a>.'\n  }, {\n    url: 'https://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png',\n    subdomains: 'abcd',\n    minZoom: 0,\n    maxZoom: 18,\n    name: 'Watercolor',\n    className: \"watercolor_stamen\",\n    attribution: 'Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, under <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a>. Data by <a href=\"http://openstreetmap.org\">OpenStreetMap</a>, under <a href=\"http://creativecommons.org/licenses/by-sa/3.0\">CC BY SA</a>.'\n  }]\n}\n","  \n  /**\n   *  Each module in a layer panel view.\n   *  It could be a filter mod, infowindow mod, sql mod,...\n   *\n   */\n\n  cdb.admin.Module = cdb.core.View.extend({\n\n    _STORAGE_NAMESPACE: \"cdb.localStorage.module.\",\n\n    // Set which action to do and width to set\n    // when module is active\n    _ACTION: {\n      type:   'narrow',\n      width:  450\n    },\n\n    // Get the module action\n    getModuleAction: function() {\n      return this._ACTION;\n    },\n\n    // Trigger module action change\n    triggerModuleAction: function() {\n      this.trigger('tabChanged', this.getModuleAction());\n    }\n\n  });","\n  /**\n   *  Carto CSS editor module\n   *\n   *  new cdb.admin.mod.CartoCSSEditor({\n   *    model: dataLayer\n   *    table: table\n   *  })\n   *\n   */\n\n\ncdb.admin.mod = cdb.admin.mod || {};\ncdb.admin.mod.CartoCSSEditor = cdb.admin.Module.extend({\n\n  _TEXTS: {\n    tip: '<strong>Ctrl + SPACE</strong> to autocomplete. <strong><%- key %> + S</strong> to apply your styles.'\n  },\n\n  _ACTION: {\n    type: 'show',\n    width: 600\n  },\n\n  buttonClass: 'cartocss_mod',\n  type: 'tool',\n\n  events: {\n    'click .actions button':  'applyStyle',\n    'click .actions a.next':  '_do',\n    'click .actions a.back':  '_undo',\n    'click .doc_info':        '_showDoc'\n  },\n\n  initialize: function() {\n    _.bindAll(this, '_onKeyUpEditor');\n\n    this.template = this.getTemplate('table/menu_modules/views/carto_editor');\n\n    this.model.bind('change',      this._updateStyle, this);\n    this.add_related_model(this.model);\n    this.add_related_model(this.model.table);\n\n    // Set query position from history array and last sql applied\n    var history   = this.model.get('tile_style_history')\n      , position  = this.model.tile_style_history_position\n      , style     = this.model.get('tile_style');\n\n    // Model doesn't persist last change, let's add in the history\n    if (style && style != \"\" && history && _.indexOf(history, style) === -1) {\n      history.push(style);\n      this.model.set({ \"tile_style_history\": history }, { silent:true });\n    }\n\n    // Get history position\n    this.model.tile_style_history_position =\n      _.indexOf(history, style) !== -1\n      ? _.indexOf(history, style)\n      : 0;\n\n    this.model.bind('parseError', this._showErrorFromServer, this);\n    /*\n    this.model.bind('tileError', this._renderError, this);\n    */\n    this.model.bind('tileOk', this._checkLocalErrors, this);\n    this.model.table.bind('change:schema', this._checkLocalErrors, this);\n\n    //this.buildAutocomplete();\n    this._initBinds();\n\n    cdb.god.bind('end_show', this.activated, this)\n    this.add_related_model(cdb.god);\n  },\n\n  /** builds autocomplete from cartcss reference */\n  buildAutocomplete: function() {\n    this.autocomplete = [];\n    if (typeof(window._mapnik_reference_latest) !== 'undefined') {\n      var symbolizers = _mapnik_reference_latest.symbolizers;\n      for (var s in symbolizers) {\n        var sym = symbolizers[s];\n        for (var p in sym) {\n          var css = sym[p].css;\n          if (css && css.length) {\n            this.autocomplete.push(css);\n          }\n        }\n      }\n    }\n  },\n\n  activated: function() {\n    if(this.codeEditor) {\n      this.codeEditor.refresh();\n      this.codeEditor.focus();\n      this._adjustCodeEditorSize();\n    }\n  },\n\n  render: function() {\n    var self = this;\n    this.clearSubViews();\n\n    this.$el.append(this.template({}));\n\n    this._initHelp();\n    this._initEditor();\n\n    this._updateStyle();\n    this._adjustCodeEditorSize();\n\n    return this;\n  },\n\n  _initBinds: function() {\n    // Codemirror extrakey\n    // Add save keymap\n    // PC & LINUX -> Ctrl + s\n    // MAC        -> Cmd + s\n    var ua      = navigator.userAgent.toLowerCase()\n      , so      = \"rest\"\n      , keymap  = \"ctrl+s\"\n      , self    = this;\n\n    if (/mac os/.test(ua)) {\n      keymap = \"meta+s\";\n      so = \"mac\";\n    }\n\n    this.$el.bind('keydown', keymap, function(ev) {\n      if (((so==\"mac\" && ev.metaKey) || (so==\"rest\" && ev.ctrlKey)) && ev.keyCode == 83 ) {\n        ev.preventDefault();\n        self.applyStyle();\n      }\n    });\n  },\n\n  _initEditor: function() {\n    var self = this;\n    this.codeEditor = CodeMirror.fromTextArea(this.$('textarea')[0], {\n      mode: \"text/x-carto\",\n      tabMode: \"indent\",\n      matchBrackets: true,\n      lineNumbers: true,\n      lineWrapping: true,\n      onKeyEvent: this._onKeyUpEditor,\n      extraKeys: {\n        \"Ctrl-Space\": function(cm) { self._showAutocomplete(cm) }\n      }\n    });\n\n    var color_picker = new cdb.admin.CodemirrorColorPicker({\n      editor: this.codeEditor,\n      model:  this.model\n    });\n    color_picker.bind('colorChosen', this.applyStyle, this);\n    this.addView(color_picker);\n\n    // Add tooltip for undo/redo buttons\n    this.$(\"a.next, a.back\").tipsy({\n      gravity: \"s\",\n      fade: true\n    });\n  },\n\n  _initHelp: function() {\n    var so = \"rest\";\n    var ua = navigator.userAgent.toLowerCase();\n\n    if (/mac os/.test(ua)) {\n      so = \"mac\";\n    }\n\n    var help = new cdb.admin.mod.HTMLEditorHelp({\n      localStorageKey: this._STORAGE_NAMESPACE + this.model.table.get('id'),\n      text: _.template(this._TEXTS.tip)({ key: (so == \"mac\") ? \"CMD\" : \"Ctrl\" })\n    }).bind(\"hide show\", this._adjustCodeEditorSize, this);\n    this.$el.append(help.render().$el);\n    this.addView(help);\n  },\n\n\n  _showAutocomplete: function(cm) {\n    CodeMirror.showHint(cm, CodeMirror.hint['custom-list-with-type'], {\n      completeSingle: false,\n      list: _.union( this._getTableName(), this._getSQLColumns())\n    });\n  },\n\n  _getTableName: function() {\n    return [ [ this.model.table.get('name'), \"T\" ] ]\n  },\n\n  _getSQLColumns: function() {\n    return _.map(\n      this.model.table.get('schema'),\n      function(pair) {\n        // Column name and type\n        return [pair[0], \"C\"]\n      });\n  },\n\n  _onKeyUpEditor: function(cm, e) {\n    var code = (e.keyCode ? e.keyCode : e.which);\n\n    if (e.type == \"keyup\" && code != 27 ) {\n      var self = this;\n\n      if (this.autocomplete_timeout) clearTimeout(this.autocomplete_timeout);\n\n      this.autocomplete_timeout = setTimeout(function() {\n        var cur = cm.getCursor();\n        var str = cm.getTokenAt(cur).string;\n        var schema = self.model.table.get('schema');\n\n        if (schema && str.length > 2) {\n          var arr = _.union(self.model.table.get('schema'), self._getTableName());\n          var list = _.compact(_.map(arr, function(pair) {\n            if (pair[0].search(str) != -1)\n              return pair[0];\n            return null;\n          }));\n\n          if (!cm.state.completionActive && str.length > 2 && list.length > 0) {\n            self._showAutocomplete(cm)\n          }\n        }\n\n      }, 150);\n    }\n  },\n\n  /** hack used to format the old styles transformed to cartodb 2.0*/\n  formatStyle: function(s) {\n    try {\n      if (s && s.length) {\n        s = s.replace(/{/g,'{\\n')\n            .replace(/}/g,'}\\n')\n            .replace(/;/g,';\\n')\n        var t = s.split('\\n');\n        var lines = [];\n        var c = 0;\n        for(var i = 0; i < t.length; ++i) {\n          lines.push(c);\n          if (t[i].indexOf('{')  != -1) {\n            ++c;\n          }\n          if (t[i].indexOf('}')  != -1) {\n            --c;\n          }\n        }\n        var r = [];\n        for(var i = 0; i < t.length; ++i) {\n          var spaces = '';\n          if(t[i].indexOf('}') >= 0) lines[i]-=1;\n          for(var j = 0; j < lines[i]; ++j) {\n            spaces = spaces + '  ';\n          }\n          r.push(spaces + t[i]);\n        }\n        return '/** this cartoCSS has been processed in order to be compatible with the new cartodb 2.0 */\\n\\n' + r.join('\\n');\n      }\n    } catch(e) {\n    }\n    return s;\n  },\n\n  _updateStyle: function(){\n    var st        = this.model.get('tile_style')\n      , editor_st = this.codeEditor ? this.codeEditor.getValue() : null;\n\n\n      if(this.codeEditor && st && st != editor_st) {\n        if(st.indexOf('\\n') === -1) {\n          st = this.formatStyle(st);\n        }\n        this.codeEditor.setValue(st);\n        this.codeEditor.refresh();\n      }\n\n    // If model is using history, check buttons\n    if (this.model.get('tile_style_history'))\n      this._checkDoButtons();\n  },\n\n  /**\n   * gets an array of parse errors from windshaft\n   * and returns an array of {line:1, error: 'string'] with user friendly\n   * strings. Parses errors in format:\n   *\n   *  'style.mss:7:2 Invalid code: asdasdasda'\n   */\n  _parseError: function(errors) {\n    var parsedErrors = [];\n    for(var i in errors) {\n      var err = errors[i];\n      if(err) {\n        if (err.length > 0) {\n          var g = err.match(/.*:(\\d+):(\\d+)\\s*(.*)/);\n          if(g) {\n            parsedErrors.push({\n              line: parseInt(g[1], 10),\n              message: g[3]\n            });\n          } else {\n            parsedErrors.push({\n              line: null,\n              message: err\n            })\n          }\n        } else if(err.line) {\n          parsedErrors.push(err);\n        }\n      }\n    }\n    // sort by line\n    parsedErrors.sort(function(a, b) { return a.line - b.line; });\n    parsedErrors = _.uniq(parsedErrors, true, function(a) { return a.line + a.message; });\n    return parsedErrors;\n  },\n\n  _showErrorFromServer: function(err) {\n    this._showError(this._parseError(err));\n  },\n\n  _showError: function(err) {\n    var parsedErrors = err;\n    if(parsedErrors.length > 0) {\n      var errors = _(parsedErrors).map(function(e) {\n        if(e.line) {\n          return \"line \" + e.line + \": \" + e.message;\n        }\n        return e.error || e.message;\n      })\n      this._renderError(errors.join('</br>'));\n    }\n  },\n\n  _renderError: function(errors) {\n    this.trigger('hasErrors');\n\n    // Get actions block height\n    var actions_h = this.$('.actions').outerHeight();\n\n    // Add error text\n    this.$('.info')\n      .addClass('error')\n      .html(\"<p>\" + errors + \"</p>\")\n      // If layer is not visible, we need to move error message\n      .css({\n        bottom: actions_h + (!this.model.get('visible') ? 57 : 0)\n      })\n      .show();\n\n    this._adjustCodeEditorSize();\n  },\n\n  _adjustCodeEditorSize: function() {\n    // Fit editor with the error\n    var info_h = this.$('.info').is(':visible') ? this.$('.info').outerHeight() : 0;\n    var help_h = this.$('.help-tip').is(':visible') ? 36 : 0 ;\n    // If layer is not visible, we need to take into account\n    var vis_msg_h = !this.model.get('visible') ? 57 : 0 ;\n\n    this.$('.CodeMirror-wrap').css({\n      bottom: info_h + vis_msg_h + 80, /* the space we need to show the action buttons */\n      top: help_h\n    });\n  },\n\n  _checkLocalErrors: function() {\n    var style = this.model.get('tile_style');\n    var cartoParser = new cdb.admin.CartoParser(style);\n    if(cartoParser.errors().length) {\n      this._showError(this._parseError(cartoParser.errors()));\n    } else {\n      // check variables used\n      var err = this.checkVariables(cartoParser.variablesUsed());\n      if(err.length) {\n        this._showError(err);\n        return;\n      }\n    }\n    this._clearErrors();\n  },\n\n  _clearErrors: function() {\n    this.trigger('clearError');\n\n    // Hide info\n    this.$('.info')\n      .html('')\n      .removeClass('error')\n      .hide();\n\n    this._adjustCodeEditorSize();\n  },\n\n  _do: function(e) {\n    e.preventDefault();\n    var newCarto = this.model.redoHistory('tile_style');\n    if(this.codeEditor) this.codeEditor.setValue(newCarto);\n    this._checkDoButtons();\n    return false;\n  },\n\n  _undo: function(e) {\n    e.preventDefault();\n    var newCarto = this.model.undoHistory('tile_style');\n    if(this.codeEditor) this.codeEditor.setValue(newCarto);\n    this._checkDoButtons();\n    return false;\n  },\n\n  /**\n   * checks variabels used in cartocss are in the schem\n   */\n  checkVariables: function(vars) {\n    var columns = this.model.table.columnNames();\n    var err = [];\n    for(var i in vars) {\n      if(!_.contains(columns, vars[i])) {\n        err.push({\n          error: \"sql/table must contain \" + vars[i] + \" variable\"\n        });\n      }\n    }\n    return err;\n  },\n\n  applyStyle: function() {\n    this._clearErrors();\n    var style = this.codeEditor.getValue();\n    var cartoParser = new cdb.admin.CartoParser(style);\n    if(cartoParser.errors().length) {\n      var errors = this._parseError(cartoParser.errors());\n      if(errors) this._showError(errors);\n    } else {\n      // check variables used\n      var err = this.checkVariables(cartoParser.variablesUsed());\n      if(err.length) {\n        this._showError(err)\n        return;\n      }\n      this.model.addToHistory('tile_style', style);\n      //TODO: check if the style has been changed\n      this.model.save({\n        tile_style: style,\n        tile_style_custom: true\n      });\n\n      // we save the new applied query on the history array\n      this.trigger('applyStyle', style);\n    }\n\n    // Event tracking \"Applied CartoCSS style manually\"\n    cdb.god.trigger('metrics', 'cartocss_manually', {\n      email: window.user_data.email\n    });\n  },\n\n  /**\n   * Check if the editor is different from the saved value\n   * @return {Boolean}\n   */\n  hasChanges: function() {\n    return this.model.get('tile_style') != this.codeEditor.getValue();\n  },\n\n  _checkDoButtons: function() {\n      // Redo\n      if (!this.model.isHistoryAtLastPosition('tile_style')) {\n        this.$el.find('a.next').removeClass(\"disabled\")\n      } else {\n        this.$el.find('a.next').addClass(\"disabled\")\n      }\n      // Undo\n      if (!this.model.isHistoryAtFirstPosition('tile_style')) {\n        this.$el.find('a.back').removeClass(\"disabled\")\n      } else {\n        this.$el.find('a.back').addClass(\"disabled\")\n      }\n  },\n\n  _showDoc: function(ev) {\n    ev.preventDefault();\n    cdb.editor.ViewFactory.createDialogByTemplate('common/dialogs/help/carto_css').appendToBody();\n  }\n});\n","/**\n* manages all the wizards which render carto\n*/\ncdb.admin.mod.CartoCSSWizard = cdb.admin.Module.extend({\n\n  buttonClass: 'wizards_mod',\n  type: 'tool',\n\n  events: {\n    'click  .wizard_arrows a':  '_onArrowClick'\n  },\n\n  initialize: function() {\n    var self = this;\n    self.active = false;\n    this.currentWizard = null;\n\n    this.wizard_properties = this.model.wizard_properties;\n\n    this.add_related_model(this.model);\n    this.add_related_model(this.options.table);\n    this.add_related_model(this.wizard_properties);\n\n    this.position = 0; // Navigation bar\n    this.tabs = new cdb.admin.Tabs();\n    this.addView(this.tabs);\n\n    this.tabs.preventDefault = true;\n    this.tabs.bind('click', this._onWizardClick, this);\n    this.tabs.bind('click', function() {\n      // Event tracking \"Applied a wizard\"\n      cdb.god.trigger('metrics', 'wizard', {\n        email: window.user_data.email\n      });\n    }, this);\n\n\n    this.wizard_properties.bind('change:type', function() {\n      this.enableTabs();\n    }, this);\n    this.wizard_properties.bind('change:type', this.renderWizards, this);\n\n    // change tabs\n    this.options.table.bind('change:geometry_types', function() {\n      this.enableTabs();\n      this.renderWizards();\n    }, this);\n  },\n\n  _onWizardClick: function(type) {\n    this.trigger('activeWizard', type, this);\n    this.wizard_properties.active(type, {\n      zoom: this.options.map.get('zoom')\n    });\n  },\n\n  _enableModules: function(v) {\n    this.trigger('modules', v.MODULES);\n  },\n\n  _onArrowClick: function(ev) {\n    this.killEvent(ev);\n    var $target = $(ev.target);\n\n    if ($target.hasClass(\"disabled\")) return false;\n\n    var side = $target.attr('href').replace(\"#\",\"\");\n    this._moveNavigation(side);\n  },\n\n  _resetNavigation: function() {\n\n    var self  = this;\n    var $ul   = this.$(\"ul.vis_options\");\n\n    var\n    gap         = 3,\n    list_size   = $ul.find(\"li\").size(),\n    list_item_w = 92 + Math.ceil(30/list_size);\n    $right      = this.$('a.right'),\n    $left       = this.$('a.left');\n\n    $ul.parent().removeClass(\"left_shadow\");\n\n    var $selectedLi = $ul.find(\"a.selected\").parent();\n    var selectedIndex = $selectedLi.index();\n    var sizeIndex = $ul.find(\"li\").size();\n\n    // TODO: check this behaviour and slider-selector component...\n    // If there is a wizard selected, situated in the position 2 or greater (0,1,2,3,...)\n    // it moves the list to that position\n    if (selectedIndex >= 3) {\n      $ul.parent().addClass(\"left_shadow\");\n      this.position = selectedIndex - 2;\n\n      // LI width, it is not possible to get width if the component doesnt exist or it is not displayed\n      var move = this.position * list_item_w;\n      // If selected item is the last in the list, add more space at the end\n      if ((list_size - 1) <= selectedIndex) move += 18;\n      $ul.animate({ left: -move + 'px' }, { queue: false, duration: 250 });\n\n      $left.removeClass(\"disabled\");\n      $right[((sizeIndex - 1) == selectedIndex) ? \"addClass\" : \"removeClass\" ](\"disabled\");\n    } else {\n      // Move the list to the beginning\n      $ul.animate({ left: \"0\" }, { queue: false, duration: 250 });\n\n      // First position, left arrow disabled\n      $left.addClass(\"disabled\");\n      // More than 3 wizards, right arrow active\n      $right[(list_size > 3) ? \"removeClass\" : \"addClass\"](\"disabled\");\n\n      this.position  = 0;\n    }\n\n    this.animation = false;\n  },\n\n  _moveNavigation: function(side) {\n\n    //TODO: extract this to a component\n    if (this.animation) return false;\n\n    var\n    $ul           = this.$(\"ul.vis_options\")\n    , gap         = 3\n    , list_size   = $ul.find(\"li\").size()\n    //, move        = $ul.find(\"li\").outerWidth() || 100\n    , move = 100 + Math.ceil(40/list_size)\n    , block_width = $ul.parent().outerWidth() || 380\n    , list_width  = list_size * (move + 5)\n    , left        = parseInt($ul.css(\"left\").replace(\"px\",\"\")) || 0\n    , $right      = this.$('a.right')\n    , $left       = this.$('a.left')\n    , self        = this;\n\n    // if the list is smaller than the block, we disable the buttons and return\n    if (block_width  > list_width ) {\n\n      $left.addClass(\"disabled\");\n      $right.addClass(\"disabled\");\n\n      return false\n    }\n\n    // Check move\n    if (side == \"left\") {\n\n      if (-left < move) {\n        move = -left;\n      }\n\n      this.position--;\n\n      if (this.position == 0) $ul.parent().removeClass(\"left_shadow\");\n\n    } else {\n\n      if (block_width - left >= list_width) {\n        return false;\n      }\n\n      if (list_width + left < move) {\n        move = list_width + left;\n      }\n\n      this.position++;\n      $ul.parent().addClass(\"left_shadow\");\n\n    }\n\n    // Check arrows\n    this.position + gap >= list_size ?  $right.addClass(\"disabled\") : $right.removeClass(\"disabled\");\n\n    this.position == 0 ? $left.addClass(\"disabled\") : $left.removeClass(\"disabled\");\n\n    // Go side\n    this.animation = true;\n\n    var operator = '-=';\n\n    if (side == \"left\") { operator = '+='; }\n\n    $ul.animate({ left: operator + move + 'px' }, 200, function() { self.animation = false; });\n\n  },\n\n  _setThumbnails: function() {\n    var classes = this.options.table.geomColumnTypes().join(\"-\");\n    this.$('.vis_options li a').each(function(i,el){\n      $(el).addClass(classes);\n    });\n  },\n\n  activated: function() {\n    this.active = true;\n  },\n\n  deactivated: function() {\n    this.active = false;\n  },\n\n  // depending on the geometry type some wizards should be disabled\n  enableTabs: function() {\n\n    this.renderTabs();\n    this.tabs.disableAll();\n\n    var toEnable = this.wizard_properties.getEnabledWizards();\n\n    // enable the wizard suitable for the current geom types\n    for(var e in toEnable) {\n        this.tabs.enable(toEnable[e]);\n    }\n\n    // we remove the disabled ones and recalculate the arrows\n    this._setThumbnails();\n    this.tabs.removeDisabled();\n    this.tabs.activate(this.wizard_properties.get('type'));\n    this._resetNavigation();\n  },\n\n  renderTabs: function() {\n    this.tabs.$el.html(\n      this.getTemplate('table/menu_modules/views/carto_wizard_tabs')()\n    );\n  },\n\n  renderWizards: function() {\n    var t = this.wizard_properties.get('type');\n    if (!t) return;\n\n    cdb.core.Profiler.metric('cartowizard:renderWizards').inc();\n\n\n    // Enter the Wizards\n    var el = this.$('.forms');\n    var wizard = this.options.wizards[t];\n\n    if (this.currentWizard) {\n      this.currentWizard.clean();\n    }\n\n    el.html('');\n    if(!wizard) {\n      return;\n    }\n\n    var w = new cdb.admin.mod[wizard]({\n      table: this.options.table,\n      layer: this.options.model,\n      wizard_properties: this.wizard_properties,\n      style: this.model.get('style'),\n      map: this.options.map\n    });\n\n    el.append(w.render().el);\n    this.currentWizard = w;\n    this.addView(this.currentWizard);\n\n    // when a panel is selected a signal is raised\n    // showing which modules are available for that\n    // kind of visualization\n    this._enableModules(this.currentWizard);\n\n  },\n\n  render: function() {\n    this.$el.html('');\n    this.$el.append(this.getTemplate('table/menu_modules/views/carto_wizard')());\n    this.tabs.setElement(this.$('ul.vis_options'));\n    this.enableTabs();\n\n    // render the wizards\n    this.renderWizards();\n\n    return this;\n  }\n\n});\n\n/**\n* Simple Wizard\n* take this as base for other wizards\n*/\n\ncdb.admin.mod.SimpleWizard = cdb.core.View.extend({\n\n  // modules available when this wizard is enabled\n  MODULES: ['infowindow', 'legends'],\n\n\n  initialize: function() {\n    var self = this;\n    this.cartoProperties = this.options.wizard_properties;\n    this.type = this.type || 'polygon';\n\n    this.add_related_model(this.cartoProperties);\n    this.add_related_model(this.options.table);\n\n    var proxyModel = new Backbone.Model();\n    proxyModel.set(this.cartoProperties.attributes);\n\n    var signalDisabled = false;\n    this.cartoProperties.bind('change', function() {\n      signalDisabled = true;\n      proxyModel.set(this.cartoProperties.attributes);\n      signalDisabled = false;\n    }, this);\n\n    proxyModel.bind('change', function() {\n      if(proxyModel.changed[\"marker-fill\"]){\n        proxyModel.unset(\"marker-file\");\n        this.cartoProperties.unset(\"marker-file\");\n      }\n      if (signalDisabled) return;\n      this.cartoProperties.enableGeneration();\n      this.cartoProperties.set(proxyModel.attributes);\n    }, this);\n\n    //TODO: change this when table support more than one geom type\n    this.form = new cdb.forms.Form({\n      form_data: this.cartoProperties.formData(this.type),\n      model: proxyModel\n    });\n    this.addView(this.form);\n\n    this._bindChanges();\n\n    this.cartoProperties.bind('change:form', function() {\n      this.form.updateForm(this.cartoProperties.formData(this.type));\n      this.render();\n    }, this);\n  },\n\n  _generateSQL: function() {\n    return null;\n  },\n\n  isValid: function() {\n    return true;\n  },\n\n  _bindChanges: function() {\n    var self = this;\n\n    this.cartoProperties.bind('change:text-name', this.showTextFields, this);\n    this.cartoProperties.bind('change:text-allow-overlap', function(m, overlap) {\n      // Overlap value is being returned as String, not as Boolean, seems like\n      // custom selector transforms values to String always :_(\n      this.cartoProperties.set({\n        'text-placement-type': overlap === \"true\" ? 'dummy' : 'simple',\n        'text-label-position-tolerance': overlap === \"true\" ? 0 : 10\n      });\n    }, this);\n    this.cartoProperties.bind('change:marker-width', function(m, width) {\n      if (this.cartoProperties.has('text-dy')) {\n        this.cartoProperties.set('text-dy', -width);\n      }\n    }, this);\n\n  },\n\n  showTextFields: function() {\n\n    var self = this;\n    var v = self.form.getFieldByName('Label Font');\n\n    if (!v) return;\n\n    var vhalo       = self.form.getFieldByName('Label Halo');\n    var voffset     = self.form.getFieldByName('Label Offset');\n    var field       = self.form.getFieldByName('Label Text');\n    var voverlap    = self.form.getFieldByName('Label Overlap');\n    var vplacement  = self.form.getFieldByName('Label Placement');\n    var tn = self.cartoProperties.get('text-name');\n    if (!tn || tn === 'None') {\n      v && v.hide();\n      vhalo && vhalo.hide();\n      voffset && voffset.hide();\n      voverlap && voverlap.hide();\n      vplacement && vplacement.hide();\n      field.removeClass(\"border\");\n    } else {\n      v && v.show();\n      vhalo && vhalo.show();\n      voffset && voffset.show();\n      voverlap && voverlap.show();\n      vplacement && vplacement.show();\n      field.addClass(\"border\");\n    }\n\n  },\n\n  _unbindChanges: function() {\n    this.cartoProperties.unbind(null, null, this);\n  },\n\n  render: function() {\n\n    var $wrapper = $(\"<div>\").addClass(\"wrapper\")\n    , $content = $(\"<div>\").addClass(\"content\");\n\n    $content.append(this.form.render().el);\n    $wrapper.append($content);\n\n    // Remove old custom scroll\n    if (this.custom_scroll) {\n      this.removeView(this.custom_scroll);\n      this.custom_scroll.clean();\n    }\n\n    // Add new custom scroll\n    this.custom_scroll = new cdb.admin.CustomScrolls({\n      el:     $wrapper,\n      parent: $wrapper.parent()\n    });\n\n    this.addView(this.custom_scroll);\n\n    this.$el.html($wrapper);\n    this.showTextFields();\n\n    return this;\n  },\n\n  // The safeHtml is rendered as-is, so called is responsibile for sanitizing content before calling this method\n  renderError: function(safeHtml) {\n    var $wrapper =    $(\"<div>\").addClass(\"wrapper\")\n    , $no_columns = $(\"<div>\").addClass(\"no_content\").html(safeHtml);\n\n    $wrapper.append($no_columns);\n    this.$el.html($wrapper);\n  },\n\n  /**\n  * search inside the source fields for the field by name.\n  * Returns the field\n  */\n  _searchFieldByName: function(name) {\n    return _.find(this.options.form || this.geomForm, function(f) {\n      return f.name === name;\n    });\n  },\n\n  /**\n  *  Get number columns without cartodb_id\n  */\n  _getNumberColumns: function() {\n    return _.filter(this.options.table.columnNamesByType('number'), function(c) {\n      return c != \"cartodb_id\"\n    });\n  },\n\n  _getColumns: function() {\n    return _.filter(this.options.table.columnNames(), function(c) {\n      return c != \"cartodb_id\";\n    });\n  },\n\n  /**\n  *  Get number, boolean and string columns without system columns\n  */\n  _getColorColumns: function() {\n    var self = this;\n    var columns = [];\n    var sc = this.options.table.get('schema')\n    _.each(sc, function(c) {\n      if (!_.contains(self.options.table.hiddenColumns, c[0]) && c[1] != \"date\" && c[1] != \"geometry\") {\n        columns.push(c[0])\n      }\n    });\n    return columns;\n  },\n\n\n\n});\n","\n  /**\n   *  Actions menu view, aka LayersPanel\n   *\n   *  - It needs at least visualization and user models.\n   *    Globalerror to show connection or fetching errors.\n   *\n   *    var menu = new cdb.admin.LayersPanel({\n   *      vis: vis_model,\n   *      user: user_model,\n   *      globalError: globalError_obj\n   *    });\n   */\n\n  cdb.admin.LayersPanel = cdb.ui.common.TabPane.extend({\n\n    className: 'table_panel',\n    animation_time: 300,\n\n    _TEXTS: {\n      sort: {\n        torque: _t('Animated layers must be on top of other layers.'),\n        tiled:  _t('Tiled layers can\\'t be above animated layers.')\n      },\n      raster:   _t(\"You can't add a raster layer into a visualization\"),\n      error: {\n        default: _t('Something went wrong, try again later')\n      }\n    },\n\n    events: {\n      'click .add_layer': '_addLayerDialog'\n    },\n\n    initialize: function() {\n      this.layer_panels = []; // Layer panels added in the current visualization\n      this.vis = this.options.vis;\n      this.master_vis = this.options.master_vis;\n      this.map = this.vis.map;\n      this.user = this.options.user;\n      this.globalError = this.options.globalError;\n\n      // View bindings\n      _.bindAll(this, '_sortStart', '_sortChange', '_sortBeforeStop', '_sortLayers',\n      '_manageLayers', '_checkResize', '_moveSortTooltip');\n\n      this.map.layers.bind('add',    this._newLayer, this);\n      this.map.layers.bind('reset',  this._resetLayers, this);\n      this.map.layers.bind('add remove', this._updateLayerPositionLabel, this);\n      $(window).bind('resize', this._checkResize);\n      this.add_related_model(this.map.layers);\n      this.add_related_model(this.map);\n      this._bindSort(); // Bind sort movement\n\n      // the following call is not needed, 'reset' on map.layers will be raised\n      // after this is loaded. If the map data was not loaded using AJAX this would\n      // need to be enabled\n      //this._addLayers(this.map.layers);\n\n      // Setting several view parameters\n      this.model = new cdb.core.Model({\n        open:           true,\n        activeWorkView: 'table'\n      });\n\n      // Bind model changes\n      this.model.bind('change:open', this._setPanelState, this);\n\n      // Visualization changes\n      this.vis.bind('change:type', this.hide, this);\n      this.add_related_model(this.vis);\n\n      cdb.ui.common.TabPane.prototype.initialize.call(this);\n    },\n\n    // Setup panel depending view model state\n    _setPanelState: function() {\n      // If it is open, add open class\n      this.$el[ this.model.get('open') ? 'addClass' : 'removeClass' ]('opened');\n    },\n\n    /* Layer panel functions */\n\n    _resetLayers: function() {\n      //clean all views\n      this.removeTabs();\n      // Empty layers array\n      this.layer_panels = [];\n      // Add again the layers\n      this._addLayers(this.map.layers);\n    },\n\n    _addLayers: function(layers) {\n      // Add 'add layer' button first\n      this._addLayerAddButton();\n\n      // Add layers\n      var self = this;\n      layers.each(function(l, pos) {\n        self._addLayer(l, pos);\n      });\n\n      // Set default layer\n      this._setDefaultLayer();\n\n    },\n\n    _newLayer: function(layer) {\n      this._addLayer(layer);\n    },\n\n    _addLayer: function(layer, pos) {\n      var self = this;\n      if (layer.get('type') == 'CartoDB' ||\n          layer.get('type') == 'torque') {\n\n        var v = new cdb.admin.LayerPanelView({\n          model: layer,\n          vis: self.vis,\n          user: self.user,\n          globalError: self.options.globalError\n        });\n\n        v.bind('toggle',    self._toggle, self);\n        v.bind('switchTo',  self._switchTo, self);\n        v.bind('delete',    self._openDeleteLayerDialog, self);\n        v.bind('show',      self.show, self);\n        v.bind('destroy',   self._removeLayer, self);\n        v.bind('addColumn', self._addColumn, self);\n\n        self.addTab(layer.cid, v, { after: 0 });\n        v.setActiveWorkView(self.model.get('activeWorkView'));\n        self.layer_panels.push(v);\n        self._bindLayerTooltip(v);\n\n        // no pos -> new layer -> set as current\n        if (!pos) {\n          self._switchTo(v, true);\n          v.setPanelStatus();\n        }\n\n        self._checkLayers();\n      }\n    },\n\n    _addColumn: function() {\n      table.tableTab.tableView.addColumn();\n    },\n\n    _removeLayer: function(dataLayerCid) {\n      var layer_view = this.getPane(dataLayerCid);\n      var self = this;\n\n      this.layer_panels = _.filter(this.layer_panels, function(view) {\n        if (view != layer_view) return view;\n      });\n\n      var tabBind = function(dataLayerCid) {\n        var view = self.getPane(dataLayerCid);\n        self.trigger('switch', view);\n        self.vis.save('active_layer_id', view.dataLayer.id);\n        self.show(view.panels.activeTab);\n        self.unbind('tabEnabled', tabBind);\n      }\n\n      this.bind('tabEnabled', tabBind);\n\n      this._unbindLayerTooltip(layer_view);\n      this.removeTab(dataLayerCid);\n      this._checkLayers();\n      this._manageLayers();\n      if (self.map.layers.getDataLayers().length === 1) {\n        _.last(self.map.layers.getDataLayers()).set('visible', true);\n      }\n    },\n\n    _setDefaultLayer: function() {\n      var layer_id = this.vis.get('active_layer_id');\n      var layer = _.last(this.layer_panels);\n\n      // Get layer from layer_id\n      if (layer_id) {\n        for (var i in this.layer_panels) {\n          var lyr = this.layer_panels[i];\n          if (lyr.dataLayer.id == layer_id) {\n            layer = lyr;\n            break;\n          }\n        }\n      }\n\n      // Any layer? Switch to it\n      if (layer) {\n        this._switchTo(layer, false);\n      }\n    },\n\n    // Check how many layers-view there are in the panel\n    _checkLayers: function() {\n      var cartodbLayers = this.map.layers.getDataLayers().length;\n\n      if (cartodbLayers === 1) {\n        this._unbindSort();\n      } else {\n        this._bindSort();\n      }\n    },\n\n    /* Add layer functions */\n\n    _addLayerAddButton: function() {\n      this.$('.add_layer').remove();\n      var template = this.getTemplate('table/views/add_layer');\n      this.$el.prepend(template());\n    },\n\n    _addLayerDialog: function(e) {\n      this.killEvent(e);\n\n      if (!this.user.canAddLayerTo(this.map)) {\n        var dlg = new cdb.editor.LimitsReachView({\n          clean_on_hide: true,\n          enter_to_confirm: true,\n          user: this.user\n        });\n        dlg.appendToBody();\n        return;\n      }\n\n      if (this.vis.isVisualization()) {\n        this._createAddLayerDialog();\n      } else {\n        this.createVisDlg = new cdb.editor.CreateVisFirstView({\n          clean_on_hide: true,\n          enter_to_confirm: true,\n          model: this.master_vis,\n          router: window.table_router,\n          title: 'A map is required to add layers',\n          explanation: 'A map is a shareable mix of layers, styles and queries. You can view all your maps in your dashboard.',\n          success: this._createAddLayerDialog.bind(this)\n        });\n        this.createVisDlg.appendToBody();\n      }\n    },\n\n    _createAddLayerDialog: function() {\n      var model = new cdb.editor.AddLayerModel({}, {\n        vis: this.vis,\n        map: this.map,\n        user: this.user\n      });\n      var dialog = new cdb.editor.AddLayerView({\n        model: model,\n        user: this.user\n      });\n      dialog.appendToBody();\n    },\n\n    _bindLayerTooltip: function(v) {\n      var self = this;\n      this._unbindLayerTooltip(v);\n      v && v.$('.info').tipsy({\n        live: true,\n        gravity: 'e',\n        offset: 0,\n        fade: true,\n        title: function() {\n          if (!self.vis.isVisualization() || self.model.get('open')) {\n            return '';\n          }\n          return $(this).find('span.name').text();\n        }\n      });\n    },\n\n    _unbindLayerTooltip: function(v) {\n      v && v.$(\".info\").unbind('mouseenter mouseleave');\n      if (v && v.$(\".info\").data('tipsy')) v.$(\".info\").data('tipsy').remove();\n    },\n\n    _hideLayerTooltip: function(v) {\n      v && v.$(\".info\").tipsy(\"hide\")\n    },\n\n\n    ////////////////////\n    // Sort functions //\n    ////////////////////\n\n    _unbindSort: function() {\n      this.$el.sortable('destroy')\n    },\n\n    _bindSort: function() {\n      this._unbindSort();\n\n      this.$el.sortable({\n        axis: \"y\",\n        items: \"> .layer_panel\",\n        handle: \".layer-info .info\",\n        cancel: '',\n        contaiment: \"parent\",\n        opacity: 0.5,\n        start: this._sortStart,\n        change: this._sortChange,\n        beforeStop: this._sortBeforeStop,\n        update: this._sortLayers,\n        forcePlaceholderSize: false\n      }).disableSelection();\n    },\n\n    // Before start sorting action\n    _sortStart: function(e, ui) {\n      this.sort_actions = {\n        original_layer_pos: $(ui.item).index(),\n        $layer: $(ui.item)\n      }\n      var active_height = $(ui.item).outerHeight();\n      $(ui.placeholder).outerHeight(active_height);\n    },\n\n    // When any change happens sorting\n    // - If a torque layer tries to move to other position, sorting is cancelled\n    //   and a yellow tooltip should appear.\n    // - If a cartodb layer tries to move to other position and there is a torque\n    //   layer in the visualization, sorting is cancelled and a yellow tooltip\n    //   should appear.\n    _sortChange: function(e, ui) {\n      var isAnyTorque = _.contains(this.map.layers.pluck('type'), 'torque');\n      var isLayerTorque = $(ui.item).attr('layer-type') == \"torque\";\n      var active_height = $(ui.item).outerHeight();\n\n      // Torque\n      if (isAnyTorque) {\n        // Torque layer\n        if (isLayerTorque) {\n          if (ui.placeholder.index() == 1) {\n            this.cancelSort = false;\n            this._removeSortTooltip();\n          } else {\n            this.cancelSort = true;\n            if (!this.sortTooltip) this._addSortTooltip(e, 'torque');\n          }\n\n          this.$('section.add_layer').after(\n            $(ui.placeholder)\n              .outerHeight(active_height)\n              .css('display','block')\n          )\n        } else {\n          if (ui.placeholder.index() != 1) {\n            this.cancelSort = false;\n            $(ui.placeholder)\n              .outerHeight(active_height)\n              .css('display','block');\n            this._removeSortTooltip();\n          } else {\n            this.cancelSort = true;\n\n            this.$('section.layer_panel:eq(' + this.sort_actions.original_layer_pos + ')').before(\n              $(ui.placeholder)\n                .outerHeight(active_height)\n                .css('display','block')\n            )\n\n            if (!this.sortTooltip) this._addSortTooltip(e, 'tiled');\n          }\n        }\n      } else {\n        this.cancelSort = false;\n        $(ui.placeholder)\n          .outerHeight(active_height)\n          .css('display','block');\n      }\n    },\n\n    // If it is necessary to cancel de sorting\n    _sortBeforeStop: function() {\n      this._removeSortTooltip();\n\n      if (this.cancelSort) this.$el.sortable('cancel');\n\n      this.cancelSort = false;\n    },\n\n    _addSortTooltip: function(e, type) {\n      this.sortTooltip = new cdb.admin.TooltipTrails({\n        className:  'tooltip-trails',\n        msg:        this._TEXTS.sort[type]\n      });\n\n      this.sort_actions.$layer.bind('mousemove', this._moveSortTooltip);\n      this.$el.append(this.sortTooltip.render().el);\n\n      this.sortTooltip.show({\n        left: e.pageX - this.$el.offset().left,\n        top: e.pageY - this.$el.offset().top\n      });\n      this.addView(this.sortTooltip);\n    },\n\n    _moveSortTooltip: function(e) {\n      // Get correct first drag coordinates\n      var parentOffset = this.$el.offset();\n      var position = {\n        left: (e.pageX - parentOffset.left),\n        top: (e.pageY - parentOffset.top)\n      };\n      this.sortTooltip.move(position);\n    },\n\n    _removeSortTooltip: function() {\n      this.sort_actions.$layer.unbind('mousemove', this._moveSortTooltip);\n      if (this.sortTooltip) {\n        this.sortTooltip.clean();\n        this.removeView(this.sortTooltip);\n        delete this.sortTooltip;\n      }\n    },\n\n    _sortLayers: function(event, ui) {\n      var self = this;\n\n      // New index of the layer in the collection of layers, assuming there\n      // is a base layer at position 0\n      var newIndex = $('.layer_panel').length - $('.layer_panel').index(ui.item);\n      var layerId = ui.item.attr('model-id');\n      var layer = this.map.layers.get(layerId);\n\n      // layers don't need to be reset when they are sorted\n      // and save the new layers order to the server\n      this.map.layers.unbind('reset', this._resetLayers, this);\n\n      this.map.layers.moveLayer(layer, {\n        to: newIndex,\n        complete: function() {\n          self._updateLayerPositionLabel();\n          self.map.layers.bind('reset',  self._resetLayers, self);\n        }\n      });\n    },\n\n    _updateLayerPositionLabel: function() {\n      _.each(this.layer_panels, function(layer) {\n        layer.setLayerOrder(layer.model);\n      });\n    },\n\n    /* Magic layers */\n    _manageLayers: function() {\n      var cartodbLayers = this.map.layers.getDataLayers().length;\n\n      // If there isn't any layer added\n      if (cartodbLayers === 0) {\n        return false;\n      }\n\n      var $active_layer = this.activePane.$el;\n\n      // Move rest of panels\n      this.$('.layer_panel').removeClass('active');\n\n      // Add active class\n      $active_layer.addClass('active');\n\n      // Set rest of layer_panels to height 60px\n      // Decide later about compress them\n      // TODO: not use jquery\n      this.$('.layer_panel').not('.layer_panel.active').css({ height: 66 });\n\n      // Get previous siblings and calculate space\n      // TODO: not use jquery\n      var pre_size = $active_layer.prevAll('.layer_panel').size();\n      var t_s = (pre_size == 0) ? 0 : (pre_size * 43);\n\n      // Get next siblings and calculate space\n      // TODO: not use jquery\n      var next_size = $active_layer.nextAll('.layer_panel').size();\n      var b_s = (next_size == 0) ? 0 : (next_size * 43);\n\n      // Set layers offset\n      var offset = -15;\n\n      $active_layer.css({ height: this.$el.height() - (t_s + b_s) + offset })\n    },\n\n    /* testing resize event */\n    _checkResize: function(e) {\n      if (this.resize) clearTimeout(this.resize);\n      var self = this;\n      this.resize = setTimeout(self._manageLayers, 100);\n    },\n\n\n    //////////////////////\n    // Dialog functions //\n    //////////////////////\n\n    show: function(modName) {\n      // Select the tab if it is not activated\n      var mod = this.getActivePane();\n\n      mod.tabs.activate(modName);\n      mod.panels.active(modName);\n\n      // Move right panel\n      this.movePanel();\n    },\n\n    // Move right panel\n    movePanel: function() {\n      var mod = this.getActivePane();\n      if (!mod) return false;\n\n      this._hideDropdowns();\n\n      // Get the action type and width\n      // of the active module\n      // var action = { module_event: narrow or show, module_width: 450 (integer) }\n      var active_pane = mod.panels.getActivePane();\n      var action  = active_pane.getModuleAction();\n\n      // Show panel -> trigger\n      cdb.god.trigger('panel_action', action.type);\n\n      // Set open model attribute as true\n      this.model.set('open', true);\n\n      this.$el.animate({\n        width: action.width,\n        right: 0\n      }, this.animation_time, function() {\n        cdb.god.trigger(\"end_\" + action.type);\n      });\n    },\n\n    hide: function(modName) {\n      var panel_width = this.$el.width();\n\n      // Hide the tab\n      var mod = this.getActivePane();\n\n      this._hideDropdowns();\n\n      // Hide panel -> trigger\n      cdb.god.trigger(\"panel_action\", \"hide\");\n\n      // Set open model attribute as true\n      this.model.set('open', false);\n\n      this.$el.animate({\n        right: 63 - panel_width\n      }, this.animation_time);\n    },\n\n    _hideDropdowns: function() {\n\n      cdb.god.trigger(\"closeDialogs\");\n      cdb.god.trigger(\"closeDialogs:color\");\n\n    },\n\n    // l    -> layer view\n    // open -> flag to know if it is necessary to open the panel\n    _switchTo: function(l, open) {\n      // If there is any change within layer tabs\n      if (this.activePane) this.activePane.unbind('tabChanged', null, null);\n      l.bind('tabChanged', this.movePanel, this);\n\n      // Check if switched layer is active one\n      if (this.activePane == l) {\n\n        if (open !== undefined) {\n          if (open === true) {\n            this.show(l.panels.activeTab);\n          } else {\n            this.hide();\n          }\n        } else {\n          if (this.model.get('open')) {\n            this.hide();\n          } else {\n            this.show(l.panels.activeTab);\n          }\n        }\n      }\n\n        // if not, activate it\n      if (this.activePane != l) {\n        this._hideLayerTooltip(l);\n        this.active(l.dataLayer.cid);\n        if (l.dataLayer.id && this.vis.get('active_layer_id') != l.dataLayer.id) {\n          this.vis.save('active_layer_id', l.dataLayer.id);\n        }\n        if (open === undefined) this.show(l.panels.activeTab);\n      }\n\n      // Send trigger\n      this.trigger('switch', l);\n\n      // Manage available layers\n      this._manageLayers();\n    },\n\n    _toggle: function(modName) {\n      // only hide if we click on active tab\n      if (this.model.get('open') && modName == this.getActivePane().panels.activeTab) {\n        this.hide(modName);\n      } else {\n        this.show(modName);\n      }\n    },\n\n    _openDeleteLayerDialog: function(layerView) {\n      var view = new cdb.editor.DeleteLayerView({\n        model: layerView.model\n      });\n      view.appendToBody();\n    },\n\n    setActiveWorkView: function(workView) {\n      this.hide();\n      this.model.set('activeWorkView', workView);\n\n      // Set active work view for all panes,\n      // not only for the current one\n      this.each(function(tab, pane){\n        pane.setActiveWorkView(workView);\n      })\n    },\n\n    clean: function() {\n      $(window).unbind('resize', this._checkResize);\n      if (this.resize) clearTimeout(this.resize);\n      this.removeTabs();\n      this._unbindSort();\n      this.elder('clean');\n    }\n  });\n","\n/**\n *  Base layer button View that applies the correct layer to the map\n */\ncdb.admin.BaseLayerButton = cdb.core.View.extend({\n\n  bindMap: function(map) {\n    map.bind('savingLayers', this.disable, this);\n    map.bind('savingLayersFinish', this.enable, this);\n  },\n\n  disable: function() {\n    this.$el.addClass('disabled');\n    this.undelegateEvents();\n  },\n\n  enable: function() {\n    this.$el.removeClass('disabled');\n    this.delegateEvents();\n  },\n\n  selectButton: function() {\n    this.$el.parents('.dropdown.basemap').find('li.selected').removeClass('selected');\n    this.$el.addClass('selected');\n  }\n\n});","\n/**\n * User options dropdown (extends Dropdown)\n *\n * It shows the content in a dropdown (or dropup) with a special effect.\n *\n * Usage example:\n *\n * var user_menu = new cdb.admin.DropdownBasemap({\n *\n * });\n *\n */\n\ncdb.admin.DropdownBasemap = cdb.ui.common.Dropdown.extend({\n\n  className: 'dropdown basemap',\n\n  // TODO: remove gmaps code from here\n  defaults: {\n    speedIn:  50,\n    speedOut: 50,\n    basemaps_per_list: 8,\n    available_basemaps: {}\n  },\n\n  events: {\n    \"click a.add\" : \"_openSelector\",\n    \"click\"       : \"killEvent\"\n  },\n\n  initialize: function() {\n    _.bindAll(this, \"add\", \"setActiveBaselayer\", \"open\", \"hide\", \"_handleClick\", \"_keydown\");\n\n    // Extend options\n    _.defaults(this.options, this.defaults);\n\n    // Dropdown template\n    this.template_base = cdb.templates.getTemplate(this.options.template_base);\n\n    // Bind to target\n    $(this.options.target).bind({\"click\": this._handleClick});\n\n    // Bind ESC key\n    $(document).bind('keydown', this._keydown);\n\n    // Is open flag\n    this.isOpen = false;\n\n    this.baseLayers = this.options.baseLayers;\n    this.user = this.options.user;\n\n    this._setupBindings();\n\n  },\n\n  _setupBindings: function() {\n\n    this._bindBaseLayers();\n    this._bindMapView();\n\n  },\n\n  _bindBaseLayers: function() {\n\n    if (this.baseLayers) {\n      this.baseLayers.bind('reset', this.render, this);\n      this.baseLayers.bind('add',   this.add,    this);\n    }\n\n  },\n\n    // Bind any change of mapview to base chooser\n  _bindMapView: function() {\n\n    var self = this;\n\n    this.model.layers.bind('change add reset',\n    function(a) {\n      self._checkPlainColor();\n      self.setActiveBaselayer(a);\n    });\n\n  },\n\n  /**\n   *  Checks if new base layer loaded is a plain color type\n   *  If so, it is applied to background map color view as the model\n   */\n  _checkPlainColor: function() {\n    var baselayer = this.model.getBaseLayer();\n    if (baselayer && baselayer.get('type') == \"Plain\") {\n      if (baselayer.get('color')) {\n        this.background_color.model = baselayer;\n      } else {\n        this.background_image.model = baselayer;\n      }\n    }\n  },\n\n  _toggleAddBaseLayer: function() {\n\n    var\n    $add = this.$el.find(\".add_basemap\"),\n    $ul  = this.$el.find(\".custom ul.yours\");\n\n    if ($ul.find(\"li\").length <= this.defaults.basemaps_per_list) {\n      $add.removeClass(\"hidden\");\n      $add.parent().append($add);\n    } else {\n      $add.addClass(\"hidden\");\n    }\n\n  },\n\n  // returns true if google maps is enabled if google maps library loaded\n  googleMapsEnabled: function() {\n    return typeof(google) !== 'undefined' && typeof(google.maps) !== 'undefined';\n  },\n\n  add: function(lyr) {\n\n    //if (!lyr.get(\"urlTemplate\")) return;\n\n    var v;\n    var type  = lyr.get(\"type\") && lyr.get(\"type\").toLowerCase();\n    var proxy = lyr.get(\"proxy\"); // If it comes from CartoDB proxy\n\n    if (lyr.get('className') === 'wms' || proxy ) {\n      v = new cdb.admin.BaseMapView({ model: lyr, map: this.model, className: \"wms\" });\n    } else if (lyr.get('className') === 'googlemaps') {\n      if (this.googleMapsEnabled()) {\n        v = new cdb.admin.GMapsBaseView({\n          model: lyr,\n          map: this.model\n        });\n      } else {\n        return;\n      }\n    } else {\n       // this is a temporal fix, if google maps feature flag is enabled show only maps in group google maps\n      if (this.user.featureEnabled('google_maps') && lyr.get('category') !== 'Google') {\n          return;\n      }\n      v = new cdb.admin.BaseMapView({ model: lyr, map: this.model });\n    }\n\n    lyr.bind(\"destroy\", this._toggleAddBaseLayer, this);\n\n    this.addView(v);\n\n    var name = v.model.get(\"name\");\n\n    if (!name) {\n      name = \"Custom basemap \" + v.model.get(\"order\");\n    } else {\n      name.replace(/_/g, \"\");\n    }\n\n    v.model.set(\"name\", name);\n\n    var $element = $(v.render().el);\n    var baseType = v.model.get(\"base_type\") || \"default\";\n\n    baseType.toLowerCase();\n\n\n    var template = cdb.templates.getTemplate('table/views/basemap/basemap_dropdown_cat');\n\n    if (baseType) {\n      var category = lyr.get(\"category\");\n      category = category || 'Others';\n      var listClassName = '.custom ul.' + category.toLowerCase();\n      var $ul = this.$(listClassName);\n      if (!$ul.length) {\n        this.$('.js-customBasemaps').prepend(\n          template({\n            category: category\n          })\n        );\n        $ul = this.$(listClassName);\n      }\n      $ul.append($element);\n    }\n\n    this._toggleAddBaseLayer();\n\n  },\n\n  _getCleanClassName: function(className) {\n\n    if (!className) return false;\n\n    return className\n    .replace(/default /g, '')\n    .replace(/\\s+/g, '')\n    .replace(/[^a-zA-Z_0-9 ]/g, \"\")\n    .toLowerCase();\n\n  },\n\n  _updateTarget: function(subview) {\n\n    var className = subview.model.get(\"className\");\n    var type      = subview.model.get(\"type\");\n    var color     = subview.model.get(\"color\");\n    var image     = subview.model.get(\"image\");\n\n\n    var kind      = (color ? 'color' : undefined ) || ( image ? 'pattern' : undefined ) || '';\n\n    var className = this._getCleanClassName(className);\n    if (className === 'googlemaps') {\n      className = subview.model.get('base_type');\n      // Adding the custom base name to set properly\n      // the background image\n      var baseName = subview.model.get('baseName');\n      className += baseName ? ( '.' + baseName ) : '';\n    }\n\n    var $el = this.$el.find(\"a.\" + className);\n\n    if (kind) {\n      $el = this.$el.find(\"a.\" + className + '.' + kind);\n    }\n\n    this._setName($el);\n    this._setThumbnail($el, color, image);\n\n  },\n\n  _setName: function($el) {\n\n    var name = $el.attr(\"data-name\");\n\n    if (!name) name = \"Change basemap\";\n\n    name = cdb.Utils.truncate(name, 40);\n\n    this.options.target.find(\".info .name\").html(name);\n\n  },\n\n  _setThumbnail: function($el, color, image) {\n\n    if (image) image = \"url(\" + image + \")\" ;\n\n    var $thumb = $el.find(\".thumb\");\n\n    // Thanks Firefox\n    var bkg   = image || $thumb.css(\"background-image\");\n    var size  = $thumb.css(\"background-size\");\n    var pos   = $thumb.css(\"background-position\");\n\n    if (!bkg || bkg === \"none\") {\n      color = color || $thumb.css(\"background-color\");\n    } else {\n      color = \"#000\";\n    }\n\n    this.options.target.find(\"> .thumb\").css({\n      \"background-image\": bkg,\n      \"background-position\": pos,\n      \"background-size\": size,\n      \"background-color\": color\n    });\n\n  },\n\n  _addBackgroundBasemap: function() {\n\n    this.background_image = new cdb.admin.BackgroundMapImageView({ model: this.model.getBaseLayer(), map: this.model, user: this.options.user });\n    this.addView(this.background_image);\n\n    var $view = $(this.background_image.render().el);\n\n    var $ul = this.$el.find('.custom ul.custom');\n    $ul.append($view);\n\n  },\n\n  _addColorBasemap: function() {\n\n    this.background_color = new cdb.admin.BackgroundMapColorView({ model: this.model.getBaseLayer(), map: this.model });\n    this.addView(this.background_color);\n\n    var $view = $(this.background_color.render().el);\n\n    var $ul = this.$el.find('.custom ul.custom');\n    $ul.append($view);\n\n    this.background_color.delegateEvents();\n\n  },\n\n  _addAddBasemapLink: function() {\n    var $a = $('<li class=\"add_basemap hidden\"><a class=\"add small\" href=\"#add_basemap\"><div class=\"thumb\"></div></a></li>');\n\n    var $ul = this.$el.find('.custom ul.yours');\n    $ul.append($a);\n\n  },\n\n  show: function() {\n\n    var dfd = $.Deferred();\n    var self = this;\n\n    //sometimes this dialog is child of a node that is removed\n    //for that reason we link again DOM events just in case\n    this.delegateEvents();\n    this.$el\n    .css({\n      marginTop: self.options.vertical_position == \"down\" ? \"-10px\" : \"10px\",\n      opacity:0,\n      display:\"block\"\n    })\n    .animate({\n      margin: \"0\",\n      opacity: 1\n    }, {\n      \"duration\": this.options.speedIn,\n      \"complete\": function(){\n        dfd.resolve();\n      }\n    });\n\n    this.trigger(\"onDropdownShown\", this.el);\n    this._toggleAddBaseLayer();\n\n    return dfd.promise();\n  },\n\n  open: function(ev,target) {\n\n    // Target\n    var $target = target && $(target) || this.options.target;\n    this.options.target = $target;\n\n    var vertical_position = this.options.target.position().top + this.options.vertical_offset;\n    var vertical_property = this.options.vertical_position == \"up\" ? \"bottom\" : \"top\";\n\n    this.$el.css(vertical_property, vertical_position);\n\n    this.$el.css({\n      left: this.options.horizontal_offset\n    })\n    .addClass(\n      // Add vertical and horizontal position class\n      (this.options.vertical_position == \"up\" ? \"vertical_top\" : \"vertical_bottom\" )\n      + \" \" +\n        (this.options.horizontal_position == \"right\" ? \"horizontal_right\" : \"horizontal_left\" )\n      + \" \" +\n        // Add tick class\n        \"border tick_\" + this.options.tick\n    )\n\n    // Show it\n    this.show();\n\n    // Dropdown open\n    this.isOpen = true;\n  },\n\n  hide: function(done) {\n\n    if (!this.isOpen) {\n      done && done();\n      return;\n    }\n\n    var self    = this;\n    this.isOpen = false;\n\n    this.$el.animate({\n      marginTop: self.options.vertical_position == \"down\" ? \"10px\" : \"-10px\",\n      opacity: 0\n    }, this.options.speedOut, function(){\n\n      // And hide it\n      self.$el.hide();\n\n    });\n\n    this.trigger(\"onDropdownHidden\",this.el);\n  },\n\n  _addBaseDefault: function() {\n    this.baseLayers.each(this.add);\n  },\n\n  /**\n   *  When a new base layer is activated,\n   *  we apply the select to the correct base layer button\n   */\n  setActiveBaselayer: function(layer) {\n\n    for (var sv in this._subviews) {\n\n      var subview = this._subviews[sv];\n\n      if (subview.model && this.model.getBaseLayer && this.model.getBaseLayer().isEqual(subview.model)) {\n        // We have to CHANGE AND REMOVE this things, we can't\n        // control the basemap selected in this way :(\n        if (subview.model.get('type') != \"Plain\") {\n          subview.selectButton();\n        }\n        this._updateTarget(subview);\n        return;\n      }\n    }\n\n  },\n\n  /*\n   * Creates a modal dialog to let the user create a new basemap\n   */\n  _openSelector: function(ev) {\n    ev.preventDefault();\n\n    var view = new cdb.editor.AddCustomBasemapView({\n      map: this.model,\n      baseLayers: this.baseLayers,\n      clean_on_hide: true,\n      enter_to_confirm: true\n    });\n    view.appendToBody();\n  },\n\n  /*\n   * Renders the basemap dropdown\n   */\n  render: function() {\n    this.clearSubViews();\n    var googleMapsEnabled = this.googleMapsEnabled() || this.user.featureEnabled('google_maps');\n\n    this.$el.html(\n      this.template_base(\n        _.extend(this.options, {\n          googleMapsEnabled: googleMapsEnabled\n        })\n      )\n    );\n\n    this._addBaseDefault();\n    this._addColorBasemap();\n    this._addBackgroundBasemap();\n\n    if (!googleMapsEnabled) {\n      this._addAddBasemapLink();\n    }\n\n    return this;\n  },\n\n  clean: function() {\n    $(document).unbind('keydown', this._keydown);\n    cdb.ui.common.Dropdown.prototype.clean.call(this);\n  }\n\n});\n","\n/**\n *  Color Base layer\n */\ncdb.admin.BackgroundMapColorView = cdb.admin.BaseLayerButton.extend({\n\n  events: {\n    'click': '_openPicker'\n  },\n\n  tagName: 'li',\n  className: 'map_background',\n\n  initialize: function() {\n    _.bindAll(this, 'setColor');\n    this.map = this.options.map;\n    this.template = cdb.templates.getTemplate('table/views/basemap/color_basemap');\n    this.bindMap(this.map);\n    this.map.bind('savingLayersFinish', this._changeModel, this);\n    this._initBinds();\n  },\n\n  render: function() {\n    this.$el.html(this.template(this.model.attributes));\n    this.elder('render');\n    return this;\n  },\n\n  activate: function(color) {\n    var lyr = new cdb.admin.PlainLayer({\n      color: color,\n      image: '',\n      maxZoom: 32\n    });\n\n    this.model = lyr;\n\n    this.map.changeProvider('leaflet', lyr);\n\n    return false;\n  },\n\n  _changeModel: function() {\n    if (this.model) {\n      this.model.unbind(null, null, this);\n    }\n\n    this.model = this.map.getBaseLayer();\n    this._initBinds();\n    this.render();\n  },\n\n  _initBinds: function() {\n    this.model.bind('change', this.render, this);\n  },\n\n  _createPicker: function() {\n    var self = this;\n\n    this.color_picker = new cdb.admin.ColorPicker({\n      className: 'dropdown color_picker basemap border vertical_offset',\n      target: this.$el,\n      vertical_position: \"up\",\n      horizontal_position: \"left\",\n      vertical_offset: -42,\n      horizontal_offset: 50,\n      tick: \"bottom\",\n      dragUpdate: false\n    }).bind(\"colorChosen\", this.setColor, this);\n\n    this._bindPicker();\n    this.addView(this.color_picker);\n  },\n\n  _destroyPicker: function() {\n    if (this.color_picker) {\n      this._unbindPicker();\n      this.removeView(this.color_picker);\n      this.color_picker.hide();\n      delete this.color_picker;\n    }\n  },\n\n  _bindPicker: function() {\n    cdb.god.bind(\"closeDialogs\", this._destroyPicker, this);\n  },\n\n  _unbindPicker: function() {\n    cdb.god.unbind(\"closeDialogs\", this._destroyPicker, this);\n  },\n\n  setColor: function(color, close) {\n    if (close) cdb.god.trigger(\"closeDialogs\");\n\n    // Set new model\n    this.activate(color);\n\n    // Render color\n    this.render();\n\n    // Set general thumb\n    $(\"ul.options .basemap_dropdown .info strong\").text(\"Color: \" + color);\n    $(\"ul.options .basemap_dropdown a.thumb\").css(\"background-color\", color);\n\n    this.selectButton();\n\n    // Event tracking \"Applied color as basemap\"\n    cdb.god.trigger('metrics', 'color_basemap', {\n      email: window.user_data.email\n    });\n  },\n\n  _openPicker: function(e) {\n    this.killEvent(e);\n\n    if (this.color_picker) this._destroyPicker();\n\n    if (!this.color_picker) {\n      this._createPicker();\n      $('body').append(this.color_picker.render().el);\n      this.color_picker.init(this.model.get('color'));\n    }\n  },\n\n  selectButton: function() {\n    this.$el.closest('.dropdown.basemap').find('li.selected').removeClass('selected');\n    this.$el.addClass('selected');\n  }\n});\n","\n/**\n *  Layers based on Leaflet\n */\ncdb.admin.BaseMapView = cdb.admin.BaseLayerButton.extend({\n\n  events: {\n    'click .remove_layer': '_openDropdown',\n    'click': 'activate'\n  },\n\n  defaults: {\n    // subdomain by default 'a'\n    s: 'a',\n    // x,y,z position of the base tile preview\n    x: 30,\n    y: 24,\n    z: 6\n  },\n\n  tagName: 'li',\n  className: 'leaflet',\n\n  initialize: function() {\n\n    this.options = _.defaults(this.options,this.defaults);\n    this.map     = this.options.map;\n\n    this.model.bind('destroy', this.clean, this);\n\n    this.bindMap(this.map);\n\n  },\n\n  render: function() {\n\n    //TODO: move this to model\n    var subdomains = this.model.get(\"subdomains\");\n    var back_tile = this.model.get(\"urlTemplate\")\n    .replace(\"{s}\", subdomains && subdomains.length ? subdomains[0] : this.options.s)\n    .replace(\"{z}\", this.options.z)\n    .replace(\"{x}\", this.options.x)\n    .replace(\"{y}\", this.options.y);\n\n    var $e;\n\n    var type      = this.model.get(\"type\") && this.model.get(\"type\").toLowerCase();\n    var proxy     = this.model.get(\"proxy\"); // If it comes from CartoDB proxy\n    var className = this.model.get('className');\n\n    if (type === 'wms' || proxy ) {\n      $e = $(\"<div class='thumb'></div>\");\n    } else {\n      $e = $(\"<div class='thumb' style='background-image:url(\" + back_tile + \")'></div>\");\n    }\n\n    var $a = $(this.make(\"a\", { \"class\": className }, $e));\n    $a.attr(\"data-name\", this.model.get(\"name\"));\n\n    if (!this.model.get('read_only')) {\n      del = this.make(\"span\", {\"class\": \"remove_layer\"});\n      $a.find(\".thumb\").append(del);\n    }\n\n    this.$el.html($a);\n    this.$el.attr('data-tipsy', this.model.get(\"name\"));\n    this.$el.attr(\"title\", this.model.get(\"name\"));\n\n    this.$el .tipsy({ gravity: 's', live: true, fade: true }); \n\n    this.elder('render');\n\n    return this;\n  },\n\n  activate: function(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    cdb.god.trigger(\"closeDialogs\");\n\n    // when the user selects a normal base layer select leaflet by default\n    var lyr = this.model.clone();\n    lyr.set('id', undefined); // force creation\n    this.map.changeProvider('leaflet', lyr);\n\n    return false;\n  },\n\n  _openDropdown: function(ev) {\n    var self = this;\n\n    ev.preventDefault();\n    ev.stopPropagation();\n    ev.stopImmediatePropagation();\n\n    this.dropdown = new cdb.admin.DropdownMenu({\n      className: 'dropdown border short',\n      target: this.$('.remove_layer'),\n      width: 196,\n      speedIn: 150,\n      speedOut: 300,\n      template_base: 'table/views/remove_layer_content',\n      vertical_position: \"down\",\n      horizontal_position: \"left\",\n      horizontal_offset: 3,\n      clean_on_hide: true,\n      tick: \"left\"\n    });\n\n    this.dropdown.bind(\"optionClicked\", function(ev) {\n      ev.preventDefault();\n      self.model.destroy();\n    });\n\n    $('body').append(this.dropdown.render().el);\n    this.dropdown.open(ev);\n    cdb.god.bind(\"closeDialogs\", this.dropdown.hide, this.dropdown);\n\n    return false;\n  }\n});\n","\n/**\n *  Layers based on Google Maps v3\n */\ncdb.admin.GMapsBaseView = cdb.admin.BaseLayerButton.extend({\n\n  events: {\n    'click': 'activate'\n  },\n\n  tagName: 'li',\n  className: 'gmaps',\n\n  initialize: function() {\n    this.options = _.defaults(this.options,this.defaults);\n    this.map = this.options.map;\n\n    this.bindMap(this.map);\n  },\n\n  render: function() {\n    var $e = $(\"<div class='thumb'></div>\" );\n    var $a = $(this.make(\"a\", {\n      \"class\": this.model.get('base_type') + \" \" + ( this.model.get('baseName') || \"\" )\n      }, $e)\n    );\n\n    $a.attr(\"data-name\", this.model.get(\"name\"));\n\n    this.$el.html($a);\n    this.$el.attr('data-tipsy', this.model.get(\"name\"));\n    this.$el.attr(\"title\", this.model.get(\"name\"));\n\n    this.$el.tipsy({ gravity: 's', live: true, fade: true }); \n\n    this.elder('render');\n\n    return this;\n  },\n\n  activate: function(e) {\n    e.preventDefault();\n    cdb.god.trigger(\"closeDialogs\");\n\n    this.map.changeProvider('googlemaps', this.model.clone());\n    return false;\n  }\n});\n","\n/**\n *  Pattern image base layer\n *\n *  - It extends from color basemap\n */\n\ncdb.admin.BackgroundMapImageView = cdb.admin.BackgroundMapColorView.extend({\n\n  events: {\n    'click': '_openImagePicker'\n  },\n\n  initialize: function() {\n    _.bindAll(this, 'setPattern');\n    this.map = this.options.map;\n    this.user = this.options.user;\n    this.template = cdb.templates.getTemplate('table/views/basemap/pattern_basemap');\n    this.bindMap(this.map);\n    this.map.bind('savingLayersFinish', this._changeModel, this);\n    this._initBinds();\n  },\n\n  activate: function(url) {\n    var lyr = new cdb.admin.PlainLayer({\n      color: '',\n      image: url,\n      maxZoom: 28 //allow the user to zoom to the atom\n    });\n\n    this.model = lyr;\n\n    this.map.changeProvider('leaflet', lyr);\n\n    return false;\n  },\n\n  _openImagePicker: function(e) {\n    this.killEvent(e);\n\n    var dialog = new cdb.editor.ImagePickerView({\n      user: this.user,\n      kind: 'pattern'\n    });\n\n    dialog.appendToBody();\n    dialog.bind('fileChosen', this.setPattern, this);\n  },\n\n  setPattern: function(url) {\n    cdb.god.trigger(\"closeDialogs\");\n\n    // Set new model\n    this.activate(url);\n\n    // Render color\n    this.render();\n\n    // Set general thumb\n    //$(\"ul.options .basemap_dropdown .info strong\").text(\"Image pattern\");\n    $(\"ul.options .basemap_dropdown a.thumb\")\n      .css({\n        \"background-image\": \"url(\" + url + \")\",\n        \"background-size\": \"34px\",\n        \"background-position\": \"50% 50%\",\n        \"background-color\": \"transparent\"\n      });\n\n    this.selectButton();\n\n    // event tracking \"Applied pattern as basemap\"\n    cdb.god.trigger('metrics', 'pattern_basemap', {\n      email: window.user_data.email\n    });\n  }\n\n});\n","\n/**\n * dropdown to select the column type when user clicks\n * on the type\n */\ncdb.admin.ColumntypeDropdown = cdb.admin.DropdownMenu.extend({\n\n  className: 'dropdown border',\n  dialogContainer: 'body',\n\n  events: {\n    'click .string': 'setString',\n    'click .number': 'setNumber',\n    'click .date': 'setDate',\n    'click .boolean': 'setBool'\n  },\n\n  initialize: function() {\n    _.bindAll(this, 'setColumnTypeChange', 'setString', 'setNumber', 'setDate', 'setBool');\n    this.elder('initialize');\n  },\n\n  setTable: function(table, column) {\n    var self = this;\n    this.table = table;\n    this.column = column;\n    var type = this.table.getColumnType(column);\n    this._disableColumn(type);\n    _([\"string\", \"number\", \"boolean\", \"date\"]).each(function(c) {\n      if (!self.table.isTypeChangeAllowed(self.column,c)) {\n        self._disableColumn(c, { keep_disabled: true });\n      }\n    });\n  },\n\n  // Disable current selected column\n  _disableColumn: function(type, options) {\n    options = options || {};\n    if(!options.keep_disabled) {\n      this.$('li.disabled').removeClass('disabled');\n    }\n    this.$('li a.' + type).parent().addClass('disabled');\n  },\n\n  setColumnTypeChange: function(type) {\n    var self = this;\n    self.hide();\n\n    if (this.table.isTypeChangeDestructive(this.column, type)) {\n      this.change_confirmation = cdb.editor.ViewFactory.createDialogByTemplate('common/dialogs/confirm_type_change', {\n        title: \"Confirm type change\",\n        description: \"Unconvertible data will be lost. Are you sure?\"\n      });\n\n      this.change_confirmation.ok = function() {\n        self.table.changeColumnType(self.column, type);\n        this.close && this.close();\n      }\n\n      this.change_confirmation\n      .appendToBody()\n      .open();\n    } else {\n      this.table.changeColumnType(this.column, type);\n    }\n  },\n\n  setString: function(e) {\n    this.killEvent(e);\n    if (this.table.isTypeChangeAllowed(this.column, 'string'))\n      this.setColumnTypeChange('string');\n  },\n\n  setNumber: function(e) {\n    this.killEvent(e);\n    if (this.table.isTypeChangeAllowed(this.column, 'number'))\n      this.setColumnTypeChange('number');\n  },\n\n  setDate: function(e) {\n    this.killEvent(e);\n    if (this.table.isTypeChangeAllowed(this.column, 'date'))\n      this.setColumnTypeChange('date');\n  },\n\n  setBool: function(e) {\n    this.killEvent(e);\n    if (this.table.isTypeChangeAllowed(this.column, 'boolean'))\n      this.setColumnTypeChange('boolean');\n  }\n\n});\n","  /**\n   *  Editor small dialog where cell editor will be placed on it.\n   */\n\n  cdb.admin.SmallEditorDialog = cdb.admin.SmallDialog.extend({\n\n    initialize: function() {\n      _.defaults(this.options, {\n        template_name: 'old_common/views/dialog_small_edit',\n        ok_title: 'Save',\n        modal_class: 'edit_text_dialog',\n        clean_on_hide: true\n      });\n\n      cdb.ui.common.Dialog.prototype.initialize.apply(this);\n      this.render();\n\n      // Ouch!!\n      $(document.body).find(\"div.table table\").append(this.el);\n    },\n\n    /**\n     *  Render correct editor\n     */\n    render_content: function() {\n      var $content  = $('<div>');\n      \n      if (this.options.editorField) {\n        this.editor   = new this.options.editorField({\n                        label:      false,\n                        autoResize: false,\n                        rowNumber:  this.options.rowNumber,\n                        row:        this.options.row,\n                        readOnly:   this.options.readOnly,\n                        model: new cdb.core.Model({\n                          attribute:  this.options.column,\n                          value:      this.options.value\n                        })\n                      }).bind(\"ENTER\", this._ok, this);\n\n        $content.append(this.editor.render().el);\n        this.addView(this.editor);\n      }\n\n      return $content;\n    },\n\n\n    /**\n     *  Overwriting the show function\n     */\n    showAt: function(x, y, width, fix) {\n      this.$el.css({\n        top: y,\n        left: x,\n        minWidth: width\n      });\n\n      if (fix) {\n        this.$el.find(\"textarea\").css({\n          'min-width': width - 22\n        })\n      }\n\n      this.show();\n      this.$el.find(\"textarea, input\")\n        .focus()\n        .select();\n    },\n\n\n    /**\n     *  Ok button function\n     */\n    _ok: function(ev) {\n      if(ev) ev.preventDefault();\n\n      // If the time is not ok, the dialog is not correct\n      if (!this.editor.isValid()) {\n        return false;\n      }\n\n      if (this.options.res) {\n        this.options.res(this.editor.model.get('value'));\n      }\n\n      this.hide();\n    }\n\n  });\n","cdb.admin.ExportImageFormatsDropdown = cdb.admin.DropdownMenu.extend({\n  className: 'dropdown border tiny',\n\n  events: {\n    'click .js-format': '_onClick'\n  },\n\n  initialize: function() {\n    this.elder('initialize');\n    if (!this.model) {\n      throw new Error('model is required');\n    }\n    this.model.on('change:format', this._onChangeFormat, this);\n    this.template_base = cdb.templates.getTemplate('table/views/export_image_formats');\n  },\n\n  render: function() {\n    this.$el.html(this.template_base(this.model.attributes));\n\n    // Necessary to hide dialog on click outside popup, for example.\n    cdb.god.bind('closeDialogs', this.hide, this);\n\n    $('body').append(this.el);\n\n    return this;\n  },\n\n  _onClick: function(e) {\n    this.killEvent(e);\n    this.model.set('format', $(e.target).data('format'));\n    this.hide();\n  },\n\n  _onChangeFormat: function() {\n    this.$('.js-format').removeClass('is-selected');\n    this.$(\"[data-format=\" + this.model.get('format') + \"]\").addClass('is-selected');\n  \n  },\n\n  clean: function() {\n    // Until https://github.com/CartoDB/cartodb.js/issues/238 is resolved:\n    $(this.options.target).unbind('click', this._handleClick);\n    this.constructor.__super__.clean.apply(this);\n  }\n\n});\n","/**\n *  Generate export image view\n *\n */\n\ncdb.admin.ExportImageView = cdb.core.View.extend({\n\n  className: \"ExportImageView\",\n\n  events: {\n    'click .js-ok': '_ok',\n    'click .js-format': '_openFormatDropdow',\n    'dblclick .js-format': 'killEvent',\n    'click .js-advanced': '_openAdvancedExport',\n    'click .js-close': '_close',\n    'dblclick input': 'killEvent',\n    'click input': 'killEvent',\n    'keyup input': '_onKeyUp'\n  },\n\n  _MIN_WIDTH: 520,\n  _DEFAULT_MARGIN: 45,\n  _DEFAULT_MIN_WIDTH: 480,\n\n  defaults: {\n    clean_on_hide: true,\n    top: 60,\n    left: 60,\n    horizontalMargin: 90,\n    verticalMargin: 130,\n    title: \"\",\n    description: \"\",\n    show_title: false,\n    show_description: false,\n    template_name: 'table/views/export_image_view',\n    modal_class: 'static_image_dialog'\n  },\n\n  initialize: function() {\n\n    _.bindAll(this, \"_onResizeWindow\", \"_onChangeDimensions\", \"_onImageCallback\", \"_onAdvancedImageCallback\", \"_keydown\", \"_onDrag\", \"_onResize\", \"_updateHelpers\");\n\n    $(document).bind('keydown', this._keydown);\n    $(window).on('resize', this._onResizeWindow);\n\n    this.bind(\"clean\", this._reClean);\n\n    this.map = this.options.map;\n    this.vis = this.options.vis;\n    this.mapOverlays = this.options.overlays;\n    this.header = this.mapOverlays.getHeaderOverlay();\n\n    this.vis.bind(\"change:name\", this._onChangeVisName, this);\n    this.vis.bind(\"change:description\", this._onChangeVisDescription, this);\n\n    _.extend(this.options, this.defaults, {\n      attribution: this.vis.map.get(\"attribution\"),\n      legend: $('.cartodb-map .cartodb-legend-stack').html()\n    });\n\n    if (this.header) {\n      _.extend(this.options, this.header.attributes);\n    }\n\n    this.width  = this.options.width  - this.options.horizontalMargin;\n    this.height = this.options.height - this.options.verticalMargin;\n\n    this.model = new cdb.core.Model({\n      format: 'png',\n      x: this.options.left,\n      y: this.options.top,\n      width: this.width,\n      height: this.height\n    });\n\n    this.model.bind(\"change:format\", this._onChangeFormat, this);\n    this.model.bind(\"change:x change:y change:width change:height\", this._onChangeDimensions, this);\n    this.constructor.__super__.initialize.apply(this);\n  },\n\n  render: function() {\n    this.template_base = cdb.templates.getTemplate(this.options.template_name);\n\n    this.$el.append(this.template_base(_.extend({}, this.options, { width: this.width, height: this.height })));\n\n    this._setupCanvas();\n    this._hideOverlays();\n    this._updateHelpers(this.options.left, this.options.top, this.width, this.height);\n\n    return this;\n  },\n\n  _getMarkdown: function(content) {\n    content = cdb.Utils.stripHTML(content);\n    content = markdown.toHTML(content);\n    content = cdb.Utils.stripHTML(content, '<a><i><em><strong><b><u><s>');\n    content = content.replace(/&#39;/g, \"'\"); // replaces single quote\n\n    return cdb.core.sanitize.html(content);\n  },\n\n  _onResizeWindow: function(e) {\n    if (e.target === window) {\n      this._onChangeDimensions();\n    }\n  },\n\n  _onChangeVisName: function() {\n    this.$(\".js-title\").text(this.vis.get(\"name\"));\n  },\n\n  _onChangeVisDescription: function() {\n    this.$(\".js-description\").html(this._getMarkdown(this.vis.get(\"description\")));\n  },\n\n  _setupCanvas: function() {\n    this.$(\".CanvasExport\").resizable({\n      resize: this._onResize,\n      containment: this.options.mapView.$el,\n      handles: \"n, e, s, w, ne, se, sw, nw\"\n    });\n\n    this.$(\".CanvasExport\").draggableOverlay({\n      drag: this._onDrag,\n      container: this.options.mapView.$el\n    });\n\n    this.$(\".CanvasExport\").css({\n      top: this.options.top,\n      left: this.options.left,\n      width: this.width,\n      height: this.height\n    });\n  },\n\n  _showOverlays: function() {\n    $(\".map-options\").show();\n    $(\".leaflet-control-attribution\").show();\n    $(\".cartodb-map .cartodb-legend-stack\").show();\n\n    if (this._legendsHidden) {\n      this.options.vis.map.set(\"legends\", true);\n      this._legendsHidden = false;\n    }\n\n    this.mapOverlays.overlays.each(function(overlay) {\n      var type = overlay.get(\"type\");\n      if (type !== \"zoom\" && type !== \"loader\" && type !== \"annotation\" && type !== \"text\" && type !== \"image\") {\n        overlay.set(\"display\", true);\n      }\n    }, this);\n  },\n\n  _hideOverlays: function() {\n    $(\".map-options\").hide();\n    $(\".leaflet-control-attribution\").hide();\n    $(\".cartodb-map .cartodb-legend-stack\").hide();\n\n    if (this.options.vis.map.get(\"legends\")) {\n      this.options.vis.map.set(\"legends\", false);\n      this._legendsHidden = true;\n    }\n\n    this.mapOverlays.overlays.each(function(overlay) {\n      var type = overlay.get(\"type\");\n      if (type !== \"zoom\" && type !== \"loader\" && type !== \"annotation\" && type !== \"text\" && type !== \"image\") {\n        overlay.set(\"display\", false);\n      }\n    }, this);\n  },\n\n  _updateHelpers: function(x, y, width, height) {\n    var canvasWidth  = this.options.mapView.$el.width();\n    var canvasHeight = this.options.mapView.$el.height();\n\n    this.$(\".CanvasExport\").css({ height: height, width: width });\n\n    this.$el.toggleClass(\"is-small\", width <= this._MIN_WIDTH);\n\n    if (x >= 0 && y >= 0) {\n      this.$(\".js-helper-north\").css({ top: 0, width: x + width + 1, height: y + 1});\n      this.$(\".js-helper-west\").css({ left: 0, top: y + 1, width: x + 1, height: height});\n      this.$(\".js-helper-south\").css({ top: y + height + 1, left: 0, width: canvasWidth, height: canvasHeight - height + y });\n      this.$(\".js-helper-east\").css({ left: x + width + 1, top: 0, width: canvasWidth - width, height: y + height + 1});\n    }\n\n    var isTop = y < this._DEFAULT_MARGIN;\n    var isBottom = y + height + this._DEFAULT_MARGIN > canvasHeight;\n\n    this.$(\".CanvasExport\").toggleClass('is-small', isTop && width < this._DEFAULT_MIN_WIDTH);\n    this.$(\".CanvasExport\").toggleClass('is-top', isTop);\n    this.$(\".CanvasExport\").toggleClass('is-bottom', isBottom);\n  },\n\n  _onChangeFormat: function() {\n    this.$(\".js-formatName\").text('.' + this.model.get(\"format\"));\n  },\n\n  _onChangeDimensions: function() {\n    var width  = this.model.get(\"width\");\n    var height = this.model.get(\"height\");\n\n    var x = this.model.get(\"x\");\n    var y = this.model.get(\"y\");\n\n    if (this.dropdown) {\n      this.dropdown.hide();\n    }\n\n    this._updateHelpers(x, y, width, height);\n\n    this.$(\".js-width\").val(width);\n    this.$(\".js-height\").val(height);\n  },\n\n  _onDrag: function() {\n    var width  = this.$(\".CanvasExport\").width();\n    var height = this.$(\".CanvasExport\").height();\n    var x      = this.$(\".CanvasExport\").position().left;\n    var y      = this.$(\".CanvasExport\").position().top;\n    this.model.set({ x: x, y: y, width: width, height: height });\n  },\n\n  _onResize: function(e, ui) {\n    var width  = ui.helper.width();\n    var height = ui.helper.height();\n    var x      = ui.helper.position().left;\n    var y      = ui.helper.position().top;\n    this.model.set({ x: x, y: y, width: width, height: height });\n  },\n\n  _keydown: function(e) {\n    if (e.keyCode === 27) this._cancel();\n  },\n\n  _calcCenter: function() {\n    var x = this.model.get(\"x\") + this.model.get(\"width\") / 2;\n    var y = this.model.get(\"y\") + this.model.get(\"height\") / 2;\n\n    return this.options.mapView.pixelToLatLon([x, y]);\n  },\n\n  _isHTTPS: function() {\n    return location.protocol.indexOf(\"https\") === 0;\n  },\n\n  _onImageCallback: function(error, url) {\n    if (error && error.errors) {\n      cdb.editor.ViewFactory.createDialogByTemplate('common/templates/fail', { msg: error.errors })\n      .render().appendToBody();\n      return;\n    }\n\n    var view = new cdb.editor.ExportImageResultView({\n      vis: this.vis,\n      clean_on_hide: true,\n      enter_to_confirm: false,\n      user: this.options.user,\n      format: this.model.get('format'),\n      x: this.model.get('x'),\n      y: this.model.get('y'),\n      width: this.model.get('width'),\n      height: this.model.get('height')\n    });\n\n    view.bind(\"finish\", this._cancel, this);\n\n    view.appendToBody();\n    view.generateImage(url);\n  },\n\n  _close: function(e) {\n    this.killEvent(e);\n    this._cancel();\n  },\n\n  _openFormatDropdow: function(e) {\n    this.killEvent(e);\n\n    this.dropdown = new cdb.admin.ExportImageFormatsDropdown({\n      target: this.$(\".js-format\"),\n      model: this.model,\n      speedIn: 150,\n      speedOut: 150,\n      vertical_position: 'up',\n      horizontal_offset: 3,\n      tick: 'center'\n    });\n\n    this.addView(this.dropdown);\n    this.dropdown.render();\n    this.dropdown.open(e);\n  },\n\n  _openAdvancedExport: function(e) {\n\n    var width  = this.model.get(\"width\");\n    var height = this.model.get(\"height\");\n\n    var view = new cdb.editor.AdvancedExportView({\n      mapView: this.options.mapView,\n      clean_on_hide: true,\n      enter_to_confirm: false,\n      user: this.options.user,\n      format: this.model.get('format'),\n      x: this.$(\".CanvasExport\").position().left,\n      y: this.$(\".CanvasExport\").position().top,\n      width: width,\n      height: height\n    });\n\n    view.appendToBody();\n    view.bind(\"generate_image\", this._onAdvancedImageGeneration, this);\n    this._close();\n  },\n\n  _onAdvancedImageGeneration: function(options) {\n    this.url  = this.options.vizjson;\n\n    var width  = options.width;\n    var height = options.height;\n    var format = options.format;\n    var bounds = [];\n\n    bounds.push([options.bounds[0][1], options.bounds[0][0]]);\n    bounds.push([options.bounds[1][1], options.bounds[1][0]]);\n\n    cdb.Image(this.url, { https: this._isHTTPS() })\n    .size(width, height)\n    .bbox(bounds)\n    .format(format)\n    .getUrl(this._onAdvancedImageCallback);\n  },\n\n  _onAdvancedImageCallback: function(error, url) {\n    if (error && error.errors) {\n      cdb.editor.ViewFactory.createDialogByTemplate('common/templates/fail', { msg: error.errors })\n      .render().appendToBody();\n      return;\n    }\n\n    var view = new cdb.editor.ExportImageResultView({\n      vis: this.vis,\n      clean_on_hide: true,\n      enter_to_confirm: false\n    });\n\n    view.bind(\"finish\", this._cancel, this);\n\n    view.appendToBody();\n    view.loadURL(url);\n  },\n\n  _ok: function(e) {\n    this.killEvent(e);\n\n    this.url  = this.options.vizjson;\n\n    var center = this._calcCenter();\n\n    var width  = this.model.get(\"width\");\n    var height = this.model.get(\"height\");\n\n    cdb.Image(this.url, { https: this._isHTTPS() })\n    .format(this.model.get('format'))\n    .size(width, height)\n    .center([center.lat, center.lng])\n    .zoom(this.map.get('zoom'))\n    .getUrl(this._onImageCallback);\n  },\n\n  _onKeyUp: function(e) {\n    this.killEvent(e);\n\n    var property = \"width\";\n    var value = +$(e.target).val();\n\n    if ($(e.target).hasClass(\"js-height\")) {\n      property = \"height\";\n    }\n\n    if (e.keyCode === $.ui.keyCode.UP) {\n      value++;\n    } else if (e.keyCode === $.ui.keyCode.DOWN) {\n      value--;\n    }\n\n    if (property === 'height') {\n      var top = this.$(\".CanvasExport\").position().top;\n      var canvasHeight = this.options.mapView.$el.height();\n\n      if (top + value > canvasHeight) {\n        value = canvasHeight - top;\n        this.$(\".js-height\").val(value);\n      }\n    } else {\n      var left = this.$(\".CanvasExport\").position().left;\n      var canvasWidth  = this.options.mapView.$el.width();\n\n      if (left + value > canvasWidth) {\n        value = canvasWidth - left;\n        this.$(\".js-width\").val(value);\n      }\n    }\n\n    if (_.isNumber(value)) {\n      this.model.set(property, value);\n    }\n  },\n\n  _cancel: function(e) {\n    this.killEvent(e);\n    this._showOverlays();\n    this.hide();\n  },\n\n  hide: function() {\n    this.trigger(\"was_removed\", this);\n    this.$el.hide();\n    this.clean();\n  },\n\n  clean: function() {\n    $(document).unbind('keydown', this._keydown);\n    $(window).off(\"resize\", this._onResizeWindow);\n    this.elder('clean');\n  },\n\n  open: function() {\n    this.$el.show();\n  }\n});\n","\ncdb.admin.GeometryEditor = cdb.core.View.extend({\n\n  className: \"editing\",\n  MAX_VERTEXES: 2000,\n\n  events: {\n    'click .done': 'finish',\n    'click .discard': 'discard',\n    'click .cancel': 'discard',\n    'mousedown': 'killEvent'\n  },\n\n  TEXTS: {\n    'invalid geometry': _t('Overlapping polygons is not supported for same record')\n  },\n\n  initialize: function() {\n    this.add_related_model(this.model);\n    this.geomBeingEdited = null;\n    this.drawer = null;\n  },\n\n  isEditing: function() {\n    return this.geomBeingEdited ? true: false;\n  },\n\n  /**\n   * finish the editing if there is some geometry being edited and save it\n   * triggers editFinish\n   */\n  finish: function(e) {\n    this.killEvent(e);\n\n    if ((this.drawer && this.drawer.canFinish()) || this.isEditing()) {\n      var self = this;\n\n      if(this.geomBeingEdited) {\n        this.geomBeingEdited.destroy();\n        this.geomBeingEdited = null;\n      }\n      if(this.drawer) {\n        this.row.set('the_geom', JSON.stringify(this.drawer.getGeoJSON()));\n        this.drawer.clean();\n        this.drawer = null;\n      }\n      var isNew = this.row.isNew()\n\n      this.model.notice('Saving ... ', 'load');\n      $.when(this.row.save(null)).done(function() {\n        if(isNew){\n          self.trigger('geomCreated', self.row);\n        }\n        self.trigger('editFinish')\n        self.model.notice('Saved', 'info', 5000);\n        self.row = null;\n      }).fail(function(e) {\n        self.trigger('editFinish');\n        var err = 'Something has failed';\n        try {\n          err = JSON.parse(e.responseText || e.response).errors[0];\n        } catch(e) {}\n        err = self.TEXTS[err.toLowerCase()] || err;\n        self.model.notice(err , 'error', 5000);\n        self.row = null;\n      });\n\n\n      this.hide();\n    }\n  },\n\n  /**\n   * finish the editing and undo the changes done.\n   * triggers 'editDiscard'\n   */\n  discard: function(e) {\n    this.killEvent(e);\n    if(this.geomBeingEdited) {\n      this.geomBeingEdited.destroy();\n      this.geomBeingEdited = null;\n      this.row.set('the_geom', this.originalGeom);\n      this.originalGeom = null;\n      this.row = null;\n      this.trigger('editDiscard');\n    }\n    if(this.drawer) {\n      this.drawer.clean();\n      this.drawer = null;\n      this.trigger('editDiscard');\n    }\n    this.mapView.unbind(null, null, this);\n    this.hide();\n  },\n\n  _getGeomCount: function(geojson) {\n    var count = 0;\n\n    _.each(geojson.coordinates, function(pol1, i){\n      _.each(pol1, function(pol2, j) {\n        count = count + pol2.length;\n      })\n    });\n\n    return count;\n  },\n\n  /**\n   * edits the row geometry\n   * the row should contain the_geom attribute.\n   * When the edit is finish the row is saved\n   */\n  editGeom: function(row) {\n    var self = this;\n\n    //fetch to get the geometry\n    row.fetch({\n      success: function() {\n        var geojson = JSON.parse(row.get('the_geom'));\n        if (self._getGeomCount(geojson) > self.MAX_VERTEXES) {\n          self._showStopEdit(row);\n          return false;\n        } else {\n          self._startEdition(row);\n        }\n      }\n    });\n\n  },\n\n  _startEdition: function(row) {\n    this.trigger('editStart');\n    this.discard();\n    var geo = new cdb.geo.Geometry({\n      geojson: JSON.parse(row.get('the_geom')),\n      // Supporting leaflet and gmaps styles, overrriding them\n      style: {\n        fillColor: \"white\",\n        fillOpacity: 0.4,\n        weight: 4,\n        color:\"#397DBA\",\n        opacity: 1,\n        strokeColor: \"#397DBA\",\n        clickable: false\n      }\n    });\n\n    this.row = row;\n    this.originalGeom = row.get('the_geom');\n    this.geomBeingEdited = geo;\n\n    // when model is edited the model changes\n    geo.bind('change:geojson', function() {\n      row.set({the_geom: JSON.stringify(geo.get('geojson'))});\n    });\n\n    this.mapView.map.addGeometry(geo);\n    var geoView = this.mapView.geometries[geo.cid];\n    geoView.edit(true);\n    this.$('.finish_editing .tooltip').hide();\n    this.$el.fadeIn();\n  },\n\n  _showStopEdit: function(row) {\n    var dlg = cdb.editor.ViewFactory.createDialogByTemplate('common/dialogs/confirm_edit_geom');\n\n    // If user confirms, app removes the row\n    var self = this;\n    dlg.ok = function() {\n      self._startEdition(row);\n    };\n\n    dlg\n      .appendToBody()\n      .open();\n  },\n\n  /**\n   * create geometry\n   * @param row a row model, normally empty\n   * @param type can be 'point', 'polygon', 'line'\n   */\n  createGeom: function(row, type) {\n    var self = this;\n    this.discard();\n    this.row = row;\n    this.geomType = type;\n    this.trigger('editStart');\n    var editors = {\n      'point': PointDrawTool,\n      'polygon': PolygonDrawTool,\n      'line': PolylineDrawTool\n    };\n    this.drawer = new editors[type]({\n      mapview: this.mapView\n    });\n    this.drawer.start();\n    var c;\n    this.mapView.bind('click', c = function() {\n      if(self.drawer.canFinish()) {\n        this.mapView.unbind('click', c);\n        self.$('.finish_editing .tooltip').fadeOut();\n        self.$('.finish_editing .done').removeClass(\"disabled\");\n      }\n    }, this);\n    this.render();\n    this.$('.finish_editing .done').addClass(\"disabled\");\n    this.$('.finish_editing .tooltip').show();\n    this.$el.fadeIn();\n  },\n\n  render: function() {\n    this.$el.html(this.getTemplate('table/views/geom_edit')({ geom_type: this.geomType}));\n    return this;\n  }\n});\n","\n  /**\n   *  Header sync info when visualization is table type\n   *\n   *  - If there is any change in the state, it will be rendered again.\n   *\n   *  new cdb.admin.SyncInfo({\n   *    model: synchronization_model\n   *  });\n   */\n\n  cdb.admin.SyncInfo = cdb.core.View.extend({\n\n    tagName: 'div',\n    className: 'sync_info',\n\n    _SYNC_GAP: 15,      // Gap necessary to perform next synchronization\n                        // Value in MINUTES\n    _POLLING_GAP: 15,   // Gap necessary to start polling and checking\n                        // synchronization. Value in SECONDS\n\n    _TEXTS: {\n      enabled:            _t('This table will be synced again <%- run_at %>'),\n      few_moments:        _t('in a few moments'),\n      sync_now_disabled:  _t('You will be able to sync manually <%- gap %> minutes after your last synchronization')\n    },\n\n    events: {\n      'click a.sync_options': '_onClickOptions',\n      'click a.sync_now':     '_onClickSyncNow'\n    },\n\n    initialize: function() {\n      _.bindAll(this, '_startSync');\n\n      this.dataLayer = this.options.dataLayer;\n      this.table = this.dataLayer.table;\n      this.model = this.table.synchronization;\n      this.template = cdb.templates.getTemplate('table/header/views/sync_info_content');\n      this.model.bind('change', this.render, this);\n\n      // Check sync now button\n      if (this._isSyncing()) {\n        this._showSyncNow();\n        this._startSync();\n      }\n    },\n\n    render: function() {\n      var attrs = _.clone(this.model.attributes);\n      var self = this;\n\n      // Destroy tipsy just in case\n      this._destroyTipsy();\n\n      attrs.ran_at = moment(attrs.ran_at || new Date()).fromNow();\n\n      // Due to the time we need to polling, we have to display to the user\n      // that the sync will be in a moment\n      if (!attrs.run_at || (new Date(attrs.run_at) <= new Date())) {\n        attrs.run_at = this._TEXTS.few_moments;\n      } else {\n        attrs.run_at = moment(attrs.run_at).fromNow();\n      }\n\n      // Can table be synced?\n      attrs.canSync = this._canTableSyncNow() ? true : false ;\n\n      // Come from external source?\n      attrs.fromExternalSource = this.model.get(\"from_external_source\");\n\n      // Render\n      this.$el\n        .html(this.template(attrs))\n        .attr('class', '')\n        .addClass(attrs.state + ' ' + this.className);\n\n      // Tipsy?\n      this.$(\".sync_now_disabled\").tipsy({\n        gravity:  's',\n        fade:     true,\n        title: function() {\n          return _.template(self._TEXTS.sync_now_disabled)({ gap: self._SYNC_GAP })\n        }\n      });\n\n      return this;\n    },\n\n    _bindEvents: function() {\n      this.model.bind('change:state', this._onStateChange, this);\n    },\n\n    _unbindEvents: function() {\n      this.model.unbind('change:state', this._onStateChange, this)\n    },\n\n    // Helpers\n\n    _canTableSyncNow: function() {\n      var ran_at = new Date(this.model.get('ran_at'));\n      var now = new Date();\n      var state = this.model.get('state');\n      var gap = this._SYNC_GAP*60*1000;   // Importer needs some time to perform the next sync,\n                                          // set 15 min as default.\n\n      // If table is syncing... false!\n      if (state === \"syncing\") {\n        return false\n      }\n\n      if (( now.getTime() - ran_at.getTime() ) > gap) {\n        return true;\n      } else {\n        return false;\n      }\n    },\n\n    _isSyncing: function() {\n      return this.model.get('state') === \"syncing\";\n    },\n\n\n    // UI bind events //\n\n    _onClickSyncNow: function(e) {\n      if (e) this.killEvent(e);\n\n      if (this._canTableSyncNow()) {\n        // Set syncing state\n        this.model.set('state', 'syncing');\n        // Show dialog\n        this._showSyncNow();\n        // Enqueue synchronization\n        this.model.syncNow(this._startSync);\n      }\n    },\n\n    _onClickOptions: function(e) {\n      if (e) this.killEvent(e);\n      var dialog = new cdb.editor.SyncView({\n        clean_on_hide: true,\n        enter_to_confirm: true,\n        table: this.table\n      });\n      dialog.appendToBody();\n    },\n\n\n    _startSync: function() {\n      // Render again\n      this.render();\n      // Bind events\n      this._bindEvents();\n      // We MUST wait before start polling\n      var self = this;\n      _.delay(function() {\n        self.model.pollCheck();\n      }, (this._POLLING_GAP * 1000)); // polling gap * miliseconds\n    },\n\n    _finishSync: function() {\n      this._unbindEvents();\n      this.model.destroyCheck();\n      this._hideSyncNow();\n\n      // Reload table and map data\n      this.dataLayer.invalidate();\n      this.table.data().refresh();\n    },\n\n    _onStateChange: function() {\n      this._finishSync();\n\n      // Success state could be wrong if any error_code\n      // or error_message appears in the model\n      if (this.model.get('state') === \"success\" &&\n          (this.model.get('error_code') || this.model.get('error_message'))\n        ) {\n        this.model.set('state', 'failure');\n      }\n\n      this.render();\n    },\n\n\n    // Show or hide sync now modal //\n\n    _showSyncNow: function(e) {\n      if (e) this.killEvent(e);\n\n      var modal = cdb.editor.ViewFactory.createDialogByTemplate('common/templates/loading', {\n        title: 'Your dataset is being synced…',\n        quote: \"This action will take some time. In the meantime the UI is disabled, but APIs will work as usual.\"\n      }, { sticky: true }).render();\n      this.sync_now = modal;\n      modal.appendToBody();\n    },\n\n    _hideSyncNow: function() {\n      if (this.sync_now) {\n        this.sync_now.hide();\n      }\n    },\n\n\n    _destroyTipsy: function() {\n      // Remove tipsy\n      if (this.$('.sync_now_disabled').data('tipsy')) {\n        this.$('.sync_now_disabled')\n          .unbind('mouseenter mouseleave')\n          .data('tipsy').remove();\n      }\n    },\n\n    clean: function() {\n      this._destroyTipsy();\n      cdb.core.View.prototype.clean.call(this);\n    }\n\n  })\n","/**\n *  Header table view options menu\n *\n *  It needs a visualization model + account config data.\n *\n *  var options_menu = new cdb.admin.HeaderOptionsMenu({\n *    target:         $(a),\n *    model:          vis_model,\n *    user:           user_model,\n *    geocoder:       geocoder,\n *    template_base: 'table/header/views/options_menu'\n *  })\n *\n */\n\n\ncdb.admin.HeaderOptionsMenu = cdb.admin.DropdownMenu.extend({\n\n  className: 'dropdown table-options',\n\n  _TEXTS: {\n    error: _t('Something went wrong, try again later')\n  },\n\n  events: {\n    'click .lock_vis':        '_lockVis',\n    'click .export_map':      '_exportMap',\n    'click .export_table':    '_exportTable',\n    'click .duplicate_table': '_duplicateDataset',\n    'click .duplicate_vis':   '_duplicateVis',\n    'click .append_data':     '_appendData',\n    'click .delete_table':    '_deleteItem',\n    'click .georeference':    '_georeference',\n    'click .merge_tables':    '_mergeTables',\n    'click .change_privacy':  '_changePrivacy',\n    'click .sync_settings':   '_syncSettings',\n    'click .delete_vis':      '_deleteItem'\n  },\n\n  render: function() {\n    var opts = this.options;\n    this.user = this.options.user;\n    this.dataLayer = this.options.dataLayer;\n    this.table = this.dataLayer.table;\n\n    opts.isVisualization = this.model.isVisualization();\n    opts.table = this.table;\n    opts.dataLayer = this.options.dataLayer;\n\n    // Get ownership from the visualization or from the table selected\n    // depending the type of it (table or derived)\n    // opts.isOwner = this[ this.model.isVisualization() ? 'model' : 'table' ].permission.isOwner(this.options.user);\n    opts.isLayerOwner = this.table.permission.isOwner(this.user);\n    opts.isVisOwner = this.model.permission.isOwner(this.user);\n\n    opts.googleUser = this.user.featureEnabled('google_maps');\n\n    this.$el\n      .html(this.template_base(opts))\n      .css({\n        width: this.options.width\n      });\n\n    this._setGeocodingBar();\n\n    return this;\n  },\n\n  show: function() {\n    this.render();\n    this.constructor.__super__.show.apply(this);\n  },\n\n  _setGeocodingBar: function() {\n    var user = this.user.toJSON();\n    user.geocoding = user.geocoding || {};\n    var per =  !user.geocoding.quota ? 100 : ( user.geocoding.monthly_use * 100 ) / user.geocoding.quota;\n    var per_class = \"\";\n\n    if (per < 90 & per > 79 ) {\n      per_class = \"caution\";\n    } else if (per > 89) {\n      per_class = \"danger\";\n    }\n\n    this.$('.progress-bar')\n      .find('.bar-2')\n      .width(per + \"%\")\n      .removeClass('danger caution')\n      .addClass(per_class);\n  },\n\n  // Lock visualization (type derived or table)\n  _lockVis: function(e) {\n    if (e) e.preventDefault();\n\n    var viewModel = new cdb.editor.ChangeLockViewModel({\n      items: [this.model],\n      contentType: this.model.isVisualization() ? 'maps' : 'datasets'\n    });\n\n    var type = this.model.isVisualization() ? 'maps' : 'datasets';\n    viewModel.bind('change:state', function() {\n      if (viewModel.get('state') === 'ProcessItemsDone') {\n        window.location.href = cdb.config.prefixUrl() + '/dashboard/' + type;\n      }\n    });\n\n    var view = new cdb.editor.ChangeLockView({\n      model: viewModel,\n      clean_on_hide: true,\n      enter_to_confirm: true\n    });\n\n    view.appendToBody();\n  },\n\n  /**\n   *  Export a map\n   */\n  _exportMap: function(e) {\n    e.preventDefault();\n\n    var view = new cdb.editor.ExportMapView({\n      model: new cdb.admin.ExportMapModel({ 'visualization_id': this.model.id }),\n      clean_on_hide: true,\n      enter_to_confirm: true\n    });\n\n    view.appendToBody();\n  },\n\n  /**\n   *  Export a table\n   */\n  _exportTable: function(e){\n    e.preventDefault();\n\n    // If a sql is applied but it is not valid, don't let the user export it\n    if (this.table.isInSQLView() && this.dataLayer && !this.dataLayer.get('query')) return false;\n\n    var view = new cdb.editor.ExportView({\n      model: this.dataLayer.table,\n      config: config,\n      user_data: this.user.toJSON()\n    });\n    view.appendToBody();\n  },\n\n  /**\n   *  Duplicate dataset\n   */\n  _duplicateDataset: function(e){\n    e.preventDefault();\n\n    var dialog = new cdb.editor.DuplicateDatasetView({\n      model: this.table,\n      user: this.user,\n      clean_on_hide: true\n    });\n    dialog.appendToBody();\n  },\n\n  /**\n   *  Duplicate a visualization\n   */\n  _duplicateVis: function(e) {\n    e.preventDefault();\n\n    var dialog = new cdb.editor.DuplicateVisView({\n      model: this.model, //vis\n      table: this.table,\n      user: this.user,\n      clean_on_hide: true\n    });\n    dialog.appendToBody();\n  },\n\n  _changePrivacy: function(e) {\n    e.preventDefault();\n\n    var view = new cdb.editor.ChangePrivacyView({\n      vis: this.model, //vis\n      user: this.options.user,\n      enter_to_confirm: true,\n      clean_on_hide: true\n    });\n    view.appendToBody();\n  },\n\n\n  /**\n   *  Append data to a table (disabled for the moment :( )\n   */\n  _appendData: function(e){\n    e.preventDefault();\n  },\n\n  /**\n   *  Sync table settings\n   */\n  _syncSettings: function(e) {\n    e.preventDefault();\n\n    if (!this.model.isVisualization()) {\n      var dialog = new cdb.editor.SyncView({\n        table: this.table\n      });\n      dialog.appendToBody();\n    }\n  },\n\n  /**\n   *  Merge tables option\n   */\n  _mergeTables: function(e) {\n    e.preventDefault();\n\n    if (!this.model.isVisualization()) {\n      var mergeDialog = new cdb.editor.MergeDatasetsView({\n        table: this.table,\n        user: this.user\n      });\n      mergeDialog.appendToBody();\n    }\n  },\n\n  /**\n   *  Georeference table data\n   */\n  _georeference: function(e) {\n    e.preventDefault();\n    var dlg;\n    var bkgPollingModel = this.options.backgroundPollingModel;\n    var tableIsReadOnly = this.table.isSync() || this.table.isInSQLView();\n    var canAddGeocoding = bkgPollingModel !== \"\" ? bkgPollingModel.canAddGeocoding() : true; // With new modals\n\n    if (!this.options.geocoder.isGeocoding() && !tableIsReadOnly && canAddGeocoding) {\n      var dlg = new cdb.editor.GeoreferenceView({\n        table:  this.table,\n        user:   this.user,\n        tabs:   ['lonlat', 'city', 'admin', 'postal', 'ip', 'address'],\n        option: 'lonlat'\n      });\n    } else if (this.options.geocoder.isGeocoding() || ( !canAddGeocoding && !tableIsReadOnly )) {\n      dlg = cdb.editor.ViewFactory.createDialogByTemplate('common/background_polling/views/geocodings/geocoding_in_progress');\n    } else {\n      // If table can't geocode == is synched, return!\n      return;\n    }\n\n    dlg.appendToBody();\n  },\n\n  _deleteItem: function(e) {\n    this.killEvent(e);\n    var isVis = this.model.isVisualization();\n\n    var viewModel = new cdb.editor.DeleteItemsViewModel(this.model, {\n      contentType: isVis ? 'maps' : 'datasets'\n    });\n\n    viewModel.bind('DeleteItemsDone', function() {\n      var dashboard = this.user.viewUrl().dashboard();\n      window.location = isVis ? dashboard.maps() : dashboard.datasets();\n    }, this);\n\n    var view = new cdb.editor.DeleteItemsView({\n      viewModel: viewModel,\n      user: this.user,\n      clean_on_hide: true,\n      enter_to_confirm: true\n    });\n    view.appendToBody();\n  }\n});\n","\n/**\n * dropdown when user clicks on a column name\n */\ncdb.admin.HeaderDropdown = cdb.admin.DropdownMenu.extend({\n\n  className: \"dropdown border\",\n  isPublic: false,\n\n  events: {\n    'click .asc':                   'orderColumnsAsc',\n    'click .desc':                  'orderColumnsDesc',\n    'click .rename_column':         'renameColumn',\n    'click .change_data_type':      'changeType',\n    'click .georeference':          'georeference',\n    'click .clearview':             'clearView',\n    'click .filter_by_this_column': 'filterColumn',\n    'click .delete_column':         'deleteColumn',\n    'click .add_new_column':        'addColumn'\n  },\n\n  initialize: function() {\n    this.options.reserved_column = false;\n    this.options.read_only = false;\n    this.options.in_sql_view = false;\n    this.options.isPublic = this.isPublic;\n    this.elder('initialize');\n  },\n\n  render: function() {\n    cdb.admin.DropdownMenu.prototype.render.call(this);\n    // Add the class public if it is reserved column or query applied\n    this.$el[this.options.isPublic !== true || this.options.read_only ? 'addClass' : 'removeClass']('public');\n\n    return this;\n  },\n\n  setTable: function(table, column) {\n    this.table = table;\n    this.column = column;\n\n    // depending on column type (reserved, normal) some fields should not be shown\n    // so render the dropdown again\n    this.options.reserved_column = this.table.isReadOnly() || this.table.isReservedColumn(column);\n    this.options.read_only = this.table.isReadOnly();\n    this.options.in_sql_view = this.table.isInSQLView();\n    this.render();\n\n    this.$('.asc').removeClass('selected');\n    this.$('.desc').removeClass('selected');\n    //set options for ordering\n    if(table.data().options.get('order_by') === column) {\n      if(table.data().options.get('sort_order') === 'asc') {\n        this.$('.asc').addClass('selected');\n      } else {\n        this.$('.desc').addClass('selected');\n      }\n    }\n  },\n\n  orderColumnsAsc: function(e) {\n    e.preventDefault();\n    this.table.data().setOptions({\n      sort_order: 'asc',\n      order_by: this.column\n    });\n    this.hide();\n    return false;\n  },\n\n  orderColumnsDesc: function(e) {\n    e.preventDefault();\n    this.table.data().setOptions({\n      sort_order: 'desc',\n      order_by: this.column\n    });\n    this.hide();\n    return false;\n  },\n\n  renameColumn: function(e) {\n    e.preventDefault();\n    this.hide();\n    this.trigger('renameColumn');\n    return false;\n  },\n\n  clearView: function(e) {\n    if (e) e.preventDefault();\n    this.hide();\n    this.trigger('clearView');\n    return false;\n  },\n\n  changeType: function(e) {\n    e.preventDefault();\n    this.hide();\n    this.trigger('changeType', this.column);\n    return false;\n  },\n\n  georeference: function(e) {\n    e.preventDefault();\n    this.trigger('georeference', this.column);\n    this.hide();\n    return false;\n  },\n\n  filterColumn: function(e) {\n    this.killEvent(e);\n    this._addFilter(this.column);\n  },\n\n  _addFilter: function(column_name) {\n    this.trigger('applyFilter', column_name);\n    this.hide();\n  },\n\n  deleteColumn: function(e) {\n    e.preventDefault();\n    this.hide();\n\n    var view = new cdb.editor.DeleteColumnView({\n      clean_on_hide: true,\n      enter_to_confirm: true,\n      table: this.table,\n      column: this.column,\n      clean_on_hide: true\n    });\n    view.appendToBody();\n\n    return false;\n  },\n\n  addColumn: function(e) {\n    e.preventDefault();\n    this.trigger(\"addColumn\", this);\n    this.hide();\n    return false;\n  }\n});\n","\n/**\n * header cell view, manages operations on table columns\n */\n\n(function() {\n\nvar HeaderView = cdb.admin.HeaderView = cdb.core.View.extend({\n\n  _TEXTS: {\n    no_geo: {\n      title:        _t('Georeference your table'),\n      description:  _t('This funcionality is not available in the visualization view. \\\n                    Please, visit <a href=\"<%- prefix %>/tables/<%- table_name %>\">your table</a> and start georeferencing there.'),\n      ok:           _t('Ok, close')\n    }\n  },\n\n  NO_MENU_COLUMNS: ['the_geom', 'the_geom_webmercator'],\n\n  events: {\n    'dblclick .coloptions':     'renameColumn',\n    'click    .coloptions':     'showColumnOptions',\n    'click    .coltype':        'showColumnTypeOptions',\n    'click    .geo':            'showGeoreferenceWindow',\n    'keydown  .col_name_edit':  '_checkEditColnameInput',\n    'focusout input':           '_finishEdit',\n    'click':                    'activateColumnOptions'\n  },\n\n  initialize: function() {\n    var self = this;\n    this.column = this.options.column;\n    this.table = this.options.table;\n    this.vis = this.options.vis;\n    this.template = this.getTemplate('table/views/table_header_view');\n    this.editing_name = false;\n    this.changing_type = false;\n\n    this.vis.bind('change:type', function() {\n      // You can't geocode being in a visualization of type derived\n      HeaderView && HeaderView.colTypeOptions.render();\n    });\n\n    this.add_related_model(this.vis);\n\n    if (HeaderView.colOptions === undefined) {\n      HeaderView.colOptions= new cdb.admin.HeaderDropdown({\n        user: this.options.user,\n        position: 'position',\n        horizontal_position: \"right\",\n        tick: \"right\",\n        template_base: \"table/views/table_header_options\",\n        sqlView: this.options.sqlView,\n        vis: this.vis\n      });\n      HeaderView.colOptions.render();\n\n      cdb.god.bind(\"closeDialogs\", HeaderView.colOptions.hide, HeaderView.colOptions);\n    }\n\n    if (HeaderView.colTypeOptions === undefined) {\n      HeaderView.colTypeOptions= new cdb.admin.ColumntypeDropdown({\n        user: this.options.user,\n        position: 'position',\n        horizontal_position: \"right\",\n        tick: \"right\",\n        template_base: \"table/views/table_column_type_options\"\n      });\n      HeaderView.colTypeOptions.render();\n      cdb.god.bind(\"closeDialogs\", HeaderView.colTypeOptions.hide, HeaderView.colTypeOptions);\n    }\n  },\n\n  _addColumn: function(column) {\n    table.tableTab.tableView.addColumn(column);\n  },\n\n  render: function() {\n    this.$el.html('');\n\n    this.$el.append(this.template({\n      col_name:         this.column[0],\n      col_type:         this.column[1],\n      editing_name:     this.editing_name,\n      changing_type:    this.changing_type,\n      read_only:        this.table.isReadOnly(),\n      isReservedColumn: this.table.isReadOnly() || this.table.isReservedColumn(this.column[0]),\n      noMenu:           (this.NO_MENU_COLUMNS.indexOf(this.column[0]) >= 0)\n    }));\n\n    // Focus in the input if it is being edited\n    // and set the correct width\n    if (this.editing_name) {\n      // In case the element is not present in DOM or not visible the width would be 0, so fallback on a reasonable\n      // width (e.g. happens for adding a column on an empty dataset)\n      var w = this.$el.find(\"p.auto\").width() || 175;\n      this.$el.find(\"input\")\n        .css({\n          \"max-width\":  w,\n          \"width\":      w\n        })\n        .focus();\n    }\n\n    this.delegateEvents();\n\n    return this;\n  },\n\n  _openColOptions: function(e) {\n    var self = this;\n    var colOptions = HeaderView.colOptions;\n\n    // Unbind events\n    colOptions.off();\n    cdb.god.unbind('closeDialogs', HeaderView.colOptions.hide, HeaderView.colOptions);\n\n    // Close other dialogs\n    cdb.god.trigger(\"closeDialogs\");\n\n    // set data for column and table currently editing\n    colOptions.setTable(this.table, this.column[0]);\n\n    colOptions.bind('addColumn', this._addColumn, this);\n    colOptions.bind('renameColumn', this.renameColumn, this);\n    colOptions.bind('changeType', this._changeType, this);\n    colOptions.bind('clearView', function(){\n      self.trigger('clearView');\n    }, this);\n    colOptions.bind('georeference', function(column) {\n      self.trigger('georeference', column);\n    }, this);\n    colOptions.bind('applyFilter', function(column) {\n      self.trigger('applyFilter', column);\n    }, this);\n\n    // bind the stuff\n    var container = $(e.target).parent().parent();\n    container.append(colOptions.el);\n\n    var link_width  = $(e.target).width() + 26\n      , th          = container.parent();\n\n    // align to the right of the target with a little of margin\n    colOptions.openAt(link_width - colOptions.$el.width(), (th.height()/2) + 7);\n\n    // Bind again!\n    cdb.god.bind(\"closeDialogs\", HeaderView.colOptions.hide, HeaderView.colOptions);\n  },\n\n  _openColTypeOptions: function(e) {\n    if(this.table.isReadOnly()) {\n      return;\n    }\n    var colOptions = HeaderView.colTypeOptions;\n\n    // Unbind events\n    colOptions.off();\n    cdb.god.unbind('closeDialogs', HeaderView.colTypeOptions.hide, HeaderView.colTypeOptions);\n\n    // Close other dialogs\n    cdb.god.trigger(\"closeDialogs\");\n\n    // set data for column and table currently editing\n    colOptions.setTable(this.table, this.column[0]);\n\n    // bind the stuff\n    var container = $(e.target).parent().parent();\n    container.append(colOptions.el);\n\n    var link_width  = $(e.target).outerWidth() + 24\n      , th          = container.parent();\n\n    // align to the right of the target with a little of margin\n    colOptions.openAt(link_width - colOptions.$el.width(), (th.height()/2) + 25);\n\n\n    // Bind again\n    cdb.god.bind(\"closeDialogs\", HeaderView.colTypeOptions.hide, HeaderView.colTypeOptions);\n  },\n\n  _checkEditColnameInput: function(e) {\n    if(e.keyCode === 13) {\n      this._submitEdit();\n    }\n    if(e.keyCode === 27) {\n      this._finishEdit();\n    }\n\n  },\n\n  _submitEdit: function() {\n    this.table.renameColumn(this.column[0], $('.col_name_edit').val());\n    this._finishEdit();\n  },\n\n  _finishEdit: function() {\n    this.editing_name = false;\n    this.render();\n  },\n\n  renameColumn: function(ev) {\n    if (ev) {\n      this.killEvent(ev)\n    }\n\n    this.editing_name = true;\n    this.changing_type = false;\n    this.render();\n  },\n\n  _changeType: function(column) {\n    this.editing_name = false;\n    this.changing_type = true;\n\n    // Simulate click\n    var $coltype_link = this.$el.find('a.coltype');\n    $coltype_link.click();\n  },\n\n  activateColumnOptions: function(e) {\n    this.killEvent(e);\n    this.$el.find(\"a.coloptions\").click();\n  },\n\n  showColumnOptions: function(e) {\n    var self = this;\n    var colOptions = HeaderView.colOptions;\n    var columnName = this.column[0];\n\n    e.preventDefault();\n\n    // If submenu was openened before, let's close it.\n    if (colOptions.isOpen && columnName == colOptions.column) {\n      colOptions.hide();\n      return false;\n    }\n\n    // If submenu is from different column or it is closed.\n    if (this.NO_MENU_COLUMNS.indexOf(this.column[0]) < 0) {\n      colOptions.hide(function() {\n        colOptions.parent_ && colOptions.parent_.css('z-index', 0);\n        var parent_ = self.$el.find('th > div');\n        colOptions.parent_ = parent_;\n        parent_.css('z-index', '100');\n        self._openColOptions(e);\n      });\n    }\n\n    return false;\n  },\n\n  showGeoreferenceWindow: function(e) {\n    this.killEvent(e);\n    this.trigger('georeference', null);\n  },\n\n  showColumnTypeOptions: function(e) {\n    var self = this;\n    var colOptions = HeaderView.colTypeOptions;\n    var columnName = this.column[0];\n\n    if (e) e.preventDefault();\n\n    // If submenu was openened before, let's close it.\n    if (colOptions.isOpen && columnName == colOptions.column) {\n      colOptions.hide();\n      return false;\n    }\n\n    // If submenu is from different column or it is closed.\n    colOptions.hide(function() {\n      self._openColTypeOptions(e);\n    });\n\n    return false;\n  }\n\n});\n\n})();\n","/**\n * this infowindow is shown in the map when user clicks on a feature\n */\n\n(function() {\n\n  var MapInfowindow = cdb.geo.ui.Infowindow.extend({\n\n    _TEXTS: {\n      _NO_FIELDS_SELECTED:        _t(\"You haven’t selected any fields to be shown in the infowindow.\"),\n      _NO_FIELDS_SELECTED_BUTTON: _t(\"Select fields\")\n    },\n\n    _TEMPLATE_URL: 'table/views/infowindow/templates',\n\n    events: cdb.core.View.extendEvents({\n      'click .edit_data': '_editData',\n      'click .edit_geo':  '_editGeom',\n      'click .remove':    '_removeGeom',\n      'click .open_infowindow_panel': '_openInfowindowPanel'\n    }),\n\n    initialize: function() {\n      var self = this;\n      _.bindAll(this, '_removeGeom');\n      this.table = this.options.table;\n      this.model.set({ content: 'loading...' });\n      // call parent\n      this.constructor.__super__.initialize.apply(this);\n      this.model.set('offset', [28, 0]);\n      this.model.bind('change:fields', function() {\n        if (!this.hasChanged('content') && self.row) {\n          self.renderInfo();\n        }\n      });\n\n      this.table.bind('change:schema', this.render, this);\n      this.add_related_model(this.table);\n\n      // Create a help dialog for the infowindows with images\n      if (this._containsCover) this._createHelpDialog();\n\n      // Set live tipsy when geom is enabled or disabled\n      this.$(\"div.cartodb-edit-buttons a.button\").tipsy({\n        live:true,\n        fade:true,\n        gravity: 's',\n        offset: -2,\n        className: function(){\n          return $(this).closest(\".cartodb-popup\").hasClass('dark') ? 'dark' : ''\n        },\n        title: function(ev){\n          var enabled = !$(this).hasClass(\"disabled\");\n          if (enabled) {\n            return $(this).text()\n          } else {\n            return 'Not available in this mode'\n          }\n        }\n      })\n    },\n\n    _createHelpDialog: function() {\n      this.helpDialog = cdb.editor.ViewFactory.createDialogByTemplate('common/dialogs/help/infowindow_with_images', {}, { clean_on_hide: false });\n      this.addView(this.helpDialog);\n    },\n\n    setFeatureInfo: function(cartodb_id) {\n      // Set cartodb_id\n      this.cartodb_id = cartodb_id;\n\n      // render to update cartodb_id\n      this.render();\n\n      // Get row data and show the content\n      if(this.row) {\n        this.row.unbind(null, null, this);\n      }\n      this.row = this.table.data().getRow(cartodb_id, {\n        no_add: true\n      });\n\n      this.row\n        .bind('change', this.renderInfo, this)\n        .fetch({ cache: false, no_geom: true });\n\n      // trigger renderInfo now to render the actual contents\n      this.renderInfo();\n\n      return this;\n    },\n\n    /**\n     * renders the infowindows adding some editing features\n     */\n    render: function() {\n\n      var self = this;\n\n      // render original\n      cdb.geo.ui.Infowindow.prototype.render.call(this);\n\n      var fields = this.model.get('fields');\n\n      // Show no_fields state when there isn't any field\n      // and a custom template is not selected\n      if((!fields || (fields && !fields.length)) && (!this.model.get('template'))) {\n\n        // Add empty fields to the infowindow\n        this.$('.cartodb-popup').addClass(\"no_fields\");\n\n        // Check if the infowindow has header or not\n        var popup_class = '.cartodb-popup-content';\n        if (this.$('.cartodb-popup-header').length > 0) {\n          popup_class = '.cartodb-popup-header';\n        }\n\n        this.$(popup_class).html(\n          '<p class=\"italic\">' + this._TEXTS._NO_FIELDS_SELECTED + '</p>' +\n          '<p><a class=\"margin5 underline open_infowindow_panel\" href=\"#/select-fields\">' + this._TEXTS._NO_FIELDS_SELECTED_BUTTON + '</a></p>'\n        )\n      } else {\n        this.$('.cartodb-popup').removeClass(\"no_fields\");\n      }\n\n\n      // render edit and remove buttons\n      this.$('.cartodb-popup-content-wrapper')\n        .append(this.getTemplate('table/views/infowindow/infowindow_footer')({ \"cartodb_id\": this.cartodb_id }));\n\n      if (this.table.isReadOnly()) {\n        this.$('.cartodb-popup-content-wrapper').find('a.remove, a.edit_data, a.edit_geo').addClass('disabled');\n      }\n\n      if (this._containsCover()) { // bind the help link to the helpDialog\n        this.$(\".image_not_found a.help\").off(\"click\");\n        this.$(\".image_not_found a.help\").on(\"click\", function() {\n          $('body').append(self.helpDialog.render().el);\n          self.helpDialog.open();\n        });\n      }\n\n    },\n\n    renderInfo: function() {\n      var self = this;\n      var row_attributes = self.row.attributes;\n      var fields = [];\n\n      for (var property in row_attributes) {\n        if (row_attributes.hasOwnProperty(property)) {\n          if (self.model.containsField(property) && !_.contains(self.model.SYSTEM_COLUMNS, property)) {\n            var h = {\n              title: self.model.getFieldProperty(property, 'title') ? property : null,\n              value: row_attributes[property],\n              position: self.model.getFieldPos(property)\n            };\n\n            fields.push(h);\n          }\n        }\n      }\n\n      // sort\n      fields = _.compact(fields);\n      fields.sort(function(a, b) {\n        return a.position - b.position;\n      });\n\n      // filter and add index\n      var render_fields = [];\n      for(var i = 0; i < fields.length; ++i) {\n        var f = fields[i];\n        if(f) {\n          //\n          // header template use index to detect if it's the first element\n          // renderer to use special style.\n          // Mustache only matches as false a null, undefined or false value\n          // so for the first element we set index as null\n          // yes, very hacky :(\n          f.index = render_fields.length ? render_fields.length: null,\n          render_fields.push(f);\n        }\n      }\n\n      if (fields.length > 0) {\n        // Set content\n        this.model.set({ content:  { fields: render_fields } });\n      } else {\n        // Show loading due to the fact that we don't have the content yet\n        this.setLoading();\n      }\n\n      if(this.model.get('visibility')) {\n        // Just move the map if need it when fields are already added.\n        this.adjustPan();\n      }\n    },\n\n\n    /**\n     *  Attempts to load the cover URL and show it\n     */\n    _loadCover: function() {\n      var self = this;\n\n      if (!this._containsCover()) return;\n\n      var $cover = this.$(\".cover\");\n      var $imageNotFound = this.$(\".image_not_found\");\n      var $img = $cover.find(\"img\");\n      var url = this._getCoverURL();\n\n      if (!this._isValidURL(url)) {\n        $imageNotFound.fadeIn(250);\n        $img.hide();\n        return;\n      }\n\n      // configure spinner\n      var\n      target  = document.getElementById('spinner'),\n      opts    = { lines: 9, length: 4, width: 2, radius: 4, corners: 1, rotate: 0, color: '#ccc', speed: 1, trail: 60, shadow: true, hwaccel: false, zIndex: 2e9 },\n      spinner = new Spinner(opts).spin(target);\n\n      // create the image\n      $imageNotFound.hide();\n\n      $img.hide(function() {\n        this.remove();\n      });\n\n      $img = $(\"<img />\").attr(\"src\", url);\n      $cover.append($img);\n\n      $img.load(function(){\n        spinner.stop();\n\n        var w  = $img.width();\n        var h  = $img.height();\n        var coverWidth = $cover.width();\n        var coverHeight = $cover.height();\n\n        var ratio = h / w;\n        var coverRatio = coverHeight / coverWidth;\n\n        // Resize rules\n        if ( w > coverWidth && h > coverHeight) { // bigger image\n          if ( ratio < coverRatio ) $img.css({ height: coverHeight });\n          else {\n            var calculatedHeight = h / (w / coverWidth);\n            $img.css({ width: coverWidth, top: \"50%\", position: \"absolute\", \"margin-top\": -1*parseInt(calculatedHeight, 10)/2 });\n          }\n        } else {\n          var calculatedHeight = h / (w / coverWidth);\n          $img.css({ width: coverWidth, top: \"50%\", position: \"absolute\", \"margin-top\": -1*parseInt(calculatedHeight, 10)/2 });\n        }\n\n        $img.fadeIn(300);\n      })\n      .error(function(){\n        spinner.stop();\n        $imageNotFound.fadeIn(250);\n      });\n    },\n\n\n    /**\n     * triggers an editGeom event with the geometry\n     * infowindow is currently showing\n     */\n    _editGeom: function(e) {\n      this.killEvent(e);\n      if (!this.table.isReadOnly()) {\n        this.model.set(\"visibility\", false);\n        this.trigger('editGeom', this.row);\n      }\n    },\n\n    _editData: function(e) {\n      this.killEvent(e);\n      if (!this.table.isReadOnly()) {\n        this.model.set(\"visibility\", false);\n        this.trigger('editData', this.row);\n      }\n    },\n\n    _removeGeom: function(e) {\n      this.killEvent(e);\n      if (!this.table.isReadOnly()) {\n        this.model.set(\"visibility\", false);\n        this.trigger('removeGeom', this.row);\n      }\n    },\n\n    _openInfowindowPanel: function(e) {\n      this.killEvent(e);\n      this.trigger('openInfowindowPanel');\n    },\n\n    _getModelTemplate: function() {\n      var template_name = cdb.admin.mod.TemplateMap[this.model.get(\"template_name\")] || this.model.get(\"template_name\");\n      return this._TEMPLATE_URL + \"/\" + template_name;\n    }\n\n  });\n\n  // export\n  cdb.admin.MapInfowindow = MapInfowindow;\n\n})();\n","\n  /**\n   *  Layer panel view added in the right menu\n   *\n   *  - It needs at least layer, visualization and user models.\n   *    Globalerror to show connection or fetching errors.\n   *\n   *  var layer_view = new cdb.admin.LayerPanelView({\n   *    model:        layer_model,\n   *    vis:          vis_model,\n   *    user:         user_model,\n   *    globalError:  globalError_obj\n   *  });\n   */\n\n\n  cdb.admin.LayerPanelView = cdb.admin.RightMenu.extend({\n\n    _TEXTS: {\n      error:  {\n        default:  _t('Something went wrong, try again later')\n      },\n      visible:    _t('This layer is hidden, changes won\\'t be shown \\\n                      until you make it visible'),\n      dblclick:   _t('Double click will allow you to rename it')\n    },\n\n    MODULES: ['infowindow', 'legends'],\n    className: \"layer_panel\",\n\n    events: {\n      'dblclick span.name': '_editAlias',\n      'click .name_info a': '_goToLayer',\n      'click .info':        '_switchTo',\n      'click a.visibility': '_switchVisibility',\n      'click a.remove':     '_removeLayer',\n      'keyup input.alias':  '_changeAlias',\n      'click input.alias':  'killEvent',\n      'click':              'setPanelStatus'\n    },\n\n    initialize: function() {\n\n      cdb.admin.RightMenu.prototype.initialize.call(this);\n\n      _.bindAll(this, '_editAlias');\n\n      // Set internal vars\n      this.table = this.model.table;\n      this.sqlView = new cdb.admin.SQLViewData();\n      this.map = this.options.vis.map;\n      this.globalError = this.options.globalError;\n      this.user = this.options.user;\n      this.vis = this.options.vis;\n\n      // Set status view model\n      this.view_model = new cdb.core.Model({ state:'idle' })\n\n      this.render();\n\n      // Set current panel view and data layer\n      this.activeWorkView = 'table';\n      this.setDataLayer(this.model);\n\n      // New added layers need to wait to get model id\n      this.model.bind('change:id', function(m) {\n        this.vis.save('active_layer_id', this.dataLayer.id);\n        this.$el.attr('model-id', this.model.id);\n      }, this);\n      this.model.bind('change:type',    this._setLayerType, this);\n      // Show message when layer is not visible\n      this.model.bind('change:visible', this.setVisibleMsg, this);\n      this.model.bind('destroy', function() {\n        this.trigger('destroy', this.dataLayer.cid);\n      }, this);\n\n      // When status change binding\n      this.view_model.bind('change:state', this._onChangeStatus, this);\n      this.add_related_model(this.view_model);\n\n      // Bind when panel is closed\n      cdb.god.bind(\"panel_action\", this.setPanelStatus, this);\n\n      this.add_related_model(cdb.god);\n\n      this.$el.attr('model-id', this.model.id);\n      this._setLayerType();\n    },\n\n    /* Layer events functions */\n\n    // Set active this tab\n    _switchTo: function(e) {\n      if (e) e.preventDefault();\n      var isActive = this.vis.get('active_layer_id') == this.dataLayer.id;\n\n      // Preventing problem with double click\n      // over span.name\n      if (isActive && $(e.target).prop(\"tagName\").toLowerCase() == \"span\"\n        && $(e.target).prop(\"className\") == \"name\") {\n\n        // Preventing display the tooltip when user is\n        // double clicking! :(\n        var self = this;\n        setTimeout(function() {\n          if (!self._dblClick) self.$('.layer-info .info .name').tipsy(\"show\");\n          delete self._dblClick;\n        }, 150);\n\n        return false;\n      }\n\n      this.trigger('switchTo', this);\n      this.view_model.set('state', 'idle');\n      this.filters._addFilters();\n\n      return false;\n    },\n\n    _goToLayer: function(ev) {\n      if (ev) {\n        ev.stopPropagation();\n      }\n    },\n\n    // Change view model to show table\n    // name alias input\n    _editAlias: function(e) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      if (this.vis.isVisualization()) {\n        this._dblClick = true;\n\n        this.view_model.set('state',\n          this.view_model.get('state') == 'idle' ? 'editing' : 'idle'\n        );\n      } else {\n        this.trigger('switchTo', this);\n      }\n\n      return false;\n    },\n\n    // Change layer state when input is ready\n    _changeAlias: function(e) {\n      var value = $(e.target).val();\n\n      // If form is submitted, go out!\n      if (e && e.keyCode == 13) {\n        this.view_model.set({ state: 'idle' });\n        return false;\n      }\n    },\n\n    setPanelStatus: function() {\n      this.view_model.set('state', 'idle');\n    },\n\n    _onChangeStatus: function() {\n      var $el = this.$('.layer-info div.left');\n      if (this.view_model.get('state') == \"idle\") {\n        var alias = $el.find('input').val();\n        $el.find('input').hide();\n        $el.find('span.name').show();\n        $el.find('.name_info').show();\n\n        if (alias != this.view_model.get('table_name_alias')) {\n          // Set new changes in model\n          if (alias == \"\" || alias == \" \") {\n            this.dataLayer.unset('table_name_alias')\n          } else {\n            this.dataLayer.set({ table_name_alias: alias })\n          }\n          this.dataLayer.save();\n          this.setLayerName(this.dataLayer);\n        }\n\n      } else {\n        $el.find('span.name').hide();\n        $el.find('.name_info').hide();\n        $el.find('input')\n          .val(this.dataLayer.get('table_name_alias') || this.dataLayer.get('table_name').replace(/_/g,' '))\n          .show()\n          .focus();\n      }\n    },\n\n    _setLayerType: function() {\n      this.$el.attr('layer-type', this.model.get('type').toLowerCase());\n    },\n\n    activated: function() {\n      // remove layer-info\n      this.deactivated();\n      this.$el.html('');\n      this.render();\n\n      // Set data layer\n      this.setDataLayer(this.model);\n\n      // Set previous active layer\n      this.setActivePanelView();\n\n      this.panels.bind('tabEnabled', this.saveActivePanelView, this);\n    },\n\n    deactivated: function() {\n      this.clearSubViews();\n      this._removeButtons();\n      this.view_model.set('state', 'idle');\n    },\n\n    // Set visibility of the map layer\n    _switchVisibility: function(e) {\n      e.preventDefault();\n\n      if (!this.vis.isVisualization()) {\n        cdb.log.info(\"You can't toggle the layer visibility in a table view\");\n        return false;\n      }\n\n      // Hide infowindow if it is open\n      this.model.infowindow && this.model.infowindow.set('visibility', false);\n\n      this.model.save({ 'visible': !this.model.get('visible') });\n    },\n\n    // Remove this view and the map layer\n    _removeLayer: function(e) {\n      e.preventDefault();\n\n      // Check if the visualization is devired type and not table\n      if (!this.vis.isVisualization()) {\n        cdb.log.info(\"You can't remove a layer in a table view\");\n        return false;\n      }\n\n      this.trigger('delete', this);\n    },\n\n\n    /* Layer info functions (order, options, name, ...) */\n\n    _setLayerInfo: function(layer) {\n      this.setLayerName(layer);\n      this.setLayerOptions(layer);\n      this.setLayerOrder(layer);\n      this.setVisibility(layer);\n      this.setVisibleMsg(layer);\n      this.setView(layer);\n    },\n\n    // Set view options\n    setView: function(layer) {\n      this.$el[ this.vis.isVisualization() ? 'addClass' : 'removeClass' ]('vis')\n    },\n\n    setVisibleMsg: function() {\n      var editors = ['sql_mod', 'cartocss_mod'];\n\n      // Remove message\n      this.$('.layer-views div.info.warning').remove()\n\n      // Add message if it is necessary\n      if (!this.model.get('visible')) {\n        var $div = $('<div>')\n          .addClass('info warning')\n          .append('<p>' + this._TEXTS.visible + '</p>');\n\n        var isEditor = _.contains(editors, this.currentPanelView);\n        $div[ isEditor ? 'addClass' : 'removeClass' ]('editor');\n        this.$('.layer-views').append($div);\n      }\n    },\n\n    // Layer name\n    setLayerName: function(layer) {\n      if (this.vis.isVisualization()) {\n\n        // table name\n        this.$('.layer-info .info .name')\n          .text(layer.get('table_name_alias') || layer.get('table_name').replace(/_/g,' '));\n\n        // table name alias\n        var layerUrl = layer.table && layer.table.viewUrl();\n        this.$('.layer-info .info .name_info')\n          .html('view of ')\n          .append($('<a>').attr('href', layerUrl).text(layer.get('table_name')));\n\n        // table synced?\n        if (this.table.isSync()) {\n          this.$('.layer-info .info .name')\n            .append($('<i>').addClass('synced'));\n        } else {\n          this.$('.layer-info i.synced').remove();\n        }\n\n        // Set tipsy bind\n        this._setLayerTooltip();\n      } else {\n        // Unset tipsy bind\n        this._unsetLayerTooltip();\n        this.$('.layer-info .info .name').text(layer.get('table_name'));\n      }\n    },\n\n    _setLayerTooltip: function() {\n      var self = this;\n      this.$('.layer-info .info .name').tipsy({\n        trigger:  'manual',\n        fade:     true,\n        gravity:  's',\n        title:  function() {\n          return self._TEXTS.dblclick\n        }\n      })\n      .bind('mouseleave', function() {\n        $(this).tipsy('hide');\n      });\n    },\n\n    _unsetLayerTooltip: function() {\n      var $name = this.$('.layer-info .info .name');\n      // Remove tipsy\n      if ($name.data('tipsy')) {\n        $name.unbind('mouseenter mouseleave');\n        $name.data('tipsy').remove();\n      }\n    },\n\n    // Layer options\n    setLayerOptions: function(layer) {\n      // Layer options buttons\n      if (this.vis && !this.vis.isVisualization()) {\n        this.$('.layer-info div.right').hide();\n      } else {\n        this.$('.layer-info div.right').show();\n      }\n    },\n\n    setVisibility: function(layer) {\n      this._maybeHideVisibilitySwitch();\n\n      var isVisible = layer.get('visible');\n      this.$(\".layer-info div.right a.switch\")\n        .toggleClass('enabled', !!isVisible)\n        .toggleClass('disabled', !isVisible);\n    },\n\n    _maybeHideVisibilitySwitch: function() {\n      var sw = this.$(\".layer-info div.right a.switch\");\n      var close = this.$(\".layer-info div.right a.remove\");\n      var dataLayers = this.vis.map.layers.getDataLayers();\n      if (dataLayers.length === 1) {\n        sw.hide();\n        close.hide();\n      } else {\n        sw.css('display', 'inline-block');\n        close.css('display', 'inline-block');\n      }\n    },\n\n    // Layer order\n    setLayerOrder: function(layer) {\n      var order = '1';\n      if(this.vis.isVisualization()) {\n        order = layer.collection.indexOf(layer);\n      }\n\n      this.$('.layer-info .info .order').text(order);\n    },\n\n\n    /* Set data of the layer (bindings, errors, modules, ...) */\n    setDataLayer: function(dataLayer) {\n      var self = this;\n      this.add_related_model(dataLayer);\n      var enabledModulesInit = self.MODULES;\n\n      if (!self.dataLayer) {\n        self.dataLayer = dataLayer;\n        this._initDataLayer(dataLayer);\n      }\n\n      // Set layer info\n      this._setLayerInfo(dataLayer);\n\n      /* SQL */\n      var sql = new cdb.admin.mod.SQL({\n        model: self.dataLayer,\n        user: self.user,\n        className: \"sql_panel editor\"\n      });\n\n      /* Filters */\n      this.filters = new cdb.admin.mod.Filters({\n        table: self.table,\n        sqlView: self.sqlView,\n        dataLayer: self.dataLayer\n      });\n\n      // load the scroll when the panel is open\n      cdb.god.bind(\"end_narrow\", function() {\n        self.filters.loadScroll()\n      }, this);\n\n      /* Wizards */\n      var activeWizards = {\n        polygon:    \"SimpleWizard\",\n        cluster:    \"ClusterWizard\",\n        intensity:  \"IntensityWizard\",\n        bubble:     \"BubbleWizard\",\n        choropleth: \"ChoroplethWizard\",\n        color:      \"CategoryWizard\",\n        category:   \"CategoryWizard\",\n        density:    \"DensityWizard\",\n        torque:     \"TorqueWizard\",\n        torque_cat:  \"TorqueCategoryWizard\",\n        torque_heat: \"TorqueHeatWizard\"\n      };\n\n\n      var wizards = new cdb.admin.mod.CartoCSSWizard({\n        user: this.user,\n        model: this.dataLayer,\n        table: this.table,\n        map: this.map,\n        className: \"wizards_panel\",\n        wizards: activeWizards\n      }).bind('modules', function(enabledModules) {\n        enabledModulesInit = enabledModules;\n        this.enableModules(enabledModules);\n      }, this).bind('activeWizard', function(type) {\n        // Close infowindow if it exists.\n        this.dataLayer.infowindow && this.dataLayer.infowindow.set('visibility', false);\n      }, this);\n\n      /* Infowindow */\n      var infowindow = this.infowindow = new cdb.admin.mod.InfoWindow({\n        table: this.table,\n        user: this.user,\n        dataLayer: dataLayer\n      });\n      infowindow.bind('tabChanged', this._onModuleTabChanged, this);\n\n      /* CartoCSS editor */\n      var editorPanel = new cdb.admin.mod.CartoCSSEditor({\n        model: this.dataLayer,\n        table: this.table,\n        user: this.user,\n        className: \"csseditor_panel editor\"\n      }).bind('hasErrors', function() {\n        self.addClassToButton('cartocss_mod', 'has_errors');\n      }).bind('clearError', function() {\n        self.removeClassFromButton('cartocss_mod', 'has_errors');\n      });\n\n      /* Legends */\n      var legends = new cdb.admin.mod.LegendEditor({\n        model: dataLayer.legend,\n        dataLayer: dataLayer,\n        className: \"legends_panel\",\n        availableLegends: [\n          { name: \"none\",       enabled: true  },\n          { name: \"custom\",     enabled: true  },\n          { name: \"color\",      enabled: false },\n          { name: \"category\",   enabled: false },\n          { name: \"bubble\",     enabled: false },\n          { name: \"choropleth\", enabled: false },\n          { name: \"intensity\",  enabled: false },\n          { name: \"density\",    enabled: false },\n          { name: \"torque_cat\", enabled: false }\n        ],\n      }).bind('modules', function(enabledModules) {\n        enabledModulesInit = enabledModules;\n        self.enableModules(enabledModules);\n      }).bind('tabChanged', this._onModuleTabChanged, this);\n\n      if (!this.user.featureEnabled('disabled_ui_sql')) {\n        self.addModule(sql.render(), ['table', 'tableLite', 'map', 'mapLite']);\n      }\n      self.addModule(wizards.render(),      ['map', 'mapLite']);\n      self.addModule(infowindow.render(),   ['map', 'mapLite']);\n      if (!this.user.featureEnabled('disabled_ui_cartocss')) {\n        self.addModule(editorPanel.render(), ['map', 'mapLite']);\n      }\n      self.addModule(legends.render(),      ['map', 'mapLite']);\n      self.addModule(this.filters.render(), ['table', 'tableLite', 'map', 'mapLite']);\n\n      /* Lateral menu modules */\n      var mergeTables = self.addToolButton(\"merge_datasets\", 'table');\n      var addRow      = self.addToolButton('add_row', 'table');\n      var addColumn   = self.addToolButton('add_column', 'table');\n      var addGeom     = self.addToolButton('add_feature', 'map');\n\n      addRow.bind('click', this._addRow, this);\n      addColumn.bind('click', this.trigger.bind(this, 'addColumn', this));\n      mergeTables.bind('click', this._mergeTables, this);\n      addGeom.bind('click', this._addFeature, this);\n\n      this.enableModules(enabledModulesInit);\n      this._bindDataLayer();\n    },\n\n    // set initial parameters to the layer\n    _initDataLayer: function(layer) {\n      layer.bind('change:table_name', this.setLayerName, this);\n      layer.bind('change:order',      this.setLayerOrder, this);\n      layer.bind('change:visible',    this.setVisibility, this);\n\n      layer.collection.bind('add remove', this._maybeHideVisibilitySwitch, this);\n      this.add_related_model(layer.collection);\n\n      layer.set({\n        stat_tag: this.vis.get('id'),\n        user_name: this.user.get(\"username\"),\n        maps_api_template: cdb.config.get('maps_api_template'),\n        cartodb_logo: false,\n        no_cdn: false,\n        force_cors: true // use CORS to control error management in a better way\n      });\n\n      // set api key\n      var e = layer.get('extra_params') || {};\n      e.api_key = e.map_key = this.user.get('api_key');\n      layer.set('extra_params', e);\n      layer.invalidate();\n    },\n\n    // bind related ui changed to datalayer\n    _bindDataLayer: function() {\n      var self = this;\n      this.dataLayer.bindSQLView(this.sqlView);\n      this.dataLayer\n        .bind('parseError', function() {\n          if(self.activeWorkView === 'map') {\n            self.globalError.showError('There is a problem with the map tiles. Please, check your CartoCSS style.', 'error', 0, 'tiles');\n          }\n        }, this)\n        .bind('sqlNoMercator', function() {\n          if(self.activeWorkView === 'map') {\n            // don't show this error, the warning is shown in the sql bar\n            //self.globalError.showError(_t('the_geom_webmercator column should be selected'), 'warn', 0, 'tiles');\n          }\n        }, this)\n        .bind('error', function(model, resp) {\n          var aborted = resp && resp.statusText === 'abort';\n          if(self.activeWorkView === 'map' && !aborted) {\n            self.globalError.showError('There is a problem with your connection', 'error', 0, 'tiles');\n          }\n        }, this)\n        .bind('tileOk', function() {\n          self.globalError.hide('tiles');\n        }, this);\n\n      this.table.bind('columnRename columnDelete columnAdded geolocated', function() {\n        self.dataLayer.invalidate();\n      }, this);\n\n      this.table.bind('change:geometry_types', function() {\n        if(this.table.get('geometry_types').length) {\n          this._enableGeometryRelatedWizards();\n        } else {\n          this._disableGeometryRelatedWizards();\n        }\n      }, this);\n\n      // Need to check buttons when permission changes\n      this.table.bind('change:permission',  this._checkButtons, this);\n      this.table.bind('change:readOnly', this._checkButtons, this);\n      this.table.bind('change:synchronization', this._checkButtons, this);\n      this.table.bind('change:isSync', this._checkButtons, this);\n\n      this.vis.bind('change:type', function() {\n        this.setLayerOptions()\n        this.setLayerName(this.model)\n      }, this);\n\n      this.model.bind('applySQLView errorSQLView clearSQLView', this._checkButtons, this);\n\n      // this.model.bind('clearSQLView', this._onResetSQL, this);\n      // this.model.bind('applySQLView', this._onApplySQL, this);\n      // this.model.bind('errorSQLView', this._onErrorSQL, this);\n\n      this.model.unbind('applyFilter', this._applyFilter, this);\n      this.model.bind('applyFilter',  this._applyFilter, this);\n\n      // Add related models to be cleaned when view is destroyed\n      this.add_related_model(this.vis);\n      this.add_related_model(this.table);\n\n      this._checkButtons();\n    },\n\n    enableModules: function(enabledModules) {\n\n      var self = this;\n\n      _(self.MODULES).each(function(m) {\n\n        if (m === \"infowindow\" && !self.model.wizard_properties.supportsInteractivity()) {\n          self.disableModule(\"infowindow_mod\");\n        } else {\n\n          if (_.contains(enabledModules, m)) {\n            self.enableModule(m + \"_mod\");\n          } else {\n            self.disableModule(m + \"_mod\");\n          }\n\n        }\n\n      });\n\n    },\n\n    SQL_WIZARDS: ['cartocss_mod', 'wizards_mod', 'infowindow_mod', 'legends_mod'],\n\n    _disableGeometryRelatedWizards: function() {\n      var self = this;\n      _(this.SQL_WIZARDS).each(function(m) {\n        self.disableModule(m);\n      });\n    },\n\n    _enableGeometryRelatedWizards: function() {\n      var self = this;\n\n      _(this.SQL_WIZARDS).each(function(m) {\n\n        if (m == 'infowindow_mod' && !self.model.wizard_properties.supportsInteractivity()) {\n          self.disableModule(m);\n        } else {\n          self.enableModule(m);\n        }\n\n      });\n\n    },\n\n    _addRow: function() {\n      this.table.data().addRow({ at: 0});\n      this.trigger('createRow');\n      cdb.god.trigger(\"closeDialogs\");\n    },\n\n    _mergeTables: function() {\n      var user = this.user;\n      var view = new cdb.editor.MergeDatasetsView({\n        table: this.table,\n        user: user\n      });\n      view.appendToBody();\n      cdb.god.trigger(\"closeDialogs\");\n    },\n\n    _addFeature: function(mod) {\n      if (this.map.get('provider') === 'leaflet') {\n        this.map.clamp();\n      }\n      if (this.table.isGeoreferenced()) {\n        this._addGeometry();\n      } else {\n        this._showScratchDialog();\n      }\n    },\n\n    _showScratchDialog: function() {\n      var view = new cdb.editor.ScratchView({\n        clean_on_hide: true,\n        enter_to_confirm: true,\n        table: this.table,\n        skipDisabled: true\n      });\n      view.bind(\"newGeometry\", this._addGeometry, this);\n      view.appendToBody();\n    },\n\n    _addGeometry: function(type) {\n      // row is saved by geometry editor if it is needed\n      type = type || this.table.geomColumnTypes()[0];\n      this.dataLayer.trigger(\"startEdition\", type);\n    },\n\n    /* Module functions */\n\n    // When a tab is activated within a sub-module.\n    // It could be the indowindow view, filters view, etc.\n    _onModuleTabChanged: function(action) {\n      this.trigger('tabChanged', action);\n    },\n\n    // check buttons if they should be enabled or not\n    _checkButtons: function() {\n      var self = this;\n      var gt = this.table.get('geometry_types');\n\n      // Changes over the SQL button\n      var sql_button_changes = {\n        applied:    'remove',\n        has_errors: 'remove'\n      };\n\n      // *Table with read permissions* //\n      if (this.table.isReadOnly()) {\n\n        // Data layer has a query applied?\n        if (this.table.isInSQLView()) {\n          if(this.model.getCurrentState() === 'error') {\n            sql_button_changes = {\n              applied: 'add',\n              has_errors: 'add'\n            }\n          } else {\n            sql_button_changes.applied = 'add';\n          }\n        }\n\n        // Check if there is any geometry\n        if (gt && gt.length === 0) {\n          this._disableGeometryRelatedWizards();\n        } else {\n          this._enableGeometryRelatedWizards();\n        }\n\n        this._readOnlyTableButtons();\n      } else {\n        // *Table with write permissions* //\n\n        // Check if there is any geometry\n        if(gt && gt.length === 0) {\n          this._disableGeometryRelatedWizards();\n        } else {\n          this._enableGeometryRelatedWizards();\n        }\n\n        // Enable writable buttons\n        this._writableTableButtons();\n      }\n\n      // Set title changes (as in name, sync info,...)\n      this.setLayerName(this.dataLayer);\n\n      // Set sql button changes\n      _.each(sql_button_changes, function(value, key) {\n        self[ value === \"remove\" ? 'removeClassFromButton' : 'addClassToButton' ]('sql_mod', key);\n      });\n    },\n\n    _removeButtons: function() {\n      this.buttons = [];\n      this.panels.unbind('tabEnabled', this.saveActivePanelView, this);\n      this.panels.clean();\n      this.tabs.clean();\n    },\n\n    // Enable the correct buttons depending on\n    // if the layer is in query mode or not\n    setActiveWorkView: function(workView) {\n      this.activeWorkView = workView;\n      this._checkButtons();\n      this.setActivePanelView(true);\n    },\n\n    saveActivePanelView: function(name) {\n      this.currentPanelView = name;\n      this.setVisibleMsg();\n    },\n\n    setActivePanelView: function(work_view) {\n      if (work_view || !this.currentPanelView) {\n        if (this.activeWorkView === 'map') {\n          var gt = this.table.get('geometry_types');\n          if(this.model.getCurrentState() !== 'error' && (gt && gt.length > 0)) {\n            this.active('wizards_mod');\n          }\n        } else {\n          this.active('sql_mod');\n        }\n      } else {\n        this.active(this.currentPanelView);\n      }\n    },\n\n    _readOnlyTableButtons: function() {\n      if(this.activeWorkView === 'map') {\n        this.showTools('mapLite', true);\n      } else {\n        this.showTools('tableLite', true);\n      }\n    },\n\n    _writableTableButtons: function() {\n      if(this.activeWorkView === 'map') {\n        this.showTools('map', true);\n      } else {\n        this.showTools('table', true);\n      }\n    },\n\n    _applyFilter: function(column_name) {\n\n      var col = { column: column_name };\n\n      var exists = this.filters.filters.find(function(a) {\n        return a.get(\"column\") == col.column\n      });\n\n      if (!exists) this.filters.filters.add(col);\n\n    },\n\n\n    /* View visibility functions */\n\n    hide: function() {\n      this.$('.layer-sidebar').hide();\n      this.$('.layer-views').hide();\n    },\n\n    show: function() {\n      this.$('.layer-sidebar').show();\n      this.$('.layer-views').show();\n    },\n\n    showModule: function(modName, modTab) {\n      // Set tab in the module\n      if (modTab && this[modName]) this[modName].setActiveTab(modTab);\n      // Show module\n      this.trigger('show', modName + \"_mod\", this);\n    },\n\n    clean: function() {\n      this._unsetLayerTooltip();\n      this._removeButtons();\n      this.elder('clean');\n    }\n  });\n","\n  /**\n   *  Layer view item for layer selector within app\n   */\n\n  cdb.geo.ui.LayerView = cdb.geo.ui.LayerView.extend({\n\n    defaults: {\n      template: '\\\n        <a class=\"layer\" href=\"#/change-layer\"><%- table_name_alias || table_name %></a>\\\n        <a href=\"#switch\" class=\"right <%- visible ? \"enabled\" : \"disabled\" %> switch\"><span class=\"handle\"></span></a>\\\n      '\n    },\n\n    render: function() {\n      var attrs = _.clone(this.model.attributes);\n      attrs.table_name_alias = attrs.table_name_alias || \"\";\n      this.$el.append(this.template(attrs));\n      return this;\n    }\n\n  });","cdb.admin.MapOptionsDropdown = cdb.ui.common.Dropdown.extend({\n\n  className: 'dropdown map_options_dropdown',\n\n  defaults: {\n    speedOut: 90,\n    speedIn:  90\n  },\n\n  events: {\n    \"click\" : \"killEvent\"\n  },\n\n  desktopOverlays: [\"shareable\", \"zoom\", \"share\"],\n\n  initialize: function() {\n\n    _.bindAll(this, \"open\", \"hide\", \"_handleClick\", \"_keydown\");\n\n    // Extend options\n    _.defaults(this.options, this.defaults);\n\n    this.collection.on(\"reset\", this._setupOptions, this);\n    this.collection.on(\"change:description\", this._setupOptions, this);\n\n    this.disabledCartodbLogo = this.options.user.featureEnabled(\"disabled_cartodb_logo\");\n\n    this.mapOptions = new cdb.core.Model({\n      title:            false,\n      description:      false,\n      search:           false,\n      layer_selector:   false,\n      fullscreen:       false,\n      share:            true,\n      logo:             this.disabledCartodbLogo,\n      zoom:             true,\n      scrollwheel:      false,\n      legends:          true\n    });\n\n    // Dropdown template\n    this.template_base = cdb.templates.getTemplate(this.options.template_base);\n\n    this.options.canvas.bind(\"change:mode\", this._onChangeDevice, this);\n    this.mapOptions.bind(\"change\", this._onMapOptionsChange, this);\n\n    // Bind to target\n    $(this.options.target).bind({ \"click\": this._handleClick});\n    $(this.options.target).bind({ \"dblclick\": this.killEvent});\n\n    // Bind ESC key\n    $(document).bind('keydown', this._keydown);\n\n    // Is open flag\n    this.isOpen = false;\n\n    this._setupOptions();\n\n  },\n\n  _onMapOptionsChange: function(model, changes) {\n\n    _.each(changes.changes, function(value, option) {\n\n      var $el = this.$el.find(\"li.\" + option);\n\n      if ($el.find(\"a\").hasClass(\"enabled\")) $el.addClass(\"active\");\n      else $el.removeClass(\"active\");\n\n    }, this);\n\n  },\n\n  _enableDesktopOverlays: function() {\n\n    _.each(this.desktopOverlays, function(overlay) {\n\n      var $overlay = this.$el.find(\".\" + overlay);\n\n      $overlay.removeClass(\"inactive\");\n      $overlay.find(\".form_switch\").removeClass(\"inactive\");\n\n    }, this);\n\n  },\n\n  _disableDesktopOverlays: function() {\n\n    _.each(this.desktopOverlays, function(overlay) {\n\n      var $overlay = this.$el.find(\".\" + overlay);\n\n      $overlay.addClass(\"inactive\");\n      $overlay.find(\".form_switch\").addClass(\"inactive\");\n\n    }, this);\n\n  },\n\n  _onChangeDevice: function() {\n\n    var device = this.options.canvas.get(\"mode\");\n\n    if (device === 'mobile') {\n\n      this._disableDesktopOverlays();\n\n    } else {\n\n      this._enableDesktopOverlays();\n\n    }\n\n  },\n\n  _setupOptions: function() {\n    var self = this;\n    var overlays = this.collection.models;\n    var simpleOverlays = [\"search\", \"shareable\", \"zoom\", \"share\", \"fullscreen\", \"layer_selector\", \"logo\"];\n\n    // If user has set the diable cartodb logo FF then remove the logo\n    if(this.disabledCartodbLogo) {\n      simpleOverlays.pop();\n    }\n\n    this.mapOptions.set({ scrollwheel: !!this.options.vis.map.get(\"scrollwheel\") });\n    this.mapOptions.set({ legends: !!this.options.vis.map.get(\"legends\") });\n\n    _.each(simpleOverlays, function(overlay_type) {\n      if (!_.contains(self.collection.pluck(\"type\"), overlay_type)) {\n        self.mapOptions.set(overlay_type, false);\n      }\n    })\n\n    _.each(overlays, function(overlay) {\n\n      var extra = overlay.get(\"extra\");\n      var type  = overlay.get(\"type\");\n\n      if (type === \"header\") {\n\n        var show_title       = extra.show_title;\n        var show_description = extra.show_description;\n\n        self.mapOptions.set({ title: show_title, description: show_description });\n\n        if (show_title) {\n          self.$(\".title\").removeClass(\"disabled\");\n        }\n\n        if (show_description) {\n          self.$(\".description\").removeClass(\"disabled\");\n        } else {\n          self.$(\".description\").addClass(\"disabled\");\n        }\n\n      } else if (_.contains(simpleOverlays, type)) {\n\n        var display = overlay.get(\"display\");\n        self.mapOptions.set(type, display);\n\n        if (display) {\n          self.$(\".\" + type).removeClass(\"disabled\");\n        }\n\n      }\n\n    });\n  },\n\n  /* Check if the dropdown is visible to hiding with the click on the target */\n  _handleClick: function(ev) {\n    if (ev) {\n      ev.preventDefault();\n      ev.stopPropagation();\n    }\n\n    // If visible\n    if (this.isOpen){\n      this.hide();\n    } else{\n      this.open();\n    }\n  },\n\n  show: function() {\n\n    var dfd = $.Deferred();\n    var self = this;\n\n    //sometimes this dialog is child of a node that is removed\n    //for that reason we link again DOM events just in case\n    this.delegateEvents();\n    this.$el\n    .css({\n      marginTop: self.options.vertical_position == \"down\" ? \"-10px\" : \"10px\",\n      opacity:0,\n      display:\"block\"\n    })\n    .animate({\n      margin: \"0\",\n      opacity: 1\n    }, {\n      \"duration\": this.options.speedIn,\n      \"complete\": function(){\n        dfd.resolve();\n      }\n    });\n\n    this.trigger(\"onDropdownShown\", this.el);\n\n    return dfd.promise();\n  },\n\n  open: function(ev, target) {\n\n    // Target\n    var $target = target && $(target) || this.options.target;\n\n    this.options.target = $target;\n\n    this.$el.css({\n      bottom: 40,\n      left: this.options.horizontal_offset\n    })\n    .addClass(\n      // Add vertical and horizontal position class\n      (this.options.vertical_position == \"up\" ? \"vertical_top\" : \"vertical_bottom\" )\n      + \" \" +\n        (this.options.horizontal_position == \"right\" ? \"horizontal_right\" : \"horizontal_left\" )\n      + \" \" +\n        // Add tick class\n        \"border tick_\" + this.options.tick\n    );\n\n    // Show it\n    this.show();\n    this._recalcHeight();\n\n    // Dropdown open\n    this.isOpen = true;\n  },\n\n  hide: function(done) {\n\n    if (!this.isOpen) {\n      done && done();\n      return;\n    }\n\n    var self    = this;\n    this.isOpen = false;\n\n    this.$el.animate({\n      marginTop: self.options.vertical_position == \"down\" ? \"10px\" : \"-10px\",\n      opacity: 0\n    }, this.options.speedOut, function(){\n\n      // And hide it\n      self.$el.hide();\n\n    });\n\n    this.trigger(\"onDropdownHidden\",this.el);\n\n  },\n\n  _recalcHeight: function() {\n\n    var $ul  = this.$el.find(\"ul.special\");\n\n    // Resets heights\n    $ul.height(\"auto\");\n    $ul.parent().height(\"auto\");\n\n    var special_height  = $ul.height();\n    var dropdown_height = $ul.parent().height();\n\n    // Sets heights\n    if (special_height < dropdown_height) $ul.css(\"height\", dropdown_height);\n    else $ul.parent().height(special_height);\n\n  },\n\n  _addSwitches: function(switches) {\n\n    _(switches).each(this._addSwitch, this);\n\n  },\n\n  _addSwitch: function(prop) {\n\n    var className = '.' + prop;\n\n    var sw = new cdb.forms.Switch({\n      model: this.mapOptions,\n      property: prop\n    })\n    .bind(\"switched\", this._onSwitchSwitched, this);\n\n    this._renderSwitch(sw, className);\n\n    if (!this.mapOptions.attributes[prop]) {\n      this.$(className);\n    }\n\n  },\n\n  _renderSwitch: function(sw, className) {\n\n    this.addView(sw);\n    this.$(\"li\" + className).append(sw.render().el);\n\n  },\n\n  _onSwitchSwitched: function(property, value) {\n\n    if (property === 'scrollwheel') {\n\n      value ? this.options.vis.map.enableScrollWheel() : this.options.vis.map.disableScrollWheel();\n\n      this.options.vis.map.save();\n      this.options.table.globalError.showError(\"Scrollwheel \" + (value ? 'enabled' : 'disabled'), 'info', 3000);\n\n    } else if (property === 'legends') {\n\n      this.options.vis.map.set(property, value)\n\n      this.options.vis.map.save();\n      this.options.table.globalError.showError(\"Legends \" + (value ? 'enabled' : 'disabled'), 'info', 3000);\n\n    } else if (property === \"zoom\" || property === 'search' || property === 'fullscreen' || property === 'share' || property === 'layer_selector' || property === 'logo') {\n\n      this._toggleOverlay(property);\n\n    } else if (property === 'title' || property === 'description') {\n\n      var overlay = this.collection.filter(function(m) { return m.get(\"type\") == \"header\" })[0]\n\n      if (!overlay) {\n\n        this.trigger(\"createOverlay\", \"header\", property);\n        return;\n\n      }\n\n      var show_property = this.mapOptions.get(property);\n\n      overlay.set(\"show_\" + property, show_property);\n      overlay.save();\n\n      if ( (!overlay.get(\"show_title\") && !overlay.get(\"show_description\") ) || !overlay.get(\"show_title\") && !overlay.get(\"description\")) this.options.collection.remove(overlay);\n\n    }\n\n    value ? this.$(\"li.\" + property).removeClass(\"disabled\") : this.$(\"li.\" + property);\n\n  },\n\n  _toggleOverlay: function(property) {\n\n    var overlay  = this.collection.filter(function(m) { return m.get(\"type\") === property; })[0];\n\n    if (overlay) {\n\n      this.options.collection.remove(overlay);\n\n    } else if (!overlay) {\n\n      this.trigger(\"createOverlay\", property);\n\n    }\n\n  },\n\n  /*\n   * Renders the dropdown\n   */\n  render: function() {\n\n    var switches = ['title', 'description', 'search', 'zoom', 'fullscreen', 'share', 'scrollwheel', 'layer_selector', 'legends'];\n\n    this.clearSubViews();\n    this.$el.html(this.template_base(this.options));\n\n    // Show the logo switch if user is allowed and disabled_cartodb_logo FF is not set\n    if (this.options.user.get('actions').remove_logo && !this.disabledCartodbLogo) {\n      switches.push('logo');\n    } else {\n      this.$('.logo').remove();\n    }\n\n    this._addSwitches(switches);\n\n    _.each(this.mapOptions.attributes, function(value, option) {\n\n      var $el = this.$el.find(\"li.\" + option);\n\n      if ($el.find(\"a\").hasClass(\"enabled\")) $el.addClass(\"active\");\n      else $el.removeClass(\"active\");\n\n    }, this);\n\n    return this;\n\n  },\n\n  clean: function() {\n    $(document).unbind('keydown', this._keydown);\n    cdb.ui.common.Dropdown.prototype.clean.call(this);\n  }\n});\n","\n(function() {\n\ncdb.admin.forms = {};\n\nvar clone = function(a) {\n   return JSON.parse(JSON.stringify(a));\n};\n\ncdb.admin.forms.get = function(what) {\n  return clone(cdb.admin.forms[what]);\n};\n\n\nvar polygon_stroke = {\n   name: 'Polygon Stroke',\n   form: {\n      'line-width': { type: 'width', value: 0.5 },\n      'line-color': { type: 'color' , value: '#FFF' },\n      'line-opacity': { type: 'opacity', value: 1 }\n   }\n};\n\nvar line_stroke = {\n   name: 'LineStroke',\n   form: {\n      'line-width': { type: 'width', value: 2 },\n      'line-color': { type: 'color' , value: '#FF6600' },\n      'line-opacity': { type: 'opacity', value: 0.7 }\n   }\n};\n\nvar line_stroke_chroloplet = {\n   name: 'LineStroke',\n   form: {\n      'line-width': { type: 'width', value: 1 },\n      'line-color': { type: 'hidden' , value: '#FF6600' },\n      'line-opacity': { type: 'opacity', value: 0.8 }\n   }\n};\n\nvar polygon_fill = {\n   name: 'Polygon Fill',\n   form: {\n      'polygon-fill': { type: 'color' , value: '#FF6600', extra: { image_property: 'polygon-pattern-file', image_kind: 'pattern' }},\n      'polygon-opacity': { type: 'opacity_polygon' , value: 0.7 }\n  }\n};\n\nvar label_text = {\n     name: 'Label Text',\n     className: \"label_text\",\n     form: {\n      'text-name': { type: 'select', value: 'None',  extra: [], columns: 'string|number', extra_default: ['None'] }  /* value is filled by wizard */\n     }\n};\n\nvar label_text_properties = {\n    name: 'Label Font',\n    className: \"label_text_properties\",\n    form: {\n      'text-face-name': {\n        type: 'select',\n        value: \"DejaVu Sans Book\",\n        extra: [\"DejaVu Sans Book\",\"unifont Medium\", \"Open Sans Regular\", \"Lato Regular\", \"Lato Bold\", \"Lato Bold Italic\", \"Graduate Regular\", \"Gravitas One Regular\", \"Old Standard TT Regular\", \"Old Standard TT Italic\", \"Old Standard TT Bold\"]\n      },\n      'text-size': { type: 'number', value: 10, min: 1, max:50 },\n      'text-fill': { type: 'color' , value: '#000' }\n    }\n};\n\nvar text_allow_overlap = {\n  name: 'Label Overlap',\n  className: \"text_allow_overlap\",\n  form: {\n    'text-allow-overlap': {\n      type: 'select',\n      value: true,\n      extra: [true, false]\n    },\n    'text-placement-type': { type:'hidden', value: 'dummy' },\n    'text-label-position-tolerance': { type: 'hidden', value: 0 }\n  }\n}\n\nvar label_placement = {\n  name: 'Label Placement',\n  className: \"label_placement\",\n  form: {\n    'text-placement': {\n      type: 'select',\n      value: 'point',\n      extra: ['point', 'line', 'vertex', 'interior']\n    }\n  }\n}\n\nvar label_text_offset =  {\n    name: 'Label Offset',\n    className: \"label_text_offset\",\n    form: {\n      'text-dy': { type: 'number', value: -10, min: -30, max: 30 }\n    }\n}\n\nvar label_halo_properties = {\n  name: 'Label Halo',\n  className: \"label_halo_properties\",\n  form: {\n    'text-halo-fill':  { type: 'color' , value: '#FFF' },\n    'text-halo-radius': { type: 'number', value: 1, min: 0, max: 10, inc: 0.5}\n  }\n};\n\nvar marker_fill = {\n       name: 'Marker Fill',\n       form: {\n          'marker-width': { type: 'width', value: 10 },\n          'marker-fill': { type: 'color' , value: '#FF6600', extra: { image_property: 'marker-file' }},\n          'marker-opacity': { type: 'opacity' , value: 0.9 },\n          'marker-allow-overlap': { type: 'hidden', value: true },\n          'marker-placement':{ type:'hidden', value: 'point'},\n          'marker-type':{ type:'hidden', value: 'ellipse'}\n      }\n};\n\nvar marker_stroke = {\n   name: 'Marker Stroke',\n   form: {\n      'marker-line-width': { type: 'width', value: 1.0 },\n      'marker-line-color': { type: 'color' , value: '#FFF' },\n      'marker-line-opacity': { type: 'opacity', value: 1.0 }\n  }\n};\n\n// from mapbox doc\n//var comp_op_options = ['clear','src','dst','src-over','dst-over','src-in','dst-in','src-out','dst-out','src-atop','dst-atop','xor','plus','minus','multiply','screen','overlay','darken','lighten','color-dodge','color-burn','hard-light','soft-light','difference','exclusion','contrast','invert','invert-rgb','grain-merge','grain-extract','hue','saturation','color','value']\nvar comp_op_options = [ 'None', 'multiply', 'screen', 'overlay', 'darken', 'lighten', 'color-dodge', 'color-burn', 'xor', 'src-over' ];\nvar comp_op_default_value = 'none';\n\nvar polygon_comp_op= {\n  name: 'Composite operation',\n  form: {\n    'polygon-comp-op': {\n      type: 'select',\n      value: comp_op_default_value,\n      extra: comp_op_options\n    }\n  }\n}\n\nvar line_comp_op= {\n  name: 'Composite operation',\n  form: {\n    'line-comp-op': {\n      type: 'select',\n      value: comp_op_default_value,\n      extra: comp_op_options\n    }\n  }\n}\n\nvar marker_comp_op= {\n  name: 'Composite operation',\n  form: {\n    'marker-comp-op': {\n      type: 'select',\n      value: comp_op_default_value,\n      extra: comp_op_options\n    }\n  }\n}\n\ncdb.admin.forms.polygon = {\n  'polygon': [\n    polygon_fill,\n    polygon_stroke,\n    polygon_comp_op,\n    label_text,\n    label_text_properties,\n    label_halo_properties,\n    label_text_offset,\n    text_allow_overlap,\n    label_placement\n  ],\n  'point': [\n    marker_fill,\n    marker_stroke,\n    marker_comp_op,\n    label_text,\n    label_text_properties,\n    label_halo_properties,\n    label_text_offset,\n    text_allow_overlap,\n    label_placement\n  ],\n  'line': [\n    line_stroke,\n    line_comp_op,\n    label_text,\n    label_text_properties,\n    label_halo_properties,\n    label_text_offset,\n    text_allow_overlap,\n    label_placement\n  ]\n};\n\n\nvar column_category = {\n  name: 'Column',\n  form: { 'property': { type: 'select', columns: 'number|string|boolean'} } /* value is filled by wizard */\n};\nvar column_numeric = {\n  name: 'Column',\n  form: { 'property': { type: 'select', columns: 'number'} } /* value is filled by wizard */\n};\n\nvar column_torque_category = {\n  name: 'Category Column',\n  form: { 'property_cat': { type: 'select', columns: 'number|string|boolean'} } /* value is filled by wizard */\n};\n\nvar column_numeric_date = {\n  name: 'Column',\n  form: { 'property': { type: 'select', columns: 'number|date'} } /* value is filled by wizard */\n};\n\nvar column_numeric_date_with_cartodb_id = {\n  name: 'Time Column',\n  form: { 'property': { type: 'select', columns: 'number|date', extra_default: ['cartodb_id'], default_column: 'date'\n  } } /* value is filled by wizard */\n};\n\nvar column = {\n  name: 'Column',\n  form: { 'property': { type: 'select', columns: 'number|string'} } /* value is filled by wizard */\n};\n\nvar method = {\n  name: 'Method',\n  form: {\n    // enable this when there is more than one method\n    'stats_method': { type: 'select', value: 'Quantiles', extra: ['Quantiles'] }\n  }\n};\n\nvar buckets = {\n  name: 'Buckets',\n  form: {\n    'method': { type: 'select', value: '7 Buckets', extra: ['3 Buckets', '5 Buckets', '7 Buckets'] }\n  }\n};\n\nvar QuantifyFn = {\n  name: 'Quantification',\n  form: {\n    'qfunction': { type: 'select', value: 'Quantile' /*'Jenks'*/, extra: [\n      'Jenks',\n      'Equal Interval',\n      'Heads/Tails',\n      'Quantile'\n     ]\n    }\n  }\n};\n\nvar color_ramp_polyline = {\n  name: 'Color Ramp',\n  form: {\n    'color_ramp': { type: 'select', value: 'red', extra:['pink',\n      'red', 'black', 'green', 'blue',\n      'inverted_pink', 'inverted_red', 'inverted_black',\n      'inverted_green', 'inverted_blue', 'spectrum1', 'spectrum2',\n      'blue_states', 'purple_states', 'red_states',\n      'inverted_blue_states', 'inverted_purple_states', 'inverted_red_states'] },\n    'line-opacity': { type: 'opacity', value: 0.8 }\n  }\n};\n\nvar color_ramp_polygon = {\n  name: 'Color Ramp',\n  form: {\n    'color_ramp': { type: 'select', value: 'red', extra:['pink',\n      'red', 'black', 'green', 'blue',\n      'inverted_pink', 'inverted_red', 'inverted_black',\n      'inverted_green', 'inverted_blue', 'spectrum1', 'spectrum2',\n      'blue_states', 'purple_states', 'red_states',\n      'inverted_blue_states', 'inverted_purple_states', 'inverted_red_states'] },\n    'polygon-opacity': { type: 'opacity', value: 0.8 }\n  }\n};\n\nvar color_ramp_point = {\n  name: 'Color Ramp',\n  form: {\n    'color_ramp': { type: 'select', value: 'red', extra:['pink',\n      'red', 'black', 'green', 'blue',\n      'inverted_pink', 'inverted_red', 'inverted_black',\n      'inverted_green', 'inverted_blue', 'spectrum1', 'spectrum2',\n      'blue_states', 'purple_states', 'red_states',\n      'inverted_blue_states', 'inverted_purple_states', 'inverted_red_states'] },\n    'marker-opacity': { type: 'opacity', value: 0.8 }\n  }\n};\n\nvar bubble_form = [\n  column_numeric, // Select column\n  QuantifyFn,\n  {\n     name: 'Radius',\n     title: 'Radius (min-max)',\n     form: {\n       'radius_min': { type: 'number', value: 10, min:0, max:100 },\n       'radius_max': { type: 'number', value: 25, min:0, max:100 }\n     },\n     text: '- to -'\n  },\n  {\n     name: 'Bubble fill',\n     form: {\n       'marker-fill': { type: 'color', value: '#FF5C00' },\n       'marker-opacity': { type: 'opacity', value: 0.9 }\n     }\n  },\n  {\n     name: 'Bubble stroke',\n     form: {\n       'marker-line-width': { type: 'number', value: 1.0, min:0, max:100, inc: 0.5 },\n       'marker-line-color': { type: 'color', value: '#FFF' },\n       'marker-line-opacity': { type: 'opacity', value: 1.0 }\n     }\n  },\n  marker_comp_op\n];\n\ncdb.admin.forms.intensity = {\n  'point': [\n    {\n      name: 'Marker Fill',\n      form: {\n        'marker-width': { type: 'width', value: 10 },\n        'marker-fill': { type: 'color' , value: '#FFCC00' },\n        'marker-opacity': { type: 'opacity' , value: 0.9 },\n        'marker-allow-overlap': { type: 'hidden', value: true },\n        'marker-placement':{ type:'hidden', value: 'point'},\n        'marker-type':{ type:'hidden', value: 'ellipse'}\n      }\n    },\n    marker_stroke\n  ]\n};\n\ncdb.admin.forms.bubble = {\n  'point': bubble_form,\n  'polygon': bubble_form,\n  'line': bubble_form\n};\n\ncdb.admin.forms.choropleth = {\n  'polygon': [\n    column_numeric,\n    //method,\n    buckets,\n    QuantifyFn,\n    color_ramp_polygon,\n    polygon_stroke,\n    polygon_comp_op,\n    label_text,\n    label_text_properties,\n    label_halo_properties,\n    label_text_offset,\n    text_allow_overlap,\n    label_placement\n  ],\n\n  'line': [\n    column_numeric,\n    //method,\n    buckets,\n    QuantifyFn,\n    color_ramp_polyline,\n    line_stroke_chroloplet,\n    line_comp_op,\n    label_text,\n    label_text_properties,\n    label_halo_properties,\n    label_text_offset,\n    text_allow_overlap,\n    label_placement\n  ],\n\n  'point': [\n    column_numeric,\n    //method,\n    buckets,\n    QuantifyFn,\n    color_ramp_point,\n    {\n      name: 'Marker Width',\n      form: {\n        'marker-width': { type: 'width', value: 10 },\n        'marker-allow-overlap': { type: 'hidden', value: true },\n        'marker-placement':{ type:'hidden', value: 'point'},\n        'marker-type':{ type:'hidden', value: 'ellipse'}\n      }\n    },\n    marker_stroke,\n    marker_comp_op,\n    label_text,\n    label_text_properties,\n    label_halo_properties,\n    label_text_offset,\n    text_allow_overlap,\n    label_placement\n  ],\n};\n\ncdb.admin.forms.color = {\n  'polygon': [\n    column,\n    {\n      name: 'Polygon Fill',\n      form: {\n        'polygon-opacity': { type: 'opacity' , value: 0.7 }\n      }\n    },\n    polygon_stroke\n  ],\n\n  'line': [\n    column,\n    {\n      name: 'LineStroke',\n      form: {\n        'line-width': { type: 'width', value: 2 },\n        'line-opacity': { type: 'opacity', value: 0.7 }\n      }\n    }\n  ],\n\n  'point': [\n    column,\n    {\n      name: 'Marker Fill',\n      form: {\n        'marker-width': { type: 'width', value: 10 },\n        'marker-opacity': { type: 'opacity' , value: 0.9 },\n        'marker-allow-overlap': { type: 'hidden', value: true },\n        'marker-placement':{ type:'hidden', value: 'point'},\n        'marker-type':{ type:'hidden', value: 'ellipse'}\n      }\n    },\n    marker_stroke\n  ],\n};\n\n\ncdb.admin.forms.cluster = {\n  'point': [\n    {\n    name: 'Buckets',\n    form: {\n      'method': { type: 'select', value: '3 Buckets', extra: ['2 Buckets', '3 Buckets', '4 Buckets', '5 Buckets'] }\n    }\n  }, {\n    name: 'Marker Fill',\n    form: {\n      'marker-fill': { type: 'color' , value: '#FD8D3C' },\n      'marker-opacity': { type: 'opacity' , value: 1 },\n      'marker-allow-overlap': { type: 'hidden', value: true },\n      'marker-placement':{ type:'hidden', value: 'point'},\n      'marker-type':{ type:'hidden', value: 'ellipse'}\n    }\n  }, {\n    name: 'Marker Stroke',\n    form: {\n      'marker-line-width': { type: 'width', value: 5.0 },\n      'marker-line-color': { type: 'color' , value: '#fff' },\n      'marker-line-opacity': { type: 'opacity', value: 1 }\n    }\n  }, {\n    name: 'Radius',\n    title: 'Marker size',\n    form: {\n      'radius_min': { type: 'number', value: 24, min:0, max:200 },\n      'radius_max': { type: 'number', value: 64, min:0, max:200 }\n    },\n    text: '- to -'\n  }, {\n    title: 'Label Font',\n    name: 'Label Text',\n    className: \"label_text_properties\",\n    form: {\n      'text-face-name': {\n        type: 'select',\n        value: \"DejaVu Sans Book\",\n        extra: [\"DejaVu Sans Book\",\"unifont Medium\", \"Open Sans Regular\", \"Lato\", \"Graduate\", \"Gravitas One\", \"Old Standard\"]\n      },\n      'text-fill': { type: 'color' , value: '#fff' }\n    }\n\n  },{\n    name: 'Label Halo',\n    className: \"label_halo_properties\",\n    form: {\n      'text-halo-fill':  { type: 'color' , value: '#FFF' },\n      'text-halo-radius': { type: 'number', value: 0.5, min: 0, max: 10, inc: 0.5}\n    }\n  }\n  ]\n};\n\ncdb.admin.forms.category = {\n  'polygon': [\n    column_category,\n    {\n      name: 'Polygon Fill',\n      form: {\n        'polygon-opacity': { type: 'opacity' , value: 0.7 }\n      }\n    },\n    polygon_stroke\n  ],\n\n  'line': [\n    column_category,\n    {\n      name: 'LineStroke',\n      form: {\n        'line-width': { type: 'width', value: 2 },\n        'line-opacity': { type: 'opacity', value: 0.7 }\n      }\n    }\n  ],\n\n  'point': [\n    column_category,\n    {\n      name: 'Marker Fill',\n      form: {\n        'marker-width': { type: 'width', value: 10 },\n        'marker-opacity': { type: 'opacity' , value: 0.9 },\n        'marker-allow-overlap': { type: 'hidden', value: true },\n        'marker-placement':{ type:'hidden', value: 'point'},\n        'marker-type':{ type:'hidden', value: 'ellipse'}\n      }\n    },\n    marker_stroke\n  ],\n};\n\n\n\ncdb.admin.forms.density = {\n  'point': [\n    {\n       name: 'Method',\n       form: {\n         'geometry_type': { type: 'select', value: 'Hexagons', extra: ['Hexagons', 'Rectangles'] }\n       }\n    },\n    {\n       name: 'Buckets',\n       form: {\n         'method': { type: 'select', value: '5 Buckets', extra: ['5 Buckets', '7 Buckets'] }\n       }\n    },\n\n    {\n       name: 'Color ramp',\n       form: {\n         'color_ramp': { type: 'select', value: 'red', extra:['pink',\n            'red', 'black', 'green', 'blue',\n            'inverted_pink', 'inverted_red', 'inverted_black',\n            'inverted_green', 'inverted_blue', 'spectrum1', 'spectrum2',\n            'blue_states', 'purple_states', 'red_states',\n            'inverted_blue_states', 'inverted_purple_states', 'inverted_red_states'] },\n         'polygon-opacity': { type: 'opacity', value: 0.8 }\n       }\n    },\n\n    polygon_stroke,\n    {\n      name: 'Polygon size',\n      form: {\n        'polygon-size': { type: 'number', value: 15, min: 1, max: 100 }\n      }\n    },\n\n    polygon_comp_op\n  ]\n};\n\nvar sharedForTorqueAndTorqueCat = {\n  'point': [\n    column_numeric_date_with_cartodb_id,\n    {\n      name: 'Marker type',\n      form: {\n        'marker-type': { type: 'select', value: 'ellipse', extra: ['ellipse', 'rectangle'] },\n\n        // this layer-type value must be present among the form options for the torque wizards to work as expected!\n        // see issue #1166 on github, for related bug report and discussion.\n        'layer-type': { type: 'hidden', value: 'torque' }\n      }\n    },\n    {\n      name: 'Marker Fill',\n      form: {\n        'marker-width': { type: 'width', value: 6 },\n        'marker-fill': { type: 'color' , value: '#0F3B82' },\n        'marker-opacity': { type: 'opacity' , value: 0.9 }\n      }\n    },\n    {\n      name: 'Marker Stroke',\n      form: {\n        'marker-line-width': { type: 'width', value: 0 },\n        'marker-line-color': { type: 'color' , value: '#FFF' },\n        'marker-line-opacity': { type: 'opacity', value: 1.0 }\n      }\n    },\n    {\n      name: 'Duration (secs)',\n      form: {\n        'torque-duration': { type: 'number', value: 30, min: 3, max: 120 },\n      }\n    },\n    {\n      name: 'Steps',\n      form: {\n        'torque-frame-count': { type: 'select', value: 256, extra: [1, 64, 128, 256, 512, 1024, 2048] }\n      }\n    },\n    {\n      name: 'Blend Mode',\n      form: {\n        'torque-blend-mode': { type: 'select', value: 'lighter', extra: [\n          'lighter', 'multiply', 'source-over', 'xor' //, 'source-atop', 'source-in', 'source-out', 'destination-atop', 'destination-in', 'destination-out', 'destination-over',  'xor', 'copy'\n        ]},\n      }\n    },\n    {\n      name: 'Trails',\n      form: {\n        'torque-trails': { type: 'number', value: 2, min: 0, max: 5 },\n      }\n    },\n    {\n      name: 'Resolution',\n      form: {\n        'torque-resolution': { type: 'select', value: 2, extra: [1, 2, 4, 8, 16, 32] }\n      }\n    }\n  ]\n\n};\n\ncdb.admin.forms.torque = clone(sharedForTorqueAndTorqueCat);\n\n// Prepend the cumulative option for torque form only.\ncdb.admin.forms.torque['point'].unshift({\n  name: 'Cumulative',\n  form: {\n    'torque-cumulative': {type: 'switch', value: false}\n  }\n});\n\ncdb.admin.forms.torque_cat = clone(sharedForTorqueAndTorqueCat);\n\n\ncdb.admin.forms.torque_heat = {\n  'point': [\n\n    {\n      name: 'Marker size',\n      form: {\n        'marker-width': { type: 'width', value: 35 },\n        'layer-type': { type: 'hidden', value: 'torque' },\n        'marker-file': { type: 'hidden', value: 'url(http://s3.amazonaws.com/com.cartodb.assets.static/alphamarker.png)' },\n        'image-filters': { type: 'hidden', value: 'colorize-alpha(blue, cyan, lightgreen, yellow , orange, red)' }\n\n      }\n    }\n    ,\n    {\n      name: 'Opacity',\n      form: {\n        'marker-opacity': { type: 'opacity' , value: 0.4 }\n      }\n    },\n    {\n      name: 'Animated',\n      form: {\n        'heat-animated': {type: 'switch', value: false}\n      }\n    },\n    {\n      name: 'Cumulative',\n      form: {\n        'torque-cumulative': {type: 'switch', value: false}\n      }\n    },\n    column_numeric_date_with_cartodb_id,\n\n    {\n      name: 'Duration (secs)',\n      form: {\n        'torque-duration': { type: 'number', value: 10, min: 3, max: 120 },\n      }\n    },\n    {\n      name: 'Steps',\n      form: {\n        'torque-frame-count': { type: 'select', value: 1, extra: [1,16,32, 64, 128, 256, 512, 1024, 2048] }\n      }\n    },\n    {\n      name: 'Trails',\n      form: {\n        'torque-trails': { type: 'number', value: 2, min: 0, max: 5 },\n      }\n    },\n    {\n      name: 'Resolution',\n      form: {\n        'torque-resolution': { type: 'select', value: 8, extra: [1, 2, 4, 8, 16, 32] }\n      }\n    }\n  ]\n}\n\n\n\n// insert category column after time column\ncdb.admin.forms.torque_cat['point'].splice(2, 0, column_torque_category);\n\n// change blend mode to not distort the colors\n_.find(cdb.admin.forms.torque_cat['point'], function(o) { return o.name === 'Blend Mode' }).form['torque-blend-mode'].value = 'source-over';\n\n\n})();\n","\n  /**\n   *  Show color picker when user clicks over\n   *  a color in the Codemirror editor.\n   *\n   *  new cdb.admin.CodemirrorColorPicker({\n   *    editor: codemirror-editor...\n   *  })\n   */\n\n  cdb.admin.CodemirrorColorPicker = cdb.core.View.extend({\n\n    initialize: function() {\n      this.editor = this.options.editor;\n      this._initBinds();\n    },\n\n    _initBinds: function() {\n      _.bindAll(this, '_onClick', '_destroyPicker', '_onBlur', '_replaceColor');\n      var self = this;\n\n      this.editor.on('mousedown', function(ed, e){\n        // Hack needed preventing cursor positioning bug\n        setTimeout(function(){ self._onClick(e) }, 50);\n      }, this);\n      this.editor.on('blur',            this._onBlur,         this);\n      this.editor.on('viewportChange',  this._destroyPicker,  this);\n      this.editor.on('scroll',          this._destroyPicker,  this);\n    },\n\n    _disableBinds: function() {\n      this.editor.off('mousedown');\n      this.editor.off('blur',           this._onBlur,         this);\n      this.editor.off('viewportChange', this._destroyPicker,  this);\n      this.editor.off('scroll',         this._destroyPicker,  this);\n      cdb.god.unbind('closeDialogs',    this._destroyPicker,  this);\n    },\n\n    _onClick: function(e) {\n      e.preventDefault();\n\n      var cursor = this.editor.getCursor(true);\n      var token = this.editor.getTokenAt(cursor);\n\n      if (token.type === \"color\" && e.target.nodeName.toLowerCase() === \"span\") {\n        this._openColorPicker(e, cursor, token);\n      } else if (this.color_picker) {\n        this._destroyPicker();\n      }\n    },\n\n    _openColorPicker: function(e, cursor, token) {\n      this._destroyPicker();\n      this._createPicker(e);\n      $('body').append(this.color_picker.render().el);\n      this.color_picker.init(token.string);\n    },\n\n    _createPicker: function(e) {\n      this.color_picker = new cdb.admin.ColorPicker({\n        target:       $(e.target),\n        extra_colors: this._getCurrentUsedColors()\n      }).bind(\"colorChosen\", this._replaceColor, this);\n      this._bindPickerEvents();\n      this.addView(this.color_picker);\n    },\n\n    _getCurrentUsedColors: function() {\n      if (!this.model) return [];\n      \n      // Tile style\n      var style = this.model.get(\"tile_style\");\n      var cartoParser = new cdb.admin.CartoParser(style);\n      return cartoParser.colorsUsed( { mode: \"hex\" });\n    },\n\n    // If user clicks over the color picker\n    // we have to avoid blur event\n    _bindPickerEvents: function() {\n      if (this.color_picker) {\n        var self = this;\n\n        this.editor.on('blur', this._onBlur, this);\n\n        this.color_picker.$el.on(\"mousedown\", function() {\n          self.editor.off('blur', self._onBlur, self);\n        });\n\n        this.color_picker.$el.on(\"mousemove\", function() {\n          self.editor.off('blur', self._onBlur, self);\n        });\n\n        this.color_picker.$el.on(\"mouseup\", function() {\n          self.editor.on('blur', self._onBlur, self);\n        });\n\n        setTimeout(function() {\n          cdb.god.bind('closeDialogs', self._destroyPicker, self);\n        },100)\n      }\n    },\n\n    _unbindPickerEvents: function() {\n      if (this.color_picker) {\n        this.editor.on('blur', this._onBlur, this);\n        this.color_picker.$el.off(\"mousedown mousemove mouseup\");\n        cdb.god.unbind('closeDialogs', this._destroyPicker, this);\n      }\n    },\n\n    _destroyPicker: function() {\n      if (this.color_picker) {\n        this._unbindPickerEvents();\n        this.removeView(this.color_picker);\n        this.color_picker.hide();\n        delete this.color_picker;\n      }\n    },\n\n    _onBlur: function(ed) {\n      this._destroyPicker();\n    },\n\n    _replaceColor: function(color, close) {\n      var cursor = this.editor.getCursor();\n      \n      var nameMatch = this._getMatch(cursor, \"name\");\n      var hexMatch = this._getMatch(cursor, \"hex\");\n      var match = nameMatch ? nameMatch : hexMatch ;\n\n      var start = {\n        line: cursor.line,\n        ch: match.start\n      };\n      var end = {\n        line: cursor.line,\n        ch: match.end\n      };\n\n      // Replace the color\n      this.editor.replaceRange(color, start, end);\n\n      // Focus the into the editor and set the cursor\n      // It will let user to save style\n      this.editor.focus();\n      this.editor.setCursor(end);\n\n      // Color chosen, let's trigger it!\n      this.trigger('colorChosen', this);\n\n      // Need to close picker?\n      if (close) this._destroyPicker();\n    },\n\n    _getMatch: function(cursor, type) {\n      if (!type) return;\n      var re;\n\n      switch (type.toLowerCase()) {\n       case \"name\":\n        re = new RegExp(color_keywords.join('|'),\"g\");\n        break; \n       case \"hsl\":\n        re = /hsla?\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3}\\%)\\s*,\\s*(\\d{1,3}\\%)\\s*(?:\\s*,\\s*(\\d+(?:\\.\\d+)?)\\s*)?\\)/g;\n        break;\n       case \"rgb\":\n        re = /rgb\\((\\d{1,3}),\\s*(\\d{1,3}),\\s*(\\d{1,3})\\)/;\n        break;\n       case \"hex\":\n        re = /#[a-fA-F0-9]{3,6}/g;\n        break;\n       default:\n        cdb.log.info(\"invalid color match selection\");\n        return;\n      }\n\n      var line = this.editor.getLine(cursor.line);\n      var match = re.exec(line);\n\n      while (match) {\n        var val = match[0];\n        var len = val.length;\n        var start = match.index;\n        var end = match.index + len;\n        if (cursor.ch >= start && cursor.ch <= end) {\n          match = null;\n          return {\n            start: start,\n            end: end,\n            string: val\n          };\n        }\n        match = re.exec(line);\n      }\n      return;\n    },\n\n    clean: function() {\n      this._disableBinds();\n      cdb.core.View.prototype.clean.call(this);\n    }\n\n  });","\ncdb.admin.mod.Filters = cdb.admin.Module.extend({\n\n    buttonClass: 'filters_mod',\n    className: 'filters_panel',\n    type: 'tool',\n\n    events: {\n\n      'click .clear a'            : '_onClickClearFilters',\n      'click .add_filter .add'    : '_onClickShowFilterSelector',\n      'click .add_filter .remove' : '_onClickHideFilterSelector',\n      'scroll'                    : '_onScroll'\n    },\n\n    _onToggleMode: function() {\n\n      var mode = this.model.get(\"addMode\");\n\n      if (mode == \"add\")         this._showAddFilter();\n      else if (mode == \"combo\")  this._showCombo();\n      else if (mode == \"hidden\") this._hideAddFilter();\n\n    },\n\n    _hideAddFilter: function() {\n      var self = this;\n\n      this.$el.find(\".add_filter > a.add, .add_filter > .combo\").fadeOut(150);\n\n    },\n\n    _showAddFilter: function() {\n      var self = this;\n\n      this.$el.find(\".add_filter > .combo\").fadeOut(150, function() {\n        self.$el.find(\".add_filter a.add\").fadeIn(150);\n        self._refreshScroll();\n      });\n\n    },\n\n    _showCombo: function() {\n      var self = this;\n\n      this.$el.find(\".add_filter a.add\").fadeOut(150, function() {\n        self.$el.find(\".add_filter > .combo\").fadeIn(150);\n        self._refreshScroll(function() {\n          self._scrollBy(30);\n        });\n\n      });\n\n    },\n\n    _onClickHideFilterSelector: function(e) {\n\n      e.preventDefault();\n      e.stopPropagation();\n\n      this.model.set(\"addMode\", \"add\");\n\n    },\n\n    _onClickClearFilters: function(e) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      this.options.dataLayer.clearSQLView();\n      this._hideQueryAppliedMessage();\n    },\n\n    _onClickShowFilterSelector: function(e) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      this.model.set(\"addMode\", \"combo\");\n\n    },\n\n    _onScroll: function(e) {\n      if (!this.api) return;\n      var n = this.api.getPercentScrolledY();\n\n      if (n <= 0) {\n        this.$el.find(\".white-gradient-shadow.main.top\").css({ opacity: 0 });\n      } else if (n == 1) {\n        this.$el.find(\".white-gradient-shadow.main.bottom\").css({ opacity: 0 });\n      } else {\n        this.$el.find(\".white-gradient-shadow.main.top\").css({ opacity: 1 });\n        this.$el.find(\".white-gradient-shadow.main.bottom\").css({ opacity: 1 });\n      }\n\n    },\n\n    initialize: function() {\n      _.bindAll(this, \"loadScroll\", \"_refreshScroll\");\n      var self = this;\n      this._initialized = false;\n      this._filterViews = {};\n      this.columns = new cdb.core.Model();\n      this.model = new Backbone.Model({\n        defaults: {\n          addMode: false\n        }\n      });\n\n      // don't initialize until the schema is not ready\n      this.options.table.bind('change:schema change:original_schema', this.initFilters, this);\n      this.add_related_model(this.options.table);\n      var comboData = [];\n\n      // Add combo boxes\n      this.innerColumnSelector = new cdb.forms.ColumnTypeCombo({\n        width: '200px',\n        placeholder: 'Select a column to filter by',\n        extra: comboData,\n        property: 'column',\n        model: self.columns\n      });\n\n      this.innerColumnSelector.bind('change', this._sendEvent, this);\n      this.add_related_model(this.innerColumnSelector);\n\n      this.columnSelector = new cdb.forms.ColumnTypeCombo({\n        width: '200px',\n        placeholder: 'Select a column to filter by',\n        extra: comboData,\n        property: 'column',\n        model: self.columns\n      });\n\n      this.columnSelector.bind('change', this._sendEvent, this);\n      this.add_related_model(this.columnSelector);\n\n      if(this.options.table.has('schema')) {\n        this.initFilters();\n      }\n\n    },\n\n    initFilters: function() {\n      // this function is attached to two changes that most of the time\n      // are produced at the same time. Although signals are unbind backbone\n      // does not support it\n      if(this._initialized) {\n        return;\n      }\n      this._initialized = true;\n\n      var self = this;\n\n      this.options.table.unbind('change:schema', this.initFilters, this);\n      this.options.table.unbind('change:original_schema', this.initFilters, this);\n\n      this.filters = new cdb.admin.models.Filters(null, {\n        table: this.options.table\n      });\n\n      this.excludedColumNames = [];\n\n      this.options.repeatInterval = this.options.repeatInterval || 200;\n\n      this.add_related_model(this.filters);\n      this.add_related_model(this.columns);\n      this.add_related_model(this.options.table);\n      this.add_related_model(this.options.dataLayer);\n\n      this.options.table.bind(\"change:schema\", this._onSchemaUpdate, this);\n      this._onSchemaUpdate();\n\n      // when SQL is cleared, remove filters\n      this.options.dataLayer.bind('change:query', function(layer, sql) {\n        if (!sql) {\n          self.removeFilters();\n          self._hideQueryAppliedMessage();\n        } else {\n          if(this.options.dataLayer.get('sql_source') !== 'filters') {\n            this._unbindChangeQuery();\n            self.removeFilters();\n            this._bindChangeQuery();\n          }\n          if (!self.filters.size()) self._showQueryAppliedMessage();\n        }\n      }, this);\n      this.add_related_model(this.options.dataLayer);\n\n      this.columns.bind('change:column', function() {\n        var col = this.columns.get('column');\n        this.filters.add({\n          column: col\n        });\n      }, this );\n      this.add_related_model(this.columns);\n\n      if (this.options.repeatInterval > 0) {\n        this._filtersChanged = _.debounce(this._filtersChanged, this.options.repeatInterval);\n      }\n\n      // Filter bindings\n      this.filters.bind('reset',                   this._addFilters,     this);\n      this.filters.bind('add',                     this._addFilter,      this);\n      this.filters.bind('remove',                  this._removeFilter,   this);\n\n      this.model.bind('change:addMode',            this._onToggleMode, this);\n      this._bindChangeQuery();\n\n      var f = this.options.dataLayer.get('filters');\n\n      if (f) {\n        this.filters.reset(f);\n      }\n\n    },\n\n    changeSQLEvents: [\n       'add',\n       'remove',\n       'change:items',\n       'change:lower',\n       'change:upper',\n       'change:free_text',\n       'change:list_view'\n    ].join(' '),\n\n    _bindChangeQuery: function() {\n      this.filters.bind(this.changeSQLEvents, this._filtersChanged, this);\n    },\n\n    _unbindChangeQuery: function() {\n      this.filters.unbind(this.changeSQLEvents, this._filtersChanged, this);\n    },\n\n    _onSchemaUpdate: function() {\n\n      // Update the combos with the columns available in the table\n      var comboData = this._generateComboData();\n\n      this.columnSelector.updateData(comboData);\n      this.innerColumnSelector.updateData(comboData);\n\n    },\n\n    _generateComboData: function() {\n\n      var self = this;\n\n      var schema = this.options.table.get(\"original_schema\") || this.options.table.get(\"schema\");\n\n      var allowedTypes = [\"string\", \"number\", \"boolean\", \"date\"];\n\n      return _.filter(schema, function(field) {\n\n        var\n        name       = field[0],\n        fieldType  = field[1];\n\n        return _.contains(allowedTypes, fieldType) && !_.contains(self.excludedColumNames, name) && name != \"cartodb_id\";\n\n      }).map(function(field) {\n\n        var name = field[0];\n\n        return [field[1], field[0]];\n      });\n\n    },\n\n    loadScroll: function() {\n\n      //if (this.api || this.model.get(\"hasScroll\")) return;\n\n      var self = this;\n\n      this.model.set(\"hasScroll\", true);\n\n      setTimeout(function() {\n\n        var $scrollPane = self.$el.find(\".scrollpane\");\n\n        $scrollPane.css(\"height\", self.$el.outerHeight(true));\n        $scrollPane.css(\"max-height\", self.$el.outerHeight(true) - 60);\n\n        $scrollPane.jScrollPane({ showArrows: true, animateScroll: true, animateDuration: 150 });\n        self.api = $scrollPane.data('jsp');\n\n      }, 250);\n\n    },\n\n    _scrollTo: function(y) {\n      if (this.api) this.api.scrollToY(y);\n    },\n\n    _scrollBy: function(y) {\n      if (this.api) this.api.scrollByY(y);\n    },\n\n    _refreshScroll: function(callback) {\n\n      if (!this.api || !this.model.get(\"hasScroll\")) return;\n\n      var self = this;\n\n      setTimeout(function() {\n\n        self.api.reinitialise();\n        callback && callback();\n\n      }, 500);\n\n    },\n\n    removeFilters: function() {\n      this.filters.removeFilters();\n    },\n\n    _getFilterViewforColumnType: function(columnType) {\n      if (columnType == 'number' || columnType == 'date') {\n        return cdb.admin.mod.Filter;\n      } else {\n        return cdb.admin.mod.SelectorFilter;\n      }\n    },\n\n    _addFilters: function() {\n      var self = this;\n\n      if (this.filters) {\n        this.filters.each(function(f) {\n          self._addFilter(f);\n        });\n      }\n\n    },\n\n    _addFilter: function(column) {\n\n      var self = this;\n\n      if (!column.has('column_type')) {\n        cdb.log.error(\"model should contain column_type, filter is not added\");\n        return;\n      }\n\n      this.$el.find(\".chooser\").hide();\n      this.$el.find(\".add_filter\").show();\n\n      var columnType = column.get('column_type');\n\n      var ViewClass = this._getFilterViewforColumnType(columnType);\n\n      var v = new ViewClass({ model: column });\n\n      v.bind(\"refresh_scroll\",   this._refreshScroll,    this);\n      v.bind(\"scrollToPosition\", this._scrollToPosition, this);\n\n      this.addView(v);\n\n      this._filterViews[column.cid] = v;\n      this.$('.filters').append(v.render().el);\n\n      this.excludedColumNames.push(column.get(\"column\"));\n\n      var comboData = this._generateComboData();\n\n      this.columnSelector.updateData(comboData);\n      this.innerColumnSelector.updateData(comboData);\n\n      if (comboData.length == 0) this.model.set(\"addMode\", \"hidden\");\n      else this.model.set(\"addMode\", \"add\");\n\n      this._refreshScroll(function() {\n        setTimeout(function() {\n          self._scrollBy(200);\n        }, 100);\n      });\n\n    },\n\n    _removeFilter: function(model) {\n\n      // Hide the filter's combo\n      this.model.set(\"addMode\", \"add\");\n\n      var self = this;\n      var view = this._filterViews[model.cid];\n\n      view.$el.hide();\n      view.clean();\n\n      delete self._filterViews[model.cid];\n\n      if (_.size(self._filterViews) < 1) {\n        this.$el.find(\".chooser\").show();\n        this.$el.find(\".add_filter\").hide();\n      }\n\n      this.excludedColumNames = _.without(this.excludedColumNames, model.get(\"column\"));\n\n      this.innerColumnSelector.updateData(this._generateComboData());\n      this.innerColumnSelector.deselect();\n\n      this.columnSelector.updateData(this._generateComboData());\n      this.columnSelector.deselect();\n\n      this._scrollTo(0);\n      this._refreshScroll();\n\n    },\n\n    _filtersChanged: function() {\n\n      // Serialize to layer\n      this.options.dataLayer.set({\n        'filters': this.filters.toJSON()\n      }, { silent: true });\n\n      var sql;\n\n      if (this.filters.size()) {\n\n        sql = _.template(\"SELECT * FROM <%= table %> WHERE <%= cond %>\")({\n          table: this.options.table.get('id'),\n          cond: this.filters.getSQLCondition()\n        });\n\n        sql = this._cleanSQL(sql);\n        this.options.dataLayer.applySQLView(sql, {\n          sql_source: 'filters'\n        });\n\n      } else {\n        this.options.dataLayer.clearSQLView();\n      }\n\n    },\n\n    _cleanSQL: function(sql) {\n\n      String.prototype.rtrim=function(){return this.replace(/\\s+$/,'');};\n\n      cleaned_sql = sql.replace(/\\(true\\)\\s*AND/g, \"\").rtrim();\n      cleaned_sql = cleaned_sql.replace(/\\AND\\s*\\(true\\)/g, \"\").rtrim();\n      cleaned_sql = cleaned_sql.replace(/WHERE\\s*\\B/, \"WHERE \");\n      cleaned_sql = cleaned_sql.replace(/WHERE$/, \"\");\n      cleaned_sql = cleaned_sql.replace(/WHERE\\s*true$/, \"\");\n      cleaned_sql = cleaned_sql.replace(/\\sWHERE\\s*\\(true\\)$/, \"\");\n\n      return cleaned_sql;\n\n    },\n\n    _hideQueryAppliedMessage: function() {\n      this.$el.find(\".applied_query\").hide();\n      this.$el.find(\".form_combo\").show();\n      this.$el.find(\".help\").show();\n    },\n\n    _showQueryAppliedMessage: function() {\n      this.$el.find(\".form_combo\").hide();\n      this.$el.find(\".help\").hide();\n      this.$el.find(\".applied_query\").show();\n    },\n\n    _sendEvent: function(column) {\n      // Event tracking \"Applied filter\"\n      cdb.god.trigger('metrics', 'filter', {\n        email: window.user_data.email\n      });\n    },\n\n    render: function() {\n\n      var self = this;\n\n      var template = this.getTemplate('table/menu_modules/filters/templates/filters');\n\n      var sqlSource = this.options.dataLayer.get(\"sql_source\");\n      var query     = this.options.dataLayer.get(\"query\");\n\n      var isQueryApplied = (query && sqlSource != 'filters');\n\n      this.$el.html(template({ isQueryApplied: isQueryApplied }));\n\n      this.$el.find('.chooser').append(this.columnSelector.render().el);\n      this.$el.find('.combo').prepend(this.innerColumnSelector.render().el);\n\n      if (this.filters == undefined || this.filters.length == 0) {\n        this.$el.find(\".chooser\").show();\n      } else {\n        this.$el.find(\".add_filter\").show();\n      }\n\n      if (isQueryApplied) {\n        this._showQueryAppliedMessage();\n      }\n\n      return this;\n    }\n\n});\n\n","(function() {\n\n  /*\n  * Filter's model\n  *\n  **/\n\n  cdb.admin.mod.Filter = cdb.core.View.extend({\n\n    _SHORT_MONTH_NAMES: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\n    _MONTH_NAMES: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],\n\n    tagName: 'li',\n    className: 'filter histogram',\n\n    events: {\n      'click a.remove': '_remove'\n    },\n\n    initialize: function() {\n\n      _.bindAll(this, \"_barChart\");\n\n      this.model.bind('change:hist',  this.render,  this);\n      this.model.bind('change:lower', this._renderRange, this);\n      this.model.bind('change:upper', this._renderRange, this);\n      this.model.bind('error',        this._checkEmpty,  this);\n\n      this.isDate = (this.model.get(\"column_type\") == 'date');\n\n      if (this.isDate) {\n        this.$el.addClass('date');\n      }\n\n    },\n\n    _renderHist: function() {\n      var self = this;\n\n      var histData = this.model.get('hist');\n\n      if(!histData) return;\n\n      if (histData.length == 1) {\n        var M = histData.length;\n\n        this.$el.find(\".legend\").html(this._cleanString(this.model.escape('column'), 15) + \":\");\n\n        this.$(\".loading\").hide();\n        this.$(\".empty\").hide();\n        this.$(\".range\").hide();\n        this.$(\".only\").fadeIn(150);\n\n        return;\n      }\n\n      this._checkEmpty();\n\n      var data = histData.map(function(x, i) {\n        return { value: x };\n      });\n\n      var filter = crossfilter(data);\n\n      var dim = function(k) {\n        return filter.dimension(function (d) {\n          return d[k];\n        });\n      }\n\n      var def = function(k) {\n\n        var dimK  = dim(k);\n\n        var width = 325;\n\n        var lower = self.model.get(\"lower\");\n        var upper = self.model.get(\"upper\");\n\n        // Inverse interpolation\n        var span = self.model.get(\"upper_limit\") - self.model.get(\"lower_limit\")\n        var bar_size = span/data.length;\n        var l = (lower - self.model.get(\"lower_limit\")) * data.length / span;\n        var u = (upper - self.model.get(\"lower_limit\")) * data.length / span;\n\n        return self._barChart()\n        .dimension(dimK)\n        .group(data.map(function(d) { return parseFloat(d.value, 10); }))\n        .round(function(v) {\n          return Math.ceil(v);\n        })\n        .x(\n          d3.scale.linear()\n          .domain([0, data.length])\n          .range([0, width])\n        )\n        .filter([l, u])\n      }\n\n      var chartDefs = [def('value')];\n\n      var chartDivs = d3.select(\".hist.\" + this.cid)\n      .data(chartDefs)\n      .each(function(chartDiv) {\n        chartDiv.on(\"brush\", renderAll).on(\"brushend\", renderAll);\n      });\n\n      function renderAll() {\n        chartDivs.each(function(method) {\n          d3.select(this).call(method);\n        });\n      }\n\n      renderAll();\n\n    },\n\n    render: function() {\n\n      var self = this;\n\n      this.$el.html(this.getTemplate('table/menu_modules/filters/templates/histogram')({\n        legend: this.model.escape('column'),\n        cid: self.cid\n      }));\n\n      this._renderHist();\n\n      return this;\n    },\n\n    _cleanString: function(s, n) {\n\n      if (s) {\n        s = s.replace(/<(?:.|\\n)*?>/gm, ''); // strip HTML tags\n        s = s.substr(0, n-1) + (s.length > n ? '&hellip;' : ''); // truncate string\n      }\n\n      return s;\n\n    },\n\n    _checkEmpty: function() {\n\n      var self = this;\n\n      setTimeout(function() {\n\n        var hist = self.model.get(\"hist\");\n\n        if (hist) {\n\n          if (hist.length > 1) {\n\n            self.$(\".empty\").hide();\n            self.$(\".loading\").hide();\n            self.$(\".range\").fadeIn(250);\n          } else {\n\n            self.$el.find(\".legend\").html(self.model.escape('column'));\n\n            self.$(\".loading\").hide();\n            self.$(\".range\").hide();\n            self.$(\".empty\").hide();\n            self.$(\".only\").fadeIn(150);\n          }\n        } else {\n\n          self.$el.find(\".legend\").html(self._cleanString(self.model.escape('column'), 25) + \":\");\n\n          self.$(\".range\").hide();\n          self.$(\".loading\").hide();\n          self.$(\".empty\").fadeIn(150);\n        }}\n      , 250);\n\n      },\n\n    _getMinMaxFromDate: function(lower, upper) {\n\n      var min, max;\n\n      lower = Math.round(lower);\n      upper = Math.round(upper);\n\n      var min_date = this.model._getDateFromTimestamp(lower);\n      var max_date = this.model._getDateFromTimestamp(upper);\n\n      var min, max;\n\n      minMaxDate = this._formatDate(min_date, max_date);\n\n      return { min: minMaxDate.min, max: minMaxDate.max }\n\n    },\n\n    _formatLowerUpper: function(lower, upper) {\n      return { min: lower.toPrecision( Math.round(lower).toString().length + 2), max: upper.toPrecision( Math.round(upper).toString().length + 2) };\n    },\n\n    _renderRange: function() {\n\n      var lower = this.model.get('lower');\n      var upper = this.model.get('upper');\n\n      var minMax = {};\n\n      if (this.isDate) {\n        minMax = this._getMinMaxFromDate(lower, upper);\n      } else {\n        minMax = this._formatLowerUpper(lower, upper);\n      }\n\n      if (!_.isNaN(upper) && !_.isNaN(lower)) {\n        this.$('.range').html(minMax.min + \" - \" + minMax.max);\n      }\n\n    },\n\n    _remove: function(e) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      this.model.destroy();\n    },\n\n    _updateBounds:function(bounds, update) {\n\n      if (bounds) {\n\n        var n = this.model.get(\"hist\").length;\n\n        var lower_ = this.model.interpolate(bounds[0]/n);\n        var upper_ = this.model.interpolate(bounds[1]/n);\n\n        var lowerFit = this.model.fitToBucket(lower_);\n        var upperFit = this.model.fitToBucket(upper_) + (this.model.get('bucket_size') || 0);\n\n        if (lowerFit < lower_) lower = lower_;\n        else lower = lowerFit || lower_;\n\n        lower = lowerFit || lower_;\n\n        if (upperFit > upper_) upper = upper_;\n        else upper = upperFit || upper_;\n\n        if (update) {\n          if (!_.isNaN(lower)) this.model.set('lower', lower);\n          if (!_.isNaN(upper)) this.model.set('upper', upper);\n        }\n\n        if (this.isDate) {\n          minMax = this._getMinMaxFromDate(lower, upper);\n        } else {\n          minMax = this._formatLowerUpper(lower, upper);\n        }\n\n        if (!_.isNaN(upper) && !_.isNaN(lower)) {\n          this.$('.range').html(minMax.min + \" - \" + minMax.max);\n        }\n\n      }\n\n    },\n\n    _formatDate: function(min_date, max_date) {\n\n      function get_nth_suffix(date) {\n        switch (date) {\n          case 1:\n          case 21:\n          case 31:\n            return 'st';\n          case 2:\n          case 22:\n            return 'nd';\n          case 3:\n          case 23:\n            return 'rd';\n          default:\n            return 'th';\n        }\n      }\n\n      function pad(n, width, z) {\n        z = z || '0';\n        n = n + '';\n        return n.length >= width ? n : new Array(width - n.length + 1).join(z) + n;\n      }\n\n      var minDay = min_date.getDate();\n      var maxDay = max_date.getDate();\n\n      var minYear = min_date.getFullYear();\n      var maxYear = max_date.getFullYear();\n\n      var minMonth = min_date.getMonth();\n      var maxMonth = max_date.getMonth();\n\n      var minTime = pad(min_date.getHours(), 2) + \":\" + pad(min_date.getMinutes(), 2) + \" \";\n      var minDate = pad(minDay, 2) + \" \" + this._SHORT_MONTH_NAMES[minMonth] + \" \" + minYear;\n\n      var maxTime = pad(max_date.getHours(), 2) + \":\" + pad(max_date.getMinutes(), 2) + \" \";\n      var maxDate = pad(maxDay, 2) + \" \" + this._SHORT_MONTH_NAMES[maxMonth] + \" \" + maxYear;\n\n      return { min: minDate + \" @ \" + minTime, max: maxDate + \" @ \" + maxTime }\n\n    },\n\n    _barChart: function() {\n\n      var self = this;\n\n      var\n        minHeight = 97,\n                  margin = {top: 0, right: 10, bottom: 0, left: 10},\n                  x, y   = d3.scale.linear().range([100, 0]),\n                  id     = this.cid,\n                  brush  = d3.svg.brush(),\n                  brushDirty,\n                  dimension,\n                  group,\n                  round;\n\n      function chart(div) {\n\n        var\n          width  = x.range()[1],\n                 height = y.range()[0];\n\n        y.domain([0, d3.max(group)]);\n\n        div.each(function() {\n\n          var div = d3.select(this),\n          g = div.select(\"g\");\n\n        // Create the skeletal chart.\n        if (g.empty()) {\n\n          g = div.append(\"svg\")\n          .attr(\"width\", width + margin.left + margin.right)\n          .attr(\"height\", height + margin.top + margin.bottom)\n          .append(\"g\")\n          .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n        g.append(\"clipPath\")\n          .attr(\"id\", \"clip-\" + id)\n          .append(\"rect\")\n          .attr(\"width\", width)\n          .attr(\"height\", height);\n\n        g.selectAll(\".bar\")\n          .data(['background', 'foreground'])\n          .enter().append(\"path\")\n          .attr(\"class\", function(d) { return d + \" bar\"; })\n          .data([group, group])\n\n          g.selectAll(\".foreground.bar\")\n          .attr(\"clip-path\", \"url(#clip-\" + id + \")\");\n\n        // Initialize the brush component with pretty resize handles.\n        var gBrush = g.append(\"g\").attr(\"class\", \"brush\").call(brush);\n        gBrush.selectAll(\"rect\").attr(\"height\", height);\n        gBrush.selectAll(\".resize\").append(\"path\").attr(\"d\", resizePath);\n        }\n\n        // Only redraw the brush if set externally.\n        if (brushDirty) {\n\n          brushDirty = false;\n          g.selectAll(\".brush\").call(brush);\n\n          if (brush.empty()) {\n            g.selectAll(\"#clip-\" + id + \" rect\")\n              .attr(\"x\", 0)\n              .attr(\"width\", width);\n          } else {\n\n            var extent = brush.extent();\n\n            g.selectAll(\"#clip-\" + id + \" rect\")\n              .attr(\"x\", x(extent[0]))\n              .attr(\"width\", x(extent[1]) - x(extent[0]));\n\n\n            self._updateBounds(extent, false);\n\n          }\n        }\n\n        g.selectAll(\".bar\").attr(\"d\", barPath);\n\n        });\n\n        function barPath(h, i) {\n\n          var path = [],\n              i = -1,\n              n = h.length,\n              d;\n\n          var barWidth = width/n;\n          while (++i < n) {\n            d = h[i];\n\n            inverseHeight = y(d);\n            if (inverseHeight > minHeight && inverseHeight < height ) inverseHeight = minHeight;\n            path.push(\"M\", x(i), \",\", height, \"V\", inverseHeight, \"h\", barWidth, \"V\", height);\n          }\n\n          return path.join(\"\");\n\n        }\n\n        function resizePath(d) {\n          var e = +(d == \"e\"),\n              x = e ? 1 : -1,\n              y = height / 3;\n          return \"M\" + (.5 * x) + \",\" + y\n            + \"A6,6 0 0 \" + e + \" \" + (6.5 * x) + \",\" + (y + 6)\n            + \"V\" + (2 * y - 6)\n            + \"A6,6 0 0 \" + e + \" \" + (.5 * x) + \",\" + (2 * y)\n            + \"Z\"\n            + \"M\" + (2.5 * x) + \",\" + (y + 8)\n            + \"V\" + (2 * y - 8)\n            + \"M\" + (4.5 * x) + \",\" + (y + 8)\n            + \"V\" + (2 * y - 8);\n        }\n      }\n\n      brush.on(\"brushstart.chart\", function() {\n        var extent = brush.extent();\n        self._updateBounds(extent, false);\n      });\n\n      brush.on(\"brush.chart\", function() {\n\n        var g = d3.select(this.parentNode),\n        extent = brush.extent();\n\n      if (round) g.select(\".brush\")\n        .call(brush.extent(extent = extent.map(round)))\n        .selectAll(\".resize\")\n        .style(\"display\", null);\n\n      g.select(\"#clip-\" + id + \" rect\")\n        .attr(\"x\", x(extent[0]))\n        .attr(\"width\", x(extent[1]) - x(extent[0]));\n\n      //dimension.filterRange(extent);\n\n      self._updateBounds(extent, false);\n\n      });\n\n      brush.on(\"brushend.chart\", function() {\n        var extent = brush.extent();\n        self._updateBounds(extent, true);\n      });\n\n      chart.margin = function(_) {\n        if (!arguments.length) return margin;\n        margin = _;\n        return chart;\n      };\n\n      chart.x = function(_) {\n        if (!arguments.length) return x;\n        x = _;\n        brush.x(x);\n        return chart;\n      };\n\n      chart.y = function(_) {\n        if (!arguments.length) return y;\n        y = _;\n        return chart;\n      };\n\n      chart.dimension = function(_) {\n        if (!arguments.length) return dimension;\n        dimension = _;\n        return chart;\n      };\n\n      chart.filter = function(_) {\n        if (_) {\n          brush.extent(_);\n          dimension.filterRange(_);\n        } else {\n          brush.clear();\n          dimension.filterAll();\n        }\n        brushDirty = true;\n        return chart;\n      };\n\n      chart.group = function(_) {\n        if (!arguments.length) return group;\n        group = _;\n        return chart;\n      };\n\n      chart.round = function(_) {\n        if (!arguments.length) return round;\n        round = _;\n        return chart;\n      };\n\n      return d3.rebind(chart, brush, \"on\");\n    }\n\n  });\n\n})();\n","(function() {\n\n  // Selection Filter\n\n  var SelectorView = cdb.core.View.extend({\n\n    tagName: 'li',\n\n    events: {\n      'click': 'toggle'\n    },\n\n    initialize: function() {\n      this.model.bind('change', this.render, this);\n      this.template_base = _.template(\"<p class='<% if (bucket == undefined || bucket == '' || bucket == 'null') { %>empty<% } %>'><% if (bucket == undefined) { %>null<% } else if (bucket == '') {%>empty<% } else { %><%- bucket %><% } %></p> <div class='value'><%- value %></div>\");\n    },\n\n    /*\n     * Adds thousands separators.\n     **/\n    _formatNumber:function(x) {\n      var parts = x.toString().split(\".\");\n      parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n      return parts.join(\".\");\n    },\n\n    _cleanString: function(s) {\n\n      var n = 180; // truncate length\n\n      if (s) {\n        s = s.replace(/<(?:.|\\n)*?>/gm, ''); // strip HTML tags\n        s = s.substr(0, n-1) + (s.length > n ? '&hellip;' : ''); // truncate string\n      }\n\n      return s;\n\n    },\n\n    render: function() {\n\n      var pretty_bucket;\n      var bucket_name = this.model.get(\"bucket\");\n\n      if (this.options.column_type == 'boolean') {\n\n        if (bucket_name == null) pretty_bucket = \"null\";\n        else pretty_bucket = (bucket_name) ? \"true\" : \"false\";\n\n      } else {\n        pretty_bucket = this._cleanString(bucket_name);\n      }\n\n      // Format the number\n      var value = this.model.get(\"value\");\n      this.model.set(\"value\", this._formatNumber(value));\n\n      this.$el.html(this.template_base(_.extend(this.model.toJSON(), this.options, { bucket: pretty_bucket } )));\n\n      if(this.model.get('selected')) {\n        this.$el.addClass('selected');\n      } else {\n        this.$el.removeClass('selected');\n      }\n\n      return this;\n\n    },\n\n    toggle: function() {\n\n      var m = this.model.get('selected');\n      this.model.set('selected', !m);\n      this.trigger(\"updateCounter\");\n\n    }\n\n  });\n\n  cdb.admin.mod.SelectorFilter = cdb.core.View.extend({\n\n    tagName: 'li',\n    className: 'filter selection',\n\n    _SCROLLSTEP: 120,\n\n    events: {\n      'keypress input':           '_onKeyPress',\n      'click a.apply':            '_onApply',\n      'click a.remove':           '_remove',\n      'click a.up':               '_move',\n      'click a.down':             '_move',\n      'click a.all':              '_select',\n      'click a.none':             '_select',\n      'click .view_mode label':   '_toggleSwitch'\n    },\n\n    initialize: function() {\n\n      _.bindAll(this, \"_updateCounter\");\n\n      this.model.items.bind('reset',        this.render, this);\n\n      this.model.bind('change:free_text',   this._updateFreeText, this);\n      this.model.bind(\"change:controllers\", this._toggleControllers, this);\n\n      this.model.bind(\"change:scrollers\",   this._toggleScrollers,   this);\n\n      this.model.bind(\"change:list_view\",   this._toggleMode,        this);\n      this.model.bind(\"change:legend\",      this._updateLegend,      this);\n\n      this.model.bind(\"change:show_items\",   this._toggleItems,   this);\n\n      this.add_related_model(this.model.items);\n\n    },\n\n    _cleanString: function(s) {\n\n      if (s) {\n        s = s.replace(/<(?:.|\\n)*?>/gm, ''); // strip HTML tags\n      }\n\n      return s;\n\n    },\n\n    _updateFreeText: function(model) {\n      this.$el.find(\"input\").html(model.get(\"free_text\"));\n    },\n\n    _updateLegend: function() {\n      this.$(\".legend\").html(this.model.get(\"legend\"));\n    },\n\n    _updateCounter: function() {\n\n      var count = _.countBy(this.model.items.models, function(m) { return m.get(\"selected\") ? \"selected\" : \"unselected\"; });\n\n      this.model.set(\"count\", count);\n\n      if (count.selected == _.size(this.model.items)) {\n        this.model.set({ all: true });\n        this.$all.addClass(\"selected\");\n        this.$none.removeClass(\"selected\");\n      }\n      else if (!count.selected) {\n        this.$none.addClass(\"selected\");\n        this.$all.removeClass(\"selected\");\n      } else {\n        this.$none.addClass(\"selected\");\n        this.$all.removeClass(\"selected\");\n      }\n\n      var c = count.selected == undefined ? 0 : count.selected;\n      this.$el.find(\".count\").html(\" - \" + c + \" selected\");\n\n    },\n\n    _showControllers: function() {\n      this.model.set(\"controllers\", true)\n    },\n\n    _hideControllers: function() {\n      this.model.set(\"controllers\", false)\n    },\n\n    _toggleControllers: function() {\n\n      if (this.model.get(\"controllers\")) this.$el.find(\".controllers\").fadeIn(250);\n      else this.$el.find(\".controllers\").fadeOut(250);\n\n    },\n\n    _showScrollers: function() {\n      this.model.set(\"scrollers\", true)\n      this.$el.find(\".fields\").addClass(\"has_scrollers\");\n    },\n\n    _hideScrollers: function() {\n      this.model.set(\"scrollers\", false)\n      this.$el.find(\".fields\").removeClass(\"has_scrollers\");\n    },\n\n    _hideItems: function() {\n      this.model.set(\"show_items\", false)\n    },\n\n    _toggleItems: function() {\n\n      if (this.model.get(\"show_items\")) this.$el.find(\".items\").fadeIn(250);\n      else this.$el.find(\".items\").fadeOut(250);\n\n    },\n\n    _toggleScrollers: function() {\n\n      if (this.model.get(\"scrollers\")) {\n        this.$el.find(\".scrollers\").removeClass(\"hidden\");\n      } else {\n        this.$el.find(\".scrollers\").addClass(\"hidden\");\n      }\n\n    },\n\n    _addItems: function() {\n\n      var self = this;\n\n      this.model.items.each(function(m) {\n\n        var v = new SelectorView({ model: m, column_type: self.model.get(\"column_type\") });\n\n        v.bind(\"updateCounter\", self._updateCounter, self);\n        self.$items.append(v.render().el);\n        self.addView(v);\n\n      });\n\n    },\n\n    _addSwitch: function() {\n\n      var self = this;\n\n      this.switch = new cdb.forms.Switch({\n        el: self.$el.find(\".switch\"),\n        model: self.model,\n        property: \"list_view\"\n      });\n\n    },\n\n    _onKeyPress: function(e) {\n\n      if (e.keyCode == 13) { this._onApply(e); }\n\n    },\n\n    _onApply: function(e) {\n\n      e.preventDefault();\n      e.stopPropagation();\n\n      var t = this.$input.find(\"input\").attr(\"value\");\n      this.model.set(\"free_text\", t);\n    },\n\n    render: function() {\n\n      var self = this;\n\n      this.clearSubViews();\n\n      var status = \"loading\";\n      var count = this.model.get(\"count\");\n\n      if (count) {\n\n        if (this.model.items.length == 0 || (this.model.items.length == 1 && this.model.items.at(0).get(\"bucket\") == null)) {\n          status = \"empty\";\n        } else if (this.model.items.length == 1) {\n          status = \"only\";\n        } else {\n          status = \"loaded\";\n        }\n\n      }\n\n      this.$el.html(this.getTemplate('table/menu_modules/filters/templates/selection')({\n        status: status,\n        column_type: this.model.get(\"column_type\"),\n        legend: this.model.escape('column'),\n        short_legend: this.model.escape('column'),\n        list_view: this.model.get(\"list_view\"),\n        free_text: this.model.get('free_text'),\n        reached_limit: this.model.get('reached_limit')\n      }));\n\n      this.$scroll    = this.$el.find('.scroll');\n      this.$items     = this.$el.find('.items');\n      this.$all       = this.$el.find('.all');\n      this.$none      = this.$el.find('.none');\n      this.$input     = this.$el.find('.input_field');\n\n      this._addItems();\n      this._updateCounter();\n\n      if (this.$items.find(\"li\").length > 5) {\n        this.model.set(\"scrollers\", true);\n        this.$el.find(\".white-gradient-shadow.bottom\").css({ opacity: 1 });\n      }\n\n      if (this.model.get(\"reached_limit\")) {\n\n        this.model.set({ list_view: false });\n        this._toggleMode();\n        this.model.set(\"legend\", this.model.escape('column'));\n\n        // Adds the tipsy\n        this.$el.find(\".view_mode\").tipsy({ gravity: 's', fade:true, html: true, live:true });\n\n      } else {\n\n\n        if (this.model.get(\"column_type\") == \"boolean\") this.$el.find(\".options\").hide();\n\n        if (status != \"loaded\") this._hideItems();\n        else {\n          this._addSwitch();\n          this._toggleMode();\n        }\n\n      }\n\n      return this;\n\n    },\n\n    _toggleSwitch: function() {\n\n      if (!this.model.get(\"reached_limit\")) {\n        this.model.set(\"list_view\", !this.model.get(\"list_view\"));\n      }\n\n    },\n\n    // Toggle between list and free text views\n    _toggleMode: function() {\n\n      if (this.model.get(\"list_view\")) this._showListView();\n      else this._showFreeTextView();\n\n    },\n\n    _showFreeTextView: function() {\n\n      this._toggleShadow(\"top\", 0);\n      this._toggleShadow(\"bottom\", 0);\n\n      this.$el.find(\".scroll\").animate({ height: 55 }, { duration: 250 });\n\n      this.$input.fadeIn(250);\n\n      this.$el.find(\".scroll .items\").fadeOut(150);\n\n      this._hideControllers();\n      this._hideScrollers();\n\n      this.$el.find(\".fields\").removeClass(\"list\");\n      this.$el.find(\".fields\").addClass(\"text\");\n\n      this.model.set(\"legend\", this.model.escape('column'));\n\n      this.trigger(\"refresh_scroll\");\n\n    },\n\n    _showListView: function() {\n\n      var count = this.model.get(\"count\");\n\n      this.$input.fadeOut(250);\n\n      this.$el.find(\".scroll .items\").fadeIn(150);\n      var h = (this.$el.find(\".scroll .items li\").length + 1) * 34;\n\n      this.$el.find(\".scroll\").animate({ height: h }, { duration: 150 });\n\n      this._showControllers();\n\n      var c = 0;\n\n      if (count.selected)   c = count.selected;\n      if (count.unselected) c += count.unselected;\n\n      if (c >= 5) {\n        this._showScrollers();\n        this._toggleShadow(\"top\", 0);\n        this._toggleShadow(\"bottom\", 1);\n      } else {\n        this._hideScrollers();\n      }\n\n      this.$el.find(\".fields\").removeClass(\"text\");\n      this.$el.find(\".fields\").addClass(\"list\");\n\n      this.model.set(\"legend\", this.model.escape('column') + \":\");\n\n      this.trigger(\"refresh_scroll\");\n\n\n    },\n\n    // Allows the selection of all or none of items\n    _select: function(e) {\n\n      e.preventDefault();\n      e.stopPropagation();\n\n      var $btn = $(e.target);\n\n      if ($btn.hasClass(\"all\")) this._selectAll(e);\n      else this._selectNone(e);\n\n      this._updateCounter();\n\n    },\n\n    _selectAll: function(e) {\n\n      this.$all.addClass(\"selected\");\n      this.$none.removeClass(\"selected\");\n\n      this.model.items.each(function(i) {\n        i.set({ selected: true });\n      });\n\n    },\n\n    _selectNone: function(e) {\n\n      this.$none.addClass(\"selected\");\n      this.$all.removeClass(\"selected\");\n\n      this.model.items.each(function(i) {\n        i.set({ selected: false });\n      });\n\n    },\n\n    _move: function(e) {\n\n      e.preventDefault();\n      e.stopPropagation();\n\n      var $btn = $(e.target);\n\n      if ($btn.hasClass(\"up\")) this._moveUp(e);\n      else this._moveDown(e);\n\n    },\n\n    // Turns shadows on/off\n    _toggleShadow: function(pos, opacity) {\n      this.$el.find(\".white-gradient-shadow.\" + pos).animate({ opacity: opacity }, 50);\n    },\n\n    _moveUp: function(e) {\n      var self = this;\n\n      this._toggleShadow(\"bottom\", 1);\n      this.$el.find(\".scrollers .down\").removeClass(\"disabled\");\n\n      this.$scroll.stop().animate({ scrollTop: \"-=\" + this._SCROLLSTEP + \"px\" }, 150, function() {\n\n        if (self.$items.position().top == 0) {\n          self.$el.find(\".scrollers .up\").addClass(\"disabled\");\n          self._toggleShadow(\"top\", 0);\n        }\n\n      });\n    },\n\n    _moveDown: function(e) {\n      var self = this;\n\n      this._toggleShadow(\"top\", 1);\n\n      this.$el.find(\".scrollers .up\").removeClass(\"disabled\");\n\n      this.$el.find(\".scroll\").stop().animate({ scrollTop: \"+=\" + this._SCROLLSTEP + \"px\" }, 150, function() {\n\n        var scrollTopPos = self.$scroll.scrollTop();\n        var listHeight   = self.$scroll.find(\"ul\").height();\n        var liHeight     = self.$scroll.find(\"li:last-child\").outerHeight(true);\n\n        if (scrollTopPos + self._SCROLLSTEP + liHeight >= listHeight) {\n          self._toggleShadow(\"bottom\", 0);\n          self.$el.find(\".scrollers .down\").addClass(\"disabled\");\n        }\n\n      });\n\n    },\n\n    _remove: function(e) {\n\n      e.preventDefault();\n      e.stopPropagation();\n\n      this.model.destroy();\n    }\n\n  });\n\n})();\n","  \n  /**\n   *  Help message for html editor panes\n   *  \n   */\n\n  cdb.admin.mod.HTMLEditorHelp = cdb.core.View.extend({\n\n    _TEXTS: {\n      message: _t(\"To link data write your column names within {{}}\")\n    },\n\n    className: \"help-tip\",\n\n    events: {\n      'click .close': '_onClickClose'\n    },\n\n    initialize: function() {\n      this.template = this.getTemplate(\"table/views/html_editor_help\");\n\n      if (this.options.text) {\n        this._TEXTS.message = this.options.text;\n      }\n\n      this._setupLocalStorage();\n      this._setupModel();\n      this._toggle();\n\n      _.bindAll(this, \"_show\", \"_hide\");\n    },\n\n    render: function() {\n      this.clearSubViews();\n\n      var content = this.template(this.model.toJSON());\n      this.$el.html(content);\n\n      return this;\n    },\n\n    _setupLocalStorage: function() {\n      var key      = this.options.localStorageKey || 'html_editor_help';\n      this.storage = new cdb.admin.localStorage(key);\n    },\n\n    _setupModel: function() {\n\n      var hidden = this.storage.get('hidden') === true ? true : false;\n\n      this.model = new cdb.core.Model({ hidden: hidden, message: this._TEXTS.message });\n      this.model.bind(\"change:message\", this.render, this);\n      this.model.bind(\"change:hidden\", this._toggle, this);\n    },\n\n    _show: function() {\n      this.show();\n      this.trigger(\"show\", this);\n    },\n\n    _hide: function() {\n      this.hide();\n      this.trigger(\"hide\", this);\n    },\n\n    _onClickClose: function(e) {\n      this.killEvent(e);\n      this.storage.set({\n        hidden: true\n      });\n      this.model.set(\"hidden\", true);\n    },\n\n    _toggle: function() {\n      if (this.model.get(\"hidden\")) this._hide();\n      else this._show();\n    }\n\n  });\n","\n\n  cdb.admin.mod = cdb.admin.mod || {};\n\n\n  /**\n   *  Infowindow module, allow to edit the infowindow appearance\n   *  and the fields that will be shown\n   */\n\n  cdb.admin.mod.InfoWindow = cdb.admin.Module.extend({\n\n    buttonClass: 'infowindow_mod',\n    className: 'infowindow_panel',\n    type: 'tool',\n\n    events: {\n      'click a.doc_info': '_showMustacheHelp'\n    },\n\n    initialize: function() {\n      this.template = this.getTemplate('table/menu_modules/views/infowindow');\n      this.dataLayer = this.options.dataLayer;\n      this.user = this.options.user;\n      this.table = this.options.table;\n    },\n\n    render: function() {\n      this.clearSubViews();\n      this.$el.html(this.template());\n      this._renderContent();\n      return this;\n    },\n\n    _renderContent: function() {\n      // Infowindow tabs\n      this.infowindow_tabs = new cdb.admin.Tabs({\n        el: this.$('ul.types'),\n        slash: true\n      });\n      this.addView(this.infowindow_tabs);\n\n      // Infowindow panes\n      this.infowindow_panes = new cdb.ui.common.TabPane({\n        el: this.$(\".panes_content\")\n      });\n\n      this.addView(this.infowindow_panes);\n\n      this.tooltip_pane = new cdb.admin.mod.TooltipTab({\n        table: this.table,\n        model: this.dataLayer.tooltip\n      }).render();\n      this.tooltip_pane.bind('tabChanged', this._onEnableTab, this);\n      this.infowindow_panes.addTab('tooltip', this.tooltip_pane);\n\n      this.infowindow_pane = new cdb.admin.mod.InfoWindowTab({\n        table: this.table,\n        model: this.dataLayer.infowindow\n      }).render()\n      this.infowindow_pane.bind('tabChanged', this._onEnableTab, this);\n      this.infowindow_panes.addTab('infowindow', this.infowindow_pane);\n\n      this.infowindow_tabs.linkToPanel(this.infowindow_panes);\n\n      this.infowindow_panes.active('infowindow');\n      this.infowindow_tabs.activate('infowindow');\n\n      this.infowindow_panes.bind('tabEnabled', this._onEnableTab, this);\n    },\n\n    getModuleAction: function() {\n      var active_tab = this.infowindow_panes.activePane.getActiveTab();\n      var action = this._ACTION;\n\n      if (active_tab == \"html\") {\n        action = {\n          type: \"show\",\n          width: 600\n        }\n      }\n\n      return action;\n    },\n\n    _onEnableTab: function() {\n      this.triggerModuleAction();\n    },\n\n    activated: function() {},\n    disabled: function() {},\n    enabled: function() {},\n\n    _showMustacheHelp: function(e) {\n      this.killEvent(e);\n      cdb.editor.ViewFactory.createDialogByTemplate('common/dialogs/help/mustache_templates').appendToBody();\n    },\n\n    setActiveTab: function(tabName) {\n      this.infowindow_panes.active(tabName);\n    }\n\n  });\n\n\n\n  // - Map for getting the new template name.\n  // - It keeps retro-compatibility with old\n  //   template urls in template name attribute.\n  cdb.admin.mod.TemplateMap = {\n    'table/views/infowindow_light':               'infowindow_light',\n    'table/views/infowindow_dark':                'infowindow_dark',\n    'table/views/infowindow_light_header_blue':   'infowindow_light_header_blue',\n    'table/views/infowindow_light_header_yellow': 'infowindow_light_header_yellow',\n    'table/views/infowindow_light_header_orange': 'infowindow_light_header_orange',\n    'table/views/infowindow_light_header_green':  'infowindow_light_header_green',\n    'table/views/infowindow_header_with_image':   'infowindow_header_with_image'\n  }\n","  \n  /**\n   *  Infowindow base pane view\n   *  \n   */\n\n  cdb.admin.mod.InfowindowBasePane = cdb.core.View.extend({\n\n    _DEFAULT_TEMPLATE: 'infowindow_light',\n\n    events: {\n      \"click .reset\": \"_onResetClick\"\n    },\n\n    getColumnNames: function() {\n      var self = this;\n      var names = this.options.table.columnNames();\n      return _(names).filter(function(c) {\n        return !_.contains(self.model.SYSTEM_COLUMNS, c);\n      });\n    },\n\n    _onResetClick: function(e) {\n      this.killEvent(e);\n\n      // Restore template_name if exists, reset old_template_name and reset template\n      this.model.set({ \n        template_name:      this.model.get('old_template_name') || this._DEFAULT_TEMPLATE,\n        old_template_name:  '',\n        template:           ''\n      });\n\n      // Restore fields\n      this.model.restoreFields();\n\n      // Send trigger\n      this.trigger('reset', this);\n\n    },\n\n    _toggleContent: function() {\n      if (this.model.get(\"template\")) {\n        this.$el.addClass('disabled');\n        this.$(\".blocked\").show();\n      } else {\n        this.$el.removeClass('disabled');\n        this.$(\".blocked\").hide();\n      }\n    }\n\n  });","  \n  /**\n   *  Infowindow field view\n   *\n   */\n\n\n  cdb.admin.mod.InfowindowField = cdb.core.View.extend({\n\n    tagName: 'li',\n\n    events: {\n      'click .switch':    'toggle',\n      'click .title':     'toggleTitle'\n    },\n\n    template: _.template(\n      '<span class=\"ellipsis\"><%- fieldName %></span>\\\n      <div class=\"switches\">\\\n        <a href=\"#title\" class=\"checkbox small light title\">\\\n          <span class=\"check\"></span>\\\n          title?\\\n        </a>\\\n        <a href=\"#switch\" class=\"switch\">\\\n          <span class=\"handle\"></span>\\\n        </a>\\\n      </div>'),\n\n    initialize: function() {\n      this.fieldName = this.options.field;\n      this.position  = this.options.position;\n\n      this.model.bind('change:fields', this.fieldChange, this);\n    },\n\n    render: function() {\n      this.$el.append(this.template(this));\n      this.fieldChange();\n      this.$el.attr('cid', this.cid);\n      this.$el.addClass('drag_field');\n\n      return this;\n    },\n\n    fieldChange: function() {\n      var $title = this.$('.title');\n      var $switch = this.$('.switch');\n\n      // field\n      var f = this.model.containsField(this.fieldName);\n\n      if (f) {\n        $switch.removeClass('disabled').addClass('enabled');\n      } else {\n        $switch.removeClass('enabled').addClass('disabled');\n      }\n\n      // title\n      var t = this.model.getFieldProperty(this.fieldName, 'title');\n\n      if (f) {\n        $title.removeClass('enabled disabled');\n        if (t) $title.addClass('enabled');\n      } else {\n        $title.removeClass('enabled').addClass('disabled');\n      }\n      \n    },\n\n    toggle: function(e) {\n      e.preventDefault();\n\n      if (!this.model.containsField(this.fieldName)) {\n        this.model.addField(this.fieldName, this.position);\n      } else {\n        this.model.removeField(this.fieldName);\n      }\n\n      return false;\n    },\n\n    toggleTitle: function(e) {\n      e.preventDefault();\n      var t = this.model.getFieldProperty(this.fieldName, 'title');\n      this.model.setFieldProperty(this.fieldName, 'title', !t);\n      return false;\n    }\n  });","    \n  /**\n   *  Infowindow field item  \n   *\n   */\n\n\n  cdb.admin.mod.InfowindowFieldItem = cdb.core.View.extend({\n\n    tagName: 'li',\n\n    events: {\n      'click .switch':    'toggle',\n      'click .title':     'toggleTitle'\n    },\n\n    template: _.template('<span class=\"ellipsis\"><%- fieldName %></span><div class=\"input\"></div>'),\n\n    initialize: function() {\n      this.fieldName = this.options.field.name;\n      this.fieldTitle = this.options.field.title;\n      this.position  = this.options.position;\n    },\n\n    render: function() {\n      this.$el.append(this.template(this));\n\n      this._renderField();\n\n      return this;\n    },\n\n    toggle: function(e) {\n      e.preventDefault();\n\n      if (!this.model.containsField(this.fieldName)) {\n        this.model.addField(this.fieldName, this.position);\n      } else {\n        this.model.removeField(this.fieldName);\n      }\n\n      return false;\n    },\n\n    toggleTitle: function(e) {\n      e.preventDefault();\n      var t = this.model.getFieldProperty(this.fieldName, 'title');\n      this.model.setFieldProperty(this.fieldName, 'title', !t);\n      return false;\n    },\n\n    _renderField: function() {\n      this.fieldModel = new cdb.core.Model({ title: this.model.getAlternativeName(this.fieldName) || this.fieldName });\n\n      var self = this;\n\n      this.fieldModel.bind(\"change:title\", function() {\n        self.model.setAlternativeName(self.fieldName, this.get(\"title\"));\n      });\n\n      this.editInPlace = new cdb.admin.EditInPlace({\n        observe: \"title\",\n        model: this.fieldModel,\n        stripHTML: true,\n        disabled: !this.fieldTitle,\n        el: this.$el.find(\".input\")\n      });\n\n      this.addView(this.editInPlace);\n    }\n\n  });","\n  /**\n   *  Default infowindow pane: allows toggling titles\n   *\n   */\n\n\n  cdb.admin.mod.InfowindowFieldsPane = cdb.admin.mod.InfowindowBasePane.extend({\n\n    className: \"fieldPane\",\n\n    events: {\n      'click .selectall': '_manageAll',\n      \"click .reset\": \"_onResetClick\"\n    },\n\n    initialize: function() {\n      this._setupModel();\n      this._setupTemplate();\n\n      // An internal collection to keep track of the fields and their order\n      this.sortedFields = new Backbone.Collection;\n      this.sortedFields.comparator = function(model) {\n        return model.get('position');\n      }\n\n      this.render();\n    },\n\n    render: function() {\n      this.clearSubViews();\n\n      this.$el.html(this.template);\n      this._toggleContent();\n\n      this.$el.find('.fields').sortable(\"destroy\")\n      this.renderFields();\n      this.$selectAll = this.$(\".selectall\");\n      this.renderSelectAll();\n\n      this._storeSortedFields();\n\n      return this;\n    },\n\n    _setupModel: function() {\n      this.model.bind('remove:fields',          this.renderSelectAll, this);\n      this.model.bind('add:fields',             this.renderSelectAll, this);\n      this.model.bind(\"change:template\",        this._toggleContent,  this);\n      this.options.table.bind('change:schema',  this.render,          this);\n\n      this.bind('reset', this.render, this);\n\n      this.add_related_model(this.options.table);\n    },\n\n    _setupTemplate: function() {\n      this.template = this.getTemplate(\"table/views/infowindow/infowindow_fields_pane\");\n    },\n\n    renderSelectAll: function() {\n      this.selectedAll = this._allFieldsSelected();\n      this._changeSelectAll();\n    },\n\n    _allFieldsSelected: function() {\n      var self = this;\n      var selectedAll = true;\n      _(this.getColumnNames()).each(function(field) {\n        if (!self.model.containsField(field)) {\n          selectedAll = false;\n        }\n      });\n      return selectedAll;\n    },\n\n    _changeSelectAll: function() {\n      this.$selectAll.toggleClass(\"working\", this.working);\n      this.$selectAll.toggleClass(\"enabled\", this.selectedAll);\n      this.$selectAll.toggleClass(\"disabled\", !this.selectedAll);\n    },\n\n    _manageAll: function(e) {\n      var self = this;\n      this.killEvent(e);\n\n      if (this.working) return;\n\n      self.model.clearFields();\n\n      if (!self.selectedAll) self._selectAll();\n      else self._unselectAll();\n    },\n\n    _selectAll: function() {\n      var self = this;\n\n      var names = this.sortedFields.map(function(w){return w.get('name')});\n      var count = _.size(names) - 1;\n      var promises = [];\n\n      _(names).each(function(f) {\n        self.working = true;\n        promises.push(self.model._addField(f));\n      });\n\n      $.when.apply($, promises).then(function() {\n        self.working = false;\n        self.model.sortFields();\n        self.model.trigger('change:fields');\n\n        self._toggleSelectAll();\n      });\n    },\n\n    _unselectAll: function() {\n      this.model.trigger('change:fields');\n      this._toggleSelectAll();\n    },\n\n    _toggleSelectAll: function() {\n      this.selectedAll = !this.selectedAll;\n      this._changeSelectAll();\n    },\n\n    renderFields: function() {\n      var self = this;\n      var $f = this.$('.fields');\n\n      var names = this.getColumnNames();\n\n      // If there isn't any valid column available\n      // show the message in the background\n      if (names.length == 0) {\n        this._showNoContent();\n        return false;\n      }\n\n      names.sort(function(a, b) {\n        var pos_a = self.model.getFieldPos(a);\n        var pos_b = self.model.getFieldPos(b);\n        return pos_a - pos_b;\n      });\n\n      _(names).each(function(f, i) {\n        // when there are no fields selected, sort using the view list position\n        var pos = self.model.fieldCount() ?  self.model.getFieldPos(f) : i;\n        var v = new cdb.admin.mod.InfowindowField({\n          model: self.model,\n          field: f,\n          position: pos\n        });\n        self.addView(v);\n        $f.append(v.render().el);\n      });\n\n      // Sortable list, except theme field!\n      $f.sortable({\n        items: 'li',\n        handle: 'span.ellipsis',\n        stop: function(ev, ui) {\n          self._reasignPositions();\n        }\n      });\n    },\n\n    _showNoContent: function() {\n      this.$('.no_content').show();\n      this.$('div.all').hide();\n    },\n\n    _storeSortedFields: function() {\n      var self = this;\n\n      this.sortedFields.reset([]);\n\n      var names = this._getSortedColumnNames();\n      _(names).each(function(name, position) {\n        self.sortedFields.add({\n          name: name,\n          position: position\n        })\n      });\n    },\n\n    _getSortedColumnNames: function() {\n      var self = this;\n      var names = this.getColumnNames();\n      if (this.model.fieldCount() > 0) {\n        names.sort(function(a, b) {\n          var pos_a = self.model.getFieldPos(a);\n          var pos_b = self.model.getFieldPos(b);\n          return pos_a - pos_b;\n        });\n      }\n      return names;\n    },\n    // when fields are sorted in the iu we should recalculate all models positions\n    _reasignPositions: function() {\n      var self = this;\n      this.sortedFields.reset([]);\n\n      // Get the order of fields \n      this.$el.find('.drag_field').each(function(i, el) {\n        var v = self._subviews[$(el).attr('cid')];\n        v.model.setFieldProperty(v.fieldName, 'position', i);\n        v.position = i;\n\n        self.sortedFields.add({\n          name: v.fieldName,\n          position: i\n        })\n      });\n    }\n\n  });\n","\n  /**\n   *  Infowindow HTML editor pane\n   *\n   */\n\n  cdb.admin.mod.InfowindowHTMLPane = cdb.admin.mod.InfowindowBasePane.extend({\n\n    _TEMPLATE_URL: \"table/views/infowindow/custom_templates\",\n    _STORAGE_NAMESPACE: \"cdb.localStorage.infowindow.\",\n\n    _TEXTS: {\n      tip:            _t('To link data write your column names within {{}}. \\\n                          &lt;script&gt; tags could break your map.'),\n      template_error: _t('Error in line {{line}}: {{msg}}'),\n      empty_error:    _t('Template can\\'t be empty')\n    },\n\n    className: \"htmlPane\",\n\n    events: {\n      'click .apply': '_apply'\n    },\n\n    initialize: function(opts) {\n      _.bindAll(this, '_onKeyUpEditor');\n\n      if (opts.template_url) {\n        this._TEMPLATE_URL = opts.template_url;\n      }\n\n      this._setupTemplate();\n      this.render();\n\n      this.model.bind(\"change:width\",                           this._checkTemplate,  this);\n      this.model.bind(\"change:template_name\",                   this._setContent,     this);\n      this.model.bind(\"change:fields change:alternative_names\", this._resetContent,   this);\n    },\n\n    render: function() {\n      this.clearSubViews();\n      this.$el.html(this.template);\n\n      // Init codemirror editor\n      this._initEditor();\n      // Init help\n      this._initHelp();\n\n      return this;\n    },\n\n    _initHelp: function() {\n      this.help = new cdb.admin.mod.HTMLEditorHelp({\n        localStorageKey: this._STORAGE_NAMESPACE + this.options.table.get('id'),\n        text: this._TEXTS.tip\n      }).bind(\"hide show\", this.adjustCodeEditorSize, this);\n      this.$el.append(this.help.render().$el);\n\n      this.addView(this.help);\n    },\n\n    _initEditor: function() {\n      var self = this;\n\n      this.codeEditor = CodeMirror.fromTextArea(this.$('textarea')[0], {\n        mode: \"text/xml\",\n        tabMode: \"indent\",\n        tabSize: 2,\n        matchBrackets: true,\n        lineNumbers: true,\n        lineWrapping: true,\n        onKeyEvent: this._onKeyUpEditor,\n        extraKeys: {\n          \"Ctrl-Space\": function(cm) { self._showAutocomplete(cm) }\n        }\n      });\n\n      // Set user keymap\n      this._setKeymap();\n\n      // Set value\n      this._setContent();\n    },\n\n    _showAutocomplete: function(cm) {\n      CodeMirror.showHint(cm, CodeMirror.hint['custom-list'], {\n        completeSingle: false,\n        list: _.map(this.options.table.get('schema'), function(pair) { return pair[0] })\n      });\n    },\n\n    _onKeyUpEditor: function(cm, e) {\n      var code = (e.keyCode ? e.keyCode : e.which);\n      \n      if (e.type == \"keyup\" && code != 27 ) {\n        var self = this;\n\n        if (this.autocomplete_timeout) clearTimeout(this.autocomplete_timeout);\n\n        this.autocomplete_timeout = setTimeout(function() {\n          var cur = cm.getCursor();\n          var str = cm.getTokenAt(cur).string;\n\n          if (str.length > 2) {\n            var list = _.compact(_.map(self.options.table.get('schema'), function(pair) {\n              if (pair[0].search(str) != -1)\n                return pair[0];\n              return null;\n            }));\n\n            if (!cm.state.completionActive && str.length > 2 && list.length > 0) {\n              self._showAutocomplete(cm)\n            }\n          }\n\n        }, 150);\n      }\n    },\n\n    _setKeymap: function() {\n      // Codemirror extrakey\n      // Add save keymap\n      // PC & LINUX -> Ctrl + s\n      // MAC        -> Cmd + s\n      var ua      = navigator.userAgent.toLowerCase();\n      var self    = this;\n      this.keymap = {\n        so: \"rest\",\n        combination: \"ctrl+s\"\n      }\n\n      if (/mac os/.test(ua)) {\n        this.keymap = {\n          so: \"mac\",\n          combination: \"meta+s\"\n        }\n      }\n\n      this.$('textarea').bind('keydown', this.keymap.combination, function(e) {\n        if (((self.keymap.so==\"mac\" && e.metaKey) || (self.keymap.so==\"rest\" && e.ctrlKey)) && e.keyCode == 83 ) {\n          e.preventDefault();\n          self._apply();\n        }\n      });\n    },\n\n    _toggleContent: function() {},\n\n    // Check if custom infowindow html has or not\n    // v2 class applied. We need to avoid style problems.\n    _checkTemplate: function() {\n      // Get content\n      var html = this.codeEditor.getValue();\n      var exp = /(?=<[^>]+(?=[\\s+\\\"\\']cartodb-popup[\\s+\\\"\\']).+)([^>]+>)/;\n\n      // If so, add v2 if it is not defined\n      if (html.match(exp) && html.match(exp).length > 0) {\n        var hasV2Class = $(html).hasClass('v2');\n\n        if (!hasV2Class) {\n          var matches = html.match(exp);\n\n          if (matches.length === 0) { return false }\n\n          var occ = matches[0];\n          var change = occ.replace('cartodb-popup', 'cartodb-popup v2');\n\n          this.codeEditor.setValue(html.replace(occ,change));\n          this._apply();\n        }\n      }\n    },\n\n    _setContent: function() {\n      var html_value = this.model.get(\"template\") || this._getTemplateContent();\n      this.codeEditor.setValue(html_value);\n      this._clearErrors();\n    },\n\n    _resetContent: function() {\n      // If custom html is not set\n      if (this.model.get('template_name')) {\n        this._setContent();\n      }\n    },\n\n    _getTemplateContent: function() {\n      // Clone fields\n      var fields = [];\n      var self = this;\n      var alternative_names = _.clone(self.model.get('alternative_names'));\n\n      _.each(this.model.toJSON().fields, function(field, i) {\n        var f = _.clone(field);\n        f.position = i;\n        if (alternative_names[f.name]) {\n          f.alternative_name = alternative_names[f.name];\n        }\n        fields.push(f);\n      });\n\n      return cdb.templates.getTemplate(this._getTemplateURL())({content: { fields: fields } });\n    },\n\n    _getTemplateURL: function() {\n      // Checking if template_name was a template-url and not\n      // an infowindow type\n      var template_name = cdb.admin.mod.TemplateMap[this.model.get(\"template_name\")] || this.model.get(\"template_name\") || this._DEFAULT_TEMPLATE;\n      return this._TEMPLATE_URL + \"/\" + template_name;\n    },\n\n    _setupTemplate: function() {\n      this.template = this.getTemplate(\"table/views/infowindow/infowindow_html_pane\");\n    },\n\n    _getErrors: function() {\n      try {\n        var value = this.codeEditor.getValue();\n        var temp = cdb.core.Template.compile(this.codeEditor.getValue(), \"mustache\")()\n        if (value === \"\") {\n          return {\n            line:     '1',\n            message:  '\\n\\n' + this._TEXTS.empty_error\n          }\n        } else {\n          return {};  \n        }\n      } catch (e) {\n        return e;\n      }\n    },\n\n    _parseErrors: function(errors) {\n      // Generate error\n      var error_text = this._TEXTS.template_error\n        .replace('{{line}}', errors.line)\n        .replace('{{msg}}', errors.message.split('\\n\\n')[1]);\n\n      // Add error text\n      this.$('.info')\n        .addClass('error')\n        .html(\"<p>\" + error_text + \"</p>\")\n        .show();\n\n      this.adjustCodeEditorSize();\n    },\n\n    _clearErrors: function() {\n      // Remove error text and hide it\n      this.$('.info')\n        .removeClass('error')\n        .html('')\n        .hide();\n\n      this.adjustCodeEditorSize();\n    },\n\n    adjustCodeEditorSize: function() {\n      // Fit editor with the error\n      var info_h = this.$('.info').is(':visible') ? this.$('.info').outerHeight() : 0;\n      var help_h = this.$('.help-tip').is(':visible') ? this.$('.help-tip').outerHeight() : 0;\n\n      this.$('.CodeMirror-wrap').css({\n        bottom: info_h + 80, /* the space we need to show the action buttons */\n        top: help_h + (-10)\n      });\n    },\n\n    _onSQLApplied: function() {\n      if (this.model.get('template') && !this.model.get('template_name')) {\n        this._apply();\n      }\n    },\n\n    _apply: function(e) {\n      if (e && e.preventDefault) e.preventDefault();\n      var errors = this._getErrors();\n\n      if (!_.isEmpty(errors)) {\n        this._parseErrors(errors);\n      } else {\n        this._clearErrors();\n\n        // Save old fields\n        if (!this.model.get('old_fields')) this.model.saveFields();\n\n        // Save old template name\n        if (!this.model.get('old_template_name')) this.model.set('old_template_name', this.model.get('template_name'));\n\n        // Prevent setting the template value again\n        this.model.unbind(\"change:template\", this._setContent, this);\n\n        // Set all fields + new custom template\n        this.model.set({\n          template:       this.codeEditor.getValue(),\n          fields:         this._generateFields(),\n          template_name:  ''\n        });\n\n        // Binding again the template change in the model :)\n        this.model.bind(\"change:template\", this._setContent, this);\n      }\n    },\n\n    _generateFields: function() {\n      var self = this;\n      var columns = this.getColumnNames();\n      var fields = [];\n\n      _.each(columns, function(column, i) {\n        fields.push({ position: self.model.getFieldPos(column), name: column, title: true });\n      });\n\n      return fields;\n    },\n\n    clean: function() {\n      this.$('textarea').unbind('keydown', null, null);\n      cdb.admin.mod.InfowindowBasePane.prototype.clean.call(this);\n    }\n\n  });\n","\n  /**\n   *  Default infowindow tab pane.\n   *\n   *  - Used by: infowindow on click and infowindow on hover\n   */\n\n\n  cdb.admin.mod.InfoWindowTab = cdb.core.View.extend({\n\n    _CUSTOM_TEMPLATES_PATH: 'table/views/infowindow/custom_templates',\n\n    _THEMES: [\n      ['light',         'infowindow_light'],\n      ['dark',          'infowindow_dark'],\n      ['header blue',   'infowindow_light_header_blue'],\n      ['header green',  'infowindow_light_header_green'],\n      ['header yellow', 'infowindow_light_header_yellow'],\n      ['header orange', 'infowindow_light_header_orange'],\n      ['image header',  'infowindow_header_with_image']\n    ],\n\n    _TEXTS: {\n      title_tab: {\n        enabled:  _t('Edit title labels'),\n        disabled: _t('No titles selected')\n      }\n    },\n\n    events: {},\n\n    initialize: function() {\n      this.selectedAll = true;\n      this.table = this.options.table;\n      this.template = this.getTemplate('table/menu_modules/views/infowindow_tabs');\n      this._initBinds();\n    },\n\n    render: function() {\n      this.clearSubViews();\n\n      this.$el.html(this.template({}));\n      this._renderComponents();\n      this._setupPane();\n\n      return this;\n    },\n\n    _initBinds: function() {\n      this.table.bind('change:schema', this._onFieldsChange, this);\n      this.table.linkToInfowindow(this.model);\n      this.add_related_model(this.table);\n\n      this.model.bind('change:template',  this._onChangeTemplate, this);\n      this.model.bind('change:fields',    this._onFieldsChange,   this);\n\n      cdb.god.bind(\"end_show\", this._refreshHTMLEditor, this);\n      this.add_related_model(cdb.god);\n    },\n\n    _renderComponents: function() {\n\n      // Themes combo\n      this.themes = new cdb.forms.Combo({\n        className: 'form_combo left',\n        property: 'template_name',\n        extra: this._THEMES,\n        model: this.model\n      });\n      this.$('.header').append(this.themes.render().el);\n      this.addView(this.themes);\n\n      // Width spinner\n      // Set width in the model if it is not defined yet\n      // to be used in the spinner\n      if (!this.model.get('width')) {\n        this.model.set({ width:226 },{ silent:true })\n      }\n      this.width = new cdb.forms.Spinner({\n        model:    this.model,\n        property: 'width',\n        min:      145,\n        max:      400,\n        width:    28\n      });\n      this.$('.header .controls').append(this.width.render().el);\n      this.addView(this.width);\n\n      // // Height spinner\n      // this.maxHeight = new cdb.forms.Spinner({\n      //   model:    this.model,\n      //   property: 'maxHeight',\n      //   min:      100,\n      //   max:      300,\n      //   width:    28\n      // });\n\n      // this.$('.header').append(this.maxHeight.render().el);\n      // this.addView(this.maxHeight);\n    },\n\n    _setupTipsy: function() {\n      var tipsy_options = {\n        gravity: 's',\n        html: true,\n        live: true,\n        fade: true,\n        title: function() {\n          return $(this).attr(\"data-tipsy\")\n        }\n      };\n      this.$(\".menu a[href]:not([href='#/html'])\").tipsy(tipsy_options);\n\n      tipsy_options.gravity = 'se';\n      this.$(\".menu a[href='#/html']\").tipsy(tipsy_options);\n    },\n\n    _destroyTripsy: function() {\n      this.$(\".menu a\").each(function(i,el){\n        if ($(el).data('tipsy')) {\n          $(el).unbind('mouseenter mouseleave');\n          $(el).removeData('tipsy');\n        }\n      })\n    },\n\n    _setupPane: function() {\n      this._setupTipsy();\n\n      // Infowindow tabs\n      this.infowindow_tabs = new cdb.admin.Tabs({\n        el: this.$('.menu ul'),\n        slash: true\n      });\n      this.addView(this.infowindow_tabs);\n\n      // Infowindow panes\n      this.infowindow_panes = new cdb.ui.common.TabPane({\n        el: this.$(\".pane\")\n      });\n      this.addView(this.infowindow_panes);\n\n      this.fields_pane = new cdb.admin.mod.InfowindowFieldsPane({\n        table: this.options.table,\n        model: this.model\n      });\n      this.infowindow_panes.addTab('fields', this.fields_pane);\n\n      this.infowindow_panes.addTab('title', new cdb.admin.mod.InfowindowTitlePane({\n        table:        this.options.table,\n        model:        this.model,\n        fields_pane:  this.fields_pane\n      }));\n\n      this.infowindow_panes.addTab('html', new cdb.admin.mod.InfowindowHTMLPane({\n        table:        this.options.table,\n        model:        this.model,\n        template_url: this._CUSTOM_TEMPLATES_PATH\n      }));\n\n      this.infowindow_tabs.linkToPanel(this.infowindow_panes);\n\n      // If custom html is applied, let's select that tab\n      var active_tab = 'fields';\n      if (this.model.get('template')) active_tab = 'html';\n\n      this._activePane(active_tab, this.infowindow_panes.getPane(active_tab));\n      this.infowindow_panes.active(active_tab);\n      this.infowindow_tabs.activate(active_tab);\n\n      this.infowindow_panes.bind('tabEnabled', this._onEnableTab, this);\n    },\n\n    getActiveTab: function() {\n      return this.infowindow_panes && this.infowindow_panes.activeTab;\n    },\n\n    _activePane: function(tabName, tabView) {\n      $('.tipsy:last').remove();\n\n      if (tabName == 'html') {\n        this.$(\".form_combo\").hide();\n        this.$(\".doc_info\").show();\n        this.$(\".controls\").addClass('margin');\n        this.$(\".header h3\").text(\"Custom HTML\");\n      } else {\n        this.$(\".form_combo\").show();\n        this.$(\".doc_info\").hide();\n        this.$(\".controls\").removeClass('margin');\n        this.$(\".header h3\").text(\"\");\n      }\n\n      if (tabName == 'html') {\n        this._refreshHTMLEditor();\n        this.$el.addClass('editing_html editor');\n      } else {\n        this.$el.removeClass('editing_html editor');\n      }\n\n      if (this.model.get('template') && tabName !== 'html') {\n        this.$('.header .blocked').show();\n      } else {\n        this.$('.header .blocked').hide();\n      }\n\n      var horiz_pos = { left: 32, right: 'auto' };\n\n      if (tabName == 'html') horiz_pos = { right:29, left:'auto' };\n      else if (tabName == 'title') horiz_pos = { right:68, left:'auto' };\n\n      this.$(\".menu .tip\").css(horiz_pos);\n    },\n\n    setActiveTab: function(tabName) {\n      this.infowindow_panes.active(tabName);\n      this.infowindow_tabs.activate(tabName);\n    },\n\n    _onEnableTab: function(tabName, tabView) {\n      this._activePane(tabName, tabView);\n      // Send signal to know that active tab has changed\n      this.trigger('tabChanged', tabName, this);\n    },\n\n    // Disable title pane when all fields are unselected\n    _onFieldsChange: function(m) {\n      var fields = _.filter(this.model.get('fields'), function(f) { return f.title });\n      var columns = this.getColumnNames();\n      var $tab = this.infowindow_tabs.getTab('title');\n\n      if (fields.length == 0 || columns.length == 0) {\n        this.infowindow_panes.removeTab('title');\n        this.infowindow_tabs.disable('title');\n        $tab.attr('data-tipsy', this._TEXTS.title_tab.disabled);\n\n      } else if (!this.infowindow_panes.getPane('title')) {\n\n        this.infowindow_panes.addTab('title', new cdb.admin.mod.InfowindowTitlePane({\n          table:        this.options.table,\n          model:        this.model,\n          fields_pane:  this.fields_pane\n        }), { active: false });\n\n        this.infowindow_tabs.enable('title');\n        $tab.attr('data-tipsy', this._TEXTS.title_tab.enabled);\n      }\n    },\n\n    _onChangeTemplate: function() {\n      this._activePane(\n        this.infowindow_panes.activeTab,\n        this.infowindow_panes.getActivePane()\n      );\n    },\n\n    _refreshHTMLEditor: function() {\n      if (this.infowindow_panes && this.infowindow_panes.activeTab == \"html\") {\n        var pane = this.infowindow_panes.getPane('html');\n        if (pane && pane.codeEditor) {\n          pane.codeEditor.refresh();\n          pane.adjustCodeEditorSize();\n        }\n      }\n    },\n\n    // column names to be rendered\n    getColumnNames: function() {\n      var self = this;\n      var names = this.options.table.columnNames();\n      return _(names).filter(function(c) {\n        return !_.contains(self.model.SYSTEM_COLUMNS, c);\n      });\n    },\n\n    clean: function() {\n      this._destroyTripsy();\n      cdb.core.View.prototype.clean.call(this);\n    }\n\n  });\n","\n  /**\n   *  Infowindow title editor pane\n   *\n   */\n\n\n  cdb.admin.mod.InfowindowTitlePane = cdb.admin.mod.InfowindowBasePane.extend({\n\n    className: \"titlePane\",\n\n    initialize: function() {\n      this.fields_pane = this.options.fields_pane;\n      this._setupModel();\n      this._setupTemplate();\n      this.render();\n    },\n\n    render: function() {\n      this.clearSubViews();\n\n      this.$el.html(this.template);\n      this._toggleContent();\n\n      this.renderFields();\n\n      return this;\n    },\n\n    _setupModel: function() {\n      this.model.bind('change:fields',          this.render,         this);\n      this.model.bind(\"change:template\",        this._toggleContent, this);\n      this.options.table.bind('change:schema',  this.render,         this);\n\n      this.add_related_model(this.options.table);\n    },\n\n    _setupTemplate: function() {\n      this.template = this.getTemplate(\"table/views/infowindow/infowindow_title_pane\");\n    },\n\n    renderFields: function() {\n      var self = this;\n      var $f = this.$('.fields');\n\n      var names = this.getColumnNames();\n      var fields = [];\n\n      // If there isn't any valid column available,\n      // don't render anything.\n      if (names.length == 0) {\n        return false;\n      }\n\n      // Getting fields position from 'fields pane' and\n      // trying to reproduce the same list order.\n      if (this.fields_pane) {\n        names = [];\n        this.fields_pane.$('ul.fields li').each(function(i,li){\n          names.push($(li).find('span.ellipsis').text());\n        });\n      }\n      \n      // names.sort(function(a, b) {\n      //   var pos_a = self.model.getFieldPos(a, 'position');\n      //   var pos_b = self.model.getFieldPos(b, 'position');\n      //   return pos_a - pos_b;\n      // });\n\n      _(names).each(function(f) {\n\n        var title = false;\n        if (self.model.containsField(f)) {\n          var pos = _.indexOf(_(self.model.get('fields')).pluck('name'), f);\n          title = self.model.get('fields')[pos] && self.model.get('fields')[pos].title;\n        }\n\n        var obj = { name: f, title: title };\n        var v = new cdb.admin.mod.InfowindowFieldItem({ model: self.model,  field: obj , position: self.model.getFieldPos(f) });\n        \n        self.addView(v);\n        $f.append(v.render().el);\n      });\n\n    }\n\n  });","\n  /**\n   *  Tooltip tab pane\n   *\n   *  - Extending infowindow tab.\n   */\n\n  cdb.admin.mod.TooltipTab = cdb.admin.mod.InfoWindowTab.extend({\n\n    _CUSTOM_TEMPLATES_PATH: 'table/views/tooltip/custom_templates',\n\n    _THEMES: [\n      ['light', 'tooltip_light'],\n      ['dark',  'tooltip_dark']\n    ],\n\n    _renderComponents: function() {\n      // Themes combo\n      this.themes = new cdb.forms.Combo({\n        className: 'form_combo left',\n        property: 'template_name',\n        extra: this._THEMES,\n        model: this.model\n      });\n      this.$('.header').append(this.themes.render().el);\n      this.addView(this.themes);\n\n      // Remove controls label\n      this.$('.controls').remove();\n    }\n\n  })","\n/* Widget for the Share Dialog */\n\ncdb.admin.mod.LegendWidget = cdb.core.View.extend({\n\n  className: \"cartodb-legends\",\n\n  initialize: function() {\n\n    this.map = this.options.map;\n    this._setupTemplates();\n\n    this.map.layers.bind(\"change\", this.render, this);\n\n  },\n\n  _setupTemplates: function() {\n\n    this.template = _.template('<%- count %> active legend<%- (count == 1) ? \"\" : \"s\" %>');\n\n  },\n\n  _getLegends: function() {\n\n    var self = this;\n\n    var legends = [];\n\n    _.each(this.map.layers.models, function(layer) {\n\n      if (layer.get(\"type\") == 'layergroup') {\n\n        var layerGroupView = self.mapView.getLayerByCid(layer.cid);\n\n        for (var i = 0 ; i < layerGroupView.getLayerCount(); ++i) {\n          var l = layerGroupView.getLayer(i);\n\n          legends.push(new cdb.geo.ui.Legend({\n            type: l.legend.get(\"type\"),\n            data: l.legend.items.toJSON()\n          }));\n\n        }\n\n      } else if (layer.get(\"type\") === \"CartoDB\" || layer.get(\"type\") === \"torque\") {\n\n        legends.push(new cdb.geo.ui.Legend({\n          type: layer.legend.get(\"type\"),\n          data: layer.legend.items.toJSON()\n        }));\n\n      }\n\n    });\n\n    return legends;\n  },\n\n  _getLegendsCount: function() {\n\n    var count = 0;\n\n    _.each(this.map.layers.models, function(layer) {\n\n      if (layer.get(\"type\") == 'layergroup') {\n\n        var layerGroupView = this.mapView.getLayerByCid(layer.cid);\n\n        for (var i = 0 ; i < layerGroupView.getLayerCount(); ++i) {\n\n          var l = layerGroupView.getLayer(i);\n\n          if (l.legend.items.length > 0 && l.get(\"visible\") && l.legend.get(\"type\") != null) {\n              count++;\n            }\n          }\n\n        } else if ((layer.get(\"type\") === \"CartoDB\" || layer.get(\"type\") === \"torque\") && layer.get(\"visible\") && layer.legend.get(\"type\") != null) {\n\n          if (layer.legend.items.length > 0 || layer.legend.get(\"template\")) {\n            count++;\n          }\n\n        }\n\n      }, this);\n\n      return count;\n    },\n\n  render: function() {\n\n    this.$el.html(this.template({ count: this._getLegendsCount() }));\n\n    return this;\n\n  }\n\n});\n\n\n\ncdb.admin.mod.LegendEditorCollection = Backbone.Collection.extend({ });\n\ncdb.admin.mod.LegendEditorItem = cdb.core.View.extend({\n\n  tagName: \"li\",\n\n  events: {\n\n    \"click .title\": \"_onClickTitle\",\n    \"click .sync\": \"_onClickSync\",\n    \"click .remove\": \"_removeItem\"\n\n  },\n\n  initialize: function() {\n\n    _.bindAll(this, \"_onChangeTitle\", \"_onToggleShowTitle\", \"_onToggleSync\");\n\n    this.template = this.options.template_name ? this.getTemplate(this.options.template_name) : this.getTemplate('table/menu_modules/legends/views/legend_item');\n\n    this.add_related_model(this.model);\n\n    this.removable   = this.options.removable === undefined ? true : false;\n    this.title       = this.options.title === undefined ? \"\" : this.options.title;\n    this.showSwitch  = this.options.showSwitch === undefined ? \"\" : this.options.showSwitch;\n\n    this.model.bind(\"change:title\", this._onChangeTitle);\n    this.model.bind(\"change:show_title\", this._onToggleShowTitle);\n    this.model.bind(\"change:sync\", this._onToggleSync);\n\n  },\n\n  render: function() {\n    var values = _.extend( this.model.toJSON(), { title: this.title, sync: this.model.get(\"sync\"), show_switch: this.showSwitch, removable: this.removable });\n    this.$el.append(this.template(values));\n\n    this._addEditInPlace();\n\n    if (!this.title) this._addColorForm();\n\n    return this;\n  },\n\n  _onToggleSync:function() {\n\n    if (this.model.get(\"sync\")) this.$el.find(\".checkbox.sync\").addClass(\"enabled\");\n    else this.$el.find(\".checkbox.sync\").removeClass(\"enabled\");\n\n  },\n\n  _onChangeTitle:function() {\n\n    if (this.model.get(\"title\") && !this.model.get(\"show_title\")) this.model.set(\"show_title\", true);\n    else if (!this.model.get(\"title\") && this.model.get(\"show_title\")) this.model.set(\"show_title\", false);\n\n  },\n\n  _onToggleShowTitle:function() {\n\n    if (this.model.get(\"show_title\")) this.$el.find(\".title\").addClass(\"enabled\");\n    else this.$el.find(\".title\").removeClass(\"enabled\");\n\n  },\n\n  _onClickSync: function(e) {\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.model.set(\"sync\", !this.model.get(\"sync\"));\n\n  },\n\n  _onClickTitle: function(e) {\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.model.set(\"show_title\", !this.model.get(\"show_title\"));\n  },\n\n  _removeItem: function(e) {\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.trigger('remove', this);\n\n  },\n\n  _addEditInPlace: function() {\n    var self = this;\n\n    this.editInPlace = new cdb.admin.EditInPlace({\n      observe: this.options.observe,\n      model: this.model,\n      maxWidth: this.options.maxWidth,\n      stripHTML: true,\n      el: this.$el.find(\".input\")\n    });\n\n    // Set custom_value to true if value was added\n    // manually\n    this.editInPlace.bind(\"change\", function(val) {\n      if (this.model.get('name') == \"Left label\" || this.model.get('name') == \"Right label\") {\n        this.model.set('custom_value', true);\n      }\n    })\n\n    this.addView(this.editInPlace);\n\n  },\n\n  _addColorForm: function() {\n\n    if (this.options.filter_type == 'category' || this.options.filter_type == 'color' || this.options.filter_type == 'custom' || this.options.filter_type == 'choropleth') {\n\n      var self = this;\n\n      // Generate a temp model for the color/file\n      var tempModel = new cdb.core.Model();\n\n      var value  = this.model.get(\"value\") || \"\";\n      var hasURL = value.toString().indexOf(\"http\") !== -1;\n      var color  = hasURL ? \"\" : value;\n      var file   = hasURL ? value : \"\";\n\n      tempModel.set({ color: color, file: file });\n\n      // Bind it to our item\n      tempModel.bind(\"change:color change:file\", function(model) {\n        var changed =  model.changed.color || model.changed.file;\n\n        if (changed) {\n          self.model.set(\"value\", changed);\n        }\n\n      });\n\n      this.colorForm = new cdb.forms.Color({\n        model: tempModel,\n        property: 'color',\n        extra_colors: this.options.extra_colors,\n        extra: {\n          image_property: 'file'\n        }\n      });\n\n    } else {\n      this.colorForm = new cdb.forms.Color({\n        model: this.model,\n        property: 'value',\n        extra_colors: this.options.extra_colors\n      });\n    }\n\n    this.$el.find('span.field').append(this.colorForm.render().el);\n    this.addView(this.colorForm);\n\n  }\n\n});\n\ncdb.admin.mod.LegendEditor = cdb.admin.Module.extend({\n\n    type: 'tool',\n    buttonClass: 'legends_mod',\n    className: 'legends_panel',\n\n    events: {\n      \"click .reset\": \"_onResetClick\"\n    },\n\n    initialize: function() {\n\n      this.template = this.getTemplate('table/menu_modules/legends/views/legends');\n      this.model.bind(\"change:template\", this._onChangeTemplate, this);\n\n      cdb.god.bind(\"end_show\", this._refreshHTMLEditor, this);\n\n    },\n\n    clean: function() {\n      cdb.god.unbind(\"end_show\", this._refreshHTMLEditor, this);\n      cdb.admin.Module.prototype.clean.call(this);\n    },\n\n    getModuleAction: function() {\n      var active_tab = this.legend_panes.activeTab;\n      var action = this._ACTION;\n\n      if (active_tab == \"html\") {\n        action = {\n          type: \"show\",\n          width: 600\n        }\n      }\n\n      return action;\n    },\n\n    _onResetClick: function(e) {\n\n      this.killEvent(e);\n\n      // Restore template_name if exists, reset old_template_name and reset template\n      this.model.set({ template: \"\" });\n      var field = this.legend_panes.getPane(\"fields\");\n\n      if (field.currentLegendPane && field.currentLegendPane.wizardProperties) {\n        var type = field.currentLegendPane.wizardProperties.get('type');\n\n        if (type != \"polygon\") this.model.set({ type: type });\n        else this.model.set({type: \"none\"})\n\n      }\n\n      // Send trigger\n      this.trigger('reset', this);\n\n    },\n\n    _setupLegendPane: function() {\n      this._setupTipsy();\n\n      this.legend_tabs = new cdb.admin.Tabs({\n        el: this.$('.menu ul'),\n        slash: true\n      });\n\n      this.addView(this.legend_tabs);\n\n      this.legend_panes = new cdb.ui.common.TabPane({\n        el: this.$(\".pane\")\n      });\n\n      this.addView(this.legend_panes);\n\n      this.legend_panes.addTab('fields', new cdb.admin.mod.LegendFieldsPane({\n        table: this.options.table,\n        dataLayer: this.options.dataLayer,\n        availableLegends: this.options.availableLegends,\n        model: this.model\n      }));\n\n      this.legend_panes.addTab('html', new cdb.admin.mod.LegendHTMLPane({\n        table: this.options.table,\n        model: this.model\n      }));\n\n      this.legend_tabs.linkToPanel(this.legend_panes);\n\n      var active_tab = 'fields';\n      if (this.model.get('template')) active_tab = 'html';\n\n      this._activePane(active_tab, this.legend_panes.getPane(active_tab));\n      this.legend_panes.active(active_tab);\n      this.legend_tabs.activate(active_tab);\n\n      this.legend_panes.bind('tabEnabled', this._onEnableTab, this);\n    },\n\n    _setupTipsy: function() {\n      var options = {\n        html: true,\n        live: true,\n        fade: true\n      }\n\n      // Tipsy: Toggle fields and titles\n      options.el = this.$(\".menu a[href='#/fields']\");\n      options.gravity = 's'\n      var toggleFieldstooltip = new cdb.common.TipsyTooltip(options)\n      this.addView(toggleFieldstooltip);\n\n      // Tipsy: Change HTML\n      options.el = this.$(\".menu a[href='#/html']\");\n      options.gravity = 'se'\n      var changeHTMLTooltip = new cdb.common.TipsyTooltip(options)\n      this.addView(changeHTMLTooltip);\n    },\n\n    _toggleContent: function() {\n      if (this.model.get(\"template\")) {\n        this.$el.addClass('disabled');\n        this.$(\".blocked\").show();\n      } else {\n        this.$el.removeClass('disabled');\n        this.$(\".blocked\").hide();\n      }\n    },\n\n    _onEnableTab: function(tabName, tabView) {\n      this._activePane(tabName, tabView);\n\n      // Send signal to know that active tab has changed\n      this.triggerModuleAction();\n    },\n\n    _onChangeTemplate: function() {\n      this._activePane(\n        this.legend_panes.activeTab,\n        this.legend_panes.getActivePane()\n      );\n    },\n\n    _activePane: function(tabName, tabView) {\n      $('.tipsy:last').remove();\n\n      if (tabName == 'html') {\n        this.$(\".form_combo\").hide();\n      } else {\n        this.$(\".form_combo\").show();\n      }\n\n      if (tabName == 'fields') {\n        this.$(\".header h3\").text(\"Design\");\n      } else if (tabName == 'html') {\n        this.$(\".header h3\").text(\"Custom HTML\");\n      }\n\n      if (tabName == 'html') {\n        this._refreshHTMLEditor();\n        this.$el.addClass('editing_html editor');\n      } else {\n        this.$el.removeClass('editing_html editor');\n      }\n\n      if (this.model.get('template') && tabName !== 'html') {\n        this.$('.header .blocked').show();\n      } else {\n        this.$('.header .blocked').hide();\n      }\n\n      var horiz_pos = { left: 32, right: 'auto' };\n\n      if (tabName == 'html') horiz_pos = { right:29, left:'auto' };\n\n      this.$(\".menu .tip\").css(horiz_pos);\n    },\n\n    setActiveTab: function(tabName) {\n      this.legend_panes.active(tabName);\n      this.legend_tabs.activate(tabName);\n    },\n\n    _refreshHTMLEditor: function() {\n      if (this.legend_panes && this.legend_panes.activeTab == \"html\") {\n        var pane = this.legend_panes.getPane('html');\n        if (pane && pane.codeEditor) {\n          pane.codeEditor.refresh();\n          pane.adjustCodeEditorSize();\n        }\n      }\n    },\n\n    render: function() {\n      this.clearSubViews();\n      this.$el.html(this.template);\n\n      this._toggleContent();\n      this._setupLegendPane();\n\n      return this;\n    }\n\n});\n\n/**\n * NoneLegend\n */\ncdb.admin.mod.NoneLegend = cdb.core.View.extend({\n\n  _FILTER_NAME: \"none\",\n\n  initialize: function() {\n\n    this._setupTemplates();\n    this.render();\n\n  },\n\n  _setupTemplates: function() {\n\n    this.template           = this.getTemplate('table/menu_modules/legends/views/none_legend_pane');\n\n  },\n\n  _calculateItems: function() {\n\n  },\n\n  refresh: function() {\n\n  },\n\n  render: function() {\n    this.clearSubViews();\n\n    this.$el.html(this.template);\n    this.$el.find(\".no_content\").show();\n\n    return this;\n  }\n\n});\n\n/**\n * CustomLegend\n */\ncdb.admin.mod.CustomLegend = cdb.core.View.extend({\n\n  _FILTER_NAME: \"custom\",\n\n  events: {\n\n    \"click .add\":    \"_addItem\"\n\n  },\n\n  initialize: function() {\n\n    this._setupTemplates();\n    this.wizardProperties = this.options.wizardProperties;\n\n    this.legendItems = [];\n\n    this.items = this.model.items;\n\n  },\n\n  _setupTemplates: function() {\n\n    this.template           = this.getTemplate('table/menu_modules/legends/views/custom_legend_pane');\n    this.item_template_name = 'table/menu_modules/legends/views/custom_legend_item'\n\n  },\n\n  refresh: function() { },\n\n  _calculateItems: function() { },\n\n  _addItem: function(e) {\n\n    e.preventDefault();\n    e.stopPropagation();\n\n    var item = new cdb.geo.ui.LegendItemModel({ name: \"Untitled\", value: \"#cccccc\", sync: true });\n\n    this.items.add(item);\n\n  },\n\n  _renderItems: function() {\n\n    this.legendItems = [];\n\n    if (this.items.length > 0) {\n      this.$el.find(\".no_content\").hide();\n      this.items.each(this._renderItem, this);\n      this.titleEditor.show();\n    } else {\n      this.$el.find(\".no_content\").show();\n      this.titleEditor.hide();\n    }\n\n  },\n\n  _renderItem: function(item) {\n\n    var view = new cdb.admin.mod.LegendEditorItem({\n      model: item,\n      observe: \"name\",\n      filter_type: this._FILTER_NAME,\n      template_name: this.item_template_name,\n      extra_colors: this.options.extra_colors\n    });\n\n    view.bind(\"remove\", this._removeItem, this);\n\n    this.$el.find(\"ul\").append(view.render().$el);\n    this.addView(view);\n    this.legendItems.push(view);\n\n  },\n\n  _removeItem: function(item) {\n    this.items.remove(item.model);\n  },\n\n  render: function() {\n\n    this.clearSubViews();\n\n    this.titleEditor = new cdb.admin.mod.LegendEditorItem({\n      className: \"title\",\n      model: this.model,\n      observe: \"title\",\n      title: \"Title\",\n      maxWidth: 120,\n      showSwitch: true,\n      removable: false,\n      template_name: 'table/menu_modules/legends/views/custom_legend_item'\n    });\n\n    this.$el.html(this.template);\n\n    this.$el.find(\"ul\").append(this.titleEditor.render().$el);\n    this.addView(this.titleEditor);\n\n    this._renderItems();\n\n    return this;\n  }\n\n});\n","/**\n * BubbleLegend\n */\ncdb.admin.mod.BubbleLegend = cdb.admin.mod.CustomLegend.extend({\n\n  _FILTER_NAME: \"bubble\",\n\n  _setupTemplates: function() {\n    this.template = this.getTemplate('table/menu_modules/legends/views/bubble_legend_pane');\n\n    this.itemTemplates = {\n      text: 'table/menu_modules/legends/views/legend_item_text',\n      color: 'table/menu_modules/legends/views/legend_item_color'\n    };\n  },\n\n  _setupSync: function(min, max) {\n    this.leftLabel  = min;\n    this.rightLabel = max;\n\n    this.leftSync  = false;\n    this.rightSync = false;\n\n    if (this.items && this.items.length > 1 && this.items.at(0).get(\"legend_type\") === \"bubble\") {\n      this.leftSync  = this.items.at(0).get('sync');\n      this.rightSync = this.items.at(1).get('sync');\n\n      this.leftLabel  = this.leftSync  ? this.items.at(0).get(\"value\") : this.leftLabel;\n      this.rightLabel = this.rightSync ? this.items.at(1).get(\"value\") : this.rightLabel;\n    }\n  },\n\n  // implements cdb.admin.mod.CustomLegend.prototype._calculateItems\n  _calculateItems: function() {\n    var items = [];\n    var color = this.wizardProperties.get(\"marker-fill\");\n    var metadata = this.wizardProperties.get(\"metadata\");\n\n    if (metadata) {\n      var min = metadata[0];\n      var max = _.last(metadata);\n\n      this._setupSync(min, max);\n\n      items.push(new cdb.geo.ui.LegendItemModel({ legend_type: \"bubble\", name: \"Left label\",  type: \"text\", sync: this.leftSync, value:  this.leftLabel }));\n      items.push(new cdb.geo.ui.LegendItemModel({ legend_type: \"bubble\", name: \"Right Label\", type: \"text\", sync: this.rightSync, value: this.rightLabel }));\n      items.push(new cdb.geo.ui.LegendItemModel({ name: \"Color\", type: \"color\", value: color }));\n\n      this.items.reset(items);\n    }\n  },\n\n  // implements cdb.admin.mod.CustomLegend.prototype._renderItem\n  _renderItem: function(item) {\n    var view = new cdb.admin.mod.LegendEditorItem({\n      model: item,\n      observe: \"value\",\n      showSwitch: true,\n      template_name: this.itemTemplates[item.get(\"type\")],\n      extra_colors: this.options.extra_colors\n    });\n\n    this.$el.find(\"ul\").append(view.render().$el);\n    this.addView(view);\n    this.legendItems.push(view);\n  }\n});\n","/**\n * CategoryLegend\n */\ncdb.admin.mod.CategoryLegend = cdb.admin.mod.CustomLegend.extend({\n\n  _FILTER_NAME: \"category\",\n\n  _setupTemplates: function() {\n    this.template           = this.getTemplate('table/menu_modules/legends/views/category_legend_pane');\n    this.item_template_name = 'table/menu_modules/legends/views/category_legend_item'\n  },\n\n  refresh: function(items) {\n\n    var loaded_items = [];\n\n    this.categories = true;\n\n    _.each(items, function(item) {\n\n      var attr = {\n        name:  item.get(\"name\"),\n        value: item.get(\"color\") || item.get(\"file\") || item.get(\"value\")\n      };\n\n      loaded_items.push(new cdb.geo.ui.LegendItemModel(attr));\n\n    });\n\n    this.items.reset(loaded_items);\n\n  },\n\n  _calculateItems: function() {\n\n    var items = [];\n    this.temp = false;\n\n    this.categories = this.wizardProperties.get('categories');\n    this.colors     = this.wizardProperties.get('colors');\n\n    if (this.colors && this.items && this.items.length > 0) { // colors contain data from the old Wizard, so don't calculate the items\n\n      this.temp = true; // set flag to true to indicate that there are items in the legend\n      this.colors = null;\n\n      return;\n    }\n\n    if (this.categories) {\n\n      _.each(this.categories, function(category) {\n\n        var attr = {\n          name:  category.title,\n          value: category.file || category.color\n        };\n\n        items.push(new cdb.geo.ui.LegendItemModel(attr));\n\n      });\n\n    }\n\n    this.items.reset(items);\n\n  },\n\n  _renderItems: function() {\n\n    if (this.categories || this.temp) {\n      this.$el.find(\".no_content\").hide();\n      this.items.each(this._renderItem, this)\n\n    } else {\n\n      this.$el.find(\".no_content\").show();\n\n    }\n\n  },\n\n  _renderItem: function(item) {\n\n    var view = new cdb.admin.mod.LegendEditorItem({\n      model: item,\n      observe: \"value\",\n      filter_type: this._FILTER_NAME,\n      template_name: this.item_template_name,\n      extra_colors: this.options.extra_colors\n    });\n\n    this.$el.find(\"ul\").append(view.render().$el);\n    this.addView(view);\n    this.legendItems.push(view);\n  }\n\n});\n\n\n","/**\n * ChoroplethLegend\n */\ncdb.admin.mod.ChoroplethLegend = cdb.admin.mod.CustomLegend.extend({\n\n  _FILTER_NAME: \"choropleth\",\n\n  _setupTemplates: function() {\n\n    this.template = this.getTemplate('table/menu_modules/legends/views/choropleth_legend_pane');\n\n    this.item_templates = [];\n    this.item_templates[\"text\"]  = 'table/menu_modules/legends/views/legend_item_text';\n    this.item_templates[\"color\"] = 'table/menu_modules/legends/views/choropleth_legend_item';\n\n  },\n\n  _calculateItems: function() {\n\n    var items = [];\n\n    this.metadata   = this.wizardProperties.get('metadata') || [];\n\n    var methodMap = {\n      '3 Buckets': 3,\n      '5 Buckets': 5,\n      '7 Buckets': 7\n    };\n\n    var nquartiles = methodMap[this.wizardProperties.get('method')];\n    var ramp = cdb.admin.color_ramps[this.wizardProperties.get('color_ramp')][nquartiles];\n\n\n    /* Left label */\n    // If a custom label was previously set, we don't change it\n    var isLeftCustom = this.model.get('items') && this.model.get('items')[0] && this.model.get('items')[0].custom_value;\n    var leftLabelValue  = isLeftCustom ? this.model.get('items')[0].value : parseFloat(this.metadata[0] || 0, 10).toFixed(2);\n    var opts = { type: \"text\",  name: \"Left label\",  value: leftLabelValue };\n    if (isLeftCustom) opts.custom_value = true;\n    items.push(new cdb.geo.ui.LegendItemModel(opts));\n\n    /* Right label */\n    // If a custom label was previously set, we don't change it\n    var isRightCustom = this.model.get('items') && this.model.get('items')[1] && this.model.get('items')[1].custom_value;\n    var rightLabelValue = isRightCustom ? this.model.get('items')[1].value : parseFloat(this.metadata[this.metadata.length - 1] || 0, 10).toFixed(2);\n    var opts = { type: \"text\",  name: \"Right label\", value: rightLabelValue };\n    if (isRightCustom) opts.custom_value = true;\n    items.push(new cdb.geo.ui.LegendItemModel(opts));\n\n    _.each(ramp, function(color) {\n      items.push(new cdb.geo.ui.LegendItemModel({ type: \"color\", name: \"Color\", value: color }));\n    });\n\n    this.items.reset(items);\n\n  },\n\n  _addItem: function(e) {\n\n    e.preventDefault();\n    e.stopPropagation();\n\n    var item = new cdb.geo.ui.LegendItemModel({ type: \"color\", name: \"Color\", value: \"#cccccc\" });\n\n    this.items.add(item);\n\n  },\n\n  _renderItem: function(item) {\n\n    var view = new cdb.admin.mod.LegendEditorItem({\n      model: item,\n      observe: \"value\",\n      removable: true,\n      filter_type: this._FILTER_NAME,\n      template_name: this.item_templates[item.get(\"type\")],\n      extra_colors: this.options.extra_colors\n    });\n\n    view.bind(\"remove\", this._removeItem, this);\n\n    this.$el.find(\"ul\").append(view.render().$el);\n    this.addView(view);\n    this.legendItems.push(view);\n\n  }\n\n});\n","/**\n * ColorLegend\n */\ncdb.admin.mod.ColorLegend = cdb.admin.mod.CustomLegend.extend({\n\n  _FILTER_NAME: \"color\",\n\n  _setupTemplates: function() {\n    this.template           = this.getTemplate('table/menu_modules/legends/views/color_legend_pane');\n    this.item_template_name = 'table/menu_modules/legends/views/color_legend_item'\n  },\n\n  refresh: function(items) {\n\n    var loaded_items = [];\n\n    this.colors = true;\n\n    _.each(items, function(item) {\n      loaded_items.push(new cdb.geo.ui.LegendItemModel({ name: item.get(\"name\"), value: item.get(\"value\") } ));\n    });\n\n    this.items.reset(loaded_items);\n\n  },\n\n  _calculateItems: function() {\n\n    var items = [];\n\n    this.colors = this.wizardProperties.get('colors');\n\n    if (this.colors) {\n\n      _.each(this.colors, function(color) {\n        items.push(new cdb.geo.ui.LegendItemModel({ name: color[0], value: color[1] } ));\n      });\n\n    }\n\n    this.items.reset(items);\n\n\n  },\n\n  _renderItems: function() {\n\n    if (this.colors) {\n      this.$el.find(\".no_content\").hide();\n      this.items.each(this._renderItem, this)\n\n    } else {\n\n      this.$el.find(\".no_content\").show();\n\n    }\n\n  },\n\n  _renderItem: function(item) {\n\n    var view = new cdb.admin.mod.LegendEditorItem({\n      model: item,\n      observe: \"value\",\n      filter_type: this._FILTER_NAME,\n      template_name: this.item_template_name\n    });\n\n    this.$el.find(\"ul\").append(view.render().$el);\n    this.addView(view);\n    this.legendItems.push(view);\n  }\n\n});\n\n","/**\n * DensityLegend\n */\ncdb.admin.mod.DensityLegend = cdb.admin.mod.CustomLegend.extend({\n\n  _FILTER_NAME: \"density\",\n\n  _setupTemplates: function() {\n\n    this.template = this.getTemplate('table/menu_modules/legends/views/density_legend_pane');\n\n    this.item_templates = [];\n    this.item_templates[\"text\"]  = 'table/menu_modules/legends/views/legend_item_text';\n    this.item_templates[\"color\"] = 'table/menu_modules/legends/views/legend_item_color';\n\n  },\n\n  _setupSync: function() {\n\n    this.leftLabel  = \"less\";\n    this.rightLabel = \"more\";\n\n    this.leftSync  = true;\n    this.rightSync = true;\n\n    if (this.items && this.items.length > 1 && this.items.at(0).get(\"legend_type\") == \"density\") {\n\n      this.leftSync  = this.items.at(0).get(\"sync\");\n      this.rightSync = this.items.at(1).get(\"sync\");\n\n      this.leftLabel  = !this.leftSync  ? this.leftLabel  : this.items.at(0).get(\"value\");\n      this.rightLabel = !this.rightSync ? this.rightLabel : this.items.at(1).get(\"value\");\n\n    }\n\n  },\n\n  _calculateItems: function() {\n\n    var items = [];\n\n\n    var methodMap = {\n      '3 Buckets': 3,\n      '5 Buckets': 5,\n      '7 Buckets': 7\n    };\n\n    var nquartiles = methodMap[this.wizardProperties.get('method')];\n    var ramp = cdb.admin.color_ramps[this.wizardProperties.get('color_ramp')][nquartiles];\n\n    this._setupSync();\n\n    items.push(new cdb.geo.ui.LegendItemModel({ legend_type: \"density\", type: \"text\", name: \"Less\", sync: this.leftSync,  value: this.leftLabel }));\n    items.push(new cdb.geo.ui.LegendItemModel({ legend_type: \"density\", type: \"text\", name: \"More\", sync: this.rightSync, value: this.rightLabel }));\n\n    _.each(ramp, function(color) {\n      items.push(new cdb.geo.ui.LegendItemModel({ type: \"color\", name: \"Color\", value: color }));\n    });\n\n    this.items.reset(items);\n\n  },\n\n  _renderItem: function(item) {\n\n    var view = new cdb.admin.mod.LegendEditorItem({\n      model: item,\n      observe: \"value\",\n      showSwitch: true,\n      template_name: this.item_templates[item.get(\"type\")],\n      extra_colors: this.options.extra_colors\n    });\n\n    this.$el.find(\"ul\").append(view.render().$el);\n    this.addView(view);\n    this.legendItems.push(view);\n\n  }\n\n});\n\n\n\n","/**\n * IntensityLegend\n */\ncdb.admin.mod.IntensityLegend = cdb.admin.mod.CustomLegend.extend({\n\n  _FILTER_NAME: \"intensity\",\n\n  _setupTemplates: function() {\n\n    this.template = this.getTemplate('table/menu_modules/legends/views/intensity_legend_pane');\n\n    this.item_templates = [];\n    this.item_templates[\"text\"]  = 'table/menu_modules/legends/views/legend_item_text';\n    this.item_templates[\"color\"] = 'table/menu_modules/legends/views/legend_item_color';\n\n  },\n\n  _setupSync: function() {\n\n    this.leftLabel  = \"Less\";\n    this.rightLabel = \"More\";\n\n    this.leftSync  = true;\n    this.rightSync = true;\n\n    if (this.items && this.items.length > 1 && this.items.at(0).get(\"legend_type\") == \"intensity\") {\n\n      this.leftSync  = this.items.at(0).get(\"sync\");\n      this.rightSync = this.items.at(1).get(\"sync\");\n\n      this.leftLabel  = !this.leftSync  ? this.leftLabel  : this.items.at(0).get(\"value\");\n      this.rightLabel = !this.rightSync ? this.rightLabel : this.items.at(1).get(\"value\");\n\n    }\n\n  },\n\n  _calculateItems: function() {\n\n    var items = [];\n\n    this.color = this.wizardProperties.get(\"marker-fill\");\n\n    this._setupSync();\n\n    items.push(new cdb.geo.ui.LegendItemModel({ legend_type: \"intensity\", type: \"text\",  name: \"Left label\",  sync: this.leftSync, value: this.leftLabel }));\n    items.push(new cdb.geo.ui.LegendItemModel({ legend_type: \"intensity\", type: \"text\",  name: \"Right label\", sync: this.rightSync, value: this.rightLabel }));\n    items.push(new cdb.geo.ui.LegendItemModel({ type: \"color\", name: \"Color\",       value: this.color }));\n\n    this.items.reset(items);\n\n  },\n\n  _renderItem: function(item) {\n\n    var view = new cdb.admin.mod.LegendEditorItem({\n      model: item,\n      observe: \"value\",\n      showSwitch: true,\n      filter_type: \"intensity\",\n      template_name: this.item_templates[item.get(\"type\")],\n      extra_colors: this.options.extra_colors\n    });\n\n    this.$el.find(\"ul\").append(view.render().$el);\n    this.addView(view);\n\n    this.legendItems.push(view);\n\n  }\n\n});\n\n","\n/**\n *  Default legend pane: allows toggling titles\n *\n */\n\ncdb.admin.mod.LegendFieldsPane = cdb.core.View.extend({\n\n  className: \"fieldPane\",\n\n  // types not present here are just the same\n  wizardTypeToLegend: {\n    'torque_cat': 'category'\n  },\n\n  initialize: function() {\n\n    this.template = this.getTemplate(\"table/menu_modules/legends/views/legend_fields_pane\");\n\n    this.dataLayer        = this.options.dataLayer;\n    this.availableLegends = this.options.availableLegends;\n\n    this._setupModel();\n    this._setupPanes();\n    this._setupBindings();\n    this._setupStorage();\n\n    this.render();\n\n  },\n\n  _setupModel: function() {\n    this.add_related_model(this.model);\n  },\n\n  _setupPanes: function() {\n\n    if (this.panes) this.panes.clean();\n\n    this.panes = new cdb.ui.common.TabPane({\n      activateOnClick: true\n    });\n\n    this.addView(this.panes);\n\n  },\n\n  _setupBindings: function() {\n\n    var self = this;\n\n    this.add_related_model(this.dataLayer);\n\n    this.dataLayer.wizard_properties.bind(\"change\", this._onWizardChange, this);\n    this.dataLayer.bind(\"change:tile_style\", this._onStyleChange, this);\n\n    this.add_related_model(this.dataLayer.wizard_properties);\n\n    this.model.bind(\"change:template\", this._toggleContent, this);\n\n    this.model.bind(\"change:items\", function() {\n      self._saveState();\n      self.currentLegendPane.render();\n    }, this);\n\n  },\n\n  /**\n   * Stores the state of the custom legend pane\n   */\n  _saveState: function() {\n\n    if (this.model.get(\"type\") == 'custom') {\n      this._saveItems();\n    }\n\n  },\n\n  /**\n   * Setup for the local storage\n   */\n  _setupStorage: function() {\n    version = \"_3.0\";\n    this.storageKey = this.dataLayer.get(\"table_name\") + version;\n    this.savedItems = new cdb.admin.localStorage(this.storageKey);\n  },\n\n  /**\n   * Makes a copy of the item collection\n   */\n  _saveItems: function() {\n    this.savedItems.set(this.model.get(\"items\"));\n  },\n\n  /**\n   * Retrieves the stored items\n   */\n  _getSavedItems: function() {\n    return this.savedItems.get();\n  },\n\n  /**\n   * Replace the current items with the stored ones\n   */\n  _loadSavedItems: function() {\n    var items = this.savedItems.get();\n\n    if (items) {\n      this.model.items.reset(items);\n    }\n  },\n\n  _enableLegend: function(name) {\n\n    var enabledLegends  = [\"none\", \"custom\", name];\n\n    _.each(this.availableLegends, function(legend) {\n      legend.enabled = _.contains(enabledLegends, legend.name) ? true : false;\n    });\n\n  },\n\n  _getLegendType: function() {\n    var t = this.dataLayer.wizard_properties.get('type');\n    if (this.wizardTypeToLegend[t]) {\n      t = this.wizardTypeToLegend[t];\n    }\n    return t;\n  },\n\n  _enableLegendFromWizard: function() {\n    var t = this._getLegendType();\n    if (t) {\n      this._enableLegend(t);\n    }\n  },\n\n  /**\n   * Replace the current items with the stored ones\n   */\n  _loadTab: function(type, old_type) {\n\n    this._activatePane(type);\n\n    this.currentLegendPane.wizardProperties = this.dataLayer.wizard_properties;\n\n    // If we're loading the custom legend, we need to load the saved items\n    // (except if we come from a category legend… in that case, we don't\n    // do anything)\n\n    if (type === 'custom' && old_type !== 'category') {\n\n      this._loadSavedItems();\n\n    }\n    else if (type !== 'custom') {\n\n      this.currentLegendPane._calculateItems();\n\n    }\n\n    this._changeColors();\n    this.currentLegendPane.render();\n\n  },\n\n  _activatePane: function(name) {\n\n    this.panes.active(name);\n    this.currentLegendPane = this.panes.getActivePane();\n\n  },\n\n  _reloadActiveTab: function() {\n\n    var name = this.model.get(\"type\") || \"none\";\n\n    this._activatePane(name);\n\n    if (name && this.currentLegendPane && this.currentLegendPane.model.get(\"type\")) {\n\n      this.currentLegendPane.render();\n      this.currentLegendPane.refresh(this.model.items.models);\n\n      this._enableLegendFromWizard();\n\n    }\n\n  },\n\n  _onWizardChange: function(m) {\n\n    var wizardProperties = m.attributes;\n    var previousWizardProperties = m.previousAttributes();\n\n    var currentType  = m.get(\"type\");\n    var previousType = previousWizardProperties.type;\n\n    var metadataDiff = _(wizardProperties.metadata).difference(previousWizardProperties.metadata)\n\n    // Don't change the legend if we chose the customized one\n    if (this.model.get(\"type\") === 'custom') {\n      var type = this._getLegendType();\n\n\n      this._enableLegend(type);\n      this._refreshTemplateCombo();\n\n      return;\n    }\n\n    // Let's check what has changed and decide if we want to update the legend or not\n    if (currentType === previousType) {\n      var currentProperty  = m.get('property');\n      var previousProperty = previousWizardProperties.property;\n      var equalProperty = currentProperty == previousProperty;\n\n      if (this.model.get(\"type\") === 'custom') {\n        return;\n      } else if (currentType === 'category') {\n        var difference = _.difference(m.get('categories'), previousWizardProperties.categories);\n        if (equalProperty && (!difference || (difference && difference.length === 0))) {\n          return;\n        }\n      } else if (currentType === 'bubble') {\n\n        var equalMarkerFill = (m.get(\"marker-fill\") == previousWizardProperties[\"marker-fill\"]);\n        var equalRadiusMin  = (m.get(\"radius_min\")  == previousWizardProperties[\"radius_min\"]);\n        var equalRadiusMax  = (m.get(\"radius_max\")  == previousWizardProperties[\"radius_max\"]);\n\n        if (equalProperty && equalMarkerFill && equalRadiusMin && equalRadiusMax && metadataDiff.length === 0) {\n          return;\n        }\n\n      } else if (currentType === 'intensity') {\n        if (m.get(\"marker-fill\") == previousWizardProperties[\"marker-fill\"]) {\n          return;\n        }\n      } else if (currentType === 'density' || currentType === 'choropleth') {\n\n        var equalColorRamp = (m.get(\"color_ramp\") === previousWizardProperties[\"color_ramp\"]);\n        var equalMethod    = (m.get(\"method\") === previousWizardProperties[\"method\"]);\n\n        var condition = equalColorRamp && equalMethod;\n\n        if (condition && (currentType === \"density\" || currentType === 'choropleth' && metadataDiff.length === 0)) {\n          return;\n        }\n      }\n    }\n\n    var type = this._getLegendType();\n\n    if (type === \"polygon\" && this.model.get(\"type\") === \"custom\") {\n      return;\n    } else if (!_.contains(this._getPanes(), type)) {\n      type = \"none\";\n    }\n\n    this._enableLegend(type);\n    this._refreshTemplateCombo();\n\n    if (!this.model.get(\"template\")) {\n\n      var opt = { template: \"\", type: type };\n\n      // check validity of legend\n      if (this._getNumericColumns().length == 0 && (type == \"choropleth\" || type == \"bubble\")) {\n        var opt = { items: \"\", template: \"\", type: \"none\" };\n      }\n\n      this.model.set(opt);\n\n    }\n\n    this._loadTab(type);\n\n  },\n\n  _getNumericColumns: function() {\n    var table = this.dataLayer.table;\n    return _.filter(table.columnNamesByType('number'), function(c) {\n      return c != \"cartodb_id\"\n    });\n  },\n\n  _getPanes: function() {\n    var legends = this.availableLegends;\n    return _.pluck(legends, 'name');\n  },\n\n  _getEnabledPanes: function() {\n    var legends = _.filter(this.availableLegends, function(legend) {\n      return legend[\"enabled\"];\n    });\n\n    return _.pluck(legends, 'name');\n  },\n\n  _refreshTemplateCombo: function() {\n    var legends = this._getEnabledPanes();\n    this.templates.updateData(legends);\n  },\n\n  _renderTemplateCombo: function() {\n\n    var legends = this._getEnabledPanes();\n\n    if (this.templates) this.templates.clean();\n\n    this.templates = new cdb.forms.Combo({\n      property: 'type',\n      extra: legends,\n      model: this.model\n    });\n\n    this.model.unbind(\"change:type\", this);\n    this.model.bind(\"change:type\", function(model, value) {\n\n      var type     = model.get(\"type\");\n      var old_type = model.previous(\"type\");\n\n      this._loadTab(type, old_type);\n\n    }, this);\n\n    var $f = this.$('.fields');\n    var li = $('<li>');\n\n    li\n    .append(this.templates.render().el)\n    .append('<span>Template</span>');\n\n    $f.append(li);\n\n    this.addView(this.templates);\n  },\n\n\n  _getCartoColors: function() {\n\n    var style = this.options.dataLayer.get(\"tile_style\");\n\n    var cartoParser = new cdb.admin.CartoParser(style);\n    var colors = cartoParser.colorsUsed( { mode: \"hex\" });\n\n    colors = _.uniq(colors); // remove duplicated\n    colors = _.without(colors, \"white\", \"WHITE\", \"#fff\", \"#ffffff\", \"#FFF\", \"#FFFFFF\"); // remove white\n    colors = _.without(colors, \"black\", \"BLACK\", \"#000\", \"#000000\"); // remove black\n\n    return colors;\n\n  },\n\n  _changeColors: function() {\n\n    var colors = this._getCartoColors();\n    var tab    = this.panes.getActivePane();\n\n    if (tab && tab.legendItems){\n      tab.options.extra_colors = colors;\n      _.each(tab.legendItems, function(item) {\n        if (item.colorForm) {\n          item.colorForm.setExtraColors(colors);\n        }\n      });\n    }\n  },\n\n  _onStyleChange: function() {\n    this._changeColors();\n  },\n\n  _capitalize: function(string) {\n    return string.charAt(0).toUpperCase() + string.slice(1);\n  },\n\n  _getExtraLegendNames: function() {\n\n    var type = this.dataLayer.wizard_properties.get(\"type\");\n\n    if (type) {\n      return _.intersection(this.options.extraLegends, [type]);\n    } else {\n      return null;\n    }\n\n  },\n\n  /* Render panes */\n  _renderPanes: function() {\n\n    this.clearSubViews();\n\n    _.each(_.pluck(this.availableLegends, \"name\"), this._renderPane, this);\n\n  },\n\n  _renderPane: function(name) {\n    if (this.wizardTypeToLegend[name]) {\n      name = this.wizardTypeToLegend[name];\n    }\n\n    var legendClass = this._capitalize(name + \"Legend\");\n\n    var tab = new cdb.admin.mod[legendClass]({\n      model: this.model,\n      table_id: this.options.dataLayer.get(\"id\"),\n      wizardProperties: this.dataLayer.wizard_properties\n    });\n\n    this.panes.addTab(name, tab);\n    tab.$el.addClass(name);\n\n  },\n\n  render: function() {\n\n    this.clearSubViews();\n    this.$el.html(this.template);\n    this.panes.setElement(this.$('.forms'));\n\n    this._renderPanes();\n    this._reloadActiveTab();\n\n    this._enableLegendFromWizard();\n\n    this._renderTemplateCombo();\n    this._toggleContent();\n\n    if (this.currentLegendPane)\n      this.currentLegendPane.render();\n\n    this._changeColors();\n\n    return this;\n  },\n\n  _toggleContent: function() {\n    if (this.model.get(\"template\")) {\n      this.$el.addClass('disabled');\n      this.$(\".blocked\").show();\n    } else {\n      this.$el.removeClass('disabled');\n      this.$(\".blocked\").hide();\n    }\n  },\n\n  _showNoContent: function() {\n    this.$('.no_content').show();\n    this.$('div.all').hide();\n  }\n\n});\n","\n  /**\n   *  Legend HTML editor pane\n   *\n   */\n\n  cdb.admin.mod.LegendHTMLPane = cdb.core.View.extend({\n\n    _STORAGE_NAMESPACE: \"cdb.localStorage.legend.\",\n\n    _TEXTS: {\n      tip:            _t('&lt;script&gt; tags could break your map.'),\n      template_error: _t('Error in line {{line}}: {{msg}}')\n    },\n\n    className: \"htmlPane\",\n\n    events: {\n      'click .apply': '_apply'\n    },\n\n    initialize: function() {\n      _.bindAll(this, '_onKeyUpEditor');\n\n      this.template = this.getTemplate(\"table/menu_modules/legends/views/legend_html_pane\");\n\n      this.render();\n\n      this.model.bind(\"change:type\",  this._setContent,   this);\n      this.model.bind(\"change:items\", this._resetContent, this);\n      this.model.bind(\"change:title change:show_title\", this._resetContent, this);\n    },\n\n    render: function() {\n      this.clearSubViews();\n      this.$el.html(this.template);\n\n      // Init codemirror editor\n      this._initEditor();\n      // Init help tip\n      this._initHelp();\n\n      return this;\n    },\n\n    _initHelp: function() {\n      this.help = new cdb.admin.mod.HTMLEditorHelp({\n        text: this._TEXTS.tip,\n        localStorageKey: this._STORAGE_NAMESPACE\n      }).bind(\"hide show\", this.adjustCodeEditorSize, this);\n\n      this.$el.append(this.help.render().$el);\n\n      this.addView(this.help);\n    },\n\n    _initEditor: function() {\n      var self = this;\n\n      this.codeEditor = CodeMirror.fromTextArea(this.$('textarea')[0], {\n        mode: \"text/xml\",\n        tabMode: \"indent\",\n        tabSize: 2,\n        matchBrackets: true,\n        lineNumbers: true,\n        lineWrapping: true,\n        onKeyEvent: this._onKeyUpEditor,\n        extraKeys: {\n          \"Ctrl-Space\": function(cm) { self._showAutocomplete(cm) }\n        }\n      });\n\n      // Set user keymap\n      this._setKeymap();\n\n      // Set value\n      this._setContent();\n    },\n\n    _showAutocomplete: function(cm) {\n      CodeMirror.showHint(cm, CodeMirror.hint['custom-list'], {\n        completeSingle: false,\n        list: _.map(this.model.get('items'), function(obj) { return obj.value })\n      });\n    },\n\n    _onKeyUpEditor: function(cm, e) {\n      var code = (e.keyCode ? e.keyCode : e.which);\n\n      if (e.type == \"keyup\" && code != 27 ) {\n        var self = this;\n\n        if (this.autocomplete_timeout) clearTimeout(this.autocomplete_timeout);\n\n        this.autocomplete_timeout = setTimeout(function() {\n          var cur = cm.getCursor();\n          var str = cm.getTokenAt(cur).string;\n\n          if (str.length > 2) {\n            var list = _.compact(_.map(self.model.get('items'), function(obj) {\n              if (obj && obj.value)\n                return obj.value;\n              return null;\n            }));\n\n            if (!cm.state.completionActive && str.length > 2 && list.length > 0) {\n              self._showAutocomplete(cm)\n            }\n          }\n\n        }, 150);\n      }\n    },\n\n    _setKeymap: function() {\n      // Codemirror extrakey\n      // Add save keymap\n      // PC & LINUX -> Ctrl + s\n      // MAC        -> Cmd + s\n      var ua      = navigator.userAgent.toLowerCase();\n      var self    = this;\n      this.keymap = {\n        so: \"rest\",\n        combination: \"ctrl+s\"\n      }\n\n      if (/mac os/.test(ua)) {\n        this.keymap = {\n          so: \"mac\",\n          combination: \"meta+s\"\n        }\n      }\n\n      this.$('textarea').bind('keydown', this.keymap.combination, function(e) {\n        if (((self.keymap.so==\"mac\" && e.metaKey) || (self.keymap.so==\"rest\" && e.ctrlKey)) && e.keyCode == 83 ) {\n          e.preventDefault();\n          self._apply();\n        }\n      });\n    },\n\n    _setContent: function() {\n      var html_value = this.model.get(\"template\") || this._getTemplateContent();\n      html_value = html_value.replace(/<li(.*?)>/g, \"\\n\\t<li$1>\\n\");\n      html_value = html_value.replace(/<\\/li>/g, \"\\n\\t</li>\");\n      html_value = html_value.replace(/<ul>/g, \"\\n<ul>\");\n      html_value = html_value.replace(/<\\/ul>/g, \"\\n</ul>\\n\");\n      this.codeEditor.setValue(html_value);\n      this._clearErrors();\n    },\n\n    _resetContent: function() {\n      // If custom html is not set\n      if (!this.model.get('template')) {\n        this._setContent();\n      }\n    },\n\n    _capitalize: function(string) {\n      if (string && _.isString(string)) {\n        return string.charAt(0).toUpperCase() + string.slice(1);\n      }\n      return \"\";\n    },\n\n    _getTemplateContent: function() {\n\n      var type = this.model.get(\"type\");\n      var legend_name = this._capitalize(type) + \"Legend\";\n\n      if (!type || type == \"none\") return \"\";\n\n      if (!cdb.geo.ui[legend_name]) return \"\";\n\n      var view = new cdb.geo.ui[legend_name]({\n        model: this.model\n      });\n\n      return \"<div class='cartodb-legend \" + this.model.get(\"type\") + \"'>\\t\" + view.render().$el.html() + \"</div>\"\n\n    },\n\n    _toggleContent: function() {},\n\n    _getErrors: function() {\n      try {\n        var temp = cdb.core.Template.compile(this.codeEditor.getValue(), \"mustache\")()\n        return {};\n      } catch (e) {\n        return e;\n      }\n    },\n\n    _parseErrors: function(errors) {\n      // Generate and manage error\n      var error_text =  \"an error\"; // Enable this feature if it is needed\n\n      // Add error text\n      this.$('.info')\n        .addClass('error')\n        .html(\"<p>\" + error_text + \"</p>\")\n        .show();\n\n      this.adjustCodeEditorSize();\n    },\n\n    _clearErrors: function() {\n      // Remove error text and hide it\n      this.$('.info')\n        .removeClass('error')\n        .html('')\n        .hide();\n\n      this.adjustCodeEditorSize();\n    },\n\n    adjustCodeEditorSize: function() {\n      // Fit editor with the error\n      var info_h = this.$('.info').is(':visible') ? this.$('.info').outerHeight() : 0;\n      var help_h = this.$('.help-tip').is(':visible') ? this.$('.help-tip').outerHeight() : 0;\n\n      this.$('.CodeMirror-wrap').css({\n        bottom: info_h + 80, /* the space we need to show the action buttons */\n        top: help_h + (-5)\n      });\n    },\n\n    _onSQLApplied: function() {\n      if (this.model.get('template')) {\n        this._apply();\n      }\n    },\n\n    _apply: function(e) {\n      if (e && e.preventDefault) e.preventDefault();\n\n      // Prevent setting the template value again\n      this.model.unbind(\"change:template\", this._setContent, this);\n\n      // Set all fields + new custom template\n      this.model.set({\n        template: this.codeEditor.getValue()\n      });\n\n      // Binding again the template change in the model :)\n      this.model.bind(\"change:template\", this._setContent, this);\n\n      if (!this.model.get(\"template\")) this.model.set(\"template\", this._getTemplateContent())\n    },\n\n    clean: function() {\n      this.$('textarea').unbind('keydown', null, null);\n      cdb.core.View.prototype.clean.call(this);\n    }\n\n  });\n","/**\n * menu bar sql module\n * this module is used to perform custom SQL queries on the table (and the map)\n */\n\ncdb.admin.mod = cdb.admin.mod || {};\n\ncdb.admin.mod.SQL = cdb.admin.Module.extend({\n\n    _TEXTS: {\n      tip: '<strong>Ctrl + SPACE</strong> to autocomplete. <strong><%- key %> + S</strong> to apply your query.'\n    },\n\n    _ACTION: {\n      type: 'show',\n      width: 600\n    },\n\n    buttonClass: 'sql_mod',\n    type: 'tool',\n    className: \"sql_panel\",\n\n    events: {\n      'click .actions a.clearview': '_clearView',\n      'click .actions button':      'applyQuery',\n      'click .actions a.next':      '_do',\n      'click .actions a.back':      '_undo',\n      'click .doc_info':            '_showDoc'\n    },\n\n    initialize: function() {\n      _.bindAll(this, '_onKeyUpEditor');\n\n      var self = this;\n      this.user = this.options.user;\n      this.template = this.getTemplate('table/menu_modules/views/sql');\n\n      this.model.bind('change:table_name',      this._replaceSQL,       this);\n      this.model.bind('change:query',           this._updateSQL,        this);\n      this.model.bind('change:query_generated', this._updateQueryInfo,  this);\n      this.model.bind('errorSQLView',           this._onSQLError,       this);\n\n      // Set query position from history array and last sql applied\n      var history = this.model.get('query_history')\n        , position = this.model.query_history_position\n        , sql =  this.model.get('query') || this._defaultSQL();\n\n      this.model.query_history_position = _.indexOf(history, sql) || 0;\n      this.add_related_model(this.model);\n\n      this._initBinds();\n\n      // table list will be needed probably\n      this.user.fetchTables();\n\n      cdb.god.bind('end_show', this.activated, this)\n      this.add_related_model(cdb.god);\n    },\n\n    render: function() {\n      var self = this;\n      this.clearSubViews();\n\n      this.$el.append(this.template({}));\n\n      this._initEditor();\n      this._initHelp();\n\n      this._updateSQL();\n      this._updateQueryInfo();\n      this._adjustCodeEditorSize();\n\n      return this;\n    },\n\n    _initBinds: function() {\n       // Codemirror extrakey\n      // Add save keymap\n      // PC & LINUX -> Ctrl + s\n      // MAC        -> Cmd + s\n      var ua      = navigator.userAgent.toLowerCase()\n        , so      = \"rest\"\n        , keymap  = \"ctrl+s\"\n        , self    = this;\n\n      if (/mac os/.test(ua)) {\n        keymap = \"meta+s\";\n        so = \"mac\";\n      }\n\n      this.$el.bind('keydown', keymap, function(ev) {\n        if (((so==\"mac\" && ev.metaKey) || (so==\"rest\" && ev.ctrlKey)) && ev.keyCode == 83 ) {\n          ev.preventDefault();\n          self.applyQuery();\n        }\n      });\n    },\n\n    _initEditor: function() {\n      var self = this;\n      this.codeEditor = CodeMirror.fromTextArea(this.$('textarea')[0], {\n        mode: \"text/x-postgres\",\n        tabMode: \"indent\",\n        matchBrackets: true,\n        lineNumbers: true,\n        lineWrapping: true,\n        onKeyEvent: this._onKeyUpEditor,\n        extraKeys: {\n          \"Ctrl-Space\": function(cm) { self._showAutocomplete(cm) }\n        }\n      });\n      this.$('textarea').bind('keyup', this._checkSubmit.bind(this))\n\n      // Add tooltip for undo/redo buttons\n      this.$(\"a.next, a.back\").tipsy({\n        gravity: \"s\",\n        fade: true\n      });\n    },\n\n    _initHelp: function() {\n      var so = \"rest\";\n      var ua = navigator.userAgent.toLowerCase();\n\n      if (/mac os/.test(ua)) {\n        so = \"mac\";\n      }\n\n      var help = new cdb.admin.mod.HTMLEditorHelp({\n        localStorageKey: this._STORAGE_NAMESPACE + this.model.table.get('id'),\n        text: _.template(this._TEXTS.tip)({ key: (so == \"mac\") ? \"CMD\" : \"Ctrl\" })\n      }).bind(\"hide show\", this._adjustCodeEditorSize, this);\n      this.$el.append(help.render().$el);\n      this.addView(help);\n    },\n\n    activated: function() {\n      if(this.codeEditor) {\n        this.codeEditor.refresh();\n        this.codeEditor.focus();\n        this._adjustCodeEditorSize();\n      }\n    },\n\n    _defaultSQL: function() {\n      return 'SELECT * FROM ' + cdb.Utils.safeTableNameQuoting(this.model.get('table_name'));\n    },\n\n    /**\n     *  Set default SQL when table has been renamed\n     *  and a query is not set.\n     *  If a query is set, backend will return new\n     *  query with table_name properly changed.\n     */\n    _replaceSQL: function() {\n      if (!this.model.get('query')) {\n        this.codeEditor.setValue(this._defaultSQL());\n      }\n    },\n\n    _onSQLError: function(resp) {\n      try {\n        var errors = JSON.parse(resp.responseText);\n        // sql api returns error and rails api return errors\n        // so support both until rails api is removed\n        this._parseError(errors.errors || errors.error);\n      } catch(exp) {\n        this._parseError([_t('unknown error')]);\n      }\n      this._toggleClearView(\"error\");\n    },\n\n    _updateSQL: function() {\n      // Send clear error event to clear the error icon if there was any\n      this.trigger('clearError');\n\n      if (this.codeEditor) {\n        this._clearErrors();\n\n        // Set new query value and refresh the editor\n        // if it is different than the editor value\n        var query         = this.model.get('query')// || this._defaultSQL()\n          , editor_query  = this.codeEditor.getValue();\n\n        // when there is no editor query, set query to default to be changed\n        // in the editor\n        // if the editor query is set, leave query untouched, this allows\n        // update and delete queries be kept after press apply query\n        var keepSql = false;\n        if(editor_query && cdb.admin.CartoDBTableMetadata.alterTable(editor_query)) {\n          keepSql = true;\n        }\n\n        if(!keepSql) {\n          this.codeEditor.setValue(this.model.get('query') || this._defaultSQL());\n          this.codeEditor.refresh();\n        }\n\n        // Check buttons\n        if (this.model.get('query_history'))\n          this._checkDoButtons();\n      }\n\n      // Show or not the sql-window \"clear view\" button\n      this._toggleClearView(this.model.get(\"query\"));\n    },\n\n    _toggleClearView: function(query) {\n      if (!query) {\n        this.$el.find(\"a.clearview\").hide();\n      } else {\n        this.$el.find(\"a.clearview\").show();\n      }\n    },\n\n    _clearView: function(e) {\n      e.preventDefault();\n      this.model.clearSQLView();\n      return false;\n    },\n\n    _onKeyUpEditor: function(cm, e) {\n      var code = (e.keyCode ? e.keyCode : e.which);\n\n      if (e.type == \"keyup\" && code != 27 ) {\n        var self = this;\n\n        if (this.autocomplete_timeout) clearTimeout(this.autocomplete_timeout);\n\n        this.autocomplete_timeout = setTimeout(function() {\n          var cur = cm.getCursor();\n          var str = cm.getTokenAt(cur).string;\n          var schema = self.model.table.get('schema');\n\n          if (schema && str.length > 2) {\n            var arr = _.union(self.model.table.get('schema'), self._getTableName());\n            var list = _.compact(_.map(arr, function(pair) {\n\n              // Problems parsing SQL sentences causing this\n              //  - First problem detected with '\\', escaping\n              //    anything in the query.\n              try {\n                if ((pair.length > 0) && (pair[0].search(str) != -1))\n                  return pair[0];\n                return null;\n              } catch(e) {\n                return null\n              }\n\n            }));\n\n            if (!cm.state.completionActive && str.length > 2 && list.length > 0) {\n              self._showAutocomplete(cm)\n            }\n          }\n\n        }, 150);\n      }\n    },\n\n    _showAutocomplete: function(cm) {\n      CodeMirror.showHint(cm, CodeMirror.hint['custom-list-with-type'], {\n        completeSingle: false,\n        list: _.union( this._getTableName(), this._getSQLColumns())\n      });\n    },\n\n    _getTableName: function() {\n      return [ [ this.model.table.get('name'), \"T\" ] ]\n    },\n\n    _getSQLColumns: function() {\n      return _.map(\n        _.union(\n          this.model.table.get('schema'),\n          [['the_geom_webmercator',0]]\n        ), function(pair) {\n          // Column name and type\n          return [pair[0], \"C\"]\n        });\n    },\n\n    _checkSubmit: function(ev) {\n      if(ev.shiftKey && ev.keyCode === 13) {\n        this.killEvent(ev);\n        this.applyQuery();\n      }\n    },\n\n    _parseError: function(errors) {\n      // Get actions block height\n      var actions_h = this.$('.actions').outerHeight();\n\n      // Add error text\n      this.$('.info')\n        .addClass('error')\n        .html(\"<p>\" + errors.join('<br/>') + \"</p>\")\n        // If layer is not visible, we need to move error message\n        .css({\n          bottom: actions_h + (!this.model.get('visible') ? 57 : 0)\n        })\n        .show();\n\n      // Fit editor with the error\n      this._adjustCodeEditorSize();\n    },\n\n    _adjustCodeEditorSize: function() {\n      // Fit editor with the error\n      var info_h = this.$('.info').is(':visible') ? this.$('.info').outerHeight() : 0;\n      var help_h = this.$('.help-tip').is(':visible') ? 36 : 0 ;\n      // If layer is not visible, we need to take into account\n      var vis_msg_h = !this.model.get('visible') ? 57 : 0 ;\n\n      this.$('.CodeMirror-wrap').css({\n        bottom: info_h + vis_msg_h + 80, /* the space we need to show the action buttons */\n        top: help_h\n      });\n    },\n\n    _updateQueryInfo: function() {\n      if(this.model.get('query_generated')) {\n        this.$('.info').removeClass('error');\n          /*.html('<p>' + _t('This query is wrapped in order to generate the current visualizacion so some queries may not work.') + '</p>')\n          .show();*/\n      } else {\n        this.$('.info').hide();\n      }\n    },\n\n    _clearErrors: function() {\n      // Remove error text and hide it\n      this.$('.info')\n        .removeClass('error')\n        .html('')\n        .hide();\n      this._adjustCodeEditorSize();\n    },\n\n    _do: function(e) {\n      e.preventDefault();\n      var newQuery = this.model.redoHistory('query');\n      if (this.codeEditor && newQuery) {\n        this.codeEditor.setValue(newQuery);\n        this._checkDoButtons();\n      }\n      return false;\n    },\n\n    _undo: function(e) {\n      e.preventDefault();\n      var newQuery = this.model.undoHistory('query');\n      if (this.codeEditor && newQuery) {\n        this.codeEditor.setValue(newQuery);\n        this._checkDoButtons();\n      }\n      return false;\n    },\n\n    applyQuery: function() {\n      var self = this;\n      this._clearErrors();\n\n      var sql = this.codeEditor.getValue();\n\n      sql = sql\n        // replace {table_name}\n        .replace(/{table_name}/g, this.model.table.get('name'))\n        // replace/remove ; character\n        .replace(/;\\s*$/g, '');\n\n      if (this.user.isInsideOrg()) {\n        sql = this.qualifyTables(sql);\n      }\n\n      this.model.applySQLView(sql);\n\n      // Event tracking \"Performed a query\"\n      cdb.god.trigger('metrics', 'query', {\n        email: window.user_data.email\n      });\n\n      return false;\n    },\n\n    // transform from select * from table to\n    // select * from user.table\n    qualifyTables: function(sql) {\n      var username = this.user.get('username');\n      return _.reduce(this.user.tables, function(sql, t) {\n        var re = new RegExp(\"([^\\\\.\\\\'a-zA-Z0-9\\_])(\\\"?)\" + t + \"(\\\"?)\", \"gi\");\n        var replace_str;\n        if (username.indexOf('-') !== -1) {\n          replace_str = \"$1\\\"\" + username + \"\\\".$2\" + t + \"$3\";\n        } else {\n          replace_str = \"$1\" + username + \".$2\" + t + \"$3\";\n        }\n        return sql.replace(re,  replace_str);\n      }, sql);\n    },\n\n    /**\n     * Check if the sql has changed from its saved value\n     * @return {Boolean}\n     */\n    hasChanges: function() {\n      return this.model.get('query') != this.codeEditor.getValue();\n    },\n\n    _checkDoButtons: function() {\n      // Redo\n      if (!this.model.isHistoryAtLastPosition('query')) {\n        this.$el.find('a.next').removeClass(\"disabled\")\n      } else {\n        this.$el.find('a.next').addClass(\"disabled\")\n      }\n      // Undo\n      if (!this.model.isHistoryAtFirstPosition('query')) {\n        this.$el.find('a.back').removeClass(\"disabled\")\n      } else {\n        this.$el.find('a.back').addClass(\"disabled\")\n      }\n    },\n\n    _showDoc: function(ev) {\n      ev.preventDefault();\n      cdb.editor.ViewFactory.createDialogByTemplate('common/dialogs/help/postgres_sql').appendToBody();\n    }\n\n});\n","/**\n* BubbleWizard\n*/\ncdb.admin.mod.BubbleWizard = cdb.admin.mod.SimpleWizard.extend({\n\n  //TODO: put this in a template\n  error_msg: {\n    NO_CONTENT_MSG: _t('There are no numeric columns on your dataset to make a bubble map.<br/>If you have numbers on your dataset, but you don\\'t see them here is likely they are set as String.')\n  },\n\n  initialize: function() {\n    this.type = 'bubble';\n    cdb.admin.mod.SimpleWizard.prototype.initialize.call(this);\n  },\n\n  isValid: function() {\n    return this._getNumberColumns().length > 0;\n  },\n\n  render: function() {\n    if(this.isValid()) {\n      cdb.admin.mod.SimpleWizard.prototype.render.call(this);\n    } else {\n      this.renderError(this.error_msg.NO_CONTENT_MSG);\n    }\n    return this;\n  }\n\n});\n\n\n","\n  /**\n   *  Category wizard, it extends from color map wizard\n   *\n   *  - It creates a collection (cartoProperties.categories) from the beginning.\n   *  - This collection has the custom values of each column, if they\n   *  were previously set.\n   *  - When cartoProperties are set, collection is reset and view is re-rendered.\n   *  - Collection view and subviews are at the end of this file.\n   *\n   *  var category_wizard = new cdb.admin.mod.CategoryWizard({\n   *    table: table,\n   *    model: model\n   *  });\n   *\n   */\n  cdb.admin.mod.CategoryWizard = cdb.admin.mod.SimpleWizard.extend({\n\n    _TEXTS: {\n      default_color:    _t('Others'),\n      select_column:    _t('Select a column'),\n      no_valid_columns: _t('There are no valid columns on your table to make a this visualization. \\\n                            Try to add a new one or change the existing ones to a valid type \\\n                            (string, number or boolean).')\n    },\n\n    initialize: function() {\n      var self = this;\n      this.type = this.type || 'category';\n      cdb.admin.mod.SimpleWizard.prototype.initialize.call(this);\n      this.table = this.options.table;\n      this.categories = new Backbone.Collection(this.cartoProperties.get('categories'));\n\n      this.cartoProperties.bind('change:metadata', this._getMetadata, this);\n      this.categories.bind('change reset', function() {\n        this.cartoProperties.set('categories', this.categories.toJSON());\n      }, this);\n\n      this.cartoProperties.bind('load', this._hideLoader, this);\n      this.cartoProperties.bind('loading', this._showLoader, this);\n\n      this.add_related_model(this.categories);\n\n      this._addViews();\n    },\n\n    _showLoader: function() {\n      this.loader.show();\n    },\n\n    _hideLoader: function() {\n      this.loader.hide();\n    },\n\n    render: function() {\n      var $wrapper = $(\"<div>\").addClass(\"wrapper\")\n      , $content = $(\"<div>\").addClass(\"content\");\n\n      if (this.isValid()) {\n        $content.append(this.form.render().el);\n        $content.append(this.custom_categories.render().el);\n        $content.append(this.error.render().el);\n        $content.append(this.loader.render().el);\n\n        $wrapper.append($content);\n\n        // Remove old custom scroll\n        if (this.custom_scroll) {\n          this.removeView(this.custom_scroll);\n          this.custom_scroll.clean();\n        }\n\n        // Add new custom scroll\n        this.custom_scroll = new cdb.admin.CustomScrolls({\n          el:     $wrapper,\n          parent: $wrapper.parent()\n        });\n\n        this.addView(this.custom_scroll);\n        this.$el.html($wrapper);\n      } else {\n        this.renderError(this._TEXTS.no_valid_columns);\n      }\n\n      return this;\n    },\n\n    isValid: function() {\n      return this._getColorColumns().length > 0;\n    },\n\n    _addViews: function() {\n      // Properties form view\n      this.form = new cdb.forms.Form({\n        form_data: this.cartoProperties.formData(this.type),\n        model: this.cartoProperties\n      });\n      this.addView(this.form);\n\n      // Custom categories view\n      this.custom_categories = new cdb.admin.mod.CategoryWizard.CategoriesView({\n        collection:       this.categories,\n        cartoProperties:  this.cartoProperties\n      });\n      this.addView(this.custom_categories);\n\n      // Error view\n      this.error = new cdb.admin.mod.CategoryWizard.Error();\n      this.addView(this.error);\n\n      // Loader view\n      this.loader = new cdb.admin.mod.CategoryWizard.Loader();\n      this.addView(this.loader);\n    },\n\n    _getMetadata: function() {\n      // Set new categories\n      var metadata = this.cartoProperties.get('metadata');\n      \n      // check if the metadata is an object array\n\n      if (metadata && metadata.length && metadata[0].title !== undefined) {\n        this.categories.reset(metadata);\n      }\n    },\n\n    comeFromColor: function() {\n      var colors = _.clone(this.model.get('properties').colors);\n      var categories = _.clone(this.model.get('properties').categories);\n\n      for (var i = 0, l = colors.length; i < l; i++) {\n        if ((colors[i][0] != categories[i].title) || (colors[i][1] != categories[i].color) || (colors[i][2] != categories[i].title_type)) {\n          return false;\n        }\n      }\n\n      return true;\n    }\n\n  });\n\n\n  /**\n   *  Custom categories view within Cagetories Wizard\n   *  - Manage thanks to a collection.\n   *  - Each item needs a model with 'title', 'title_type', 'color' || 'file',\n   *  'value_type' and 'default' if it is neccessary.\n   *\n   *  new cdb.admin.mod.CategoryWizard.CategoryView({\n   *    collection: categories\n   *  })\n   */\n\n  cdb.admin.mod.CategoryWizard.CategoriesView = cdb.core.View.extend({\n\n    tagName: 'ul',\n\n    className: 'custom_categories',\n\n    initialize: function() {\n      this.collection.bind('add remove reset', this.render, this);\n      this.add_related_model(this.collection);\n    },\n\n    render: function() {\n      var self = this;\n\n      // clean old views\n      this.clearSubViews();\n\n      // render new items\n      this.collection.each(function(category) {\n        var item = new cdb.admin.mod.CategoryWizard.CategoriesViewItem({\n          model:            category,\n          cartoProperties:  self.options.cartoProperties\n        });\n\n        self.$el.append(item.render().el);\n        self.addView(item);\n      });\n\n      return this;\n    }\n  });\n\n\n  /**\n   *  Custom category item view using the categories collection.\n   *  - It needs a model with 'title', 'title_type', 'color' || 'file',\n   *  'value_type' and 'default' if it is neccessary.\n   *\n   *  new cdb.admin.mod.CategoryWizard.CategoriesViewItem({\n   *    model: category\n   *  })\n   */\n\n  cdb.admin.mod.CategoryWizard.CategoriesViewItem = cdb.core.View.extend({\n\n    tagName: 'li',\n\n    className: 'custom_category_item',\n\n    initialize: function() {\n      this.template = cdb.templates.getTemplate('table/menu_modules/wizards/views/category_wizard_custom_categories');\n    },\n\n    render: function() {\n      this.clearSubViews();\n\n      this.$el.append(this.template(this.model.toJSON()));\n\n      var view = new cdb.admin.mod.CategoryColor({\n        model:            this.model,\n        property:         'color',\n        extra:            { image_property: 'file' },\n        cartoProperties:  this.options.cartoProperties\n      });\n\n      this.model.bind(\"change\", this._setModel, this);\n      this.$('span.field').append(view.render().el);\n      this.addView(view);\n\n      return this;\n    },\n\n    _setModel: function(model, obj) {\n      if (obj.changes && obj.changes.file && model.get('file')) {\n        var file = model.get('file');\n        model.set({ value_type: 'file' }, { silent: true })\n      } else {\n        model.set({ value_type: 'color' }, { silent: true })\n      }\n\n      this._triggerChange();\n    },\n\n    _triggerChange: function() {\n      this.model.trigger('valueChanged')\n    }\n  });\n\n  \n  \n  /**\n   *  Custom color form to check extra colors each time\n   *  is opened.\n   *\n   */\n\n  cdb.admin.mod.CategoryColor = cdb.forms.Color.extend({\n    \n    _createPicker: function() {\n      // Get wizard applied colors\n      if (this.options.cartoProperties) {\n        this.options.extra_colors = this._getExtraColors()\n      }\n      \n      cdb.forms.Color.prototype._createPicker.call(this);\n    },\n\n    _getExtraColors: function() {\n      if (!this.options.cartoProperties) return [];\n      \n      // Tile style\n      var style = this.options.cartoProperties.layer.get(\"tile_style\");\n      var cartoParser = new cdb.admin.CartoParser(style);\n      return cartoParser.colorsUsed( { mode: \"hex\" });\n    }\n\n  })\n\n\n  /**\n   *  Error message\n   */\n\n  cdb.admin.mod.CategoryWizard.Error = cdb.core.View.extend({\n\n    tagName: 'div',\n\n    className: 'colors_error',\n\n    initialize: function() {\n      this.template = cdb.templates.getTemplate('table/menu_modules/wizards/views/color_wizard_error');\n    },\n\n    render: function() {\n      this.$el.html(this.template());\n      return this;\n    }\n  });\n\n\n  /**\n   *  Simple loader to request column values\n   */\n\n  cdb.admin.mod.CategoryWizard.Loader = cdb.core.View.extend({\n\n    tagName: 'div',\n\n    className: 'colors_loader',\n\n    initialize: function() {\n      this.template = cdb.templates.getTemplate('table/menu_modules/wizards/views/color_wizard_loader');\n    },\n\n    render: function() {\n      this.$el.html(this.template());\n      return this;\n    }\n  });\n","  /**\n   * choropleth\n   */\n  cdb.admin.mod.ChoroplethWizard = cdb.admin.mod.SimpleWizard.extend({\n\n    //TODO: put this in a template\n    error_msg: {\n      NO_CONTENT_MSG: _t('There are no numeric columns on your dataset to make a choropleth map.<br/>If you have numbers on your dataset, but you don\\'t see them here is likely they are set as String.')\n    },\n\n    initialize: function() {\n      this.type = 'choropleth';\n      cdb.admin.mod.SimpleWizard.prototype.initialize.call(this);\n    },\n\n    isValid: function() {\n      return this._getNumberColumns().length > 0;\n    },\n\n    render: function() {\n      if(this.isValid()) {\n        cdb.admin.mod.SimpleWizard.prototype.render.call(this);\n      } else {\n        this.renderError(this.error_msg.NO_CONTENT_MSG);\n      }\n      return this;\n    }\n  });\n","/**\n * ClusterWizard\n */\ncdb.admin.mod.ClusterWizard = cdb.admin.mod.SimpleWizard.extend({\n\n  MODULES: ['legends'],\n\n  initialize: function() {\n    this.type = 'cluster';\n    cdb.admin.mod.SimpleWizard.prototype.initialize.call(this);\n  }\n\n});\n\n\n","cdb.admin.mod.DensityWizard = cdb.admin.mod.SimpleWizard.extend({\n\n  MODULES: ['legends'],\n\n  initialize: function() {\n    this.type = 'density';\n    cdb.admin.mod.SimpleWizard.prototype.initialize.call(this);\n  },\n\n  _generateSQL: function() {\n    var self = this;\n    var table = self.options.table;\n    var prop = 'cartodb_id';\n    var zoom = self.options.map.get('zoom');\n\n    // we generate a grid and get the number of points\n    // for each cell. With that the density is generated\n    // and calculated for zoom level 10, which is taken as reference when we calculate the quartiles for the style buclets\n    // see models/carto.js\n    if(this.cartoProperties.get('geometry_type') === 'Rectangles') {\n      self.sql = _.template(\"WITH hgrid AS (SELECT CDB_RectangleGrid(ST_Expand(!bbox!, greatest(!pixel_width!,!pixel_height!) * <%= size %>), greatest(!pixel_width!,!pixel_height!) * <%= size %>, greatest(!pixel_width!,!pixel_height!) * <%= size %>) as cell) SELECT hgrid.cell as the_geom_webmercator, count(i.<%=prop%>) as points_count,count(i.<%=prop%>)/power( <%= size %> * CDB_XYZ_Resolution(<%= z %>), 2 )  as points_density, 1 as cartodb_id FROM hgrid, <%= table %> i where ST_Intersects(i.the_geom_webmercator, hgrid.cell) GROUP BY hgrid.cell\")({\n        prop: prop,\n        table: '__wrapped',\n        size: this.cartoProperties.get('polygon-size'),\n        z: zoom\n      });\n\n    } else {\n      self.sql = _.template(\"WITH hgrid AS (SELECT CDB_HexagonGrid(ST_Expand(!bbox!, greatest(!pixel_width!,!pixel_height!) * <%= size %>), greatest(!pixel_width!,!pixel_height!) * <%= size %>) as cell) SELECT hgrid.cell as the_geom_webmercator, count(i.<%=prop%>) as points_count, count(i.<%=prop%>)/power( <%= size %> * CDB_XYZ_Resolution(<%= z %>), 2 ) as points_density, 1 as cartodb_id FROM hgrid, <%= table %> i where ST_Intersects(i.the_geom_webmercator, hgrid.cell) GROUP BY hgrid.cell\")({\n        prop: prop,\n        table: '__wrapped',\n        size: this.cartoProperties.get('polygon-size'),\n        z: zoom\n      });\n    }\n    return this.sql;\n  }\n\n});\n\n","cdb.admin.mod.IntensityWizard = cdb.admin.mod.SimpleWizard.extend({\n\n  MODULES: [\"infowindow\", \"legends\"],\n\n  initialize: function() {\n    this.type = 'intensity';\n    cdb.admin.mod.SimpleWizard.prototype.initialize.call(this);\n    this.options.table.bind('change:schema', function() {\n      this.render();\n    }, this);\n  }\n\n});\n\n\n","cdb.admin.mod.TorqueWizard = cdb.admin.mod.SimpleWizard.extend({\n\n  MODULES: ['legends'],\n\n  events: {\n    'click .to_the_top': 'moveToFront'\n  },\n\n  LAYER_PROPS: ['property',\n    'torque-duration',\n    'torque-frame-count',\n    'torque-blend-mode',\n    'torque-trails',\n    'torque-is-time'\n  ],\n\n  error_msg: {\n    NO_CONTENT_MSG: _t('There are no numeric or date columns on your dataset to make an animated map.<br/>If you have numbers on your dataset, but you don\\'t see them here is likely they are set as String.'),\n    LAYER_ON_TOP: _t('Animated layers should be on top of the map.'),\n    ONLY_ONE_TORQUE_LAYER: _t('Sorry, but for the moment only one Torque layer is allowed per map.')\n  },\n\n  initialize: function() {\n    this.type = 'torque';\n    this.layer_type = 'torque';\n    this.layers = this.options.map.layers;\n    cdb.admin.mod.SimpleWizard.prototype.initialize.call(this);\n  },\n\n  validColumns: function() {\n    return this.options.table.columnNamesByType('number').concat(\n      this.options.table.columnNamesByType('date')\n    );\n  },\n\n  isLayerOnTop: function() {\n    return this.layers.isLayerOnTopOfDataLayers(this.options.layer);\n  },\n\n  moveToFront: function(e) {\n    if (e) e.preventDefault();\n    this.options.layer.moveToFront();\n  },\n\n  torqueLayersCount: function() {\n    return this.layers.getLayersByType('torque').length;\n  },\n\n  getTorqueLayer: function() {\n    return this.layers.getLayersByType('torque')[0];\n  },\n\n  isValid: function() {\n    // check if the layer is on top and there are numeric columns\n    return this.validColumns().length > 0 &&\n           this.isLayerOnTop() &&\n           (this.torqueLayersCount() === 0 || (\n              this.torqueLayersCount() === 1 && this.getTorqueLayer().cid === this.options.layer.cid)\n           )\n  },\n\n  render: function() {\n    if(this.isValid()) {\n      cdb.admin.mod.SimpleWizard.prototype.render.call(this);\n    } else {\n      if (this.torqueLayersCount() !== 0) {\n        this.renderError(this.error_msg.ONLY_ONE_TORQUE_LAYER);\n      }\n      else if (!this.isLayerOnTop()) {\n        this.renderError(this.error_msg.LAYER_ON_TOP);\n        $(this.$('.wrapper .no_content')[0]).append(' Please <a href=\"#/move\" class=\"to_the_top\">move it to the top</a>.');\n      } else {\n        this.renderError(this.error_msg.NO_CONTENT_MSG);\n      }\n    }\n    return this;\n  },\n\n\n});\n","cdb.admin.mod.TorqueCategoryWizard = cdb.admin.mod.CategoryWizard.extend({\n\n  MODULES: ['legends'],\n\n  events: {\n    'click .to_the_top': 'moveToFront'\n  },\n\n  LAYER_PROPS: ['property',\n    'torque-duration',\n    'torque-frame-count',\n    'torque-blend-mode',\n    'torque-trails',\n    'torque-is-time'\n  ],\n\n  error_msg: {\n    NO_CONTENT_MSG: _t('There are no numeric or date columns on your dataset to make an animated map.<br/>If you have numbers on your dataset, but you don\\'t see them here is likely they are set as String.'),\n    LAYER_ON_TOP: _t('Animated layers should be on top of the map.'),\n    ONLY_ONE_TORQUE_LAYER: _t('Sorry, but for the moment only one Torque layer is allowed per map.')\n  },\n\n  initialize: function() {\n    this.type = 'torque_cat';\n    this.layer_type = 'torque';\n\n    cdb.admin.mod.CategoryWizard.prototype.initialize.call(this);\n  },\n\n  validColumns: function() {\n    return this.options.table.columnNamesByType('number').concat(\n      this.options.table.columnNamesByType('date')\n    );\n  },\n\n  isLayerOnTop: function() {\n    return this.options.layer.collection.isLayerOnTopOfDataLayers(this.options.layer);\n  },\n\n  moveToFront: function(e) {\n    if (e) e.preventDefault();\n    this.options.layer.moveToFront();\n  },\n\n  torqueLayersCount: function() {\n    return this.options.layer.collection.getLayersByType('torque').length;\n  },\n\n  getTorqueLayer: function() {\n    return this.options.layer.collection.getLayersByType('torque')[0];\n  },\n\n  isValid: function() {\n    // check if the layer is on top and there are numeric columns\n    return this.validColumns().length > 0 &&\n           this.isLayerOnTop() &&\n           (this.torqueLayersCount() === 0 || (\n              this.torqueLayersCount() === 1 && this.getTorqueLayer().cid === this.options.layer.cid)\n           )\n  },\n\n  render: function() {\n    if(this.isValid()) {\n      cdb.admin.mod.CategoryWizard.prototype.render.call(this);\n    } else {\n      if (this.torqueLayersCount() !== 0) {\n        this.renderError(this.error_msg.ONLY_ONE_TORQUE_LAYER);\n      }\n      else if (!this.isLayerOnTop()) {\n        this.renderError(this.error_msg.LAYER_ON_TOP);\n        $(this.$('.wrapper .no_content')[0]).append(' Please <a href=\"#/move\" class=\"to_the_top\">move it to the top</a>.');\n      } else {\n        this.renderError(this.error_msg.NO_CONTENT_MSG);\n      }\n    }\n    return this;\n  },\n\n\n});\n","cdb.admin.mod.TorqueHeatWizard = cdb.admin.mod.TorqueWizard.extend({\n  initialize: function() {\n    this.type = 'torque_heat';\n    this.layer_type = 'torque';\n    cdb.admin.mod.SimpleWizard.prototype.initialize.call(this);\n  },\n  _bindChanges: function() {\n    cdb.admin.mod.SimpleWizard.prototype._bindChanges.call(this);\n    this.cartoProperties.bind('change', this.showHeatAnimationFields, this);\n    this.cartoProperties.bind('change:heat-animated', this.setDefaults, this);\n    this.cartoProperties.bind('change:torque-cumulative', this.setDefaults, this);\n  },\n  render: function(){\n  \tcdb.admin.mod.SimpleWizard.prototype.render.call(this);\n  \tthis.showHeatAnimationFields();\n  \treturn this;\n  },\n  setDefaults: function(){\n    var animated = this.cartoProperties.get('heat-animated');\n    if (animated === undefined) return;\n    if(animated === false){\n        this.cartoProperties.set({\n          'torque-frame-count': 1,\n          'torque-resolution': 2 ,\n          'torque-trails': 0\n        });\n      }\n    else{\n      var cumulative = this.cartoProperties.get('torque-cumulative');\n      if(cumulative){\n        this.cartoProperties.set({\n          'torque-frame-count': 512,\n          'torque-resolution': 10\n        });\n      }\n      else{\n        this.cartoProperties.set({\n          'torque-frame-count': 32,\n          'torque-resolution': 8,\n          'torque-trails': 2\n        });\n      }\n    }\n  },\n\n  showHeatAnimationFields: function(){\n    var self = this;\n    var v = self.form.getFieldByName('Animated');\n    var animated = self.cartoProperties.get('heat-animated');\n    if (!v) return;\n\n    var time_col = self.form.getFieldByName('Time Column');\n    var duration = self.form.getFieldByName('Duration (secs)');\n    var steps = self.form.getFieldByName('Steps');\n    var cumulative = self.form.getFieldByName('Cumulative');\n    var trails = self.form.getFieldByName('Trails');\n\n      time_col && time_col.hide();\n    if (!animated) {\n      duration && duration.hide();\n      steps && steps.hide();\n      cumulative && cumulative.hide();\n      trails && trails.hide();\n    }\n    else {\n      time_col && time_col.show();\n      duration && duration.show();\n      steps && steps.show();\n      cumulative && cumulative.show();\n      trails && trails.show();\n    }\n  }\n\n});","cdb.admin.overlays.Annotation = cdb.geo.ui.Annotation.extend({\n\n  className: \"annotation overlay\",\n\n  template_name: 'table/views/overlays/annotation',\n\n  events: {\n\n    \"mouseenter .text\":   \"_onMouseEnter\",\n    \"mouseup\":            \"_onMouseUp\",\n\n    \"click .close\":      \"_close\",\n    \"click .content\":    \"_onClickEdit\",\n    \"click .text\":       \"_onClickEdit\",\n    \"dblclick .content\": \"_onDblClick\",\n    \"dblclick .text\":    \"_onDblClick\",\n\n    \"keyup .text\":       \"_onKeyUp\",\n    \"paste .text\":       \"_onPaste\"\n\n  },\n\n  initialize: function() {\n\n    _.bindAll(this, \"_close\", \"_onChangeMode\", \"_onKeyDown\");\n\n    this.vis    = this.options.vis;\n    this.canvas = this.options.canvas;\n\n    this.mapView = this.options.mapView;\n\n    this._bindMap();\n\n    this.template = this.getTemplate(this.template_name);\n\n    this._setupModels();\n\n    // zoom level config\n    var minZoomLevel     = this.mapView.map.get(\"minZoom\");\n    var maxZoomLevel     = this.mapView.map.get(\"maxZoom\");\n\n    this.form_data = [{\n        name: 'Text',\n        form: {\n          'font-size':  { type: 'simple_number', value: 12, min: 5, max: 50, inc: 2, disable_triggering: true },\n          'color':      { type: 'color', value: '#FFF', extra: { tick: \"left\", picker_horizontal_position: \"left\", picker_vertical_position: \"down\" }},\n          'font-family-name': {\n            type: 'select',\n            value: \"Helvetica\",\n            extra: [\"Helvetica\", \"Droid Sans\", \"Vollkorn\", \"Roboto\", \"Open Sans\", \"Lato\", \"Graduate\", \"Gravitas One\", \"Old Standard TT\"]\n          },\n          'text-align':      { type: 'text_align', value: 'left', alignments: { left: true, right: true, center: false } },\n        }\n      }, {\n        name: 'Box',\n        form: {\n          'box-color':  { type: 'color', value: '#000', extra: { tick: \"left\", picker_horizontal_position: \"left\", picker_vertical_position: \"down\" }},\n          'box-opacity':  { type: 'simple_opacity', value: .7, min:0, max:1, inc: .1, disable_triggering: true },\n          'box-padding':  { type: 'simple_number_with_label', value: 5, min: 5, max: 50, inc: 1, label: \"P\", disable_triggering: true }\n        }\n      }, {\n        name: 'Line',\n        form: {\n          'line-color':  { type: 'color', value: '#000', extra: { tick: \"left\", picker_horizontal_position: \"left\", picker_vertical_position: \"down\" }},\n          'line-width':  { type: 'simple_number_with_label', value: 50, min: 5, max: 100, inc: 1, label: 'W', disable_triggering: true },\n        }\n      } , {\n        name: 'Zoom (min-max)',\n        form: {\n          'min-zoom':  { type: 'simple_number', value: minZoomLevel, min: minZoomLevel, max: maxZoomLevel, inc: 1, classes: \"margin-min\", disable_triggering: true },\n          'max-zoom':  { type: 'simple_number_with_label', value: maxZoomLevel, min: minZoomLevel, max: maxZoomLevel, inc: 1, label: '↔', disable_triggering: true },\n        }\n      }];\n  },\n\n  _bindMap: function() {\n\n    this.mapView.map.bind('change',      this._place, this);\n    this.mapView.map.bind('change:zoom', this._applyZoomLevelStyle, this);\n    this.mapView.bind('zoomstart', this._hideOverlay, this);\n    this.mapView.bind('zoomend',   this._showOverlay, this);\n\n  },\n\n  _unbindMap: function() {\n\n    this.mapView.map.unbind('change',      this._place, this);\n    this.mapView.map.unbind('change:zoom', this._applyZoomLevelStyle, this);\n    this.mapView.unbind('zoomstart', this._hideOverlay, this);\n    this.mapView.unbind('zoomend',   this._showOverlay, this);\n\n  },\n\n  // Setup the internal and custom model\n  _setupModels: function() {\n\n    var self  = this;\n    var extra = this.extra = this.model.get(\"extra\");\n\n    this.model.set({ text: extra.text }, { silent: true });\n\n    var applyStyle = function() {\n      self._applyStyle();\n      self.model.save();\n    };\n\n    // Binding\n    this.model.bind('remove',          this.hide,             this);\n\n    this.model.bind('change:style',    applyStyle,            this);\n    this.model.bind('change:text',     this._setText,         this);\n    this.model.bind('change:display',  this._onChangeDisplay, this);\n    this.model.bind('change:extra',    this._onChangeExtra,   this);\n    this.model.bind('change:selected', this._onChangeSelected, this);\n\n    // Internal model to store the editing state\n    this.editModel = new cdb.core.Model({ mode: \"\" });\n    this.editModel.bind('change:mode', this._onChangeMode, this);\n\n    this.add_related_model(this.editModel);\n\n  },\n\n  // Element events \n  _onKeyUp: function(e) {\n\n    if (this.timeout) {\n      clearTimeout(this.timeout);\n    }\n\n    this.model.set({ text: this.$text.html() }, { silent: true });\n\n  },\n\n  _onClickEdit: function(e) {\n\n    this.killEvent(e);\n\n    $(document).bind('keydown', this._onKeyDown);\n\n    this.trigger(\"clickEdit\", this.model, this.form_data);\n    this.model.set(\"selected\", true);\n\n  },\n\n  _onKeyDown: function(e) {\n\n    var selected = this.model.get(\"selected\");\n\n    if (selected) {\n\n      var editable = this.editModel.get(\"mode\") !== \"editable\";\n      var focus    = this.$(\".overlay_text\").is(\":focus\");\n\n      // hitting the backspace removes the overlay\n      if ($(e.target).hasClass(\"overlay_text\") || $(e.target).hasClass(\"cartodb-map\")) {\n        if (e.keyCode === $.ui.keyCode.BACKSPACE && (editable || !focus)) {\n          this.killEvent(e);\n          this._close();\n        }\n      }\n\n      if (editable && !focus) {\n        if (e.which == 67 && (e.ctrlKey || e.metaKey)) {\n          this.trigger('duplicate', this.model, this);\n        }\n      }\n    }\n\n    if (e.keyCode === $.ui.keyCode.ESCAPE) { \n      this.editModel.set(\"mode\", \"\");\n    }\n\n  },\n\n  _onPaste: function(e) {\n\n    var self = this;\n\n    setTimeout(function() {\n\n      var text = cdb.Utils.stripHTML(self.model.get(\"text\"));\n      self.model.set(\"text\", text)\n\n    }, 200);\n\n  },\n\n  _onDblClick: function(e) {\n\n    this.killEvent(e);\n    this.editModel.set(\"mode\", \"editable\");\n  },\n\n  _onMouseUp: function() {\n\n    var editable = (this.editModel.get(\"mode\") == \"editable\");\n\n    if (!editable) {\n      this._savePosition();\n    }\n\n  },\n\n  _savePosition: function() {\n\n    var extra = this.model.get(\"extra\");\n\n    var x     = this.model.get(\"x\");\n    var y     = this.model.get(\"y\");\n\n    var oldX   = this.$el.position().left;\n    var oldY   = this.$el.position().top;\n    var height = this.$el.height();\n\n    if (x == oldX && y == oldY) return;\n\n    var x = this.$el.position().left;\n    var y = this.$el.position().top;\n\n    var style      = this.model.get(\"style\");\n\n    var lineWidth  = style[\"line-width\"];\n    var textAlign  = style[\"text-align\"];\n\n    y = y + Math.ceil(this.$el.outerHeight(true)/2);\n\n    if (textAlign === \"right\") {\n      x = x + this.$el.width() + lineWidth + this.$(\".ball\").width();\n    } else {\n      x = x - lineWidth;\n    }\n\n    var latlng = this.mapView.pixelToLatLon([x , y]);\n    extra.latlng = [latlng.lat, latlng.lng];\n\n    if (!this.model.isNew()) { // avoid saving it if the model was removed\n      this.model.save({ extra: extra });\n    }\n\n  },\n\n  _onMouseDown: function() {},\n\n  _onMouseEnter: function() {\n\n    this.$el.addClass(\"hover\");\n\n    if (this.editModel.get(\"mode\") === \"editable\") {\n      if (this.timeout) clearTimeout(this.timeout);\n    }\n\n  },\n\n  _onMouseLeave: function() {\n    this.$el.removeClass(\"hover\");\n\n    var self = this;\n\n    if (this.editModel.get(\"mode\") === \"editable\") {\n\n      this.timeout = setTimeout(function() {\n\n        self.editModel.set(\"mode\", \"\");\n\n      }, 250);\n    }\n\n  },\n\n  _hideOverlay: function() {\n    this.$el.fadeOut(150);\n  },\n\n  _showOverlay: function() {\n\n    if (!this._belongsToCanvas()) return;\n\n    var self = this;\n\n    this.$el.stop().delay(500).fadeIn(150, function() {\n      self.$el.css({ display: \"inline-table\" }); // trick so we don't need to set the width\n    });\n\n  },\n\n  // canonical show method for the overlay\n  show: function(animated) {\n\n    if (!this._belongsToCanvas()) return;\n\n    this.$el.show();\n    this.$el.css({ display: \"inline-table \"});\n\n    if (true) this.$el.addClass('animated bounceIn');\n\n    var self = this;\n\n    this.$el.one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function() {\n      self.$el.removeClass(\"animated bounceIn\");\n    });\n\n  },\n\n  // canonical hide (= destroy) method for the overlay\n  hide: function(callback) {\n\n    var self = this;\n\n    this.unbind(\"mouseenter\", this._onMouseEnter, this);\n    this.unbind(\"mouseup\", this._onMouseUp, this);\n    $(document).unbind('keydown', this._onKeyDown, this);\n\n    this.$el\n    .removeClass('animated bounceIn')\n    .addClass('animated bounceOut')\n\n    callback && _.isFunction(callback) && callback();\n\n    this._unbindMap();\n\n    cdb.god.unbind(\"closeDialogs\", this._onCloseDialogs, this);\n\n    // Give it some time to complete the animation\n    setTimeout(function() {\n      self.clean();\n    }, 550);\n\n  },\n\n  _close: function(e) {\n\n    this.killEvent(e);\n\n    var self = this;\n\n    this.hide(function() {\n      self.trigger(\"remove\", self);\n    });\n\n  },\n\n  _place: function() {\n\n    var mode = this.editModel.get(\"mode\");\n\n    if (mode === \"editable\") return;\n\n    var style      = this.model.get(\"style\");\n    var lineWidth  = style[\"line-width\"];\n    var textAlign  = style[\"text-align\"];\n\n    var pos        = this.mapView.latLonToPixel(this.model.get('extra').latlng);\n    var size       = this.mapView.getSize();\n    var top        = pos.y - Math.ceil(this.$el.outerHeight(true)/2);\n    var left       = pos.x + lineWidth;\n\n    if (textAlign === \"right\") {\n      left = pos.x - this.$el.width() - lineWidth - this.$(\".ball\").width();\n    }\n\n    this.$el.css({ top: top, left: left });\n\n  },\n\n  _belongsToCanvas: function() {\n\n    return this.model.get(\"device\") === this.canvas.get(\"mode\");\n\n  },\n\n  _onChangeDisplay: function() {\n\n    var display = this.model.get(\"display\");\n\n    if (display && this._belongsToCanvas()) {\n      this.show();\n    } else {\n      this._hideOverlay();\n    }\n\n  },\n\n  _onChangeExtra: function() {\n\n    var extra  = this.model.get(\"extra\");\n    extra.text = this.model.get(\"text\");\n\n    this.model.set({ extra: extra }, { silent: true });\n\n  },\n\n  _getStyleProperty: function(property) {\n\n    var style      = this.model.get(\"style\");\n\n    return style[property];\n  },\n\n  /*\n   * Applies style to the content of the widget\n   */\n\n  _applyStyle: function() {\n\n    var style      = this.model.get(\"style\");\n\n    var textAlign  = style[\"text-align\"];\n    var boxColor   = style[\"box-color\"];\n    var boxOpacity = style[\"box-opacity\"];\n    var boxPadding = style[\"box-padding\"];\n\n    var lineWidth  = style[\"line-width\"];\n    var lineColor  = style[\"line-color\"];\n    var fontFamily = style[\"font-family-name\"];\n\n    if (boxOpacity === 0) {\n      this.$el.addClass(\"border-dark\");\n    } else {\n      this.$el.removeClass(\"border-dark\");\n    }\n\n    if (boxColor === \"#FFFFFF\") {\n      this.$el.addClass(\"white-box\");\n    } else {\n      this.$el.removeClass(\"white-box\");\n    }\n\n    this.$text.css(style);\n\n    this.$(\".content\").css(\"padding\", boxPadding);\n    this.$text.css(\"font-size\", style[\"font-size\"] + \"px\");\n    this.$el.css(\"z-index\", style[\"z-index\"]);\n\n    this.$(\".stick\").css({ width: lineWidth, left: -lineWidth });\n\n    var fontFamilyClass = \"\";\n\n    if      (fontFamily  == \"Droid Sans\")       fontFamilyClass = \"droid\";\n    else if (fontFamily  == \"Vollkorn\")         fontFamilyClass = \"vollkorn\";\n    else if (fontFamily  == \"Open Sans\")        fontFamilyClass = \"open_sans\";\n    else if (fontFamily  == \"Roboto\")           fontFamilyClass = \"roboto\";\n    else if (fontFamily  == \"Lato\")             fontFamilyClass = \"lato\";\n    else if (fontFamily  == \"Graduate\")         fontFamilyClass = \"graduate\";\n    else if (fontFamily  == \"Gravitas One\")     fontFamilyClass = \"gravitas_one\";\n    else if (fontFamily  == \"Old Standard TT\")  fontFamilyClass = \"old_standard_tt\";\n\n    this.$el\n    .removeClass(\"droid\")\n    .removeClass(\"vollkorn\")\n    .removeClass(\"roboto\")\n    .removeClass(\"open_sans\")\n    .removeClass(\"lato\")\n    .removeClass(\"graduate\")\n    .removeClass(\"gravitas_one\")\n    .removeClass(\"old_standard_tt\");\n\n    this.$el.addClass(fontFamilyClass);\n\n    if (textAlign === \"right\") {\n      this.$el.addClass(\"align-right\");\n      this.$(\".stick\").css({ left: \"auto\", right: -lineWidth });\n    } else {\n      this.$el.removeClass(\"align-right\");\n    }\n\n    this._place();\n    this._applyZoomLevelStyle();\n\n  },\n\n  _applyZoomLevelStyle: function() {\n\n    var style      = this.model.get(\"style\");\n    var extra      = this.model.get(\"extra\");\n\n    var boxColor   = style[\"box-color\"];\n    var boxOpacity = style[\"box-opacity\"];\n    var lineColor  = style[\"line-color\"];\n\n    var minZoom    = style[\"min-zoom\"];\n    var maxZoom    = style[\"max-zoom\"];\n\n    var currentZoom = this.mapView.map.get(\"zoom\");\n\n    var textOpacity = 1;\n\n    if (currentZoom >= minZoom && currentZoom <= maxZoom) {\n\n      textOpacity = 1;\n\n      var rgbaLineCol = this._getRGBA(lineColor, 1);\n      var rgbaBoxCol  = this._getRGBA(boxColor, boxOpacity);\n\n    } else {\n\n      textOpacity = .5;\n\n      var rgbaLineCol = this._getRGBA(lineColor, .2);\n      var rgbaBoxCol  = this._getRGBA(boxColor, .2);\n\n    }\n\n    this.$(\".text\").animate({ opacity: textOpacity }, 150);\n\n    this.$el.css(\"background-color\", rgbaBoxCol);\n\n    this.$(\".stick\").css(\"background-color\", rgbaLineCol);\n    this.$(\".ball\").css(\"background-color\", rgbaLineCol);\n\n  },\n\n  _onChangeSelected: function() {\n\n    var selected = this.model.get(\"selected\");\n\n    if (selected) {\n\n      this.$el.addClass(\"selected\");\n\n      if (this._getStyleProperty(\"box-opacity\") === 0) {\n        this.$el.addClass(\"border-dark\");\n      }\n\n      if (this._getStyleProperty(\"box-color\") === \"#FFFFFF\") {\n        this.$el.addClass(\"white-box\");\n      }\n\n    } else {\n\n      this.$el\n      .removeClass(\"selected\")\n      .removeClass(\"border-dark\")\n      .removeClass(\"white-box\");\n\n      this._disableEditingMode();\n\n    }\n\n  },\n\n  _onChangeMode: function() {\n\n    var mode = this.editModel.get(\"mode\");\n\n    this.trigger('editing', mode === 'editable', this);\n\n    if (mode == \"editable\") {\n      this._enableEditingMode();\n    } else {\n      this._disableEditingMode();\n    }\n  },\n\n  _enableEditingMode: function() {\n\n    this.$el\n    .addClass(\"editable\")\n    .addClass(\"disabled\");\n\n    this.$text.attr(\"contenteditable\", true).focus();\n\n    var style = this.model.get(\"style\");\n    var width = style[\"box-width\"];\n\n    var text = this.model.get(\"text\");\n\n    this.$el.css(\"width\", \"auto\");\n    this.$el.css(\"max-width\", width);\n    this.$text.html(text);\n    this.$(\".hint\").fadeIn(150);\n  },\n\n  _disableEditingMode: function() {\n\n    $(document).unbind('keydown', this._onKeyDown);\n\n    var text = this._transformToMarkdown(this.model.get(\"text\"));\n\n    this.editModel.set(\"mode\", \"\");\n\n    if (text) {\n\n      var self = this;\n\n      self.$(\".hint\").fadeOut(150, function() {\n\n        self.$el\n        .removeClass(\"editable\")\n        .removeClass(\"disabled\");\n\n        self.$text.attr(\"contenteditable\", false);\n\n      });\n\n      self.$text.html(text);\n      self._savePosition();\n\n    } else {\n      this._close();\n    }\n\n  },\n\n  _setText: function() {\n\n    var text          = this.model.get(\"text\");\n    var rendered_text = this._transformToMarkdown(text);\n\n    var extra = this.model.get(\"extra\");\n\n    extra.text          = text;\n    extra.rendered_text = rendered_text\n\n    this.model.save({ extra: extra });\n\n    if (rendered_text) this.$text.html(rendered_text);\n\n  },\n\n  _transformToMarkdown: function(text) {\n\n    text = markdown.toHTML(text)\n\n    text = text.replace(/&lt;/g, \"<\");\n    text = text.replace(/&gt;/g, \">\");\n    text = text.replace(/<p>/g, \"\");\n    text = text.replace(/&amp;nbsp;/g, \" \");\n    text = text.replace(/<\\/p>/g, \"\");\n\n    return text;\n\n  },\n\n  _onCloseDialogs: function() {\n    if (this.model.get(\"selected\") !== undefined) this.model.set(\"selected\", false);\n  },\n\n  _setupText: function() {\n\n    this.$text = this.$(\".content div.text\");\n    this.$text.html(this._transformToMarkdown(this.model.get(\"text\")));\n\n  },\n\n  render: function() {\n\n    this.$el.append(this.template(this.model.attributes));\n    this.$el.addClass(this.model.get(\"device\"));\n\n    this._setupText();\n\n    var self = this;\n\n    setTimeout(function() {\n      self._applyStyle();\n      self._place();\n      self.show();\n    }, 500);\n\n    cdb.god.unbind(\"closeDialogs\", this._onCloseDialogs, this);\n    cdb.god.bind(\"closeDialogs\", this._onCloseDialogs, this);\n\n    return this;\n\n  }\n\n});\n","cdb.admin.ConfigureCanvasDropdown = cdb.ui.common.Dropdown.extend({\n\n  className: 'dropdown canvas_setup_dropdown',\n\n  defaults: {\n    speedOut: 100,\n    speedIn: 100\n  },\n\n  events: {\n    \"click\" : \"killEvent\"\n  },\n\n  initialize: function() {\n\n    _.bindAll(this, \"open\", \"hide\", \"_handleClick\", \"_keydown\");\n\n    // Extend options\n    _.defaults(this.options, this.defaults);\n\n    // Dropdown template\n    this.template_base = cdb.templates.getTemplate(this.options.template_base);\n\n    // Bind to target\n    $(this.options.target).bind({ \"click\": this._handleClick});\n\n    // Bind ESC key\n    $(document).bind('keydown', this._keydown);\n\n    // Is open flag\n    this.isOpen = false;\n\n  },\n\n  /* Check if the dropdown is visible to hiding with the click on the target */\n  _handleClick: function(ev) {\n    if (ev) {\n      ev.preventDefault();\n    }\n\n    // If visible\n    if (this.isOpen){\n      this.hide();\n    } else{\n      this.open();\n    }\n  },\n\n  show: function() {\n\n    var dfd = $.Deferred();\n    var self = this;\n\n    //sometimes this dialog is child of a node that is removed\n    //for that reason we link again DOM events just in case\n    this.delegateEvents();\n    this.$el\n    .css({\n      marginTop: \"-10px\",\n      opacity:0,\n      display:\"block\"\n    })\n    .animate({\n      margin: \"0\",\n      opacity: 1\n    }, {\n      \"duration\": this.options.speedIn,\n      \"complete\": function(){\n        dfd.resolve();\n      }\n    });\n\n    this.trigger(\"onDropdownShown\", this.el);\n\n    return dfd.promise();\n  },\n\n  open: function(ev, target) {\n\n    cdb.god.trigger(\"closeDialogs\");\n\n    // Target\n    var $target = target && $(target) || this.options.target;\n\n    this.options.target = $target;\n\n    this.$el.css({\n      top: 40,\n      left: 0\n    })\n    .addClass(\n      // Add vertical and horizontal position class\n      (this.options.vertical_position == \"up\" ? \"vertical_top\" : \"vertical_bottom\" )\n      + \" \" +\n        (this.options.horizontal_position == \"right\" ? \"horizontal_right\" : \"horizontal_left\" )\n      + \" \" +\n        // Add tick class\n        \"border tick_\" + this.options.tick\n    );\n\n    // Show it\n    this.show();\n    this._recalcHeight();\n\n    // Dropdown open\n    this.isOpen = true;\n  },\n\n\n  hide: function(done) {\n\n    if (!this.isOpen) {\n      done && done();\n      return;\n    }\n\n    var self    = this;\n    this.isOpen = false;\n\n    this.$el.animate({\n      marginTop: self.options.vertical_position == \"down\" ? \"10px\" : \"-10px\",\n      opacity: 0\n    }, this.options.speedOut, function(){\n\n      // And hide it\n      self.$el.hide();\n\n    });\n\n    this.trigger(\"onDropdownHidden\",this.el);\n  },\n\n  _recalcHeight: function() {\n\n    var $ul  = this.$el.find(\"ul.special\");\n\n    // Resets heights\n    $ul.height(\"auto\");\n    $ul.parent().height(\"auto\");\n\n    var special_height  = $ul.height();\n    var dropdown_height = $ul.parent().height();\n\n    // Sets heights\n    if (special_height < dropdown_height) $ul.css(\"height\", dropdown_height);\n    else $ul.parent().height(special_height);\n\n  },\n\n  _addButton: function(title, icon_name, active, callback) {\n\n    var button = new cdb.admin.OverlaysDropdownItem({\n      template_name: 'table/views/overlays/canvas_dropdown_item',\n      text: title,\n      active: active,\n      className: title.toLowerCase()\n    }).on(\"click\", callback, this);\n\n    this.$el.find(\"ul\").append(button.render().$el);\n\n    return button;\n\n  },\n\n  _switchToDesktop: function() {\n\n    this.desktopButton.model.set(\"active\", true);\n    this.mobileButton.model.set(\"active\", false);\n    this.options.canvas.set(\"mode\", \"desktop\");\n\n  },\n\n  _switchToMobile: function() {\n\n    this.desktopButton.model.set(\"active\", false);\n    this.mobileButton.model.set(\"active\", true);\n    this.options.canvas.set(\"mode\", \"mobile\");\n\n  },\n\n  /*\n   * Renders the dropdown\n   */\n  render: function() {\n\n    this.clearSubViews();\n\n    this.$el.html(this.template_base(this.options));\n\n    this.desktopButton = this._addButton(\"Desktop\", \"desktop\", true, this._switchToDesktop);\n    this.mobileButton  = this._addButton(\"Mobile\",  \"mobile\",  false, this._switchToMobile);\n\n    return this;\n  },\n\n  clean: function() {\n    $(document).unbind('keydown', this._keydown);\n    cdb.ui.common.Dropdown.prototype.clean.call(this);\n  }\n});\n","cdb.admin.overlays.Code = cdb.core.View.extend({\n\n  className: \"code overlay\",\n\n  template_name: 'table/views/overlays/code',\n\n  events: {\n\n    \"mouseup\":           \"_onMouseUp\",\n    \"mousedown\":         \"_onMouseDown\",\n\n    \"mouseenter .text\":  \"_onMouseEnter\",\n    \"mouseleave .text\":  \"_onMouseLeave\",\n\n    \"click .close\":      \"_close\",\n    \"click .content\":    \"_click\",\n    \"dblclick .content\": \"_dblClick\",\n\n    \"keyup .text\":       \"_onKeyUp\",\n    \"click .text\":       \"_killEvent\",\n    \"paste .text\":       \"_onPaste\"\n\n  },\n\n  initialize: function() {\n\n    _.bindAll(this, \"_click\", \"_close\", \"_dblClick\", \"_onChangeMode\", \"_onKeyDown\", \"_putOnTop\");\n\n    // Bind ESC key\n    $(document).bind('keydown', this._onKeyDown);\n\n    this.template = this.getTemplate(this.template_name);\n\n    this._setupModels();\n\n  },\n\n  _killEvent: function(e) {\n\n    e && e.preventDefault();\n    e && e.stopPropagation();\n\n  },\n\n  // Setup the internal and custom model\n  _setupModels: function() {\n\n    var extra = this.model.get(\"extra\");\n\n    this.model.set({ text: extra.text }, { silent: true });\n\n    // Binding\n    this.model.bind('change:text',    this._setText,    this);\n    this.model.bind('change:style',   this._applyStyle, this);\n    this.model.bind('change:display', this._onChangeDisplay, this);\n    this.model.bind('change:extra',   this._onChangeExtra, this);\n\n    // Internal model to store the editing state\n    this.editModel = new cdb.core.Model({ mode: \"\" });\n    this.editModel.bind('change:mode', this._onChangeMode, this);\n\n    this.add_related_model(this.editModel);\n\n  },\n\n  // Element events \n  _onKeyUp: function(e) {\n\n    var self = this;\n\n    var temp      = \"\";\n    var domString = \"\";\n\n    if (this.timeout)       clearTimeout(this.timeout);\n    if (this.keyUpTimeout)  clearTimeout(this.keyUpTimeout);\n    if (this.savingTimeout) clearTimeout(this.savingTimeout);\n\n    var value = this.$text.html();\n\n    if (cdb.Utils.stripHTML(value) == \"\") {\n\n      this.keyUpTimeout = setTimeout(function() {\n\n        self.model.set({ text: \"\" }, { silent: true });\n        self._close();\n\n      }, 600);\n\n    } else {\n\n      this.model.set({ text: value }, { silent: true });\n\n      if (!this.$el.hasClass(\"hover\") && this.$text.text()) {\n        this.savingTimeout = setTimeout(function() {\n\n          self._disableEditingMode();\n\n        }, 500);\n      }\n    }\n\n  },\n\n  _dblClick: function(e) {\n\n    this._killEvent(e);\n\n  },\n\n  _click: function(e) {\n\n    this._killEvent(e);\n\n    this._putOnTop();\n\n    var isLink = e.target.hasAttribute(\"href\");\n\n    if (!isLink) {\n      cdb.god.trigger(\"closeDialogs\");\n    }\n\n  },\n\n  _onKeyDown: function(e) {\n\n    if (e.keyCode === 27) {\n      this.editModel.set(\"mode\", \"\");\n    }\n\n  },\n\n  _onPaste: function(e) {\n\n    var self = this;\n\n    setTimeout(function() {\n\n      var text = cdb.Utils.stripHTML(self.model.get(\"text\"));\n      self.model.set(\"text\", text)\n\n    }, 200);\n\n  },\n\n  _onMouseUp: function(e) {\n\n    // Prevents entering in the edit mode when clicking the edit button\n    if (!$(e.target).parents(\".overlay_text\").length && !$(e.target).hasClass(\"overlay_text\")) {\n      return;\n    }\n\n    cdb.god.trigger(\"closeDialogs\");\n\n    var extra = this.model.get(\"extra\");\n\n    var x     = this.model.get(\"x\");\n    var y     = this.model.get(\"y\");\n\n    var oldX  = this.$el.position().left;\n    var oldY  = this.$el.position().top;\n\n    var portraitDirection  = extra.portraitDirection;\n    var landscapeDirection = extra.landscapeDirection;\n\n    if (y == 0 && portraitDirection == \"bottom\") oldY = y;\n    if (x == 0 && landscapeDirection == \"right\") oldX = x;\n\n    // If we didn't move the overlay\n    if (oldX === x && y === oldY || x == 0 && landscapeDirection == \"right\" && y === oldY || y == 0 && portraitDirection == \"bottom\" && oldX === x) {\n\n      this.dropdown.hide();\n      this.editModel.set(\"mode\", \"editable\");\n\n      return;\n\n    }\n\n    var x = this.$el.position().left;\n    var y = this.$el.position().top;\n\n    // Default positions\n    extra.portraitDirection  = \"top\";\n    extra.landscapeDirection = \"left\";\n\n    // Let's see where did we put our overlay…\n    var rightSticked  = x + this.$el.width()  >= $(\".cartodb-map\").width();\n    var bottomSticked = y + this.$el.height() >= $(\".cartodb-map\").height();\n\n    if (bottomSticked) { // we sticked the overlay to the bottom of the screen\n\n      y = 0;\n\n      this.$el.css({ bottom: 0, top: \"auto\" });\n\n      extra.portraitDirection = \"bottom\";\n\n    }\n\n    if (rightSticked) { // we sticked the overlay to the right side\n\n      x = 0;\n\n      this.$el.css({ right: 0, left: \"auto\" });\n\n      extra.landscapeDirection = \"right\";\n\n    }\n\n    this.model.set({ extra: extra }, { silent: true});\n    this.model.set({ x: x, y: y });\n\n    this.model.save();\n\n  },\n\n  _onMouseDown: function() { },\n\n  _onMouseEnter: function() {\n\n    this.$el.addClass(\"hover\");\n    if (this.editModel.get(\"mode\") == \"editable\") {\n      if (this.timeout) clearTimeout(this.timeout);\n    }\n\n  },\n\n  _onMouseLeave: function() {\n    this.$el.removeClass(\"hover\");\n\n    var self = this;\n\n    if (this.editModel.get(\"mode\") == \"editable\") {\n\n      this.timeout = setTimeout(function() {\n\n        self.editModel.set(\"mode\", \"\");\n\n      }, 250);\n    }\n\n  },\n\n  show: function(animated) {\n\n    this.$el.show();\n\n    if (true) this.$el.addClass('animated bounceIn');\n\n  },\n\n  hide: function(callback) {\n\n    var self = this;\n\n    this.$el\n    .removeClass('animated bounceIn')\n    .addClass('animated bounceOut');\n\n    callback && callback();\n\n    // Give it some time to complete the animation\n    setTimeout(function() {\n      self.clean();\n    }, 550);\n\n  },\n\n  _close: function(e) {\n\n    this._killEvent(e);\n\n    var self = this;\n\n    this.dropdown.hide();\n    this.dropdown.clean();\n\n    this.hide(function() {\n      self.trigger(\"remove\", self);\n    });\n\n  },\n\n  _onChangeDisplay: function() {\n\n    var display = this.model.get(\"display\");\n\n    if (display) {\n      this.show();\n    } else {\n      this.$el.hide();\n    }\n\n  },\n\n  _onChangeExtra: function() {\n\n    var extra  = this.model.get(\"extra\");\n    extra.text = this.model.get(\"text\");\n\n    this.model.set({ extra: extra }, { silent: true });\n\n  },\n\n  /*\n   * Applies style to the content of the widget\n   */\n\n  _applyStyle: function() {\n\n    var style      = this.model.get(\"style\");\n\n    var boxColor   = style[\"box-color\"];\n    var boxOpacity = style[\"box-opacity\"];\n    var boxWidth   = style[\"box-width\"];\n    var fontFamily = style[\"font-family-name\"];\n\n    this.$text.css(style);\n    this.$text.css(\"font-size\", style[\"font-size\"] + \"px\");\n\n    var rgbaCol = 'rgba(' + parseInt(boxColor.slice(-6,-4),16)\n    + ',' + parseInt(boxColor.slice(-4,-2),16)\n    + ',' + parseInt(boxColor.slice(-2),16)\n    +', ' + boxOpacity + ' )';\n\n    this.$el.css(\"background-color\", rgbaCol);\n    this.$el.css(\"max-width\", boxWidth);\n\n    var fontFamilyClass = \"\";\n\n    if      (fontFamily  == \"Droid Sans\") fontFamilyClass = \"droid\";\n    else if (fontFamily  == \"Vollkorn\")   fontFamilyClass = \"vollkorn\";\n    else if (fontFamily  == \"Open Sans\")  fontFamilyClass = \"open_sans\";\n    else if (fontFamily  == \"Roboto\")     fontFamilyClass = \"roboto\";\n\n    this.$el.css(\"width\", \"auto\");\n\n    this.$el\n    .removeClass(\"droid\")\n    .removeClass(\"vollkorn\")\n    .removeClass(\"roboto\")\n    .removeClass(\"open_sans\");\n\n    this.$el.addClass(fontFamilyClass);\n\n  },\n\n  _onChangeMode: function() {\n\n    var mode = this.editModel.get(\"mode\");\n\n    if (mode == \"editable\") {\n\n      this._enableEditingMode();\n\n    } else {\n\n      this._disableEditingMode();\n\n    }\n\n  },\n\n  _enableEditingMode: function() {\n\n    var text = this.model.get(\"text\");\n\n    this.$el\n    .addClass(\"editable\")\n    .addClass(\"disabled\");\n\n    this.$text.attr(\"contenteditable\", true).focus();\n\n    this.$el.css(\"width\", \"auto\");\n\n    var self = this;\n\n    setTimeout(function() {\n      self.$text.html(text);\n    }, 100)\n\n  },\n\n  _disableEditingMode: function() {\n\n    var text = this._transformToMarkdown(this.model.get(\"text\"));\n\n    this.editModel.set(\"mode\", \"\");\n\n    if (text) {\n\n      this.$text.html(text);\n\n      this.$el\n      .removeClass(\"editable\")\n      .removeClass(\"disabled\");\n\n      this.$text.attr(\"contenteditable\", false);\n      this.$el.css(\"width\", \"auto\");\n\n      var self = this;\n\n      setTimeout(function() {\n        var width = self.$el.width();\n        self.$el.css(\"width\", width);\n      }, 300);\n\n      this.model.save();\n\n    }\n\n  },\n\n  _setText: function() {\n\n    var text          = this.model.get(\"text\");\n    var rendered_text = this._transformToMarkdown(text);\n\n    var extra = this.model.get(\"extra\");\n\n    extra.text          = text;\n    extra.rendered_text = rendered_text\n\n    this.model.set({ extra: extra }, { silent: true });\n\n    if (rendered_text) this.$text.html(rendered_text);\n\n  },\n\n  _transformToMarkdown: function(text) {\n\n    console.log(text)\n    //return \"code\" + \"<script>\" + text + \"</script>\";\n    return \"code\"; \n\n  },\n\n  _addDropdown: function() {\n\n    var device            = this.model.get(\"device\");\n    var horizontal_offset = 26;\n    var vertical_offset   = 24;\n\n    if (device === \"mobile\") {\n      vertical_offset -= $(\"header\").height() + 12;\n    }\n\n    this.dropdown = new cdb.admin.WidgetPropertiesDropdown({\n      tick: \"left\",\n      target: this.$el.find(\".edit\"),\n      model: this.model,\n      offset_mode: device === 'mobile' ? \"offset\" : \"position\",\n      horizontal_position: \"left\",\n      horizontal_offset: horizontal_offset,\n      vertical_offset: vertical_offset,\n      template_base: 'table/views/overlays/properties_dropdown',\n      form_data: [{\n        name: 'Text Align',\n        form: {\n          'text-align':      { type: 'text_align', value: 'left' },\n        }\n      }, {\n        name: 'Text Style',\n        form: {\n          'font-size':  { type: 'simple_number', value: 12, min: 5, max: 50, inc: 2 },\n          'color':      { type: 'color', value: '#FFF' },\n        }\n\n      }, {\n        name: 'Font',\n        form: {\n          'font-family-name': {\n            type: 'select',\n            value: \"Helvetica\",\n            extra: [\"Helvetica\", \"Droid Sans\", \"Vollkorn\", \"Roboto\", \"Open Sans\"]\n          }\n        }\n      }, {\n\n        name: 'Box Style',\n        form: {\n          'box-color':  { type: 'color', value: '#000' },\n          'box-opacity':  { type: 'simple_opacity', value: .7, min:0, max:1, inc: .1 },\n        }\n\n      }, {\n        name: 'Max Width',\n        form: {\n          'box-width':  { type: 'simple_number', value: 300, min: 50, max: 2000, inc: 10 },\n        }\n\n      }]\n    });\n\n    this._bindDropdown();\n\n    var self = this;\n\n    this.dropdown.on(\"saved\", function() {\n      self.dropdown.move(true);\n    });\n\n    if (this.model.get(\"device\") == \"mobile\") {\n      $(\".map\").append(this.dropdown.render().el);\n    } else {\n      this.$el.append(this.dropdown.render().el);\n    }\n\n  },\n\n  _bindDropdown: function() {\n\n    this.dropdown.bind(\"onDropdownShown\", function() {\n      this.$el.addClass(\"open\");\n\n      this._putOnTop();\n\n    }, this);\n\n    this.dropdown.bind(\"onDropdownHidden\", function() {\n      this.$el.removeClass(\"open\");\n    }, this);\n\n    cdb.god.bind(\"closeDialogs\", this.dropdown.hide, this.dropdown);\n\n  },\n\n  _putOnTop: function() {\n\n    $(\".overlay\").css(\"z-index\", 999);\n    this.$el.css(\"z-index\", 2001);\n\n  },\n\n  _place: function() {\n\n    var landscapeDirection = this.model.get(\"extra\").landscapeDirection;\n    var portraitDirection  = this.model.get(\"extra\").portraitDirection;\n\n    if (portraitDirection == 'bottom') {\n\n      this.$el.offset({\n        top: this.model.get(\"y\")\n      });\n\n      this.$el.css({\n        top: \"auto\",\n        bottom: this.model.get(\"y\")\n      });\n\n    } else {\n      this.$el.offset({\n        top: this.model.get(\"y\")\n      });\n    }\n\n    if (landscapeDirection == 'right') {\n\n      this.$el.offset({\n        left: this.model.get(\"x\")\n      });\n\n      this.$el.css({\n        left: \"auto\",\n        right: this.model.get(\"x\")\n      });\n\n    } else {\n      this.$el.offset({\n        left: this.model.get(\"x\")\n      });\n    }\n\n  },\n\n  render: function() {\n\n    this._place();\n\n    this.$el.append(this.template(this.model.attributes));\n\n    this.$text = this.$el.find(\".content div.text\");\n\n    var text = this._transformToMarkdown(this.model.get(\"text\"));\n\n    this.$text.html(text);\n\n    this._applyStyle();\n    this._onChangeExtra();\n    this._addDropdown();\n\n    return this;\n\n  }\n\n});\n","cdb.admin.overlays.Fullscreen = cdb.core.View.extend({\n\n  tagName: 'div',\n  className: 'cartodb-fullscreen',\n\n  events: {\n    \"click a\": \"_toggleFullScreen\"\n  },\n\n  template_name: 'table/views/overlays/fullscreen',\n\n  initialize: function() {\n\n    _.bindAll(this, \"_close\");\n\n    this.template = this.getTemplate(this.template_name);\n\n    this._setupModels();\n\n  },\n\n  _killEvent: function(e) {\n\n    e && e.preventDefault();\n    e && e.stopPropagation();\n\n  },\n\n  // Setup the internal and custom model\n  _setupModels: function() {\n\n    this.model = this.options.model;\n\n    this.model.on(\"change:display\", this._onChangeDisplay, this);\n    this.model.on(\"change:y\",       this._onChangeY, this);\n\n    this.model.on(\"destroy\", function() {\n      this.$el.remove();\n    }, this);\n\n  },\n\n  _onChangeY: function() {\n\n    var y = this.model.get(\"y\");\n    this.$el.animate({ top: y }, 150);\n\n    this.trigger(\"change_y\", this);\n\n  },\n\n  _onChangeDisplay: function() {\n\n    var display = this.model.get(\"display\");\n\n    if (display) {\n      this.show();\n    } else {\n      this.hide();\n    }\n\n  },\n\n  _onMouseDown:      function() { },\n  _onMouseEnterText: function() { },\n  _onMouseLeaveText: function() { },\n  _onMouseEnter:     function() { },\n  _onMouseLeave:     function() { },\n\n  show: function() {\n\n    var self = this;\n\n    this.$el.fadeIn(250, function() {\n      self.trigger(\"change_y\", self);\n    });\n\n  },\n\n  hide: function(callback) {\n\n    var self = this;\n\n    callback && callback();\n\n    this.$el.fadeOut(250, function() {\n      self.trigger(\"change_y\", self);\n    });\n\n  },\n\n  _close: function(e) {\n\n    this._killEvent(e);\n\n    var self = this;\n\n    this.hide(function() {\n      self.trigger(\"remove\", self);\n    });\n\n  },\n\n  _toggleFullScreen: function(ev) {\n\n    ev.stopPropagation();\n    ev.preventDefault();\n\n    var doc   = window.document;\n    var docEl = doc.documentElement;\n\n    if (this.options.doc) { // we use a custom element\n      docEl = $(this.options.doc)[0];\n    }\n\n    var requestFullScreen = docEl.requestFullscreen || docEl.mozRequestFullScreen || docEl.webkitRequestFullScreen || docEl.msRequestFullscreen;\n    var cancelFullScreen = doc.exitFullscreen || doc.mozCancelFullScreen || doc.webkitExitFullscreen || doc.msExitFullscreen;\n\n    var mapView = this.options.mapView;\n\n    if (!doc.fullscreenElement && !doc.mozFullScreenElement && !doc.webkitFullscreenElement && !doc.msFullscreenElement) {\n\n      requestFullScreen.call(docEl);\n\n      if (mapView) {\n\n        if (this.model.get(\"allowWheelOnFullscreen\")) {\n          mapView.options.map.set(\"scrollwheel\", true);\n        }\n\n      }\n\n    } else {\n\n      cancelFullScreen.call(doc);\n\n    }\n  },\n\n  render: function() {\n\n    var self = this;\n\n    this.$el.append(this.template());\n\n    this.$el.css({ left: this.model.get(\"x\"), top: this.model.get(\"y\") });\n\n    return this;\n\n  }\n\n});\n","cdb.admin.overlays.Header = cdb.admin.overlays.Text.extend({\n\n  className: \"header overlay-static\",\n\n  template_name: 'table/views/overlays/header',\n\n  events: { },\n\n  _close:             function() { },\n  _applyStyle:        function() { },\n  _onChangeMode:      function() { },\n  _enableEditingMode: function() { },\n  _onMouseLeave:      function() { },\n  _onMouseEnter:      function() { },\n  _onKeyUp:           function() { },\n  _onKeyDown:         function() { },\n\n  initialize: function() {\n\n    _.bindAll(this, \"_close\", \"_dblClick\", \"_onChangeMode\", \"_onKeyDown\");\n\n    // Bind ESC key\n    $(document).bind('keydown', this._onKeyDown);\n\n    this.template = this.getTemplate(this.template_name);\n\n    this._setupModel();\n\n  },\n\n  _setupModel: function() {\n\n    this.model = this.options.model;\n\n    this.model.set({ mode: \"\" }, { silent: true })\n\n    this.model.bind('change:show_title',        this._onChangeShowTitle,  this);\n    this.model.bind('change:show_description',  this._onChangeShowDescription,  this);\n\n    this.model.bind('change:style',             this._applyStyle, this);\n    this.model.bind(\"change:display\",           this._onChangeDisplay, this);\n    this.model.bind('change:title',             this._onChangeTitle,  this);\n    this.model.bind('change:description',       this._onChangeDescription,  this);\n    this.model.bind('change:mode',              this._onChangeMode,  this);\n    this.model.bind(\"change:y\",                 this._onChangeY, this);\n\n    this.model.on(\"destroy\", function() {\n      this.$el.remove();\n    }, this);\n\n  },\n\n  isVisible: function() {\n\n    return (this.model.get(\"title\") && this.model.get(\"show_title\")) || (this.model.get(\"description\") && this.model.get(\"show_description\"));\n\n  },\n\n  _dblClick: function(e) {\n\n    this._killEvent(e);\n\n  },\n\n  _onChangeShowDescription: function() {\n\n    var self = this;\n\n    var display         = this.model.get(\"display\");\n    var showTitle       = this.model.get(\"title\") && this.model.get(\"show_title\");\n    var showDescription = this.model.get(\"description\") && this.model.get(\"show_description\");\n    var extra           = this.model.get(\"extra\");\n\n    extra[\"show_description\"] = this.model.get(\"show_description\");\n\n    if (display && showDescription) {\n\n      this.$el.show();\n      this.$description.show();\n\n      this.trigger(\"change_y\");\n\n    } else {\n\n      this.$description.hide();\n      if (!showTitle) this.$el.hide();\n\n      this.trigger(\"change_y\");\n\n    }\n\n    this.model.set({ extra: extra }, { silent: true });\n\n  },\n\n  _onChangeY: function() {\n\n    var y = this.model.get(\"y\");\n    this.$el.animate({ top: y }, 150);\n\n  },\n\n  _onChangeDisplay: function() {\n\n    var display = this.model.get(\"display\");\n\n    if (display) {\n      this.show();\n    } else {\n      this.$el.hide();\n    }\n\n  },\n\n  _onChangeShowTitle: function() {\n\n    var self = this;\n\n    var display         = this.model.get(\"display\");\n    var showTitle       = this.model.get(\"title\") && this.model.get(\"show_title\");\n    var showDescription = this.model.get(\"description\") && this.model.get(\"show_description\");\n\n    var extra           = this.model.get(\"extra\");\n    extra[\"show_title\"] = this.model.get(\"show_title\");\n\n    if (display && showTitle) {\n\n      this.$el.show();\n      this.$title.show();\n\n      this.trigger(\"change_y\");\n\n    } else {\n\n      this.$title.hide();\n\n      if (!showDescription) {\n        this.$el.hide();\n      }\n\n      this.trigger(\"change_y\");\n\n    }\n\n    this.model.set({ extra: extra }, { silent: true });\n\n  },\n\n  _onChangeTitle: function() {\n    this.$el.find(\".title\").html(this.model.get(\"title\"));\n\n    var extra = this.model.get(\"extra\");\n    extra.title = this.model.get(\"title\");\n    this.model.set({ extra: extra }, { silent: true });\n\n    this.show();\n  },\n\n  _onChangeDescription: function() {\n    var description = this.model.get(\"description\");\n    var show_description = true;\n\n    if (!description || !description.trim().length) {\n      show_description = false;\n    }\n\n    this.$(\".description\").html(\n      this._getMarkdown(description)\n    );\n\n    var extra = this.model.get(\"extra\");\n\n    extra.description = description;\n\n    this.model.save({ extra: extra, show_description: show_description }, { silent: true });\n\n    this.show();\n  },\n\n  show: function() {\n    var display        = this.model.get(\"display\");\n    var hasTitle       = this.model.get(\"title\") && this.model.get(\"show_title\");\n    var hasDescription = this.model.get(\"description\") && this.model.get(\"show_description\");\n\n    if (display && (hasTitle || hasDescription)) {\n\n      this.$el.show();\n\n      if (hasTitle)       this.$title.show();\n      if (hasDescription) this.$description.show();\n\n      this.trigger(\"change_y\");\n    }\n  },\n\n  hide: function() {},\n\n  _getMarkdown: function(content) {\n\n    content = cdb.Utils.stripHTML(content);\n    content = markdown.toHTML(content);\n    content = cdb.Utils.stripHTML(content, '<a><i><em><strong><b><u><s>');\n    content = content.replace(/&#39;/g, \"'\"); // replaces single quote\n\n    return cdb.core.sanitize.html(content);\n\n  },\n\n  render: function() {\n\n    this.$el.offset({\n      top:  this.model.get(\"y\"),\n      left: this.model.get(\"x\")\n    });\n\n    this.extra = this.model.get(\"extra\");\n\n    this.model.set({\n      title:            this.extra.title,\n      description:      this.extra.description,\n      show_title:       this.extra.show_title,\n      show_description: this.extra.show_description\n    }, { silent: true });\n\n    var attributes = _.chain(this.model.attributes)\n      .clone()\n      .extend({\n        description: this._getMarkdown(this.model.get(\"description\"))\n      })\n      .value();\n\n    this.$el.append(this.template(attributes));\n\n    this.$title       = this.$el.find(\".content div.title\");\n    this.$description = this.$el.find(\".content div.description\");\n\n    this._onChangeDisplay();\n\n    return this;\n  }\n\n});\n","cdb.admin.overlays.Image = cdb.admin.overlays.Text.extend({\n\n  className: \"image overlay snap\",\n\n  events: {\n\n    \"mouseenter .text\":  \"_onMouseEnter\",\n\n    \"click .close\":      \"_close\",\n    \"click .content\":    \"_onClickEdit\",\n    \"click .text\":       \"_onClickEdit\",\n    \"dblclick .content\": \"_onDblClick\",\n    \"dblclick .text\":    \"_onDblClick\",\n\n    \"keyup .text\":       \"_onKeyUp\",\n    \"paste .text\":       \"_onPaste\"\n\n  },\n\n  initialize: function() {\n\n    _.bindAll(this, \"_close\", \"_onDblClick\", \"_onChangeMode\", \"_onKeyDown\", \"_onLoadSuccess\", \"_onLoadError\");\n\n    // Bind ESC key\n    $(document).bind('keydown', this._onKeyDown);\n\n    this.template = this.getTemplate('table/views/overlays/image');\n    this.image_template =  _.template(\"<img src='<%- url %>' style='width: <%- width %>px'/>\");\n\n    this._setupModels();\n\n    this.form_data = [{\n      name: 'Box',\n      form: {\n        'box-color':  { type: 'color', value: '#000', extra: { tick: \"left\", picker_vertical_position: \"down\", picker_horizontal_position: \"left\" }},\n        'box-opacity':  { type: 'simple_opacity', value: .7, min:0, max:1, inc: .1, disable_triggering: true },\n      }\n\n    }, {\n      name: 'Width',\n      form: {\n        'box-width':  { type: 'simple_number', value: 300, min: 50, max: 2000, inc: 10, disable_triggering: true },\n      }\n\n    }];\n\n  },\n\n  // Setup the internal and custom model\n  _setupModels: function() {\n\n    var self  = this;\n    var extra = this.model.get(\"extra\");\n\n    this.model.set({ url: extra.url }, { silent: true });\n\n    var applyStyle = function() {\n      self._applyStyle(true);\n    };\n\n    // Bindings\n    this.model.bind('remove',   this.hide, this);\n    this.model.bind('change:url',     this._setURL,          this);\n    this.model.bind('change:style',   applyStyle,            this);\n    this.model.bind('change:extra',   this._onChangeExtra,   this);\n    this.model.bind('change:display', this._onChangeDisplay, this);\n    this.model.bind('change:selected', this._onChangeSelected, this);\n\n    // Internal model to store the editing state\n    this.editModel = new cdb.core.Model({ mode: \"\" });\n    this.editModel.bind('change:mode', this._onChangeMode, this);\n\n    this.add_related_model(this.editModel);\n\n  },\n\n  // Element events \n  _onKeyUp: function(e) {\n\n    var self = this;\n\n    var temp      = \"\";\n    var domString = \"\";\n\n    if (this.timeout)      clearTimeout(this.timeout);\n    if (this.keyUpTimeout) clearTimeout(this.keyUpTimeout);\n    if (this.savingTimeout) clearTimeout(this.savingTimeout);\n\n    var value = this.$text.html();\n\n    if (cdb.Utils.stripHTML(value) == \"\") {\n\n      this.keyUpTimeout = setTimeout(function() {\n\n        self.model.set({ url: \"\" }, { silent: true });\n        self._close();\n\n      }, 600);\n\n    }  else {\n\n\n      if (cdb.Utils.isURL(value)) {\n        this.model.set({ url: value }, { silent: true });\n      }\n\n      if (!this.$el.hasClass(\"hover\") && this.$text.text()) {\n        this.savingTimeout = setTimeout(function() {\n\n          self._disableEditingMode();\n\n        }, 500);\n\n      }\n\n    }\n\n  },\n\n  _onPaste: function(e) {\n\n    var self = this;\n\n    setTimeout(function() {\n      var text = cdb.Utils.stripHTML(self.$text.text());\n\n      if (cdb.Utils.isURL(text)) {\n        self.model.set(\"url\", text);\n        self.editModel.set(\"mode\", \"loading\");\n      }\n\n    }, 300);\n\n  },\n\n  _onMouseDown:      function() { },\n  _onMouseEnterText: function() { },\n  _onMouseLeaveText: function() { },\n\n  /*\n   * Applies style to the content of the overlay\n   */\n\n  _applyStyle: function(save) {\n\n    var style      = this.model.get(\"style\");\n\n    var boxColor   = style[\"box-color\"];\n    var boxOpacity = style[\"box-opacity\"];\n    var boxWidth   = style[\"box-width\"];\n\n    this.$text.css(style);\n    this.$text.css(\"font-size\", style[\"font-size\"] + \"px\");\n\n    this.$el.css(\"z-index\", style[\"z-index\"]);\n\n    var rgbaCol = 'rgba(' + parseInt(boxColor.slice(-6,-4),16)\n    + ',' + parseInt(boxColor.slice(-4,-2),16)\n    + ',' + parseInt(boxColor.slice(-2),16)\n    +', ' + boxOpacity + ' )';\n\n    this.$el.css(\"background-color\", rgbaCol);\n    this.$(\"img\").css(\"width\", boxWidth);\n\n    if (save) this.model.save();\n\n  },\n\n  _enableEditingMode: function() {\n\n    var self = this;\n    var text = this.model.get(\"url\");\n\n    this.$el\n    .removeClass(\"error\")\n    .addClass(\"editable disabled\");\n\n    this.$text.attr(\"contenteditable\", true).focus();\n\n    setTimeout(function() {\n\n      var h = self.$text.outerHeight(true);\n      var w = self.$text.width();\n\n      self.$text.html(text);\n      self.$text.css({ minWidth: w });\n\n    }, 100);\n\n  },\n\n  _disableEditingMode: function() {\n\n    var url       = this.model.get(\"url\");\n    var style     = this.model.get(\"style\");\n    var boxWidth  = style[\"box-width\"];\n    var extra     = this.model.get(\"extra\");\n    var img       = \"<img src='\" + url + \"' style='width: \" + boxWidth + \"px'/>\";\n\n    this.$el.removeClass(\"editable disabled\");\n\n    this.editModel.set(\"mode\", \"\");\n\n    if (!this.error) this.$el.removeClass(\"error\");\n    else this.$el.addClass(\"error\");\n\n    this.$text.html(img);\n    this.$text.attr(\"contenteditable\", false);\n\n    extra.url = url;\n\n    extra.rendered_text = this.image_template({ url: url, width: boxWidth });\n\n    if (extra.url !== extra.default_image_url) {\n      extra.has_default_image = false;\n    }\n\n    this.model.set({ extra: extra }, { silent: true });\n\n    this.model.save();\n\n    this.$text.css({ height: \"auto\", minHeight: \"0\", minWidth: \"0\" });\n\n  },\n\n  _setURL: function() {\n    this._loadImage(this.model.get(\"url\"));\n  },\n\n  _loadImage: function(url) {\n\n    var self = this;\n\n    var success = function() {\n      self._onLoadSuccess(url);\n    };\n\n    var error = function() {\n      self._onLoadError(url);\n    };\n\n    $(\"<img/>\")\n    .load(success)\n    .error(error)\n    .attr(\"src\", url);\n\n  },\n\n  _onLoadError: function(url) {\n    this.$el.addClass('error');\n    this.error = true;\n  },\n\n  _onLoadSuccess: function(url) {\n\n    this.$el.removeClass(\"error\");\n\n    this.error = false;\n\n    var style     = this.model.get(\"style\");\n    var boxWidth  = style[\"box-width\"];\n    var extra     = this.model.get(\"extra\");\n    var img       = this.image_template({ url: url, width: boxWidth });\n\n    extra.rendered_text = img;\n\n    this.model.set({ extra: extra }, { silent: true });\n\n    this.$el.removeClass(\"editable disabled\");\n\n    this.$text.html(img);\n    this.$text.attr(\"contenteditable\", false);\n    this.$text.css(\"height\", \"auto\");\n\n    this.editModel.set(\"mode\", \"\");\n\n    if (this.model.get(\"display\")) {\n      this.show();\n    }\n\n  },\n\n  _addDropdown: function() {\n\n    this.dropdown = new cdb.admin.OverlayPropertiesDropdown({\n      tick: \"left\",\n      target: this.$(\".edit\"),\n      model: this.model,\n      horizontal_position: \"left\",\n      horizontal_offset: 26,\n      vertical_offset: 24,\n      template_base: 'table/views/overlays/properties_dropdown',\n      form_data: this.form_data\n    });\n\n    var self = this;\n\n    this.dropdown.on(\"saved\", function() {\n      self.dropdown.move();\n    });\n\n    this._bindDropdown();\n\n    this.$el.append(this.dropdown.render().el);\n\n  },\n\n  _bindDropdown: function() {\n\n    this.dropdown.bind(\"onDropdownShown\", function() {\n      this.$el.addClass(\"open\");\n    }, this);\n\n    this.dropdown.bind(\"onDropdownHidden\", function() {\n      this.$el.removeClass(\"open\");\n    }, this);\n\n    cdb.god.bind(\"closeDialogs\", this.dropdown.hide, this.dropdown);\n\n  },\n\n  _onChangeMode: function() {\n\n    var mode = this.editModel.get(\"mode\");\n\n    this.trigger('editing', mode === 'editable', this);\n\n    if (mode === \"editable\") {\n      this._enableEditingMode();\n    } else {\n      this._disableEditingMode();\n    }\n\n  },\n\n  clean: function() {\n    $(document).unbind('keydown', this._onKeyDown, this);\n    cdb.core.View.prototype.clean.call(this);\n  },\n\n  render: function() {\n\n    this._place();\n\n    this.$el.append(this.template());\n\n    this.$text = this.$(\".content div.text\");\n\n    this._setURL();\n    this._applyStyle(false);\n\n    this.$el.addClass(this.model.get(\"device\"));\n\n    cdb.god.unbind(\"closeDialogs\", this._onCloseDialogs, this);\n    cdb.god.bind(\"closeDialogs\", this._onCloseDialogs, this);\n\n    return this;\n\n  }\n\n});\n\n","cdb.admin.overlays.LayerSelector = cdb.core.View.extend({\n\n  tagName: 'div',\n  className: 'cartodb-layer-selector-box',\n\n  events: {\n    \"click\":     '_openDropdown',\n    \"dblclick\":  'killEvent',\n    \"mousedown\": 'killEvent'\n  },\n\n  default_options: {\n    timeout: 0,\n    msg: ''\n  },\n\n  initialize: function() {\n\n    _.bindAll(this, \"_close\");\n\n    this.map      = this.options.mapView.map;\n    this.mapView  = this.options.mapView;\n\n    this.mapView.bind('click zoomstart drag', function() {\n      this.dropdown && this.dropdown.hide()\n    }, this);\n\n    this.add_related_model(this.mapView);\n\n    this.layers = [];\n\n    this.map = this.options.map;\n\n    _.defaults(this.options, this.default_options);\n\n    this._setupModels();\n\n  },\n\n  _killEvent: function(e) {\n\n    e && e.preventDefault();\n    e && e.stopPropagation();\n\n  },\n\n  // Setup the internal and custom model\n  _setupModels: function() {\n\n    this.model = this.options.model;\n\n    this.model.on(\"change:display\", this._onChangeDisplay, this);\n    this.model.on(\"change:y\",       this._onChangeY, this);\n    this.model.on(\"change:x\",       this._onChangeX, this);\n\n    this.model.on(\"destroy\", function() {\n      this.$el.remove();\n    }, this);\n\n  },\n\n  _onChangeX: function() {\n\n    var x = this.model.get(\"x\");\n    this.$el.animate({ right: x }, 150);\n\n    this.trigger(\"change_x\", this);\n\n    //this.model.save();\n\n  },\n\n  _onChangeY: function() {\n\n    var y = this.model.get(\"y\");\n    this.$el.animate({ top: y }, 150);\n\n    this.trigger(\"change_y\", this);\n\n    //this.model.save();\n\n  },\n\n  _onChangeDisplay: function() {\n\n    var display = this.model.get(\"display\");\n\n    if (display) {\n      this.show();\n    } else {\n      this.hide();\n    }\n\n  },\n\n  _checkZoom: function() {\n    var zoom = this.map.get('zoom');\n    this.$('.zoom_in')[ zoom < this.map.get('maxZoom') ? 'removeClass' : 'addClass' ]('disabled')\n    this.$('.zoom_out')[ zoom > this.map.get('minZoom') ? 'removeClass' : 'addClass' ]('disabled')\n  },\n\n  zoom_in: function(ev) {\n    if (this.map.get(\"maxZoom\") > this.map.getZoom()) {\n      this.map.setZoom(this.map.getZoom() + 1);\n    }\n    ev.preventDefault();\n    ev.stopPropagation();\n  },\n\n  zoom_out: function(ev) {\n    if (this.map.get(\"minZoom\") < this.map.getZoom()) {\n      this.map.setZoom(this.map.getZoom() - 1);\n    }\n    ev.preventDefault();\n    ev.stopPropagation();\n  },\n\n  _onMouseDown:      function() { },\n  _onMouseEnterText: function() { },\n  _onMouseLeaveText: function() { },\n  _onMouseEnter:     function() { },\n  _onMouseLeave:     function() { },\n\n  show: function() {\n\n    this.$el.fadeIn(250);\n\n  },\n\n  hide: function(callback) {\n\n    var self = this;\n\n    callback && callback();\n\n    this.$el.fadeOut(250);\n\n  },\n\n  _close: function(e) {\n\n    this._killEvent(e);\n\n    var self = this;\n\n    this.hide(function() {\n      self.trigger(\"remove\", self);\n    });\n\n  },\n\n  _toggleFullScreen: function(ev) {\n\n    ev.stopPropagation();\n    ev.preventDefault();\n\n    var doc   = window.document;\n    var docEl = doc.documentElement;\n\n    if (this.options.doc) { // we use a custom element\n      docEl = $(this.options.doc)[0];\n    }\n\n    var requestFullScreen = docEl.requestFullscreen || docEl.mozRequestFullScreen || docEl.webkitRequestFullScreen;\n    var cancelFullScreen  = doc.exitFullscreen || doc.mozCancelFullScreen || doc.webkitExitFullscreen;\n\n    var mapView = this.options.mapView;\n\n    if (!doc.fullscreenElement && !doc.mozFullScreenElement && !doc.webkitFullscreenElement) {\n\n      requestFullScreen.call(docEl);\n\n      if (mapView) {\n\n        if (this.model.get(\"allowWheelOnFullscreen\")) {\n          mapView.options.map.set(\"scrollwheel\", true);\n        }\n\n      }\n\n    } else {\n\n      cancelFullScreen.call(doc);\n\n    }\n  },\n\n  _getLayers: function() {\n    var self = this;\n    this.layers = [];\n\n    _.each(this.mapView.map.layers.models, function(layer) {\n\n      if (layer.get(\"type\") == 'layergroup' || layer.get('type') === 'namedmap') {\n        var layerGroupView = self.mapView.getLayerByCid(layer.cid);\n        for (var i = 0 ; i < layerGroupView.getLayerCount(); ++i) {\n          var l = layerGroupView.getLayer(i);\n          var m = new cdb.core.Model(l);\n          m.set('order', i);\n          m.set('type', 'layergroup');\n\n          m.set('visible', !layerGroupView.getSubLayer(i).get('hidden'));\n\n          m.bind('change:visible', function(model) {\n\n            this.trigger(\"change:visible\", model.get('visible'), model.get('order'), model);\n            model.save();\n\n          }, self);\n\n          if(self.options.layer_names) {\n            m.set('layer_name', self.options.layer_names[i]);\n          } else {\n            m.set('layer_name', l.options.layer_name);\n          }\n\n          var layerView = self._createLayer('LayerViewFromLayerGroup', {\n            model: m,\n            layerView: layerGroupView,\n            layerIndex: i\n          });\n\n          layerView.bind('switchChanged', self._setCount, self);\n\n          self.layers.push(layerView);\n        }\n\n      } else if (layer.get(\"type\") === \"CartoDB\" || layer.get('type') === 'torque') {\n\n        var layerView = self._createLayer('LayerView', { model: layer });\n        layerView.bind('switchChanged', self._setCount, self);\n\n\n        self.layers.push(layerView);\n\n        layerView.model.bind('change:visible', function(model) {\n\n          this.trigger(\"change:visible\", model.get('visible'), model.get('order'), model);\n          model.save();\n\n        }, self);\n\n      }\n\n    });\n  },\n\n  _createLayer: function(_class, opts) {\n    var layerView = new cdb.geo.ui[_class](opts);\n    this.$(\"ul\").append(layerView.render().el);\n    this.addView(layerView);\n    return layerView;\n  },\n\n  _setCount: function() {\n    var count = 0;\n    for (var i = 0, l = this.layers.length; i < l; ++i) {\n      var lyr = this.layers[i];\n\n      if (lyr.model.get('visible')) {\n        count++;\n      }\n    }\n\n    this.$('.count').text(count);\n    this.trigger(\"switchChanged\", this);\n  },\n\n  _openDropdown: function() {\n    this.dropdown.open();\n  },\n\n  render: function() {\n\n    var self = this;\n\n    this.$el.html(this.options.template(this.options));\n\n    this.$el.css({ right: this.model.get(\"x\"), top: this.model.get(\"y\") });\n\n    this.dropdown = new cdb.ui.common.Dropdown({\n      className:\"cartodb-dropdown border\",\n      template: this.options.dropdown_template,\n      target: this.$el.find(\"a\"),\n      speedIn: 300,\n      speedOut: 200,\n      position: \"position\",\n      tick: \"right\",\n      vertical_position: \"down\",\n      horizontal_position: \"right\",\n      vertical_offset: 7,\n      horizontal_offset: 13\n    });\n\n    if (cdb.god) cdb.god.bind(\"closeDialogs\", this.dropdown.hide, this.dropdown);\n\n    this.$el.append(this.dropdown.render().el);\n\n    this._getLayers();\n    this._setCount();\n\n    return this;\n  }\n\n});\n","cdb.admin.overlays.Loader = cdb.core.View.extend({\n\n  tagName: 'div',\n  className: 'cartodb-tiles-loader',\n\n  template_name: 'table/views/overlays/loader',\n\n  default_options: {\n    animationSpeed: 500\n  },\n\n  initialize: function() {\n\n    _.bindAll(this, \"_close\");\n\n    this.isVisible = 0;\n    this.template = this.getTemplate(this.template_name);\n\n    this.map = this.options.map;\n\n    _.defaults(this.options, this.default_options);\n\n    this._setupModels();\n\n  },\n\n  _killEvent: function(e) {\n\n    e && e.preventDefault();\n    e && e.stopPropagation();\n\n  },\n\n  // Setup the internal and custom model\n  _setupModels: function() {\n\n    this.model = this.options.model;\n\n    this.model.on(\"change:y\", this._onChangeY, this);\n\n    this.map.bind('change:zoom change:minZoom change:maxZoom', this._checkZoom, this);\n\n  },\n\n  _onChangeY: function() {\n\n    var y = this.model.get(\"y\");\n    this.$el.animate({ top: y }, 150);\n\n  },\n\n  _onChangeDisplay: function() {\n\n    var display = this.model.get(\"display\");\n\n    if (display) {\n      this.show();\n    } else {\n      this.hide();\n    }\n\n  },\n\n  show: function(ev) {\n\n    if (this.isVisible) return;\n\n    if (!$.browser.msie || ($.browser.msie && $.browser.version.indexOf(\"9.\") != 0)) {\n      this.$el.fadeIn(this.options.animationSpeed);\n    } else {\n      this.$el.show();\n    }\n\n    this.isVisible++;\n  },\n\n  hide: function(ev) {\n\n    this.isVisible--;\n\n    if (this.isVisible > 0) return;\n\n    this.isVisible = 0;\n\n    if (!$.browser.msie || ($.browser.msie && $.browser.version.indexOf(\"9.\") == 0)) {\n      this.$el.fadeOut(this.options.animationSpeed);\n    } else {\n      this.$el.hide();\n    }\n\n  },\n\n  visible: function() {\n    return this.isVisible > 0;\n  },\n\n  _onMouseDown:      function() { },\n  _onMouseEnterText: function() { },\n  _onMouseLeaveText: function() { },\n  _onMouseEnter:     function() { },\n  _onMouseLeave:     function() { },\n\n  _close: function(e) {\n\n    this._killEvent(e);\n\n    var self = this;\n\n    this.hide(function() {\n      self.trigger(\"remove\", self);\n    });\n\n  },\n\n  render: function() {\n\n    var self = this;\n\n    this.$el.html($(this.template(this.options)));\n\n    this.$el.css({ left: this.model.get(\"x\"), top: this.model.get(\"y\") });\n\n    // Create tipsy and set to the tiles loader\n    this.$el.find(\"div.loader\").tipsy({\n      title: function() { return \"Loading tiles...\" },\n      fade: true,\n      offset: 3,\n      gravity: 'w'\n    });\n\n    //if (this.model.get(\"display\")) this.$el.show();\n    //else this.$el.hide();\n\n    return this;\n\n  }\n\n});\n","cdb.admin.overlays.Logo = cdb.admin.overlays.Text.extend({\n\n  className: \"cartodb-logo\",\n\n  template_name: 'table/views/overlays/logo',\n\n  events: { },\n\n  initialize: function() {\n\n    //_.bindAll(this, \"_close\");\n\n    this.template = this.getTemplate(this.template_name);\n\n    this._setupModels();\n\n  },\n\n  _killEvent: function(e) {\n\n    e && e.preventDefault();\n    e && e.stopPropagation();\n\n  },\n\n  // Setup the internal and custom model\n  _setupModels: function() {\n\n    // Binding\n    this.model.bind('change:display', this._onChangeDisplay, this);\n\n    this.model.on(\"destroy\", function() {\n      this.$el.hide();\n    }, this);\n\n  },\n\n  show: function(animated) {\n\n    this.$el.show();\n\n    if (true) this.$el.addClass('animated bounceIn');\n\n  },\n\n  hide: function(callback) {\n\n    var self = this;\n\n    this.$el\n    .removeClass('animated bounceIn')\n    .addClass('animated bounceOut');\n\n    callback && callback();\n\n  },\n\n  _onChangeDisplay: function() {\n\n    var display = this.model.get(\"display\");\n\n    if (display) {\n      this.show();\n    } else {\n      this.$el.hide();\n    }\n\n  },\n\n  render: function() {\n\n    this.$el.append(this.template(this.model.attributes));\n\n    if (this.model.get(\"display\")) this.show();\n\n    this.$el.css({ left: this.model.get(\"x\"), bottom: this.model.get(\"y\") });\n\n    return this;\n\n  }\n\n});\n\n","//\n// manages overlays on the map\n//\n\ncdb.admin.MapOverlays = cdb.core.View.extend({\n\n  initialize: function() {\n    this.overlayViews = [];\n    this.horizontal_overlays = [\"share\", \"layer_selector\", \"search\"];\n    this.vertical_overlays   = [\"zoom\", \"fullscreen\", \"loader\"];\n\n    this.vis        = this.options.vis;\n    this.master_vis = this.options.master_vis;\n\n    this.canvas     = this.options.canvas;\n    this.mapView    = this.options.mapView;\n    this.map        = this.mapView.map;\n    this.mapToolbar = this.options.mapToolbar;\n\n    this.headerMessageIsVisible = this.options.headerMessageIsVisible;\n\n    this._bindOverlays();\n  },\n\n  setHeaderMessageIsVisible: function(visible) {\n    this.headerMessageIsVisible = visible;\n    this._positionOverlaysVertically();\n  },\n\n  _cleanOverlays: function() {\n    if (this.overlays) {\n      _.each(this.overlayViews, function(overlay) {\n        overlay.clean();\n      });\n      this.overlayViews = [];\n      this.zoom = null;\n      this.loader = null;\n      this.fullscreen = null;\n      this.search = null;\n    }\n  },\n\n  getOverlay: function(type) {\n    if (!this.overlays) return;\n    return this.overlays.filter(function(m) { return m.get(\"type\") == type })[0];\n  },\n\n  getHeaderOverlay: function() {\n    return this.getOverlay(\"header\");\n  },\n\n  _hideOverlays: function(mode) {\n    if (!this.overlays) return;\n\n    var hideOverlays = [\"search\"];\n\n    this.overlays.each(function(overlay) {\n      var device = overlay.get(\"device\");\n      if (device === mode) overlay.set(\"display\", false);\n    }, this);\n\n  },\n\n  _showOverlays: function(mode) {\n\n    this.overlays.each(function(overlay) {\n      var device = overlay.get(\"device\");\n      if (device === mode) overlay.set(\"display\", true);\n    }, this);\n\n  },\n\n  _bindOverlays: function() {\n    var self = this;\n\n    this.overlays = this.vis.overlays;\n    this.add_related_model(this.vis.overlays);\n\n    this.overlays.unbind(\"reset\", this._onResetOverlays);\n    this.overlays.unbind(\"remove\");\n    this.overlays.unbind(\"add\");\n\n    this.overlays.bind(\"reset\", this._onResetOverlays, this);\n\n    this.overlays.bind(\"remove\", function(overlay) {\n      overlay.destroy();\n    });\n\n    this.overlays.bind(\"add\", function(overlay) {\n      self._renderOverlay(false, overlay);\n      self._reloadDraggable();\n    });\n\n    this._onResetOverlays(this.overlays);\n\n  },\n\n  _onResetOverlays: function(overlays) {\n    this._cleanOverlays();\n    if (overlays.models.length > 0) {\n      overlays.each(this._setupOverlay, this);\n    }\n  },\n\n  _setupOverlay: function(overlay) {\n    this._renderOverlay(false, overlay);\n  },\n\n  _renderOverlay:  function(delayed_animation, model) {\n    // FIXME - delayed_animation never used ???\n\n    var type         = this._getOverlayType(model);\n    var device       = model.get(\"device\");\n\n    var vis_overlays = [\"Header\", \"Fullscreen\", \"Share\", \"LayerSelector\"];\n    if (_.contains(vis_overlays, type) && this.vis.get(\"type\") === \"table\") {\n      return;\n    }\n\n    var display = (device && device != this.canvas.get(\"mode\")) ? false : true;\n    model.set(\"display\", display);\n\n    var overlay = this._configureOverlay(model);\n    if (!overlay) return;\n\n    this.overlayViews.push(overlay);\n    this.mapView.$el.append(overlay.render().$el);\n    this._bindOverlay(overlay);\n\n    if (type === \"Text\" || type === \"Image\") {\n      this._toggleOverlay(overlay);\n    } else if (type === \"Annotation\") {\n      this._reloadDraggable();\n    }\n\n  },\n\n  //TODO: move to overlay list\n  _configureOverlay: function(model) {\n\n    var type = this._getOverlayType(model);\n    var overlay;\n\n    switch(type) {\n\n      case 'Loader':         overlay = this._setupLoaderOverlay(type, model);          break;\n      case 'Zoom':           overlay = this._setupZoomOverlay(type, model);            break;\n      case 'Share':          overlay = this._setupShareOverlay(type, model);           break;\n      case 'Header':         overlay = this._setupHeaderOverlay(type, model);          break;\n      case 'Search':         overlay = this._setupSearchOverlay(type, model);          break;\n      case 'Logo':           overlay = this._setupCartoDBLogo(type, model);            break;\n      case 'LayerSelector':  overlay = this._setupLayerSelectorOverlay(type, model);   break;\n      case 'Fullscreen':     overlay = this._setupFullScreenOverlay(type, model);      break;\n\n      // Default\n      case 'Text':           overlay = new cdb.admin.overlays[type]({ model: model }); break;\n      case 'Image':          overlay = new cdb.admin.overlays[type]({ model: model }); break;\n      case 'Annotation':     overlay = new cdb.admin.overlays[type]({\n        vis: this.vis,\n        canvas: this.canvas,\n        model: model,\n        mapView: this.mapView\n      }); break;\n\n    }\n\n    return overlay;\n\n  },\n\n  _getOverlayType: function(data) {\n\n    var type = data.get(\"type\");\n\n    if (!type) type = \"text\";\n\n    return _.map(type.split(\"_\"), function(word) {\n      return word.slice(0, 1).toUpperCase() + word.slice(1);\n    }).join(\"\");\n\n  },\n\n  _positionOverlaysHorizontally: function() {\n\n    _.each(this.horizontal_overlays, function(type) {\n      var overlay_model = this.getOverlay(type);\n      if (overlay_model) this._positionOverlay(overlay_model)\n    }, this);\n\n  },\n\n  _positionOverlaysVertically: function(move_header) {\n\n    if (!this.overlays) return;\n\n    if (move_header) {\n\n      var header = this.getHeaderOverlay();\n      this._positionOverlay(header);\n    }\n\n    _.each(this.horizontal_overlays, function(type) {\n\n      var overlay_model = this.getOverlay(type);\n      if (overlay_model) this._positionOverlay(overlay_model)\n\n    }, this);\n\n    _.each(this.vertical_overlays, function(type) {\n\n      var overlay_model = this.getOverlay(type);\n      if (overlay_model) this._positionOverlay(overlay_model);\n\n    }, this);\n\n  },\n\n  _duplicate: function(model) {\n\n    var m = model.cloneAttributes();\n    var extra = m.extra;\n\n    var canvas_mode = this.options.canvas.get(\"mode\");\n    var indexes = this.overlays.getOverlaysZIndex(canvas_mode);\n    var zIndex   = _.max(indexes);\n\n    var style = m.style;\n\n    style['z-index'] = zIndex + 1;\n\n    if (model.get('type') === 'annotation') {\n      var latlng = this._getRandomCenter(model.get('extra').latlng);\n      extra.latlng = [latlng.lat, latlng.lng];\n    } else {\n      var point = this._getRandomPoint(model.get('x'), model.get('y'));\n      m.x = point.x;\n      m.y = point.y;\n    }\n\n    var overlay = new cdb.admin.models.Overlay(_.extend(m, { id: null, style: style, extra: extra }));\n    this.overlays.add(overlay);\n    overlay.save();\n  },\n\n\n  paste: function() {\n\n    if (!this._copiedOverlay || this._editing) {\n      return;\n    }\n\n    var model = this._copiedOverlay;\n\n    this._duplicate(model);\n  },\n\n  _getRandomPoint: function(x, y) {\n    return { x: x + 50 + Math.round(Math.random() * 50), y: y + 50 + Math.round(Math.random() * 50) };\n  },\n\n  _getRandomCenter: function(latlng) {\n    var center = this.mapView.latLonToPixel(latlng);\n    var xR = center.x + 50 + Math.round(Math.random() * 50);\n    var yR = center.y + 50 + Math.round(Math.random() * 50);\n\n    return this.mapView.pixelToLatLon([xR, yR]);\n  },\n\n  _bindOverlay: function(overlay) {\n\n    if (overlay.model && overlay.model.get(\"type\") === \"header\") {\n      this._positionOverlaysVertically();\n    }\n\n    if (overlay.model && overlay.model.get(\"type\") === 'search') {\n      this._positionSearchOverlay(overlay.model);\n    }\n\n    overlay.bind(\"editing\", function(editing) {\n      this._editing = editing;\n    }, this);\n\n    overlay.bind(\"duplicate\", function(model) {\n      this.editing = true;\n      this._copiedOverlay = model;\n    }, this);\n\n    overlay.bind(\"remove\", function(overlay) {\n      this.overlays.remove(overlay.model);\n      this._removeOverlayPropertiesBar(true);\n    }, this);\n\n    overlay.bind(\"clickEdit\", function(model, form_data) {\n      this._addOverlayPropertiesBar(model, form_data);\n    }, this);\n  },\n\n  _hideToobarOptions: function(model) {\n    if (this.overlayPropertiesBar) {\n      if (this.overlayPropertiesBar.compareModel(model)) { // if the model is the same as the current one, hide the options bar\n        this.mapToolbar.find(\"ul.options\").animate({ top: -100 }, { duration: 200, easing: \"easeInOutQuad\" } );\n      } else { // otherwise, deselect the overlay\n        this.overlayPropertiesBar.deselectOverlay();\n      }\n\n    } else  {\n      this.mapToolbar.find(\"ul.options\").animate({ top: -100 }, { duration: 200, easing: \"easeInOutQuad\" });\n    }\n  },\n\n  _removeOverlayPropertiesBar: function(show_toolbar, model) {\n\n    // Abort the removal if we are clicking in the same overlay to edit\n    if (model && this.overlayPropertiesBar && this.overlayPropertiesBar.compareModel(model)) return;\n\n    if (show_toolbar) this._showToolbarOptions();\n\n    // Attempt to destroy the bar\n    if (this.overlayPropertiesBar) {\n\n      var self = this;\n\n      if (!model) { // if there's no current model, animate the bar\n        this.overlayPropertiesBar.$el.animate({ top: 100 }, { duration: 150, complete: function() {\n          self.overlayPropertiesBar.clean();\n          delete self.overlayPropertiesBar;\n        }});\n\n        return false;\n\n      } else { // otherwise, just remove the bar\n        this.overlayPropertiesBar.clean();\n        delete this.overlayPropertiesBar;\n        return true;\n      }\n    }\n  },\n\n  _showToolbarOptions: function() {\n    var self = this;\n\n    this.mapToolbar.find(\"ul.options\").animate({ top: 0 }, { duration: 250, easing: \"easeInOutQuad\", complete: function() {\n      self.mapToolbar.removeClass(\"animated\");\n    }});\n  },\n\n\n  _addOverlayPropertiesBar: function(model, form_data) {\n\n    if (this.overlaysDropdown) this.overlaysDropdown.hide();\n\n    this.mapToolbar.addClass(\"animated\");\n\n    this._hideToobarOptions(model);\n\n    var animatedRemoval = this._removeOverlayPropertiesBar(false, model);\n\n    if (!this.overlayPropertiesBar) {\n\n      this.overlayPropertiesBar = new cdb.admin.OverlayPropertiesBar({\n        model: model,\n        mapView: this.mapView,\n        overlays: this.overlays,\n        canvas: this.canvas,\n        vis: this.vis,\n        form_data: form_data\n      });\n\n      this.addView(this.overlayPropertiesBar);\n      this.overlayPropertiesBar.bind(\"remove\", this._removeOverlayPropertiesBar, this);\n      this.overlayPropertiesBar.bind(\"copy-overlay\", this._duplicate, this);\n\n      this.mapToolbar.append(this.overlayPropertiesBar.render().el);\n\n      if (!animatedRemoval) {\n        this.overlayPropertiesBar.$el.animate({ top: 0 }, { duration: 200, easing: \"easeInOutQuad\" });\n      } else {\n        this.overlayPropertiesBar.$el.css({ top: 0 });\n      }\n\n    }\n\n  },\n\n  /* Show or hide an overlay */\n  _toggleOverlay: function(overlay, delayed_animation) {\n\n    this._reloadDraggable();\n\n    if (delayed_animation) { // Random animation\n\n      var randomTime = 100 + Math.random() * 900;\n\n      setTimeout(function() {\n        if (overlay.model.get(\"display\")) overlay.show();\n      }, randomTime);\n\n    } else { // Show the overlay right away\n      if (overlay.model.get(\"display\")) overlay.show();\n    }\n\n  },\n\n  _reloadDraggable: function() {\n\n    $(\".overlay\").draggableOverlay({\n      container: $(\".cartodb-map\"),\n      stickiness: 10\n    });\n\n  },\n\n  // SHARE\n\n  _setupShareOverlay: function(type, data) {\n\n    var overlay = this.share = new cdb.admin.overlays[type]({\n      model: data,\n      map: this.map\n    });\n\n    overlay.show();\n\n    this._bindShareOverlay(overlay);\n    return overlay;\n  },\n\n  _bindShareOverlay: function(overlay) {\n\n    var self = this;\n\n    this._positionShareOverlay(overlay.model);\n    this._positionOverlaysHorizontally();\n\n    var onDestroy = function() {\n\n      if (self.share) {\n        self.share.clean();\n        delete self.share;\n      }\n\n      self._positionOverlaysHorizontally();\n\n    };\n\n    overlay.model.bind(\"destroy\", onDestroy, this);\n\n  },\n\n  // LOADER\n\n  _setupLoaderOverlay: function(type, data) {\n\n    if (this.loader) return;\n\n    var overlay = this.loader = new cdb.admin.overlays[type]({\n      model: data,\n      map: this.vis.map\n    });\n\n    this._bindLoaderOverlay(overlay);\n\n    return overlay;\n\n  },\n\n  _bindLoaderOverlay: function(overlay) {\n    this._positionLoaderOverlay(overlay.model);\n  },\n\n  // FULLSCREEN\n\n  _setupFullScreenOverlay: function(type, data) {\n\n    if (this.fullscreen) return;\n\n    var overlay = this.fullscreen = new cdb.admin.overlays[type]({\n      model: data,\n      mapView: this.mapView\n    });\n\n    this._bindFullScreenOverlay(overlay);\n\n    return overlay;\n\n  },\n\n  _bindFullScreenOverlay: function(overlay) {\n\n    var self = this;\n\n    this._positionOverlay(overlay.model);\n\n    var onDestroy = function() {\n      if (self.fullscreen) {\n        self.fullscreen.clean();\n        delete self.fullscreen;\n      }\n    };\n\n    overlay.show();\n\n    overlay.model.bind(\"destroy\", onDestroy, this);\n\n  },\n\n  _setupLayerSelectorOverlay: function(type, data) {\n\n    if (this.layer_selector) return;\n\n    var overlay = this.layer_selector = new cdb.admin.overlays[type]({\n      model: data,\n      mapView: this.mapView,\n      template: this.getTemplate(\"table/views/layer_selector\"),\n      dropdown_template: this.getTemplate(\"table/views/layer_dropdown\")\n    });\n\n    overlay.show();\n\n    this._bindLayerSelectorOverlay(overlay);\n\n    return overlay;\n\n  },\n\n  _bindLayerSelectorOverlay: function(overlay) {\n\n    var self = this;\n\n    this._positionOverlay(overlay.model);\n\n    var onDestroy = function() {\n      if (self.layer_selector) {\n        self.layer_selector.clean();\n        delete self.layer_selector;\n      }\n    };\n\n    overlay.model.bind(\"destroy\", onDestroy, this);\n\n  },\n\n  // ZOOM\n\n  _setupZoomOverlay: function(type, data) {\n\n    if (this.zoom) return;\n\n    var overlay = this.zoom = new cdb.admin.overlays[type]({\n      model: data,\n      map: this.vis.map\n    });\n\n    overlay.show();\n\n    this._bindZoomOverlay(overlay);\n\n    return overlay;\n\n  },\n\n  _bindZoomOverlay: function(overlay) {\n\n    var self = this;\n\n    var n = this.vertical_overlays.indexOf(overlay.model.get(\"type\"));\n\n    for (var i = n ; i< this.vertical_overlays.length; i++) {\n\n      var type = this.vertical_overlays[i];\n\n      var overlay_model = this.getOverlay(type);\n\n      if (overlay_model) this._positionOverlay(overlay_model)\n\n    }\n\n\n    var onDestroy = function() {\n\n      if (self.zoom) {\n        self.zoom.clean();\n        delete self.zoom;\n      }\n\n      var n = this.vertical_overlays.indexOf(overlay.model.get(\"type\"));\n\n      for (var i = n + 1; i< this.vertical_overlays.length; i++) {\n\n        var type = this.vertical_overlays[i];\n\n        var overlay_model = this.getOverlay(type);\n        if (overlay_model) this._positionOverlay(overlay_model)\n\n      }\n\n    };\n\n    overlay.model.bind(\"destroy\", onDestroy, this);\n\n  },\n\n  _setupCartoDBLogo: function(type, data) {\n\n    var overlay = this.cartodb_logo = new cdb.admin.overlays[type]({\n      model: data,\n      map: this.map\n    });\n\n    return overlay;\n\n  },\n\n  _setupSearchOverlay: function(type, data) {\n\n    if (this.search) {\n      return;\n    }\n\n    var overlay = this.search = new cdb.admin.overlays[type]({\n      model: data,\n      relative_position: this.vis.get(\"type\") === \"table\",\n      mapView: this.options.mapView,\n      map: this.map,\n      vis: this.vis,\n      canvas: this.canvas,\n    });\n\n    this._bindSearchOverlay(overlay);\n\n    return overlay;\n\n  },\n\n  _bindSearchOverlay: function(overlay) {\n\n    var self = this;\n\n    this._positionSearchOverlay(overlay.model);\n    this._positionOverlaysHorizontally();\n\n    var onDestroy = function() {\n\n      if (self.search) {\n        self.search.clean();\n        delete self.search;\n      }\n\n      self._positionOverlaysHorizontally();\n\n    };\n\n    overlay.model.bind(\"destroy\", onDestroy, this);\n\n  },\n\n  _setupHeaderOverlay: function(type, data) {\n\n    var overlay = this.header = new cdb.admin.overlays[type]({\n      model: data,\n      map: this.map\n    });\n\n    this._bindHeaderOverlay(overlay);\n\n    return overlay;\n\n  },\n\n  _bindHeaderOverlay: function(overlay) {\n\n    var self = this;\n\n    var onDestroy = function() {\n\n      if (self.header) {\n        self.header.clean();\n        delete self.header;\n      }\n\n      self._positionOverlaysVertically();\n\n    };\n\n    overlay.bind(\"change_y\", this._positionOverlaysVertically, this);\n    overlay.model.bind(\"destroy\", onDestroy, this);\n\n  },\n\n  _getHeaderHeight: function() {\n\n    return $(\".header.overlay-static\").outerHeight(true) || 20;\n\n  },\n\n  _positionOverlay: function(overlay_model) {\n\n    if (!overlay_model) return;\n\n    var type = overlay_model.get(\"type\");\n\n    if      (type === 'header')         this._positionHeaderOverlay(overlay_model);\n    else if (type === 'zoom')           this._positionZoomOverlay(overlay_model);\n    else if (type === 'fullscreen')     this._positionFullScreenOverlay(overlay_model);\n    else if (type === 'share')          this._positionShareOverlay(overlay_model);\n    else if (type === 'loader')         this._positionLoaderOverlay(overlay_model);\n    else if (type === 'search')         this._positionSearchOverlay(overlay_model);\n    else if (type === 'layer_selector') this._positionLayerSelectorOverlay(overlay_model);\n\n  },\n\n  _positionHeaderOverlay: function(overlay_model) {\n\n    if (this.headerMessageIsVisible && this.canvas.get(\"mode\") === 'desktop') overlay_model.set(\"y\", 20);\n    else overlay_model.set(\"y\", 0);\n\n  },\n\n  _positionSearchOverlay: function(overlay_model) {\n\n    var y = this.header ? this._getHeaderHeight() + 20 : 20;\n    var x = this.share  ? 60 : 20;\n\n    if (this.headerMessageIsVisible && this.canvas.get(\"mode\") === 'desktop') overlay_model.set(\"y\", this._getHeaderHeight() + 40);\n    else overlay_model.set(\"y\", y);\n\n    overlay_model.set(\"x\", x);\n\n  },\n\n  _positionLayerSelectorOverlay: function(overlay_model) {\n\n    var y = 20;\n    var x = 20;\n\n    if (this.header) y = this._getHeaderHeight() + 20;\n\n    if      (this.search && this.share) x = 220;\n    else if (this.search)               x = 180;\n    else if (this.share)                x = 60;\n\n    overlay_model.set(\"x\", x);\n\n    if (this.headerMessageIsVisible && this.canvas.get(\"mode\") === 'desktop') overlay_model.set(\"y\", this._getHeaderHeight() + 40);\n    else overlay_model.set(\"y\", y);\n\n  },\n\n  _positionShareOverlay: function(overlay_model) {\n\n    var y = this.header ? this._getHeaderHeight() + 20 : 20;\n\n    if (this.headerMessageIsVisible && this.canvas.get(\"mode\") === 'desktop') overlay_model.set(\"y\", this._getHeaderHeight() + 40);\n    else overlay_model.set(\"y\", y);\n\n  },\n\n  _positionLoaderOverlay: function(overlay_model) {\n\n    var hasSQLHeader = this.headerMessageIsVisible && this.canvas.get(\"mode\") === 'desktop';\n\n    var y = 20;\n\n    if (this.canvas.get(\"mode\") === 'mobile' && this.header) {\n      y = this._getHeaderHeight() + 20;\n    }\n    else if (this.fullscreen) y = this.fullscreen.model.get(\"y\") + 40;\n    else if (this.zoom)       y = this.zoom.model.get(\"y\") + 120;\n    else if (this.header)     y = this._getHeaderHeight() + 20;\n    else if (hasSQLHeader)    y = this._getHeaderHeight() + 40;\n\n    overlay_model.set(\"y\", y);\n\n  },\n\n  _positionZoomOverlay: function(overlay_model) {\n\n    var y = this.header ? this._getHeaderHeight() + 20 : 20;\n\n    if ( this.headerMessageIsVisible) overlay_model.set(\"y\", this._getHeaderHeight() + 40);\n    else overlay_model.set(\"y\", y);\n\n  },\n\n  _positionFullScreenOverlay: function(overlay_model) {\n\n    if      (this.zoom)                   overlay_model.set(\"y\", this.zoom.model.get(\"y\") + 120);\n    else if (this.header)                 overlay_model.set(\"y\", this._getHeaderHeight() + 20);\n    else if (this.headerMessageIsVisible && this.canvas.get(\"mode\") === 'desktop') overlay_model.set(\"y\", this._getHeaderHeight() + 40);\n    else                                  overlay_model.set(\"y\", 20);\n\n  }\n\n});\n","cdb.admin.overlays.MobileLayers = cdb.core.View.extend({\n\n  className: \"layer-container\",\n\n  template:  cdb.core.Template.compile('<div class=\"scrollpane\"><ul class=\"layers\"></ul></div>'),\n\n  initialize: function() {\n\n    this.layers = [];\n    this.layerViews = [];\n\n    this.model = new Backbone.Model({\n      layer_count: 0,\n      show_title: this.options.show_title,\n      force_hidden_title: this.options.force_hidden_title,\n      show_layer_selector: this.options.show_layer_selector,\n      show_legends: this.options.show_legends || false\n    });\n\n    this.model.on(\"change:layer_count\", this._onChangeLayerCount, this);\n    this.model.on(\"change:show_title\", this._onChangeShowTitle, this);\n    this.model.on(\"change:show_legends\", this._onChangeShowLegends, this);\n    this.model.on(\"change:show_layer_selector\", this._onChangeShowLayerSelector, this);\n\n    this.map = this.options.map;\n    this.mapView = this.options.mapView;\n\n    this.map.layers.on(\"change\", function() {\n      this._reloadLayers();\n    }, this);\n\n    _.each(this.map.layers.models, this._getLayer, this);\n\n  },\n\n  getLayerCount: function() {\n    return this.layerViews.length;\n  },\n\n  _onChangeShowLayerSelector: function() {\n    this._reloadLayers();\n  },\n\n  _onChangeShowLegends: function() {\n    this._reloadLayers();\n  },\n\n  _onChangeLayerCount: function() {\n\n    var layerCount = this.model.get(\"layer_count\");\n\n    if (layerCount === 0) {\n      this.trigger(\"hide-layers\", this);\n      if (!this.model.get(\"force_hidden_title\")) this.model.set(\"show_title\", false);\n    } else {\n      this.trigger(\"show-layers\", this);\n      var msg = layerCount + \" layer\" + (layerCount != 1 ? \"s\" : \"\");\n      this.$el.find(\" > h3\").text(msg)\n      if (!this.model.get(\"force_hidden_title\")) this.model.set(\"show_title\", true);\n    }\n\n  },\n\n  _onChangeShowTitle: function() {\n\n    if (this.model.get(\"show_title\")) this._showTitle();\n    else this._hideTitle();\n\n  },\n\n  _addTitle: function() {\n    var layerCount = this.model.get(\"layer_count\");\n    var msg = layerCount + \" layer\" + (layerCount != 1 ? \"s\" : \"\");\n    this.$el.prepend(\"<h3>\" + msg + \"</h3>\");\n    if (!this.model.get(\"show_title\")) this.$el.find(\"> h3\").hide();\n  },\n\n  showTitle: function(force) {\n\n    if (force) this.model.set(\"force_hidden_title\", false);\n    this.model.set(\"show_title\", true);\n\n  },\n\n  hideTitle: function(force) {\n\n    if (force) this.model.set(\"force_hidden_title\", true);\n\n    this.model.set(\"show_title\", false);\n\n  },\n\n  _showTitle: function() {\n    this.$el.find(\"> h3\").show();\n  },\n\n  _hideTitle: function() {\n    this.$el.find(\"> h3\").hide();\n  },\n\n  showLayerSelector: function() {\n    this.model.set(\"show_layer_selector\", true);\n  },\n\n  hideLayerSelector: function() {\n    this.model.set(\"show_layer_selector\", false);\n  },\n\n  toggleLegends: function() {\n    this.model.set(\"show_legends\", !this.model.get(\"show_legends\"));\n  },\n\n  _getLayer: function(layer) {\n    if (layer.get(\"type\") === \"CartoDB\" || layer.get('type') === 'torque') {\n      this.layers.push(layer);\n    }\n  },\n\n  _renderLayer: function(data) {\n\n    var hasLegend = data.legend && data.legend.get(\"type\") !== \"\" && data.legend.get(\"type\") !== \"none\";\n\n    var showLayerSelector = this.model.get(\"show_layer_selector\");\n    var showLegends       = this.model.get(\"show_legends\");\n\n    var layer = new cdb.admin.overlays.MobileLayer({\n      model: data,\n      show_legends: showLegends,\n      show_title:   showLayerSelector,\n      hide_toggle: !showLayerSelector\n    });\n\n    if (layer.model.get(\"type\") === \"torque\" && layer.model.get(\"visible\")) {\n      var torqueLayer = this._getTorqueLayer();\n      this.trigger(\"add-torque\", torqueLayer);\n    }\n\n    // Let's see if we should render the layer\n    if (!showLayerSelector && !showLegends) return;\n    if (!showLayerSelector && !hasLegend) return;\n    if (!showLayerSelector && !data.get(\"visible\")) return;\n\n    if (data.wizard_properties) {\n      data.wizard_properties.off(\"change\", this._onChangeWizardProperties, this);\n      data.wizard_properties.on(\"change\", this._onChangeWizardProperties, this);\n    }\n\n    this.layerViews.push(layer);\n\n    this.addView(layer);\n\n    this.$el.find(\".layers\").append(layer.render().$el);\n\n    layer.bind(\"change_visibility\", this._reInitScrollpane, this);\n\n  },\n\n  _onChangeWizardProperties: function(model) {\n    this._reloadLayers();\n  },\n\n  _getTorqueLayer: function() {\n\n    var layer = this.map.layers.getLayersByType('torque')[0];\n\n    if (layer) {\n      return this.mapView.getLayerByCid(layer.cid);\n    }\n\n  },\n\n  _reloadLayers: function() {\n\n    this.layers = [];\n\n    _.each(this.map.layers.models, this._getLayer, this);\n\n    this._removeTorque();\n    this._removeLayers();\n    this._renderLayers();\n\n  },\n\n  _removeTorque: function() {\n    this.trigger(\"remove-torque\", this);\n  },\n\n  _removeLayers: function() {\n\n    _.each(this.layerViews, function(layer) {\n      layer.clean();\n    }, this);\n\n    this.layerViews = [];\n\n  },\n\n  _renderLayers: function() {\n\n    _.each(this.layers, this._renderLayer, this);\n\n    this.model.set(\"layer_count\", this.layerViews.length);\n\n    this._reInitScrollpane();\n\n  },\n\n  _reInitScrollpane: function() {\n    this.$('.scrollpane').data('jsp') && this.$('.scrollpane').data('jsp').reinitialise();\n  },\n\n  render: function() {\n\n    this.$el.append(this.template);\n\n    this._renderLayers();\n\n    this._addTitle();\n\n    return this;\n  }\n\n});\n\ncdb.admin.overlays.MobileHeader = cdb.core.View.extend({\n\n  className: \"hgroup\",\n\n  template: _.template('<% if (show_title) { %><div class=\"title\"><%- title %></div><% } %><% if (show_description) { %><div class=\"description\"><%- description %><% } %></div>'),\n\n  initialize: function() {\n\n    var extra = this.model.get(\"extra\");\n\n    this.model.on(\"change:title\", this._onChangeTitle, this);\n    this.model.on(\"change:description\", this._onChangeDescription, this);\n\n    this.model.on(\"change:show_title\", this._onChangeShowTitle, this);\n    this.model.on(\"change:show_description\", this._onChangeShowDescription, this);\n\n  },\n\n  _onChangeShowTitle: function() {\n    this.render();\n  },\n\n  _onChangeShowDescription: function() {\n    this.render();\n  },\n\n  _onChangeTitle: function() {\n    this.render();\n  },\n\n  _onChangeDescription: function() {\n    this.render();\n  },\n\n  render: function() {\n\n    var extra = this.model.get(\"extra\");\n\n    var showTitle       = false;\n    var showDescription = false;\n\n    if (extra.title && extra.show_title) {\n      showTitle = true;\n    }\n\n    if (extra.description && extra.show_description) {\n      showDescription = true;\n    }\n\n    this.$el.html(this.template({\n      title: extra.title,\n      show_title:showTitle,\n      description: extra.description,\n      show_description: showDescription\n    }));\n\n    return this;\n\n  }\n\n});\n\ncdb.admin.overlays.MobileLayer = cdb.core.View.extend({\n\n  tagName: \"li\",\n\n  events: {\n    'click h3':    \"_toggle\",\n    \"dblclick\":  \"_stopPropagation\"\n  },\n\n  className: \"cartodb-mobile-layer\",\n\n  template: cdb.core.Template.compile(\"<% if (show_title) { %><h3><span><%- layer_name %></span><% } %><a href='#' class='toggle<%- toggle_class %>'></a></h3>\"),\n\n  /**\n   *  Stop event propagation\n   */\n  _stopPropagation: function(ev) {\n    ev.stopPropagation();\n  },\n\n  initialize: function() {\n\n    _.defaults(this.options, this.default_options);\n\n    this.model.on(\"change:table_name_alias\", this._onChangeLayerName, this);\n    this.model.on(\"change:visible\", this._onChangeVisible, this);\n\n    if (this.model.legend) {\n\n      this.model.legend.off(\"add change remove\", this._reloadLegend, this);\n      this.model.legend.on(\"add change remove\", this._reloadLegend, this);\n\n    }\n\n  },\n\n  _onChangeLayerName: function() {\n\n    this.$el.find(\"h3 span\", this._getLayerName());\n\n  },\n\n  _onChangeVisible: function() {\n\n    this.$el.find(\".legend\")[ this.model.get(\"visible\") ? \"fadeIn\":\"fadeOut\"](150);\n    this.$el[ this.model.get(\"visible\") ? \"removeClass\":\"addClass\"](\"hidden\");\n\n    this.trigger(\"change_visibility\", this);\n\n  },\n\n  _toggle: function(e) {\n\n    e.preventDefault();\n    e.stopPropagation();\n\n    if (this.options.hide_toggle) return;\n\n    this.model.set(\"visible\", !this.model.get(\"visible\"))\n\n  },\n\n  _reloadLegend: function() {\n\n    this.$el.removeClass(\"has-legend\");\n\n    if (this.legend) {\n      this.legend.clean();\n      delete this.legend;\n    }\n\n    this._renderLegend();\n\n  },\n\n  _renderLegend: function() {\n\n    if (!this.options.show_legends) return;\n\n    if (this.model.legend && (this.model.legend.get(\"type\") === \"none\" || !this.model.legend.get(\"type\"))) return;\n    if (this.model.legend && this.model.legend.get(\"items\") && this.model.legend.get(\"items\").length === 0) return;\n\n    this.$el.addClass(\"has-legend\");\n\n    this.legend = new cdb.geo.ui.Legend({ model: this.model.legend });\n\n    this.addView(this.legend);\n\n    this.legend.undelegateEvents();\n\n    this.$el.append(this.legend.render().$el);\n\n  },\n\n  _truncate: function(input, length) {\n    return input.substr(0, length-1) + (input.length > length ? '&hellip;' : '');\n  },\n\n  _getLayerName: function() {\n    return this.model.get(\"table_name_alias\") || this.model.get(\"table_name\");\n  },\n\n  render: function() {\n\n    var attributes = _.extend(this.model.attributes, {\n      show_title: this.options.show_title,\n      layer_name: this._getLayerName(),\n      toggle_class: this.options.hide_toggle ? \" hide\" : \"\"\n    });\n\n    this.$el.html(this.template(attributes));\n\n    if (!this.model.get(\"visible\")) this.$el.addClass(\"hidden\");\n    if (this.model.get(\"legend\"))   this._renderLegend();\n\n    this._onChangeVisible();\n\n    return this;\n  }\n\n});\n\ncdb.admin.overlays.Mobile = cdb.core.View.extend({\n\n  className: \"cartodb-mobile\",\n\n  template_name: \"table/views/mobile\",\n\n  events: {\n    \"click .cartodb-attribution-button\": \"_onAttributionClick\",\n    \"click .toggle\":                     \"_toggle\",\n    \"click .fullscreen\":                 \"_toggleFullScreen\",\n    \"click .backdrop\":                   \"_onBackdropClick\",\n    \"dblclick .aside\":                   \"_stopPropagation\",\n    \"dragstart .aside\":                  \"_checkOrigin\",\n    \"mousedown .aside\":                  \"_checkOrigin\",\n    \"touchstart .aside\":                 \"_checkOrigin\",\n    \"MSPointerDown .aside\":              \"_checkOrigin\",\n  },\n\n  initialize: function() {\n\n    _.bindAll(this, \"_toggle\", \"_reInitScrollpane\");\n\n    _.defaults(this.options, this.default_options);\n\n    this.visibility_options = this.options.visibility_options || {};\n\n    this.mapView = this.options.mapView;\n    this.map     = this.mapView.map;\n\n    this.map.on(\"change:legends\", this._toggleLegends, this);\n\n    this.template = this.options.template ? this.options.template : this.getTemplate(this.template_name);\n\n    this._bindOverlays();\n\n    this.model = new Backbone.Model({\n      open: false,\n      show_layer_selector: false\n    });\n\n    this.model.on(\"change:open\", this._onChangeOpen, this);\n\n  },\n\n  show: function() {\n    this.$el.fadeIn(250);\n  },\n\n  hide: function() {\n    this.$el.fadeOut(250);\n  },\n\n  /**\n   *  Check event origin\n   */\n  _checkOrigin: function(ev) {\n    // If the mouse down come from jspVerticalBar\n    // dont stop the propagation, but if the event\n    // is a touchstart, stop the propagation\n    var come_from_scroll = (($(ev.target).closest(\".jspVerticalBar\").length > 0) && (ev.type != \"touchstart\"));\n\n    if (!come_from_scroll) {\n      ev.stopPropagation();\n    }\n  },\n\n  _stopPropagation: function(ev) {\n    ev.stopPropagation();\n  },\n\n  _onBackdropClick: function(e) {\n\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.$el.find(\".backdrop\").fadeOut(250);\n    this.$el.find(\".cartodb-attribution\").fadeOut(250);\n\n  },\n\n  _onAttributionClick: function(e) {\n\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.$el.find(\".backdrop\").fadeIn(250);\n    this.$el.find(\".cartodb-attribution\").fadeIn(250);\n\n  },\n\n  _toggle: function(e) {\n\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.model.set(\"open\", !this.model.get(\"open\"));\n\n  },\n\n  _toggleLegends: function(){\n    this.layers.toggleLegends();\n  },\n\n  _toggleFullScreen: function(ev) {\n\n    ev.stopPropagation();\n    ev.preventDefault();\n\n    var doc   = window.document;\n    var docEl = doc.documentElement;\n\n    if (this.options.doc) { // we use a custom element\n      docEl = $(this.options.doc)[0];\n    }\n\n    var requestFullScreen = docEl.requestFullscreen || docEl.mozRequestFullScreen || docEl.webkitRequestFullScreen;\n    var cancelFullScreen  = doc.exitFullscreen || doc.mozCancelFullScreen || doc.webkitExitFullscreen;\n\n    var mapView = this.options.mapView;\n\n    if (!doc.fullscreenElement && !doc.mozFullScreenElement && !doc.webkitFullscreenElement) {\n\n      requestFullScreen.call(docEl);\n\n      if (mapView) {\n\n        if (this.model.get(\"allowWheelOnFullscreen\")) {\n          mapView.options.map.set(\"scrollwheel\", true);\n        }\n\n      }\n\n    } else {\n\n      cancelFullScreen.call(doc);\n\n    }\n  },\n\n  _open: function() {\n\n    var right = this.$el.find(\".aside\").width();\n\n    this.$el.find(\".cartodb-header\").animate({ right: right }, 200)\n    this.$el.find(\".aside\").animate({ right: 0 }, 200)\n    this.$el.find(\".cartodb-attribution-button\").animate({ right: right + parseInt(this.$el.find(\".cartodb-attribution-button\").css(\"right\")) }, 200)\n    this.$el.find(\".cartodb-attribution\").animate({ right: right + parseInt(this.$el.find(\".cartodb-attribution-button\").css(\"right\")) }, 200)\n    this._initScrollPane();\n\n  },\n\n  _close: function() {\n\n    this.$el.find(\".cartodb-header\").animate({ right: 0 }, 200)\n    this.$el.find(\".aside\").animate({ right: - this.$el.find(\".aside\").width() }, 200)\n    this.$el.find(\".cartodb-attribution-button\").animate({ right: 20 }, 200)\n    this.$el.find(\".cartodb-attribution\").animate({ right: 20 }, 200)\n\n  },\n\n  default_options: {\n    timeout: 0,\n    msg: ''\n  },\n\n  _stopPropagation: function(ev) {\n    ev.stopPropagation();\n  },\n\n  _bindOverlays: function() {\n\n    this.overlays = this.options.overlays;\n\n    this.overlays.on(\"add\", function() {\n      this._resetOverlays();\n    }, this);\n\n    this.overlays.on(\"remove\", function() {\n      this._resetOverlays();\n    }, this);\n\n  },\n\n  _onChangeOpen: function() {\n    this.model.get(\"open\") ? this._open() : this._close();\n  },\n\n  _createLayer: function(_class, opts) {\n    return new cdb.geo.ui[_class](opts);\n  },\n\n  _reInitScrollpane: function() {\n    this.$('.scrollpane').data('jsp') && this.$('.scrollpane').data('jsp').reinitialise();\n  },\n\n  _removeOverlays: function() {\n    this._removeLayerSelector();\n    this._removeHeader();\n    this._removeSearch();\n    this._removeFullscreen();\n  },\n\n  _resetOverlays: function() {\n    this._removeOverlays();\n    this._renderOverlays();\n\n    if (!this.model.get(\"show_layer_selector\") && !this.model.get(\"show_search\") && !this.map.get(\"legends\")) this.model.set(\"open\", false);\n    if (this.layers.layers.length === 0 && !this.model.get(\"search\")) this.model.set(\"open\", false);\n\n  },\n\n  _renderOverlays: function() {\n\n    _.each(this.overlays.models, function(overlay) {\n\n      var overlayType = overlay.get(\"type\");\n\n      if (overlayType === 'search') {\n        this._addSearch(overlay);\n      }\n\n      if (overlayType === 'layer_selector') {\n        this._addLayerSelector();\n      }\n\n      if (overlayType === 'fullscreen') {\n        this._addFullscreen(overlay);\n      }\n\n      if (overlayType === 'header') {\n        this._addHeader(overlay);\n      }\n\n    }, this);\n\n  },\n\n  render:function() {\n\n    this.$el.html(this.template(this.options));\n\n    this._renderOverlays();\n\n    this._addAttributions();\n\n    this._addLayers();\n\n    return this;\n\n  },\n\n  _initScrollPane: function() {\n\n    if (this.$scrollpane) return;\n\n    var self = this;\n\n    var height       = this.$el.height();\n    this.$scrollpane = this.$el.find(\".scrollpane\");\n\n    setTimeout(function() {\n      self.$scrollpane.css(\"max-height\", height - 60);\n      self.$scrollpane.jScrollPane({ showArrows: true });\n    }, 500);\n\n  },\n\n  _removeLayerSelector: function() {\n    this.model.set(\"show_layer_selector\", false);\n    if (this.layers) this.layers.hideLayerSelector();\n  },\n\n  _addLayerSelector: function(overlay) {\n    this.model.set(\"show_layer_selector\", true);\n    if (this.layers) this.layers.showLayerSelector();\n  },\n\n  _addFullscreen: function(overlay) {\n    this.$el.addClass(\"with-fullscreen\");\n  },\n\n  _addSearch: function(overlay) {\n\n    this.model.set(\"show_search\", true);\n\n    this.search = new cdb.geo.ui.Search({\n      template: this.getTemplate(\"table/views/search_control\"),\n      model: this.options.map,\n      mapView: this.options.mapView\n    });\n\n    this.addView(this.search);\n\n    this.$el.addClass(\"with-search\");\n    this.$el.find(\".aside\").prepend(this.search.render().$el);\n    this.search.$el.find(\"input[type='text']\").attr(\"placeholder\", \"Search for places…\");\n\n    if (this.layers) this.layers.hideTitle(true);\n\n  },\n\n  _addHeader: function(overlay) {\n\n    this.header = new cdb.admin.overlays.MobileHeader({ model: overlay });\n    this.addView(this.header);\n\n    this.$el.addClass(\"with-header\");\n    this.$el.find(\".cartodb-header .content\").append(this.header.render().$el);\n\n  },\n\n  _removeFullscreen: function() {\n    this.$el.removeClass(\"with-fullscreen\");\n  },\n\n  _removeSearch: function() {\n\n    this.model.set(\"show_search\", false);\n\n    this.$el.removeClass(\"with-search\");\n\n    if (this.search) {\n      this.search.clean();\n      delete this.search;\n    }\n\n    if (this.layers) this.layers.showTitle();\n\n  },\n\n  _removeHeader: function() {\n\n    this.$el.removeClass(\"with-header\");\n\n    if (this.header) {\n      this.header.clean();\n      delete this.header;\n    }\n\n  },\n\n  _addAttributions: function() {\n\n    var attributions = \"\";\n\n    this.options.mapView.$el.find(\".leaflet-control-attribution\").hide(); // TODO: remove this from here\n\n    if (this.options.layerView) {\n\n      attributions = this.options.layerView.model.get(\"attribution\");\n      this.$el.find(\".cartodb-attribution\").append(attributions);\n\n    } else if (this.options.map.get(\"attribution\")) {\n\n      attributions = this.options.map.get(\"attribution\");\n\n      _.each(attributions, function(attribution) {\n        var $li = $(\"<li></li>\");\n        var $el = $li.html(attribution);\n        this.$el.find(\".cartodb-attribution\").append($li);\n      }, this);\n\n    }\n\n    if (attributions) {\n      this.$el.find(\".cartodb-attribution-button\").fadeIn(250);\n    }\n\n  },\n\n  _removeLayers: function() {\n\n    this.$el.removeClass(\"with-layers\");\n\n    if (this.layers) {\n      this.layers.clean();\n      delete this.layers;\n    }\n\n  },\n\n  _addLayers: function() {\n\n    this.layers = new cdb.admin.overlays.MobileLayers({\n      map: this.map,\n      mapView: this.mapView,\n      show_legends: this.map.get(\"legends\"),\n      show_title: !this.model.get(\"show_search\"),\n      force_hidden_title: this.model.get(\"show_search\"),\n      show_layer_selector: this.model.get(\"show_layer_selector\")\n    });\n\n    this.layers.bind(\"remove-torque\", function(torqueLayer) {\n      this._removeTorque();\n    }, this);\n\n    this.layers.bind(\"add-torque\", function(torqueLayer) {\n      this._addTorqueLayer(torqueLayer);\n    }, this);\n\n    this.layers.bind(\"show-layers\", function() {\n      this.$el.addClass(\"with-layers\");\n    }, this);\n\n    this.layers.bind(\"hide-layers\", function() {\n      this.$el.removeClass(\"with-layers\");\n    }, this);\n\n    this.addView(this.layers);\n\n    this.$el.find(\".aside\").append(this.layers.render().$el);\n\n  },\n\n  _removeTorque: function() {\n\n    this.$el.removeClass(\"with-torque\");\n\n    if (this.slider) {\n      this.slider.clean();\n      this.slider = null;\n    }\n  },\n\n  _addTorqueLayer: function(layer) {\n\n    this.slider = new cdb.geo.ui.TimeSlider({type: \"time_slider\", layer: layer, map: this.options.map, pos_margin: 0, position: \"none\" , width: \"auto\" });\n\n    this.addView(this.slider);\n\n    this.slider.bind(\"time_clicked\", function() {\n      this.slider.toggleTime();\n    }, this);\n\n    this.$el.find(\".torque\").append(this.slider.render().$el);\n    this.$el.addClass(\"with-torque\");\n\n  }\n\n});\n","cdb.admin.OverlayPropertiesActions =  cdb.core.View.extend({\n\n  events: {\n  \n    \"click .btn-copy\":      \"_onClickCopy\",\n    \"click .btn-delete\":    \"_onClickDelete\",\n    \"click .btn-zIndexInc\": \"_onClickZIndexInc\",\n    \"click .btn-zIndexDec\": \"_onClickZIndexDec\"\n\n  },\n\n  initialize: function() {\n\n    this.template_base = cdb.templates.getTemplate(this.options.template_base);\n\n  },\n\n  _onClickCopy: function(e) {\n\n    this.killEvent(e);\n    this.trigger(\"copy-overlay\", this);\n\n  },\n\n  _onClickDelete: function(e) {\n\n    e.preventDefault();\n    this.trigger(\"delete-overlay\", this);\n\n  },\n\n  _onClickZIndexInc: function(e) {\n\n    this.killEvent(e);\n    this.trigger(\"increase-zindex\", this);\n\n  },\n\n  _onClickZIndexDec: function(e) {\n\n    this.killEvent(e);\n    this.trigger(\"decrease-zindex\", this);\n\n  },\n\n  _enableTipsy: function() {\n\n    var self = this;\n\n    _.each(this.$(\"a[title]\"), function(el){\n      var tooltip = new cdb.common.TipsyTooltip({\n        el: $(el)\n      });\n\n      self.addView(tooltip);\n\n    });\n\n  },\n  render: function() {\n    this.clearSubViews();\n    this.setElement(this.template_base(this.options));\n    this._enableTipsy();\n\n    return this;\n  }\n\n});\n\ncdb.admin.OverlayPropertiesBar =  cdb.core.View.extend({\n\n  className: \"overlay-properties\",\n\n  events: {\n\n    \"click\" : \"killEvent\",\n\n  },\n\n  initialize: function() {\n\n    this.overlays = this.options.overlays;\n\n    this._setupModel();\n    this._addStyleModel();\n\n  },\n\n  _setupModel: function() {\n\n    this.model = this.options.model;\n    this.model.bind(\"remove\", this._remove, this);\n\n  },\n\n  _addStyleModel: function() {\n\n    this.style = new cdb.core.Model(this.model.get(\"style\"));\n\n    this.style.unbind(\"change\", this._setStyle, this);\n    this.style.bind(\"change\", this._setStyle, this); // every time the style changes, store it back in the main model\n\n  },\n\n  _setStyle: function() {\n    this.model.set(\"style\", this.style.toJSON());\n  },\n\n  _addForm: function() {\n\n    var self = this;\n\n    if (!this.form) {\n\n      this.form = new cdb.forms.Form({\n        form_data: this.options.form_data,\n        model: this.style\n      }).on(\"saved\", function() {\n        self.trigger(\"saved\", self);\n      });\n\n      this.addView(this.form);\n      this.$el.append(this.form.render().$el);\n\n    }\n\n  },\n\n  _addActions: function() {\n\n    var self = this;\n\n    if (!this.actions) {\n\n      this.actions = new cdb.admin.OverlayPropertiesActions({\n        template_base: \"table/views/overlays/overlay_properties_actions\",\n        model: this.model\n      }).on(\"copy-overlay\", function() {\n        self.trigger(\"copy-overlay\", self.model, self);\n      }).on(\"delete-overlay\", function() {\n        self.overlays.remove(self.model);\n      }).on(\"decrease-zindex\", function() {\n        self._decreaseOverlayZIndex(self.model);\n      }).on(\"increase-zindex\", function() {\n        self._increaseOverlayZIndex(self.model);\n      }).on(\"saved\", function() {\n        self.trigger(\"saved\", self);\n      });\n\n      this.addView(this.actions);\n      this.$el.find(\"> ul\").append(this.actions.render().$el);\n\n    }\n\n  },\n\n  _decreaseOverlayZIndex: function(model) {\n\n    var canvas_mode = this.options.canvas.get(\"mode\");\n    var indexes = this.overlays.getOverlaysZIndex(canvas_mode);\n    var zIndex   = _.min(indexes);\n\n    var style = _.clone(model.get(\"style\"));\n    if (zIndex > 1) {\n      style[\"z-index\"] = zIndex - 1;\n    }\n    this.style.set(style);\n  },\n\n  _increaseOverlayZIndex: function(model) {\n\n    var canvas_mode = this.options.canvas.get(\"mode\");\n    var indexes = this.overlays.getOverlaysZIndex(canvas_mode);\n    var zIndex   = _.max(indexes);\n\n    var style = _.clone(model.get(\"style\"));\n    style[\"z-index\"] = zIndex + 1;\n    this.style.set(style);\n  },\n\n  _remove: function(a, test) {\n\n    cdb.god.unbind(\"closeDialogs\", this._remove, this);\n    this.trigger(\"remove\", this);\n\n  },\n\n  deselectOverlay: function() {\n\n    this.model.set(\"selected\", false);\n\n  },\n\n  compareModel: function(model) {\n    return model && this.model === model;\n  },\n\n  render: function() {\n\n    this._addForm();\n    this._addActions();\n\n    cdb.god.bind(\"closeDialogs\", this._remove, this);\n\n    return this;\n\n  }\n\n});\n","cdb.admin.OverlayPropertiesDropdown = cdb.ui.common.Dropdown.extend({\n\n  className: 'dropdown properties_dropdown',\n\n  defaults: {\n    speedOut: 100,\n    speedIn: 100\n  },\n\n  events: {\n    \"click\" : \"killEvent\",\n    \"dblclick\" : \"killEvent\"\n  },\n\n  initialize: function() {\n\n    _.bindAll(this, \"open\", \"hide\", \"_handleClick\", \"_onKeyDown\");\n\n    // Extend options\n    _.defaults(this.options, this.defaults);\n\n    // Dropdown template\n    this.template_base = cdb.templates.getTemplate(this.options.template_base);\n\n    // Bind to target\n    $(this.options.target).bind({ \"click\": this._handleClick});\n\n    this._addStyleModel();\n\n    // Bind ESC key\n    $(document).bind('keydown', this._onKeyDown);\n\n    // Is open flag\n    this.isOpen = false;\n\n    this.options.original_vertical_position =  this.options.vertical_position;\n\n  },\n\n  /* Check if the dropdown is visible to hiding with the click on the target */\n  _handleClick: function(ev) {\n    if (ev) {\n      ev.preventDefault();\n    }\n\n    // If visible\n    if (this.isOpen){\n      this.hide();\n    } else{\n      this.open();\n    }\n  },\n\n  /* Defines model for the popup form */\n\n  _addStyleModel: function() {\n\n    this.style = new cdb.core.Model(this.model.get(\"style\"));\n\n    /* Everytime the style changes, store it back in the main model */\n    this.style.bind(\"change\", function() {\n      this.model.set(\"style\", this.style.toJSON());\n    }, this);\n\n  },\n\n  _adjustPosition:function() {\n\n    var top        = this.$el.offset().top;\n    var left       = this.$el.offset().left;\n    var width      = this.$el.width();\n    var height     = this.$el.height();\n\n    var $map = $(\".cartodb-map\");\n\n    var map_width       = $map.width();\n    var map_height      = $map.height();\n    var map_top_offset  = $map.offset().top;\n    var map_left_offset = $map.offset().left;\n\n    // Move tick to the other side if the dropdown is closed to the right border\n    if ((left + width - map_left_offset) > map_width) {\n\n      this.$el\n      .css({ left: \"auto\", right: -6 })\n      .removeClass(\"tick_left\")\n      .addClass(\"tick_right\");\n\n    }\n\n    if (top + height - map_top_offset > map_height) {\n\n      this.$el.css({ top: -height - 13 });\n\n    }\n\n  },\n\n  show: function() {\n\n    var self = this;\n\n    var dfd = $.Deferred();\n\n    // Target\n    var $target = this.options.target;\n\n    this.options.target = $target;\n\n    var topPosition  = this.options.target.position().top;\n    var leftPosition = this.options.target.position().left;\n\n    if (this.options.offset_mode === \"offset\") {\n      topPosition  = this.options.target.offset().top;\n      leftPosition = this.options.target.offset().left;\n    }\n\n    var top  = topPosition  + this.options.vertical_offset;\n    var left = leftPosition + this.options.horizontal_offset;\n\n    //sometimes this dialog is child of a node that is removed\n    //for that reason we link again DOM events just in case\n    this.delegateEvents();\n    this.$el\n    .css({\n      top:  top,\n      left: left,\n      marginTop: self.options.vertical_position == \"down\" ? \"-10px\" : \"10px\",\n      opacity:0,\n      display:\"block\"\n    })\n    .animate({\n      margin: \"0\",\n      opacity: 1\n    }, {\n      \"duration\": this.options.speedIn,\n      \"complete\": function(){\n        dfd.resolve();\n      }\n    });\n\n    if (this.options.offset_mode !== \"offset\") {\n      this._adjustPosition();\n    }\n\n    this.trigger(\"onDropdownShown\", this.el);\n\n    return dfd.promise();\n  },\n\n  move: function(animated) {\n    var dfd = $.Deferred();\n    var self = this;\n\n    // Target\n    var $target = this.options.target;\n\n    this.options.target = $target;\n\n    var topPosition  = this.options.target.position().top;\n    var leftPosition = this.options.target.position().left;\n\n    if (this.options.offset_mode === \"offset\") {\n      topPosition  = this.options.target.offset().top;\n      leftPosition = this.options.target.offset().left;\n    }\n\n    var top  = topPosition  + this.options.vertical_offset;\n    var left = leftPosition + this.options.horizontal_offset;\n\n\n    //sometimes this dialog is child of a node that is removed\n    //for that reason we link again DOM events just in case\n\n    this.delegateEvents();\n\n    if (animated) {\n\n      this.$el\n      .css({ marginTop: 0, display:\"block\" })\n      .animate({ top:  top, left: left\n      }, {\n        \"duration\": this.options.speedIn,\n        \"complete\": function(){ dfd.resolve();\n        } \n      });\n\n    } else {\n\n      this.$el\n      .css({\n        top: top, left: left, marginTop: 0, display:\"block\" })\n        .animate({}, {\n          \"duration\": this.options.speedIn,\n          \"complete\": function(){ dfd.resolve();\n          } \n        });\n    }\n\n    if (this.options.offset_mode !== \"offset\") {\n      this._adjustPosition();\n    }\n\n    this.trigger(\"onDropdownShown\", this.el);\n\n    return dfd.promise();\n\n  },\n\n  open: function(ev, target) {\n\n    var $target = target && $(target) || this.options.target;\n\n    this.options.target = $target;\n\n    this.$el.removeClass(\"vertical_top\");\n    this.$el.removeClass(\"vertical_bottom\");\n\n    if (this.options.offset_mode !== \"offset\") {\n      var t = this.options.target.offset().top + this.options.vertical_offset + this.$el.height() - $(\".cartodb-map\").offset().top > $(\".cartodb-map\").height();\n    }\n\n    if (t) {\n      this.options.vertical_position = \"up\";\n    } else {\n      this.options.vertical_position = this.options.original_vertical_position;\n    }\n\n    this.$el.css({\n      top:  this.options.target.offset().top    + this.options.vertical_offset,\n      left: this.options.target.position().left + this.options.horizontal_offset\n    })\n    .addClass(\n      // Add vertical and horizontal position class\n      (this.options.vertical_position == \"up\" ? \"vertical_top\" : \"vertical_bottom\" )\n      + \" \" +\n        (this.options.horizontal_position == \"right\" ? \"horizontal_right\" : \"horizontal_left\" )\n      + \" \" +\n        // Add tick class\n        \"border tick_\" + this.options.tick\n    );\n\n    // Show it\n    this.show();\n    this._recalcHeight();\n\n    // Dropdown open\n    this.isOpen = true;\n  },\n\n  _onKeyDown: function(e) {\n\n    if (e.keyCode === 27) {\n      this.hide();\n    }\n\n  },\n\n\n  hide: function(done) {\n\n    if (!this.isOpen) {\n      done && done();\n      return;\n    }\n\n    var self    = this;\n    this.isOpen = false;\n\n    this.$el.animate({\n      marginTop: self.options.vertical_position == \"down\" ? \"10px\" : \"-10px\",\n      opacity: 0\n    }, this.options.speedOut, function(){\n\n      // And hide it\n      self.$el.hide();\n\n    });\n\n    this.trigger(\"onDropdownHidden\",this.el);\n  },\n\n  _recalcHeight: function() {\n\n    var $ul  = this.$el.find(\"ul.special\");\n\n    // Resets heights\n    $ul.height(\"auto\");\n    $ul.parent().height(\"auto\");\n\n    var special_height  = $ul.height();\n    var dropdown_height = $ul.parent().height();\n\n    // Sets heights\n    if (special_height < dropdown_height) $ul.css(\"height\", dropdown_height);\n    else $ul.parent().height(special_height);\n\n  },\n\n  _addForm: function() {\n\n    var properties = this.options.properties;\n\n    var self = this;\n\n    this.form = new cdb.forms.Form({\n      form_data: this.options.form_data,\n      model: this.style\n    }).on(\"saved\", function() {\n      self.trigger(\"saved\", self)\n    });\n\n    this.addView(this.form);\n    this.$el.append(this.form.render().$el);\n\n  },\n\n  /*\n   * Renders the dropdown\n   */\n  render: function() {\n\n    this.clearSubViews();\n\n    this.$el.html(this.template_base(this.options));\n\n    this._addForm();\n\n    return this;\n  }\n});\n","cdb.admin.overlays = cdb.admin.overlays || {};\n\n/*\n * Model for the Overlays\n * */\ncdb.admin.models.Overlay = cdb.core.Model.extend({\n\n  defaults: {\n    order: 1\n  },\n\n  sync: Backbone.syncAbort,\n\n  url: function(method) {\n    var version = cdb.config.urlVersion('overlays', method);\n    var base = '/api/' + version + '/viz/' + this.collection.vis.id + '/overlays';\n    if (this.isNew()) {\n      return base;\n    }\n    return base + '/' + this.id;\n  },\n\n  _clone: function(obj) {\n\n    var copy;\n\n    // Handle  a couple of types, plus null and undefined\n    if (null == obj || \"object\" != typeof obj) return obj;\n\n    // Handle Array\n    if (obj instanceof Array) {\n      copy = [];\n      for (var i = 0, len = obj.length; i < len; i++) {\n        copy[i] = this._clone(obj[i]);\n      }\n      return copy;\n    }\n\n    // Handle Object\n    if (obj instanceof Object) {\n      copy = {};\n      for (var attr in obj) {\n        if (obj.hasOwnProperty(attr)) copy[attr] = this._clone(obj[attr]);\n      }\n      return copy;\n    }\n\n    throw new Error(\"Type not supported\");\n  },\n\n  cloneAttributes: function() {\n    return this._clone(this.attributes);\n  },\n\n  /*\n   * Overwrite serialization method to use our Overlay structure\n   * */\n  toJSON: function() {\n\n    return {\n      template: this.get(\"template\"),\n      order:    this.get(\"order\"),\n      type:     this.get(\"type\"),\n      options:  {\n        x:       this.get(\"x\"),\n        y:       this.get(\"y\"),\n        device:  this.get(\"device\"),\n        display: this.get(\"display\"),\n        style:   this.get(\"style\"),\n        extra:   this.get(\"extra\")\n      }\n    }\n  }, \n\n  parse: function(resp) {\n    resp.display = resp.options.display;\n    var options = resp.options;\n    if (options) {\n      options = typeof options === 'string' ? JSON.parse(options): options;\n      _.extend(resp, {\n        x:            options.x,\n        y:            options.y,\n        device:       options.device,\n        extra:        options.extra,\n        style:        options.style,\n        display:      options.display\n      });\n    }\n    delete resp.options.display;\n    return resp;\n  },\n\n  clone: function() {\n    return new cdb.admin.models.Overlay(_.omit(_.clone(this.attributes), 'id', 'parent_id'));\n  }\n\n});\n\n/*\n * Overlays collection\n * */\ncdb.admin.Overlays = Backbone.Collection.extend({\n\n  model: cdb.admin.models.Overlay,\n\n  url: function(method) {\n    var version = cdb.config.urlVersion('overlays', method);\n    return '/api/' + version + '/viz/' + this.vis.get(\"id\") + '/overlays';\n  },\n\n\n  comparator: function(item) {\n    return item.get(\"order\");\n  },\n\n  initialize: function() {\n\n    this._bindOverlays();\n\n  },\n\n  _bindOverlays: function() {\n\n    this.bind(\"reset\", function(){\n\n      var headers = this.filter(function(overlay) { return overlay.get(\"type\") === \"header\"; });\n\n      if (headers.length) {\n\n        var self = this;\n\n        this.vis.on(\"change:name change:description\", function() {\n\n          headers[0].set({\n            title:  this.get(\"name\"),\n            description: self._getMarkdown(this.get('description'))\n          });\n\n        }, this.vis);\n\n      }\n\n    }, this);\n\n  },\n\n  /*\n   * Returns an array with all the overlays z-indexes\n   * */\n  getOverlaysZIndex: function(mode) {\n\n    var overlays = this.filter(function(o) { \n      return o.get(\"device\") === mode && (o.get(\"type\") === \"text\" || o.get(\"type\") === \"annotation\" || o.get(\"type\") === \"image\");\n    });\n\n    return _.map(overlays, function(o) { return parseInt(o.get(\"style\")[\"z-index\"]) });\n\n  },\n\n  createOverlayByType: function(overlay_type, property) {\n      var byType = {\n        'fullscreen':     this._createFullScreenOverlay,\n        'header':         this._createHeaderOverlay,\n        'layer_selector': this._createLayerSelectorOverlay,\n        'share':          this._createShareOverlay,\n        'search':         this._createSearchOverlay,\n        'zoom':           this._createZoomOverlay,\n        'logo':           this._createLogoOverlay\n      };\n      var c = byType[overlay_type];\n      if (c) {\n        return c.call(this, property);\n      }\n  },\n\n  _createZoomOverlay: function() {\n    var options = {\n      type: \"zoom\",\n      order: 6,\n      display: true,\n      template: '<a href=\"#zoom_in\" class=\"zoom_in\">+</a> <a href=\"#zoom_out\" class=\"zoom_out\">-</a>',\n      x: 20,\n      y: 20\n    };\n    this.create(options);\n  },\n\n  _createLogoOverlay: function() {\n    var options = {\n      type: \"logo\",\n      order: 10,\n      display: true,\n      x: 10,\n      y: 40\n    };\n    this.create(options);\n  },\n\n  _createSearchOverlay: function() {\n    var options = {\n      type: \"search\",\n      order: 3,\n      display: true,\n      x: 60,\n      y: 20\n    }\n    this.create(options);\n  },\n\n  _createLayerSelectorOverlay: function() {\n    var options = {\n      type: \"layer_selector\",\n      order: 4,\n      display: true,\n      x: 212,\n      y: 20\n    };\n    this.create(options);\n  },\n\n  _createShareOverlay: function() {\n\n    var options = {\n      type: \"share\",\n      order: 2,\n      display: true,\n      x: 20,\n      y: 20\n    };\n\n    this.create(options);\n\n  },\n\n  _getMarkdown: function(text) {\n    return text ? $(markdown.toHTML(text)).html() : \"\";\n  },\n\n  _createHeaderOverlay: function(property) {\n\n    var self = this;\n\n    var show_title       = false;\n    var show_description = false;\n\n    if (property === \"title\")       show_title       = true;\n    if (property === \"description\") show_description = true;\n\n    var description = this.vis.get(\"description\");\n    var title       = this.vis.get(\"name\");\n\n    if (!show_title && property == 'description' && !description) return;\n\n    var options = {\n      type: \"header\",\n      order: 1,\n      display: true,\n      extra: {\n        title: title,\n        description: description,\n        show_title: show_title,\n        show_description: show_description\n      }\n    };\n\n    var model = this.create(options);\n    var vis = this.vis;\n\n    this.vis.on(\"change:name change:description\", function() {\n      model.set({\n        title:  vis.get(\"name\"),\n        description: self._getMarkdown(vis.get('description'))\n      });\n    }, model);\n\n    model.bind('destroy', function() {\n      vis.unbind(null, null, model);\n    });\n\n  },\n\n  _createFullScreenOverlay: function() {\n    var options = {\n      type: \"fullscreen\",\n      order: 7,\n      display: true,\n      x: 20,\n      y: 172\n    };\n    this.create(options);\n  }\n});\n","cdb.admin.OverlaysDropdownItem = cdb.core.View.extend({\n\n  tagName: \"li\",\n\n  events: {\n    \"click a\": \"_onClick\"\n  },\n\n  initialize: function() {\n\n    this.template   = this.getTemplate(this.options.template_name);\n    this.collection = this.options.collection;\n\n    this.model = new cdb.core.Model(); \n    this.model.on(\"change:active\", this._onChangeActive, this);\n\n    this.model.set(\"active\", this.options.active);\n\n  },\n\n  _onClick: function(e) {\n\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.trigger(\"click\", this)\n\n  },\n\n  _onChangeActive: function() {\n\n    if (this.model.get(\"active\")) this.$el.addClass(\"active\");\n    else this.$el.removeClass(\"active\");\n \n  },\n\n  render: function() {\n\n    this.$el.append(this.template(this.options));\n\n    return this;\n\n  }\n\n});\n\ncdb.admin.OverlaysDropdown = cdb.ui.common.Dropdown.extend({\n\n  className: 'dropdown widgets_dropdown',\n\n  defaults: {\n    speedOut: 100,\n    speedIn: 100\n  },\n\n  placeholders: {\n    public_default_image: \"overlay_placeholder_cartofante.png\",\n    default_image: \"overlay_placeholder.png\"\n  },\n\n  events: {\n    \"click\" : \"killEvent\"\n  },\n\n  initialize: function() {\n\n    _.bindAll(this, \"open\", \"hide\", \"_handleClick\", \"_onKeyDown\");\n\n    // Extend options\n    _.defaults(this.options, this.defaults);\n\n    // Dropdown template\n    this.template_base = cdb.templates.getTemplate(this.options.template_base);\n\n    this.vis     = this.options.vis;\n    this.canvas  = this.options.canvas;\n    this.mapView = this.options.mapView;\n\n    // Bind to target\n    $(this.options.target).bind({ \"click\": this._handleClick});\n\n    // Bind ESC key\n    $(document).bind('keydown', this._onKeyDown);\n\n    // flags\n    this.isOpen    = false;\n  },\n\n\n  _isDesktop: function() {\n\n    return this.canvas.get(\"mode\") === \"desktop\";\n\n  },\n\n  /* Check if the dropdown is visible to hiding with the click on the target */\n  _handleClick: function(ev) {\n    if (ev) {\n      ev.preventDefault();\n    }\n\n    // If visible\n    if (this.isOpen){\n      this.hide();\n    } else{\n      this.open();\n    }\n  },\n\n  show: function() {\n\n    var dfd = $.Deferred();\n    var self = this;\n\n    //sometimes this dialog is child of a node that is removed\n    //for that reason we link again DOM events just in case\n    this.delegateEvents();\n    this.$el\n    .css({\n      marginTop: \"-10px\",\n      opacity:0,\n      display:\"block\"\n    })\n    .animate({\n      margin: \"0\",\n      opacity: 1\n    }, {\n      \"duration\": this.options.speedIn,\n      \"complete\": function(){\n        dfd.resolve();\n      }\n    });\n\n    this.trigger(\"onDropdownShown\", this.el);\n\n    return dfd.promise();\n  },\n\n  open: function(ev, target) {\n\n    cdb.god.trigger(\"closeDialogs\");\n\n    // Target\n    var $target = target && $(target) || this.options.target;\n\n    this.options.target = $target;\n\n    this.$el.css({\n      top: 40,\n      left: 0\n    })\n    .addClass(\n      // Add vertical and horizontal position class\n      (this.options.vertical_position === \"up\" ? \"vertical_top\" : \"vertical_bottom\" )\n      + \" \" +\n        (this.options.horizontal_position === \"right\" ? \"horizontal_right\" : \"horizontal_left\" )\n      + \" \" +\n        // Add tick class\n        \"border tick_\" + this.options.tick\n    );\n\n    // Show it\n    this.show();\n    this._recalcHeight();\n\n    // Dropdown open\n    this.isOpen = true;\n    \n    this.trigger(\"onOverlayDropdownOpen\", this);\n\n  },\n\n  _onKeyDown: function(e) {\n\n    if (e.keyCode === 27) {\n      this.hide();\n    }\n\n  },\n\n\n  hide: function(done) {\n\n    if (!this.isOpen) {\n      done && done();\n      return;\n    }\n\n    var self    = this;\n    this.isOpen = false;\n\n    this.$el.animate({\n      marginTop: self.options.vertical_position === \"down\" ? \"10px\" : \"-10px\",\n      opacity: 0\n    }, this.options.speedOut, function(){\n\n      // And hide it\n      self.$el.hide();\n\n    });\n\n    this.trigger(\"onDropdownHidden\",this.el);\n  },\n\n  _recalcHeight: function() {\n\n    var $ul  = this.$el.find(\"ul.special\");\n\n    // Resets heights\n    $ul.height(\"auto\");\n    $ul.parent().height(\"auto\");\n\n    var special_height  = $ul.height();\n    var dropdown_height = $ul.parent().height();\n\n    // Sets heights\n    if (special_height < dropdown_height) $ul.css(\"height\", dropdown_height);\n    else $ul.parent().height(special_height);\n\n  },\n\n  _addOverlay: function(model) {\n    this.collection.add(model);\n    model.save();\n    cdb.god.trigger(\"closeDialogs\");\n  },\n\n  _addLogoOverlay: function() {\n\n    var model = new cdb.admin.models.Overlay({\n      type: \"logo\",\n      display: true\n    });\n\n    this._addOverlay(model);\n  },\n\n  _getDefaultImageURL: function() {\n    return cdb.config.get(\"assets_url\") + \"/images/layout/\" +  this.placeholders.default_image;\n  },\n\n  _getPublicDefaultImageURL: function() {\n    return cdb.config.get(\"assets_url\") + \"/images/layout/\" +  this.placeholders.public_default_image;\n  },\n\n  _addImageOverlay: function() {\n\n    var width  = 400;\n    var height = 200;\n\n    var defaultStyle = {\n      \"z-index\": 4,\n      \"box-color\": \"#000000\",\n      \"box-opacity\": .7,\n      \"box-width\": 200\n    };\n\n    var default_image_url = this._getDefaultImageURL();\n\n    var defaultOptions = {\n      has_default_image: true,\n      url: this._getDefaultImageURL(),\n      rendered_text: \"<img src='\" + default_image_url + \"' />\",\n      default_image_url: default_image_url,\n      public_default_image_url: this._getPublicDefaultImageURL() \n    };\n\n    var x = $(\".cartodb-map\").width()/2  - width/2;\n    var y = $(\".cartodb-map\").height()/2 - height/2;\n\n    if (this.canvas.get(\"mode\") === \"mobile\") {\n      x = 33;\n      y = 120;\n    }\n\n    var model = new cdb.admin.models.Overlay({\n      type: \"image\",\n      display: true,\n      width: width,\n      height: height,\n      device: this.canvas.get(\"mode\"),\n      x: x,\n      y: y,\n      extra: defaultOptions,\n      style: defaultStyle\n    });\n\n    this._addOverlay(model);\n\n  },\n\n  _addTitleOverlay: function() {\n\n    var content = this.vis.get(\"name\");\n    var width   = 350;\n    var height  = 30;\n\n    var defaultStyle = {\n      \"z-index\":          4,\n      \"color\":            \"#ffffff\",\n      \"text-align\":       \"left\",\n      \"font-size\":        this._isDesktop() ? \"40\" : \"17\",\n      \"font-family-name\": \"Helvetica\",\n      \"box-padding\":      10,\n      \"box-color\":        \"#000000\",\n      \"box-opacity\":      .7,\n      \"box-width\":        this._isDesktop ? 500 : 200\n    };\n\n    var defaultOptions = {\n      landscapeDirection: \"left\",\n      pTop: 0,\n      pLeft: 0,\n      portraitDirection:  \"top\",\n      text: \"**\" + content + \"**\",\n      rendered_text: \"<strong>\" + content + \"</strong>\"\n    };\n\n    var model = new cdb.admin.models.Overlay({\n      type: \"text\",\n      display: true,\n      width: width,\n      height: height,\n      device: this.canvas.get(\"mode\"),\n      x: this._isDesktop() ? 66 : 20,\n      y: this._isDesktop() ? $(\".header\").outerHeight()  + 15 : $(\".header\").outerHeight()  + 15,\n      extra: defaultOptions,\n      style: defaultStyle\n    });\n\n    this._addOverlay(model);\n\n  },\n\n  _addTextOverlay: function() {\n\n    var width  = 200;\n    var height = 30;\n\n    var defaultStyle = {\n      \"z-index\":          4,\n      \"color\":            \"#ffffff\",\n      \"text-align\":       \"left\",\n      \"font-size\":        this._isDesktop() ? \"20\" : \"12\",\n      \"font-family-name\": \"Helvetica\",\n      \"box-padding\":      10,\n      \"box-color\":        \"#000000\",\n      \"box-opacity\":      .7,\n      \"box-width\":        300\n    };\n\n    var defaultOptions = {\n      pLeft: \"50\",\n      pTop: \"50\",\n      landscapeDirection: \"left\",\n      portraitDirection:  \"top\",\n      text: \"I'm a **text overlay**\",\n      rendered_text: \"I'm a <strong>text overlay</strong>\" // Rendered version of the markdown text\n    };\n\n    var model = new cdb.admin.models.Overlay({\n      type: \"text\",\n      display: true,\n      width: width,\n      height: height,\n      device: this.canvas.get(\"mode\"),\n      x: $(\".cartodb-map\").width()/2  - width/2,\n      y: $(\".cartodb-map\").height()/2 - height/2,\n      extra: defaultOptions,\n      style: defaultStyle\n    });\n\n    this._addOverlay(model);\n\n  },\n\n  _addAnnotationOverlay: function() {\n\n    var defaultStyle = {\n      \"z-index\":          4,\n      \"color\":            \"#ffffff\",\n      \"text-align\":       \"left\",\n      \"font-size\":        this._isDesktop() ? \"13\" : \"12\",\n      \"font-family-name\": \"Helvetica\",\n      \"box-color\":        \"#000000\",\n      \"box-opacity\":      .7,\n      \"box-padding\":      5,\n      \"line-color\":       \"#000000\",\n      \"line-width\":       this._isDesktop() ? 50 : 25,\n      \"min-zoom\": this.mapView.map.get(\"minZoom\"),\n      \"max-zoom\": this.mapView.map.get(\"maxZoom\")\n    };\n\n    var defaultOptions = {\n      latlng: this.mapView.map.get(\"center\"),\n      text: this._isDesktop() ? \"I'm an **annotation overlay**\" : \"Hi! I'm here\",\n      rendered_text: this._isDesktop() ? \"I'm an <strong>annotation overlay</strong>\" : \"Hi! I'm here\"\n    };\n\n    var model = new cdb.admin.models.Overlay({\n      type: \"annotation\",\n      display: true,\n      device: this.canvas.get(\"mode\"),\n      extra: defaultOptions,\n      style: defaultStyle\n    });\n\n    this._addOverlay(model);\n\n  },\n\n  _addButton: function(title, callback) {\n\n    var button = new cdb.admin.OverlaysDropdownItem({\n\n      text: title,\n      template_name: \"table/views/overlays/add_widget_dropdown_item\",\n\n    }).on(\"click\", callback, this);\n\n    this.$el.find(\"ul\").append(button.render().$el);\n\n  },\n\n  /*\n   * Renders the dropdown\n   */\n  render: function() {\n\n    this.clearSubViews();\n\n    this.$el.html(this.template_base(this.options));\n\n    this._addButton(\"Add title item\", this._addTitleOverlay);\n    this._addButton(\"Add text item\",  this._addTextOverlay);\n    this._addButton(\"Add annotation item\",  this._addAnnotationOverlay);\n    this._addButton(\"Add image item\", this._addImageOverlay);\n\n    return this;\n  }\n\n});\n","cdb.admin.overlays.Search = cdb.core.View.extend({\n\n  events: { },\n\n  initialize: function() {\n\n    _.bindAll(this, \"_close\");\n\n    this._setupModels();\n    this._addSearchControl();\n\n  },\n\n  _killEvent: function(e) {\n\n    e && e.preventDefault();\n    e && e.stopPropagation();\n\n  },\n\n  // Setup the internal and custom model\n  _setupModels: function() {\n\n    this.model = this.options.model;\n    this.vis = this.options.vis;\n    this.canvas = this.options.canvas;\n\n    this.model.on(\"change:display\", this._onChangeDisplay, this);\n    this.model.on(\"change:y\",       this._onChangeY, this);\n    this.model.on(\"change:x\",       this._onChangeX, this);\n\n    this.model.on(\"destroy\", function() {\n      this.$el.remove();\n    }, this);\n\n  },\n\n  _onChangeX: function() {\n\n    var x    = this.model.get(\"x\");\n    var self = this;\n\n    this.$el.animate({ right: x }, { duration: 150, complete: function() {\n\n      self.trigger(\"change_x\", this);\n\n    }});\n\n    //if (this.model) this.model.save();\n\n  },\n\n  _onChangeY: function() {\n\n    var y = this.model.get(\"y\");\n    this.$el.animate({ top: y }, 150);\n\n    //if (this.model) this.model.save();\n\n  },\n\n  _onChangeDisplay: function() {\n\n    var display = this.model.get(\"display\");\n\n    if (display) {\n      this.show();\n    } else {\n      this.hide();\n    }\n\n  },\n\n  _addSearchControl: function() {\n    this.searchControl = new cdb.admin.SearchControl({\n      model:  this.options.map,\n      vis: this.options.vis,\n      canvas: this.options.canvas,\n      mapView: this.options.mapView,\n      template: cdb.templates.getTemplate(\"table/views/search_control\"),\n      infowindowTemplate: cdb.templates.getTemplate(\"table/views/search_infowindow\"),\n      infowindowOffset: [93, 140]\n    });\n  },\n\n  _onMouseDown:      function() { },\n  _onMouseEnterText: function() { },\n  _onMouseLeaveText: function() { },\n  _onMouseEnter:     function() { },\n  _onMouseLeave:     function() { },\n\n  show: function() {\n\n    var self = this;\n\n    this.$el.fadeIn(250, function() {\n      self.trigger(\"change_x\", this);\n    });\n\n  },\n\n  hide: function(callback) {\n\n    var self = this;\n\n    callback && callback();\n\n    this.$el.fadeOut(250, function() {\n      self.trigger(\"change_x\", this);\n    });\n\n  },\n\n  _close: function(e) {\n\n    this._killEvent(e);\n\n    var self = this;\n\n    this.hide(function() {\n      self.trigger(\"remove\", self);\n    });\n\n  },\n\n  _toggleDisplay: function() {\n\n    this.model.get(\"display\") ? this.$el.show() : this.$el.hide();\n\n  },\n\n  _position: function() {\n    // Always position the top according to model\n    var attrs = {\n      top: this.model.get(\"y\")\n    };\n\n    if (!this.options.relative_position) {\n      attrs.right = this.model.get(\"x\");\n    }\n\n    this.$el.css(attrs);\n  },\n\n  render: function() {\n\n    var self = this;\n\n    this.$el = this.searchControl.render().$el;\n\n    this._toggleDisplay();\n    this._position();\n\n    return this;\n\n  }\n\n});\n","/**\n *  Search overlay for editor.\n *  Adding custom infowindow providing:\n *\n *  - Add a new point in that position.\n *  - Add a new annotation.\n *\n */\n\ncdb.admin.SearchControl = cdb.geo.ui.Search.extend({\n\n  _createInfowindow: function(position, address) {\n    var infowindowModel = new cdb.geo.ui.InfowindowModel({\n      template: this.options.infowindowTemplate,\n      latlng: position,\n      width: this.options.infowindowWidth,\n      offset: this.options.infowindowOffset,\n      content: {\n        fields: [{\n          title: 'address',\n          value: address\n        }]\n      }\n    });\n\n    this._searchInfowindow = new cdb.admin.SearchInfowindow({\n      model: infowindowModel,\n      mapView: this.mapView,\n      vis: this.options.vis,\n      canvas: this.options.canvas\n    });\n\n    this.mapView.$el.append(this._searchInfowindow.el);\n    infowindowModel.set('visibility', true);\n  }\n\n});\n","/**\n *  Custom infowindow only for search control\n *  - It provides two options, add a point or\n *  add an annotation.\n *\n */\n\ncdb.admin.SearchInfowindow = cdb.geo.ui.Infowindow.extend({\n\n  events: cdb.geo.ui.Infowindow.extendEvents({\n    'click .js-addPoint': '_addPoint',\n    'click .js-addAnnotation': '_addAnnotation'\n  }),\n\n  initialize: function() {\n    this.layerModel = this.options.mapView.activeLayerModel;\n    this.layerData = this.options.mapView.getLayerByCid(this.layerModel.cid);\n    this.table = this.layerModel.table;\n    cdb.geo.ui.Infowindow.prototype.initialize.call(this, arguments);\n  },\n\n  render: function() {\n    this.clearSubViews();\n    this.elder('render');\n    this._setEditButtons();\n    return this;\n  },\n\n  _setEditButtons: function() {\n    var isVisualization = this.options.vis.isVisualization();\n    var canAddPoint = this._canAddPoint();\n    this.$('.add_annotation').toggleClass('disabled', !isVisualization);\n    this.$('.add_point').toggleClass('disabled', !canAddPoint);\n\n    this.addView(\n      new cdb.common.TipsyTooltip({\n        el: this.$('.add_annotation'),\n        title: function(e) {\n          return !isVisualization ? $(this).attr('data-title') : $(this).text()\n        }\n      })\n    );\n\n    this.addView(\n      new cdb.common.TipsyTooltip({\n        el: this.$('.add_point'),\n        title: function(e) {\n          return !canAddPoint ? $(this).attr('data-title') : $(this).text()\n        }\n      })\n    );\n  },\n\n  _addPoint: function(ev) {\n    if (ev) {\n      ev.preventDefault();\n    }\n    var self = this;\n\n    this.model.set('visibility', false);\n\n    if (this.table) {\n      var geomTypes = this.table.geomColumnTypes();\n      // Only allow add points if the data layer is made of that.\n      if (!_.contains(geomTypes,'point') && !_.isEmpty(geomTypes)) {\n        return false;\n      }\n      var row = this.table.data().newRow();\n      row.save({\n        the_geom: '{ \"type\": \"Point\", \"coordinates\": [' + this.model.get('latlng')[1] + ',' + this.model.get('latlng')[0] + '] }'\n      }, {\n        success: function() {\n          self.layerData.invalidate();\n        },\n        error: function(e, resp) {\n          self.table.error(\"Error adding a new row\", resp);\n        }\n      });\n    }\n  },\n\n  _addAnnotation: function(ev) {\n    if (ev) {\n      ev.preventDefault();\n    }\n\n    if (!this.options.vis.isVisualization()) {\n      return;\n    }\n\n    this.model.set('visibility', false);\n    \n    var address = this._getAddress();\n\n    // TODO: remove these styles when annotation model\n    // has these default values defined.\n    var defaultStyle = {\n      \"z-index\": 4,\n      color: \"#ffffff\",\n      \"text-align\": \"left\",\n      \"font-size\": \"13\",\n      \"font-family-name\": \"Helvetica\",\n      \"box-color\": \"#000000\",\n      \"box-opacity\": .7,\n      \"box-padding\": 5,\n      \"line-color\": \"#000000\",\n      \"line-width\": 50,\n      \"min-zoom\": this.mapView.map.get(\"minZoom\"),\n      \"max-zoom\": this.mapView.map.get(\"maxZoom\")\n    };\n\n    var defaultOptions = {\n      latlng: this.model.get(\"latlng\"),\n      text: address\n    };\n\n    var model = new cdb.admin.models.Overlay({\n      type: \"annotation\",\n      display: true,\n      device: this.options.canvas.get(\"mode\"),\n      extra: defaultOptions,\n      style: defaultStyle\n    });\n\n    this.options.vis.overlays.add(model);\n    model.save();\n  },\n\n  _canAddPoint: function() {\n    var geomTypes = this.table.geomColumnTypes();\n    // Only allow add points if the data layer is made of that.\n    if (!_.contains(geomTypes,'point') && !_.isEmpty(geomTypes)) {\n      return false;\n    }\n\n    if (this.table.isReadOnly()) {\n      return false;\n    }\n\n    return true;\n  },\n\n  _getAddress: function() {\n    return this.model.get('content').fields[0].value;\n  }\n\n})\n","cdb.admin.overlays.Share = cdb.core.View.extend({\n\n  className: \"cartodb-share\",\n\n  template_name: 'table/views/overlays/share',\n\n  events: { },\n\n  initialize: function() {\n\n    _.bindAll(this, \"_close\");\n\n    this.template = this.getTemplate(this.template_name);\n\n    this._setupModels();\n\n  },\n\n  _killEvent: function(e) {\n\n    e && e.preventDefault();\n    e && e.stopPropagation();\n\n  },\n\n  // Setup the internal and custom model\n  _setupModels: function() {\n\n    this.model = this.options.model;\n\n    this.model.on(\"change:display\", this._onChangeDisplay, this);\n    this.model.on(\"change:y\",       this._onChangeY, this);\n    this.model.on(\"change:x\",       this._onChangeX, this);\n\n    this.model.on(\"destroy\", function() {\n      this.$el.remove();\n    }, this);\n\n  },\n\n  _onChangeX: function() {\n\n    var x = this.model.get(\"x\");\n    this.$el.animate({ right: x }, 150);\n\n    this.trigger(\"change_x\", this);\n\n  },\n\n  _onChangeY: function() {\n\n    var y = this.model.get(\"y\");\n    this.$el.animate({ top: y }, 150);\n\n    this.trigger(\"change_y\", this);\n\n  },\n\n  _onChangeDisplay: function() {\n\n    var display = this.model.get(\"display\");\n\n    if (display) {\n      this.show();\n    } else {\n      this.hide();\n    }\n\n  },\n\n  _addControl: function() {\n\n    this.control = new cdb.ui.common.FullScreen({\n      doc: \".map\",\n      mapView: this.options.mapView,\n      template: this.getTemplate(\"table/views/fullscreen\")\n    });\n\n  },\n\n  _onMouseDown:      function() { },\n  _onMouseEnterText: function() { },\n  _onMouseLeaveText: function() { },\n  _onMouseEnter:     function() { },\n  _onMouseLeave:     function() { },\n\n  show: function() {\n\n    var self = this;\n\n    this.$el.fadeIn(250, function() {\n      self.trigger(\"change_x\", this);\n    });\n\n  },\n\n  hide: function(callback) {\n\n    var self = this;\n\n    callback && callback();\n\n    this.$el.fadeOut(250, function() {\n      self.trigger(\"change_x\", this);\n    });\n\n  },\n\n  _close: function(e) {\n\n    this._killEvent(e);\n\n    var self = this;\n\n    this.hide(function() {\n\n      self.trigger(\"remove\", self);\n\n    });\n\n  },\n\n  render: function() {\n\n    var self = this;\n\n    this.$el.append(this.template());\n\n    this.$el.css({ right: this.model.get(\"x\"), top: this.model.get(\"y\") });\n\n    return this;\n\n  }\n\n});\n","cdb.admin.overlays.Zoom = cdb.core.View.extend({\n\n  tagName: 'div',\n  className: 'cartodb-zoom',\n\n  events: {\n    'click .zoom_in': 'zoom_in',\n    'click .zoom_out': 'zoom_out'\n  },\n\n  default_options: {\n    timeout: 0,\n    msg: ''\n  },\n\n  template_name: 'table/views/overlays/zoom',\n\n  initialize: function() {\n\n    _.bindAll(this, \"_close\");\n\n    this.template = this.getTemplate(this.template_name);\n\n    this.map = this.options.map;\n\n    _.defaults(this.options, this.default_options);\n\n    this._setupModels();\n\n  },\n\n  _killEvent: function(e) {\n\n    e && e.preventDefault();\n    e && e.stopPropagation();\n\n  },\n\n  // Setup the internal and custom model\n  _setupModels: function() {\n\n    this.model = this.options.model;\n\n    this.model.on(\"change:display\", this._onChangeDisplay, this);\n    this.model.on(\"change:y\",       this._onChangeY, this);\n\n    this.map.bind('change:zoom change:minZoom change:maxZoom', this._checkZoom, this);\n\n    this.model.on(\"destroy\", function() {\n      this.$el.remove();\n    }, this);\n\n  },\n\n  _onChangeY: function() {\n\n    var y = this.model.get(\"y\");\n    this.$el.animate({ top: y }, 150);\n\n    this.trigger(\"change_y\", this);\n\n  },\n\n  _onChangeDisplay: function() {\n\n    var display = this.model.get(\"display\");\n\n    if (display) {\n      this.show();\n    } else {\n      this.hide();\n    }\n\n  },\n\n  _checkZoom: function() {\n\n    var zoom = this.map.get('zoom');\n\n    this.$('.zoom_in')[ zoom < this.map.get('maxZoom') ? 'removeClass' : 'addClass' ]('disabled')\n    this.$('.zoom_out')[ zoom > this.map.get('minZoom') ? 'removeClass' : 'addClass' ]('disabled')\n\n    this.$el.find(\".info\").html(zoom);\n\n  },\n\n  zoom_in: function(ev) {\n    if (this.map.get(\"maxZoom\") > this.map.getZoom()) {\n      this.map.setZoom(this.map.getZoom() + 1);\n    }\n    ev.preventDefault();\n    ev.stopPropagation();\n  },\n\n  zoom_out: function(ev) {\n    if (this.map.get(\"minZoom\") < this.map.getZoom()) {\n      this.map.setZoom(this.map.getZoom() - 1);\n    }\n    ev.preventDefault();\n    ev.stopPropagation();\n  },\n\n  _onMouseDown:      function() { },\n  _onMouseEnterText: function() { },\n  _onMouseLeaveText: function() { },\n  _onMouseEnter:     function() { },\n  _onMouseLeave:     function() { },\n\n  show: function() {\n\n    var self = this;\n\n    this.$el.fadeIn(250, function() {\n      self.trigger(\"change_y\", self);\n    });\n\n  },\n\n  hide: function(callback) {\n\n    var self = this;\n\n    callback && callback();\n\n    this.$el.fadeOut(250, function() {\n      self.trigger(\"change_y\", self);\n    });\n\n  },\n\n  _close: function(e) {\n\n    this._killEvent(e);\n\n    var self = this;\n\n    this.hide(function() {\n      self.trigger(\"remove\", self);\n    });\n\n  },\n\n  _toggleFullScreen: function(ev) {\n\n    ev.stopPropagation();\n    ev.preventDefault();\n\n    var doc   = window.document;\n    var docEl = doc.documentElement;\n\n    if (this.options.doc) { // we use a custom element\n      docEl = $(this.options.doc)[0];\n    }\n\n    var requestFullScreen = docEl.requestFullscreen || docEl.mozRequestFullScreen || docEl.webkitRequestFullScreen;\n    var cancelFullScreen  = doc.exitFullscreen || doc.mozCancelFullScreen || doc.webkitExitFullscreen;\n\n    var mapView = this.options.mapView;\n\n    if (!doc.fullscreenElement && !doc.mozFullScreenElement && !doc.webkitFullscreenElement) {\n\n      requestFullScreen.call(docEl);\n\n      if (mapView) {\n\n        if (this.model.get(\"allowWheelOnFullscreen\")) {\n          mapView.options.map.set(\"scrollwheel\", true);\n        }\n\n      }\n\n    } else {\n\n      cancelFullScreen.call(doc);\n\n    }\n\n  },\n\n  render: function() {\n\n    var self = this;\n\n    this.$el.append(this.template());\n\n    this.$el.css({ left: this.model.get(\"x\"), top: this.model.get(\"y\") });\n\n    this._checkZoom();\n\n    this._createTooltip();\n\n    return this;\n\n  },\n\n  _createTooltip: function(elem) {\n\n    var tooltip = new cdb.common.TipsyTooltip({\n      el: this.$('.info'),\n      gravity: 'w',\n      title: function() {\n        return (\"zoom level\");\n      }\n    })\n\n    this.addView(tooltip);\n  }\n\n});\n","\n/**\n * view for dropdown show when user click on row options\n */\ncdb.admin.RowHeaderDropdown = cdb.admin.DropdownMenu.extend({\n\n  className: 'dropdown border',\n\n  events: {\n    'click .delete_row': 'deleteRow',\n    'click .add_row': 'addRow'\n  },\n\n  initialize: function(options) {\n    this.tableData = options.tableData;\n    this.table = this.options.table;\n    this.elder('initialize');\n  },\n\n  openAt: function(x, y) {\n    this.$el.removeClass('vertical_top vertical_bottom horizontal_right horigonzal_left tick_top tick_bottom');\n    this.constructor.__super__.openAt.apply(this, arguments);\n  },\n\n  // New show function\n  show: function() {\n    var dfd = $.Deferred();\n    var self = this;\n    //sometimes this dialog is child of a node that is removed\n    //for that reason we link again DOM events just in case\n    this.delegateEvents();\n\n    this.$el\n      .css({\n        marginTop: self.options.vertical_position == \"down\" ? \"-1px\" : \"-50px\",\n        marginLeft: -5,\n        opacity:0,\n        display:\"block\"\n      })\n      .animate({\n        marginLeft: 5,\n        opacity: 1\n      }, {\n        \"duration\": this.options.speedIn,\n        \"complete\": function(){\n          dfd.resolve();\n        }\n      });\n    this.trigger(\"onDropdownShown\",this.el);\n\n    return dfd.promise();\n  },\n\n  hide: function(done) {\n\n    // don't attempt to hide the dropdown if it's already hidden\n    if (!this.isOpen) { done && done(); return; }\n\n    var self    = this;\n    this.isOpen = false;\n\n    this.$el.animate({\n\n      marginLeft: 15,\n      opacity: 0\n\n    }, this.options.speedOut, function(){\n\n      // Remove selected class\n      $(self.options.target).removeClass(\"selected\");\n\n      // And hide it\n      self.$el.hide();\n      done && done();\n\n    });\n\n    this.trigger(\"onDropdownHidden\",this.el);\n\n  },\n\n  setRow: function(row) {\n    this.row = row;\n  },\n\n  deleteRow: function(e) {\n    this.killEvent(e);\n\n    var view = new cdb.editor.DeleteRowView({\n      table: this.table,\n      row: this.row,\n      clean_on_hide: true,\n      enter_to_confirm: true\n    });\n    view.appendToBody();\n\n    this.hide();\n\n    return false;\n  },\n\n  addRow: function(e) {\n    this.killEvent(e);\n    var rowIndex = this.row.collection.indexOf(this.row);\n\n    this.tableData.addRow({ at: rowIndex + 1 });\n    this.hide();\n    return false;\n  }\n});\n","\n/**\n * view used to render each row\n */\ncdb.admin.RowView = cdb.ui.common.RowView.extend({\n  classLabel: 'cdb.admin.RowView',\n  events: {\n    'click      .row_header': '_onOptionsClick',\n    'mouseout   .row_header': '_onOptionsOut'\n  },\n\n  cellRenderers: {\n    'default': '_renderDefault',\n    'boolean': '_renderBoolean',\n    'number': '_renderNumber',\n    'geometry': '_renderGeometry'\n  },\n\n  initialize: function() {\n    var self = this;\n    this.elder('initialize');\n    _.bindAll(this, '_onOptionsClick', '_onOptionsOut')\n    this.options.row_header = true;\n\n    this.retrigger('saving', this.model);\n    this.retrigger('saved', this.model);\n    this.retrigger('errorSaving', this.model);\n  },\n\n  _getRowOptions: function() {\n    if(!cdb.admin.RowView.rowOptions) {\n       var rowOptions = cdb.admin.RowView.rowOptions = new cdb.admin.RowHeaderDropdown({\n        position: 'position',\n        user: this.tableView.user,\n        template_base: \"table/views/table_row_header_options\",\n        tick: \"top\",\n        horizontal_position: \"left\",\n        tableData: this.getTableView().dataModel,\n        table: this.getTableView().model\n      });\n      rowOptions.render();\n      this.retrigger('createRow', rowOptions);\n\n    }\n    return cdb.admin.RowView.rowOptions;\n  },\n\n  _onOptionsOut: function(e) {\n    var $relatedTarget = $(e.relatedTarget)\n      , current_row_id = $relatedTarget.closest('tr').attr('id');\n\n    if ($relatedTarget.closest('.dropdown').length == 0 && $relatedTarget.closest('.row_header').length == 0) {\n      if (this.rowOptions) this.rowOptions.hide();\n    }\n  },\n\n  _onOptionsClick: function(e) {\n    var rowOptions, tableData, pos, tableOffset, left, top\n      , $target = $(e.target);\n\n    tableData = this.getTableView().dataModel;\n    if(this.table.isReadOnly()) {\n      // if data is read only do not allow\n      // to add or remove rows\n      return;\n    }\n    rowOptions = this._getRowOptions();\n    e.preventDefault();\n    $target.append(rowOptions.el);\n\n    left = 30;\n    top = 5;\n\n    // If it is the last td of the table, show the dropdown upwards\n    if ($target.closest(\"tr\").is(':last-child') && $target.closest(\"tr\").index() > 1) {\n      rowOptions.options.vertical_position = \"top\";\n      rowOptions.options.tick = \"bottom\";\n    } else {\n      rowOptions.options.vertical_position = \"down\";\n      rowOptions.options.tick = \"top\";\n    }\n\n    rowOptions.setRow(this.model);\n    rowOptions.openAt(left, top);\n    this.rowOptions = rowOptions; // to make it testable;\n    return false;\n  },\n\n  /**\n   * return each cell view\n   */\n  valueView: function(colName, value) {\n\n    this.table = this.table || this.getTableView().model;\n    var render = '_renderDefault';\n    if(colName.length) {\n      var colType = this.table.getColumnType(colName);\n      render = this.cellRenderers[colType] || render;\n    }\n\n    var obj = $(this[render](value));\n    obj.addClass('cell');\n    if(cdb.admin.Row.isReservedColumn(colName)) {\n      obj.addClass('disabled');\n    }\n\n    // It is the first cell?\n    if(colName === '' && value === '') {\n      if(this.table.isReadOnly()) {\n        // No row options button\n        obj\n          .addClass('disabled')\n          .html('');\n      } else {\n        // Add row options button\n        obj.addClass('row_header');\n      }\n    }\n    return obj;\n  },\n\n  _renderDefault: function(value, additionalClasses) {\n    additionalClasses = additionalClasses || '';\n\n    var cell;\n\n    if (value === null) {\n      additionalClasses += \" isNull\"\n      cell =  '<div class=\"'+ additionalClasses +'\">null</div>';\n    } else cell =  '<div class=\"'+ additionalClasses +'\">' + _.escape(value) + '</div>';\n\n    return cell;\n  },\n\n  _renderBoolean: function(value) {\n    return this._renderDefault(value, 'boolean');\n  },\n\n  _renderNumber: function(value) {\n    return this._renderDefault(value, 'number');\n  },\n\n  _renderGeometry: function(value) {\n    var self = this;\n    function geomDisplayValue(value) {\n      var v = _.uniq(self.table.geomColumnTypes());\n      if (!_.isNull(value) && v && v.length && v[0]) {\n        v = v[0];\n        // capitalize\n        value = v.charAt(0).toUpperCase() + v.substring(1).toLowerCase();\n      }\n      return value;\n    }\n\n    var objValue = {};\n    try {\n      objValue = JSON.parse(value);\n      function formatCoord(c) {\n        var val = \"       \";\n        if (c !== undefined) {\n          val = c.toFixed(4);\n          if (c > 0) {\n            val = \" \" + val;\n          }\n        }\n        return val;\n      }\n      if(objValue.type === 'Point') {\n        value = formatCoord(objValue.coordinates[0]) + ',' + formatCoord(objValue.coordinates[1]);\n      } else {\n        value = geomDisplayValue(value);\n      }\n    } catch (e) {\n      value = geomDisplayValue(value);\n    }\n    return this._renderDefault(value);\n  }\n\n});\n\n","/**\n * slides lateral panel\n */\n\ncdb.admin.SlidesPanel = cdb.core.View.extend({\n\n  className: 'slides_panel',\n\n  template_name: 'table/views/slides/panel',\n\n  initialize: function() {\n\n    this.template = this.getTemplate(this.template_name);\n\n    this.slides = this.options.slides;\n    this.toggleElement = this.options.toggle;\n\n    this.model = new cdb.core.Model({\n      visible: false\n    });\n\n    this.model.bind(\"change:visible\", this._onChangeVisible, this);\n\n    if (!this.slides) {\n      throw new Error(\"slides is undefined\");\n    }\n\n    this._bindSlides();\n\n  },\n\n  _bindSlides: function() {\n\n    this.add_related_model(this.slides);\n\n    this.slides.bind('reset' , function() {\n      this.slides.each(this._add.bind(this));\n    }, this);\n\n    this.slides.bind('remove', function() {\n      this._reInitScrollpane();\n    }, this);\n\n    this.slides.bind('add', this._add, this);\n\n  } ,\n\n  _addAddButton: function(slide) {\n\n    this.addSlideButton = new cdb.admin.SlideViewAdd({\n      model: new cdb.core.Model()\n    });\n\n    this.addSlideButton.bind(\"click\", function() {\n      this.addSlideButton.model.set(\"loading\", true);\n      this.slides.create();\n    }, this);\n\n    this.addView(this.addSlideButton);\n    this.$el.find(\".scrollpane\").append(this.addSlideButton.render().el);\n\n  },\n\n  _reInitScrollpane: function() {\n    var self = this;\n    setTimeout(function() {\n      this.$('.scrollpane').data('jsp') && this.$('.scrollpane').data('jsp').reinitialise();\n      this.$('.scrollpane.jspScrollable').css(\"overflow\", \"\");\n    }, 500);\n  },\n\n  _add: function(slide) {\n    var v = new cdb.admin.SlideView({\n      user: this.options.user,\n      model: slide\n    });\n    // remove fake\n    if (this._fakeSlide) {\n      this._fakeSlide.clean();\n      this._fakeSlide = null;\n    }\n\n    this._addSlideView(v);\n  },\n\n  _addSlideView: function(slideView) {\n    this.addView(slideView);\n    this.$el.find(\".scrollpane .slides\").append(slideView.render().el);\n\n    slideView.show();\n    this._reInitScrollpane();\n  },\n\n  _onChangeVisible: function() {\n\n    var visible = this.model.get(\"visible\")\n    visible ? this._show() : this._hide();\n\n    this.trigger(\"onChangeVisible\", visible, this);\n\n  },\n\n  toggle: function() {\n\n    var visible = !this.model.get(\"visible\");\n    this.model.set(\"visible\", visible);\n\n    return visible;\n\n  },\n\n  show: function() {\n    this.model.set(\"visible\", true);\n  },\n\n  hide: function() {\n    this.model.set(\"visible\", false);\n  },\n\n  _hide: function() {\n    this.toggleElement.find(\"h5\").html(\"Create\");\n    this.toggleElement.removeClass(\"active\");\n    this.$el.removeClass(\"active\");\n    cdb.god.trigger(\"closeDialogs\");\n  },\n\n  _show: function() {\n    this.toggleElement.find(\"h5\").html(\"Hide\");\n    this.toggleElement.addClass(\"active\");\n    this.$el.addClass(\"active\");\n  },\n\n  _initScrollPane: function() {\n\n    var $scrollpane = this.$el.find(\".scrollpane\");\n    var height      = this.$el.height();\n\n    setTimeout(function() {\n      $scrollpane.css(\"max-height\", height - 60);\n      $scrollpane.jScrollPane();\n      $scrollpane.css(\"overflow\", \"\");\n    }, 500)\n\n  },\n\n  _initSortable: function() {\n\n    var self = this;\n\n    this.$el.find(\".slides\").sortable({\n      axis: \"y\",\n      update : function (event, ui) {\n\n        var current_id = ui.item.attr(\"id\");\n        var next_id = ui.item.next() ? ui.item.next().attr(\"id\") : null;\n        //var prev_id = ui.item.prev() ? ui.item.prev().attr(\"id\") : null;\n\n        var slide = self.slides.get(current_id);\n        slide.setNext(next_id);\n        //self.trigger(\"on_sortable\", { current: current_id, next: next_id }, self);;\n      }\n    });\n\n  },\n\n  _renderFake: function() {\n    this._fakeSlide = new cdb.admin.SlideViewFake();\n    this._addSlideView(this._fakeSlide);\n  },\n\n  render: function() {\n\n    this.clearSubViews();\n\n    this.$el.append(this.template());\n\n    this._renderFake();\n\n    this.slides.each(this._add.bind(this));\n\n    this._addAddButton();\n    this._initScrollPane();\n    this._initSortable();\n\n    this.slides.bind(\"add\", function() {\n      this.addSlideButton.model.set(\"loading\", false);\n    }, this);\n\n    return this;\n\n  }\n\n});\n\n/**\n * view for the fake slide. When there are no slides the UI shows one (the master one) but it's not\n * an actual slide in the server.\n */\n\ncdb.admin.SlideViewFake = cdb.core.View.extend({\n\n  tagName: \"a\",\n\n  className: 'slide_view fake',\n\n  template_name: 'table/views/slides/slide',\n\n  initialize: function () {\n    this.template = this.getTemplate(this.template_name);\n  },\n\n  show: function() {\n    this.$el.addClass('animated bounceIn active');\n  },\n\n  render: function() {\n    this.$el.attr(\"href\", \"#\");\n    this.$el.append(this.template({ count: 1, transition: false }));\n    return this;\n  }\n\n});\n\n/**\n * view for a single slide\n */\ncdb.admin.SlideView = cdb.core.View.extend({\n\n  tagName: \"a\",\n\n  className: 'slide_view',\n\n  template_name: 'table/views/slides/slide',\n\n  events: {\n    'click':        '_onClick',\n    'click .count': '_onClick',\n    'click .info':  '_onClickInfo',\n    'click .close': '_onClickClose'\n  },\n\n  initialize: function () {\n\n    this._setupModel();\n    this.template = this.getTemplate(this.template_name);\n\n  },\n\n  _setupDropdown: function() {\n\n    this.dropdown = new cdb.admin.TransitionDropdown({\n      target: this.$el.find('.js-change-transition-method'),\n      template_base: \"table/views/slides/transition_dropdown\",\n      horizontal_position: \"left\",\n      tick: \"top\",\n      vertical_offset: 58,\n      horizontal_offset: -145,\n      vis: this.model.visualization\n    });\n\n    this.addView(this.dropdown);\n\n    cdb.god.bind(\"closeDialogs\", this._onHideDropdown, this);\n\n    this.$el.append(this.dropdown.render().el);\n\n  },\n\n  _onHideDropdown: function() {\n\n    this.dropdown.hide();\n    this.$el.css(\"z-index\", 1);\n\n  },\n\n  _setupModel: function() {\n\n    this.model.bind('change:active', this._onChangeActive, this);\n    this.model.visualization.bind('change:transition_options', this._onChangeTransitionOptions, this);\n    this.model.bind('remove',        this._onDestroy, this);\n\n    this.model.collection.bind('add remove reset change:next_id', this._onChangeCount, this);\n    this.add_related_model(this.model.collection);\n\n  },\n\n  _onClick: function(e) {\n    this.killEvent(e);\n    this.model.collection.setActive(this.model);\n  },\n\n  _onClickInfo: function(e) {\n    this.killEvent(e);\n    this.$el.css(\"z-index\", 100)\n  },\n\n  _onClickClose: function(e) {\n    this.killEvent(e);\n\n    var delete_confirmation = cdb.editor.ViewFactory.createDialogByTemplate('common/dialogs/confirm_delete_slide');\n    delete_confirmation.ok = this.model.destroy.bind(this.model);\n    delete_confirmation.appendToBody();\n  },\n\n  _onDestroy: function() {\n    var self = this;\n\n    this.hide(function() {\n      self.clean();\n    });\n\n  },\n\n  _onChangeCount: function() {\n    this.$el.find(\".count\").html(this.model.collection.indexOf(this.model) + 1);\n  },\n\n  _onChangeTransitionOptions: function() {\n\n    var transition_method = this._getTransitionMethod();\n\n    this.$el.find(\".js-change-transition-method\").html(transition_method);\n\n  },\n\n  _onChangeActive: function() {\n\n    if (this.model.isActive()) {\n      this.$el.addClass(\"active\");\n    } else {\n      this.$el.removeClass(\"active\");\n    }\n    cdb.god.trigger(\"closeDialogs\");\n\n  },\n\n  hide: function(callback) {\n\n    this.$el\n    .removeClass('animated bounceIn')\n    .addClass('animated bounceOut');\n\n    if (callback) {\n      setTimeout(function() {\n        callback();\n      }, 500)\n    }\n\n  },\n\n  _getTransitionMethod: function() {\n\n    var transition = this.model.visualization.get(\"transition_options\");\n    var transition_method = \"on click\";\n\n    if (transition && transition.transition_trigger === \"time\") {\n      transition_method = (transition.time !== 1) ? transition.time + \" seconds\" : \"1 second\";\n    }\n\n    return transition_method;\n\n  },\n\n  show: function() {\n    this.$el.addClass('animated bounceIn');\n  },\n\n  render: function() {\n\n    this.$el.attr(\"href\", \"#\");\n\n    // TODO: remove count && get the value from the model\n    var attributes = _.extend(this.model.attributes, { count: 1, transition: true, transition_method: this._getTransitionMethod() });\n\n    this.$el.append(this.template(attributes));\n\n    this._onChangeActive();\n    this._onChangeCount();\n\n    this._setupDropdown();\n\n    this.$el.attr(\"id\", this.model.get(\"id\"))\n\n    return this;\n\n  }\n\n});\n\ncdb.admin.SlideViewAdd = cdb.admin.SlideView.extend({\n\n  className: 'slide_view add',\n\n  template_name: 'table/views/slides/add_slide',\n\n  _setupModel: function() {\n    this.model.bind('change:loading', this._onChangeLoading, this);\n  },\n\n  _onChangeLoading: function(e) {\n\n    if (this.model.get(\"loading\")) {\n      this.$el.addClass(\"loading\");\n    } else {\n      this.$el.removeClass(\"loading\");\n    }\n\n  },\n\n  _onClick: function(e) {\n\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.trigger(\"click\", this);\n\n  },\n\n  render: function() {\n\n    this.$el.attr(\"href\", \"#\");\n\n    var attributes = this.options;\n\n    this.$el.append(this.template(attributes));\n\n    return this;\n\n  }\n\n});\n","/**\n *  entry point for table\n */\n\n\n$(function() {\n\n  var Table = cdb.core.View.extend({\n\n    el: document.body,\n\n    events: {\n      'keypress': 'keyPress',\n      'keyup': 'keyUp'\n    },\n\n    initialize: function(options) {\n      this.table = null;\n      this.selectedMenu = null; // enable this\n      this.workViewActive = 'table';\n                                      // for oppening a menu in the startup\n      // Get user layers as well\n      this.options.user_data.get_layers = true;\n\n      this.user = new cdb.admin.User(this.options.user_data);\n      cdb.config.set('user', this.user);\n\n      this._initModels();\n      this._initViews();\n\n      cdb.admin.hotkeys.enable();\n      this.keyBind();\n      this._initBinds();\n    },\n\n    /**\n    * Bind the keystrokes associated with menu actions\n    * alt + <- : show right menu\n    * alt + -> : hide right menu\n    * alt + c : toggle carto\n    * alt + s : toggle sql\n    * @method keyBind\n    */\n    keyBind: function() {\n      var self = this;\n      cdb.god.bind('hotkey:d', function(e) {\n        self.menu.isOpen\n          ? self.menu.hide()\n          : self.menu.show('sql_mod');\n      });\n      cdb.god.bind('hotkey:s', function(e) {\n        self.menu.show('sql_mod');\n      })\n      cdb.god.bind('hotkey:c', function(e) {\n        self.menu.show('style_mod');\n      })\n    },\n\n    _initModels: function() {\n      var self = this;\n      this.vis = new cdb.admin.Visualization(this.options.vis_data);\n        // when the user changes slides the visualization is changed\n        // but we want to keep the master one for tasks that require to use it\n      this.master_vis = new cdb.admin.Visualization(_.omit(this.options.vis_data, 'children'));\n\n      this.vis.setMaster(this.master_vis);\n\n      // if slides are available enable first one to fetch the map\n      // if not use the master map\n      if (this.vis.slides.length === 0) {\n        this.vis.map.set(this.vis.map.parse(this.options.map_data));\n      } else {\n        this.vis.activeSlide(0);\n      }\n\n      this.map = this.vis.map;\n      this.vis.enableOverlays();\n\n\n      var layers = this.options.basemaps;\n\n      this.baseLayers = this.user.layers;\n      this.baseLayers.each(function(m) {\n        m.set('category', 'Yours');\n      })\n\n      _(layers).each(function(catLayers, cat) {\n        _(catLayers).map(function(m) {\n          var baseTypes = {\n            'googlemaps': cdb.admin.GMapsBaseLayer\n          }\n          var BaseType = baseTypes[m.className] || cdb.admin.TileLayer;\n\n          // Default basemaps are defined in app_config.yml and\n          // lib/assets/javascripts/cartodb/table/default_layers.js\n          var tmpLayer = {\n            name:        m.name,\n            className:   m.className,\n            base_type:   m.baseType || 'default',\n            urlTemplate: m.url,\n            minZoom:     m.minZoom,\n            maxZoom:     m.maxZoom,\n            attribution: m.attribution,\n            subdomains:  m.subdomains,\n            baseName:    m.baseName,\n            style:       m.style ? JSON.parse(m.style): null,\n            labels:      m.labels,\n            read_only:   true,\n            category:    cat\n          };\n\n          if (m.tileSize) {\n            tmpLayer.tileSize = m.tileSize;\n          }\n\n          if (m.zoomOffset) {\n            tmpLayer.zoomOffset = m.zoomOffset;\n          }\n\n          // Default basemaps are defined in app_config.yml and\n          // lib/assets/javascripts/cartodb/table/default_layers.js\n          self.baseLayers.add(new BaseType(tmpLayer));\n        });\n      });\n\n      // Background polling model\n      // - It takes care of the background imports and geocodings\n      this.backgroundPollingModel = new cdb.editor.BackgroundPollingModel({\n        geocodingsPolling: true,\n        importsPolling: false\n      }, {\n        user: this.user,\n        vis: this.vis\n      });\n    },\n\n    _resetModel: function(_id) {\n      this.vis = new cdb.admin.Visualization({ id: _id });\n      this.vis.fetch();\n    },\n\n    _initViews: function() {\n      this.globalError = new cdb.admin.GlobalError({\n        el: $('.globalerror')\n      });\n      this.globalError.listenGlobal();\n      this.addView(this.globalError);\n\n      // ***  Locked visualization (table or visualization type)?\n      if (this.vis.get('locked')) {\n        var viewModel = new cdb.editor.ChangeLockViewModel({\n          items: [this.vis],\n          contentType: this.vis.isVisualization() ? 'maps' : 'datasets'\n        });\n        var view = new cdb.editor.ChangeLockView({\n          model: viewModel,\n          ownerName: this.vis.permission.owner.get('username'),\n          isOwner: this.vis.permission.isOwner(this.user),\n          template: cdb.templates.getTemplate('common/dialogs/change_lock/templates/unlock_to_editor'),\n          clean_on_hide: true,\n          enter_to_confirm: true\n        });\n        var self = this;\n        view.cancel = function() {\n          window.location = self.user.viewUrl().dashboard()[ self.vis.isVisualization() ? 'maps' : 'datasets' ]().urlToPath('locked');\n        };\n\n        view.appendToBody();\n      }\n\n      // *** Warning opening Builder maps in the old editor\n      if (this.vis.isVisualization() && this.vis.get('uses_builder_features')) {\n        var view = new cdb.editor.BuilderFeaturesWarningDialog({\n          clean_on_hide: true,\n          enter_to_confirm: true\n        });\n        var self = this;\n        view.cancel = function() {\n          window.location = self.user.viewUrl().dashboard()[ self.vis.isVisualization() ? 'maps' : 'datasets' ]();\n        };\n\n        view.appendToBody();\n      }\n\n      // ***  tabs\n      this.tabs = new cdb.admin.Tabs({\n        el: this.$('nav'),\n        slash: true\n      });\n      this.addView(this.tabs);\n\n      // *** work pane (table and map)\n      this.workView = new cdb.ui.common.TabPane({\n        el: this.$('.panes')\n      });\n\n      this.addView(this.workView);\n\n      // *** right menu\n      // We need to provide the master/parent vis to allow creating a new visualization\n      // and the regular vis to work with the layers\n      this.menu = new cdb.admin.LayersPanel({\n        vis: this.vis,\n        master_vis: this.master_vis,\n        user: this.user,\n        globalError: this.globalError\n      });\n\n      this.$el.append(this.menu.render().el);\n      this.menu.hide();\n      this.addView(this.menu);\n\n      this.menu.bind('switch', function(layerView) {\n        this.setTable(layerView.table, layerView.sqlView);\n        if(!this.tableTab) {\n          this._initTableMap();\n          this.table.trigger('change', this.table);\n        }\n        this.tableTab.setActiveLayer(layerView);\n        this.mapTab.setActiveLayer(layerView);\n        this.header.setActiveLayer(layerView);\n      }, this);\n\n      // Set watching notifier if needed\n      if (!this.vis.isVisualization()) {\n        this._setWatchingNotifier();\n      }\n\n      // global click\n      enableClickOut(this.$el);\n\n      // On resize window...\n      $(window).bind(\"resize\", this._onResize);\n\n      // If import layer fail, show dialog\n      this.backgroundPollingModel.bind('importLayerFail', function(errorMsg) {\n        cdb.editor.ViewFactory.createDialogByTemplate('common/templates/fail', { msg: errorMsg })\n        .render().appendToBody();\n      });\n\n      this.backgroundPollingModel.bind('geocodingCompleted', function(mdl) {\n        // Refresh data in order to have cartodb_georef_status column updated\n        // but only if current layer data is the geocoded one\n        if (this.table && this.table.get('id') === mdl.get('table_name') && this.table.data) {\n          this.table.data().refresh()\n        }\n        // Refresh map\n        if (this.mapTab && this.mapTab.updateDataLayerView) {\n          this.mapTab.updateDataLayerView()\n        }\n        // Reload user data in order to have updated info about geocoding quota etc.\n        this.user.fetch();\n      }, this);\n\n      this.backgroundPollingModel.bind('geocodingFailed', function() {\n        // Refresh data in order to have\n        // cartodb_georef_status column updated\n        if (this.table && this.table.data) {\n          this.table.data().refresh()\n        }\n      }, this);\n\n      this.backgroundPollingModel.bind('importCompleted', function() {\n        // Reload user data in order to have updated info about limits etc.\n        this.user.fetch();\n      }, this);\n\n      // Background polling view!\n      var bgPollingView = new cdb.editor.BackgroundPollingView({\n        model: this.backgroundPollingModel,\n        createVis: false,\n        vis: this.vis,\n        user: this.user\n      });\n\n      this.$el.append(bgPollingView.render().el);\n      this.addView(bgPollingView);\n\n    },\n\n    _initTableMap: function() {\n      var self = this;\n\n\n      // Init geocoder\n      // TODO: remove when new_modals is enabled for everybody\n      this.geocoder = new cdb.admin.Geocoding();\n\n      // New visualization header\n      this.header = new cdb.admin.Header({\n        el: this.$('header'),\n        globalError: this.globalError,\n        model: this.master_vis,\n        visualization: this.vis,\n        user: this.user,\n        config: this.options.config,\n        geocoder: this.geocoder,\n        backgroundPollingModel: this.backgroundPollingModel\n      });\n      this.addView(this.header);\n\n      // Table tab\n      this.tableTab = new cdb.admin.TableTab({\n        model: this.table,\n        user: this.user,\n        vis: this.vis,\n        sqlView: this.sqlView,\n        geocoder: this.geocoder,\n        backgroundPollingModel: this.backgroundPollingModel,\n        globalError: this.globalError,\n        menu: this.menu\n      });\n\n      // Map tab\n      this.mapTab = new cdb.admin.MapTab({\n        model: this.map,\n        baseLayers: this.baseLayers,\n        vis: this.vis,\n        master_vis: this.master_vis,\n        geocoder: this.geocoder,\n        backgroundPollingModel: this.backgroundPollingModel,\n        table: this.table,\n        user: this.user,\n        menu: this.menu\n      });\n\n      // Mamufas view\n      this.mamufasView = new cdb.editor.MamufasImportView({\n        el: this.$el,\n        user: this.user\n      }).render();\n\n      if (this.vis.isVisualization()) {\n        this.mamufasView.enable();\n      }\n\n      this._addVideoPlayer();\n\n      this.map.bind('notice', this.globalError.showError, this.globalError);\n\n      this.workView.bind('tabEnabled:map', this.mapTab.enableMap, this.mapTab);\n      this.workView.bind('tabEnabled', this.tabs.activate);\n      this.mapTab.bind('missingClick', self.menu.hide, self.menu);\n\n      this.workView.addTab('table', this.tableTab.render(), { active: false });\n      this.workView.addTab('map', this.mapTab.render(), { active: false });\n      this.workView.active(this.workViewActive);\n    },\n\n    _initBinds: function() {\n      cdb.god.bind('geocodingChosen', this._onGeocodingChosen, this);\n      cdb.god.bind('dialogOpened', function() {\n        if (this.vis.isVisualization() && this.mamufasView) {\n          this.mamufasView.disable();\n        }\n        this.backgroundPollingModel && this.backgroundPollingModel.stopPollings();\n      }, this);\n      cdb.god.bind('dialogClosed', function() {\n        if (this.vis.isVisualization() && this.mamufasView) {\n          this.mamufasView.enable();\n        }\n        this.backgroundPollingModel && this.backgroundPollingModel.startPollings();\n      }, this);\n    },\n\n    _onGeocodingChosen: function(data) {\n      this._sendGeocodingMetrics(data.type);\n\n      var geocodeModel;\n      if (data.type === 'lonlat') {\n        geocodeModel = new cdb.editor.LonLatGeocodingModel({\n          table: this.table,\n          longitude_column: data.longitude,\n          latitude_column: data.latitude,\n          force_all_rows: !!data.force_all_rows\n        });\n      } else {\n        geocodeModel = new cdb.editor.GeocodingModel(_.omit(data, 'type'))\n      }\n\n      this.backgroundPollingModel.addGeocodingItem(geocodeModel);\n    },\n\n    _sendGeocodingMetrics: function(type) {\n      // Event tracking \"Geocoding\"\n      cdb.god.trigger('metrics', 'geocoding', {\n        email: window.user_data.email\n      });\n    },\n\n    setTable: function(table, sqlView) {\n      var self = this;\n      if(this.table) {\n        this.table.unbind('notice', null, this.globalError);\n        this.table.unbind('change:permission', null, this);\n      }\n\n      function setPermissions() {\n        // check permissions to set read only\n        table.setReadOnly(!table.permission.hasWriteAccess(self.user));\n      }\n      table.bind('change:permission', setPermissions, this);\n      setPermissions();\n\n      this.table = table;\n      this.sqlView = sqlView;\n      this.table.bind('notice', this.globalError.showError, this.globalError);\n      this.table.bind('change:isSync', this._setSyncInfo, this);\n      this._setSyncInfo();\n    },\n\n    _addVideoPlayer: function() {\n\n      this.player = new cdb.admin.VideoPlayer();\n\n      if (this.player.hasVideoData()) {\n        this.$el.append(this.player.render().$el);\n      }\n\n    },\n\n    // Set necessary info if the table is synced\n    _setSyncInfo: function() {\n      if (this.table && this.table.isSync() && !this.vis.isVisualization()) {\n        this.workView.$el.addClass('synced');\n      } else {\n        this.workView.$el.removeClass('synced');\n      }\n    },\n\n    _setWatchingNotifier: function() {\n      // Create model\n      var watchvis_notifier = new cdb.admin.WatchingNotifierModel({}, {\n        vis:      this.vis,\n        interval: cdb.config.get('watcher_ttl')\n      });\n\n      // And then the view\n      var watchvis_notifier_view = new cdb.admin.WatchingNotifierView({\n        model:  watchvis_notifier,\n        user:   this.user\n      });\n\n      this.$el.append(watchvis_notifier_view.render().el);\n      this.addView(watchvis_notifier_view);\n    },\n\n    // Close all dialogs in window resize\n    _onResize: function(e) {\n      cdb.god.trigger(\"closeDialogs\");\n    },\n\n    keyUp: function(e) {},\n\n    keyPress: function(e) {},\n\n    // Show big loader when changes to visualization\n    // or table\n    showLoader: function(type) {\n      this.hideLoader();\n      this._loader = cdb.editor.ViewFactory.createDialogByTemplate('common/templates/loading', {\n        title: 'Setting ' + type,\n        quote: cdb.editor.randomQuote()\n      });\n      this._loader.appendToBody();\n    },\n\n    // Hide big loader when visualization\n    // or table finishes\n    hideLoader: function() {\n      if (this._loader) {\n        this._loader.close();\n        this._loader = null;\n      }\n    },\n\n    activeView: function(name) {\n      this.workView.active(name);\n      // table or map is active?\n      this.menu.setActiveWorkView(name);\n      this.workViewActive = name;\n    }\n  });\n\n  cdb._test = cdb._test || {};\n  cdb._test.Table = Table;\n\n\n  cdb.init(function() {\n    cdb.config.set(config);\n    cdb.config.set('api_key', user_data.api_key);\n    cdb.templates.namespace = 'cartodb/';\n    cdb.config.set('url_prefix', user_data.base_url);\n\n    var currentUser = new cdb.admin.User(window.user_data);\n\n    // Store JS errors\n    var errors = new cdb.admin.ErrorStats({ user_data: user_data });\n\n    // Main view\n    var table = new Table({\n      vis_data: vis_data,\n      user_data: user_data,\n      config: config,\n      map_data: map_data,\n      basemaps: basemaps || cdb.admin.DEFAULT_BASEMAPS\n    });\n\n    var metrics = new cdb.admin.Metrics();\n\n    // expose to debug\n    window.table = table;\n    window.table_router = new cdb.admin.TableRouter(table);\n\n    Backbone.history.start({\n      pushState: true,\n      root: cdb.config.prefixUrlPathname() + '/'\n    });\n  });\n\n});\n","\n  /**\n   *  New table router \\o/\n   *\n   *  - No more /#/xxx routes\n   *  - Control if current visualization is a table or a viz\n   */\n\n  cdb.admin.TableRouter = Backbone.Router.extend({\n\n    _TEXTS: {\n      error: _t('Something went wrong, try again later')\n    },\n\n    routes: {\n      ':type/:id':            'change',\n      ':type/:id/':           'change',\n      ':type/:id/:scenario':  'change'\n    },\n\n    initialize: function(table) {\n      this.history = [];\n      this.table = table;\n      this.addToHistory();\n    },\n\n    changeToVis: function(vis) {\n      // Get scenario param (table or map)\n      var last_route = this.history.length > 0 && _.last(this.history).split('/');\n      // Create url\n      var url = \"/viz/\" + vis.get(\"id\") + \"/\" + ( last_route[2] || 'table' );\n      // Navigate\n      this.navigate(url, { trigger: false });\n      this.addToHistory();\n    },\n\n    addToHistory: function() {\n      if (Backbone.history.fragment) {\n        // I hate you double quotes!\n        var fragment = (Backbone.history.fragment.replace(/\"/g, ''));\n        this.history.push(fragment);\n      }\n    },\n\n    change: function(type, _id, scenario) {\n      var last_route = this.history.length > 0 && _.compact(_.last(this.history).split('/'));\n      var loader = false;\n      var isTable = false;\n      var self = this;\n\n      // Change quotes by %22 (not encodeURIComponent for the moment).\n      _id = _id.replace(/\"/g,'');\n\n      // Check if type has changed\n      if (last_route && last_route.length > 0 && last_route[0] != type && type == \"tables\") {\n\n        loader = true;\n        isTable = true;\n        self.table.showLoader('dataset');\n\n        var table = new cdb.admin.CartoDBTableMetadata({ id: _id });\n        table.fetch({\n          wait: true,\n          success: function(m) {\n            toVis(m.get(\"table_visualization\").id);\n          },\n          fail: function() {\n            self.table.globalError.showError(self._TEXTS.error, \"error\", 5000)\n          }\n        })\n      }\n\n      // Check if id has changed\n      if (last_route && last_route.length > 1 && last_route[1] != _id) {\n\n        // Show loader if it is not available\n        if (!loader) {\n          self.table.showLoader('visualization');\n        }\n\n        // Table id or visualization id\n        if (!isTable) {\n          toVis(_id);\n        }\n      }\n\n      // Check active view, if it is different, change\n      if (scenario != 'table' && scenario != 'map') scenario = 'table';\n      this.table.activeView(scenario);\n\n      // Add to history :)\n      this.addToHistory();\n\n\n      // Function to change to visualization\n      function toVis(new_id) {\n        self.table.master_vis\n          .set('id', new_id)\n          .fetch({\n            wait: true,\n            success: function(vis) {\n              // Get related tables if it is necessary\n              vis.getRelatedTables();\n              self.table.hideLoader();\n            },\n            error: function() {\n              self.table.hideLoader();\n              self.table.globalError.showError(self._TEXTS.error, \"error\", 5000);\n            }\n          });\n      }\n    },\n\n    changeToMap: function() {\n      var url = window.location.pathname;\n      var tabName = url.substr(url.length - 4);\n      if (tabName !== '/map') {\n        url = url.substring(0,url.lastIndexOf(\"/table\")) + '/map';\n        this.navigate(url, { trigger: false });\n        this.addToHistory();\n      }\n    },\n\n    changeToDataset: function() {\n      var url = window.location.pathname;\n      var tabName = url.substr(url.length - 6);\n      if (tabName !== '/table') {\n        url = url.substring(0,url.lastIndexOf(\"/map\")) + '/table';\n        this.navigate(url, { trigger: false });\n        this.addToHistory();\n      }\n    }\n\n  });\n","\n(function() {\n\n    /**\n     * table view shown in admin\n     */\n    cdb.admin.TableView = cdb.ui.common.Table.extend({\n\n      classLabel: 'cdb.admin.TableView',\n\n      events: cdb.core.View.extendEvents({\n          'click .clearview': '_clearView',\n          'click .sqlview .export_query': '_tableFromQuery',\n          'click .noRows': 'addEmptyRow'\n      }),\n\n      rowView: cdb.admin.RowView,\n\n      initialize: function() {\n        var self = this;\n        this.elder('initialize');\n        this.options.row_header = true;\n        this.globalError = this.options.globalError;\n        this.vis = this.options.vis;\n        this.user = this.options.user;\n        this._editorsOpened = null;\n\n        this.initializeBindings();\n\n        this.initPaginationAndScroll();\n      },\n\n      /**\n       * Append all the bindings needed for this view\n       * @return undefined\n       */\n      initializeBindings: function() {\n        var self = this;\n\n        _.bindAll(this, \"render\", \"rowSaving\", \"addEmptyRow\",\n          \"_checkEmptyTable\", \"_forceScroll\", \"_scrollMagic\",\n          \"rowChanged\", \"rowSynched\", \"_startPagination\", \"_finishPagination\",\n          \"rowFailed\", \"rowDestroyed\", \"emptyTable\");\n\n        this.model.data().bind('newPage', this.newPage, this);\n\n        //this.model.data().bind('loadingRows', this._startPagination);\n        this.model.data().bind('endLoadingRows', this._finishPagination);\n\n        this.bind('cellDblClick', this._editCell, this);\n        this.bind('createRow', function() {\n          self._checkEmptyTable();\n        });\n\n\n        this.model.bind('change:dataSource', this._onSQLView, this);\n        // when model changes the header is re rendered so the notice should be added\n        //this.model.bind('change', this._onSQLView, this);\n        this.model.bind('dataLoaded', function() {\n          //self._checkEmptyTable();\n          self._forceScroll();\n        }, this);\n\n        this.model.bind('change:permission', this._checkEmptyTable, this);\n\n        this.model.bind('change:isSync', this._swicthEnabled, this);\n        this._swicthEnabled();\n\n        // Actions triggered in the right panel\n        cdb.god.bind(\"panel_action\", function(action) {\n          self._moveInfo(action);\n        }, this);\n        this.add_related_model(cdb.god);\n\n        // Geocoder binding\n        this.options.geocoder.bind('geocodingComplete geocodingError geocodingCanceled', function() {\n          this.notice(_t('loaded'));\n        }, this);\n        this.add_related_model(this.options.geocoder);\n      },\n\n      initPaginationAndScroll: function() {\n        var self = this;\n        var topReached = false;\n        var bottomReached = false;\n\n        // Initialize moving header and loaders when scrolls\n        this.scroll_position = { x:$(window).scrollLeft(), y:$(window).scrollTop(), last: 'vertical' };\n        $(window).scroll( this._scrollMagic );\n\n        // Pagination\n        var SCROLL_BACK_PIXELS = 2;\n        this.checkScrollTimer = setInterval(function() {\n          if(!self.$el.is(\":visible\") || self.model.data().isFetchingPage()) {\n            return;\n          }\n          var pos = $(this).scrollTop();\n          var d = self.model.data();\n          // do not let to fetch previous pages\n          // until the user dont scroll back a little bit\n          // see comments below\n          if(pos > SCROLL_BACK_PIXELS) {\n            topReached = false;\n          }\n          var pageSize = $(window).height() - self.$el.offset().top;\n          var tableHeight = this.$('tbody').height();\n          var realPos = pos + pageSize;\n          if(tableHeight < pageSize) {\n            return;\n          }\n          // do not let to fetch previous pages\n          // until the user dont scroll back a little bit\n          // if we dont do this when the user reach the end of the page\n          // and there are more rows than max_rows, the rows form the beggining\n          // are removed and the scroll keeps at the bottom so a new page is loaded\n          // doing this the user have to move the scroll a little bit (2 px)\n          // in order to load the page again\n          if(realPos < tableHeight - SCROLL_BACK_PIXELS) {\n            bottomReached = false;\n          }\n          if(realPos >= tableHeight) {\n            if(!bottomReached) {\n              // Simulating loadingRows event\n              if (!d.lastPage) self._startPagination('down');\n\n              setTimeout(function() {\n                d.loadPageAtBottom();\n              },600);\n            }\n            bottomReached = true;\n          } else if (pos <= 0) {\n            if(!topReached) {\n              // Simulating loadingRows event\n              if (d.pages && d.pages[0] != 0) self._startPagination('up');\n\n              setTimeout(function() {\n                d.loadPageAtTop()\n              },600);\n            }\n            topReached = true;\n          }\n\n          self._setUpPagination(d);\n        }, 300);\n        this.bind('clean', function() {\n          clearInterval(this.checkScrollTimer);\n        }, this);\n      },\n\n      needsRender: function(table) {\n        if (!table) return true;\n        var ca = table.changedAttributes();\n        if (ca.geometry_types && _.keys(ca).length === 1) {\n          return false;\n        }\n        return true;\n      },\n\n      render: function(args) {\n        if (!this.needsRender(args)) return;\n        this.elder('render', args);\n        if (this.model.isInSQLView()) {\n          this._onSQLView();\n        }\n        this._swicthEnabled();\n        this.trigger('render');\n      },\n\n      _renderHeader: function() {\n        var thead = cdb.ui.common.Table.prototype._renderHeader.apply(this);\n        // New custom shadow (better performance)\n        thead.append($('<div>').addClass('shadow'));\n        return thead;\n      },\n\n      addColumn: function(column){\n        this.newColumnName = \"column_\" + new Date().getTime();\n\n        this.model.addColumn(this.newColumnName, 'string');\n\n        this.unbind(\"render\", this._highlightColumn, this);\n        this.bind(\"render\", this._highlightColumn, this);\n      },\n\n      _highlightColumn: function() {\n\n        if (this.newColumnName) {\n\n          var $th = this.$(\"a[href='#\" + this.newColumnName + \"']\").parents(\"th\");\n          var position = $th.index();\n\n          if (position) {\n\n            setTimeout(function() {\n              var windowWidth = $(window).width();\n              if ($th && $th.position()) {\n                var centerPosition = $th.position().left - windowWidth/2 + $th.width()/2;\n                $(window).scrollLeft(centerPosition);\n              }\n              this.$(\"[data-x='\" + position + \"']\").addClass(\"is-highlighted\");\n            }, 300);\n\n            this.unbind(\"render\", this._highlightColumn, this);\n          }\n        }\n      },\n\n      /**\n       *  Take care if the table needs space at top and bottom\n       *  to show the loaders.\n       */\n      _setUpPagination: function(d) {\n        var pages = d.pages;\n\n        // Check if the table is not in the first page\n        if (pages.length > 0 && pages[0] > 0) {\n          // In that case, add the paginator-up loader and leave it ready\n          // when it is necessary\n          if (this.$el.find('tfoot.page_loader.up').length == 0) {\n            this.$el.append(this.getTemplate('table/views/table_pagination_loaders')({ direction: 'up' }));\n          }\n          // Table now needs some space at the top to show the loader\n          this.$el.parent().addClass(\"page_up\");\n        } else {\n          // Loader is not needed and table doesn't need any space at the top\n          this.$el.parent().removeClass(\"page_up\");\n        }\n\n        // Checks if we are in the last page\n        if (!d.lastPage) {\n          // If not, let's prepare the paginator-down\n          if (this.$el.find('tfoot.page_loader.down').length == 0) {\n            this.$el.append(this.getTemplate('table/views/table_pagination_loaders')({ direction: 'down' }));\n          }\n          // Let's say to the table that we have paginator-down\n          this.$el.parent().addClass(\"page_down\");\n        } else {\n          // Loader is not needed and table doesn't need any space at the bottom\n          this.$el.parent().removeClass(\"page_down\");\n        }\n      },\n\n\n      /**\n       *  What to do when a pagination starts\n       */\n      _startPagination: function(updown) {\n        // Loader... move on buddy!\n        this.$el.find(\".page_loader.\" + updown + \"\").addClass('active');\n      },\n\n      /**\n       *  What to do when a pagination finishes\n       */\n      _finishPagination: function(page, updown) {\n\n        // If we are in a different page than 0, and we are paginating up\n        // let's move a little bit the scroll to hide the loader again\n        // HACKY\n        if (page != 0 && updown == \"up\") {\n          setTimeout(function(){\n            $(window).scrollTop(180);\n          },300);\n        }\n\n        this.$el.find('.page_loader.active').removeClass('active');\n      },\n\n\n      _onSQLView: function() {\n        // bind each time we change dataSource because table unbind\n        // all the events from sqlView object each time useSQLView is called\n        this.$('.sqlview').remove();\n\n        this.options.sqlView.unbind('reset error', this._renderSQLHeader, this);\n        this.options.sqlView.unbind('loading', this._renderLoading, this);\n\n        this.options.sqlView.bind('loading', this._renderLoading, this);\n        this.options.sqlView.bind('reset', this._renderSQLHeader, this);\n        this.options.sqlView.bind('error', this._renderSQLHeader, this);\n        this._renderSQLHeader();\n      },\n\n      _renderLoading: function(opts) {\n        opts = opts || {};\n        this.cleanEmptyTableInfo();\n        if(!opts.add) {\n          this._renderBodyTemplate('table/views/sql_loading');\n        }\n      },\n\n      _renderSQLHeader: function() {\n        var self = this;\n        if(self.model.isInSQLView()) {\n          var empty = self.isEmptyTable();\n          self.$('thead').find('.sqlview').remove();\n          self.$('thead').append(\n            self.getTemplate('table/views/sql_view_notice')({\n              empty: empty,\n              isVisualization: self.vis.isVisualization(),\n              warnMsg: null\n            })\n          );\n\n          self.$('thead > tr').css('height', 64 + 42);\n          if(self.isEmptyTable()) {\n            self.addEmptySQLIfo();\n          }\n\n          self._moveInfo();\n        }\n      },\n\n      // depending if the sync is enabled add or remove a class\n      _swicthEnabled: function() {\n        // Synced?\n        this.$el[ this.model.isSync() ? 'addClass' : 'removeClass' ]('synced');\n        // Visualization?\n        this.$el[ this.vis.isVisualization() ? 'addClass' : 'removeClass' ]('vis');\n      },\n\n      _clearView: function(e) {\n        if (e) e.preventDefault();\n        this.options.layer.clearSQLView();\n        return false;\n      },\n\n      _tableFromQuery: function(e) {\n        e.preventDefault();\n\n        var duplicate_dialog = new cdb.editor.DuplicateDatasetView({\n          model: this.model,\n          user: this.user,\n          clean_on_hide: true\n        });\n        duplicate_dialog.appendToBody();\n      },\n\n\n      /**\n       *  Function to control the scroll in the table (horizontal and vertical)\n       */\n      _scrollMagic: function(ev) {\n        var actual_scroll_position = { x:$(window).scrollLeft(), y:$(window).scrollTop() };\n\n        if (this.scroll_position.x != actual_scroll_position.x) {\n          this.scroll_position.x = actual_scroll_position.x;\n          this.$el.find(\"thead\").addClass(\"horizontal\");\n\n          // If last change was vertical\n          if (this.scroll_position.last == \"vertical\") {\n            this.scroll_position.x = actual_scroll_position.x;\n\n            this.$el.find(\"thead > tr > th > div > div:not(.dropdown)\")\n              .removeAttr(\"style\")\n              .css(\"top\", actual_scroll_position.y + \"px\");\n\n            this.scroll_position.last = \"horizontal\";\n          }\n\n        } else if (this.scroll_position.y != actual_scroll_position.y) {\n          this.scroll_position.y = actual_scroll_position.y;\n          this.$el.find(\"thead\").removeClass(\"horizontal\");\n\n          // If last change was horizontal\n          if (this.scroll_position.last == \"horizontal\") {\n\n            this.$el.find(\"thead > tr > th > div > div:not(.dropdown)\")\n              .removeAttr('style')\n              .css({\"marginLeft\": \"-\" + actual_scroll_position.x + \"px\"});\n\n            this.scroll_position.last = \"vertical\";\n          }\n        }\n      },\n\n\n      /**\n       *  Move the info content if the panel is opened or hidden.\n       *  - Query info if query is applied\n       *  - Query loader if query is appliying in that moment\n       *  - Add some padding to last column of the content to show them\n       */\n      _moveInfo: function(type) {\n        if (type == \"show\") {\n          this.$el\n            .removeClass('narrow')\n            .addClass('displaced');\n        } else if (type == \"narrow\") {\n          this.$el.addClass('displaced narrow')\n        } else if (type == \"hide\") {\n          this.$el.removeClass('displaced narrow');\n        } else {\n          // Check from the beginning if the right menu is openned, isOpen from\n          // the menu is not working properly\n          if ($('.table_panel').length > 0) {\n            var opened = $('.table_panel').css(\"right\").replace(\"px\",\"\") == 0 ? true : false;\n            if (!opened) {\n              this.$el.removeClass('displaced');\n            }\n          }\n        }\n      },\n\n      _getEditor: function(columnType, opts) {\n        var editors = {\n          'string':                       cdb.admin.StringField,\n          'number':                       cdb.admin.NumberField,\n          'date':                         cdb.admin.DateField,\n          'geometry':                     cdb.admin.GeometryField,\n          'timestamp with time zone':     cdb.admin.DateField,\n          'timestamp without time zone':  cdb.admin.DateField,\n          'boolean':                      cdb.admin.BooleanField\n        };\n\n        var editorExists = _.filter(editors, function(a,i) { return i === columnType }).length > 0;\n\n        if(columnType !== \"undefined\" && editorExists) {\n          return editors[columnType];\n        } else {\n          return editors['string']\n        }\n      },\n\n\n      closeEditor: function() {\n        if (this._editorsOpened) {\n          this._editorsOpened.hide();\n          this._editorsOpened.clean();\n        }\n      },\n\n\n      _editCell: function(e, cell, x, y) {\n        var self = this;\n\n        // Clean and close previous cell editor\n        this.closeEditor();\n\n        var column = self.model.columnName(x-1);\n        var columnType = this.model.getColumnType(column);\n\n        if (this.model.isReservedColumn(column) && !this.model.isReadOnly() && columnType!='geometry') {\n          return;\n        }\n\n        var row = self.model.data().getRowAt(y);\n\n        var initial_value = '';\n        if(self.model.data().getCell(y, column) === 0 || self.model.data().getCell(y, column) === '0') {\n          initial_value = '0';\n        } else if (self.model.data().getCell(y, column) !== undefined) {\n          initial_value = self.model.data().getCell(y, column);\n        }\n\n        // dont let generic editor\n        if(column == 'the_geom') {\n          columnType = 'geometry'\n        }\n\n        var prevRow = _.clone(row.toJSON());\n\n        var dlg = this._editorsOpened = new cdb.admin.SmallEditorDialog({\n          value:        initial_value,\n          column:       column,\n          row:          row,\n          rowNumber:    y,\n          readOnly:     this.model.isReadOnly(),\n          editorField:  this._getEditor(columnType),\n          res: function(new_value) {\n            if(!_.isEqual(new_value, prevRow[column])) {\n              // do not use save error callback since it avoid model error method to be called\n              row.bind('error', function editError() {\n                row.unbind('error', editError);\n                // restore previopis on error\n                row.set(column, prevRow[column]);\n              });\n              row\n                .save(column, new_value)\n                .done(function(a){\n                  self.model.trigger('data:saved');\n                });\n            }\n          }\n        });\n\n        if(!dlg) {\n          cdb.log.error(\"editor not defined for column type \" + columnType);\n          return;\n        }\n\n        // auto add to table view\n        // Check first if the row is the first or the cell is the last :)\n        var $td = $(e.target).closest(\"td\")\n          , offset = $td.offset()\n          , $tr = $(e.target).closest(\"tr\")\n          , width = Math.min($td.outerWidth(), 278);\n\n        // Remove header spacing from top offset\n        offset.top = offset.top - this.$el.offset().top;\n\n        if ($td.parent().index() == 0) {\n          offset.top += 5;\n        } else {\n          offset.top -= 11;\n        }\n\n        if ($td.index() == ($tr.find(\"td\").size() - 1) && $tr.find(\"td\").size() < 2) {\n          offset.left -= width/2;\n        } else {\n          offset.left -= 11;\n        }\n\n        dlg.showAt(offset.left, offset.top, width, true);\n      },\n\n\n      headerView: function(column) {\n        var self = this;\n\n        if(column[1] !== 'header') {\n          var v = new cdb.admin.HeaderView({\n            column: column,\n            table: this.model,\n            sqlView: this.options.sqlView,\n            user: this.user,\n            vis: this.vis\n          })\n          .bind('clearView', this._clearView, this)\n          .bind('georeference', function(column) {\n            var dlg;\n            var bkgPollingModel = this.options.backgroundPollingModel;\n            var tableIsReadOnly = this.model.isSync();\n            var canAddGeocoding = bkgPollingModel !== \"\" ? bkgPollingModel.canAddGeocoding() : true; // With new modals\n\n            if (!this.options.geocoder.isGeocoding() && !tableIsReadOnly && canAddGeocoding) {\n              var dlg = new cdb.editor.GeoreferenceView({\n                table:  this.model,\n                user:   this.user,\n                tabs:   ['lonlat', 'city', 'admin', 'postal', 'ip', 'address'],\n                option: 'lonlat',\n                data:   { longitude: column }\n              });\n\n            } else if (this.options.geocoder.isGeocoding() || ( !canAddGeocoding && !tableIsReadOnly )) {\n              dlg = cdb.editor.ViewFactory.createDialogByTemplate('common/background_polling/views/geocodings/geocoding_in_progress');\n            } else {\n              // If table can't geocode == is synched, return!\n              return;\n            }\n\n            dlg.appendToBody();\n          }, this)\n          .bind('applyFilter', function(column) {\n            self.options.menu.show('filters_mod');\n            self.options.layer.trigger('applyFilter',column);\n          }, this)\n\n          this.addView(v);\n\n          if (this.newColumnName == column[0]) {\n            setTimeout(function() {\n              v.renameColumn();\n              self.newColumnName = null;\n            }, 300);\n          }\n\n          return v.render().el;\n        } else {\n          return '<div><div></div></div>';\n        }\n      },\n\n\n      /**\n      * Checks if the table has any rows, and if not, launch the method for showing the appropiate view elements\n      * @method _checkEmptyTable\n      */\n      _checkEmptyTable: function() {\n        if(this.isEmptyTable()) {\n          this.addEmptyTableInfo();\n        } else {\n          this.cleanEmptyTableInfo();\n        }\n      },\n\n\n      /**\n      * Force the table to be at the beginning\n      * @method _forceScroll\n      */\n      _forceScroll: function(ev){\n        $(window).scrollLeft(0);\n      },\n\n      _renderEmpty: function() {\n        this.addEmptyTableInfo();\n      },\n\n      /**\n      * Adds the view elements associated with no content in the table\n      * @method addemptyTableInfo\n      */\n      addEmptyTableInfo: function() {\n        if(this.$('.noRows').length == 0 && !this.model.isInSQLView() && this.model.get('schema')) {\n          this.elder('addEmptyTableInfo');\n\n          this.$el.hide();\n\n          // Fake empty row if the table is not readonly\n          if (!this.model.isReadOnly()) {\n            //TODO: use row view instead of custom HTML\n            var columnsNumber = this.model.get('schema').length;\n            var columns = '<tr class=\"placeholder noRows\"><td class=\"addNewRow\">+</td>';\n            for(var i = 0; i < columnsNumber; i++) {\n              columns += '<td></td>';\n            }\n            columns += '</tr>';\n            var columnsFooter = '<tr class=\"placeholder noRows decoration\"><td></td>';\n            for(var i = 0; i < columnsNumber; i++) {\n              columnsFooter += '<td></td>';\n            }\n            columnsFooter += '</tr>';\n\n            var $columns = $(columns+columnsFooter)\n            this.$el.append($columns);\n          }\n\n          this.template_base = cdb.templates.getTemplate( this.model.isReadOnly() ? 'table/views/empty_readtable_info' : 'table/views/empty_table');\n          var content = this.template_base();\n          var $footer = $('<tfoot><tr><td colspan=\"100\">' + content + '</td></tr></tfoot>');\n          this.$el.append($footer);\n\n          this.$el.fadeIn();\n        }\n      },\n\n      /**\n      * Adds the view elements associated with no content in the table when a SQL is applied\n      * @method addEmptySQLIfo\n      */\n      addEmptySQLIfo: function() {\n        if(this.model.isInSQLView()) {\n          this._renderBodyTemplate('table/views/empty_sql');\n        }\n      },\n\n      _renderBodyTemplate: function(tmpl) {\n        this.$('tbody').html('');\n        this.$('tfoot').remove();\n        this.$el.hide();\n\n        // Check if panel is opened to move the loader some bit left\n        var panel_opened = false;\n        if ($('.table_panel').length > 0) {\n          panel_opened = $('.table_panel').css(\"right\").replace(\"px\",\"\") == 0 ? true : false;\n        }\n\n        var content = cdb.templates.getTemplate(tmpl)({ panel_opened: panel_opened })\n        , $footer = $('<tfoot class=\"sql_loader\"><tr><td colspan=\"100\">' + content + '</td></tr></tfoot>');\n\n        this.$el.append($footer);\n        this.$el.fadeIn();\n      },\n\n      /**\n      * Removes from the view the no-content elements\n      * @method cleanEmptyTableInfo\n      */\n      cleanEmptyTableInfo: function() {\n        this.$('tfoot').fadeOut('fast', function() {\n          $(this).remove();\n        })\n        this.$('.noRows').slideUp('fast', function() {\n          $(this).remove();\n        })\n      },\n\n      notice: function(text, type, time) {\n        this.globalError.showError(text, type, time);\n      },\n\n      /**\n      * Add a new row and removes the empty table view elemetns\n      * @method addEmptyRow\n      * @todo: (xabel) refactor this to include a \"addRow\" method in _models[0]\n      */\n      addEmptyRow: function() {\n        this.dataModel.addRow({ at: 0});\n        this.cleanEmptyTableInfo();\n      },\n\n      /**\n      * Captures the saving event from the row and produces a notification\n      * @todo (xabel) i'm pretty sure there has to be a less convulted way of doing this, without capturing a event\n      * to throw another event in the model to be captured by some view\n      */\n      rowSaving: function() {\n        this.notice('Saving your edit', 'load', -1);\n      },\n\n      /**\n      * Captures the change event from the row and produces a notification\n      * @method rowSynched\n      * @todo (xabel) i'm pretty sure there has to be a less convulted way of doing this, without capturing a event\n      * to throw another event in the model to be captured by some view\n      */\n      rowSynched: function() {\n        this.notice('Sucessfully saved');\n      },\n\n      /**\n      * Captures the change event from the row and produces a notification\n      * @method rowSynched\n      * @todo (xabel) i'm pretty sure there has to be a less convulted way of doing this, without capturing a event\n      * to throw another event in the model to be captured by some view\n      */\n      rowFailed: function() {\n        this.notice('Oops, there has been an error saving your changes.', 'error');\n      },\n\n      /**\n      * Captures the destroy event from the row and produces a notification\n      * @method rowDestroyed\n      */\n\n      rowDestroying: function() {\n        this.notice('Deleting row', 'load', -1)\n      },\n\n      /**\n      * Captures the sync after a destroy event from the row and produces a notification\n      * @method rowDestroyed\n      */\n\n      rowDestroyed: function() {\n        this.notice('Sucessfully deleted')\n        this._checkEmptyTable();\n      }\n    });\n\n\n\n    /**\n    * table tab controller\n    */\n    cdb.admin.TableTab = cdb.core.View.extend({\n\n      className: 'table',\n\n      initialize: function() {\n        this.user = this.options.user;\n        this.sqlView = this.options.sqlView;\n        this.geocoder = this.options.geocoder;\n        this.backgroundPollingModel = this.options.backgroundPollingModel;\n        this._initBinds();\n      },\n\n      setActiveLayer: function(layerView) {\n        var recreate = !!this.tableView;\n        this.deactivated();\n        this.model = layerView.table;\n        this.layer = layerView.model;\n        this.sqlView = layerView.sqlView;\n        if(recreate) {\n          this.activated();\n        }\n      },\n\n      _initBinds: function() {\n        // Geocoder binding\n        this.geocoder.bind('geocodingComplete geocodingError geocodingCanceled', function() {\n          if (this.model.data) {\n            this.model.data().refresh()\n          }\n        }, this);\n        this.add_related_model(this.geocoder);\n      },\n\n      _createTable: function() {\n        this.tableView = new cdb.admin.TableView({\n          dataModel: this.model.data(),\n          model: this.model,\n          sqlView: this.sqlView,\n          layer: this.layer,\n          geocoder: this.options.geocoder,\n          backgroundPollingModel: this.backgroundPollingModel,\n          vis: this.options.vis,\n          menu: this.options.menu,\n          user: this.user,\n          globalError: this.options.globalError\n        });\n      },\n\n      activated: function() {\n        if(!this.tableView) {\n          this._createTable();\n          this.tableView.render();\n          this.render();\n        }\n      },\n\n      deactivated: function() {\n        if(this.tableView) {\n          this.tableView.clean();\n          this.tableView = null;\n          this.hasRenderedTableView = false;\n        }\n      },\n\n      render: function() {\n        // Since render should be idempotent (i.e. should not append the tableView twice when called multiple times)\n        if(this.tableView && !this.hasRenderedTableView) {\n          this.hasRenderedTableView = true;\n          this.$el.append(this.tableView.el);\n        }\n        return this;\n      }\n\n\n    });\n\n})();\n","\ncdb.admin.Tooltip = cdb.geo.ui.Tooltip.extend({\n\n  _TEMPLATE_URL: 'table/views/tooltip/templates',\n\n  defaults: {\n    vertical_offset: 10,\n    horizontal_offset: 4,\n    position: 'bottom|right'\n  },\n\n  events: {\n    'mouseover': '_lock',\n    'mouseout': '_unlock'\n  },\n\n  initialize: function() {\n    this.table = this.options.table;\n    this.options.empty_fields = true; // render empty fields\n    cdb.geo.ui.Tooltip.prototype.initialize.call(this);\n    this.model.bind('change:template_name', this._setTemplate, this);\n    this.model.bind('change:template', this._compileTemplate, this);\n    this.model.bind('change:fields',this._changeFields, this);\n    this.model.bind('change:alternative_names',this._alternameNames, this);\n    this._setTemplate();\n    this._alternameNames();\n    this._changeFields();\n    if (this.model.get('template')) {\n      this._compileTemplate();\n    }\n    this.targetPos = null;\n    this.locked = false;\n    this.hideTimeout = -1;\n  },\n\n  render: function(data) {\n    if (this.model.fieldCount()) {\n      cdb.geo.ui.Tooltip.prototype.render.call(this, data);\n    } else {\n      this.el.innerHTML = '';\n    }\n\n    return this;\n  },\n\n  _lock: function(e) {\n    this.locked = true;\n    clearTimeout(this.hideTimeout);\n  },\n\n  _unlock: function(e) {\n    this.locked = false;\n  },\n\n  _changeFields: function() {\n    this.setFields(this.model.get('fields'));\n  },\n\n  _alternameNames: function() {\n    this.options.alternative_names = this.model.get('alternative_names');\n  },\n\n  /**\n   *  Compile template of the tooltip\n   */\n  _compileTemplate: function() {\n    var template = this.model.get('template') ?\n      this.model.get('template') :\n      cdb.templates.getTemplate(this._getModelTemplate());\n\n    if(typeof(template) !== 'function') {\n      this.template = new cdb.core.Template({\n        template: template,\n        type: this.model.get('template_type') || 'mustache'\n      }).asFunction()\n    } else {\n      this.template = template\n    }\n\n    this.render();\n  },\n\n  _setTemplate: function() {\n    if (this.model.get('template_name')) {\n      this.template = cdb.templates.getTemplate(this._getModelTemplate());\n      this.render();\n    }\n  },\n\n  _getModelTemplate: function() {\n    return this._TEMPLATE_URL + \"/\" + this.model.get('template_name')\n  },\n\n  _move: function() {\n    if (!this.targetPos) return;\n    var pos = this.$el.position();\n    var dx = this.targetPos.x - pos.left;\n    var dy = this.targetPos.y - pos.top;\n    pos.left += dx*0.05;\n    pos.top += dy*0.05;\n    this.$el.css(pos);\n    if (!this.locked && (Math.abs(dx) > 1 || Math.abs(dy) > 1)) {\n      L.Util.requestAnimFrame(this._move, this);\n    }\n  }\n\n});\n","\n  /**\n   *  Model to poll the number of users who are\n   *  editing the current visualization at the \n   *  same time.\n   *\n   *  - It needs a visualization model.\n   *\n   */\n\n\n  cdb.admin.WatchingNotifierModel = cdb.core.Model.extend({\n\n    _INTERVAL: 30000, // in milliseconds\n    _FIRST_TRY: 3000, // in milliseconds\n\n    defaults: {\n      users: []\n    },\n\n    url: function(method) {\n      var version = cdb.config.urlVersion('watching', method);\n      return '/api/' + version + '/viz/' + this.vis.get('id') + '/watching'\n    },\n\n    initialize: function(attrs, opts) {\n      // If there is no vis defined :() -> HORROR!\n      if (!opts.vis) {\n        cdb.log.info('There is no vis defined')\n      }\n\n      // Interval change?\n      if (opts.interval) {\n        this._INTERVAL = (opts.interval/2) * 1000;\n      }\n\n      this.vis = opts.vis;\n      this.set('id', this.vis.get('id'));\n\n      this._initBinds();\n      this._checkPermissions();\n    },\n\n    _initBinds: function() {\n      _.bindAll(this, '_fetchModel');\n      this.vis.bind('change:id', this._checkPermissions, this);\n    },\n\n    _checkPermissions: function() {\n      var self = this;\n\n      if (this.vis.permission && !this.vis.isVisualization()) {\n        var perm = this.vis.permission;\n\n        if (perm.acl.size() > 0) {\n          setTimeout(function() {\n            self._fetchModel()\n            self.pollCheck();\n          }, self._FIRST_TRY);\n        } else {\n          this.destroyCheck();\n        }\n      } else {\n        this.destroyCheck();\n      }\n    },\n\n    _fetchModel: function() {\n      var self = this;\n      this.save({\n        success: function() {\n          self.trigger('change');\n        },\n        error: function(e) {\n          self.destroyCheck();\n        }\n      });\n    },\n\n    /**\n     * checks for poll to check\n     */\n    pollCheck: function(i) {\n      var self = this;\n      \n      this.pollTimer = setInterval(function() {\n        self._fetchModel();\n      }, i || this._INTERVAL );\n    },\n\n    destroyCheck: function() {\n      clearInterval(this.pollTimer);\n      this.set('users', []);\n    },\n\n    // Parse users result\n    parse: function(r) {\n      return { users: r }\n    }\n\n  });\n","\n  /**\n   *  Displays which users are editing/viewing the\n   *  current visualization.\n   *\n   *  - It needs the watching notifier model and the user model.\n   */\n\n  cdb.admin.WatchingNotifierView = cdb.core.View.extend({\n\n    className:  'watching-notifier',\n    tagName:    'div',\n\n    initialize: function() {\n      this.user = this.options.user;\n      this._initBinds();\n      this.template = cdb.templates.getTemplate('table/views/watching_notifier');\n    },\n\n    render: function() {\n      var users = this._removeCurrentUser( this.model.get('users') ) || [];\n      this.$el.html(this.template({ users: users }));\n      return this;\n    },\n\n    _initBinds: function() {\n      this.model.bind('change', this._onModelChange, this);\n    },\n\n    _onModelChange: function() {\n      var users = this._removeCurrentUser( this.model.get('users') ) || [];\n      \n      if (users.length > 0) {\n        this\n          .render()\n          .show();\n      } else {\n        this.hide();\n      }\n    },\n\n    _removeCurrentUser: function(users) {\n      var self = this;\n      return _.reject(users, function(name) { return name === self.user.get('username') })\n    },\n\n    show: function() {\n      this.$el.addClass('active')\n    },\n\n    hide: function() {\n      this.$el.removeClass('active')\n    }\n\n  });"]}
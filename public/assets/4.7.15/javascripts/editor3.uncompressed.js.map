{
  "version": 3,
  "sources": [
    "node_modules/browser-pack/_prelude.js",
    "lib/assets/javascripts/cartodb3/cartocss-notifications.js",
    "lib/assets/javascripts/cartodb3/components/background-importer/background-import-item-view.js",
    "lib/assets/javascripts/cartodb3/components/background-importer/background-import-limit-view.js",
    "lib/assets/javascripts/cartodb3/components/background-importer/background-import-limit.tpl",
    "lib/assets/javascripts/cartodb3/components/background-importer/background-importer.js",
    "lib/assets/javascripts/cartodb3/components/background-importer/delegated-import-views/failed.js",
    "lib/assets/javascripts/cartodb3/components/background-importer/delegated-import-views/failed.tpl",
    "lib/assets/javascripts/cartodb3/components/background-importer/delegated-import-views/loading.js",
    "lib/assets/javascripts/cartodb3/components/background-importer/delegated-import-views/loading.tpl",
    "lib/assets/javascripts/cartodb3/components/background-importer/delegated-import-views/success.js",
    "lib/assets/javascripts/cartodb3/components/background-importer/delegated-import-views/success.tpl",
    "lib/assets/javascripts/cartodb3/components/background-importer/delegated-import-views/warnings.js",
    "lib/assets/javascripts/cartodb3/components/background-importer/delegated-import-views/warnings.tpl",
    "lib/assets/javascripts/cartodb3/components/background-importer/error-details-view.js",
    "lib/assets/javascripts/cartodb3/components/background-importer/error-details.tpl",
    "lib/assets/javascripts/cartodb3/components/background-importer/twitter-import-details-view.js",
    "lib/assets/javascripts/cartodb3/components/background-importer/twitter-import-details.tpl",
    "lib/assets/javascripts/cartodb3/components/background-importer/upgrade-errors.tpl",
    "lib/assets/javascripts/cartodb3/components/background-importer/warning-partial-import-details.tpl",
    "lib/assets/javascripts/cartodb3/components/background-importer/warning-too-many-files-details.tpl",
    "lib/assets/javascripts/cartodb3/components/background-importer/warning-too-many-rows-connector-details.tpl",
    "lib/assets/javascripts/cartodb3/components/background-importer/warnings-details-view.js",
    "lib/assets/javascripts/cartodb3/components/carousel-form-view.js",
    "lib/assets/javascripts/cartodb3/components/code-mirror/cartocss.code-mirror.js",
    "lib/assets/javascripts/cartodb3/components/code-mirror/code-mirror-bullet.tpl",
    "lib/assets/javascripts/cartodb3/components/code-mirror/code-mirror-error.tpl",
    "lib/assets/javascripts/cartodb3/components/code-mirror/code-mirror-view.js",
    "lib/assets/javascripts/cartodb3/components/code-mirror/code-mirror.tpl",
    "lib/assets/javascripts/cartodb3/components/code-mirror/colorpicker.code-mirror.js",
    "lib/assets/javascripts/cartodb3/components/code-mirror/hint/custom-list-hint.js",
    "lib/assets/javascripts/cartodb3/components/code-mirror/mode/mustache.js",
    "lib/assets/javascripts/cartodb3/components/code-mirror/mode/sql.js",
    "lib/assets/javascripts/cartodb3/components/code-mirror/placeholder.code-mirror.js",
    "lib/assets/javascripts/cartodb3/components/code-mirror/scroll.code-mirror.js",
    "lib/assets/javascripts/cartodb3/components/code-mirror/searchcursor.code-mirror.js",
    "lib/assets/javascripts/cartodb3/components/code-mirror/show-hint.code-mirror.js",
    "lib/assets/javascripts/cartodb3/components/context-menu-factory-view.js",
    "lib/assets/javascripts/cartodb3/components/context-menu-factory.tpl",
    "lib/assets/javascripts/cartodb3/components/context-menu/context-menu-view.js",
    "lib/assets/javascripts/cartodb3/components/custom-carousel/custom-carousel-collection.js",
    "lib/assets/javascripts/cartodb3/components/custom-carousel/custom-carousel-item-model.js",
    "lib/assets/javascripts/cartodb3/components/custom-carousel/custom-carousel-item-view.js",
    "lib/assets/javascripts/cartodb3/components/custom-carousel/custom-carousel-item.tpl",
    "lib/assets/javascripts/cartodb3/components/custom-carousel/custom-carousel-view.js",
    "lib/assets/javascripts/cartodb3/components/custom-carousel/custom-carousel.tpl",
    "lib/assets/javascripts/cartodb3/components/custom-list/custom-list-add.tpl",
    "lib/assets/javascripts/cartodb3/components/custom-list/custom-list-collection.js",
    "lib/assets/javascripts/cartodb3/components/custom-list/custom-list-empty.tpl",
    "lib/assets/javascripts/cartodb3/components/custom-list/custom-list-item-model.js",
    "lib/assets/javascripts/cartodb3/components/custom-list/custom-list-item-view.js",
    "lib/assets/javascripts/cartodb3/components/custom-list/custom-list-item-with-checkbox.tpl",
    "lib/assets/javascripts/cartodb3/components/custom-list/custom-list-item.tpl",
    "lib/assets/javascripts/cartodb3/components/custom-list/custom-list-multi-collection.js",
    "lib/assets/javascripts/cartodb3/components/custom-list/custom-list-multi-item-view.js",
    "lib/assets/javascripts/cartodb3/components/custom-list/custom-list-search-view.js",
    "lib/assets/javascripts/cartodb3/components/custom-list/custom-list-search.tpl",
    "lib/assets/javascripts/cartodb3/components/custom-list/custom-list-view.js",
    "lib/assets/javascripts/cartodb3/components/custom-list/custom-list.tpl",
    "lib/assets/javascripts/cartodb3/components/custom-list/custom-view.js",
    "lib/assets/javascripts/cartodb3/components/dataset/dataset-base-view.js",
    "lib/assets/javascripts/cartodb3/components/date-picker-range/date-picker-range-form.tpl",
    "lib/assets/javascripts/cartodb3/components/date-picker-range/date-picker-range-view.js",
    "lib/assets/javascripts/cartodb3/components/date-picker-range/date-picker-range.tpl",
    "lib/assets/javascripts/cartodb3/components/date-picker/date-picker-view.js",
    "lib/assets/javascripts/cartodb3/components/date-picker/date-picker.tpl",
    "lib/assets/javascripts/cartodb3/components/date-picker/edit-field-model.js",
    "lib/assets/javascripts/cartodb3/components/error/error-view.js",
    "lib/assets/javascripts/cartodb3/components/error/error.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/base.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/code-editor.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/data-observatory/dropdown-dialog-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/data-observatory/dropdown-item.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/data-observatory/dropdown-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/data-observatory/dropdown.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/data-observatory/filter-list-item-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/data-observatory/filter-list-item.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/data-observatory/filter-list-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/data-observatory/filter-list-view.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/data-observatory/measurement-list-item-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/data-observatory/measurement-list-item.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/data-observatory/measurement-list-search.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/data-observatory/measurement-list-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/data-observatory/measurements-base-collection.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/data-observatory/measurements-collection.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/data-observatory/measurements-filters-collection.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/datetime/datetime-dialog-model.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/datetime/datetime-dialog-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/datetime/datetime-editor-model.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/datetime/datetime-editor-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/datetime/datetime.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/datetime/datetime.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/editor-helpers-extend.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/enabler-editor/enabler-editor-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/enabler-editor/enabler-editor.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/enabler/enabler-reversed.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/enabler/enabler-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/enabler/enabler.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/color-picker/color-picker-template.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/color-picker/color-picker.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/color-picker/template.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/column-list-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/column-list-view.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/default-fill-settings.json",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/fill-dialog-model.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/fill-dialog.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/fill-tab-pane.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/fill-template.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/fill.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-collection.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/assets-picker/asset-header-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/assets-picker/asset-header-view.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/assets-picker/asset-item-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/assets-picker/asset-item-view.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/assets-picker/assets-list-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/assets-picker/assets-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/assets-picker/assets-view.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/assets-picker/input-asset-picker-header.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/assets-picker/input-asset-picker-header.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/assets-picker/input-asset-picker-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/assets-picker/input-asset-picker-view.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/assets-picker/organization-assets-list-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/assets-picker/organization-assets-list-view.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/assets-picker/static-asset-item-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/assets-picker/static-asset-item-view.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/assets-picker/tab-pane-template.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/assets-picker/upload-assets-error.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/assets-picker/upload-assets-tab.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/assets-picker/upload-assets-tab.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/assets-picker/user-assets-list-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/assets-picker/user-assets-list-view.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/assets-picker/user-assets-tab.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/assets/maki-icons.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-categories/categories-list/categories-list-item-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-categories/categories-list/categories-list-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-categories/categories-list/categories-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-categories/input-color-categories-list-item.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-categories/input-color-categories-list-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-categories/input-color-categories-list-view.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-categories/input-color-categories.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-categories/input-color-categories.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-color-dialog-content.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-color-file-carousel.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-color-file-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-color-file-view.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-color-fixed-content-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-color-picker/input-color-picker-header.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-color-picker/input-color-picker-header.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-color-picker/input-color-picker-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-color-value-content-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-color.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-color.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-ramps/custom-ramp-template.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-ramps/input-color-ramps.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-ramps/input-ramp-content-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-ramps/input-ramp-content-view.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-ramps/input-ramp-list-item-template.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-ramps/input-ramp-list-item-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-ramps/input-ramp-list-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/input-ramps/ramps.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-color/quantification-method-item.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-number/input-number-content-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-number/input-number-dialog-content.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-number/input-number-fixed-content-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-number/input-number-value-content-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-number/input-number-value-content-view.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-number/input-number.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/fill/input-number/input-number.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/legend/category-item.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/list/list-item.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/list/list.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/node-dataset/node-dataset-item-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/node-dataset/node-dataset-item.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/node-dataset/node-dataset-selected.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/node-dataset/node-dataset-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/number/number.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/number/number.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/operators/operators-list-collection.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/operators/operators-list-count.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/operators/operators-list-model.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/operators/operators-list-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/operators/operators-list.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/operators/operators-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/operators/operators.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/radio/radio.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/radio/radio.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/select/multi-select-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/select/select-layer-item.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/select/select-layer-list-item-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/select/select-layer-list-item.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/select/select-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/select/select.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/select/suggest-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/slider/slider.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/slider/slider.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/sortable-list.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/taglist/taglist-collection.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/taglist/taglist-item-view.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/taglist/taglist.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/taglist/taglist.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/text.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/textarea.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/toggle/toggle.js",
    "lib/assets/javascripts/cartodb3/components/form-components/editors/toggle/toggle.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/field.js",
    "lib/assets/javascripts/cartodb3/components/form-components/field.tpl",
    "lib/assets/javascripts/cartodb3/components/form-components/fieldset-template.js",
    "lib/assets/javascripts/cartodb3/components/form-components/form.js",
    "lib/assets/javascripts/cartodb3/components/form-components/index.js",
    "lib/assets/javascripts/cartodb3/components/form-components/validators/interval.js",
    "lib/assets/javascripts/cartodb3/components/img-loader-view.js",
    "lib/assets/javascripts/cartodb3/components/infobox/infobox-button.tpl",
    "lib/assets/javascripts/cartodb3/components/infobox/infobox-collection.js",
    "lib/assets/javascripts/cartodb3/components/infobox/infobox-factory.js",
    "lib/assets/javascripts/cartodb3/components/infobox/infobox-item-model.js",
    "lib/assets/javascripts/cartodb3/components/infobox/infobox-item-view.js",
    "lib/assets/javascripts/cartodb3/components/infobox/infobox-model.js",
    "lib/assets/javascripts/cartodb3/components/infobox/infobox-quota.tpl",
    "lib/assets/javascripts/cartodb3/components/infobox/infobox-view.js",
    "lib/assets/javascripts/cartodb3/components/infobox/infobox.tpl",
    "lib/assets/javascripts/cartodb3/components/inline-editor/inline-editor-view.js",
    "lib/assets/javascripts/cartodb3/components/likes/likes-model.js",
    "lib/assets/javascripts/cartodb3/components/likes/likes-view.js",
    "lib/assets/javascripts/cartodb3/components/likes/likes.tpl",
    "lib/assets/javascripts/cartodb3/components/loading/loading.tpl",
    "lib/assets/javascripts/cartodb3/components/loading/quote.tpl",
    "lib/assets/javascripts/cartodb3/components/loading/random-quote.js",
    "lib/assets/javascripts/cartodb3/components/loading/render-loading.js",
    "lib/assets/javascripts/cartodb3/components/local-storage/local-storage.js",
    "lib/assets/javascripts/cartodb3/components/metrics/metrics-model.js",
    "lib/assets/javascripts/cartodb3/components/metrics/metrics-tracker.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/add-analyses.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/add-analysis-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/analyses-types.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/analysis-category-pane-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/analysis-category-pane.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/analysis-category.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/analysis-info-pane.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/analysis-info-pane.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/analysis-option-models/analysis-option-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/analysis-option-models/generated-analysis-option-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/analysis-option-models/merge-analysis-option-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/analysis-option-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/analysis-option.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/analysis-options-collection.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/analysis-options.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/analysis-view-pane.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/animation-templates/aoi.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/animation-templates/centroid.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/animation-templates/closest.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/animation-templates/connect-with-lines.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/animation-templates/data-observatory-measure.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/animation-templates/filter-by-column-value.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/animation-templates/filter-by-layer.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/animation-templates/filter-by-polygon.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/animation-templates/georeference.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/animation-templates/group-points.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/animation-templates/intersect.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/animation-templates/join-two-columns.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/animation-templates/kmeans.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/animation-templates/outliers.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/animation-templates/predict-trends.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/animation-templates/sampling.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/tab-pane-button-template.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-analysis/tab-pane-template.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/add-basemap-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/add-basemap-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/add-basemap.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/mapbox/enter-url.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/mapbox/mapbox-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/mapbox/mapbox-to-tile-layer-factory.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/mapbox/mapbox-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/nasa/nasa-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/nasa/nasa-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/nasa/nasa.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/tabs-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/tabs.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/tilejson/enter-url.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/tilejson/tilejson-layer-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/tilejson/tilejson-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/tilejson/tilejson-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/wms/enter-url.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/wms/select-layer-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/wms/select-layer.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/wms/wms-layer-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/wms/wms-layer-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/wms/wms-layer.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/wms/wms-layers-collection.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/wms/wms-layers-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/wms/wms-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/wms/wms-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/xyz/enter-url.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/xyz/xyz-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-basemap/xyz/xyz-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/add-layer-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/add-layer-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/add-layer.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/datasets/content-result-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/datasets/dataset-item-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/datasets/dataset-item.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/datasets/datasets-error.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/datasets/datasets-list-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/datasets/datasets-loader.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/datasets/datasets-no-result.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/datasets/datasets-pagination-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/datasets/datasets-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/datasets/no-datasets.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/datasets/remote-dataset-item-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/datasets/remote-dataset-item.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/fallbacks/import-arcgis-fallback.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/fallbacks/import-box-fallback.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/fallbacks/import-mailchimp-fallback.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/fallbacks/import-salesforce-fallback.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/fallbacks/import-twitter-fallback.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-arcgis/import-arcgis-form.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-arcgis/import-arcgis-header.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-arcgis/import-arcgis-selected-dataset-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-arcgis/import-arcgis-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-data/import-data-form-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-data/import-data-form.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-data/import-data-header-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-data/import-data-header.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-data/import-data-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-data/import-data.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-mailchimp/import-data-header-mailchimp.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-options.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-salesforce/import-data-form-salesforce.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-salesforce/import-data-header-salesforce.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-selected-dataset-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-selected-dataset.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-service/import-service-header-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-service/import-service-header.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-service/import-service-item-description-format.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-service/import-service-item-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-service/import-service-items-collection.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-service/import-service-list-item-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-service/import-service-list-item.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-service/import-service-list-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-service/import-service-list.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-service/import-service-loader-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-service/import-service-loader.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-service/import-service-oauth-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-service/import-service-token-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-service/import-service-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-service/import-service.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-tab.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-twitter/credits-info-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-twitter/credits-info.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-twitter/credits-usage-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-twitter/import-twitter-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-twitter/import-twitter.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-twitter/twitter-categories/twitter-categories-collection.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-twitter/twitter-categories/twitter-categories-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-twitter/twitter-categories/twitter-category-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-twitter/twitter-categories/twitter-category-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-twitter/twitter-categories/twitter-category.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/import-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/imports-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/imports/imports.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/listing-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/navigation-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/content/navigation.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/footer/footer-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/footer/footer.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/footer/guessing-toggler-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/footer/guessing-toggler.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/footer/privacy-toggler-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-layer/footer/privacy-toggler.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/add-widgets-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/add-widgets.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/body-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/category/category-fake.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/category/category-option-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/category/category-option-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/category/category-option.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/category/category-options-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/create-tuples-items.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/formula/formula-fake.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/formula/formula-option-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/formula/formula-option-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/formula/formula-option.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/formula/formula-options-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/histogram/histogram-fake.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/histogram/histogram-option-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/histogram/histogram-option-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/histogram/histogram-option.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/histogram/histogram-options-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/layer-selector-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/select.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/tab-pane-button-template.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/tab-pane-template.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/tablestats.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/time-series/time-series-none-option-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/time-series/time-series-none-option-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/time-series/time-series-none-option.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/time-series/time-series-option-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/time-series/time-series-option-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/time-series/time-series-option.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/time-series/time-series-options-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/widget-option-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/add-widgets/widgets-types.js",
    "lib/assets/javascripts/cartodb3/components/modals/confirmation/modal-confirmation-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/creation/modal-creation-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/editor-visualization-warning/editor-visualization-warning-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/editor-visualization-warning/editor-visualization-warning.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/export-data/modal-export-data-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/export-data/modal-export-data.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/map-metadata/footer/footer-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/map-metadata/footer/footer.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/map-metadata/form/form-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/map-metadata/form/form.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/map-metadata/map-metadata-error.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/map-metadata/map-metadata-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/map-metadata/map-metadata.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/map-metadata/save-metadata-map.js",
    "lib/assets/javascripts/cartodb3/components/modals/modal-view-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/modal-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/modal.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/modals-service-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/publish/create-privacy-options.js",
    "lib/assets/javascripts/cartodb3/components/modals/publish/privacy-collection.js",
    "lib/assets/javascripts/cartodb3/components/modals/publish/privacy-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/publish/privacy-password-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/publish/publish-button-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/publish/publish-button.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/publish/publish-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/publish/publish.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/publish/publish/create-share-options.js",
    "lib/assets/javascripts/cartodb3/components/modals/publish/publish/icon-embed.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/publish/publish/icon-link.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/publish/publish/publish-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/publish/publish/publish.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/publish/publish/share-collection.js",
    "lib/assets/javascripts/cartodb3/components/modals/publish/publish/share-item-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/publish/publish/share-item.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/publish/publish/share-model.js",
    "lib/assets/javascripts/cartodb3/components/modals/publish/share-with-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/publish/share-with.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/publish/share/share-list-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/publish/share/share-permission-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/publish/share/share-permission.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/publish/share/share-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/publish/share/share.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/publish/share/user-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/publish/share/user.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/publish/share/users-group-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/publish/share/users-group.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/publish/tab-pane-submenu.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/publish/upgrade-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/publish/upgrade.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/remove-layer/delete-layer-confirmation-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/sync-options/sync-options-modal-view.js",
    "lib/assets/javascripts/cartodb3/components/modals/sync-options/sync-options-modal.tpl",
    "lib/assets/javascripts/cartodb3/components/modals/visualization-title-suffix-metadata.js",
    "lib/assets/javascripts/cartodb3/components/mosaic-form-view.js",
    "lib/assets/javascripts/cartodb3/components/mosaic/mosaic-collection.js",
    "lib/assets/javascripts/cartodb3/components/mosaic/mosaic-item-model.js",
    "lib/assets/javascripts/cartodb3/components/mosaic/mosaic-item-view.js",
    "lib/assets/javascripts/cartodb3/components/mosaic/mosaic-item.tpl",
    "lib/assets/javascripts/cartodb3/components/mosaic/mosaic-thumbnail.tpl",
    "lib/assets/javascripts/cartodb3/components/mosaic/mosaic-view.js",
    "lib/assets/javascripts/cartodb3/components/mosaic/mosaic.tpl",
    "lib/assets/javascripts/cartodb3/components/no-results/no-results.tpl",
    "lib/assets/javascripts/cartodb3/components/no-results/render-no-results.js",
    "lib/assets/javascripts/cartodb3/components/notifier/notifier-action-view.js",
    "lib/assets/javascripts/cartodb3/components/notifier/notifier-action.tpl",
    "lib/assets/javascripts/cartodb3/components/notifier/notifier-close.tpl",
    "lib/assets/javascripts/cartodb3/components/notifier/notifier-collection.js",
    "lib/assets/javascripts/cartodb3/components/notifier/notifier-item-view.js",
    "lib/assets/javascripts/cartodb3/components/notifier/notifier-item.tpl",
    "lib/assets/javascripts/cartodb3/components/notifier/notifier-model.js",
    "lib/assets/javascripts/cartodb3/components/notifier/notifier-view.js",
    "lib/assets/javascripts/cartodb3/components/notifier/notifier.js",
    "lib/assets/javascripts/cartodb3/components/notifier/notifier.tpl",
    "lib/assets/javascripts/cartodb3/components/onboardings/analysis/analyses/aggregate-intersection.tpl",
    "lib/assets/javascripts/cartodb3/components/onboardings/analysis/analyses/area-of-influence.tpl",
    "lib/assets/javascripts/cartodb3/components/onboardings/analysis/analyses/centroid.tpl",
    "lib/assets/javascripts/cartodb3/components/onboardings/analysis/analyses/closest.tpl",
    "lib/assets/javascripts/cartodb3/components/onboardings/analysis/analyses/connect-with-lines.tpl",
    "lib/assets/javascripts/cartodb3/components/onboardings/analysis/analyses/data-observatory-measure.tpl",
    "lib/assets/javascripts/cartodb3/components/onboardings/analysis/analyses/filter-by-node-column.tpl",
    "lib/assets/javascripts/cartodb3/components/onboardings/analysis/analyses/filter.tpl",
    "lib/assets/javascripts/cartodb3/components/onboardings/analysis/analyses/georeference.tpl",
    "lib/assets/javascripts/cartodb3/components/onboardings/analysis/analyses/group-points.tpl",
    "lib/assets/javascripts/cartodb3/components/onboardings/analysis/analyses/intersection.tpl",
    "lib/assets/javascripts/cartodb3/components/onboardings/analysis/analyses/kmeans.tpl",
    "lib/assets/javascripts/cartodb3/components/onboardings/analysis/analyses/merge.tpl",
    "lib/assets/javascripts/cartodb3/components/onboardings/analysis/analyses/moran.tpl",
    "lib/assets/javascripts/cartodb3/components/onboardings/analysis/analyses/sampling.tpl",
    "lib/assets/javascripts/cartodb3/components/onboardings/analysis/analyses/spatial-markov-trend.tpl",
    "lib/assets/javascripts/cartodb3/components/onboardings/analysis/analysis-launcher.js",
    "lib/assets/javascripts/cartodb3/components/onboardings/analysis/analysis-view.js",
    "lib/assets/javascripts/cartodb3/components/onboardings/analysis/analysis-view.tpl",
    "lib/assets/javascripts/cartodb3/components/onboardings/builder-activated/builder-activated-notification-view.js",
    "lib/assets/javascripts/cartodb3/components/onboardings/builder-activated/builder-activated-notification.tpl",
    "lib/assets/javascripts/cartodb3/components/onboardings/builder/builder-view.js",
    "lib/assets/javascripts/cartodb3/components/onboardings/builder/builder-view.tpl",
    "lib/assets/javascripts/cartodb3/components/onboardings/builder/launcher.js",
    "lib/assets/javascripts/cartodb3/components/onboardings/generic/generic-onboarding-launcher.js",
    "lib/assets/javascripts/cartodb3/components/onboardings/generic/generic-onboarding-view.js",
    "lib/assets/javascripts/cartodb3/components/onboardings/layers/analysis-onboarding/analysis-onboarding-view.js",
    "lib/assets/javascripts/cartodb3/components/onboardings/layers/analysis-onboarding/analysis-onboarding.tpl",
    "lib/assets/javascripts/cartodb3/components/onboardings/layers/data-onboarding/data-onboarding-view.js",
    "lib/assets/javascripts/cartodb3/components/onboardings/layers/data-onboarding/data-onboarding.tpl",
    "lib/assets/javascripts/cartodb3/components/onboardings/layers/layer-onboarding-key.js",
    "lib/assets/javascripts/cartodb3/components/onboardings/layers/style-onboarding/style-onboarding-view.js",
    "lib/assets/javascripts/cartodb3/components/onboardings/layers/style-onboarding/style-onboarding.tpl",
    "lib/assets/javascripts/cartodb3/components/onboardings/layers/style-onboarding/style-points-onboarding.tpl",
    "lib/assets/javascripts/cartodb3/components/onboardings/onboarding-view-model.js",
    "lib/assets/javascripts/cartodb3/components/onboardings/onboarding-view.js",
    "lib/assets/javascripts/cartodb3/components/onboardings/onboarding.tpl",
    "lib/assets/javascripts/cartodb3/components/onboardings/onboardings-service-model.js",
    "lib/assets/javascripts/cartodb3/components/pagination-search/pagination-search-model.js",
    "lib/assets/javascripts/cartodb3/components/pagination-search/pagination-search-view.js",
    "lib/assets/javascripts/cartodb3/components/pagination-search/pagination-search.tpl",
    "lib/assets/javascripts/cartodb3/components/pagination-search/pagination.tpl",
    "lib/assets/javascripts/cartodb3/components/pagination/pagination-model.js",
    "lib/assets/javascripts/cartodb3/components/pagination/pagination-view.js",
    "lib/assets/javascripts/cartodb3/components/pagination/pagination.tpl",
    "lib/assets/javascripts/cartodb3/components/popup-manager.js",
    "lib/assets/javascripts/cartodb3/components/privacy-dropdown/password-dialog-view.js",
    "lib/assets/javascripts/cartodb3/components/privacy-dropdown/password-dialog.tpl",
    "lib/assets/javascripts/cartodb3/components/privacy-dropdown/privacy-cta.tpl",
    "lib/assets/javascripts/cartodb3/components/privacy-dropdown/privacy-dialog-view.js",
    "lib/assets/javascripts/cartodb3/components/privacy-dropdown/privacy-dropdown-view.js",
    "lib/assets/javascripts/cartodb3/components/privacy-dropdown/privacy-dropdown.tpl",
    "lib/assets/javascripts/cartodb3/components/privacy-dropdown/tab-pane.tpl",
    "lib/assets/javascripts/cartodb3/components/scroll/scroll-view.js",
    "lib/assets/javascripts/cartodb3/components/scroll/scroll.tpl",
    "lib/assets/javascripts/cartodb3/components/stack-layout/stack-layout-model.js",
    "lib/assets/javascripts/cartodb3/components/stack-layout/stack-layout-view.js",
    "lib/assets/javascripts/cartodb3/components/tab-pane/create-editor-menu-tab-pane.js",
    "lib/assets/javascripts/cartodb3/components/tab-pane/create-mixed-labels-tab-pane.js",
    "lib/assets/javascripts/cartodb3/components/tab-pane/create-template-tab-pane.js",
    "lib/assets/javascripts/cartodb3/components/tab-pane/create-text-labels-tab-pane.js",
    "lib/assets/javascripts/cartodb3/components/tab-pane/tab-pane-collection.js",
    "lib/assets/javascripts/cartodb3/components/tab-pane/tab-pane-color-view.js",
    "lib/assets/javascripts/cartodb3/components/tab-pane/tab-pane-color.tpl",
    "lib/assets/javascripts/cartodb3/components/tab-pane/tab-pane-file.tpl",
    "lib/assets/javascripts/cartodb3/components/tab-pane/tab-pane-icon-view.js",
    "lib/assets/javascripts/cartodb3/components/tab-pane/tab-pane-icon.tpl",
    "lib/assets/javascripts/cartodb3/components/tab-pane/tab-pane-item-view.js",
    "lib/assets/javascripts/cartodb3/components/tab-pane/tab-pane-label-view.js",
    "lib/assets/javascripts/cartodb3/components/tab-pane/tab-pane-label.tpl",
    "lib/assets/javascripts/cartodb3/components/tab-pane/tab-pane-mixed-view.js",
    "lib/assets/javascripts/cartodb3/components/tab-pane/tab-pane-template-view.js",
    "lib/assets/javascripts/cartodb3/components/tab-pane/tab-pane-view.js",
    "lib/assets/javascripts/cartodb3/components/tab-pane/tab-pane.tpl",
    "lib/assets/javascripts/cartodb3/components/table/body/modals-templates/remove-table-row.tpl",
    "lib/assets/javascripts/cartodb3/components/table/body/table-body-cell.tpl",
    "lib/assets/javascripts/cartodb3/components/table/body/table-body-row-view.js",
    "lib/assets/javascripts/cartodb3/components/table/body/table-body-view.js",
    "lib/assets/javascripts/cartodb3/components/table/body/table-body.tpl",
    "lib/assets/javascripts/cartodb3/components/table/body/table-no-rows.tpl",
    "lib/assets/javascripts/cartodb3/components/table/editors/editor-view-model.js",
    "lib/assets/javascripts/cartodb3/components/table/editors/editor-view.js",
    "lib/assets/javascripts/cartodb3/components/table/editors/editors-service-model.js",
    "lib/assets/javascripts/cartodb3/components/table/editors/types/editor-base-view.js",
    "lib/assets/javascripts/cartodb3/components/table/editors/types/editor-boolean-view.js",
    "lib/assets/javascripts/cartodb3/components/table/editors/types/editor-boolean.tpl",
    "lib/assets/javascripts/cartodb3/components/table/editors/types/editor-date-form-model.js",
    "lib/assets/javascripts/cartodb3/components/table/editors/types/editor-date-view.js",
    "lib/assets/javascripts/cartodb3/components/table/editors/types/editor-model.js",
    "lib/assets/javascripts/cartodb3/components/table/editors/types/editor-string-view.js",
    "lib/assets/javascripts/cartodb3/components/table/head/modals-templates/change-table-column-type.tpl",
    "lib/assets/javascripts/cartodb3/components/table/head/modals-templates/remove-table-column.tpl",
    "lib/assets/javascripts/cartodb3/components/table/head/modals-templates/rename-table-column.tpl",
    "lib/assets/javascripts/cartodb3/components/table/head/table-head-item-view.js",
    "lib/assets/javascripts/cartodb3/components/table/head/table-head-item.tpl",
    "lib/assets/javascripts/cartodb3/components/table/head/table-head-options-item-view.js",
    "lib/assets/javascripts/cartodb3/components/table/head/table-head-options-item.tpl",
    "lib/assets/javascripts/cartodb3/components/table/head/table-head-view.js",
    "lib/assets/javascripts/cartodb3/components/table/head/table-head.tpl",
    "lib/assets/javascripts/cartodb3/components/table/operations/table-add-column.js",
    "lib/assets/javascripts/cartodb3/components/table/operations/table-add-row.js",
    "lib/assets/javascripts/cartodb3/components/table/operations/table-change-column-type.js",
    "lib/assets/javascripts/cartodb3/components/table/operations/table-edit-cell.js",
    "lib/assets/javascripts/cartodb3/components/table/operations/table-remove-column.js",
    "lib/assets/javascripts/cartodb3/components/table/operations/table-remove-row.js",
    "lib/assets/javascripts/cartodb3/components/table/operations/table-rename-column.js",
    "lib/assets/javascripts/cartodb3/components/table/paginator/table-paginator-loader.tpl",
    "lib/assets/javascripts/cartodb3/components/table/paginator/table-paginator-view.js",
    "lib/assets/javascripts/cartodb3/components/table/paginator/table-paginator.tpl",
    "lib/assets/javascripts/cartodb3/components/table/table-manager.js",
    "lib/assets/javascripts/cartodb3/components/table/table-view-model.js",
    "lib/assets/javascripts/cartodb3/components/table/table-view.js",
    "lib/assets/javascripts/cartodb3/components/tipsy-tooltip-view.js",
    "lib/assets/javascripts/cartodb3/components/toggler/toggler-view.js",
    "lib/assets/javascripts/cartodb3/components/toggler/toggler.tpl",
    "lib/assets/javascripts/cartodb3/components/undo-redo/undo-redo-view.js",
    "lib/assets/javascripts/cartodb3/components/undo-redo/undo-redo.tpl",
    "lib/assets/javascripts/cartodb3/components/view-factory.js",
    "lib/assets/javascripts/cartodb3/components/view-options/panel-with-options-view.js",
    "lib/assets/javascripts/cartodb3/components/view-options/panel-with-options.tpl",
    "lib/assets/javascripts/cartodb3/config/upload-config.js",
    "lib/assets/javascripts/cartodb3/data/acl-item-model.js",
    "lib/assets/javascripts/cartodb3/data/analyses.js",
    "lib/assets/javascripts/cartodb3/data/analysis-definition-model.js",
    "lib/assets/javascripts/cartodb3/data/analysis-definition-node-model.js",
    "lib/assets/javascripts/cartodb3/data/analysis-definition-node-source-model.js",
    "lib/assets/javascripts/cartodb3/data/analysis-definition-nodes-collection.js",
    "lib/assets/javascripts/cartodb3/data/analysis-definitions-collection.js",
    "lib/assets/javascripts/cartodb3/data/asset-model.js",
    "lib/assets/javascripts/cartodb3/data/assets-collection.js",
    "lib/assets/javascripts/cartodb3/data/backbone/sync-abort.js",
    "lib/assets/javascripts/cartodb3/data/background-importer/background-importer-imports-collection.js",
    "lib/assets/javascripts/cartodb3/data/background-importer/background-polling-model.js",
    "lib/assets/javascripts/cartodb3/data/background-importer/import-model-poller.js",
    "lib/assets/javascripts/cartodb3/data/background-importer/import-model.js",
    "lib/assets/javascripts/cartodb3/data/background-importer/imports-model.js",
    "lib/assets/javascripts/cartodb3/data/background-importer/poller.js",
    "lib/assets/javascripts/cartodb3/data/basemap-providers-and-categories.js",
    "lib/assets/javascripts/cartodb3/data/camshaft-reference.js",
    "lib/assets/javascripts/cartodb3/data/column-model.js",
    "lib/assets/javascripts/cartodb3/data/column-row-data.js",
    "lib/assets/javascripts/cartodb3/data/config-model.js",
    "lib/assets/javascripts/cartodb3/data/custom-baselayer-model.js",
    "lib/assets/javascripts/cartodb3/data/custom-baselayers-collection.js",
    "lib/assets/javascripts/cartodb3/data/default-cartography.json",
    "lib/assets/javascripts/cartodb3/data/default-form-styles.json",
    "lib/assets/javascripts/cartodb3/data/editor-background-polling-model.js",
    "lib/assets/javascripts/cartodb3/data/editor-model.js",
    "lib/assets/javascripts/cartodb3/data/export-map-definition-model.js",
    "lib/assets/javascripts/cartodb3/data/feature-definition-model.js",
    "lib/assets/javascripts/cartodb3/data/get-simple-geometry-type.js",
    "lib/assets/javascripts/cartodb3/data/grantables-collection.js",
    "lib/assets/javascripts/cartodb3/data/group-model.js",
    "lib/assets/javascripts/cartodb3/data/infowindow-click-model.js",
    "lib/assets/javascripts/cartodb3/data/infowindow-definition-model.js",
    "lib/assets/javascripts/cartodb3/data/infowindow-hover-model.js",
    "lib/assets/javascripts/cartodb3/data/layer-colors.js",
    "lib/assets/javascripts/cartodb3/data/layer-definition-model.js",
    "lib/assets/javascripts/cartodb3/data/layer-definitions-collection.js",
    "lib/assets/javascripts/cartodb3/data/layer-letters.js",
    "lib/assets/javascripts/cartodb3/data/layer-types-and-kinds.js",
    "lib/assets/javascripts/cartodb3/data/legends/legend-base-definition-model.js",
    "lib/assets/javascripts/cartodb3/data/legends/legend-bubble-definition-model.js",
    "lib/assets/javascripts/cartodb3/data/legends/legend-category-definition-model.js",
    "lib/assets/javascripts/cartodb3/data/legends/legend-choropleth-definition-model.js",
    "lib/assets/javascripts/cartodb3/data/legends/legend-custom-choropleth-definition-model.js",
    "lib/assets/javascripts/cartodb3/data/legends/legend-custom-definition-model.js",
    "lib/assets/javascripts/cartodb3/data/legends/legend-definitions-collection.js",
    "lib/assets/javascripts/cartodb3/data/legends/legends-metadata.js",
    "lib/assets/javascripts/cartodb3/data/legends/legends-state.js",
    "lib/assets/javascripts/cartodb3/data/map-definition-model.js",
    "lib/assets/javascripts/cartodb3/data/map-settings.js",
    "lib/assets/javascripts/cartodb3/data/mapcaps-collection.js",
    "lib/assets/javascripts/cartodb3/data/organization-assets-collection.js",
    "lib/assets/javascripts/cartodb3/data/organization-model.js",
    "lib/assets/javascripts/cartodb3/data/overlays-definition-collection.js",
    "lib/assets/javascripts/cartodb3/data/permission-model.js",
    "lib/assets/javascripts/cartodb3/data/query-column-model.js",
    "lib/assets/javascripts/cartodb3/data/query-columns-collection.js",
    "lib/assets/javascripts/cartodb3/data/query-geometry-model.js",
    "lib/assets/javascripts/cartodb3/data/query-row-model.js",
    "lib/assets/javascripts/cartodb3/data/query-rows-collection.js",
    "lib/assets/javascripts/cartodb3/data/query-schema-model.js",
    "lib/assets/javascripts/cartodb3/data/state-definition-model.js",
    "lib/assets/javascripts/cartodb3/data/static-asset-model.js",
    "lib/assets/javascripts/cartodb3/data/static-assets-collection.js",
    "lib/assets/javascripts/cartodb3/data/synchronization-model.js",
    "lib/assets/javascripts/cartodb3/data/table-columns-collection.js",
    "lib/assets/javascripts/cartodb3/data/table-model.js",
    "lib/assets/javascripts/cartodb3/data/tables-collection.js",
    "lib/assets/javascripts/cartodb3/data/undo-manager.js",
    "lib/assets/javascripts/cartodb3/data/upload-model.js",
    "lib/assets/javascripts/cartodb3/data/user-actions.js",
    "lib/assets/javascripts/cartodb3/data/user-groups-collection.js",
    "lib/assets/javascripts/cartodb3/data/user-model.js",
    "lib/assets/javascripts/cartodb3/data/user-notifications.js",
    "lib/assets/javascripts/cartodb3/data/users-group-collection.js",
    "lib/assets/javascripts/cartodb3/data/users-group-fetcher.js",
    "lib/assets/javascripts/cartodb3/data/vis-definition-model.js",
    "lib/assets/javascripts/cartodb3/data/vis-metadata-model.js",
    "lib/assets/javascripts/cartodb3/data/visualization-table-model.js",
    "lib/assets/javascripts/cartodb3/data/visualizations-collection.js",
    "lib/assets/javascripts/cartodb3/data/visualizations-fetch-model.js",
    "lib/assets/javascripts/cartodb3/data/widget-definition-model.js",
    "lib/assets/javascripts/cartodb3/data/widget-definitions-collection.js",
    "lib/assets/javascripts/cartodb3/data/wms-service.js",
    "lib/assets/javascripts/cartodb3/deep-insights-integration/edit-feature-overlay.js",
    "lib/assets/javascripts/cartodb3/deep-insights-integration/edit-geometry.tpl",
    "lib/assets/javascripts/cartodb3/deep-insights-integration/legend-manager.js",
    "lib/assets/javascripts/cartodb3/deep-insights-integration/link-layer-infowindow.js",
    "lib/assets/javascripts/cartodb3/deep-insights-integration/link-layer-tooltip.js",
    "lib/assets/javascripts/cartodb3/deep-insights-integration/start-edition-confirmation.tpl",
    "lib/assets/javascripts/cartodb3/deep-insights-integrations.js",
    "lib/assets/javascripts/cartodb3/editor.js",
    "lib/assets/javascripts/cartodb3/editor/components/modals/export-map/export-map-confirmation.tpl",
    "lib/assets/javascripts/cartodb3/editor/components/modals/export-map/export-map-download.tpl",
    "lib/assets/javascripts/cartodb3/editor/components/modals/export-map/modal-export-map-view.js",
    "lib/assets/javascripts/cartodb3/editor/components/overlay/overlay-view.js",
    "lib/assets/javascripts/cartodb3/editor/components/overlay/overlay.tpl",
    "lib/assets/javascripts/cartodb3/editor/delete-map-confirmation.tpl",
    "lib/assets/javascripts/cartodb3/editor/editor-header.js",
    "lib/assets/javascripts/cartodb3/editor/editor-header.tpl",
    "lib/assets/javascripts/cartodb3/editor/editor-hints/css-hints.js",
    "lib/assets/javascripts/cartodb3/editor/editor-hints/factory-hints.js",
    "lib/assets/javascripts/cartodb3/editor/editor-hints/sql-hints.js",
    "lib/assets/javascripts/cartodb3/editor/editor-map-view.js",
    "lib/assets/javascripts/cartodb3/editor/editor-pane-icon.tpl",
    "lib/assets/javascripts/cartodb3/editor/editor-pane.js",
    "lib/assets/javascripts/cartodb3/editor/editor-pane.tpl",
    "lib/assets/javascripts/cartodb3/editor/editor-settings-pane.js",
    "lib/assets/javascripts/cartodb3/editor/editor-settings-view.js",
    "lib/assets/javascripts/cartodb3/editor/editor-tab-pane.tpl",
    "lib/assets/javascripts/cartodb3/editor/editor-view.js",
    "lib/assets/javascripts/cartodb3/editor/export-image-pane/export-image-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/export-image-pane/export-image-form-view.js",
    "lib/assets/javascripts/cartodb3/editor/export-image-pane/export-image-form.tpl",
    "lib/assets/javascripts/cartodb3/editor/export-image-pane/export-image-pane.js",
    "lib/assets/javascripts/cartodb3/editor/export-image-pane/export-image-pane.tpl",
    "lib/assets/javascripts/cartodb3/editor/export-image-pane/export-image-widget.js",
    "lib/assets/javascripts/cartodb3/editor/export-image-pane/export-image-widget.tpl",
    "lib/assets/javascripts/cartodb3/editor/export-image-pane/footer/footer-view.js",
    "lib/assets/javascripts/cartodb3/editor/export-image-pane/footer/footer.tpl",
    "lib/assets/javascripts/cartodb3/editor/feedback/feedback-button-view.js",
    "lib/assets/javascripts/cartodb3/editor/feedback/feedback-button.tpl",
    "lib/assets/javascripts/cartodb3/editor/feedback/feedback-modal.tpl",
    "lib/assets/javascripts/cartodb3/editor/inline-editor.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/analysis-views/analyses-tooltip-error.js",
    "lib/assets/javascripts/cartodb3/editor/layers/analysis-views/analysis-notifications.js",
    "lib/assets/javascripts/cartodb3/editor/layers/analysis-views/composite-layer-analysis-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/analysis-views/composite-layer-analysis-view.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/analysis-views/default-layer-analysis-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/analysis-views/default-layer-analysis-view.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/analysis-views/ref-layer-analysis-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/analysis-views/ref-layer-analysis-view.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/analysis-views/source-layer-analysis-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/analysis-views/source-layer-analysis-view.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-carousel.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-categories-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-categories.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-form-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-form.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-header-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-header.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-icons/basemap-carto.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-icons/basemap-color.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-icons/basemap-custom.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-icons/basemap-gmaps.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-icons/basemap-here.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-icons/basemap-mapbox.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-icons/basemap-nasa.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-icons/basemap-stamen.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-icons/basemap-tilejson.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-icons/basemap-wms.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-inner-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-inner.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-model-factory.js",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-mosaic-add-item-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-mosaic-form-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-mosaic-item-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-mosaic-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-mosaic-remove-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-mosaic-remove.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-mosaic-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-mosaic.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-select-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemap-select.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content-views/basemaps-collection.js",
    "lib/assets/javascripts/cartodb3/editor/layers/basemap-content.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/change-view-buttons.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/delete-layer-confirmation.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/edit-feature-content-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/edit-feature-content-views/delete-feature-confirmation.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/edit-feature-content-views/edit-feature-action-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/edit-feature-content-views/edit-feature-action.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/edit-feature-content-views/edit-feature-attributes-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/edit-feature-content-views/edit-feature-attributes-form-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/edit-feature-content-views/edit-feature-attributes-form.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/edit-feature-content-views/edit-feature-control-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/edit-feature-content-views/edit-feature-control.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/edit-feature-content-views/edit-feature-geometry-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/edit-feature-content-views/edit-feature-geometry-form-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/edit-feature-content-views/edit-feature-geometry-form.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/edit-feature-content-views/edit-feature-geometry-point-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/edit-feature-content-views/edit-feature-header-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/edit-feature-content-views/edit-feature-header.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/edit-feature-content-views/edit-feature-inner-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/edit-feature-content.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/inline-editor.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-analyses-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-analysis-draggable-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-analysis-draggable.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-analysis-view-factory.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analyses-placeholder.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analyses-quota/analyses-quota-enough.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analyses-quota/analyses-quota-estimation-input.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analyses-quota/analyses-quota-info.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analyses-quota/analyses-quota-options.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analyses-quota/analyses-quota-presenter.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analyses-quota/analyses-quota-provider.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analyses-service.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analyses-sql-error.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analyses-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analyses-workflow-item-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analyses-workflow-item.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analyses-workflow-list-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analyses-workflow-list.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analyses-workflow-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analyses-workflow.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-button-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-controls-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/aggregate-intersection-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/aggregate-intersection-form.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/area-of-influence-buffer.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/area-of-influence-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/area-of-influence-form.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/area-of-influence-trade-area.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/area-of-influence-types.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/available-functions.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/base-analysis-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/centroid-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/centroid-form.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/closest-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/closest-form.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/connect-with-lines-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/connect-with-lines-types.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/connect-with-lines.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/connect-with-lines/line-sequential.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/connect-with-lines/line-source-to-target.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/connect-with-lines/line-to-column.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/connect-with-lines/line-to-single-point.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/data-observatory-measure-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/data-observatory-measure.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/deprecated-sql-function-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/deprecated-sql-function.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/fallback-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/filter-by-node-column.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/filter-by-node-column.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/filter-category.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/filter-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/filter-form.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/filter-intersection-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/filter-intersection-form.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/filter-range.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/filter-types.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/georeference-admin-region-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/georeference-city-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/georeference-country-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/georeference-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/georeference-form.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/georeference-ip-address-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/georeference-long-lat-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/georeference-postal-code-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/georeference-street-address-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/georeference-types.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/group-points-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/group-points-types.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/group-points.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/group-points/bounding-box.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/group-points/bounding-circle.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/group-points/concave-hull.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/group-points/convex-hull.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/kmeans-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/kmeans-form.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/merge-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/merge-form.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/moran-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/moran-form.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/sampling-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/sampling-form.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/spatial-markov-trend-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/spatial-markov-trend.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-models/unknown-type-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-form-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-forms-collection.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-quota-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/analysis-source-options-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/column-data.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/column-options.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/data-observatory-metadata.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/layer-content-analyses-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/analyses/panel-with-options.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/data/code-mirror-error.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/data/create-tuples-items.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/data/data-columns-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/data/data-content-error.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/data/data-content-not-ready.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/data/data-content-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/data/data-sql-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/data/data-sql-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/data/data-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/data/stat-category.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/data/stat-formula.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/data/stat-histogram.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/data/stat-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/data/stat.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/data/widgets-types.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/code-mirror-error.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/georeference-placeholder.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindow-apply-button-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindow-apply-button.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindow-carousel.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindow-click-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindow-content-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindow-description-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindow-description.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindow-field-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindow-field.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindow-fields-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindow-fields.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindow-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindow-form-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindow-form.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindow-hover-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindow-html-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindow-icons/infowindow-color.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindow-icons/infowindow-dark.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindow-icons/infowindow-image.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindow-icons/infowindow-light.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindow-icons/infowindow-none.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindow-items-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindow-items.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindow-select-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindow-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/infowindows-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/popups-placeholder.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/tooltip-icons/tooltip-dark.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/infowindow/tooltip-icons/tooltip-light.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/apply-button-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/carousel-icons/bubble.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/carousel-icons/category.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/carousel-icons/custom.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/carousel-icons/gradient.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/carousel-icons/none.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/color/legend-color-types.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/color/legend-color-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/color/legend-custom-template.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/form/legend-base-definition-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/form/legend-bubble-definition-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/form/legend-category-definition-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/form/legend-choropleth-definition-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/form/legend-color-helper.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/form/legend-color-range.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/form/legend-custom-choropleth-definition-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/form/legend-custom-definition-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/form/legend-list-item.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/form/legend-list.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/form/legend-nested-category-definition-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/georeference-placeholder.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/legend-base-type-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/legend-buffer.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/legend-content-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/legend-content.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/legend-editor-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/legend-factory.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/legend-form-types.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/legend-no-geometry-template.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/legend-properties-form.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/legend-properties-form.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/legend-validations.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/legends-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/size/legend-size-types.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-content-views/legend/size/legend-size-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-header-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-header.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-tab-pane.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-view-factory.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-views/background-image-layer-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-views/base-layer-view-base.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-views/base-tiled-layer-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-views/data-layer-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-views/data-layer.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-views/geometry-lines.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-views/geometry-none.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-views/geometry-points.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-views/geometry-polygons.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-views/google-maps-base-layer-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-views/image-thumbnail-layer.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-views/inline-editor.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-views/labels-layer-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-views/plain-color-layer-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layer-views/plain-color-layer.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/layers-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/layers.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/notification-error-message-handler.js",
    "lib/assets/javascripts/cartodb3/editor/layers/notification-error-messages.json",
    "lib/assets/javascripts/cartodb3/editor/layers/operations/remove-layer.js",
    "lib/assets/javascripts/cartodb3/editor/layers/operations/rename-layer.js",
    "lib/assets/javascripts/cartodb3/editor/layers/panel-loading-template.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/query-sanity-check.js",
    "lib/assets/javascripts/cartodb3/editor/layers/share-button-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/share-button.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/sql-error-action.tpl",
    "lib/assets/javascripts/cartodb3/editor/layers/sync-info/sync-info-view.js",
    "lib/assets/javascripts/cartodb3/editor/layers/sync-info/sync-info.tpl",
    "lib/assets/javascripts/cartodb3/editor/map-operations/remove-map.js",
    "lib/assets/javascripts/cartodb3/editor/map-operations/rename-map.js",
    "lib/assets/javascripts/cartodb3/editor/map-operations/zoom-to-data.js",
    "lib/assets/javascripts/cartodb3/editor/settings/preview/enabler.tpl",
    "lib/assets/javascripts/cartodb3/editor/settings/preview/options-not-ready.tpl",
    "lib/assets/javascripts/cartodb3/editor/settings/preview/preview-options-item-view.js",
    "lib/assets/javascripts/cartodb3/editor/settings/preview/preview-options-view.js",
    "lib/assets/javascripts/cartodb3/editor/settings/preview/preview-options.tpl",
    "lib/assets/javascripts/cartodb3/editor/settings/preview/preview-view.js",
    "lib/assets/javascripts/cartodb3/editor/style/georeference-placeholder.tpl",
    "lib/assets/javascripts/cartodb3/editor/style/style-cartocss-model.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-cartocss-view.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-content-view.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-converter.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-defaults/animation-style-defaults.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-defaults/heatmap-style-defaults.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-defaults/hexabins-aggregation-style-defaults.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-defaults/regions-aggregation-style-defaults.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-defaults/simple-style-defaults.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-defaults/squares-aggregation-style-defaults.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-defaults/style-defaults.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-definition-model.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-form-placeholder.tpl",
    "lib/assets/javascripts/cartodb3/editor/style/style-form-types.tpl",
    "lib/assets/javascripts/cartodb3/editor/style/style-form/none-form-message.tpl",
    "lib/assets/javascripts/cartodb3/editor/style/style-form/style-aggregation-form/style-aggregation-form-view.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-form/style-aggregation-form/style-aggregation-form.tpl",
    "lib/assets/javascripts/cartodb3/editor/style/style-form/style-aggregation-form/style-aggregation-properties-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-form/style-form-components-dictionary.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-form/style-form-default-model.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-form/style-form-view.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-form/style-properties-form/style-animated-properties-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-form/style-properties-form/style-animated-properties-form-view.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-form/style-properties-form/style-labels-properties-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-form/style-properties-form/style-labels-properties-form-view.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-form/style-properties-form/style-properties-form-view.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-form/style-properties-form/style-properties-form.tpl",
    "lib/assets/javascripts/cartodb3/editor/style/style-form/style-properties-form/style-shape-properties-form-model.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-form/style-properties-form/style-shape-properties-form-view.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-form/style-properties-form/style-unanimatable-view.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-form/style-properties-form/style-unanimatable.tpl",
    "lib/assets/javascripts/cartodb3/editor/style/style-icons/animated.tpl",
    "lib/assets/javascripts/cartodb3/editor/style/style-icons/heatmap.tpl",
    "lib/assets/javascripts/cartodb3/editor/style/style-icons/hexabins.tpl",
    "lib/assets/javascripts/cartodb3/editor/style/style-icons/points.tpl",
    "lib/assets/javascripts/cartodb3/editor/style/style-icons/regions.tpl",
    "lib/assets/javascripts/cartodb3/editor/style/style-icons/squares.tpl",
    "lib/assets/javascripts/cartodb3/editor/style/style-manager.js",
    "lib/assets/javascripts/cartodb3/editor/style/style-view.js",
    "lib/assets/javascripts/cartodb3/editor/style/styles-factory.js",
    "lib/assets/javascripts/cartodb3/editor/tab-pane-submenu.tpl",
    "lib/assets/javascripts/cartodb3/editor/widgets/delete-widget-confirmation.tpl",
    "lib/assets/javascripts/cartodb3/editor/widgets/widget-icon-category.tpl",
    "lib/assets/javascripts/cartodb3/editor/widgets/widget-icon-formula.tpl",
    "lib/assets/javascripts/cartodb3/editor/widgets/widget-icon-histogram.tpl",
    "lib/assets/javascripts/cartodb3/editor/widgets/widget-icon-layer-category.tpl",
    "lib/assets/javascripts/cartodb3/editor/widgets/widget-icon-layer-formula.tpl",
    "lib/assets/javascripts/cartodb3/editor/widgets/widget-icon-layer-histogram.tpl",
    "lib/assets/javascripts/cartodb3/editor/widgets/widget-icon-layer-timeSeries.tpl",
    "lib/assets/javascripts/cartodb3/editor/widgets/widget-icon-timeSeries.tpl",
    "lib/assets/javascripts/cartodb3/editor/widgets/widget-view.js",
    "lib/assets/javascripts/cartodb3/editor/widgets/widget-view.tpl",
    "lib/assets/javascripts/cartodb3/editor/widgets/widgets-content-not-ready.tpl",
    "lib/assets/javascripts/cartodb3/editor/widgets/widgets-form/inline-editor.tpl",
    "lib/assets/javascripts/cartodb3/editor/widgets/widgets-form/schema/widgets-form-base-schema-model.js",
    "lib/assets/javascripts/cartodb3/editor/widgets/widgets-form/schema/widgets-form-category-schema-model.js",
    "lib/assets/javascripts/cartodb3/editor/widgets/widgets-form/schema/widgets-form-formula-schema-model.js",
    "lib/assets/javascripts/cartodb3/editor/widgets/widgets-form/schema/widgets-form-histogram-schema-model.js",
    "lib/assets/javascripts/cartodb3/editor/widgets/widgets-form/schema/widgets-form-time-series-schema-model.js",
    "lib/assets/javascripts/cartodb3/editor/widgets/widgets-form/widget-header.js",
    "lib/assets/javascripts/cartodb3/editor/widgets/widgets-form/widget-header.tpl",
    "lib/assets/javascripts/cartodb3/editor/widgets/widgets-form/widgets-form-column-options-factory.js",
    "lib/assets/javascripts/cartodb3/editor/widgets/widgets-form/widgets-form-content-view.js",
    "lib/assets/javascripts/cartodb3/editor/widgets/widgets-form/widgets-form-factory.js",
    "lib/assets/javascripts/cartodb3/editor/widgets/widgets-form/widgets-form-fields-view.js",
    "lib/assets/javascripts/cartodb3/editor/widgets/widgets-form/widgets-form-fields.tpl",
    "lib/assets/javascripts/cartodb3/editor/widgets/widgets-form/widgets-form-types.tpl",
    "lib/assets/javascripts/cartodb3/editor/widgets/widgets-form/widgets-form-view.js",
    "lib/assets/javascripts/cartodb3/editor/widgets/widgets-placeholder.tpl",
    "lib/assets/javascripts/cartodb3/editor/widgets/widgets-service.js",
    "lib/assets/javascripts/cartodb3/editor/widgets/widgets-view.js",
    "lib/assets/javascripts/cartodb3/editor/widgets/widgets-view.tpl",
    "lib/assets/javascripts/cartodb3/helpers/browser-detect.js",
    "lib/assets/javascripts/cartodb3/helpers/color-keywords.js",
    "lib/assets/javascripts/cartodb3/helpers/error-parser.js",
    "lib/assets/javascripts/cartodb3/helpers/errorTracking.js",
    "lib/assets/javascripts/cartodb3/helpers/fetch-all-query-objects.js",
    "lib/assets/javascripts/cartodb3/helpers/magic-positioner.js",
    "lib/assets/javascripts/cartodb3/helpers/navigate-through-router.js",
    "lib/assets/javascripts/cartodb3/helpers/parser-css.js",
    "lib/assets/javascripts/cartodb3/helpers/point-geojson-parser.js",
    "lib/assets/javascripts/cartodb3/helpers/required-opts.js",
    "lib/assets/javascripts/cartodb3/helpers/reset-style-per-node.js",
    "lib/assets/javascripts/cartodb3/helpers/sql-utils.js",
    "lib/assets/javascripts/cartodb3/helpers/styles-without-autostyle.js",
    "lib/assets/javascripts/cartodb3/helpers/table-name-utils.js",
    "lib/assets/javascripts/cartodb3/helpers/utils.js",
    "lib/assets/javascripts/cartodb3/map-mode-model.js",
    "lib/assets/javascripts/cartodb3/mustache-templates/infowindows/infowindow_color.jst.mustache",
    "lib/assets/javascripts/cartodb3/mustache-templates/infowindows/infowindow_dark.jst.mustache",
    "lib/assets/javascripts/cartodb3/mustache-templates/infowindows/infowindow_header_with_image.jst.mustache",
    "lib/assets/javascripts/cartodb3/mustache-templates/infowindows/infowindow_light.jst.mustache",
    "lib/assets/javascripts/cartodb3/mustache-templates/infowindows/infowindow_none.tpl",
    "lib/assets/javascripts/cartodb3/mustache-templates/infowindows_custom/infowindow_color.jst.mustache",
    "lib/assets/javascripts/cartodb3/mustache-templates/infowindows_custom/infowindow_dark.jst.mustache",
    "lib/assets/javascripts/cartodb3/mustache-templates/infowindows_custom/infowindow_header_with_image.jst.mustache",
    "lib/assets/javascripts/cartodb3/mustache-templates/infowindows_custom/infowindow_light.jst.mustache",
    "lib/assets/javascripts/cartodb3/mustache-templates/tooltips/tooltip_dark.jst.mustache",
    "lib/assets/javascripts/cartodb3/mustache-templates/tooltips/tooltip_light.jst.mustache",
    "lib/assets/javascripts/cartodb3/mustache-templates/tooltips_custom/tooltip_dark.jst.mustache",
    "lib/assets/javascripts/cartodb3/mustache-templates/tooltips_custom/tooltip_light.jst.mustache",
    "lib/assets/javascripts/cartodb3/node-geometry-tracker.js",
    "lib/assets/javascripts/cartodb3/sql-notifications.js",
    "lib/assets/javascripts/cartodb3/value-objects/analysis-node-ids.js",
    "lib/assets/javascripts/cartodb3/value-objects/distance-converter.js",
    "lib/assets/javascripts/cartodb3/vis-notifications.js",
    "lib/assets/javascripts/cartodb3/widgets-notifications.js",
    "lib/assets/locale/en.json",
    "lib/assets/locale/es.json",
    "lib/assets/locale/index.js",
    "lib/assets/locale/sw.json",
    "lib/assets/node_modules/backbone/core-view.js",
    "lib/assets/node_modules/jquery-ui.js",
    "node_modules/process/browser.js",
    "node_modules/util/node_modules/inherits/inherits_browser.js",
    "node_modules/util/support/isBufferBrowser.js",
    "node_modules/util/util.js",
    "vendor/assets/javascripts/datepicker.js",
    "vendor/assets/javascripts/dragster.js",
    "vendor/assets/javascripts/dropzone.js",
    "vendor/assets/javascripts/jquery.tipsy.js",
    "vendor/assets/javascripts/markdown.js",
    "vendor/assets/javascripts/tag-it.js"
  ],
  "names": [],
  "mappings": "AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5TA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/TA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5cA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5QA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5bA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/PA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/6BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACnGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5MA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC5KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3MA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1NA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5UA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrDA;AACA;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACreA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1VA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5aA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1KA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxSA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5NA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChyBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5MA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvnCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACjUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChVA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5RA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3RA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrCA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3UA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjLA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxSA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACxFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACzTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/WA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACtRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9ZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpSA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzqBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxiBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChDA;AACA;;ACDA;AACA;;ACDA;AACA;;ACDA;AACA;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;;ACDA;AACA;;ACDA;AACA;;ACDA;AACA;;ACDA;AACA;;ACDA;AACA;;ACDA;AACA;;ACDA;AACA;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtzEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxugBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC1kBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACl4BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/rDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClSA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7rDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA",
  "file": "generated.js",
  "sourceRoot": "",
  "sourcesContent": [
    "(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})",
    "var _ = require('underscore');\nvar Notifier = require('./components/notifier/notifier');\n\nvar NOTIFICATION_ERROR_TEMPLATE = _.template(\"<span class='u-errorTextColor'><%- title %></span>\");\nvar NOTIFICATION_PREFIX = 'cartocss-notification-';\n\nvar CartoCSSNotifications = {\n  track: function (view) {\n    // In order to not bloat the notification center we will create\n    // only one notification, and update it along the way\n    this._notificationId = NOTIFICATION_PREFIX + view.cid;\n  },\n\n  showSuccessNotification: function () {\n    var notificationAttrs = {\n      status: 'success',\n      info: _t('notifications.cartocss.success'),\n      closable: true,\n      delay: Notifier.DEFAULT_DELAY\n    };\n\n    this._addOrUpdateNotification(this._notificationId, notificationAttrs);\n  },\n\n  showErrorNotification: function (errors) {\n    var notificationAttrs = {\n      status: 'error',\n      info: _t('notifications.cartocss.error.body', {\n        body: NOTIFICATION_ERROR_TEMPLATE({\n          title: _t('notifications.cartocss.error.title')\n        }),\n        error: this._transformErrors(errors)\n      }),\n      closable: true,\n      delay: Notifier.DEFAULT_DELAY\n    };\n\n    this._addOrUpdateNotification(this._notificationId, notificationAttrs);\n  },\n\n  _transformErrors: function (errors) {\n    return _.map(errors, function (err) {\n      return err.message;\n    }, this).join('. ');\n  },\n\n  _addOrUpdateNotification: function (notificationId, notificationAttrs) {\n    var notification = this._getNotification(notificationId);\n    if (notification) {\n      notification.set(notificationAttrs);\n    } else {\n      this._addNotification(notificationId, notificationAttrs);\n    }\n  },\n\n  _addNotification: function (notificationId, notificationAttrs) {\n    notificationAttrs = _.extend({\n      id: notificationId\n    }, notificationAttrs);\n    Notifier.addNotification(notificationAttrs);\n  },\n\n  _getNotification: function (notificationId) {\n    return Notifier.getNotification(notificationId);\n  }\n};\n\nmodule.exports = CartoCSSNotifications;\n",
    "var CoreView = require('backbone/core-view');\nvar Notifier = require('../../components/notifier/notifier');\nvar UploadConfig = require('../../config/upload-config');\nvar ErrorDetailsView = require('./error-details-view');\nvar WarningsDetailsView = require('./warnings-details-view');\nvar TwitterImportDetailsDialog = require('./twitter-import-details-view');\n\n/**\n *  Import item within background importer\n *\n */\n\nvar DELEGATIONS = {\n  loading: require('./delegated-import-views/loading'),\n  error: require('./delegated-import-views/failed'),\n  warning: require('./delegated-import-views/warnings'),\n  success: require('./delegated-import-views/success')\n};\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.modals) throw new Error('modals is required');\n    if (!opts.importModel) throw new Error('importModel is required');\n\n    this._userModel = opts.userModel;\n    this._configModel = opts.configModel;\n    this._modals = opts.modals;\n    this._importModel = opts.importModel;\n    this._showSuccessDetailsButton = opts.showSuccessDetailsButton;\n\n    this._notification = Notifier.addNotification({});\n\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this._importModel.on('change', this.updateNotification, this);\n    this._importModel.on('remove', this.clean, this);\n    this._notification.on('notification:close', this._closeHandler, this);\n    this._notification.on('notification:action', this._actionHandler, this);\n    this.add_related_model(this._importModel);\n    this.add_related_model(this._notification);\n  },\n\n  _closeHandler: function () {\n    this.trigger('remove', this._importModel, this);\n    this._importModel.pause();\n    this.clean();\n  },\n\n  _actionHandler: function (action) {\n    if (action === 'show_errors') {\n      this._showImportError();\n    } else if (action === 'show_stats') {\n      this._showImportStats();\n    } else if (action === 'show_table') {\n      this._showImportDataset();\n    } else if (action === 'show_warnings') {\n      this._showImportWarnings();\n    }\n  },\n\n  _getStatus: function () {\n    var status = 'loading';\n    var failed = this._importModel.hasFailed();\n    var completed = this._importModel.hasCompleted();\n    var warnings = this._importModel.getWarnings();\n\n    if (failed) {\n      status = 'error';\n    } else if (completed && !warnings) {\n      status = 'success';\n    } else if (completed && warnings) {\n      status = 'warning';\n    }\n\n    return status;\n  },\n\n  _getInfo: function () {\n    var upload = this._importModel.get('upload');\n    var imp = this._importModel.get('import');\n\n    var d = {\n      name: '',\n      state: this._importModel.get('state'),\n      progress: '',\n      service: '',\n      step: this._importModel.get('step'),\n      failed: this._importModel.hasFailed(),\n      completed: this._importModel.hasCompleted(),\n      warnings: this._importModel.getWarnings(),\n      showSuccessDetailsButton: this._showSuccessDetailsButton,\n      tables_created_count: imp.tables_created_count\n    };\n\n    // Name\n    if (upload.type) {\n      if (upload.type === 'file') {\n        if (upload.value.length > 1) {\n          d.name = upload.value.length + ' files';\n        } else {\n          d.name = upload.value.name;\n        }\n      }\n      if (upload.type === 'url' || upload.type === 'remote') {\n        d.name = upload.value;\n      }\n      if (upload.type === 'service') {\n        d.name = upload.value && upload.value.filename || '';\n      }\n      if (upload.service_name === 'twitter_search') {\n        d.name = 'Twitter import';\n      }\n      if (upload.type === 'sql') {\n        d.name = 'SQL';\n      }\n      if (upload.type === 'duplication') {\n        d.name = upload.table_name || upload.value;\n      }\n    } else {\n      d.name = imp.display_name || imp.item_queue_id || 'import';\n    }\n\n    // Service\n    d.service = upload.service_name;\n\n    // Progress\n    if (this._importModel.get('step') === 'upload') {\n      d.progress = this._importModel.get('upload').progress;\n    } else {\n      d.progress = Math.max(0, (UploadConfig.uploadStates.indexOf(d.state) / UploadConfig.uploadStates.length) * 100);\n    }\n\n    d.progress = d.progress.toFixed(0);\n\n    return d;\n  },\n\n  updateNotification: function () {\n    var status = this._getStatus();\n    var delegated = DELEGATIONS[status];\n    delegated.call(this, this._importModel, this._notification, status, this._getInfo(), this._showSuccessDetailsButton);\n  },\n\n  _showImportDataset: function () {\n    var dataset = this._importModel.get('import').table_name;\n    window.location = this._configModel.get('base_url') + '/dataset/' + dataset;\n  },\n\n  _showImportStats: function () {\n    var self = this;\n    this._modals.create(function (modalModel) {\n      return new TwitterImportDetailsDialog({\n        modalModel: modalModel,\n        userModel: self._userModel,\n        model: self._importModel\n      });\n    });\n  },\n\n  _showImportError: function () {\n    var self = this;\n    this._modals.create(function (modalModel) {\n      return new ErrorDetailsView({\n        configModel: self._configModel,\n        modalModel: modalModel,\n        error: self._importModel.getError(),\n        userModel: self._userModel\n      });\n    });\n  },\n\n  _showImportWarnings: function () {\n    var self = this;\n    this._modals.create(function (modalModel) {\n      return new WarningsDetailsView({\n        modalModel: modalModel,\n        warnings: self._importModel.getWarnings(),\n        userModel: self._userModel\n      });\n    });\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./background-import-limit.tpl');\nvar Notifier = require('../../components/notifier/notifier');\n\n/**\n *  Import limit message within background importer\n *\n */\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._userModel = opts.userModel;\n    this._configModel = opts.configModel;\n\n    this._notification = Notifier.addNotification({\n      status: 'error',\n      closable: true,\n      button: false,\n      info: this._getInfo()\n    });\n\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this._notification.on('notification:close', this._closeHandler, this);\n    this.add_related_model(this._notification);\n  },\n\n  _closeHandler: function () {\n    this.clean();\n  },\n\n  _getInfo: function () {\n    var importQuota = this._userModel.getMaxConcurrentImports();\n    var isUpgradeable = !this._configModel.get('cartodb_com_hosted') && importQuota === 1;\n\n    return template({\n      upgradeUrl: window.upgrade_url,\n      isUpgradeable: isUpgradeable,\n      importQuota: importQuota\n    });\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='';\n if (isUpgradeable) { \n__p+='\\n'+\n((__t=( _t('components.background-importer.background-import-limit.hurry', { upgradeUrl: upgradeUrl }) ))==null?'':_.escape(__t))+\n'\\n';\n } else { \n__p+='\\n'+\n((__t=( _t('components.background-importer.background-import-limit.one-file', { importQuota: importQuota }) ))==null?'':_.escape(__t))+\n'\\n';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar ImportItemView = require('./background-import-item-view');\nvar ImportLimitItemView = require('./background-import-limit-view');\nvar ImportsModel = require('../../data/background-importer/imports-model');\n\n/**\n *  Background polling manager\n *\n *  It will pool all polling operations (imports) that happens\n *  in the Builder\n *\n */\n\nvar BackgroundImporter = function (options) {\n  this.options = options || {};\n  this._importers = {};\n  this.initialize(this.options);\n};\n\nBackgroundImporter.prototype = {\n  initialize: function (opts) {\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.modals) throw new Error('modals is required');\n    if (!opts.pollingModel) throw new Error('pollingModel is required');\n\n    this._userModel = opts.userModel;\n    this._configModel = opts.configModel;\n    this._createVis = opts.createVis;\n    this._modals = opts.modals;\n    this._model = opts.pollingModel;\n\n    this._initBinds();\n  },\n\n  addView: function (view) {\n    this._importers[view.cid] = view;\n  },\n\n  removeView: function (view) {\n    delete this._importers[view.cid];\n  },\n\n  enable: function () {\n    this._model.startPollings();\n  },\n\n  disable: function () {\n    this._model.stopPollings();\n  },\n\n  removeImport: function (model) {\n    this._model.removeImportItem(model);\n  },\n\n  destroy: function () {\n    this._model.off(null, null, this);\n  },\n\n  _initBinds: function () {\n    this._model.on('importAdded', this._addImport, this);\n    this._model.on('importByUploadData', this._addDataset, this);\n  },\n\n  _addImport: function (m) {\n    var importItemView = new ImportItemView({\n      configModel: this._configModel,\n      showSuccessDetailsButton: this._model.get('showSuccessDetailsButton'),\n      modals: this._modals,\n      importModel: m,\n      userModel: this._userModel\n    });\n\n    importItemView.on('remove', this._removeImport, this);\n    this.addView(importItemView);\n    this.enable();\n  },\n\n  _addDataset: function (d) {\n    if (d) {\n      this._addImportsItem(d);\n    }\n  },\n\n  _onDroppedFile: function (files) {\n    if (files) {\n      this._addImportsItem({\n        type: 'file',\n        value: files,\n        create_vis: this._createVis\n      });\n    }\n  },\n\n  _addImportsItem: function (uploadData) {\n    if (this._model.canAddImport()) {\n      this._removeLimitItem();\n    } else {\n      this._addLimitItem();\n      return false;\n    }\n\n    var imp = new ImportsModel({}, {\n      upload: uploadData,\n      userModel: this._userModel,\n      configModel: this._configModel\n    });\n\n    this._model.addImportItem(imp);\n  },\n\n  _addLimitItem: function () {\n    if (!this._importLimit) {\n      var view = new ImportLimitItemView({\n        configModel: this._configModel,\n        userModel: this._userModel\n      });\n\n      this.addView(view);\n      this._importLimit = view;\n    }\n  },\n\n  _removeLimitItem: function () {\n    var view = this._importLimit;\n    if (view) {\n      view.clean();\n      this.removeView(view);\n      delete this._importLimit;\n    }\n  },\n\n  _removeImport: function (model, view) {\n    this._model.removeImportItem(model);\n    this.removeView(view);\n  }\n};\n\n// Supporting default Backbone events like on, off, trigger, listenTo etc\n_.extend(BackgroundImporter.prototype, Backbone.Events, {\n  remove: function () {\n    this.stopListening();\n  }\n});\n\nvar manager = (function () {\n  var initialized = false;\n  var importer;\n\n  return {\n    init: function (opts) {\n      if (!initialized) {\n        importer = new BackgroundImporter(opts);\n      }\n      return importer;\n    }\n  };\n})();\n\nmodule.exports = manager;\n",
    "var template = require('./failed.tpl');\n\nfunction getAction () {\n  return 'show_errors';\n}\n\nfunction getButton () {\n  return _t('components.background-importer.background-importer-item.show');\n}\n\nfunction getClosable () {\n  return true;\n}\n\nfunction updateNotification (info) {\n  var data = {\n    info: info,\n    status: _status,\n    closable: getClosable(),\n    button: getButton(),\n    action: getAction()\n  };\n\n  _notification.update(data);\n}\n\nvar _notification;\nvar _status;\n\nmodule.exports = function (model, notification, status, info, showDetails) {\n  _notification = notification;\n  _status = status;\n  updateNotification(template(info));\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+=''+\n((__t=( _t('components.background-importer.background-importer-item.error-connecting', { name: name }) ))==null?'':__t)+\n' ';\n if (service) { \n__p+=' '+\n((__t=( _t('components.background-importer.background-importer-item.from') ))==null?'':_.escape(__t))+\n' '+\n((__t=( service ))==null?'':_.escape(__t))+\n' ';\n } \n__p+='';\n}\nreturn __p;\n};\n",
    "var template = require('./loading.tpl');\n\nfunction getAction () {\n  return false;\n}\n\nfunction getButton () {\n  return false;\n}\n\nfunction getClosable () {\n  var state = _model.get('state');\n  var step = _model.get('step');\n  return state === 'uploading' && step === 'upload';\n}\n\nfunction updateNotification (info) {\n  var data = {\n    info: info,\n    status: _status,\n    closable: getClosable(),\n    button: getButton(),\n    action: getAction()\n  };\n\n  _notification.update(data);\n}\n\nvar _model;\nvar _notification;\nvar _status;\n\nmodule.exports = function (model, notification, status, info, showDetails) {\n  _model = model;\n  _notification = notification;\n  _status = status;\n  updateNotification(template(info));\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<span class=\\'CDB-Text is-semibold\\'>'+\n((__t=( progress ))==null?'':_.escape(__t))+\n'% '+\n((__t=( state ))==null?'':_.escape(__t))+\n'</span> '+\n((__t=( name ))==null?'':_.escape(__t))+\n' ';\n if (service && service != \"twitter_search\") { \n__p+=' '+\n((__t=( _t('components.background-importer.background-importer-item.from') ))==null?'':_.escape(__t))+\n' '+\n((__t=( service ))==null?'':_.escape(__t))+\n' ';\n } \n__p+='';\n}\nreturn __p;\n};\n",
    "var template = require('./success.tpl');\n\nfunction getAction () {\n  var service = _model.get('upload').service_name;\n  var tables_created_count = _model.get('import').tables_created_count;\n\n  if (_showDetails) {\n    if (service && service === 'twitter_search') {\n      return 'show_stats';\n    } else if (tables_created_count === 1) {\n      return 'show_table';\n    }\n  }\n\n  return false;\n}\n\nfunction getButton () {\n  var service = _model.get('upload').service_name;\n  var tables_created_count = _model.get('import').tables_created_count;\n\n  if (_showDetails) {\n    if (service && service === 'twitter_search') {\n      return _t('components.background-importer.background-importer-item.show');\n    } else if (tables_created_count === 1) {\n      return _t('components.background-importer.background-importer-item.show');\n    }\n  }\n\n  return false;\n}\n\nfunction getClosable () {\n  return true;\n}\n\nfunction updateNotification (info) {\n  var data = {\n    info: info,\n    status: _status,\n    closable: getClosable(),\n    button: getButton(),\n    action: getAction()\n  };\n\n  _notification.update(data);\n}\n\nvar _model;\nvar _notification;\nvar _status;\nvar _showDetails;\n\nmodule.exports = function (model, notification, status, info, showDetails) {\n  _model = model;\n  _notification = notification;\n  _status = status;\n  _showDetails = showDetails;\n  updateNotification(template(info));\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+=''+\n((__t=( name ))==null?'':_.escape(__t))+\n' ';\n if (service && service != \"twitter_search\") { \n__p+=' '+\n((__t=( _t('components.background-importer.background-importer-item.from') ))==null?'':_.escape(__t))+\n' '+\n((__t=( service ))==null?'':_.escape(__t))+\n' ';\n } \n__p+=' <span class=\\'CDB-Text is-semibold\\'>'+\n((__t=( _t('components.background-importer.background-importer-item.completed') ))==null?'':_.escape(__t))+\n'</span>';\n}\nreturn __p;\n};\n",
    "var template = require('./warnings.tpl');\n\nfunction getAction () {\n  return 'show_warnings';\n}\n\nfunction getButton () {\n  return _t('components.background-importer.background-importer-item.show');\n}\n\nfunction getClosable () {\n  return true;\n}\n\nfunction updateNotification (info) {\n  var data = {\n    info: info,\n    status: _status,\n    closable: getClosable(),\n    button: getButton(),\n    action: getAction()\n  };\n\n  _notification.update(data);\n}\n\nvar _notification;\nvar _status;\n\nmodule.exports = function (model, notification, status, info, showDetails) {\n  _notification = notification;\n  _status = status;\n  updateNotification(template(info));\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<span class=\\'CDB-Text is-semibold\\'>Some warnings</span> were produced for '+\n((__t=( name ))==null?'':_.escape(__t))+\n' ';\n if (service) { \n__p+=' '+\n((__t=( _t('components.background-importer.background-importer-item.from') ))==null?'':_.escape(__t))+\n' '+\n((__t=( service ))==null?'':_.escape(__t))+\n' ';\n } \n__p+='';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar defaultTemplate = require('./error-details.tpl');\nvar upgradeErrorTemplate = require('./upgrade-errors.tpl');\nvar UPGRADE_ERROR_CODES = [8001, 8005];\n\n/**\n * Error details view, to be used together with an error object from an import model.\n *\n */\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.error) throw new Error('error is required');\n\n    this._userModel = opts.userModel;\n    this._configModel = opts.configModel;\n    this._error = opts.error;\n  },\n\n  render: function () {\n    var isUpgradeError = _.contains(UPGRADE_ERROR_CODES, this._error.errorCode);\n    var upgradeUrl = this._configModel.get('upgrade_url');\n    var userCanUpgrade = upgradeUrl && !this._configModel.get('cartodb_com_hosted') && (!this._userModel.isInsideOrg() || this._userModel.isOrgOwner());\n    var template = this._getTemplate(isUpgradeError);\n\n    var html = template({\n      errorCode: this._error.errorCode,\n      title: this._error.title,\n      text: this._error.what_about,\n      itemQueueId: this._error.item_queue_id,\n      originalUrl: this._error.originalUrl,\n      httpResponseCode: this._error.httpResponseCode,\n      httpResponseCodeMessage: this._error.httpRresponseCodeMessage,\n      userCanUpgrade: userCanUpgrade,\n      showTrial: this._userModel.canStartTrial(),\n      upgradeUrl: upgradeUrl\n    });\n\n    this.$el.html(html);\n\n    return this;\n  },\n\n  _getTemplate: function (isUpgradeError) {\n    var template = defaultTemplate;\n\n    if (isUpgradeError) {\n      template = upgradeErrorTemplate;\n    }\n    return template;\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Dialog-header\">\\n  <div class=\"Dialog-headerIcon Dialog-headerIcon--negative u-flex u-alignCenter u-justifyCenter\">\\n    <i class=\"CDB-IconFont CDB-IconFont-cloud\"></i>\\n  </div>\\n  <h2 class=\"CDB-Text CDB-Size-large u-bSpace u-errorTextColor\">\\n    '+\n((__t=( title ))==null?'':_.escape(__t))+\n' ';\n if (errorCode) { \n__p+='('+\n((__t=( errorCode ))==null?'':_.escape(__t))+\n')';\n } \n__p+='\\n  </h2>\\n  <h3 class=\"CDB-Text CDB-Size-medium u-secondaryTextColor\">\\n    ';\n if (itemQueueId) { \n__p+='\\n    '+\n((__t=( _t('components.background-importer.error-details.dont-panic') ))==null?'':_.escape(__t))+\n'\\n    ';\n } else { \n__p+='\\n    '+\n((__t=( _t('components.background-importer.error-details.check-errors') ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n  </h3>\\n</div>\\n\\n<div class=\"Dialog-body ErrorDetails-body\">\\n  <ul class=\"Modal-containerList\">\\n    ';\n if (httpResponseCode) { \n__p+='\\n      <li class=\"ErrorDetails-item\">\\n        <div class=\"ErrorDetails-itemStep CDB-Text CDB-Size-medium is-semibold u-flex u-alignCenter u-justifyCenter\">1</div>\\n        <div class=\"ErrorDetails-itemText\">\\n          <p class=\"CDB-Text CDB-Size-medium\">\\n            '+\n((__t=( _t('components.background-importer.error-details.remote-server-code', { httpResponseCode: httpResponseCode}) ))==null?'':__t)+\n' '+\n((__t=( httpResponseCodeMessage ))==null?'':_.escape(__t))+\n'\\n          </p>\\n        </div>\\n      </li>\\n      <li class=\"ErrorDetails-item\">\\n        <div class=\"ErrorDetails-itemStep CDB-Text CDB-Size-medium is-semibold u-flex u-alignCenter u-justifyCenter\">2</div>\\n        <div class=\"ErrorDetails-itemText\">\\n          <p class=\"CDB-Text CDB-Size-medium\">\\n            '+\n((__t=( _t('components.background-importer.error-details.check-url') ))==null?'':_.escape(__t))+\n':<br/>\\n          </p>\\n          <span class=\\'CDB-Text CDB-Size-medium ErrorDetails-itemTextStrong\\'><a href=\"'+\n((__t=( originalUrl ))==null?'':_.escape(__t))+\n'\">'+\n((__t=( originalUrl ))==null?'':_.escape(__t))+\n'</a></span>\\n        </div>\\n      </li>\\n    ';\n } else { \n__p+='\\n      <li class=\"ErrorDetails-item\">\\n        <div class=\"ErrorDetails-itemStep CDB-Text CDB-Size-medium is-semibold u-flex u-alignCenter u-justifyCenter\">1</div>\\n        <div class=\"ErrorDetails-itemText\">\\n          <p class=\"CDB-Text CDB-Size-medium\">\\n            ';\n if (text) { \n__p+='\\n            '+\n((__t=( cdb.core.sanitize.html(text) ))==null?'':__t)+\n'\\n            ';\n } else { \n__p+='\\n            '+\n((__t=( _t('components.background-importer.error-details.unknown-error') ))==null?'':_.escape(__t))+\n'\\n            ';\n } \n__p+='\\n          </p>\\n        </div>\\n      </li>\\n    ';\n } \n__p+='\\n    ';\n if (itemQueueId) { \n__p+='\\n      <li class=\"ErrorDetails-item\">\\n        <div class=\"ErrorDetails-itemStep CDB-Text CDB-Size-medium is-semibold u-flex u-alignCenter u-justifyCenter\">!</div>\\n        <div class=\"ErrorDetails-itemText\">\\n          <p class=\"CDB-Text CDB-Size-medium\">\\n            '+\n((__t=( _t('components.background-importer.error-details.send-us-the-error-code') ))==null?'':__t)+\n':<br/>\\n          </p>\\n          <span class=\"CDB-Text CDB-Size-medium ErrorDetails-itemTextStrong\">'+\n((__t=( itemQueueId ))==null?'':_.escape(__t))+\n'</span>\\n        </div>\\n      </li>\\n    ';\n } \n__p+='\\n  </ul>\\n</div>\\n\\n\\n<div class=\"Dialog-footer--simple u-inner\">\\n  <button class=\"CDB-Button CDB-Button--error u-tSpace--m js-close\">\\n    <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">\\n      '+\n((__t=( _t('components.background-importer.error-details.close') ))==null?'':_.escape(__t))+\n'\\n    </span>\\n  </button>\\n</div>';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar Utils = require('../../helpers/utils');\nvar template = require('./twitter-import-details.tpl');\n\n/**\n *  When a Twitter import finishes, this dialog displays\n *  all the info about the price/cost etc.\n *\n */\nmodule.exports = CoreView.extend({\n\n  className: 'TwitterImportDetails',\n\n  events: {\n    'click .js-close': '_onCloseClick'\n  },\n\n  initialize: function (opts) {\n    if (!opts.modalModel) throw new Error('modalModel is required');\n    if (!opts.userModel) throw new Error('userModel is required');\n    this._userModel = opts.userModel;\n    this._modalModel = opts.modalModel;\n  },\n\n  render: function () {\n    var imp = this.model.get('import');\n    var userTwitterValues = this._userModel.get('twitter');\n    var availableTweets = userTwitterValues.quota - userTwitterValues.monthly_use;\n\n    this.$el.html(\n      template({\n        datasetTotalRows: imp.tweets_georeferenced,\n        datasetTotalRowsFormatted: Utils.formatNumber(imp.tweets_georeferenced),\n        tweetsCost: imp.tweets_cost,\n        tweetsCostFormatted: Utils.formatNumber(imp.tweets_cost),\n        availableTweets: availableTweets,\n        availableTweetsFormatted: Utils.formatNumber(availableTweets),\n        tweetsOverquota: imp.tweets_overquota,\n        tweetsOverquotaFormatted: Utils.formatNumber(imp.tweets_overquota),\n        blockSizeFormatted: Utils.formatNumber(userTwitterValues.block_size),\n        blockPriceFormatted: Utils.formatNumber(userTwitterValues.block_price)\n      })\n    );\n\n    return this;\n  },\n\n  _onCloseClick: function () {\n    this._modalModel.destroy();\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Dialog-header\">\\n  <div class=\"Dialog-headerIcon Dialog-headerIcon--twitter u-flex u-alignCenter u-justifyCenter\">\\n    <i class=\"CDB-IconFont CDB-IconFont-twitter\"></i>\\n  </div>\\n  <h2 class=\"CDB-Text CDB-Size-large u-bSpace Dialog-headerIcon--twitter\">\\n    '+\n((__t=( _t('components.background-importer.twitter-import-details.twitter-import-title') ))==null?'':_.escape(__t))+\n'\\n  </h2>\\n  <h3 class=\"CDB-Text CDB-Size-medium u-altTextColor\">\\n    ';\n if (datasetTotalRows === 0) { \n__p+='\\n      '+\n((__t=( _t('components.background-importer.twitter-import-details.errors.no-results') ))==null?'':_.escape(__t))+\n'\\n    ';\n } else { \n__p+='\\n      '+\n((__t=( _t('components.background-importer.twitter-import-details.new-type-created', { datasetTotalRowsFormatted: datasetTotalRowsFormatted, tweetPlural: datasetTotalRows != 1 ? 's' : '' }) ))==null?'':__t)+\n'\\n    ';\n } \n__p+='\\n  </h3>\\n</div>\\n\\n<div class=\"Dialog-body ErrorDetails-body\">\\n  <ul class=\"Modal-containerList\">\\n    <li class=\"ErrorDetails-item\">\\n      <div class=\"ErrorDetails-itemIcon ErrorDetails-itemIcon--success CDB-Size-big u-flex u-alignCenter u-justifyCenter u-rSpace--xl\">\\n        <i class=\"CDB-IconFont CDB-IconFont-dollar\"></i>\\n      </div>\\n      <div class=\"ErrorDetails-itemText\">\\n        <p class=\"CDB-Text CDB-Size-large u-secondaryTextColor\">\\n          ';\n if (tweetsCost > 0) { \n__p+='\\n            '+\n((__t=( _t('components.background-importer.twitter-import-details.tweet-cost.paid', { tweetsCostFormatted: tweetsCostFormatted }) ))==null?'':_.escape(__t))+\n'\\n          ';\n } else { \n__p+='\\n            '+\n((__t=( _t('components.background-importer.twitter-import-details.tweet-cost.free', { tweetsCostFormatted: tweetsCostFormatted }) ))==null?'':_.escape(__t))+\n'\\n          ';\n } \n__p+='\\n        </p>\\n        <p class=\"CDB-Text CDB-Size-medium u-altTextColor\">\\n          ';\n if (tweetsCost > 0 ||availableTweets <= 0) { \n__p+='\\n            '+\n((__t=( _t('components.background-importer.twitter-import-details.no-more-credits', { blockPriceFormatted: blockPriceFormatted, blockSizeFormatted: blockSizeFormatted }) ))==null?'':_.escape(__t))+\n'\\n          ';\n } else { \n__p+='\\n            ';\n if (availableTweets != 1) { \n__p+='\\n              '+\n((__t=( _t('components.background-importer.twitter-import-details.credits-left', { availableTweetsFormatted: availableTweetsFormatted }) ))==null?'':_.escape(__t))+\n'\\n            ';\n } else { \n__p+='\\n              '+\n((__t=( _t('components.background-importer.twitter-import-details.credit-left', { availableTweetsFormatted: availableTweetsFormatted }) ))==null?'':_.escape(__t))+\n'\\n            ';\n } \n__p+='\\n          ';\n } \n__p+='\\n        </p>\\n      </div>\\n    </li>\\n  </ul>\\n</div>\\n\\n<div class=\"Dialog-footer--simple u-inner\">\\n  <button class=\"CDB-Button CDB-Button--primary u-tSpace--m\">\\n    <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase js-close\">\\n      '+\n((__t=( _t('components.background-importer.error-details.close') ))==null?'':_.escape(__t))+\n'\\n    </span>\\n  </button>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Dialog-header\">\\n  <div class=\"Dialog-headerIcon Dialog-headerIcon--negative u-flex u-alignCenter u-justifyCenter\">\\n    <i class=\"CDB-IconFont CDB-IconFont-barometer\"></i>\\n  </div>\\n  <h2 class=\"CDB-Text CDB-Size-large u-bSpace u-errorTextColor\">\\n    '+\n((__t=( _t('components.background-importer.upgrade-errors.' + errorCode + '.title') ))==null?'':_.escape(__t))+\n'\\n  </h2>\\n  <h3 class=\"CDB-Text CDB-Size-medium u-secondaryTextColor\">\\n    '+\n((__t=( _t('components.background-importer.upgrade-errors.' + errorCode + '.description') ))==null?'':_.escape(__t))+\n'\\n  </h3>\\n</div>\\n\\n<div class=\"Dialog-body ErrorDetails-body\">\\n  <ul class=\"Modal-containerList\">\\n    <li class=\"ErrorDetails-item\">\\n      <div class=\"ErrorDetails-itemIcon ErrorDetails-itemIcon--success CDB-Size-big u-flex u-alignCenter u-justifyCenter u-rSpace--xl\">\\n        <i class=\"CDB-IconFont CDB-IconFont-rocket\"></i>\\n      </div>\\n      <div class=\"ErrorDetails-itemText\">\\n        <p class=\"CDB-Text CDB-Size-medium\">\\n          '+\n((__t=( _t('components.background-importer.upgrade-errors.' + errorCode + '.info') ))==null?'':_.escape(__t))+\n'\\n          ';\n if (showTrial) { \n__p+='\\n            <br/>\\n            <a href=\"'+\n((__t=( upgradeUrl ))==null?'':__t)+\n'\">'+\n((__t=( _t('components.background-importer.free-trial', { days: 14 }) ))==null?'':_.escape(__t))+\n'</a>\\n          ';\n } \n__p+='\\n        </p>\\n      </div>\\n    </li>\\n  </ul>\\n</div>\\n\\n<div class=\"Dialog-footer--simple u-inner\">\\n  <a href=\"'+\n((__t=( upgradeUrl ))==null?'':_.escape(__t))+\n'\" class=\"CDB-Button CDB-Button--primary u-tSpace--m\">\\n    <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">\\n      '+\n((__t=( _t('components.background-importer.upgrade-errors.upgrade') ))==null?'':_.escape(__t))+\n'\\n    </span>\\n  </a>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Dialog-header ErrorDetails-header\">\\n  <div class=\"Dialog-headerIcon Dialog-headerIcon--alert\">\\n    <i class=\"CDB-IconFont CDB-IconFont-cloud\"></i>\\n  </div>\\n  <p class=\"Dialog-headerTitle--warning\">\\n    '+\n((__t=( _t('components.background-importer.partial-import-details.unable-to-import-as-layers') ))==null?'':_.escape(__t))+\n'\\n  </p>\\n  <p class=\"Dialog-headerText\">\\n    '+\n((__t=( _t('components.background-importer.partial-import-details.find-connected-datasets') ))==null?'':_.escape(__t))+\n'</br>\\n    '+\n((__t=( _t('components.background-importer.partial-import-details.upgrade-your-account', { userMaxLayers: userMaxLayers }) ))==null?'':_.escape(__t))+\n'</br>\\n  </p>\\n</div>\\n';\n if (maxTablesPerImport) { \n__p+='\\n  <div class=\"Dialog-body ErrorDetails-body\">\\n    <ul class=\"ErrorDetails-list\">\\n      <li class=\"ErrorDetails-item\">\\n        <div class=\"ErrorDetails-itemStep\">!</div>\\n        <div class=\"ErrorDetails-itemText\">\\n          '+\n((__t=( _t('components.background-importer.partial-import-details.too-many-datasets', { maxTablesPerImport: maxTablesPerImport }) ))==null?'':_.escape(__t))+\n'</br>\\n        </div>\\n      </li>\\n    </ul>\\n  </div>\\n';\n } \n__p+='\\n<div class=\"Dialog-footer ErrorDetails-footer\">\\n  <button class=\"Button Button--secondary ErrorDetails-footerButton js-close\">\\n    <span>'+\n((__t=( _t('components.background-importer.partial-import-details.continue-btn') ))==null?'':_.escape(__t))+\n'</span>\\n  </button>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Dialog-header ErrorDetails-header\">\\n  <div class=\"Dialog-headerIcon Dialog-headerIcon--alert\">\\n    <i class=\"CDB-IconFont CDB-IconFont-cloud\"></i>\\n  </div>\\n  <p class=\"Dialog-headerTitle--warning\">\\n    '+\n((__t=( _t('components.background-importer.warnings-details.unable-to-import-datasets') ))==null?'':_.escape(__t))+\n'\\n  </p>\\n  <p class=\"Dialog-headerText\">\\n    '+\n((__t=( _t('components.background-importer.warnings-details.no-more-datasets', { maxTablesPerImport: maxTablesPerImport}) ))==null?'':_.escape(__t))+\n'<br />\\n    '+\n((__t=( _t('components.background-importer.warnings-details.find-connected-datasets') ))==null?'':_.escape(__t))+\n'\\n  </p>\\n</div>\\n<div class=\"Dialog-footer ErrorDetails-footer\">\\n  <button class=\"Button Button--secondary ErrorDetails-footerButton u-upperCase js-close\">\\n    <span>'+\n((__t=( _t('components.background-importer.warnings-details.continue-btn') ))==null?'':_.escape(__t))+\n'</span>\\n  </button>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Dialog-header ErrorDetails-header\">\\n  <div class=\"Dialog-headerIcon Dialog-headerIcon--alert\">\\n    <i class=\"CDB-IconFont CDB-IconFont-cloud\"></i>\\n  </div>\\n  <p class=\"Dialog-headerTitle--warning\">\\n    '+\n((__t=( _t('components.background-importer.connector-warning-details.too-many-rows') ))==null?'':_.escape(__t))+\n'\\n  </p>\\n  <p class=\"Dialog-headerText\">\\n    '+\n((__t=( _t('components.background-importer.connector-warning-details.unable-to-import-all-rows', { maxRowsPerConnectorImport: maxRowsPerConnectorImport}) ))==null?'':_.escape(__t))+\n'<br />\\n  </p>\\n</div>\\n<div class=\"Dialog-footer ErrorDetails-footer\">\\n  <button class=\"Button Button--secondary ErrorDetails-footerButton u-upperCase js-close\">\\n    <span>'+\n((__t=( _t('components.background-importer.connector-warning-details.continue-btn') ))==null?'':_.escape(__t))+\n'</span>\\n  </button>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar partialImportDetailsTemplate = require('./warning-partial-import-details.tpl');\nvar tooManyFilesDetailsTemplate = require('./warning-too-many-files-details.tpl');\nvar tooManyRowsConnectorTemplate = require('./warning-too-many-rows-connector-details.tpl');\n\n/**\n * Error details view, to be used together with an error object from an import model.\n *\n */\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.warnings) throw new Error('warnings is required');\n\n    this._userModel = this.options.userModel;\n    this._warnings = this.options.warnings;\n  },\n\n  render: function () {\n    var warnings = this._warnings;\n    var template = this._getTemplate(warnings);\n\n    this.$el.html(\n      template({\n        userMaxLayers: warnings.user_max_layers,\n        maxTablesPerImport: warnings.max_tables_per_import,\n        maxRowsPerConnectorImport: warnings.max_rows_per_connection\n      })\n    );\n\n    return this;\n  },\n\n  _getTemplate: function (warnings) {\n    if (warnings.user_max_layers && warnings.max_tables_per_import) {\n      return (warnings.user_max_layers < warnings.max_tables_per_import) ? partialImportDetailsTemplate : tooManyFilesDetailsTemplate;\n    } else if (warnings.user_max_layers) {\n      return partialImportDetailsTemplate;\n    } else if (warnings.max_tables_per_import) {\n      return tooManyFilesDetailsTemplate;\n    } else if (warnings.max_rows_per_connection) {\n      return tooManyRowsConnectorTemplate;\n    }\n  }\n});\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar CarouselView = require('./custom-carousel/custom-carousel-view');\n\n/**\n *  Carousel form view\n */\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    if (!opts.collection) throw new Error('Carousel collection is required');\n    if (!opts.template) throw new Error('template is required');\n    this.template = opts.template;\n    this._initBinds();\n  },\n\n  render: function () {\n    var selectedItem = this.collection.getSelected();\n    var selectedName = selectedItem && selectedItem.getName();\n    this.$el.html(\n      this.template({\n        name: selectedName\n      })\n    );\n    this._initViews();\n    return this;\n  },\n\n  _initBinds: function () {\n    this.collection.bind('change:highlighted', this._onChangeHighlighted, this);\n  },\n\n  _initViews: function () {\n    var carousel = new CarouselView(_.extend(this.options, {\n      collection: this.collection\n    }));\n\n    if (!this.$('.js-selector').length) throw new Error('HTML element with js-selector class is required');\n\n    this.$('.js-selector').append(carousel.render().el);\n    carousel.initScroll();\n    this.addView(carousel);\n  },\n\n  _onChangeHighlighted: function () {\n    var item = this.collection.getHighlighted() || this.collection.getSelected();\n    if (item) {\n      var $el = this.$('.js-highlight');\n      if ($el) {\n        $el.text(item.getName());\n      }\n    }\n  }\n\n});\n",
    "var COLOR_KEYWORDS = require('../../helpers/color-keywords');\n\n/*\n  LESS mode - http://www.lesscss.org/\n  Ported to CodeMirror by Peter Kroon <plakroon@gmail.com>\n  Report bugs/issues here: https://github.com/marijnh/CodeMirror/issues  GitHub: @peterkroon\n*/\n\nmodule.exports = function (CodeMirror) {\n  CodeMirror.defineMode('cartocss', function (config) {\n    var indentUnit = config.indentUnit;\n    var type;\n\n    function ret (style, tp) {\n      type = tp;\n      return style;\n    }\n    // html tags\n    var tags = 'a abbr acronym address applet area article aside audio b base basefont bdi bdo big blockquote body br button canvas caption cite code col colgroup command datalist dd del details dfn dir div dl dt em embed fieldset figcaption figure font footer form frame frameset h1 h2 h3 h4 h5 h6 head header hgroup hr html i iframe img input ins keygen kbd label legend li link map mark menu meta meter nav noframes noscript object ol optgroup option output p param pre progress q rp rt ruby s samp script section select small source span strike strong style sub summary sup table tbody td textarea tfoot th thead time title tr track tt u ul var video wbr'.split(' ');\n    var colorKeywords = keySet(COLOR_KEYWORDS);\n\n    function inTagsArray (val) {\n      for (var i = 0; i < tags.length; i++) {\n        if (val === tags[i]) return true;\n      }\n    }\n\n    var selectors = /(^\\:root$|^\\:nth\\-child$|^\\:nth\\-last\\-child$|^\\:nth\\-of\\-type$|^\\:nth\\-last\\-of\\-type$|^\\:first\\-child$|^\\:last\\-child$|^\\:first\\-of\\-type$|^\\:last\\-of\\-type$|^\\:only\\-child$|^\\:only\\-of\\-type$|^\\:empty$|^\\:link|^\\:visited$|^\\:active$|^\\:hover$|^\\:focus$|^\\:target$|^\\:lang$|^\\:enabled^\\:disabled$|^\\:checked$|^\\:first\\-line$|^\\:first\\-letter$|^\\:before$|^\\:after$|^\\:not$|^\\:required$|^\\:invalid$)/;\n\n    function tokenBase (stream, state) {\n      var ch = stream.next();\n\n      if (ch === '@') {\n        stream.eatWhile(/[\\w\\-]/);\n        return ret('meta', stream.current());\n      } else if (ch === '/' && stream.eat('*')) {\n        state.tokenize = tokenCComment;\n        return tokenCComment(stream, state);\n      } else if (ch === '<' && stream.eat('!')) {\n        state.tokenize = tokenSGMLComment;\n        return tokenSGMLComment(stream, state);\n      } else if (ch === '=') ret(null, 'compare');\n      else if (ch === '|' && stream.eat('=')) return ret(null, 'compare');\n      else if (ch === '\\'' || ch === '\\'') {\n        state.tokenize = tokenString(ch);\n        return state.tokenize(stream, state);\n      } else if (ch === '/') { // e.g.: .png will not be parsed as a class\n        if (stream.eat('/')) {\n          state.tokenize = tokenSComment;\n          return tokenSComment(stream, state);\n        } else {\n          if (type === 'string' || type === '(') {\n            return ret('string', 'string');\n          }\n          if (state.stack[state.stack.length - 1] !== undefined) {\n            return ret(null, ch);\n          }\n          stream.eatWhile(/[\\a-zA-Z0-9\\-_.\\s]/);\n          if (/\\/|\\)|#/.test(stream.peek() || (stream.eatSpace() && stream.peek() === ')')) || stream.eol()) {\n            return ret('string', 'string'); // let url(/images/logo.png) without quotes return as string\n          }\n        }\n      } else if (ch === '!') {\n        stream.match(/^\\s*\\w*/);\n        return ret('keyword', 'important');\n      } else if (/\\d/.test(ch)) {\n        stream.eatWhile(/[\\w.%]/);\n        return ret('number', 'unit');\n      } else if (/[,+<>*\\/]/.test(ch)) {\n        if (stream.peek() === '=' || type === 'a') {\n          return ret('string', 'string');\n        }\n        return ret(null, 'select-op');\n      } else if (/[;{}:\\[\\]()~\\|]/.test(ch)) {\n        if (ch === ':') {\n          stream.eatWhile(/[a-z\\\\\\-]/);\n\n          if (selectors.test(stream.current())) {\n            return ret('tag', 'tag');\n          } else if (stream.peek() === ':') { // ::-webkit-search-decoration\n            stream.next();\n            stream.eatWhile(/[a-z\\\\\\-]/);\n            if (stream.current().match(/\\:\\:\\-(o|ms|moz|webkit)\\-/)) {\n              return ret('string', 'string');\n            }\n            if (selectors.test(stream.current().substring(1))) {\n              return ret('tag', 'tag');\n            }\n            return ret(null, ch);\n          } else {\n            return ret(null, ch);\n          }\n        } else if (ch === '~') {\n          if (type === 'r') {\n            return ret('string', 'string');\n          }\n        } else {\n          return ret(null, ch);\n        }\n      } else if (ch === '.') {\n        if (type === '(' || type === 'string') {\n          return ret('string', 'string'); // allow url(../image.png)\n        }\n        stream.eatWhile(/[\\a-zA-Z0-9\\-_]/);\n        if (stream.peek() === ' ') {\n          stream.eatSpace();\n        }\n        if (stream.peek() === ')') {\n          return ret('number', 'unit'); // rgba(0,0,0,.25);\n        }\n        return ret('tag', 'tag');\n      } else if (ch === '#') {\n        // we don't eat white-space, we want the hex color and or id only\n        stream.eatWhile(/[A-Za-z0-9]/);\n        // check if there is a proper hex color length e.g. #eee || #eeeEEE\n        if (stream.current().length === 4 || stream.current().length === 7) {\n          if (stream.current().match(/[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3}/, false) != null) { // is there a valid hex color value present in the current stream\n            // when not a valid hex value, parse as id\n            if (stream.current().substring(1) !== stream.current().match(/[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3}/, false)[0]) {\n              return ret('atom', 'tag');\n            }\n            // eat white-space\n            stream.eatSpace();\n            // when hex value declaration doesn't end with [;,] but is does with a slash/cc comment treat it as an id, just like the other hex values that don't end with[;,]\n            if (/[\\/<>.({!$%^&*_\\-\\\\?=+\\|#'~`]/.test(stream.peek())) {\n              return ret('atom', 'tag');\n            } else if (stream.peek() === '}') {\n              // #time { color: #aaa }\n              return ret('color', 'unit');\n            } else if (/[a-zA-Z\\\\]/.test(stream.peek())) {\n              // we have a valid hex color value, parse as id whenever an element/class is defined after the hex(id) value e.g. #eee aaa || #eee .aaa\n              return ret('color', 'unit');\n            } else if (stream.eol()) {\n              // when a hex value is on the end of a line, parse as id\n              return ret('color', 'unit');\n            } else {\n              // default\n              return ret('color', 'unit');\n            }\n          } else { // when not a valid hexvalue in the current stream e.g. #footer\n            stream.eatWhile(/[\\w\\\\\\-]/);\n            return ret('atom', 'tag');\n          }\n        } else { // when not a valid hexvalue length\n          stream.eatWhile(/[\\w\\\\\\-]/);\n          return ret('atom', 'tag');\n        }\n      } else if (ch === '&') {\n        stream.eatWhile(/[\\w\\-]/);\n        return ret(null, ch);\n      } else {\n        stream.eatWhile(/[\\w\\\\\\-_%.{]/);\n        if (type === 'string') {\n          return ret('string', 'string');\n        } else if (stream.current().match(/(^http$|^https$)/) != null) {\n          stream.eatWhile(/[\\w\\\\\\-_%.{:\\/]/);\n          return ret('string', 'string');\n        } else if (stream.peek() === '<' || stream.peek() === '>') {\n          return ret('tag', 'tag');\n        } else if (/\\(/.test(stream.peek())) {\n          return ret(null, ch);\n        } else if (stream.peek() === '/' && state.stack[state.stack.length - 1] !== undefined) { // url(dir/center/image.png)\n          return ret('string', 'string');\n        } else if (stream.current().match(/\\-\\d|\\-.\\d/)) { // match e.g.: -5px -0.4 etc... only colorize the minus sign\n          // commment out these 2 comment if you want the minus sign to be parsed as null -500px\n          // stream.backUp(stream.current().length-1);\n          // return ret(null, ch); //console.log( stream.current() );\n          return ret('number', 'unit');\n        } else if (inTagsArray(stream.current().toLowerCase())) { // match html tags\n          return ret('tag', 'tag');\n        } else if (/\\/|[\\s\\)]/.test(stream.peek() || stream.eol() || (stream.eatSpace() && stream.peek() === '/')) && stream.current().indexOf('.') !== -1) {\n          if (stream.current().substring(stream.current().length - 1, stream.current().length) === '{') {\n            stream.backUp(1);\n            return ret('tag', 'tag');\n          } // end if\n          stream.eatSpace();\n          if (/[{<>.a-zA-Z\\/]/.test(stream.peek()) || stream.eol()) return ret('tag', 'tag'); // e.g. button.icon-plus\n          return ret('string', 'string'); // let url(/images/logo.png) without quotes return as string\n        } else if (stream.eol() || stream.peek() === '[' || stream.peek() === '#' || type === 'tag') {\n          if (stream.current().substring(stream.current().length - 1, stream.current().length) === '{') stream.backUp(1);\n          return ret('tag', 'tag');\n        } else if (type === 'compare' || type === 'a' || type === '(') {\n          return ret('string', 'string');\n        } else if (type === '|' || stream.current() === '-' || type === '[') {\n          return ret(null, ch);\n        } else if (stream.peek() === ':') {\n          stream.next();\n          var t_v = stream.peek() === ':';\n          if (!t_v) {\n            var old_pos = stream.pos;\n            var sc = stream.current().length;\n            stream.eatWhile(/[a-z\\\\\\-]/);\n            var new_pos = stream.pos;\n            if (stream.current().substring(sc - 1).match(selectors) != null) {\n              stream.backUp(new_pos - (old_pos - 1));\n              return ret('tag', 'tag');\n            } else stream.backUp(new_pos - (old_pos - 1));\n          } else {\n            stream.backUp(1);\n          }\n          if (t_v) return ret('tag', 'tag');\n          else return ret('variable', 'variable');\n\n          // It is a color variable?\n        } else if (colorKeywords.hasOwnProperty(stream.current())) {\n          return ret('color', 'unit');\n        } else {\n          return ret('variable', 'variable');\n        }\n      }\n    }\n\n    function keySet (array) {\n      var keys = {};\n      for (var i = 0; i < array.length; ++i) {\n        keys[array[i]] = true;\n      }\n      return keys;\n    }\n\n    function tokenSComment (stream, state) { // SComment = Slash comment\n      stream.skipToEnd();\n      state.tokenize = tokenBase;\n      return ret('comment', 'comment');\n    }\n\n    function tokenCComment (stream, state) {\n      var maybeEnd = false;\n      var ch;\n      while ((ch = stream.next()) != null) {\n        if (maybeEnd && ch === '/') {\n          state.tokenize = tokenBase;\n          break;\n        }\n        maybeEnd = (ch === '*');\n      }\n      return ret('comment', 'comment');\n    }\n\n    function tokenSGMLComment (stream, state) {\n      var dashes = 0;\n      var ch;\n      while ((ch = stream.next()) != null) {\n        if (dashes >= 2 && ch === '>') {\n          state.tokenize = tokenBase;\n          break;\n        }\n        dashes = (ch === '-') ? dashes + 1 : 0;\n      }\n      return ret('comment', 'comment');\n    }\n\n    function tokenString (quote) {\n      return function (stream, state) {\n        var escaped = false;\n        var ch;\n        while ((ch = stream.next()) != null) {\n          if (ch === quote && !escaped) {\n            break;\n          }\n          escaped = !escaped && ch === '\\\\';\n        }\n        if (!escaped) state.tokenize = tokenBase;\n        return ret('string', 'string');\n      };\n    }\n\n    return {\n      startState: function (base) {\n        return {\n          tokenize: tokenBase,\n          baseIndent: base || 0,\n          stack: []\n        };\n      },\n\n      token: function (stream, state) {\n        if (stream.eatSpace()) return null;\n        var style = state.tokenize(stream, state);\n\n        var context = state.stack[state.stack.length - 1];\n        if (type === 'hash' && context === 'rule') style = 'atom';\n        else if (style === 'variable') {\n          if (context === 'rule') style = null; // 'tag'\n          else if (!context || context === '@media{') {\n            style = stream.current() === 'when' ? 'variable'\n            : /[\\s,|\\s\\)|\\s]/.test(stream.peek()) ? 'tag' : type;\n          }\n        }\n\n        if (context === 'rule' && /^[\\{\\};]$/.test(type)) {\n          state.stack.pop();\n        }\n        if (type === '{') {\n          if (context === '@media') state.stack[state.stack.length - 1] = '@media{';\n          else state.stack.push('{');\n        } else if (type === '}') state.stack.pop();\n        else if (type === '@media') state.stack.push('@media');\n        else if (context === '{' && type !== 'comment') state.stack.push('rule');\n        return style;\n      },\n\n      indent: function (state, textAfter) {\n        var n = state.stack.length;\n        if (/^\\}/.test(textAfter)) {\n          n -= state.stack[state.stack.length - 1] === 'rule' ? 2 : 1;\n        }\n        return state.baseIndent + n * indentUnit;\n      },\n\n      electricChars: '}'\n    };\n  });\n\n  CodeMirror.defineMIME('text/x-carto', 'cartocss');\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<i class=\"CodeMirror-bullet\"></i>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<ul class=\"CodeMirror-error\">\\n  <li class=\"CodeMirror-errorMessage u-lSpace--xl u-rSpace--xl\">\\n    '+\n((__t=( _t('components.codemirror.syntax-error') ))==null?'':_.escape(__t))+\n'. '+\n((__t=( _t('components.codemirror.line') ))==null?'':_.escape(__t))+\n' '+\n((__t=( line ))==null?'':_.escape(__t))+\n': <span>'+\n((__t=( message ))==null?'':_.escape(__t))+\n'</span>\\n  </li>\\n</ul>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar CodeMirror = require('codemirror');\nvar ColorPicker = require('./colorpicker.code-mirror');\nvar template = require('./code-mirror.tpl');\nvar bulletTemplate = require('./code-mirror-bullet.tpl');\nvar errorTemplate = require('./code-mirror-error.tpl');\n\nrequire('./mode/sql')(CodeMirror);\nrequire('./mode/mustache')(CodeMirror);\nrequire('./cartocss.code-mirror')(CodeMirror);\nrequire('./scroll.code-mirror')(CodeMirror);\nrequire('./show-hint.code-mirror')(CodeMirror);\nrequire('./hint/custom-list-hint')(CodeMirror);\nrequire('./searchcursor.code-mirror')(CodeMirror);\nrequire('./placeholder.code-mirror')(CodeMirror);\n\nvar ESCAPE_KEY_CODE = 27;\nvar RETURN_KEY_CODE = 13;\n\nvar NOHINT = [ESCAPE_KEY_CODE, RETURN_KEY_CODE];\n\nvar ADDONS = {\n  'color-picker': ColorPicker\n};\n\nmodule.exports = CoreView.extend({\n  className: 'Editor-content',\n\n  options: {\n    readonly: false,\n    lineNumbers: true,\n    autocompleteChars: 3\n  },\n\n  initialize: function (opts) {\n    if (!opts) throw new Error('options for codemirror are required.');\n    if (!opts.model) throw new Error('Model for codemirror is required.');\n    if (opts.model.get('content') === void 0 &&\n        opts.placeholder === void 0) throw new Error('Content property or placeholder for codemirror is required.');\n    if (opts.tip === void 0) throw new Error('tip message is required');\n\n    this._autocompleteChars = opts.autocompleteChars || this.options.autocompleteChars;\n    this._mode = opts.mode || 'cartocss';\n    this._addons = opts.addons;\n    this._hints = opts.hints;\n    this._autocompletePrefix = opts.autocompletePrefix;\n    this._autocompleteTriggers = opts.autocompleteTriggers;\n    this._autocompleteSuffix = opts.autocompleteSuffix;\n    this._errorTemplate = opts.errorTemplate || errorTemplate;\n    this._tip = opts.tip;\n    this._lineWithErrors = [];\n    this._onInputRead = _.bind(this._onKeyUpEditor, this);\n    this._placeholder = opts.placeholder;\n  },\n\n  render: function () {\n    this.$el.html(\n      template({\n        content: this.model.get('content'),\n        tip: this._tip\n      })\n    );\n\n    this._initViews();\n    this._bindEvents();\n    this._showErrors();\n    return this;\n  },\n\n  _initViews: function () {\n    var options = _.defaults(_.extend({}, this.model.toJSON()), this.options);\n\n    var isReadOnly = options.readonly;\n    var hasLineNumbers = options.lineNumbers;\n\n    var extraKeys = {\n      'Ctrl-S': this.triggerApplyEvent.bind(this),\n      'Cmd-S': this.triggerApplyEvent.bind(this),\n      'Ctrl-Space': this._completeIfAfterCtrlSpace.bind(this)\n    };\n\n    this.editor = CodeMirror.fromTextArea(this.$('.js-editor').get(0), {\n      lineNumbers: hasLineNumbers,\n      theme: 'material',\n      mode: this._mode,\n      scrollbarStyle: 'simple',\n      lineWrapping: true,\n      readOnly: isReadOnly,\n      extraKeys: extraKeys,\n      placeholder: this._placeholder\n    });\n    this.editor.on('change', _.debounce(this._onCodeMirrorChange.bind(this), 150), this);\n\n    if (!_.isEmpty(this._addons)) {\n      _.each(this._addons, function (addon) {\n        var Class = ADDONS[addon];\n        var addonView = new Class({\n          editor: this.editor\n        });\n        addonView.bind('codeSaved', this.triggerApplyEvent, this);\n        this.$el.append(addonView.el);\n        this.addView(addonView);\n      }, this);\n    }\n\n    if (this._hints) {\n      this.editor.on('keyup', this._onInputRead);\n    }\n\n    this._toggleReadOnly();\n\n    setTimeout(function () {\n      this.editor.refresh();\n    }.bind(this), 0);\n  },\n\n  _completeIfAfterCtrlSpace: function (cm) {\n    var autocompletePrefix = this._autocompletePrefix;\n    var opts = {};\n    var cur = cm.getCursor();\n\n    if (autocompletePrefix &&\n        cm.getRange(CodeMirror.Pos(cur.line, cur.ch - autocompletePrefix.length), cur) !== autocompletePrefix) {\n      opts = { autocompletePrefix: autocompletePrefix };\n    }\n\n    return this._completeAfter(cm, opts);\n  },\n\n  updateHints: function (hints) {\n    this._hints = hints;\n  },\n\n  _onKeyUpEditor: function (cm, event) {\n    var code = event.keyCode;\n    var hints = this._hints;\n    var autocompleteChars = this._autocompleteChars - 1;\n    var autocompletePrefix = this._autocompletePrefix;\n\n    if (NOHINT.indexOf(code) === -1) {\n      var self = this;\n\n      if (this._autocompleteTimeout) clearTimeout(this._autocompleteTimeout);\n\n      this._autocompleteTimeout = setTimeout(function () {\n        var opts = {};\n        var cur = cm.getCursor();\n        var str = cm.getTokenAt(cur).string;\n        str = str.toLowerCase();\n\n        if (autocompletePrefix &&\n            cm.getRange(CodeMirror.Pos(cur.line, cur.ch - autocompletePrefix.length), cur) !== autocompletePrefix) {\n          opts = { autocompletePrefix: autocompletePrefix };\n        }\n\n        return self._completeAfter(cm, opts, function () {\n          var autocompleteHandler = function (listItem) {\n            // every list can be an array of strings or an array of objects {text, type}\n            var hit = _.isObject(listItem) ? listItem.text : listItem;\n            hit = hit.toLowerCase();\n            return hit.indexOf(str) !== -1;\n          };\n\n          if (str.length > autocompleteChars) {\n            var listHints = _.filter(hints, autocompleteHandler);\n\n            return listHints.length > 0 || autocompletePrefix && autocompletePrefix === str;\n          }\n        });\n      }, 150);\n    }\n  },\n\n  _onCodeMirrorChange: function () {\n    this.trigger('codeChanged');\n  },\n\n  _completeAfter: function (cm, opts, pred) {\n    if (!pred || pred()) {\n      if (!cm.state.completionActive) {\n        this._showAutocomplete(cm, _.extend({}, opts));\n      }\n    }\n\n    return CodeMirror.Pass;\n  },\n\n  _showAutocomplete: function (cm, opts) {\n    var autocompletePrefix = opts && opts.autocompletePrefix;\n\n    CodeMirror.showHint(cm, CodeMirror.hint['custom-list'], {\n      completeSingle: false,\n      list: this._hints,\n      autocompletePrefix: autocompletePrefix,\n      autocompleteSuffix: this._autocompleteSuffix\n    });\n  },\n\n  _bindEvents: function () {\n    var self = this;\n    this.editor.on('change', function (editor, changed) {\n      self.model.set('content', self.getContent(), {silent: true});\n    });\n\n    this.model.on('change:content', function () {\n      this.setContent(this.model.get('content'));\n    }, this);\n\n    this.model.on('change:readonly', this._toggleReadOnly, this);\n\n    this.model.on('change:errors', function () {\n      this._showErrors();\n    }, this);\n\n    this.model.on('undo redo', function () {\n      this.setContent(this.model.get('content'));\n    }, this);\n  },\n\n  _toggleReadOnly: function () {\n    var isReadOnly = !!this.model.get('readonly');\n    this.editor.setOption('readOnly', isReadOnly);\n    if (isReadOnly) {\n      this.editor.setOption('theme', '');\n      this._getInfo().hide();\n    } else {\n      this.editor.setOption('theme', 'material');\n      this._getInfo().show();\n    }\n  },\n\n  search: function (query, caseInsensitive) {\n    var cursor = this.editor.getSearchCursor(query, null, true);\n    cursor.find();\n    return cursor.pos;\n  },\n\n  markReadOnly: function (from, to) {\n    var options = {readOnly: true, inclusiveLeft: true};\n    this.editor.markText(from, to, options);\n\n    for (var i = from.line; i <= to.line; i++) {\n      this.editor.addLineClass(i, 'background', 'CodeMirror-readonlyLine');\n    }\n  },\n\n  setContent: function (value) {\n    this.editor.setValue(value);\n  },\n\n  getContent: function () {\n    return this.editor.getValue();\n  },\n\n  triggerApplyEvent: function () {\n    this.trigger('codeSaved', this.getContent(), this);\n  },\n\n  destroyEditor: function () {\n    this.editor.off('change');\n    var el = this.editor.getWrapperElement();\n    el.parentNode.removeChild(el);\n  },\n\n  _getInfo: function () {\n    return this.$('.js-console');\n  },\n\n  _getConsole: function () {\n    return this.$('.js-console-error');\n  },\n\n  _getCode: function () {\n    return this.$('.CodeMirror-code');\n  },\n\n  _removeErrors: function () {\n    this._getConsole().empty();\n    _.each(this._lineWithErrors, function ($line) {\n      $line.find('.CodeMirror-bullet').remove();\n      $line.find('.CodeMirror-linenumber').removeClass('has-error');\n    });\n\n    this._lineWithErrors = [];\n  },\n\n  _showErrors: function () {\n    var errors = this.model.get('errors');\n    this._removeErrors();\n\n    if (errors && errors.length > 0) {\n      _.each(errors, function (err) {\n        this._renderError(err);\n        this._renderBullet(err);\n      }, this);\n    }\n  },\n\n  _renderBullet: function (error) {\n    var line = error.line;\n    var $line;\n    if (line) {\n      $line = this._getCode().children().eq(+line - 1);\n      $line.append(bulletTemplate);\n      $line.find('.CodeMirror-linenumber').addClass('has-error');\n      this._lineWithErrors.push($line);\n    }\n  },\n\n  _renderError: function (error) {\n    this._getConsole().append(this._errorTemplate(error));\n  },\n\n  clean: function () {\n    this.destroyEditor();\n    CoreView.prototype.clean.apply(this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CodeMirror-editor\">\\n  <textarea class=\"js-editor\">'+\n((__t=( content ))==null?'':_.escape(__t))+\n'</textarea>\\n</div>\\n\\n';\n if (tip) { \n__p+='\\n<div class=\"CodeMirror-console js-console\">\\n  '+\n((__t=( tip ))==null?'':_.escape(__t))+\n'\\n  <div class=\"js-console-error\"></div>\\n</div>\\n';\n } \n__p+='';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar $ = require('jquery');\nvar _ = require('underscore');\nvar ColorPicker = require('../form-components/editors/fill/color-picker/color-picker.js');\nvar COLOR_KEYWORDS = require('../../helpers/color-keywords');\n\n/**\n *  Show color picker when user clicks over\n *  a color in the Codemirror editor.\n *\n *  new CodemirrorColorPicker({\n *    editor: codemirror-editor...\n *  })\n */\n\nvar REQUIRED_OPTS = [\n  'editor'\n];\n\nvar STYLE = _.template('1px solid  <%- color %>');\nvar COLORPICKER_HEIGHT = 220;\n\nvar stopPropagation = function (e) {\n  e.stopPropagation();\n};\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (opts[item] === undefined) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n\n    this._updateColors = _.debounce(this._updateColors, 5).bind(this);\n    this._onDocumentClick = this._onDocumentClick.bind(this);\n    this._editor = opts.editor;\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    var self = this;\n    var destroyPicker = function () {\n      this._destroyPicker();\n    }.bind(this);\n\n    this._enableUpdateBind();\n\n    this._editor.on('mousedown', function (cm, ev) {\n      _.delay(self._onClick.bind(self, cm, ev), 50);\n    });\n\n    this._editor.on('keydown', destroyPicker);\n    this._editor.on('viewportChange', destroyPicker);\n    this._editor.on('scroll', destroyPicker);\n\n    var wrapper = this._editor.getWrapperElement();\n    wrapper.addEventListener('click', stopPropagation);\n  },\n\n  _disableBinds: function () {\n    var wrapper = this._editor.getWrapperElement();\n    wrapper.removeEventListener('click', stopPropagation);\n    this._editor.off(null, null, this);\n  },\n\n  _enableUpdateBind: function () {\n    this._editor.on('update', this._updateColors);\n  },\n\n  _disableUpdateBind: function () {\n    this._editor.off('update', this._updateColors);\n  },\n\n  _onClick: function (cm, ev) {\n    var cursor = this._editor.getCursor(true);\n    var token = this._editor.getTokenAt(cursor);\n\n    if (token.type === 'color') {\n      this._createPicker(ev, cursor, token);\n    } else {\n      this._destroyPicker();\n    }\n  },\n\n  _updateColors: function (cm) {\n    var wrapper = cm.getWrapperElement();\n    _.each(wrapper.querySelectorAll('.cm-color'), function (node) {\n      this._paintColor(node.textContent, node);\n    }, this);\n  },\n\n  _replaceColor: function (color, target) {\n    var cursor = this._editor.getCursor();\n    var nameMatch = this._getMatch(cursor, 'name');\n    var hexMatch = this._getMatch(cursor, 'hex');\n    var match = nameMatch || hexMatch;\n    var start;\n    var end;\n\n    if (match) {\n      start = {\n        line: cursor.line,\n        ch: match.start\n      };\n      end = {\n        line: cursor.line,\n        ch: match.end\n      };\n\n      this._editor.replaceRange(color, start, end, 'paste');\n\n      var wrapper = this._editor.getWrapperElement();\n      _.each(wrapper.querySelectorAll('.cm-color'), function (node) {\n        var nodeStyle = node.style;\n        var nodeColor = node.innerText;\n        if (!nodeStyle || !nodeStyle.borderBottom) {\n          this._paintColor(nodeColor, node);\n        }\n      }, this);\n    }\n  },\n\n  _paintColor: function (color, target) {\n    target.style.borderBottom = STYLE({color: color});\n  },\n\n  _getMatch: function (cursor, type) {\n    if (!type) return;\n    var re;\n\n    switch (type.toLowerCase()) {\n      case 'name':\n        re = new RegExp(COLOR_KEYWORDS.join('|'), 'g');\n        break;\n      case 'hsl':\n        re = /hsla?\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3}\\%)\\s*,\\s*(\\d{1,3}\\%)\\s*(?:\\s*,\\s*(\\d+(?:\\.\\d+)?)\\s*)?\\)/g;\n        break;\n      case 'rgb':\n        re = /rgb\\((\\d{1,3}),\\s*(\\d{1,3}),\\s*(\\d{1,3})\\)/;\n        break;\n      case 'hex':\n        re = /#[a-fA-F0-9]{3,6}/g;\n        break;\n      default:\n        console.log('Invalid color match selection');\n        return;\n    }\n\n    var line = this._editor.getLine(cursor.line);\n    var match = re.exec(line);\n\n    while (match) {\n      var val = match[0];\n      var len = val.length;\n      var start = match.index;\n      var end = match.index + len;\n      if (cursor.ch >= start && cursor.ch <= end) {\n        match = null;\n        return {\n          start: start,\n          end: end,\n          string: val\n        };\n      }\n      match = re.exec(line);\n    }\n    return;\n  },\n\n  _createPicker: function (ev, cursor, token) {\n    var cursorCoords = this._editor.cursorCoords();\n    this._destroyPicker();\n\n    this._colorPicker = new ColorPicker({\n      className: 'Editor-boxModal ColorPicker--cm Editor-boxModal--darked Editor-FormDialog CDB-Text',\n      value: token.string,\n      disableOpacity: true\n    });\n    this._colorPicker.$el.attr('data-colorpicker-cid', this.cid);\n    this._colorPicker.bind('change', _.debounce(this._onColorPickerChange.bind(this, ev), 5), this);\n\n    var top = cursorCoords.top + 20;\n    var maxTop = $(window).outerHeight();\n\n    if (top + COLORPICKER_HEIGHT > maxTop) {\n      top = cursorCoords.top - COLORPICKER_HEIGHT - 20;\n    }\n\n    this._colorPicker.$el.css({\n      left: cursorCoords.left,\n      top: top\n    });\n\n    document.body.appendChild(this._colorPicker.render().el);\n    document.addEventListener('click', this._onDocumentClick);\n  },\n\n  _onDocumentClick: function (e) {\n    var $el = $(e.target);\n    if ($el.closest('[data-colorpicker-cid=\"' + this.cid + '\"]').length === 0) {\n      this._destroyPicker();\n    }\n  },\n\n  _onColorPickerChange: function (ev, values) {\n    this._disableUpdateBind();\n    this._replaceColor(values.hex, ev.target);\n    this.trigger('codeSaved');\n    this._enableUpdateBind();\n  },\n\n  _destroyPicker: function () {\n    if (this._colorPicker) {\n      this.removeView(this._colorPicker);\n      this._colorPicker.clean();\n      delete this._colorPicker;\n    }\n\n    document.removeEventListener('click', this._onDocumentClick);\n  },\n\n  clean: function () {\n    this._disableBinds();\n    CoreView.prototype.clean.call(this);\n  }\n});\n",
    "var _ = require('underscore');\n\nmodule.exports = function (CodeMirror) {\n  var Pos = CodeMirror.Pos;\n\n  function arrayContains (arr, item) {\n    return arr.indexOf(item) !== -1;\n  }\n\n  function scriptHint (editor, keywords, getToken, options) {\n    // Find the token at the cursor\n    var cur = editor.getCursor();\n    var token = getToken(editor, cur);\n    var tprop = token;\n    token.state = CodeMirror.innerMode(editor.getMode(), token.state).state;\n\n    // If it's not a 'word-style' token, ignore the token.\n    if (!/^[\\w$_-]*$/.test(token.string)) {\n      token = tprop = {\n        start: cur.ch,\n        end: cur.ch,\n        string: '',\n        state: token.state,\n        type: token.string === '.' ? 'property' : null\n      };\n    }\n    // If it is a property, find out what it is a property of.\n    while (tprop.type === 'property') {\n      tprop = getToken(editor, Pos(cur.line, tprop.start));\n      if (tprop.string !== '.') return;\n      tprop = getToken(editor, Pos(cur.line, tprop.start));\n      if (tprop.string === ')') {\n        var level = 1;\n        do {\n          tprop = getToken(editor, Pos(cur.line, tprop.start));\n          switch (tprop.string) {\n            case ')':\n              level++;\n              break;\n            case '(':\n              level--;\n              break;\n            default:\n              break;\n          }\n        } while (level > 0);\n        tprop = getToken(editor, Pos(cur.line, tprop.start));\n        if (tprop.type.indexOf('variable') === 0) tprop.type = 'function';\n        else return; // no clue\n      }\n      if (!context) var context = [];\n      context.push(tprop);\n    }\n\n    return {\n      list: getCompletions(token, context, keywords, options),\n      from: Pos(cur.line, token.start),\n      to: Pos(cur.line, token.end)\n    };\n  }\n\n  function columnsHint (editor, options) {\n    return scriptHint(editor, [], /* javascriptKeywords */\n      function (e, cur) {\n        return e.getTokenAt(cur);\n      },\n    options);\n  }\n\n  CodeMirror.registerHelper('hint', 'custom-list', columnsHint);\n\n  function getCompletions (token, context, keywords, options) {\n    var found = [];\n    var start = token.string.toLowerCase();\n\n    function maybeAdd (str) {\n      var hit = _.isObject(str) ? str.text : str;\n      hit = hit.toLowerCase();\n      if (hit.indexOf(start) === 0 && start !== hit && !arrayContains(found, hit)) {\n        found.push(str);\n      }\n    }\n\n    function gatherCompletions (obj) {\n      for (var name in obj) {\n        maybeAdd(obj[name]);\n      }\n    }\n\n    gatherCompletions(options.list);\n    _.each(keywords, maybeAdd);\n\n    return found;\n  }\n};\n",
    "module.exports = function (CodeMirror) {\n  CodeMirror.defineMode('mustache', function () {\n    return {\n      token: function (stream, state) {\n        var ch;\n\n        if (stream.match('{{')) {\n          ch = stream.peek();\n          if (ch == null || ch != null && ch.match(/[{]{1,}/)) {\n            stream.next();\n            return 'mustache-error';\n          } else if (ch != null && ch.match(/[a-zA-Z\\u00C0-\\u024F_]+/)) {\n            return null;\n          }\n        }\n\n        if (stream.match('}}')) {\n          ch = stream.peek();\n          if (ch != null && ch.match(/[}]{1,}/)) {\n            stream.next();\n            return 'mustache-error';\n          } else if (ch == null) {\n            return null;\n          }\n        }\n\n        if (stream.match('}')) {\n          ch = stream.peek();\n          if (ch == null || ch != null && ch.match(/[}]{1,}/)) {\n            stream.next();\n            return 'mustache-error';\n          }\n        }\n\n        if (stream.match('{')) {\n          ch = stream.peek();\n          if (ch == null || ch != null && ch.match(/[{]{1,}/)) {\n            stream.next();\n            return 'mustache-error';\n          }\n        }\n\n        // Delimiter character\n        if (stream.match(/[a-zA-Z\\u00C0-\\u024F_]+/, true)) {\n          return 'mustache-text';\n        }\n\n        // jump to the next item, needed OR CRASH\n        stream.next();\n      }\n    };\n  });\n\n  (function () {\n    var sqlKeywords = '{{  }}';\n\n    function set (str) {\n      var obj = {};\n      var words = str.split(' ');\n      for (var i = 0; i < words.length; ++i) obj[words[i]] = true;\n      return obj;\n    }\n\n    CodeMirror.defineMIME('text/mustache', {\n      name: 'mustache',\n      client: set('source'),\n      keywords: set(sqlKeywords)\n    });\n  }());\n};\n",
    "// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n/* eslint-disable */\nmodule.exports = function(CodeMirror) {\n\"use strict\";\n\nCodeMirror.defineMode(\"sql\", function(config, parserConfig) {\n  \"use strict\";\n\n  var client         = parserConfig.client || {},\n      atoms          = parserConfig.atoms || {\"false\": true, \"true\": true, \"null\": true},\n      builtin        = parserConfig.builtin || {},\n      keywords       = parserConfig.keywords || {},\n      operatorChars  = parserConfig.operatorChars || /^[*+\\-%<>!=&|~^]/,\n      support        = parserConfig.support || {},\n      hooks          = parserConfig.hooks || {},\n      dateSQL        = parserConfig.dateSQL || {\"date\" : true, \"time\" : true, \"timestamp\" : true};\n\n  function tokenBase(stream, state) {\n    var ch = stream.next();\n\n    // call hooks from the mime type\n    if (hooks[ch]) {\n      var result = hooks[ch](stream, state);\n      if (result !== false) return result;\n    }\n\n    if (support.hexNumber == true &&\n      ((ch == \"0\" && stream.match(/^[xX][0-9a-fA-F]+/))\n      || (ch == \"x\" || ch == \"X\") && stream.match(/^'[0-9a-fA-F]+'/))) {\n      // hex\n      // ref: http://dev.mysql.com/doc/refman/5.5/en/hexadecimal-literals.html\n      return \"number\";\n    } else if (support.binaryNumber == true &&\n      (((ch == \"b\" || ch == \"B\") && stream.match(/^'[01]+'/))\n      || (ch == \"0\" && stream.match(/^b[01]+/)))) {\n      // bitstring\n      // ref: http://dev.mysql.com/doc/refman/5.5/en/bit-field-literals.html\n      return \"number\";\n    } else if (ch.charCodeAt(0) > 47 && ch.charCodeAt(0) < 58) {\n      // numbers\n      // ref: http://dev.mysql.com/doc/refman/5.5/en/number-literals.html\n          stream.match(/^[0-9]*\\.?[0-9]+([eE][-+]?[0-9]+)?/);\n      support.decimallessFloat == true && stream.eat('.');\n      return \"number\";\n    } else if (ch == \"?\" && (stream.eatSpace() || stream.eol() || stream.eat(\";\"))) {\n      // placeholders\n      return \"variable-3\";\n    } else if (ch == \"'\" || (ch == '\"' && support.doubleQuote)) {\n      // strings\n      // ref: http://dev.mysql.com/doc/refman/5.5/en/string-literals.html\n      state.tokenize = tokenLiteral(ch);\n      return state.tokenize(stream, state);\n    } else if ((((support.nCharCast == true && (ch == \"n\" || ch == \"N\"))\n        || (support.charsetCast == true && ch == \"_\" && stream.match(/[a-z][a-z0-9]*/i)))\n        && (stream.peek() == \"'\" || stream.peek() == '\"'))) {\n      // charset casting: _utf8'str', N'str', n'str'\n      // ref: http://dev.mysql.com/doc/refman/5.5/en/string-literals.html\n      return \"keyword\";\n    } else if (/^[\\(\\),\\;\\[\\]]/.test(ch)) {\n      // no highlighting\n      return null;\n    } else if (support.commentSlashSlash && ch == \"/\" && stream.eat(\"/\")) {\n      // 1-line comment\n      stream.skipToEnd();\n      return \"comment\";\n    } else if ((support.commentHash && ch == \"#\")\n        || (ch == \"-\" && stream.eat(\"-\") && (!support.commentSpaceRequired || stream.eat(\" \")))) {\n      // 1-line comments\n      // ref: https://kb.askmonty.org/en/comment-syntax/\n      stream.skipToEnd();\n      return \"comment\";\n    } else if (ch == \"/\" && stream.eat(\"*\")) {\n      // multi-line comments\n      // ref: https://kb.askmonty.org/en/comment-syntax/\n      state.tokenize = tokenComment;\n      return state.tokenize(stream, state);\n    } else if (ch == \".\") {\n      // .1 for 0.1\n      if (support.zerolessFloat == true && stream.match(/^(?:\\d+(?:e[+-]?\\d+)?)/i)) {\n        return \"number\";\n      }\n      // .table_name (ODBC)\n      // // ref: http://dev.mysql.com/doc/refman/5.6/en/identifier-qualifiers.html\n      if (support.ODBCdotTable == true && stream.match(/^[a-zA-Z_]+/)) {\n        return \"variable-2\";\n      }\n    } else if (operatorChars.test(ch)) {\n      // operators\n      stream.eatWhile(operatorChars);\n      return null;\n    } else if (ch == '{' &&\n        (stream.match(/^( )*(d|D|t|T|ts|TS)( )*'[^']*'( )*}/) || stream.match(/^( )*(d|D|t|T|ts|TS)( )*\"[^\"]*\"( )*}/))) {\n      // dates (weird ODBC syntax)\n      // ref: http://dev.mysql.com/doc/refman/5.5/en/date-and-time-literals.html\n      return \"number\";\n    } else {\n      stream.eatWhile(/^[_\\w\\d]/);\n      var word = stream.current().toLowerCase();\n      // dates (standard SQL syntax)\n      // ref: http://dev.mysql.com/doc/refman/5.5/en/date-and-time-literals.html\n      if (dateSQL.hasOwnProperty(word) && (stream.match(/^( )+'[^']*'/) || stream.match(/^( )+\"[^\"]*\"/)))\n        return \"number\";\n      if (atoms.hasOwnProperty(word)) return \"atom\";\n      if (builtin.hasOwnProperty(word)) return \"builtin\";\n      if (keywords.hasOwnProperty(word)) return \"keyword\";\n      if (client.hasOwnProperty(word)) return \"string-2\";\n      return null;\n    }\n  }\n\n  // 'string', with char specified in quote escaped by '\\'\n  function tokenLiteral(quote) {\n    return function(stream, state) {\n      var escaped = false, ch;\n      while ((ch = stream.next()) != null) {\n        if (ch == quote && !escaped) {\n          state.tokenize = tokenBase;\n          break;\n        }\n        escaped = !escaped && ch == \"\\\\\";\n      }\n      return \"string\";\n    };\n  }\n  function tokenComment(stream, state) {\n    while (true) {\n      if (stream.skipTo(\"*\")) {\n        stream.next();\n        if (stream.eat(\"/\")) {\n          state.tokenize = tokenBase;\n          break;\n        }\n      } else {\n        stream.skipToEnd();\n        break;\n      }\n    }\n    return \"comment\";\n  }\n\n  function pushContext(stream, state, type) {\n    state.context = {\n      prev: state.context,\n      indent: stream.indentation(),\n      col: stream.column(),\n      type: type\n    };\n  }\n\n  function popContext(state) {\n    state.indent = state.context.indent;\n    state.context = state.context.prev;\n  }\n\n  return {\n    startState: function() {\n      return {tokenize: tokenBase, context: null};\n    },\n\n    token: function(stream, state) {\n      if (stream.sol()) {\n        if (state.context && state.context.align == null)\n          state.context.align = false;\n      }\n      if (stream.eatSpace()) return null;\n\n      var style = state.tokenize(stream, state);\n      if (style == \"comment\") return style;\n\n      if (state.context && state.context.align == null)\n        state.context.align = true;\n\n      var tok = stream.current();\n      if (tok == \"(\")\n        pushContext(stream, state, \")\");\n      else if (tok == \"[\")\n        pushContext(stream, state, \"]\");\n      else if (state.context && state.context.type == tok)\n        popContext(state);\n      return style;\n    },\n\n    indent: function(state, textAfter) {\n      var cx = state.context;\n      if (!cx) return CodeMirror.Pass;\n      var closing = textAfter.charAt(0) == cx.type;\n      if (cx.align) return cx.col + (closing ? 0 : 1);\n      else return cx.indent + (closing ? 0 : config.indentUnit);\n    },\n\n    blockCommentStart: \"/*\",\n    blockCommentEnd: \"*/\",\n    lineComment: support.commentSlashSlash ? \"//\" : support.commentHash ? \"#\" : null\n  };\n});\n\n(function() {\n  \"use strict\";\n\n  // `identifier`\n  function hookIdentifier(stream) {\n    // MySQL/MariaDB identifiers\n    // ref: http://dev.mysql.com/doc/refman/5.6/en/identifier-qualifiers.html\n    var ch;\n    while ((ch = stream.next()) != null) {\n      if (ch == \"`\" && !stream.eat(\"`\")) return \"variable-2\";\n    }\n    stream.backUp(stream.current().length - 1);\n    return stream.eatWhile(/\\w/) ? \"variable-2\" : null;\n  }\n\n  // variable token\n  function hookVar(stream) {\n    // variables\n    // @@prefix.varName @varName\n    // varName can be quoted with ` or ' or \"\n    // ref: http://dev.mysql.com/doc/refman/5.5/en/user-variables.html\n    if (stream.eat(\"@\")) {\n      stream.match(/^session\\./);\n      stream.match(/^local\\./);\n      stream.match(/^global\\./);\n    }\n\n    if (stream.eat(\"'\")) {\n      stream.match(/^.*'/);\n      return \"variable-2\";\n    } else if (stream.eat('\"')) {\n      stream.match(/^.*\"/);\n      return \"variable-2\";\n    } else if (stream.eat(\"`\")) {\n      stream.match(/^.*`/);\n      return \"variable-2\";\n    } else if (stream.match(/^[0-9a-zA-Z$\\.\\_]+/)) {\n      return \"variable-2\";\n    }\n    return null;\n  };\n\n  // short client keyword token\n  function hookClient(stream) {\n    // \\N means NULL\n    // ref: http://dev.mysql.com/doc/refman/5.5/en/null-values.html\n    if (stream.eat(\"N\")) {\n        return \"atom\";\n    }\n    // \\g, etc\n    // ref: http://dev.mysql.com/doc/refman/5.5/en/mysql-commands.html\n    return stream.match(/^[a-zA-Z.#!?]/) ? \"variable-2\" : null;\n  }\n\n  // these keywords are used by all SQL dialects (however, a mode can still overwrite it)\n  var sqlKeywords = \"alter and as asc between by count create delete desc distinct drop from group having in insert into is join like not on or order select set table union update values where limit \";\n\n  // turn a space-separated list into an array\n  function set(str) {\n    var obj = {}, words = str.split(\" \");\n    for (var i = 0; i < words.length; ++i) obj[words[i]] = true;\n    return obj;\n  }\n\n  CodeMirror.defineMIME(\"text/x-pgsql\", {\n    name: \"sql\",\n    client: set(\"source\"),\n    // http://www.postgresql.org/docs/9.5/static/sql-keywords-appendix.html\n    keywords: set(sqlKeywords + \"a abort abs absent absolute access according action ada add admin after aggregate all allocate also always analyse analyze any are array array_agg array_max_cardinality asensitive assertion assignment asymmetric at atomic attribute attributes authorization avg backward base64 before begin begin_frame begin_partition bernoulli binary bit_length blob blocked bom both breadth c cache call called cardinality cascade cascaded case cast catalog catalog_name ceil ceiling chain characteristics characters character_length character_set_catalog character_set_name character_set_schema char_length check checkpoint class class_origin clob close cluster coalesce cobol collate collation collation_catalog collation_name collation_schema collect column columns column_name command_function command_function_code comment comments commit committed concurrently condition condition_number configuration conflict connect connection connection_name constraint constraints constraint_catalog constraint_name constraint_schema constructor contains content continue control conversion convert copy corr corresponding cost covar_pop covar_samp cross csv cube cume_dist current current_catalog current_date current_default_transform_group current_path current_role current_row current_schema current_time current_timestamp current_transform_group_for_type current_user cursor cursor_name cycle data database datalink datetime_interval_code datetime_interval_precision day db deallocate dec declare default defaults deferrable deferred defined definer degree delimiter delimiters dense_rank depth deref derived describe descriptor deterministic diagnostics dictionary disable discard disconnect dispatch dlnewcopy dlpreviouscopy dlurlcomplete dlurlcompleteonly dlurlcompletewrite dlurlpath dlurlpathonly dlurlpathwrite dlurlscheme dlurlserver dlvalue do document domain dynamic dynamic_function dynamic_function_code each element else empty enable encoding encrypted end end-exec end_frame end_partition enforced enum equals escape event every except exception exclude excluding exclusive exec execute exists exp explain expression extension external extract false family fetch file filter final first first_value flag float floor following for force foreign fortran forward found frame_row free freeze fs full function functions fusion g general generated get global go goto grant granted greatest grouping groups handler header hex hierarchy hold hour id identity if ignore ilike immediate immediately immutable implementation implicit import including increment indent index indexes indicator inherit inherits initially inline inner inout input insensitive instance instantiable instead integrity intersect intersection invoker isnull isolation k key key_member key_type label lag language large last last_value lateral lead leading leakproof least left length level library like_regex link listen ln load local localtime localtimestamp location locator lock locked logged lower m map mapping match matched materialized max maxvalue max_cardinality member merge message_length message_octet_length message_text method min minute minvalue mod mode modifies module month more move multiset mumps name names namespace national natural nchar nclob nesting new next nfc nfd nfkc nfkd nil no none normalize normalized nothing notify notnull nowait nth_value ntile null nullable nullif nulls number object occurrences_regex octets octet_length of off offset oids old only open operator option options ordering ordinality others out outer output over overlaps overlay overriding owned owner p pad parameter parameter_mode parameter_name parameter_ordinal_position parameter_specific_catalog parameter_specific_name parameter_specific_schema parser partial partition pascal passing passthrough password percent percentile_cont percentile_disc percent_rank period permission placing plans pli policy portion position position_regex power precedes preceding prepare prepared preserve primary prior privileges procedural procedure program public quote range rank read reads reassign recheck recovery recursive ref references referencing refresh regr_avgx regr_avgy regr_count regr_intercept regr_r2 regr_slope regr_sxx regr_sxy regr_syy reindex relative release rename repeatable replace replica requiring reset respect restart restore restrict result return returned_cardinality returned_length returned_octet_length returned_sqlstate returning returns revoke right role rollback rollup routine routine_catalog routine_name routine_schema row rows row_count row_number rule savepoint scale schema schema_name scope scope_catalog scope_name scope_schema scroll search second section security selective self sensitive sequence sequences serializable server server_name session session_user setof sets share show similar simple size skip snapshot some source space specific specifictype specific_name sql sqlcode sqlerror sqlexception sqlstate sqlwarning sqrt stable standalone start state statement static statistics stddev_pop stddev_samp stdin stdout storage strict strip structure style subclass_origin submultiset substring substring_regex succeeds sum symmetric sysid system system_time system_user t tables tablesample tablespace table_name temp template temporary then ties timezone_hour timezone_minute to token top_level_count trailing transaction transactions_committed transactions_rolled_back transaction_active transform transforms translate translate_regex translation treat trigger trigger_catalog trigger_name trigger_schema trim trim_array true truncate trusted type types uescape unbounded uncommitted under unencrypted unique unknown unlink unlisten unlogged unnamed unnest until untyped upper uri usage user user_defined_type_catalog user_defined_type_code user_defined_type_name user_defined_type_schema using vacuum valid validate validator value value_of varbinary variadic var_pop var_samp verbose version versioning view views volatile when whenever whitespace width_bucket window within work wrapper write xmlagg xmlattributes xmlbinary xmlcast xmlcomment xmlconcat xmldeclaration xmldocument xmlelement xmlexists xmlforest xmliterate xmlnamespaces xmlparse xmlpi xmlquery xmlroot xmlschema xmlserialize xmltable xmltext xmlvalidate year yes loop repeat\"),\n    // http://www.postgresql.org/docs/9.5/static/datatype.html\n    builtin: set(\"bigint int8 bigserial serial8 bit varying varbit boolean bool box bytea character char varchar cidr circle date double precision float8 inet integer int int4 interval json jsonb line lseg macaddr money numeric decimal path pg_lsn point polygon real float4 smallint int2 smallserial serial2 serial serial4 text time without zone with timetz timestamp timestamptz tsquery tsvector txid_snapshot uuid xml\"),\n    atoms: set(\"false true null unknown\"),\n    operatorChars: /^[*+\\-%<>!=&|^]/,\n    dateSQL: set(\"date time timestamp\"),\n    support: set(\"ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber nCharCast charsetCast commentHash commentSpaceRequired\")\n  });\n}());\n\n};\n\n/* eslint-enable */\n",
    "// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n/* eslint-disable */\nmodule.exports = function (CodeMirror) {\n  CodeMirror.defineOption(\"placeholder\", \"\", function(cm, val, old) {\n    var prev = old && old != CodeMirror.Init;\n    if (val && !prev) {\n      cm.on(\"blur\", onBlur);\n      cm.on(\"change\", onChange);\n      cm.on(\"swapDoc\", onChange);\n      onChange(cm);\n    } else if (!val && prev) {\n      cm.off(\"blur\", onBlur);\n      cm.off(\"change\", onChange);\n      cm.off(\"swapDoc\", onChange);\n      clearPlaceholder(cm);\n      var wrapper = cm.getWrapperElement();\n      wrapper.className = wrapper.className.replace(\" CodeMirror-empty\", \"\");\n    }\n\n    if (val && !cm.hasFocus()) onBlur(cm);\n  });\n\n  function clearPlaceholder(cm) {\n    if (cm.state.placeholder) {\n      cm.state.placeholder.parentNode.removeChild(cm.state.placeholder);\n      cm.state.placeholder = null;\n    }\n  }\n  function setPlaceholder(cm) {\n    clearPlaceholder(cm);\n    var elt = cm.state.placeholder = document.createElement(\"pre\");\n    elt.style.cssText = \"height: 0; overflow: visible\";\n    elt.className = \"CodeMirror-placeholder\";\n    var placeHolder = cm.getOption(\"placeholder\")\n    if (typeof placeHolder == \"string\") placeHolder = document.createTextNode(placeHolder)\n    elt.appendChild(placeHolder)\n    cm.display.lineSpace.insertBefore(elt, cm.display.lineSpace.firstChild);\n  }\n\n  function onBlur(cm) {\n    if (isEmpty(cm)) setPlaceholder(cm);\n  }\n  function onChange(cm) {\n    var wrapper = cm.getWrapperElement(), empty = isEmpty(cm);\n    wrapper.className = wrapper.className.replace(\" CodeMirror-empty\", \"\") + (empty ? \" CodeMirror-empty\" : \"\");\n\n    if (empty) setPlaceholder(cm);\n    else clearPlaceholder(cm);\n  }\n\n  function isEmpty(cm) {\n    return (cm.lineCount() === 1) && (cm.getLine(0) === \"\");\n  }\n};\n/* eslint-enable */\n",
    "// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\nmodule.exports = function (CodeMirror) {\n  function Bar (cls, orientation, scroll) {\n    this.orientation = orientation;\n    this.scroll = scroll;\n    this.screen = this.total = this.size = 1;\n    this.pos = 0;\n\n    this.node = document.createElement('div');\n    this.node.className = cls + '-' + orientation;\n    this.inner = this.node.appendChild(document.createElement('div'));\n\n    var self = this;\n    CodeMirror.on(this.inner, 'mousedown', function (e) {\n      if (e.which !== 1) return;\n      CodeMirror.e_preventDefault(e);\n      var axis = self.orientation === 'horizontal' ? 'pageX' : 'pageY';\n      var start = e[axis];\n      var startpos = self.pos;\n      function done () {\n        CodeMirror.off(document, 'mousemove', move);\n        CodeMirror.off(document, 'mouseup', done);\n      }\n      function move (e) {\n        if (e.which !== 1) return done();\n        self.moveTo(startpos + (e[axis] - start) * (self.total / self.size));\n      }\n      CodeMirror.on(document, 'mousemove', move);\n      CodeMirror.on(document, 'mouseup', done);\n    });\n\n    CodeMirror.on(this.node, 'click', function (e) {\n      CodeMirror.e_preventDefault(e);\n      var innerBox = self.inner.getBoundingClientRect();\n      var where;\n      if (self.orientation === 'horizontal') {\n        where = e.clientX < innerBox.left ? -1 : e.clientX > innerBox.right ? 1 : 0;\n      } else {\n        where = e.clientY < innerBox.top ? -1 : e.clientY > innerBox.bottom ? 1 : 0;\n      }\n      self.moveTo(self.pos + where * self.screen);\n    });\n\n    function onWheel (e) {\n      var moved = CodeMirror.wheelEventPixels(e)[self.orientation === 'horizontal' ? 'x' : 'y'];\n      var oldPos = self.pos;\n      self.moveTo(self.pos + moved);\n      if (self.pos !== oldPos) {\n        CodeMirror.e_preventDefault(e);\n      }\n    }\n    CodeMirror.on(this.node, 'mousewheel', onWheel);\n    CodeMirror.on(this.node, 'DOMMouseScroll', onWheel);\n  }\n\n  Bar.prototype.setPos = function (pos, force) {\n    if (pos < 0) pos = 0;\n    if (pos > this.total - this.screen) pos = this.total - this.screen;\n    if (!force && pos === this.pos) return false;\n    this.pos = pos;\n    this.inner.style[this.orientation === 'horizontal' ? 'left' : 'top'] =\n      (pos * (this.size / this.total)) + 'px';\n    return true;\n  };\n\n  Bar.prototype.moveTo = function (pos) {\n    if (this.setPos(pos)) this.scroll(pos, this.orientation);\n  };\n\n  var minButtonSize = 10;\n\n  Bar.prototype.update = function (scrollSize, clientSize, barSize) {\n    var sizeChanged = this.screen !== clientSize || this.total !== scrollSize || this.size !== barSize;\n    if (sizeChanged) {\n      this.screen = clientSize;\n      this.total = scrollSize;\n      this.size = barSize;\n    }\n\n    var buttonSize = this.screen * (this.size / this.total);\n    if (buttonSize < minButtonSize) {\n      this.size -= minButtonSize - buttonSize;\n      buttonSize = minButtonSize;\n    }\n    this.inner.style[this.orientation === 'horizontal' ? 'width' : 'height'] =\n      buttonSize + 'px';\n    this.setPos(this.pos, sizeChanged);\n  };\n\n  function SimpleScrollbars (cls, place, scroll) {\n    this.addClass = cls;\n    this.horiz = new Bar(cls, 'horizontal', scroll);\n    place(this.horiz.node);\n    this.vert = new Bar(cls, 'vertical', scroll);\n    place(this.vert.node);\n    this.width = null;\n  }\n\n  SimpleScrollbars.prototype.update = function (measure) {\n    if (this.width == null) {\n      var style = window.getComputedStyle ? window.getComputedStyle(this.horiz.node) : this.horiz.node.currentStyle;\n      if (style) {\n        this.width = parseInt(style.height, 10);\n      }\n    }\n    var width = this.width || 0;\n\n    var needsH = measure.scrollWidth > measure.clientWidth + 1;\n    var needsV = measure.scrollHeight > measure.clientHeight + 1;\n    this.vert.node.style.display = needsV ? 'block' : 'none';\n    this.horiz.node.style.display = needsH ? 'block' : 'none';\n\n    if (needsV) {\n      this.vert.update(measure.scrollHeight, measure.clientHeight,\n        measure.viewHeight - (needsH ? width : 0));\n      this.vert.node.style.bottom = needsH ? width + 'px' : '0';\n    }\n    if (needsH) {\n      this.horiz.update(measure.scrollWidth, measure.clientWidth,\n        measure.viewWidth - (needsV ? width : 0) - measure.barLeft);\n      this.horiz.node.style.right = needsV ? width + 'px' : '0';\n      this.horiz.node.style.left = measure.barLeft + 'px';\n    }\n\n    return {right: needsV ? width : 0, bottom: needsH ? width : 0};\n  };\n\n  SimpleScrollbars.prototype.setScrollTop = function (pos) {\n    this.vert.setPos(pos);\n  };\n\n  SimpleScrollbars.prototype.setScrollLeft = function (pos) {\n    this.horiz.setPos(pos);\n  };\n\n  SimpleScrollbars.prototype.clear = function () {\n    var parent = this.horiz.node.parentNode;\n    parent.removeChild(this.horiz.node);\n    parent.removeChild(this.vert.node);\n  };\n\n  CodeMirror.scrollbarModel.simple = function (place, scroll) {\n    return new SimpleScrollbars('CodeMirror-simplescroll', place, scroll);\n  };\n\n  CodeMirror.scrollbarModel.overlay = function (place, scroll) {\n    return new SimpleScrollbars('CodeMirror-overlayscroll', place, scroll);\n  };\n};\n",
    "// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\nmodule.exports = function (CodeMirror) {\n  /*eslint-disable */\n  var Pos = CodeMirror.Pos;\n\n  function SearchCursor(doc, query, pos, caseFold) {\n    this.atOccurrence = false; this.doc = doc;\n    if (caseFold == null && typeof query == \"string\") caseFold = false;\n\n    pos = pos ? doc.clipPos(pos) : Pos(0, 0);\n    this.pos = {from: pos, to: pos};\n\n    // The matches method is filled in based on the type of query.\n    // It takes a position and a direction, and returns an object\n    // describing the next occurrence of the query, or null if no\n    // more matches were found.\n    if (typeof query != \"string\") { // Regexp match\n      if (!query.global) query = new RegExp(query.source, query.ignoreCase ? \"ig\" : \"g\");\n      this.matches = function(reverse, pos) {\n        if (reverse) {\n          query.lastIndex = 0;\n          var line = doc.getLine(pos.line).slice(0, pos.ch), cutOff = 0, match, start;\n          for (;;) {\n            query.lastIndex = cutOff;\n            var newMatch = query.exec(line);\n            if (!newMatch) break;\n            match = newMatch;\n            start = match.index;\n            cutOff = match.index + (match[0].length || 1);\n            if (cutOff == line.length) break;\n          }\n          var matchLen = (match && match[0].length) || 0;\n          if (!matchLen) {\n            if (start == 0 && line.length == 0) {match = undefined;}\n            else if (start != doc.getLine(pos.line).length) {\n              matchLen++;\n            }\n          }\n        } else {\n          query.lastIndex = pos.ch;\n          var line = doc.getLine(pos.line), match = query.exec(line);\n          var matchLen = (match && match[0].length) || 0;\n          var start = match && match.index;\n          if (start + matchLen != line.length && !matchLen) matchLen = 1;\n        }\n        if (match && matchLen)\n          return {from: Pos(pos.line, start),\n                  to: Pos(pos.line, start + matchLen),\n                  match: match};\n      };\n    } else { // String query\n      var origQuery = query;\n      if (caseFold) query = query.toLowerCase();\n      var fold = caseFold ? function(str){return str.toLowerCase();} : function(str){return str;};\n      var target = query.split(\"\\n\");\n      // Different methods for single-line and multi-line queries\n      if (target.length == 1) {\n        if (!query.length) {\n          // Empty string would match anything and never progress, so\n          // we define it to match nothing instead.\n          this.matches = function() {};\n        } else {\n          this.matches = function(reverse, pos) {\n            if (reverse) {\n              var orig = doc.getLine(pos.line).slice(0, pos.ch), line = fold(orig);\n              var match = line.lastIndexOf(query);\n              if (match > -1) {\n                match = adjustPos(orig, line, match);\n                return {from: Pos(pos.line, match), to: Pos(pos.line, match + origQuery.length)};\n              }\n             } else {\n               var orig = doc.getLine(pos.line).slice(pos.ch), line = fold(orig);\n               var match = line.indexOf(query);\n               if (match > -1) {\n                 match = adjustPos(orig, line, match) + pos.ch;\n                 return {from: Pos(pos.line, match), to: Pos(pos.line, match + origQuery.length)};\n               }\n            }\n          };\n        }\n      } else {\n        var origTarget = origQuery.split(\"\\n\");\n        this.matches = function(reverse, pos) {\n          var last = target.length - 1;\n          if (reverse) {\n            if (pos.line - (target.length - 1) < doc.firstLine()) return;\n            if (fold(doc.getLine(pos.line).slice(0, origTarget[last].length)) != target[target.length - 1]) return;\n            var to = Pos(pos.line, origTarget[last].length);\n            for (var ln = pos.line - 1, i = last - 1; i >= 1; --i, --ln)\n              if (target[i] != fold(doc.getLine(ln))) return;\n            var line = doc.getLine(ln), cut = line.length - origTarget[0].length;\n            if (fold(line.slice(cut)) != target[0]) return;\n            return {from: Pos(ln, cut), to: to};\n          } else {\n            if (pos.line + (target.length - 1) > doc.lastLine()) return;\n            var line = doc.getLine(pos.line), cut = line.length - origTarget[0].length;\n            if (fold(line.slice(cut)) != target[0]) return;\n            var from = Pos(pos.line, cut);\n            for (var ln = pos.line + 1, i = 1; i < last; ++i, ++ln)\n              if (target[i] != fold(doc.getLine(ln))) return;\n            if (fold(doc.getLine(ln).slice(0, origTarget[last].length)) != target[last]) return;\n            return {from: from, to: Pos(ln, origTarget[last].length)};\n          }\n        };\n      }\n    }\n  }\n\n  SearchCursor.prototype = {\n    findNext: function() {return this.find(false);},\n    findPrevious: function() {return this.find(true);},\n\n    find: function(reverse) {\n      var self = this, pos = this.doc.clipPos(reverse ? this.pos.from : this.pos.to);\n      function savePosAndFail(line) {\n        var pos = Pos(line, 0);\n        self.pos = {from: pos, to: pos};\n        self.atOccurrence = false;\n        return false;\n      }\n\n      for (;;) {\n        if (this.pos = this.matches(reverse, pos)) {\n          this.atOccurrence = true;\n          return this.pos.match || true;\n        }\n        if (reverse) {\n          if (!pos.line) return savePosAndFail(0);\n          pos = Pos(pos.line-1, this.doc.getLine(pos.line-1).length);\n        }\n        else {\n          var maxLine = this.doc.lineCount();\n          if (pos.line == maxLine - 1) return savePosAndFail(maxLine);\n          pos = Pos(pos.line + 1, 0);\n        }\n      }\n    },\n\n    from: function() {if (this.atOccurrence) return this.pos.from;},\n    to: function() {if (this.atOccurrence) return this.pos.to;},\n\n    replace: function(newText, origin) {\n      if (!this.atOccurrence) return;\n      var lines = CodeMirror.splitLines(newText);\n      this.doc.replaceRange(lines, this.pos.from, this.pos.to, origin);\n      this.pos.to = Pos(this.pos.from.line + lines.length - 1,\n                        lines[lines.length - 1].length + (lines.length == 1 ? this.pos.from.ch : 0));\n    }\n  };\n\n  // Maps a position in a case-folded line back to a position in the original line\n  // (compensating for codepoints increasing in number during folding)\n  function adjustPos(orig, folded, pos) {\n    if (orig.length == folded.length) return pos;\n    for (var pos1 = Math.min(pos, orig.length);;) {\n      var len1 = orig.slice(0, pos1).toLowerCase().length;\n      if (len1 < pos) ++pos1;\n      else if (len1 > pos) --pos1;\n      else return pos1;\n    }\n  }\n\n  CodeMirror.defineExtension(\"getSearchCursor\", function(query, pos, caseFold) {\n    return new SearchCursor(this.doc, query, pos, caseFold);\n  });\n  CodeMirror.defineDocExtension(\"getSearchCursor\", function(query, pos, caseFold) {\n    return new SearchCursor(this, query, pos, caseFold);\n  });\n\n  CodeMirror.defineExtension(\"selectMatches\", function(query, caseFold) {\n    var ranges = [];\n    var cur = this.getSearchCursor(query, this.getCursor(\"from\"), caseFold);\n    while (cur.findNext()) {\n      if (CodeMirror.cmpPos(cur.to(), this.getCursor(\"to\")) > 0) break;\n      ranges.push({anchor: cur.from(), head: cur.to()});\n    }\n    if (ranges.length)\n      this.setSelections(ranges, 0);\n  });\n  /*eslint-enable */\n};\n",
    "// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n/* eslint-disable */\nmodule.exports = function (CodeMirror) {\n  \"use strict\";\n\n  var HINT_ELEMENT_CLASS        = \"CodeMirror-hint\";\n  var ACTIVE_HINT_ELEMENT_CLASS = \"CodeMirror-hint-active\";\n\n  // This is the old interface, kept around for now to stay\n  // backwards-compatible.\n  CodeMirror.showHint = function(cm, getHints, options) {\n    if (!getHints) return cm.showHint(options);\n    if (options && options.async) getHints.async = true;\n    var newOpts = {hint: getHints};\n    if (options) for (var prop in options) newOpts[prop] = options[prop];\n    return cm.showHint(newOpts);\n  };\n\n  CodeMirror.defineExtension(\"showHint\", function(options) {\n    options = parseOptions(this, this.getCursor(\"start\"), options);\n    var selections = this.listSelections()\n    if (selections.length > 1) return;\n    // By default, don't allow completion when something is selected.\n    // A hint function can have a `supportsSelection` property to\n    // indicate that it can handle selections.\n    if (this.somethingSelected()) {\n      if (!options.hint.supportsSelection) return;\n      // Don't try with cross-line selections\n      for (var i = 0; i < selections.length; i++)\n        if (selections[i].head.line != selections[i].anchor.line) return;\n    }\n\n    if (this.state.completionActive) this.state.completionActive.close();\n    var completion = this.state.completionActive = new Completion(this, options);\n    if (!completion.options.hint) return;\n\n    CodeMirror.signal(this, \"startCompletion\", this);\n    completion.update(true);\n  });\n\n  function Completion(cm, options) {\n    this.cm = cm;\n    this.options = options;\n    this.widget = null;\n    this.debounce = 0;\n    this.tick = 0;\n    this.startPos = this.cm.getCursor(\"start\");\n    this.startLen = this.cm.getLine(this.startPos.line).length - this.cm.getSelection().length;\n\n    var self = this;\n    cm.on(\"cursorActivity\", this.activityFunc = function() { self.cursorActivity(); });\n  }\n\n  var requestAnimationFrame = window.requestAnimationFrame || function(fn) {\n    return setTimeout(fn, 1000/60);\n  };\n  var cancelAnimationFrame = window.cancelAnimationFrame || clearTimeout;\n\n  Completion.prototype = {\n    close: function() {\n      if (!this.active()) return;\n      this.cm.state.completionActive = null;\n      this.tick = null;\n      this.cm.off(\"cursorActivity\", this.activityFunc);\n\n      if (this.widget && this.data) CodeMirror.signal(this.data, \"close\");\n      if (this.widget) this.widget.close();\n      CodeMirror.signal(this.cm, \"endCompletion\", this.cm);\n    },\n\n    active: function() {\n      return this.cm.state.completionActive == this;\n    },\n\n    pick: function(data, i) {\n      var completion = data.list[i];\n      if (completion.hint) completion.hint(this.cm, data, completion);\n      else this.cm.replaceRange(getText(completion, this.options), completion.from || data.from,\n                                completion.to || data.to, \"complete\");\n      CodeMirror.signal(data, \"pick\", completion);\n      this.close();\n    },\n\n    cursorActivity: function() {\n      if (this.debounce) {\n        cancelAnimationFrame(this.debounce);\n        this.debounce = 0;\n      }\n\n      var pos = this.cm.getCursor(), line = this.cm.getLine(pos.line);\n      if (pos.line != this.startPos.line || line.length - pos.ch != this.startLen - this.startPos.ch ||\n          pos.ch < this.startPos.ch || this.cm.somethingSelected() ||\n          (pos.ch && this.options.closeCharacters.test(line.charAt(pos.ch - 1)))) {\n        this.close();\n      } else {\n        var self = this;\n        this.debounce = requestAnimationFrame(function() {self.update();});\n        if (this.widget) this.widget.disable();\n      }\n    },\n\n    update: function(first) {\n      if (this.tick == null) return\n      var self = this, myTick = ++this.tick\n      fetchHints(this.options.hint, this.cm, this.options, function(data) {\n        if (self.tick == myTick) self.finishUpdate(data, first)\n      })\n    },\n\n    finishUpdate: function(data, first) {\n      if (this.data) CodeMirror.signal(this.data, \"update\");\n\n      var picked = (this.widget && this.widget.picked) || (first && this.options.completeSingle);\n      if (this.widget) this.widget.close();\n\n      if (data && this.data && isNewCompletion(this.data, data)) return;\n      this.data = data;\n\n      if (data && data.list.length) {\n        if (picked && data.list.length == 1) {\n          this.pick(data, 0);\n        } else {\n          this.widget = new Widget(this, data);\n          CodeMirror.signal(data, \"shown\");\n        }\n      }\n    }\n  };\n\n  function isNewCompletion(old, nw) {\n    var moved = CodeMirror.cmpPos(nw.from, old.from)\n    return moved > 0 && old.to.ch - old.from.ch != nw.to.ch - nw.from.ch\n  }\n\n  function parseOptions(cm, pos, options) {\n    var editor = cm.options.hintOptions;\n    var out = {};\n    for (var prop in defaultOptions) out[prop] = defaultOptions[prop];\n    if (editor) for (var prop in editor)\n      if (editor[prop] !== undefined) out[prop] = editor[prop];\n    if (options) for (var prop in options)\n      if (options[prop] !== undefined) out[prop] = options[prop];\n    if (out.hint.resolve) out.hint = out.hint.resolve(cm, pos)\n    return out;\n  }\n\n  function getText(completion, options) {\n    var autocompleteSuffix = options && options.autocompleteSuffix ? options.autocompleteSuffix : '';\n    var autocompletePrefix = options && options.autocompletePrefix ? options.autocompletePrefix : '';\n\n    if (typeof completion !== \"string\") {\n      completion = completion.text\n    }\n\n    return autocompletePrefix + completion + autocompleteSuffix;\n  }\n\n  function getType(completion) {\n    if (typeof completion == \"string\") return '';\n    else return completion.type;\n  }\n\n  function buildKeyMap(completion, handle) {\n    var baseMap = {\n      Up: function() {handle.moveFocus(-1);},\n      Down: function() {handle.moveFocus(1);},\n      PageUp: function() {handle.moveFocus(-handle.menuSize() + 1, true);},\n      PageDown: function() {handle.moveFocus(handle.menuSize() - 1, true);},\n      Home: function() {handle.setFocus(0);},\n      End: function() {handle.setFocus(handle.length - 1);},\n      Enter: handle.pick,\n      Tab: handle.pick,\n      Esc: handle.close\n    };\n    var custom = completion.options.customKeys;\n    var ourMap = custom ? {} : baseMap;\n    function addBinding(key, val) {\n      var bound;\n      if (typeof val != \"string\")\n        bound = function(cm) { return val(cm, handle); };\n      // This mechanism is deprecated\n      else if (baseMap.hasOwnProperty(val))\n        bound = baseMap[val];\n      else\n        bound = val;\n      ourMap[key] = bound;\n    }\n    if (custom)\n      for (var key in custom) if (custom.hasOwnProperty(key))\n        addBinding(key, custom[key]);\n    var extra = completion.options.extraKeys;\n    if (extra)\n      for (var key in extra) if (extra.hasOwnProperty(key))\n        addBinding(key, extra[key]);\n    return ourMap;\n  }\n\n  function getHintElement(hintsElement, el) {\n    while (el && el != hintsElement) {\n      if (el.nodeName.toUpperCase() === \"LI\" && el.parentNode == hintsElement) return el;\n      el = el.parentNode;\n    }\n  }\n\n  function styleHint(hint) {\n    var element = document.createElement(hint.displayText || getText(hint));\n    element = document.createElement(\"span\");\n    element.className = 'CDB-Size-small has-letter';\n    element.innerHTML = hint.displayText || getText(hint);\n\n    var type = getType(hint);\n    if (type) {\n      element.className = 'CDB-Size-small has-letter';\n      element.dataset.type = type;\n    }\n\n    return element;\n  }\n\n  function Widget(completion, data) {\n    this.completion = completion;\n    this.data = data;\n    this.picked = false;\n    var widget = this, cm = completion.cm;\n\n    var hints = this.hints = document.createElement(\"ul\");\n    hints.className = \"CodeMirror-hints\";\n    this.selectedHint = data.selectedHint || 0;\n\n    var element;\n    var completions = data.list;\n    for (var i = 0; i < completions.length; ++i) {\n      var elt = hints.appendChild(document.createElement(\"li\")), cur = completions[i];\n      var className = HINT_ELEMENT_CLASS + (i != this.selectedHint ? \"\" : \" \" + ACTIVE_HINT_ELEMENT_CLASS);\n      if (cur.className != null) className = cur.className + \" \" + className;\n      elt.className = className;\n      if (cur.render) cur.render(elt, data, cur);\n      else {\n        element = styleHint(cur);\n        elt.appendChild(element);\n      }\n\n      elt.hintId = i;\n    }\n\n    var pos = cm.cursorCoords(completion.options.alignWithWord ? data.from : null);\n    var left = pos.left, top = pos.bottom, below = true;\n    hints.style.left = left + \"px\";\n    hints.style.top = top + \"px\";\n    // If we're at the edge of the screen, then we want the menu to appear on the left of the cursor.\n    var winW = window.innerWidth || Math.max(document.body.offsetWidth, document.documentElement.offsetWidth);\n    var winH = window.innerHeight || Math.max(document.body.offsetHeight, document.documentElement.offsetHeight);\n    (completion.options.container || document.body).appendChild(hints);\n    var box = hints.getBoundingClientRect(), overlapY = box.bottom - winH;\n    if (overlapY > 0) {\n      var height = box.bottom - box.top, curTop = pos.top - (pos.bottom - box.top);\n      if (curTop - height > 0) { // Fits above cursor\n        hints.style.top = (top = pos.top - height) + \"px\";\n        below = false;\n      } else if (height > winH) {\n        hints.style.height = (winH - 5) + \"px\";\n        hints.style.top = (top = pos.bottom - box.top) + \"px\";\n        var cursor = cm.getCursor();\n        if (data.from.ch != cursor.ch) {\n          pos = cm.cursorCoords(cursor);\n          hints.style.left = (left = pos.left) + \"px\";\n          box = hints.getBoundingClientRect();\n        }\n      }\n    }\n    var overlapX = box.right - winW;\n    if (overlapX > 0) {\n      if (box.right - box.left > winW) {\n        hints.style.width = (winW - 5) + \"px\";\n        overlapX -= (box.right - box.left) - winW;\n      }\n      hints.style.left = (left = pos.left - overlapX) + \"px\";\n    }\n\n    cm.addKeyMap(this.keyMap = buildKeyMap(completion, {\n      moveFocus: function(n, avoidWrap) { widget.changeActive(widget.selectedHint + n, avoidWrap); },\n      setFocus: function(n) { widget.changeActive(n); },\n      menuSize: function() { return widget.screenAmount(); },\n      length: completions.length,\n      close: function() { completion.close(); },\n      pick: function() { widget.pick(); },\n      data: data\n    }));\n\n    if (completion.options.closeOnUnfocus) {\n      var closingOnBlur;\n      cm.on(\"blur\", this.onBlur = function() { closingOnBlur = setTimeout(function() { completion.close(); }, 100); });\n      cm.on(\"focus\", this.onFocus = function() { clearTimeout(closingOnBlur); });\n    }\n\n    var startScroll = cm.getScrollInfo();\n    cm.on(\"scroll\", this.onScroll = function() {\n      var curScroll = cm.getScrollInfo(), editor = cm.getWrapperElement().getBoundingClientRect();\n      var newTop = top + startScroll.top - curScroll.top;\n      var point = newTop - (window.pageYOffset || (document.documentElement || document.body).scrollTop);\n      if (!below) point += hints.offsetHeight;\n      if (point <= editor.top || point >= editor.bottom) return completion.close();\n      hints.style.top = newTop + \"px\";\n      hints.style.left = (left + startScroll.left - curScroll.left) + \"px\";\n    });\n\n    CodeMirror.on(hints, \"dblclick\", function(e) {\n      var t = getHintElement(hints, e.target || e.srcElement);\n      if (t && t.hintId != null) {widget.changeActive(t.hintId); widget.pick();}\n    });\n\n    CodeMirror.on(hints, \"click\", function(e) {\n      var t = getHintElement(hints, e.target || e.srcElement);\n      if (t && t.hintId != null) {\n        widget.changeActive(t.hintId);\n        if (completion.options.completeOnSingleClick) widget.pick();\n      }\n    });\n\n    CodeMirror.on(hints, \"mousedown\", function() {\n      setTimeout(function(){cm.focus();}, 20);\n    });\n\n    CodeMirror.signal(data, \"select\", completions[0], hints.firstChild);\n    return true;\n  }\n\n  Widget.prototype = {\n    close: function() {\n      if (this.completion.widget != this) return;\n      this.completion.widget = null;\n      this.hints.parentNode.removeChild(this.hints);\n      this.completion.cm.removeKeyMap(this.keyMap);\n\n      var cm = this.completion.cm;\n      if (this.completion.options.closeOnUnfocus) {\n        cm.off(\"blur\", this.onBlur);\n        cm.off(\"focus\", this.onFocus);\n      }\n      cm.off(\"scroll\", this.onScroll);\n    },\n\n    disable: function() {\n      this.completion.cm.removeKeyMap(this.keyMap);\n      var widget = this;\n      this.keyMap = {Enter: function() { widget.picked = true; }};\n      this.completion.cm.addKeyMap(this.keyMap);\n    },\n\n    pick: function() {\n      this.completion.pick(this.data, this.selectedHint);\n    },\n\n    changeActive: function(i, avoidWrap) {\n      if (i >= this.data.list.length)\n        i = avoidWrap ? this.data.list.length - 1 : 0;\n      else if (i < 0)\n        i = avoidWrap ? 0  : this.data.list.length - 1;\n      if (this.selectedHint == i) return;\n      var node = this.hints.childNodes[this.selectedHint];\n      node.className = node.className.replace(\" \" + ACTIVE_HINT_ELEMENT_CLASS, \"\");\n      node = this.hints.childNodes[this.selectedHint = i];\n      node.className += \" \" + ACTIVE_HINT_ELEMENT_CLASS;\n      if (node.offsetTop < this.hints.scrollTop)\n        this.hints.scrollTop = node.offsetTop - 3;\n      else if (node.offsetTop + node.offsetHeight > this.hints.scrollTop + this.hints.clientHeight)\n        this.hints.scrollTop = node.offsetTop + node.offsetHeight - this.hints.clientHeight + 3;\n      CodeMirror.signal(this.data, \"select\", this.data.list[this.selectedHint], node);\n    },\n\n    screenAmount: function() {\n      return Math.floor(this.hints.clientHeight / this.hints.firstChild.offsetHeight) || 1;\n    }\n  };\n\n  function applicableHelpers(cm, helpers) {\n    if (!cm.somethingSelected()) return helpers\n    var result = []\n    for (var i = 0; i < helpers.length; i++)\n      if (helpers[i].supportsSelection) result.push(helpers[i])\n    return result\n  }\n\n  function fetchHints(hint, cm, options, callback) {\n    if (hint.async) {\n      hint(cm, callback, options)\n    } else {\n      var result = hint(cm, options)\n      if (result && result.then) result.then(callback)\n      else callback(result)\n    }\n  }\n\n  function resolveAutoHints(cm, pos) {\n    var helpers = cm.getHelpers(pos, \"hint\"), words\n    if (helpers.length) {\n      var resolved = function(cm, callback, options) {\n        var app = applicableHelpers(cm, helpers);\n        function run(i) {\n          if (i == app.length) return callback(null)\n          fetchHints(app[i], cm, options, function(result) {\n            if (result && result.list.length > 0) callback(result)\n            else run(i + 1)\n          })\n        }\n        run(0)\n      }\n      resolved.async = true\n      resolved.supportsSelection = true\n      return resolved\n    } else if (words = cm.getHelper(cm.getCursor(), \"hintWords\")) {\n      return function(cm) { return CodeMirror.hint.fromList(cm, {words: words}) }\n    } else if (CodeMirror.hint.anyword) {\n      return function(cm, options) { return CodeMirror.hint.anyword(cm, options) }\n    } else {\n      return function() {}\n    }\n  }\n\n  CodeMirror.registerHelper(\"hint\", \"auto\", {\n    resolve: resolveAutoHints\n  });\n\n  CodeMirror.registerHelper(\"hint\", \"fromList\", function(cm, options) {\n    var cur = cm.getCursor(), token = cm.getTokenAt(cur);\n    var to = CodeMirror.Pos(cur.line, token.end);\n    if (token.string && /\\w/.test(token.string[token.string.length - 1])) {\n      var term = token.string, from = CodeMirror.Pos(cur.line, token.start);\n    } else {\n      var term = \"\", from = to;\n    }\n    var found = [];\n    for (var i = 0; i < options.words.length; i++) {\n      var word = options.words[i];\n      if (word.slice(0, term.length) == term)\n        found.push(word);\n    }\n\n    if (found.length) return {list: found, from: from, to: to};\n  });\n\n  CodeMirror.commands.autocomplete = CodeMirror.showHint;\n\n  var defaultOptions = {\n    hint: CodeMirror.hint.auto,\n    completeSingle: true,\n    alignWithWord: true,\n    closeCharacters: /[\\s()\\[\\]{};:>,]/,\n    closeOnUnfocus: true,\n    completeOnSingleClick: true,\n    container: null,\n    customKeys: null,\n    extraKeys: null\n  };\n\n  CodeMirror.defineOption(\"hintOptions\", null);\n};\n/* eslint-enable */\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar ContextMenuView = require('./context-menu/context-menu-view');\nvar CustomListCollection = require('./custom-list/custom-list-collection');\nvar template = require('./context-menu-factory.tpl');\n\nvar REQUIRED_OPTS = [\n  'menuItems'\n];\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-toggle-menu': '_onToggleContextMenuClicked'\n  },\n\n  className: 'CDB-Shape',\n\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (opts[item] === undefined) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n\n    this.template = opts.template || template;\n    this._initContextMenu(this._menuItems);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(this.template());\n    return this;\n  },\n\n  _initContextMenu: function (items) {\n    this._menuItems = new CustomListCollection(items);\n    this._menuItems.on('change:selected', this._onContextMenuSelect, this);\n    this.add_related_model(this._menuItems);\n  },\n\n  _onContextMenuSelect: function (menuItem) {\n    var action = menuItem.get('action');\n    action && action.call(this);\n  },\n\n  _showContextMenu: function (position) {\n    var triggerElementID = 'context-menu-trigger-' + this.cid;\n    this.$('.js-toggle-menu').attr('id', triggerElementID);\n\n    var menuItems = this._menuItems;\n    this._resetContextMenuItems();\n    this._menuView = new ContextMenuView({\n      collection: menuItems,\n      triggerElementID: triggerElementID,\n      position: position\n    });\n\n    this._menuView.model.on('change:visible', function (model, isContextMenuVisible) {\n      if (this._hasContextMenu() && !isContextMenuVisible) {\n        this._hideContextMenu();\n      }\n    }, this);\n\n    this._menuView.show();\n    this.addView(this._menuView);\n  },\n\n  _resetContextMenuItems: function () {\n    var selected = this._menuItems.getSelectedItem();\n    selected && selected.set({selected: false}, {silent: true});\n  },\n\n  _hasContextMenu: function () {\n    return this._menuView != null;\n  },\n\n  _hideContextMenu: function () {\n    this.removeView(this._menuView);\n    this._menuView.clean();\n    delete this._menuView;\n  },\n\n  _onToggleContextMenuClicked: function (event) {\n    event.preventDefault();\n    if (this._hasContextMenu()) {\n      this._hideContextMenu();\n    } else {\n      this._showContextMenu({\n        x: event.pageX,\n        y: event.pageY\n      });\n    }\n  },\n\n  getContextMenu: function () {\n    return this._menuView;\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<button class=\"CDB-Shape-threePoints is-blue is-small js-toggle-menu\">\\n  <div class=\"CDB-Shape-threePointsItem\"></div>\\n  <div class=\"CDB-Shape-threePointsItem\"></div>\\n  <div class=\"CDB-Shape-threePointsItem\"></div>\\n</button>';\n}\nreturn __p;\n};\n",
    "var $ = require('jquery');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar CustomListView = require('../custom-list/custom-list-view');\nvar CustomListItemView = require('../custom-list/custom-list-item-view');\nvar itemTemplate = require('../custom-list/custom-list-item.tpl');\nvar magicPositioner = require('../../helpers/magic-positioner');\n\nvar ESCAPE_KEY_CODE = 27;\n\n/*\n *  A context menu\n */\nmodule.exports = CoreView.extend({\n\n  options: {\n    position: {\n      x: 0,\n      y: 0\n    },\n    offset: {\n      x: 0,\n      y: 15\n    },\n    itemTemplate: itemTemplate,\n    itemView: CustomListItemView\n  },\n\n  className: 'CDB-Box-modal CDB-SelectItem CustomList CustomList--small',\n  tagName: 'div',\n\n  initialize: function (opts) {\n    opts = opts || {};\n    if (!opts.collection) throw new Error('collection option is required');\n    if (!opts.triggerElementID) throw new Error('element id is required');\n\n    this._triggerElementID = opts.triggerElementID;\n\n    this.model = new Backbone.Model({\n      visible: false\n    });\n\n    this._onEscapePressed = this._onEscapePressed.bind(this);\n    this._onDocumentElementClicked = this._onDocumentElementClicked.bind(this);\n\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this.model.on('change:visible', function (mdl, isVisible) {\n      this.render();\n      if (isVisible) {\n        this._initDocumentBinds();\n      } else {\n        this._destroyDocumentBinds();\n      }\n    }, this);\n    this.collection.on('change:selected', this.hide, this);\n    this.add_related_model(this.collection);\n  },\n\n  _initDocumentBinds: function () {\n    $(document).on('keydown', this._onEscapePressed);\n    $(document).on('mousedown', this._onDocumentElementClicked);\n  },\n\n  _destroyDocumentBinds: function () {\n    $(document).off('keydown', this._onEscapePressed);\n    $(document).off('mousedown', this._onDocumentElementClicked);\n  },\n\n  render: function () {\n    var $body = $('body');\n    var posX = (this.options.position.x || 0) + this.options.offset.x;\n    var posY = (this.options.position.y || 0) + this.options.offset.y;\n\n    this.clearSubViews();\n    this.$el.empty();\n    this._renderList();\n\n    this.$el.toggle(this.isVisible());\n\n    $body.append(this.el);\n\n    this.$el.css(\n      magicPositioner({\n        parentView: $body,\n        posX: posX,\n        posY: posY\n      })\n    );\n\n    return this;\n  },\n\n  _onEscapePressed: function (ev) {\n    if (ev.which === ESCAPE_KEY_CODE) {\n      this.hide();\n    }\n  },\n\n  _onDocumentElementClicked: function (ev) {\n    var $el = $(ev.target);\n    if ($el.closest(this.$el).length === 0 && $el.closest($('#' + this._triggerElementID)).length === 0) {\n      this.hide();\n    }\n  },\n\n  _renderList: function () {\n    this._listView = new CustomListView({\n      model: this.model,\n      collection: this.collection,\n      typeLabel: '',\n      ItemView: this.options.itemView,\n      itemTemplate: this.options.itemTemplate,\n      size: 5\n    });\n    this.$el.append(this._listView.render().el);\n    this.addView(this._listView);\n  },\n\n  show: function () {\n    this.model.set('visible', true);\n  },\n\n  hide: function () {\n    this.model.set('visible', false);\n  },\n\n  toggle: function () {\n    this.model.set('visible', !this.model.get('visible'));\n  },\n\n  isVisible: function () {\n    return this.model.get('visible');\n  },\n\n  clean: function () {\n    this._destroyDocumentBinds();\n    CoreView.prototype.clean.apply(this);\n  }\n});\n",
    "var Backbone = require('backbone');\nvar CustomCarouselModel = require('./custom-carousel-item-model');\n\n/*\n *  Custom list collection, it parses pairs like:\n *\n *  [{ val, label }]\n *  [\"string\"]\n */\n\nmodule.exports = Backbone.Collection.extend({\n\n  model: function (attrs, opts) {\n    var d = {};\n    if (typeof attrs === 'string') {\n      d.val = attrs;\n    } else {\n      d = attrs;\n    }\n    return new CustomCarouselModel(d);\n  },\n\n  initialize: function () {\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this.bind('change:selected', this._onSelectedChange, this);\n  },\n\n  _onSelectedChange: function (changedModel, isSelected) {\n    if (isSelected) {\n      this.each(function (m) {\n        if (m.cid !== changedModel.cid && m.get('selected')) {\n          m.set('selected', false);\n        }\n      });\n    }\n  },\n\n  getSelected: function () {\n    return this.findWhere({ selected: true });\n  },\n\n  getSelectedValue: function () {\n    var selectedModel = this.getSelected();\n    return selectedModel && selectedModel.get('val');\n  },\n\n  getHighlighted: function () {\n    return this.findWhere({ highlighted: true });\n  }\n\n});\n",
    "var Backbone = require('backbone');\n\n/*\n *  List item model\n *\n */\n\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    selected: false,\n    label: '',\n    template: function () {\n      return '';\n    }\n  },\n\n  getName: function () {\n    return this.get('label') || this.getValue();\n  },\n\n  getValue: function () {\n    return this.get('val');\n  }\n\n});\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./custom-carousel-item.tpl');\n\nmodule.exports = CoreView.extend({\n\n  className: 'Carousel-item',\n  tagName: 'li',\n\n  events: {\n    'mouseenter': '_onMouseEnter',\n    'mouseleave': '_onMouseLeave',\n    'click': '_onClick'\n  },\n\n  initialize: function (opts) {\n    this._itemClassName = opts && opts.itemOptions ? opts.itemOptions.className : '';\n    this._initBinds();\n  },\n\n  render: function () {\n    this.$el.html(\n      template({\n        name: this.model.getName(),\n        className: this._itemClassName,\n        template: this.model.get('template')()\n      })\n    );\n\n    if (this.model.getValue()) {\n      this.$el.addClass('js-' + this.model.getValue());\n    }\n    this.$el.toggleClass('is-selected', !!this.model.get('selected'));\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:selected', this.render, this);\n  },\n\n  _onMouseEnter: function () {\n    this.model.set('highlighted', true);\n  },\n\n  _onMouseLeave: function () {\n    this.model.set('highlighted', false);\n  },\n\n  _onClick: function (e) {\n    this.killEvent(e);\n    this.model.set('selected', true);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<button';\n if (className) { \n__p+=' class=\"'+\n((__t=( className ))==null?'':_.escape(__t))+\n'\"';\n } \n__p+='>\\n  '+\n((__t=( template ))==null?'':__t)+\n'\\n</button>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar Ps = require('perfect-scrollbar');\nvar template = require('./custom-carousel.tpl');\nvar CarouselCollection = require('./custom-carousel-collection');\nvar CarouselItemView = require('./custom-carousel-item-view');\nvar _ = require('underscore');\n/*\n *  A custom carousel selector\n *\n *  It accepts a collection of (val, label) model attributes or a values array\n *  with the same content or only strings.\n *\n *  new CustomCarousel({\n *    options: [\n *      {\n *        val: 'hello',\n *        label: 'hi'\n *      }\n *    ]\n *  });\n */\n\nmodule.exports = CoreView.extend({\n\n  className: 'Carousel',\n  tagName: 'div',\n\n  initialize: function (opts) {\n    if (!opts.collection) {\n      if (!opts.options) { throw new Error('options array {value, label} is required'); }\n      this.collection = new CarouselCollection(opts.options);\n      this.options = opts;\n    }\n    this._bindedCheckShadows = this._checkShadows.bind(this);\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template());\n    this._renderList();\n    this._applyCustomScroll();\n    return this;\n  },\n\n  _initBinds: function () {\n    this.collection.bind('change:selected', this._checkScroll, this);\n  },\n\n  _renderList: function () {\n    this.collection.each(function (mdl) {\n      this._createItem(mdl);\n    }, this);\n  },\n\n  _createItem: function (mdl) {\n    var opts = this.options;\n    var className = opts && opts.listItemOptions ? opts.listItemOptions.className : 'Carousel-item';\n    var view = new CarouselItemView({\n      className: className,\n      model: mdl,\n      itemOptions: this.options.itemOptions\n    });\n\n    this._listContainer().append(view.render().el);\n    this.addView(view);\n  },\n\n  _applyCustomScroll: function () {\n    Ps.initialize(this._listContainer().get(0), {\n      wheelSpeed: 1,\n      wheelPropagation: false,\n      swipePropagation: true,\n      suppressScrollY: true,\n      stopPropagationOnClick: false,\n      minScrollbarLength: 120\n    });\n    this._checkScroll();\n    this._bindScroll();\n  },\n\n  _destroyCustomScroll: function () {\n    this._unbindScroll();\n    Ps.destroy(this._listContainer().get(0));\n  },\n\n  _bindScroll: function () {\n    this._listContainer()\n      .on('ps-x-reach-start', this._bindedCheckShadows)\n      .on('ps-x-reach-end', this._bindedCheckShadows)\n      .on('ps-scroll-x', this._bindedCheckShadows);\n  },\n\n  _unbindScroll: function () {\n    this._listContainer()\n      .off('ps-x-reach-start', this._bindedCheckShadows)\n      .off('ps-x-reach-end', this._bindedCheckShadows)\n      .off('ps-scroll-x', this._bindedCheckShadows);\n  },\n\n  _checkScroll: function () {\n    var position = this.$('.is-selected').position();\n    if (position) {\n      this._listContainer().scrollLeft(position.left - 20);\n      this._bindedCheckShadows();\n    }\n  },\n\n  _listContainer: function () {\n    return this.$('.js-list');\n  },\n\n  _checkShadows: function () {\n    var currentPos = this._listContainer().scrollLeft();\n    var max = this._listContainer().get(0).scrollWidth;\n    var width = this._listContainer().outerWidth();\n    var maxPos = max - width;\n\n    this.$('.js-leftShadow').toggleClass('is-visible', currentPos > 0);\n    this.$('.js-rightShadow').toggleClass('is-visible', currentPos < maxPos);\n  },\n\n  clean: function () {\n    this._destroyCustomScroll();\n    CoreView.prototype.clean.apply(this);\n  },\n\n  initScroll: function () {\n    setTimeout(_.bind(function () {\n      this._checkShadows();\n      this._checkScroll();\n      Ps.update(this._listContainer().get(0));\n    }, this), 0);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Carousel-shadow Carousel-shadow--left js-leftShadow\"></div>\\n<div class=\"Carousel-shadow Carousel-shadow--right is-visible js-rightShadow\"></div>\\n<ul class=\"Carousel-list js-list\"></ul>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CDB-ListDecoration-item CustomList-item js-listItem\">\\n  <button type=\"button\" class=\"CDB-ListDecoration-itemLink CustomList-itemLink js-add-custom-value u-ellipsis\" data-val=\"'+\n((__t=( query ))==null?'':_.escape(__t))+\n'\" title=\"'+\n((__t=( query ))==null?'':_.escape(__t))+\n'\">\\n    <p class=\"CDB-Text CDB-FontSize-small u-altTextColor\">'+\n((__t=( _t('components.custom-list.add-custom-result') ))==null?'':_.escape(__t))+\n'</p>\\n    '+\n((__t=( query ))==null?'':_.escape(__t))+\n'\\n  </button>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar CustomListItemModel = require('./custom-list-item-model');\nvar _ = require('underscore');\n\n/*\n *  Custom list collection, it parses pairs like:\n *\n *  [{ val, label }]\n *  [\"string\"]\n */\n\nmodule.exports = Backbone.Collection.extend({\n  sort_key: 'id', // default sort key\n\n  initialize: function (models, options) {\n    this.options = _.extend({ silent: true }, options);\n    this._initBinds();\n  },\n\n  comparator: function (item) {\n    return item.get(this.sort_key) ? item.get(this.sort_key).toLowerCase() : item.get(this.sort_key);\n  },\n\n  model: function (attrs, opts) {\n    var d = {};\n    if (typeof attrs === 'string') {\n      d.val = attrs;\n    } else {\n      d = attrs;\n    }\n    return new CustomListItemModel(d, opts);\n  },\n\n  sortByKey: function (key) {\n    this.sort_key = key;\n    this.sort();\n  },\n\n  _initBinds: function () {\n    this.bind('change:selected', this._onSelectedChange, this);\n  },\n\n  search: function (query) {\n    if (!query) return this;\n    query = query.toLowerCase();\n\n    return _(this.filter(function (model) {\n      var name = model.getName();\n      var val = _.isString(name) ? name.toLowerCase() : name;\n      return val ? ~val.indexOf(query) : -1;\n    }));\n  },\n\n  _onSelectedChange: function (changedModel, isSelected) {\n    if (isSelected) {\n      this.each(function (m) {\n        if (m.cid !== changedModel.cid) {\n          m.set({\n            selected: false\n          }, {\n            silent: this.options.silent\n          });\n        }\n      }, this);\n    }\n  },\n\n  getSelectedItem: function () {\n    return _.first(\n      this.where({ selected: true })\n    );\n  },\n\n  containsValue: function (value) {\n    return this.find(function (mdl) {\n      return mdl.getValue() === value;\n    });\n  },\n\n  setSelected: function (value) {\n    var selectedModel;\n    var silent = { silent: this.options.silent };\n\n    this.each(function (mdl) {\n      if (mdl.getValue() === value) {\n        mdl.set({\n          selected: true\n        }, silent);\n        selectedModel = mdl;\n      } else {\n        mdl.set({\n          selected: false\n        }, silent);\n      }\n    });\n    return selectedModel;\n  },\n\n  removeSelected: function () {\n    this.each(function (mdl) {\n      mdl.set({\n        selected: false\n      });\n    });\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CustomList-message\">\\n  <p class=\"CustomList-messageText CDB-Text CDB-Size-medium u-secondaryTextColor\">\\n    ';\n if (query && query.length) { \n__p+='\\n      '+\n((__t=( _t('components.custom-list.no-results', { typeLabel: typeLabel, query: query }) ))==null?'':_.escape(__t))+\n'\\n    ';\n } else { \n__p+='\\n      '+\n((__t=( _t('components.custom-list.no-items', { typeLabel: typeLabel }) ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n  </p>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\n\n/*\n *  List item model\n *\n */\n\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    selected: false\n  },\n\n  getName: function () {\n    return (this.get('label') == null) ? this.getValue() : this.get('label'); // eslint-disable-line\n  },\n\n  getValue: function () {\n    return this.get('val');\n  }\n\n});\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\n\nmodule.exports = CoreView.extend({\n\n  options: {\n    template: require('./custom-list-item.tpl')\n  },\n\n  className: 'CDB-ListDecoration-item CustomList-item js-listItem',\n  tagName: 'li',\n\n  events: {\n    'mouseenter': '_onMouseEnter',\n    'mouseleave': '_onMouseLeave',\n    'click': '_onClick'\n  },\n\n  initialize: function (opts) {\n    this.options = _.extend({}, this.options, opts);\n    this.model.on('change', this.render, this);\n  },\n\n  render: function () {\n    this.$el.empty();\n    this.clearSubViews();\n\n    var name = this.model.getName() == null ? 'null' : this.model.getName();\n\n    this.$el.append(\n      this.options.template(\n        _.extend({\n          typeLabel: this.options.typeLabel,\n          isSelected: this.model.get('selected'),\n          isDisabled: this.model.get('disabled'),\n          isDestructive: this.model.get('destructive'),\n          name: name,\n          val: this.model.getValue(),\n          options: this.model.get('renderOptions')\n        })\n      )\n    );\n\n    this.$el\n      .attr('data-val', this.model.getValue())\n      .toggleClass('is-disabled', !!this.model.get('disabled'));\n\n    return this;\n  },\n\n  _onMouseLeave: function () {\n    this.$el.removeClass('is-highlighted');\n  },\n\n  _onMouseEnter: function () {\n    this.$el.addClass('is-highlighted');\n  },\n\n  _onClick: function (ev) {\n    this.killEvent(ev);\n    this.model.set({\n      selectedClass: ev.target.classList,\n      selected: true\n    });\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<button type=\"button\" class=\"CDB-ListDecoration-itemLink u-ellipsis\\n  ';\n if (isSelected) { \n__p+=' is-selected ';\n } \n__p+='\\n  ';\n if (isDestructive) { \n__p+='\\n  u-errorTextColor\\n  ';\n } else if (isDisabled) { \n__p+='\\n  u-hintTextColor\\n  ';\n } else { \n__p+='\\n  u-actionTextColor\\n  ';\n } \n__p+='\\n  \" title=\"'+\n((__t=( name ))==null?'':_.escape(__t))+\n'\">\\n\\n  <div class=\"u-iBlock u-rSpace\">\\n    <input class=\"CDB-Checkbox js-input\" type=\"checkbox\" name=\"\" value=\"\" ';\n if (isSelected) { \n__p+='checked';\n } \n__p+=' ';\n if (isDisabled) { \n__p+='disabled';\n } \n__p+=' />\\n    <span class=\"u-iBlock CDB-Checkbox-face\"></span>\\n  </div>\\n  '+\n((__t=( name ))==null?'':_.escape(__t))+\n'\\n</button>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<button type=\"button\" class=\"CDB-ListDecoration-itemLink u-ellipsis\\n    ';\n if (isSelected) { \n__p+=' is-selected ';\n } \n__p+='\\n    ';\n if (isDestructive) { \n__p+='\\n      u-errorTextColor\\n    ';\n } else if (isDisabled) { \n__p+='\\n      u-hintTextColor\\n    ';\n } else { \n__p+='\\n      u-actionTextColor\\n    ';\n } \n__p+='\\n  \" title=\"'+\n((__t=( name ))==null?'':_.escape(__t))+\n'\">\\n  '+\n((__t=( name ))==null?'':_.escape(__t))+\n'\\n</button>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar CustomListCollection = require('./custom-list-collection');\n\nmodule.exports = CustomListCollection.extend({\n  _initBinds: function () { },\n\n  setSelected: function (value) {\n    var selectedModel;\n    var silentTrue = { silent: true };\n\n    if (_.isArray(value)) {\n      this.each(function (mdl) {\n        if (_.contains(value, mdl.getValue())) {\n          mdl.set({\n            selected: true\n          }, silentTrue);\n          selectedModel = mdl;\n        } else {\n          mdl.set({\n            selected: false\n          }, silentTrue);\n        }\n      });\n    } else {\n      this.each(function (mdl) {\n        if (mdl.getValue() === value) {\n          mdl.set({\n            selected: true\n          }, silentTrue);\n          selectedModel = mdl;\n        } else {\n          mdl.set({\n            selected: false\n          }, silentTrue);\n        }\n      });\n    }\n    return selectedModel;\n  }\n});\n",
    "var CustomListItemView = require('./custom-list-item-view');\n\nmodule.exports = CustomListItemView.extend({\n  _onClick: function (ev) {\n    this.killEvent(ev);\n    this.model.set('selected', !this.model.get('selected'));\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./custom-list-search.tpl');\n\nmodule.exports = CoreView.extend({\n\n  className: 'CustomList-form CDB-Box-modalHeader',\n  tagName: 'form',\n\n  events: {\n    'keyup .js-search': '_onSearchType',\n    'click .js-clear': '_onClickClear',\n    'submit': '_submit'\n  },\n\n  initialize: function () {\n    this.template = this.options.template || template;\n    this.searchPlaceholder = this.options.searchPlaceholder || _t('components.custom-list.placeholder', { typeLabel: this.options.typeLabel });\n    this._initBinds();\n  },\n\n  render: function () {\n    this.$el\n      .empty()\n      .append(\n        this.template({\n          query: this.model.get('query'),\n          searchPlaceholder: this.searchPlaceholder\n        })\n      );\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.on('change:query', this._checkButtons, this);\n  },\n\n  _checkButtons: function () {\n    var query = this.model.get('query');\n    this.$('.js-clear').toggle(query.length > 0);\n  },\n\n  _onSearchType: function (e) {\n    this._submit();\n  },\n\n  _onClickClear: function (e) {\n    e.stopPropagation();\n    this.model.set('query', '');\n    this.render();\n    this.focus();\n  },\n\n  focus: function () {\n    this.$('.js-search').focus();\n  },\n\n  _submit: function (ev) {\n    this.killEvent(ev);\n    var query = this.$('.js-search').val();\n    this.model.set('query', query);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CDB-Box-modalHeaderItem\">\\n  <input type=\"text\" name=\"text\" autocomplete=\"off\" placeholder=\"'+\n((__t=( searchPlaceholder ))==null?'':_.escape(__t))+\n'\" class=\"CDB-InputTextPlain CDB-Text js-search\">\\n  <button type=\"button\" style=\"display:none\" class=\"u-lSpace--xl js-clear\">\\n    <div class=\"CDB-Shape\">\\n      <div class=\"CDB-Shape-close is-blue is-large\"></div>\\n    </div>\\n  </button>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar Ps = require('perfect-scrollbar');\nvar emptyTemplate = require('./custom-list-empty.tpl');\nvar addTemplate = require('./custom-list-add.tpl');\nvar template = require('./custom-list.tpl');\nvar ARROW_DOWN_KEY_CODE = 40;\nvar Utils = require('../../helpers/utils');\nvar ARROW_UP_KEY_CODE = 38;\nvar ENTER_KEY_CODE = 13;\n\nmodule.exports = CoreView.extend({\n  options: {\n    size: 3\n  },\n\n  className: 'CDB-Text CDB-Size-medium CustomList-listWrapper',\n\n  tagName: 'div',\n\n  events: {\n    'click .js-add-custom-value': '_onClickAddCustomValue'\n  },\n\n  initialize: function (opts) {\n    this.options = _.extend({}, this.options, opts);\n    this._onKeyDownBinded = this._onKeyDown.bind(this);\n    this._needsMaxSize = true;\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this._removeArrowBinds();\n    this._destroyCustomScroll();\n    this.$el.empty();\n\n    var query = this.model.get('query');\n    var items = this.collection.search(query);\n\n    this.$el.append(template());\n\n    var allowFreeTextInput = this.options.allowFreeTextInput;\n    var containsValue = !this.collection.containsValue(query);\n\n    if (allowFreeTextInput && query && !Utils.isBlank(query) && containsValue) {\n      this.$el.prepend(\n        addTemplate({\n          query: query,\n          typeLabel: this.options.typeLabel\n        })\n      );\n    }\n\n    if (items.size() > 0) {\n      items.each(this._renderItem, this);\n      this._applyArrowBinds();\n      // Perfect-scroll needs to have the element in the DOM in order to\n      // style/positionate the scroll properly, small trick\n      setTimeout(this._applyCustomScroll.bind(this), 0);\n    } else if (!allowFreeTextInput || Utils.isBlank(query)) {\n      this.$el.append(\n        emptyTemplate({\n          query: query,\n          typeLabel: this.options.typeLabel\n        })\n      );\n    }\n\n    return this;\n  },\n\n  _renderItem: function (mdl) {\n    var ItemViewClass = this.options.ItemView;\n    var itemView = new ItemViewClass({\n      model: mdl,\n      typeLabel: this.options.typeLabel,\n      template: this.options.itemTemplate\n    });\n    this.$('.js-list').append(itemView.render().el);\n    this.addView(itemView);\n\n    itemView.bind('customEvent', function (eventName, item) {\n      this.trigger('customEvent', eventName, item, this);\n    }, this);\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:query', this.render, this);\n  },\n\n  _applyArrowBinds: function () {\n    document.addEventListener('keydown', this._onKeyDownBinded);\n  },\n\n  _removeArrowBinds: function () {\n    document.removeEventListener('keydown', this._onKeyDownBinded);\n  },\n\n  _getSelected: function () {\n    var selectedModel = this.collection.getSelectedItem();\n    var selectedValue;\n\n    if (selectedModel) {\n      selectedValue = selectedModel.getValue();\n      return this.$(\"[data-val='\" + selectedValue + \"']\");\n    }\n\n    return null;\n  },\n\n  _highlightSelected: function (item) {\n    var itemHeight = item.outerHeight();\n    item.addClass('is-highlighted');\n    this.$('.js-list').scrollTop(item.index() * itemHeight);\n  },\n\n  _onClickAddCustomValue: function (e) {\n    this.killEvent(e);\n\n    var query = this.model.get('query');\n\n    var mdl = this.collection.add({\n      val: query,\n      label: '' + query + ''\n    });\n\n    this.collection.sortByKey('val');\n    mdl.set('selected', true);\n  },\n\n  _onKeyDown: function (e) {\n    if (this.model.get('visible') === false) {\n      return;\n    }\n\n    var key = e.which;\n    var $listItems = this.$('.js-listItem');\n    var $highlighted = $listItems.filter('.is-highlighted');\n    var $current;\n    var mdl;\n\n    $highlighted.removeClass('is-highlighted');\n\n    if (key === ARROW_DOWN_KEY_CODE) {\n      if (!$highlighted.length || $highlighted[0] === $listItems.last()[0]) {\n        $current = $listItems.eq(0);\n      } else {\n        $current = $highlighted.next();\n      }\n    } else if (key === ARROW_UP_KEY_CODE) {\n      if (!$highlighted.length || $highlighted[0] === $listItems.first()[0]) {\n        $current = $listItems.last();\n      } else {\n        $current = $highlighted.prev();\n      }\n    } else if (key === ENTER_KEY_CODE) {\n      e.preventDefault();\n      if ($highlighted && $highlighted.length) {\n        mdl = _.first(this.collection.where({ val: $highlighted.data('val') }));\n        if (mdl) {\n          mdl.set('selected', true);\n        }\n        return false;\n      }\n    }\n\n    $current && this._highlightSelected($current);\n  },\n\n  _applyCustomScroll: function () {\n    Ps.initialize(this._wrapperContainer().get(0), {\n      wheelSpeed: 2,\n      wheelPropagation: true,\n      stopPropagationOnClick: false,\n      minScrollbarLength: 20\n    });\n  },\n\n  _destroyCustomScroll: function () {\n    if (this._wrapperContainer().length > 0) {\n      Ps.destroy(this._wrapperContainer().get(0));\n    }\n  },\n\n  _wrapperContainer: function () {\n    return this.$('.js-list');\n  },\n\n  clean: function () {\n    this._removeArrowBinds();\n    this._destroyCustomScroll();\n    CoreView.prototype.clean.apply(this);\n  },\n\n  highlight: function () {\n    var selected = this._getSelected();\n    selected && this._highlightSelected(selected);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<ul class=\"CustomList-list js-list\"></ul>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar CustomListCollection = require('./custom-list-collection');\nvar SearchView = require('./custom-list-search-view');\nvar CustomListView = require('./custom-list-view');\nvar itemTemplate = require('./custom-list-item.tpl');\nvar CustomListItemView = require('./custom-list-item-view');\n\n/*\n *  A custom list with possibility to search within values.\n *\n *  It accepts a collection of (val, label) model attributes or a values array\n *  with the same content or only strings.\n *\n *  new CustomList({\n *    showSearch: false,\n *    itemTemplate: itemTemplate,\n *    values: [\n *      {\n *        val: 'hello',\n *        label: 'hi'\n *      }\n *    ]\n *  });\n */\n\nmodule.exports = CoreView.extend({\n\n  options: {\n    showSearch: true,\n    allowFreeTextInput: false,\n    typeLabel: 'column',\n    itemTemplate: itemTemplate,\n    itemView: CustomListItemView\n  },\n\n  className: 'CDB-Box-modal CustomList',\n  tagName: 'div',\n\n  initialize: function (opts) {\n    if (!opts.collection) {\n      if (!opts.options) { throw new Error('options array {value, label} is required'); }\n      this.collection = new CustomListCollection(opts.options);\n    }\n\n    if (opts.position) {\n      this.$el.css(opts.position);\n    }\n\n    this.options = _.extend({}, this.options, opts);\n    this.model = new Backbone.Model({\n      query: '',\n      visible: false\n    });\n    this._initBinds();\n  },\n\n  render: function () {\n    this.$el.empty();\n    this.clearSubViews();\n\n    if (this.options.showSearch) {\n      this._renderSearch();\n    }\n    this._renderList();\n\n    if (this.options.showSearch) {\n      this._focusSearch();\n    }\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:visible', function (mdl, isVisible) {\n      this._resetQuery();\n      this._toggleVisibility();\n\n      if (!isVisible) {\n        this.clearSubViews();\n      } else {\n        this.render();\n      }\n    }, this);\n  },\n\n  _renderSearch: function () {\n    this._searchView = new SearchView({\n      template: this.options.searchTemplate,\n      typeLabel: this.options.typeLabel,\n      searchPlaceholder: this.options.searchPlaceholder,\n      model: this.model\n    });\n    this.$el.prepend(this._searchView.render().el);\n    this.addView(this._searchView);\n  },\n\n  _focusSearch: function () {\n    setTimeout(function () {\n      this._searchView && this._searchView.focus();\n    }.bind(this), 0);\n  },\n\n  _renderList: function () {\n    this._listView = new CustomListView({\n      model: this.model,\n      allowFreeTextInput: this.options.allowFreeTextInput,\n      collection: this.collection,\n      typeLabel: this.options.typeLabel,\n      ItemView: this.options.itemView,\n      itemTemplate: this.options.itemTemplate,\n      size: this.options.size\n    });\n    this.$el.append(this._listView.render().el);\n\n    this._listView.highlight();\n    this.addView(this._listView);\n\n    this._listView.bind('customEvent', function (eventName, item) {\n      this.trigger(eventName, item, this);\n    }, this);\n  },\n\n  highlight: function () {\n    this._listView.highlight();\n  },\n\n  _resetQuery: function () {\n    this.model.set('query', '');\n  },\n\n  show: function () {\n    this.model.set('visible', true);\n  },\n\n  hide: function () {\n    this.trigger('hidden', this);\n    this.model.set('visible', false);\n  },\n\n  toggle: function () {\n    this.model.set('visible', !this.model.get('visible'));\n  },\n\n  _toggleVisibility: function () {\n    this.$el.toggleClass('is-visible', !!this.model.get('visible'));\n  },\n\n  isVisible: function () {\n    return this.model.get('visible');\n  },\n\n  remove: function () {\n    this._listView && this._listView.clean();\n    CoreView.prototype.remove.call(this);\n  }\n});\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar SQLNotifications = require('../../sql-notifications');\nvar SQLUtils = require('../../helpers/sql-utils');\nvar Notifier = require('../../components/notifier/notifier');\nvar cdb = require('cartodb.js');\nvar checkAndBuildOpts = require('../../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'configModel',\n  'editorModel',\n  'layerDefinitionModel',\n  'querySchemaModel'\n];\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    this._clearSQLModel = new Backbone.Model({\n      visible: false\n    });\n\n    this._sqlModel = this._layerDefinitionModel.sqlModel;\n\n    this._SQL = new cdb.SQL({\n      user: this._configModel.get('user_name'),\n      sql_api_template: this._configModel.get('sql_api_template'),\n      api_key: this._configModel.get('api_key')\n    });\n\n    this._codemirrorModel = new Backbone.Model({\n      content: this._querySchemaModel.get('query'),\n      readonly: false\n    });\n\n    SQLNotifications.track(this);\n  },\n\n  _internalParseSQL: function (callbackAfterAlterSuccess) {\n    var appliedQuery = this._querySchemaModel.get('query');\n    var currentQuery = this._codemirrorModel.get('content');\n\n    // Remove last character if it has ';'\n    if (currentQuery && currentQuery.slice(-1) === ';') {\n      currentQuery = currentQuery.slice(0, currentQuery.length - 1);\n      this._codemirrorModel.set('content', currentQuery);\n    }\n\n    var isSameQuery = SQLUtils.isSameQuery(currentQuery, appliedQuery);\n    var altersData = SQLUtils.altersData(currentQuery);\n\n    if (currentQuery === '' || isSameQuery) {\n      SQLNotifications.removeNotification();\n      return false;\n    }\n\n    if (altersData) {\n      SQLNotifications.showNotification({\n        status: 'loading',\n        info: _t('notifications.sql.alter-loading'),\n        closable: false\n      });\n\n      this._sqlModel.set('content', currentQuery);\n\n      this._SQL.execute(currentQuery, null, {\n        success: function () {\n          SQLNotifications.showNotification({\n            status: 'success',\n            info: _t('notifications.sql.alter-success'),\n            closable: true,\n            delay: Notifier.DEFAULT_DELAY\n          });\n          this._applyDefaultSQLAfterAlteringData();\n          if (typeof callbackAfterAlterSuccess === 'function') {\n            callbackAfterAlterSuccess.call(this);\n          }\n        }.bind(this),\n        error: function (errors) {\n          errors = errors.responseJSON.error;\n          var parsedErrors = this._parseErrors(errors);\n          this._codemirrorModel.set('errors', parsedErrors);\n          SQLNotifications.showErrorNotification(parsedErrors);\n          this._checkClearButton();\n        }.bind(this)\n      });\n    } else {\n      this._runQuery(currentQuery, this._saveSQL.bind(this));\n    }\n  },\n\n  _checkClearButton: function () {\n    var customSql = this._codemirrorModel.get('content');\n    var isDefaultQuery = SQLUtils.isSameQuery(customSql, this._defaultSQL());\n    this._clearSQLModel.set({ visible: !isDefaultQuery });\n  },\n\n  _applyDefaultSQLAfterAlteringData: function () {\n    var originalQuery = this._defaultSQL();\n    this._codemirrorModel.set({\n      content: originalQuery,\n      errors: []\n    });\n    this._sqlModel.set('content', originalQuery);\n    this._querySchemaModel.set('query_errors', []);\n    this._clearSQLModel.set({ visible: false });\n    this._querySchemaModel.resetDueToAlteredData();\n    this._clearSQL();\n  },\n\n  _clearSQL: function () {\n    var originalQuery = this._defaultSQL();\n    this._codemirrorModel.set({\n      content: originalQuery,\n      errors: []\n    });\n    this._runQuery(originalQuery, this._saveSQL.bind(this));\n  },\n\n  _showErrors: function (model) {\n    var errors = this._querySchemaModel.get('query_errors');\n    var hasErrors = errors && errors.length > 0;\n    this._codemirrorModel.set('errors', this._parseErrors(errors));\n    this._editorModel.set('disabled', hasErrors);\n\n    if (hasErrors) {\n      SQLNotifications.showErrorNotification(this._parseErrors(errors));\n    }\n\n    this._checkClearButton();\n  },\n\n  _parseErrors: function (errors) {\n    return errors.map(function (error) {\n      return {\n        message: error\n      };\n    });\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<form class=\"DatePicker-timers\">\\n  <div class=\"DatePicker-timersField u-rSpace--xl\">\\n    <div class=\"DatePicker-timersInput\" data-fields=\"fromHour\"></div>\\n  </div>\\n  <div class=\"DatePicker-timersField u-rSpace--xl\">\\n    <div class=\"DatePicker-timersInput\" data-fields=\"fromMin\"></div>\\n  </div>\\n  <div class=\"DatePicker-timersField DatePicker-timersField--spaced u-rSpace--xl\">\\n    <div class=\"DatePicker-timersInput\" data-fields=\"toHour\"></div>\\n  </div>\\n  <div class=\"DatePicker-timersField\">\\n    <div class=\"DatePicker-timersInput\" data-fields=\"toMin\"></div>\\n  </div>\\n</form>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar moment = require('moment');\nvar $ = require('jquery');\nvar Utils = require('../../helpers/utils');\nrequire('../form-components/index');\nrequire('datepicker');\nvar datePickerTemplate = require('./date-picker-range-form.tpl');\nvar template = require('./date-picker-range.tpl');\nvar MAX_RANGE = 30;\n\n/**\n * Custom picer for a dates range.\n */\nmodule.exports = CoreView.extend({\n\n  className: 'DatePicker',\n\n  options: {\n    flat: true,\n    date: ['2008-07-31', '2008-07-31'],\n    current: '2008-07-31',\n    calendars: 2,\n    mode: 'range',\n    starts: 1\n  },\n\n  events: {\n    'click .js-dates': '_toggleCalendar',\n    'click .js-fourHours': '_setLastFourHours',\n    'click .js-oneDay': '_setLastDay',\n    'click .js-oneWeek': '_setLastWeek'\n  },\n\n  initialize: function (opts) {\n    this.model = new Backbone.Model({\n      fromDate: '',\n      fromHour: 0,\n      fromMin: 0,\n      toDate: '',\n      toHour: 23,\n      toMin: 59,\n      user_timezone: 0 // Explained as GMT+0\n    });\n\n    this.template = opts.template || template;\n    this._initBinds();\n    this._setDefaultDate();\n  },\n\n  render: function () {\n    var self = this;\n\n    this.clearSubViews();\n\n    this.$el.append(\n      this.template(\n        _.extend(\n          this.model.attributes,\n          {\n            max_days: MAX_RANGE,\n            pad: Utils.pad\n          }\n        )\n      )\n    );\n\n    setTimeout(function () {\n      self._initCalendar();\n      self._hideCalendar();\n      self._initTimers();\n    }, 100);\n\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.bind('change', this._setValues, this);\n    this.model.bind('change', this._onValuesChange, this);\n    $(document).bind('click', this._onDocumentClick.bind(this));\n  },\n\n  _destroyBinds: function () {\n    $(document).unbind('click', this._onDocumentClick.bind(this));\n  },\n\n  _setValues: function (m, c) {\n    var text = _t('components.datepicker.dates-placeholder');\n    var data = this.model.attributes;\n\n    if (data.fromDate && data.toDate) {\n      text =\n        _t('components.datepicker.from') + ' ' +\n        '<strong>' +\n        this.model.get('fromDate') + ' ' +\n        (Utils.pad(this.model.get('fromHour'), 2) + ':' + Utils.pad(this.model.get('fromMin'), 2)) +\n        '</strong>' +\n        ' ' + _t('components.datepicker.to') + ' ' +\n        '<strong>' +\n        this.model.get('toDate') + ' ' +\n        (Utils.pad(this.model.get('toHour'), 2) + ':' + Utils.pad(this.model.get('toMin'), 2)) +\n        '</strong>' +\n        '<i class=\"CDB-IconFont CDB-IconFont-calendar DatePicker-datesIcon\"></i>';\n    }\n\n    this.$('.DatePicker-dates').html(text);\n  },\n\n  _setDefaultDate: function () {\n    var datesUTC = this.model.get('user_timezone');\n    var today = moment().utc(datesUTC);\n    var previous = moment().utc(datesUTC).subtract((MAX_RANGE - 1), 'days');\n    this.options.date = [previous.format('YYYY-MM-DD'), today.format('YYYY-MM-DD')];\n    this.options.current = today.format('YYYY-MM-DD');\n    this._setModelFromPrevious(previous);\n  },\n\n  _initCalendar: function () {\n    var selector = '.DatePicker-calendar';\n\n    // Can't initialize calendar if not already present in document... avoid errors being thrown\n    if (!document.body.contains(this.$(selector)[0])) return;\n\n    this.calendar = this.$(selector).DatePicker(\n      _.extend(this.options, {\n        onChange: this._onDatesChange.bind(this),\n        onRender: function (d) { // Disable future dates and dates < MAX_RANGE days ago\n          var date = d.valueOf();\n          var now = new Date();\n\n          var thirtyDaysAgo = new Date();\n          thirtyDaysAgo.setDate(now.getDate() - MAX_RANGE);\n\n          return (date < thirtyDaysAgo) || (date > now) ? { disabled: true } : '';\n        }\n      })\n    );\n  },\n\n  _onDatesChange: function (formatted, dates) {\n    // Check if selected dates have more than MAX_RANGE days\n    var start = moment(formatted[0]);\n    var end = moment(formatted[1]);\n\n    if (Math.abs(start.diff(end, 'days')) > MAX_RANGE) {\n      formatted[1] = moment(formatted[0]).add('days', MAX_RANGE).format('YYYY-MM-DD');\n      this.$('.DatePicker-calendar').DatePickerSetDate([formatted[0], formatted[1]]);\n    }\n\n    this.model.set({\n      fromDate: formatted[0],\n      toDate: formatted[1]\n    });\n  },\n\n  _hideCalendar: function (e) {\n    if (e) this.killEvent(e);\n    this.$('.DatePicker-dropdown').hide();\n  },\n\n  _toggleCalendar: function (ev) {\n    if (ev) this.killEvent(ev);\n    this.$('.DatePicker-dropdown').toggle();\n  },\n\n  _setLastFourHours: function () {\n    var previous = moment().utc(0).subtract(4, 'hours');\n    this._setModelFromPrevious(previous);\n    this._setDatepickerFromPrevious(previous);\n    this.closeCalendar();\n  },\n\n  _setLastDay: function () {\n    var previous = moment().utc(0).subtract(1, 'day');\n    this._setModelFromPrevious(previous);\n    this._setDatepickerFromPrevious(previous);\n    this.closeCalendar();\n  },\n\n  _setLastWeek: function () {\n    var previous = moment().utc(0).subtract(1, 'week');\n    this._setModelFromPrevious(previous);\n    this._setDatepickerFromPrevious(previous);\n    this.closeCalendar();\n  },\n\n  _setModelFromPrevious: function (previous) {\n    var today = moment().utc(0);\n\n    this.model.set({\n      fromDate: previous.format('YYYY-MM-DD'),\n      fromHour: parseInt(previous.format('H'), 10),\n      fromMin: parseInt(previous.format('m'), 10),\n      toDate: today.format('YYYY-MM-DD'),\n      toHour: parseInt(today.format('H'), 10),\n      toMin: parseInt(today.format('m'), 10)\n    });\n  },\n\n  _setDatepickerFromPrevious: function (previous) {\n    var today = moment().utc(0);\n    this.$('.DatePicker-calendar').DatePickerSetDate([ previous.format('YYYY-MM-DD'), today.format('YYYY-MM-DD') ]);\n  },\n\n  _initTimers: function () {\n    var generateNumberType = function (min, max) {\n      var title = max === 23\n        ? _t('components.datepicker.hour')\n        : _t('components.datepicker.min');\n      return {\n        type: 'Number',\n        title: title,\n        validators: ['required', {\n          type: 'interval',\n          min: min,\n          max: max\n        }]\n      };\n    };\n\n    this.model.schema = {\n      fromHour: generateNumberType(0, 23),\n      fromMin: generateNumberType(0, 59),\n      toHour: generateNumberType(0, 23),\n      toMin: generateNumberType(0, 59)\n    };\n\n    this._datesForm = new Backbone.Form({\n      model: this.model,\n      template: datePickerTemplate\n    });\n\n    this._datesForm.bind('change', function () {\n      this.commit();\n    });\n    this.$('.js-timers').append(this._datesForm.render().el);\n  },\n\n  _onValuesChange: function () {\n    this.trigger('changeDate', this.model.toJSON(), this);\n  },\n\n  getDates: function () {\n    return this.model.toJSON();\n  },\n\n  closeCalendar: function () {\n    this.$('.DatePicker-dropdown').hide();\n  },\n\n  _onDocumentClick: function (e) {\n    var $el = $(e.target);\n\n    if ($el.closest('.DatePicker').length === 0) {\n      this.closeCalendar();\n    }\n  },\n\n  clean: function () {\n    this._datesForm.remove();\n    this._destroyBinds();\n    this.closeCalendar();\n    this.$('.DatePicker-calendar').DatePickerHide();\n    CoreView.prototype.clean.call(this);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<button class=\"DatePicker-dates js-dates has-icon CDB-Text CDB-Size-medium\">\\n  '+\n((__t=( _t('components.datepicker.from') ))==null?'':_.escape(__t))+\n' <strong>'+\n((__t=( fromDate ))==null?'':_.escape(__t))+\n' '+\n((__t=( pad(fromHour,2) ))==null?'':_.escape(__t))+\n':'+\n((__t=( pad(fromMin,2) ))==null?'':_.escape(__t))+\n'</strong> '+\n((__t=( _t('components.datepicker.to') ))==null?'':_.escape(__t))+\n' <strong>'+\n((__t=( toDate ))==null?'':_.escape(__t))+\n' '+\n((__t=( pad(toHour,2) ))==null?'':_.escape(__t))+\n':'+\n((__t=( pad(toMin,2) ))==null?'':_.escape(__t))+\n'</strong>\\n  <i class=\"CDB-IconFont CDB-IconFont-calendar DatePicker-datesIcon\"></i>\\n</button>\\n<div class=\"DatePicker-dropdown CDB-Text\">\\n  <div class=\"DatePicker-calendar\"></div>\\n  <div class=\"DatePicker-timers js-timers\"></div>\\n  <div class=\"DatePicker-shortcuts\">\\n    <p class=\"DatePicker-shortcutsText\">\\n      '+\n((__t=( _t('components.datepicker.get-last') ))==null?'':_.escape(__t))+\n' <button type=\"button\" class=\"Button--link js-fourHours\">'+\n((__t=( _t('components.datepicker.hours-pluralize', { smart_count: 4 }) ))==null?'':_.escape(__t))+\n'</button>,\\n      <button type=\"button\" class=\"Button--link js-oneDay\">'+\n((__t=( _t('components.datepicker.days-pluralize', { smart_count: 1 }) ))==null?'':_.escape(__t))+\n'</button> '+\n((__t=( _t('components.datepicker.or') ))==null?'':_.escape(__t))+\n'\\n      <button type=\"button\" class=\"Button--link js-oneWeek\">'+\n((__t=( _t('components.datepicker.weeks-pluralize', { smart_count: 1 }) ))==null?'':_.escape(__t))+\n'</button>\\n    </p>\\n    <p class=\"DatePicker-shortcutsText\">'+\n((__t=( _t('components.datepicker.gmt-convertion') ))==null?'':_.escape(__t))+\n'</p>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar moment = require('moment');\nvar $ = require('jquery');\nrequire('../form-components/index');\nrequire('datepicker');\nvar template = require('./date-picker.tpl');\n\n/**\n * Custom picer for a dates range.\n */\nmodule.exports = CoreView.extend({\n\n  className: 'DatePicker',\n\n  options: {\n    flat: true,\n    date: '2008-07-31',\n    current: '2008-07-31',\n    calendars: 1,\n    starts: 1\n  },\n\n  events: {\n    'click .js-dates': '_toggleCalendar'\n  },\n\n  initialize: function (opts) {\n    this.template = opts.template || template;\n    this._initBinds();\n    this._setDefaultDate();\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    this.$el.append(this.template({\n      readOnly: this.model.get('readOnly'),\n      date: this.options.date\n    }));\n\n    if (this.model.get('readOnly')) {\n      this.undelegateEvents();\n    }\n\n    return this;\n  },\n\n  _initBinds: function () {\n    $(document).bind('click', this._onDocumentClick.bind(this));\n  },\n\n  _destroyBinds: function () {\n    $(document).unbind('click', this._onDocumentClick.bind(this));\n  },\n\n  _setDefaultDate: function () {\n    var utc = new Date().getTimezoneOffset();\n    var today = moment(new Date()).utcOffset(utc).format('YYYY-MM-DD');\n    this.options.date = this.model.get('value') && moment(this.model.get('value')).format('YYYY-MM-DD') || today;\n    this.options.current = this.options.date;\n  },\n\n  _$calendar: function () {\n    return this.$('.js-calendar');\n  },\n\n  _$dropdown: function () {\n    return this.$('.js-DatePicker-simpleDropdown');\n  },\n\n  _hideCalendar: function (ev) {\n    if (ev) {\n      this.killEvent(ev);\n    }\n    this.model.set('visible', false);\n    this._destroyCalendar();\n    this._$dropdown().hide();\n  },\n\n  _showCalendar: function () {\n    this.model.set('visible', true);\n\n    this._$calendar().DatePicker(\n      _.extend(this.options, this.model.attributes, {\n        onChange: function (formatted, date) {\n          this.model.set('value', formatted);\n          this.$('.js-date-str').text(formatted);\n          this._hideCalendar();\n        }.bind(this),\n        onRender: function (d) { // Disable future dates and dates\n          var date = d.valueOf();\n          var now = new Date();\n\n          return (date > now) ? { disabled: true } : '';\n        }\n      })\n    );\n\n    this._$dropdown().show();\n  },\n\n  _destroyCalendar: function () {\n    if (this.$('.DatePicker').length > 0) {\n      this._$calendar() && this._$calendar().DatePickerHide();\n    }\n  },\n\n  _toggleCalendar: function (ev) {\n    if (ev) {\n      this.killEvent(ev);\n    }\n\n    this.model.get('visible') ? this._hideCalendar() : this._showCalendar();\n  },\n\n  closeCalendar: function () {\n    this._hideCalendar();\n  },\n\n  _onDocumentClick: function (e) {\n    var $el = $(e.target);\n\n    if ($el.closest('.DatePicker').length === 0) {\n      this._hideCalendar();\n    }\n  },\n\n  clean: function () {\n    this._destroyBinds();\n    this._hideCalendar();\n    CoreView.prototype.clean.call(this);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<button class=\"js-dates DatePicker-dates DatePicker-dates--singleDate js-DatePicker-dates has-icon ';\n if (readOnly) { \n__p+=' is-disabled ';\n } \n__p+='\">\\n  <strong class=\"js-date-str\">'+\n((__t=( date ))==null?'':_.escape(__t))+\n'</strong>\\n  <i class=\"CDB-IconFont CDB-IconFont-calendar DatePicker-datesIcon\"></i>\\n</button>\\n<div class=\"DatePicker-simpleDropdown datepickerHidden js-DatePicker-simpleDropdown\">\\n  <div class=\"js-calendar DatePicker-calendar DatePicker-calendar--simple\"></div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar moment = require('moment');\n\n/**\n *  Default model for each field model\n *\n */\n\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    attribute: '',\n    value: '',\n    type: 'string',\n    readOnly: false\n  },\n\n  initialize: function () {\n    // Validation control variable\n    this.validationError = '';\n    this.bind('valid', function () {\n      this.validationError = '';\n    }, this);\n    this.bind('error', function (m, error) {\n      this.validationError = error;\n    });\n  },\n\n  _validate: function (attrs, options) {\n    var valid = Backbone.Model.prototype._validate.apply(this, arguments);\n    if (valid) {\n      this.trigger('valid');\n      return true;\n    } else {\n      return false;\n    }\n  },\n\n  validate: function (attrs) {\n    if (!attrs) return;\n\n    var val = attrs.value;\n    var type = attrs.type;\n\n    if (attrs.type === 'number') {\n      var pattern = /^(\\+|-)?(?:[0-9]+|[0-9]*\\.[0-9]+)$/;\n      if (val && !pattern.test(val)) {\n        return 'Invalid number';\n      }\n    }\n\n    if (type === 'boolean') {\n      if (val !== null && val !== true && val !== false) {\n        return 'Invalid boolean';\n      }\n    }\n\n    if (type === 'date') {\n      if (val && !moment(val).isValid()) {\n        return 'Invalid date';\n      }\n    }\n  },\n\n  getError: function () {\n    return this.validationError;\n  },\n\n  isValid: function () {\n    if (!this.validate) {\n      return true;\n    }\n    return !this.validate(this.attributes) && this.validationError === '';\n  }\n\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar cdb = require('cartodb.js');\nvar baseTemplate = require('./error.tpl');\n\n/**\n * A typical error view.\n * @param {Object} options\n * @param {String} options.title If not provided will use a generic text as fallback\n * @param {String} options.desc If not provied will use a generic text as fallback\n */\nmodule.exports = CoreView.extend({\n\n  className: 'IntermediateInfo',\n\n  initialize: function (opts) {\n    var attrs = _.defaults(\n      _.pick(opts, ['title', 'desc']),\n      {\n        title: _t('components.error.default-title'),\n        desc: _t('components.error.default-desc')\n      }\n    );\n    this._template = this.options && this.options.template || baseTemplate;\n    this.model = new Backbone.Model(attrs);\n  },\n\n  render: function () {\n    this.$el.html(this._html());\n    return this;\n  },\n\n  _html: function () {\n    var m = this.model;\n    return this._template({\n      title: m.get('title'),\n      desc: cdb.core.sanitize.html(m.get('desc'))\n    });\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"LayoutIcon LayoutIcon--negative\">\\n  <i class=\"CDB-IconFont CDB-IconFont-cockroach\"></i>\\n</div>\\n<h3 class=\"CDB-Text CDB-Size-large u-mainTextColor u-errorTextColor u-bSpace--m u-tSpace-xl\">'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</h3>\\n<p class=\"CDB-Text CDB-Size-medium u-altTextColor\">'+\n((__t=( desc ))==null?'':__t)+\n'</p>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar $ = require('jquery');\nvar ESC_KEY_CODE = 27;\n\nBackbone.Form.editors.Base = Backbone.Form.editors.Base.extend({\n\n  applyESCBind: function (callback) {\n    this._ESCBindCallback = callback;\n    document.addEventListener('keydown', this._onKeyDown.bind(this));\n  },\n\n  _onKeyDown: function (ev) {\n    var anyModalOpen;\n    if (ev.which === ESC_KEY_CODE) {\n      anyModalOpen = this._anyModalOpen();\n      !anyModalOpen && this._ESCBindCallback();\n    }\n  },\n\n  applyClickOutsideBind: function (callback) {\n    this._clickBindCallback = callback;\n    this.$el.attr('data-cid', this.cid);\n    document.addEventListener('click', this._onDocumentClick.bind(this));\n  },\n\n  _onDocumentClick: function (e) {\n    var $el = $(e.target);\n    var anyModalOpen = this._anyModalOpen();\n    if ($el.closest('[data-cid=\"' + this.cid + '\"]').length === 0 && !anyModalOpen) {\n      this._clickBindCallback();\n    }\n  },\n\n  _anyModalOpen: function () {\n    var modals = this.options.modals;\n    if (!modals) {\n      return false;\n    }\n\n    return modals.isOpen();\n  },\n\n  remove: function () {\n    if (this._ESCBindCallback) {\n      document.removeEventListener('keydown', this._onKeyDown.bind(this));\n    }\n    if (this._clickBindCallback) {\n      document.removeEventListener('click', this._onDocumentClick.bind(this));\n    }\n    Backbone.View.prototype.remove.call(this);\n  }\n\n});\n",
    "var $ = require('jquery');\nvar Backbone = require('backbone');\nvar FactoryHints = require('../../../editor/editor-hints/factory-hints');\nvar CodeMirrorView = require('../../code-mirror/code-mirror-view');\n\nBackbone.Form.editors.CodeEditor = Backbone.Form.editors.TextArea.extend({\n  render: function () {\n    this.setValue(this.value);\n\n    this._codemirrorModel = new Backbone.Model({\n      content: this.value,\n      readonly: false,\n      lineNumbers: false\n    });\n\n    FactoryHints.init({\n      tokens: this.options.tokens,\n      tableName: false,\n      columnsName: false\n    });\n\n    this._initViews();\n\n    this._toggleDisableState();\n\n    return this;\n  },\n\n  getValue: function () {\n    var val = this.$el.val();\n\n    val = this.codeMirrorView.getContent();\n\n    return (val === '') ? null : val;\n  },\n\n  _initViews: function () {\n    this._destroyEditor();\n\n    var hints = FactoryHints.reset().hints;\n    this.codeMirrorView = new CodeMirrorView({\n      model: this._codemirrorModel,\n      hints: hints,\n      mode: 'text/mustache',\n      autocompleteChars: 2,\n      autocompletePrefix: '{{',\n      autocompleteSuffix: '}}',\n      placeholder: this.options.placeholder,\n      tip: ''\n    });\n    this.codeMirrorView.bind('codeChanged', function () {\n      this.trigger('change', this.codeMirrorView.getContent());\n    }, this);\n\n    var $codeMirrorEl = $(this.codeMirrorView.render().el);\n    this.$el.replaceWith($codeMirrorEl);\n    this.setElement($codeMirrorEl);\n    this.$el.addClass('CodeMirror-formInput');\n    // The default el is replace it with another dom node\n    // we should add tracking class manually again\n    this._addTrackingClass();\n  },\n\n  _addTrackingClass: function () {\n    if (this.options.trackingClass) {\n      var trackClasses = this.options.trackingClass + ' track-' + this.options.key + this.options.editorType;\n      this.$el.addClass(trackClasses);\n    }\n  },\n\n  _hasEditor: function () {\n    return this.options.editor && !!this.codeMirrorView;\n  },\n\n  _destroyEditor: function () {\n    if (this._hasEditor()) {\n      this.codeMirrorView.remove();\n    }\n  },\n\n  remove: function () {\n    this._destroyEditor();\n    Backbone.Form.editors.Base.prototype.remove.apply(this);\n  },\n\n  clean: function () {\n    this.$el.remove();\n  }\n});\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar checkAndBuildOpts = require('../../../../helpers/required-opts');\nvar StackLayoutView = require('../../../../components/stack-layout/stack-layout-view');\nvar MeasurementsView = require('./measurement-list-view');\nvar FiltersView = require('./filter-list-view');\n\nvar REQUIRED_OPTS = [\n  'measurementsCollection',\n  'filtersCollection'\n];\n\nmodule.exports = CoreView.extend({\n  className: 'CDB-Box-modal CustomList',\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    // For internal state\n    this.model = new Backbone.Model({\n      visible: false\n    });\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this._generateStackLayoutView();\n    return this;\n  },\n\n  _initBinds: function () {\n    this.listenTo(this.model, 'change:visible', function (mdl, isVisible) {\n      isVisible ? this.render() : this.clearSubViews();\n      this._toggleVisibility();\n    });\n  },\n\n  _generateStackLayoutView: function () {\n    var self = this;\n\n    var stackViewCollection = new Backbone.Collection([{\n      createStackView: function (stackLayoutModel, opts) {\n        return self._createListView(stackLayoutModel, opts).bind(self);\n      }\n    }, {\n      createStackView: function (stackLayoutModel, opts) {\n        return self._createFilterView(stackLayoutModel, opts).bind(self);\n      }\n    }]);\n\n    this._stackLayoutView = new StackLayoutView({ collection: stackViewCollection });\n    this.addView(this._stackLayoutView);\n    this.$el.append(this._stackLayoutView.render().$el);\n  },\n\n  _createListView: function (stackLayoutModel, opts) {\n    var view = new MeasurementsView({\n      measurementsCollection: this._measurementsCollection,\n      filtersCollection: this._filtersCollection\n    });\n\n    view.bind('filters', function () {\n      stackLayoutModel.nextStep();\n    }, this);\n\n    return view;\n  },\n\n  _createFilterView: function (stackLayoutModel, opts) {\n    var view = new FiltersView({\n      filtersCollection: this._filtersCollection\n    });\n\n    view.bind('back', function () {\n      stackLayoutModel.prevStep();\n    }, this);\n\n    return view;\n  },\n\n  hide: function () {\n    this.model.set('visible', false);\n  },\n\n  toggle: function () {\n    this.model.set('visible', !this.model.get('visible'));\n  },\n\n  isVisible: function () {\n    return this.model.get('visible');\n  },\n\n  _toggleVisibility: function () {\n    this.$el.toggleClass('is-visible', !!this.isVisible());\n  },\n\n  clean: function () {\n    // Other ops here\n    CoreView.prototype.clean.apply(this, arguments);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='';\n if (typeof isLoading != 'undefined' && isLoading) { \n__p+='\\n  <div class=\"u-flex\">\\n    <div class=\"CDB-LoaderIcon CDB-LoaderIcon--small is-dark\">\\n      <svg class=\"CDB-LoaderIcon-spinner\" viewBox=\"0 0 50 50\">\\n        <circle class=\"CDB-LoaderIcon-path\" cx=\"25\" cy=\"25\" r=\"20\" fill=\"none\"></circle>\\n      </svg>\\n    </div>\\n    <span class=\"u-lSpace u-secondaryTextColor\">'+\n((__t=( _t('components.backbone-forms.select.loading') ))==null?'':_.escape(__t))+\n'</span>\\n  </div>\\n';\n } else { \n__p+='\\n  '+\n((__t=( label ))==null?'':_.escape(__t))+\n'\\n';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar EditorHelpers = require('../editor-helpers-extend');\nvar template = require('./dropdown.tpl');\nvar selectedItemTemplate = require('./dropdown-item.tpl');\nvar DropdownDialogView = require('./dropdown-dialog-view');\nvar PopupManager = require('../../../popup-manager');\nvar MeasurementsCollection = require('./measurements-collection');\nvar FiltersCollection = require('./measurements-filters-collection');\n\nvar ENTER_KEY_CODE = 13;\nvar STATE = {\n  idle: 'idle',\n  loading: 'loading',\n  fetching: 'fetching',\n  fetched: 'fetched',\n  error: 'error'\n};\n\nBackbone.Form.editors.DataObservatoryDropdown = Backbone.Form.editors.Base.extend({\n\n  tagName: 'div',\n  className: 'u-ellipsis Editor-formSelect',\n\n  events: {\n    'click .js-button': '_onButtonClick',\n    'keydown .js-button': '_onButtonKeyDown',\n    'focus .js-button': function () {\n      this.trigger('focus', this);\n    },\n    'blur': function () {\n      this.trigger('blur', this);\n    }\n  },\n\n  options: {\n    selectedItemTemplate: selectedItemTemplate\n  },\n\n  initialize: function (opts) {\n    Backbone.Form.editors.Base.prototype.initialize.call(this, opts);\n    EditorHelpers.setOptions(this, opts);\n\n    this.template = opts.template || template;\n    this.dialogMode = this.options.dialogMode || 'nested';\n\n    var collectionOptions = {\n      configModel: this.options.configModel,\n      layerDefinitionModel: this.options.layerDefinitionModel,\n      country: this.model.get('country') || null\n    };\n\n    this.measurementsCollection = new MeasurementsCollection([], collectionOptions);\n    this.filtersCollection = new FiltersCollection([], collectionOptions);\n\n    this._modelView = new Backbone.Model({\n      state: STATE.idle\n    });\n\n    this._initBinds();\n\n    this._dialogView = new DropdownDialogView({\n      measurementsCollection: this.measurementsCollection,\n      filtersCollection: this.filtersCollection\n    });\n\n    this._fetch();\n  },\n\n  render: function () {\n    var isLoading = this._isLoading();\n    var isEmpty = !this._hasItems();\n    var isDisabled = !isEmpty ? this.options.disabled : true;\n    var name = this.model.get(this.options.keyAttr);\n    var item = this.measurementsCollection.getItem(name);\n    var isNull = name === null;\n    var label = isNull ? 'null' : (item ? item.get('name') : false);\n    var placeholder = this.options.placeholder;\n\n    this.$el.html(\n      this.template({\n        label: label,\n        keyAttr: this.options.keyAttr,\n        placeholder: placeholder,\n        isDisabled: isDisabled,\n        isLoading: isLoading,\n        isEmpty: isEmpty,\n        isNull: isNull\n      })\n    );\n\n    this._popupManager = new PopupManager(this.cid, this.$el, this._dialogView.$el);\n    this._popupManager.append(this.dialogMode);\n\n    return this;\n  },\n\n  _initBinds: function () {\n    var hide = function () {\n      this._dialogView.hide();\n      this._popupManager.untrack();\n    }.bind(this);\n\n    this.applyESCBind(hide);\n    this.applyClickOutsideBind(hide);\n\n    this.listenTo(this.measurementsCollection, 'change:selected', this._onItemSelected);\n    this.listenTo(this._modelView, 'change:state', this.render);\n    this.listenTo(this.model, 'change:country', this._fetch);\n  },\n\n  _fetch: function () {\n    var fetchOptions = {\n      success: this._onFetchSuccess.bind(this),\n      error: this._onFetchError.bind(this)\n    };\n\n    this.measurementsCollection.fetch(fetchOptions);\n    this.filtersCollection.fetch(fetchOptions);\n    this._modelView.set({state: STATE.loading});\n\n    this.setValue(this.model.get(this.options.keyAttr));\n  },\n\n  _onFetchSuccess: function () {\n    var measurementsReady = this.measurementsCollection.getState() === STATE.fetched;\n    var filtersReady = this.filtersCollection.getState() === STATE.fetched;\n\n    if (filtersReady && measurementsReady) {\n      this._modelView.set({state: STATE.fetched});\n    }\n  },\n\n  _onFetchError: function () {\n    this._modelView.set({state: STATE.error});\n  },\n\n  _hasItems: function () {\n    var state = this.measurementsCollection.getState();\n    return state === STATE.fetched && this.measurementsCollection.filter(function (mdl) {\n      var filter = mdl.get('filter');\n      return filter.length > 0;\n    }).length > 0;\n  },\n\n  _isLoading: function () {\n    var state = this.measurementsCollection.getState();\n    return state === STATE.fetching;\n  },\n\n  _onItemSelected: function (mdl) {\n    this._dialogView.hide();\n    this._popupManager.untrack();\n    this._renderButton(mdl).focus();\n    this.trigger('change', this);\n  },\n\n  _onButtonClick: function () {\n    if (this._hasItems()) {\n      this._dialogView.toggle();\n      this._dialogView.isVisible() ? this._popupManager.track() : this._popupManager.untrack();\n    }\n  },\n\n  _onButtonKeyDown: function (ev) {\n    if (ev.which === ENTER_KEY_CODE) {\n      ev.preventDefault();\n      if (!this._dialogView.isVisible()) {\n        ev.stopPropagation();\n        this._onButtonClick();\n      } else {\n        this._popupManager.track();\n      }\n    }\n  },\n\n  getValue: function () {\n    var item = this.measurementsCollection.getSelectedItem();\n    if (item) {\n      return item.getName();\n    }\n    return;\n  },\n\n  setValue: function (value) {\n    var selectedModel = this.measurementsCollection.setSelected(value);\n    if (selectedModel) {\n      this._renderButton(selectedModel);\n    }\n    this.value = value;\n  },\n\n  _renderButton: function (mdl) {\n    var button = this.$('.js-button');\n    var $html = this.options.selectedItemTemplate({\n      label: mdl.getName()\n    });\n\n    button\n      .removeClass('is-empty')\n      .html($html);\n\n    return button;\n  },\n\n  remove: function () {\n    this._popupManager && this._popupManager.destroy();\n    this._dialogView && this._dialogView.clean();\n    Backbone.Form.editors.Base.prototype.remove.call(this);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CDB-InputText CDB-Text is-cursor js-button u-ellipsis\\n  ';\n if (isDisabled) { \n__p+=' is-disabled ';\n } \n__p+='\\n  ';\n if (!label) { \n__p+=' is-empty ';\n } \n__p+='\\n  ';\n if (isNull) { \n__p+=' is-empty ';\n } \n__p+='\"\\n  tabindex=\"0\">\\n  ';\n if (isLoading) { \n__p+='\\n    <div class=\"CDB-LoaderIcon CDB-LoaderIcon--small is-dark u-iBlock\">\\n      <svg class=\"CDB-LoaderIcon-spinner\" viewBox=\"0 0 50 50\">\\n        <circle class=\"CDB-LoaderIcon-path\" cx=\"25\" cy=\"25\" r=\"20\" fill=\"none\"></circle>\\n      </svg>\\n    </div>\\n    <span class=\"u-lSpace u-secondaryTextColor\">'+\n((__t=( _t('components.backbone-forms.select.loading') ))==null?'':_.escape(__t))+\n'</span>\\n  ';\n } else { \n__p+='\\n    ';\n if (isEmpty) { \n__p+='\\n      '+\n((__t=( _t('components.backbone-forms.select.empty') ))==null?'':_.escape(__t))+\n'\\n    ';\n } else { \n__p+='\\n      '+\n((__t=( placeholder || label || _t('components.backbone-forms.select.placeholder', { keyAttr: keyAttr }) ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n  ';\n } \n__p+='\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar CustomListMultiItemView = require('../../../custom-list/custom-list-multi-item-view');\n\nvar NAME = _.template('<%-name %> (<%- items %>)');\n\nmodule.exports = CustomListMultiItemView.extend({\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n\n    var name = this.model.getName() == null ? 'null' : this.model.getName();\n    name = name.replace(/\"/g, '');\n\n    this.$el.append(\n      this.options.template(\n        _.extend({\n          isSelected: this.model.get('selected'),\n          isDisabled: this.model.get('disabled'),\n          name: NAME({\n            name: name,\n            items: this.model.get('items')\n          }),\n          val: this.model.getValue(),\n          description: this.model.get('description')\n        })\n      )\n    );\n\n    this.$el\n      .attr('data-val', this.model.getValue())\n      .toggleClass('is-disabled', !!this.model.get('disabled'));\n\n    return this;\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<button type=\"button\" class=\"CDB-ListDecoration-itemLink\\n  ';\n if (isSelected) { \n__p+=' is-selected ';\n } \n__p+='\\n  \" title=\"'+\n((__t=( name ))==null?'':_.escape(__t))+\n'\">\\n  <div class=\"u-flex\">\\n    <div class=\"u-iBlock u-rSpace--m\">\\n      <input class=\"CDB-Checkbox js-input\" type=\"checkbox\" name=\"\" value=\"\" ';\n if (isSelected) { \n__p+='checked';\n } \n__p+=' ';\n if (isDisabled) { \n__p+='disabled';\n } \n__p+=' />\\n      <span class=\"u-iBlock CDB-Checkbox-face\"></span>\\n    </div>\\n    <div>\\n      <div class=\"u-bSpace\">'+\n((__t=( name ))==null?'':_.escape(__t))+\n'</div>\\n      <div class=\"CDB-Size-small u-altTextColor\">'+\n((__t=( description ))==null?'':_.escape(__t))+\n'</div>\\n    </div>\\n  </div>\\n</button>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar CustomListView = require('../../../custom-list/custom-view');\nvar CustomListItemView = require('./filter-list-item-view');\nvar itemListTemplate = require('./filter-list-item.tpl');\nvar template = require('./filter-list-view.tpl');\nvar checkAndBuildOpts = require('../../../../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'filtersCollection'\n];\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-back': '_onClickBack'\n  },\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    this._initBinds();\n\n    this._listView = new CustomListView({\n      className: 'DO-Filters',\n      typeLabel: _t('components.backbone-forms.data-observatory.dropdown.filter.filters'),\n      showSearch: false,\n      collection: this._filtersCollection,\n      itemTemplate: itemListTemplate,\n      itemView: CustomListItemView\n    });\n\n    this.addView(this._listView);\n  },\n\n  render: function () {\n    this.$el.append(template({\n      headerTitle: _t('components.backbone-forms.data-observatory.dropdown.filter.header')\n    }));\n\n    this.$('.js-content').append(this._listView.render().$el);\n\n    return this;\n  },\n\n  _onClickBack: function (e) {\n    this.killEvent(e);\n    this.trigger('back', this);\n  },\n\n  _initBinds: function () {\n    this.listenTo(this._filtersCollection, 'change:selected', this._onSelectItem, this);\n  },\n\n  _onSelectItem: function (item) {\n    this.trigger('selectItem', item, this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CDB-Box-modalHeader\">\\n  <ul class=\"CDB-Box-modalHeaderItem CDB-Box-modalHeaderItem--block CDB-Box-modalHeaderItem--paddingHorizontal\">\\n    <li class=\"CDB-ListDecoration-item CDB-ListDecoration-itemPadding--vertical CDB-Text CDB-Size-medium u-secondaryTextColor\">\\n      <button class=\"u-actionTextColor js-back u-rSpace\">\\n        <i class=\"CDB-IconFont CDB-IconFont-arrowPrev Size-large\"></i>\\n      </button>\\n      '+\n((__t=( headerTitle))==null?'':_.escape(__t))+\n'\\n    </li>\\n  </ul>\\n</div>\\n<div class=\"js-content\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar BaseView = require('../../../custom-list/custom-list-item-view');\n\nmodule.exports = BaseView.extend({\n  render: function () {\n    this.$el.empty();\n    this.clearSubViews();\n\n    var name = this.model.getName() == null ? 'null' : this.model.getName();\n\n    this.$el.append(\n      this.options.template(\n        _.extend({\n          isSelected: this.model.get('selected'),\n          isDisabled: this.model.get('disabled'),\n          name: name,\n          val: this.model.getValue(),\n          description: this.model.get('description')\n        })\n      )\n    );\n\n    this.$el\n      .attr('data-val', this.model.getValue())\n      .toggleClass('is-disabled', !!this.model.get('disabled'));\n\n    return this;\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<button type=\"button\" class=\"CDB-ListDecoration-itemLink\\n    ';\n if (isSelected) { \n__p+=' is-selected ';\n } \n__p+='\\n  \" title=\"'+\n((__t=( name ))==null?'':_.escape(__t))+\n'\">\\n  <div class=\"u-bSpace\">'+\n((__t=( name ))==null?'':_.escape(__t))+\n'</div>\\n  <div class=\"CDB-Size-small u-altTextColor\">'+\n((__t=( description ))==null?'':_.escape(__t))+\n'</div>\\n</button>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CDB-Box-modalHeaderItem\">\\n  <div  class=\"u-flex u-grow\">\\n    <div class=\"u-flex u-grow\">\\n      <input type=\"text\" name=\"text\" autocomplete=\"off\" placeholder=\"'+\n((__t=( searchPlaceholder ))==null?'':_.escape(__t))+\n'\" class=\"CDB-InputTextPlain CDB-Text js-search\">\\n      <button type=\"button\" style=\"display:none\" class=\"u-lSpace--xl u-rSpace--xl js-clear\">\\n        <div class=\"CDB-Shape\">\\n          <div class=\"CDB-Shape-close is-blue is-large\"></div>\\n        </div>\\n      </button>\\n    </div>\\n\\n    <div>\\n      <button class=\"CDB-Text CDB-Size-medium u-actionTextColor js-filters u-rSpace--m\">'+\n((__t=( _t('analyses.data-observatory-measure.filters') ))==null?'':_.escape(__t))+\n'</button>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar CustomListCollection = require('../../../custom-list/custom-list-collection');\nvar CustomListView = require('../../../custom-list/custom-view');\nvar CustomListItemView = require('./measurement-list-item-view');\nvar itemListTemplate = require('./measurement-list-item.tpl');\nvar checkAndBuildOpts = require('../../../../helpers/required-opts');\nvar searchTemplate = require('./measurement-list-search.tpl');\n\nvar REQUIRED_OPTS = [\n  'measurementsCollection',\n  'filtersCollection'\n];\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-filters': '_onClickFilters'\n  },\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    this._initCollection();\n    this._initBinds();\n\n    this._listView = new CustomListView({\n      className: 'DO-Measurements',\n      typeLabel: _t('components.backbone-forms.data-observatory.dropdown.measurement.type'),\n      showSearch: true,\n      itemView: CustomListItemView,\n      searchTemplate: searchTemplate,\n      collection: this.collection,\n      itemTemplate: itemListTemplate,\n      searchPlaceholder: _t('components.backbone-forms.data-observatory.dropdown.measurement.search')\n    });\n\n    this.addView(this._listView);\n  },\n\n  render: function () {\n    this.$el.append(this._listView.render().$el);\n    return this;\n  },\n\n  _initCollection: function () {\n    var filtersApplied = _.map(this._filtersCollection.getSelected(), function (mdl) {\n      return mdl.getValue();\n    });\n    var measurements = this._measurementsCollection.filter(function (mdl) {\n      var filters = mdl.get('filter');\n      // if filters applied, we look for hits\n      // if not, we check if measurement has filter\n      if (filtersApplied.length > 0) {\n        return _.some(filters, function (filter) {\n          return filtersApplied.indexOf(filter.id) >= 0;\n        });\n      } else {\n        return filters.length > 0;\n      }\n    });\n\n    this.collection = new CustomListCollection(_.map(measurements, function (measurement) {\n      return measurement.attributes;\n    }));\n  },\n\n  _onClickFilters: function (e) {\n    this.killEvent(e);\n    this.trigger('filters');\n  },\n\n  _initBinds: function () {\n    this.listenTo(this.collection, 'change:selected', this._onSelectItem);\n  },\n\n  _onSelectItem: function (item) {\n    this._measurementsCollection.setSelected(item.getValue());\n  }\n});\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar cdb = require('cartodb.js');\nvar errorParse = require('../../../../helpers/error-parser');\nvar checkAndBuildOpts = require('../../../../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'configModel',\n  'layerDefinitionModel'\n];\n\nmodule.exports = Backbone.Collection.extend({\n  initialize: function (models, options) {\n    checkAndBuildOpts(options, REQUIRED_OPTS, this);\n    this._country = options.country || 'NULL';\n    this._querySchemaModel = this._layerDefinitionModel.getAnalysisDefinitionNodeModel().querySchemaModel;\n\n    var configModel = options.configModel;\n    this.SQL = new cdb.SQL({\n      user: configModel.get('user_name'),\n      sql_api_template: configModel.get('sql_api_template'),\n      api_key: configModel.get('api_key')\n    });\n\n    this._state = 'unfetched';\n  },\n\n  fetch: function (options) {\n    this._success = options && options.success;\n    this._error = options && options.error;\n    var table = this._layerDefinitionModel.getTableName();\n    var query = this._querySchemaModel.get('query');\n\n    var sqlQuery = this._queryTemplate({\n      table: table,\n      query: query,\n      country: this._country\n    });\n\n    if (!this.isFetching()) {\n      this._state = 'fetching';\n      this.SQL.execute(sqlQuery, null, {\n        success: function (data) {\n          this._state = 'fetched';\n          this._onFetchSuccess(data);\n          this._success && this._success();\n        }.bind(this),\n        error: function (err) {\n          this._state = 'error';\n          this._error && this._error(errorParse(err));\n        }.bind(this)\n      });\n    }\n  },\n\n  _onFetchSuccess: function (data) {\n    var models = data.rows;\n    this.reset(models);\n  },\n\n  isFetching: function () {\n    return this.getState() === 'fetching';\n  },\n\n  getState: function () {\n    return this._state;\n  },\n\n  // these methods below is to use this collection as base collection for custom list view.\n  getSelectedItem: function () {\n    return _.first(this.getSelected());\n  },\n\n  getSelected: function () {\n    return this.filter(function (mdl) {\n      return mdl.get('selected') === true;\n    });\n  },\n\n  removeSelected: function () {\n    this.each(function (mdl) {\n      mdl.set({\n        selected: false\n      });\n    });\n  }\n});\n",
    "var _ = require('underscore');\nvar BaseCollection = require('./measurements-base-collection');\nvar BaseModel = require('../../../custom-list/custom-list-item-model');\n\nvar MEASUREMENTS_QUERY = 'SELECT * FROM OBS_GetAvailableNumerators((SELECT ST_SetSRID(ST_Extent(the_geom), 4326) FROM (<%- query %>) q), <%- country %>) numers';\n\nmodule.exports = BaseCollection.extend({\n  initialize: function (models, options) {\n    this._queryTemplate = _.template(MEASUREMENTS_QUERY);\n    BaseCollection.prototype.initialize.call(this, models, options);\n  },\n\n  model: function (attrs, opts) {\n    var o = {};\n    // label and val to custom list compatibility\n    o.val = attrs.numer_id;\n    o.label = attrs.numer_name;\n    o.description = attrs.numer_description;\n    // a measurement can belong to more than one category (filter)\n    o.filter = [];\n    var tags = JSON.parse(attrs.numer_tags);\n    for (var key in tags) {\n      if (/^subsection/.test(key)) {\n        o.filter.push({\n          id: key,\n          name: tags[key]\n        });\n      }\n\n      if (/^license/.test(key)) {\n        o.license = tags[key];\n      }\n    }\n\n    return new BaseModel(o);\n  },\n\n  getItem: function (value) {\n    return this.findWhere({ val: value });\n  },\n\n  setSelected: function (value) {\n    var selectedModel;\n    var silent = { silent: true };\n\n    this.each(function (mdl) {\n      if (mdl.getValue() === value) {\n        mdl.set({\n          selected: true\n        });\n        selectedModel = mdl;\n      } else {\n        mdl.set({\n          selected: false\n        }, silent);\n      }\n    });\n    return selectedModel;\n  }\n});\n",
    "var _ = require('underscore');\nvar BaseCollection = require('./measurements-base-collection');\nvar BaseModel = require('../../../custom-list/custom-list-item-model');\n\nvar FILTERS_QUERY = \"SELECT count(*) num_measurements, tag.key subsection_id, tag.value subsection_name FROM OBS_GetAvailableNumerators((SELECT ST_SetSRID(ST_Extent(the_geom), 4326) FROM (<%- query %>) q), <%- country %>) numers, Jsonb_Each(numers.numer_tags) tag WHERE tag.key like 'subsection%' GROUP BY tag.key, tag.value\";\n\nmodule.exports = BaseCollection.extend({\n  initialize: function (models, options) {\n    this._queryTemplate = _.template(FILTERS_QUERY);\n    BaseCollection.prototype.initialize.call(this, models, options);\n  },\n\n  model: function (attrs, opts) {\n    // label and val to custom list compatibility\n    var o = {};\n    o.val = attrs.subsection_id;\n    o.label = attrs.subsection_name;\n    o.items = attrs.num_measurements;\n\n    return new BaseModel(o);\n  },\n\n  setSelected: function (value) {\n    var silentTrue = { silent: true };\n\n    if (_.isArray(value)) {\n      this.each(function (mdl) {\n        if (_.contains(value, mdl.getValue())) {\n          mdl.set({\n            selected: true\n          }, silentTrue);\n        } else {\n          mdl.set({\n            selected: false\n          }, silentTrue);\n        }\n      });\n    } else {\n      this.each(function (mdl) {\n        if (mdl.getValue() === value) {\n          mdl.set({\n            selected: true\n          }, silentTrue);\n        } else {\n          mdl.set({\n            selected: false\n          }, silentTrue);\n        }\n      });\n    }\n  },\n\n  search: function () {\n    return _(this.models);\n  },\n\n  containsValue: function (value) {\n    return this.length > 0;\n  }\n});\n",
    "var Backbone = require('backbone');\n\n/**\n * View model of the fill dialog\n */\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    show: false\n  },\n\n  show: function () {\n    this.set('show', true);\n  },\n\n  hide: function () {\n    this.set('show', false);\n  },\n\n  isHidden: function () {\n    return !this.get('show');\n  },\n\n  /**\n   * @override {Backbone.Model.prototype.destroy}\n   */\n  destroy: function () {\n    var args = Array.prototype.slice.call(arguments);\n    this.trigger.apply(this, ['destroy'].concat(args));\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar DatetimeEditorView = require('./datetime-editor-view');\n\nmodule.exports = CoreView.extend({\n\n  className: 'CDB-Box-modal CustomList CustomList--inputs is-visible has-visibility js-datetimePicker',\n\n  initialize: function () {\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    this._datetimeEditorView = new DatetimeEditorView({\n      model: this.model\n    });\n    this.addView(this._datetimeEditorView);\n    this.$el.append(this._datetimeEditorView.render().el);\n\n    return this;\n  },\n\n  _initBinds: function () {\n    this.listenTo(this.model, 'change:show', this._onShowChange);\n    this.listenTo(this.model, 'destroy', this._onDestroy);\n  },\n\n  _onShowChange: function (mdl, show) {\n    if (show) {\n      this.$el.show();\n      this.$el.removeClass('is-closing').addClass('is-opening');\n    } else {\n      this.$el.removeClass('is-opening').addClass('is-closing');\n      this.$el.hide();\n    }\n  },\n\n  show: function () {\n    this.model.show();\n  },\n\n  hide: function () {\n    this.model.hide();\n  },\n\n  _onDestroy: function () {\n    this.hide();\n    this.clean();\n  }\n});\n",
    "var Backbone = require('backbone');\nvar Utils = require('../../../../helpers/utils');\nvar moment = require('moment');\n\nvar MONTHS = [\n  {\n    val: 0,\n    label: _t('months.january')\n  }, {\n    val: 1,\n    label: _t('months.february')\n  }, {\n    val: 2,\n    label: _t('months.march')\n  }, {\n    val: 3,\n    label: _t('months.april')\n  }, {\n    val: 4,\n    label: _t('months.may')\n  }, {\n    val: 5,\n    label: _t('months.june')\n  }, {\n    val: 6,\n    label: _t('months.july')\n  }, {\n    val: 7,\n    label: _t('months.august')\n  }, {\n    val: 8,\n    label: _t('months.september')\n  }, {\n    val: 9,\n    label: _t('months.october')\n  }, {\n    val: 10,\n    label: _t('months.november')\n  }, {\n    val: 11,\n    label: _t('months.december')\n  }\n];\n\nmodule.exports = Backbone.Model.extend({\n\n  initialize: function () {\n    this.schema = {\n      day: {\n        type: 'Text',\n        title: '',\n        validators: [\n          'required',\n          /^(([0]?[1-9])|([1-2][0-9])|(3[01]))$/,\n          function (value, formValues) {\n            var date = moment(Utils.formatDate(formValues));\n            if (!date.isValid()) {\n              return {\n                type: 'date',\n                message: _t('components.datepicker.invalid-date')\n              };\n            }\n          }\n        ]\n      },\n      month: {\n        type: 'Select',\n        title: '',\n        position: {\n          'left': 0,\n          'min-width': '200px'\n        },\n        options: MONTHS\n      },\n      year: {\n        title: '',\n        type: 'Text',\n        validators: ['required', /^([0-9]{0,4})$/]\n      },\n      time: {\n        title: '',\n        type: 'Text',\n        validators: ['required', /^([01]{1}[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]$/]\n      }\n    };\n  },\n\n  getFormattedDate: function () {\n    return Utils.formatDate(this.toJSON());\n  }\n});\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar moment = require('moment');\nvar DatetimeEditorModel = require('./datetime-editor-model');\n\nmodule.exports = CoreView.extend({\n\n  tagName: 'div',\n  className: 'Table-editorDate',\n\n  events: {\n    'keyup': '_onKeyUp'\n  },\n\n  initialize: function () {\n    var dateAttr = this.model.get('value');\n    var date = {};\n\n    if (!dateAttr) {\n      date = moment().utc();\n    } else {\n      date = moment(dateAttr).utc();\n    }\n\n    this._formModel = new DatetimeEditorModel({\n      day: date.date(),\n      month: date.month(),\n      year: date.year(),\n      time: date.format('HH:mm:ss'),\n      utcOffset: date.utcOffset()\n    });\n    this._formModel.bind('change', this._setValue, this);\n    this.add_related_model(this._formModel);\n\n    this._setValue();\n  },\n\n  render: function () {\n    this._formView = new Backbone.Form({\n      model: this._formModel\n    });\n\n    this._formView.bind('change', function () {\n      this.commit();\n    });\n\n    this.$el.html(this._formView.render().el);\n\n    return this;\n  },\n\n  _setValue: function () {\n    this.model.set('value', this._formModel.getFormattedDate());\n  },\n\n  _onKeyUp: function () {\n    this._setValue();\n  },\n\n  clean: function () {\n    this._formView.remove();\n    CoreView.prototype.clean.apply(this);\n  }\n\n});\n",
    "var Backbone = require('backbone');\nvar EditorHelpers = require('../editor-helpers-extend');\nvar moment = require('moment');\n\nvar DatetimeDialogModel = require('./datetime-dialog-model');\nvar DatetimeDialogView = require('./datetime-dialog-view');\nvar template = require('./datetime.tpl');\n\nvar PopupManager = require('../../../popup-manager');\n\nBackbone.Form.editors.DateTime = Backbone.Form.editors.Base.extend({\n  className: 'Editor-formInput u-flex u-alignCenter',\n\n  events: {\n    'click .js-input': '_onInputClick'\n  },\n\n  initialize: function (opts) {\n    Backbone.Form.editors.Base.prototype.initialize.call(this, opts);\n    EditorHelpers.setOptions(this, opts);\n\n    this.dialogMode = this.options.dialogMode || 'nested';\n    this._initBinds();\n    this.render();\n  },\n\n  render: function () {\n    Backbone.Form.editors.Base.prototype.render.apply(this, arguments);\n\n    this._removeDateTimeDialog();\n\n    this.$el.html(\n      template({\n        value: this._getFormattedDatetime()\n      })\n    );\n\n    this._initViews();\n\n    return this;\n  },\n\n  _getFormattedDatetime: function () {\n    if (this.value) {\n      var value = new Date(this.value).toUTCString();\n      var momentObj = moment(value).utc();\n      return momentObj.format('YYYY-MM-DD') + 'T' + momentObj.format('HH:mm:ss') + 'Z';\n    }\n\n    // for datetime type, empty '' value raises an error on Postgres\n    return null;\n  },\n\n  _initViews: function () {\n    if (this.options.editorAttrs && this.options.editorAttrs.disabled) {\n      this.$el.addClass('is-disabled');\n    }\n\n    this._datetimeDialogModel = new DatetimeDialogModel({\n      value: this._getFormattedDatetime()\n    });\n    this._datetimeDialogModel.bind('change:value', this._onInputChanged, this);\n\n    this._datetimeDialogView = new DatetimeDialogView({\n      model: this._datetimeDialogModel\n    });\n\n    this._popupManager = new PopupManager(this.cid, this.$el, this._datetimeDialogView.$el);\n  },\n\n  _initBinds: function () {\n    var hide = function () {\n      this._removeDateTimeDialog();\n    }.bind(this);\n    this.applyESCBind(hide);\n    this.applyClickOutsideBind(hide);\n  },\n\n  _onInputClick: function () {\n    this._datetimeDialogView.render();\n    this._popupManager.append(this.dialogMode);\n    this._popupManager.track();\n  },\n\n  _removeDateTimeDialog: function () {\n    if (this._datetimeDialogView) {\n      this._popupManager.untrack();\n      this._datetimeDialogView.remove();\n    }\n  },\n\n  _onInputChanged: function (mdl) {\n    var value = this._datetimeDialogModel.get('value');\n    this.setValue(value);\n\n    this.trigger('change', this);\n  },\n\n  _updateInput: function (value) {\n    this.$('.js-input')\n      .toggleClass('is-empty', !value)\n      .text(value);\n  },\n\n  getValue: function () {\n    return this._datetimeDialogModel.get('value');\n  },\n\n  setValue: function (value) {\n    this._updateInput(value);\n    this.value = value;\n  },\n\n  remove: function () {\n    this._removeDateTimeDialog();\n    this._popupManager && this._popupManager.destroy();\n    Backbone.Form.editors.Base.prototype.remove.apply(this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<button type=\"button\" class=\"CDB-InputText\\n  ';\n if (!value) { \n__p+=' is-empty ';\n } \n__p+='\\n  u-txt-left js-input\">'+\n((__t=( value ? value : 'null' ))==null?'':_.escape(__t))+\n'</button>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\n\nmodule.exports = {\n\n  setOptions: function (editor, opts) {\n    var validators = [];\n\n    if (opts.schema && opts.schema.validators) {\n      validators = validators.concat(opts.schema.validators);\n    }\n\n    if (editor.options && editor.options.validators) {\n      validators = validators.concat(editor.options.validators);\n    }\n\n    editor.validators = validators;\n\n    editor.options = _.extend(\n      {},\n      _.omit(editor.options, 'validators') || {},\n      opts.schema,\n      // 'editorAttrs' can appear in schema if it comes from a Backbone form component\n      // or in options directly if the component is created without a Backbone form\n      opts.schema && opts.schema.editorAttrs || {},\n      opts.editorAttrs,\n      {\n        keyAttr: opts.key\n      },\n      {\n        validators: validators\n      },\n      _.omit(opts, 'validators')\n    );\n\n    if (editor.options.className) {\n      editor.$el.addClass(editor.options.className);\n    }\n\n    if (editor.options.trackingClass) {\n      var trackClasses = editor.options.trackingClass + ' track-' + editor.options.key + editor.options.editorType;\n      editor.$el.addClass(trackClasses);\n    }\n  }\n};\n",
    "var Backbone = require('backbone');\nvar EditorHelpers = require('../editor-helpers-extend');\nvar $ = require('jquery');\nvar _ = require('underscore');\nvar TipsyTooltipView = require('../../../tipsy-tooltip-view');\nvar template = require('./enabler-editor.tpl');\n\n/**\n *  Creates an element that enables another component, tested with:\n *\n *  select, number and input so far.\n */\n\nBackbone.Form.editors.EnablerEditor = Backbone.Form.editors.Base.extend({\n  tagName: 'div',\n  className: 'Editor-checker u-flex u-alignCenter',\n\n  events: {\n    'click .js-check': '_onCheckClicked'\n  },\n\n  initialize: function (opts) {\n    Backbone.Form.editors.Base.prototype.initialize.call(this, opts);\n    EditorHelpers.setOptions(this, opts);\n\n    // Disable validators unless it's enabled\n    this.validators = null;\n\n    if (!this.options.editor) {\n      throw new Error('editor options is required');\n    }\n\n    this._editorOptions = this.options.editor;\n    this.value = this.model.get(opts.key);\n    this._checkModel = new Backbone.Model({\n      enabled: !!this.value\n    });\n    this.template = template;\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.$el.html(\n      this.template({\n        label: this.options.label,\n        isChecked: this._isChecked(),\n        help: this.options.help || ''\n      })\n    );\n\n    if (this.options.help) {\n      this._helpTooltip = new TipsyTooltipView({\n        el: this.$('.js-help'),\n        gravity: 's',\n        offset: 0,\n        title: function () {\n          return $(this).data('tooltip');\n        }\n      });\n    }\n\n    this._renderComponent();\n\n    return this;\n  },\n\n  _initBinds: function () {\n    this._checkModel.bind('change:enabled', function (mdl, isEnabled) {\n      this._manageValue(isEnabled);\n      this._renderComponent();\n      this._triggerChange();\n    }, this);\n  },\n\n  _manageValue: function (isEnabled) {\n    if (isEnabled) {\n      this.validators = this.options.validators;\n      this.value = this.options.defaultValue || '';\n      this._editorComponent.setValue(this.options.defaultValue || '');\n    } else {\n      this.validators = null;\n      this.value = '';\n      this._editorComponent.setValue('');\n    }\n    this.model.set(this.options.keyAttr, this.value);\n    this.validate();\n  },\n\n  _isChecked: function () {\n    return this._checkModel.get('enabled');\n  },\n\n  _renderComponent: function () {\n    if (this._editorComponent) {\n      this._removeComponent();\n    }\n\n    var EditorClass = Backbone.Form.editors[this._editorOptions.type];\n    var editorAttrs = _.extend(\n      this._editorOptions.editorAttrs || {},\n      {\n        disabled: !this._isChecked()\n      }\n    );\n\n    this._editorComponent = new EditorClass(\n      _.extend(\n        {\n          model: this.model,\n          key: this.options.keyAttr,\n          editorAttrs: editorAttrs,\n          trackingClass: this.options.trackingClass,\n          editorType: this._editorOptions.type\n        },\n        _.omit(this._editorOptions, 'editorAttrs', 'type')\n      )\n    );\n    this._editorComponent.bind('change', this._setEditorComponentValue, this);\n    this.$('.js-editor').html(this._editorComponent.render().el);\n\n    // Not all editor implement the focus method\n    try {\n      this._editorComponent.focus();\n    } catch (e) {}\n  },\n\n  _removeComponent: function () {\n    this._editorComponent.remove();\n    this._editorComponent.unbind('change', this._setEditorComponentValue, this);\n  },\n\n  _setEditorComponentValue: function () {\n    this.value = this._editorComponent.getValue();\n    this._triggerChange();\n  },\n\n  _triggerChange: function () {\n    this.trigger('change', this);\n  },\n\n  getValue: function () {\n    if (this._checkModel.get('enabled')) {\n      return this._editorComponent && this._editorComponent.getValue() || '';\n    } else {\n      return '';\n    }\n  },\n\n  setValue: function (value) {\n    this._checkModel.set('enabled', !!value);\n    if (this._editorComponent) {\n      this._editorComponent.setValue(value);\n    }\n    this.value = value;\n  },\n\n  _onCheckClicked: function (ev) {\n    this._checkModel.set('enabled', $(ev.target).is(':checked'));\n  },\n\n  remove: function () {\n    if (this._editorComponent) {\n      this._removeComponent();\n    }\n    if (this._helpTooltip) {\n      this._helpTooltip.clean();\n    }\n    Backbone.Form.editors.Base.prototype.remove.call(this);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex Editor-checkerInput CDB-Text CDB-Size-medium u-rSpace--xl\">\\n  <input class=\"CDB-Checkbox js-check\" type=\"checkbox\" name=\"\" value=\"\" ';\n if (isChecked) { \n__p+='checked';\n } \n__p+='>\\n  <span class=\"CDB-Checkbox-face u-rSpace--m\"></span>\\n  <label class=\"CDB-Text CDB-Size-small u-ellipsis u-upperCase is-semibold u-flex u-alignCenter Editor-formLabel\">\\n    <span class=\"u-ellipsis ';\n if (help) { \n__p+=' js-help is-underlined';\n } \n__p+='\" ';\n if (help) { \n__p+=' data-tooltip=\"'+\n((__t=( help ))==null?'':_.escape(__t))+\n'\"';\n } \n__p+='  title=\"'+\n((__t=( label ))==null?'':_.escape(__t))+\n'\">'+\n((__t=( label ))==null?'':_.escape(__t))+\n'</span>\\n  </label>\\n</div>\\n<div class=\"Editor-checkerComponent js-editor\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<label class=\"CDB-Legend u-upperCase CDB-Text is-semibold CDB-Size-small\">\\n  <div class=\"u-flex u-alignCenter\">\\n    <div class=\"u-iBlock u-rSpace--m\">\\n      <input class=\"CDB-Checkbox js-input\" type=\"checkbox\" name=\"\" value=\"\" ';\n if (checked) { \n__p+='checked';\n } \n__p+=' ';\n if (disabled) { \n__p+='disabled';\n } \n__p+='>\\n      <span class=\"u-iBlock CDB-Checkbox-face\"></span>\\n    </div>\\n    <span class=\"';\n if (help) { \n__p+=' js-help is-underlined';\n } \n__p+='\" ';\n if (help) { \n__p+=' data-tooltip=\"'+\n((__t=( help ))==null?'':_.escape(__t))+\n'\"';\n } \n__p+=' >'+\n((__t=( label ))==null?'':_.escape(__t))+\n'</span>\\n  </div>\\n</label>\\n<div class=\"Editor-checkerComponent js-editor\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar EditorHelpers = require('../editor-helpers-extend');\nvar $ = require('jquery');\nvar TipsyTooltipView = require('../../../tipsy-tooltip-view');\nvar template = require('./enabler.tpl');\nvar templateReversed = require('./enabler-reversed.tpl');\n\nBackbone.Form.editors.Enabler = Backbone.Form.editors.Base.extend({\n  tagName: 'div',\n\n  events: {\n    'change .js-input': '_onCheckChange',\n    'focus .js-input': function () {\n      this.trigger('focus', this);\n    },\n    'blur .js-input': function () {\n      this.trigger('blur', this);\n    }\n  },\n\n  initialize: function (opts) {\n    Backbone.Form.editors.Base.prototype.initialize.call(this, opts);\n    EditorHelpers.setOptions(this, opts);\n\n    this.template = opts.schema && opts.schema.editorAttrs && opts.schema.editorAttrs.reversed ? templateReversed : (opts.template || template);\n    this._initViews();\n  },\n\n  _initViews: function () {\n    this.$el.html(\n      this.template({\n        checked: this.options.disabled ? false : this.model.get(this.options.key),\n        label: this.options.label,\n        title: this.options.title,\n        help: this.options.help || '',\n        disabled: this.options.disabled\n      })\n    );\n\n    if (this.options.help) {\n      this._removeTooltip();\n\n      this._helpTooltip = new TipsyTooltipView({\n        el: this.$('.js-help'),\n        gravity: 's',\n        title: function () {\n          return $(this).data('tooltip');\n        }\n      });\n    }\n\n    if (this.options.disabled) {\n      this.undelegateEvents();\n    }\n  },\n\n  _onCheckChange: function () {\n    var isEnabled = this.$('.js-input').is(':checked');\n    this.model.set('enabler', isEnabled);\n    this.trigger('change', this);\n  },\n\n  getValue: function () {\n    return this.$('.js-input').is(':checked');\n  },\n\n  setValue: function (value) {\n    this.$('.js-input')[value ? 'attr' : 'removeAttr']('checked', '');\n    this.model.set(this.key, value);\n  },\n\n  _removeTooltip: function () {\n    if (this._helpTooltip) {\n      this._helpTooltip.clean();\n    }\n  },\n\n  remove: function () {\n    this._removeTooltip();\n    Backbone.Form.editors.Base.prototype.remove.apply(this);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<label class=\"CDB-Legend u-upperCase CDB-Text is-semibold CDB-Size-small\">\\n  <div class=\"u-flex u-alignCenter\">\\n    <div class=\"u-iBlock u-rSpace--m\">\\n      <input class=\"CDB-Checkbox js-input\" type=\"checkbox\" name=\"\" value=\"\" ';\n if (checked) { \n__p+='checked';\n } \n__p+=' ';\n if (disabled) { \n__p+='disabled';\n } \n__p+='>\\n      <span class=\"u-iBlock CDB-Checkbox-face\"></span>\\n    </div>\\n    <span class=\"';\n if (help) { \n__p+=' js-help is-underlined';\n } \n__p+='\" ';\n if (help) { \n__p+=' data-tooltip=\"'+\n((__t=( help ))==null?'':_.escape(__t))+\n'\"';\n } \n__p+=' >'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</span>\\n  </div>\\n</label>\\n<div class=\"CDB-Text CDB-Size-medium Editor-formInput js-editor\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"colorpicker dropdown-menu\">\\n  <div class=\"colorpicker-saturation\">\\n    <i><b></b></i>\\n  </div>\\n  <div class=\"colorpicker-hue\">\\n    <i class=\"ColorPicker-ball\"></i>\\n  </div>\\n  <div class=\"colorpicker-alpha js-alpha\">\\n    <i class=\"ColorPicker-ball\"></i>\\n  </div>\\n  <div class=\"ColorPicker-colorWrapper\">\\n    <div class=\"ColorPicker-color colorpicker-color js-color\"></div>\\n  </div>\\n</div>';\n}\nreturn __p;\n};\n",
    "var $ = require('jquery');\nvar _ = require('underscore');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nrequire('bootstrap-colorpicker');\nvar template = require('./template.tpl');\nvar colorPickerTemplate = require('./color-picker-template.tpl');\nvar Utils = require('../../../../../helpers/utils');\n\nvar ESCAPE_KEY_CODE = 27;\n\nmodule.exports = CoreView.extend({\n  events: {\n    'blur .js-hex': '_onChangeHex',\n    'blur .js-inputColor': '_onChangeColorValue',\n    'blur .js-a': '_onChangeOpacity'\n  },\n\n  initialize: function (opts) {\n    var opacity = opts.opacity != null ? opts.opacity : 1;\n\n    this.model = new Backbone.Model({\n      hex: opts.value,\n      opacity: opacity\n    });\n\n    this._onEscape = this._onEscapePressed.bind(this);\n    this._initBinds();\n  },\n\n  render: function () {\n    var rgb = Utils.hexToRGB(this.model.get('hex'));\n\n    var color = _.extend(rgb, {\n      hex: this.model.get('hex'),\n      opacity: this.model.get('opacity'),\n      opacityDisabled: this.options.disableOpacity\n    });\n\n    this.$el.append(template(color));\n\n    var rgbaTemplate = _.template('rgba(<%- r %>, <%- g %>, <%- b %>, <%- opacity %>)');\n\n    this.$('.js-colorPicker').colorpicker({\n      color: rgbaTemplate(color),\n      format: 'rgba',\n      container: true,\n      horizontal: true,\n      inline: true,\n      customClass: 'ColorPicker',\n      template: colorPickerTemplate(),\n      slidersHorz: {\n        saturation: {\n          maxLeft: 206,\n          maxTop: 95,\n          callLeft: 'setSaturation',\n          callTop: 'setBrightness'\n        },\n        hue: {\n          maxLeft: 180,\n          maxTop: 0,\n          callLeft: 'setHue',\n          callTop: false\n        },\n        alpha: {\n          maxLeft: 180,\n          maxTop: 0,\n          callLeft: 'setAlpha',\n          callTop: false\n        }\n      }\n    });\n\n    if (this.options.disableOpacity) {\n      this.$('.js-colorPicker .js-alpha').addClass('is-hidden');\n    }\n\n    var setNewColor = function (e) {\n      var rgb = e.color.toRGB();\n      var hex = e.color.toHex();\n      this.model.set({ hex: hex, r: rgb.r, g: rgb.g, b: rgb.b, opacity: rgb.a });\n      this.$('.js-color').css('opacity', rgb.a);\n    }.bind(this);\n\n    this.$('.js-colorPicker').colorpicker().on('changeColor', setNewColor);\n\n    this._initDocumentBinds();\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:hex', this._onChangeColor, this);\n    this.model.bind('change:r', this._onChangeColor, this);\n    this.model.bind('change:g', this._onChangeColor, this);\n    this.model.bind('change:b', this._onChangeColor, this);\n    this.model.bind('change:opacity', this._onChangeColor, this);\n  },\n\n  _onEscapePressed: function (ev) {\n    if (ev.which === ESCAPE_KEY_CODE) {\n      this.remove();\n    }\n  },\n\n  _initDocumentBinds: function () {\n    $(document).on('keydown', this._onEscape);\n  },\n\n  _destroyDocumentBinds: function () {\n    $(document).off('keydown', this._onEscape);\n  },\n\n  _onChangeColor: function () {\n    this.trigger('change', {\n      opacity: this.model.get('opacity'),\n      hex: this.model.get('hex')\n    }, this);\n\n    this.$('.js-hex').val(this.model.get('hex'));\n    this.$('.js-r').val(this.model.get('r'));\n    this.$('.js-g').val(this.model.get('g'));\n    this.$('.js-b').val(this.model.get('b'));\n    this.$('.js-a').val(this.model.get('opacity'));\n  },\n\n  _onChangeOpacity: function () {\n    var opacity = +this.$('.js-a').val();\n    if (_.isNumber(opacity) && opacity >= 0 && opacity <= 1) {\n      this.setColor(this.model.get('hex'), opacity);\n    }\n  },\n\n  _onChangeColorValue: function (e) {\n    this.$(e.target).removeClass('has-error');\n\n    var r = +this.$('.js-r').val();\n    var g = +this.$('.js-g').val();\n    var b = +this.$('.js-b').val();\n\n    var hex = Utils.rgbToHex(r, g, b);\n\n    if (Utils.isValidHex(hex)) {\n      this.setColor(hex);\n    } else {\n      this.$(e.target).addClass('has-error');\n    }\n  },\n\n  _onChangeHex: function (e) {\n    this.$(e.target).removeClass('has-error');\n\n    var hex = this.$('.js-hex').val();\n\n    if (Utils.isValidHex(hex)) {\n      this.setColor(hex);\n    } else {\n      this.$(e.target).addClass('has-error');\n    }\n  },\n\n  setColor: function (hex, opacity) {\n    if (opacity === undefined) {\n      opacity = this.model.get('opacity') || 1;\n    }\n\n    this.$('.js-colorPicker').colorpicker('setValue', Utils.hexToRGBA(hex, opacity));\n  },\n\n  clean: function () {\n    this._destroyDocumentBinds();\n    CoreView.prototype.clean.apply(this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-boxModalContent\">\\n  <div class=\"ColorPicker-pickerWrapper js-colorPicker\"></div>\\n  <div class=\"ColorPicker-inputs\">\\n    <div class=\"ColorPicker-inputWrapper CDB-Text\">\\n      <input type=\"text\" class=\"CDB-Text CDB-InputText ColorPicker-input is-color js-hex\" value=\"'+\n((__t=( hex ))==null?'':_.escape(__t))+\n'\"/>\\n      <span class=\"ColorPicker-inputLabel u-upperCase\">HEX</span>\\n    </div>\\n    <div class=\"ColorPicker-inputWrapper CDB-Text\">\\n      <input type=\"text\" class=\"CDB-Text CDB-InputText ColorPicker-input js-inputColor js-r\" value=\"'+\n((__t=( r ))==null?'':_.escape(__t))+\n'\"/>\\n      <span class=\"ColorPicker-inputLabel u-upperCase\">R</span>\\n    </div>\\n    <div class=\"ColorPicker-inputWrapper CDB-Text\">\\n      <input type=\"text\" class=\"CDB-Text CDB-InputText ColorPicker-input js-inputColor js-g\" value=\"'+\n((__t=( g ))==null?'':_.escape(__t))+\n'\" />\\n      <span class=\"ColorPicker-inputLabel u-upperCase\">G</span>\\n    </div>\\n    <div class=\"ColorPicker-inputWrapper CDB-Text\">\\n      <input type=\"text\" class=\"CDB-Text CDB-InputText ColorPicker-input js-inputColor js-b\" value=\"'+\n((__t=( b ))==null?'':_.escape(__t))+\n'\" />\\n      <span class=\"ColorPicker-inputLabel u-upperCase\">B</span>\\n    </div>\\n    <div class=\"ColorPicker-inputWrapper CDB-Text\">\\n      <input type=\"text\" class=\"CDB-Text CDB-InputText ColorPicker-input js-a';\n if (opacityDisabled) { \n__p+=' is-disabled';\n } \n__p+='\" value=\"'+\n((__t=( opacity ))==null?'':_.escape(__t))+\n'\" ';\n if (opacityDisabled) { \n__p+='disabled';\n } \n__p+=' />\\n      <span class=\"ColorPicker-inputLabel u-upperCase\">A</span>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar CustomListView = require('../../../custom-list/custom-view');\nvar CustomListCollection = require('../../../custom-list/custom-list-collection');\nvar template = require('./column-list-view.tpl');\n\nmodule.exports = CoreView.extend({\n  defaults: {\n    headerTitle: ''\n  },\n\n  events: {\n    'click .js-back': '_onClickBack'\n  },\n\n  initialize: function (opts) {\n    if (!opts.stackLayoutModel) throw new Error('stackLayoutModel is required');\n    if (!opts.columns) throw new Error('columns param is required');\n\n    this._stackLayoutModel = opts.stackLayoutModel;\n    this._columns = opts.columns;\n    this._showSearch = opts.showSearch || false;\n    this._typeLabel = opts.typeLabel;\n    this._itemTemplate = opts.itemTemplate;\n\n    this.collection = new CustomListCollection(this._columns);\n    this.listenTo(this.collection, 'change:selected', this._onSelectItem);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n\n    this.$el.append(\n      template({\n        headerTitle: this.options.headerTitle\n      })\n    );\n\n    this._initViews();\n\n    return this;\n  },\n\n  _onClickBack: function (e) {\n    this.killEvent(e);\n    this.trigger('back', this);\n  },\n\n  _initViews: function () {\n    this._listView = new CustomListView({\n      collection: this.collection,\n      showSearch: this._showSearch,\n      typeLabel: this._typeLabel,\n      itemTemplate: this._itemTemplate\n    });\n    this.$('.js-content').append(this._listView.render().$el);\n    this.addView(this._listView);\n  },\n\n  _onSelectItem: function (item) {\n    this.trigger('selectItem', item, this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='';\n if (headerTitle) { \n__p+='\\n<div class=\"CDB-Box-modalHeader\">\\n  <ul class=\"CDB-Box-modalHeaderItem CDB-Box-modalHeaderItem--block CDB-Box-modalHeaderItem--paddingHorizontal\">\\n    <li class=\"CDB-ListDecoration-item CDB-ListDecoration-itemPadding--vertical CDB-Text CDB-Size-medium u-secondaryTextColor\">\\n      <button class=\"u-actionTextColor js-back u-rSpace\">\\n        <i class=\"CDB-IconFont CDB-IconFont-arrowPrev Size-large\"></i>\\n      </button>\\n      '+\n((__t=( headerTitle))==null?'':_.escape(__t))+\n'\\n    </li>\\n  </ul>\\n</div>\\n';\n } \n__p+='\\n<div class=\"js-content\"></div>\\n';\n}\nreturn __p;\n};\n",
    "module.exports={\n  \"number\": {\n    \"quantifications\": {\n      \"items\": [\"quantiles\", \"jenks\", \"equal\", \"headtails\"],\n      \"defaultIndex\": 0\n    },\n    \"bins\": {\n      \"items\": [\"2\", \"3\", \"4\", \"5\", \"6\", \"7\"],\n      \"defaultIndex\": 3\n    }\n  },\n  \"color\": {\n    \"quantifications\": {\n      \"items\": [\"jenks\", \"equal\", \"headtails\", \"quantiles\", \"category\"],\n      \"defaultIndex\": 0\n    }\n  },\n  \"color-ramps\": {\n    \"quantifications\": {\n      \"items\": [\"quantiles\", \"jenks\", \"equal\", \"headtails\", \"category\"],\n      \"defaultIndex\": 0\n    },\n    \"bins\": {\n      \"items\": [\"2\", \"3\", \"4\", \"5\", \"6\", \"7\"],\n      \"defaultIndex\": 3\n    }\n  }\n}\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\n\n/**\n * View model of the fill dialog\n */\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    visible: true,\n    createContentView: function () {\n      return new CoreView();\n    }\n  },\n\n  createContentView: function () {\n    return this.get('createContentView')(this);\n  },\n\n  show: function () {\n    this.set('visible', true);\n  },\n\n  hide: function () {\n    this.set('visible', false);\n  },\n\n  isHidden: function () {\n    return !this.get('visible');\n  },\n\n  /**\n   * @override {Backbone.Model.prototype.destroy}\n   */\n  destroy: function () {\n    var args = Array.prototype.slice.call(arguments);\n    this.trigger.apply(this, ['destroy'].concat(args));\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\n\nmodule.exports = CoreView.extend({\n  className: 'Editor-boxModal Editor-FormDialog js-formDialog is-opening',\n\n  initialize: function () {\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this._renderContentView();\n    return this;\n  },\n\n  _renderContentView: function () {\n    var view = this.model.createContentView();\n    this.addView(view);\n    this.$el.append(view.render().$el);\n  },\n\n  _initBinds: function () {\n    this.listenTo(this.model, 'change:show', this._onShowChange);\n    this.listenTo(this.model, 'destroy', this._onDestroy);\n  },\n\n  _onShowChange: function (m, show) {\n    if (show) {\n      this.$el.show();\n      this.$el.removeClass('is-closing').addClass('is-opening');\n    } else {\n      this.$el.removeClass('is-opening').addClass('is-closing');\n      this.$el.hide();\n    }\n  },\n\n  show: function () {\n    this.model.show();\n  },\n\n  hide: function () {\n    this.model.hide();\n  },\n\n  _onDestroy: function () {\n    this.hide();\n    this.clean();\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-boxModalHeader\">\\n  <nav class=\"CDB-NavMenu\">\\n    <ul class=\"CDB-NavMenu-Inner CDB-NavMenu-inner--no-margin CDB-NavMenu-inner--is-dropdown CDB-Text is-semibold CDB-Size-medium js-menu\"></ul>\\n  </nav>\\n</div>\\n<div class=\"js-content\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<ul class=\"CDB-OptionInput-container js-content\"></ul>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar EditorHelpers = require('../editor-helpers-extend');\n\nvar FillDialogModel = require('./fill-dialog-model');\nvar FillDialogView = require('./fill-dialog');\n\nvar InputCollection = require('./input-collection');\nvar InputNumber = require('./input-number/input-number');\nvar InputColor = require('./input-color/input-color');\n\nvar template = require('./fill-template.tpl');\n\nvar PopupManager = require('../../../popup-manager');\n\nvar INPUT_TYPE_MAP = {\n  'size': InputNumber,\n  'color': InputColor,\n  'image': InputColor\n};\n\nvar QUANTIFICATION_REF = {\n  'Jenks': 'jenks',\n  'Equal Interval': 'equal',\n  'Heads/Tails': 'headtails',\n  'Quantile': 'quantiles'\n};\n\nvar MIN_IMAGE_SIZE = 20;\n\nBackbone.Form.editors.Fill = Backbone.Form.editors.Base.extend({\n  className: 'Form-InputFill CDB-OptionInput CDB-Text js-input',\n\n  events: {\n    focus: function () {\n      this.trigger('focus', this);\n    },\n    blur: function () {\n      this.trigger('blur', this);\n    }\n  },\n\n  initialize: function (opts) {\n    Backbone.Form.editors.Base.prototype.initialize.call(this, opts);\n    EditorHelpers.setOptions(this, opts); // Options\n\n    this.options = _.extend(\n      this.options,\n      {\n        columns: this.options.options,\n        query: this.options.query,\n        configModel: this.options.configModel,\n        userModel: this.options.userModel,\n        editorAttrs: this.options.editorAttrs,\n        modals: this.options.modals\n      }\n    );\n\n    this._keyAttr = opts.key;\n    this.dialogMode = this.options.dialogMode || 'nested';\n\n    this._initBinds();\n    this._initViews();\n  },\n\n  _initViews: function () {\n    this.$el.append(template());\n\n    if (this.options.editorAttrs && this.options.editorAttrs.disabled) {\n      this.$el.addClass('is-disabled');\n    }\n\n    this._initFillDialog();\n    this._initInputFields();\n\n    this._popupManager = new PopupManager(this.cid, this.$el, this._fillDialogView.$el);\n  },\n\n  _initInputFields: function () {\n    var inputKlass;\n\n    this._inputCollection = new InputCollection();\n\n    _.each(this.model.get(this._keyAttr), function (value, key) {\n      this._inputCollection.add(_.extend({ type: key }, value));\n    }, this);\n\n    this._inputCollection.each(function (inputModel) {\n      var type = inputModel.get('type');\n\n      var Klass = INPUT_TYPE_MAP[type];\n\n      if (!Klass) {\n        throw new Error(type + ' is not a valid type of constructor');\n      }\n\n      if (inputModel.get('quantification') && QUANTIFICATION_REF[inputModel.get('quantification')]) {\n        inputModel.set('quantification', QUANTIFICATION_REF[inputModel.get('quantification')], { silent: true });\n      }\n\n      inputKlass = new Klass(({\n        model: inputModel,\n        columns: this.options.columns,\n        query: this.options.query,\n        configModel: this.options.configModel,\n        userModel: this.options.userModel,\n        modals: this.options.modals,\n        editorAttrs: this.options.editorAttrs ? this.options.editorAttrs[type] : {},\n        disabled: this.options.editorAttrs && this.options.editorAttrs.disabled\n      }));\n\n      inputKlass.bind('click', this._onInputClick, this);\n\n      this.$('.js-content').append(inputKlass.render().$el);\n    }, this);\n\n    this._inputCollection.bind('inputChanged', this._onInputChanged, this);\n  },\n\n  _initBinds: function () {\n    this.applyESCBind(function () {\n      this._removeDialog();\n    });\n    this.applyClickOutsideBind(function () {\n      this._removeDialog();\n    });\n  },\n\n  _onInputClick: function (inputModel) {\n    if (inputModel.get('selected')) {\n      this._removeDialog();\n      return;\n    }\n\n    inputModel.set('selected', true);\n    this._fillDialogView.model.set('createContentView', inputModel.get('createContentView'));\n    this._fillDialogView.render();\n    this._fillDialogView.show();\n\n    this._popupManager.append(this.dialogMode);\n    this._popupManager.track();\n  },\n\n  _onInputChanged: function (mdl) {\n    this._adjustImageSize(mdl);\n    this.trigger('change', this);\n  },\n\n  _adjustImageSize: function (mdl) {\n    if (mdl.get('type') !== 'color' && mdl.get('kind') !== 'marker') {\n      return;\n    }\n\n    var changedImage = mdl.get('image') && mdl.hasChanged('image') && !mdl.previous('image');\n\n    var hasImages = _.isEmpty(_.compact(mdl.get('images')));\n    var hadImages = _.isEmpty(_.compact(mdl.previous('images')));\n    var changedImages = !hasImages && mdl.hasChanged('images') && hadImages;\n\n    if (changedImage || changedImages) {\n      var size = this._inputCollection.findWhere({ type: 'size' });\n\n      if (size && size.get('fixed') < MIN_IMAGE_SIZE) {\n        size.set('fixed', MIN_IMAGE_SIZE);\n      }\n    }\n  },\n\n  _initFillDialog: function () {\n    var fillDialogModel = new FillDialogModel();\n\n    this.listenToOnce(fillDialogModel, 'destroy', function () {\n      this._fillDialogView = null;\n      this.stopListening(fillDialogModel);\n    });\n\n    this._fillDialogView = new FillDialogView({\n      model: fillDialogModel\n    });\n  },\n\n  _removeDialog: function (dialog) {\n    this._inputCollection.unselect();\n    this._fillDialogView.remove();\n    this._popupManager.untrack();\n  },\n\n  focus: function () {\n    if (this.hasFocus) return;\n    this.$('.js-fillInput').focus();\n  },\n\n  blur: function () {\n    if (!this.hasFocus) return;\n    this.$('.js-fillInput').blur();\n  },\n\n  getValue: function () {\n    return this._inputCollection.getValues();\n  },\n\n  setValue: function (value) {\n    // TODO: add setter\n  },\n\n  remove: function () {\n    this._removeDialog();\n    this._popupManager.destroy();\n    this._inputCollection.unbind('inputChanged', this._onInputChanged, this);\n    Backbone.Form.editors.Base.prototype.remove.apply(this);\n  }\n});\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\n\nvar INPUT_TYPE_ORDER = ['size', 'color'];\n\nmodule.exports = Backbone.Collection.extend({\n  constructor: function (models, options) {\n    options = _.extend(options || {}, { silent: false });\n    Backbone.Collection.prototype.constructor.call(this, models, options);\n  },\n\n  comparator: function (m) {\n    return INPUT_TYPE_ORDER.indexOf(m.get('type'));\n  },\n\n  initialize: function () {\n    this.bind('change:selected', this._onSelectedChange, this);\n    this.bind('change', this._onModelsChanged, this);\n  },\n\n  getSelected: function () {\n    return this.find(function (model) {\n      return model.get('selected');\n    });\n  },\n\n  unselect: function () {\n    this.each(function (model) {\n      model.set('selected', false);\n    }, this);\n  },\n\n  _onSelectedChange: function (itemModel, isSelected) {\n    if (!isSelected) {\n      return;\n    }\n\n    this.each(function (model) {\n      if (model !== itemModel) {\n        model.set('selected', false);\n      }\n    }, this);\n  },\n\n  _onModelsChanged: function (mdl) {\n    var mdlChanges = mdl.changed;\n\n    // If there is any change about selected, don't propagate it\n    if (_.isEmpty(mdlChanges) || (_.size(mdlChanges) === 1 && mdl.changed.hasOwnProperty('selected'))) {\n      return;\n    }\n\n    this.trigger('inputChanged', mdl, this);\n  },\n\n  getValues: function () {\n    return this.reduce(function (memo, mdl) {\n      var data = {};\n      var typeValues = mdl.toJSON();\n\n      if (typeValues.fixed) {\n        data.fixed = typeValues.fixed;\n\n        if (typeValues.type === 'color') {\n          if (typeValues.image) {\n            data.image = typeValues.image;\n          }\n          if (typeValues.kind) {\n            data.kind = typeValues.kind;\n          }\n          data.opacity = typeValues.opacity;\n        }\n      } else {\n        data = _.omit(typeValues, ['createContentView', 'selected', 'type']);\n      }\n\n      memo[typeValues.type] = data;\n\n      return memo;\n    }, {});\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar checkAndBuildOpts = require('../../../../../../helpers/required-opts');\nvar template = require('./asset-header-view.tpl');\n\nvar REQUIRED_OPTS = [\n  'title',\n  'editable'\n];\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-remove': '_onClickRemove',\n    'click .js-select-all': '_onClickSelectAll',\n    'click .js-deselect-all': '_onClickDeselectAll'\n  },\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    this._assetsCollection = this.options.assetsCollection;\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    var selectedCount = this._getSelectedAssetsCount();\n\n    var assetsCount = this._assetsCollection.size();\n\n    this.$el.html(template({\n      title: this._title,\n      editable: this._editable,\n      assetsCount: assetsCount,\n      selectedCount: selectedCount,\n      allSelected: selectedCount === assetsCount\n    }));\n\n    return this;\n  },\n\n  _initBinds: function () {\n    this.listenTo(this._assetsCollection, 'add change remove', this.render);\n  },\n\n  _onClickRemove: function () {\n    this.trigger('remove');\n  },\n\n  _onClickSelectAll: function () {\n    this.trigger('select-all');\n  },\n\n  _onClickDeselectAll: function () {\n    this.trigger('deselect-all');\n  },\n\n  _getSelectedAssetsCount: function () {\n    var selectedAssets = this._assetsCollection.where({ state: 'selected' });\n    return selectedAssets ? selectedAssets.length : 0;\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<ul>\\n  <li class=\"CDB-NavSubmenu-item\">\\n    <h2 class=\"CDB-Text CDB-Size-medium u-altTextColor\">'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</h2>\\n  </li>\\n  ';\n if (editable && assetsCount > 0) { \n__p+='\\n    ';\n if (allSelected) { \n__p+='\\n      <li class=\"CDB-NavSubmenu-item\">\\n        <button class=\"CDB-NavSubmenu-itemLink CDB-Text CDB-Size-medium u-actionTextColor js-deselect-all\">'+\n((__t=( _t('components.modals.assets-picker.deselect-all') ))==null?'':_.escape(__t))+\n'</button>\\n      </li>\\n      ';\n } else if (selectedCount > 0) { \n__p+='\\n      <li class=\"CDB-NavSubmenu-item\">\\n        <button class=\"CDB-NavSubmenu-itemLink CDB-Text CDB-Size-medium u-actionTextColor js-select-all\">'+\n((__t=( _t('components.modals.assets-picker.select-all') ))==null?'':_.escape(__t))+\n'</button>\\n      </li>\\n    ';\n } \n__p+='\\n\\n    ';\n if (selectedCount > 0) { \n__p+='\\n      <li class=\"CDB-NavSubmenu-item\">\\n          ';\n if (selectedCount > 1) { \n__p+='\\n        <button class=\"CDB-NavSubmenu-itemLink CDB-Text CDB-Size-medium u-errorTextColor js-remove\">'+\n((__t=( _t('components.modals.assets-picker.delete-images') ))==null?'':_.escape(__t))+\n'</button>\\n        ';\n } else { \n__p+='\\n        <button class=\"CDB-NavSubmenu-itemLink CDB-Text CDB-Size-medium u-errorTextColor js-remove\">'+\n((__t=( _t('components.modals.assets-picker.delete-image') ))==null?'':_.escape(__t))+\n'</button>\\n        ';\n } \n__p+='\\n      </li>\\n    ';\n } \n__p+='\\n  ';\n } \n__p+='\\n</ul>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\n\nvar template = require('./asset-item-view.tpl');\n\nvar ASSET_HEIGHT = 24;\n\nmodule.exports = CoreView.extend({\n  tagName: 'li',\n  className: 'AssetsList-item AssetsList-item--medium',\n\n  events: {\n    'click .js-asset': '_onClick'\n  },\n\n  initialize: function (opts) {\n    this.listenTo(this.model, 'change:state', this._changeState);\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    this.$el.attr('id', this.model.get('id'));\n\n    var type = this.model.get('type') || 'icon';\n\n    this.$el.append(template({\n      type: type,\n      height: this.options.assetHeight || ASSET_HEIGHT,\n      name: this.model.get('name'),\n      public_url: this.model.get('public_url')\n    }));\n\n    this.$el.addClass('AssetsList-item--' + type);\n\n    return this;\n  },\n\n  _onClick: function (e) {\n    this.killEvent(e);\n    this.trigger('selected', this.model);\n  },\n\n  _changeState: function () {\n    this.$el.toggleClass('is-selected', this.model.get('state') === 'selected');\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"AssetItem-label CDB-Text CDB-Size-big ';\n if (type === 'icon') { \n__p+='u-mainTextColor';\n } else { \n__p+='u-actionTextColor';\n } \n__p+=' u-upperCase js-asset\" title=\"'+\n((__t=( name ))==null?'':_.escape(__t))+\n'\">\\n  ';\n if (type === 'icon' || type === 'file') { \n__p+='\\n    <img height=\"'+\n((__t=( height ))==null?'':_.escape(__t))+\n'\" src=\"'+\n((__t=( public_url ))==null?'':_.escape(__t))+\n'\" alt=\"'+\n((__t=( name ))==null?'':_.escape(__t))+\n'\" />\\n  ';\n } else { \n__p+='\\n    '+\n((__t=( name ))==null?'':_.escape(__t))+\n'\\n  ';\n } \n__p+='\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar StaticAssetItemView = require('./static-asset-item-view');\nvar StaticAssetsCollection = require('../../../../../../data/static-assets-collection');\nvar checkAndBuildOpts = require('../../../../../../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'icons',\n  'selectedAsset'\n];\n\nmodule.exports = CoreView.extend({\n  tagName: 'ul',\n  className: 'AssetsList',\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n    this._setupAssets(opts);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this._renderAssets();\n    return this;\n  },\n\n  _renderAssets: function () {\n    this._assetsCollection.each(function (mdl) {\n      var item = new StaticAssetItemView({\n        model: mdl\n      });\n\n      if (this.model && item.model.getURLFor(mdl.get('icon')) === this.model.get('image')) {\n        item.model.set('state', 'selected');\n      }\n\n      item.bind('selected', this._selectItem, this);\n\n      this.$el.append(item.render().el);\n      this.addView(item);\n    }, this);\n  },\n\n  _setupAssets: function (opts) {\n    if (!_.isEmpty(opts)) {\n      this._icons = _.map(this._icons, function (asset) {\n        return _.extend(asset, opts);\n      });\n    }\n\n    var assets = this._icons;\n\n    if (this.options.limit) {\n      assets = assets.slice(0, this.options.limit);\n    }\n\n    this._assetsCollection = new StaticAssetsCollection(assets);\n    this.add_related_model(this._assetsCollection);\n  },\n\n  _selectItem: function (m) {\n    this._selectedAsset.set({\n      url: m.get('public_url'),\n      kind: m.get('kind')\n    });\n\n    this._assetsCollection.deselectAll(m);\n  }\n});\n",
    "var $ = require('jquery');\nvar _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar Backbone = require('backbone');\n\nvar Utils = require('../../../../../../helpers/utils');\nvar MakiIcons = require('../assets/maki-icons');\nvar UserAssetsView = require('./user-assets-tab');\nvar OrganizationAssetsListView = require('./organization-assets-list-view');\nvar OrganizationAssetsCollection = require('../../../../../../data/organization-assets-collection');\nvar UploadAssetsView = require('./upload-assets-tab');\n\nvar checkAndBuildOpts = require('../../../../../../helpers/required-opts');\nvar AssetsCollection = require('../../../../../../data/assets-collection');\nvar createTextLabelsTabPane = require('../../../../../tab-pane/create-text-labels-tab-pane');\nvar ScrollView = require('../../../../../scroll/scroll-view');\nvar AssetsListView = require('./assets-list-view');\nvar loadingView = require('../../../../../loading/render-loading');\n\nvar ErrorView = require('../../../../../error/error-view');\nvar errorTemplate = require('./upload-assets-error.tpl');\nvar errorParser = require('../../../../../../helpers/error-parser');\n\nvar template = require('./assets-view.tpl');\nvar tabPaneTemplate = require('./tab-pane-template.tpl');\n\nvar KIND = 'custom-marker';\n\nvar REQUIRED_OPTS = [\n  'modalModel',\n  'configModel',\n  'userModel'\n];\n\nmodule.exports = CoreView.extend({\n  className: 'Dialog-content Dialog-content--expanded',\n\n  events: {\n    'click .js-add': '_onSetImage',\n    'click .js-upload': '_initUpload',\n    'change .js-fileInput': '_onFileSelected',\n    'click .js-back': '_onClickBack'\n  },\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    this._initModels();\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template({\n      disclaimer: MakiIcons.disclaimer\n    }));\n\n    if (this._hasFetchedAllCollections()) {\n      this._initTabPane();\n    } else if (this._isLoading()) {\n      this._renderLoading();\n    } else if (this._hasError()) {\n      this._renderError();\n    }\n    return this;\n  },\n\n  _hasFetchedAllCollections: function () {\n    return this._stateModel.get('status') === 'show';\n  },\n\n  _initModels: function () {\n    var self = this;\n\n    this._selectedAsset = new Backbone.Model({\n      url: this.model.get('image')\n    });\n\n    this._stateModel = new Backbone.Model({\n      status: 'loading',\n      modalEnabled: false,\n      uploads: 0\n    });\n\n    this._assetCollections = [];\n\n    this._userAssetCollection = new AssetsCollection(null, {\n      configModel: this._configModel,\n      userModel: this._userModel\n    });\n\n    this._assetCollections.push(this._userAssetCollection);\n\n    if (this._userModel.isInsideOrg()) {\n      this._organizationAssetCollection = new OrganizationAssetsCollection(null, {\n        configModel: this._configModel,\n        orgId: this._userModel.getOrganization().get('id')\n      });\n      this._assetCollections.push(this._organizationAssetCollection);\n    }\n\n    var onFetchAssetCollections = _.invoke(this._assetCollections, 'fetch');\n    $.when.apply($, onFetchAssetCollections)\n      .then(function () {\n        self._stateModel.set('status', 'show');\n      }, function (model, response) {\n        self._setError(response);\n      });\n  },\n\n  _initBinds: function () {\n    this.listenTo(this._selectedAsset, 'change:url', this._onChangeSelectedAsset);\n    this.listenTo(this._stateModel, 'change:status', this.render);\n    this.listenTo(this._stateModel, 'change:modalEnabled', this._onChangeSetButton);\n  },\n\n  _onClickBack: function (e) {\n    this.killEvent(e);\n    this._stateModel.set('status', 'show');\n    this._assetsTabPaneView.setSelectedTabPaneByName('upload-file');\n  },\n\n  _upload: function (data) {\n    this._userAssetCollection.create(data, {\n      beforeSend: this._beforeAssetUpload.bind(this),\n      success: this._onAssetUploaded.bind(this),\n      error: this._onAssetUploadError.bind(this),\n      complete: this._onAssetUploadComplete.bind(this)\n    });\n  },\n\n  _renderError: function () {\n    this._hideDisclaimer();\n\n    this.$('.js-body').html(\n      new ErrorView({\n        title: Utils.capitalize(this._stateModel.get('error_message')),\n        desc: _t('components.modals.assets-picker.error-desc'),\n        template: errorTemplate\n      }).render().el\n    );\n  },\n\n  _renderLoading: function () {\n    this._hideDisclaimer();\n\n    this.$('.js-body').html(\n      loadingView({\n        title: _t('components.modals.assets-picker.loading')\n      })\n    );\n  },\n\n  _isLoading: function () {\n    return this._stateModel.get('status') === 'loading';\n  },\n\n  _hasError: function () {\n    return this._stateModel.get('status') === 'error';\n  },\n\n  _initTabPane: function () {\n    var tabPaneTabs = [{\n      name: 'maki-icons',\n      label: _t('components.modals.add-asset.icons'),\n      createContentView: this._createMakiIconsView.bind(this)\n    }, {\n      name: 'your-uploads',\n      label: _t('components.modals.add-asset.your-uploads'),\n      createContentView: this._createYourUploadsView.bind(this)\n    }];\n\n    if (this._userModel.isInsideOrg() && this._organizationAssetCollection.length > 0) {\n      tabPaneTabs.push({\n        name: 'organization-uploads',\n        label: _t('components.modals.add-asset.organization-uploads'),\n        createContentView: this._createOrganizationUploadsView.bind(this)\n      });\n    }\n\n    tabPaneTabs.push({\n      name: 'upload-file',\n      label: _t('components.modals.add-asset.upload-file'),\n      createContentView: this._createUploadFileView.bind(this)\n    });\n\n    var tabPaneOptions = {\n      tabPaneOptions: {\n        template: tabPaneTemplate,\n        disclaimer: MakiIcons.disclaimer,\n        tabPaneItemOptions: {\n          tagName: 'li',\n          className: 'CDB-NavMenu-item'\n        }\n      },\n      tabPaneItemLabelOptions: {\n        tagName: 'button',\n        className: 'CDB-NavMenu-link u-upperCase'\n      }\n    };\n\n    this._assetsTabPaneView = createTextLabelsTabPane(tabPaneTabs, tabPaneOptions);\n    this.listenTo(this._assetsTabPaneView.collection, 'change', this._onChangeSelectedTab);\n\n    this.addView(this._assetsTabPaneView);\n    this.$('.js-body').append(this._assetsTabPaneView.render().el);\n\n    this._initSetButtonState();\n  },\n\n  _onChangeSelectedTab: function () {\n    switch (this._assetsTabPaneView.getSelectedTabPaneName()) {\n      case 'maki-icons':\n        this._setDisclaimer(MakiIcons.disclaimer);\n        this._toggleSetButton();\n        break;\n      case 'upload-file':\n        this._hideDisclaimer();\n        this._disableSetButton();\n        break;\n      default:\n        this._hideDisclaimer();\n        this._toggleSetButton();\n        break;\n    }\n  },\n\n  _toggleSetButton: function () {\n    this._stateModel.set('modalEnabled', this._selectedAsset.get('url') !== undefined);\n  },\n\n  _initSetButtonState: function () {\n    if (!this.model.get('image')) {\n      return;\n    }\n\n    var selectedAssetExist = false;\n\n    if (this.model.get('kind') === 'marker') {\n      selectedAssetExist = true;\n    }\n\n    if (!selectedAssetExist) {\n      _.each(this._assetCollections, function (assetCollection) {\n        if (!selectedAssetExist) {\n          selectedAssetExist = assetCollection.some(function (mdl) {\n            return this.model.get('image') === mdl.get('public_url');\n          }, this);\n        }\n      }, this);\n    }\n\n    if (selectedAssetExist) {\n      this._enableSetButton();\n    }\n  },\n\n  _enableSetButton: function () {\n    this._stateModel.set('modalEnabled', true);\n  },\n\n  _disableSetButton: function () {\n    this._stateModel.set('modalEnabled', false);\n  },\n\n  _createYourUploadsView: function () {\n    var view = new UserAssetsView({\n      model: this.model,\n      selectedAsset: this._selectedAsset,\n      title: _t('components.modals.add-asset.your-uploads'),\n      organizationAssetCollection: this._organizationAssetCollection,\n      userAssetCollection: this._userAssetCollection,\n      userModel: this._userModel\n    }).bind(this);\n\n    this._userAssetsView = view;\n\n    view.bind('init-upload', this._initUpload, this);\n\n    this._hideDisclaimer();\n\n    return this._userAssetsView;\n  },\n\n  _createOrganizationUploadsView: function () {\n    var view = new ScrollView({\n      createContentView: function () {\n        return new OrganizationAssetsListView({\n          title: _t('components.modals.add-asset.organization-uploads'),\n          model: this.model,\n          organizationAssetCollection: this._organizationAssetCollection,\n          userAssetCollection: this._userAssetCollection,\n          selectedAsset: this._selectedAsset\n        });\n      }.bind(this)\n    });\n\n    this._hideDisclaimer();\n\n    return view;\n  },\n\n  _createUploadFileView: function () {\n    var view = new UploadAssetsView({\n      model: this.model,\n      userModel: this._userModel,\n      configModel: this._configModel\n    }).bind(this);\n\n    view.bind('upload-complete', this._onUploadComplete, this);\n    view.bind('upload-files', this._uploadFiles, this);\n    view.bind('upload-url', this._uploadURL, this);\n    return view;\n  },\n\n  _createMakiIconsView: function () {\n    return new ScrollView({\n      createContentView: function () {\n        return new AssetsListView({\n          model: this.model,\n          selectedAsset: this._selectedAsset,\n          title: _t('components.modals.add-asset.maki-icons'),\n          icons: MakiIcons.icons,\n          folder: 'maki-icons',\n          kind: 'marker',\n          size: '18'\n        });\n      }.bind(this)\n    });\n  },\n\n  _onUploadComplete: function () {\n    this._assetsTabPaneView.setSelectedTabPaneByName('your-uploads');\n  },\n\n  _onChangeSetButton: function () {\n    this.$('.js-add').toggleClass('is-disabled', !this._stateModel.get('modalEnabled'));\n  },\n\n  _onChangeSelectedAsset: function () {\n    if (!this._selectedAsset.get('url')) {\n      this.model.unset('image');\n      this.model.unset('kind');\n    }\n\n    this._stateModel.set('modalEnabled', !!this._selectedAsset.get('url'));\n  },\n\n  _initUpload: function (e) {\n    this.killEvent(e);\n    this.$('.js-fileInput').click();\n  },\n\n  _setDisclaimer: function (disclaimer) {\n    this.$('.js-disclaimer').html(disclaimer);\n  },\n\n  _hideDisclaimer: function () {\n    this.$('.js-disclaimer').html('');\n  },\n\n  _getSelectedFiles: function () {\n    return this.$('.js-fileInput').prop('files');\n  },\n\n  _uploadURL: function (url) {\n    this._upload({\n      type: 'url',\n      kind: KIND,\n      url: url\n    });\n  },\n\n  _uploadFiles: function (files) {\n    _.each(files, function (file) {\n      this._upload({\n        kind: KIND,\n        type: 'file',\n        filename: file\n      });\n    }, this);\n  },\n\n  _onFileSelected: function () {\n    this._uploadFiles(this._getSelectedFiles());\n  },\n\n  _beforeAssetUpload: function () {\n    this._stateModel.set('uploads', this._stateModel.get('uploads') + 1);\n\n    if (this._stateModel.get('uploads') > 0) {\n      this._stateModel.set('status', 'loading');\n    }\n  },\n\n  _onAssetUploaded: function (iconModel) {\n    this._resetFileSelection();\n  },\n\n  _setError: function (error) {\n    this._stateModel.set({\n      error_message: errorParser(error),\n      status: 'error'\n    });\n  },\n\n  _onAssetUploadError: function (model, response) {\n    this._resetFileSelection();\n    this._setError(response);\n  },\n\n  _onAssetUploadComplete: function () {\n    this._stateModel.set('uploads', this._stateModel.get('uploads') - 1);\n\n    if (this._stateModel.get('uploads') < 1 && !this._hasError()) {\n      this._stateModel.set('status', 'show');\n      this._onUploadComplete();\n    }\n  },\n\n  _resetFileSelection: function () {\n    this.$('.js-fileInput').val('');\n  },\n\n  _onSetImage: function (e) {\n    this.killEvent(e);\n\n    if (!this._stateModel.get('modalEnabled')) {\n      return;\n    }\n\n    this.model.set({\n      image: this._selectedAsset.get('url'), // backend serves the url of the asset in `image`\n      kind: this._selectedAsset.get('kind')\n    });\n\n    this.trigger('change', {\n      url: this._selectedAsset.get('url'),\n      kind: this._selectedAsset.get('kind')\n    }, this);\n\n    this._modalModel.destroy(this.model);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Modal\">\\n  <div class=\"Modal-header\">\\n    <div class=\"Modal-headerContainer\">\\n      <h2 class=\"CDB-Text CDB-Size-huge is-light u-bSpace\">'+\n((__t=( _t('components.modals.add-asset.modal-title') ))==null?'':_.escape(__t))+\n'</h2>\\n      <h3 class=\"CDB-Text CDB-Size-medium u-altTextColor\"><button class=\"u-actionTextColor js-upload\">'+\n((__t=( _t('components.modals.add-asset.upload-asset') ))==null?'':_.escape(__t))+\n'</button> '+\n((__t=( _t('components.modals.add-asset.modal-desc') ))==null?'':_.escape(__t))+\n'</h3>\\n    </div>\\n  </div>\\n\\n  <div class=\"Modal-container js-body\"></div>\\n\\n  <div class=\"Modal-footer\">\\n    <div class=\"Modal-footerContainer u-flex u-justifySpace\">\\n      <div class=\"CDB-Text CDB-Size-medium js-disclaimer\">\\n        ';\n if (disclaimer) { \n__p+='\\n        '+\n((__t=( disclaimer ))==null?'':__t)+\n'\\n        ';\n } \n__p+='\\n      </div>\\n\\n      <button class=\"CDB-Button CDB-Button--primary is-disabled js-add\">\\n        <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">'+\n((__t=( _t('components.modals.add-asset.set-image') ))==null?'':_.escape(__t))+\n'</span>\\n      </button>\\n    </div>\\n  </div>\\n</div>\\n\\n<form accept-charset=\"UTF-8\" enctype=\"multipart/form-data\" method=\"post\">\\n  <input type=\"file\" accept=\"image/jpeg,image/jpg,image/gif,image/png,image/svg+xml\" class=\"js-fileInput\" style=\"position: absolute; clip: rect(0px 0px 0px 0px); opacity: 0;\" multiple=\"multiple\">\\n</form>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./input-asset-picker-header.tpl');\nvar ImageLoaderView = require('../../../../../img-loader-view');\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-back': '_onClickBack',\n    'click .js-colorPicker': '_onClickColorPicker'\n  },\n\n  initialize: function (opts) {\n    this._imageEnabled = opts.imageEnabled;\n\n    this._initBinds();\n  },\n\n  render: function (model, options) {\n    this.clearSubViews();\n    this.$el.empty();\n\n    var rampItem = this._getRampItem();\n\n    this.$el.append(template({\n      index: this.model.get('index') || 0,\n      color: rampItem.color || '',\n      label: rampItem.title || _t('form-components.editors.fill.input-categories.others'),\n      image: rampItem.image || '',\n      imageEnabled: this._imageEnabled\n    }));\n\n    this._loadImages();\n\n    return this;\n  },\n\n  _initBinds: function () {\n    this.listenTo(this.model, 'change:image', this.render);\n  },\n\n  _getRampItem: function () {\n    var ramp = this.model.get('ramp');\n\n    if (!ramp) {\n      return {\n        color: '',\n        title: _t('form-components.editors.fill.input-categories.others'),\n        image: ''\n      };\n    }\n\n    return ramp[this.model.get('index')];\n  },\n\n  _loadImages: function () {\n    var rampItem = this._getRampItem();\n\n    this.iconView = new ImageLoaderView({\n      imageClass: 'CDB-Text u-actionTextColor js-assetPicker',\n      imageUrl: rampItem.image,\n      color: rampItem.color\n    });\n    this.addView(this.iconView);\n    this.$('.js-image-container').append(this.iconView.render().el);\n  },\n\n  _onClickBack: function (ev) {\n    this.killEvent(ev);\n    this.trigger('back', this);\n  },\n\n  _onClickColorPicker: function (ev) {\n    this.killEvent(ev);\n    this.trigger('goToColorPicker', this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CDB-Box-modalHeader\">\\n  <ul class=\"CDB-Box-modalHeaderItem CDB-Box-modalHeaderItem--block CDB-Box-modalHeaderItem--paddingHorizontal\">\\n    <li class=\"CDB-ListDecoration-item CDB-ListDecoration-itemDisplay--flex CDB-Text CDB-Size-medium u-secondaryTextColor\">\\n      <div class=\\'CDB-ListDecoration-secondaryContainer\\'>\\n        <button class=\"u-rSpace u-actionTextColor js-back\">\\n          <i class=\"CDB-IconFont CDB-IconFont-arrowPrev Size-large\"></i>\\n        </button>\\n        <span class=\"label js-label\">'+\n((__t=( label ))==null?'':_.escape(__t))+\n'</span>\\n      </div>\\n\\n      <div class=\\'CDB-ListDecoration-secondaryContainer\\'>\\n        <nav class=\\'CDB-NavMenu\\'>\\n          <ul class=\\'CDB-NavMenu-Inner CDB-NavMenu-inner--no-margin js-menu\\'>\\n            <li class=\\'CDB-NavMenu-item\\'>\\n              <div class=\\'CDB-NavMenu-link CDB-ListDecoration-rampNav-item\\'>\\n                <button class=\"ColorBar CDB-ListDecoration-rampItemBar u-rSpace--xl js-colorPicker\" style=\"background-color: '+\n((__t=( color ))==null?'':__t)+\n';\" type=\"button\"></button>\\n              </div>\\n            </li>\\n\\n            ';\n if (imageEnabled) { \n__p+='\\n              <li class=\\'CDB-NavMenu-item is-selected\\'>\\n                <div class=\\'CDB-NavMenu-link CDB-ListDecoration-rampNav-item\\'>\\n                  ';\n if (image) { \n__p+='\\n                    <div class=\\'CDB-ListDecoration-rampImg js-image-container\\'></div>\\n                  ';\n } else { \n__p+='\\n                    <span class=\"CDB-ListDecoration-rampImg CDB-Text js-assetPicker\">'+\n((__t=( _t('form-components.editors.fill.input-color.img') ))==null?'':__t)+\n'</span>\\n                  ';\n } \n__p+='\\n                </div>\\n              </li>\\n            ';\n } \n__p+='\\n          </ul>\\n        </nav>\\n      </div>\\n    </li>\\n  </ul>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar template = require('./input-asset-picker-view.tpl');\nvar InputAssetPickerHeader = require('./input-asset-picker-header');\nvar InputAssetPickerView = require('../input-color-file-view');\nvar checkAndBuildOpts = require('../../../../../../helpers/required-opts');\nvar REQUIRED_OPTS = [\n  'configModel',\n  'modals',\n  'ramp',\n  'userModel'\n];\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n    this._imageEnabled = opts.imageEnabled;\n\n    this.model = new Backbone.Model({\n      index: this.options.index,\n      ramp: opts.ramp\n    });\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template());\n    this._initViews();\n    return this;\n  },\n\n  _initViews: function () {\n    this._headerView = new InputAssetPickerHeader({\n      model: this.model,\n      imageEnabled: this._imageEnabled\n    });\n    this._headerView.bind('goToColorPicker', this._onGoToColorPicker, this);\n    this._headerView.bind('back', this._onClickBack, this);\n    this.$('.js-header').append(this._headerView.render().el);\n    this.addView(this._headerView);\n\n    this._assetPicker = new InputAssetPickerView({\n      model: this.model,\n      userModel: this._userModel,\n      configModel: this._configModel,\n      modals: this._modals,\n      imageEnabled: this._imageEnabled\n    });\n    this._assetPicker.bind('change', _.debounce(this._onChangeImage, 50), this);\n    this.$('.js-content').append(this._assetPicker.render().el);\n    this.addView(this._assetPicker);\n  },\n\n  _getRampItem: function () {\n    var ramp = this.model.get('ramp');\n\n    if (!ramp) {\n      return {\n        color: '',\n        title: _t('form-components.editors.fill.input-categories.others'),\n        image: ''\n      };\n    }\n\n    return ramp[this.model.get('index')];\n  },\n\n  _onChangeImage: function (data) {\n    var url = data && data.url || '';\n    var kind = data && data.kind || '';\n\n    this._getRampItem().image = url;\n    this.model.trigger('change:image');\n\n    this.trigger('change:image', {\n      url: url,\n      kind: kind,\n      index: this.model.get('index')\n    }, this);\n  },\n\n  _onClickBack: function (e) {\n    this.killEvent(e);\n    this.trigger('back', this);\n  },\n\n  _onGoToColorPicker: function (e) {\n    this.killEvent(e);\n    this.trigger('goToColorPicker', this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"js-header\"></div>\\n<div class=\"js-content\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar checkAndBuildOpts = require('../../../../../../helpers/required-opts');\nvar AssetItemView = require('./asset-item-view');\nvar template = require('./organization-assets-list-view.tpl');\n\nvar REQUIRED_OPTS = [\n  'userAssetCollection',\n  'organizationAssetCollection',\n  'selectedAsset'\n];\n\nvar KIND = 'custom-marker';\nvar ASSET_HEIGHT = 48;\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template);\n\n    this._organizationAssetCollection.deselectAll();\n    this._organizationAssetCollection.each(this._renderAsset, this);\n\n    return this;\n  },\n\n  _initBinds: function () {\n    this.listenTo(this._organizationAssetCollection, 'reset', this.render);\n    this.listenTo(this._organizationAssetCollection, 'change', this._onChangeAssets);\n  },\n\n  _getSelectedAsset: function () {\n    var selectedAssets = this._organizationAssetCollection.where({ state: 'selected' });\n    return selectedAssets && selectedAssets[0];\n  },\n\n  _renderAsset: function (assetModel) {\n    var assetItemView = new AssetItemView({\n      model: assetModel,\n      assetHeight: ASSET_HEIGHT,\n      selectedAsset: this._selectedAsset\n    });\n\n    if (assetModel.get('public_url') === this.model.get('image')) {\n      assetModel.set('state', 'selected');\n    }\n\n    assetItemView.bind('selected', this._selectAsset, this);\n\n    this.$('.js-assets').append(assetItemView.render().el);\n    this.addView(assetItemView);\n  },\n\n  _onChangeAssets: function () {\n    var selectedAsset = this._getSelectedAsset();\n\n    this._selectedAsset.set({\n      url: selectedAsset && selectedAsset.get('public_url'),\n      kind: KIND\n    });\n  },\n\n  _selectAsset: function (m) {\n    m.set('state', 'selected');\n\n    this._organizationAssetCollection.deselectAll(m);\n    this._userAssetCollection.deselectAll();\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<ul class=\"AssetsList js-assets\"></ul>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./static-asset-item-view.tpl');\n\nmodule.exports = CoreView.extend({\n  tagName: 'li',\n  className: 'AssetsList-item AssetsList-item--medium',\n\n  events: {\n    'click .js-asset': '_onClick'\n  },\n\n  initialize: function () {\n    this.listenTo(this.model, 'change:state', this._changeState);\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    this.$el.append(template({\n      type: 'icon',\n      name: this.model.get('name'),\n      public_url: this.model.get('public_url')\n    }));\n    return this;\n  },\n\n  _onClick: function (e) {\n    this.killEvent(e);\n    this.trigger('selected', this.model);\n    this.model.set('state', 'selected');\n  },\n\n  _changeState: function () {\n    this.$el.toggleClass('is-selected', this.model.get('state') === 'selected');\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='';\n if (type === 'icon') { \n__p+='\\n<div class=\"AssetItem-icon js-asset\"><img height=\"24\" src=\"'+\n((__t=( public_url ))==null?'':_.escape(__t))+\n'\" alt=\"'+\n((__t=( name ))==null?'':_.escape(__t))+\n'\" crossOrigin=\"anonymous\" /></div>\\n';\n } else { \n__p+='\\n<div class=\"AssetItem-label CDB-Text CDB-Size-small u-altTextColor u-upperCase js-asset\" title=\"'+\n((__t=( name ))==null?'':_.escape(__t))+\n'\">\\n  '+\n((__t=( name ))==null?'':_.escape(__t))+\n'\\n</div>\\n';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Modal-navigation\">\\n  <ul class=\"Modal-navigationInner CDB-Text is-semibold CDB-Size-medium js-menu\"></ul>\\n</div>\\n<div class=\"Tab-paneContent Publish-modalContent Modal-inner Modal-inner--with-navigation js-content\">\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"LayoutIcon LayoutIcon--negative\">\\n  <i class=\"CDB-IconFont CDB-IconFont-cockroach\"></i>\\n</div>\\n<h3 class=\"CDB-Text CDB-Size-large u-mainTextColor u-errorTextColor u-bSpace--m u-tSpace-xl\">'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</h3>\\n<p class=\"CDB-Text CDB-Size-medium u-altTextColor\">'+\n((__t=( desc ))==null?'':__t)+\n'</p>\\n\\n<button class=\"CDB-Button CDB-Button--primary u-tSpace-xl js-back\">\\n  <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">'+\n((__t=( _t('components.modals.assets-picker.go-back') ))==null?'':_.escape(__t))+\n'</span>\\n</button>\\n';\n}\nreturn __p;\n};\n",
    "var $ = require('jquery');\nvar Backbone = require('backbone');\nvar Utils = require('../../../../../../helpers/utils');\n\nrequire('dragster');\nvar Dropzone = require('dropzone');\nvar CoreView = require('backbone/core-view');\nvar checkAndBuildOpts = require('../../../../../../helpers/required-opts');\nvar AssetsCollection = require('../../../../../../data/assets-collection');\nvar template = require('./upload-assets-tab.tpl');\n\nvar REQUIRED_OPTS = [\n  'configModel',\n  'userModel'\n];\n\nmodule.exports = CoreView.extend({\n  className: 'Form-modal',\n\n  events: {\n    'keyup .js-url': '_onURLChanged',\n    'click .js-submit': '_onClickSubmit'\n  },\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    this._stateModel = new Backbone.Model({\n      status: 'show',\n      uploads: 0\n    });\n\n    this.listenTo(this._stateModel, 'change:status', this.render);\n\n    this._assetCollection = new AssetsCollection(\n      null, {\n        configModel: this._configModel,\n        userModel: this._userModel\n      }\n    );\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    this.$el.html(template());\n    this._initDropzone();\n\n    return this;\n  },\n\n  _initDropzone: function () {\n    var el = $('html')[0];\n    var self = this;\n\n    this.dragster = new Dragster(el); // eslint-disable-line\n\n    $(el).bind('dragster:enter', function (e) {\n      self._showDropzone();\n    });\n\n    $(el).bind('dragster:leave', function (e) {\n      self._hideDropzone();\n    });\n\n    if (el.dropzone) { // avoid loading the dropzone twice\n      return;\n    }\n\n    this.dropzone = new Dropzone(el, {\n      url: ':)',\n      autoProcessQueue: false,\n      previewsContainer: false\n    });\n\n    this.dropzone.on('dragover', function () {\n      self._showDropzone();\n    });\n\n    this.dropzone.on('drop', function (e) {\n      self.trigger('upload-files', e.dataTransfer.files);\n      self._hideDropzone();\n    });\n  },\n\n  _showDropzone: function () {\n    this.$('.Form-upload').addClass('is-dropping');\n  },\n\n  _hideDropzone: function () {\n    this.$('.Form-upload').removeClass('is-dropping');\n  },\n\n  _destroyDropzone: function () {\n    var el = $('html')[0];\n\n    if (this.dragster) {\n      this.dragster.removeListeners();\n      this.dragster.reset();\n      $(el).unbind('dragster:enter dragster:leave');\n    }\n\n    if (this.dropzone) {\n      this.dropzone.destroy();\n    }\n  },\n\n  _hasError: function () {\n    return this._stateModel.get('status') === 'error';\n  },\n\n  _onClickSubmit: function (e) {\n    this.killEvent(e);\n\n    var url = this._getURL();\n\n    if (!url) {\n      this._hideURLError();\n      return;\n    } else if (!Utils.isURL(url)) {\n      this._showURLError();\n      return;\n    } else {\n      this._hideURLError();\n    }\n\n    this.trigger('upload-url', url);\n  },\n\n  _getURL: function () {\n    return this.$('.js-url').val();\n  },\n\n  _onURLChanged: function () {\n    var url = this._getURL();\n\n    if (!url) {\n      this._hideURLError();\n    } else if (!Utils.isURL(url)) {\n      this._showURLError();\n    } else {\n      this._hideURLError();\n    }\n  },\n\n  _showURLError: function () {\n    this.$('.js-url-error').addClass('is-visible');\n  },\n\n  _hideURLError: function () {\n    this.$('.js-url-error').removeClass('is-visible');\n  },\n\n  clean: function () {\n    this._destroyDropzone();\n    CoreView.prototype.clean.apply(this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"ImportPanel-header\">\\n  <h3 class=\"CDB-Text CDB-Size-large u-mainTextColor u-secondaryTextColor u-bSpace--m\">\\n    '+\n((__t=( _t('components.modals.assets-picker.upload-file-url') ))==null?'':_.escape(__t))+\n'\\n  </h3>\\n  <p class=\"CDB-Text CDB-Size-medium u-altTextColor\">\\n    '+\n((__t=( _t('components.modals.assets-picker.upload-desc') ))==null?'':_.escape(__t))+\n'\\n  </p>\\n</div>\\n<div class=\"Form-row Form-row--centered\">\\n  <div class=\"Form-rowData Form-rowData--med Form-rowData--noMargin js-dropzone\">\\n    <div class=\"Form-upload\">\\n      <label class=\"Form-fileLabel js-fileLabel CDB-Text CDB-Size-medium\">'+\n((__t=( _t('components.modals.assets-picker.drag-and-drop') ))==null?'':_.escape(__t))+\n'</label>\\n      <label class=\"Form-fileLabel Form-fileLabel--error CDB-Text CDB-Size-small js-fileError\"></label>\\n      <div class=\"Form-file\">\\n        <span class=\"CDB-Button CDB-Button--primary Form-fileButton CDB-Button-Text CDB-Text is-semibold CDB-Size-small u-upperCase js-upload\">\\n          '+\n((__t=( _t('components.modals.assets-picker.browse') ))==null?'':_.escape(__t))+\n'\\n        </span>\\n      </div>\\n    </div>\\n  </div>\\n  <span class=\"u-lSpace--xl u-rSpace--xl u-flex u-alignCenter CDB-Text CDB-Size-medium u-altTextColor\">'+\n((__t=( _t('components.modals.assets-picker.or') ))==null?'':_.escape(__t))+\n'</span>\\n  <div class=\"Form-rowData Form-rowData--noMargin Form-rowData--med\">\\n    <input type=\"text\" class=\"Form-input Form-input--med has-submit js-url CDB-Text CDB-Size-medium\" value=\"\" placeholder=\"https://carto.com/markers/pin.png\" />\\n    <button type=\"submit\" class=\"CDB-Text CDB-Size-small Form-inputSubmit u-upperCase u-actionTextColor Form-inputSubmit js-submit\">\\n      <span>'+\n((__t=( _t('components.modals.assets-picker.submit') ))==null?'':_.escape(__t))+\n'</span>\\n    </button>\\n    <div class=\"Form-inputError CDB-Text js-url-error\">'+\n((__t=( _t('components.modals.assets-picker.incorrect-url') ))==null?'':_.escape(__t))+\n'</div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var $ = require('jquery');\nvar _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar AssetItemView = require('./asset-item-view');\nvar checkAndBuildOpts = require('../../../../../../helpers/required-opts');\nvar Backbone = require('backbone');\nvar loadingView = require('../../../../../loading/render-loading');\nvar AssetHeaderView = require('./asset-header-view');\n\nvar ErrorView = require('../../../../../error/error-view');\nvar errorTemplate = require('./upload-assets-error.tpl');\nvar template = require('./user-assets-list-view.tpl');\n\nvar REQUIRED_OPTS = [\n  'userModel',\n  'userAssetCollection',\n  'selectedAsset'\n];\n\nvar KIND = 'custom-marker';\nvar ASSET_HEIGHT = 48;\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    if (this._userModel.isInsideOrg()) {\n      if (!opts.organizationAssetCollection) throw new Error('organizationAssetCollection is required');\n\n      this._organizationAssetCollection = opts.organizationAssetCollection;\n    }\n\n    this._stateModel = new Backbone.Model();\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template);\n\n    if (this._isLoading()) {\n      this._renderLoading();\n    } else if (this._hasError()) {\n      this._renderError();\n    } else {\n      this._renderRegularView();\n    }\n\n    return this;\n  },\n\n  _addHeaderView: function () {\n    this._assetHeaderView = new AssetHeaderView({\n      editable: true,\n      title: this.options.title,\n      assetsCollection: this._userAssetCollection\n    });\n\n    this.addView(this._assetHeaderView);\n    this.$('.js-nav').append(this._assetHeaderView.render().el);\n\n    this._assetHeaderView.bind('select-all', this._selectAllAssets, this);\n    this._assetHeaderView.bind('deselect-all', this._deselectAllAssets, this);\n    this._assetHeaderView.bind('remove', this._removeSelectedAssets, this);\n  },\n\n  _renderRegularView: function () {\n    this._addHeaderView();\n    this._renderAddButton();\n\n    this._userAssetCollection.deselectAll();\n    this._userAssetCollection.each(this._renderAsset, this);\n  },\n\n  _renderAddButton: function () {\n    var addAssetButton = new AssetItemView({\n      model: new Backbone.Model({\n        type: 'text',\n        name: '+'\n      }),\n      assetHeight: ASSET_HEIGHT\n    });\n\n    addAssetButton.bind('selected', function () {\n      this.trigger('init-upload');\n    }, this);\n\n    this.addView(addAssetButton);\n    this.$('.js-assets').append(addAssetButton.render().$el);\n  },\n\n  _initBinds: function () {\n    this._keyDown = this._onKeyDown.bind(this);\n    $(document).on('keydown', this._keyDown);\n\n    this._keyUp = this._onKeyUp.bind(this);\n    $(document).on('keyup', this._keyUp);\n\n    this.listenTo(this._stateModel, 'change:status', this.render);\n    this.listenTo(this._userAssetCollection, 'change', this._onChangeAssets);\n  },\n\n  _getSelectedAsset: function () {\n    return this._userAssetCollection.findWhere({ state: 'selected' });\n  },\n\n  _getSelectedAssetsCount: function () {\n    var selectedAssets = this._userAssetCollection.where({ state: 'selected' });\n    return selectedAssets ? selectedAssets.length : 0;\n  },\n\n  _onKeyDown: function (ev) {\n    this._shiftKeyPressed = ev.shiftKey;\n  },\n\n  _onKeyUp: function (ev) {\n    this._shiftKeyPressed = ev.shiftKey;\n  },\n\n  _onClickBack: function (e) {\n    this.killEvent(e);\n    this._stateModel.unset('status');\n  },\n\n  _renderAsset: function (assetModel) {\n    var assetItemView = new AssetItemView({\n      model: assetModel,\n      assetHeight: ASSET_HEIGHT,\n      selectedAsset: this._selectedAsset\n    });\n\n    if (assetModel.get('public_url') === this.model.get('image')) {\n      assetModel.set('state', 'selected');\n    }\n\n    assetItemView.bind('selected', this._selectAsset, this);\n\n    this.$('.js-assets').append(assetItemView.render().el);\n    this.addView(assetItemView);\n  },\n\n  _onChangeAssets: function () {\n    if (this._getSelectedAssetsCount() === 1) {\n      var selectedAsset = this._getSelectedAsset();\n      this._selectedAsset.set({\n        url: selectedAsset && selectedAsset.get('public_url'),\n        kind: KIND\n      });\n    } else {\n      this._selectedAsset.set({\n        url: '',\n        kind: ''\n      });\n    }\n  },\n\n  _selectAllAssets: function () {\n    this._userAssetCollection.selectAll();\n  },\n\n  _deselectAllAssets: function () {\n    this._userAssetCollection.deselectAll();\n  },\n\n  _selectAsset: function (m) {\n    if (this._shiftKeyPressed) {\n      m.set('state', m.get('state') === 'selected' ? '' : 'selected');\n    } else {\n      m.set('state', 'selected');\n    }\n\n    if (!this._shiftKeyPressed) {\n      this._userAssetCollection.deselectAll(m);\n\n      if (this._userModel.isInsideOrg()) {\n        this._organizationAssetCollection.deselectAll();\n      }\n    }\n  },\n\n  _removeSelectedAssetsFromView: function () {\n    var selectedAssets = this._userAssetCollection.select(function (asset) {\n      return asset.get('state') === 'selected';\n    }, this);\n\n    _.each(selectedAssets, function (asset) {\n      this.$('#' + asset.get('id')).remove();\n    }, this);\n  },\n\n  _removeSelectedAssets: function () {\n    this._stateModel.set('status', 'loading');\n\n    var selectedAssets = this._userAssetCollection.select(function (asset) {\n      return asset.get('state') === 'selected';\n    }, this);\n\n    _.each(selectedAssets, function (asset) {\n      asset.destroy({\n        complete: this._onDestroyFinished.bind(this)\n      });\n    }, this);\n  },\n\n  _onDestroyFinished: function (response) {\n    if (response.status === 200) {\n      this._removeSelectedAssetsFromView();\n      this._stateModel.unset('status');\n      this._selectedAsset.unset('kind');\n      this._selectedAsset.unset('url');\n    } else {\n      this._stateModel.set({\n        error_message: response.statusText,\n        status: 'error'\n      });\n    }\n  },\n\n  _isLoading: function () {\n    return this._stateModel.get('status') === 'loading';\n  },\n\n  _hasError: function () {\n    return this._stateModel.get('status') === 'error';\n  },\n\n  _renderLoading: function () {\n    this.$el.html(\n      loadingView({\n        title: _t('components.modals.assets-picker.loading')\n      })\n    );\n  },\n\n  _renderError: function () {\n    this.$el.html(\n      new ErrorView({\n        title: this._stateModel.get('error_message'),\n        desc: _t('components.modals.assets-picker.error-desc'),\n        template: errorTemplate\n      }).render().el\n    );\n  },\n\n  _disableBinds: function () {\n    $(document).off('keydown', this._keyDown);\n    $(document).off('keyup', this._keyUp);\n  },\n\n  clean: function () {\n    this._disableBinds();\n    CoreView.prototype.clean.apply(this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<nav class=\"CDB-NavMenu u-bSpace--m u-inner js-nav\"></nav>\\n<ul class=\"AssetsList js-assets\"></ul>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar checkAndBuildOpts = require('../../../../../../helpers/required-opts');\nvar ScrollView = require('../../../../../scroll/scroll-view');\nvar UserAssetsListView = require('./user-assets-list-view');\n\nvar REQUIRED_OPTS = [\n  'userModel',\n  'userAssetCollection',\n  'title',\n  'selectedAsset'\n];\n\nmodule.exports = CoreView.extend({\n  events: {\n    'change .js-uploadInput': '_onFileSelected'\n  },\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    if (this._userModel.isInsideOrg()) {\n      if (!opts.organizationAssetCollection) throw new Error('organizationAssetCollection is required');\n\n      this._organizationAssetCollection = opts.organizationAssetCollection;\n    }\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this._renderAssets();\n    return this;\n  },\n\n  _renderAssets: function () {\n    var view = new ScrollView({\n      createContentView: function () {\n        var view = new UserAssetsListView({\n          title: this._title,\n          model: this.model,\n          organizationAssetCollection: this._organizationAssetCollection,\n          userAssetCollection: this._userAssetCollection,\n          selectedAsset: this._selectedAsset,\n          userModel: this._userModel\n        });\n\n        view.bind('init-upload', function () {\n          this.trigger('init-upload');\n        }, this);\n\n        return view;\n      }.bind(this)\n    });\n\n    this.addView(view);\n    this.$el.append(view.render().el);\n  }\n});\n",
    "// Maki icons from https://github.com/mapbox/maki\n// and https://github.com/mapbox/maki/blob/mb-pages/_includes/maki.json\nmodule.exports = {\n  disclaimer: _t('assets.maki-icons.disclaimer'),\n  icons: [\n    {\n      'name': 'Square stroked',\n      'icon': 'square-stroked'\n    },\n    {\n      'name': 'Square solid',\n      'icon': 'square'\n    },\n    {\n      'name': 'Triangle stroked',\n      'icon': 'triangle-stroked'\n    },\n    {\n      'name': 'Triangle solid',\n      'icon': 'triangle'\n    },\n    {\n      'name': 'Star stroked',\n      'icon': 'star-stroked'\n    },\n    {\n      'name': 'Star solid',\n      'icon': 'star'\n    },\n    {\n      'name': 'Cross',\n      'icon': 'cross'\n    },\n    {\n      'name': 'Marker Stroke',\n      'icon': 'marker-stroked'\n    },\n    {\n      'name': 'Marker Solid',\n      'icon': 'marker'\n    },\n    {\n      'name': 'Religious Jewish',\n      'icon': 'religious-jewish'\n    },\n    {\n      'name': 'Religious Christian',\n      'icon': 'religious-christian'\n    },\n    {\n      'name': 'Religious Muslim',\n      'icon': 'religious-muslim'\n    },\n    {\n      'name': 'Cemetery',\n      'icon': 'cemetery'\n    },\n    {\n      'name': 'Rocket',\n      'icon': 'rocket'\n    },\n    {\n      'name': 'Airport',\n      'icon': 'airport'\n    },\n    {\n      'name': 'Heliport',\n      'icon': 'heliport'\n    },\n    {\n      'name': 'Rail',\n      'icon': 'rail'\n    },\n    {\n      'name': 'Rail Metro',\n      'icon': 'rail-metro'\n    },\n    {\n      'name': 'Rail Light',\n      'icon': 'rail-light'\n    },\n    {\n      'name': 'Bus',\n      'icon': 'bus'\n    },\n    {\n      'name': 'Fuel',\n      'icon': 'fuel'\n    },\n    {\n      'name': 'Parking',\n      'tags': [\n        'parking',\n        'transportation'\n      ],\n      'icon': 'parking'\n    },\n    {\n      'name': 'Parking Garage',\n      'tags': [\n        'parking',\n        'transportation',\n        'garage'\n      ],\n      'icon': 'parking-garage'\n    },\n    {\n      'name': 'Airfield',\n      'tags': [\n        'airfield',\n        'airport',\n        'plane',\n        'landing strip'\n      ],\n      'icon': 'airfield'\n    },\n    {\n      'name': 'Roadblock',\n      'tags': [\n        'roadblock',\n        'stop',\n        'warning',\n        'dead end'\n      ],\n      'icon': 'roadblock'\n    },\n    {\n      'name': 'Ferry',\n      'tags': [\n        'ship',\n        'boat',\n        'water',\n        'ferry',\n        'transportation'\n      ],\n      'icon': 'ferry'\n    },\n    {\n      'name': 'Harbor',\n      'tags': [\n        'marine',\n        'dock',\n        'water',\n        'wharf'\n      ],\n      'icon': 'harbor'\n    },\n    {\n      'name': 'Bicycle',\n      'tags': [\n        'cycling',\n        'cycle',\n        'transportation'\n      ],\n      'icon': 'bicycle'\n    },\n    {\n      'name': 'Park',\n      'tags': [\n        'recreation',\n        'park',\n        'forest',\n        'tree',\n        'green',\n        'woods',\n        'nature'\n      ],\n      'icon': 'park'\n    },\n    {\n      'name': 'Park 2',\n      'tags': [\n        'recreation',\n        'park',\n        'forest',\n        'tree',\n        'green',\n        'woods',\n        'nature'\n      ],\n      'icon': 'park2'\n    },\n    {\n      'name': 'Museum',\n      'tags': [\n        'recreation',\n        'museum',\n        'tourism'\n      ],\n      'icon': 'museum'\n    },\n    {\n      'name': 'Lodging',\n      'tags': [\n        'lodging',\n        'hotel',\n        'recreation',\n        'motel',\n        'tourism'\n      ],\n      'icon': 'lodging'\n    },\n    {\n      'name': 'Monument',\n      'tags': [\n        'recreation',\n        'statue',\n        'monument',\n        'tourism'\n      ],\n      'icon': 'monument'\n    },\n    {\n      'name': 'Zoo',\n      'tags': [\n        'recreation',\n        'zoo',\n        'animal',\n        'giraffe'\n      ],\n      'icon': 'zoo'\n    },\n    {\n      'name': 'Garden',\n      'tags': [\n        'recreation',\n        'garden',\n        'park',\n        'flower',\n        'nature'\n      ],\n      'icon': 'garden'\n    },\n    {\n      'name': 'Campsite',\n      'tags': [\n        'recreation',\n        'campsite',\n        'camp',\n        'camping',\n        'tent',\n        'nature'\n      ],\n      'icon': 'campsite'\n    },\n    {\n      'name': 'Theatre',\n      'tags': [\n        'recreation',\n        'theatre',\n        'theater',\n        'entertainment',\n        'play',\n        'performance'\n      ],\n      'icon': 'theatre'\n    },\n    {\n      'name': 'Art gallery',\n      'tags': [\n        'art',\n        'center',\n        'museum',\n        'gallery',\n        'creative',\n        'recreation',\n        'entertainment',\n        'studio'\n      ],\n      'icon': 'art-gallery'\n    },\n    {\n      'name': 'Pitch',\n      'tags': [\n        'pitch',\n        'track',\n        'athletic',\n        'sports',\n        'field'\n      ],\n      'icon': 'pitch'\n    },\n    {\n      'name': 'Soccer',\n      'tags': [\n        'soccer',\n        'sports'\n      ],\n      'icon': 'soccer'\n    },\n    {\n      'name': 'American Football',\n      'tags': [\n        'football',\n        'sports'\n      ],\n      'icon': 'america-football'\n    },\n    {\n      'name': 'Tennis',\n      'tags': [\n        'tennis',\n        'court',\n        'ball',\n        'sports'\n      ],\n      'icon': 'tennis'\n    },\n    {\n      'name': 'Basketball',\n      'tags': [\n        'basketball',\n        'ball',\n        'sports'\n      ],\n      'icon': 'basketball'\n    },\n    {\n      'name': 'Baseball',\n      'tags': [\n        'baseball',\n        'softball',\n        'ball',\n        'sports'\n      ],\n      'icon': 'baseball'\n    },\n    {\n      'name': 'Golf',\n      'tags': [\n        'golf',\n        'sports',\n        'course'\n      ],\n      'icon': 'golf'\n    },\n    {\n      'name': 'Swimming',\n      'tags': [\n        'swimming',\n        'water',\n        'swim',\n        'sports'\n      ],\n      'icon': 'swimming'\n    },\n    {\n      'name': 'Cricket',\n      'tags': [\n        'cricket',\n        'sports'\n      ],\n      'icon': 'cricket'\n    },\n    {\n      'name': 'Skiing',\n      'tags': [\n        'winter',\n        'skiing',\n        'ski',\n        'sports'\n      ],\n      'icon': 'skiing'\n    },\n    {\n      'name': 'School',\n      'tags': [\n        'school',\n        'highschool',\n        'elementary',\n        'children',\n        'amenity',\n        'middle'\n      ],\n      'icon': 'school'\n    },\n    {\n      'name': 'College',\n      'tags': [\n        'college',\n        'school',\n        'amenity',\n        'university'\n      ],\n      'icon': 'college'\n    },\n    {\n      'name': 'Library',\n      'tags': [\n        'library',\n        'books',\n        'amenity'\n      ],\n      'icon': 'library'\n    },\n    {\n      'name': 'Post',\n      'tags': [\n        'post',\n        'office',\n        'amenity',\n        'mail',\n        'letter'\n      ],\n      'icon': 'post'\n    },\n    {\n      'name': 'Fire station',\n      'tags': [\n        'fire',\n        'station',\n        'amenity'\n      ],\n      'icon': 'fire-station'\n    },\n    {\n      'name': 'Town hall',\n      'tags': [\n        'townhall',\n        'mayor',\n        'building',\n        'amenity',\n        'government'\n      ],\n      'icon': 'town-hall'\n    },\n    {\n      'name': 'Police',\n      'tags': [\n        'police',\n        'jail',\n        'arrest',\n        'amenity',\n        'station'\n      ],\n      'icon': 'police'\n    },\n    {\n      'name': 'Prison',\n      'tags': [\n        'prison',\n        'jail',\n        'amenity'\n      ],\n      'icon': 'prison'\n    },\n    {\n      'name': 'Embassy',\n      'tags': [\n        'embassy',\n        'diplomacy',\n        'consulate',\n        'amenity',\n        'flag'\n      ],\n      'icon': 'embassy'\n    },\n    {\n      'name': 'Beer',\n      'tags': [\n        'bar',\n        'beer',\n        'drink',\n        'commercial',\n        'biergarten',\n        'pub'\n      ],\n      'icon': 'beer'\n    },\n    {\n      'name': 'Restaurant',\n      'tags': [\n        'restaurant',\n        'commercial'\n      ],\n      'icon': 'restaurant'\n    },\n    {\n      'name': 'Cafe',\n      'tags': [\n        'cafe',\n        'coffee',\n        'commercial',\n        'tea'\n      ],\n      'icon': 'cafe'\n    },\n    {\n      'name': 'Shop',\n      'tags': [\n        'shop',\n        'mall',\n        'commercial',\n        'store'\n      ],\n      'icon': 'shop'\n    },\n    {\n      'name': 'Fast Food',\n      'tags': [\n        'food',\n        'fast',\n        'commercial',\n        'burger',\n        'drive-through'\n      ],\n      'icon': 'fast-food'\n    },\n    {\n      'name': 'Bar',\n      'tags': [\n        'bar',\n        'drink',\n        'commercial',\n        'club',\n        'martini',\n        'lounge'\n      ],\n      'icon': 'bar'\n    },\n    {\n      'name': 'Bank',\n      'tags': [\n        'bank',\n        'atm',\n        'commercial',\n        'money'\n      ],\n      'icon': 'bank'\n    },\n    {\n      'name': 'Grocery',\n      'tags': [\n        'food',\n        'grocery',\n        'commercial',\n        'store',\n        'market'\n      ],\n      'icon': 'grocery'\n    },\n    {\n      'name': 'Cinema',\n      'tags': [\n        'cinema',\n        'theatre',\n        'film',\n        'movie',\n        'commercial',\n        'theater',\n        'entertainment'\n      ],\n      'icon': 'cinema'\n    },\n    {\n      'name': 'Pharmacy',\n      'tags': [\n        'pharmacy',\n        'drugs',\n        'medication',\n        'social',\n        'medicine',\n        'prescription'\n      ],\n      'icon': 'pharmacy'\n    },\n    {\n      'name': 'Hospital',\n      'tags': [\n        'hospital',\n        'health',\n        'medication',\n        'social',\n        'medicine',\n        'medical',\n        'clinic'\n      ],\n      'icon': 'hospital'\n    },\n    {\n      'name': 'Danger',\n      'tags': [\n        'minefield',\n        'landmine',\n        'disaster',\n        'dangerous',\n        'hazard'\n      ],\n      'icon': 'danger'\n    },\n    {\n      'name': 'Industrial',\n      'tags': [\n        'industrial',\n        'factory',\n        'property',\n        'building'\n      ],\n      'icon': 'industrial'\n    },\n    {\n      'name': 'Warehouse',\n      'tags': [\n        'warehouse',\n        'property',\n        'storage',\n        'building'\n      ],\n      'icon': 'warehouse'\n    },\n    {\n      'name': 'Commercial',\n      'tags': [\n        'commercial',\n        'property',\n        'business',\n        'building'\n      ],\n      'icon': 'commercial'\n    },\n    {\n      'name': 'Building',\n      'tags': [\n        'building',\n        'property',\n        'structure',\n        'business',\n        'building'\n      ],\n      'icon': 'building'\n    },\n    {\n      'name': 'Place of worship',\n      'tags': [\n        'religion',\n        'ceremony',\n        'religious',\n        'nondenominational',\n        'church',\n        'temple'\n      ],\n      'icon': 'place-of-worship'\n    },\n    {\n      'name': 'Alcohol shop',\n      'tags': [\n        'alcohol',\n        'liquor',\n        'store',\n        'shop',\n        'beer',\n        'wine',\n        'vodka'\n      ],\n      'icon': 'alcohol-shop'\n    },\n    {\n      'name': 'Logging',\n      'tags': [\n        'logger',\n        'chainsaw',\n        'woods',\n        'industry'\n      ],\n      'icon': 'logging'\n    },\n    {\n      'name': 'Oil well',\n      'tags': [\n        'oil',\n        'natural',\n        'environment',\n        'industry',\n        'resources'\n      ],\n      'icon': 'oil-well'\n    },\n    {\n      'name': 'Slaughterhouse',\n      'tags': [\n        'cows',\n        'cattle',\n        'food',\n        'meat',\n        'industry',\n        'resources'\n      ],\n      'icon': 'slaughterhouse'\n    },\n    {\n      'name': 'Dam',\n      'tags': [\n        'water',\n        'natural',\n        'hydro',\n        'hydroelectric',\n        'energy',\n        'environment',\n        'industry',\n        'resources'\n      ],\n      'icon': 'dam'\n    },\n    {\n      'name': 'Water',\n      'tags': [\n        'water',\n        'natural',\n        'hydro',\n        'lake',\n        'river',\n        'ocean',\n        'resources'\n      ],\n      'icon': 'water'\n    },\n    {\n      'name': 'Wetland',\n      'tags': [\n        'water',\n        'swamp',\n        'natural'\n      ],\n      'icon': 'wetland'\n    },\n    {\n      'name': 'Disability',\n      'tags': [\n        'handicap',\n        'wheelchair',\n        'access'\n      ],\n      'icon': 'disability'\n    },\n    {\n      'name': 'Telephone',\n      'tags': [\n        'payphone',\n        'call'\n      ],\n      'icon': 'telephone'\n    },\n    {\n      'name': 'Emergency Telephone',\n      'tags': [\n        'payphone',\n        'danger',\n        'safety',\n        'call'\n      ],\n      'icon': 'emergency-telephone'\n    },\n    {\n      'name': 'Toilets',\n      'tags': [\n        'bathroom',\n        'men',\n        'women',\n        'sink',\n        'washroom',\n        'lavatory'\n      ],\n      'icon': 'toilets'\n    },\n    {\n      'name': 'Waste Basket',\n      'tags': [\n        'trash',\n        'rubbish',\n        'bin',\n        'garbage'\n      ],\n      'icon': 'waste-basket'\n    },\n    {\n      'name': 'Music',\n      'tags': [\n        'stage',\n        'performance',\n        'band',\n        'concert',\n        'venue'\n      ],\n      'icon': 'music'\n    },\n    {\n      'name': 'Land Use',\n      'tags': [\n        'zoning',\n        'usage',\n        'area'\n      ],\n      'icon': 'land-use'\n    },\n    {\n      'name': 'City',\n      'tags': [\n        'area',\n        'point',\n        'place',\n        'urban'\n      ],\n      'icon': 'city'\n    },\n    {\n      'name': 'Town',\n      'tags': [\n        'area',\n        'point',\n        'place',\n        'small'\n      ],\n      'icon': 'town'\n    },\n    {\n      'name': 'Village',\n      'tags': [\n        'area',\n        'point',\n        'place',\n        'small',\n        'rural'\n      ],\n      'icon': 'village'\n    },\n    {\n      'name': 'Farm',\n      'tags': [\n        'building',\n        'farming',\n        'crops',\n        'plants',\n        'agriculture',\n        'rural'\n      ],\n      'icon': 'farm'\n    },\n    {\n      'name': 'Bakery',\n      'tags': [\n        'bakery',\n        'pastry',\n        'croissant',\n        'food',\n        'shop',\n        'bread'\n      ],\n      'icon': 'bakery'\n    },\n    {\n      'name': 'Dog Park',\n      'tags': [\n        'dog',\n        'pet'\n      ],\n      'icon': 'dog-park'\n    },\n    {\n      'name': 'Lighthouse',\n      'tags': [\n        'building',\n        'navigation',\n        'nautical',\n        'ocean',\n        'logistics'\n      ],\n      'icon': 'lighthouse'\n    },\n    {\n      'name': 'Clothing Store',\n      'tags': [\n        'clothing',\n        'store',\n        'shop'\n      ],\n      'icon': 'clothing-store'\n    },\n    {\n      'name': 'Polling Place',\n      'icon': 'polling-place'\n    },\n    {\n      'name': 'Playground',\n      'icon': 'playground'\n    },\n    {\n      'name': 'Entrance',\n      'icon': 'entrance'\n    },\n    {\n      'name': 'Heart',\n      'icon': 'heart'\n    },\n    {\n      'name': 'London Underground',\n      'icon': 'london-underground'\n    },\n    {\n      'name': 'Minefield',\n      'icon': 'minefield'\n    },\n    {\n      'name': 'Rail Underground',\n      'icon': 'rail-underground'\n    },\n    {\n      'name': 'Rail Above',\n      'icon': 'rail-above'\n    },\n    {\n      'name': 'Camera',\n      'icon': 'camera'\n    },\n    {\n      'name': 'Laundry',\n      'icon': 'laundry'\n    },\n    {\n      'name': 'Car',\n      'icon': 'car'\n    },\n    {\n      'name': 'Suitcase',\n      'icon': 'suitcase'\n    },\n    {\n      'name': 'Hairdresser',\n      'icon': 'hairdresser'\n    },\n    {\n      'name': 'Chemist',\n      'icon': 'chemist'\n    },\n    {\n      'name': 'Mobile phone',\n      'icon': 'mobilephone'\n    },\n    {\n      'name': 'Scooter',\n      'icon': 'scooter'\n    }\n  ]\n};\n",
    "var _ = require('underscore');\nvar $ = require('jquery');\nvar ImageLoaderView = require('../../../../../../img-loader-view');\nvar CustomListItemView = require('../../../../../../custom-list/custom-list-item-view');\n\nmodule.exports = CustomListItemView.extend({\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n\n    var name = this.model.getName() == null ? 'null' : this.model.getName();\n\n    this.$el.append(\n      this.options.template(\n        _.extend({\n          typeLabel: this.options.typeLabel,\n          isSelected: this.model.get('selected'),\n          isDisabled: this.model.get('disabled'),\n          isDestructive: this.model.get('destructive'),\n          name: name,\n          val: this.model.getValue(),\n          options: this.model.get('renderOptions'),\n          image: this.model.get('image'),\n          imageEnabled: this.options.imageEnabled\n        })\n      )\n    );\n\n    this._loadImages();\n\n    this.$el\n      .attr('data-val', this.model.getValue())\n      .toggleClass('is-disabled', !!this.model.get('disabled'));\n\n    return this;\n  },\n\n  _loadImages: function () {\n    this.iconView = new ImageLoaderView({\n      imageClass: 'CDB-Text u-actionTextColor js-assetPicker',\n      imageUrl: this.model.get('image'),\n      color: this.model.get('val')\n    });\n    this.addView(this.iconView);\n    this.$('.js-image-container').append(this.iconView.render().el);\n  },\n\n  _onClick: function (ev) {\n    this.killEvent(ev);\n    var $target = $(ev.target);\n    var isIconClicked = $target.closest('.js-image-container').length > 0;\n    var isImgClicked = $target.closest('.js-assetPicker').length > 0;\n\n    this.model.set({\n      selectedClass: isImgClicked || isIconClicked ? ['js-assetPicker'] : [],\n      selected: true\n    });\n  }\n});\n",
    "var CustomListView = require('../../../../../../custom-list/custom-list-view');\n\nmodule.exports = CustomListView.extend({\n  _renderItem: function (mdl) {\n    var ItemViewClass = this.options.ItemView;\n    var itemView = new ItemViewClass({\n      model: mdl,\n      typeLabel: this.options.typeLabel,\n      template: this.options.itemTemplate,\n      imageEnabled: this.options.imageEnabled\n    });\n    this.$('.js-list').append(itemView.render().el);\n    this.addView(itemView);\n\n    // 'customEvent' comes from custom list component\n    itemView.bind('customEvent', function (eventName, item) {\n      this.trigger('customEvent', eventName, item, this);\n    }, this);\n  }\n});\n",
    "var CustomView = require('../../../../../../custom-list/custom-view.js');\nvar itemTemplate = require('../../../../../../custom-list/custom-list-item.tpl');\nvar CategoriesListItemView = require('./categories-list-item-view');\nvar CategoriesListView = require('./categories-list-view');\n\nmodule.exports = CustomView.extend({\n  options: {\n    showSearch: true,\n    allowFreeTextInput: false,\n    typeLabel: 'column',\n    itemTemplate: itemTemplate,\n    itemView: CategoriesListItemView\n  },\n\n  _renderList: function () {\n    this._listView = new CategoriesListView({\n      model: this.model,\n      allowFreeTextInput: this.options.allowFreeTextInput,\n      collection: this.collection,\n      typeLabel: this.options.typeLabel,\n      ItemView: this.options.itemView,\n      itemTemplate: this.options.itemTemplate,\n      size: this.options.size,\n      imageEnabled: this.options.imageEnabled\n    });\n    this.$el.append(this._listView.render().el);\n    this._listView.highlight();\n    this.addView(this._listView);\n\n    // 'customEvent' comes from custom list component\n    this._listView.bind('customEvent', function (eventName, item) {\n      this.trigger(eventName, item, this);\n    }, this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CDB-ListDecoration-itemLink u-flex u-justifySpace u-alignCenter ';\n if (isSelected) { \n__p+=' is-selected ';\n } \n__p+='\">\\n  <span class=\"RampItem-text CDB-Text u-ellipsis u-actionTextColor\" title=\"'+\n((__t=( name ))==null?'':_.escape(__t))+\n'\">'+\n((__t=( name ))==null?'':_.escape(__t))+\n'</span>\\n\\n  <div class=\\'RampItem-secondaryContainer\\'>\\n    <div class=\"ColorBar RampItem-bar js-colorPicker\" style=\"background-color: '+\n((__t=( val ))==null?'':_.escape(__t))+\n';\"></div>\\n\\n    ';\n if (imageEnabled) { \n__p+='\\n      <div class=\\'RampItem-img\\'>\\n        ';\n if (image) { \n__p+='\\n          <div class=\\'js-image-container u-flex\\'></div>\\n        ';\n } else { \n__p+='\\n          <button class=\"CDB-Text u-actionTextColor js-assetPicker\">'+\n((__t=( _t('form-components.editors.fill.input-color.img') ))==null?'':__t)+\n'</button>\\n        ';\n } \n__p+='\\n      </div>\\n    ';\n } \n__p+='\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar $ = require('jquery');\nvar Utils = require('../../../../../../helpers/utils');\nvar CoreView = require('backbone/core-view');\nvar CategoriesListView = require('./categories-list/categories-view');\nvar CustomListCollection = require('../../../../../custom-list/custom-list-collection');\nvar template = require('./input-color-categories-list-view.tpl');\nvar itemTemplate = require('./input-color-categories-list-item.tpl');\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-color': '_onClickColor'\n  },\n\n  initialize: function (opts) {\n    this._showSearch = opts.showSearch || false;\n    this._typeLabel = opts.typeLabel;\n    this._maxValues = opts.maxValues;\n\n    this._setupCollection();\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n\n    this.$el.append(template({\n      range: this.model.get('range'),\n      attribute: this.model.get('attribute')\n    }));\n\n    this._listView = new CategoriesListView({\n      itemTemplate: itemTemplate,\n      collection: this._collection,\n      showSearch: this._showSearch,\n      typeLabel: this._typeLabel,\n      imageEnabled: this.options.imageEnabled\n    });\n\n    this.addView(this._listView);\n\n    this.$('.js-content').append(this._listView.render().$el);\n\n    return this;\n  },\n\n  _setupCollection: function () {\n    this._collection = new CustomListCollection(null, {silent: false});\n\n    var range = this.model.get('range');\n    var domain = this.model.get('domain');\n    var images = this.model.get('images');\n\n    if (range && range.length && domain && domain.length) {\n      var categories = _.map(range, function (color, i) {\n        var isNull = domain[i] == null || (_.isString(domain[i]) && Utils.isBlank(domain[i]));\n        var label = domain[i];\n\n        if (i >= this._maxValues) {\n          label = _t('form-components.editors.fill.input-categories.others');\n        } else if (isNull) {\n          label = _t('form-components.editors.fill.input-categories.null');\n        }\n\n        var attrs = {\n          label: label,\n          val: color\n        };\n\n        if (images && images.length) {\n          attrs['image'] = images[i];\n        }\n\n        return attrs;\n      }, this);\n\n      this._collection.reset(categories);\n    }\n  },\n\n  _onClickBack: function (e) {\n    this.killEvent(e);\n    this.trigger('back', this);\n  },\n\n  _initBinds: function () {\n    this.listenTo(this.model, 'change:range', this.render);\n    this.listenTo(this.model, 'change:domain', this.render);\n    this.listenTo(this._collection, 'change:selected', this._onSelectItem);\n  },\n\n  _onClickColor: function (ev) {\n    this.killEvent(ev);\n    var index = $(ev.target).index();\n    var color = this._collection.at(index);\n    color && this._onSelectItem(color);\n  },\n\n  _onSelectItem: function (item) {\n    var selectedItem = {\n      index: this._collection.indexOf(item),\n      target: _.contains(item.get('selectedClass'), 'js-assetPicker') ? 'asset' : 'color'\n    };\n\n    this.trigger('selectItem', selectedItem, this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CDB-Box-modalHeader\">\\n  <ul class=\"CDB-Box-modalHeaderItem CDB-Box-modalHeaderItem--block CDB-Box-modalHeaderItem--paddingHorizontal\">\\n    <li class=\"CDB-ListDecoration-item CDB-ListDecoration-itemPadding--vertical CDB-Text CDB-Size-medium u-secondaryTextColor u-flex u-alignCenter\">\\n      <ul class=\"ColorBarContainer\">\\n        ';\n _.each(range, function (color) { \n__p+='\\n          <li class=\"ColorBar ColorBar--spaceless ColorBar--clickable js-color\" style=\"background-color: '+\n((__t=( color ))==null?'':_.escape(__t))+\n';\"></li>\\n        ';\n }); \n__p+='\\n      </ul>\\n    </li>\\n  </ul>\\n</div>\\n<div class=\"js-content\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar CDB = require('cartodb.js');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar template = require('./input-color-categories.tpl');\nvar StackLayoutView = require('../../../../../../components/stack-layout/stack-layout-view');\nvar InputColorPickerView = require('../input-color-picker/input-color-picker-view');\nvar CategoriesListView = require('./input-color-categories-list-view');\nvar rampList = require('cartocolor');\nvar AssetPickerView = require('../assets-picker/input-asset-picker-view');\nvar MAX_VALUES = 10;\nvar DEFAULT_COLORS = _.clone(rampList.Prism[MAX_VALUES + 1]); // max values + \"others\" color\nvar queryTemplate = _.template('SELECT <%= column %>, count(<%= column %>) FROM (<%= sql %>) _table_sql GROUP BY <%= column %> ORDER BY count DESC, <%= column %> ASC LIMIT <%= max_values %>');\nvar checkAndBuildOpts = require('../../../../../../helpers/required-opts');\nvar REQUIRED_OPTS = [\n  'columns',\n  'configModel',\n  'modals',\n  'query',\n  'userModel'\n];\n\nfunction _quote (c) {\n  if (c && c !== true) {\n    return '\"' + c.toString().replace(/\"/g, '\\\\\"').replace(/\\n/g, '\\\\n') + '\"';\n  }\n  return c;\n}\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-back': '_onClickBack',\n    'click .js-quantification': '_onClickQuantification'\n  },\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n    this._imageEnabled = opts.imageEnabled;\n    this.listenTo(this.model, 'change:attribute', this._fetchColumns);\n    this._viewModel = new Backbone.Model({\n      step: 0,\n      status: 'idle'\n    });\n\n    this.listenTo(this._viewModel, 'change:status', this.render);\n\n    // If it comes from a quantification change\n    if (this.model.hasChanged('quantification') && this.model.get('quantification') === 'category') {\n      this._fetchColumns();\n    }\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n\n    var column = this._getColumn();\n    var columnType = column && column.type;\n\n    this.$el.append(template({\n      status: this._viewModel.get('status'),\n      columnType: columnType,\n      attribute: this.model.get('attribute'),\n      quantification: this.model.get('quantification') || 'category'\n    }));\n\n    this._generateStackLayoutView();\n\n    return this;\n  },\n\n  _generateStackLayoutView: function () {\n    var currentStep = this._viewModel.get('step');\n\n    var stackViewCollection = new Backbone.Collection([{\n      selected: currentStep === 0,\n      createStackView: function (stackLayoutModel, opts) {\n        return this._createRangeListView(stackLayoutModel, opts).bind(this);\n      }.bind(this)\n    }, {\n      selected: currentStep === 1,\n      createStackView: function (stackLayoutModel, opts) {\n        return this._createColorPickerView(stackLayoutModel, opts).bind(this);\n      }.bind(this)\n    }]);\n\n    if (this._iconStylingEnabled()) {\n      stackViewCollection.add({\n        selected: currentStep === 2,\n        createStackView: function (stackLayoutModel, opts) {\n          return this._createImagePickerView(stackLayoutModel, opts).bind(this);\n        }.bind(this)\n      });\n    }\n\n    this._stackLayoutView = new StackLayoutView({ collection: stackViewCollection });\n    this._stackLayoutView.bind('positionChanged', this._onStackLayoutPositionChange, this);\n\n    this.addView(this._stackLayoutView);\n    this.$('.js-content').append(this._stackLayoutView.render().$el);\n  },\n\n  _onStackLayoutPositionChange: function () {\n    this.$('.js-prevStep').toggle(this._stackLayoutView.getCurrentPosition() === 0);\n  },\n\n  _iconStylingEnabled: function () {\n    return this._imageEnabled;\n  },\n\n  _getColumn: function () {\n    return _.find(this._columns, function (column) {\n      return column.label === this.model.get('attribute');\n    }, this);\n  },\n\n  _fetchColumns: function () {\n    if (!this.model.get('attribute')) {\n      return;\n    }\n\n    if (this._query) {\n      this._setViewStatus('loading');\n\n      var sql = new CDB.SQL({\n        user: this._configModel.get('user_name'),\n        sql_api_template: this._configModel.get('sql_api_template'),\n        api_key: this._configModel.get('api_key')\n      });\n\n      sql.execute(\n        queryTemplate({\n          sql: this._query,\n          column: this.model.get('attribute'),\n          max_values: MAX_VALUES + 1\n        }),\n        null,\n        {\n          success: this._onQueryDone.bind(this),\n          error: function () {\n            this._setViewStatus('error');\n          }.bind(this)\n        }\n      );\n    } else {\n      this._onQueryDone();\n    }\n  },\n\n  _onQueryDone: function (data) {\n    data = data || {};\n    this._updateRangeAndDomain(data.rows);\n    this._setViewStatus('idle');\n  },\n\n  _updateRangeAndDomain: function (rows) {\n    rows = rows || [];\n    var categoryNames = _.pluck(rows, this.model.get('attribute'));\n\n    var domain = _.map(categoryNames, function (name, i) {\n      return name;\n    }).slice(0, MAX_VALUES);\n\n    if (this.model.get('attribute_type') !== 'number') {\n      domain = domain.filter(function (item, pos, self) {\n        return self.indexOf(item) === pos;\n      }).map(_quote);\n    }\n\n    var range = _.map(categoryNames, function (name, i) {\n      return (i < MAX_VALUES) ? DEFAULT_COLORS[i] : DEFAULT_COLORS[MAX_VALUES + 1];\n    });\n\n    if (this._iconStylingEnabled()) {\n      var images = _.map(categoryNames, function () {\n        return '';\n      });\n\n      this.model.attributes.images = images;\n    }\n\n    this.model.set({\n      range: range,\n      domain: domain\n    });\n  },\n\n  _setViewStatus: function (status) {\n    var attrs = {\n      status: status\n    };\n\n    if (status === 'loading') {\n      attrs.step = 0;\n    }\n\n    this._viewModel.set(attrs);\n  },\n\n  _getRange: function () {\n    return _.map(this.model.get('range'), function (color, i) {\n      var range = {\n        val: color,\n        color: color,\n        title: this.model.get('domain')[i]\n      };\n\n      if (this._iconStylingEnabled()) {\n        range.image = this.model.get('images')[i];\n      }\n\n      return range;\n    }, this);\n  },\n\n  _updateRange: function (categories) {\n    var range = _.clone(this.model.get('range'));\n    range[this._index] = categories[this._index].color;\n    this.model.set('range', range);\n  },\n\n  _createColorPickerView: function (stackLayoutModel, opts) {\n    var range = this._getRange();\n\n    var opacity = typeof this.model.get('opacity') !== 'undefined' ? this.model.get('opacity') : 1;\n\n    var view = new InputColorPickerView({\n      index: this._index,\n      ramp: range,\n      opacity: opacity,\n      imageEnabled: this._iconStylingEnabled()\n    });\n\n    view.bind('back', function (value) {\n      stackLayoutModel.prevStep();\n    }, this);\n\n    view.bind('goToAssetPicker', function () {\n      stackLayoutModel.nextStep();\n    }, this);\n\n    view.bind('change', this._updateRange, this);\n    view.bind('changeIndex', function (index) {\n      this._index = index;\n    }, this);\n    view.bind('change:opacity', function (opacity) {\n      this.model.set('opacity', opacity);\n    }, this);\n\n    return view;\n  },\n\n  _createRangeListView: function (stackLayoutModel, opts) {\n    var view = new CategoriesListView({\n      maxValues: MAX_VALUES,\n      model: this.model,\n      imageEnabled: this._iconStylingEnabled()\n    });\n\n    view.bind('back', function (value) {\n      stackLayoutModel.prevStep();\n    }, this);\n\n    view.bind('selectItem', function (item) {\n      this._index = item.index;\n\n      if (item.target === 'asset') {\n        stackLayoutModel.goToStep(2);\n      } else {\n        stackLayoutModel.goToStep(1);\n      }\n    }, this);\n\n    return view;\n  },\n\n  _createImagePickerView: function (stackLayoutModel, opts) {\n    var range = this._getRange();\n\n    var view = new AssetPickerView({\n      userModel: this._userModel,\n      configModel: this._configModel,\n      index: this._index,\n      ramp: range,\n      modals: this._modals,\n      imageEnabled: this._iconStylingEnabled()\n    });\n\n    view.bind('back', function (value) {\n      stackLayoutModel.goToStep(0);\n    }, this);\n\n    view.bind('goToColorPicker', function () {\n      stackLayoutModel.prevStep();\n    }, this);\n\n    if (this._iconStylingEnabled()) {\n      view.bind('change:image', this._onImageChanged, this);\n    }\n\n    return view;\n  },\n\n  _onImageChanged: function (data) {\n    var images = _.clone(this.model.get('images'));\n    images[this._index] = data.url;\n    this.model.set('images', images);\n  },\n\n  _onClickQuantification: function (e) {\n    this.killEvent(e);\n    this.trigger('selectQuantification', this);\n  },\n\n  _onClickBack: function (e) {\n    this.killEvent(e);\n    this.trigger('back', this);\n  }\n}, {\n  MAX_VALUES: MAX_VALUES\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CDB-Box-modalHeader js-prevStep\">\\n  <ul class=\"CDB-Box-modalHeaderItem CDB-Box-modalHeaderItem--block CDB-Box-modalHeaderItem--paddingHorizontal\">\\n    <li class=\"CDB-ListDecoration-item CDB-ListDecoration-itemPadding--vertical CDB-Text CDB-Size-medium u-secondaryTextColor\">\\n      <ul class=\"u-flex u-justifySpace\">\\n        <li class=\"u-flex\">\\n          <button class=\"u-rSpace u-actionTextColor js-back\">\\n            <i class=\"CDB-IconFont CDB-IconFont-arrowPrev Size-large\"></i>\\n          </button>\\n          <span class=\"label js-label\">'+\n((__t=( attribute ))==null?'':_.escape(__t))+\n'</span>\\n        </li>\\n        ';\n if (columnType === 'number') { \n__p+='\\n          <li class=\"u-flex\">\\n            '+\n((__t=( _t('form-components.editors.fill.quantification.methods.' + quantification) ))==null?'':_.escape(__t))+\n'\\n            <button class=\"CDB-Shape u-lSpace js-quantification\">\\n              <div class=\"CDB-Shape-threePoints is-horizontal is-blue is-small\">\\n                <div class=\"CDB-Shape-threePointsItem\"></div>\\n                <div class=\"CDB-Shape-threePointsItem\"></div>\\n                <div class=\"CDB-Shape-threePointsItem\"></div>\\n              </div>\\n            </button>\\n          </li>\\n        ';\n } \n__p+='\\n      </ul>\\n    </li>\\n  </ul>\\n</div>\\n\\n';\n if (status === 'loading') { \n__p+='\\n  <div class=\"InputColorCategory-loader js-loader\">\\n    <div class=\"CDB-LoaderIcon is-dark\">\\n      <svg class=\"CDB-LoaderIcon-spinner\" viewBox=\"0 0 50 50\">\\n        <circle class=\"CDB-LoaderIcon-path\" cx=\"25\" cy=\"25\" r=\"20\" fill=\"none\"></circle>\\n      </svg>\\n    </div>\\n  </div>\\n';\n } else if (status === 'error') { \n__p+='\\n  <div class=\"u-flex u-alignCenter u-justifyCenter CDB-Text CDB-Size-medium u-bSpace--m u-tSpace--m u-errorTextColor\">'+\n((__t=( _t('form-components.editors.fill.error') ))==null?'':_.escape(__t))+\n'</div>\\n';\n } else { \n__p+='\\n  <div class=\"InputColorCategory-content js-content\"></div>\\n';\n } \n__p+='';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar tabPaneTemplate = require('../fill-tab-pane.tpl');\nvar createTextLabelsTabPane = require('../../../../../components/tab-pane/create-text-labels-tab-pane');\nvar InputColorFixedContentView = require('./input-color-fixed-content-view');\nvar InputColorValueContentView = require('./input-color-value-content-view');\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    if (this.options.editorAttrs) {\n      var editorAttrs = this.options.editorAttrs;\n\n      if (editorAttrs.hidePanes) {\n        this._hidePanes = editorAttrs.hidePanes;\n\n        if (!_.contains(this._hidePanes, 'value')) {\n          if (!opts.configModel) throw new Error('configModel param is required');\n          if (!opts.userModel) throw new Error('userModel param is required');\n          if (!opts.modals) throw new Error('modals param is required');\n          if (!opts.query) throw new Error('query param is required');\n        }\n      }\n\n      if (editorAttrs.categorizeColumns) {\n        this._categorizeColumns = true;\n      }\n\n      if (editorAttrs.imageEnabled) {\n        this._imageEnabled = true;\n      }\n    }\n\n    if (!opts.columns) throw new Error('columns is required');\n\n    this._columns = opts.columns;\n    this._configModel = opts.configModel;\n    this._userModel = opts.userModel;\n    this._modals = opts.modals;\n    this._query = opts.query;\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this._initViews();\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.on('change:fixed', function () {\n      if (!this.model.get('fixed') || this.model.get('range')) {\n        this.model.unset('image', { silent: true });\n      }\n    }, this);\n  },\n\n  _initViews: function () {\n    var self = this;\n\n    var fixedPane = {\n      name: 'fixed',\n      label: _t('form-components.editors.fill.input-color.solid'),\n      createContentView: function () {\n        return self._generateFixedContentView();\n      }\n    };\n\n    var valuePane = {\n      name: 'value',\n      label: _t('form-components.editors.fill.input-color.value'),\n      createContentView: function () {\n        return self._generateValueContentView();\n      }\n    };\n\n    this._tabPaneTabs = [];\n\n    if (this._hidePanes) {\n      if (!_.contains(this._hidePanes, 'fixed')) {\n        this._tabPaneTabs.push(fixedPane);\n      }\n      if (!_.contains(this._hidePanes, 'value')) {\n        this._tabPaneTabs.push(valuePane);\n      }\n    } else {\n      this._tabPaneTabs = [fixedPane, valuePane];\n    }\n\n    var tabPaneOptions = {\n      tabPaneOptions: {\n        template: tabPaneTemplate,\n        tabPaneItemOptions: {\n          tagName: 'li',\n          className: 'CDB-NavMenu-item'\n        }\n      },\n      tabPaneItemLabelOptions: {\n        tagName: 'button',\n        className: 'CDB-NavMenu-link u-upperCase'\n      }\n    };\n\n    if (this.model.get('range') && this._tabPaneTabs.length > 1) {\n      this._tabPaneTabs[1].selected = true;\n    }\n\n    this._tabPaneView = createTextLabelsTabPane(this._tabPaneTabs, tabPaneOptions);\n    this._tabPaneView.collection.bind('change:selected', this._onChangeTabPaneViewTab, this);\n    this.$el.append(this._tabPaneView.render().$el);\n    this.addView(this._tabPaneView);\n  },\n\n  _onChangeTabPaneViewTab: function () {\n    var selectedTabPaneName = this._tabPaneView.getSelectedTabPaneName();\n    var attrsToUnsetIfFixed = ['domain', 'bins', 'attribute', 'quantification'];\n\n    if (selectedTabPaneName === 'fixed') {\n      _.each(attrsToUnsetIfFixed, function (attr) {\n        this.model.unset(attr, { silent: true });\n      }, this);\n\n      if (!this.model.get('fixed')) {\n        if (this.model.get('range')) {\n          this.model.set('fixed', this.model.get('range')[0]);\n          this.model.unset('range');\n        } else {\n          this.model.set('fixed', '#0303FF');\n        }\n      }\n    }\n\n    this.trigger('change', selectedTabPaneName, this);\n  },\n\n  _generateFixedContentView: function () {\n    return new InputColorFixedContentView({\n      model: this.model,\n      configModel: this._configModel,\n      userModel: this._userModel,\n      modals: this._modals,\n      editorAttrs: this.options.editorAttrs\n    });\n  },\n\n  _generateValueContentView: function () {\n    return new InputColorValueContentView({\n      model: this.model,\n      columns: this._columns,\n      configModel: this._configModel,\n      categorizeColumns: this._categorizeColumns,\n      imageEnabled: this._imageEnabled,\n      userModel: this._userModel,\n      modals: this._modals,\n      hideTabs: this.options.hideTabs,\n      query: this._query\n    });\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"js-selector\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./input-color-file-view.tpl');\nvar AssetsView = require('./assets-picker/assets-view');\nvar CarouselFormView = require('../../../../../components/carousel-form-view');\nvar CarouselCollection = require('../../../../../components/custom-carousel/custom-carousel-collection');\nvar StaticAssetsCollection = require('../../../../../data/static-assets-collection');\nvar StaticAssetModel = require('../../../../../data/static-asset-model');\nvar AssetTemplate = require('./assets-picker/static-asset-item-view.tpl');\nvar CarouselTemplate = require('./input-color-file-carousel.tpl');\nvar MakiIcons = require('./assets/maki-icons');\n\nmodule.exports = CoreView.extend({\n\n  events: {\n    'click .js-show-collection': '_onClickShowCollection'\n  },\n\n  initialize: function (opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.modals) throw new Error('modals is required');\n\n    this._configModel = opts.configModel;\n    this._userModel = opts.userModel;\n    this._modals = opts.modals;\n\n    this._initCarouselCollection();\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template());\n    this._renderAssets();\n    return this;\n  },\n\n  _initBinds: function () {\n    this.listenTo(this._carouselCollection, 'change:selected', this._onSelectAsset);\n    this.listenTo(this._carouselCollection, 'reset', this.render);\n  },\n\n  _resetCarouselCollection: function (url) {\n    this._icons.reset(MakiIcons.icons);\n\n    var selectedItem = this._carouselCollection.find(function (m) { return m.get('url') === url; });\n\n    if (selectedItem) {\n      selectedItem.set('selected', true);\n    }\n\n    this._icons.unshift(this._resetAsset);\n    this._carouselCollection.reset(this._getIcons());\n  },\n\n  _initCarouselCollection: function () {\n    this._icons = new StaticAssetsCollection(MakiIcons.icons);\n    this.add_related_model(this._icons);\n\n    this._resetAsset = new StaticAssetModel({\n      type: 'none',\n      selected: !this._getIconSelected(),\n      name: _t('form-components.editors.fill.image.none'),\n      action: function (m) {\n        this._resetImage(m);\n      }.bind(this)\n    });\n\n    this._icons.unshift(this._resetAsset);\n\n    this._carouselCollection = new CarouselCollection(this._getIcons());\n    this.add_related_model(this._carouselCollection);\n  },\n\n  _getIcons: function () {\n    var defaultAction = function (m) {\n      this._changeIcon(m);\n    }.bind(this);\n\n    return this._icons.map(function (icon) {\n      var type = icon.get('type') ? icon.get('type') : 'icon';\n      var action = icon.get('action') ? icon.get('action') : defaultAction;\n      var selectedIcon = this._getIconSelected();\n\n      return {\n        selected: icon.get('selected') || icon.getURLFor(icon.get('icon')) === selectedIcon,\n        icon: icon,\n        type: type,\n        name: icon.get('name'),\n        url: icon.get('public_url'),\n        action: action,\n        template: function () {\n          return AssetTemplate({ type: type, public_url: icon.get('public_url') + '?req=markup', name: icon.get('name') });\n        }\n      };\n    }, this);\n  },\n\n  _getIconSelected: function () {\n    if (this.model.get('ramp')) {\n      var rampIndex = this.model.get('index') || 0;\n      var categoryImage = this.model.get('ramp')[rampIndex].image;\n\n      return categoryImage || '';\n    } else {\n      return this.model.get('image') || '';\n    }\n  },\n\n  _renderAssets: function () {\n    this.clearSubViews();\n    this.$el.html(template());\n\n    var view = new CarouselFormView({\n      collection: this._carouselCollection,\n      template: CarouselTemplate,\n      listItemOptions: {\n        className: 'Carousel-item AssetListItem'\n      },\n      itemOptions: {\n        className: 'AssetItem-button'\n      }\n    });\n\n    this.addView(view);\n    this.$('.js-assets').append(view.render().el);\n  },\n\n  _onSelectAsset: function (m) {\n    m.get('action')(m);\n  },\n\n  _changeIcon: function (m) {\n    var icon = m.get('icon');\n\n    this.trigger('change', {\n      url: icon.get('public_url'),\n      kind: icon.get('kind')\n    }, this);\n  },\n\n  _resetImage: function () {\n    this.trigger('change', null, this);\n  },\n\n  _onClickShowCollection: function (e) {\n    this.killEvent(e);\n\n    var self = this;\n\n    this._modals.create(function (modalModel) {\n      var view = new AssetsView({\n        model: self.model,\n        modalModel: modalModel,\n        configModel: self._configModel,\n        userModel: self._userModel\n      });\n\n      view.bind('change', function (data) {\n        this._resetCarouselCollection(data.url);\n        this.trigger('change', data, this);\n      }, self);\n\n      return view;\n    });\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-boxModalContent js-assets\">\\n  <h2 class=\"CDB-Text CDB-Size-small u-bSpace--m u-upperCase\">\\n    '+\n((__t=( _t('form-components.editors.fill.image.recently-title') ))==null?'':_.escape(__t))+\n'\\n  </h2>\\n</div>\\n<div class=\"CustomRamp-list\">\\n  <div class=\"CustomList-item CustomList-item--add\">\\n    <button class=\"CDB-ListDecoration-itemLink CDB-Text CDB-Size-medium u-actionTextColor js-show-collection\" type=\"button\">\\n      '+\n((__t=( _t('form-components.editors.fill.image.show-all') ))==null?'':_.escape(__t))+\n'\\n    </button>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar tabPaneTemplate = require('../fill-tab-pane.tpl');\nvar createMixedLabelsTabPane = require('../../../../../components/tab-pane/create-mixed-labels-tab-pane');\nvar ColorPicker = require('../color-picker/color-picker');\nvar InputColorFileView = require('./input-color-file-view');\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    if (this.options.editorAttrs) {\n      var editorAttrs = this.options.editorAttrs;\n\n      this._imageEnabled = editorAttrs.imageEnabled;\n\n      if (editorAttrs.hidePanes) {\n        this._hidePanes = editorAttrs.hidePanes;\n\n        if (this._imageEnabled && !_.contains(this._hidePanes, 'file')) {\n          if (!opts.configModel) throw new Error('configModel param is required');\n          if (!opts.userModel) throw new Error('userModel param is required');\n          if (!opts.modals) throw new Error('modals param is required');\n        }\n      }\n\n      if (editorAttrs.disableOpacity) {\n        this._disableOpacity = true;\n      }\n    }\n\n    this._userModel = opts.userModel;\n    this._configModel = opts.configModel;\n    this._modals = opts.modals;\n    this._query = opts.query;\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    if (this._imageEnabled) {\n      this._setupTabPanes();\n    }\n\n    if (this._tabPaneView) {\n      this.$el.append(this._tabPaneView.render().$el);\n    } else {\n      this.$el.append(this._generateFixedContentView().render().$el);\n    }\n    return this;\n  },\n\n  _setupTabPanes: function () {\n    var self = this;\n\n    var fixedPane = {\n      name: 'fixed',\n      type: 'color',\n      label: this.model.get('fixed'),\n      createContentView: function () {\n        return self._generateFixedContentView();\n      }\n    };\n\n    var filePane = {\n      name: 'file',\n      type: this.model.get('image') ? 'image' : 'text',\n      label: this.model.get('image') || _t('form-components.editors.fill.input-color.img'),\n      kind: this.model.get('kind') || 'marker',\n      color: this.model.get('fixed'),\n      createContentView: function () {\n        return self._generateFileContentView();\n      }\n    };\n\n    this._tabPaneTabs = [];\n\n    if (this.options.editorAttrs && this.options.editorAttrs.hidePanes) {\n      this._hidePanes = this.options.editorAttrs.hidePanes;\n\n      if (!_.contains(this._hidePanes, 'fixed')) {\n        this._tabPaneTabs.push(fixedPane);\n      }\n\n      if (!_.contains(this._hidePanes, 'file')) {\n        this._tabPaneTabs.push(filePane);\n      }\n    } else {\n      this._tabPaneTabs = [fixedPane, filePane];\n    }\n\n    var tabPaneOptions = {\n      tabPaneOptions: {\n        template: tabPaneTemplate,\n        tabPaneItemOptions: {\n          tagName: 'li',\n          className: 'CDB-NavMenu-item'\n        }\n      },\n      tabPaneItemLabelOptions: {\n        tagName: 'button',\n        className: 'CDB-NavMenu-link u-upperCase'\n      }\n    };\n\n    if (this.model.get('image') && this._tabPaneTabs.length > 1) {\n      this._tabPaneTabs[1].selected = true;\n    }\n    this.listenTo(this.model, 'change:image', this._updateImageTabPane);\n    this.listenTo(this.model, 'change:fixed', this._updateTextTabPane);\n\n    this._tabPaneView = createMixedLabelsTabPane(this._tabPaneTabs, tabPaneOptions);\n    this.addView(this._tabPaneView);\n  },\n\n  _updateTextTabPane: function () {\n    this._updateImageTabPane();\n    this._tabPaneView.collection.at(0).set('label', this.model.get('fixed'));\n  },\n\n  _updateImageTabPane: function () {\n    if (this.model.get('image')) {\n      this._tabPaneView.collection.at(1).set({ label: this.model.get('image'), color: this.model.get('fixed') });\n    } else {\n      this._tabPaneView.collection.at(1).set('label', _t('form-components.editors.fill.input-color.img'));\n    }\n  },\n\n  _generateFixedContentView: function () {\n    var contentView = new ColorPicker({\n      value: this.model.get('fixed'),\n      opacity: this.model.get('opacity'),\n      disableOpacity: this._disableOpacity\n    });\n\n    contentView.bind('change', this._onChangeValue, this);\n    return contentView;\n  },\n\n  _generateFileContentView: function () {\n    var contentView = new InputColorFileView({\n      model: this.model,\n      userModel: this._userModel,\n      configModel: this._configModel,\n      modals: this._modals\n    });\n\n    contentView.bind('change', this._onChangeFile, this);\n    return contentView;\n  },\n\n  _onChangeFile: function (data) {\n    if (data && data.url) {\n      this.model.set({\n        image: data.url,\n        kind: data.kind\n      });\n    } else {\n      this.model.unset('image');\n    }\n  },\n\n  _onChangeValue: function (color) {\n    this.model.set({ fixed: color.hex, opacity: color.opacity });\n  }\n});\n",
    "var $ = require('jquery');\nvar _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar ImageLoaderView = require('../../../../../img-loader-view');\nvar template = require('./input-color-picker-header.tpl');\nvar MAX = 1;\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-color': '_onClickColor',\n    'click .js-assetPicker': '_onClickAssetPicker',\n    'keyup .js-a': '_onChangeOpacity'\n  },\n\n  initialize: function (opts) {\n    this.listenTo(this.model, 'change', this.render);\n  },\n\n  render: function (model, options) {\n    if (model && model.changed && typeof model.changed.opacity !== 'undefined') {\n      this._reRenderOpacity();\n      return this;\n    }\n\n    this.clearSubViews();\n    this.$el.empty();\n\n    var rampItem = this._getRampItem();\n    this.$el.append(template({\n      ramp: this.model.get('ramp'),\n      index: this.model.get('index'),\n      opacity: this.model.get('opacity'),\n      label: rampItem.title || _t('form-components.editors.fill.input-categories.others'),\n      color: rampItem.color || '',\n      iconStylingEnabled: this.options.iconStylingEnabled,\n      isCategorized: _.has(rampItem, 'image'),\n      image: rampItem.image || '',\n      imageEnabled: this.options.imageEnabled\n    }));\n\n    this._slider = this.$('.js-slider').slider({\n      range: 'min',\n      value: this._inverseSliderValue(this.model.get('opacity')),\n      min: 0,\n      max: MAX,\n      step: 0.02,\n      orientation: 'horizontal',\n      disabled: false,\n      slide: this._onSlideChange.bind(this)\n    });\n\n    this._loadImages();\n\n    return this;\n  },\n\n  _getRampItem: function () {\n    var ramp = this.model.get('ramp');\n\n    if (!ramp) {\n      return {\n        color: '',\n        title: _t('form-components.editors.fill.input-categories.others'),\n        image: ''\n      };\n    }\n\n    return ramp[this.model.get('index')];\n  },\n\n  _loadImages: function () {\n    var rampItem = this._getRampItem();\n\n    this.iconView = new ImageLoaderView({\n      imageClass: 'CDB-Text u-actionTextColor js-assetPicker',\n      imageUrl: rampItem.image,\n      color: rampItem.color\n    });\n    this.addView(this.iconView);\n    this.$('.js-image-container').append(this.iconView.render().el);\n  },\n\n  _onClickColor: function (ev) {\n    this.killEvent(ev);\n    this.model.set('index', $(ev.target).index());\n  },\n\n  _onClickBack: function (ev) {\n    this.killEvent(ev);\n    this.trigger('back', this);\n  },\n\n  _onClickAssetPicker: function (ev) {\n    this.killEvent(ev);\n    this.trigger('goToAssetPicker', this);\n  },\n\n  _onSlideChange: function (evt, obj) {\n    this.model.set('opacity', this._inverseSliderValue(obj.value));\n  },\n\n  _inverseSliderValue: function (value) {\n    return parseFloat(Number(MAX - value).toFixed(2));\n  },\n\n  _onChangeOpacity: function () {\n    var $input = this.$('.js-a');\n    var value = $input.val();\n    var isValid = this._isValidOpacity(value);\n    $input.toggleClass('has-error', !isValid);\n    if (isValid) {\n      this.model.set('opacity', parseFloat(value));\n    }\n  },\n\n  _isValidOpacity: function (value) {\n    var regex = /^((0(\\.\\d+)?)|(1(\\.0)?))$/;\n    return regex.test(value);\n  },\n\n  _reRenderOpacity: function () {\n    var $input = this.$('.js-a');\n    var $slider = this.$('.js-slider');\n    var opacity = this.model.get('opacity');\n    var inputValue;\n    var sliderValue;\n\n    if ($input.length > 0) {\n      inputValue = $input.val();\n      if (!this._isValidOpacity(inputValue) || (this._isValidOpacity(inputValue) && parseFloat(inputValue) !== opacity)) {\n        $input.val(opacity);\n      }\n    }\n\n    if (typeof $slider.slider('instance') !== 'undefined') {\n      sliderValue = $slider.slider('value');\n      if (typeof sliderValue !== 'undefined' && sliderValue !== this._inverseSliderValue(opacity)) {\n        $slider.slider('value', this._inverseSliderValue(opacity));\n      }\n    }\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CDB-Box-modalHeader\">\\n  <ul class=\"CDB-Box-modalHeaderItem CDB-Box-modalHeaderItem--block CDB-Box-modalHeaderItem--paddingHorizontal\">\\n    <li class=\"CDB-ListDecoration-item CDB-ListDecoration-itemDisplay--flex CDB-Text CDB-Size-medium u-secondaryTextColor\">\\n      <div class=\\'CDB-ListDecoration-secondaryContainer\\'>\\n        <button class=\"u-rSpace u-actionTextColor js-back\" type=\"button\">\\n          <i class=\"CDB-IconFont CDB-IconFont-arrowPrev Size-large\"></i>\\n        </button>\\n        <span class=\"label js-label\">'+\n((__t=( label ))==null?'':_.escape(__t))+\n'</span>\\n      </div>\\n\\n      ';\n if (isCategorized && imageEnabled) { \n__p+='\\n        <div class=\\'CDB-ListDecoration-secondaryContainer\\'>\\n          <nav class=\\'CDB-NavMenu\\'>\\n            <ul class=\\'CDB-NavMenu-Inner CDB-NavMenu-inner--no-margin js-menu\\'>\\n              <li class=\\'CDB-NavMenu-item is-selected\\'>\\n                <div class=\\'CDB-NavMenu-link CDB-ListDecoration-rampNav-item\\'>\\n                  <button class=\\'ColorBar CDB-ListDecoration-rampItemBar u-rSpace--xl js-colorPicker\\' type=\"button\" style=\"background-color: '+\n((__t=( color ))==null?'':__t)+\n';\"></button>\\n                </div>\\n              </li>\\n              <li class=\\'CDB-NavMenu-item\\'>\\n                <div class=\\'CDB-NavMenu-link CDB-ListDecoration-rampNav-item\\'>\\n                  ';\n if (image) { \n__p+='\\n                    <button class=\"CDB-ListDecoration-rampImg js-image-container\" type=\"button\"></button>\\n                  ';\n } else { \n__p+='\\n                    <button class=\"CDB-ListDecoration-rampImg CDB-Text u-actionTextColor js-assetPicker\" type=\"button\">'+\n((__t=( _t('form-components.editors.fill.input-color.img') ))==null?'':__t)+\n'</button>\\n                  ';\n } \n__p+='\\n                </div>\\n              </li>\\n            </ul>\\n          </nav>\\n        </div>\\n      ';\n } \n__p+='\\n    </li>\\n  </ul>\\n</div>\\n\\n<div class=\"CDB-Box-modalHeader\">\\n  <ul class=\"CDB-Box-modalHeaderItem CDB-Box-modalHeaderItem--block CDB-Box-modalHeaderItem--paddingHorizontal\">\\n    <li class=\"CDB-ListDecoration-item CDB-ListDecoration-itemPadding--vertical CDB-Text CDB-Size-medium u-secondaryTextColor\">\\n      <ul class=\"ColorBarContainer ColorBarContainer--rampEditing\">\\n        ';\n _.each(ramp, function (color, i) { \n__p+='\\n        <li class=\"ColorBar is-link ColorBar--spaceless ColorBar--clickable js-color'+\n((__t=( i === index ? ' is-selected' : '' ))==null?'':_.escape(__t))+\n'\" data-label=\"'+\n((__t=( color.title ))==null?'':_.escape(__t))+\n'\" data-color=\"'+\n((__t=( color.color ))==null?'':_.escape(__t))+\n'\" style=\"background-color: '+\n((__t=( color.color ))==null?'':_.escape(__t))+\n';\"></li>\\n        ';\n }); \n__p+='\\n      </ul>\\n      <div class=\"OpacityEditor\">\\n        <div class=\"OpacityEditor-slider js-slider\"></div>\\n        <div class=\"OpacityEditor-inputWrapper\">\\n          <input type=\"text\" class=\"CDB-InputText ColorPicker-input js-a\" value=\"'+\n((__t=( opacity ))==null?'':_.escape(__t))+\n'\">\\n        </div>\\n      </div>\\n    </li>\\n  </ul>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar ColorPicker = require('../../color-picker/color-picker');\nvar template = require('./input-color-picker-view.tpl');\nvar InputColorPickerHeader = require('./input-color-picker-header');\nvar checkAndBuildOpts = require('../../../../../../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'ramp',\n  'opacity'\n];\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-back': '_onClickBack'\n  },\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    this.model = new Backbone.Model({\n      index: this.options.index,\n      ramp: opts.ramp,\n      opacity: opts.opacity\n    });\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template());\n    this._initViews();\n    return this;\n  },\n\n  _initBinds: function () {\n    this.listenTo(this.model, 'change:index', this._onChangeIndex);\n    this.listenTo(this.model, 'change:opacity', this._onOpacityChanged);\n  },\n\n  _initViews: function () {\n    this._headerView = new InputColorPickerHeader({\n      model: this.model,\n      imageEnabled: this.options.imageEnabled\n    });\n\n    this.addView(this._headerView);\n    this._headerView.bind('goToAssetPicker', this._onGoToAssetPicker, this);\n    this.$('.js-header').append(this._headerView.render().$el);\n\n    this._colorPicker = new ColorPicker({\n      value: this._getColor(),\n      opacity: 1,\n      disableOpacity: true\n    });\n\n    this.addView(this._colorPicker);\n    this._colorPicker.bind('change', this._onChangeValue, this);\n    this.$('.js-content').append(this._colorPicker.render().$el);\n  },\n\n  _setColor: function (color) {\n    var ramp = _.clone(this.model.get('ramp'));\n    ramp[this.model.get('index')].color = color;\n    this.model.set('ramp', ramp);\n    this.model.trigger('change', ramp);\n    this.trigger('change', ramp);\n  },\n\n  _getColor: function () {\n    var ramp = this.model.get('ramp');\n    return ramp[this.model.get('index') || 0].color;\n  },\n\n  _onChangeIndex: function () {\n    this._colorPicker.setColor(this._getColor());\n    this.trigger('changeIndex', this.model.get('index'), this);\n  },\n\n  _onChangeValue: function (color) {\n    this._setColor(color.hex);\n  },\n\n  _onClickBack: function (e) {\n    this.killEvent(e);\n    this.trigger('back', this);\n  },\n\n  _onOpacityChanged: function () {\n    var opacity = this.model.get('opacity');\n    this.trigger('change:opacity', opacity);\n  },\n\n  _onGoToAssetPicker: function () {\n    this.trigger('goToAssetPicker');\n  }\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar StackLayoutView = require('../../../../../components/stack-layout/stack-layout-view');\nvar ColumnListView = require('../column-list-view');\nvar quantificationMethodItemTemplate = require('./quantification-method-item.tpl');\nvar InputColorRamps = require('./input-ramps/input-color-ramps');\nvar InputColorCategories = require('./input-categories/input-color-categories');\nvar DefaultFillSettings = require('../default-fill-settings.json');\nvar checkAndBuildOpts = require('../../../../../helpers/required-opts');\n\nvar EXCLUDED_COLUMNS = ['the_geom', 'the_geom_webmercator'];\nvar REQUIRED_OPTS = [\n  'columns',\n  'configModel',\n  'modals',\n  'query',\n  'userModel'\n];\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    this._settings = DefaultFillSettings.color;\n\n    this._categorizeColumns = opts.categorizeColumns;\n    this._imageEnabled = opts.imageEnabled;\n\n    this._column = this._getColumn();\n    this._columnType = this._column && this._column.type;\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this._initViews();\n    return this;\n  },\n\n  _initBinds: function () {\n    this.listenTo(this.model, 'change:quantification', function () {\n      if (this.model.previous('quantification') === 'category') {\n        delete this.model.attributes.range;\n      }\n\n      if (this.model.get('quantification') !== 'category') {\n        this.model.unset('domain');\n      }\n    });\n  },\n\n  _initViews: function () {\n    var self = this;\n\n    var stackViewCollection = new Backbone.Collection([{\n      createStackView: function (stackLayoutModel, opts) {\n        return self._createColumnListView(stackLayoutModel, opts).bind(self);\n      }\n    }, {\n      createStackView: function (stackLayoutModel, opts) {\n        return self._createInputColorRamps(stackLayoutModel, opts).bind(self);\n      }\n    }, {\n      createStackView: function (stackLayoutModel, opts) {\n        return self._createInputColorCategories(stackLayoutModel, opts).bind(self);\n      }\n    }, {\n      createStackView: function (stackLayoutModel, opts) {\n        return self._createQuantificationListView(stackLayoutModel, opts).bind(self);\n      }\n    }]);\n\n    this._stackLayoutView = new StackLayoutView({\n      collection: stackViewCollection\n    });\n\n    if (this.model.get('attribute')) {\n      var hasDomain = this.model.get('domain') && this.model.get('domain').length;\n      var hasRange = this.model.get('range') && this.model.get('range').length;\n      var showCategories = (this._columnType === 'string') || (hasDomain && hasRange);\n\n      if (showCategories) {\n        this._stackLayoutView.model.set('position', 2);\n      } else {\n        this._stackLayoutView.model.set('position', 1);\n      }\n    }\n\n    this.$el.append(this._stackLayoutView.render().$el);\n    this.addView(this._stackLayoutView);\n  },\n\n  _createInputColorCategories: function (stackLayoutModel, opts) {\n    var view = new InputColorCategories({\n      model: this.model,\n      query: this._query,\n      columns: this._columns,\n      configModel: this._configModel,\n      userModel: this._userModel,\n      modals: this._modals,\n      imageEnabled: this._imageEnabled\n    });\n\n    view.bind('selectQuantification', function (item) {\n      stackLayoutModel.goToStep(3);\n    }, this);\n\n    view.bind('back', function (value) {\n      stackLayoutModel.goToStep(0);\n    }, this);\n\n    return view;\n  },\n\n  _createQuantificationListView: function (stackLayoutModel, opts) {\n    var view = new ColumnListView({\n      headerTitle: _t('form-components.editors.fill.quantification.title'),\n      stackLayoutModel: stackLayoutModel,\n      itemTemplate: quantificationMethodItemTemplate,\n      columns: this._settings.quantifications.items,\n      showSearch: false\n    });\n\n    view.bind('selectItem', function (item) {\n      this.model.set('quantification', item.get('val'));\n      stackLayoutModel.goToStep(1);\n    }, this);\n\n    view.bind('back', function (value) {\n      stackLayoutModel.goToStep(0);\n    }, this);\n\n    return view;\n  },\n\n  _createInputColorRamps: function (stackLayoutModel, opts) {\n    var view = new InputColorRamps({\n      hideTabs: this.options.hideTabs,\n      model: this.model\n    });\n\n    view.bind('switch', function () {\n      stackLayoutModel.goToStep(2);\n    }, this);\n\n    view.bind('back', function (value) {\n      stackLayoutModel.prevStep();\n    }, this);\n\n    return view;\n  },\n\n  _getColumn: function (columnName) {\n    return _.find(this._columns, function (column) {\n      return column.label === (columnName || this.model.get('attribute'));\n    }, this);\n  },\n\n  _createColumnListView: function (stackLayoutModel, opts) {\n    var columns = _.reject(this._columns, function (column) {\n      return column.type === 'geometry' || _.contains(EXCLUDED_COLUMNS, column.label);\n    }, this);\n\n    var view = new ColumnListView({\n      stackLayoutModel: stackLayoutModel,\n      columns: columns,\n      showSearch: true,\n      typeLabel: 'column'\n    });\n\n    view.bind('selectItem', function (item) {\n      this._onChangeAttribute(item.get('val'), stackLayoutModel);\n    }, this);\n\n    return view;\n  },\n\n  _onChangeAttribute: function (columnName, stackLayoutModel) {\n    var validCategoryTypes = ['string', 'boolean'];\n    var attrsToUnset = ['image', 'fixed', 'quantification', 'opacity'];\n    var wasQuantificationCategory = this.model.get('quantification') === 'category';\n\n    this._column = this._getColumn(columnName);\n    this._columnType = this._column && this._column.type;\n\n    _.each(attrsToUnset, function (attr) {\n      this.model.unset(attr, { silent: true });\n    }, this);\n\n    if (_.contains(validCategoryTypes, this._columnType) || this._categorizeColumns) {\n      this.model.unset('bins', { silent: true });\n      stackLayoutModel.goToStep(2);\n    } else if (this._columnType === 'number') {\n      this.model.unset('images', { silent: true });\n      this.model.unset('domain', { silent: true });\n\n      // Unset range if previous quantification was category\n      if (wasQuantificationCategory) {\n        this.model.unset('range', { silent: true });\n      }\n\n      stackLayoutModel.goToStep(1);\n    }\n\n    this.model.set({\n      attribute: columnName,\n      attribute_type: this._columnType\n    });\n  }\n});\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar template = require('./input-color.tpl');\nvar InputDialogContent = require('./input-color-dialog-content');\nvar Utils = require('../../../../../helpers/utils');\nvar rampList = require('./input-ramps/ramps');\nvar ImageLoaderView = require('../../../../img-loader-view');\n\nmodule.exports = CoreView.extend({\n  tagName: 'li',\n  className: 'CDB-OptionInput-item',\n\n  events: {\n    'click': '_onClick'\n  },\n\n  initialize: function (opts) {\n    if (this.options.editorAttrs) {\n      this._editorAttrs = this.options.editorAttrs;\n      this._imageEnabled = this._editorAttrs.imageEnabled;\n      var hidePanes = this._editorAttrs.hidePanes;\n\n      if (hidePanes && !_.contains(hidePanes, 'value')) {\n        if (!opts.configModel) throw new Error('configModel param is required');\n        if (!opts.userModel) throw new Error('userModel param is required');\n        if (!opts.modals) throw new Error('modals param is required');\n        if (!opts.query) throw new Error('query param is required');\n      }\n    }\n\n    if (!opts.columns) throw new Error('columns is required');\n\n    this._columns = opts.columns;\n    this._configModel = opts.configModel;\n    this._userModel = opts.userModel;\n    this._modals = opts.modals;\n    this._query = opts.query;\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n\n    if (this.options.disabled) {\n      this.$el.addClass('is-disabled');\n    }\n\n    var column = this._getColumn();\n    var columnType = column && column.type;\n    var hasDomain = this.model.get('domain') && this.model.get('domain').length;\n\n    if (this.model.get('range') && _.isString(this.model.get('range'))) {\n      this._migrateRange();\n    }\n\n    var hasRange = this.model.get('range') && this.model.get('range').length;\n    var showCategories = (columnType === 'string') || (hasDomain && hasRange);\n    var imageURL = this._getImageURL();\n    var categoryImagesPresent = this._iconStylingEnabled() && !this._getImageURL() && this._categoryImagesPresent();\n\n    this.$el.html(template({\n      categoryImagesPresent: categoryImagesPresent,\n      imageURL: imageURL,\n      kind: this._getKind(),\n      showCategories: showCategories,\n      value: this._getValue(),\n      opacity: this._getOpacity()\n    }));\n\n    this._loadImages();\n\n    return this;\n  },\n\n  _loadImages: function () {\n    this.iconView = new ImageLoaderView({\n      imageClass: 'Editor-fillImageAsset',\n      imageUrl: this._getImageURL(),\n      color: this.model.get('fixed')\n    });\n    this.addView(this.iconView);\n    this.$('.js-image-container').append(this.iconView.render().el);\n  },\n\n  _categoryImagesPresent: function () {\n    var images = this.model.get('images');\n\n    for (var i in images) {\n      if (!_.isEmpty(images[i])) {\n        return true;\n      }\n    }\n\n    return false;\n  },\n\n  _iconStylingEnabled: function () {\n    return this._imageEnabled;\n  },\n\n  _getKind: function () {\n    return this.model.get('kind') && this._iconStylingEnabled() ? this.model.get('kind') : '';\n  },\n\n  _getImageURL: function () {\n    return this.model.get('image') && this._iconStylingEnabled() ? this.model.get('image') : '';\n  },\n\n  // Converts reference to the old color ramp to the full color list\n  _migrateRange: function () {\n    var rangeName = this.model.get('range');\n    var bins = this.model.get('bins') || 3;\n\n    if (rampList[rangeName] && rampList[rangeName][bins]) {\n      this.model.set('range', rampList[rangeName][bins]);\n    }\n  },\n\n  _getColumn: function () {\n    return _.find(this._columns, function (column) {\n      return column.label === this.model.get('attribute');\n    }, this);\n  },\n\n  _createContentView: function () {\n    var view = new InputDialogContent({\n      configModel: this._configModel,\n      userModel: this._userModel,\n      modals: this._modals,\n      query: this._query,\n      model: this.model,\n      columns: this._columns,\n      editorAttrs: this._editorAttrs\n    });\n\n    view.bind('change', this.render, this);\n\n    return view;\n  },\n\n  _onClick: function (e) {\n    if (this.options.disabled) {\n      return;\n    }\n    this.trigger('click', this.model);\n  },\n\n  _initBinds: function () {\n    var self = this;\n\n    this.model.set('createContentView', function () {\n      return self._createContentView();\n    }).bind(this);\n\n    this.model.on('change:images', this.render, this);\n    this.model.on('change:selected', this._onToggleSelected, this);\n    this.model.on('change:opacity', this.render, this);\n    this.model.on('change:fixed', this.render, this);\n    this.model.on('change:fixed', this._updateColor, this);\n    this.model.on('change:image', this.render, this);\n    this.model.on('change:range', this.render, this);\n  },\n\n  _updateColor: function () {\n    this.iconView && this.iconView.updateImageColor(this.model.get('fixed'));\n  },\n\n  _getValue: function () {\n    var value = this.model.get('fixed');\n\n    if (value) {\n      value = Utils.hexToRGBA(value, this._getOpacity());\n    }\n\n    if (this.model.get('range') && this.model.get('range').length) {\n      value = _.map(this.model.get('range'), function (color) {\n        return Utils.hexToRGBA(color, this._getOpacity());\n      }, this);\n    }\n\n    return value;\n  },\n\n  _getOpacity: function () {\n    return this.model.get('opacity') != null ? this.model.get('opacity') : 1;\n  },\n\n  _onToggleSelected: function () {\n    this.$el.toggleClass('is-active', this.model.get('selected'));\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='';\n if (showCategories) { \n__p+='\\n  <ul class=\"ColorsBar\">\\n    ';\n _.each(value, function (color) { \n__p+='\\n      <li class=\"ColorBar '+\n((__t=( categoryImagesPresent ? 'ColorBar--spaceSmall' : 'ColorBar--spaceMedium' ))==null?'':_.escape(__t))+\n'\" style=\"background-color: '+\n((__t=( color ))==null?'':_.escape(__t))+\n'\"></li>\\n    ';\n }); \n__p+='\\n  </ul>\\n';\n } else { \n__p+='\\n  <button type=\"button\" class=\"Editor-fillContainer\">\\n    <ul class=\"ColorBarContainer\">\\n      ';\n if (_.isArray(value)) { \n__p+='\\n        <li class=\"ColorBar ColorBar-gradient\" style=\"background: linear-gradient(90deg,'+\n((__t=( value.join(',') ))==null?'':_.escape(__t))+\n')\"></li>\\n      ';\n } else { \n__p+='\\n        <li class=\"ColorBar\" style=\"background-color: '+\n((__t=( value ))==null?'':_.escape(__t))+\n'\"></li>\\n      ';\n } \n__p+='\\n    </ul>\\n  </button>\\n';\n } \n__p+='\\n\\n';\n if (imageURL && kind !== 'custom-marker') { \n__p+='\\n<button type=\"button\" class=\"Editor-fillImage\">\\n  <div class=\"js-image-container\"></div>\\n</button>\\n';\n } \n__p+='\\n\\n';\n if ((!imageURL && categoryImagesPresent) || (imageURL && kind === 'custom-marker')) { \n__p+='\\n<button type=\"button\" class=\"Editor-fillImage\">\\n  <div class=\\'Editor-categoryImagesTag CDB-Text CDB-FontSize-small u-altTextColor is-semibold u-upperCase\\'>'+\n((__t=( _t('form-components.editors.fill.input-color.img') ))==null?'':__t)+\n'</div>\\n</button>\\n';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='';\n if (customRamp && customRamp.length) { \n__p+='\\n<li class=\"CDB-ListDecoration-item CustomList-item CustomRamp js-customRampItem\">\\n  <div class=\"CustomRamp-listOptions CDB-ListDecoration-itemLink CDB-ListDecoration-itemLink--double js-customRamp js-listItemLink is-selected\">\\n    <ul class=\"ColorBarContainer\">\\n      ';\n _.each(customRamp, function (color) { \n__p+='\\n      <li class=\"ColorBar ColorBar--spaceless\" style=\"background-color: '+\n((__t=( color ))==null?'':_.escape(__t))+\n';\"></li>\\n      ';\n }); \n__p+='\\n    </ul>\\n  </div>\\n  <button class=\"CDB-ListDecoration-itemLink CustomRamp-clear js-clear\">\\n    <div class=\"CDB-Shape\">\\n      <div class=\"CDB-Shape-close is-blue is-large\"></div>\\n    </div>\\n  </button>\\n</li>\\n';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar StackLayoutView = require('../../../../../../components/stack-layout/stack-layout-view');\nvar ColumnListView = require('../../column-list-view');\nvar quantificationMethodItemTemplate = require('../quantification-method-item.tpl');\nvar InputRampContentView = require('./input-ramp-content-view');\nvar rampList = require('cartocolor');\nvar DefaultFillSettings = require('../../default-fill-settings.json');\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    this._settings = DefaultFillSettings['color-ramps'];\n\n    this._setupModel();\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this._initViews();\n    return this;\n  },\n\n  _setupModel: function () {\n    var options = {};\n\n    if (!this.model.get('quantification')) {\n      options.quantification = this._settings.quantifications.items[this._settings.quantifications.defaultIndex];\n    }\n\n    if (!this.model.get('bins')) {\n      options.bins = this._settings.bins.items[this._settings.bins.defaultIndex];\n    }\n\n    if (+this.model.get('bins') > +this._settings.bins.items[this._settings.bins.items.length - 1]) {\n      options.bins = this._settings.bins.items[this._settings.bins.items.length - 1];\n    }\n\n    this.model.set(options);\n  },\n\n  _initBinds: function () {\n    var range = this.model.get('range');\n\n    this.listenTo(this.model, 'change:bins', this._updateRange);\n    this.listenTo(this.model, 'change:attribute', this.render);\n    this.listenTo(this.model, 'change:quantification', this._onChangeQuantification);\n\n    this.model.unset('fixed');\n\n    if (!range || !this._isValidRange(range)) {\n      this.model.set('range', this._getDefaultRamp());\n    }\n  },\n\n  // range minimun size should be 2\n  _isValidRange: function (range) {\n    return range && range.length > 1 || false;\n  },\n\n  _initViews: function () {\n    var self = this;\n\n    var collectionOptions = [\n      {\n        createStackView: function (stackLayoutModel, opts) {\n          return self._createInputRampContentView(stackLayoutModel, opts).bind(self);\n        }\n      }\n    ];\n\n    if (!this.options.hideTabs || !_.contains(this.options.hideTabs, 'quantification')) {\n      collectionOptions.push(\n        {\n          createStackView: function (stackLayoutModel, opts) {\n            return self._createQuantificationListView(stackLayoutModel, opts).bind(self);\n          }\n        }\n      );\n    }\n\n    if (!this.options.hideTabs || !_.contains(this.options.hideTabs, 'bins')) {\n      collectionOptions.push(\n        {\n          createStackView: function (stackLayoutModel, opts) {\n            return self._createBinsListView(stackLayoutModel, opts).bind(self);\n          }\n        }\n      );\n    }\n\n    var stackViewCollection = new Backbone.Collection(collectionOptions);\n\n    this._stackLayoutView = new StackLayoutView({\n      collection: stackViewCollection\n    });\n\n    this.$el.append(this._stackLayoutView.render().$el);\n    this.addView(this._stackLayoutView);\n  },\n\n  _updateRange: function () {\n    var previousBins = this.model.previous('bins');\n\n    if (!previousBins) {\n      return;\n    }\n\n    var previousRamps = _.find(rampList, function (ramp) {\n      var previousRamp = ramp[previousBins];\n      var range = this.model.get('range');\n      return previousRamp && range && previousRamp.join('').toLowerCase() === range.join('').toLowerCase();\n    }, this);\n\n    if (previousRamps) {\n      var bins = this.model.get('bins');\n      this.model.set('range', previousRamps[bins]);\n    }\n  },\n\n  _createInputRampContentView: function (stackLayoutModel, opts) {\n    var view = new InputRampContentView({\n      stackLayoutModel: stackLayoutModel,\n      model: this.model\n    });\n\n    view.bind('back', function (value) {\n      this.trigger('back');\n    }, this);\n\n    view.bind('selectItem', function (value) {\n      this.model.unset('domain');\n      this.model.set('range', value);\n    }, this);\n\n    view.bind('selectQuantification', function (value) {\n      stackLayoutModel.goToStep(1);\n    }, this);\n\n    view.bind('selectBins', function (value) {\n      stackLayoutModel.goToStep(2);\n    }, this);\n\n    return view;\n  },\n\n  _createBinsListView: function (stackLayoutModel, opts) {\n    var view = new ColumnListView({\n      headerTitle: _t('form-components.editors.fill.bins'),\n      stackLayoutModel: stackLayoutModel,\n      columns: this._settings.bins.items\n    });\n\n    view.bind('selectItem', function (item) {\n      this.model.set('bins', item.get('val'));\n      stackLayoutModel.goToStep(0);\n    }, this);\n\n    view.bind('back', function (value) {\n      stackLayoutModel.goToStep(0);\n    }, this);\n\n    return view;\n  },\n\n  _createQuantificationListView: function (stackLayoutModel, opts) {\n    var view = new ColumnListView({\n      headerTitle: _t('form-components.editors.fill.quantification.title'),\n      stackLayoutModel: stackLayoutModel,\n      itemTemplate: quantificationMethodItemTemplate,\n      columns: this._settings.quantifications.items,\n      showSearch: false\n    });\n\n    view.bind('selectItem', function (item) {\n      this.model.set('quantification', item.get('val'));\n      stackLayoutModel.prevStep();\n    }, this);\n\n    view.bind('back', function (value) {\n      stackLayoutModel.goToStep(0);\n    }, this);\n\n    return view;\n  },\n\n  _getDefaultRamp: function () {\n    return _.map(rampList, function (ramp) {\n      return ramp[this.model.get('bins')];\n    }, this)[0];\n  },\n\n  _onChangeQuantification: function () {\n    if (this.model.get('quantification') === 'category') {\n      this.trigger('switch', this);\n    }\n  },\n\n  remove: function () {\n    CoreView.prototype.remove.apply(this);\n  }\n});\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar InputRampListView = require('./input-ramp-list-view');\nvar StackLayoutView = require('../../../../../../components/stack-layout/stack-layout-view');\nvar InputColorPickerView = require('../input-color-picker/input-color-picker-view');\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-back': '_onClickBack'\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this._initViews();\n    return this;\n  },\n\n  _initViews: function () {\n    var self = this;\n\n    var stackViewCollection = new Backbone.Collection([{\n      createStackView: function (stackLayoutModel, opts) {\n        return self._createInputRampListView(stackLayoutModel, opts).bind(self);\n      }\n    }, {\n      createStackView: function (stackLayoutModel, opts) {\n        return self._createColorPickerView(stackLayoutModel, opts).bind(self);\n      }\n    }]);\n\n    this._stackLayoutView = new StackLayoutView({\n      collection: stackViewCollection\n    });\n\n    this.$el.append(this._stackLayoutView.render().$el);\n    this.addView(this._stackLayoutView);\n  },\n\n  _createColorPickerView: function (stackLayoutModel, opts) {\n    var range = _.map(this.model.get('range'), function (color, i) {\n      return {\n        val: color,\n        color: color,\n        title: this.model.get('attribute')\n      };\n    }, this);\n\n    var opacity = (typeof this.model.get('opacity') !== 'undefined') ? this.model.get('opacity') : 1;\n\n    var view = new InputColorPickerView({\n      index: 0,\n      ramp: range,\n      opacity: opacity\n    });\n\n    view.bind('back', function (value) {\n      stackLayoutModel.prevStep();\n    }, this);\n\n    view.bind('change', this._updateRange, this);\n    view.bind('change:opacity', function (opacity) {\n      this.model.set('opacity', opacity);\n    }, this);\n\n    return view;\n  },\n\n  _createInputRampListView: function (stackLayoutModel, opts) {\n    var view = new InputRampListView({\n      model: this.model,\n      showSearch: this.options.showSearch || false,\n      typeLabel: this.options.typeLabel\n    });\n\n    view.bind('customize', function (value) {\n      stackLayoutModel.nextStep();\n    }, this);\n\n    view.bind('change_ramp', this._updateRamp, this);\n    view.bind('change', this._updateRange, this);\n\n    view.bind('back', function (value) {\n      this.trigger('back', this);\n    }, this);\n\n    view.bind('switch', function (value) {\n      this.trigger('switch', this);\n    }, this);\n\n    view.bind('selectItem', function (item) {\n      this.trigger('selectItem', item.get('val'), this);\n    }, this);\n\n    view.bind('selectBins', function (item) {\n      this.trigger('selectBins', this);\n    }, this);\n\n    view.bind('selectQuantification', function (item) {\n      this.trigger('selectQuantification', this);\n    }, this);\n\n    return view;\n  },\n\n  _updateRamp: function (ramp) {\n    this.model.set('range', ramp);\n  },\n\n  _updateRange: function (categories) {\n    this.model.set('range', _.pluck(categories, 'color'));\n  },\n\n  _onClickBack: function (e) {\n    this.killEvent(e);\n    this.trigger('back', this);\n  }\n});\n\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CDB-Box-modalHeader\">\\n  <ul class=\"CDB-Box-modalHeaderItem CDB-Box-modalHeaderItem--block CDB-Box-modalHeaderItem--paddingHorizontal\">\\n    <li class=\"InputColor-modalHeader CDB-ListDecoration-item CDB-ListDecoration-itemPadding--vertical CDB-Text CDB-Size-medium u-secondaryTextColor\">\\n      <div class=\"u-flex u-alignStart u-ellipsis\">\\n        <button class=\"u-rSpace u-actionTextColor js-back\">\\n          <i class=\"CDB-IconFont CDB-IconFont-arrowPrev Size-large\"></i>\\n        </button>\\n        <div class=\"u-ellipsis\">\\n          '+\n((__t=( attribute ))==null?'':_.escape(__t))+\n'\\n        </div>\\n      </div>\\n    </li>\\n    <li class=\"CDB-ListDecoration-item CDB-ListDecoration-itemPadding--vertical CDB-Text CDB-Size-medium u-secondaryTextColor\">\\n      <ul class=\"u-flex u-justifySpace\">\\n        <li class=\"u-flex\">\\n          '+\n((__t=( bins ))==null?'':_.escape(__t))+\n' '+\n((__t=( _t('form-components.editors.fill.input-ramp.buckets', { smart_count: bins }) ))==null?'':_.escape(__t))+\n'\\n          <button class=\"CDB-Shape u-lSpace js-bins\">\\n            <div class=\"CDB-Shape-threePoints is-horizontal is-blue is-small\">\\n              <div class=\"CDB-Shape-threePointsItem\"></div>\\n              <div class=\"CDB-Shape-threePointsItem\"></div>\\n              <div class=\"CDB-Shape-threePointsItem\"></div>\\n            </div>\\n          </button>\\n        </li>\\n        <li class=\"u-flex\">\\n          '+\n((__t=( _t('form-components.editors.fill.quantification.methods.' + quantification) ))==null?'':_.escape(__t))+\n'\\n          <button class=\"CDB-Shape u-lSpace js-quantification\">\\n            <div class=\"CDB-Shape-threePoints is-horizontal is-blue is-small\">\\n              <div class=\"CDB-Shape-threePointsItem\"></div>\\n              <div class=\"CDB-Shape-threePointsItem\"></div>\\n              <div class=\"CDB-Shape-threePointsItem\"></div>\\n            </div>\\n          </button>\\n        </li>\\n      </ul>\\n    </li>\\n  </ul>\\n</div>\\n<div class=\"js-content\"></div>\\n<div class=\"CDB-Text CDB-Size-medium CustomRamp-list CustomList-listWrapper\">\\n  <ul class=\"CustomList-list js-customList\">\\n    <li class=\"CDB-ListDecoration-item CustomList-item CustomList-item--add\">\\n      <button class=\"CDB-ListDecoration-itemLink js-listItemLink js-customize u-actionTextColor\">'+\n((__t=( _t('form-components.editors.fill.customize') ))==null?'':_.escape(__t))+\n'</button>\\n    </li>\\n  </ul>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"ColorBarWrapper--withInvertLink CDB-ListDecoration-itemLink CDB-ListDecoration-itemLink--double js-listItemLink ';\n if (isSelected) { \n__p+=' is-selected ';\n } \n__p+='\">\\n  <ul class=\"ColorBarContainer\">\\n    ';\n _.each(name, function (color) { \n__p+='\\n    <li class=\"ColorBar ColorBar--spaceless\" style=\"background-color: '+\n((__t=( color ))==null?'':_.escape(__t))+\n';\"></li>\\n    ';\n }); \n__p+='\\n  </ul>\\n</div>\\n<button class=\"ColorBar-invertLink js-invert\" data-event=\"invert\"></button>\\n\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\n\nmodule.exports = CoreView.extend({\n\n  className: 'CDB-ListDecoration-item CustomList-item CustomList-item--invert js-listItem',\n  tagName: 'li',\n\n  events: {\n    'mouseenter': '_onMouseEnter',\n    'mouseleave': '_onMouseLeave',\n    'click .js-listItemLink': '_onClick',\n    'click .js-invert': '_onClickInvert'\n  },\n\n  initialize: function (opts) {\n    this.options = _.extend({}, this.options, opts);\n    this.listenTo(this.model, 'change', this.render);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n\n    this.$el.append(\n      this.options.template(\n        _.extend({\n          typeLabel: this.options.typeLabel,\n          isSelected: this.model.get('selected'),\n          isInverted: this.model.get('inverted'),\n          isDisabled: this.model.get('disabled'),\n          isDestructive: this.model.get('destructive'),\n          name: this.model.getName(),\n          val: this.model.getValue(),\n          options: this.model.get('renderOptions')\n        })\n      )\n    );\n\n    this.$el\n      .attr('data-val', this.model.getValue())\n      .toggleClass('is-disabled', !!this.model.get('disabled'))\n      .toggleClass('is-selected', !!this.model.get('selected'))\n      .toggleClass('is-inverted', !!this.model.get('inverted'));\n\n    return this;\n  },\n\n  _onMouseLeave: function () {\n    this.$el.removeClass('is-highlighted');\n  },\n\n  _onMouseEnter: function () {\n    this.$el.addClass('is-highlighted');\n  },\n\n  _onClick: function (ev) {\n    this.killEvent(ev);\n\n    if (this.model.get('selected')) {\n      this.trigger('customEvent', 'customize', this.model.get('val'), this);\n    } else {\n      this.model.set('selected', true);\n    }\n  },\n\n  _onClickInvert: function (e) {\n    this.killEvent(e);\n    this.model.set('inverted', !this.model.get('inverted'));\n    this.trigger('customEvent', 'invert', this.model, this);\n  }\n});\n",
    "var _ = require('underscore');\nvar cdb = require('cartodb.js');\nvar CoreView = require('backbone/core-view');\nvar CustomListView = require('../../../../../custom-list/custom-view');\nvar CustomListCollection = require('../../../../../custom-list/custom-list-collection');\nvar rampItemTemplate = require('./input-ramp-list-item-template.tpl');\nvar rampItemView = require('./input-ramp-list-item-view');\nvar customRampTemplate = require('./custom-ramp-template.tpl');\nvar rampList = require('cartocolor');\nvar template = require('./input-ramp-content-view.tpl');\n\nvar DEFAULT_RAMP_ITEM_COLOR = '#CCCCCC';\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-customize': '_onClickCustomize',\n    'click .js-clear': '_onClickClear',\n    'click .js-customRamp': '_onClickCustomRamp',\n    'click .js-back': '_onClickBack',\n    'click .js-switch': '_onClickSwitch',\n    'click .js-quantification': '_onClickQuantification',\n    'click .js-bins': '_onClickBins'\n  },\n\n  initialize: function (opts) {\n    this._showSearch = opts.showSearch || false;\n    this._typeLabel = opts.typeLabel;\n\n    this._initModels();\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n\n    this.$el.append(template({\n      bins: this.model.get('bins'),\n      attribute: this.model.get('attribute'),\n      quantification: this.model.get('quantification')\n    }));\n\n    this._initViews();\n\n    var customRamp = this._customRamp.get('range');\n\n    this.$('.js-customList').prepend(customRampTemplate({\n      customRamp: customRamp\n    }));\n\n    if (customRamp) {\n      this.$('.js-customList').addClass('is-customized');\n    } else {\n      var selectedRamp = this.collection.getSelectedItem();\n\n      if (!selectedRamp) {\n        selectedRamp = this.collection.first();\n      }\n\n      this._selectRamp(selectedRamp);\n    }\n\n    return this;\n  },\n\n  _initModels: function () {\n    this._customRamp = new cdb.core.Model();\n    this._setupCollection();\n  },\n\n  _initBinds: function () {\n    this.listenTo(this.model, 'change:bins', this._onChangeBins);\n    this.listenTo(this.model, 'change:attribute_type', this._updateRampOnAttributeChange);\n    this.listenTo(this.collection, 'change:selected', this._onSelectItem);\n  },\n\n  _initViews: function () {\n    this._listView = new CustomListView({\n      collection: this.collection,\n      showSearch: this._showSearch,\n      typeLabel: this._typeLabel,\n      itemTemplate: rampItemTemplate,\n      itemView: rampItemView\n    });\n\n    this._listView.bind('invert', this._invertRamp, this);\n    this._listView.bind('customize', function (ramp) {\n      this.trigger('customize', ramp, this);\n    }, this);\n\n    this.$('.js-content').append(this._listView.render().el);\n    this.addView(this._listView);\n  },\n\n  _getRamps: function () {\n    var attributeType = this.model.get('attribute_type');\n    // select only suitable ramps for the data type\n    // number -> ramps\n    // string -> category\n    var rampTypeFromType = {\n      number: ['quantitative', 'diverging'],\n      string: ['qualitative']\n    };\n    var ramps = rampList;\n    if (rampTypeFromType[attributeType]) {\n      ramps = _.filter(ramps, function (r) {\n        // ramp without tags is discarded\n        if (r.tags) {\n          return _.contains(rampTypeFromType[attributeType], r.tags[0]);\n        }\n        return false;\n      });\n    }\n\n    ramps = _.map(ramps, function (rampItem, name) {\n      var ramp = rampItem[this.model.get('bins')];\n      var range = this.model.get('range');\n      var isSelected = false;\n      var isInverted = false;\n\n      if (ramp && ramp.length && range && range.length) {\n        isSelected = ramp.join().toLowerCase() === range.join().toLowerCase();\n\n        if (!isSelected) {\n          isSelected = _.clone(ramp).reverse().join().toLowerCase() === range.join().toLowerCase();\n          isInverted = isSelected;\n        }\n      }\n\n      if (!ramp) {\n        return null;\n      }\n\n      return {\n        selected: isSelected,\n        inverted: isInverted,\n        name: name,\n        val: ramp\n      };\n    }, this);\n\n    return ramps;\n  },\n\n  _setupCollection: function () {\n    var ramps = this._getRamps();\n    this.collection = new CustomListCollection(_.compact(ramps), { silent: false });\n    if (!this.collection.getSelectedItem()) {\n      this._customRamp.set('range', this.model.get('range'));\n    }\n  },\n\n  _updateRampOnAttributeChange: function (m, type) {\n    var ramps = this._getRamps();\n    // Update the ramps when the attribute changes\n    this.collection.reset(_.compact(ramps), {silent: true});\n    // and delete the custom ramp\n    this._customRamp.set('range', false);\n\n    // apply the first ramp\n    var first = this.collection.first();\n    first && first.set('selected', true);\n    this.render();\n  },\n\n  _invertRamp: function (item) {\n    if (!item) {\n      return;\n    }\n\n    this._customRamp.set('range', null);\n    item.set('selected', false);\n    var ramp = [].concat(item.get('val')).reverse();\n    item.set({ val: ramp, selected: true });\n    this.model.set('range', ramp);\n  },\n\n  _selectRamp: function (item) {\n    if (!item) {\n      return;\n    }\n\n    var range = item.get('val');\n    // 'manually' select the item to preserve scroll position\n    this.$('.js-listItemLink').removeClass('is-selected');\n    this.$('.js-listItem[data-val=\"' + range.join(',') + '\"] .js-listItemLink').addClass('is-selected');\n  },\n\n  _onClickClear: function (e) {\n    this.killEvent(e);\n\n    this._customRamp.set('range', null);\n\n    if (!this.collection.getSelectedItem()) {\n      this.collection.first().set('selected', true);\n    }\n\n    this.render();\n    this._listView.highlight();\n  },\n\n  _onClickCustomRamp: function (e) {\n    this.killEvent(e);\n\n    if (this.model.get('range') === this._customRamp.get('range')) {\n      this.trigger('customize', this.collection.getSelectedItem(), this);\n    } else {\n      this.model.set('range', this._customRamp.get('range'));\n    }\n\n    this.$('.js-listItemLink').removeClass('is-selected');\n    this.$('.js-customRamp').addClass('is-selected');\n  },\n\n  _onClickCustomize: function (e) {\n    this.killEvent(e);\n    var ramp = this.collection.getSelectedItem();\n    this._customRamp.set('range', ramp);\n    this.trigger('customize', ramp, this);\n  },\n\n  _onChangeBins: function () {\n    var customRange = this._customRamp.get('range');\n\n    if (customRange) {\n      if (this.model.get('bins') > customRange.length) {\n        customRange = _.range(this.model.get('bins')).map(function (i) {\n          return i >= customRange.length ? DEFAULT_RAMP_ITEM_COLOR : customRange[i];\n        });\n      } else {\n        customRange = customRange.slice(0, this.model.get('bins'));\n      }\n\n      this.model.set('range', customRange);\n      this._customRamp.set('range', customRange);\n    }\n  },\n\n  _onSelectItem: function (item) {\n    this._selectRamp(item);\n    this.trigger('selectItem', item, this);\n  },\n\n  _onClickSwitch: function (e) {\n    this.killEvent(e);\n    this.trigger('switch', this);\n  },\n\n  _onClickBack: function (e) {\n    this.killEvent(e);\n    this.trigger('back', this);\n  },\n\n  _onClickQuantification: function (e) {\n    this.killEvent(e);\n    this.trigger('selectQuantification', this);\n  },\n\n  _onClickBins: function (e) {\n    this.killEvent(e);\n    this.trigger('selectBins', this);\n  }\n});\n",
    "module.exports = {\n  green: {\n    '3': ['#E5F5F9', '#99D8C9', '#2CA25F'],\n    '4': ['#EDF8FB', '#B2E2E2', '#66C2A4', '#238B45'],\n    '5': ['#EDF8FB', '#B2E2E2', '#66C2A4', '#2CA25F', '#006D2C'],\n    '6': ['#EDF8FB', '#CCECE6', '#99D8C9', '#66C2A4', '#2CA25F', '#006D2C'],\n    '7': ['#EDF8FB', '#D7FAF4', '#CCECE6', '#66C2A4', '#41AE76', '#238B45', '#005824']\n  },\n  blue: {\n    '3': ['#EDF8B1', '#7FCDBB', '#2C7FB8'],\n    '4': ['#FFFFCC', '#A1DAB4', '#41B6C4', '#225EA8'],\n    '5': ['#FFFFCC', '#A1DAB4', '#41B6C4', '#2C7FB8', '#253494'],\n    '6': ['#FFFFCC', '#C7E9B4', '#7FCDBB', '#41B6C4', '#2C7FB8', '#253494'],\n    '7': ['#FFFFCC', '#C7E9B4', '#7FCDBB', '#41B6C4', '#1D91C0', '#225EA8', '#0C2C84']\n  },\n  pink: {\n    '3': ['#E7E1EF', '#C994C7', '#DD1C77'],\n    '4': ['#F1EEF6', '#D7B5D8', '#DF65B0', '#CE1256'],\n    '5': ['#F1EEF6', '#D7B5D8', '#DF65B0', '#DD1C77', '#980043'],\n    '6': ['#F1EEF6', '#D4B9DA', '#C994C7', '#DF65B0', '#DD1C77', '#980043'],\n    '7': ['#F1EEF6', '#D4B9DA', '#C994C7', '#DF65B0', '#E7298A', '#CE1256', '#91003F']\n  },\n  black: {\n    '3': ['#F0F0F0', '#BDBDBD', '#636363'],\n    '4': ['#F7F7F7', '#CCCCCC', '#969696', '#525252'],\n    '5': ['#F7F7F7', '#CCCCCC', '#969696', '#636363', '#252525'],\n    '6': ['#F7F7F7', '#D9D9D9', '#BDBDBD', '#969696', '#636363', '#252525'],\n    '7': ['#F7F7F7', '#D9D9D9', '#BDBDBD', '#969696', '#737373', '#525252', '#252525']\n  },\n  red: {\n    '3': ['#FFEDA0', '#FEB24C', '#F03B20'],\n    '4': ['#FFFFB2', '#FECC5C', '#FD8D3C', '#E31A1C'],\n    '5': ['#FFFFB2', '#FECC5C', '#FD8D3C', '#F03B20', '#BD0026'],\n    '6': ['#FFFFB2', '#FED976', '#FEB24C', '#FD8D3C', '#F03B20', '#BD0026'],\n    '7': ['#FFFFB2', '#FED976', '#FEB24C', '#FD8D3C', '#FC4E2A', '#E31A1C', '#B10026']\n  },\n  inverted_green: {\n    '3': ['#2CA25F', '#99D8C9', '#E5F5F9'],\n    '4': ['#238B45', '#66C2A4', '#B2E2E2', '#EDF8FB'],\n    '5': ['#006D2C', '#2CA25F', '#66C2A4', '#B2E2E2', '#EDF8FB'],\n    '6': ['#006D2C', '#2CA25F', '#66C2A4', '#99D8C9', '#CCECE6', '#EDF8FB'],\n    '7': ['#005824', '#238B45', '#41AE76', '#66C2A4', '#CCECE6', '#D7FAF4', '#EDF8FB']\n  },\n  inverted_blue: {\n    '3': ['#2C7FB8', '#7FCDBB', '#EDF8B1'],\n    '4': ['#225EA8', '#41B6C4', '#A1DAB4', '#FFFFCC'],\n    '5': ['#253494', '#2C7FB8', '#41B6C4', '#A1DAB4', '#FFFFCC'],\n    '6': ['#253494', '#2C7FB8', '#41B6C4', '#7FCDBB', '#C7E9B4', '#FFFFCC'],\n    '7': ['#0C2C84', '#225EA8', '#1D91C0', '#41B6C4', '#7FCDBB', '#C7E9B4', '#FFFFCC']\n  },\n  inverted_pink: {\n    '3': ['#DD1C77', '#C994C7', '#E7E1EF'],\n    '4': ['#CE1256', '#DF65B0', '#D7B5D8', '#F1EEF6'],\n    '5': ['#980043', '#DD1C77', '#DF65B0', '#D7B5D8', '#F1EEF6'],\n    '6': ['#980043', '#DD1C77', '#DF65B0', '#C994C7', '#D4B9DA', '#F1EEF6'],\n    '7': ['#91003F', '#CE1256', '#E7298A', '#DF65B0', '#C994C7', '#D4B9DA', '#F1EEF6']\n  },\n  inverted_black: {\n    '3': ['#636363', '#BDBDBD', '#F0F0F0'],\n    '4': ['#525252', '#969696', '#CCCCCC', '#F7F7F7'],\n    '5': ['#252525', '#636363', '#969696', '#CCCCCC', '#F7F7F7'],\n    '6': ['#252525', '#636363', '#969696', '#BDBDBD', '#D9D9D9', '#F7F7F7'],\n    '7': ['#252525', '#525252', '#737373', '#969696', '#BDBDBD', '#D9D9D9', '#F7F7F7']\n  },\n  inverted_red: {\n    '3': ['#F03B20', '#FEB24C', '#FFEDA0'],\n    '4': ['#E31A1C', '#FD8D3C', '#FECC5C', '#FFFFB2'],\n    '5': ['#BD0026', '#F03B20', '#FD8D3C', '#FECC5C', '#FFFFB2'],\n    '6': ['#BD0026', '#F03B20', '#FD8D3C', '#FEB24C', '#FED976', '#FFFFB2'],\n    '7': ['#B10026', '#E31A1C', '#FC4E2A', '#FD8D3C', '#FEB24C', '#FED976', '#FFFFB2']\n  },\n  spectrum1: {\n    '3': ['#1a9850', '#fff2cc', '#d73027'],\n    '4': ['#1a9850', '#d2ecb4', '#fed6b0', '#d73027'],\n    '5': ['#1a9850', '#8cce8a', '#fff2cc', '#f79272', '#d73027'],\n    '6': ['#1a9850', '#8cce8a', '#d2ecb4', '#fed6b0', '#f79272', '#d73027'],\n    '7': ['#1a9850', '#8cce8a', '#d2ecb4', '#fff2cc', '#fed6b0', '#f79272', '#d73027']\n  },\n  spectrum2: {\n    '3': ['#0080ff', '#fff2cc', '#ff4d4d'],\n    '4': ['#0080ff', '#7fbfff', '#ffa6a6', '#ff4d4d'],\n    '5': ['#0080ff', '#40a0ff', '#fff2cc', '#ff7a7a', '#ff4d4d'],\n    '6': ['#0080ff', '#40a0ff', '#7fbfff', '#ffa6a6', '#ff7a7a', '#ff4d4d'],\n    '7': ['#0080ff', '#40a0ff', '#7fbfff', '#fff2cc', '#ffa6a6', '#ff7a7a', '#ff4d4d']\n  },\n  purple_states: {\n    '3': ['#F1E6F1', '#B379B3', '#8A4E8A'],\n    '4': ['#F1E6F1', '#D8BBD8', '#A05AA0', '#8A4E8A'],\n    '5': ['#F1E6F1', '#D8BBD8', '#B379B3', '#A05AA0', '#8A4E8A'],\n    '6': ['#F1E6F1', '#D8BBD8', '#CCA5CC', '#B379B3', '#A05AA0', '#8A4E8A'],\n    '7': ['#F1E6F1', '#D8BBD8', '#CCA5CC', '#C08FC0', '#B379B3', '#A05AA0', '#8A4E8A']\n  },\n  red_states: {\n    '3': ['#F2D2D3', '#D4686C', '#C1373C'],\n    '4': ['#F2D2D3', '#EBB7B9', '#CC4E52', '#C1373C'],\n    '5': ['#F2D2D3', '#EBB7B9', '#D4686C', '#CC4E52', '#C1373C'],\n    '6': ['#F2D2D3', '#EBB7B9', '#E39D9F', '#D4686C', '#CC4E52', '#C1373C'],\n    '7': ['#F2D2D3', '#EBB7B9', '#E39D9F', '#DB8286', '#D4686C', '#CC4E52', '#C1373C']\n  },\n  blue_states: {\n    '3': ['#ECF0F6', '#6182B5', '#43618F'],\n    '4': ['#ECF0F6', '#B2C2DB', '#4E71A6', '#43618F'],\n    '5': ['#ECF0F6', '#B2C2DB', '#6182B5', '#4E71A6', '#43618F'],\n    '6': ['#ECF0F6', '#B2C2DB', '#9BB0D0', '#6182B5', '#4E71A6', '#43618F'],\n    '7': ['#ECF0F6', '#B2C2DB', '#9BB0D0', '#849EC5', '#6182B5', '#4E71A6', '#43618F']\n  },\n  inverted_purple_states: {\n    '3': ['#8A4E8A', '#B379B3', '#F1E6F1'],\n    '4': ['#8A4E8A', '#A05AA0', '#D8BBD8', '#F1E6F1'],\n    '5': ['#8A4E8A', '#A05AA0', '#B379B3', '#D8BBD8', '#F1E6F1'],\n    '6': ['#8A4E8A', '#A05AA0', '#B379B3', '#CCA5CC', '#D8BBD8', '#F1E6F1'],\n    '7': ['#8A4E8A', '#A05AA0', '#B379B3', '#C08FC0', '#CCA5CC', '#D8BBD8', '#F1E6F1']\n  },\n  inverted_red_states: {\n    '3': ['#C1373C', '#D4686C', '#F2D2D3'],\n    '4': ['#C1373C', '#CC4E52', '#EBB7B9', '#F2D2D3'],\n    '5': ['#C1373C', '#CC4E52', '#D4686C', '#EBB7B9', '#F2D2D3'],\n    '6': ['#C1373C', '#CC4E52', '#D4686C', '#E39D9F', '#EBB7B9', '#F2D2D3'],\n    '7': ['#C1373C', '#CC4E52', '#D4686C', '#DB8286', '#E39D9F', '#EBB7B9', '#F2D2D3']\n  },\n  inverted_blue_states: {\n    '3': ['#43618F', '#6182B5', '#ECF0F6'],\n    '4': ['#43618F', '#4E71A6', '#B2C2DB', '#ECF0F6'],\n    '5': ['#43618F', '#4E71A6', '#6182B5', '#B2C2DB', '#ECF0F6'],\n    '6': ['#43618F', '#4E71A6', '#6182B5', '#9BB0D0', '#B2C2DB', '#ECF0F6'],\n    '7': ['#43618F', '#4E71A6', '#6182B5', '#849EC5', '#9BB0D0', '#B2C2DB', '#ECF0F6']\n  }\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CDB-ListDecoration-itemLink u-flex u-justifySpace u-alignCenter u-actionTextColor ';\n if (isSelected) { \n__p+=' is-selected ';\n } \n__p+='\">\\n  '+\n((__t=( _t('form-components.editors.fill.quantification.methods.' + name) ))==null?'':_.escape(__t))+\n'\\n</div>\\n\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar template = require('./input-number-value-content-view.tpl');\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-back': '_onClickBack',\n    'click .js-bins': '_onClickBins',\n    'click .js-quantification': '_onClickQuantification'\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this._removeForm();\n    this.$el.empty();\n\n    this.$el.append(template({\n      bins: this.model.get('bins'),\n      attribute: this.model.get('attribute'),\n      quantification: this.model.get('quantification')\n    }));\n\n    this._initForm();\n\n    return this;\n  },\n\n  _calculateRangeFromFixed: function (fixed, percent) {\n    percent = percent || 30;\n\n    var span = this.options.max - this.options.min;\n    var delta = fixed / span;\n\n    return [\n      Math.floor(Math.max(this.options.min, fixed - percent * delta)),\n      Math.floor(Math.min(this.options.max, fixed + percent * delta))\n    ];\n  },\n\n  _initForm: function () {\n    var self = this;\n\n    if (this._formView) {\n      this._formView.remove();\n    }\n\n    // when range min === max means we come from a fixed value\n    // calculate the range values based on this\n    var range = this.model.get('range');\n    var min, max;\n\n    min = max = this.model.get('fixed');\n\n    if (range) {\n      min = +range[0];\n      max = +range[1];\n    }\n\n    if (min === max) {\n      var r = this._calculateRangeFromFixed(min);\n      // set the range so changes are propagated\n      min = r[0];\n      max = r[1];\n      this.model.set('range', r);\n    }\n\n    this._formModel = new Backbone.Model({\n      min: min,\n      max: max\n    });\n\n    this._formModel.schema = {\n      min: {\n        type: 'Number',\n        validators: ['required', {\n          type: 'interval',\n          min: self.options.min,\n          max: self.options.max\n        }]\n      },\n      max: {\n        type: 'Number',\n        validators: ['required', {\n          type: 'interval',\n          min: self.options.min,\n          max: self.options.max\n        }]\n      }\n    };\n\n    this._formModel.bind('change', function (input) {\n      this.model.set('range', [(+input.get('min')), (+input.get('max'))]);\n    }, this);\n\n    this._formView = new Backbone.Form({\n      className: 'Editor-boxList',\n      model: this._formModel\n    });\n\n    this._formView.bind('change', function () {\n      this.commit();\n    });\n\n    this.$('.js-content').append(this._formView.render().$el);\n  },\n\n  _removeForm: function () {\n    // Backbone.Form removes the view with the following method\n    this._formView && this._formView.remove();\n  },\n\n  _onClickBack: function (e) {\n    this.killEvent(e);\n    this.trigger('back', this);\n  },\n\n  _onClickQuantification: function (e) {\n    this.killEvent(e);\n    this.trigger('selectQuantification', this);\n  },\n\n  _onClickBins: function (e) {\n    this.killEvent(e);\n    this.trigger('selectBins', this);\n  },\n\n  clean: function () {\n    this._removeForm();\n    CoreView.prototype.clean.call(this);\n  }\n});\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar tabPaneTemplate = require('../fill-tab-pane.tpl');\nvar createTextLabelsTabPane = require('../../../../../components/tab-pane/create-text-labels-tab-pane');\nvar InputNumberFixedContentView = require('./input-number-fixed-content-view');\nvar InputNumberValueContentView = require('./input-number-value-content-view');\n\nvar DEFAULT_INPUT_MIN_VALUE = 0;\nvar DEFAULT_INPUT_MAX_VALUE = 100;\nvar DEFAULT_INPUT_STEP_VALUE = 1;\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    if (!opts.columns) throw new Error('columns param is required');\n    this._columns = opts.columns;\n\n    this.listenTo(this.model, 'change:attribute', this._updateRangeValue);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this._initViews();\n    return this;\n  },\n\n  _initViews: function () {\n    var self = this;\n\n    var fixedPane = {\n      name: 'fixed',\n      label: _t('form-components.editors.fill.input-number.fixed'),\n      createContentView: function () {\n        return self._generateFixedContentView();\n      }\n    };\n\n    var valuePane = {\n      name: 'value',\n      label: _t('form-components.editors.fill.input-number.value'),\n      createContentView: function () {\n        return self._generateValueContentView();\n      }\n    };\n\n    this._tabPaneTabs = [];\n\n    if (this.options.editorAttrs && this.options.editorAttrs.hidePanes) {\n      var hidePanes = this.options.editorAttrs.hidePanes;\n      if (!_.contains(hidePanes, 'fixed')) {\n        this._tabPaneTabs.push(fixedPane);\n      }\n      if (!_.contains(hidePanes, 'value')) {\n        this._tabPaneTabs.push(valuePane);\n      }\n    } else {\n      this._tabPaneTabs = [fixedPane, valuePane];\n    }\n\n    var tabPaneOptions = {\n      tabPaneOptions: {\n        template: tabPaneTemplate,\n        tabPaneItemOptions: {\n          tagName: 'li',\n          className: 'CDB-NavMenu-item'\n        }\n      },\n      tabPaneItemLabelOptions: {\n        tagName: 'button',\n        className: 'CDB-NavMenu-link u-upperCase'\n      }\n    };\n\n    if (this.model.get('range') && this._tabPaneTabs.length > 1) {\n      this._tabPaneTabs[1].selected = true;\n    }\n\n    this._tabPaneView = createTextLabelsTabPane(this._tabPaneTabs, tabPaneOptions);\n    this.listenTo(this._tabPaneView.collection, 'change:selected', this._onChangeTabPaneViewTab);\n    this.addView(this._tabPaneView);\n    this.$el.append(this._tabPaneView.render().$el);\n  },\n\n  _onChangeTabPaneViewTab: function () {\n    var selectedTabPaneName = this._tabPaneView.getSelectedTabPaneName();\n\n    if (selectedTabPaneName === 'fixed') {\n      this._updateFixedValue();\n    } else {\n      this._updateRangeValue();\n    }\n\n    this.trigger('change', selectedTabPaneName, this);\n  },\n\n  _updateFixedValue: function () {\n    if (this.model.get('range')) {\n      // when coming from range calculate the average\n      var r = this.model.get('range');\n      var avg = 0.5 * (+r[0] + +r[1]);\n      this.model.set('fixed', avg);\n      this.model.unset('range');\n    }\n  },\n\n  _updateRangeValue: function () {\n    if (this.model.get('fixed') !== null && this.model.get('fixed') !== undefined && this.model.get('attribute')) {\n      this.model.set('range', [this.model.get('fixed'), this.model.get('fixed')]);\n      this.model.unset('fixed');\n    }\n  },\n\n  _generateFixedContentView: function () {\n    var editorAttrs = this.options.editorAttrs;\n    return new InputNumberFixedContentView({\n      model: this.model,\n      min: (editorAttrs && editorAttrs.min) || DEFAULT_INPUT_MIN_VALUE,\n      max: (editorAttrs && editorAttrs.max) || DEFAULT_INPUT_MAX_VALUE,\n      step: (editorAttrs && editorAttrs.step) || DEFAULT_INPUT_STEP_VALUE\n    });\n  },\n\n  _generateValueContentView: function () {\n    var editorAttrs = this.options.editorAttrs;\n    return new InputNumberValueContentView({\n      model: this.model,\n      columns: this._columns,\n      min: (editorAttrs && editorAttrs.min) || DEFAULT_INPUT_MIN_VALUE,\n      max: (editorAttrs && editorAttrs.max) || DEFAULT_INPUT_MAX_VALUE\n    });\n  },\n\n  _onChangeValue: function (input) {\n    this.model.set('fixed', input.value);\n  }\n});\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\n\nmodule.exports = CoreView.extend({\n  render: function () {\n    this.clearSubViews();\n    this._removeForm();\n    this.$el.empty();\n    this._initForm();\n    return this;\n  },\n\n  _initForm: function () {\n    this._formModel = new Backbone.Model({\n      value: this.model.get('fixed')\n    });\n\n    this._formModel.schema = {\n      value: {\n        type: 'Number',\n        validators: ['required', {\n          type: 'interval',\n          min: this.options.min,\n          max: this.options.max,\n          step: this.options.step\n        }]\n      }\n    };\n\n    this._formModel.bind('change', function (input) {\n      this.model.set('fixed', input.get('value'));\n    }, this);\n\n    this._formView = new Backbone.Form({\n      className: 'CDB-ListDecoration-itemPadding',\n      model: this._formModel\n    });\n\n    this._formView.bind('change', function () {\n      this.commit();\n    });\n\n    this.$el.append(this._formView.render().$el);\n  },\n\n  _removeForm: function () {\n    // Backbone.Form removes the view with the following method\n    this._formView && this._formView.remove();\n  },\n\n  clean: function () {\n    this._removeForm();\n    CoreView.prototype.clean.call(this);\n  }\n});\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar StackLayoutView = require('../../../../../components/stack-layout/stack-layout-view');\nvar ColumnListView = require('../column-list-view');\nvar quantificationMethodItemTemplate = require('./quantification-method-item.tpl');\nvar InputNumberContentView = require('./input-number-content-view');\nvar DefaultFillSettings = require('../default-fill-settings.json');\n\n/**\n * add the number of classes\n * change the max depending on the min\n * smaller values on top\n */\nvar COLUMN_PANE_INDEX = 0;\nvar MAIN_PAIN_INDEX = 1;\nvar QUANTIFICATION_PANE_INDEX = 2;\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-back': '_onClickBack'\n  },\n\n  initialize: function (opts) {\n    if (!opts.columns) throw new Error('columns param is required');\n    this._columns = opts.columns;\n\n    this._settings = DefaultFillSettings.number;\n\n    this._setupModel();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this._initViews();\n    return this;\n  },\n\n  _setupModel: function () {\n    var options = {};\n\n    if (!this.model.get('quantification')) {\n      options.quantification = this._settings.quantifications.items[this._settings.quantifications.defaultIndex];\n    }\n\n    if (!this.model.get('bins')) {\n      options.bins = this._settings.bins.items[this._settings.bins.defaultIndex];\n    }\n\n    if (+this.model.get('bins') > +this._settings.bins.items[this._settings.bins.items.length - 1]) {\n      options.bins = this._settings.bins.items[this._settings.bins.items.length - 1];\n    }\n\n    this.model.set(options);\n  },\n\n  _initViews: function () {\n    var self = this;\n\n    var stackViewCollection = new Backbone.Collection([{\n      createStackView: function (stackLayoutModel, opts) {\n        return self._createInputRampContentView(stackLayoutModel, opts).bind(self);\n      }\n    }, {\n      createStackView: function (stackLayoutModel, opts) {\n        return self._createInputNumberContentView(stackLayoutModel, opts).bind(self);\n      }\n    }, {\n      createStackView: function (stackLayoutModel, opts) {\n        return self._createQuantificationListView(stackLayoutModel, opts).bind(self);\n      }\n    }, {\n      createStackView: function (stackLayoutModel, opts) {\n        return self._createBinsListView(stackLayoutModel, opts).bind(self);\n      }\n    }]);\n\n    this._stackLayoutView = new StackLayoutView({\n      collection: stackViewCollection\n    });\n\n    var position = MAIN_PAIN_INDEX;\n\n    if (!this.model.get('attribute')) {\n      position = COLUMN_PANE_INDEX;\n    } else if (!this.model.get('quantification')) {\n      position = QUANTIFICATION_PANE_INDEX;\n    }\n\n    this._stackLayoutView.model.set('position', position);\n    this.$el.append(this._stackLayoutView.render().$el);\n    this.addView(this._stackLayoutView);\n  },\n\n  _createInputRampContentView: function (stackLayoutModel, opts) {\n    var view = new ColumnListView({\n      stackLayoutModel: stackLayoutModel,\n      columns: this._columns.filter(function (f) {\n        return f.type === 'number';\n      }),\n      showSearch: true,\n      typeLabel: 'column'\n    });\n\n    view.bind('selectItem', function (item) {\n      this.model.set('attribute', item.get('val'));\n      var step = MAIN_PAIN_INDEX;\n      if (!this.model.get('quantification')) {\n        step = QUANTIFICATION_PANE_INDEX;\n      }\n      this._stackLayoutView.model.goToStep(step);\n    }, this);\n\n    return view;\n  },\n\n  _createInputNumberContentView: function (stackLayoutModel, opts) {\n    var view = new InputNumberContentView({\n      stackLayoutModel: stackLayoutModel,\n      model: this.model,\n      min: this.options.min,\n      max: this.options.max\n    });\n\n    view.bind('back', function (value) {\n      stackLayoutModel.prevStep();\n    }, this);\n\n    view.bind('selectQuantification', function (value) {\n      stackLayoutModel.goToStep(2);\n    }, this);\n\n    view.bind('selectBins', function (value) {\n      stackLayoutModel.goToStep(3);\n    }, this);\n\n    return view;\n  },\n\n  _createQuantificationListView: function (stackLayoutModel, opts) {\n    var view = new ColumnListView({\n      headerTitle: _t('form-components.editors.fill.quantification.title'),\n      stackLayoutModel: stackLayoutModel,\n      columns: this._settings.quantifications.items,\n      itemTemplate: quantificationMethodItemTemplate,\n      showSearch: false\n    });\n\n    view.bind('selectItem', function (item) {\n      this.model.set('quantification', item.get('val'));\n      stackLayoutModel.prevStep();\n    }, this);\n\n    view.bind('back', function (value) {\n      stackLayoutModel.prevStep();\n    }, this);\n\n    return view;\n  },\n\n  _createBinsListView: function (stackLayoutModel, opts) {\n    var view = new ColumnListView({\n      headerTitle: _t('form-components.editors.fill.bins'),\n      stackLayoutModel: stackLayoutModel,\n      columns: this._settings.bins.items\n    });\n\n    view.bind('selectItem', function (item) {\n      this.model.set('bins', item.get('val'));\n      stackLayoutModel.goToStep(1);\n    }, this);\n\n    view.bind('back', function (value) {\n      stackLayoutModel.goToStep(1);\n    }, this);\n\n    return view;\n  },\n\n  _onClickBack: function (e) {\n    this.killEvent(e);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CDB-Box-modalHeader\">\\n  <ul class=\"CDB-Box-modalHeaderItem CDB-Box-modalHeaderItem--block CDB-Box-modalHeaderItem--paddingHorizontal\">\\n    <li class=\"InputColor-modalHeader CDB-ListDecoration-item CDB-ListDecoration-itemPadding--vertical CDB-Text CDB-Size-medium u-secondaryTextColor\">\\n      <div class=\"u-flex u-alignStart u-ellipsis\">\\n        <button class=\"u-rSpace u-actionTextColor js-back\">\\n          <i class=\"CDB-IconFont CDB-IconFont-arrowPrev Size-large\"></i>\\n        </button>\\n        <div class=\"u-ellipsis\">\\n          '+\n((__t=( attribute ))==null?'':_.escape(__t))+\n'\\n        </div>\\n      </div>\\n    </li>\\n    <li class=\"CDB-ListDecoration-item CDB-ListDecoration-itemPadding--vertical CDB-Text CDB-Size-medium u-secondaryTextColor\">\\n      <ul class=\"u-flex u-justifySpace\">\\n        <li class=\"u-flex\">\\n          '+\n((__t=( bins ))==null?'':_.escape(__t))+\n' '+\n((__t=( _t('form-components.editors.fill.input-ramp.buckets', { smart_count: bins }) ))==null?'':_.escape(__t))+\n'\\n          <button class=\"CDB-Shape u-lSpace js-bins\">\\n            <div class=\"CDB-Shape-threePoints is-horizontal is-blue is-small\">\\n              <div class=\"CDB-Shape-threePointsItem\"></div>\\n              <div class=\"CDB-Shape-threePointsItem\"></div>\\n              <div class=\"CDB-Shape-threePointsItem\"></div>\\n            </div>\\n          </button>\\n        </li>\\n        <li class=\"u-flex\">\\n          '+\n((__t=( _t('form-components.editors.fill.quantification.methods.' + quantification) ))==null?'':_.escape(__t))+\n'\\n          <button class=\"CDB-Shape u-lSpace js-quantification\">\\n            <div class=\"CDB-Shape-threePoints is-horizontal is-blue is-small\">\\n              <div class=\"CDB-Shape-threePointsItem\"></div>\\n              <div class=\"CDB-Shape-threePointsItem\"></div>\\n              <div class=\"CDB-Shape-threePointsItem\"></div>\\n            </div>\\n          </button>\\n        </li>\\n      </ul>\\n    </li>\\n  </ul>\\n</div>\\n<div class=\"js-content\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./input-number.tpl');\nvar InputDialogContent = require('./input-number-dialog-content');\n\nmodule.exports = CoreView.extend({\n  tagName: 'li',\n  className: 'CDB-OptionInput-item',\n\n  events: {\n    'click': '_onClick'\n  },\n\n  initialize: function (opts) {\n    if (!opts.columns) throw new Error('columns is required');\n    this._columns = opts.columns;\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n\n    if (this.options.disabled) {\n      this.$el.addClass('is-disabled');\n    }\n\n    this.$el.html(template({\n      value: this._getValue()\n    }));\n\n    return this;\n  },\n\n  _createContentView: function () {\n    var view = new InputDialogContent({\n      model: this.model,\n      columns: this._columns,\n      editorAttrs: this.options.editorAttrs\n    });\n\n    view.bind('change', this.render, this);\n\n    return view;\n  },\n\n  _onClick: function (e) {\n    if (this.options.disabled) {\n      return;\n    }\n    this.trigger('click', this.model);\n  },\n\n  _initBinds: function () {\n    this.model.set('createContentView', function () {\n      return this._createContentView();\n    }.bind(this));\n\n    this.listenTo(this.model, 'change:selected', this._onToggleSelected);\n    this.listenTo(this.model, 'change:fixed', this._onChangeValue);\n    this.listenTo(this.model, 'change:range', this._onChangeValue);\n  },\n\n  _getValue: function () {\n    // 1.0 -> 1\n    function dropDecimal (f) {\n      return f.replace(/\\.0$/, '');\n    }\n\n    if (this.model.get('range')) {\n      return this.model.get('range').map(function (v) {\n        return dropDecimal((+v).toFixed(1));\n      }).join('..');\n    }\n    return dropDecimal((+this.model.get('fixed')).toFixed(1));\n  },\n\n  _onChangeValue: function () {\n    this.$('.js-value').text(this._getValue());\n  },\n\n  _onToggleSelected: function () {\n    this.$el.toggleClass('is-active', this.model.get('selected'));\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<button type=\"button\" class=\"CDB-OptionInput-content js-value\">'+\n((__t=( value ))==null?'':_.escape(__t))+\n'</button>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar EditorHelpers = require('../editor-helpers-extend');\n\nBackbone.Form.editors.List.CategoryModel = Backbone.Form.editors.NestedModel.extend({\n\n  initialize: function (options) {\n    Backbone.Form.editors.Base.prototype.initialize.call(this, options);\n    EditorHelpers.setOptions(this, options);\n\n    if (!this.form) throw new Error('Missing required option \"form\"');\n    if (!options.schema.model) throw new Error('Missing required \"schema.model\" option for NestedModel editor');\n  },\n\n  render: function () {\n    // Get the constructor for creating the nested form; i.e. the same constructor as used by the parent form\n    var NestedForm = this.form.constructor;\n\n    var data = this.value || {};\n    var NestedModel = this.schema.model;\n\n    // Wrap the data in a model if it isn't already a model instance\n    var modelInstance = (data.constructor === NestedModel) ? data : new NestedModel(data, this.options);\n\n    this.nestedForm = new NestedForm({\n      model: modelInstance,\n      idPrefix: this.id + '_',\n      fieldTemplate: 'nestedField'\n    });\n\n    this._observeFormEvents();\n\n    // Render form\n    this.$el.html(this.nestedForm.render().el);\n\n    if (this.hasFocus) this.trigger('blur', this);\n\n    return this;\n  }\n\n});\n",
    "var Backbone = require('backbone');\nvar $ = require('jquery');\nvar _ = require('underscore');\n\n/**\n * A single item in the list\n *\n * @param {editors.List} options.list The List editor instance this item belongs to\n * @param {Function} options.Editor   Editor constructor function\n * @param {String} options.key        Model key\n * @param {Mixed} options.value       Value\n * @param {Object} options.schema     Field schema\n */\nBackbone.Form.editors.List.Item = Backbone.Form.editors.Base.extend({\n\n  events: {\n    'click [data-action=\"remove\"]': function (event) {\n      event.preventDefault();\n      this.list.removeItem(this);\n    },\n    'keydown input[type=text]': function (event) {\n      if (event.keyCode !== 13) return;\n      event.preventDefault();\n      this.list.addItem();\n      this.list.$list.find('> li:last input').focus();\n    }\n  },\n\n  initialize: function (options) {\n    this.list = options.list;\n    this.schema = options.schema || this.list.schema;\n    this.value = options.value;\n    this.Editor = options.Editor || Backbone.Form.editors.Text;\n    this.key = options.key;\n    this.template = options.template || this.schema.itemTemplate || this.constructor.template;\n    this.errorClassName = options.errorClassName || this.constructor.errorClassName;\n    this.form = options.form;\n    this.userModel = options.userModel;\n    this.configModel = options.configModel;\n    this.modals = options.modals;\n  },\n\n  render: function () {\n    // Create editor\n    this.editor = new this.Editor({\n      key: this.key,\n      schema: this.schema,\n      value: this.value,\n      list: this.list,\n      item: this,\n      form: this.form\n    }, {\n      userModel: this.userModel,\n      configModel: this.configModel,\n      modals: this.modals\n    }).render();\n\n    // Create main element\n    var $el = $($.trim(this.template()));\n\n    $el.find('[data-editor]').append(this.editor.el);\n\n    // Replace the entire element so there isn't a wrapper tag\n    this.setElement($el);\n\n    return this;\n  },\n\n  getValue: function () {\n    return this.editor.getValue();\n  },\n\n  setValue: function (value) {\n    this.editor.setValue(value);\n  },\n\n  focus: function () {\n    this.editor.focus();\n  },\n\n  blur: function () {\n    this.editor.blur();\n  },\n\n  remove: function () {\n    this.editor.remove();\n\n    Backbone.View.prototype.remove.call(this);\n  },\n\n  validate: function () {\n    var value = this.getValue();\n    var formValues = this.list.form ? this.list.form.getValue() : {};\n    var validators = this.schema.validators;\n    var getValidator = this.getValidator;\n\n    if (!validators) return null;\n\n    // Run through validators until an error is found\n    var error = null;\n    _.every(validators, function (validator) {\n      error = getValidator(validator)(value, formValues);\n\n      return !!error;\n    });\n\n    // Show/hide error\n    if (error) {\n      this.setError(error);\n    } else {\n      this.clearError();\n    }\n\n    // Return error to be aggregated by list\n    return error ? error : null; // eslint-disable-line\n  },\n\n  /**\n   * Show a validation error\n   */\n  setError: function (err) {\n    this.$el.addClass(this.errorClassName);\n    this.$el.attr('title', err.message);\n  },\n\n  /**\n   * Hide validation errors\n   */\n  clearError: function () {\n    this.$el.removeClass(this.errorClassName);\n    this.$el.attr('title', null);\n  }\n}, {\n\n  /*eslint-disable */\n  template: _.template('\\\n      <div>\\\n        <span data-editor></span>\\\n        <button type=\"button\" data-action=\"remove\">&times;</button>\\\n      </div>\\\n    ', null, Backbone.Form.templateSettings),\n  errorClassName: 'error'\n  /*eslint-enable */\n});\n",
    "var Backbone = require('backbone');\nvar EditorHelpers = require('../editor-helpers-extend');\nvar $ = require('jquery');\nvar _ = require('underscore');\n\nBackbone.Form.editors.List = Backbone.Form.editors.Base.extend({\n\n  events: {\n    'click [data-action=\"add\"]': function (event) {\n      event.preventDefault();\n      this.addItem(null, true);\n    }\n  },\n\n  initialize: function (options) {\n    options = options || {};\n\n    var editors = Backbone.Form.editors;\n\n    editors.Base.prototype.initialize.call(this, options);\n    EditorHelpers.setOptions(this, options);\n\n    var schema = this.schema;\n    if (!schema) throw new Error(\"Missing required option 'schema'\");\n\n    this.template = options.template || schema.listTemplate || this.constructor.template;\n\n    // Determine the editor to use\n    this.Editor = (function () {\n      var type = schema.itemType;\n\n      // Default to Text\n      if (!type) return editors.Text;\n\n      // Use List-specific version if available\n      if (editors.List[type]) return editors.List[type];\n\n      // Or whichever was passed\n      return editors[type];\n    })();\n\n    this._userModel = this.options.userModel;\n    this._configModel = this.options.configModel;\n    this._modals = this.options.modals;\n\n    this.items = [];\n  },\n\n  render: function () {\n    var self = this;\n    var value = this.value || [];\n\n    // Create main element\n    var $el = $($.trim(this.template()));\n\n    // Store a reference to the list (item container)\n    this.$list = $el.is('[data-items]') ? $el : $el.find('[data-items]');\n\n    // Add existing items\n    if (value.length) {\n      _.each(value, function (itemValue) {\n        self.addItem(itemValue);\n      });\n    } else {\n      // If no existing items create an empty one, unless the editor specifies otherwise\n      if (!this.Editor.isAsync) this.addItem();\n    }\n\n    this.setElement($el);\n    this.$el.attr('id', this.id);\n    this.$el.attr('name', this.key);\n\n    if (this.hasFocus) this.trigger('blur', this);\n\n    return this;\n  },\n\n  /**\n   * Add a new item to the list\n   * @param {Mixed} [value]           Value for the new item editor\n   * @param {Boolean} [userInitiated] If the item was added by the user clicking 'add'\n   */\n  addItem: function (value, userInitiated) {\n    var self = this;\n    var editors = Backbone.Form.editors;\n\n    // Create the item\n    var item = new editors.List.Item({\n      list: this,\n      form: this.form,\n      schema: this.schema,\n      value: value,\n      Editor: this.Editor,\n      key: this.key,\n      userModel: this._userModel,\n      configModel: this._configModel,\n      modals: this._modals\n    }).render();\n\n    var _addItem = function () {\n      self.items.push(item);\n      self.$list.append(item.el);\n\n      item.editor.on('all', function (event) {\n        if (event === 'change') return;\n\n        // args = [\"key:change\", itemEditor, fieldEditor]\n        var args = _.toArray(arguments);\n        args[0] = 'item:' + event;\n        args.splice(1, 0, self);\n        // args = [\"item:key:change\", this=listEditor, itemEditor, fieldEditor]\n\n        editors.List.prototype.trigger.apply(this, args);\n      }, self);\n\n      item.editor.on('change', function () {\n        if (!item.addEventTriggered) {\n          item.addEventTriggered = true;\n          this.trigger('add', this, item.editor);\n        }\n        this.trigger('item:change', this, item.editor);\n        this.trigger('change', this);\n      }, self);\n\n      item.editor.on('focus', function () {\n        if (this.hasFocus) return;\n        this.trigger('focus', this);\n      }, self);\n      item.editor.on('blur', function () {\n        if (!this.hasFocus) return;\n        var self = this;\n        setTimeout(function () {\n          if (_.find(self.items, function (item) {\n            return item.editor.hasFocus;\n          })) return;\n          self.trigger('blur', self);\n        }, 0);\n      }, self);\n\n      if (userInitiated || value) {\n        item.addEventTriggered = true;\n      }\n\n      if (userInitiated) {\n        self.trigger('add', self, item.editor);\n        self.trigger('change', self);\n      }\n    };\n\n    // Check if we need to wait for the item to complete before adding to the list\n    if (this.Editor.isAsync) {\n      item.editor.on('readyToAdd', _addItem, this);\n    } else {\n      // Most editors can be added automatically\n      _addItem();\n      item.editor.focus();\n    }\n\n    return item;\n  },\n\n  /**\n   * Remove an item from the list\n   * @param {List.Item} item\n   */\n  removeItem: function (item) {\n    // Confirm delete\n    var confirmMsg = this.schema.confirmDelete;\n    if (confirmMsg && !confirm(confirmMsg)) return; // eslint-disable-line\n\n    var index = _.indexOf(this.items, item);\n\n    this.items[index].remove();\n    this.items.splice(index, 1);\n\n    if (item.addEventTriggered) {\n      this.trigger('remove', this, item.editor);\n      this.trigger('change', this);\n    }\n\n    if (!this.items.length && !this.Editor.isAsync) this.addItem();\n  },\n\n  getValue: function () {\n    var values = _.map(this.items, function (item) {\n      return item.getValue();\n    });\n\n    // Filter empty items\n    return _.without(values, undefined, '');\n  },\n\n  setValue: function (value) {\n    this.value = value;\n    this.render();\n  },\n\n  focus: function () {\n    if (this.hasFocus) return;\n\n    if (this.items[0]) this.items[0].editor.focus();\n  },\n\n  blur: function () {\n    if (!this.hasFocus) return;\n\n    var focusedItem = _.find(this.items, function (item) {\n      return item.editor.hasFocus;\n    });\n\n    if (focusedItem) focusedItem.editor.blur();\n  },\n\n  /**\n   * Override default remove function in order to remove item views\n   */\n  remove: function () {\n    _.invoke(this.items, 'remove');\n\n    Backbone.Form.editors.Base.prototype.remove.call(this);\n  },\n\n  /**\n   * Run validation\n   *\n   * @return {Object|Null}\n   */\n  validate: function () {\n    if (!this.validators) return null;\n\n    // Collect errors\n    var errors = _.map(this.items, function (item) {\n      return item.validate();\n    });\n\n    // Check if any item has errors\n    var hasErrors = !!_.compact(errors).length;\n    if (!hasErrors) return null;\n\n    // If so create a shared error\n    var fieldError = {\n      type: 'list',\n      message: 'Some of the items in the list failed validation',\n      errors: errors\n    };\n\n    return fieldError;\n  }\n}, {\n\n  /*eslint-disable */\n  template: _.template('\\\n      <div>\\\n        <div data-items></div>\\\n        <button type=\"button\" data-action=\"add\">Add</button>\\\n      </div>\\\n    ', null, Backbone.Form.templateSettings)\n  /*eslint-enable */\n});\n",
    "var CustomListItemView = require('../../../custom-list/custom-list-item-view');\nvar _ = require('underscore');\n\nmodule.exports = CustomListItemView.extend({\n\n  render: function () {\n    this.$el.empty();\n    this.clearSubViews();\n\n    this.$el.append(\n      this.options.template(\n        _.extend(\n          {\n            typeLabel: this.options.typeLabel,\n            isSelected: this.model.get('selected'),\n            name: this.model.getName(),\n            val: this.model.getValue()\n          },\n          this.model.attributes\n        )\n      )\n    );\n\n    this.$el\n      .attr('data-val', this.model.getValue())\n      .toggleClass('is-disabled', !!this.model.get('disabled'));\n\n    return this;\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<button type=\"button\" class=\"CDB-ListDecoration-itemLink u-ellipsis u-actionTextColor\" title=\"'+\n((__t=( val ))==null?'':_.escape(__t))+\n'\">\\n  ';\n if (typeof type != 'undefined' && type === 'node') { \n__p+='\\n    <div class=\"u-flex\">\\n      <span\\n        class=\"SelectorLayer-letter CDB-Text CDB-Size-small u-whiteTextColor u-rSpace u-upperCase\"\\n        style=\"background-color: '+\n((__t=( color ))==null?'':_.escape(__t))+\n';\">'+\n((__t=( val ))==null?'':_.escape(__t))+\n'</span>\\n      <p class=\"CDB-Text CDB-Size-medium u-ellipsis u-flex\">\\n        '+\n((__t=( nodeTitle ))==null?'':_.escape(__t))+\n'<span class=\"u-altTextColor u-lSpace u-ellipsis\">'+\n((__t=( layerName ))==null?'':_.escape(__t))+\n'</span>\\n      </p>\\n    </div>\\n  ';\n } else { \n__p+='\\n    '+\n((__t=( val ))==null?'':_.escape(__t))+\n'\\n  ';\n } \n__p+='\\n</button>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='';\n if (typeof isLoading != 'undefined' && isLoading) { \n__p+='\\n  <div class=\"u-flex\">\\n    <div class=\"CDB-LoaderIcon CDB-LoaderIcon--small is-dark\">\\n      <svg class=\"CDB-LoaderIcon-spinner\" viewBox=\"0 0 50 50\">\\n        <circle class=\"CDB-LoaderIcon-path\" cx=\"25\" cy=\"25\" r=\"20\" fill=\"none\"></circle>\\n      </svg>\\n    </div>\\n    <span class=\"u-lSpace u-secondaryTextColor\">'+\n((__t=( _t('components.backbone-forms.select.loading') ))==null?'':_.escape(__t))+\n'</span>\\n  </div>\\n';\n } else { \n__p+='\\n  ';\n if (typeof type != 'undefined' && type === 'node') { \n__p+='\\n    <div class=\"u-flex\">\\n      <span\\n        class=\"SelectorLayer-letter CDB-Text CDB-Size-small u-whiteTextColor u-rSpace u-upperCase\"\\n        style=\"background-color: '+\n((__t=( color ))==null?'':_.escape(__t))+\n';\">'+\n((__t=( val ))==null?'':_.escape(__t))+\n'</span>\\n        <p class=\"CDB-Text CDB-Size-medium u-ellipsis u-flex\" title=\"'+\n((__t=( nodeTitle ))==null?'':_.escape(__t))+\n' - '+\n((__t=( layerName ))==null?'':_.escape(__t))+\n'\">\\n          '+\n((__t=( nodeTitle ))==null?'':_.escape(__t))+\n' <span class=\"u-altTextColor u-lSpace u-ellipsis\">'+\n((__t=( layerName ))==null?'':_.escape(__t))+\n'</span>\\n        </p>\\n    </div>\\n  ';\n } else { \n__p+='\\n    '+\n((__t=( label ))==null?'':_.escape(__t))+\n'\\n  ';\n } \n__p+='\\n';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar NodeDatasetItemView = require('./node-dataset-item-view');\nvar nodeDatasetSelectedTemplate = require('./node-dataset-selected.tpl');\nvar nodeDatasetItemTemplate = require('./node-dataset-item.tpl');\n\nBackbone.Form.editors.NodeDataset = Backbone.Form.editors.Select.extend({\n\n  options: {\n    selectedItemTemplate: nodeDatasetSelectedTemplate,\n    itemListTemplate: nodeDatasetItemTemplate,\n    customListItemView: NodeDatasetItemView\n  }\n\n});\n",
    "var Backbone = require('backbone');\nvar template = require('./number.tpl');\nvar EditorHelpers = require('../editor-helpers-extend');\nrequire('jquery');\nrequire('jquery-ui');\n\nvar UP_ARROW_KEY_CODE = 38;\nvar BOTTOM_ARROW_KEY_CODE = 40;\nvar SPACE_KEY_CODE = 32;\nvar ENTER_KEY_CODE = 13;\n\nvar SMALL_INCREMENT = 1;\nvar BIG_INCREMENT = 10;\n\nBackbone.Form.editors.Number = Backbone.Form.editors.Base.extend({\n\n  tagName: 'ul',\n  className: 'CDB-OptionInput-container CDB-OptionInput-container--noMargin u-grow',\n\n  // backbone-forms 0.14.1 has a 'number' validator:\n  // https://github.com/powmedia/backbone-forms/blob/v0.14.1/src/validators.js#L64\n  // We're on 0.14.0 so we have to use a 'regexp' validator\n  options: {\n    min: 0,\n    max: 10,\n    step: 1,\n    showSlider: true,\n    validators: [{\n      type: 'regexp',\n      regexp: /^[+-]?((\\.\\d+)|(\\d+(\\.\\d+)?))$/,\n      message: _t('editor.edit-feature.valid')\n    }]\n  },\n\n  events: {\n    'keydown .js-input': '_onInputKeyDown',\n    'keyup .js-input': '_onInputKeyUp',\n    focus: function () {\n      this.trigger('focus', this);\n    },\n    blur: function () {\n      this.trigger('blur', this);\n    }\n  },\n\n  initialize: function (opts) {\n    Backbone.Form.editors.Base.prototype.initialize.call(this, opts);\n    EditorHelpers.setOptions(this, opts);\n\n    // Setting min, max and step from validators, if exists.\n    this._validators = opts.validators || (opts.schema && opts.schema.validators);\n    if (this._validators && this._validators[1]) {\n      this.options.min = this._validators[1].min;\n      this.options.max = this._validators[1].max;\n      this.options.step = this._validators[1].step;\n    }\n\n    this._initViews();\n  },\n\n  _initViews: function () {\n    var placeholder = (this.value === null) ? 'null' : '';\n\n    this.$el.html(\n      template({\n        value: this.value,\n        isDisabled: this.options.disabled,\n        hasSlider: this.options.showSlider,\n        isFormatted: this.options.isFormatted,\n        placeholder: placeholder\n      })\n    );\n\n    if (this.options.showSlider) {\n      this.$('.js-slider').slider({\n        range: 'min',\n        value: this.value,\n        min: this.options.min,\n        max: this.options.max,\n        step: this.options.step,\n        orientation: 'horizontal',\n        disabled: this.options.disabled,\n        slide: this._onSlideChange.bind(this),\n        stop: this._onSlideStop.bind(this)\n      });\n    }\n\n    this.$el.toggleClass('CDB-OptionInput-container--noSlider', !!this.options.showSlider);\n  },\n\n  _onSlideChange: function (ev, ui) {\n    this.value = ui.value;\n    this.$('.js-input').val(this.value);\n  },\n\n  _onSlideStop: function (ev, ui) {\n    this.trigger('change', this);\n  },\n\n  _onInputKeyDown: function (e) {\n    var value = +this.getValue();\n    var inc = SMALL_INCREMENT;\n    var $input = this.$('.js-input');\n\n    if (e.shiftKey === true) {\n      inc = BIG_INCREMENT;\n    }\n\n    switch (e.which) {\n      case SPACE_KEY_CODE:\n      case ENTER_KEY_CODE:\n        return false;\n      case UP_ARROW_KEY_CODE:\n        value += inc;\n        $input.val(value);\n        break;\n      case BOTTOM_ARROW_KEY_CODE:\n        value -= inc;\n        $input.val(value);\n        break;\n      default:\n        // Any other case!\n    }\n  },\n\n  _hasSlider: function () {\n    return this.options.showSlider && this.$('.js-slider').data('ui-slider');\n  },\n\n  _onInputKeyUp: function () {\n    var value = this.$('.js-input').val();\n    if (this._hasSlider()) {\n      this.$('.js-slider').slider('value', value);\n    }\n\n    this.value = value;\n    this.trigger('change', this);\n  },\n\n  focus: function () {\n    if (this.hasFocus) return;\n    this.$('.js-input').focus();\n  },\n\n  blur: function () {\n    if (!this.hasFocus) return;\n    this.$('.js-input').blur();\n  },\n\n  getValue: function () {\n    var val = this.$('.js-input').val();\n\n    return (val === '') ? null : +val;\n  },\n\n  setValue: function (value) {\n    if (this._hasSlider()) {\n      this.$('.js-slider').slider('value', value);\n    }\n\n    this.$('.js-input').val(value);\n    this.value = value;\n  },\n\n  _destroySlider: function () {\n    if (this._hasSlider()) {\n      this.$('.js-slider').slider('destroy');\n    }\n  },\n\n  remove: function () {\n    this._destroySlider();\n    Backbone.Form.editors.Base.prototype.remove.apply(this);\n  },\n\n  clean: function () {\n    this.$el.remove();\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='';\n if (hasSlider) { \n__p+='\\n  <li class=\"CDB-OptionInput-item CDB-OptionInput-item--noSeparator\">\\n    <div class=\"UISlider js-slider\"></div>\\n  </li>\\n';\n } \n__p+='\\n<li class=\"CDB-OptionInput-item\">\\n  <input type=\"text\" class=\"CDB-InputText ';\n if (isFormatted) { \n__p+='is-number';\n } \n__p+=' ';\n if (isDisabled) { \n__p+='is-disabled';\n } \n__p+=' js-input\" ';\n if (isDisabled) { \n__p+='readonly';\n } \n__p+=' value=\"'+\n((__t=( value ))==null?'':_.escape(__t))+\n'\" placeholder=\"'+\n((__t=( placeholder ))==null?'':_.escape(__t))+\n'\" />\\n</li>\\n';\n}\nreturn __p;\n};\n",
    "var CustomListCollection = require('../../../custom-list/custom-list-collection');\nvar _ = require('underscore');\n\n/*\n *  Custom list collection, it parses pairs like:\n *\n *  [{ val, label }]\n *  [\"string\"]\n */\n\nmodule.exports = CustomListCollection.extend({\n\n  search: function (query) {\n    query = query.toLowerCase();\n\n    return _(this.filter(function (model) {\n      var val = model.getName().toLowerCase();\n      var type = model.get('type').toLowerCase();\n      return ~val.indexOf(query) && type === 'number';\n    }));\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text CDB-Size-medium u-altTextColor Editor-dropDownInfoText\">\\n  '+\n((__t=( _t('components.backbone-forms.operators.count-message') ))==null?'':_.escape(__t))+\n'\\n</p>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\n\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    visible: false,\n    operator: 'count',\n    attribute: ''\n  },\n\n  isValidOperator: function () {\n    var operator = this.get('operator');\n    var attribute = this.get('attribute');\n\n    if (operator === 'count') {\n      return true;\n    } else {\n      if (operator && attribute) {\n        return true;\n      }\n      return false;\n    }\n  }\n\n});\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar $ = require('jquery');\nvar CustomListView = require('../../../custom-list/custom-view');\nvar OperatorsListModel = require('./operators-list-model');\nvar emptyTemplate = require('./operators-list-count.tpl');\nvar template = require('./operators-list.tpl');\n\nmodule.exports = CoreView.extend({\n\n  className: 'Editor-dropdown Editor-boxModal Editor-dropdownOperators',\n  tagName: 'div',\n\n  events: {\n    'change input[name=\"operator\"]': '_onOperationChange'\n  },\n\n  initialize: function (opts) {\n    this.model = new OperatorsListModel({\n      operator: opts.operator,\n      attribute: opts.attribute,\n      visible: false\n    });\n\n    if (opts.attribute) {\n      this.collection.setSelected(opts.attribute);\n    }\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this.$el.append(\n      template({\n        operator: this.model.get('operator')\n      })\n    );\n    this._renderList();\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:operator change:attribute', _.debounce(this._onModelChange.bind(this), 10));\n    this.model.bind('change:visible', function (mdl, isVisible) {\n      this._toggleVisibility();\n\n      if (!isVisible) {\n        this._destroyList();\n        this.$('.js-list').html(emptyTemplate());\n      } else {\n        this.render();\n      }\n    }, this);\n    this.collection.bind('change:selected', this._onAttributeSelected, this);\n    this.add_related_model(this.collection);\n  },\n\n  _hasList: function () {\n    return !!this._listView;\n  },\n\n  _renderList: function () {\n    if (this.model.get('operator') !== 'count') {\n      if (this._hasList()) {\n        return;\n      }\n\n      this._listView = new CustomListView({\n        className: 'CDB-Dropdown-options CDB-Text CDB-Size-medium',\n        collection: this.collection,\n        showSearch: true,\n        typeLabel: this.options.keyAttr\n      });\n      this.$('.js-list').html(this._listView.render().el);\n    } else {\n      this._destroyList();\n      this.$('.js-list').html(emptyTemplate());\n    }\n  },\n\n  _destroyList: function () {\n    if (this._hasList()) {\n      this.removeView(this._listView);\n      this._listView.clean();\n      delete this._listView;\n    }\n  },\n\n  _onModelChange: function () {\n    if (this.model.isValidOperator()) {\n      this.trigger('change', this.model.toJSON(), this);\n    }\n  },\n\n  _onOperationChange: function (ev) {\n    var $input = $(ev.target);\n    var operator = $input.val();\n\n    if (operator === 'count') {\n      this.model.set('attribute', '');\n      this.collection.removeSelected();\n    }\n\n    this.model.set('operator', operator);\n\n    this._renderList();\n  },\n\n  _onAttributeSelected: function (mdl) {\n    if (mdl.get('selected')) {\n      this.model.set('attribute', mdl.getValue());\n    }\n  },\n\n  _toggleVisibility: function () {\n    this.$el.toggleClass('is-visible', !!this.model.get('visible'));\n  },\n\n  show: function () {\n    this.model.set('visible', true);\n  },\n\n  hide: function () {\n    this.model.set('visible', false);\n  },\n\n  toggle: function () {\n    this.model.set('visible', !this.model.get('visible'));\n  },\n\n  isVisible: function () {\n    return this.model.get('visible');\n  },\n\n  remove: function () {\n    this._destroyList();\n    this.$el.empty();\n    CoreView.prototype.remove.call(this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<ul class=\"Editor-dropdownCalculations CDB-Text is-semibold\">\\n  <li class=\"Editor-dropdownCalculationsElement CDB-Fieldset\">\\n    <input class=\"CDB-Radio\" type=\"radio\" name=\"operator\" value=\"count\" ';\n if (operator === 'count') { \n__p+='checked';\n } \n__p+='>\\n    <span class=\"u-iBlock CDB-Radio-face\"></span>\\n    <label class=\"u-iBlock u-lSpace\">'+\n((__t=( _t('operators.count') ))==null?'':_.escape(__t))+\n'</label>\\n  </li>\\n  <li class=\"Editor-dropdownCalculationsElement CDB-Fieldset\">\\n    <input class=\"CDB-Radio\" type=\"radio\" name=\"operator\" value=\"sum\" ';\n if (operator === 'sum') { \n__p+='checked';\n } \n__p+='>\\n    <span class=\"u-iBlock CDB-Radio-face\"></span>\\n    <label class=\"u-iBlock u-lSpace\">'+\n((__t=( _t('operators.sum') ))==null?'':_.escape(__t))+\n'</label>\\n  </li>\\n  <li class=\"Editor-dropdownCalculationsElement CDB-Fieldset\">\\n    <input class=\"CDB-Radio\" type=\"radio\" name=\"operator\" value=\"avg\" ';\n if (operator === 'avg') { \n__p+='checked';\n } \n__p+='>\\n    <span class=\"u-iBlock CDB-Radio-face\"></span>\\n    <label class=\"u-iBlock u-lSpace\">'+\n((__t=( _t('operators.avg') ))==null?'':_.escape(__t))+\n'</label>\\n  </li>\\n  <li class=\"Editor-dropdownCalculationsElement CDB-Fieldset\">\\n    <input class=\"CDB-Radio\" type=\"radio\" name=\"operator\" value=\"max\" ';\n if (operator === 'max') { \n__p+='checked';\n } \n__p+='>\\n    <span class=\"u-iBlock CDB-Radio-face\"></span>\\n    <label class=\"u-iBlock u-lSpace\">'+\n((__t=( _t('operators.max') ))==null?'':_.escape(__t))+\n'</label>\\n  </li>\\n  <li class=\"Editor-dropdownCalculationsElement CDB-Fieldset\">\\n    <input class=\"CDB-Radio\" type=\"radio\" name=\"operator\" value=\"min\" ';\n if (operator === 'min') { \n__p+='checked';\n } \n__p+='>\\n    <span class=\"u-iBlock CDB-Radio-face\"></span>\\n    <label class=\"u-iBlock u-lSpace\">'+\n((__t=( _t('operators.min') ))==null?'':_.escape(__t))+\n'</label>\\n  </li>\\n</ul>\\n<div class=\"js-list\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar EditorHelpers = require('../editor-helpers-extend');\nvar _ = require('underscore');\nvar $ = require('jquery');\nvar OperatorListView = require('./operators-list-view');\nvar OperatorListCollection = require('./operators-list-collection');\nvar template = require('./operators.tpl');\nvar ENTER_KEY_CODE = 13;\nvar PopupManager = require('../../../popup-manager');\n\nBackbone.Form.editors.Operators = Backbone.Form.editors.Base.extend({\n\n  tagName: 'div',\n  className: 'Editor-formSelect u-ellipsis',\n\n  events: {\n    'click .js-button': '_onButtonClick',\n    'keydown .js-button': '_onButtonKeyDown',\n    'focus .js-button': function () {\n      this.trigger('focus', this);\n    },\n    'blur': function () {\n      this.trigger('blur', this);\n    }\n  },\n\n  initialize: function (opts) {\n    Backbone.Form.editors.Base.prototype.initialize.call(this, opts);\n    EditorHelpers.setOptions(this, opts);\n\n    this.collection = new OperatorListCollection(this.options.options);\n    this.dialogMode = this.options.dialogMode || 'nested';\n\n    this._initViews();\n    this.setValue(this.model.get(this.options.keyAttr));\n    this._initBinds();\n  },\n\n  _initViews: function () {\n    var value = this.model.get(this.options.keyAttr);\n\n    this.$el.append(\n      $('<div>').addClass('js-operator')\n    );\n\n    this._setOperatorTemplate();\n\n    this._operatorsListView = new OperatorListView({\n      operator: value.operator,\n      attribute: value.attribute,\n      collection: this.collection\n    });\n    this._operatorsListView.bind('change', this._onOperatorsChange, this);\n\n    this._popupManager = new PopupManager(this.cid, this.$el, this._operatorsListView.$el);\n    this._popupManager.append(this.dialogMode);\n\n    if (this.options.disabled) {\n      this.undelegateEvents();\n    }\n  },\n\n  _setOperatorTemplate: function () {\n    this.$('.js-operator').html(\n      template({\n        name: this._getOperatorsTextValue(),\n        disabled: this.options.disabled,\n        keyAttr: this.options.keyAttr\n      })\n    );\n  },\n\n  _initBinds: function () {\n    var hide = function () {\n      this._operatorsListView.hide();\n      this._popupManager.untrack();\n    }.bind(this);\n\n    this.applyESCBind(hide);\n    this.applyClickOutsideBind(hide);\n  },\n\n  _onOperatorsChange: function (data) {\n    this.model.set(this.options.keyAttr, data);\n    this._setOperatorTemplate();\n    this.$('.js-button').focus();\n    this.trigger('change', this);\n  },\n\n  _getOperatorsTextValue: function () {\n    var value = this.model.get(this.options.keyAttr);\n    if (value && value.operator) {\n      return value.operator.toUpperCase() + (value.attribute ? '(' + value.attribute + ')' : '');\n    } else {\n      return '';\n    }\n  },\n\n  _onButtonClick: function (ev) {\n    this._operatorsListView.toggle();\n    this._operatorsListView.isVisible() ? this._popupManager.track() : this._popupManager.untrack();\n  },\n\n  _onButtonKeyDown: function (ev) {\n    if (ev.which === ENTER_KEY_CODE) {\n      ev.preventDefault();\n      if (!this._operatorsListView.isVisible()) {\n        ev.stopPropagation();\n        this._operatorsListView.toggle();\n        this._popupManager.track();\n      } else {\n        this._popupManager.untrack();\n      }\n    }\n  },\n\n  getValue: function () {\n    var data = this.model.get(this.options.keyAttr);\n    return _.omit(data, 'visible');\n  },\n\n  setValue: function (value) {\n    var textValue = this._getOperatorsTextValue();\n    this.value = textValue;\n    this._setOperatorTemplate();\n  },\n\n  remove: function () {\n    this._popupManager && this._popupManager.destroy();\n    this._operatorsListView && this._operatorsListView.clean();\n    Backbone.Form.editors.Base.prototype.remove.call(this);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CDB-InputText CDB-Text is-cursor js-button u-ellipsis\\n  ';\n if (disabled) { \n__p+=' is-disabled ';\n } \n__p+='\\n  ';\n if (!name) { \n__p+=' is-empty ';\n } \n__p+='\"\\n  tabindex=\"0\">\\n  '+\n((__t=( name || _t('components.backbone-forms.select.placeholder', { keyAttr: keyAttr }) ))==null?'':_.escape(__t))+\n'\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar EditorHelpers = require('../editor-helpers-extend');\nvar template = require('./radio.tpl');\nvar _ = require('underscore');\nvar $ = require('jquery');\nvar TipsyTooltipView = require('../../../tipsy-tooltip-view');\n\nBackbone.Form.editors.Radio = Backbone.Form.editors.Radio.extend({\n\n  className: 'CDB-Text CDB-Size-medium u-flex u-alignCenter',\n\n  initialize: function (opts) {\n    Backbone.Form.editors.Base.prototype.initialize.apply(this, arguments);\n    EditorHelpers.setOptions(this, opts);\n  },\n\n  render: function () {\n    this.setOptions(this.schema.options); // It comes from the default Select editor (not ours)\n    this._setHelp();\n    return this;\n  },\n\n  _setHelp: function () {\n    var containsHelp = _.find(this.schema.options, function (option) {\n      return option.help;\n    });\n\n    if (containsHelp) {\n      this._helpTooltip = this._createTooltip({\n        $el: this.$('.js-help')\n      });\n    }\n  },\n\n  _createTooltip: function (opts) {\n    return new TipsyTooltipView({\n      el: opts.$el || this.$el,\n      gravity: opts.gravity || 's',\n      className: opts.className || '',\n      offset: opts.offset || 0,\n      title: function () {\n        return opts.msg || $(this).data('tooltip');\n      }\n    });\n  },\n\n  getValue: function () {\n    var value = this.$('input[type=radio]:checked').val();\n\n    return (value === '') ? null : value;\n  },\n\n  _arrayToHtml: function (array) {\n    var selectedVal = this.form.model.get(this.key);\n\n    var items = _.map(array, function (option, index) {\n      var val = option.val;\n\n      var item = {\n        name: this.getName(),\n        value: (val === null) ? '' : val.toString(),\n        help: option.help,\n        id: this.id,\n        label: option.label,\n        className: option.className\n      };\n\n      // Can't be selected and disabled simultaneously\n      if (selectedVal === val) {\n        item.selected = true;\n      } else {\n        item.disabled = option.disabled;\n      }\n\n      return item;\n    }, this);\n\n    return template({\n      items: items\n    });\n  },\n\n  remove: function () {\n    if (this._helpTooltip) {\n      this._helpTooltip.clean();\n    }\n    Backbone.Form.editors.Base.prototype.remove.call(this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='';\n _.each(items, function(item, index) { \n__p+='\\n  <li class=\"u-flex u-alignCenter '+\n((__t=( (index === (items.length - 1)) ? '' : 'u-rSpace--xl' ))==null?'':_.escape(__t))+\n'\">\\n    <input type=\"radio\" class=\"CDB-Radio u-iBlock';\n if (item.className) { \n__p+=' '+\n((__t=( item.className ))==null?'':_.escape(__t))+\n' ';\n } \n__p+='\"\\n    name=\"'+\n((__t=( item.name ))==null?'':_.escape(__t))+\n'\" value=\"'+\n((__t=( item.value ))==null?'':_.escape(__t))+\n'\" id=\"'+\n((__t=( item.id ))==null?'':_.escape(__t))+\n'\" \\n        ';\n if (item.selected) { \n__p+='\\n          checked=\"checked\"\\n        ';\n } else if (item.disabled) { \n__p+='\\n          disabled=\"disabled\"\\n        ';\n } \n__p+='\\n      />\\n    <span class=\"u-rSpace CDB-Radio-face\"></span>\\n      ';\n if (item.help) { \n__p+='\\n        <span class=\"js-help is-underlined u-lSpace\" data-tooltip=\"'+\n((__t=( item.help ))==null?'':_.escape(__t))+\n'\">\\n      ';\n } \n__p+='\\n      '+\n((__t=( item.label ))==null?'':_.escape(__t))+\n'\\n      ';\n if (item.help) { \n__p+='\\n        </span>\\n      ';\n } \n__p+='\\n  </li>\\n';\n }); \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar EditorHelpers = require('../editor-helpers-extend');\nvar _ = require('underscore');\nvar CustomListView = require('../../../custom-list/custom-view');\nvar CustomListCollection = require('../../../custom-list/custom-list-multi-collection');\nvar selectedItemTemplate = require('./select-item.tpl');\nvar CustomListItemView = require('../../../custom-list/custom-list-multi-item-view');\nvar itemListTemplate = require('../../../custom-list/custom-list-item-with-checkbox.tpl');\nvar template = require('./select.tpl');\nvar PopupManager = require('../../../popup-manager');\n\nvar ENTER_KEY_CODE = 13;\n\nBackbone.Form.editors.MultiSelect = Backbone.Form.editors.Base.extend({\n\n  tagName: 'div',\n  className: 'u-ellipsis Editor-formSelect',\n\n  events: {\n    'click .js-button': '_onButtonClick',\n    'keydown .js-button': '_onButtonKeyDown',\n    'focus .js-button': function () {\n      this.trigger('focus', this);\n    },\n    'blur': function () {\n      this.trigger('blur', this);\n    }\n  },\n\n  options: {\n    selectedItemTemplate: selectedItemTemplate,\n    itemListTemplate: itemListTemplate,\n    customListItemView: CustomListItemView\n  },\n\n  initialize: function (opts) {\n    EditorHelpers.setOptions(this, opts);\n\n    this.collection = new CustomListCollection(opts.schema.options);\n    this.dialogMode = this.options.dialogMode || 'nested';\n\n    this._initViews();\n    this.setValue(this.model.get(opts.key));\n    Backbone.Form.editors.Base.prototype.initialize.call(this, opts);\n\n    this._initBinds();\n  },\n\n  _getLabel: function () {\n    var itemCount = _.compact(this.collection.pluck('selected')).length;\n    return _t('components.backbone-forms.select.selected', { count: itemCount });\n  },\n\n  _initViews: function () {\n    var isLoading = this.options.loading;\n    var isEmpty = !this.collection.length;\n    var isDisabled = !isEmpty ? this.options.disabled : true;\n    var name = this._getLabel();\n    var isNull = name === null;\n    var label = isNull ? 'null' : name;\n\n    this.$el.html(\n      template({\n        label: label,\n        keyAttr: this.options.keyAttr,\n        isDisabled: isDisabled,\n        isLoading: isLoading,\n        isEmpty: isEmpty,\n        isNull: isNull,\n        placeholder: null\n      })\n    );\n\n    if (isDisabled) {\n      this.undelegateEvents();\n    }\n\n    this._listView = new CustomListView({\n      collection: this.collection,\n      showSearch: this.options.showSearch,\n      typeLabel: this.options.keyAttr,\n      itemTemplate: this.options.itemListTemplate,\n      itemView: this.options.customListItemView,\n      searchPlaceholder: null\n    });\n\n    this._listView.bind('hidden', this._onHide, this);\n\n    this._popupManager = new PopupManager(this.cid, this.$el, this._listView.$el);\n    this._popupManager.append(this.dialogMode);\n  },\n\n  _initBinds: function () {\n    var hide = function () {\n      this._listView.hide();\n      this._popupManager.untrack();\n    }.bind(this);\n\n    this.collection.bind('change:selected', this._onItemSelected, this);\n    this.applyESCBind(hide);\n    this.applyClickOutsideBind(hide);\n  },\n\n  _onItemSelected: function (mdl) {\n    this._renderButton(mdl).focus();\n    this.trigger('change', this);\n  },\n\n  _onButtonClick: function (ev) {\n    this._listView.toggle();\n    this._listView.isVisible() ? this._popupManager.track() : this._popupManager.untrack();\n  },\n\n  _onButtonKeyDown: function (ev) {\n    if (ev.which === ENTER_KEY_CODE) {\n      ev.preventDefault();\n      if (!this._listView.isVisible()) {\n        ev.stopPropagation();\n        this._listView.toggle();\n        this._popupManager.track();\n      } else {\n        this._popupManager.untrack();\n      }\n    }\n  },\n\n  _getSelectedValues: function () {\n    return this.collection.chain().map(function (m) { return m.get('selected') ? m.get('val') : null; }).compact().value();\n  },\n\n  getValue: function () {\n    var values = this._getSelectedValues();\n    if (values.length > 0) {\n      return values;\n    }\n    return;\n  },\n\n  setValue: function (value) {\n    if (value) {\n      var selectedModel = this.collection.setSelected(value);\n\n      if (selectedModel) {\n        this._renderButton(selectedModel);\n      }\n    }\n  },\n\n  _renderButton: function (mdl) {\n    var button = this.$('.js-button');\n    var data = _.extend({}, mdl.attributes, { label: this._getLabel() });\n    var $html = this.options.selectedItemTemplate(data);\n\n    button\n      .removeClass('is-empty')\n      .html($html);\n\n    return button;\n  },\n\n  _onHide: function () {\n    if (this._getSelectedValues().length > 0) {\n      this.trigger('change', this);\n    }\n  },\n\n  remove: function () {\n    this._popupManager && this._popupManager.destroy();\n    this._listView && this._listView.clean();\n    Backbone.Form.editors.Base.prototype.remove.call(this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<button type=\"button\" class=\"CDB-ListDecoration-itemLink\\n  ';\n if (isSelected) { \n__p+=' is-selected ';\n } \n__p+=' ';\n if (isDestructive) { \n__p+='  u-alertTextColor ';\n } else { \n__p+=' u-actionTextColor ';\n } \n__p+='\"\\n  title=\"'+\n((__t=( nodeTitle ))==null?'':_.escape(__t))+\n' - '+\n((__t=( layerName ))==null?'':_.escape(__t))+\n'\">\\n  <div class=\"u-flex\">\\n    <span class=\"SelectorLayer-letter CDB-Text CDB-Size-small u-whiteTextColor u-rSpace u-upperCase\" style=\"background-color: '+\n((__t=( color ))==null?'':_.escape(__t))+\n';\">'+\n((__t=( layer_id ))==null?'':_.escape(__t))+\n'</span>\\n    <p class=\"CDB-Text CDB-Size-medium u-ellipsis u-flex\">\\n      '+\n((__t=( nodeTitle ))==null?'':_.escape(__t))+\n' <span class=\"u-altTextColor u-lSpace u-ellipsis\">'+\n((__t=( layerName ))==null?'':_.escape(__t))+\n'</span>\\n    </p>\\n  </div>\\n</button>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\n\nmodule.exports = CoreView.extend({\n\n  options: {\n    template: require('./select-layer-list-item.tpl')\n  },\n\n  className: 'CDB-ListDecoration-item CustomList-item js-listItem',\n  tagName: 'li',\n\n  events: {\n    'mouseenter': '_onMouseEnter',\n    'mouseleave': '_onMouseLeave',\n    'click': '_onClick'\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n\n    this.$el.append(\n      this.options.template(\n        _.extend({\n          typeLabel: this.options.typeLabel,\n          isSelected: this.model.get('selected'),\n          isDestructive: this.model.get('destructive'),\n          layerName: this.model.get('layerName'),\n          nodeTitle: this.model.get('nodeTitle'),\n          color: this.model.get('color'),\n          layer_id: this.model.get('layer_id')\n        })\n      )\n    );\n\n    this.$el.attr('data-val', this.model.getValue());\n\n    return this;\n  },\n\n  _onMouseLeave: function () {\n    this.$el.removeClass('is-highlighted');\n  },\n\n  _onMouseEnter: function () {\n    this.$el.addClass('is-highlighted');\n  },\n\n  _onClick: function (e) {\n    e.stopPropagation();\n    this.model.set('selected', true);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex\">\\n  <span class=\"SelectorLayer-letter CDB-Text CDB-Size-small u-whiteTextColor u-rSpace u-upperCase\" style=\"background-color: '+\n((__t=( color ))==null?'':_.escape(__t))+\n';\">'+\n((__t=( layer_id ))==null?'':_.escape(__t))+\n'</span>\\n  <p class=\"CDB-Text CDB-Size-medium u-ellipsis u-flex\" title=\"'+\n((__t=( nodeTitle ))==null?'':_.escape(__t))+\n' - '+\n((__t=( layerName ))==null?'':_.escape(__t))+\n'\">\\n    '+\n((__t=( nodeTitle ))==null?'':_.escape(__t))+\n' <span class=\"u-altTextColor u-lSpace u-ellipsis\">'+\n((__t=( layerName ))==null?'':_.escape(__t))+\n'</span>\\n  </p>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar EditorHelpers = require('../editor-helpers-extend');\nvar _ = require('underscore');\nvar CustomListView = require('../../../custom-list/custom-view');\nvar CustomListCollection = require('../../../custom-list/custom-list-collection');\nvar selectedItemTemplate = require('./select-item.tpl');\nvar CustomListItemView = require('../../../custom-list/custom-list-item-view');\nvar itemListTemplate = require('../../../custom-list/custom-list-item.tpl');\nvar template = require('./select.tpl');\nvar PopupManager = require('../../../popup-manager');\n\nvar ENTER_KEY_CODE = 13;\n\nBackbone.Form.editors.Select = Backbone.Form.editors.Base.extend({\n\n  tagName: 'div',\n  className: 'u-ellipsis Editor-formSelect',\n\n  events: {\n    'click .js-button': '_onButtonClick',\n    'keydown .js-button': '_onButtonKeyDown',\n    'focus .js-button': function () {\n      this.trigger('focus', this);\n    },\n    'blur': function () {\n      this.trigger('blur', this);\n    }\n  },\n\n  options: {\n    selectedItemTemplate: selectedItemTemplate,\n    itemListTemplate: itemListTemplate,\n    customListItemView: CustomListItemView\n  },\n\n  initialize: function (opts) {\n    Backbone.Form.editors.Base.prototype.initialize.call(this, opts);\n    EditorHelpers.setOptions(this, opts);\n\n    this.template = opts.template || template;\n    this.dialogMode = this.options.dialogMode || 'nested';\n    this.collection = new CustomListCollection(this.options.options);\n    this._initViews();\n\n    this.setValue(this.model.get(this.options.keyAttr));\n\n    this._initBinds();\n  },\n\n  _initViews: function () {\n    var isLoading = this.options.loading;\n    var isEmpty = !this.collection.length;\n    var isDisabled = !isEmpty ? this.options.disabled : true;\n    var name = this.model.get(this.options.keyAttr);\n    var isNull = name === null;\n    var label = isNull ? 'null' : name;\n    var placeholder = this.options.placeholder;\n    var typeLabel = this.options.keyAttr;\n\n    this.$el.html(\n      this.template({\n        label: label,\n        keyAttr: this.options.keyAttr,\n        placeholder: placeholder,\n        isDisabled: isDisabled,\n        isLoading: isLoading,\n        isEmpty: isEmpty,\n        isNull: isNull\n      })\n    );\n\n    if (isDisabled) {\n      this.undelegateEvents();\n    }\n\n    this._listView = new CustomListView({\n      collection: this.collection,\n      showSearch: this.options.showSearch,\n      allowFreeTextInput: this.options.allowFreeTextInput,\n      typeLabel: typeLabel,\n      itemTemplate: this.options.itemListTemplate,\n      itemView: this.options.customListItemView,\n      position: this.options.position,\n      searchPlaceholder: this.options.searchPlaceholder\n    });\n\n    this._popupManager = new PopupManager(this.cid, this.$el, this._listView.$el);\n    this._popupManager.append(this.dialogMode);\n  },\n\n  _initBinds: function () {\n    var hide = function () {\n      this._listView.hide();\n      this._popupManager.untrack();\n    }.bind(this);\n\n    this.collection.bind('change:selected', this._onItemSelected, this);\n    this.applyESCBind(hide);\n    this.applyClickOutsideBind(hide);\n  },\n\n  _onItemSelected: function (mdl) {\n    this._listView.hide();\n    this._popupManager.untrack();\n    this._renderButton(mdl).focus();\n    this.trigger('change', this);\n  },\n\n  _onButtonClick: function (ev) {\n    this._listView.toggle();\n    this._listView.isVisible() ? this._popupManager.track() : this._popupManager.untrack();\n  },\n\n  _onButtonKeyDown: function (ev) {\n    if (ev.which === ENTER_KEY_CODE) {\n      ev.preventDefault();\n      if (!this._listView.isVisible()) {\n        ev.stopPropagation();\n        this._listView.toggle();\n      } else {\n        this._popupManager.track();\n      }\n    }\n  },\n\n  getValue: function () {\n    var item = this.collection.getSelectedItem();\n    if (item) {\n      return item.getValue();\n    }\n    return;\n  },\n\n  setValue: function (value) {\n    var selectedModel = this.collection.setSelected(value);\n    if (selectedModel) {\n      this._renderButton(selectedModel);\n    }\n    this.value = value;\n  },\n\n  _renderButton: function (mdl) {\n    var button = this.$('.js-button');\n    var data = _.extend({}, {label: mdl.getName()}, mdl.attributes);\n    var $html = this.options.selectedItemTemplate(data);\n\n    button\n      .removeClass('is-empty')\n      .html($html);\n\n    return button;\n  },\n\n  remove: function () {\n    this._popupManager && this._popupManager.destroy();\n    this._listView && this._listView.clean();\n    Backbone.Form.editors.Base.prototype.remove.call(this);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CDB-InputText CDB-Text is-cursor js-button u-ellipsis\\n  ';\n if (isDisabled) { \n__p+=' is-disabled ';\n } \n__p+='\\n  ';\n if (!label) { \n__p+=' is-empty ';\n } \n__p+='\\n  ';\n if (isNull) { \n__p+=' is-empty ';\n } \n__p+='\"\\n  tabindex=\"0\">\\n  ';\n if (isLoading) { \n__p+='\\n    <div class=\"CDB-LoaderIcon CDB-LoaderIcon--small is-dark\">\\n      <svg class=\"CDB-LoaderIcon-spinner\" viewBox=\"0 0 50 50\">\\n        <circle class=\"CDB-LoaderIcon-path\" cx=\"25\" cy=\"25\" r=\"20\" fill=\"none\"></circle>\\n      </svg>\\n      <span class=\"u-lSpace u-secondaryTextColor\">'+\n((__t=( _t('components.backbone-forms.select.loading') ))==null?'':_.escape(__t))+\n'</span>\\n    </div>\\n  ';\n } else { \n__p+='\\n    ';\n if (isEmpty) { \n__p+='\\n      '+\n((__t=( _t('components.backbone-forms.select.empty') ))==null?'':_.escape(__t))+\n'\\n    ';\n } else { \n__p+='\\n      '+\n((__t=( placeholder || label || _t('components.backbone-forms.select.placeholder', { keyAttr: keyAttr }) ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n  ';\n } \n__p+='\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar EditorHelpers = require('../editor-helpers-extend');\nvar _ = require('underscore');\nvar CustomListView = require('../../../custom-list/custom-view');\nvar CustomListCollection = require('../../../custom-list/custom-list-collection');\nvar selectedItemTemplate = require('./select-item.tpl');\nvar CustomListItemView = require('../../../custom-list/custom-list-item-view');\nvar itemListTemplate = require('../../../custom-list/custom-list-item.tpl');\nvar template = require('./select.tpl');\nvar PopupManager = require('../../../popup-manager');\n\nvar ENTER_KEY_CODE = 13;\n\nBackbone.Form.editors.Suggest = Backbone.Form.editors.Base.extend({\n\n  tagName: 'div',\n  className: 'u-ellipsis Editor-formSelect',\n\n  events: {\n    'click .js-button': '_onButtonClick',\n    'keydown .js-button': '_onButtonKeyDown',\n    'focus .js-button': function () {\n      this.trigger('focus', this);\n    },\n    'blur': function () {\n      this.trigger('blur', this);\n    }\n  },\n\n  options: {\n    selectedItemTemplate: selectedItemTemplate,\n    itemListTemplate: itemListTemplate,\n    customListItemView: CustomListItemView\n  },\n\n  initialize: function (opts) {\n    Backbone.Form.editors.Base.prototype.initialize.call(this, opts);\n    EditorHelpers.setOptions(this, opts);\n\n    this.template = opts.template || template;\n    this.dialogMode = this.options.dialogMode || 'nested';\n\n    this._setupCollection();\n    this.setValue(this.model.get(this.options.keyAttr));\n    this._initBinds();\n  },\n\n  render: function () {\n    this.setValue(this.value);\n\n    return this;\n  },\n\n  _setupCollection: function () {\n    this.collection = new CustomListCollection(this.options.options);\n\n    if (this.options.editorAttrs && this.options.editorAttrs.collectionData) {\n      var categories = _.map(this.options.editorAttrs.collectionData, function (d) {\n        return { label: d, val: d };\n      });\n\n      this.collection.reset(categories);\n    }\n  },\n\n  _initViews: function () {\n    var isLoading = this.options.loading;\n    var isEmpty = !this.collection.length;\n    var isDisabled = !isEmpty ? this.options.disabled : true;\n    var name = this.model.get(this.options.keyAttr);\n    var isNull = name === null;\n    var label = isNull ? 'null' : name;\n\n    this.$el.html(\n      this.template({\n        label: label,\n        keyAttr: this.options.keyAttr,\n        isDisabled: isDisabled,\n        isLoading: isLoading,\n        isEmpty: isEmpty,\n        isNull: isNull,\n        placeholder: null\n      })\n    );\n\n    if (isDisabled) {\n      this.undelegateEvents();\n    }\n\n    this._listView = new CustomListView({\n      collection: this.collection,\n      showSearch: this.options.showSearch,\n      allowFreeTextInput: this.options.allowFreeTextInput,\n      typeLabel: this.options.keyAttr,\n      itemTemplate: this.options.itemListTemplate,\n      itemView: this.options.customListItemView,\n      position: this.options.position,\n      searchPlaceholder: null\n    });\n\n    this._popupManager = new PopupManager(this.cid, this.$el, this._listView.$el);\n    this._popupManager.append(this.dialogMode);\n  },\n\n  _initBinds: function () {\n    var hide = function () {\n      this._listView.hide();\n      this._popupManager.untrack();\n    }.bind(this);\n\n    this.collection.bind('change:selected', this._onItemSelected, this);\n    this.collection.bind('reset', this.render, this);\n    this.applyESCBind(hide);\n    this.applyClickOutsideBind(hide);\n  },\n\n  _onItemSelected: function (mdl) {\n    this._listView.hide();\n    this._popupManager.untrack();\n    this._renderButton(mdl).focus();\n    this.trigger('change', this);\n  },\n\n  _onButtonClick: function (ev) {\n    this._listView.toggle();\n    this._listView.isVisible() ? this._popupManager.track() : this._popupManager.untrack();\n  },\n\n  _onButtonKeyDown: function (ev) {\n    if (ev.which === ENTER_KEY_CODE) {\n      ev.preventDefault();\n      if (!this._listView.isVisible()) {\n        ev.stopPropagation();\n        this._listView.toggle();\n        this._popupManager.track();\n      } else {\n        this._popupManager.untrack();\n      }\n    }\n  },\n\n  getValue: function () {\n    var item = this.collection.getSelectedItem();\n\n    if (item) {\n      return item.getValue();\n    }\n\n    return;\n  },\n\n  setValue: function (value) {\n    var selectedModel = this.collection.setSelected(value);\n\n    if (!selectedModel) {\n      this.collection.add({ label: value, val: value });\n      selectedModel = this.collection.setSelected(value);\n    }\n\n    this._initViews();\n    this._renderButton(selectedModel);\n\n    this.value = value;\n  },\n\n  _renderButton: function (mdl) {\n    var button = this.$('.js-button');\n    var name = mdl.getName();\n    var isNull = name === null || name === 'null';\n    var label = isNull ? 'null' : name;\n\n    var data = _.extend({}, mdl.attributes, { label: label });\n    var $html = this.options.selectedItemTemplate(data);\n\n    button\n      .html($html)\n      .toggleClass('is-empty', isNull);\n\n    return button;\n  },\n\n  remove: function () {\n    this._popupManager && this._popupManager.destroy();\n    this._listView && this._listView.clean();\n    Backbone.Form.editors.Base.prototype.remove.call(this);\n  },\n\n  clean: function () {\n    this._popupManager && this._popupManager.destroy();\n  }\n\n});\n",
    "var $ = require('jquery');\nvar _ = require('underscore');\nvar Backbone = require('backbone');\nvar EditorHelpers = require('../editor-helpers-extend');\nvar template = require('./slider.tpl');\nrequire('jquery');\nrequire('jquery-ui');\n\nBackbone.Form.editors.Slider = Backbone.Form.editors.Base.extend({\n\n  tagName: 'ul',\n  className: 'CDB-OptionInput-container CDB-OptionInput-container--noMargin',\n\n  options: {\n    direction: ''\n  },\n\n  events: {\n    focus: function () {\n      this.trigger('focus', this);\n    },\n    blur: function () {\n      this.trigger('blur', this);\n    }\n  },\n\n  initialize: function (opts) {\n    Backbone.Form.editors.Base.prototype.initialize.call(this, opts);\n    EditorHelpers.setOptions(this, opts);\n\n    if (!this.options.labels) {\n      throw new Error('labels is required');\n    }\n\n    if (this.options.values && this.options.labels.length !== this.options.values.length) {\n      throw new Error('values and labels should have the same length');\n    }\n\n    this._values = this.options.values;\n    this._labels = this.options.labels;\n\n    this._initViews();\n  },\n\n  _initViews: function () {\n    this.$el.html(\n      template({\n        direction: this.options.direction\n      })\n    );\n\n    var step = this._getStepPercentage();\n    this._ticks = this._getTicks(step);\n\n    var tickID = this._getInitialTickID();\n\n    this.$('.js-slider').slider({\n      range: 'min',\n      value: this._ticks[tickID],\n      step: step,\n      orientation: 'horizontal',\n      disabled: this.options.disabled,\n      slide: this._onSlideChange.bind(this),\n      stop: this._onSlideStop.bind(this)\n    });\n\n    this._addTicks(step);\n    this._updateUI(tickID);\n  },\n\n  _getInitialTickID: function () {\n    var value = this.value;\n\n    if (this._values) {\n      value = this._values.indexOf(this.value);\n\n      if (value === -1) {\n        value = 0;\n      }\n    } else if (!value) {\n      value = 0;\n    }\n\n    return value;\n  },\n\n  _updateUI: function (tickID) {\n    if (tickID === undefined) {\n      tickID = 0;\n    }\n\n    this._updateLabel(tickID);\n    this._highlightTick(tickID);\n  },\n\n  _getTickID: function () {\n    var v = 0;\n\n    if (this.value && _.isNumber(this.value)) {\n      v = this._calculateTickValue(this.value);\n    }\n\n    return this._ticks.indexOf(v);\n  },\n\n  _addTicks: function (step) {\n    _.each(this._ticks, function (amount) {\n      $('<div class=\"UISlider-tick js-tick\"></div>')\n        .css('left', amount + '%')\n        .appendTo(this.$('.js-slider'));\n    }, this);\n  },\n\n  _highlightTick: function (tickID) {\n    this.$('.js-tick').removeClass('is-highlighted');\n    $(this.$('.js-tick').get(tickID)).addClass('is-highlighted');\n  },\n\n  _updateLabel: function (tickID) {\n    this.$('.js-label').text(this._labels[tickID]);\n  },\n\n  _getTicks: function (step) {\n    var self = this;\n\n    return [0].concat(_(this._labels.length - 1).times(function (n) {\n      return self._calculateTickValue(step * (n + 1));\n    }));\n  },\n\n  _getStepPercentage: function () {\n    return (100 / (this._labels.length - 1));\n  },\n\n  _calculateTickValue: function (value) {\n    return +value.toFixed(2);\n  },\n\n  _onSlideChange: function (ev, ui) {\n    this.value = ui.value;\n\n    this._updateUI(this._getTickID());\n  },\n\n  _onSlideStop: function (ev, ui) {\n    this.trigger('change', this);\n  },\n\n  _hasSlider: function () {\n    return this.$('.js-slider').data('ui-slider');\n  },\n\n  getValue: function () {\n    var value = this._values ? this._values[this._getTickID()] : this._getTickID();\n    return (this.value === '') ? null : value;\n  },\n\n  setValue: function (value) {\n    this.$('.js-slider').slider('value', value);\n    this.value = value;\n  },\n\n  _destroySlider: function () {\n    if (this._hasSlider()) {\n      this.$('.js-slider').slider('destroy');\n    }\n  },\n\n  remove: function () {\n    this._destroySlider();\n    Backbone.Form.editors.Base.prototype.remove.apply(this);\n  },\n\n  clean: function () {\n    this.$el.remove();\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<li class=\"CDB-OptionInput-item CDB-OptionInput-item--noSeparator\">\\n  ';\n if (direction === 'desc') { \n__p+='\\n  <svg class=\"UISlider-scale\" width=\"160px\" height=\"7px\" viewBox=\"0 0 160 7\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n    <g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\\n      <g fill=\"#EEEEEE\">\\n        <path d=\"M0,3.96972188 C0,2.86143684 0.899814069,1.95171147 1.99402962,1.93799103 L158.00597,-0.0182528125 C159.107243,-0.0320617354 160,0.846465216 160,1.95103649 L160,4.98745286 C160,6.08887023 159.100186,6.96483876 158.00597,6.94427947 L1.99402962,4.012961 C0.89275747,3.99226913 0,3.08692473 0,1.96876746 L0,3.96972188 Z\" id=\"Mask\" transform=\"translate(80.000000, 3.458568) scale(-1, 1) translate(-80.000000, -3.458568) \"></path>\\n      </g>\\n    </g>\\n  </svg>\\n  ';\n } else if (direction === 'asc') { \n__p+='\\n  <svg class=\"UISlider-scale\" width=\"160px\" height=\"7px\" viewBox=\"0 0 160 7\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n    <g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\\n      <g transform=\"translate(80.000000, 4.000000) rotate(-180.000000) translate(-80.000000, -4.000000) \" fill-rule=\"nonzero\" fill=\"#EEEEEE\">\\n        <path d=\"M0,4.96972188 C0,3.86143684 0.899814069,2.95171147 1.99402962,2.93799103 L158.00597,0.981747188 C159.107243,0.967938265 160,1.84646522 160,2.95103649 L160,5.98745286 C160,7.08887023 159.100186,7.96483876 158.00597,7.94427947 L1.99402962,5.012961 C0.89275747,4.99226913 0,4.08692473 0,2.96876746 L0,4.96972188 Z\" id=\"Mask\" transform=\"translate(80.000000, 4.463110) scale(-1, 1) translate(-80.000000, -4.463110) \"></path>\\n      </g>\\n    </g>\\n  </svg>\\n  ';\n } \n__p+='\\n  <div class=\"UISlider is-standalone ';\n if (direction) { \n__p+='without-line';\n } \n__p+=' js-slider\"></div>\\n  <span class=\"UISlider-label js-label\"></span>\\n</li>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nrequire('jquery-ui');\n\nBackbone.Form.editors.SortableList = Backbone.Form.editors.List.extend({\n  initialize: function () {\n    Backbone.Form.editors.List.prototype.initialize.apply(this, arguments);\n  },\n\n  render: function () {\n    Backbone.Form.editors.List.prototype.render.apply(this, arguments);\n    this._initSortable();\n    return this;\n  },\n\n  _initSortable: function () {\n    this.$list.sortable({\n      axis: 'y',\n      items: '.js-sortable',\n      tolerance: 'pointer',\n      containment: this.$list,\n      forceHelperSize: true,\n      forcePlaceholderSize: true,\n      update: this._onSortableUpdate.bind(this)\n    });\n  },\n\n  _onSortableUpdate: function (event, ui) {\n    var sorted = [];\n    _.each(this.items, function (item) {\n      var index = item.$el.index(this.$list);\n      sorted[index] = item;\n    });\n\n    this.items = sorted;\n    this.commit();\n  }\n});\n",
    "var Backbone = require('backbone');\n\nmodule.exports = Backbone.Collection.extend({\n  removeTag: function (label) {\n    var m = this.findWhere({label: label});\n    m && this.remove(m);\n  },\n\n  addTag: function (label) {\n    var m = this.findWhere({label: label});\n    !m && this.add({label: label});\n  },\n\n  getValue: function () {\n    return this.map(function (mdl) {\n      return mdl.get('label');\n    });\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\n\nmodule.exports = CoreView.extend({\n  tagName: 'li',\n\n  initialize: function (opts) {\n    if (!opts.label) throw new Error('label is required');\n    this._label = opts.label;\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(this._label);\n    return this;\n  }\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar template = require('./taglist.tpl');\nvar TagView = require('./taglist-item-view');\nvar TagCollection = require('./taglist-collection');\nvar EditorHelpers = require('../editor-helpers-extend');\n\nrequire('jquery');\nrequire('jquery-ui');\nrequire('tagit');\n\nBackbone.Form.editors.Taglist = Backbone.Form.editors.Base.extend({\n  className: 'Form-tags CDB-Text',\n  events: {\n    'mouseover': '_onMouseOver',\n    'mouseout': '_onMouseOut'\n  },\n  initialize: function (opts) {\n    Backbone.Form.editors.Base.prototype.initialize.call(this, opts);\n    EditorHelpers.setOptions(this, opts);\n\n    this._tagCollection = new TagCollection(this._normalize(opts.schema.options.tags));\n\n    this.isEditable = opts.schema.options.isEditable || opts.schema.options.isEditable === undefined;\n  },\n\n  render: function () {\n    this._initViews();\n    return this;\n  },\n\n  _initViews: function () {\n    var self = this;\n    var tagsPlaceholder = (!this.isEditable && this._tagCollection.length === 0)\n                          ? _t('components.taglist.none')\n                          : _t('components.taglist.placeholder');\n\n    this.$el.html(template());\n\n    this._tagCollection.each(this._renderTag, this);\n\n    this.$('.js-tagsList').tagit({\n      allowSpaces: true,\n      caseSensitive: false,\n      placeholderText: tagsPlaceholder,\n      readOnly: !this.isEditable,\n      onBlur: function () {\n        self.isEditable && self.$el.removeClass('is-focus');\n        self.trigger('blur', self);\n      },\n      onFocus: function () {\n        self.isEditable && self.$el.removeClass('is-hover').addClass('is-focus');\n        self.trigger('focus', self);\n      },\n      afterTagAdded: self._onTagAdded.bind(self),\n      afterTagRemoved: self._onTagRemoved.bind(self)\n    });\n  },\n\n  _renderTag: function (model) {\n    var view = new TagView({\n      label: model.get('label')\n    });\n\n    this.$('.js-tagsList').append(view.render().el);\n  },\n\n  focus: function () {\n    if (this.hasFocus) return;\n    this.$el.focus();\n  },\n\n  blur: function () {\n    if (!this.hasFocus) return;\n    this.$el.blur();\n  },\n\n  getValue: function () {\n    return this._tagCollection.getValue();\n  },\n\n  setValue: function (tags) {\n    this._tagCollection.reset(this._normalize(tags));\n    this._destroyTagit();\n    this.render();\n    this.trigger('change', this);\n  },\n\n  _onMouseOver: function () {\n    !this.$el.hasClass('is-focus') && this.$el.addClass('is-hover');\n  },\n\n  _onMouseOut: function () {\n    !this.$el.hasClass('is-focus') && this.$el.removeClass('is-hover');\n  },\n\n  _onTagRemoved: function (e, ui) {\n    var tag = ui.tag.find('.tagit-label').text();\n    this._tagCollection.removeTag(tag);\n    this.trigger('change', this);\n  },\n\n  _onTagAdded: function (e, ui) {\n    var tag = ui.tag.find('.tagit-label').text();\n    this._tagCollection.addTag(tag);\n    this.trigger('change', this);\n  },\n\n  _normalize: function (tags) {\n    return _.map(tags, function (tag) {\n      return {\n        label: tag.trim()\n      };\n    });\n  },\n\n  _destroyTagit: function () {\n    // cannot call public methods before initilization\n    // checking ui-widget class does the trick\n    (this.$('.ui-widget').length > 0) && this.$('.js-tagsList').tagit('destroy');\n  },\n\n  remove: function () {\n    this._destroyTagit();\n    Backbone.Form.editors.Base.prototype.remove.apply(this);\n  },\n\n  clean: function () {\n    this.$el.remove();\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<ul class=\"Form-tagsList js-tagsList\"></ul>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar EditorHelpers = require('./editor-helpers-extend');\n\nBackbone.Form.editors.Text = Backbone.Form.editors.Text.extend({\n  className: 'CDB-InputText CDB-Text',\n\n  initialize: function (opts) {\n    Backbone.Form.editors.Base.prototype.initialize.call(this, opts);\n    EditorHelpers.setOptions(this, opts);\n\n    var schema = this.schema;\n\n    // Allow customising text type (email, phone etc.) for HTML5 browsers\n    var type = 'text';\n\n    if (schema && schema.editorAttrs && schema.editorAttrs.type) type = schema.editorAttrs.type;\n    if (schema && schema.dataType) type = schema.dataType;\n\n    this.$el.attr('type', type);\n\n    this.determineChange = _.debounce(this.determineChange, 200);\n  },\n\n  render: function () {\n    this.setValue(this.value);\n    this._toggleDisableState();\n\n    if (this._isCopyButtonEnabled()) {\n      this._toggleClipboardState();\n    }\n\n    return this;\n  },\n\n  getValue: function () {\n    var val = this.$el.val();\n\n    return (val === '') ? null : val;\n  },\n\n  _toggleClipboardState: function () {\n    this.$el.toggleClass('Share-input-field u-ellipsis', this._isCopyButtonEnabled());\n  },\n\n  _togglePlaceholder: function () {\n    if (this.options.placeholder) {\n      this.$el.attr('placeholder', this.options.placeholder);\n    } else {\n      var placeholder = (this.value === null) ? 'null' : '';\n      this.$el.attr('placeholder', placeholder);\n    }\n  },\n\n  _toggleDisableState: function () {\n    if (this.options.disabled) {\n      this.$el.attr('readonly', '');\n      this.$el.attr('placeholder', '');\n\n      // if it's disabled AND has copy, leave just readonly\n      if (this._isCopyButtonEnabled()) {\n        this.$el.removeAttr('disabled');\n      }\n    } else {\n      this.$el.removeAttr('readonly');\n      this._togglePlaceholder();\n    }\n\n    this.$el.toggleClass('is-disabled', !!this.options.disabled);\n  },\n\n  _isCopyButtonEnabled: function () {\n    return !!this.options.hasCopyButton;\n  }\n});\n",
    "var Backbone = require('backbone');\n\nBackbone.Form.editors.TextArea = Backbone.Form.editors.Text.extend({\n  tagName: 'textarea',\n  className: 'CDB-Textarea',\n\n  render: function () {\n    this.setValue(this.value);\n    this._toggleDisableState();\n\n    return this;\n  },\n\n  getValue: function () {\n    var val = this.$el.val();\n\n    return (val === '') ? null : val;\n  },\n\n  _toggleDisableState: function () {\n    if (this.options.disabled) {\n      this.$el.attr('readonly', '');\n      this.$el.attr('placeholder', '');\n    } else {\n      this.$el.removeAttr('readonly');\n      this._togglePlaceholder();\n    }\n\n    this.$el.toggleClass('is-disabled', !!this.options.disabled);\n  }\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar template = require('./toggle.tpl');\n\nBackbone.Form.editors.Toggle = Backbone.Form.editors.Radio.extend({\n  className: 'Editor-formLabel CDB-Text CDB-Size-medium u-alignCenter',\n\n  _arrayToHtml: function (array) {\n    var name = this.getName();\n    var id = this.id;\n\n    var items = _.map(array, function (option, index) {\n      var val = this.form.model.get(this.key);\n      var item = {\n        name: name,\n        id: id + '-' + index\n      };\n\n      if (_.isObject(option)) {\n        item.value = (option.val || option.val === 0) ? option.val : '';\n        item.label = option.label;\n        item.help = option.help;\n        item.labelHTML = option.labelHTML;\n        item.selected = (val !== void 0) ? val === option.val : option.selected;\n      } else {\n        item.value = option;\n        item.label = option;\n        item.selected = (val !== void 0) ? val === option : option.selected;\n      }\n\n      return item;\n    }.bind(this));\n\n    return template({ items: items });\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='';\n _.each(items, function(item, index) { \n__p+='\\n  ';\n if (item.selected) { \n__p+='\\n    <li class=\"u-tSpace\">\\n      <input type=\"radio\" class=\"Editor-toggleRadio\" name=\"'+\n((__t=( item.name ))==null?'':__t)+\n'\" value=\"'+\n((__t=( item.value ))==null?'':_.escape(__t))+\n'\" id=\"'+\n((__t=( item.id ))==null?'':__t)+\n'\" checked=\"checked\" />\\n      ';\n if (item.help) { \n__p+='<p class=\"Editor-toggleHelp CDB-Text CDB-Size-small u-altTextColor\">'+\n((__t=( item.help ))==null?'':__t)+\n'</p>';\n } \n__p+='\\n    </li>\\n  ';\n } else { \n__p+='\\n    <li class=\"u-tSpace u-txt-right\">\\n      <input type=\"radio\" name=\"'+\n((__t=( item.name ))==null?'':__t)+\n'\" value=\"'+\n((__t=( item.value ))==null?'':_.escape(__t))+\n'\" id=\"'+\n((__t=( item.id ))==null?'':__t)+\n'\" />\\n      <label class=\"u-upperCase u-actionTextColor CDB-Text is-semibold CDB-Size-small u-iBlock\" for=\"'+\n((__t=( item.id ))==null?'':__t)+\n'\">';\n if (item.labelHTML){ \n__p+=''+\n((__t=( item.labelHTML ))==null?'':__t)+\n'';\n }else{ \n__p+=''+\n((__t=( item.label ))==null?'':_.escape(__t))+\n'';\n } \n__p+='</label>\\n    </li>\\n  ';\n } \n__p+='\\n';\n }); \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar $ = require('jquery');\nvar TipsyTooltipView = require('../tipsy-tooltip-view.js');\nvar Clipboard = require('clipboard');\n\nBackbone.Form.Field = Backbone.Form.Field.extend({\n\n  initialize: function (options) {\n    this.trackingClass = options.trackingClass;\n    this.constructor.__super__.initialize.apply(this, arguments);\n  },\n\n  render: function () {\n    this.constructor.__super__.render.apply(this, arguments);\n    if (this.schema.help) {\n      this._setHelp();\n    }\n    if (this._isCopyButtonEnabled()) {\n      this._initClipboard();\n    }\n    return this;\n  },\n\n  /**\n  * OVERWRITTEN the creation of the full field schema, merging defaults etc.\n  *\n  * @param {Object|String} schema\n  *\n  * @return {Object}\n  */\n  createSchema: function (schema) {\n    var editorType = schema.type;\n    schema = this.constructor.__super__.createSchema.apply(this, arguments);\n    schema.editorType = editorType;\n    return schema;\n  },\n\n  /**\n   * OVERWRITTEN the creation of the editor specified in the schema; either an\n   * editor string name or a constructor function\n   *\n   * @return {View}\n   */\n  createEditor: function () {\n    var options = _.extend(\n      _.pick(this, 'schema', 'form', 'key', 'model', 'value', 'trackingClass'),\n      { id: this.createEditorId() }\n    );\n\n    var ConstructorFn = this.schema.type;\n\n    return new ConstructorFn(options);\n  },\n\n  _setHelp: function () {\n    this._helpTooltip = this._createTooltip({\n      $el: this.$('.js-help')\n    });\n  },\n\n  // Changed original setError function in order to add\n  // the error tooltip\n  setError: function (msg) {\n    if (this.editor.hasNestedForm) return;\n    this.$el.addClass(this.errorClassName);\n    this._destroyErrorTooltip();\n    this._errorTooltip = this._createTooltip({\n      gravity: 'w',\n      className: 'is-error',\n      msg: msg,\n      offset: 5\n    });\n    this._errorTooltip.showTipsy();\n  },\n\n  // Changed original clearError function in order to remove\n  // the error tooltip\n  clearError: function () {\n    this.$el.removeClass(this.errorClassName);\n    this._destroyErrorTooltip();\n  },\n\n  _initClipboard: function () {\n    if (this._clipboard) {\n      this._clipboard.destroy();\n    }\n\n    var btn = this.$('.js-copy');\n    this._clipboard = new Clipboard(btn.get(0));\n  },\n\n  _createTooltip: function (opts) {\n    return new TipsyTooltipView({\n      el: opts.$el || this.$el,\n      gravity: opts.gravity || 's',\n      className: opts.className || '',\n      offset: opts.offset || 0,\n      title: function () {\n        return opts.msg || $(this).data('tooltip');\n      }\n    });\n  },\n\n  _destroyErrorTooltip: function () {\n    if (this._errorTooltip) {\n      this._errorTooltip.hideTipsy();\n      this._errorTooltip.destroyTipsy();\n    }\n  },\n\n  _destroyHelpTooltip: function () {\n    if (this._helpTooltip) {\n      this._helpTooltip.destroyTipsy();\n    }\n  },\n\n  _destroyClipboard: function () {\n    if (this._clipboard) {\n      this._clipboard.destroy();\n    }\n  },\n\n  // Changed original templateData function in order to add a\n  // new template attribute (hasNestedForm)\n  templateData: function () {\n    var schema = this.schema;\n    var type;\n\n    try {\n      type = this.form.schema[this.key].type;\n    } catch (e) {\n      type = undefined;\n    }\n\n    return {\n      help: schema.help || '',\n      isCopyButtonEnabled: this._isCopyButtonEnabled(),\n      hasNestedForm: this.editor.hasNestedForm,\n      title: schema.title,\n      fieldAttrs: schema.fieldAttrs,\n      editorAttrs: schema.editorAttrs,\n      key: this.key,\n      type: type,\n      editorId: this.editor.id,\n      editorType: this.editor.el.type\n    };\n  },\n\n  _isCopyButtonEnabled: function () {\n    return !!this.schema.hasCopyButton;\n  },\n\n  remove: function () {\n    this._destroyErrorTooltip();\n    this._destroyHelpTooltip();\n    this._destroyClipboard();\n    this.editor.remove();\n    Backbone.View.prototype.remove.call(this);\n  }\n\n}, {\n  template: require('./field.tpl'),\n  errorClassName: 'CDB-FieldError'\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CDB-Text Editor-formInner';\n if (type){ \n__p+=' Editor-formInner--'+\n((__t=( type ))==null?'':_.escape(__t))+\n'';\n } \n__p+='\">\\n  ';\n if (title) { \n__p+='\\n    <label class=\"CDB-Legend ';\n if (editorType){ \n__p+=' CDB-Legend--'+\n((__t=( editorType ))==null?'':_.escape(__t))+\n'';\n } \n__p+=' u-upperCase CDB-Text is-semibold CDB-Size-small u-rSpace--m\" for=\"'+\n((__t=( editorId ))==null?'':_.escape(__t))+\n'\" title=\"'+\n((__t=( title ))==null?'':_.escape(__t))+\n'\">\\n      <div class=\"u-ellipsis ';\n if (help) { \n__p+='Editor-formHelp';\n } \n__p+='\">\\n        <span class=\"';\n if (help) { \n__p+=' js-help is-underlined';\n } \n__p+='\" ';\n if (help) { \n__p+=' data-tooltip=\"'+\n((__t=( help ))==null?'':_.escape(__t))+\n'\"';\n } \n__p+=' >'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</span>\\n      </div>\\n    </label>\\n  ';\n } \n__p+='\\n  <div class=\"Editor-formInput u-flex u-alignCenter\" data-editor>\\n    ';\n if (isCopyButtonEnabled) { \n__p+='\\n      <button type=\"button\" class=\"Share-copy CDB-Button CDB-Button--small js-copy\" data-clipboard-target=\"#'+\n((__t=( editorId ))==null?'':_.escape(__t))+\n'\">\\n        <span class=\"CDB-Button-Text CDB-Text CDB-Size-small u-actionTextColor\">'+\n((__t=( _t('components.backbone-forms.copy-button') ))==null?'':_.escape(__t))+\n'</span>\\n      </button>\\n    ';\n } \n__p+='\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\n\n// overwirte template in order to be able to use flex\n/*eslint-disable */\nBackbone.Form.Fieldset.template = _.template('\\\n  <div class=\"Editor-fieldset\" data-fields>\\\n    <% if (legend) { %>\\\n      <legend><%= legend %></legend>\\\n    <% } %>\\\n  </div>\\\n');\n/*eslint-enable */\n",
    "var Backbone = require('backbone');\n\nBackbone.Form = Backbone.Form.extend({\n\n  initialize: function (options) {\n    this.options = options;\n    this.constructor.__super__.initialize.apply(this, arguments);\n  },\n\n  createField: function (key, schema) {\n    var options = {\n      form: this,\n      key: key,\n      schema: schema,\n      idPrefix: this.idPrefix,\n      trackingClass: this.options.trackingClass\n    };\n\n    if (this.model) {\n      options.model = this.model;\n    } else if (this.data) {\n      options.value = this.data[key];\n    } else {\n      options.value = undefined;\n    }\n\n    var field = new this.Field(options);\n\n    this.listenTo(field.editor, 'all', this.handleEditorEvent);\n\n    return field;\n  }\n\n});\n",
    "var $ = require('jquery');\nvar _ = require('underscore');\nvar Backbone = require('backbone');\nrequire('backbone-forms');\nBackbone.$ = $;\n\n// Custom validators\n_.extend(\n  Backbone.Form.validators,\n  {\n    interval: require('./validators/interval.js')\n  }\n);\n\n// Requiring custom form components\nrequire('./form.js');\nrequire('./fieldset-template.js');\nrequire('./field.js');\nrequire('./editors/base.js');\nrequire('./editors/text.js');\nrequire('./editors/textarea.js');\nrequire('./editors/number/number.js');\nrequire('./editors/select/select-view.js');\nrequire('./editors/select/multi-select-view.js');\nrequire('./editors/radio/radio.js');\nrequire('./editors/enabler/enabler-view.js');\nrequire('./editors/toggle/toggle.js');\nrequire('./editors/enabler-editor/enabler-editor-view.js');\nrequire('./editors/node-dataset/node-dataset-view.js');\nrequire('./editors/operators/operators-view.js');\nrequire('./editors/list/list.js');\nrequire('./editors/list/list-item.js');\nrequire('./editors/sortable-list.js');\nrequire('./editors/legend/category-item.js');\nrequire('./editors/slider/slider.js');\nrequire('./editors/fill/fill.js');\nrequire('./editors/taglist/taglist.js');\nrequire('./editors/datetime/datetime.js');\nrequire('./editors/select/suggest-view.js');\nrequire('./editors/data-observatory/dropdown-view.js');\nrequire('./editors/code-editor');\n",
    "module.exports = function (opts) {\n  // get the min value\n  var minValue = parseFloat(opts.min) || 0;\n  var maxValue = parseFloat(opts.max) || 0;\n  var err = {\n    type: opts.type,\n    message: _t('components.backbone-forms.interval-error', { minValue: opts.min, maxValue: opts.max })\n  };\n  return function interval (value, attrs) {\n    var fieldValue = 0;\n\n    if (value === null || value === undefined || value === '') return err;\n\n    // check if the value is number\n    if (!isNaN(parseFloat(value)) && isFinite(value)) {\n      fieldValue = parseFloat(value);\n    }\n    if (minValue > fieldValue || maxValue < fieldValue) {\n      return err;\n    }\n    return;\n  };\n};\n",
    "var $ = require('jquery');\nvar CoreView = require('backbone/core-view');\nvar utils = require('../helpers/utils');\nvar _ = require('underscore');\n\nvar IMAGE_DIM = 18;\nvar IMAGE_FILE_ATTRS = {\n  width: '18px',\n  height: '18px'\n};\n\nvar VIEWBOX = _.template('0 0 <%- w %> <%- h %>');\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    if (!opts.imageClass) { throw new Error('Image class is mandatory.'); }\n\n    this._imageClass = opts.imageClass;\n    this._imageURL = opts.imageUrl;\n    this._color = opts.color;\n\n    this._lastImage = {\n      url: null,\n      content: null\n    };\n  },\n\n  render: function () {\n    this.$el.empty();\n\n    this._loadImage();\n\n    return this;\n  },\n\n  _loadImage: function () {\n    if (!this._imageURL) { // the URL could be null or undefined\n      return;\n    }\n\n    var self = this;\n\n    if (this._isSVG(this._imageURL)) {\n      this._loadSVG();\n    } else {\n      var $img = $('<img crossorigin=\"anonymous\"/>');\n      $img.attr('class', self._imageClass + ' js-image');\n      $img.attr('src', this._imageURL + '?req=markup');\n\n      for (var attribute in IMAGE_FILE_ATTRS) {\n        $img.attr(attribute, IMAGE_FILE_ATTRS[attribute]);\n      }\n\n      this.$el.append($img);\n    }\n  },\n\n  _loadSVG: function () {\n    var self = this;\n\n    this._requestImageURL(this._imageURL, function (content) {\n      var svg = content.cloneNode(true);\n      var $svg = $(svg);\n      $svg = $svg.removeAttr('xmlns:a');\n      $svg.attr('class', self._imageClass + ' js-image');\n\n      var bbox = {\n        w: IMAGE_DIM,\n        h: IMAGE_DIM\n      };\n\n      if (!$svg.attr('viewBox')) {\n        if ($svg.attr('height') && $svg.attr('width')) {\n          bbox = {\n            w: svg.width.baseVal.value,\n            h: svg.height.baseVal.value\n          };\n        }\n\n        $svg.attr('viewBox', VIEWBOX(bbox));\n      }\n\n      for (var attribute in IMAGE_FILE_ATTRS) {\n        $svg.attr(attribute, IMAGE_FILE_ATTRS[attribute]);\n      }\n\n      self.$el.append($svg);\n\n      $svg.css('fill', self._color);\n      $svg.find('g').css('fill', 'inherit');\n      $svg.find('path').css('fill', 'inherit');\n    });\n  },\n\n  _requestImageURL: function (url, callback) {\n    var self = this;\n    var completeUrl = url + '?req=ajax';\n\n    if (this._lastImage.url === completeUrl) {\n      callback && callback(this._lastImage.content);\n    } else {\n      $.ajax(completeUrl)\n      .done(function (data) {\n        self._lastImage.url = completeUrl;\n        var content = self._lastImage.content = data.getElementsByTagName('svg')[0];\n        callback && callback(content);\n      })\n      .fail(function () {\n        throw new Error(\"Couldn't get \" + completeUrl + ' file.');\n      });\n    }\n  },\n\n  updateImageColor: function (color) {\n    this.$('.js-image').css('fill', color);\n  },\n\n  _isSVG: function (url) {\n    if (!url) {\n      return false;\n    }\n    var noQueryString = url.split('?')[0];\n    return noQueryString && utils.endsWith(noQueryString.toUpperCase(), 'SVG');\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='';\n if (type === 'primary') { \n__p+='\\n  <button class=\"CDB-Button CDB-Button--primary CDB-Button--medium ';\n if (disabled) { \n__p+='is-disabled';\n } \n__p+=' js-'+\n((__t=( action ))==null?'':_.escape(__t))+\n' js-action\">\\n    <span class=\"CDB-Button-Text CDB-Text is-semibold u-upperCase CDB-Size-small\">'+\n((__t=( label ))==null?'':__t)+\n'</span>\\n  </button>\\n';\n } else { \n__p+='\\n  <button class=\"Infobox-buttonLink u-upperCase ';\n if (disabled) { \n__p+='is-disabled';\n } \n__p+=' js-'+\n((__t=( action ))==null?'':_.escape(__t))+\n' js-action CDB-Text is-semibold CDB-Size-small\">\\n    '+\n((__t=( label ))==null?'':__t)+\n'\\n  </button>\\n';\n } \n__p+='';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar InfoboxModel = require('./infobox-item-model');\nvar _ = require('underscore');\n\n/*\n *  Infobox states collection\n */\n\nmodule.exports = Backbone.Collection.extend({\n  model: InfoboxModel,\n\n  initialize: function () {\n    this._initBinds();\n  },\n\n  reset: function (models, options) {\n    this._defaultSelected(models);\n    Backbone.Collection.prototype.reset.call(this, models, options);\n  },\n\n  _initBinds: function () {\n    this.on('change:selected', this._onSelectedChange, this);\n    this.on('reset', this._defaultSelected, this);\n  },\n\n  _defaultSelected: function (models) {\n    var selected = _.first(_.where(models, {selected: true}));\n    if (!selected) {\n      selected = _.first(models);\n      if (this._isModel(selected)) {\n        selected.set({selected: true}, {silent: true});\n      } else {\n        selected.selected = true;\n      }\n    }\n  },\n\n  _onSelectedChange: function (changedModel, isSelected) {\n    if (isSelected) {\n      this.each(function (m) {\n        if (m.cid !== changedModel.cid) {\n          m.set({selected: false}, {silent: true});\n        }\n      });\n    }\n  },\n\n  getState: function (state) {\n    return _.first(this.where({state: state}));\n  },\n\n  getSelected: function () {\n    var selected;\n    selected = _.first(this.where({selected: true}));\n    return selected;\n  },\n\n  setSelected: function (state) {\n    var selectedModel;\n\n    this.each(function (mdl) {\n      if (mdl.get('state') === state) {\n        mdl.set({selected: true}, {silent: true});\n        selectedModel = mdl;\n      } else {\n        mdl.set({selected: false}, {silent: true});\n      }\n    });\n\n    return selectedModel;\n  }\n\n});\n",
    "var InfoboxView = require('./infobox-item-view');\n\nmodule.exports = {\n  // Infobox with no buttons, only message\n  createInfo: function (opts) {\n    var closable = opts.closable === undefined ? true : opts.closable;\n    return new InfoboxView({\n      type: opts.type || 'default',\n      title: opts.title,\n      body: opts.body,\n      closable: closable\n    });\n  },\n\n  createWithAction: function (opts) {\n    var closable = opts.closable === undefined ? true : opts.closable;\n    var options = {\n      type: opts.type || 'default',\n      title: opts.title,\n      body: opts.body,\n      closable: closable\n    };\n\n    if (opts.mainAction) {\n      options.mainAction = {\n        label: opts.mainAction.label,\n        type: opts.mainAction.type\n      };\n    }\n\n    if (opts.secondAction) {\n      options.secondAction = {\n        label: opts.secondAction.label,\n        type: opts.secondAction.type\n      };\n    }\n\n    return new InfoboxView(options);\n  },\n\n  createLoading: function (opts) {\n    return new InfoboxView({\n      type: opts.type || 'default',\n      title: opts.title || '',\n      body: opts.body,\n      loading: true\n    });\n  },\n\n  createQuota: function (opts) {\n    if (opts.closable === undefined) {\n      opts.closable = true;\n    }\n\n    return new InfoboxView(opts);\n  }\n};\n",
    "var Backbone = require('backbone');\n\n/*\n *  Infobox item model\n *\n */\n\nmodule.exports = Backbone.Model.extend({\n  defaults: {\n    selected: false\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar template = require('./infobox.tpl');\nvar templateButton = require('./infobox-button.tpl');\nvar templateQuota = require('./infobox-quota.tpl');\n\nvar INFOBOX_TYPE = {\n  error: 'is-error',\n  alert: 'is-alert',\n  code: 'is-dark',\n  success: 'is-success',\n  default: ''\n};\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-mainAction': '_onMainClick',\n    'click .js-secondAction': '_onSecondClick',\n    'click .js-close': '_onClose'\n  },\n\n  initialize: function (opts) {\n    if (opts.title === undefined) throw new Error('Title is required');\n    if (opts.body === undefined) throw new Error('Body is required');\n\n    this._title = opts.title;\n    this._body = opts.body;\n    this._loading = opts.loading;\n    this._isClosable = opts.closable;\n\n    if (opts.quota) {\n      this._quota = opts.quota;\n    }\n\n    if (opts.mainAction) {\n      this._mainLabel = opts.mainAction.label;\n      this._mainType = opts.mainAction.type;\n      this._mainDisabled = opts.mainAction.disabled;\n    }\n\n    if (opts.secondAction) {\n      this._secondLabel = opts.secondAction.label;\n      this._secondType = opts.secondAction.type;\n      this._secondDisabled = opts.secondAction.disabled;\n    }\n\n    this._type = INFOBOX_TYPE[opts.type || 'default'];\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this._initViews();\n    return this;\n  },\n\n  _initViews: function () {\n    var hasButtons = this._mainLabel || this._secondLabel;\n    var hasQuota = !_.isEmpty(this._quota);\n    var isLoading = this._loading;\n\n    var view = template({\n      title: this._title,\n      body: this._body,\n      type: this._type,\n      isLoading: isLoading,\n      hasQuota: hasQuota,\n      hasButtons: hasButtons,\n      isClosable: this._isClosable\n    });\n\n    this.setElement(view);\n\n    if (this._mainLabel) {\n      this.$('.js-leftPosition').html(templateButton({\n        action: 'mainAction',\n        label: this._mainLabel,\n        type: this._mainType,\n        disabled: this._mainDisabled\n      }));\n    }\n\n    if (this._secondLabel) {\n      this.$('.js-rightPosition').html(templateButton({\n        action: 'secondAction',\n        label: this._secondLabel,\n        type: this._secondType,\n        disabled: this._secondDisabled\n      }));\n    }\n\n    if (hasQuota) {\n      var quota = this._quota;\n      var quotaPer = ((quota.usedQuota / quota.totalQuota) * 100);\n      if (isNaN(quotaPer)) {\n        quotaPer = 100;\n      }\n      var progressState = 'fine';\n      if (quotaPer > 75 && quotaPer < 90) {\n        progressState = 'alert';\n      } else if (quotaPer >= 90) {\n        progressState = 'caution';\n      }\n\n      this.$('.js-quota').html(templateQuota({\n        quotaMessage: quota.quotaMessage || '',\n        progressState: progressState,\n        quotaPer: quotaPer\n      }));\n    }\n  },\n\n  _onMainClick: function (e) {\n    this.trigger('action:main');\n  },\n\n  _onSecondClick: function (e) {\n    this.trigger('action:second');\n  },\n\n  _onClose: function (e) {\n    this.trigger('action:close');\n  }\n});\n",
    "var Backbone = require('backbone');\nvar INFOBOX_DEFAULT_STATE = '';\n\n/**\n * View model of a infobox\n *\n */\n\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    state: INFOBOX_DEFAULT_STATE\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<label class=\"CDB-Text CDB-Size CDB-Size-small u-secondaryTextColor\">'+\n((__t=( quotaMessage ))==null?'':_.escape(__t))+\n'</label>\\n<div class=\"Infobox-quotaBar Progress u-tSpace\">\\n  <div class=\"Infobox-quotaBarProgress Progress-bar Progress-bar--'+\n((__t=( progressState ))==null?'':_.escape(__t))+\n'\"\\n    style=\"width: '+\n((__t=( quotaPer ))==null?'':_.escape(__t))+\n'%\"\\n  ></div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar checkAndBuildOpts = require('../../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'infoboxModel',\n  'infoboxCollection'\n];\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    this._initBinds();\n    this._setSelectedModel();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this._initViews();\n    return this;\n  },\n\n  _initBinds: function () {\n    this.listenTo(this._infoboxModel, 'change:state', this._onChangeState);\n    this.listenTo(this._infoboxModel, 'change:visible', this.render);\n  },\n\n  _initViews: function () {\n    var createContentView;\n\n    if (this._selectedModel) {\n      createContentView = this._selectedModel.get('createContentView');\n      this.infoboxView = createContentView();\n      this.$el.append(this.infoboxView.render().el);\n      this.addView(this.infoboxView);\n      this._initSubviewBinds();\n    }\n  },\n\n  _setSelectedModel: function () {\n    var state = this._infoboxModel.get('state');\n    this._selectedModel = this._infoboxCollection.setSelected(state);\n  },\n\n  _onChangeState: function () {\n    this._setSelectedModel();\n    this.render();\n  },\n\n  _initSubviewBinds: function () {\n    this.listenTo(this.infoboxView, 'action:main', this._onMainAction);\n    this.listenTo(this.infoboxView, 'action:second', this._onSecondAction);\n    this.listenTo(this.infoboxView, 'action:close', this._onClose);\n  },\n\n  _onMainAction: function () {\n    var action = this._selectedModel.get('mainAction');\n    action && action();\n  },\n\n  _onSecondAction: function () {\n    var action = this._selectedModel.get('secondAction');\n    action && action();\n  },\n\n  _onClose: function () {\n    var action = this._selectedModel.get('closeAction');\n    if (action) {\n      action();\n    } else {\n      // if no action associated, we still need to hide the infobox\n      this._infoboxModel.set('state', null);\n    }\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Infobox '+\n((__t=( type ))==null?'':_.escape(__t))+\n'\">\\n  <div class=\"u-flex u-justifySpace u-alignCenter u-bSpace--m\">\\n    <h2 class=\"CDB-Text is-semibold CDB-Size-small u-upperCase\">'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</h2>\\n\\n    ';\n if (isClosable) { \n__p+='\\n    <button class=\"CDB-Shape js-close\">\\n      <div class=\"CDB-Shape-close is-large js-theme is-blue\"></div>\\n    </button>\\n    ';\n } \n__p+='\\n  </div>\\n\\n  <div class=\"CDB-Text CDB-Size-medium u-bSpace--xl u-flex\">\\n    ';\n if (isLoading) { \n__p+='\\n      <div class=\"CDB-LoaderIcon is-dark u-rSpace--m\">\\n        <svg class=\"CDB-LoaderIcon-spinner\" viewBox=\"0 0 50 50\">\\n          <circle class=\"CDB-LoaderIcon-path\" cx=\"25\" cy=\"25\" r=\"20\" fill=\"none\"></circle>\\n        </svg>\\n      </div>\\n    ';\n } \n__p+='\\n    <div>\\n      '+\n((__t=( body ))==null?'':__t)+\n'\\n    </div>\\n  </div>\\n\\n  <div class=\"u-flex u-justifySpace u-alignCenter\">\\n    ';\n if (hasQuota) { \n__p+='\\n      <div class=\"Infobox-quota js-quota\"></div>\\n    ';\n } \n__p+='\\n    ';\n if (hasButtons) { \n__p+='\\n      <ul class=\"Infobox-buttons ';\n if (hasQuota) { \n__p+='Infobox-buttons--quota';\n } \n__p+='\">\\n        <li class=\"Infobox-button js-leftPosition\"></li>\\n        <li class=\"Infobox-button Infobox-button--right js-rightPosition\"></li>\\n      </ul>\\n    ';\n } \n__p+='\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar utils = require('../../helpers/utils');\n\nvar REQUIRED_OPTS = [\n  'template',\n  'onEdit',\n  'renderOptions'\n];\n\nvar DBLCLICK_TIMEOUT = 200;\nvar clicks = 0;\nvar ESCAPE_KEY_CODE = 27;\nvar ENTER_KEY_CODE = 13;\n\nmodule.exports = CoreView.extend({\n  events: {\n    'blur .js-input': 'hide',\n    'keyup .js-input': '_onKeyUpInput'\n  },\n\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (!opts[item]) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n\n    this._onClickHandler = this._onClickHandler.bind(this);\n    this.edit = this.edit.bind(this);\n\n    this._timeout = opts.timeout || DBLCLICK_TIMEOUT;\n  },\n\n  render: function () {\n    this._unbindEvents();\n    this.clearSubViews();\n    this.$el.empty();\n    this._initViews();\n    this._initBinds();\n    return this;\n  },\n\n  _initBinds: function () {\n    if (this.options.onClick) {\n      this._onClick = this.options.onClick;\n      this._title().on('click', this._onClickHandler);\n    } else {\n      this._title().on('dblclick', this.edit);\n    }\n  },\n\n  _unbindEvents: function () {\n    var $title = this._title();\n    $title && $title.off('click dblclick');\n  },\n\n  _onClickHandler: function (e) {\n    var self = this;\n    clicks++;\n    if (clicks === 1) {\n      setTimeout(function () {\n        if (clicks === 1) {\n          self._onClick && self._onClick(e);\n        } else {\n          self.edit();\n        }\n        clicks = 0;\n      }, this._timeout);\n    }\n  },\n\n  _initViews: function () {\n    this.$el.append(this._template(this._renderOptions));\n    this.setElement(this.$('.Inline-editor'));\n  },\n\n  edit: function () {\n    this.$('.js-input').prop('readonly', false).show().focus();\n    this.$('.js-input').get(0).setSelectionRange(0, this.$('.js-input').val().length);\n  },\n\n  getValue: function () {\n    var inputValue = this.$('.js-input').val();\n    return utils.sanitizeHtml(inputValue);\n  },\n\n  _title: function () {\n    return this.$('.js-title');\n  },\n\n  hide: function () {\n    this.$('.js-input').prop('readonly', true).hide();\n  },\n\n  clean: function () {\n    this._unbindEvents();\n    CoreView.prototype.clean.call(this);\n  },\n\n  _onKeyUpInput: function (e) {\n    if (e.which === ESCAPE_KEY_CODE) {\n      this.hide();\n    }\n\n    if (e.which === ENTER_KEY_CODE) {\n      this._onEdit && this._onEdit(this.getValue());\n    }\n  }\n});\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\n\nvar LikeModel = Backbone.Model.extend({\n  defaults: {\n    likeable: true\n  },\n\n  url: function (method) {\n    var version = this._configModel.urlVersion('like');\n    var baseUrl = this._configModel.get('base_url');\n    return baseUrl + '/api/' + version + '/viz/' + this.get('vis_id') + '/like';\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!attrs.vis_id) throw new Error('vis_id attribute is required');\n    this._configModel = opts.configModel;\n\n    this.on('destroy', function () {\n      this.set({\n        liked: false,\n        likes: this.get('likes') - 1\n      });\n    }, this);\n  },\n\n  _onSaveError: function (model, response) {\n    this.trigger('error', {\n      status: response.status,\n      statusText: response.statusText\n    });\n  },\n\n  toggleLiked: function () {\n    if (this.get('liked')) {\n      this.destroy();\n    } else {\n      this.set({ id: null }, { silent: true });\n      this.save({}, {\n        error: this._onSaveError.bind(this)\n      });\n    }\n  }\n\n}, {\n  newByVisData: function (opts) {\n    var d = _.defaults({\n      id: opts.liked ? opts.vis_id : null\n    }, _.omit(opts, 'url', 'configModel'));\n\n    var m = new LikeModel(d, {\n      configModel: opts.configModel\n    });\n\n    if (opts.url) {\n      m.url = opts.url;\n    }\n\n    return m;\n  }\n});\n\nmodule.exports = LikeModel;\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./likes.tpl');\n\n/**\n * Responsible for likes ( 123) and its toggling behaviour.\n */\nmodule.exports = CoreView.extend({\n  tagName: 'a',\n\n  events: {\n    'click': '_toggleLike'\n  },\n\n  initialize: function () {\n    this.model.bind('change:likeable change:liked change:likes error', this.render, this);\n  },\n\n  render: function () {\n    this.$el.html(\n      template({\n        likes: this.model.get('likes'),\n        size: this.model.get('size'),\n        show_count: this.model.get('show_count'),\n        show_label: this.model.get('show_label')\n      })\n    );\n    this.$el.attr({\n      class: this._classNames(),\n      href: this._hrefLocation()\n    });\n\n    return this;\n  },\n\n  _hrefLocation: function () {\n    var href = '#/like';\n\n    if (!this.model.get('likeable')) {\n      href = window.login_url;\n    }\n\n    return href;\n  },\n\n  _classNames: function () {\n    var classNames = ['LikesIndicator'];\n\n    if (this.model.get('likeable')) {\n      classNames.push('is-likeable');\n    }\n\n    if (this.model.get('liked')) {\n      classNames.push('is-liked');\n    }\n\n    if (this._animate) {\n      classNames.push('is-animated');\n      this.$el.one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function () {\n        // unset animate and force re-render to avoid race conditions\n        this._animate = false;\n        this.render();\n      }.bind(this));\n    }\n\n    return classNames.join(' ');\n  },\n\n  _toggleLike: function (ev) {\n    if (this.model.get('likeable')) {\n      this.killEvent(ev);\n\n      this._animate = true;\n      this.model.toggleLiked();\n    }\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<i class=\"CDB-IconFont CDB-IconFont-heartFill LikesIndicator-icon ';\n if ((typeof size != \"undefined\") && size === 'big') { \n__p+='LikesIndicator-icon--big Navmenu-icon';\n } \n__p+='\"></i>\\n';\n if (likes > 2 || show_count) { \n__p+='\\n  <span class=\"CDB-Text CDB-Size-medium LikesIndicator-count\">'+\n((__t=( likes ))==null?'':_.escape(__t))+\n'</span>\\n  ';\n if (show_label && likes > 3) { \n__p+='\\n    <span class=\"CDB-Text CDB-Size-medium LikesIndicator-label\">'+\n((__t=( _t('components.likes-pluralize', { smart_count: likes }) ))==null?'':_.escape(__t))+\n'</span>\\n  ';\n } \n__p+='\\n';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"IntermediateInfo\">\\n  <div class=\"CDB-LoaderIcon CDB-LoaderIcon--big is-dark js-loader\">\\n    <svg class=\"CDB-LoaderIcon-spinner\" viewbox=\"0 0 50 50\">\\n      <circle class=\"CDB-LoaderIcon-path\" cx=\"25\" cy=\"25\" r=\"20\" fill=\"none\"/>\\n    </svg>\\n  </div>\\n  <h4 class=\"CDB-Text CDB-Size-large u-mainTextColor u-secondaryTextColor u-bSpace--m u-tSpace-xl\">'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</h4>\\n  <div class=\"CDB-Text CDB-Size-medium u-altTextColor\">'+\n((__t=( descHTML ))==null?'':__t)+\n'</div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text CDB-Size-medium u-altTextColor\">\\n  \"'+\n((__t=( quote ))==null?'':__t)+\n'\"\\n</p>\\n';\n if (author) { \n__p+='\\n  <p class=\"CDB-Text CDB-Size-medium u-altTextColor u-tSpace\"><i> '+\n((__t=( author ))==null?'':_.escape(__t))+\n'</i></p>\\n';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var template = require('./quote.tpl');\n\nvar QUOTES = [\n  { quote: 'Geographers never get lost. They just do accidental field work.', author: 'Nicholas Chrisman' },\n  { quote: 'Geography is just physics slowed down, with a couple of trees stuck in it.', author: 'Terry Pratchett' },\n  { quote: 'Not all those who wander are lost.', author: 'J. R. R. Tolkien' },\n  { quote: 'In that Empire, the Art of Cartography attained such Perfection that the map of a single Province occupied the entirety of a City.', author: 'Jorge Luis Borges' },\n  { quote: 'X marks the spot', author: 'Indiana Jones' },\n  { quote: \"It's turtles all the way down.\", author: null },\n  { quote: 'Remember: no matter where you go, there you are.', author: null },\n  { quote: \"Without geography, you're nowhere!\", author: 'Jimmy Buffett' },\n  { quote: 'our earth is a globe / whose surface we probe /<br />no map can replace her / but just try to trace her', author: 'Steve Waterman' },\n  { quote: 'Everything happens somewhere.', author: 'Doctor Who' },\n  { quote: 'A map is the greatest of all epic poems. Its lines and colors show the realization of great dreams.', author: 'Gilbert H. Grosvenor' },\n  { quote: 'Everything is related to everything else,<br />but near things are more related than distant things.', author: \"Tobler's first law of geography\" },\n  { quote: 'Hic Sunt Dracones', author: null },\n  { quote: 'Here be dragons', author: null },\n  { quote: \"Stand in the place where you live / Now face North /<br/>Think about direction / Wonder why you haven't before\", author: 'R.E.M' },\n  { quote: 'The virtue of maps, they show what can be done with limited space, they foresee that everything can happen therein.', author: 'Jos Saramago' }\n];\n\n/**\n * Random quote\n */\nmodule.exports = function () {\n  var idx = Math.round(Math.random() * (QUOTES.length - 1));\n\n  return template(QUOTES[idx]);\n};\n",
    "var cdb = require('cartodb.js');\nvar template = require('./loading.tpl');\nvar randomQuote = require('./random-quote');\n\n/**\n * @param {Object} opts\n * @param {String=} opts.title\n * @param {String=} opts.desc\n */\nmodule.exports = function (opts) {\n  var customDesc = opts.desc && cdb.core.sanitize(opts.desc);\n\n  return template({\n    title: opts.title || '',\n    descHTML: customDesc || randomQuote()\n  });\n};\n",
    "var storage = (function () {\n  var storageName = 'cdb';\n  var version = '0.1.0';\n  var mainStorageKey;\n  var initialized = false;\n  var userModel;\n\n  function init (key, opts) {\n    if (!key) {\n      throw new Error('key is required');\n    }\n\n    if (!userModel && !opts) {\n      throw new Error('userModel is required');\n    }\n\n    if (!userModel && opts && opts.userModel) {\n      userModel = opts.userModel;\n    }\n\n    mainStorageKey = key;\n    initialized = true;\n  }\n\n  function getKey (key) {\n    return [storageName, version, userModel.get('username'), mainStorageKey, key].join('.');\n  }\n\n  function isSupported () {\n    try {\n      return 'localStorage' in window && window['localStorage'] !== null;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  return {\n    init: function (key, opts) {\n      if (!isSupported()) throw new Error('localStorage not supported in your browser');\n      init(key, opts);\n    },\n\n    get: function (key) {\n      if (!initialized) {\n        init();\n      }\n      var storageKey = getKey(key);\n      return localStorage[storageKey];\n    },\n\n    set: function (key, value) {\n      if (!initialized) {\n        init();\n      }\n      var storageKey = getKey(key);\n      localStorage[storageKey] = value;\n    },\n\n    delete: function (key) {\n      if (!initialized) {\n        init();\n      }\n\n      var storageKey = getKey(key);\n      delete localStorage[storageKey];\n    }\n  };\n})();\n\nmodule.exports = storage;\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\n\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    eventName: '',\n    eventProperties: {}\n  },\n\n  url: function () {\n    return this._configModel.get('base_url') + '/api/v3/metrics';\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.userId) { throw new Error('userId is required'); }\n    if (!opts.visId) { throw new Error('visId is required'); }\n    if (!opts.configModel) { throw new Error('configModel is required'); }\n\n    this._userId = opts.userId;\n    this._visId = opts.visId;\n    this._configModel = opts.configModel;\n  },\n\n  toJSON: function () {\n    return {\n      name: this.get('eventName'),\n      properties: _.extend(\n        {},\n        this.get('eventProperties'),\n        {\n          visualization_id: this._visId,\n          user_id: this._userId\n        }\n      )\n    };\n  }\n});\n",
    "var MetricsModel = require('./metrics-model');\n\n/**\n *  Metrics singleton tracker.\n *  It sends any event to metrics endpoint.\n */\n\nmodule.exports = (function () {\n  return {\n    init: function (opts) {\n      if (!opts) { throw new Error('visId, userId and configModel are required'); }\n      if (!opts.userId) { throw new Error('userId is required'); }\n      if (!opts.visId) { throw new Error('visId is required'); }\n      if (!opts.configModel) { throw new Error('configModel is required'); }\n\n      this._userId = opts.userId;\n      this._visId = opts.visId;\n      this._configModel = opts.configModel;\n    },\n\n    track: function (eventName, eventProperties) {\n      if (!eventName) { throw new Error('eventName is required'); }\n\n      var metricModel = new MetricsModel({\n        eventName: eventName,\n        eventProperties: eventProperties\n      }, {\n        userId: this._userId,\n        visId: this._visId,\n        configModel: this._configModel\n      });\n\n      metricModel.save();\n    }\n  };\n})();\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Modal\">\\n  <div class=\"Modal-header\">\\n    <div class=\"Modal-headerContainer\">\\n      <h2 class=\"CDB-Text CDB-Size-huge is-light u-bSpace\">'+\n((__t=( _t('components.modals.add-analysis.modal-title') ))==null?'':_.escape(__t))+\n'</h2>\\n      <h3 class=\"CDB-Text CDB-Size-medium u-altTextColor\">'+\n((__t=( _t('components.modals.add-analysis.modal-desc') ))==null?'':_.escape(__t))+\n'</h3>\\n    </div>\\n  </div>\\n  <div class=\"Modal-container Modal-container--analysis\">\\n    <div class=\"Modal-inner js-body\">\\n    </div>\\n  </div>\\n  <div class=\"Modal-footer\">\\n    <div class=\"Modal-footerContainer u-flex u-justifyEnd\">\\n      <button class=\"CDB-Button CDB-Button--primary is-disabled js-add\">\\n        <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">'+\n((__t=( _t('components.modals.add-analysis.add-btn') ))==null?'':_.escape(__t))+\n'</span>\\n      </button>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar Analyses = require('../../../data/analyses');\nvar AnalysisOptionsCollection = require('./analysis-options-collection');\nvar analysisOptions = require('./analysis-options');\nvar StackLayoutView = require('../../../components/stack-layout/stack-layout-view');\nvar AnalysisViewPane = require('./analysis-view-pane');\nvar AnalysisInfoPane = require('./analysis-info-pane');\nvar renderLoading = require('../../../components/loading/render-loading');\nvar DataServicesApiCheck = require('../../../editor/layers/layer-content-views/analyses/analyses-quota/analyses-quota-info');\n\n/**\n * View to add a new analysis node.\n * Expected to be rendered in a modal.\n */\nmodule.exports = CoreView.extend({\n  className: 'Dialog-content Dialog-content--expanded',\n\n  events: {\n    'click .js-add': '_onAddAnalysis'\n  },\n\n  initialize: function (opts) {\n    if (!opts.modalModel) throw new Error('modalModel is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.layerDefinitionModel) throw new Error('layerDefinitionModel is required');\n\n    this._modalModel = opts.modalModel;\n    this._layerDefinitionModel = opts.layerDefinitionModel;\n    this._userModel = opts.userModel;\n    this._configModel = opts.configModel;\n    this._analysisDefinitionNodeModel = this._layerDefinitionModel.getAnalysisDefinitionNodeModel();\n\n    this._analysisOptions = analysisOptions(Analyses, this._userModel, this._configModel);\n    this._analysisOptionsCollection = new AnalysisOptionsCollection();\n\n    this.add_related_model(this._analysisOptionsCollection);\n\n    this._queryGeometryModel = this._analysisDefinitionNodeModel.queryGeometryModel;\n    this._queryGeometryModel.on('change', this.render, this);\n    this.add_related_model(this._queryGeometryModel);\n\n    this._dataservicesApiHealth = DataServicesApiCheck.get();\n\n    if (!this._isFetchingGeometry()) {\n      this._queryGeometryModel.fetch();\n    }\n\n    this._initOptions();\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    var render = this.render.bind(this);\n    var dsApiNeedsCheck = this._dataservicesApiHealth.needsCheck();\n    if (dsApiNeedsCheck) {\n      this._dataservicesApiHealth.fetch({\n        success: render\n      });\n    }\n\n    if (this._isFetchingGeometry() || dsApiNeedsCheck) {\n      this._renderLoadingView();\n    } else {\n      this._renderStackView();\n    }\n\n    return this;\n  },\n\n  _renderLoadingView: function () {\n    this.$el.html(\n      renderLoading({\n        title: _t('components.modals.add-widgets.loading-title')\n      })\n    );\n  },\n\n  _renderStackView: function () {\n    var stackViewCollection = new Backbone.Collection([{\n      createStackView: function (stackLayoutModel, opts) {\n        var view = new AnalysisViewPane({\n          modalModel: this._modalModel,\n          stackLayoutModel: stackLayoutModel,\n          analysisOptions: this._analysisOptions,\n          analysisOptionsCollection: this._analysisOptionsCollection,\n          layerDefinitionModel: this._layerDefinitionModel,\n          queryGeometryModel: this._queryGeometryModel\n        });\n        this._analysisViewPane = view;\n        return view;\n      }.bind(this)\n    }, {\n      createStackView: function (stackLayoutModel, opts) {\n        var view = new AnalysisInfoPane({\n          stackLayoutModel: stackLayoutModel,\n          modalModel: this._modalModel,\n          layerDefinitionModel: this._layerDefinitionModel,\n          collection: this._analysisOptionsCollection\n        });\n\n        view.bind('backToCategory', function (categoryName) {\n          stackLayoutModel.prevStep();\n          this._analysisViewPane.goToTabItem(categoryName);\n        }, this);\n\n        return view;\n      }.bind(this)\n    }]);\n\n    this._stackLayoutView = new StackLayoutView({\n      className: 'Editor-content',\n      collection: stackViewCollection\n    });\n\n    this.$el.html(this._stackLayoutView.render().$el);\n    this.addView(this._stackLayoutView);\n  },\n\n  _isFetchingGeometry: function () {\n    return this._queryGeometryModel.get('status') === 'fetching';\n  },\n\n  _initOptions: function () {\n    // Flatten the options hierarchy to a flat array structure that's easier to handle programmatically.\n    var modelsAttrs = _.reduce(Object.keys(this._analysisOptions), function (memo, category) {\n      var categoryDef = this._analysisOptions[category];\n      categoryDef.analyses.forEach(function (d) {\n        memo.push(_.extend({}, d, { category: category, type: d.nodeAttrs.type }));\n      });\n\n      return memo;\n    }, [], this);\n\n    this._analysisOptionsCollection.reset(modelsAttrs);\n  }\n});\n",
    "var _ = require('underscore');\nvar AnalysisCategoryView = require('./analysis-category-pane-view');\n\nmodule.exports = function (analysisOptions) {\n  return [{\n    type: 'create_clean',\n    createTabPaneItem: function (optionsCollection, opts) {\n      return {\n        label: _t('analysis-category.create-clean'),\n        name: 'create_clean',\n        createContentView: function () {\n          return new AnalysisCategoryView(_.extend({\n            analysisOptions: analysisOptions,\n            analysisType: 'create_clean',\n            collection: optionsCollection\n          }, opts));\n        }\n      };\n    }\n  }, {\n    type: 'analyze_predict',\n    createTabPaneItem: function (optionsCollection, opts) {\n      return {\n        label: _t('analysis-category.analyze-predict'),\n        name: 'analyze_predict',\n        createContentView: function () {\n          return new AnalysisCategoryView(_.extend({\n            analysisOptions: analysisOptions,\n            analysisType: 'analyze_predict',\n            collection: optionsCollection\n          }, opts));\n        }\n      };\n    }\n  }, {\n    type: 'data_transformation',\n    createTabPaneItem: function (optionsCollection, opts) {\n      return {\n        label: _t('analysis-category.data-transformation'),\n        name: 'data_transformation',\n        createContentView: function () {\n          return new AnalysisCategoryView(_.extend({\n            analysisOptions: analysisOptions,\n            analysisType: 'data_transformation',\n            collection: optionsCollection\n          }, opts));\n        }\n      };\n    }\n  }];\n};\n",
    "var CoreView = require('backbone/core-view');\nvar ScrollView = require('../../scroll/scroll-view');\nvar AnalysisCategoryPane = require('./analysis-category-pane');\n\n/**\n * View to add a new analysis node.\n * Expected to be rendered in a modal.\n */\nmodule.exports = CoreView.extend({\n  className: 'Dialog-content Dialog-content--expanded',\n\n  initialize: function (opts) {\n    if (!opts.modalModel) throw new Error('modalModel is required');\n    if (!opts.stackLayoutModel) throw new Error('stackLayoutModel is required');\n    if (!opts.analysisOptionsCollection) throw new Error('analysisOptionsCollection is required');\n    if (!opts.analysisType) throw new Error('analysisType is required');\n    if (!opts.analysisOptions) throw new Error('analysisOptions is required');\n    if (!opts.queryGeometryModel) throw new Error('queryGeometryModel is required');\n\n    this._modalModel = opts.modalModel;\n    this._stackLayoutModel = opts.stackLayoutModel;\n    this._queryGeometryModel = opts.queryGeometryModel;\n    this._analysisOptionsCollection = opts.analysisOptionsCollection;\n    this._analysisType = opts.analysisType;\n    this._analysisOptions = opts.analysisOptions;\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    var view = new ScrollView({\n      createContentView: function () {\n        return new AnalysisCategoryPane({\n          stackLayoutModel: this._stackLayoutModel,\n          collection: this._analysisOptionsCollection,\n          title: this.options.categoryTitle || this.options.category,\n          category: this._analysisType === 'all' ? null : this._analysisType,\n          categoryTitle: this._analysisType === 'all' ? null : this._analysisOptions[this._analysisType].label,\n          simpleGeometryType: this._queryGeometryModel.get('simple_geom')\n        });\n      }.bind(this)\n    });\n\n    this.addView(view);\n    this.$el.append(view.render().el);\n\n    return this;\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar AnalysisOptionView = require('./analysis-option-view');\nvar template = require('./analysis-category.tpl');\n\n/**\n * View to render an individual analysis category and its analysis options\n */\nmodule.exports = CoreView.extend({\n\n  className: 'Modal-analysisContainer',\n\n  options: {\n    category: '',\n    categoryTitle: '',\n    simpleGeometryType: ''\n  },\n\n  initialize: function (opts) {\n    if (!opts.stackLayoutModel) throw new Error('stackLayoutModel is required');\n    this._stackLayoutModel = opts.stackLayoutModel;\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    this.$el.html(this._html());\n    this.collection.each(this._renderOption, this);\n\n    return this;\n  },\n\n  _html: function () {\n    return template({\n      title: this.options.title\n    });\n  },\n\n  _renderOption: function (analysisOptionModel) {\n    if (this.options.category && !analysisOptionModel.belongsTo(this.options.category)) {\n      return;\n    }\n\n    var view = new AnalysisOptionView({\n      model: analysisOptionModel,\n      simpleGeometryTypeInput: this.options.simpleGeometryType\n    });\n\n    view.bind('onClickInfo', function () {\n      this._stackLayoutModel.nextStep();\n    }, this);\n\n    this.addView(view);\n    this._$list().append(view.render().el);\n  },\n\n  _$list: function () {\n    return this.$('.js-analyses-list');\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<ul class=\"ModalBlockList js-analyses-list\"></ul>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./analysis-info-pane.tpl');\nvar Analyses = require('../../../data/analyses');\n\n/**\n * View to render an individual analysis category and its analysis options\n */\nmodule.exports = CoreView.extend({\n  className: 'Modal',\n\n  events: {\n    'click .js-back': '_onClickBack',\n    'click .js-backToCategory': '_onClickBackToCategory',\n    'click .js-add': '_onAddAnalysis'\n  },\n\n  initialize: function (opts) {\n    if (!opts.layerDefinitionModel) throw new Error('layerDefinitionModel is required');\n    if (!opts.modalModel) throw new Error('modalModel is required');\n    if (!opts.stackLayoutModel) throw new Error('stackLayoutModel is required');\n\n    this._layerDefinitionModel = opts.layerDefinitionModel;\n    this._modalModel = opts.modalModel;\n    this._stackLayoutModel = opts.stackLayoutModel;\n\n    this.collection.on('change:selected', this.render, this);\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    var selectedAnalysis = this.collection.find('selected');\n    var analysisType;\n    var genericType;\n    var opts = { title: '', category: '', type: '', genericType: '', analysisParams: '' };\n\n    if (selectedAnalysis) {\n      var analysisParams = {};\n      analysisType = selectedAnalysis.get('type');\n      var analysisItem = Analyses.getAnalysisByType(analysisType);\n      var animationTemplate = analysisItem && analysisItem.animationTemplate;\n\n      if (animationTemplate) {\n        genericType = analysisItem.genericType || analysisType;\n        analysisParams = analysisItem.animationParams || {};\n      }\n\n      this._analysisCategoryName = selectedAnalysis.get('category');\n\n      opts = {\n        type: analysisType,\n        genericType: genericType,\n        category: this._analysisCategoryName.replace(/_/g, '-'),\n        title: selectedAnalysis.get('title'),\n        analysisParams: analysisParams\n      };\n    }\n\n    this.$el.html(template(opts));\n\n    if (animationTemplate) {\n      this.$('.js-animation').append(animationTemplate);\n    }\n\n    return this;\n  },\n\n  _onClickBackToCategory: function () {\n    this.trigger('backToCategory', this._analysisCategoryName, this);\n  },\n\n  _onClickBack: function () {\n    this._stackLayoutModel.prevStep();\n  },\n\n  _isSelected: function (m) {\n    return !!m.get('selected');\n  },\n\n  _onAddAnalysis: function () {\n    var selectedOptionModel = this.collection.find(this._isSelected);\n\n    if (selectedOptionModel) {\n      var analysisFormAttrs = selectedOptionModel.getFormAttrs(this._layerDefinitionModel);\n      this._modalModel.destroy(analysisFormAttrs);\n    }\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Modal-header\">\\n  <div class=\"Modal-headerContainer\">\\n    <div class=\"CDB-HeaderInfo\">\\n      <button class=\"u-rSpace--xl CDB-HeaderInfo-back u-actionTextColor js-back\">\\n        <i class=\"CDB-IconFont CDB-IconFont-arrowPrev Size-large\"></i>\\n      </button>\\n      <div class=\"CDB-HeaderInfo-inner\">\\n        <h2 class=\"CDB-Text CDB-Size-huge is-light u-bSpace\">'+\n((__t=( _t('components.modals.add-analysis.modal-title') ))==null?'':_.escape(__t))+\n'</h2>\\n        <h3 class=\"CDB-Text CDB-Size-medium u-altTextColor\">'+\n((__t=( _t('components.modals.add-analysis.modal-desc') ))==null?'':_.escape(__t))+\n'</h3>\\n      </div>\\n    </div>\\n  </div>\\n</div>\\n\\n<div class=\"Modal-inner Modal-inner--with-navigation js-content\">\\n  <div class=\"Dialog-content Dialog-content--expanded\">\\n    <div class=\"ScrollView\">\\n      <div class=\"ScrollView-content\">\\n        <div class=\"Modal-analysisContainer\">\\n          <ul class=\"CDB-NavMenu-inner CDB-Text is-semibold CDB-Size-small SubmenuModal u-flex u-alignCenter\">\\n            <li class=\"CDB-NavMenu-item SubmenuModal-item u-flex u-alignCenter\">\\n              <button class=\"js-back u-mainTextColor u-upperCase\">'+\n((__t=( _t('analysis-category.all') ))==null?'':_.escape(__t))+\n'</button>\\n            </li>\\n            <li class=\"CDB-NavMenu-item SubmenuModal-item u-flex u-alignCenter\">\\n              <button class=\"js-backToCategory u-mainTextColor u-upperCase\">'+\n((__t=( _t('analysis-category.' + category) ))==null?'':_.escape(__t))+\n'</button>\\n            </li>\\n            <li class=\"CDB-NavMenu-item u-upperCase SubmenuModal-item u-flex u-alignCenter\">\\n              '+\n((__t=( title ))==null?'':_.escape(__t))+\n'\\n            </li>\\n          </ul>\\n          <div class=\"Modal-inner u-justifyCenter\">\\n            <div class=\"Analysis-moreInfo\">\\n              <div class=\"Analysis-animation ';\n if (genericType) { \n__p+='is-'+\n((__t=( genericType ))==null?'':_.escape(__t))+\n'';\n } \n__p+=' has-autoplay js-animation is-rounded\"></div>\\n              <h2 class=\"CDB-Text CDB-Size-huge is-light Analysis-moreInfoTitle\">'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</h2>\\n              <p class=\"CDB-Text CDB-Size-medium u-secondaryTextColor\">\\n                '+\n((__t=( _t('analyses-onboarding.' + genericType + '.description', analysisParams) ))==null?'':_.escape(__t))+\n'\\n              </p>\\n            </div>\\n          </div>\\n        </div>\\n      </div>\\n    </div>\\n  </div>\\n</div>\\n<div class=\"Modal-footer\">\\n  <div class=\"Modal-footerContainer u-flex u-justifyEnd\">\\n    <button class=\"CDB-Button CDB-Button--primary js-add\">\\n      <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">'+\n((__t=( _t('components.modals.add-analysis.add-btn') ))==null?'':_.escape(__t))+\n'</span>\\n    </button>\\n  </div>\\n</div>\\n\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar camshaftReference = require('../../../../data/camshaft-reference');\nvar nodeIds = require('../../../../value-objects/analysis-node-ids');\n\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    title: '',\n    category: '',\n    selected: false,\n    type_group: '',\n    desc: ''\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.nodeAttrs) throw new Error('nodeAttrs is required');\n\n    this._nodeAttrs = opts.nodeAttrs;\n  },\n\n  belongsTo: function (category) {\n    return this.get('category') === category;\n  },\n\n  acceptsGeometryTypeAsInput: function (simpleGeometryType) {\n    return camshaftReference.isValidInputGeometryForType(simpleGeometryType, this._nodeAttrs.type);\n  },\n\n  getValidInputGeometries: function () {\n    return camshaftReference.getValidInputGeometriesForType(this._nodeAttrs.type);\n  },\n\n  getFormAttrs: function (layerDefModel) {\n    var letter = layerDefModel.get('letter');\n    var sourceId = layerDefModel.get('source');\n\n    return _.extend(\n      {\n        source: sourceId,\n        id: letter === nodeIds.letter(sourceId)\n          ? nodeIds.next(sourceId)\n          : letter + '1'\n      },\n      this._nodeAttrs\n    );\n  }\n\n});\n",
    "var _ = require('underscore');\nvar AnalysisOptionModel = require('./analysis-option-model');\nvar camshaftReference = require('../../../../data/camshaft-reference');\n\n/**\n * Model to represent a generated analysis option.\n */\nmodule.exports = AnalysisOptionModel.extend({\n\n  /**\n   * @override {AnalysisOptionModel.getNodeAttrs}\n   */\n  getFormAttrs: function () {\n    var attrs = AnalysisOptionModel.prototype.getFormAttrs.apply(this, arguments);\n\n    this._removeSourceIfThereAreMultipleSources(attrs);\n\n    return attrs;\n  },\n\n  _removeSourceIfThereAreMultipleSources: function (attrs) {\n    var params = camshaftReference.paramsForType(attrs.type);\n    var sourceCount = _.reduce(Object.keys(params), function (memo, name) {\n      if (params[name].type === 'node') {\n        memo++;\n      }\n      return memo;\n    }, 0);\n\n    if (sourceCount > 1) {\n      delete attrs.source;\n    }\n  }\n\n});\n",
    "var _ = require('underscore');\nvar AnalysisOptionModel = require('./analysis-option-model');\n\n/**\n * Custom model for merge type, to set correct primary source\n */\nmodule.exports = AnalysisOptionModel.extend({\n\n  /**\n   * @override {AnalysisOptionModel.getNodeAttrs}\n   */\n  getFormAttrs: function (layerDefModel) {\n    var attrs = AnalysisOptionModel.prototype.getFormAttrs.apply(this, arguments);\n    delete attrs.source;\n\n    _.extend(attrs, {\n      primary_source_name: 'left_source',\n      left_source: layerDefModel.get('source')\n    });\n\n    return attrs;\n  }\n\n});\n",
    "var _ = require('underscore');\nvar $ = require('jquery');\nvar CoreView = require('backbone/core-view');\nvar template = require('./analysis-option.tpl');\nvar Analyses = require('../../../data/analyses');\n\n/**\n * View for an individual analysis option.\n */\nmodule.exports = CoreView.extend({\n\n  tagName: 'li',\n  className: 'ModalBlockList-item',\n\n  events: {\n    'mouseenter': '_onMouseEnter',\n    'mouseleave': '_onMouseLeave',\n    'click': '_onClick'\n  },\n\n  initialize: function (opts) {\n    this._simpleGeometryTypeInput = opts.simpleGeometryTypeInput; // might be undefined/null, so don't check\n\n    this.listenTo(this.model, 'change:selected', this.render);\n  },\n\n  render: function () {\n    var props = this.model.pick('title', 'type_group', 'desc', 'selected');\n\n    props.enabled = this._acceptsInputGeometry();\n\n    if (!props.enabled) {\n      props.desc = this._disabledDesc();\n    }\n\n    var analysisType = this.model.get('type');\n    var analysisItem = Analyses.getAnalysisByType(analysisType);\n    var animationTemplate = analysisItem && analysisItem.animationTemplate;\n    var genericType = '';\n\n    if (animationTemplate) {\n      genericType = analysisItem.genericType || analysisType;\n    }\n\n    this.$el.html(template(_.extend(props, { type: genericType })));\n\n    if (animationTemplate) {\n      this.$('.js-animation').append(animationTemplate);\n    }\n\n    this.$el.toggleClass('is-selected', this.model.get('selected'));\n    this.$el.toggleClass('is-disabled', !props.enabled);\n\n    return this;\n  },\n\n  _onMouseEnter: function () {\n    if (this._acceptsInputGeometry()) {\n      this.$('.js-animation').addClass('has-autoplay');\n    }\n  },\n\n  _onMouseLeave: function () {\n    if (this._acceptsInputGeometry()) {\n      this.$('.js-animation').removeClass('has-autoplay');\n    }\n  },\n\n  _onClick: function (e) {\n    if (e && e.target && $(e.target).hasClass('js-more')) {\n      this.trigger('onClickInfo', this);\n    }\n\n    if (this._acceptsInputGeometry()) {\n      this.model.set('selected', true);\n    }\n  },\n\n  _disabledDesc: function (desc) {\n    return _t('components.modals.add-analysis.disabled-option-desc', {\n      simpleGeometryType: this._simpleGeometryTypeInput || _t('components.modals.add-analysis.unknown-geometry-type'),\n      requiredInputGeometries: this.model.getValidInputGeometries()\n    });\n  },\n\n  _acceptsInputGeometry: function () {\n    return this.model.acceptsGeometryTypeAsInput(this._simpleGeometryTypeInput);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Analysis-animation ';\n if (enabled) { \n__p+='is-enabled';\n } \n__p+=' ';\n if (type) { \n__p+='is-'+\n((__t=( type ))==null?'':_.escape(__t))+\n'';\n } \n__p+=' js-animation u-flex u-alignCenter u-justifyCenter\"></div>\\n<div class=\"Analysis-info u-flex\">\\n  <div class=\"ModalBlockList-itemInput CDB-Size-large\">\\n    <input class=\"CDB-Radio\" type=\"radio\" value=\"true\"\\n        ';\n if (selected) { \n__p+='checked=\"checked\"';\n } \n__p+='\\n        ';\n if (!enabled) { \n__p+='disabled=\"disabled\"';\n } \n__p+='\\n      >\\n    <span class=\"u-iBlock CDB-Radio-face\"></span>\\n  </div>\\n  <div class=\"ModalBlockList-inner\">\\n    <div class=\"ModalBlockList-item-header u-bSpace\">\\n      <h2 class=\"ModalBlockList-item-headerTitle CDB-Text CDB-Size-large u-rSpace--m u-ellipsis\" title=\"'+\n((__t=( title ))==null?'':_.escape(__t))+\n'\">\\n        '+\n((__t=( title ))==null?'':_.escape(__t))+\n'\\n      </h2>\\n    </div>\\n    <div class=\"ModalBlockList-item-body\">\\n      <p class=\"CDB-Text CDB-Size-small u-altTextColor\">\\n        '+\n((__t=( desc ))==null?'':_.escape(__t))+\n'\\n      </p>\\n      <button class=\"CDB-Text CDB-Size-small u-tSpace-xl u-actionTextColor js-more\">'+\n((__t=( _t('components.modals.add-analysis.info-analysis') ))==null?'':_.escape(__t))+\n'</button>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar AnalysisOptionModel = require('./analysis-option-models/analysis-option-model');\n\nmodule.exports = Backbone.Collection.extend({\n\n  model: function (d, opts) {\n    var Model = d.Model || AnalysisOptionModel;\n\n    var attrs = _.omit(d, 'Model', 'nodeAttrs');\n\n    return new Model(attrs, {nodeAttrs: d.nodeAttrs});\n  },\n\n  initialize: function (models, opts) {\n    this.on('change:selected', this._onSelectedChange, this);\n  },\n\n  _onSelectedChange: function (changedModel, isSelected) {\n    if (isSelected) {\n      this.each(function (m) {\n        if (m !== changedModel) {\n          m.set('selected', false);\n        }\n      });\n    }\n  }\n});\n",
    "var _ = require('underscore');\nvar GeneratedAnalysisOptionModel = require('./analysis-option-models/generated-analysis-option-model');\nvar camshaftReference = require('camshaft-reference');\nvar latestCamshaftReference = camshaftReference.getVersion('latest');\n\n/**\n * Analysis definitions, organized in buckets per top-level category\n *\n *  - {Obj} -> analyses list (data/analyses.js file)\n *  - {Obj} -> user model\n *  - {Obj} -> config model\n */\nmodule.exports = function (Analyses, userModel, configModel) {\n  var categories = {\n    create_clean: {\n      title: _t('analysis-category.create-clean'),\n      analyses: Analyses.getAnalysesByModalCategory('create_clean', configModel, userModel)\n    },\n    data_transformation: {\n      title: _t('analysis-category.data-transformation'),\n      analyses: Analyses.getAnalysesByModalCategory('data_transformation', configModel, userModel)\n    },\n    analyze_predict: {\n      title: _t('analysis-category.analyze-predict'),\n      analyses: Analyses.getAnalysesByModalCategory('analyze_predict', configModel, userModel)\n    }\n  };\n  var alsoGenerateFromCamshaftReference = userModel.featureEnabled('generate_analysis_options');\n\n  if (alsoGenerateFromCamshaftReference) {\n    var implementedAnalyses = _.reduce(Object.keys(categories), function (memo, category) {\n      return memo.concat(\n        categories[category].analyses.map(function (analysis) {\n          return analysis.nodeAttrs.type;\n        })\n      );\n    }, []);\n\n    categories['generated'] = {\n      title: 'Generated analyses by the Camshaft reference v' + _.last(camshaftReference.versions),\n      analyses: _.compact(\n        Object\n          .keys(latestCamshaftReference.analyses)\n          .filter(function (type) {\n            return type !== 'source' && !_.contains(implementedAnalyses, type);\n          })\n          .map(function (type) {\n            if (!Analyses.isAnalysisValidByType(type, configModel, userModel)) {\n              return false;\n            }\n\n            return {\n              Model: GeneratedAnalysisOptionModel,\n              nodeAttrs: {type: type},\n              title: type,\n              desc: JSON.stringify(latestCamshaftReference.analyses[type])\n            };\n          })\n      )\n    };\n  }\n\n  return categories;\n};\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar AnalysisCategoryView = require('./analysis-category-pane-view');\nvar createTemplateTabPane = require('../../tab-pane/create-template-tab-pane');\nvar template = require('./add-analyses.tpl');\nvar tabPaneButtonTemplate = require('./tab-pane-button-template.tpl');\nvar tabPaneTemplate = require('./tab-pane-template.tpl');\nvar analysesTypes = require('./analyses-types');\n\n/**\n * View to select the analysis to create.\n */\nmodule.exports = CoreView.extend({\n  className: 'Dialog-content Dialog-content--expanded',\n\n  events: {\n    'click .js-add': '_onAddAnalysis'\n  },\n\n  initialize: function (opts) {\n    if (!opts.modalModel) throw new Error('modalModel is required');\n    if (!opts.stackLayoutModel) throw new Error('stackLayoutModel is required');\n    if (!opts.analysisOptionsCollection) throw new Error('analysisOptionsCollection is required');\n    if (!opts.analysisOptions) throw new Error('analysisOptions is required');\n    if (!opts.layerDefinitionModel) throw new Error('layerDefinitionModel is required');\n    if (!opts.queryGeometryModel) throw new Error('queryGeometryModel is required');\n\n    this._modalModel = opts.modalModel;\n    this._stackLayoutModel = opts.stackLayoutModel;\n    this._analysisOptions = opts.analysisOptions;\n    this._analysisOptionsCollection = opts.analysisOptionsCollection;\n    this._layerDefinitionModel = opts.layerDefinitionModel;\n    this._queryGeometryModel = opts.queryGeometryModel;\n\n    this.listenTo(this._analysisOptionsCollection, 'change:selected', this._toggleAddButton);\n    this._generateTabPaneItems();\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    this.$el.html(template());\n\n    var options = {\n      tabPaneOptions: {\n        template: tabPaneTemplate,\n        tabPaneItemOptions: {\n          tagName: 'li',\n          className: 'CDB-NavMenu-item'\n        }\n      },\n      tabPaneTemplateOptions: {\n        tagName: 'button',\n        className: 'CDB-NavMenu-link u-upperCase',\n        template: tabPaneButtonTemplate\n      }\n    };\n\n    this._tabPane = createTemplateTabPane(this._tabPaneItems, options);\n    this.addView(this._tabPane);\n    this._$body().append(this._tabPane.render().el);\n    return this;\n  },\n\n  goToTabItem: function (tabItemName) {\n    var tabItem = _.first(this._tabPane.collection.where({ name: tabItemName }));\n    if (tabItem) {\n      tabItem.set('selected', true);\n      this._toggleAddButton(); // set the right state for the add button\n    }\n  },\n\n  _generateTabPaneItems: function () {\n    var availableTypes = _.unique(_.keys(this._analysisOptions));\n\n    this._tabPaneItems = _.map(analysesTypes(this._analysisOptions), function (d) {\n      if (_.contains(availableTypes, d.type)) {\n        return d.createTabPaneItem(this._analysisOptionsCollection, {\n          modalModel: this._modalModel,\n          stackLayoutModel: this._stackLayoutModel,\n          analysisOptionsCollection: this._analysisOptionsCollection,\n          queryGeometryModel: this._queryGeometryModel\n        });\n      }\n    }.bind(this));\n\n    this._tabPaneItems.unshift({\n      label: _t('analysis-category.all'),\n      name: 'all',\n      createContentView: function () {\n        return new AnalysisCategoryView({\n          analysisType: 'all',\n          stackLayoutModel: this._stackLayoutModel,\n          modalModel: this._modalModel,\n          analysisOptions: this._analysisOptions,\n          analysisOptionsCollection: this._analysisOptionsCollection,\n          queryGeometryModel: this._queryGeometryModel\n        });\n      }.bind(this)\n    });\n  },\n\n  _$body: function () {\n    return this.$('.js-body');\n  },\n\n  _onAddAnalysis: function () {\n    var selectedOptionModel = this._analysisOptionsCollection.find(this._isSelected);\n\n    if (selectedOptionModel) {\n      var analysisFormAttrs = selectedOptionModel.getFormAttrs(this._layerDefinitionModel);\n      this._modalModel.destroy(analysisFormAttrs);\n    }\n  },\n\n  _toggleAddButton: function () {\n    this.$('.js-add').toggleClass('is-disabled', !this._analysisOptionsCollection.any(this._isSelected));\n  },\n\n  _isSelected: function (m) {\n    return !!m.get('selected');\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"308px\" height=\"98px\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n  <g fill=\"#9DE0AD\" fill-rule=\"evenodd\" transform=\"translate(50, 8)\">\\n    <circle class=\"aoi-area area01\" fill=\"#5A7E6D\" cx=\"20\" cy=\"36\" r=\"20\"></circle>\\n    <circle class=\"aoi-point area-point01\" cx=\"20\" cy=\"36\" r=\"4\"></circle>\\n    <circle class=\"aoi-area area02\" fill=\"#5A7E6D\" cx=\"56\" cy=\"28\" r=\"20\"></circle>\\n    <circle class=\"aoi-point area-point02\"  cx=\"56\" cy=\"28\" r=\"4\"></circle>\\n    <circle class=\"aoi-area area03\" fill=\"#5A7E6D\" cx=\"76\" cy=\"44\" r=\"20\"></circle>\\n    <circle class=\"aoi-point area-point03\" cx=\"76\" cy=\"44\" r=\"4\"></circle>\\n    <circle class=\"aoi-area area04\" fill=\"#5A7E6D\" cx=\"138\" cy=\"60\" r=\"20\"></circle>\\n    <circle class=\"aoi-point area-point04\" cx=\"138\" cy=\"60\" r=\"4\"></circle>\\n    <circle class=\"aoi-area area05\" fill=\"#5A7E6D\" cx=\"156\" cy=\"20\" r=\"20\"></circle>\\n    <circle class=\"aoi-point area-point05\" cx=\"156\" cy=\"20\" r=\"4\"></circle>\\n    <circle class=\"aoi-area area06\" fill=\"#5A7E6D\" cx=\"188\" cy=\"28\" r=\"20\"></circle>\\n    <circle class=\"aoi-point area-point06\" cx=\"188\" cy=\"28\" r=\"4\"></circle>\\n  </g>\\n</svg>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"148px\" height=\"141px\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n  <g fill=\"#636D72\" fill-rule=\"evenodd\">\\n    <circle class=\"Centroid-pointsHighlight\" fill=\"#9DE0AD\" cx=\"74\" cy=\"70\" r=\"4\"></circle>\\n    <circle class=\"Centroid-line\" fill=\"none\" stroke=\"#9DE0AD\" cx=\"74.5\" cy=\"70\" r=\"70\"></circle>\\n    <circle class=\"Centroid-points Centroid-points01\" cx=\"4\" cy=\"65\" r=\"4\"></circle>\\n    <circle class=\"Centroid-points Centroid-points02\" cx=\"34\" cy=\"85\" r=\"4\"></circle>\\n    <circle class=\"Centroid-points Centroid-points03\" cx=\"103\" cy=\"50\" r=\"4\"></circle>\\n    <circle class=\"Centroid-points Centroid-points04\" cx=\"83\" cy=\"40\" r=\"4\"></circle>\\n    <circle class=\"Centroid-points Centroid-points05\" cx=\"63\" cy=\"90\" r=\"4\"></circle>\\n    <circle class=\"Centroid-points Centroid-points06\" cx=\"144\" cy=\"65\" r=\"4\"></circle>\\n    <circle class=\"Centroid-points Centroid-points07\" cx=\"93\" cy=\"96\" r=\"4\"></circle>\\n    <circle class=\"Centroid-points Centroid-points08\" cx=\"44\" cy=\"55\" r=\"4\"></circle>\\n    <circle class=\"Centroid-points Centroid-points09\" cx=\"112\" cy=\"83\" r=\"4\"></circle>\\n    <circle class=\"Centroid-points Centroid-points10\" cx=\"24\" cy=\"45\" r=\"4\"></circle>\\n  </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"306\" height=\"98\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n  <g transform=\"translate(30, 16)\" fill=\"#636D72\">\\n\\n    <g>\\n      <path class=\"Line Line-01\" d=\"M109,32 L42,29\"></path>\\n      <path class=\"Line Line-02\" d=\"M109,32 L72,49\"></path>\\n      <path class=\"Line Line-03\" d=\"M109,32 L101,54\"></path>\\n      <path class=\"Line Line-04\" d=\"M109,32 L131,60\"></path>\\n      <path class=\"Line Line-05\" d=\"M109,32 L82,19\"></path>\\n      <path class=\"Line Line-06\" d=\"M109,32 L150,47\"></path>\\n      <path class=\"Line Line-07\" d=\"M109,32 L121,4\"></path>\\n      <path class=\"Line Line-08\" d=\"M109,32 L141,14\"></path>\\n      <path class=\"Line Line-09\" d=\"M109,32 L159,25\"></path>\\n    </g>\\n\\n    <circle class=\"Dot Dot--withColorChange Dot-01\" cx=\"42\" cy=\"29\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--withColorChange Dot-02\" cx=\"72\" cy=\"49\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--withColorChange Dot-03\" cx=\"101\" cy=\"54\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--withColorChange Dot-04\" cx=\"131\" cy=\"60\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--withColorChange Dot-05\" cx=\"82\" cy=\"19\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--withColorChange Dot-06\" cx=\"150\" cy=\"47\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--withColorChange Dot-07\" cx=\"141\" cy=\"14\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--withColorChange Dot-08\" cx=\"121\" cy=\"4\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--withColorChange Dot-09\" cx=\"159\" cy=\"25\" r=\"4\"></circle>\\n\\n    <circle class=\"Dot Dot--withFadeOut Dot-10\" cx=\"52\" cy=\"54\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--withFadeOut Dot-11\" cx=\"4\" cy=\"54\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--withFadeOut Dot-12\" cx=\"28\" cy=\"14\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--withFadeOut Dot-13\" cx=\"188\" cy=\"6\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--withFadeOut Dot-14\" cx=\"196\" cy=\"46\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--withFadeOut Dot-15\" cx=\"228\" cy=\"26\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--withFadeOut Dot-16\" cx=\"182\" cy=\"29\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--withFadeOut Dot-17\" cx=\"62\" cy=\"9\" r=\"4\"></circle>\\n\\n    <circle class=\"Dot\" fill=\"white\" cx=\"109\" cy=\"32\" r=\"4\"></circle>\\n  </g>\\n</svg>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"148px\" height=\"64px\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n  <g stroke=\"none\" fill=\"#636D72\">\\n    <polyline class=\"Line\" stroke=\"#9DE0AD\" points=\"4.08007812 29.7382812 34.2617188 49.4335938 24.2285156 9.83007812 43.7246094 18.7578125 62.9414062 54.7128906 73.6425781 30.9160156 92.3808594 59.359375 83.328125 3.75585938 103.042969 14.6777344 111.734375 47.1640625 144.171875 28.3574219\"></polyline>\\n    <circle class=\"Dot Dot-01\" cx=\"4\" cy=\"29\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot-02\" cx=\"34\" cy=\"49\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot-03\" cx=\"24\" cy=\"9\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot-04\" cx=\"44\" cy=\"19\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot-05\" cx=\"63\" cy=\"54\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot-06\" cx=\"74\" cy=\"32\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot-07\" cx=\"93\" cy=\"60\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot-08\" cx=\"83\" cy=\"4\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot-09\" cx=\"103\" cy=\"14\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot-10\" cx=\"112\" cy=\"47\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot-11\" cx=\"144\" cy=\"29\" r=\"4\"></circle>\\n  </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"302px\" height=\"98px\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n  <defs>\\n    <rect id=\"path-1\" x=\"0\" y=\"0\" width=\"304\" height=\"96\"></rect>\\n    <rect id=\"path-3\" x=\"48\" y=\"0\" width=\"48\" height=\"64\"></rect>\\n    <mask id=\"mask-4\" x=\"0\" y=\"0\" width=\"48\" height=\"64\" fill=\"white\">\\n      <use xlink:href=\"#path-3\"></use>\\n    </mask>\\n    <rect id=\"path-5\" x=\"0\" y=\"31\" width=\"49\" height=\"33\"></rect>\\n    <mask id=\"mask-6\" x=\"0\" y=\"0\" width=\"49\" height=\"33\" fill=\"white\">\\n      <use xlink:href=\"#path-5\"></use>\\n    </mask>\\n    <rect id=\"path-7\" x=\"95\" y=\"0\" width=\"57\" height=\"24\"></rect>\\n    <mask id=\"mask-8\" x=\"0\" y=\"0\" width=\"57\" height=\"24\" fill=\"white\">\\n      <use xlink:href=\"#path-7\"></use>\\n    </mask>\\n    <rect id=\"path-9\" x=\"151\" y=\"8\" width=\"18\" height=\"16\"></rect>\\n    <mask id=\"mask-10\" x=\"0\" y=\"0\" width=\"18\" height=\"16\" fill=\"white\">\\n      <use xlink:href=\"#path-9\"></use>\\n    </mask>\\n    <rect id=\"path-11\" x=\"24\" y=\"16\" width=\"25\" height=\"16\"></rect>\\n    <mask id=\"mask-12\" x=\"0\" y=\"0\" width=\"25\" height=\"16\" fill=\"white\">\\n      <use xlink:href=\"#path-11\"></use>\\n    </mask>\\n    <rect id=\"path-13\" x=\"95\" y=\"23\" width=\"25\" height=\"25\"></rect>\\n    <mask id=\"mask-14\" x=\"0\" y=\"0\" width=\"25\" height=\"25\" fill=\"white\">\\n      <use xlink:href=\"#path-13\"></use>\\n    </mask>\\n    <rect id=\"path-15\" x=\"119\" y=\"23\" width=\"58\" height=\"33\"></rect>\\n    <mask id=\"mask-16\" maskContentUnits=\"userSpaceOnUse\" maskUnits=\"objectBoundingBox\" x=\"0\" y=\"0\" width=\"58\" height=\"33\" fill=\"white\">\\n      <use xlink:href=\"#path-15\"></use>\\n    </mask>\\n  </defs>\\n  <g id=\"Page-1\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\\n    <g>\\n      <g>\\n        <g>\\n          <mask id=\"mask-2\" fill=\"white\">\\n            <use xlink:href=\"#path-1\"></use>\\n          </mask>\\n          <use id=\"Rectangle-10\" xlink:href=\"#path-1\"></use>\\n        </g>\\n        <g transform=\"translate(64, 16)\" stroke=\"#282C2F\" stroke-width=\"2\" fill=\"#9DE0AD\">\\n          <use class=\"rect-01\" mask=\"url(#mask-4)\" fill-opacity=\"0.32\" xlink:href=\"#path-3\"></use>\\n          <use class=\"rect-02\" mask=\"url(#mask-6)\" fill-opacity=\"0.8\" xlink:href=\"#path-5\"></use>\\n          <use class=\"rect-03\" mask=\"url(#mask-8)\" fill-opacity=\"0.639999986\" xlink:href=\"#path-7\"></use>\\n          <use class=\"rect-04\" mask=\"url(#mask-10)\" fill-opacity=\"0.160000011\" xlink:href=\"#path-9\"></use>\\n          <use class=\"rect-05\" mask=\"url(#mask-12)\" fill-opacity=\"0.48\" xlink:href=\"#path-11\"></use>\\n          <use class=\"rect-06\" mask=\"url(#mask-14)\" xlink:href=\"#path-13\"></use>\\n          <use class=\"rect-07\" mask=\"url(#mask-16)\" fill-opacity=\"0.800000012\" xlink:href=\"#path-15\"></use>\\n        </g>\\n      </g>\\n    </g>\\n  </g>\\n</svg>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"306\" height=\"98\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n  <circle class=\"Dot\" cx=\"117\" cy=\"33\" r=\"4\"></circle>\\n  <circle class=\"Dot\" cx=\"91\" cy=\"57\" r=\"4\"></circle>\\n  <circle class=\"Dot--withSplash Dot--withSplash--01\" cx=\"91\" cy=\"57\" r=\"4\"></circle>\\n  <circle class=\"Dot\" cx=\"73\" cy=\"27\" r=\"4\"></circle>\\n  <circle class=\"Dot\" cx=\"223\" cy=\"39\" r=\"4\"></circle>\\n  <circle class=\"Dot--withSplash Dot--withSplash--02\" cx=\"223\" cy=\"39\" r=\"4\"></circle>\\n  <circle class=\"Dot\" cx=\"125\" cy=\"69\" r=\"4\"></circle>\\n  <circle class=\"Dot\" cx=\"64\" cy=\"65\" r=\"4\"></circle>\\n  <circle class=\"Dot\" cx=\"151\" cy=\"71\" r=\"4\"></circle>\\n  <circle class=\"Dot--withSplash Dot--withSplash--03\" cx=\"151\" cy=\"71\" r=\"4\"></circle>\\n  <circle class=\"Dot\" cx=\"205\" cy=\"75\" r=\"4\"></circle>\\n  <circle class=\"Dot\" cx=\"163\" cy=\"61\" r=\"4\"></circle>\\n  <circle class=\"Dot\" cx=\"133\" cy=\"43\" r=\"4\"></circle>\\n  <circle class=\"Dot\" cx=\"189\" cy=\"46\" r=\"4\"></circle>\\n  <circle class=\"Dot--withSplash Dot--withSplash--04\" cx=\"189\" cy=\"46\" r=\"4\"></circle>\\n  <circle class=\"Dot\" cx=\"242\" cy=\"45\" r=\"4\"></circle>\\n  <circle class=\"Dot\" cx=\"155\" cy=\"39\" r=\"4\"></circle>\\n  <circle class=\"Dot\" cx=\"195\" cy=\"23\" r=\"4\"></circle>\\n  <circle class=\"Dot--green Dot-01\" cx=\"91\" cy=\"57\" r=\"4\"></circle>\\n  <circle class=\"Dot--green Dot-02\" cx=\"223\" cy=\"39\" r=\"4\"></circle>\\n  <circle class=\"Dot--green Dot-03\" cx=\"151\" cy=\"71\" r=\"4\"></circle>\\n  <circle class=\"Dot--green Dot-04\" cx=\"189\" cy=\"46\" r=\"4\"></circle>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"304\" height=\"96\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n  <g fill=\"#636D72\" stroke=\"none\" stroke-width=\"1\">\\n    <g stroke=\"#FFFFFF\" stroke-linecap=\"square\">\\n      <path class=\"Line\" d=\"M174.5,58.5 L166.5,35.5\" id=\"Line\"></path>\\n      <path class=\"Line\" d=\"M174.5,58.5 L145.5,40.5\" id=\"Line\"></path>\\n      <path class=\"Line\" d=\"M128.5,29.5 L145.5,40.5\" id=\"Line\"></path>\\n      <path class=\"Line\" d=\"M128.5,29.5 L84.5,24.5\" id=\"Line\"></path>\\n      <path class=\"Line--withHighlight\" d=\"M174.5,58.5 L136.5,66.5\" id=\"Line\"></path>\\n      <path class=\"Line--withHighlight\" d=\"M103.5,53.5 L136.5,66.5\" id=\"Line\"></path>\\n      <path class=\"Line--withHighlight\" d=\"M76.5,61.5 L104.5,53.5\" id=\"Line\"></path>\\n      <path class=\"Line\" d=\"M174.5,58.5 L162.5,68.5\" id=\"Line\"></path>\\n      <path class=\"Line\" d=\"M174.5,58.5 L217.5,71.5\" id=\"Line\"></path>\\n      <path class=\"Line\" d=\"M235.5,35.5 L217.5,71.5\" id=\"Line\"></path>\\n      <path class=\"Line\" d=\"M235.5,35.5 L253.5,41.5\" id=\"Line\"></path>\\n      <path class=\"Line\" d=\"M202.5,42.5 L166.5,35.5\" id=\"Line\"></path>\\n      <path class=\"Line\" d=\"M202.5,42.5 L207.5,18.5\" id=\"Line\"></path>\\n      <path class=\"Line--withFade\" d=\"M174.5,58.5 L136.5,66.5\" id=\"Line\"></path>\\n      <path class=\"Line--withFade\" d=\"M103.5,53.5 L136.5,66.5\" id=\"Line\"></path>\\n      <path class=\"Line--withFade\" d=\"M76.5,61.5 L104.5,53.5\" id=\"Line\"></path>\\n    </g>\\n\\n    <circle class=\"Dot Dot-01\" cx=\"129\" cy=\"30\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot-02\" cx=\"85\" cy=\"24\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot-03\" cx=\"235\" cy=\"36\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot-04\" cx=\"163\" cy=\"68\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot-05\" cx=\"217\" cy=\"72\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot-06\" cx=\"145\" cy=\"40\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot-07\" cx=\"201\" cy=\"43\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot-08\" cx=\"254\" cy=\"42\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot-09\" cx=\"167\" cy=\"36\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot-10\" cx=\"207\" cy=\"20\" r=\"4\"></circle>\\n\\n    <circle class=\"Dot-11 Dot--withHighlight\" cx=\"103\" cy=\"54\" r=\"4\"></circle>\\n    <circle class=\"Dot-12 Dot--withHighlight\" cx=\"137\" cy=\"66\" r=\"4\"></circle>\\n    <circle class=\"Dot-13 Dot--withHighlight\" cx=\"76\" cy=\"62\" r=\"4\"></circle>\\n    <circle class=\"Dot-14 Dot--withHighlight\" cx=\"175\" cy=\"58\" r=\"4\"></circle>\\n  </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"306px\" height=\"98px\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n  <g fill=\"#636D72\" fill-rule=\"evenodd\" transform=\"translate(70, 15)\">\\n    <polygon fill=\"none\" class=\"Filter-line\" stroke=\"#9DE0AD\" points=\"73.703125 13.6435547 97.5439453 17.5722656 106.554688 42.9824219 92.5517578 55.5849609 63.3261719 53.5224609 54.0126953 15.3515625 59.0839844 11.4414062\"></polygon>\\n    <circle class=\"Filter-dotHighlight Filter-dotHighlight--01\" cx=\"95\" cy=\"20\" r=\"4\"></circle>\\n    <circle class=\"Filter-dotHighlight Filter-dotHighlight--06\" cx=\"73\" cy=\"24\" r=\"4\"></circle>\\n    <circle class=\"Filter-dotHighlight Filter-dotHighlight--02\" cx=\"103\" cy=\"42\" r=\"4\"></circle>\\n    <circle class=\"Filter-dotHighlight Filter-dotHighlight--03\" cx=\"91\" cy=\"52\" r=\"4\"></circle>\\n    <circle class=\"Filter-dotHighlight Filter-dotHighlight--05\" cx=\"57\" cy=\"14\" r=\"4\"></circle>\\n    <circle class=\"Filter-dotHighlight Filter-dotHighlight--04\" cx=\"65\" cy=\"50\" r=\"4\"></circle>\\n    <circle class=\"Filter-dot circle08\" cx=\"163\" cy=\"20\" r=\"4\"></circle>\\n    <circle class=\"Filter-dot circle07\" cx=\"31\" cy=\"38\" r=\"4\"></circle>\\n    <circle class=\"Filter-dot circle06\" cx=\"13\" cy=\"8\" r=\"4\"></circle>\\n    <circle class=\"Filter-dot circle05\" cx=\"4\" cy=\"46\" r=\"4\"></circle>\\n    <circle class=\"Filter-dot circle04\" cx=\"145\" cy=\"56\" r=\"4\"></circle>\\n    <circle class=\"Filter-dot circle03\" cx=\"129\" cy=\"27\" r=\"4\"></circle>\\n    <circle class=\"Filter-dot circle02\" cx=\"182\" cy=\"26\" r=\"4\"></circle>\\n    <circle class=\"Filter-dot circle01\" cx=\"135\" cy=\"4\" r=\"4\"></circle>\\n  </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"302px\" height=\"99px\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n  <g fill=\"#9DE0AD\" fill-rule=\"evenodd\">\\n    <path d=\"M0.5,41.5 L305.5,24.5\" class=\"Georeference-street00\" stroke=\"#282C2F\" stroke-width=\"8\" stroke-linecap=\"square\"></path>\\n    <path d=\"M134,0 L141,91\" class=\"Georeference-street01\" stroke=\"#282C2F\" stroke-width=\"8\" stroke-linecap=\"square\"></path>\\n    <path d=\"M258,0 L265,91\" class=\"Georeference-street02\" stroke=\"#282C2F\" stroke-width=\"8\" stroke-linecap=\"square\"></path>\\n    <text class=\"Georeference-point02-text\" font-family=\"Open Sans\" font-size=\"10\" font-weight=\"300\" fill=\"#FFFFFF\">\\n      <tspan x=\"63\" y=\"62\">-63.578373</tspan>\\n      <tspan x=\"63\" y=\"76\">44.642619</tspan>\\n    </text>\\n    <text class=\"Georeference-point01-text\" font-family=\"Open Sans\" font-size=\"10\" font-weight=\"300\" fill=\"#FFFFFF\">\\n      <tspan x=\"198\" y=\"54\">IP 214.80.33.47</tspan>\\n    </text>\\n    <circle class=\"Dot Dot-01\" fill=\"#9DE0AD\" cx=\"43\" cy=\"40\" r=\"8\"></circle>\\n    <circle class=\"Dot Dot-02\" fill=\"#9DE0AD\" cx=\"183\" cy=\"32\" r=\"8\"></circle>\\n  </g>\\n</svg>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"176\" height=\"64\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n  <g fill=\"#9DE0AD\">\\n    <polygon fill=\"none\" class=\"Group-line\" stroke=\"#9EE0AD\" points=\"88.4493047 0.0859375 175.58896 0.0859375 175.58896 23.2574383 135.581141 32.7431641 135.581141 54.9504597 117.092373 54.9504597 101.982508 63.6816406 59.4503976 63.6816406 44.9366094 55.6914063 1 55.6914063 1 24.8914834 44.6201536 24.8914834 56.9346563 0\"></polygon>\\n    <circle class=\"Group-point Group-point01\" cx=\"60\" cy=\"60\" r=\"4\"></circle>\\n    <circle class=\"Group-point Group-point02\" cx=\"100\" cy=\"4\" r=\"4\"></circle>\\n    <circle class=\"Group-point Group-point03\" cx=\"132\" cy=\"52\" r=\"4\"></circle>\\n    <circle class=\"Group-point Group-point04\" cx=\"116\" cy=\"52\" r=\"4\"></circle>\\n    <circle class=\"Group-point Group-point05\" cx=\"116\" cy=\"36\" r=\"4\"></circle>\\n    <circle class=\"Group-point Group-point06\" cx=\"116\" cy=\"20\" r=\"4\"></circle>\\n    <circle class=\"Group-point Group-point07\" cx=\"172\" cy=\"20\" r=\"4\"></circle>\\n    <circle class=\"Group-point Group-point08\" cx=\"172\" cy=\"4\" r=\"4\"></circle>\\n    <circle class=\"Group-point Group-point09\" cx=\"44\" cy=\"28\" r=\"4\"></circle>\\n    <circle class=\"Group-point Group-point10\" cx=\"4\" cy=\"28\" r=\"4\"></circle>\\n    <circle class=\"Group-point Group-point11\" cx=\"4\" cy=\"52\" r=\"4\"></circle>\\n    <circle class=\"Group-point Group-point12\" cx=\"44\" cy=\"52\" r=\"4\"></circle>\\n    <circle class=\"Group-point Group-point13\" cx=\"100\" cy=\"60\" r=\"4\"></circle>\\n    <circle class=\"Group-point Group-point14\" cx=\"132\" cy=\"36\" r=\"4\"></circle>\\n    <circle class=\"Group-point Group-point15\" cx=\"60\" cy=\"4\" r=\"4\"></circle>\\n  </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"308px\" height=\"98px\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n  <g fill=\"#636D72\" fill-rule=\"evenodd\" transform=\"translate(55, 15)\">\\n    <circle class=\"intersect intersect-layer\" fill=\"#5A7E6D\" stroke=\"#9DE0AD\" cx=\"101\" cy=\"32\" r=\"32\"></circle>\\n    <circle class=\"intersect intersect-circle1\" cx=\"57\" cy=\"14\" r=\"4\"></circle>\\n    <circle class=\"intersect intersect-circle2\" cx=\"31\" cy=\"38\" r=\"4\"></circle>\\n    <circle class=\"intersect intersect-circle3\" cx=\"13\" cy=\"8\" r=\"4\"></circle>\\n    <circle class=\"intersect intersect-circle4\" cx=\"163\" cy=\"20\" r=\"4\"></circle>\\n    <circle class=\"intersect intersect-circle5\" cx=\"65\" cy=\"50\" r=\"4\"></circle>\\n    <circle class=\"intersect intersect-circle6\" cx=\"4\" cy=\"46\" r=\"4\"></circle>\\n    <circle class=\"intersect intersect-circle1Highlight\" cx=\"91\" cy=\"52\" r=\"4\"></circle>\\n    <circle class=\"intersect intersect-circle7\" cx=\"145\" cy=\"56\" r=\"4\"></circle>\\n    <circle class=\"intersect intersect-circle2Highlight\" cx=\"103\" cy=\"42\" r=\"4\"></circle>\\n    <circle class=\"intersect intersect-circle3Highlight\"  cx=\"73\" cy=\"24\" r=\"4\"></circle>\\n    <circle class=\"intersect intersect-circle4Highlight\" cx=\"129\" cy=\"27\" r=\"4\"></circle>\\n    <circle class=\"intersect intersect-circle8\" cx=\"182\" cy=\"26\" r=\"4\"></circle>\\n    <circle class=\"intersect intersect-circle5Highlight\" cx=\"95\" cy=\"20\" r=\"4\"></circle>\\n    <circle class=\"intersect intersect-circle9\" cx=\"135\" cy=\"4\" r=\"4\"></circle>\\n  </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"185px\" height=\"64px\" viewBox=\"512 388 185 64\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n  <g id=\"Group\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(513.000000, 389.000000)\">\\n    <polygon class=\"Path Path-01\" stroke=\"#FFFFFF\" points=\"7.92876627e-08 47 22.7004054 47 22.7004054 62.1132254 0 62.1132254\"></polygon>\\n    <polygon class=\"Path Path-03\" stroke=\"#FFFFFF\" points=\"160 24 182.700012 24 182.700012 38.9848139 160 38.9848139\"></polygon>\\n    <polygon class=\"Path Path-02\" stroke=\"#FFFFFF\" points=\"87.7216797 0.278320312 110.836973 0.278320312 110.836973 24.2279707 87.8211856 24.2279707\"></polygon>\\n    <polygon class=\"Path Path-03Green\" stroke=\"#9DE0AD\" points=\"128 24 182.862039 24 182.862039 55.6141883 128.202651 55.6141883\"></polygon>\\n    <polygon class=\"Path Path-01Green\" stroke=\"#9DE0AD\" points=\"0.0502868199 31 47.7467919 31 47.7467919 62.177811 0 62.177811\"></polygon>\\n    <polygon class=\"Path Path-02Green\" stroke=\"#9DE0AD\" points=\"63.9970703 0.033203125 110.710209 0.033203125 110.710209 62.0109574 63.8597689 62.0109574\"></polygon>\\n    <circle class=\"Dot Dot-01\" fill=\"#FFFFFF\" cx=\"7\" cy=\"55\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot-02\" fill=\"#FFFFFF\" cx=\"99\" cy=\"11\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot-03\"  fill=\"#FFFFFF\" cx=\"171\" cy=\"31\" r=\"4\"></circle>\\n  </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"306\" height=\"98\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n  <g transform=\"translate(50, 20)\">\\n    <circle class=\"Dot Dot--01 Dot--gray\" cx=\"4\" cy=\"46\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--02 Dot--gray\" cx=\"31\" cy=\"38\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--03 Dot--gray\" cx=\"13\" cy=\"8\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--04 Dot--green\" cx=\"57\" cy=\"14\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--05 Dot--green\" cx=\"65\" cy=\"50\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--06 Dot--green\" cx=\"91\" cy=\"52\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--07 Dot--green\" cx=\"103\" cy=\"42\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--08 Dot--green\" cx=\"73\" cy=\"24\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--09 Dot--green\" cx=\"95\" cy=\"20\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--10 Dot--darkGray\" cx=\"145\" cy=\"56\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--11 Dot--darkGray\" cx=\"129\" cy=\"27\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--12 Dot--darkGray\" cx=\"135\" cy=\"4\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--13 Dot--white\" cx=\"163\" cy=\"20\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot--14 Dot--white\" cx=\"182\" cy=\"26\" r=\"4\"></circle>\\n  </g>\\n</svg>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"306px\" height=\"98px\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n  <g id=\"Mod-Analysis\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\\n    <g fill=\"#9DE0AD\">\\n      <text x=\"8\" y=\"19\" class=\"Text Text-LH\" font-family=\"OpenSans, Open Sans\" font-size=\"10\" font-weight=\"normal\">\\n        '+\n((__t=( _t('components.modals.add-analysis.option-types.moran-cluster.low-high') ))==null?'':_.escape(__t))+\n'\\n      </text>\\n      <text x=\"227\" y=\"19\" class=\"Text Text-HH\" font-family=\"OpenSans, Open Sans\" font-size=\"10\" font-weight=\"normal\">\\n        '+\n((__t=( _t('components.modals.add-analysis.option-types.moran-cluster.high-high') ))==null?'':_.escape(__t))+\n'\\n      </text>\\n      <text x=\"233\" y=\"85\" class=\"Text Text-HL\" font-family=\"OpenSans, Open Sans\" font-size=\"10\" font-weight=\"normal\">\\n        '+\n((__t=( _t('components.modals.add-analysis.option-types.moran-cluster.high-low') ))==null?'':_.escape(__t))+\n'\\n      </text>\\n      <text x=\"10\" y=\"85\" class=\"Text Text-LL\" font-family=\"OpenSans, Open Sans\" font-size=\"10\" font-weight=\"normal\">\\n        '+\n((__t=( _t('components.modals.add-analysis.option-types.moran-cluster.low-low') ))==null?'':_.escape(__t))+\n'\\n      </text>\\n    </g>\\n    <g fill=\"#FFF\">\\n      <circle class=\"Dot Dot-04\" fill-opacity=\"0.4\" cx=\"106\" cy=\"57\" r=\"4\"></circle>\\n      <circle class=\"Dot Dot-04\" fill-opacity=\"0.4\" cx=\"137\" cy=\"66\" r=\"4\"></circle>\\n      <circle class=\"Dot Dot-04\" fill-opacity=\"0.4\" cx=\"79\" cy=\"62\" r=\"4\"></circle>\\n      <circle class=\"Dot Dot-06\" fill-opacity=\"0.6\" cx=\"193\" cy=\"70\" r=\"4\"></circle>\\n      <circle class=\"Dot Dot-06\" fill-opacity=\"0.6\" cx=\"175\" cy=\"58\" r=\"4\"></circle>\\n      <circle class=\"Dot Dot-08\" fill-opacity=\"0.8\" cx=\"129\" cy=\"30\" r=\"4\"></circle>\\n      <circle class=\"Dot Dot-08\" fill-opacity=\"0.8\" cx=\"145\" cy=\"40\" r=\"4\"></circle>\\n      <circle class=\"Dot Dot-1\" cx=\"231\" cy=\"36\" r=\"4\"></circle>\\n      <circle class=\"Dot Dot-1\" cx=\"197\" cy=\"40\" r=\"4\"></circle>\\n      <circle class=\"Dot Dot-1\" cx=\"250\" cy=\"38\" r=\"4\"></circle>\\n      <circle class=\"Dot Dot-1\" cx=\"167\" cy=\"36\" r=\"4\"></circle>\\n      <circle class=\"Dot Dot-1\" cx=\"203\" cy=\"20\" r=\"4\"></circle>\\n    </g>\\n    <g stroke=\"#9DE0AD\">\\n      <path d=\"M0,49 L304,49\" class=\"Line Line-horizontal\" stroke-dasharray=\"2,3\"></path>\\n      <path d=\"M152,0 L152,98\" class=\"Line Line-vertical\" stroke-dasharray=\"2,3\"></path>\\n    </g>\\n  </g>\\n</svg>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='  <svg width=\"306px\" height=\"98px\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n    <g transform=\"translate(87, 22)\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" stroke-linecap=\"square\">\\n      <path class=\"Arrow-04\" d=\"M98.5,45.5 L97.5,40.5\" stroke=\"#9CE0AC\"></path>\\n      <path class=\"Arrow-04\" d=\"M98.5,45.5 L92.5,46.5\" stroke=\"#9CE0AC\"></path>\\n      <path class=\"Line-04\" d=\"M75.5,34.5 L98.5,45.5\" stroke=\"#9DE0AD\"></path>\\n\\n      <path class=\"Line-03\" d=\"M0.5,44.5 L3.5,39.5\" stroke=\"#9CE0AC\"></path>\\n      <path class=\"Line-03\" d=\"M0.5,44.5 L5.5,47.5\" stroke=\"#9CE0AC\"></path>\\n      <path class=\"Line-03\" d=\"M0.5,44.5 L55.5,32.5\" stroke=\"#9DE0AD\"></path>\\n\\n      <g transform=\"translate(75.000000, 1.000000)\">\\n        <path class=\"Arrow-01\" d=\"M31.5,8.5 L32.5,2.5\" stroke=\"#95D6A6\"></path>\\n        <path class=\"Arrow-01\" d=\"M26.5,0.5 L32.5,2.5\" stroke=\"#95D6A6\"></path>\\n        <path class=\"Line-01\" d=\"M0.5,18.5 L32.5,2.5\" stroke=\"#9DE0AD\"></path>\\n      </g>\\n\\n      <g transform=\"translate(19.000000, 0.000000)\" stroke=\"#979797\">\\n        <path class=\"Arrow-02\" d=\"M36.5,19.5 L35.5,14.5\"></path>\\n        <path class=\"Arrow-02\" d=\"M36.5,19.5 L31.5,21.5\"></path>\\n        <path class=\"Line-02\" d=\"M0.5,0.5 L36.5,19.5\"></path>\\n      </g>\\n    </g>\\n  </g>\\n  <g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\\n    <g stroke=\"#636D72\">\\n      <path d=\"M0,49 L304,49\" class=\"Line Line-horizontal\" stroke-dasharray=\"2,3\"></path>\\n      <path d=\"M152,0 L152,98\" class=\"Line Line-vertical\" stroke-dasharray=\"2,3\"></path>\\n    </g>\\n  </g>\\n  <g transform=\"translate(72, 11)\">\\n    <circle class=\"Dot Dot--center\" cx=\"80\" cy=\"38\" r=\"4\" stroke=\"#9DE0AD\" fill=\"#2E3C43\"></circle>\\n    <circle class=\"Dot Dot-01\" fill=\"#9DE0AD\" cx=\"133\" cy=\"10\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot-02\" fill=\"#979EA1\" cx=\"24\" cy=\"4\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot-03\" fill=\"#9DE0AD\" cx=\"4\" cy=\"57\" r=\"4\"></circle>\\n    <circle class=\"Dot Dot-04\" fill=\"#9DE0AD\" cx=\"122\" cy=\"61\" r=\"4\"></circle>\\n  </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"306\" height=\"98\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n  <g transform=\"translate(30, 16)\" fill=\"#9DE0AD\">\\n    <circle class=\"Dot\" cx=\"42\" cy=\"29\" r=\"4\"></circle>\\n    <circle class=\"Dot--withFadeOut Dot-01\" cx=\"72\" cy=\"49\" r=\"4\"></circle>\\n    <circle class=\"Dot\" cx=\"52\" cy=\"54\" r=\"4\"></circle>\\n    <circle class=\"Dot--withFadeOut Dot-02\" cx=\"4\" cy=\"54\" r=\"4\"></circle>\\n    <circle class=\"Dot--withFadeOut Dot-03\" cx=\"28\" cy=\"14\" r=\"4\"></circle>\\n    <circle class=\"Dot\" cx=\"188\" cy=\"6\" r=\"4\"></circle>\\n    <circle class=\"Dot\" cx=\"196\" cy=\"46\" r=\"4\"></circle>\\n    <circle class=\"Dot--withFadeOut Dot-03\" cx=\"159\" cy=\"25\" r=\"4\"></circle>\\n    <circle class=\"Dot\" cx=\"228\" cy=\"26\" r=\"4\"></circle>\\n    <circle class=\"Dot\" cx=\"141\" cy=\"14\" r=\"4\"></circle>\\n    <circle class=\"Dot--withFadeOut Dot-04\" cx=\"121\" cy=\"4\" r=\"4\"></circle>\\n    <circle class=\"Dot\" cx=\"101\" cy=\"54\" r=\"4\"></circle>\\n    <circle class=\"Dot\" cx=\"182\" cy=\"29\" r=\"4\"></circle>\\n    <circle class=\"Dot--withFadeOut Dot-05\" cx=\"131\" cy=\"60\" r=\"4\"></circle>\\n    <circle class=\"Dot\" cx=\"82\" cy=\"19\" r=\"4\"></circle>\\n    <circle class=\"Dot\" cx=\"150\" cy=\"47\" r=\"4\"></circle>\\n    <circle class=\"Dot--withFadeOut Dot-06\" cx=\"62\" cy=\"9\" r=\"4\"></circle>\\n    <circle class=\"Dot\" cx=\"109\" cy=\"32\" r=\"4\"></circle>\\n  </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+=''+\n((__t=( label ))==null?'':_.escape(__t))+\n'\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Modal-navigation\">\\n  <ul class=\"Modal-navigationInner CDB-Text is-semibold CDB-Size-medium js-menu\"></ul>\\n</div>\\n<div class=\"Modal-inner Modal-inner--with-navigation js-content\">\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar XYZModel = require('./xyz/xyz-model');\nvar mosaicThumbnail = require('../../mosaic/mosaic-thumbnail.tpl');\nvar MapboxModel = require('./mapbox/mapbox-model');\nvar WMSModel = require('./wms/wms-model');\nvar TileJSONModel = require('./tilejson/tilejson-model');\nvar NASAModel = require('./nasa/nasa-model');\n\n/**\n * Add basemap model\n */\nmodule.exports = Backbone.Model.extend({\n  defaults: {\n    tabs: undefined,\n    contentPane: 'tabs', // [tabs, loading, error]\n    currentTab: 'xyz' // [xyz, wms, nasa, mapbox, tilejson, nasa]\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.layerDefinitionsCollection) throw new Error('layerDefinitionsCollection is required');\n    if (!opts.basemapsCollection) throw new Error('basemapsCollection is required');\n    if (!opts.customBaselayersCollection) throw new Error('customBaselayersCollection is required');\n\n    this._layerDefinitionsCollection = opts.layerDefinitionsCollection;\n    this._basemapsCollection = opts.basemapsCollection;\n    this._customBaselayersCollection = opts.customBaselayersCollection;\n    this._currentTab = opts.currentTab;\n\n    this._initTabs();\n    this._initBinds();\n  },\n\n  activeTabModel: function () {\n    return this.get('tabs').findWhere({ name: this.get('currentTab') });\n  },\n\n  canSaveBasemap: function () {\n    return this.get('contentPane') === 'tabs' && this._layerToSave();\n  },\n\n  saveBasemap: function () {\n    var self = this;\n\n    this.set('contentPane', 'addingBasemap');\n\n    var customBaselayerModel = this._layerToSave();\n    var attrs = customBaselayerModel.getAttributes();\n\n    if (this.activeTabModel().hasAlreadyAddedLayer(this._customBaselayersCollection)) {\n      // update selected in basemaps collection\n      this._basemapsCollection.updateSelected(attrs.className);\n      // update category if needed in basemaps collection,\n      // this is the case for mapbox basemaps which were stored without category in the editor\n      this._basemapsCollection.updateCategory(attrs.className, attrs.category);\n\n      // update baselayer\n      this._onBasemapSaved(attrs);\n    } else {\n      // Add to customBaselayersCollection before saving, so save URL resolves to the expected endpoint\n      this._customBaselayersCollection.add(customBaselayerModel);\n\n      customBaselayerModel.save({}, {\n        success: function (mdl, mdlAttrs) {\n          var options = mdlAttrs.options;\n\n          var name = options.name ? options.name : 'Custom basemap ' + mdlAttrs.order;\n          var className = options.className;\n          var urlTemplate = options.urlTemplate;\n\n          // add in basemaps collection\n          self._basemapsCollection.add({\n            id: mdlAttrs.id,\n            urlTemplate: urlTemplate,\n            maxZoom: options.minZoom || 21,\n            minZoom: options.minZoom || 0,\n            name: name,\n            className: className,\n            attribution: options.attribution,\n            category: options.category,\n            tms: options.tms,\n            type: options.type,\n            val: className,\n            label: name,\n            template: function (imgURL) {\n              return mosaicThumbnail({\n                imgURL: imgURL\n              });\n            }\n          });\n\n          // update baselayer\n          self._onBasemapSaved(attrs);\n        },\n        error: function () {\n          // Cleanup, remove layer it could not be saved!\n          self._customBaselayersCollection.remove(customBaselayerModel);\n          self.set('contentPane', 'addBasemapFailed');\n        }\n      });\n    }\n  },\n\n  _onBasemapSaved: function (layerAttrs) {\n    // Update baseLayer\n    this._layerDefinitionsCollection.setBaseLayer(layerAttrs);\n\n    this.trigger('saveBasemapDone');\n  },\n\n  _initTabs: function () {\n    var tabs = new Backbone.Collection([\n      new XYZModel(),\n      new MapboxModel(),\n      new WMSModel(null, {\n        customBaselayersCollection: this._customBaselayersCollection\n      }),\n      new TileJSONModel(),\n      new NASAModel()\n    ]);\n    this.set({\n      tabs: tabs,\n      currentTab: this._currentTab || tabs.first().get('name')\n    });\n  },\n\n  _initBinds: function () {\n    this.get('tabs').each(function (tabModel) {\n      tabModel.bind('saveBasemap', this.saveBasemap, this);\n    }, this);\n  },\n\n  _layerToSave: function () {\n    return this.activeTabModel().get('layer');\n  }\n\n});\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./add-basemap.tpl');\nvar TabPaneView = require('../../tab-pane/tab-pane-view');\nvar TabPaneCollection = require('../../tab-pane/tab-pane-collection');\nvar ViewFactory = require('../../view-factory');\nvar renderLoading = require('../../loading/render-loading');\nvar ErrorView = require('../../error/error-view');\nvar _ = require('underscore');\nvar TabsView = require('./tabs-view');\n\n/**\n * Add basemap dialog\n */\nmodule.exports = CoreView.extend({\n\n  className: 'Dialog-content Dialog-content--expanded',\n\n  events: {\n    'click .js-ok': 'ok'\n  },\n\n  initialize: function (opts) {\n    if (!opts.modalModel) throw new TypeError('modalModel is required');\n    if (!opts.createModel) throw new TypeError('createModel is required');\n\n    this._modalModel = opts.modalModel;\n    this._createModel = opts.createModel;\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template());\n    this._initViews();\n  },\n\n  _initBinds: function () {\n    this._createModel.bind('saveBasemapDone', this._modalModel.destroy.bind(this._modalModel), this);\n    this._createModel.bind('change:contentPane', this._onChangeContentView, this);\n    this.add_related_model(this._createModel);\n  },\n\n  _onChangeContentView: function () {\n    var context = this._createModel.get('contentPane');\n    var paneModel = _.first(this._tabPaneCollection.where({ name: context }));\n    paneModel.set('selected', true);\n  },\n\n  _initViews: function () {\n    var self = this;\n\n    this._submitButtom = this.$('.js-ok');\n    this._modalFooter = this.$('.js-Modal-footer');\n\n    this._tabPaneCollection = new TabPaneCollection([\n      {\n        name: 'tabs',\n        selected: this._createModel.get('contentPane') === 'tabs',\n        createContentView: function () {\n          return new TabsView({\n            model: self._createModel,\n            submitButton: self._submitButtom,\n            modalFooter: self._modalFooter\n          });\n        }\n      }, {\n        name: 'addingBasemap',\n        selected: this._createModel.get('contentPane') === 'addingBasemap',\n        createContentView: function () {\n          self._disableModalFooter(true);\n\n          return ViewFactory.createByHTML(\n            renderLoading({\n              title: _t('components.modals.add-basemap.adding-basemap')\n            })\n          );\n        }\n      }, {\n        name: 'addBasemapFailed',\n        selected: this._createModel.get('contentPane') === 'addBasemapFailed',\n        createContentView: function () {\n          return new ErrorView({\n            title: _t('components.modals.add-basemap.add-basemap-error')\n          });\n        }\n      }\n    ]);\n\n    var tabPaneView = new TabPaneView({\n      collection: this._tabPaneCollection\n    });\n    this.addView(tabPaneView);\n    this.$('.js-content-container').append(tabPaneView.render().el);\n  },\n\n  _disableModalFooter: function (disable) {\n    this._modalFooter.toggleClass('is-disabled', disable);\n  },\n\n  ok: function () {\n    if (this._createModel.canSaveBasemap()) {\n      this._createModel.saveBasemap();\n    }\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Modal\">\\n  <div class=\"Modal-header\">\\n    <div class=\"Modal-headerContainer\">\\n      <h2 class=\"CDB-Text CDB-Size-huge is-light u-mainTextColor u-bSpace\">'+\n((__t=( _t('components.modals.add-basemap.modal-title') ))==null?'':_.escape(__t))+\n'</h2>\\n      <h3 class=\"CDB-Text CDB-Size-medium u-altTextColor\">'+\n((__t=( _t('components.modals.add-basemap.modal-desc') ))==null?'':_.escape(__t))+\n'</h3>\\n    </div>\\n  </div>\\n  <div class=\"Modal-container\">\\n    <div class=\"Tab-pane js-content-container\">\\n    </div>\\n  </div>\\n  <div class=\"Modal-footer js-Modal-footer\">\\n    <div class=\"Modal-footerContainer u-flex u-justifyEnd\">\\n      <button class=\"CDB-Button CDB-Button--primary is-disabled js-ok ok\">\\n        <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">'+\n((__t=( _t('components.modals.add-basemap.add-btn') ))==null?'':_.escape(__t))+\n'</span>\\n      </button>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-alignCenter Modal-basemapContainer\">\\n  <h3 class=\"CDB-Text CDB-Size-large u-mainTextColor Modal-titleBasemap\">'+\n((__t=( _t('components.modals.add-basemap.mapbox.insert') ))==null?'':_.escape(__t))+\n'</h3>\\n  <div class=\"CDB-Text u-flex u-alignCenter \">\\n    <label class=\"Metadata-label Metadata-label--big CDB-Text CDB-Size-small is-semibold u-upperCase u-ellipsis\">'+\n((__t=( _t('components.modals.add-basemap.mapbox.enter') ))==null?'':_.escape(__t))+\n'</label>\\n    <div class=\"Form-rowData Form-rowData--longer\">\\n      <input type=\"text\" class=\"CDB-InputText CDB-Text js-url\" value=\"'+\n((__t=( url ))==null?'':_.escape(__t))+\n'\" placeholder=\"'+\n((__t=( _t('components.modals.add-basemap.xyz.eg') ))==null?'':_.escape(__t))+\n' username.ab12cd3\">\\n    </div>\\n  </div>\\n  <div class=\"u-tSpace-xl CDB-Text u-flex u-alignCenter\">\\n    <label class=\"Metadata-label Metadata-label--big CDB-Text CDB-Size-small is-semibold u-upperCase u-ellipsis\">'+\n((__t=( _t('components.modals.add-basemap.mapbox.enter-token') ))==null?'':_.escape(__t))+\n'</label>\\n    <div class=\"Form-rowData Form-rowData--longer\">\\n      <input type=\"text\" class=\"CDB-InputText CDB-Text js-access-token\" value=\"'+\n((__t=( accessToken ))==null?'':_.escape(__t))+\n'\" placeholder=\"'+\n((__t=( _t('components.modals.add-basemap.xyz.eg') ))==null?'':_.escape(__t))+\n' pk.bfg32ewdsadeyJ1Ijoi\">\\n      <div class=\"XYZPanel-error CDB-InfoTooltip CDB-InfoTooltip--left is-error CDB-Text CDB-Size-medium CDB-InfoTooltip-text js-error '+\n((__t=( lastErrorMsg ? 'is-visible' : '' ))==null?'':_.escape(__t))+\n'\">'+\n((__t=( lastErrorMsg ))==null?'':_.escape(__t))+\n'</div>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar MapboxView = require('./mapbox-view');\nvar MapboxToTileLayerFactory = require('./mapbox-to-tile-layer-factory');\n\n/**\n * View model for Mapbox tab content.\n */\n\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    name: 'mapbox',\n    label: 'Mapbox',\n    currentView: 'enterURL', //, validatingInputs, valid\n    lastErrorMsg: '', // set if fails to save\n    layer: undefined // will be set when valid\n  },\n\n  createView: function (opts) {\n    if (!opts.submitButton) throw new Error('submitButton is required');\n    if (!opts.modalFooter) throw new Error('modalFooter is required');\n\n    this._submitButton = opts.submitButton;\n    this._modalFooter = opts.modalFooter;\n\n    this.set({\n      currentView: 'enterURL',\n      layer: undefined\n    });\n\n    return new MapboxView({\n      model: this,\n      submitButton: this._submitButton,\n      modalFooter: this._modalFooter\n    });\n  },\n\n  hasAlreadyAddedLayer: function (userLayers) {\n    var urlTemplate = this.get('layer').get('urlTemplate');\n    return _.any(userLayers.isCustomCategory(), function (customLayer) {\n      return customLayer.get('urlTemplate') === urlTemplate;\n    });\n  },\n\n  validateInputs: function (url, accessToken) {\n    this.set({\n      currentView: 'validatingInputs',\n      url: url,\n      accessToken: accessToken\n    });\n\n    var self = this;\n\n    var mf = new MapboxToTileLayerFactory({\n      url: url,\n      accessToken: accessToken\n    });\n    mf.createTileLayer({\n      success: function (tileLayer) {\n        self.set('layer', tileLayer);\n        self.trigger('saveBasemap');\n      },\n      error: function (errorMsg) {\n        self.set({\n          currentView: 'enterURL',\n          lastErrorMsg: errorMsg\n        });\n      }\n    });\n  }\n\n});\n",
    "/* global Image, location */\n\nvar $ = require('jquery');\nvar _ = require('underscore');\nvar Backbone = require('backbone');\nvar CustomBaselayerModel = require('../../../../data/custom-baselayer-model');\n\n/**\n * Factory to create a CustomBaselayerModel from a given URL and access token tuple for Mapbox.\n */\n\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    url: '',\n    accessToken: ''\n  },\n\n  _MAPBOX: {\n    version: 4,\n    https: 'https://dnv9my2eseobd.cloudfront.net',\n    base: 'https://a.tiles.mapbox.com/'\n  },\n\n  /**\n   * @param {Object} callbacks\n   *   success {Function} given a new TileLayer object\n   *   error {Function} given an error explanation\n   */\n  createTileLayer: function (callbacks) {\n    var val = this.get('url');\n    var url = this._lowerXYZ(val);\n    var access_token = this.get('accessToken');\n    var type = 'json';\n    var subdomains = ['a', 'b', 'c'];\n    var mapbox_id;\n\n    // Detects the URL's type\n    if (url.indexOf('{x}') < 0 && url.indexOf('tiles.mapbox.com') !== -1) {\n      mapbox_id = this._getMapBoxMapID(url);\n      if (mapbox_id) {\n        type = 'mapbox_id';\n        url = mapbox_id;\n      }\n    } else if (url.indexOf('{x}') !== -1) {\n      type = 'xyz';\n      url = url.replace(/\\{s\\}/g, function () {\n        return subdomains[Math.floor(Math.random() * 3)];\n      })\n        .replace(/\\{x\\}/g, '0')\n        .replace(/\\{y\\}/g, '0')\n        .replace(/\\{z\\}/g, '0');\n    } else if (url && url.indexOf('http') < 0 && url.match(/(.*?)\\.(.*)/) != null && url.match(/(.*?)\\.(.*)/).length === 3) {\n      type = 'mapbox_id';\n      mapbox_id = val;\n    } else { // If not, check https\n      url = this._fixHTTPS(url);\n    }\n\n    var self = this;\n    var image;\n    if (type === 'mapbox') {\n      callbacks.success(this._newTileLayer({ tiles: [url] }));\n    } else if (type === 'xyz') {\n      image = new Image();\n      image.onload = function () {\n        callbacks.success(self._newTileLayer({\n          tiles: [self._lowerXYZ(val)]\n        }));\n      };\n      image.onerror = function () {\n        callbacks.error(self._errorToMsg());\n      };\n      image.src = url;\n    } else if (type === 'mapbox_id') {\n      var params = '?access_token=' + access_token;\n      var base_url = this._MAPBOX.base + 'v' + this._MAPBOX.version + '/' + mapbox_id;\n      var tile_url = base_url + '/{z}/{x}/{y}.png' + params;\n      var json_url = base_url + '.json' + params;\n\n      // JQuery has a faulty implementation of the getJSON method and doesn't return\n      // a 404, so we use a timeout. TODO: replace with CORS\n      var errorTimeout = setTimeout(function () {\n        callbacks.error(self._errorToMsg());\n      }, 5000);\n\n      $.ajax({\n        url: json_url,\n        success: function (data) {\n          clearTimeout(errorTimeout);\n          callbacks.success(self._newTileLayer({\n            tiles: [tile_url],\n            attribution: data.attribution,\n            minzoom: data.minzoom,\n            maxzoom: data.maxzoom,\n            name: data.name\n          }));\n        },\n        error: function (e) {\n          clearTimeout(errorTimeout);\n          callbacks.error(self._errorToMsg(e));\n        }\n      });\n    } else {\n      callbacks.error(this._errorToMsg());\n    }\n  },\n\n  _newTileLayer: function (data) {\n    // Check if the respond is an array\n    // In that case, get only the first\n    if (_.isArray(data) && _.size(data) > 0) {\n      data = _.first(data);\n    }\n\n    var url = data.tiles[0];\n    var attribution = data.attribution || null;\n\n    var layer = new CustomBaselayerModel({\n      urlTemplate: url,\n      attribution: attribution,\n      maxZoom: data.maxzoom || 21,\n      minZoom: data.minzoom || 0,\n      name: data.name || '',\n      category: 'Mapbox',\n      type: 'Tiled'\n    });\n    layer.set('className', layer._generateClassName(url));\n\n    return layer;\n  },\n\n  _errorToMsg: function (error) {\n    if (typeof error === 'object' || !error) {\n      if (error && error.status && error.status === 401) {\n        return _t('components.modals.add-basemap.mapbox.error');\n      } else {\n        return _t('components.modals.add-basemap.mapbox.invalid');\n      }\n    }\n\n    return error;\n  },\n\n  _lowerXYZ: function (url) {\n    return url.replace(/\\{S\\}/g, '{s}')\n      .replace(/\\{X\\}/g, '{x}')\n      .replace(/\\{Y\\}/g, '{y}')\n      .replace(/\\{Z\\}/g, '{z}');\n  },\n\n  // Extracts the Mapbox MapId from a Mapbox URL\n  _getMapBoxMapID: function (url) {\n    // http://d.tiles.mapbox.com/v3/{user}.{map}/3/4/3.png\n    // http://a.tiles.mapbox.com/v3/{user}.{map}/page.html\n    // http://a.tiles.mapbox.com/v4/{user}.{map}.*\n    var reg1 = /https?:\\/\\/[a-z]?\\.?tiles\\.mapbox.com\\/v(\\d)\\/([^\\/.]*)\\.([^\\/.]*)/;\n\n    // https://tiles.mapbox.com/{user}/edit/{map}?newmap&preset=Streets#3/0.00/-0.09\n    var reg2 = /https?:\\/\\/tiles\\.mapbox\\.com\\/(.*?)\\/edit\\/(.*?)(\\?|#)/;\n\n    var match = '';\n\n    // Check first expresion\n    match = url.match(reg1);\n\n    if (match && match[1] && match[2]) {\n      return match[2] + '.' + match[3];\n    }\n\n    // Check second expresion\n    match = url.match(reg2);\n\n    if (match && match[1] && match[2]) {\n      return match[1] + '.' + match[2];\n    }\n  },\n\n  /**\n   * return a https url if the current application is loaded from https\n   */\n  _fixHTTPS: function (url, loc) {\n    loc = loc || location;\n\n    // fix the url to https or http\n    if (url.indexOf('https') !== 0 && loc.protocol === 'https:') {\n      // search for mapping\n      var i = url.indexOf('mapbox.com');\n      if (i !== -1) {\n        return this._MAPBOX.https + url.substr(i + 'mapbox.com'.length);\n      }\n      return url.replace(/http/, 'https');\n    }\n    return url;\n  }\n\n});\n",
    "var CoreView = require('backbone/core-view');\nvar ViewFactory = require('../../../view-factory');\nvar renderLoading = require('../../../loading/render-loading');\nvar enterUrl = require('./enter-url.tpl');\n\n/**\n * Represents the Mapbox tab content.\n */\n\nmodule.exports = CoreView.extend({\n\n  events: {\n    'keydown': '_onKeyDown',\n    'keyup': '_onKeyUp'\n  },\n\n  initialize: function (opts) {\n    if (!opts.submitButton) throw new Error('submitButton is required');\n    if (!opts.modalFooter) throw new Error('modalFooter is required');\n\n    this._submitButton = opts.submitButton;\n    this._modalFooter = opts.modalFooter;\n    this._onClickBinded = this._onClickOK.bind(this);\n\n    this._bindSubmitButton();\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    var view;\n\n    switch (this.model.get('currentView')) {\n      case 'validatingInputs':\n        this._disableModalFooter(true);\n\n        view = ViewFactory.createByHTML(\n          renderLoading({\n            title: _t('components.modals.add-basemap.validating')\n          })\n        );\n        break;\n      case 'enterURL':\n      default:\n        this._disableModalFooter(false);\n\n        view = ViewFactory.createByHTML(\n          enterUrl({\n            url: this.model.get('url'),\n            accessToken: this.model.get('accessToken'),\n            lastErrorMsg: this.model.get('lastErrorMsg')\n          })\n        );\n    }\n    this.addView(view);\n    this.$el.append(view.render().el);\n\n    this._updateOkBtn();\n    this._onKeyUp();\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.bind('change', this.render, this);\n  },\n\n  _hasValues: function () {\n    return this._urlVal() && this._accessToken();\n  },\n\n  _urlVal: function () {\n    return this.$('.js-url').val();\n  },\n\n  _accessToken: function () {\n    return this.$('.js-access-token').val();\n  },\n\n  _onClickOK: function (e) {\n    this.killEvent(e);\n\n    if (this._hasValues()) {\n      var url = this._urlVal();\n      var accessToken = this._accessToken();\n\n      this.model.validateInputs(url, accessToken);\n    }\n  },\n\n  _disableModalFooter: function (disable) {\n    this._modalFooter.toggleClass('is-disabled', disable);\n  },\n\n  _updateOkBtn: function () {\n    this._submitButton.find('span').text(_t('components.modals.add-basemap.add-btn'));\n  },\n\n  _onKeyDown: function (e) {\n    e.stopPropagation();\n\n    this.$('.js-error').removeClass('is-visible');\n  },\n\n  _onKeyUp: function (e) {\n    e && e.stopPropagation();\n    this._submitButton.toggleClass('is-disabled', !this._hasValues());\n  },\n\n  _bindSubmitButton: function () {\n    this._submitButton.on('click', this._onClickBinded);\n  },\n\n  _unBindSubmitButton: function () {\n    this._submitButton.off('click', this._onClickBinded);\n  },\n\n  clean: function () {\n    this._unBindSubmitButton();\n    CoreView.prototype.clean.call(this);\n  }\n\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar moment = require('moment');\nvar NASAView = require('./nasa-view');\nvar CustomBaselayerModel = require('../../../../data/custom-baselayer-model');\n\nvar TYPES = {\n  day: {\n    url: 'http://map1.vis.earthdata.nasa.gov/wmts-webmerc/MODIS_Terra_CorrectedReflectance_TrueColor/default/<%- date %>/GoogleMapsCompatible_Level9/{z}/{y}/{x}.jpeg',\n    limit: '2012-05-01',\n    default: '2012-05-01',\n    attribution: '<a href=\"http://earthdata.nasa.gov/gibs\" target=\"_blank\">NASA EOSDIS GIBS</a>',\n    name: 'NASA Terra',\n    maxZoom: 9,\n    minZoom: 1\n  },\n  night: {\n    url: 'http://map1.vis.earthdata.nasa.gov/wmts-webmerc/VIIRS_CityLights_2012/default/<%- date %>/GoogleMapsCompatible_Level8/{z}/{y}/{x}.jpeg',\n    limit: '2012-05-01',\n    default: '2012-05-02',\n    attribution: '<a href=\"http://earthdata.nasa.gov/gibs\" target=\"_blank\">NASA EOSDIS GIBS</a>',\n    name: 'NASA Earth at night',\n    maxZoom: 8,\n    minZoom: 1\n  }\n};\n\n/**\n * View model for NASA tab content.\n */\n\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    name: 'nasa',\n    label: 'NASA',\n    layer: undefined, // gets set on dayOrNight/date changes\n    layerType: 'day',\n    date: undefined, // for date picker\n    current: undefined,\n    format: 'Y-m-d' // YYYY-MM-DD\n  },\n\n  initialize: function () {\n    this._initBinds();\n  },\n\n  createView: function (opts) {\n    if (!opts.submitButton) throw new Error('submitButton is required');\n\n    this._submitButton = opts.submitButton;\n\n    var utc = new Date().getTimezoneOffset();\n    var today = moment(new Date()).utcOffset(utc).format('YYYY-MM-DD');\n    var yesterday = moment(new Date()).utcOffset(utc).subtract(1, 'days').format('YYYY-MM-DD');\n\n    this.set({\n      current: today,\n      date: yesterday\n    });\n\n    return new NASAView({\n      model: this,\n      submitButton: this._submitButton\n    });\n  },\n\n  hasAlreadyAddedLayer: function (userLayers) {\n    var urlTemplate = this.get('layer').get('urlTemplate');\n    return _.any(userLayers.isCustomCategory(), function (customLayer) {\n      return customLayer.get('urlTemplate') === urlTemplate;\n    });\n  },\n\n  _initBinds: function () {\n    this.bind('change:date change:layerType', this._onChange, this);\n  },\n\n  _onChange: function () {\n    var dateStr = this.get('date');\n    var layerType = this.get('layerType');\n\n    var url = _.template(TYPES[layerType].url)({\n      date: dateStr\n    });\n\n    var name = TYPES[layerType].name;\n\n    if (layerType === 'day') {\n      name = name + ' ' + dateStr;\n    }\n\n    var layer = new CustomBaselayerModel({\n      urlTemplate: url,\n      attribution: TYPES[layerType].attribution,\n      maxZoom: TYPES[layerType].maxZoom,\n      minZoom: TYPES[layerType].minZoom,\n      name: name,\n      category: 'NASA',\n      type: 'Tiled'\n    });\n    layer.set('className', layer._generateClassName(url));\n\n    this.set('layer', layer);\n  }\n\n});\n",
    "var $ = require('jquery');\nvar moment = require('moment');\nvar CoreView = require('backbone/core-view');\nvar DatePickerView = require('../../../../components/date-picker/date-picker-view');\nvar EditFieldModel = require('../../../../components/date-picker/edit-field-model');\nvar TipsyTooltipView = require('../../../../components/tipsy-tooltip-view');\nvar template = require('./nasa.tpl');\n\n/**\n * Represents the NASA tab content\n */\n\nmodule.exports = CoreView.extend({\n\n  options: {\n    dateFormat: 'YYYY-MM-DD'\n  },\n\n  events: {\n    'click .js-day': '_onChangeToDay',\n    'click .js-night': '_onChangeToNight'\n  },\n\n  initialize: function (opts) {\n    if (!opts.submitButton) throw new Error('submitButton is required');\n\n    this._submitButton = opts.submitButton;\n    this.dateModel = new EditFieldModel({\n      value: this.model.get('date'),\n      type: 'date'\n    });\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    this._updateOkBtn();\n    this._disableOkBtn(false);\n\n    this.$el.html(\n      template({\n        layerType: this.model.get('layerType')\n      })\n    );\n\n    this._renderDatePicker();\n\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:layerType', function () {\n      this.dateModel.set('readOnly', this.model.get('layerType') === 'night');\n      this.render();\n    }, this);\n    this.dateModel.bind('change:value', function () {\n      var date = moment(this.dateModel.get('value')).format(this.options.dateFormat);\n      this.model.set('date', date);\n    }, this);\n    this.add_related_model(this.dateModel);\n  },\n\n  _renderDatePicker: function () {\n    // Date picker\n    var datepicker = this.datepicker = new DatePickerView({\n      className: 'DatePicker DatePicker--withBorder',\n      model: this.dateModel\n    });\n    this._$datePicker().html(datepicker.render().el);\n    this.addView(datepicker);\n\n    // Disabled tooltip\n    if (this.dateModel.get('readOnly')) {\n      var tooltip = new TipsyTooltipView({\n        el: this._$datePicker(),\n        title: function (e) {\n          return $(this).attr('data-title');\n        }\n      });\n      this.addView(tooltip);\n    }\n  },\n\n  _onChangeToNight: function () {\n    this.model.set('layerType', 'night');\n  },\n\n  _onChangeToDay: function () {\n    this.model.set('layerType', 'day');\n  },\n\n  _$datePicker: function () {\n    return this.$('.js-datePicker');\n  },\n\n  _updateOkBtn: function () {\n    this._submitButton.find('span').text(_t('components.modals.add-basemap.add-btn'));\n  },\n\n  _disableOkBtn: function (disable) {\n    this._submitButton.toggleClass('is-disabled', disable);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-alignCenter Modal-basemapContainer\">\\n  <h3 class=\"CDB-Text CDB-Size-large u-mainTextColor Modal-titleBasemap\">'+\n((__t=( _t('components.modals.add-basemap.nasa.select') ))==null?'':_.escape(__t))+\n'</h3>\\n  <div class=\"CDB-Text u-flex u-alignCenter\">\\n    <div class=\"Form-rowData Form-rowData--short Form-rowData--alignLeft\">\\n      <div class=\"Form-rowData Form-rowData--full\">\\n        <div class=\"RadioButton js-day\">\\n          <button type=\"button\" class=\"RadioButton-input ';\n if (layerType === 'day') { \n__p+='is-checked';\n } \n__p+='\"></button>\\n          <label class=\"Metadata-label Metadata-label--auto CDB-Text CDB-Size-small is-semibold u-upperCase u-ellipsis\" for=\"nasa-type-day\">'+\n((__t=( _t('components.modals.add-basemap.nasa.day') ))==null?'':_.escape(__t))+\n'</label>\\n        </div>\\n      </div>\\n      <div class=\"Form-rowData Form-rowData--full\">\\n        <div class=\"RadioButton js-night\">\\n          <button type=\"button\" class=\"RadioButton-input ';\n if (layerType === 'night') { \n__p+='is-checked';\n } \n__p+='\"/></button>\\n          <label class=\"Metadata-label Metadata-label--auto CDB-Text CDB-Size-small is-semibold u-upperCase u-ellipsis\" for=\"nasa-type-night\">'+\n((__t=( _t('components.modals.add-basemap.nasa.night') ))==null?'':_.escape(__t))+\n'</label>\\n        </div>\\n      </div>\\n    </div>\\n    <div class=\"Form-rowData Form-rowData--short\">\\n      <div class=\"js-datePicker\" data-title=\"'+\n((__t=( _t('components.modals.add-basemap.nasa.cant-select') ))==null?'':_.escape(__t))+\n'\"></div>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar ScrollView = require('../../scroll/scroll-view');\nvar $ = require('jquery');\nvar template = require('./tabs.tpl');\n\n/**\n * View representing the tabs content of the dialog.\n */\nmodule.exports = CoreView.extend({\n\n  events: {\n    'click .js-tabs button': '_onClickTab'\n  },\n\n  attributes: function () {\n    return {\n      class: 'Modal-outer'\n    };\n  },\n\n  initialize: function (opts) {\n    if (!opts.submitButton) throw new Error('submitButton is required');\n    if (!opts.modalFooter) throw new Error('modalFooter is required');\n\n    this._submitButton = opts.submitButton;\n    this._modalFooter = opts.modalFooter;\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    this.$el.html(template({\n      model: this.model\n    }));\n\n    this._initViews();\n\n    return this;\n  },\n\n  _initViews: function () {\n    var scrollView = new ScrollView({\n      className: 'ScrollView ScrollView--withoutMargins',\n      createContentView: function () {\n        return this._createTabContentView();\n      }.bind(this)\n    });\n\n    this.addView(scrollView);\n    this.$('.js-tab-content').append(scrollView.render().el);\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:currentTab', this.render, this);\n  },\n\n  _createTabContentView: function () {\n    if (this._currentTabView) {\n      this._currentTabView.clean();\n    }\n    this._currentTabView = this.model.activeTabModel().createView({\n      submitButton: this._submitButton,\n      modalFooter: this._modalFooter\n    });\n    this.addView(this._currentTabView);\n    return this._currentTabView.render();\n  },\n\n  _onClickTab: function (e) {\n    this.killEvent(e);\n    var name = $(e.target).closest('button').data('name');\n    if (name) {\n      this.model.set('currentTab', name);\n    } else {\n      throw new Error('tab name was expected but was empty');\n    }\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Modal-navigation\">\\n  <ul class=\"Modal-navigationInner CDB-Text is-semibold CDB-Size-medium js-tabs\">\\n    ';\n model.get('tabs').each(function(tab) { \n__p+='\\n      <li class=\"CDB-NavMenu-item '+\n((__t=( model.get('currentTab') === tab.get('name') ? 'is-selected' : '' ))==null?'':_.escape(__t))+\n'\">\\n        <button data-name=\"'+\n((__t=( tab.get('name') ))==null?'':_.escape(__t))+\n'\" class=\"CDB-NavMenu-link u-upperCase\">\\n          '+\n((__t=( tab.get('label') ))==null?'':_.escape(__t))+\n'\\n        </button>\\n      </li>\\n    ';\n }) \n__p+='\\n  </ul>\\n</div>\\n<div class=\"Modal-inner Modal-inner--with-navigation js-tab-content\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-alignCenter Modal-basemapContainer\">\\n  <h3 class=\"CDB-Text CDB-Size-large u-mainTextColor Modal-titleBasemap\">'+\n((__t=( _t('components.modals.add-basemap.tilejson.insert') ))==null?'':_.escape(__t))+\n'</h3>\\n  <div class=\"CDB-Text u-flex u-alignCenter\">\\n    <label class=\"Metadata-label Metadata-label--auto  CDB-Text CDB-Size-small is-semibold u-upperCase u-ellipsis\">'+\n((__t=( _t('components.modals.add-basemap.xyz.enter') ))==null?'':_.escape(__t))+\n'</label>\\n    <div class=\"Form-rowData Form-rowData--longer\">\\n      <input type=\"text\" class=\"has-icon CDB-InputText CDB-Text js-url\" value=\"\" placeholder=\"'+\n((__t=( _t('components.modals.add-basemap.xyz.eg') ))==null?'':_.escape(__t))+\n' http://domain.com/tiles.json?foo=bar\">\\n      <i class=\"CDB-IconFont CDB-IconFont-dribbble Form-inputIcon js-idle\"></i>\\n      <i class=\"Spinner XYZPanel-inputIcon Spinner--formIcon Form-inputIcon js-validating\" style=\"display: none;\"></i>\\n      <div class=\"XYZPanel-error CDB-InfoTooltip CDB-InfoTooltip--left is-error CDB-Text CDB-Size-medium CDB-InfoTooltip-text js-error\"></div>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar CustomBaselayerModel = require('../../../../data/custom-baselayer-model');\n\n/**\n * Model to representing a TileJSON endpoint\n * See https://github.com/mapbox/tilejson-spec/tree/master/2.1.0 for details\n */\n\nmodule.exports = Backbone.Model.extend({\n\n  url: function () {\n    return this.get('tilejson_url');\n  },\n\n  newTileLayer: function () {\n    if (!this._isFetched()) throw new Error('no tiles, have fetch been called and returned a successful resultset?');\n\n    var url = this._urlTemplate();\n\n    var layer = new CustomBaselayerModel({\n      urlTemplate: url,\n      attribution: this.get('attribution'),\n      maxZoom: this.get('maxzoom'),\n      minZoom: this.get('minzoom'),\n      name: this._name(),\n      bounding_boxes: this.get('bounds'),\n      tms: this.get('scheme') === 'tms',\n      category: 'TileJSON',\n      type: 'Tiled'\n    });\n    layer.set('className', layer._generateClassName(url));\n\n    return layer;\n  },\n\n  setUrl: function (url) {\n    this.set('tilejson_url', url);\n  },\n\n  _isFetched: function () {\n    return this.get('tiles').length > 0;\n  },\n\n  _urlTemplate: function () {\n    return this.get('tiles')[0];\n  },\n\n  _name: function () {\n    return this.get('name') || this.get('description');\n  }\n\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar TileJSONView = require('./tilejson-view');\nvar TileJSONLayerModel = require('./tilejson-layer-model');\n\n/**\n * View model for TileJSON tab content.\n */\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    name: 'tilejson',\n    label: 'TileJSON',\n    layer: undefined // will be set when valid\n  },\n\n  createView: function (opts) {\n    if (!opts.submitButton) throw new Error('submitButton is required');\n\n    this._submitButton = opts.submitButton;\n\n    var tileJSONLayerModel = new TileJSONLayerModel();\n\n    return new TileJSONView({\n      model: this,\n      submitButton: this._submitButton,\n      tileJSONLayerModel: tileJSONLayerModel\n    });\n  },\n\n  hasAlreadyAddedLayer: function (userLayers) {\n    var urlTemplate = this.get('layer').get('urlTemplate');\n    return _.any(userLayers.isCustomCategory(), function (customLayer) {\n      return customLayer.get('urlTemplate') === urlTemplate;\n    });\n  }\n\n});\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar template = require('./enter-url.tpl');\n\n/**\n * Represents the TileJSON tab content.\n */\nmodule.exports = CoreView.extend({\n\n  events: {\n    'keydown .js-url': '_onKeydown',\n    'paste .js-url': '_onPaste'\n  },\n\n  initialize: function (opts) {\n    if (!opts.submitButton) throw new Error('submitButton is required');\n    if (!opts.tileJSONLayerModel) throw new Error('tileJSONLayerModel is required');\n\n    this._submitButton = opts.submitButton;\n    this._tileJSONLayerModel = opts.tileJSONLayerModel;\n    this._lastURL = '';\n    this._debouncedUpdate = _.debounce(this._update.bind(this), 150);\n  },\n\n  render: function () {\n    this._updateOkBtn();\n    this._disableOkBtn(true);\n\n    this.$el.html(\n      template()\n    );\n\n    return this;\n  },\n\n  _onKeydown: function (e) {\n    e.stopPropagation();\n    this._debouncedUpdate();\n  },\n\n  _onPaste: function (e) {\n    e.stopPropagation();\n    this._debouncedUpdate();\n  },\n\n  _update: function () {\n    var self = this;\n\n    this._disableOkBtn(true);\n    this._indicateIsValidating(true);\n\n    var url = this._urlWithHTTP();\n\n    if (url === this._lastURL) {\n      // Even if triggered nothing really changed so just update UI and return early\n      this._indicateIsValidating(false);\n      this._updateError();\n\n      return;\n    }\n\n    this._lastURL = url;\n\n    this._indicateIsValidating(true);\n\n    this._tileJSONLayerModel.setUrl(url);\n\n    this._tileJSONLayerModel.fetch({\n      success: function (mdl) {\n        if (url === self._lastURL) {\n          self.model.set('layer', mdl.newTileLayer());\n          self._disableOkBtn(false);\n          self._indicateIsValidating(false);\n          self._updateError();\n        }\n      },\n      error: function () {\n        if (url === self._lastURL) {\n          self._indicateIsValidating(false);\n          // Note that this text can not be longer, or it will exceed available space of the error label.\n          self._updateError(_t('components.modals.add-basemap.tilejson.invalid'));\n        }\n      }\n    });\n  },\n\n  _updateOkBtn: function () {\n    this._submitButton.find('span').text(_t('components.modals.add-basemap.add-btn'));\n  },\n\n  _disableOkBtn: function (disable) {\n    this._submitButton.toggleClass('is-disabled', disable);\n  },\n\n  _updateError: function (msg) {\n    this.$('.js-error').text(msg)[msg ? 'addClass' : 'removeClass']('is-visible');\n  },\n\n  _indicateIsValidating: function (indicate) {\n    if (indicate) {\n      this.$('.js-idle').hide();\n      this.$('.js-validating').show();\n    } else {\n      this.$('.js-validating').hide();\n      this.$('.js-idle').show();\n    }\n  },\n\n  // So don't try to be fetched relatively to current URL path later\n  _urlWithHTTP: function () {\n    var str = this.$('.js-url').val();\n\n    if (str.indexOf('http://') === -1 && str.indexOf('https://') === -1) {\n      return 'http://' + str;\n    } else {\n      return str;\n    }\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-alignCenter Modal-basemapContainer\">\\n  <h3 class=\"CDB-Text CDB-Size-large u-mainTextColor Modal-titleBasemap\">'+\n((__t=( _t('components.modals.add-basemap.wms.insert') ))==null?'':_.escape(__t))+\n'</h3>\\n  <div class=\"CDB-Text u-flex u-alignCenter\">\\n    <label class=\"Metadata-label Metadata-label--auto  CDB-Text CDB-Size-small is-semibold u-upperCase u-ellipsis\">'+\n((__t=( _t('components.modals.add-basemap.xyz.enter') ))==null?'':_.escape(__t))+\n'</label>\\n    <div class=\"Form-rowData Form-rowData--longer\">\\n      <input type=\"text\" class=\"has-icon CDB-InputText CDB-Text js-url\" value=\"\" placeholder=\"'+\n((__t=( _t('components.modals.add-basemap.xyz.eg') ))==null?'':_.escape(__t))+\n' http://openlayers.org/en/v3.5.0/examples/data/ogcsample.xml\">\\n      <i class=\"CDB-IconFont CDB-IconFont-dribbble Form-inputIcon js-idle\"></i>\\n      <i class=\"Spinner XYZPanel-inputIcon XYZPanel-inputIcon--loader Spinner--formIcon Form-inputIcon js-validating\" style=\"display: none;\"></i>\\n      <div class=\"XYZPanel-error CDB-InfoTooltip CDB-InfoTooltip--left is-error CDB-Text CDB-Size-medium CDB-InfoTooltip-text js-error '+\n((__t=( (layersFetched && layers.length === 0) ? 'is-visible' : '' ))==null?'':_.escape(__t))+\n'\">\\n        ';\n if (layersFetched && layers.length === 0) { \n__p+='\\n          '+\n((__t=( _t('components.modals.add-basemap.wms.invalid') ))==null?'':_.escape(__t))+\n'\\n        ';\n } \n__p+='\\n      </div>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./select-layer.tpl');\nvar WMSLayersView = require('./wms-layers-view');\n\n/**\n * Sub view, to select what layer to use as basemap.\n */\nmodule.exports = CoreView.extend({\n\n  events: {\n    'click .js-back': '_onClickBack'\n  },\n\n  initialize: function (opts) {\n    if (!opts.customBaselayersCollection) throw new Error('customBaselayersCollection is required');\n    this._customBaselayersCollection = opts.customBaselayersCollection;\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    this.$el.html(\n      template({\n        searchQuery: this.model.get('searchQuery'),\n        layersFound: this.model.getLayers(),\n        layersAvailableCount: this.model.layersAvailableCount()\n      })\n    );\n\n    this._initViews();\n\n    return this;\n  },\n\n  _initViews: function () {\n    var wmsListView = new WMSLayersView({\n      model: this.model,\n      customBaselayersCollection: this._customBaselayersCollection\n    });\n\n    this.addView(wmsListView);\n    this.$('.js-layers').append(wmsListView.render().el);\n  },\n\n  _onClickBack: function (e) {\n    this.killEvent(e);\n    this.model.set('currentView', 'enterURL');\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-inner\">\\n  <div class=\"Filters WMSSSelectLayer-Filter is-relative\">\\n    <div class=\"Filters-inner\">\\n      <div class=\"Filters-row\">\\n        <div class=\"Filters-group\">\\n          <div class=\"Filters-typeItem Filters-typeItem--searchEnabler\">\\n            <button class=\"Filters-searchLink CDB-Text is-semibold u-upperCase CDB-Size-medium js-search-link\">\\n              <i class=\"Filters-searchLinkIcon CDB-IconFont CDB-IconFont-lens\"></i>'+\n((__t=( _t('components.modals.add-layer.navigation.search') ))==null?'':_.escape(__t))+\n'\\n            </button>\\n          </div>\\n        </div>\\n\\n        <div class=\"Filters-typeItem Filters-typeItem--searchField\">\\n          <form class=\"Filters-searchForm js-search-form\" action=\"#\">\\n            <input class=\"Filters-searchInput CDB-Text CDB-Size-medium js-search-input\" type=\"text\" value=\"'+\n((__t=( searchQuery ))==null?'':_.escape(__t))+\n'\" placeholder=\"'+\n((__t=( _t('components.modals.add-basemap.wms.placeholder', { layersFoundCount: layersFound.length, layersFoundCountPluralize: _t('components.modals.add-basemap.wms.tables-pluralize', { smart_count: layersFound.length }), layersAvailableCount: layersAvailableCount, layersAvailableCountPluralize: _t('components.modals.add-basemap.wms.tables-pluralize', { smart_count: layersAvailableCount }) }) ))==null?'':_.escape(__t))+\n'\" />\\n            <button type=\"button\" class=\"Filters-cleanSearch js-clean-search u-actionTextColor\">\\n              <i class=\"CDB-IconFont CDB-IconFont-close\"></i>\\n            </button>\\n          </form>\\n        </div>\\n\\n        <span class=\"Filters-separator\"></span>\\n      </div>\\n    </div>\\n  </div>\\n\\n  ';\n if (searchQuery && layersFound.length == 0) { \n__p+='\\n    <div class=\"IntermediateInfo\">\\n      <div class=\"LayoutIcon\">\\n        <i class=\"CDB-IconFont CDB-IconFont-defaultUser\"></i>\\n      </div>\\n      <h4 class=\"CDB-Text CDB-Size-large u-mainTextColor u-bSpace u-secondaryTextColor u-tSpace-xl\">'+\n((__t=( _t('components.modals.add-basemap.wms.oh-no') ))==null?'':_.escape(__t))+\n'</h4>\\n      <p class=\"CDB-Text CDB-Size-medium u-altTextColor\">'+\n((__t=( _t('components.modals.add-basemap.wms.unfortunately') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  ';\n } else { \n__p+='\\n    <div class=\"js-layers\"></div>\\n  ';\n } \n__p+='\\n</div>\\n\\n<button class=\"NavButton Dialog-backBtn js-back\">\\n  <i class=\"CDB-IconFont CDB-IconFont-arrowPrev\"></i>\\n</button>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar CustomBaselayerModel = require('../../../../data/custom-baselayer-model');\n\n/**\n * Model for an individual WMS/WMTS layer.\n */\n\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    state: 'idle' // idle, saving, saveDone, saveFail\n  },\n\n  url: function () {\n    return this._wmsService.saveLayerURL({\n      title: this.get('title'),\n      name: this.get('name'),\n      layer: this.get('name'),\n      srs: this.get('srs'),\n      bounding_boxes: this.get('llbbox'),\n      type: this.get('type'), // wms/wmts\n      matrix_sets: this.get('matrix_sets')\n    });\n  },\n\n  sync: function (method, model, options) {\n    options = options || {};\n    options.url = this.url(method.toLowerCase());\n    options.dataType = 'jsonp';\n    method = 'READ';\n\n    return Backbone.sync.apply(this, arguments);\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.wmsService) throw new Error('wmsService is required');\n\n    this._wmsService = opts.wmsService;\n  },\n\n  canSave: function (customBaselayersCollection) {\n    return !_.any(customBaselayersCollection.isCustomCategory(), function (customLayer) {\n      return customLayer.get('name') === this.get('title');\n    }, this);\n  },\n\n  createProxiedLayerOrCustomBaselayerModel: function () {\n    this.set('state', 'saving');\n    this._shouldBeProxied() ? this._createProxiedLayer() : this._newCustomBaselayerModel();\n  },\n\n  _shouldBeProxied: function () {\n    if (this.get('type') === 'wmts') {\n      var supportedMatrixSets = this._wmsService.supportedMatrixSets(this.get('matrix_sets') || []);\n\n      return supportedMatrixSets.length > 0;\n    }\n\n    return true;\n  },\n\n  _createProxiedLayer: function () {\n    var self = this;\n\n    this.save({}, {\n      success: function () {\n        var proxiedBaselayerModel;\n\n        try {\n          proxiedBaselayerModel = self._newProxiedBaselayerModel();\n        } catch (e) {\n        }\n\n        if (proxiedBaselayerModel) {\n          self._setCustomBaselayerModel(proxiedBaselayerModel);\n        } else {\n          self.set('state', 'saveFail');\n        }\n      },\n      error: function (e) {\n        self.set('state', 'saveFail');\n      }\n    });\n  },\n\n  _newCustomBaselayerModel: function () {\n    var customBaselayerModel = this._byCustomURL(this._xyzURLTemplate());\n\n    customBaselayerModel.set({\n      name: this.get('title') || this.get('name'),\n      attribution: this.get('attribution'),\n      bounding_boxes: this.get('llbbox')\n    });\n    this._setCustomBaselayerModel(customBaselayerModel);\n\n    return customBaselayerModel;\n  },\n\n  _newProxiedBaselayerModel: function () {\n    if (!this.get('mapproxy_id')) {\n      throw new Error('mapproxy_id must be set');\n    }\n\n    var url = this._wmsService.getProxyTilesURL() + '/' + this.get('mapproxy_id') + '/wmts/map/webmercator/{z}/{x}/{y}.png';\n    var proxiedBaselayerModel = this._generateCustomBaselayerModel(url);\n\n    proxiedBaselayerModel.set({\n      name: this.get('title') || this.get('name'),\n      attribution: this.get('attribution'),\n      proxy: true,\n      bounding_boxes: this.get('bounding_boxes')\n    });\n\n    return proxiedBaselayerModel;\n  },\n\n  _generateCustomBaselayerModel: function (url) {\n    var layer = new CustomBaselayerModel({\n      urlTemplate: url,\n      attribution: null,\n      maxZoom: 21,\n      minZoom: 0,\n      name: '',\n      category: 'WMS',\n      tms: false,\n      type: 'Tiled'\n    });\n    layer.set('className', layer._generateClassName(url));\n\n    return layer;\n  },\n\n  _byCustomURL: function (url) {\n    // Minimal test for \"valid URL\" w/o having to complicate it with regex\n    if (url && url.indexOf('/') === -1) throw new TypeError('invalid URL');\n\n    // Only lowercase the placeholder variables, since the URL may contain case-sensitive data (e.g. API keys and such)\n    url = url.replace(/\\{S\\}/g, '{s}')\n      .replace(/\\{X\\}/g, '{x}')\n      .replace(/\\{Y\\}/g, '{y}')\n      .replace(/\\{Z\\}/g, '{z}');\n\n    var layer = this._generateCustomBaselayerModel(url);\n\n    return layer;\n  },\n\n  _xyzURLTemplate: function () {\n    var urlTemplate = this.get('url_template') || '';\n    // Convert the proxy template variables to XYZ format, http://foo.com/bar/%%(z)s/%%(x)s/%%(y)s.png\"\n    return urlTemplate.replace(/%%\\((\\w)\\)s/g, '{$1}');\n  },\n\n  _setCustomBaselayerModel: function (customBaselayerModel) {\n    this.set({\n      state: 'saveDone',\n      customBaselayerModel: customBaselayerModel\n    });\n  }\n\n});\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./wms-layer.tpl');\n\n/**\n * View for an individual layer item.\n */\nmodule.exports = CoreView.extend({\n\n  tagName: 'li',\n\n  className: 'List-row',\n\n  events: {\n    'click .js-add': '_onClickAdd'\n  },\n\n  initialize: function (opts) {\n    if (!opts.customBaselayersCollection) throw new Error('customBaselayersCollection is required');\n\n    this._customBaselayersCollection = opts.customBaselayersCollection;\n  },\n\n  render: function () {\n    this.$el.html(\n      template({\n        model: this.model,\n        canSave: this.model.canSave(this._customBaselayersCollection)\n      })\n    );\n    return this;\n  },\n\n  _onClickAdd: function (e) {\n    this.killEvent(e);\n\n    if (this.model.canSave(this._customBaselayersCollection)) {\n      this.model.createProxiedLayerOrCustomBaselayerModel();\n    }\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"List-rowItem\">\\n  <div class=\"DefaultTitle '+\n((__t=( canSave ? '': 'is-disabled' ))==null?'':_.escape(__t))+\n'\">'+\n((__t=( model.get('title') || model.get('name') ))==null?'':_.escape(__t))+\n'</div>\\n  <button class=\"js-add Button Button--secondary Button--secondaryTransparentBkg '+\n((__t=( canSave ? '' : 'is-disabled' ))==null?'':_.escape(__t))+\n'\">\\n    <span>Add this</span>\\n  </button>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar WMSLayerModel = require('./wms-layer-model');\n\nmodule.exports = Backbone.Collection.extend({\n\n  model: function (attrs, opts) {\n    var self = opts.collection;\n\n    return new WMSLayerModel(attrs, {\n      wmsService: self._wmsService\n    });\n  },\n\n  parse: function (r) {\n    var layers = [];\n\n    if (r.layers) {\n      layers = _.map(r.layers, function (layer) {\n        return _.extend({ type: r.type || 'wms' }, layer);\n      });\n    }\n\n    return layers;\n  },\n\n  sync: function (method, model, options) {\n    options = options || {};\n    options.url = this.url(method.toLowerCase());\n    options.dataType = 'jsonp';\n    method = 'READ';\n\n    return Backbone.sync.apply(this, arguments);\n  },\n\n  url: function () {\n    return this._wmsService.getFetchLayersURL();\n  },\n\n  initialize: function (models, opts) {\n    if (!opts.wmsService) throw new Error('wmsService is required');\n\n    this._wmsService = opts.wmsService;\n  }\n\n});\n",
    "var WMSLayerView = require('./wms-layer-view');\nvar CoreView = require('backbone/core-view');\n\n/**\n * Sub view, to select what layer to use as basemap.\n */\nmodule.exports = CoreView.extend({\n\n  className: 'List',\n  tagName: 'ul',\n\n  initialize: function (opts) {\n    if (!opts.customBaselayersCollection) throw new Error('customBaselayersCollection is required');\n    if (!this.model) throw new Error('model is required');\n\n    this._customBaselayersCollection = opts.customBaselayersCollection;\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.append.apply(this.$el, this._renderedLayers());\n    return this;\n  },\n\n  _renderedLayers: function () {\n    return this.model.getLayers().map(function (layer) {\n      var view = new WMSLayerView({\n        model: layer,\n        customBaselayersCollection: this._customBaselayersCollection\n      });\n\n      this.addView(view);\n\n      return view.render().el;\n    }, this);\n  }\n\n});\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar WMSView = require('./wms-view');\nvar WMSLayersCollection = require('./wms-layers-collection');\nvar WMSService = require('../../../../data/wms-service');\n\n/**\n * View model for WMS/WMTS tab content.\n */\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    name: 'wms',\n    label: 'WMS/WMTS',\n    currentView: 'enterURL', // [fetchingLayers, selectLayer, savingLayer]\n    layersFetched: false,\n    layer: undefined // will be set when selected\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.customBaselayersCollection) throw new Error('customBaselayersCollection is required');\n\n    this._customBaselayersCollection = opts.customBaselayersCollection;\n\n    this.wmsService = new WMSService();\n    this.wmsLayersCollection = new WMSLayersCollection(null, {\n      wmsService: this.wmsService\n    });\n\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this.wmsLayersCollection.bind('change:state', this._onLayerStateChange, this);\n    this.wmsLayersCollection.bind('reset', function () {\n      this.set({\n        currentView: this.wmsLayersCollection.length > 0 ? 'selectLayer' : 'enterURL',\n        layersFetched: true\n      });\n\n      this.trigger('layersFetched');\n    }, this);\n  },\n\n  createView: function (opts) {\n    if (!opts.submitButton) throw new Error('submitButton is required');\n    if (!opts.modalFooter) throw new Error('modalFooter is required');\n\n    this._submitButton = opts.submitButton;\n    this._modalFooter = opts.modalFooter;\n\n    this.set({\n      currentView: 'enterURL',\n      layersFetched: false\n    });\n\n    return new WMSView({\n      model: this,\n      customBaselayersCollection: this._customBaselayersCollection,\n      submitButton: this._submitButton,\n      modalFooter: this._modalFooter\n    });\n  },\n\n  fetchLayers: function (url) {\n    this.set('currentView', 'fetchingLayers');\n\n    this.wmsService.setUrl(url);\n\n    this.wmsLayersCollection.fetch({\n      reset: true\n    });\n  },\n\n  layersAvailableCount: function () {\n    return _.difference(\n      this.wmsLayersCollection.pluck('title'),\n      this._customBaselayersCollection.pluck('name')\n    ).length;\n  },\n\n  get: function (name) {\n    if (name === 'layer') {\n      var customBaselayerModel = this.wmsLayersCollection.find(function (mdl) {\n        return mdl.get('state') === 'saveDone';\n      });\n\n      return customBaselayerModel && customBaselayerModel.get('customBaselayerModel');\n    } else {\n      return Backbone.Model.prototype.get.apply(this, arguments);\n    }\n  },\n\n  getLayers: function () {\n    if (this.get('searchQuery')) {\n      var regExp = new RegExp(this.get('searchQuery'), 'i');\n\n      return this.wmsLayersCollection.filter(function (layer) {\n        return layer.get('name').match(regExp);\n      }, this);\n    } else {\n      return this.wmsLayersCollection;\n    }\n  },\n\n  hasAlreadyAddedLayer: function () {\n    // Already added layers are disabled to be saved for each layer\n    return false;\n  },\n\n  _onLayerStateChange: function (mdl, newState) {\n    switch (newState) {\n      case 'saving':\n        this.set('currentView', 'savingLayer');\n        break;\n      case 'saveDone':\n        this.set('layer', mdl.get('customBaselayerModel'));\n        this.trigger('saveBasemap');\n        break;\n      case 'saveFail':\n        this.set('currentView', 'saveFail');\n        break;\n      default:\n        this.set('currentView', 'selectLayer');\n    }\n  }\n\n});\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar SelectLayerView = require('./select-layer-view');\nvar ViewFactory = require('../../../view-factory');\nvar ErrorView = require('../../../error/error-view');\nvar renderLoading = require('../../../loading/render-loading');\nvar enterUrl = require('./enter-url.tpl');\nvar $ = require('jquery');\n\n/**\n * Represents the WMS/WMTS tab category.\n * Current state is defined by presence (or lack of) layers\n */\nmodule.exports = CoreView.extend({\n\n  events: {\n    'keydown .js-search-input': '_onKeyDown',\n    'submit .js-search-form': 'killEvent',\n    'keydown .js-url': '_onKeydown',\n    'paste .js-url': '_onPaste',\n    'click .js-clean-search': '_onCleanSearchClick',\n    'click .js-search-link': '_submitSearch'\n  },\n\n  initialize: function (opts) {\n    if (!opts.customBaselayersCollection) throw new Error('customBaselayersCollection is required');\n    if (!opts.submitButton) throw new Error('submitButton is required');\n    if (!opts.modalFooter) throw new Error('modalFooter is required');\n\n    this._customBaselayersCollection = opts.customBaselayersCollection;\n    this._submitButton = opts.submitButton;\n    this._modalFooter = opts.modalFooter;\n    this._debouncedUpdate = _.debounce(this._update.bind(this), 150);\n    this._onClickBinded = this._onClickOK.bind(this);\n\n    this._bindSubmitButton();\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    this._updateOkBtn();\n    this._disableOkBtn(true);\n\n    var view;\n\n    switch (this.model.get('currentView')) {\n      case 'savingLayer':\n        this._disableModalFooter(true);\n\n        view = ViewFactory.createByHTML(\n          renderLoading({\n            title: _t('components.modals.add-basemap.saving')\n          })\n        );\n        break;\n      case 'selectLayer':\n        this._disableModalFooter(true);\n\n        view = new SelectLayerView({\n          model: this.model,\n          customBaselayersCollection: this._customBaselayersCollection\n        });\n        break;\n      case 'saveFail':\n        this._disableModalFooter(true);\n\n        view = new ErrorView({\n          title: _t('components.modals.add-basemap.add-basemap-error')\n        });\n        break;\n      case 'fetchingLayers':\n        this._disableModalFooter(true);\n\n        view = ViewFactory.createByHTML(\n          renderLoading({\n            title: _t('components.modals.add-basemap.fetching')\n          })\n        );\n        break;\n      case 'enterURL':\n      default:\n        this._disableModalFooter(false);\n\n        view = ViewFactory.createByHTML(\n          enterUrl({\n            layersFetched: this.model.get('layersFetched'),\n            layers: this.model.wmsLayersCollection\n          })\n        );\n        break;\n    }\n    this.addView(view);\n    this.$el.append(view.render().el);\n\n    this.$('.js-search-input').focus();\n\n    return this;\n  },\n\n  _showCleanSearchButton: function () {\n    this.$('.js-clean-search').show();\n  },\n\n  _hideCleanSearchButton: function () {\n    this.$('.js-clean-search').hide();\n  },\n\n  _initBinds: function () {\n    this.model.bind('change', this.render, this);\n    this.model.bind('change', this._onChangeSearchQuery, this);\n    this.model.bind('layersFetched', this.render, this);\n  },\n\n  _onKeydown: function (e) {\n    e.stopPropagation();\n\n    this._debouncedUpdate();\n  },\n\n  _onPaste: function (e) {\n    e.stopPropagation();\n\n    this._debouncedUpdate();\n  },\n\n  _update: function (e) {\n    this._disableOkBtn(!this.$('.js-url').val());\n    this.$('.js-error').removeClass('is-visible'); // resets error state when changed\n  },\n\n  _disableOkBtn: function (disable) {\n    this._submitButton.toggleClass('is-disabled', disable);\n  },\n\n  _onKeyDown: function (e) {\n    var enterPressed = (e.keyCode === $.ui.keyCode.ENTER);\n\n    if (enterPressed) {\n      this.killEvent(e);\n\n      this._submitSearch();\n    }\n  },\n\n  _submitSearch: function (e) {\n    this.killEvent(e);\n\n    this.model.set('searchQuery', this.$('.js-search-input').val());\n  },\n\n  _onChangeSearchQuery: function () {\n    var searchQuery = this.model.get('searchQuery');\n\n    if (!searchQuery) {\n      this._hideCleanSearchButton();\n    }\n  },\n\n  _onCleanSearchClick: function (e) {\n    this.killEvent(e);\n\n    this.model.set('searchQuery', '');\n  },\n\n  _onClickOK: function (e) {\n    this.killEvent(e);\n\n    var url = this.$('.js-url').val();\n\n    if (url) {\n      this.model.fetchLayers(url);\n    }\n  },\n\n  _disableModalFooter: function (disable) {\n    this._modalFooter.toggleClass('is-disabled', disable);\n  },\n\n  _updateOkBtn: function () {\n    this._submitButton.find('span').text(_t('components.modals.add-basemap.get-layers'));\n  },\n\n  _bindSubmitButton: function () {\n    this._submitButton.on('click', this._onClickBinded);\n  },\n\n  _unBindSubmitButton: function () {\n    this._submitButton.off('click', this._onClickBinded);\n  },\n\n  clean: function () {\n    this._unBindSubmitButton();\n    CoreView.prototype.clean.call(this);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-alignCenter Modal-basemapContainer\">\\n  <h3 class=\"CDB-Text CDB-Size-large u-mainTextColor Modal-titleBasemap\">'+\n((__t=( _t('components.modals.add-basemap.xyz.insert') ))==null?'':_.escape(__t))+\n'</h3>\\n  <div class=\"CDB-Text u-flex u-alignCenter\">\\n    <label class=\"Metadata-label Metadata-label--auto  CDB-Text CDB-Size-small is-semibold u-upperCase u-ellipsis\">'+\n((__t=( _t('components.modals.add-basemap.xyz.enter') ))==null?'':_.escape(__t))+\n'</label>\\n    <div class=\"Form-rowData Form-rowData--longer\">\\n      <input type=\"text\" class=\"has-icon CDB-InputText CDB-Text js-url\" value=\"\" placeholder=\"E.g. https://{s}.carto.com/foobar/{z}/{x}/{y}.png\">\\n      <i class=\"Spinner XYZPanel-inputIcon XYZPanel-inputIcon--loader Spinner--formIcon Form-inputIcon js-validating\" style=\"display: none;\"></i>\\n      <div class=\"Checkbox XYZPanel-inputCheckbox js-tms\" data-title=\"Inverts Y axis numbering for tiles\">\\n        <button class=\"Checkbox-input u-rSpace--m\"></button>\\n        <label class=\"CDB-Text CDB-Size-small is-semibold u-upperCase\">'+\n((__t=( _t('components.modals.add-basemap.xyz.tms') ))==null?'':_.escape(__t))+\n'</label>\\n      </div>\\n      <div class=\"XYZPanel-error CDB-InfoTooltip CDB-InfoTooltip--left is-error CDB-Text CDB-Size-medium CDB-InfoTooltip-text js-error\"></div>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar XYZView = require('./xyz-view');\n\n/**\n * View model for XYZ tab content.\n */\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    name: 'xyz',\n    label: 'XYZ',\n    tms: false,\n    layer: undefined // will be set when valid\n  },\n\n  createView: function (opts) {\n    if (!opts.submitButton) throw new Error('submitButton is required');\n    if (!opts.modalFooter) throw new Error('modalFooter is required');\n\n    this._submitButton = opts.submitButton;\n    this._modalFooter = opts.modalFooter;\n\n    return new XYZView({\n      model: this,\n      submitButton: this._submitButton,\n      modalFooter: this._modalFooter\n    });\n  },\n\n  hasAlreadyAddedLayer: function (userLayers) {\n    var urlTemplate = this.get('layer').get('urlTemplate');\n    return _.any(userLayers.isCustomCategory(), function (customLayer) {\n      return customLayer.get('urlTemplate') === urlTemplate;\n    });\n  }\n\n});\n",
    "var $ = require('jquery');\nvar _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar template = require('./enter-url.tpl');\nvar CustomBaselayerModel = require('../../../../data/custom-baselayer-model');\nvar TipsyTooltipView = require('../../../../components/tipsy-tooltip-view');\n\n/**\n * Represents the XYZ tab content.\n */\n\nmodule.exports = CoreView.extend({\n\n  className: 'XYZPanel',\n\n  events: {\n    'click .js-tms': '_changeTMS',\n    'keydown .js-url': '_onKeydown',\n    'paste .js-url': '_onPaste'\n  },\n\n  initialize: function (opts) {\n    if (!opts.submitButton) throw new Error('submitButton is required');\n\n    this._submitButton = opts.submitButton;\n    this._lastCallSeq = 0;\n    this._debouncedUpdate = _.debounce(this._update.bind(this), 150);\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    this._updateOkBtn();\n    this._disableOkBtn(true);\n\n    this.$el.html(\n      template()\n    );\n\n    this._initViews();\n\n    return this;\n  },\n\n  _initViews: function () {\n    // Add TMS tooltip\n    var tooltip = new TipsyTooltipView({\n      el: this.$('.js-tms'),\n      title: function () {\n        return $(this).data('title');\n      }\n    });\n    this.addView(tooltip);\n  },\n\n  _onKeydown: function (e) {\n    e.stopPropagation();\n    this._debouncedUpdate();\n  },\n\n  _onPaste: function (e) {\n    e.stopPropagation();\n    this._debouncedUpdate();\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:tms', this._setTMSCheckbox, this);\n  },\n\n  _update: function () {\n    this._disableOkBtn(true);\n    this._indicateIsValidating(true);\n    var layer;\n    var urlErrorMsg;\n\n    var url = this.$('.js-url').val();\n    var tms = this.model.get('tms');\n\n    if (url) {\n      try {\n        layer = this._byCustomURL(url, tms);\n      } catch (e) {\n        urlErrorMsg = _t('components.modals.add-basemap.xyz.not-valid');\n      }\n    }\n\n    this.model.set('layer', layer);\n\n    if (layer) {\n      var self = this;\n      // Make sure only the last call made is the one that defines view change,\n      // avoids laggy responses to indicate wrong state\n      var thisCallSeq = ++this._lastCallSeq;\n      layer.validateTemplateURL({\n        success: function () {\n          if (thisCallSeq === self._lastCallSeq) {\n            self._disableOkBtn(false);\n            self._indicateIsValidating(false);\n            self._updateError();\n          }\n        },\n        error: function () {\n          if (thisCallSeq === self._lastCallSeq) {\n            self._disableOkBtn(false);\n            self._indicateIsValidating(false);\n            self._updateError(_t('components.modals.add-basemap.xyz.couldnt-validate'));\n          }\n        }\n      });\n    } else if (url) {\n      this._indicateIsValidating(false);\n      this._updateError(urlErrorMsg);\n    } else {\n      this._indicateIsValidating(false);\n      this._updateError();\n    }\n  },\n\n  _changeTMS: function (e) {\n    this.model.set('tms', !this.model.get('tms'));\n    this._onKeydown(e);\n  },\n\n  _setTMSCheckbox: function (e) {\n    this.$('.js-tms .Checkbox-input').toggleClass('is-checked', this.model.get('tms'));\n  },\n\n  _byCustomURL: function (url, tms) {\n    // Minimal test for \"valid URL\" w/o having to complicate it with regex\n    if (url && url.indexOf('/') === -1) throw new TypeError('invalid URL');\n\n    // Only lowercase the placeholder variables, since the URL may contain case-sensitive data (e.g. API keys and such)\n    url = url.replace(/\\{S\\}/g, '{s}')\n      .replace(/\\{X\\}/g, '{x}')\n      .replace(/\\{Y\\}/g, '{y}')\n      .replace(/\\{Z\\}/g, '{z}');\n\n    var layer = new CustomBaselayerModel({\n      urlTemplate: url,\n      attribution: null,\n      maxZoom: 21,\n      minZoom: 0,\n      name: '',\n      tms: tms,\n      category: 'Custom',\n      type: 'Tiled'\n    });\n    layer.set('className', layer._generateClassName(url));\n\n    return layer;\n  },\n\n  _setTMS: function (ev) {\n    var $checkbox = $(ev.target).closest('.Checkbox');\n    $checkbox.find('.Checkbox-input').toggleClass('is-checked');\n    this._update(ev);\n  },\n\n  _updateOkBtn: function () {\n    this._submitButton.find('span').text(_t('components.modals.add-basemap.add-btn'));\n  },\n\n  _disableOkBtn: function (disable) {\n    this._submitButton.toggleClass('is-disabled', disable);\n  },\n\n  _updateError: function (msg) {\n    this.$('.js-error').text(msg)[ msg ? 'addClass' : 'removeClass' ]('is-visible');\n  },\n\n  _indicateIsValidating: function (indicate) {\n    this.$('.js-validating').toggle(!!indicate);\n  }\n\n});\n",
    "var Backbone = require('backbone');\nvar UploadModel = require('../../../data/upload-model');\nvar VisualizationFetchModel = require('../../../data/visualizations-fetch-model');\nvar TablesCollection = require('../../../data/visualizations-collection');\nvar TableModel = require('../../../data/table-model');\n\n/**\n * Add layer model\n *\n * \"Implements\" the CreateListingModel.\n */\nmodule.exports = Backbone.Model.extend({\n  defaults: {\n    type: 'addLayer',\n    contentPane: 'listing', // [listing, loading]\n    listing: 'datasets', // [import, datasets, scratch]\n    collectionFetched: false,\n    activeImportPane: 'file'\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.userActions) throw new Error('userActions is required');\n    if (!opts.pollingModel) throw new Error('pollingModel is required');\n\n    this._userModel = opts.userModel;\n    this._userActions = opts.userActions;\n    this._configModel = opts.configModel;\n    this._pollingModel = opts.pollingModel;\n\n    this._uploadModel = new UploadModel({\n      create_vis: false\n    }, {\n      userModel: this._userModel,\n      configModel: this._configModel\n    });\n\n    this._selectedDatasetsCollection = new Backbone.Collection();\n    this._tablesCollection = new TablesCollection([], {\n      configModel: this._configModel\n    });\n    this._visualizationFetchModel = new VisualizationFetchModel({\n      content_type: 'datasets',\n      library: this.showLibrary()\n    });\n    this._initBinds();\n    this._fetchCollection();\n  },\n\n  getTablesCollection: function () {\n    return this._tablesCollection;\n  },\n\n  getSelectedDatasetsCollection: function () {\n    return this._selectedDatasetsCollection;\n  },\n\n  getVisualizationFetchModel: function () {\n    return this._visualizationFetchModel;\n  },\n\n  getUploadModel: function () {\n    return this._uploadModel;\n  },\n\n  canSelect: function (dataset) {\n    return dataset.get('selected') || this._selectedDatasetsCollection.length < 1; // for now only allow 1 item\n  },\n\n  showLibrary: function () {\n    return false;\n  },\n\n  showDatasets: function () {\n    return true;\n  },\n\n  setActiveImportPane: function (name) {\n    this.set('activeImportPane', name);\n  },\n\n  canFinish: function () {\n    if (this.get('listing') === 'import') {\n      return this._uploadModel.isValidToUpload();\n    } else if (this.get('listing') === 'datasets') {\n      return this._selectedDatasetsCollection.length > 0;\n    }\n  },\n\n  finish: function () {\n    if (this.get('listing') === 'import') {\n      this._pollingModel.trigger('importByUploadData', this._uploadModel.toJSON(), this);\n    } else if (this.get('listing') === 'datasets') {\n      var mdl = this._selectedDatasetsCollection.at(0);\n      if (mdl.get('type') === 'remote') {\n        var d = {\n          create_vis: false,\n          type: 'remote',\n          value: mdl.get('name'),\n          remote_visualization_id: mdl.get('id'),\n          size: mdl.get('external_source') ? mdl.get('external_source').size : undefined\n        };\n        // See BackgroundImporter where the same event is bound to be handled..\n        this._pollingModel.trigger('importByUploadData', d, this);\n      } else {\n        this._addNewLayer(mdl.getTableModel());\n      }\n    }\n  },\n\n  getImportState: function () {\n    return this.get('activeImportPane');\n  },\n\n  showGuessingToggler: function () {\n    return this.get('listing') === 'import';\n  },\n\n  showPrivacyToggler: function () {\n    return this.get('listing') === 'import';\n  },\n\n  createFromScratch: function () {\n    var self = this;\n    this.set('contentPane', 'creatingFromScratch');\n    var tableModel = new TableModel({}, {\n      configModel: this._configModel\n    });\n    tableModel.save({}, {\n      success: function () {\n        self._addNewLayer(tableModel);\n      },\n      error: function () {\n        self.set('contentPane', 'addLayerFailed');\n      }\n    });\n  },\n\n  _initBinds: function () {\n    this._uploadModel.bind('change', function () {\n      this.trigger('change:upload', this);\n    }, this);\n    this._visualizationFetchModel.bind('change', this._fetchCollection, this);\n    this.bind('change:listing', this._fetchCollection, this);\n\n    this._tablesCollection.bind('change:selected', function (changedModel, wasSelected) {\n      this._selectedDatasetsCollection[ wasSelected ? 'add' : 'remove' ](changedModel);\n    }, this);\n    this._tablesCollection.bind('sync', function () {\n      this._selectedDatasetsCollection.each(function (model) {\n        var sameModel = this._tablesCollection.get(model.id);\n        if (sameModel) {\n          sameModel.set('selected', true);\n        }\n      }, this);\n    }, this);\n  },\n\n  _fetchCollection: function () {\n    var params = this._visualizationFetchModel.attributes;\n    var types;\n\n    if (this._visualizationFetchModel.isSearching()) {\n      // Supporting search in data library and user datasets at the same time\n      types = 'table,remote';\n    } else {\n      types = params.library ? 'remote' : 'table';\n    }\n\n    this._tablesCollection.fetch({\n      data: {\n        locked: '',\n        q: params.q,\n        page: params.page,\n        tags: params.tag,\n        shared: params.shared,\n        only_liked: params.liked,\n        type: '',\n        types: types\n      }\n    });\n  },\n\n  _onCollectionChange: function () {\n    this._selectedDatasetsCollection.reset(\n      this._tablesCollection.where({ selected: true })\n    );\n  },\n\n  _addNewLayer: function (tableModel) {\n    this.set('contentPane', 'addingNewLayer');\n\n    this._userActions.createLayerFromTable(tableModel, {\n      success: function () {\n        this.trigger('addLayerDone');\n      }.bind(this),\n      error: function () {\n        this.set('contentPane', 'addLayerFailed');\n      }.bind(this)\n    });\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar template = require('./add-layer.tpl');\nvar FooterView = require('./footer/footer-view');\nvar NavigationView = require('./content/navigation-view');\nvar ListingView = require('./content/listing-view');\nvar TabPaneView = require('../../tab-pane/tab-pane-view');\nvar TabPaneCollection = require('../../tab-pane/tab-pane-collection');\nvar ViewFactory = require('../../view-factory');\nvar renderLoading = require('../../loading/render-loading');\nvar ErrorView = require('../../error/error-view');\n\n/**\n * Add layer dialog, typically used from editor\n */\nmodule.exports = CoreView.extend({\n\n  className: 'Dialog-content Dialog-content--expanded',\n\n  initialize: function (opts) {\n    if (!opts.modalModel) throw new TypeError('model is required');\n    if (!opts.createModel) throw new TypeError('createModel is required');\n    if (!opts.configModel) throw new TypeError('configModel is required');\n    if (!opts.userModel) throw new TypeError('userModel is required');\n    if (!opts.pollingModel) throw new TypeError('pollingModel is required');\n\n    this._modalModel = opts.modalModel;\n    this._createModel = opts.createModel;\n    this._userModel = opts.userModel;\n    this._configModel = opts.configModel;\n    this._pollingModel = opts.pollingModel;\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template());\n    this._initViews();\n  },\n\n  _initBinds: function () {\n    this._createModel.bind('addLayerDone', this._modalModel.destroy.bind(this._modalModel), this);\n    this._createModel.bind('change:contentPane', this._onChangeContentView, this);\n    this._pollingModel.bind('importByUploadData', this._modalModel.destroy.bind(this._modalModel), this);\n    this.add_related_model(this._pollingModel);\n    this.add_related_model(this._createModel);\n  },\n\n  _initViews: function () {\n    var self = this;\n\n    this._navigationView = new NavigationView({\n      el: this.$('.js-navigation'),\n      userModel: this._userModel,\n      routerModel: this._createModel.getVisualizationFetchModel(),\n      createModel: this._createModel,\n      tablesCollection: this._createModel.getTablesCollection()\n    });\n    this._navigationView.render();\n    this.addView(this._navigationView);\n\n    this._tabPaneCollection = new TabPaneCollection([\n      {\n        name: 'listing',\n        selected: this._createModel.get('contentPane') === 'listing',\n        createContentView: function () {\n          return new ListingView({\n            createModel: self._createModel,\n            configModel: self._configModel,\n            userModel: self._userModel\n          });\n        }\n      }, {\n        name: 'creatingFromScratch',\n        selected: this._createModel.get('contentPane') === 'creatingFromScratch',\n        createContentView: function () {\n          return ViewFactory.createByHTML(\n            renderLoading({\n              title: _t('components.modals.add-layer.create-loading-title')\n            })\n          );\n        }\n      }, {\n        name: 'addingNewLayer',\n        selected: this._createModel.get('contentPane') === 'addingNewLayer',\n        createContentView: function () {\n          return ViewFactory.createByHTML(\n            renderLoading({\n              title: _t('components.modals.add-layer.adding-new-layer')\n            })\n          );\n        }\n      }, {\n        name: 'addLayerFailed',\n        selected: this._createModel.get('contentPane') === 'addLayerFailed',\n        createContentView: function () {\n          return new ErrorView({\n            title: _t('components.modals.add-layer.add-layer-error')\n          });\n        }\n      }\n    ]);\n\n    var tabPaneView = new TabPaneView({\n      collection: this._tabPaneCollection\n    });\n    this.addView(tabPaneView);\n    this.$('.js-content-container').append(tabPaneView.render().el);\n\n    this._footerView = new FooterView({\n      configModel: this._configModel,\n      createModel: this._createModel,\n      userModel: this._userModel\n    });\n    this.addView(this._footerView);\n    this.$('.js-footer').append(this._footerView.render().el);\n  },\n\n  _onChangeContentView: function () {\n    var context = this._createModel.get('contentPane');\n    var paneModel = _.first(this._tabPaneCollection.where({ name: context }));\n    var paneModelName = paneModel.get('name');\n    paneModel.set('selected', true);\n\n    if (paneModelName === 'loading') {\n      this._footerView.hide();\n    }\n    if (paneModelName !== 'listing') {\n      this._navigationView.hide();\n    }\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Dialog-header Dialog-header--expanded CreateDialog-header with-separator\">\\n  <div class=\"Dialog-headerIcon Dialog-headerIcon--neutral\">\\n    <i class=\"CDB-IconFont CDB-IconFont-add\"></i>\\n  </div>\\n  <h2 class=\"CDB-Text CDB-Size-large u-mainTextColor u-bSpace\">'+\n((__t=( _t('components.modals.add-layer.modal-title') ))==null?'':_.escape(__t))+\n'</h2>\\n  <h3 class=\"CDB-Text CDB-Size-medium u-altTextColor\">'+\n((__t=( _t('components.modals.add-layer.modal-desc') ))==null?'':_.escape(__t))+\n'</h3>\\n</div>\\n<div class=\"Filters Filters--navListing Filters--static js-navigation\"></div>\\n<div class=\"js-content-container Dialog-body Dialog-body--expanded Dialog-body--create Dialog-body--noPaddingTop Dialog-body--withoutBorder\"></div>\\n<div class=\"Dialog-footer Dialog-footer--expanded CreateDialog-footer js-footer\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar randomQuote = require('../../../../loading/random-quote');\n\n/*\n *  Content result default view\n */\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-connect': '_onConnectClick'\n  },\n\n  initialize: function (opts) {\n    if (!opts.routerModel) throw new Error('routerModel is required');\n    if (!opts.tablesCollection) throw new Error('tablesCollection is required');\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.template) throw new Error('template is required');\n\n    this._userModel = opts.userModel;\n    this._routerModel = opts.routerModel;\n    this._tablesCollection = opts.tablesCollection;\n    this.template = opts.template;\n\n    this._initBinds();\n  },\n\n  render: function () {\n    var type = this._routerModel.get('content_type');\n\n    this.$el.html(this.template({\n      page: this._routerModel.get('page'),\n      tag: this._routerModel.get('tag'),\n      q: this._routerModel.get('q'),\n      shared: this._routerModel.get('shared'),\n      locked: this._routerModel.get('locked'),\n      library: this._routerModel.get('library'),\n      quote: randomQuote(),\n      type: type,\n      totalItems: this._tablesCollection.size(),\n      totalEntries: this._tablesCollection.getTotalStat('total_entries')\n    }));\n\n    return this;\n  },\n\n  _initBinds: function () {\n    this._routerModel.bind('change', this.render, this);\n    this._tablesCollection.bind('sync', this.render, this);\n    this.add_related_model(this._routerModel);\n    this.add_related_model(this._tablesCollection);\n  },\n\n  _onConnectClick: function () {\n    this.trigger('connectDataset', this);\n  }\n\n});\n",
    "var cdb = require('cartodb.js');\nvar CoreView = require('backbone/core-view');\nvar $ = require('jquery');\nvar _ = require('underscore');\nvar moment = require('moment');\nvar Utils = require('../../../../../helpers/utils');\nvar TipsyTooltipView = require('../../../../tipsy-tooltip-view');\nvar template = require('./dataset-item.tpl');\nvar LikesView = require('../../../../likes/likes-view');\n\n/**\n * View representing an item in the list under datasets route.\n */\nmodule.exports = CoreView.extend({\n  tagName: 'li',\n  className: 'ModalBlockList-item ModalBlockList-item--full',\n\n  events: {\n    'click .js-tag-link': '_onTagClick',\n    'click': '_toggleSelected'\n  },\n\n  initialize: function (opts) {\n    if (!opts.createModel) throw new Error('createModel is required');\n    if (!opts.userModel) throw new Error('userModel is required');\n\n    this._createModel = opts.createModel;\n    this._userModel = opts.userModel;\n    this._routerModel = this._createModel.getVisualizationFetchModel();\n\n    this.model.on('change', this.render, this);\n  },\n\n  render: function () {\n    var tableModel = this.model.getTableModel();\n    var permissionModel = this.model.getPermissionModel();\n    var synchronizationModel = this.model.getSynchronizationModel();\n    var tags = this.model.get('tags') || [];\n    var description = cdb.core.sanitize.html(this.model.get('description'));\n    var tableGeomColumnTypes = tableModel.getGeometryType() || [];\n\n    var d = {\n      isRaster: this.model.isRaster(),\n      geometryType: tableGeomColumnTypes.length > 0 ? tableGeomColumnTypes[0] : '',\n      title: this.model.get('name'),\n      isOwner: permissionModel.isOwner(this._userModel),\n      owner: permissionModel.getOwner().renderData(this._userModel),\n      showPermissionIndicator: !permissionModel.hasWriteAccess(this._userModel),\n      description: description,\n      privacy: this.model.get('privacy').toLowerCase(),\n      likes: this.model.get('likes') || 0,\n      timeDiff: moment(this.model.get('updated_at')).fromNow(),\n      tags: tags,\n      tagsCount: tags.length,\n      maxTagsToShow: 3,\n      rowCount: undefined,\n      datasetSize: undefined,\n      syncStatus: undefined,\n      syncRanAt: undefined\n    };\n\n    var rowCount = tableModel.get('row_count');\n    if (rowCount >= 0) {\n      d.rowCount = rowCount;\n      d.rowCountFormatted = (rowCount < 10000 ? Utils.formatNumber(rowCount) : Utils.readizableNumber(rowCount));\n    }\n\n    var datasetSize = tableModel.get('size');\n    if (datasetSize >= 0) {\n      d.datasetSize = Utils.readablizeBytes(datasetSize, true);\n    }\n\n    if (!_.isEmpty(synchronizationModel)) {\n      d.syncRanAt = moment(synchronizationModel.get('ran_at') || new Date()).fromNow();\n      d.syncStatus = synchronizationModel.get('state');\n    }\n\n    this.$el.html(template(d));\n\n    this._renderLikesIndicator();\n    this._renderTooltips();\n\n    // Item selected?\n    this.$el.toggleClass('is-selected', !!this.model.get('selected'));\n\n    return this;\n  },\n\n  _renderLikesIndicator: function () {\n    var view = new LikesView({\n      model: this.model.getLikesModel()\n    });\n    this.$('.js-likes-indicator').replaceWith(view.render().el);\n    this.addView(view);\n  },\n\n  _renderTooltips: function () {\n    if (!_.isEmpty(this.model.get('synchronization'))) {\n      this.addView(\n        new TipsyTooltipView({\n          el: this.$('.DatasetsList-itemStatus'),\n          title: function (e) {\n            return $(this).attr('data-title');\n          }\n        })\n      );\n    }\n  },\n\n  _onTagClick: function (ev) {\n    var tag = $(ev.target).val();\n\n    if (tag) {\n      this._routerModel.set('tag', tag);\n    }\n  },\n\n  _toggleSelected: function (ev) {\n    // Let links use default behaviour\n    if (ev.target.tagName !== 'A') {\n      this.killEvent(ev);\n      if (this._createModel.canSelect(this.model)) {\n        this.model.set('selected', !this.model.get('selected'));\n      }\n    }\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"DatasetsList-itemCategory is--'+\n((__t=( isRaster ? 'raster' : geometryType ))==null?'':_.escape(__t))+\n'Dataset\">\\n  ';\n if (syncStatus) { \n__p+='\\n    <i\\n    ';\n if (syncStatus === \"failure\") { \n__p+='\\n      data-title=\"'+\n((__t=( _t('components.modals.add-layer.datasets.item.sync-failed') ))==null?'':_.escape(__t))+\n' '+\n((__t=( syncRanAt ))==null?'':_.escape(__t))+\n'\"\\n    ';\n } else if (syncStatus === \"syncing\") { \n__p+='\\n      data-title=\"'+\n((__t=( _t('components.modals.add-layer.datasets.item.syncing') ))==null?'':_.escape(__t))+\n'\"\\n    ';\n } else { \n__p+='\\n      data-title=\"'+\n((__t=( _t('components.modals.add-layer.datasets.item.synced') ))==null?'':_.escape(__t))+\n' '+\n((__t=( syncRanAt ))==null?'':_.escape(__t))+\n'\"\\n    ';\n } \n__p+='\\n    class=\"CDB-IconFont CDB-IconFont-wifi DatasetsList-itemStatus is-'+\n((__t=( syncStatus ))==null?'':_.escape(__t))+\n'\"></i>\\n  ';\n } \n__p+='\\n</div>\\n<div class=\"ModalDataset-itemInfo\">\\n  <div class=\"ModalDataset-itemInfoTitle\">\\n    <h3 class=\"CDB-Text CDB-Size-large u-bSpace u-ellipsis\">\\n      '+\n((__t=( title ))==null?'':_.escape(__t))+\n'\\n      ';\n if (showPermissionIndicator) { \n__p+='\\n        <span class=\"Tag Tag--outline Tag-outline--grey CDB-Text CDB-Size-small u-upperCase\">\\n          '+\n((__t=( _t('components.modals.add-layer.datasets.item.read') ))==null?'':_.escape(__t))+\n'\\n        </span>\\n      ';\n } \n__p+='\\n    </h3>\\n    ';\n if (description && description.length > 0) { \n__p+='\\n      <p class=\"u-ellipsis CDB-Text CDB-Size-medium u-altTextColor\" title=\"'+\n((__t=( description ))==null?'':_.escape(__t))+\n'\">'+\n((__t=( description ))==null?'':_.escape(__t))+\n'</p>\\n    ';\n } else { \n__p+='\\n      <span class=\"NoResults CDB-Text CDB-Size-medium\">'+\n((__t=( _t('components.modals.add-layer.datasets.item.no-description') ))==null?'':_.escape(__t))+\n'</span>\\n    ';\n } \n__p+='\\n  </div>\\n  <div>\\n    <div class=\"DatasetsList-itemMeta\">\\n\\n      <span class=\"CDB-Tag is-'+\n((__t=( privacy ))==null?'':_.escape(__t))+\n' CDB-Text is-semibold CDB-Size-small u-upperCase\">\\n        '+\n((__t=( privacy ))==null?'':_.escape(__t))+\n'\\n      </span>\\n      ';\n if (rowCount) { \n__p+='\\n        <span class=\"RowsIndicator\">\\n          <span class=\"CDB-Text CDB-Size-small u-altTextColor\">'+\n((__t=( rowCountFormatted ))==null?'':_.escape(__t))+\n' '+\n((__t=( _t('components.modals.add-layer.datasets.item.rows-pluralize', { smart_count: rowCount }) ))==null?'':_.escape(__t))+\n'</span>\\n        </span>\\n      ';\n } \n__p+='\\n      ';\n if (datasetSize) { \n__p+='\\n        <span class=\"SizeIndicator\">\\n          <span class=\"CDB-Text CDB-Size-small u-altTextColor\">'+\n((__t=( datasetSize ))==null?'':_.escape(__t))+\n'</span>\\n        </span>\\n      ';\n } \n__p+='\\n      <span class=\"DatasetsList-itemTimeDiff DefaultTimeDiff\">\\n        <span class=\"CDB-Text CDB-Size-small u-altTextColor\">'+\n((__t=( timeDiff ))==null?'':_.escape(__t))+\n'</span>\\n        ';\n if (!isOwner) { \n__p+='\\n          <span class=\"CDB-Text CDB-Size-small u-altTextColor u-lSpace--xl u-rSpace\">\\n            '+\n((__t=( _t('components.modals.add-layer.datasets.item.by') ))==null?'':_.escape(__t))+\n'\\n          </span>\\n          <span class=\"DatasetsList-avatar\">\\n            <img class=\"DatasetsList-avatarImg\" src=\"'+\n((__t=( owner.avatar_url ))==null?'':_.escape(__t))+\n'\" alt=\"'+\n((__t=( owner.name || owner.username ))==null?'':_.escape(__t))+\n'\" title=\"'+\n((__t=( owner.name || owner.username ))==null?'':_.escape(__t))+\n'\" />\\n          </span>\\n        ';\n } \n__p+='\\n      </span>\\n    </div>\\n    <div class=\"DatasetsList-itemMeta DatasetsList-itemTags\">\\n      ';\n if (tagsCount > 0) { \n__p+='\\n        <div class=\"DefaultTags CDB-Text CDB-Size-small\">\\n          ';\n for (var i = 0, l = Math.min(maxTagsToShow, tags.length); i < l; ++i) { \n__p+='\\n            <button class=\"CDB-Text CDB-Size-small u-upperCase DefaultTags-item js-tag-link u-actionTextColor\" value=\"'+\n((__t=( tags[i] ))==null?'':_.escape(__t))+\n'\">'+\n((__t=( tags[i] ))==null?'':_.escape(__t))+\n'</button>';\n if (i !== (l-1)) { \n__p+='';\n } \n__p+='\\n          ';\n } \n__p+='\\n          ';\n if (tagsCount > maxTagsToShow) { \n__p+='\\n            '+\n((__t=( _t('components.modals.add-layer.datasets.item.tags-more', { tagsCount: tagsCount - maxTagsToShow }) ))==null?'':_.escape(__t))+\n'\\n          ';\n } \n__p+='\\n        </div>\\n      ';\n } else { \n__p+='\\n        <span class=\"NoResults CDB-Text CDB-Size-small u-altTextColor\">'+\n((__t=( _t('components.modals.add-layer.datasets.item.no-tags') ))==null?'':_.escape(__t))+\n'</span>\\n      ';\n } \n__p+='\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"IntermediateInfo\">\\n  <div class=\"LayoutIcon LayoutIcon--negative\">\\n    <i class=\"CDB-IconFont CDB-IconFont-cockroach\"></i>\\n  </div>\\n  <h4 class=\"CDB-Text CDB-Size-large u-mainTextColor u-secondaryTextColor u-bSpace--m\">\\n    '+\n((__t=( _t('components.modals.add-layer.datasets.error.title') ))==null?'':_.escape(__t))+\n'\\n  </h4>\\n  <p class=\"CDB-Text CDB-Size-medium u-altTextColor\">'+\n((__t=( _t('components.modals.add-layer.datasets.error.desc') ))==null?'':_.escape(__t))+\n' <a class=\"js-mail-link\" href=\"mailto:support@carto.com\">support@carto.com</a>.</p>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar DATASETS_ITEMS = {\n  'datasets': require('./dataset-item-view'),\n  'remotes': require('./remote-dataset-item-view')\n};\n\n/**\n * View representing the list of datasets\n */\nmodule.exports = CoreView.extend({\n\n  tagName: 'ul',\n  className: 'DatasetsList',\n\n  initialize: function (opts) {\n    if (!opts.createModel) throw new Error('createModel is required');\n    if (!opts.userModel) throw new Error('userModel is required');\n\n    this._createModel = opts.createModel;\n    this._userModel = opts.userModel;\n    this._tablesCollection = this._createModel.getTablesCollection();\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this._tablesCollection.each(this._addItem, this);\n    return this;\n  },\n\n  _initBinds: function () {\n    this._tablesCollection.bind('sync', this.render, this);\n    this.add_related_model(this._tablesCollection);\n  },\n\n  _addItem: function (m, i) {\n    var type = m.get('type') === 'remote' ? 'remotes' : 'datasets';\n\n    var item = new DATASETS_ITEMS[type]({\n      model: m,\n      createModel: this._createModel,\n      userModel: this._userModel\n    });\n\n    this.addView(item);\n    this.$el.append(item.render().el);\n  },\n\n  show: function () {\n    this.$el.removeClass('is-hidden');\n  },\n\n  hide: function () {\n    this.$el.addClass('is-hidden');\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"IntermediateInfo\">\\n  <div class=\"CDB-LoaderIcon CDB-LoaderIcon--big is-dark js-loader\">\\n    <svg class=\"CDB-LoaderIcon-spinner\" viewbox=\"0 0 50 50\">\\n      <circle class=\"CDB-LoaderIcon-path\" cx=\"25\" cy=\"25\" r=\"20\" fill=\"none\"/>\\n    </svg>\\n  </div>\\n  <h4 class=\"CDB-Text CDB-Size-large u-mainTextColor u-bSpace u-secondaryTextColor u-tSpace-xl\">\\n    '+\n((__t=( _t('components.modals.add-layer.datasets.' + (q || tag  ? 'searching' : 'loading')) ))==null?'':_.escape(__t))+\n'...\\n  </h4>\\n  <div class=\"CDB-Text CDB-Size-medium u-altTextColor\">'+\n((__t=( quote ))==null?'':__t)+\n'</div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"IntermediateInfo\">\\n  <div class=\"LayoutIcon ';\n (q || tag) ? 'LayoutIcon--negative' : '' \n__p+='\">\\n    <i class=\"CDB-IconFont\\n      ';\n if (shared) { \n__p+=' CDB-IconFont-defaultUser\\n      ';\n } else if (locked) { \n__p+=' CDB-IconFont-lock\\n      ';\n } else if (library) { \n__p+=' CDB-IconFont-dribbble\\n      ';\n } else { \n__p+=' CDB-IconFont-lens ';\n } \n__p+='\" />\\n  </div>\\n  <h4 class=\"CDB-Text CDB-Size-large u-mainTextColor u-bSpace u-secondaryTextColor u-tSpace-xl\">\\n    ';\n if (page > 1 ||totalItems === 0 && totalEntries > 0) { \n__p+='\\n      '+\n((__t=( _t('components.modals.add-layer.datasets.no-results.desc') ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n\\n    ';\n if (( tag || q ) &&totalItems === 0 && totalEntries === 0) { \n__p+='\\n      0 '+\n((__t=( tag ||q ))==null?'':_.escape(__t))+\n' '+\n((__t=( type ))==null?'':_.escape(__t))+\n' '+\n((__t=( _t('components.modals.add-layer.datasets.no-results.found') ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n\\n    ';\n if (page === 1 && !tag && !q &&totalItems === 0 && totalEntries === 0) { \n__p+='\\n      '+\n((__t=( _t('components.modals.add-layer.datasets.no-results.there-are-no') ))==null?'':_.escape(__t))+\n' '+\n((__t=( shared === \"only\" ? 'shared' : '' ))==null?'':_.escape(__t))+\n' '+\n((__t=( locked ? 'locked' : '' ))==null?'':_.escape(__t))+\n' '+\n((__t=( library ? 'library' : '' ))==null?'':_.escape(__t))+\n' '+\n((__t=( type ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n  </h4>\\n  <p class=\"CDB-Text CDB-Size-medium u-altTextColor\">\\n    ';\n if (!tag && !q &&totalItems === 0 && totalEntries === 0) { \n__p+='\\n      '+\n((__t=( _t('components.modals.add-layer.datasets.no-results.no-fun', { type: type }) ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n  </p>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar PaginationModel = require('../../../../pagination/pagination-model');\nvar PaginationView = require('../../../../pagination/pagination-view');\n\n/**\n * Responsible for the datasets paginator\n *  ___________________________________________________________________________\n * |                                                                           |\n * |                                             Page 2 of 42 [1] 2 [3][4][5]  |\n * |___________________________________________________________________________|\n *\n */\n\nmodule.exports = CoreView.extend({\n  className: 'DatasetsPaginator',\n\n  initialize: function (opts) {\n    if (!opts.routerModel) throw new TypeError('routerModel is required');\n    if (!opts.tablesCollection) throw new TypeError('tablesCollection is required');\n\n    this._routerModel = opts.routerModel;\n    this._tablesCollection = opts.tablesCollection;\n\n    this.model = new PaginationModel({\n      current_page: this._routerModel.get('page')\n    });\n\n    this._initBinds();\n    this._initViews();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.append(this.paginationView.render().el);\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.bind('change', this.render, this);\n    this.model.bind('change:current_page', function () {\n      this._routerModel.set('page', this.model.get('current_page'));\n    }, this);\n    this._tablesCollection.bind('sync', this._updatePaginationModelByCollection, this);\n    this._routerModel.bind('change:page', this._updatePaginationModelByRouterModel, this);\n\n    this.add_related_model(this._routerModel);\n    this.add_related_model(this._tablesCollection);\n    this.add_related_model(this.model);\n  },\n\n  _initViews: function () {\n    this.paginationView = new PaginationView({\n      model: this.model\n    });\n    this.addView(this.paginationView);\n  },\n\n  _updatePaginationModelByCollection: function () {\n    this.model.set({\n      per_page: this._tablesCollection.getDefaultParam('per_page'),\n      total_count: this._tablesCollection.getTotalStat('total_entries')\n    });\n  },\n\n  _updatePaginationModelByRouterModel: function () {\n    this.model.set('current_page', this._routerModel.get('page'));\n  }\n\n});\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar ContentResultView = require('./content-result-view');\nvar DatasetsListView = require('./datasets-list-view');\nvar DatasetsPaginationView = require('./datasets-pagination-view');\nvar noResultsTemplate = require('./no-datasets.tpl');\nvar datasetsNoResultTemplate = require('./datasets-no-result.tpl');\nvar datasetsErrorTemplate = require('./datasets-error.tpl');\nvar datasetsLoaderTemplate = require('./datasets-loader.tpl');\n\n/**\n *  Datasets list view\n *\n *  Show datasets view to select them for\n *  creating a map or importing a dataset\n *\n */\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    if (!opts.createModel) throw new Error('createModel is required');\n    if (!opts.userModel) throw new Error('userModel is required');\n\n    this._createModel = opts.createModel;\n    this._userModel = opts.userModel;\n    this._routerModel = this._createModel.getVisualizationFetchModel();\n    this._tablesCollection = this._createModel.getTablesCollection();\n\n    this._initViews();\n    this._initBinds();\n    this._onDataLoading();\n  },\n\n  _initBinds: function () {\n    this._routerModel.bind('change', this._onRouterChange, this);\n    this._tablesCollection.bind('loading', this._onDataLoading, this);\n    this._tablesCollection.bind('sync', this._onDataFetched, this);\n    this._tablesCollection.bind('error', function (e) {\n      // Old requests can be stopped, so aborted requests are not\n      // considered as an error\n      if (!e || (e && e.statusText !== 'abort')) {\n        this._onDataError();\n      }\n    }, this);\n    this.add_related_model(this._routerModel);\n    this.add_related_model(this._tablesCollection);\n  },\n\n  _initViews: function () {\n    this.controlledViews = {}; // All available views\n    this.enabledViews = []; // Visible views\n\n    var noDatasetsView = new ContentResultView({\n      className: 'ContentResult no-datasets',\n      userModel: this._userModel,\n      routerModel: this._routerModel,\n      tablesCollection: this._tablesCollection,\n      template: noResultsTemplate\n    });\n    noDatasetsView.bind('connectDataset', function () {\n      if (this._userModel.canCreateDatasets()) {\n        this._createModel.set('listing', 'import');\n      }\n    }, this);\n    noDatasetsView.render().hide();\n    this.controlledViews['no_datasets'] = noDatasetsView;\n    this.$el.append(noDatasetsView.el);\n    this.addView(noDatasetsView);\n\n    var listView = new DatasetsListView({\n      userModel: this._userModel,\n      createModel: this._createModel\n    });\n    this.controlledViews.list = listView;\n    this.$el.append(listView.render().el);\n    this.addView(listView);\n\n    var noResultsView = new ContentResultView({\n      userModel: this._userModel,\n      routerModel: this._routerModel,\n      tablesCollection: this._tablesCollection,\n      template: datasetsNoResultTemplate\n    });\n    noResultsView.render().hide();\n    this.controlledViews.no_results = noResultsView;\n    this.$el.append(noResultsView.el);\n    this.addView(noResultsView);\n\n    var errorView = new ContentResultView({\n      userModel: this._userModel,\n      routerModel: this._routerModel,\n      tablesCollection: this._tablesCollection,\n      template: datasetsErrorTemplate\n    });\n    errorView.render().hide();\n    this.controlledViews.error = errorView;\n    this.$el.append(errorView.el);\n    this.addView(errorView);\n\n    var mainLoaderView = new ContentResultView({\n      userModel: this._userModel,\n      routerModel: this._routerModel,\n      tablesCollection: this._tablesCollection,\n      template: datasetsLoaderTemplate\n    });\n    this.controlledViews.main_loader = mainLoaderView;\n    this.$el.append(mainLoaderView.render().el);\n    this.addView(mainLoaderView);\n\n    var datasetsPaginationView = new DatasetsPaginationView({\n      routerModel: this._routerModel,\n      tablesCollection: this._tablesCollection\n    });\n    this.controlledViews.content_footer = datasetsPaginationView;\n    this.$el.append(datasetsPaginationView.render().el);\n    this.addView(datasetsPaginationView);\n  },\n\n  _onRouterChange: function () {\n    this._hideBlocks();\n    this._showBlocks([ 'main_loader' ]);\n  },\n\n  /**\n   * Arguments may vary, depending on if it's the collection or a model that triggers the event callback.\n   * @private\n   */\n  _onDataFetched: function () {\n    var activeViews = [ 'content_footer' ];\n    var tag = this._routerModel.get('tag');\n    var q = this._routerModel.get('q');\n    var shared = this._routerModel.get('shared');\n    var locked = this._routerModel.get('locked');\n    var library = this._routerModel.get('library');\n\n    if (library && this._tablesCollection.getTotalStat('total_user_entries') === 0) {\n      activeViews.push('no_datasets');\n    }\n\n    if (this._tablesCollection.size() === 0) {\n      if (!tag && !q && shared === 'no' && !locked) {\n        if (!library) {\n          this._goToLibrary();\n          return;\n        } else {\n          activeViews.push('no_results');\n        }\n      } else {\n        activeViews.push('no_results');\n      }\n    } else {\n      activeViews.push('list');\n    }\n\n    this._hideBlocks();\n    this._showBlocks(activeViews);\n  },\n\n  _onDataLoading: function () {\n    this._hideBlocks();\n    this._showBlocks([ 'main_loader' ]);\n  },\n\n  _onDataError: function (e) {\n    this._hideBlocks();\n    this._showBlocks([ 'error' ]);\n  },\n\n  _showBlocks: function (views) {\n    var self = this;\n    if (views) {\n      _.each(views, function (v) {\n        if (self.controlledViews[v]) {\n          self.controlledViews[v].show();\n          self.enabledViews.push(v);\n        }\n      });\n    } else {\n      self.enabledViews = [];\n      _.each(this.controlledViews, function (v) {\n        v.show();\n        self.enabledViews.push(v);\n      });\n    }\n  },\n\n  _goToLibrary: function () {\n    this._routerModel.set({\n      shared: 'no',\n      library: true,\n      page: 1\n    });\n  },\n\n  _hideBlocks: function (views) {\n    var self = this;\n    if (views) {\n      _.each(views, function (v) {\n        if (self.controlledViews[v]) {\n          self.controlledViews[v].hide();\n          self.enabledViews = _.without(self.enabledViews, v);\n        }\n      });\n    } else {\n      _.each(this.controlledViews, function (v) {\n        v.hide();\n      });\n      self.enabledViews = [];\n    }\n  },\n\n  _isBlockEnabled: function (name) {\n    if (name) {\n      return _.contains(this.enabledViews, name);\n    }\n    return false;\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<h4 class=\"CDB-Text CDB-Size-large u-mainTextColor u-secondaryTextColor u-bSpace--m u-tSpace-xl\">\\n  '+\n((__t=( _t('components.modals.add-layer.datasets.no-datasets.title') ))==null?'':_.escape(__t))+\n'\\n</h4>\\n<p class=\"CDB-Text CDB-Size-medium u-altTextColor\">\\n  ';\n var connectDatasetHTML = '<button class=\"Button--link js-connect\">' + _t('components.modals.add-layer.datasets.no-datasets.connect-datasets') + '</button>'; \n__p+='\\n  ';\n var searchHTML = '<strong>' + _t('components.modals.add-layer.datasets.no-datasets.search') + '</strong>'; \n__p+='\\n  '+\n((__t=( _t('components.modals.add-layer.datasets.no-datasets.desc', {\n      connectDataset: connectDatasetHTML,\n      search: searchHTML\n    }) ))==null?'':_.escape(__t))+\n'\\n</p>\\n<div class=\"NoDatasets-illustration\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var cdb = require('cartodb.js');\nvar $ = require('jquery');\nvar DatasetItem = require('./dataset-item-view');\nvar moment = require('moment');\nvar markdown = require('markdown');\nvar Utils = require('../../../../../helpers/utils');\nvar TipsyTooltipView = require('../../../../tipsy-tooltip-view');\nvar UploadConfig = require('../../../../../config/upload-config');\nvar template = require('./remote-dataset-item.tpl');\n\n/**\n *  Remote dataset item view\n *\n */\n\nmodule.exports = DatasetItem.extend({\n  tagName: 'li',\n  className: 'ModalBlockList-item ModalBlockList-item--full',\n\n  events: {\n    'click .js-tag-link': '_onTagClick',\n    'click': '_toggleSelected'\n  },\n\n  render: function () {\n    var tableModel = this.model.getTableModel();\n    var tags = this.model.get('tags') || [];\n    var description = cdb.core.sanitize.html(this.model.get('description') || '');\n    var source = markdown.toHTML(this.model.get('source') || '');\n    var tableGeomColumnTypes = tableModel.getGeometryType() || [];\n\n    var d = {\n      isRaster: this.model.isRaster(),\n      geometryType: tableGeomColumnTypes.length > 0 ? tableGeomColumnTypes[0] : '',\n      title: this.model.get('display_name') || this.model.get('name'),\n      source: source,\n      description: description,\n      timeDiff: moment(this.model.get('updated_at')).fromNow(),\n      tags: tags,\n      tagsCount: tags.length,\n      routerModel: this._routerModel,\n      maxTagsToShow: 3,\n      canImportDataset: this._canImportDataset(),\n      rowCount: undefined,\n      datasetSize: undefined\n    };\n\n    var rowCount = tableModel.get('row_count');\n    if (rowCount >= 0) {\n      d.rowCount = rowCount;\n      d.rowCountFormatted = (rowCount < 10000 ? Utils.formatNumber(rowCount) : Utils.readizableNumber(rowCount));\n    }\n\n    var datasetSize = tableModel.get('size');\n    if (datasetSize >= 0) {\n      d.datasetSize = Utils.readablizeBytes(\n        datasetSize,\n        datasetSize.toString().length > 9\n      );\n    }\n\n    this.$el.html(template(d));\n    this._setItemClasses();\n    this._renderTooltips();\n\n    return this;\n  },\n\n  _setItemClasses: function () {\n    // Item selected?\n    this.$el.toggleClass('is-selected', !!this.model.get('selected'));\n    // Check if it is selectable\n    this.$el.toggleClass('is-selectable', !!this._canImportDataset());\n    // Check if it is importable\n    this.$el.toggleClass('is-banned', !this._canImportDataset());\n  },\n\n  _renderTooltips: function () {\n    this.addView(\n      new TipsyTooltipView({\n        el: this.$('.DatasetsList-itemStatus'),\n        title: function (e) {\n          return $(this).attr('data-title');\n        }\n      })\n    );\n  },\n\n  _onTagClick: function (ev) {\n    if (ev) {\n      this.killEvent(ev);\n    }\n\n    var tag = $(ev.target).val();\n\n    if (tag) {\n      this._routerModel.set({\n        tag: tag,\n        library: true\n      });\n    }\n  },\n\n  _canImportDataset: function () {\n    var tableModel = this.model.getTableModel();\n    var tableSize = tableModel.get('size') || 0;\n    return (\n      this._userModel.get('remaining_byte_quota') * UploadConfig.fileTimesBigger >= tableSize &&\n      this._userModel.get('limits')['import_file_size'] > tableSize\n    );\n  },\n\n  _toggleSelected: function (ev) {\n    // Let links use default behaviour\n    if (ev.target.tagName !== 'A') {\n      this.killEvent(ev);\n      if (this._canImportDataset() && this._createModel.canSelect(this.model)) {\n        this.model.set('selected', !this.model.get('selected'));\n      }\n    }\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"DatasetsList-itemCategory is--'+\n((__t=( isRaster ? 'raster' : geometryType ))==null?'':_.escape(__t))+\n'Dataset\">\\n  <i data-title=\"Public dataset\" class=\"CDB-IconFont CDB-IconFont-book DatasetsList-itemStatus '+\n((__t=( canImportDataset ? 'is-public' : 'is-banned' ))==null?'':_.escape(__t))+\n'\"></i>\\n</div>\\n<div class=\"ModalDataset-itemInfo\">\\n  <div class=\"ModalDataset-itemInfoTitle\">\\n    <h3 class=\"CDB-Text CDB-Size-large u-bSpace u-ellipsis\">'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</h3>\\n    ';\n if (description && description.length > 0) { \n__p+='\\n      <p class=\"u-ellipsis CDB-Text CDB-Size-medium u-altTextColor\" title=\"'+\n((__t=( description ))==null?'':_.escape(__t))+\n'\">'+\n((__t=( description ))==null?'':_.escape(__t))+\n'</p>\\n    ';\n } else { \n__p+='\\n      <span class=\"NoResults CDB-Text CDB-Size-medium\">'+\n((__t=( _t('components.modals.add-layer.datasets.item.no-description')))==null?'':_.escape(__t))+\n'</span>\\n    ';\n } \n__p+='\\n  </div>\\n  <div>\\n    <ul class=\"DatasetsList-itemMeta CDB-Text CDB-Size-small u-altTextColor\">\\n      ';\n if (rowCount) { \n__p+='\\n        <li class=\"RowsIndicator\">\\n          '+\n((__t=( rowCountFormatted ))==null?'':_.escape(__t))+\n' '+\n((__t=( _t('components.modals.add-layer.datasets.item.rows-pluralize', { smart_count: rowCount }) ))==null?'':_.escape(__t))+\n'\\n        </li>\\n      ';\n } \n__p+='\\n      ';\n if (datasetSize) { \n__p+='\\n        <li class=\"SizeIndicator\">\\n          '+\n((__t=( datasetSize ))==null?'':_.escape(__t))+\n'\\n        </li>\\n      ';\n } \n__p+='\\n      <li class=\"DatasetsList-itemTimeDiff DefaultTimeDiff CDB-Text CDB-Size-small u-altTextColor\">\\n        '+\n((__t=( timeDiff ))==null?'':_.escape(__t))+\n' <span class=\"DatasetsList-itemSource js-source\">';\n if (source) { \n__p+=''+\n((__t=( _t('components.modals.add-layer.datasets.item.from') ))==null?'':_.escape(__t))+\n' '+\n((__t=( cdb.core.sanitize.html(source) ))==null?'':__t)+\n'';\n } \n__p+='</span>\\n      </li>\\n    </ul>\\n    <div class=\"DatasetsList-itemMeta DatasetsList-itemTags\">\\n      ';\n if (tagsCount > 0) { \n__p+='\\n        <div class=\"DefaultTags CDB-Text CDB-Size-small\">\\n          ';\n for (var i = 0, l = Math.min(maxTagsToShow, tags.length); i < l; ++i) { \n__p+='\\n            <button class=\"CDB-Text CDB-Size-small u-upperCase DefaultTags-item js-tag-link u-actionTextColor\" value=\"'+\n((__t=( tags[i] ))==null?'':_.escape(__t))+\n'\">'+\n((__t=( tags[i] ))==null?'':_.escape(__t))+\n'</button>';\n if (i !== (l-1)) { \n__p+='';\n } \n__p+='\\n          ';\n } \n__p+='\\n          ';\n if (tagsCount > maxTagsToShow) { \n__p+='\\n            '+\n((__t=( _t('components.modals.add-layer.datasets.item.tags-more', { tagsCount: tagsCount - maxTagsToShow }) ))==null?'':_.escape(__t))+\n'\\n          ';\n } \n__p+='\\n        </div>\\n      ';\n } else { \n__p+='\\n        <span class=\"NoResults CDB-Text CDB-Size-small u-altTextColor\">'+\n((__t=( _t('components.modals.add-layer.datasets.item.no-tags') ))==null?'':_.escape(__t))+\n'</span>\\n      ';\n } \n__p+='\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"ImportPanel-header\">\\n  <div class=\"LayoutIcon u-bSpace--xl\">\\n    <i class=\"CDB-IconFont CDB-IconFont-gift\"></i>\\n  </div>\\n  <h3 class=\"CDB-Text CDB-Size-large u-mainTextColor u-secondaryTextColor u-bSpace--m\">ArcGIS<sup>&trade;</sup> '+\n((__t=( _t('components.modals.add-layer.imports.connector') ))==null?'':_.escape(__t))+\n'</h3>\\n  <p class=\"CDB-Text CDB-Size-medium u-altTextColor u-bSpace--xl\">\\n    '+\n((__t=( _t('components.modals.add-layer.imports.arcgis.fallback-desc', {\n      brand: 'ArcGIS<sup>&trade;</sup>'\n    }) ))==null?'':__t)+\n'\\n  </p>\\n  <a href=\"mailto:sales@carto.com?subject='+\n((__t=( _t('components.modals.add-layer.imports.demo-email-title', { name: 'ArcGIS' }) ))==null?'':_.escape(__t))+\n'&body='+\n((__t=( _t('components.modals.add-layer.imports.demo-email-desc', { name: 'ArcGIS' }) ))==null?'':_.escape(__t))+\n'\" class=\"CDB-Button CDB-Button--primary CDB-Button--medium\">\\n    <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">'+\n((__t=( _t('components.modals.add-layer.imports.ask-for-demo') ))==null?'':_.escape(__t))+\n'</span>\\n  </a>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"ImportPanel-header\">\\n  <div class=\"LayoutIcon u-bSpace--xl\">\\n    <i class=\"CDB-IconFont CDB-IconFont-gift\"></i>\\n  </div>\\n  <h3 class=\"CDB-Text CDB-Size-large u-mainTextColor u-secondaryTextColor u-bSpace--m\">Box '+\n((__t=( _t('components.modals.add-layer.imports.connector') ))==null?'':_.escape(__t))+\n'</h3>\\n  <p class=\"CDB-Text CDB-Size-medium u-altTextColor u-bSpace--xl\">\\n    '+\n((__t=( _t('components.modals.add-layer.imports.box.fallback-desc', { brand: 'Box' }) ))==null?'':_.escape(__t))+\n'\\n  </p>\\n  <a href=\"mailto:sales@carto.com?subject='+\n((__t=( _t('components.modals.add-layer.imports.demo-email-title', { name: 'Box' }) ))==null?'':_.escape(__t))+\n'&body='+\n((__t=( _t('components.modals.add-layer.imports.demo-email-desc', { name: 'Box' }) ))==null?'':_.escape(__t))+\n'\" class=\"CDB-Button CDB-Button--primary CDB-Button--medium\">\\n    <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">'+\n((__t=( _t('components.modals.add-layer.imports.ask-for-demo') ))==null?'':_.escape(__t))+\n'</span>\\n  </a>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"ImportPanel-header\">\\n  <div class=\"LayoutIcon u-bSpace--xl\">\\n    <i class=\"CDB-IconFont CDB-IconFont-gift\"></i>\\n  </div>\\n  <h3 class=\"CDB-Text CDB-Size-large u-mainTextColor u-secondaryTextColor u-bSpace--m\">MailChimp '+\n((__t=( _t('components.modals.add-layer.imports.connector') ))==null?'':_.escape(__t))+\n'</h3>\\n  <p class=\"CDB-Text CDB-Size-medium u-altTextColor u-bSpace--xl\">'+\n((__t=( _t('components.modals.add-layer.imports.mailchimp.fallback-desc', { brand: 'Mailchimp' }) ))==null?'':_.escape(__t))+\n'</p>\\n  <a href=\"mailto:sales@carto.com?subject='+\n((__t=( _t('components.modals.add-layer.imports.demo-email-title', { name: 'MailChimp' }) ))==null?'':_.escape(__t))+\n'&body='+\n((__t=( _t('components.modals.add-layer.imports.demo-email-desc', { name: 'MailChimp' }) ))==null?'':_.escape(__t))+\n'\" class=\"CDB-Button CDB-Button--primary CDB-Button--medium\">\\n    <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">'+\n((__t=( _t('components.modals.add-layer.imports.ask-for-demo') ))==null?'':_.escape(__t))+\n'</span>\\n  </a>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"ImportPanel-header\">\\n  <div class=\"LayoutIcon u-bSpace--xl\">\\n    <i class=\"CDB-IconFont CDB-IconFont-gift\"></i>\\n  </div>\\n  <h3 class=\"CDB-Text CDB-Size-large u-mainTextColor u-secondaryTextColor u-bSpace--m\">Salesforce '+\n((__t=( _t('components.modals.add-layer.imports.connector') ))==null?'':_.escape(__t))+\n'</h3>\\n  <p class=\"CDB-Text CDB-Size-medium u-altTextColor u-bSpace--xl\">\\n    '+\n((__t=( _t('components.modals.add-layer.imports.salesforce.fallback-desc', { brand: 'Salesforce' }) ))==null?'':_.escape(__t))+\n'\\n  </p>\\n  <a href=\"mailto:sales@carto.com?subject='+\n((__t=( _t('components.modals.add-layer.imports.demo-email-title', { name: 'Salesforce' }) ))==null?'':_.escape(__t))+\n'&body='+\n((__t=( _t('components.modals.add-layer.imports.demo-email-desc', { name: 'Salesforce' }) ))==null?'':_.escape(__t))+\n'\" class=\"CDB-Button CDB-Button--primary CDB-Button--medium\">\\n    <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">'+\n((__t=( _t('components.modals.add-layer.imports.ask-for-demo') ))==null?'':_.escape(__t))+\n'</span>\\n  </a>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"ImportPanel-header\">\\n  <div class=\"LayoutIcon u-bSpace--xl\">\\n    <i class=\"CDB-IconFont CDB-IconFont-gift\"></i>\\n  </div>\\n  <h3 class=\"CDB-Text CDB-Size-large u-mainTextColor u-secondaryTextColor u-bSpace--m\">'+\n((__t=( _t('components.modals.add-layer.imports.twitter.fallback-title', { brand: 'Twitter' }) ))==null?'':_.escape(__t))+\n'</h3>\\n  <p class=\"CDB-Text CDB-Size-medium u-altTextColor u-bSpace--xl\">\\n    '+\n((__t=( _t('components.modals.add-layer.imports.twitter.fallback-desc', { brand: 'Twitter' }) ))==null?'':_.escape(__t))+\n'\\n  </p>\\n  <a href=\"mailto:sales@carto.com?subject='+\n((__t=( _t('components.modals.add-layer.imports.demo-email-title', { name: 'Twitter' }) ))==null?'':_.escape(__t))+\n'&body='+\n((__t=( _t('components.modals.add-layer.imports.demo-email-desc', { name: 'Twitter' }) ))==null?'':_.escape(__t))+\n'\" class=\"CDB-Button CDB-Button--primary CDB-Button--medium\">\\n    <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">ask for a demo</span>\\n  </a>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<form class=\"Form js-form\">\\n  <div class=\"Form-row\">\\n    <div class=\"Form-rowLabel\">\\n      <label class=\"CDB-Text CDB-Size-medium\">'+\n((__t=( _t('components.modals.add-layer.imports.form-import.title') ))==null?'':_.escape(__t))+\n'</label>\\n    </div>\\n    <div class=\"Form-rowData Form-rowData--longer\">\\n      <input type=\"text\" class=\"CDB-Text CDB-Size-medium Form-input Form-input--longer has-submit js-textInput\" value=\"\" placeholder=\"'+\n((__t=( _t('components.modals.add-layer.imports.arcgis.input-placeholder', { brand: 'ArcGIS Server&trade;' }) ))==null?'':__t)+\n'\" />\\n      <button type=\"submit\" class=\"CDB-Text CDB-Size-small Form-inputSubmit u-upperCase u-actionTextColor Form-inputSubmit\">\\n        <span>'+\n((__t=( _t('components.modals.add-layer.imports.form-import.submit') ))==null?'':_.escape(__t))+\n'</span>\\n      </button>\\n      <div class=\"Form-inputError CDB-Text\">'+\n((__t=( _t('components.modals.add-layer.imports.form-import.error-desc') ))==null?'':_.escape(__t))+\n'</div>\\n    </div>\\n  </div>\\n  <div class=\"Form-row\">\\n    <div class=\"Form-rowLabel\"></div>\\n    <div class=\"Form-rowData Form-rowData--longer\">\\n      <p class=\"CDB-Text CDB-Size-small Form-rowInfoText--centered Form-rowInfoText--block u-altTextColor\">\\n        '+\n((__t=( _t('components.modals.add-layer.imports.form-import.format') ))==null?'':_.escape(__t))+\n': http://&#60;host&#62;/arcgis/rest/services/&#60;folder&#62;/&#60;serviceName&#62;/&#60;serviceType&#62;<br/>\\n        '+\n((__t=( _t('components.modals.add-layer.imports.arcgis.url-desc') ))==null?'':_.escape(__t))+\n'\\n      </p>\\n    </div>\\n  </div>\\n</form>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<h3 class=\"CDB-Text CDB-Size-large u-mainTextColor u-secondaryTextColor u-bSpace--m\">\\n  ';\n if (state === 'selected') { \n__p+='\\n    '+\n((__t=( _t('components.modals.add-layer.imports.header-import.type-selected', { brand: 'ArcGIS<sup>&trade;</sup>' }) ))==null?'':__t)+\n'\\n  ';\n } else { \n__p+='\\n    '+\n((__t=( _t('components.modals.add-layer.imports.header-import.type-import', { brand: 'ArcGIS<sup>&trade;</sup>' }) ))==null?'':__t)+\n'\\n  ';\n } \n__p+='\\n</h3>\\n<p class=\"CDB-Text CDB-Size-medium u-altTextColor\">\\n  ';\n if (state !== \"selected\") { \n__p+='\\n    '+\n((__t=( _t('components.modals.add-layer.imports.arcgis.import-data', { brand: 'ArcGIS<sup>&trade;</sup>' }) ))==null?'':__t)+\n'\\n  ';\n } else { \n__p+='\\n    '+\n((__t=( _t('components.modals.add-layer.imports.arcgis.sync-options') ))==null?'':_.escape(__t))+\n'\\n  ';\n } \n__p+='\\n</p>\\n';\n if (state === \"selected\") { \n__p+='\\n  <button class=\"NavButton NavButton--back ImportPanel-headerButton js-back\">\\n    <i class=\"CDB-IconFont CDB-IconFont-arrowPrev\"></i>\\n  </button>\\n';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var Utils = require('../../../../../../helpers/utils');\nvar SelectedDatasetView = require('../import-selected-dataset-view');\nvar template = require('../import-selected-dataset.tpl');\n\n/**\n *  Selected ArcGIS dataset\n *\n *  - Displays the result when an ArcGIS url/dataset is selected, no matter the type.\n *  - It will show available sync options if user can and the url is an ArcGIS layer.\n *  - Upgrade link for people who don't have sync permissions.\n *\n */\n\nmodule.exports = SelectedDatasetView.extend({\n  render: function () {\n    var title = this.options.fileAttrs.title && this.model.get('value')[this.options.fileAttrs.title] || this.model.get('value');\n    var description = this._genDescription();\n    var ext = this.options.fileAttrs.ext ? Utils.getFileExtension(title) : '';\n\n    if (this.options.fileAttrs.ext) {\n      title = title && title.replace('.' + ext, '');\n    }\n\n    var upgradeUrl = window.upgrade_url;\n    var userCanSync = this._userModel.isActionEnabled('sync_tables');\n    var customInstall = this._configModel.get('cartodb_com_hosted');\n\n    this.$el.html(\n      template({\n        title: title,\n        description: description,\n        ext: ext,\n        interval: this.model.get('interval'),\n        importCanSync: this.options.acceptSync && this._isArcGISLayer(title),\n        userCanSync: userCanSync,\n        showTrial: this._userModel.canStartTrial(),\n        showUpgrade: !userCanSync && !customInstall && upgradeUrl && !this._userModel.isInsideOrg(),\n        upgradeUrl: upgradeUrl\n      })\n    );\n    return this;\n  },\n\n  _isArcGISLayer: function (url) {\n    return url.search(/([0-9]+\\/|[0-9]+)/) !== -1;\n  }\n\n});\n",
    "var FormView = require('../import-data/import-data-form-view');\nvar HeaderView = require('../import-data/import-data-header-view');\nvar SelectedDatasetView = require('./import-arcgis-selected-dataset-view');\nvar ImportDataView = require('../import-data/import-data-view');\nvar headerTemplate = require('./import-arcgis-header.tpl');\nvar formTemplate = require('./import-arcgis-form.tpl');\n\n/**\n *  Import ArcGIS panel\n *\n *  - It only accepts an url, and it could be a map or a layer.\n *\n */\n\nmodule.exports = ImportDataView.extend({\n  options: {\n    fileExtensions: [],\n    type: 'service',\n    service: 'arcgis',\n    acceptSync: true,\n    fileEnabled: false,\n    fileAttrs: {\n      ext: false,\n      title: '',\n      description: ''\n    }\n  },\n\n  _initViews: function () {\n    var headerView = new HeaderView({\n      el: this.$('.ImportPanel-header'),\n      model: this.model,\n      userModel: this._userModel,\n      collection: this.collection,\n      fileEnabled: this.options.fileEnabled,\n      acceptSync: this.options.acceptSync,\n      template: headerTemplate\n    });\n    headerView.render();\n    this.addView(headerView);\n\n    var selected = new SelectedDatasetView({\n      el: this.$('.DatasetSelected'),\n      userModel: this._userModel,\n      model: this.model,\n      acceptSync: this.options.acceptSync,\n      fileAttrs: this.options.fileAttrs,\n      configModel: this._configModel\n    });\n    selected.render();\n    this.addView(selected);\n\n    var formView = new FormView({\n      el: this.$('.ImportPanel-form'),\n      userModel: this._userModel,\n      model: this.model,\n      template: formTemplate,\n      fileEnabled: this.options.fileEnabled\n    });\n\n    formView.render();\n    this.addView(formView);\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar $ = require('jquery');\nrequire('dragster');\nvar Dropzone = require('dropzone');\nvar template = require('./import-data-form.tpl');\n\n/**\n *  Form view for url import for example\n *\n *  - It accepts an url\n *  - It checks if it is valid\n *  - It could have a file option\n *\n */\n\nmodule.exports = CoreView.extend({\n  options: {\n    template: '',\n    fileEnabled: false\n  },\n\n  events: {\n    'keyup .js-textInput': '_onTextChanged',\n    'submit .js-form': '_onSubmitForm'\n  },\n\n  initialize: function (opts) {\n    if (!opts.userModel) throw new Error('userModel is required');\n\n    this._userModel = opts.userModel;\n    this.template = opts.template || template;\n    this._initBinds();\n    this._checkVisibility();\n  },\n\n  render: function () {\n    this.$el.html(\n      this.template(this.options)\n    );\n    this._initViews();\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:state', this._checkVisibility, this);\n  },\n\n  _initViews: function () {\n    if (this.options.fileEnabled) {\n      var self = this;\n      this.$('.js-fileInput').bind('change', function (e) {\n        if (this.files && this.files.length > 0) {\n          self._onFileChanged(this.files);\n        }\n        this.value = '';\n      });\n\n      this._initDropzone();\n    }\n  },\n\n  _initDropzone: function () {\n    var el = $('html')[0]; // :(\n    var self = this;\n\n    this.dragster = new Dragster(el); // eslint-disable-line\n\n    $(el).bind('dragster:enter', function (e) {\n      self._showDropzone();\n    });\n\n    $(el).bind('dragster:leave', function (e) {\n      self._hideDropzone();\n    });\n\n    if (el.dropzone) { // avoid loading the dropzone twice\n      return;\n    }\n\n    this.dropzone = new Dropzone(el, {\n      url: ':)',\n      autoProcessQueue: false,\n      previewsContainer: false\n    });\n\n    this.dropzone.on('dragover', function () {\n      self._showDropzone();\n    });\n\n    this.dropzone.on('drop', function (ev) {\n      var files = ev.dataTransfer.files;\n      self._onFileChanged(files);\n      self._hideDropzone();\n    });\n  },\n\n  _destroyDropzone: function () {\n    var el = $('html')[0]; // :(\n\n    if (this.dragster) {\n      this.dragster.removeListeners();\n      this.dragster.reset();\n      $(el).unbind('dragster:enter dragster:leave');\n    }\n\n    if (this.dropzone) {\n      this.dropzone.destroy();\n    }\n  },\n\n  _setValidFileExtensions: function (list) {\n    return RegExp('(\\.|\\/)(' + list.join('|') + ')$', 'i');\n  },\n\n  _onTextChanged: function () {\n    var value = this.$('.js-textInput').val();\n    if (!value) {\n      this._hideTextError();\n    }\n  },\n\n  _onFileChanged: function (files) {\n    this.trigger('fileSelected', this);\n\n    if (files && files.length === 1) {\n      files = files[0];\n    }\n\n    this.model.setUpload({\n      type: 'file',\n      value: files\n    });\n\n    if (this.model.get('state') !== 'error') {\n      this._hideFileError();\n      this.model.set('state', 'selected');\n    } else {\n      this._showFileError();\n    }\n  },\n\n  _showTextError: function () {\n    this.$('.Form-inputError').addClass('is-visible');\n  },\n\n  _hideTextError: function () {\n    this.$('.Form-inputError').removeClass('is-visible');\n  },\n\n  _showDropzone: function () {\n    this.$('.Form-upload').addClass('is-dropping');\n    this._hideFileError();\n  },\n\n  _hideDropzone: function () {\n    this.$('.Form-upload').removeClass('is-dropping');\n  },\n\n  _showFileError: function () {\n    if (this.model.get('state') === 'error') {\n      this.$('.js-fileError')\n        .text(this.model.get('get_error_text').what_about)\n        .show();\n      this.$('.js-fileLabel').hide();\n      this.$('.js-fileButton').addClass('Button--negative');\n    }\n  },\n\n  _hideFileError: function () {\n    this.$('.js-fileError').hide();\n    this.$('.js-fileLabel').show();\n    this.$('.js-fileButton').removeClass('Button--negative');\n  },\n\n  _onSubmitForm: function (e) {\n    if (e) this.killEvent(e);\n\n    var value = this.$('.js-textInput').val();\n\n    if (!value) {\n      this._hideTextError();\n      return;\n    }\n\n    // Change file attributes :S\n    this.trigger('urlSelected', this);\n\n    // Change model\n    var importType = this.model.get('service_name') ? 'service' : 'url';\n    this.model.setUpload({\n      type: importType,\n      value: value,\n      service_item_id: value,\n      state: 'idle'\n    });\n\n    if (this.model.get('state') !== 'error') {\n      this._hideFileError();\n      this._hideTextError();\n      this.model.set('state', 'selected');\n    } else {\n      this._showTextError();\n    }\n  },\n\n  _checkVisibility: function () {\n    var state = this.model.get('state');\n    this[ state !== 'selected' ? 'show' : 'hide' ]();\n  },\n\n  clean: function () {\n    this._destroyDropzone();\n    this.$('.js-fileInput').unbind('change');\n    CoreView.prototype.clean.apply(this);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<form class=\"Form js-form\">\\n  <div class=\"Form-row Form-row--centered\">\\n    ';\n if (fileEnabled) { \n__p+='\\n      <div class=\"Form-rowData Form-rowData--med Form-rowData--noMargin js-dropzone\">\\n        <div class=\"Form-upload\">\\n          <label class=\"Form-fileLabel js-fileLabel CDB-Text CDB-Size-medium\">'+\n((__t=( _t('components.modals.add-layer.imports.form-import.drag-and-drop') ))==null?'':_.escape(__t))+\n'</label>\\n          <label class=\"Form-fileLabel Form-fileLabel--error CDB-Text CDB-Size-small js-fileError\"></label>\\n          <div class=\"Form-file\">\\n            <input type=\"file\" class=\"js-fileInput\" />\\n            <span class=\"CDB-Button CDB-Button--primary Form-fileButton CDB-Button-Text CDB-Text is-semibold CDB-Size-small u-upperCase js-fileButton\">\\n              '+\n((__t=( _t('components.modals.add-layer.imports.form-import.browse') ))==null?'':_.escape(__t))+\n'\\n            </span>\\n          </div>\\n        </div>\\n      </div>\\n      <span class=\"u-lSpace--xl u-rSpace--xl u-flex u-alignCenter CDB-Text CDB-Size-medium u-altTextColor\">'+\n((__t=( _t('components.modals.add-layer.imports.form-import.or') ))==null?'':_.escape(__t))+\n'</span>\\n    ';\n } \n__p+='\\n    <div class=\"Form-rowData Form-rowData--noMargin Form-rowData--med\">\\n      <input type=\"text\" class=\"Form-input Form-input--med has-submit js-textInput CDB-Text CDB-Size-medium\" value=\"\" placeholder=\"https://carto.com/data-library\" />\\n      <button type=\"submit\" class=\"CDB-Text CDB-Size-small Form-inputSubmit u-upperCase u-actionTextColor Form-inputSubmit\">\\n        <span>'+\n((__t=( _t('components.modals.add-layer.imports.form-import.submit') ))==null?'':_.escape(__t))+\n'</span>\\n      </button>\\n      <div class=\"Form-inputError CDB-Text\">'+\n((__t=( _t('components.modals.add-layer.imports.form-import.error-desc') ))==null?'':_.escape(__t))+\n'</div>\\n    </div>\\n  </div>\\n</form>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./import-data-header.tpl');\n\n/**\n *  Data header view\n *\n *  - It will change when upload state changes\n *  - Possibility to change state with a header button\n *\n */\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-back': '_goToStart'\n  },\n\n  options: {\n    fileEnabled: false,\n    acceptSync: false\n  },\n\n  initialize: function (opts) {\n    if (!opts.userModel) throw new Error('userModel is required');\n\n    this._userModel = opts.userModel;\n    this.template = opts.template || template;\n    this._initBinds();\n    this._checkVisibility();\n  },\n\n  render: function () {\n    var acceptSync = this.options.acceptSync && this._userModel.get('actions') && this._userModel.isActionEnabled('sync_tables') && this.model.get('type') !== 'file';\n\n    this.$el.html(\n      this.template({\n        type: this.model.get('type'),\n        fileEnabled: this.options.fileEnabled,\n        acceptSync: acceptSync,\n        state: this.model.get('state')\n      })\n    );\n    this._checkVisibility();\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:state', this.render, this);\n  },\n\n  _checkVisibility: function () {\n    this.show();\n  },\n\n  _goToStart: function () {\n    this.model.set('state', 'idle');\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<h3 class=\"CDB-Text CDB-Size-large u-mainTextColor u-secondaryTextColor u-bSpace--m\">\\n  ';\n if (state === 'selected') { \n__p+='\\n    '+\n((__t=( _t('components.modals.add-layer.imports.header-import.file-selected') ))==null?'':_.escape(__t))+\n'\\n  ';\n } else { \n__p+='\\n    '+\n((__t=( _t('components.modals.add-layer.imports.header-import.upload-file-url', { smart_count: fileEnabled ? 1 : 0 }) ))==null?'':_.escape(__t))+\n'\\n  ';\n } \n__p+='\\n</h3>\\n<p class=\"CDB-Text CDB-Size-medium u-altTextColor\">\\n  ';\n if (state !== \"selected\") { \n__p+='\\n    ';\n fileEnabledText = _t('components.modals.add-layer.imports.header-import.select-a-file') +\n      ' <a href=\"https://carto.com/docs/carto-engine/import-api/importing-geospatial-data/#supported-geospatial-data-formats\">' +\n      _t('components.modals.add-layer.imports.header-import.see-all-formats') +\n      '</a>'\n    \n__p+='\\n    '+\n((__t=( _t('components.modals.add-layer.imports.header-import.paste-url', {\n      fileEnabled: fileEnabled ? fileEnabledText : ''\n    }) ))==null?'':__t)+\n'\\n  ';\n } \n__p+='\\n  ';\n if (state === \"selected\") { \n__p+='\\n    ';\n if (acceptSync) { \n__p+='\\n      '+\n((__t=( _t('components.modals.add-layer.imports.header-import.sync-enabled') ))==null?'':_.escape(__t))+\n'\\n    ';\n } else { \n__p+='\\n      '+\n((__t=( _t('components.modals.add-layer.imports.header-import.sync-disabled') ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n  ';\n } \n__p+='\\n</p>\\n';\n if (state === \"selected\") { \n__p+='\\n  <button class=\"NavButton NavButton--back ImportPanel-headerButton js-back\">\\n    <i class=\"CDB-IconFont CDB-IconFont-arrowPrev\"></i>\\n  </button>\\n';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var ImportView = require('../import-view');\nvar UploadModel = require('../../../../../../data/upload-model');\nvar FormView = require('./import-data-form-view');\nvar HeaderView = require('./import-data-header-view');\nvar SelectedDatasetView = require('../import-selected-dataset-view');\nvar template = require('./import-data.tpl');\n\n/**\n *  Import data panel\n *\n *  - It accepts an url\n *  - It checks if it is valid\n *\n */\n\nmodule.exports = ImportView.extend({\n  options: {\n    fileExtensions: [],\n    type: 'url',\n    service: '',\n    acceptSync: false,\n    fileEnabled: false,\n    formTemplate: '',\n    headerTemplate: '',\n    fileAttrs: {}\n  },\n\n  className: 'ImportPanel ImportDataPanel',\n\n  initialize: function (opts) {\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._userModel = opts.userModel;\n    this._configModel = opts.configModel;\n    this.model = new UploadModel({\n      type: this.options.type,\n      service_name: this.options.service\n    }, {\n      userModel: this._userModel,\n      configModel: this._configModel\n    });\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template());\n    this._initViews();\n    return this;\n  },\n\n  _initViews: function () {\n    var headerView = new HeaderView({\n      el: this.$('.ImportPanel-header'),\n      model: this.model,\n      userModel: this._userModel,\n      fileEnabled: this.options.fileEnabled,\n      acceptSync: this.options.acceptSync,\n      template: this.options.headerTemplate\n    });\n    headerView.render();\n    this.addView(headerView);\n\n    var selected = new SelectedDatasetView({\n      el: this.$('.DatasetSelected'),\n      userModel: this._userModel,\n      model: this.model,\n      acceptSync: this.options.acceptSync,\n      fileAttrs: this.options.fileAttrs,\n      configModel: this._configModel\n    });\n    selected.render();\n    this.addView(selected);\n\n    var formView = new FormView({\n      el: this.$('.ImportPanel-form'),\n      userModel: this._userModel,\n      model: this.model,\n      template: this.options.formTemplate,\n      fileEnabled: this.options.fileEnabled\n    });\n\n    formView.bind('fileSelected', function () {\n      selected.setOptions({\n        acceptSync: false,\n        fileAttrs: {\n          ext: true,\n          title: 'name',\n          description: {\n            content: [{\n              name: 'size',\n              format: 'size'\n            }]\n          }\n        }\n      });\n    });\n\n    formView.bind('urlSelected', function () {\n      selected.setOptions({\n        acceptSync: true,\n        fileAttrs: {\n          ext: false,\n          title: '',\n          description: ''\n        }\n      });\n    });\n    formView.render();\n    this.addView(formView);\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:state', this._checkState, this);\n    this.model.bind('change', this._triggerChange, this);\n  },\n\n  _checkState: function () {\n    if (this.model.previous('state') === 'selected') {\n      this.model.set({\n        type: undefined,\n        value: '',\n        service_name: '',\n        service_item_id: '',\n        interval: 0\n      });\n    }\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"ImportPanel-header\">\\n  <h3 class=\"CDB-Text CDB-Size-large u-mainTextColor u-secondaryTextColor u-bSpace--m\">'+\n((__t=( _t('components.modals.add-layer.imports.form-import.title') ))==null?'':_.escape(__t))+\n'</h3>\\n  <p class=\"ImportPanel-headerDescription\">'+\n((__t=( _t('components.modals.add-layer.imports.form-import.desc') ))==null?'':_.escape(__t))+\n'</p>\\n</div>\\n<div class=\"ImportPanel-body\">\\n  <div class=\"ImportPanel-bodyWrapper\">\\n    <div class=\"ImportPanel-state ImportPanel-form is-idle\"></div>\\n    <div class=\"ImportPanel-state is-selected DatasetSelected\"></div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='';\n if (state !== 'list' ) { \n__p+='\\n  <h3 class=\"CDB-Text CDB-Size-large u-mainTextColor u-secondaryTextColor u-bSpace--m\">\\n    ';\n if (state === 'selected') { \n__p+='\\n      '+\n((__t=( _t('components.modals.add-layer.imports.mailchimp.campaign-selected', { brand: 'MailChimp' }) ))==null?'':_.escape(__t))+\n'\\n    ';\n } else { \n__p+='\\n      '+\n((__t=( _t('components.modals.add-layer.imports.mailchimp.map-campaign', { brand: 'MailChimp' }) ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n  </h3>\\n  <p class=\"CDB-Text CDB-Size-medium u-altTextColor ';\n if (state === \"error\") { \n__p+='ImportPanel-headerDescription--negative';\n } \n__p+='\">\\n    ';\n if (state === \"idle\") { \n__p+='\\n      '+\n((__t=( _t('components.modals.add-layer.imports.mailchimp.state-idle', { brand: 'MailChimp' }) ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n    ';\n if (state === \"error\") { \n__p+='\\n      '+\n((__t=( _t('components.modals.add-layer.imports.mailchimp.state-error', { brand: 'MailChimp' }) ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n    ';\n if (state === \"token\") { \n__p+='\\n      '+\n((__t=( _t('components.modals.add-layer.imports.mailchimp.state-token', { brand: 'MailChimp' }) ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n    ';\n if (state === \"oauth\") { \n__p+='\\n      '+\n((__t=( _t('components.modals.add-layer.imports.mailchimp.state-oauth', { brand: 'MailChimp' }) ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n    ';\n if (state === \"retrieving\") { \n__p+='\\n      '+\n((__t=( _t('components.modals.add-layer.imports.mailchimp.state-retrieving', { brand: 'MailChimp' }) ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n    ';\n if (state === \"selected\") { \n__p+='\\n      '+\n((__t=( _t('components.modals.add-layer.imports.mailchimp.state-selected', { brand: 'MailChimp' }) ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n  </p>\\n  ';\n if (state === \"selected\") { \n__p+='\\n    <button class=\"NavButton NavButton--back ImportPanel-headerButton js-back\">\\n      <i class=\"CDB-IconFont CDB-IconFont-arrowPrev\"></i>\\n    </button>\\n  ';\n } \n__p+='\\n';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var ImportDataView = require('./import-data/import-data-view');\nvar ImportServiceView = require('./import-service/import-service-view');\nvar ImportArcGISView = require('./import-arcgis/import-arcgis-view');\nvar ImportTwitterView = require('./import-twitter/import-twitter-view');\n\n/**\n * Attributes:\n *\n *  view: import pane class view\n *  enabled: function that takes configModel and returns whether the service is enabled\n *  fallbackClassName: ...\n *  name: local name\n *  title: text for tab link\n *  options:\n *    - service:\n *    - fileExtensions:\n *    - showAvailableFormats:\n *    - acceptSync:\n *    - fileAttrs:\n *\n */\n\nmodule.exports = {\n\n  File: {\n    view: ImportDataView,\n    enabled: function (config, userModel) { return true; },\n    name: 'file',\n    title: 'Data file',\n    options: {\n      type: 'url',\n      fileEnabled: true,\n      acceptSync: true\n    }\n  },\n  GDrive: {\n    view: ImportServiceView,\n    enabled: function (config, userModel) { return !!config.get('oauth_gdrive'); },\n    name: 'gdrive',\n    title: 'Google Drive',\n    options: {\n      service: 'gdrive',\n      fileExtensions: ['Google SpreadSheet', 'CSV'],\n      showAvailableFormats: false,\n      acceptSync: true,\n      fileAttrs: {\n        ext: true,\n        title: 'filename',\n        description: {\n          content: [{\n            name: 'size',\n            format: 'size',\n            key: true\n          }]\n        }\n      }\n    }\n  },\n  Dropbox: {\n    view: ImportServiceView,\n    enabled: function (config, userModel) { return !!config.get('oauth_dropbox'); },\n    name: 'dropbox',\n    title: 'Dropbox',\n    options: {\n      service: 'dropbox',\n      fileExtensions: ['CSV', 'XLS'],\n      showAvailableFormats: false,\n      acceptSync: true,\n      fileAttrs: {\n        ext: true,\n        title: 'filename',\n        description: {\n          content: [\n            {\n              name: 'id',\n              format: ''\n            },\n            {\n              name: 'size',\n              format: 'size',\n              key: true\n            }\n          ],\n          separator: '-'\n        }\n      }\n    }\n  },\n  Box: {\n    view: ImportServiceView,\n    enabled: function (config, userModel) { return !!config.get('oauth_box'); },\n    name: 'box',\n    title: 'Box',\n    fallback: require('./fallbacks/import-box-fallback.tpl'),\n    options: {\n      service: 'box',\n      fileExtensions: ['CSV', 'XLS'],\n      showAvailableFormats: false,\n      acceptSync: true,\n      fileAttrs: {\n        ext: true,\n        title: 'filename',\n        description: {\n          content: [\n            {\n              name: 'size',\n              format: 'size',\n              key: true\n            }\n          ],\n          separator: '-'\n        }\n      }\n    }\n  },\n  Twitter: {\n    view: ImportTwitterView,\n    enabled: function (config, userModel) { return userModel.get('twitter').enabled && !!config.get('datasource_search_twitter'); },\n    fallback: require('./fallbacks/import-twitter-fallback.tpl'),\n    name: 'twitter',\n    title: 'Twitter'\n  },\n  Mailchimp: {\n    view: ImportServiceView,\n    enabled: function (config, userModel) { return userModel.get('mailchimp').enabled && !!config.get('oauth_mailchimp'); },\n    fallback: require('./fallbacks/import-mailchimp-fallback.tpl'),\n    name: 'mailchimp',\n    title: 'MailChimp',\n    options: {\n      service: 'mailchimp',\n      fileExtensions: [],\n      acceptSync: true,\n      showAvailableFormats: false,\n      headerTemplate: require('./import-mailchimp/import-data-header-mailchimp.tpl'),\n      fileAttrs: {\n        ext: true,\n        title: 'filename',\n        description: {\n          content: [{\n            name: 'member_count',\n            format: 'number',\n            key: true\n          }],\n          itemName: 'member',\n          separator: ''\n        }\n      }\n    }\n  },\n  // Instagram: {\n  //   view: ImportServiceView,\n  //   fallback: require('./fallbacks/import-instagram-fallback.tpl'),\n  //   name: 'instagram',\n  //   title: 'Instagram',\n  //   options: {\n  //     service: 'instagram',\n  //     fileExtensions: [],\n  //     acceptSync: false,\n  //     showAvailableFormats: false,\n  //     fileAttrs: {\n  //       ext: false,\n  //       title: 'title'\n  //     }\n  //   }\n  // },\n  Arcgis: {\n    view: ImportArcGISView,\n    enabled: function (config, userModel) { return config.get('arcgis_enabled'); },\n    fallback: require('./fallbacks/import-arcgis-fallback.tpl'),\n    name: 'arcgis',\n    title: 'ArcGIS Server&trade;'\n  },\n  Salesforce: {\n    view: ImportDataView,\n    enabled: function (config, userModel) { return config.get('salesforce_enabled'); },\n    fallback: require('./fallbacks/import-salesforce-fallback.tpl'),\n    name: 'salesforce',\n    title: 'Salesforce',\n    options: {\n      type: 'service',\n      service_name: 'salesforce',\n      acceptSync: true,\n      formTemplate: require('./import-salesforce/import-data-form-salesforce.tpl'),\n      headerTemplate: require('./import-salesforce/import-data-header-salesforce.tpl')\n    }\n  }\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<form class=\"Form js-form\">\\n  <div class=\"Form-row\">\\n    <div class=\"Form-rowLabel\">\\n      <label class=\"CDB-Text CDB-Size-medium\"><span>'+\n((__t=( _t('components.modals.add-layer.imports.form-import.title') ))==null?'':_.escape(__t))+\n'</span></label>\\n    </div>\\n    <div class=\"Form-rowData Form-rowData--longer\">\\n      <input type=\"text\" class=\"CDB-Text CDB-Size-medium Form-input Form-input--longer has-submit js-textInput\" value=\"\" placeholder=\"'+\n((__t=( _t('components.modals.add-layer.imports.salesforce.salesforce.input-placeholder', { brand: 'Salesforce' }) ))==null?'':_.escape(__t))+\n'\" />\\n      <button type=\"submit\" class=\"CDB-Text CDB-Size-small Form-inputSubmit u-upperCase u-actionTextColor Form-inputSubmit\">\\n        <span>'+\n((__t=( _t('components.modals.add-layer.imports.form-import.submit') ))==null?'':_.escape(__t))+\n'</span>\\n      </button>\\n      <div class=\"Form-inputError CDB-Text\">\\n        <span>'+\n((__t=( _t('components.modals.add-layer.imports.form-import.error-desc') ))==null?'':_.escape(__t))+\n'</span>\\n      </div>\\n    </div>\\n  </div>\\n</form>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<h3 class=\"CDB-Text CDB-Size-large u-mainTextColor u-secondaryTextColor u-bSpace--m\">\\n  ';\n if (state === 'selected') { \n__p+='\\n    '+\n((__t=( _t('components.modals.add-layer.imports.header-import.type-selected', { brand: 'Salesforce'}) ))==null?'':_.escape(__t))+\n'\\n  ';\n } else { \n__p+='\\n    '+\n((__t=( _t('components.modals.add-layer.imports.header-import.type-import', { brand: 'Salesforce'}) ))==null?'':_.escape(__t))+\n'\\n  ';\n } \n__p+='\\n</h3>\\n<p class=\"CDB-Text CDB-Size-medium u-altTextColor\">\\n  ';\n if (state !== \"selected\") { \n__p+='\\n    '+\n((__t=( _t('components.modals.add-layer.imports.header-import.import-url', { brand: 'Salesforce'}) ))==null?'':_.escape(__t))+\n'\\n  ';\n } else { \n__p+='\\n    ';\n if (acceptSync) { \n__p+='\\n      '+\n((__t=( _t('components.modals.add-layer.imports.header-import.sync-enabled', { brand: 'Salesforce'}) ))==null?'':_.escape(__t))+\n'\\n    ';\n } else { \n__p+='\\n      '+\n((__t=( _t('components.modals.add-layer.imports.header-import.sync-disabled', { brand: 'Salesforce'}) ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n  ';\n } \n__p+='\\n</p>\\n';\n if (state === \"selected\") { \n__p+='\\n  <button class=\"NavButton NavButton--back ImportPanel-headerButton js-back\">\\n    <i class=\"CDB-IconFont CDB-IconFont-arrowPrev\"></i>\\n  </button>\\n';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar Utils = require('../../../../../helpers/utils');\nvar template = require('./import-selected-dataset.tpl');\n\n/**\n *  Selected dataset\n *\n *  - Displays the result when a dataset is selected, no matter the type.\n *  - It will show available sync options if that import lets it.\n *  - Upgrade link for people who don't have sync permissions.\n *\n */\n\nmodule.exports = CoreView.extend({\n  className: 'DatasetSelected',\n\n  _FORMATTERS: {\n    'size': Utils.readablizeBytes,\n    'number': Utils.formatNumber\n  },\n\n  options: {\n    acceptSync: false,\n    fileAttrs: {\n      ext: false,\n      title: '',\n      description: {\n        content: [{\n          name: 'id',\n          format: ''\n        }],\n        itemName: '',\n        separator: ''\n      }\n    }\n  },\n\n  events: {\n    'click .js-interval-0': '_onIntervalZero',\n    'click .js-interval-1': '_onIntervalHour',\n    'click .js-interval-2': '_onIntervalDay',\n    'click .js-interval-3': '_onIntervalWeek',\n    'click .js-interval-4': '_onIntervalMonth'\n  },\n\n  initialize: function (opts) {\n    if (!opts.userModel) throw new TypeError('userModel is required');\n    if (!opts.configModel) throw new TypeError('configModel is required');\n\n    this._configModel = opts.configModel;\n    this._userModel = opts.userModel;\n    this._initBinds();\n    this._checkVisibility();\n  },\n\n  render: function () {\n    var title = this.options.fileAttrs.title && this.model.get('value')[this.options.fileAttrs.title] || this.model.get('value');\n    var description = this._genDescription();\n    var ext = this.options.fileAttrs.ext ? Utils.getFileExtension(title) : '';\n\n    if (this.options.fileAttrs.ext) {\n      title = title && title.replace('.' + ext, '');\n    }\n\n    var upgradeUrl = window.upgrade_url;\n    var userCanSync = this._userModel.isActionEnabled('sync_tables');\n    var customInstall = this._configModel.get('cartodb_com_hosted');\n\n    this.$el.html(\n      template({\n        title: title,\n        description: description,\n        ext: ext,\n        interval: this.model.get('interval'),\n        importCanSync: this.options.acceptSync,\n        userCanSync: userCanSync,\n        showTrial: this._userModel.canStartTrial(),\n        showUpgrade: !userCanSync && !customInstall && upgradeUrl && !this._userModel.isInsideOrg(),\n        upgradeUrl: upgradeUrl\n      })\n    );\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:value', this.render, this);\n    this.model.bind('change:interval', this.render, this);\n    this.model.bind('change:state', this._checkVisibility, this);\n  },\n\n  _genDescription: function () {\n    if (this.options.fileAttrs && this.options.fileAttrs.description) {\n      var descriptionOpts = this.options.fileAttrs.description;\n      var descriptionKeyValue = '';\n      var descriptionStr = '';\n      var self = this;\n\n      if (descriptionOpts.content && descriptionOpts.content.length > 0) {\n        _.each(descriptionOpts.content, function (item, i) {\n          if (i > 0 && descriptionOpts.separator) {\n            descriptionStr += ' ' + descriptionOpts.separator + ' ';\n          }\n\n          var value = self.model.get('value')[item.name];\n          var format = item.format && self._FORMATTERS[item.format];\n          descriptionStr += format && format(value) || value;\n\n          if (item.key) {\n            descriptionKeyValue = item.name;\n          }\n        });\n      }\n\n      if (descriptionOpts.itemName && descriptionKeyValue) {\n        descriptionStr += ' ' + (descriptionOpts.itemName && _t('components.modals.add-layer.imports.' + descriptionOpts.itemName + '-pluralize', { smart_count: descriptionKeyValue }) || '');\n      }\n\n      return descriptionStr;\n    }\n\n    return '';\n  },\n\n  _onIntervalZero: function () {\n    this.model.set('interval', 0);\n  },\n\n  _onIntervalHour: function () {\n    if (this.options.acceptSync && this._userModel.isActionEnabled('sync_tables')) {\n      this.model.set('interval', 3600);\n    }\n  },\n\n  _onIntervalDay: function () {\n    if (this.options.acceptSync && this._userModel.isActionEnabled('sync_tables')) {\n      this.model.set('interval', 86400);\n    }\n  },\n\n  _onIntervalWeek: function () {\n    if (this.options.acceptSync && this._userModel.isActionEnabled('sync_tables')) {\n      this.model.set('interval', 604800);\n    }\n  },\n\n  _onIntervalMonth: function () {\n    if (this.options.acceptSync && this._userModel.isActionEnabled('sync_tables')) {\n      this.model.set('interval', 2592000);\n    }\n  },\n\n  setOptions: function (d) {\n    if (d && !_.isEmpty(d)) {\n      _.extend(this.options, d);\n    }\n  },\n\n  _checkVisibility: function () {\n    var state = this.model.get('state');\n    if (state === 'selected') {\n      this.show();\n    } else {\n      this.hide();\n    }\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"DatasetSelected-item\">\\n  <div class=\"DatasetSelected-itemExt CDB-Text u-ellipsis\">\\n    '+\n((__t=( ext || '?' ))==null?'':_.escape(__t))+\n'\\n  </div>\\n  <div class=\"DatasetSelected-itemInfo u-ellipsis\">\\n    <h6 class=\"CDB-Text CDB-Size-large u-ellipsis\" title=\"'+\n((__t=( title ))==null?'':_.escape(__t))+\n'\">'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</h6>\\n    <p class=\"CDB-Text CDB-Size-small u-ellipsis u-altTextColor\">'+\n((__t=( description ))==null?'':_.escape(__t))+\n'</p>\\n  </div>\\n</div>\\n';\n if (importCanSync) { \n__p+='\\n  <div class=\"DatasetSelected-sync\">\\n    <div class=\"DatasetSelected-syncOptions\">\\n      <label class=\"DatasetSelected-syncLabel CDB-Text CDB-Size-medium u-mainTextColor\">\\n        '+\n((__t=( _t('components.modals.add-layer.imports.selected-state.sync-my-data') ))==null?'':_.escape(__t))+\n'\\n      </label>\\n      <ul class=\"DatasetSelected-syncOptionsList\">\\n        <li class=\"DatasetSelected-syncOptionsItem\">\\n          <div class=\"RadioButton\">\\n            <button class=\"RadioButton-input js-interval-0 '+\n((__t=( interval === 0 ? 'is-checked' : '' ))==null?'':_.escape(__t))+\n'\"></button>\\n            <label class=\"CDB-Text CDB-Size-medium u-altTextColor u-lSpace\">'+\n((__t=( _t('components.modals.add-layer.imports.selected-state.never') ))==null?'':_.escape(__t))+\n'</label>\\n          </div>\\n        </li>\\n        <li class=\"DatasetSelected-syncOptionsItem\">\\n          <div class=\"RadioButton '+\n((__t=( !userCanSync ? 'is-disabled' : '' ))==null?'':_.escape(__t))+\n'\">\\n            <button class=\"RadioButton-input js-interval-1 '+\n((__t=( interval === 3600 ? 'is-checked' : '' ))==null?'':_.escape(__t))+\n'\"></button>\\n            <label class=\"CDB-Text CDB-Size-medium u-altTextColor u-lSpace\">'+\n((__t=( _t('components.modals.add-layer.imports.selected-state.every-hour') ))==null?'':_.escape(__t))+\n'</label>\\n          </div>\\n        </li>\\n        <li class=\"DatasetSelected-syncOptionsItem\">\\n          <div class=\"RadioButton '+\n((__t=( !userCanSync ? 'is-disabled' : '' ))==null?'':_.escape(__t))+\n'\">\\n            <button class=\"RadioButton-input js-interval-2 '+\n((__t=( interval === 86400 ? 'is-checked' : '' ))==null?'':_.escape(__t))+\n'\"></button>\\n            <label class=\"CDB-Text CDB-Size-medium u-altTextColor u-lSpace\">'+\n((__t=( _t('components.modals.add-layer.imports.selected-state.every-day') ))==null?'':_.escape(__t))+\n'</label>\\n          </div>\\n        </li>\\n        <li class=\"DatasetSelected-syncOptionsItem\">\\n          <div class=\"RadioButton '+\n((__t=( !userCanSync ? 'is-disabled' : '' ))==null?'':_.escape(__t))+\n'\">\\n            <button class=\"RadioButton-input js-interval-3 '+\n((__t=( interval === 604800 ? 'is-checked' : '' ))==null?'':_.escape(__t))+\n'\"></button>\\n            <label class=\"CDB-Text CDB-Size-medium u-altTextColor u-lSpace\">'+\n((__t=( _t('components.modals.add-layer.imports.selected-state.every-week') ))==null?'':_.escape(__t))+\n'</label>\\n          </div>\\n        </li>\\n        <li class=\"DatasetSelected-syncOptionsItem\">\\n          <div class=\"RadioButton '+\n((__t=( !userCanSync ? 'is-disabled' : '' ))==null?'':_.escape(__t))+\n'\">\\n            <button class=\"RadioButton-input js-interval-4 '+\n((__t=( interval === 2592000 ? 'is-checked' : '' ))==null?'':_.escape(__t))+\n'\"></button>\\n            <label class=\"CDB-Text CDB-Size-medium u-altTextColor u-lSpace\">'+\n((__t=( _t('components.modals.add-layer.imports.selected-state.every-month') ))==null?'':_.escape(__t))+\n'</label>\\n          </div>\\n        </li>\\n      </ul>\\n    </div>\\n    ';\n if (showUpgrade) { \n__p+='\\n      <div class=\"Upgrade-info\">\\n        <p class=\"CDB-Text CDB-Size-medium u-ellipsis u-secondaryTextColor\">\\n         ';\n featuresLink = '<a href=\"https://carto.com/pricing\">' + _t('components.modals.add-layer.imports.selected-state.more-features') + '</a>' \n__p+='\\n          '+\n((__t=( _t('components.modals.add-layer.imports.selected-state.upgrade-desc', { features: featuresLink }) ))==null?'':_.escape(__t))+\n'\\n        </p>\\n        <div class=\"Upgrade-infoActions\">\\n          ';\n if (showTrial) { \n__p+='\\n            <p class=\"CDB-Text CDB-Size-medium u-ellipsis is-semibold u-rSpace--xl\">'+\n((__t=( _t('components.modals.add-layer.imports.selected-state.free-trial', { days: 14 }) ))==null?'':_.escape(__t))+\n'</p>\\n          ';\n } \n__p+='\\n          <a href=\"'+\n((__t=( upgradeUrl ))==null?'':_.escape(__t))+\n'\" class=\"CDB-Button CDB-Button--secondary\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">'+\n((__t=( _t('components.modals.add-layer.imports.selected-state.upgrade') ))==null?'':_.escape(__t))+\n'</span>\\n          </a>\\n        </div>\\n      </div>\\n    ';\n } \n__p+='\\n  </div>\\n';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./import-service-header.tpl');\n\n/**\n *  Service header\n *\n *  - It will change when upload state changes\n *  - Possibility to change state with a header button\n *\n */\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-back': '_goToList'\n  },\n\n  options: {\n    title: 'Service',\n    showAvailableFormats: false,\n    acceptSync: false,\n    fileExtensions: [],\n    template: ''\n  },\n\n  initialize: function (opts) {\n    if (!opts.userModel) throw new Error('userModel is required');\n    this._userModel = opts.userModel;\n    this.template = opts.template || template;\n    this._initBinds();\n  },\n\n  render: function () {\n    this.$el.html(\n      this.template({\n        items: this.collection.size(),\n        service_name: this.model.get('service_name'),\n        showAvailableFormats: this.options.showAvailableFormats,\n        fileExtensions: this.options.fileExtensions,\n        acceptSync: this.options.acceptSync && this._userModel.isActionEnabled('sync_tables'),\n        state: this.model.get('state'),\n        title: this.options.title\n      })\n    );\n    this._checkVisibility();\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:state', this.render, this);\n  },\n\n  _checkVisibility: function () {\n    var state = this.model.get('state');\n    this[ state !== 'list' ? 'show' : 'hide' ]();\n  },\n\n  _goToList: function () {\n    this.model.set('state', 'list');\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='';\n if (state !== 'list' ) { \n__p+='\\n  <h3 class=\"CDB-Text CDB-Size-large u-mainTextColor u-secondaryTextColor u-bSpace--m\">\\n    ';\n if (state === 'selected') { \n__p+='\\n      ';\n if (service_name === 'instagram') { \n__p+='\\n        '+\n((__t=( _t('components.modals.add-layer.imports.service-import.account-connected') ))==null?'':_.escape(__t))+\n'\\n        ';\n } else { \n__p+='\\n        '+\n((__t=( _t('components.modals.add-layer.imports.service-import.item-selected') ))==null?'':_.escape(__t))+\n'\\n      ';\n } \n__p+='\\n    ';\n } else { \n__p+='\\n      '+\n((__t=( _t('components.modals.add-layer.imports.service-import.connect-with', { title: title }) ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n  </h3>\\n  <p class=\"CDB-Text CDB-Size-medium u-altTextColor ';\n if (state === \"error\") { \n__p+='ImportPanel-headerDescription--negative';\n } \n__p+='\">\\n    ';\n if (state === \"idle\") { \n__p+='\\n      ';\n if (fileExtensions.length > 0) { \n__p+='\\n        ';\n formatsLink = _t('components.modals.add-layer.imports.service-import.and') + ' <a target=\"_blank\" href=\"https://docs.carto.com/cartodb-editor/datasets/#supported-file-formats\" class=\"ImportPanel-headerDescriptionLink\">' + _t('components.modals.add-layer.imports.service-import.many-more-formats') + '</a>' \n__p+='\\n        '+\n((__t=( fileExtensions.join(', ') ))==null?'':_.escape(__t))+\n'';\n if (showAvailableFormats) { \n__p+=' '+\n((__t=( formatsLink ))==null?'':_.escape(__t))+\n' ';\n } \n__p+=' '+\n((__t=( _t('components.modals.add-layer.imports.service-import.supported') ))==null?'':_.escape(__t))+\n'.\\n      ';\n } else { \n__p+='\\n        '+\n((__t=( _t('components.modals.add-layer.imports.service-import.state-idle-login') ))==null?'':_.escape(__t))+\n'\\n      ';\n } \n__p+='\\n    ';\n } \n__p+='\\n    ';\n if (state === \"error\") { \n__p+='\\n      '+\n((__t=( _t('components.modals.add-layer.imports.service-import.state-error') ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n    ';\n if (state === \"token\") { \n__p+='\\n      '+\n((__t=( _t('components.modals.add-layer.imports.service-import.state-token') ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n    ';\n if (state === \"oauth\") { \n__p+='\\n      '+\n((__t=( _t('components.modals.add-layer.imports.service-import.state-oauth') ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n    ';\n if (state === \"retrieving\") { \n__p+='\\n      '+\n((__t=( _t('components.modals.add-layer.imports.service-import.state-retrieving', { title: title }) ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n    ';\n if (state === \"selected\") { \n__p+='\\n      ';\n if (acceptSync) { \n__p+='\\n        '+\n((__t=( _t('components.modals.add-layer.imports.service-import.state-selected-sync') ))==null?'':_.escape(__t))+\n'\\n      ';\n } else { \n__p+='\\n        ';\n if (service_name === 'instagram') { \n__p+='\\n          '+\n((__t=( _t('components.modals.add-layer.imports.service-import.state-selected-instagram') ))==null?'':_.escape(__t))+\n'\\n        ';\n } else { \n__p+='\\n          '+\n((__t=( _t('components.modals.add-layer.imports.service-import.state-selected-no-sync') ))==null?'':_.escape(__t))+\n'\\n        ';\n } \n__p+='\\n      ';\n } \n__p+='\\n    ';\n } \n__p+='\\n  </p>\\n  ';\n if (state === \"selected\" && items > 1) { \n__p+='\\n    <button class=\"CDB-Size-large ImportPanel-headerButton js-back\">\\n      <i class=\"CDB-IconFont CDB-IconFont-arrowPrev u-actionTextColor\"></i>\\n    </button>\\n  ';\n } \n__p+='\\n';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var Utils = require('../../../../../../helpers/utils');\n\n/**\n *  Service list item format utils\n *\n *  - Create customized functions for service list items.\n *\n */\n\nmodule.exports = {\n  // Due to the fact that backend data source service\n  // returns 0 size when it doesn't know it\n  formatSize: function (s) {\n    if (s && s > 0) {\n      return Utils.readablizeBytes(s);\n    } else {\n      return 'Unknown';\n    }\n  }\n};\n",
    "var Backbone = require('backbone');\n\n/**\n *  Service item model\n *\n */\n\nmodule.exports = Backbone.Model.extend({\n  defaults: {\n    id: '',\n    filename: '',\n    checksum: '',\n    service: '',\n    size: '',\n    title: ''\n  }\n});\n",
    "var ServiceItem = require('./import-service-item-model');\nvar Backbone = require('backbone');\n\n/**\n *  Service item model + Service items collection\n *\n *  - It needs a datasource name or it won't work.\n *\n */\n\nmodule.exports = Backbone.Collection.extend({\n\n  _DATASOURCE_NAME: 'dropbox',\n\n  model: ServiceItem,\n\n  url: function (method) {\n    var version = this._configModel.urlVersion('imports_service');\n    var baseUrl = this._configModel.get('base_url');\n    return baseUrl + '/api/' + version + '/imports/service/' + this._DATASOURCE_NAME + '/list_files';\n  },\n\n  initialize: function (coll, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.datasourceName) throw new Error('datasourceName is required');\n    this._configModel = opts.configModel;\n    this._DATASOURCE_NAME = opts.datasourceName;\n  },\n\n  fetch: function () {\n    this.trigger('fetch', this);\n    return Backbone.Collection.prototype.fetch.apply(this, arguments);\n  },\n\n  parse: function (r) {\n    return r.files;\n  }\n\n});\n",
    "var CoreView = require('backbone/core-view');\nvar Utils = require('../../../../../../helpers/utils');\nvar ServiceUtilsFormat = require('./import-service-item-description-format');\nvar template = require('./import-service-list-item.tpl');\nvar _ = require('underscore');\n\n/**\n *  Service list item view\n *\n *  - Displays the item info.\n *  - It lets user to select the item for a future import.\n *\n */\n\nmodule.exports = CoreView.extend({\n  options: {\n    title: '',\n    fileAttrs: {\n      ext: false,\n      title: 'filename',\n      description: 'size',\n      itemName: 'file',\n      formatDescription: ''\n    }\n  },\n\n  _FORMATTERS: {\n    'size': ServiceUtilsFormat.formatSize,\n    'number': Utils.formatNumber\n  },\n\n  className: 'ServiceList-item',\n  tagName: 'li',\n\n  events: {\n    'click .js-choose': '_onSelectItem'\n  },\n\n  render: function () {\n    var title = this.model.get(this.options.fileAttrs.title);\n    var description = this._genDescription();\n    var ext = this.options.fileAttrs.ext ? Utils.getFileExtension(title) : '';\n\n    if (this.options.fileAttrs.ext) {\n      title = title && title.replace('.' + ext, '');\n    }\n\n    this.$el.html(\n      template({\n        name: this.options.title,\n        ext: ext,\n        title: title,\n        description: description\n      })\n    );\n    return this;\n  },\n\n  _genDescription: function () {\n    if (this.options.fileAttrs && this.options.fileAttrs.description) {\n      var descriptionOpts = this.options.fileAttrs.description;\n      var descriptionKeyValue = '';\n      var descriptionStr = '';\n      var self = this;\n\n      if (descriptionOpts.content && descriptionOpts.content.length > 0) {\n        _.each(descriptionOpts.content, function (item, i) {\n          if (i > 0 && descriptionOpts.separator) {\n            descriptionStr += ' ' + descriptionOpts.separator + ' ';\n          }\n\n          var value = self.model.get(item.name);\n          var format = item.format && self._FORMATTERS[item.format];\n          descriptionStr += format && format(value) || value;\n\n          if (item.key) {\n            descriptionKeyValue = item.name;\n          }\n        });\n      }\n\n      if (descriptionOpts.itemName && descriptionKeyValue) {\n        descriptionStr += ' ' + (descriptionOpts.itemName && _t('components.modals.add-layer.imports.' + descriptionOpts.itemName + '-pluralize', { smart_count: descriptionKeyValue }) || '');\n      }\n\n      return descriptionStr;\n    }\n\n    return '';\n  },\n\n  _onSelectItem: function () {\n    this.trigger('selected', this.model, this);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"ServiceList-itemExt u-ellipsLongText CDB-Text CDB-Size-medium u-rSpace--xl\">\\n  '+\n((__t=( ext || '?' ))==null?'':_.escape(__t))+\n'\\n</div>\\n<div class=\"ServiceList-itemInfo u-flex u-alignCenter u-justifySpace\">\\n  <div class=\"ServiceList-itemInfoTitle\">\\n    <h6 class=\"CDB-Text CDB-Size-large u-bSpace u-ellipsis\" >'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</h6>\\n    <p class=\"CDB-Text CDB-Size-medium u-altTextColor u-ellipsis\">'+\n((__t=( description ))==null?'':_.escape(__t))+\n'</p>\\n  </div>\\n  <div class=\"ServiceList-itemActions\">\\n    <button class=\"CDB-Button CDB-Button--secondary js-choose\">\\n      <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-small u-upperCase\">'+\n((__t=( _t('components.modals.add-layer.imports.service-import.choose') ))==null?'':_.escape(__t))+\n'</span>\\n    </button>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar ServiceListItemView = require('./import-service-list-item-view');\nvar template = require('./import-service-list.tpl');\n\n/**\n *  Service list view\n *\n *  - It will display all the items available under\n *  the service and the possibility to chose one of\n *  them.\n *\n */\n\nmodule.exports = CoreView.extend({\n  options: {\n    title: 'service',\n    fileAttrs: {}\n  },\n\n  initialize: function () {\n    this._initBinds();\n    this._checkVisibility();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    var size = this.collection.size();\n    this.$el.html(\n      template({\n        size: size,\n        title: this.options.title,\n        pluralize: _t('components.modals.add-layer.imports.item-pluralize', { smart_count: size })\n      })\n    );\n    if (this.collection.size() > 0) {\n      this.collection.each(this._addItem, this);\n    }\n    return this;\n  },\n\n  _initBinds: function () {\n    this.collection.bind('sync', this.render, this);\n    this.model.bind('change:state', this._checkVisibility, this);\n    this.add_related_model(this.collection);\n  },\n\n  _addItem: function (m) {\n    var item = new ServiceListItemView({\n      model: m,\n      title: this.options.title,\n      fileAttrs: this.options.fileAttrs\n    });\n    item.bind('selected', this._onSelectedItem, this);\n    this.$('.ServiceList-items').append(item.render().el);\n    this.addView(item);\n  },\n\n  _onSelectedItem: function (mdl) {\n    this.model.setUpload({\n      state: 'selected',\n      value: mdl.toJSON(),\n      service_item_id: mdl.get('id')\n    });\n  },\n\n  _checkVisibility: function () {\n    var state = this.model.get('state');\n    if (state === 'list') {\n      this.show();\n    } else {\n      this.hide();\n    }\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"ConnectDataset-header\">\\n  <h2 class=\"CDB-Text CDB-Size-medium u-altTextColor\">\\n    '+\n((__t=( _t('components.modals.add-layer.imports.service-import.found-in', {\n      size: size,\n      pluralize: pluralize,\n      title: title\n    }) ))==null?'':_.escape(__t))+\n'\\n  </h2>\\n</div>\\n<div class=\"ServiceList-body\">\\n  ';\n if (size > 0) { \n__p+='\\n    <ul class=\"ServiceList-items\"></ul>\\n  ';\n } else { \n__p+='\\n    <div class=\"IntermediateInfo ServiceList-empty\">\\n      <div class=\"LayoutIcon\">\\n        <i class=\"CDB-IconFont CDB-IconFont-lens\"></i>\\n      </div>\\n      <h4 class=\"CDB-Text CDB-Size-large u-mainTextColor u-secondaryTextColor u-bSpace--m\">\\n        '+\n((__t=( _t('components.modals.add-layer.imports.service-import.no-results-title') ))==null?'':_.escape(__t))+\n'\\n      </h4>\\n      <p class=\"CDB-Text CDB-Size-medium u-altTextColor\">\\n        '+\n((__t=( _t('components.modals.add-layer.imports.service-import.no-results-desc') ))==null?'':_.escape(__t))+\n'\\n      </p>\\n    </div>\\n  ';\n } \n__p+='\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./import-service-loader.tpl');\n\n/**\n *  Service loader view\n *\n *  - It will be on charge to make token and oauth petitions\n *\n */\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-connect': '_checkToken'\n  },\n\n  initialize: function (opts) {\n    if (!opts.serviceTokenModel) throw new Error('serviceTokenModel prodiver is required');\n    if (!opts.serviceOauthModel) throw new Error('serviceOauthModel is required');\n\n    this._serviceTokenModel = opts.serviceTokenModel;\n    this._serviceOauthModel = opts.serviceOauthModel;\n    this._initBinds();\n    this._checkVisibility();\n  },\n\n  render: function () {\n    this.$el.html(\n      template({\n        state: this.model.get('state')\n      })\n    );\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:state', function () {\n      this.render();\n      this._checkVisibility();\n    }, this);\n  },\n\n  _checkToken: function () {\n    var self = this;\n    this.model.set('state', 'token');\n    this._serviceTokenModel.fetch({\n      success: function (r) {\n        if (!r.get('oauth_valid')) {\n          self._getOauthURL();\n        }\n      },\n      error: function (e) {\n        self._getOauthURL();\n      }\n    });\n  },\n\n  _checkVisibility: function () {\n    var state = this.model.get('state');\n    if (state !== 'list' && state !== 'selected') {\n      this.show();\n    } else {\n      this.hide();\n    }\n  },\n\n  _getOauthURL: function () {\n    var self = this;\n    this.model.set('state', 'oauth');\n    this._serviceOauthModel.set({ url: '' }, { silent: true });\n    this._serviceOauthModel.fetch({\n      error: function () {\n        self.model.set('state', 'error');\n      }\n    });\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"ImportPanel-actions\">\\n  ';\n if (state === \"idle\") { \n__p+='\\n    <button class=\"CDB-Button CDB-Button--primary js-connect\">\\n      <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-small u-upperCase\">\\n        '+\n((__t=( _t('components.modals.add-layer.imports.service-import.connect') ))==null?'':_.escape(__t))+\n'\\n      </span>\\n    </button>\\n  ';\n } else if (state === \"error\") { \n__p+='\\n    <button class=\"CDB-Button CDB-Button--primary js-connect\">\\n      <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-small u-upperCase\">\\n        '+\n((__t=( _t('components.modals.add-layer.imports.service-import.try-again') ))==null?'':_.escape(__t))+\n'\\n      </span>\\n    </button>\\n  ';\n } else { \n__p+='\\n    <div class=\"Spinner ImportPanel-actionsLoader\"></div>\\n  ';\n } \n__p+='\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\n\n/**\n *  Get oauth url from the service requested\n *\n *  - It needs a datasource name or it won't work.\n *\n *  new ServiceOauthModel({ datasourceName: 'dropbox', configModel: configModel })\n */\n\nmodule.exports = Backbone.Model.extend({\n\n  _DATASOURCE_NAME: 'dropbox',\n\n  url: function (method) {\n    var version = this._configModel.urlVersion('imports_service');\n    var baseUrl = this._configModel.get('base_url');\n    return baseUrl + '/api/' + version + '/imports/service/' + this._DATASOURCE_NAME + '/auth_url';\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.datasourceName) throw new Error('datasource_name is required');\n    this._configModel = opts.configModel;\n    this._DATASOURCE_NAME = opts.datasourceName;\n  }\n\n});\n",
    "var Backbone = require('backbone');\n\n/**\n *  Model to check if oAuth token is valid or not\n *\n *  - It needs a datasource name or it won't work.\n *\n *  new ServiceTokenModel({ datasourceName: 'dropbox', configModel: configModel })\n */\n\nmodule.exports = Backbone.Model.extend({\n\n  _DATASOURCE_NAME: 'dropbox',\n\n  url: function (method) {\n    var version = this._configModel.urlVersion('imports_service');\n    var baseUrl = this._configModel.get('base_url');\n    return baseUrl + '/api/' + version + '/imports/service/' + this._DATASOURCE_NAME + '/token_valid';\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.datasourceName) throw new Error('datasource_name is required');\n    this._configModel = opts.configModel;\n    this._DATASOURCE_NAME = opts.datasourceName;\n  }\n\n});\n",
    "var ImportView = require('../import-view');\nvar UploadModel = require('../../../../../../data/upload-model');\nvar ServiceHeaderView = require('./import-service-header-view');\nvar ServiceLoaderView = require('./import-service-loader-view');\nvar ServiceListView = require('./import-service-list-view');\nvar ServiceSelectedFileView = require('../import-selected-dataset-view');\nvar ServiceTokenModel = require('./import-service-token-model');\nvar ServiceOauthModel = require('./import-service-oauth-model');\nvar ServiceCollection = require('./import-service-items-collection');\nvar template = require('./import-service.tpl');\nvar WINDOW_INTERVAL = 1000; // miliseconds\n\n/**\n *  Import service view\n *\n *  - Use a service import panel\n *  - It will request login to the service\n *  - If it works, a list of available files will appear.\n *  - Once a file is selected, sync options will appear.\n *\n */\n\nmodule.exports = ImportView.extend({\n  _DATASOURCE_NAME: 'dropbox',\n\n  className: 'ImportPanel ImportPanelService',\n\n  options: {\n    service: '', // Name of the service\n    showAvailableFormats: false, // If all available format link should appear or not\n    fileExtensions: [], // File extensions\n    acceptSync: false, // Accept sync this service?\n    fileAttrs: { // Attributes or changes for service list or selected file:\n      ext: false, // If files should show extension\n      title: 'filename', // Title attribute\n      description: '<%- size %>', // Description attribute\n      formatDescription: 'size', // If any format function should be applied over the description\n      headerTemplate: '' // Header template\n    }\n  },\n\n  initialize: function (opts) {\n    if (!opts.service) throw new Error('service prodiver is required');\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._userModel = opts.userModel;\n    this._configModel = opts.configModel;\n    this._DATASOURCE_NAME = this.options.service;\n\n    this.model = new UploadModel({\n      type: 'service',\n      service_name: this._DATASOURCE_NAME\n    }, {\n      userModel: this._userModel,\n      configModel: this._configModel\n    });\n\n    this._initModels();\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template(this.options));\n    this._initViews();\n    return this;\n  },\n\n  _initModels: function () {\n    this._serviceTokenModel = new ServiceTokenModel(null, {\n      datasourceName: this._DATASOURCE_NAME,\n      configModel: this._configModel\n    });\n    this._serviceOauthModel = new ServiceOauthModel(null, {\n      datasourceName: this._DATASOURCE_NAME,\n      configModel: this._configModel\n    });\n    this.collection = new ServiceCollection(null, {\n      datasourceName: this._DATASOURCE_NAME,\n      configModel: this._configModel\n    });\n  },\n\n  _initBinds: function () {\n    this.model.bind('change', this._triggerChange, this);\n    this.model.bind('change:state', this._checkState, this);\n    this._serviceTokenModel.bind('change:oauth_valid', this._onOauthChange, this);\n    this._serviceOauthModel.bind('change:url', this._openWindow, this);\n    this.add_related_model(this._serviceOauthModel);\n    this.add_related_model(this._serviceTokenModel);\n  },\n\n  _initViews: function () {\n    var header = new ServiceHeaderView({\n      el: this.$('.ImportPanel-header'),\n      userModel: this._userModel,\n      model: this.model,\n      collection: this.collection,\n      title: this.options.title,\n      showAvailableFormats: this.options.showAvailableFormats,\n      fileExtensions: this.options.fileExtensions,\n      acceptSync: this.options.acceptSync,\n      template: this.options.headerTemplate\n    });\n    header.render();\n    this.addView(header);\n\n    var loader = new ServiceLoaderView({\n      el: this.$('.ServiceLoader'),\n      model: this.model,\n      serviceTokenModel: this._serviceTokenModel,\n      serviceOauthModel: this._serviceOauthModel\n    });\n    loader.render();\n    this.addView(loader);\n\n    var list = new ServiceListView({\n      el: this.$('.ServiceList'),\n      model: this.model,\n      collection: this.collection,\n      title: this.options.title,\n      fileAttrs: this.options.fileAttrs\n    });\n    list.render();\n    this.addView(list);\n\n    var selected = new ServiceSelectedFileView({\n      el: this.$('.ServiceSelected'),\n      userModel: this._userModel,\n      model: this.model,\n      acceptSync: this.options.acceptSync,\n      fileAttrs: this.options.fileAttrs,\n      configModel: this._configModel\n    });\n    selected.render();\n    this.addView(selected);\n  },\n\n  _onOauthChange: function () {\n    if (this._serviceTokenModel.get('oauth_valid')) {\n      this._getFiles();\n    }\n  },\n\n  _getFiles: function () {\n    var self = this;\n\n    this.model.set('state', 'retrieving');\n\n    this.collection.fetch({\n      error: function () {\n        self.model.set('state', 'error');\n      },\n      success: function () {\n        self.model.set('state', 'list');\n      }\n    });\n  },\n\n  _checkState: function () {\n    if (this.model.get('state') === 'list') {\n      if (this.collection.size() === 1) {\n        var item = this.collection.at(0);\n        this.model.setUpload({\n          state: 'selected',\n          value: item.toJSON(),\n          service_item_id: item.get('id')\n        });\n      }\n    }\n    if (this.model.get('state') !== 'selected') {\n      this.model.set({\n        value: '',\n        service_item_id: '',\n        interval: 0\n      });\n    }\n  },\n\n  _openWindow: function () {\n    var url = this._serviceOauthModel.get('url');\n    var self = this;\n    var i = window.open(url, null, 'menubar=no,toolbar=no,width=600,height=495');\n    var e = window.setInterval(function () {\n      if (i && i.closed) {\n        self._getFiles();\n        clearInterval(e);\n      } else if (!i) {\n        self.model.set('state', 'error');\n        clearInterval(e);\n      }\n    }, WINDOW_INTERVAL);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"ImportPanel-header\"></div>\\n<div class=\"ImportPanel-body\">\\n  <div class=\"ImportPanel-bodyWrapper\">\\n    <div class=\"ImportPanel-state ServiceLoader is-idle is-token is-oauth is-retrieving is-error\"></div>\\n    <div class=\"ImportPanel-state ServiceList is-list\"></div>\\n    <div class=\"ImportPanel-state ServiceSelected DatasetSelected is-selected\"></div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<i class=\\'TabIcon is-'+\n((__t=( name ))==null?'':_.escape(__t))+\n'\\'></i>\\n<span>'+\n((__t=( cdb.core.sanitize.html(title || name) ))==null?'':__t)+\n'</span>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar Utils = require('../../../../../../helpers/utils');\nvar template = require('./credits-info.tpl');\n\n/**\n *  Credits info view\n *\n *  - Percentage of use\n *  - Possible money spent\n *\n */\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    this._userModel = opts.userModel;\n    this._initBinds();\n  },\n\n  render: function () {\n    var twitterData = this._userModel.get('twitter');\n    var remaining = twitterData.quota - twitterData.monthly_use;\n    var per = Math.min(100, Math.ceil((this.model.get('value') * 100) / remaining));\n\n    this.$el.html(\n      template({\n        value: this.model.get('value'),\n        remaining: remaining,\n        per: per,\n        hardLimit: twitterData.hard_limit,\n        remainingFormatted: Utils.formatNumber(remaining),\n        quota: twitterData.quota,\n        block_price: twitterData.block_price,\n        block_size: Utils.readizableNumber(twitterData.block_size)\n      })\n    );\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.bind('change', this.render, this);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='';\n extraTweets = '<strong>$' + block_price/100 + '/' + block_size + ' ' + _t('components.modals.add-layer.imports.twitter.extra-tweets') + '</strong>' \n__p+='\\n';\n if (value <= remaining) { \n__p+='\\n  '+\n((__t=( _t('components.modals.add-layer.imports.twitter.credits-left', {\n    per: per,\n    remainingFormatted: remainingFormatted\n  }) ))==null?'':_.escape(__t))+\n'\\n';\n } else if (remaining <= 0 && !hardLimit) { \n__p+='\\n  '+\n((__t=( _t('components.modals.add-layer.imports.twitter.credits-consumed', {\n    extraTweets: extraTweets\n  }) ))==null?'':__t)+\n'\\n';\n } else { \n__p+='\\n  '+\n((__t=( _t('components.modals.add-layer.imports.twitter.credits-no-limit', {\n    extraTweets: extraTweets\n  }) ))==null?'':__t)+\n'\\n';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nrequire('jquery-ui');\nvar CreditsInfoView = require('./credits-info-view');\nvar DEFAULT_PER_VALUE = 80;\nvar MIN_PER_VALUE = 1;\n\n/**\n *  Set max use of credits for Twitter\n *\n *  - Slider range = 1000 credits\n *  - Last step should be infinite if user doesn't\n *    have \"soft_limit\".\n *\n */\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    if (!opts.userModel) throw new Error('userModel is required');\n    this._userModel = opts.userModel;\n    this.model = new Backbone.Model();\n    this._initBinds();\n    this._setModel();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this._destroySlider();\n    this._initViews();\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:value', this._onValueChange, this);\n  },\n\n  _setModel: function () {\n    var twitterData = this._userModel.get('twitter');\n    var max = twitterData.quota - twitterData.monthly_use;\n    var min = (MIN_PER_VALUE * max) / 100; // Just 1% of the quota\n    var defaultValue = (max * DEFAULT_PER_VALUE) / 100;\n    var value = max > 0 ? defaultValue : (max + 1);\n\n    this.model.set({\n      max: (twitterData.hard_limit ? max : max + 1),\n      min: min,\n      step: min,\n      value: max > 0 ? value : twitterData.quota,\n      disabled: max <= 0\n    });\n  },\n\n  _initViews: function () {\n    this.$('.js-slider').slider(\n      _.extend({\n        range: 'min',\n        orientation: 'horizontal',\n        slide: this._onSlideChange.bind(this),\n        change: this._onSlideChange.bind(this)\n      },\n        this.model.attributes\n      )\n    );\n\n    var creditsInfo = new CreditsInfoView({\n      el: this.$('.js-info'),\n      userModel: this._userModel,\n      model: this.model\n    });\n    creditsInfo.render();\n    this.addView(creditsInfo);\n  },\n\n  _onSlideChange: function (ev, ui) {\n    this.model.set('value', ui.value);\n  },\n\n  _onValueChange: function () {\n    this.trigger('maxCreditsChange', this.getMaxCredits(), this);\n  },\n\n  getMaxCredits: function () {\n    var twitterData = this._userModel.get('twitter');\n    var max = twitterData.quota - twitterData.monthly_use;\n    var value = this.model.get('value');\n    return value > max ? 0 : value;\n  },\n\n  _destroySlider: function () {\n    if (this.$('.js-slider').data('ui-slider')) {\n      this.$('.js-slider').slider('destroy');\n    }\n  },\n\n  clean: function () {\n    this._destroySlider();\n    CoreView.prototype.clean.call(this);\n  }\n\n});\n",
    "var _ = require('underscore');\nvar moment = require('moment');\nvar ImportView = require('../import-view');\nvar UploadModel = require('../../../../../../data/upload-model');\nvar DatesRangePickerView = require('../../../../../date-picker-range/date-picker-range-view');\nvar TwitterCategoriesView = require('./twitter-categories/twitter-categories-view');\nvar CreditsUsageView = require('./credits-usage-view.js');\nvar template = require('./import-twitter.tpl');\n\n/**\n *  Import twitter panel\n *\n *  - It accepts up to 3 categories\n *  - Date range can't be longer than 30 days\n *\n */\n\nmodule.exports = ImportView.extend({\n  options: {\n    acceptSync: false,\n    type: 'service',\n    service: 'twitter_search'\n  },\n\n  className: 'ImportPanel ImportTwitterPanel',\n\n  initialize: function (opts) {\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._userModel = opts.userModel;\n    this._configModel = opts.configModel;\n    this.model = new UploadModel({\n      type: this.options.type,\n      service_name: this.options.service\n    }, {\n      userModel: this._userModel,\n      configModel: this._configModel\n    });\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(\n      template({\n        currentGMT: moment().format('Z')\n      })\n    );\n    this._initViews();\n    return this;\n  },\n\n  _initViews: function () {\n    // Categories\n    var categories = this.categories = new TwitterCategoriesView();\n    categories.bind('changeCategory', this._setModel, this);\n    this.$('.ImportTwitterPanel-cagetories').append(categories.render().el);\n    this.addView(categories);\n\n    // Date picker\n    var datepicker = this.datepicker = new DatesRangePickerView({\n      className: 'DatePicker DatePicker--withBorder'\n    });\n    datepicker.bind('changeDate', this._setModel, this);\n    this.$('.js-picker').append(datepicker.render().el);\n    this.addView(datepicker);\n\n    // Use slider\n    var creditsUsage = this.creditsUsage = new CreditsUsageView({\n      el: this.$('.CreditsUsage'),\n      userModel: this._userModel\n    });\n    creditsUsage.bind('maxCreditsChange', this._setModel, this);\n    creditsUsage.render();\n    this.addView(creditsUsage);\n\n    this._setModel();\n  },\n\n  _initBinds: function () {\n    this.model.bind('change', this._triggerChange, this);\n  },\n\n  _getCategories: function () {\n    var categories = this.categories.getCategories();\n    return _.filter(categories, function (c) {\n      return c.category && c.terms.length > 0;\n    });\n  },\n\n  _getDates: function () {\n    return this.datepicker.getDates();\n  },\n\n  _getMaxCredits: function () {\n    return this.creditsUsage.getMaxCredits();\n  },\n\n  _setModel: function () {\n    var categories = this._getCategories();\n    var dates = this._getDates();\n    var maxCredits = this._getMaxCredits();\n    var d = {\n      categories: categories,\n      dates: dates\n    };\n\n    this.model.setUpload({\n      value: d,\n      service_item_id: d,\n      user_defined_limits: {\n        twitter_credits_limit: maxCredits\n      }\n    });\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"ImportPanel-header\">\\n  <h3 class=\"CDB-Text CDB-Size-large u-mainTextColor u-secondaryTextColor u-bSpace--m\">\\n    '+\n((__t=( _t('components.modals.add-layer.imports.twitter.title') ))==null?'':_.escape(__t))+\n'\\n  </h3>\\n  <p class=\"CDB-Text CDB-Size-medium u-altTextColor\">\\n    '+\n((__t=( _t('components.modals.add-layer.imports.twitter.terms-desc') ))==null?'':_.escape(__t))+\n'\\n  </p>\\n</div>\\n<div class=\"ImportPanel-body\">\\n  <form class=\"Form\">\\n    <div class=\"ImportTwitterPanel-cagetories\"></div>\\n    <div class=\"ImportTwitterPanel-datePicker\">\\n      <div class=\"Form-row\">\\n        <div class=\"Form-rowLabel\">\\n          <label class=\"CDB-Text CDB-Size-medium js-category\">'+\n((__t=( _t('components.modals.add-layer.imports.twitter.from-to') ))==null?'':_.escape(__t))+\n'</label>\\n        </div>\\n        <div class=\"Form-rowData Form-rowData--longer js-picker CDB-Text CDB-Size-medium\"></div>\\n        <div class=\"Form-rowInfo DatePicker-info\">\\n          <p class=\"CDB-Text CDB-Size-small u-altTextColor\">'+\n((__t=( _t('components.modals.add-layer.imports.twitter.twitter-gmt') ))==null?'':_.escape(__t))+\n' <br/>('+\n((__t=( _t('components.modals.add-layer.imports.twitter.your-gmt') ))==null?'':_.escape(__t))+\n''+\n((__t=( currentGMT ))==null?'':_.escape(__t))+\n')</p>\\n        </div>\\n      </div>\\n    </div>\\n    <div class=\"ImportTwitterPanel-creditsUsage\">\\n      <div class=\"Form-row\">\\n        <div class=\"Form-rowLabel\">\\n          <label class=\"CDB-Text CDB-Size-medium js-category\">'+\n((__t=( _t('components.modals.add-layer.imports.twitter.use') ))==null?'':_.escape(__t))+\n'</label>\\n        </div>\\n        <div class=\"Form-rowData Form-rowData--longer CreditsUsage\">\\n          <div class=\"UISlider CreditsUsage-slider js-slider\"></div>\\n          <div class=\"CreditsUsage-info CDB-Text CDB-Size-medium js-info\"></div>\\n        </div>\\n      </div>\\n    </div>\\n  </form>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar TwitterCategoryModel = require('./twitter-category-model');\n\n// Twitter categories collection\n\nmodule.exports = Backbone.Collection.extend({\n  model: TwitterCategoryModel\n});\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar $ = require('jquery');\nvar TwitterCategoriesCollection = require('./twitter-categories-collection');\nvar TwitterCategoriesModel = require('./twitter-category-model');\nvar TwitterCategoryView = require('./twitter-category-view');\n\n/**\n *  Twitter category list view\n *  - It will generate a collection to store all the\n *    terms added.\n */\n\nmodule.exports = CoreView.extend({\n  _MAX_CATEGORIES: 4,\n  _MAX_TERMS: 29,\n\n  initialize: function () {\n    // Add a first empty model\n    var m = this._generateCategory();\n    this.collection = new TwitterCategoriesCollection([ m ]);\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.collection.each(this._addCategory, this);\n    return this;\n  },\n\n  _initBinds: function () {\n    this.collection.bind('change', this._manageCategories, this);\n    this.collection.bind('change', this._onCategoryChange, this);\n    this.add_related_model(this.collection);\n  },\n\n  _manageCategories: function () {\n    var collection_size = this.collection.size();\n\n    // Check if already created models are completed\n    var nonFilled = this.collection.filter(function (m) {\n      return m.get('terms').length === 0;\n    });\n\n    // if so, generate new one\n    if (nonFilled.length === 0 && collection_size < this._MAX_CATEGORIES) {\n      var categoryModel = this._generateCategory();\n      this.collection.add(categoryModel);\n      this._addCategory(categoryModel);\n      return false;\n    }\n\n    // else, let's check\n    if (nonFilled.length > 0) {\n      var mdl = _.first(nonFilled);\n      var view = _.find(this._subviews, function (view) {\n        return mdl.cid === view.model.cid;\n      });\n      var pos = view.$el.index();\n\n      // Only one item in the collection, do nothing\n      if (collection_size === 1) return false;\n\n      // If it is the last item but there is no more items, do nothing\n      if (pos === (collection_size - 1)) return false;\n\n      // If it is not the last item and there is another non-filled element\n      // let's remove that one.\n      if (pos !== (collection_size - 1) && nonFilled.length > 1) {\n        mdl = nonFilled[1];\n        view = _.find(this._subviews, function (view) {\n          return mdl.cid === view.model.cid;\n        });\n        this._removeCategory(view);\n      }\n\n      // Reorder category indexes :(\n      this._sortCategoryIndex();\n    }\n  },\n\n  // Set proper index after any category removed\n  _sortCategoryIndex: function () {\n    var self = this;\n\n    // Hack to set properly category numbers\n    this.$('.twitter-category').each(function (i, el) {\n      // Get category, removing Category word\n      var category = $(el).find('.js-category').text().replace(_t('components.modals.add-layer.imports.twitter.category') + ' ', '');\n\n      if (category !== (i + 1)) {\n        // Find model\n        var m = self.collection.find(function (m) { return m.get('category') === category; });\n        // Find view\n        m.set('category', (i + 1).toString());\n      }\n    });\n  },\n\n  _generateCategory: function () {\n    return new TwitterCategoriesModel({\n      terms: [],\n      category: (this.collection ? (this.collection.size() + 1) : 1).toString()\n    });\n  },\n\n  _addCategory: function (m) {\n    var category = new TwitterCategoryView({ model: m });\n\n    category.bind('submit', this._onCategorySubmit, this);\n    category.bind('limit', this._onCategoryLimit, this);\n    category.bind('nolimit', this._onCategoryNoLimit, this);\n\n    this.$el.append(category.render().el);\n\n    this.addView(category);\n    this.trigger('addCategory');\n  },\n\n  _removeCategory: function (v) {\n    v.hide();\n    v.clean();\n    v.model.destroy();\n    this.trigger('removeCategory');\n  },\n\n  _onCategorySubmit: function () {\n    this.trigger('submitCategory', this.collection.toJSON(), this);\n  },\n\n  _onCategoryLimit: function () {\n    this.trigger('limitCategory', this.collection.toJSON(), this);\n  },\n\n  _onCategoryNoLimit: function () {\n    this.trigger('noLimitCategory', this.collection.toJSON(), this);\n  },\n\n  _onCategoryChange: function () {\n    this.trigger('changeCategory', this.collection.toJSON(), this);\n  },\n\n  getCategories: function () {\n    return this.collection.toJSON();\n  }\n\n});\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar TERMS_CHARS = 4;\n\n// Twitter category model\n\nmodule.exports = Backbone.Model.extend({\n  _MAX_COUNTER: 1014,\n\n  _CHAR_MAP: {\n    ' ': 2,\n    '-': 2,\n    '_': 2,\n    '.': 2\n  },\n\n  defaults: {\n    terms: [],\n    category: '',\n    counter: 1014\n  },\n\n  initialize: function () {\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this.bind('change:terms', this._setCounter, this);\n  },\n\n  _setCounter: function () {\n    var count = this._MAX_COUNTER;\n    var self = this;\n\n    // Check terms number\n    if (this.get('terms').length > 1) {\n      count = count - ((this.get('terms').length - 1) * TERMS_CHARS);\n    }\n\n    // Count characters\n    _.each(this.get('terms'), function (term) {\n      _.each(term, function (c) {\n        if (self._CHAR_MAP[c] !== undefined) {\n          count = count - self._CHAR_MAP[c];\n        } else {\n          count--;\n        }\n      });\n    });\n\n    // Count never should be less than 0 please!\n    this.set('counter', Math.max(0, count));\n  }\n\n});\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar $ = require('jquery');\nvar template = require('./twitter-category.tpl');\n\n/**\n *  Twitter category item view\n *  - It just needs a twitter category model\n */\n\nmodule.exports = CoreView.extend({\n  className: 'TwitterCategory',\n\n  _MAX_CATEGORIES: 4,\n  _MAX_TERMS: 29,\n\n  events: {\n    'keydown .js-terms': '_onInputChange',\n    'keypress .js-terms': '_onInputChange',\n    'keyup .js-terms': '_onInputChange'\n  },\n\n  initialize: function () {\n    this._initBinds();\n  },\n\n  render: function () {\n    this.$el.append(\n      template({\n        terms: this.model.get('terms'),\n        category: this.model.get('category'),\n        counter: this.model.get('counter')\n      })\n    );\n\n    this.show();\n\n    return this;\n  },\n\n  _initBinds: function () {\n    _.bindAll(this, '_onInputChange');\n    this.model.bind('change:category', this._onCategoryChange, this);\n  },\n\n  _onCategoryChange: function () {\n    this.$('.js-category').text(_t('components.modals.add-layer.imports.twitter.category') + ' ' + this.model.get('category'));\n  },\n\n  _onInputChange: function (e) {\n    var value = $(e.target).val();\n    var d = {};\n\n    if (e.keyCode === 13/* ENTER */) {\n      e.preventDefault();\n      this.trigger('submit', this.model, this);\n      return false;\n    }\n\n    this.$('.CDB-IconFont-twitter').toggleClass('is-highlighted', value.length > 0);\n\n    // Check if it is possible to add new characters\n    // if not, stop the action, unless user is deleting\n    // any previous character\n    if ((this.model.get('counter') === 0 || this.model.get('terms').length > this._MAX_TERMS) &&\n      e.keyCode !== 37 /* left */ && e.keyCode !== 39 /* right */ && e.keyCode !== 8 && value.length > 0) {\n      this.killEvent(e);\n      this.trigger('limit', this.model, this);\n      return false;\n    } else {\n      this.trigger('nolimit', this.model, this);\n    }\n\n    // Get valid terms array\n    if (!value) {\n      value = [];\n    } else {\n      value = value.split(',');\n    }\n\n    d['terms'] = value;\n\n    this.model.set(d);\n  },\n\n  show: function () {\n    this.$el.addClass('enabled');\n  },\n\n  hide: function () {\n    this.$el.removeClass('enabled');\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Form-row\">\\n  <div class=\"Form-rowLabel\">\\n    <label class=\"CDB-Text CDB-Size-medium js-category\">'+\n((__t=( _t('components.modals.add-layer.imports.twitter.category') ))==null?'':_.escape(__t))+\n' '+\n((__t=( category ))==null?'':_.escape(__t))+\n'</label>\\n  </div>\\n  <div class=\"Form-rowData Form-rowData--longer\">\\n    <input type=\"text\" class=\"CDB-Text CDB-Size-medium Form-input Form-input--longer has-icon js-terms\" value=\"'+\n((__t=( terms.join(\",\") ))==null?'':_.escape(__t))+\n'\" placeholder=\"'+\n((__t=( _t('components.modals.add-layer.imports.twitter.terms-placeholder') ))==null?'':_.escape(__t))+\n'\" />\\n    <i class=\"CDB-IconFont CDB-IconFont-twitter Form-inputIcon\"></i>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar UploadModel = require('../../../../../data/upload-model');\n\n/**\n *  Default view for an import item\n *\n *  - It is based in an upload model.\n *  - Will trigger a change when model changes.\n *  - It returns their data if it is requested with a method.\n */\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._configModel = opts.configModel;\n    this._userModel = opts.userModel;\n    this.model = new UploadModel(null, {\n      configModel: this._configModel,\n      userModel: this._userModel\n    });\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this.model.bind('change', this._triggerChange, this);\n  },\n\n  _triggerChange: function () {\n    this.trigger('change', this.model.toJSON(), this);\n  },\n\n  getModelData: function () {\n    if (this.model) {\n      return this.model.toJSON();\n    }\n    return {};\n  }\n\n});\n",
    "var cdb = require('cartodb.js');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar ViewFactory = require('../../../../view-factory');\nvar importViewTemplate = require('./imports.tpl');\nvar importTabViewTemplate = require('./import-tab.tpl');\nvar TipsyTooltipView = require('../../../../tipsy-tooltip-view');\nvar TabPaneView = require('../../../../tab-pane/tab-pane-view');\nvar TabPaneCollection = require('../../../../tab-pane/tab-pane-collection');\nvar _ = require('underscore');\nvar IMPORT_OPTIONS = require('./import-options');\nvar TABS_PER_ROW = 5;\nvar DEFAULT_IMPORT = 'file';\nvar ROW_WIDTH = 800;\n\n/**\n *  Imports view\n *\n *  Displays all the import options available\n *  through new create dialog.\n *\n *  IMPORTANT!!\n *\n *  If you need to add a new import pane:\n *\n *  - Create the proper class within imports folder and its tests.\n *  - Add necessary info in import_options file.\n *  - Create a check function here if needed, if not will appear\n *    always enabled (for everybody!).\n *\n */\n\nmodule.exports = CoreView.extend({\n  className: 'ImportOptions',\n\n  events: {\n    'click .js-goNext': '_moveToNextTabs',\n    'click .js-goPrev': '_moveToPrevTabs'\n  },\n\n  initialize: function (opts) {\n    if (!opts.createModel) throw new Error('createModel is required');\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._userModel = opts.userModel;\n    this._configModel = opts.configModel;\n    this._createModel = opts.createModel;\n    this.model = new Backbone.Model({\n      page: 1,\n      maxPages: 0\n    });\n  },\n\n  render: function () {\n    this._destroyBinds();\n    this.clearSubViews();\n    this.$el.empty();\n\n    this._generateContent();\n    this._generateNavigationTabs();\n    this._initBinds();\n    this._setOption();\n\n    return this;\n  },\n\n  // //////////////////\n  // TABS && PANES!  //\n  // //////////////////\n\n  _generateContent: function () {\n    var paneItems = [];\n\n    _.each(IMPORT_OPTIONS, function (importConfig, i) {\n      var obj = {};\n      if (!_.isEmpty(importConfig) && importConfig.enabled(this._configModel, this._userModel)) {\n        obj = {\n          name: importConfig.name,\n          selected: importConfig.name === 'file'\n        };\n\n        obj.createButtonView = function () {\n          return ViewFactory.createByTemplate(\n            importTabViewTemplate,\n            {\n              title: cdb.core.sanitize.html(importConfig.title || importConfig.name),\n              name: importConfig.name\n            },\n            {\n              tagName: 'button',\n              className: 'TabLink ' + 'js-' + importConfig.name + 'Tab'\n            }\n          );\n        };\n\n        var pane;\n\n        // Check if import option function exists\n        var fn = this['_check' + i + 'Import'];\n        var isEnabled;\n\n        if (fn) {\n          isEnabled = fn.bind(this)();\n        }\n\n        if ((isEnabled || isEnabled === undefined) && !_.isEmpty(importConfig)) {\n          var ImportView = importConfig.view;\n          pane = new ImportView(\n            _.extend(\n              importConfig.options || {},\n              {\n                userModel: this._userModel,\n                configModel: this._configModel,\n                title: importConfig.title\n              }\n            )\n          );\n        } else if (importConfig.fallback) {\n          pane = ViewFactory.createByTemplate(importConfig.fallback);\n        }\n\n        if (pane) {\n          pane.render();\n          pane.bind('change', this._setUploadModel, this);\n          obj.createContentView = function () {\n            return pane;\n          };\n        }\n\n        paneItems.push(obj);\n      }\n    }, this);\n\n    this._tabPaneCollection = new TabPaneCollection(paneItems);\n    this._tabPaneView = new TabPaneView({\n      template: importViewTemplate,\n      collection: this._tabPaneCollection,\n      tabPaneItemOptions: {\n        tagName: 'li',\n        className: 'ImportOptions-tab'\n      }\n    });\n    this.$el.append(this._tabPaneView.render().el);\n  },\n\n  _generateNavigationTabs: function () {\n    var numTabs = this.$('.ImportOptions-tab').size();\n    if (numTabs <= 1) {\n      this.$('.AddLayer-tabs').hide();\n    }\n\n    this.model.set('maxPages', Math.ceil(numTabs / TABS_PER_ROW));\n    this._checkNavigationTabs();\n    if (this.model.get('maxPages') <= 1) {\n      this.$('.ImportOptions-navigation').hide();\n    }\n  },\n\n  _moveToNextTabs: function () {\n    var page = this.model.get('page');\n    var maxPages = this.model.get('maxPages');\n\n    if (page < maxPages) {\n      this.model.set('page', page + 1);\n    }\n  },\n\n  _moveToPrevTabs: function () {\n    var page = this.model.get('page');\n    if (page > 1) {\n      this.model.set('page', page - 1);\n    }\n  },\n\n  _moveNavigationTabs: function () {\n    var page = this.model.get('page');\n    var rowWidth = ROW_WIDTH;\n\n    this.$('.js-menu').css('margin-left', '-' + (rowWidth * (page - 1)) + 'px');\n    this._checkNavigationTabs();\n  },\n\n  _checkNavigationTabs: function () {\n    var page = this.model.get('page');\n    var maxPages = this.model.get('maxPages');\n    this.$('.js-goPrev').toggleClass('is-disabled', page < 2);\n    this.$('.js-goNext').toggleClass('is-disabled', page >= maxPages);\n  },\n\n  _checkGDriveImport: function () {\n    if (!this._configModel.get('oauth_gdrive')) {\n      this._setFailedTab('gdrive', 'key');\n      return false;\n    }\n    return true;\n  },\n\n  _checkDropboxImport: function () {\n    if (!this._configModel.get('oauth_dropbox')) {\n      this._setFailedTab('dropbox', 'key');\n      return false;\n    }\n    return true;\n  },\n\n  _checkBoxImport: function () {\n    if (!this._configModel.get('oauth_box')) {\n      this._setFailedTab('box', 'key');\n      return false;\n    }\n    return true;\n  },\n\n  _checkTwitterImport: function () {\n    if (!this._configModel.get('datasource_search_twitter')) {\n      this._setFailedTab('twitter', 'key');\n      return false;\n    }\n\n    if (!this._userModel.get('twitter').enabled) {\n      return false;\n    }\n\n    if (!this._userModel.canCreateTwitterDataset()) {\n      this._setFailedTab('twitter', 'credits');\n      return false;\n    }\n    return true;\n  },\n\n  _checkInstagramImport: function () {\n    if (!this._userModel.featureEnabled('instagram_import')) {\n      return false;\n    }\n    if (!this._configModel.get('oauth_instagram')) {\n      this._setFailedTab('instagram', 'key');\n      return false;\n    }\n    return true;\n  },\n\n  _checkSalesforceImport: function () {\n    if (!this._userModel.get('salesforce').enabled) {\n      return false;\n    }\n    return true;\n  },\n\n  _checkMailchimpImport: function () {\n    if (!this._configModel.get('oauth_mailchimp')) {\n      this._setFailedTab('mailchimp', 'key');\n      return false;\n    }\n\n    if (!this._userModel.featureEnabled('mailchimp_import')) {\n      return false;\n    }\n    return true;\n  },\n\n  _setFailedTab: function (tabName, type) {\n    var $tab = this.$('.js-' + tabName + 'Tab');\n    $tab.addClass('disabled');\n\n    var tooltip = new TipsyTooltipView({\n      el: $tab,\n      title: function () {\n        return _t('components.modals.add-layer.imports.tab-options-error.' + type, { name: tabName });\n      }\n    });\n    this.addView(tooltip);\n  },\n\n  _setUploadModel: function (d) {\n    var uploadModel = this._createModel.getUploadModel();\n    uploadModel.setFresh(d);\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:page', this._moveNavigationTabs, this);\n    if (this._tabPaneCollection) {\n      this._tabPaneCollection.bind('change:selected', this._onTabChange, this);\n    }\n  },\n\n  _destroyBinds: function () {\n    if (this._tabPaneCollection) {\n      this._tabPaneCollection.bind('change:selected', null, this);\n    }\n  },\n\n  _setOption: function () {\n    // First option > data file\n    var tabPaneModel = _.first(this._tabPaneCollection.where({ name: DEFAULT_IMPORT }));\n    if (tabPaneModel) {\n      tabPaneModel.set('selected', true);\n      this._updateImportOption();\n    }\n  },\n\n  _updateImportOption: function () {\n    this._createModel.setActiveImportPane(this._tabPaneView.getSelectedTabPaneName());\n  },\n\n  // //////////\n  // Events //\n  // //////////\n\n  _onTabChange: function (tabModel) {\n    // var view = this._tabPaneView.getSelectedTabPane();\n    // Set upload model from activated pane to create model\n    // var upload = view.getModelData && view.getModelData();\n    // this._setUploadModel(upload || {});\n    this._updateImportOption();\n  },\n\n  clean: function () {\n    this._destroyBinds();\n    CoreView.prototype.clean.call(this);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"ImportOptions-navigation\">\\n  <button class=\"Carousel-Navigation CDB-Size-large ImportOptions-navigationButton ImportOptions-navigationButton--prev js-goPrev\">\\n    <i class=\"CDB-IconFont CDB-IconFont-arrowPrev u-actionTextColor\"></i>\\n  </button>\\n  <button class=\"Carousel-Navigation CDB-Size-large ImportOptions-navigationButton ImportOptions-navigationButton--next js-goNext\">\\n    <i class=\"CDB-IconFont CDB-IconFont-arrowNext u-actionTextColor\"></i>\\n  </button>\\n</div>\\n<div class=\"AddLayer-tabs\">\\n  <ul class=\"ImportOptions-tabsList js-menu CDB-Text CDB-Size-medium u-altTextColor\"></ul>\\n</div>\\n<div class=\"ImportOptions-panes js-content\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar DatasetsView = require('./datasets/datasets-view');\nvar ImportsView = require('./imports/imports-view');\nvar TabPaneView = require('../../../tab-pane/tab-pane-view');\nvar TabPaneCollection = require('../../../tab-pane/tab-pane-collection');\n\n/**\n *  Create listing view\n *\n *  It will display all the possibilities to select\n *  any of your current datasets or connect a new dataset.\n *\n */\nmodule.exports = CoreView.extend({\n  className: 'CreateDialog-listing CreateDialog-listing--noPaddingTop',\n\n  initialize: function (opts) {\n    if (!opts.createModel) throw new Error('createModel is required');\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._userModel = opts.userModel;\n    this._createModel = opts.createModel;\n    this._configModel = opts.configModel;\n\n    this._initBinds();\n    this._onChangeListing();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this._initViews();\n    return this;\n  },\n\n  _initBinds: function () {\n    // Bug with binding... do not work with the usual one for some reason :(\n    this._createModel.bind('change:listing', this._onChangeListing.bind(this));\n    this.add_related_model(this._createModel);\n  },\n\n  _initViews: function () {\n    var self = this;\n\n    var paneModels = [{\n      name: 'datasets',\n      selected: false,\n      createContentView: function () {\n        return new DatasetsView({\n          userModel: self._userModel,\n          createModel: self._createModel\n        });\n      }\n    }];\n\n    if (this._userModel.canCreateDatasets()) {\n      paneModels.push({\n        name: 'import',\n        selected: false,\n        createContentView: function () {\n          return new ImportsView({\n            userModel: self._userModel,\n            configModel: self._configModel,\n            createModel: self._createModel\n          });\n        }\n      });\n    }\n\n    this._tabPaneCollection = new TabPaneCollection(paneModels);\n    var paneTabPaneView = new TabPaneView({\n      collection: this._tabPaneCollection\n    });\n    this.addView(paneTabPaneView);\n    this.$el.append(paneTabPaneView.render().el);\n  },\n\n  _onChangeListing: function () {\n    if (this._tabPaneCollection) {\n      var context = this._createModel.get('listing');\n      var paneModel = _.first(this._tabPaneCollection.where({ name: context }));\n      paneModel.set('selected', true);\n    }\n  }\n});\n",
    "var cdb = require('cartodb.js');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar $ = require('jquery');\nvar _ = require('underscore');\nvar template = require('./navigation.tpl');\n\n/**\n *  Listing datasets navigation.\n *\n *  - 'Filter by' datasets.\n *  - 'Search' any pattern within dataset collection.\n *\n */\nmodule.exports = CoreView.extend({\n  events: {\n    'submit .js-search-form': '_submitSearch',\n    'keydown .js-search-form': '_onSearchKeyDown',\n    'click .js-search-form': 'killEvent',\n    'click .js-search-link': '_onSearchClick',\n    'click .js-clean-search': '_onCleanSearchClick',\n    'click .js-shared': '_onSharedClick',\n    'click .js-library': '_onLibraryClick',\n    'click .js-connect': '_onConnectClick',\n    'click .js-datasets': '_onDatasetsClick',\n    'click .js-create-empty': '_onCreateEmptyClick'\n  },\n\n  initialize: function (opts) {\n    if (!opts.createModel) throw new Error('createModel is required');\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.routerModel) throw new Error('routerModel is required');\n    if (!opts.tablesCollection) throw new Error('tablesCollection is required');\n\n    this._routerModel = opts.routerModel;\n    this._createModel = opts.createModel;\n    this._userModel = opts.userModel;\n    this._tablesCollection = opts.tablesCollection;\n    this.model = new Backbone.Model();\n\n    this._preRender();\n    this._initBinds();\n  },\n\n  // It is necessary to add two static elements because\n  // they can't be removed/replaced using render method\n  // each time a change (in a model or a collection) happens.\n  // This is due to the behaviour of the CSS animations.\n  _preRender: function () {\n    var $uInner = $('<div>').addClass('u-inner');\n    var $filtersInner = $('<div>').addClass('Filters-inner');\n    this.$el.append($uInner.append($filtersInner));\n  },\n\n  render: function (m, c) {\n    this.clearSubViews();\n\n    var selectedItemsCount = this._selectedItems().length;\n    // If a change is made from content type we have to know\n    // preventing show wrong data about total items\n    var changedContentType = c && c.changes && c.changes.content_type;\n\n    this.$('.Filters-inner').html(\n      template(\n        _.extend(\n          {\n            showDatasets: this._createModel.showDatasets(),\n            createModelType: this._createModel.get('type'),\n            canCreateDataset: this._userModel.canCreateDatasets(),\n            listingType: this._createModel.get('listing'),\n            isInsideOrg: this._userModel.isInsideOrg(),\n            totalShared: this._tablesCollection.getTotalStat('total_shared'),\n            totalItems: changedContentType ? 0 : this._tablesCollection.getTotalStat('total_user_entries'),\n            selectedItemsCount: selectedItemsCount\n          },\n          this._routerModel.attributes\n        )\n      )\n    );\n\n    this._animate();\n    if (this._routerModel.isSearching()) {\n      this._focusSearchInput();\n    }\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.on('change:isSearchEnabled', this._onChangeIsSearchEnabled, this);\n    this._createModel.bind('change:listing', this.render, this);\n    this._routerModel.bind('change', this.render, this);\n    this._tablesCollection.bind('sync', this.render, this);\n    this.add_related_model(this._createModel);\n    this.add_related_model(this._tablesCollection);\n    this.add_related_model(this._routerModel);\n  },\n\n  _onChangeIsSearchEnabled: function (model, isSearchEnabled) {\n    this._enableSearchUI(isSearchEnabled);\n\n    if (this._routerModel.isSearching()) {\n      this._cleanSearch();\n    } else if (isSearchEnabled) {\n      this._$searchInput().val('');\n      this._focusSearchInput();\n    }\n  },\n\n  _$searchInput: function () {\n    return this.$('.js-search-input');\n  },\n\n  _focusSearchInput: function () {\n    this._$searchInput()\n      .select()\n      .focus();\n  },\n\n  _onSearchKeyDown: function (e) {\n    if (e.keyCode === 27) { // ESC\n      this.killEvent(e);\n      this._cleanSearch();\n    }\n  },\n\n  _selectedItems: function () {\n    return this._tablesCollection.where({ selected: true });\n  },\n\n  _animate: function () {\n    this._enableSearchUI(!!this._routerModel.isSearching());\n\n    // Check if user doesn't have any table and it is in library section\n    // to remove useless shadow\n    var inLibrarySection = this._routerModel.get('library');\n    var inDatasetsSection = this._createModel.get('listing') === 'datasets';\n    var hasDatasets = this._tablesCollection.getTotalStat('total_user_entries') > 0;\n    this.$el.toggleClass('no-shadow', inLibrarySection && !hasDatasets && inDatasetsSection);\n  },\n\n  _enableSearchUI: function (enable) {\n    this.$('.js-search-field').toggle(enable);\n    this.$('.js-links-list').toggleClass('is-hidden', enable);\n    this.$('.js-order-list').toggleClass('is-hidden', enable);\n  },\n\n  _onDatasetsClick: function () {\n    this._routerModel.set({\n      shared: 'no',\n      library: false,\n      page: 1\n    });\n    this._createModel.set('listing', 'datasets');\n  },\n\n  _onSharedClick: function () {\n    this._routerModel.set({\n      shared: 'only',\n      library: false,\n      page: 1\n    });\n    this._createModel.set('listing', 'datasets');\n  },\n\n  _onLibraryClick: function () {\n    this._routerModel.set({\n      shared: 'no',\n      library: true,\n      page: 1\n    });\n    this._createModel.set('listing', 'datasets');\n  },\n\n  _onConnectClick: function () {\n    if (this._userModel.canCreateDatasets()) {\n      this._createModel.set('listing', 'import');\n    }\n  },\n\n  _onCreateEmptyClick: function () {\n    if (this._userModel.canCreateDatasets()) {\n      this._createModel.createFromScratch();\n    }\n  },\n\n  // Selection actions\n  _onSearchClick: function (e) {\n    this.killEvent(e);\n    this.model.set('isSearchEnabled', !this.model.get('isSearchEnabled'));\n  },\n\n  // Filter actions\n  _onCleanSearchClick: function (e) {\n    if (e) {\n      e.preventDefault();\n    }\n    this._cleanSearch();\n  },\n\n  _cleanSearch: function () {\n    this._routerModel.set({\n      q: '',\n      tag: '',\n      shared: 'no',\n      library: this._createModel.showLibrary()\n    });\n    this.model.set('isSearchEnabled', false);\n  },\n\n  _submitSearch: function (e) {\n    this.killEvent(e);\n    var val = cdb.core.sanitize.html(this.$('.js-search-input').val().trim());\n    var tag = val.search(':') === 0 ? val.replace(':', '') : '';\n    var q = val.search(':') !== 0 ? val : '';\n\n    this._routerModel.set({\n      page: 1,\n      tag: tag,\n      q: q,\n      shared: 'yes'\n    });\n\n    this._createModel.set('listing', 'datasets');\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<span class=\"Filters-separator\"></span>\\n\\n<div class=\"Filters-row\">\\n  <div class=\"Filters-group\">\\n    <div class=\"Filters-typeItem Filters-typeItem--searchEnabler js-search-enabler\">\\n      <button class=\"Filters-searchLink CDB-Text is-semibold u-upperCase CDB-Size-medium js-search-link\">\\n        <i class=\"Filters-searchLinkIcon CDB-IconFont CDB-IconFont-lens\"></i>'+\n((__t=( _t('components.modals.add-layer.navigation.search') ))==null?'':_.escape(__t))+\n'\\n      </button>\\n    </div>\\n\\n    <ul class=\"Filters-group js-links-list\">\\n      <li class=\"Filters-typeItem js-filter-type\">\\n        <button class=\"Filters-typeLink js-typeItem u-actionTextColor CDB-Text is-semibold u-upperCase CDB-Size-medium js-connect '+\n((__t=( listingType === 'import' ? 'is-selected' : '' ))==null?'':_.escape(__t))+\n' '+\n((__t=( !canCreateDataset ? 'is-disabled' : '' ))==null?'':_.escape(__t))+\n'\">\\n          '+\n((__t=( _t('components.modals.add-layer.navigation.connect-dataset') ))==null?'':_.escape(__t))+\n'\\n        </button>\\n      </li>\\n      ';\n if (showDatasets) { \n__p+='\\n        <li class=\"Filters-typeItem js-filter-type\">\\n          <button class=\"Filters-typeLink js-typeItem u-actionTextColor CDB-Text is-semibold u-upperCase CDB-Size-medium js-datasets '+\n((__t=( listingType === 'datasets' && shared !== 'only' && !library ? 'is-selected' : '' ))==null?'':_.escape(__t))+\n'\">\\n            ';\n if (totalItems) { \n__p+='\\n              <strong>'+\n((__t=( totalItems ))==null?'':_.escape(__t))+\n'</strong>\\n            ';\n } \n__p+='\\n            '+\n((__t=( _t('components.modals.add-layer.navigation.dataset-pluralize', { smart_count: totalItems }) ))==null?'':_.escape(__t))+\n'\\n          </button>\\n        </li>\\n        ';\n if (isInsideOrg) { \n__p+='\\n          <li class=\"Filters-typeItem js-filter-type\">\\n            <button class=\"Filters-typeLink js-typeItem u-actionTextColor CDB-Text is-semibold u-upperCase CDB-Size-medium js-shared '+\n((__t=( listingType === 'datasets' && shared === \"only\" ? 'is-selected' : '' ))==null?'':_.escape(__t))+\n'\">\\n              ';\n if (totalShared) { \n__p+='\\n                <strong>'+\n((__t=( totalShared ))==null?'':_.escape(__t))+\n'</strong>\\n              ';\n } \n__p+='\\n              '+\n((__t=( _t('components.modals.add-layer.navigation.shared-with-you') ))==null?'':_.escape(__t))+\n'\\n            </button>\\n          </li>\\n        ';\n } \n__p+='\\n      ';\n } \n__p+='\\n      <li class=\"Filters-typeItem js-filter-type\">\\n        <button class=\"Filters-typeLink js-typeItem u-actionTextColor CDB-Text is-semibold u-upperCase CDB-Size-medium js-library '+\n((__t=( listingType === 'datasets' && library ? 'is-selected' : '' ))==null?'':_.escape(__t))+\n'\">\\n          '+\n((__t=( _t('components.modals.add-layer.navigation.data-library') ))==null?'':_.escape(__t))+\n'\\n        </button>\\n      </li>\\n    </ul>\\n  </div>\\n\\n  <div class=\"Filters-typeItem Filters-typeItem--searchField js-search-field\">\\n    <form class=\"Filters-searchForm js-search-form\">\\n      <input class=\"Filters-searchInput CDB-Text CDB-Size-medium js-search-input\" type=\"text\" value=\"'+\n((__t=( ( tag && (':' + tag) ) || q ))==null?'':_.escape(__t))+\n'\" placeholder=\"'+\n((__t=( _t('components.modals.add-layer.navigation.search-placeholder') ))==null?'':_.escape(__t))+\n'\" />\\n      ';\n if (tag || q) { \n__p+='\\n        <button type=\"button\" class=\"Filters-cleanSearch js-clean-search u-actionTextColor\">\\n          <i class=\"CDB-IconFont CDB-IconFont-close\"></i>\\n        </button>\\n      ';\n } \n__p+='\\n    </form>\\n  </div>\\n\\n  <div class=\"Filters-addLayer js-order-list\">\\n    <button class=\"Filters-typeLink js-typeItem u-actionTextColor CDB-Text is-semibold u-upperCase CDB-Size-medium js-create-empty '+\n((__t=( listingType === 'scratch' ? 'is-selected' : '' ))==null?'':_.escape(__t))+\n' '+\n((__t=( !canCreateDataset ? 'is-disabled' : '' ))==null?'':_.escape(__t))+\n'\">\\n      '+\n((__t=( _t('components.modals.add-layer.navigation.create-empty-' + createModelType) ))==null?'':_.escape(__t))+\n'\\n    </button>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar GuessingTogglerView = require('./guessing-toggler-view');\nvar PrivacyTogglerView = require('./privacy-toggler-view');\nvar template = require('./footer.tpl');\n\n/**\n * Footer view for the add layer modal.\n */\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-ok': '_finish'\n  },\n\n  initialize: function (opts) {\n    if (!opts.createModel) throw new TypeError('createModel is required');\n    if (!opts.userModel) throw new TypeError('userModel is required');\n    if (!opts.configModel) throw new TypeError('configModel is required');\n\n    this._createModel = opts.createModel;\n    this._userModel = opts.userModel;\n    this._configModel = opts.configModel;\n    this._guessingModel = new Backbone.Model({\n      guessing: true\n    });\n    this._privacyModel = new Backbone.Model({\n      privacy: this._userModel.canCreatePrivateDatasets() ? 'PRIVATE' : 'PUBLIC'\n    });\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(\n      template({\n        canFinish: this._createModel.canFinish(),\n        listing: this._createModel.get('listing')\n      })\n    );\n    this._initViews();\n    return this;\n  },\n\n  _initViews: function () {\n    var guessingTogglerView = new GuessingTogglerView({\n      guessingModel: this._guessingModel,\n      createModel: this._createModel,\n      configModel: this._configModel\n    });\n    this.$('.js-footer-info').append(guessingTogglerView.render().el);\n    this.addView(guessingTogglerView);\n\n    var privacyTogglerView = new PrivacyTogglerView({\n      privacyModel: this._privacyModel,\n      userModel: this._userModel,\n      createModel: this._createModel,\n      configModel: this._configModel\n    });\n    this.$('.js-footerActions').prepend(privacyTogglerView.render().el);\n    this.addView(privacyTogglerView);\n  },\n\n  _initBinds: function () {\n    var uploadModel = this._createModel.getUploadModel();\n    uploadModel.bind('change', this.render, this);\n    var selectedDatasetsCollection = this._createModel.getSelectedDatasetsCollection();\n    selectedDatasetsCollection.bind('all', this._update, this);\n    this._createModel.bind('change', this._update, this);\n    this.add_related_model(uploadModel);\n    this.add_related_model(selectedDatasetsCollection);\n    this.add_related_model(this._createModel);\n  },\n\n  _update: function () {\n    var contentPane = this._createModel.get('contentPane');\n    var listing = this._createModel.get('listing');\n    if (contentPane === 'listing' && listing !== 'scratch') {\n      this.render().show();\n    } else {\n      this.hide();\n    }\n  },\n\n  _finish: function (e) {\n    this.killEvent(e);\n    if (this._createModel.canFinish()) {\n      // Set proper guessing values before starting the upload\n      // if dialog is in import section\n      if (this._createModel.get('listing') === 'import') {\n        var uploadModel = this._createModel.getUploadModel();\n        uploadModel.setPrivacy(this._privacyModel.get('privacy'));\n        uploadModel.setGuessing(this._guessingModel.get('guessing'));\n      }\n      this._createModel.finish();\n    }\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CreateDialog-footerShadow\"></div>\\n<div class=\"CreateDialog-footerLine\"></div>\\n<div class=\"CreateDialog-footerInner u-flex u-justifySpace u-alignCenter\">\\n  <div class=\"js-footer-info CreateDialog-footerInfo u-secondaryTextColor\">\\n  </div>\\n  <div class=\"CreateDialog-footerActions js-footerActions\">\\n    <button class=\"js-ok CDB-Button CDB-Button--primary '+\n((__t=( canFinish ? '' : 'is-disabled' ))==null?'':_.escape(__t))+\n'\">\\n      <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-small u-upperCase\">'+\n((__t=( _t('components.modals.add-layer.footer.add-layer') ))==null?'':_.escape(__t))+\n'</span>\\n    </button>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./guessing-toggler.tpl');\n\n/**\n * Manages if upcoming import should guess or not.\n * Expected to be rendered in the footer of a create dialog.\n */\n\nmodule.exports = CoreView.extend({\n\n  events: {\n    'click .js-toggle': '_toggle'\n  },\n\n  initialize: function (opts) {\n    if (!opts.createModel) throw new Error('createModel is required');\n    if (!opts.guessingModel) throw new Error('guessingModel is required');\n    if (!opts.configModel) throw new TypeError('configModel is required');\n\n    this._configModel = opts.configModel;\n    this._createModel = opts.createModel;\n    this.model = opts.guessingModel;\n    this._initBinds();\n  },\n\n  render: function () {\n    var htmlStr = '';\n    if (this._createModel.showGuessingToggler()) {\n      var uploadModel = this._createModel.getUploadModel();\n      htmlStr = template({\n        isGuessingEnabled: this.model.get('guessing'),\n        importState: this._createModel.getImportState(),\n        isUploadValid: uploadModel.isValidToUpload(),\n        customHosted: this._configModel.get('cartodb_com_hosted')\n      });\n    }\n    this.$el.html(htmlStr);\n    return this;\n  },\n\n  _initBinds: function () {\n    this._createModel.bind('change', this.render, this);\n    this.model.bind('change', this.render, this);\n    this.add_related_model(this._createModel);\n  },\n\n  _toggle: function () {\n    var value = !this.model.get('guessing');\n    this.model.set('guessing', value);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='';\n if (importState !== \"twitter\") { \n__p+='\\n  <div class=\"u-iBlock CDB-Text CDB-Size-medium u-rSpace--xl js-toggle\">\\n    <input class=\"CDB-Checkbox\" type=\"checkbox\" '+\n((__t=( isGuessingEnabled ? 'checked' : '' ))==null?'':_.escape(__t))+\n'>\\n    <span class=\"u-iBlock CDB-Checkbox-face\"></span>\\n    <label class=\"u-iBlock u-lSpace\">'+\n((__t=( _t('components.modals.add-layer.footer.guessing-desc') ))==null?'':_.escape(__t))+\n'</label>\\n  </div>\\n';\n } else if (!customHosted) { \n__p+='\\n  <span class=\"CDB-Text CDB-Size-medium\">\\n    '+\n((__t=( _t('components.modals.add-layer.footer.twitter-desc') ))==null?'':_.escape(__t))+\n'\\n    <a href=\"mailto:support@carto.com\">'+\n((__t=( _t('components.modals.add-layer.footer.contact-team') ))==null?'':_.escape(__t))+\n'</a>\\n  </span>\\n';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar $ = require('jquery');\nvar template = require('./privacy-toggler.tpl');\nvar TipsyTooltipView = require('../../../tipsy-tooltip-view');\nvar publicPrivacy = 'PUBLIC';\nvar privatePrivacy = 'PRIVATE';\n\n/**\n *  Change the privacy of the new dataset.\n *  - If the user can't change the privacy, it will refer to the upgrade page\n *   unless app is the \"open source\" version\n *\n */\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click': '_onClick'\n  },\n\n  initialize: function (opts) {\n    if (!opts.createModel) throw new Error('createModel is required');\n    if (!opts.privacyModel) throw new Error('privacyModel is required');\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.configModel) throw new TypeError('configModel is required');\n\n    this._configModel = opts.configModel;\n    this.model = opts.privacyModel;\n    this._userModel = opts.userModel;\n    this._createModel = opts.createModel;\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n\n    if (this._createModel.showPrivacyToggler()) {\n      var canChangePrivacy = this._userModel.canCreatePrivateDatasets();\n      var privacy = this.model.get('privacy');\n      var isPublic = privacy === publicPrivacy;\n      var nextPrivacy = isPublic ? privatePrivacy : publicPrivacy;\n      var icon = isPublic ? 'unlock' : 'lock';\n      var upgradeUrl = this._configModel.get('upgrade_url') || window.upgrade_url;\n      var canUpgrade = !this._configModel.get('cartodb_com_hosted') && !canChangePrivacy && upgradeUrl;\n\n      this.$el.html(\n        template({\n          privacy: privacy,\n          isDisabled: !canChangePrivacy,\n          canUpgrade: canUpgrade,\n          nextPrivacy: nextPrivacy,\n          upgradeUrl: upgradeUrl,\n          icon: icon\n        })\n      );\n\n      this._initViews();\n    }\n\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:privacy', this.render, this);\n  },\n\n  _initViews: function () {\n    // Tooltip\n    this.addView(\n      new TipsyTooltipView({\n        el: this.$('.js-toggler'),\n        html: true,\n        title: function () {\n          return $(this).attr('data-title');\n        }\n      })\n    );\n  },\n\n  _onClick: function () {\n    if (this._userModel.canCreatePrivateDatasets()) {\n      var privacy = this.model.get('privacy');\n      this.model.set('privacy', privacy === publicPrivacy ? privatePrivacy : publicPrivacy);\n      return;\n    }\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='';\n if (canUpgrade) { \n__p+='\\n  <a href=\"'+\n((__t=( upgradeUrl ))==null?'':_.escape(__t))+\n'\" class=\"PrivacyToggler js-toggler PrivacyToggler--'+\n((__t=( privacy ))==null?'':_.escape(__t))+\n' is-disabled\"\\n    data-title=\"'+\n((__t=( _t('components.modals.add-layer.footer.privacy-change-not-allowed') ))==null?'':_.escape(__t))+\n'\">\\n    <i class=\"CDB-IconFont CDB-IconFont-'+\n((__t=( icon ))==null?'':_.escape(__t))+\n'\"></i>\\n  </a>\\n';\n } else {\n__p+='\\n  <button type=\"button\" class=\"PrivacyToggler js-toggler PrivacyToggler--'+\n((__t=( privacy ))==null?'':_.escape(__t))+\n' '+\n((__t=( isDisabled ? 'is-disabled' : '' ))==null?'':_.escape(__t))+\n'\"\\n    data-title=\"\\n      ';\n if (!isDisabled) { \n__p+='\\n        '+\n((__t=( _t('components.modals.add-layer.footer.privacy-change', { privacy: privacy.toLowerCase() }) ))==null?'':_.escape(__t))+\n'.<br />'+\n((__t=( _t('components.modals.add-layer.footer.privacy-click', { nextPrivacy: nextPrivacy.toLowerCase() }) ))==null?'':_.escape(__t))+\n'.\\n      ';\n } else { \n__p+='\\n        '+\n((__t=( _t('components.modals.add-layer.footer.privacy-change-banned') ))==null?'':_.escape(__t))+\n'\\n      ';\n } \n__p+='\\n    \">\\n    <i class=\"CDB-IconFont CDB-IconFont-'+\n((__t=( icon ))==null?'':_.escape(__t))+\n'\"></i>\\n  </button>\\n';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar createTuplesItems = require('./create-tuples-items');\nvar widgetsTypes = require('./widgets-types');\nvar BodyView = require('./body-view');\nvar template = require('./add-widgets.tpl');\nvar renderLoading = require('../../../components/loading/render-loading');\nvar TableStats = require('./tablestats.js');\n\n/**\n * View to add new widgets.\n * Expected to be rendered in a modal.\n */\nmodule.exports = CoreView.extend({\n  className: 'Dialog-content Dialog-content--expanded',\n\n  events: {\n    'click .js-continue': '_onContinue'\n  },\n\n  initialize: function (opts) {\n    if (!opts.userActions) throw new Error('userActions is required');\n    if (!opts.modalModel) throw new Error('modalModel is required');\n    if (!opts.layerDefinitionsCollection) throw new Error('layerDefinitionsCollection is required');\n    if (!opts.widgetDefinitionsCollection) throw new Error('widgetDefinitionsCollection is required');\n    if (!opts.analysisDefinitionNodesCollection) throw new Error('analysisDefinitionNodesCollection is required');\n\n    this._userActions = opts.userActions;\n    this._modalModel = opts.modalModel;\n    this._layerDefinitionsCollection = opts.layerDefinitionsCollection;\n    this._widgetDefinitionsCollection = opts.widgetDefinitionsCollection;\n    this._analysisDefinitionNodesCollection = opts.analysisDefinitionNodesCollection;\n    this._optionsCollection = new Backbone.Collection();\n    this.tableStats = new TableStats({\n      configModel: opts.configModel,\n      userModel: opts.userModel\n    });\n\n    this._analysisDefinitionNodesCollection.each(function (m) {\n      m = m.querySchemaModel;\n      m.on('change', this._onQuerySchemaChange, this);\n      this.add_related_model(m);\n      m.fetch();\n    }, this);\n\n    this.listenTo(this._optionsCollection, 'change:selected', this._updateContinueButtonState);\n    this.add_related_model(this._optionsCollection);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template());\n\n    if (this._hasFetchedAllQuerySchemas()) {\n      this._renderBodyView();\n    } else {\n      this._renderLoadingView();\n    }\n\n    this._updateContinueButtonState();\n\n    return this;\n  },\n\n  _onQuerySchemaChange: function () {\n    if (this._hasFetchedAllQuerySchemas()) {\n      this.render();\n    }\n  },\n\n  _hasFetchedAllQuerySchemas: function () {\n    return this._analysisDefinitionNodesCollection.all(function (m) {\n      return m.querySchemaModel.get('status') !== 'fetching';\n    });\n  },\n\n  _onContinue: function () {\n    var selectedOptionModels = this._optionsCollection.filter(this._isSelected);\n\n    if (selectedOptionModels.length > 0) {\n      _.map(selectedOptionModels, function (selectedOptionModel) {\n        this._userActions.saveWidgetOption(selectedOptionModel);\n      }, this);\n      this._modalModel.destroy();\n    }\n  },\n\n  _renderBodyView: function () {\n    this._createOptionsModels();\n    var view = new BodyView({\n      el: this._$body(),\n      optionsCollection: this._optionsCollection,\n      widgetsTypes: widgetsTypes\n    });\n    this.addView(view.render());\n  },\n\n  _renderLoadingView: function () {\n    this._$body().html(\n      renderLoading({\n        title: _t('components.modals.add-widgets.loading-title')\n      })\n    );\n  },\n\n  _$body: function () {\n    return this.$('.js-body');\n  },\n\n  _updateContinueButtonState: function () {\n    this.$('.js-continue').toggleClass('is-disabled', !this._optionsCollection.any(this._isSelected));\n  },\n\n  _isSelected: function (m) {\n    return !!m.get('selected');\n  },\n\n  _createOptionsModels: function () {\n    var self = this;\n    this._optionsCollection.reset();\n    var tuplesItems = createTuplesItems(this._analysisDefinitionNodesCollection, this._layerDefinitionsCollection);\n\n    _.each(widgetsTypes, function (d) {\n      var models = d.createOptionModels(tuplesItems, this._widgetDefinitionsCollection);\n      models = models.map(function (m) { m.stats = self.tableStats; return m; });\n      this._optionsCollection.add(models);\n    }, this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Modal\">\\n  <div class=\"Modal-header\">\\n    <div class=\"Modal-headerContainer\">\\n      <h2 class=\"CDB-Text CDB-Size-huge is-light u-mainTextColor u-bSpace\">'+\n((__t=( _t('components.modals.add-widgets.modal-title') ))==null?'':_.escape(__t))+\n'</h2>\\n      <h3 class=\"CDB-Text CDB-Size-medium u-altTextColor\">'+\n((__t=( _t('components.modals.add-widgets.modal-desc') ))==null?'':_.escape(__t))+\n'</h3>\\n    </div>\\n  </div>\\n  <div class=\"Modal-container js-body\">\\n    \\n  </div>\\n  <div class=\"Modal-footer\">\\n    <div class=\"Modal-footerContainer u-flex u-justifyEnd\">\\n      <button class=\"CDB-Button CDB-Button--primary is-disabled js-continue\">\\n        <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">'+\n((__t=( _t('components.modals.add-widgets.continue-btn') ))==null?'':_.escape(__t))+\n'</span>\\n      </button>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar createTemplateTabPane = require('../../tab-pane/create-template-tab-pane');\nvar tabPaneButtonTemplate = require('./tab-pane-button-template.tpl');\nvar tabPaneTemplate = require('./tab-pane-template.tpl');\n\n/**\n * View to select widget options to create.\n */\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    if (!opts.optionsCollection) throw new Error('optionsCollection is required');\n    if (!opts.widgetsTypes) throw new Error('widgetsTypes is required');\n\n    // Only render tab items for types that have option models available\n    var availableTypes = _.unique(opts.optionsCollection.pluck('type'));\n    this._tabPaneItems = _\n      .reduce(opts.widgetsTypes, function (memo, d) {\n        if (_.contains(availableTypes, d.type)) {\n          var tabPaneItem = d.createTabPaneItem(opts.optionsCollection);\n          memo.push(tabPaneItem);\n        }\n        return memo;\n      }, []);\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    var options = {\n      tabPaneOptions: {\n        template: tabPaneTemplate,\n        tabPaneItemOptions: {\n          tagName: 'li',\n          className: 'CDB-NavMenu-item'\n        }\n      },\n      tabPaneTemplateOptions: {\n        tagName: 'button',\n        className: 'CDB-NavMenu-link u-upperCase',\n        template: tabPaneButtonTemplate\n      }\n    };\n\n    var view = createTemplateTabPane(this._tabPaneItems, options);\n    this.addView(view);\n    this.$el.append(view.render().el);\n    return this;\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"Widget-categoryFakeText\"></p>\\n<div class=\"Widget-categoryFake\"></div>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar WidgetOptionModel = require('../widget-option-model');\nvar WidgetDefinitionModel = require('../../../../data/widget-definition-model');\n\nmodule.exports = WidgetOptionModel.extend({\n  defaults: _.defaults({type: 'category'}, WidgetOptionModel.defaults),\n\n  save: function (widgetDefinitionsCollection) {\n    var columnName = this.columnName();\n    var model = this;\n    var styleModel = this.layerDefinitionModel() && this.layerDefinitionModel().styleModel;\n    var isAllowed = styleModel && styleModel.canApplyAutoStyle() || false;\n\n    widgetDefinitionsCollection.trigger('loading', model);\n\n    var attrs = {\n      type: 'category',\n      layer_id: this.layerDefinitionModel().id,\n      source: {\n        id: this.analysisDefinitionNodeModel().id\n      },\n      options: {\n        column: columnName,\n        aggregation_column: columnName,\n        aggregation: this.get('aggregation'),\n        title: this.get('title')\n      },\n      style: {\n        widget_style: {\n          definition: WidgetDefinitionModel.getDefaultWidgetStyle('category')\n        },\n        auto_style: {\n          allowed: isAllowed,\n          custom: false\n        }\n      }\n    };\n\n    return widgetDefinitionsCollection.create(attrs, {\n      wait: true,\n      success: function (mdl, attrs) {\n        widgetDefinitionsCollection.trigger('success', model);\n      },\n      error: function (mdl, e) {\n        widgetDefinitionsCollection.trigger('error', model, e);\n      }\n    });\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar LayerSelectorView = require('../layer-selector-view');\nvar template = require('./category-option.tpl');\nvar categoryFake = require('./category-fake.tpl');\n\n/**\n * View for an individual category option.\n */\nmodule.exports = CoreView.extend({\n\n  events: {\n    'click .js-checkbox': '_onSelect'\n  },\n\n  initialize: function (opts) {\n    this.listenTo(this.model, 'change:layer_index', this.render);\n    this.listenTo(this.model, 'change:selected', this.render);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(this._html());\n    this._renderLayerSelector();\n    var tableStats = this.options.model.stats;\n    if (tableStats) {\n      this._drawGraph();\n    }\n    return this;\n  },\n\n  _html: function () {\n    return template({\n      columnName: this.model.columnName(),\n      isSelected: !!this.model.get('selected')\n    });\n  },\n\n  _renderLayerSelector: function () {\n    var view = new LayerSelectorView({\n      model: this.model\n    });\n    this.addView(view);\n    this.$('.js-inner').append(view.render().el);\n  },\n\n  _onSelect: function () {\n    this.model.set('selected', !this.model.get('selected'));\n  },\n\n  _drawGraph: function () {\n    var self = this;\n    this.options.model.stats.graphFor(\n      this.model.analysisDefinitionNodeModel().get('table_name'),\n      this.model.get('name'), function (graph) {\n        if (graph.stats && graph.stats.freqs) {\n          self.$('.js-Category-bar').append(graph.getCategory({\n            color: '#9DE0AD',\n            width: 240,\n            height: 10\n          }));\n          var stats = self.$('.js-catstats').children();\n          self.$(stats[0]).text(graph.getNullsPercentage() + '% null');\n          self.$(stats[1]).text((graph.getPercentageInTopCategories() * 100).toFixed(2) + _t('components.modals.add-widgets.percentage-in-top-cats'));\n          self.$('.js-catstats').css('display', 'flex');\n        } else {\n          self.$('.js-Category-bar').append(categoryFake());\n        }\n      }\n    );\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"WidgetList-option\">\\n  <input class=\"CDB-Checkbox js-checkbox\" type=\"checkbox\" ';\n if (isSelected) { \n__p+='checked=\"checked\"';\n } \n__p+=' />\\n  <span class=\"u-iBlock CDB-Checkbox-face\"></span>\\n</div>\\n\\n<div class=\"WidgetList-inner js-inner\">\\n  <h3 class=\"u-ellipsis CDB-Text CDB-Size-large u-bSpace--m\">'+\n((__t=( columnName ))==null?'':_.escape(__t))+\n'</h3>\\n  <ul class=\"js-catstats u-flex CDB-Text CDB-Size-small u-secondaryTextColor u-upperCase\">\\n    <li class=\\'u-rSpace--m\\'></li>\\n    <li class=\\'u-rSpace--m\\'></li>\\n  </ul>\\n  <div class=\"u-bSpace--m js-Category-bar\">\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar CategoryOptionView = require('./category-option-view.js');\n\n/**\n * View to select category widget options\n */\nmodule.exports = CoreView.extend({\n\n  tagName: 'ul',\n  className: 'WidgetList',\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this.collection\n      .chain()\n      .filter(this._isCategory)\n      .each(this._renderOption, this);\n    return this;\n  },\n\n  _renderOption: function (m) {\n    var view = new CategoryOptionView({\n      tagName: 'li',\n      className: 'WidgetList-item',\n      model: m\n    });\n    this.addView(view);\n    this.$el.append(view.render().el);\n  },\n\n  _isCategory: function (m) {\n    return m.get('type') === 'category';\n  }\n\n});\n",
    "var _ = require('underscore');\n\nvar BLACKLISTED_COLUMNS = ['created_at', 'the_geom', 'the_geom_webmercator', 'updated_at'];\n\n/**\n * Tmp data structure with column and layer-def models for each unique name+type tuple.\n * Each bucket contains a columnModel and layerDefinitionModel tuple,\n * since they are unique even if the columns' name+type happen to be the same\n * From this widget definition options for specific needs\n *\n * @param {Object} layerDefinitionsCollection\n * @return {Object} e.g.\n *   e.g.\n *     {\n *       foobar-string: [{\n *         columnModel: M({name: 'foobar', type: 'string', }),\n *         layerDefinitionModel: M({ id: 'abc-123',  })\n *       }]\n *     }\n */\nmodule.exports = function (analysisDefinitionNodesCollection, layerDefinitionsCollection) {\n  return analysisDefinitionNodesCollection\n    .reduce(function (tuplesItems, nodeDefModel) {\n      var layerDefinitionModel = layerDefinitionsCollection.find(function (l) { return l.isOwnerOfAnalysisNode(nodeDefModel); });\n      if (!layerDefinitionModel) return tuplesItems; // e.g. if the node is one of those temporary tables\n\n      var querySchemaModel = nodeDefModel.querySchemaModel;\n      var queryGeometryModel = nodeDefModel.queryGeometryModel;\n      if (!querySchemaModel || !queryGeometryModel) return tuplesItems;\n      if (!queryGeometryModel.hasValue()) return tuplesItems;\n\n      querySchemaModel.columnsCollection.each(function (m) {\n        var columnName = m.get('name');\n\n        if (!_.contains(BLACKLISTED_COLUMNS, columnName)) {\n          var key = columnName + '-' + m.get('type');\n          var tuples = tuplesItems[key] = tuplesItems[key] || [];\n          tuples.push({\n            analysisDefinitionNodeModel: nodeDefModel,\n            layerDefinitionModel: layerDefinitionModel,\n            columnModel: m\n          });\n        }\n      });\n\n      return tuplesItems;\n    }, {});\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\\'Widget-formulaFakeContainer\\'>\\n  <p class=\\'Widget-categoryFakeText\\'></p>\\n  <div class=\\'Widget-formulaFake\\'></div>\\n</div>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar WidgetOptionModel = require('../widget-option-model');\n\nmodule.exports = WidgetOptionModel.extend({\n  defaults: _.defaults({type: 'formula'}, WidgetOptionModel.defaults),\n\n  save: function (widgetDefinitionsCollection) {\n    var model = this;\n    widgetDefinitionsCollection.trigger('loading', model);\n\n    var attrs = {\n      type: 'formula',\n      layer_id: this.layerDefinitionModel().id,\n      source: {\n        id: this.analysisDefinitionNodeModel().id\n      },\n      options: {\n        column: this.columnName(),\n        title: this.get('title'),\n        operation: this.get('operation')\n      }\n    };\n\n    return widgetDefinitionsCollection.create(attrs, {\n      wait: true,\n      success: function (mdl, attrs) {\n        widgetDefinitionsCollection.trigger('success', model);\n      },\n      error: function (mdl, e) {\n        widgetDefinitionsCollection.trigger('error', model, e);\n      }\n    });\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar LayerSelectorView = require('../layer-selector-view');\nvar template = require('./formula-option.tpl');\nvar formulaFake = require('./formula-fake.tpl');\nvar _ = require('underscore');\n\n/**\n * View for an individual formula option.\n */\nmodule.exports = CoreView.extend({\n\n  events: {\n    'click .js-checkbox': '_onSelect'\n  },\n\n  initialize: function (opts) {\n    this.listenTo(this.model, 'change:layer_index', this.render);\n    this.listenTo(this.model, 'change:selected', this.render);\n    this.aggregation = this.model.get('operation');\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(this._html());\n    this._renderLayerSelector();\n    var tableStats = this.options.model.stats;\n    if (tableStats) {\n      this._drawGraph();\n    }\n    return this;\n  },\n\n  _html: function () {\n    return template({\n      columnName: this.model.get('title'),\n      isSelected: !!this.model.get('selected')\n    });\n  },\n\n  _renderLayerSelector: function () {\n    var view = new LayerSelectorView({\n      model: this.model\n    });\n    this.addView(view);\n    this.$('.js-inner').append(view.render().el);\n  },\n\n  _onSelect: function () {\n    this.model.set('selected', !this.model.get('selected'));\n  },\n\n  _drawGraph: function () {\n    var self = this;\n    this.options.model.stats.graphFor(\n      this.model.analysisDefinitionNodeModel().get('table_name'),\n      this.model.get('name'), function (graph) {\n        if (graph.stats) {\n          var stats = self.$('.js-formulastats').children();\n          var aggregation = graph[{ // eslint-disable-line\n            'avg': 'getAverage',\n            'sum': 'getSum',\n            'min': 'getMin',\n            'max': 'getMax',\n            'count': 'getCount'\n          }[self.aggregation]]();\n          if (_.isNumber(aggregation)) {\n            self.$(stats[0]).text(graph.getNullsPercentage() + '% null');\n            if (self.aggregation === 'count') {\n              self.$(stats[1]).text(aggregation.toFixed().toString());\n            } else {\n              self.$(stats[1]).text(aggregation.toFixed(2).toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ','));\n            }\n            self.$('.js-formulastats').show();\n          } else {\n            self.$('.js-formulastats').append(formulaFake());\n            self.$('.js-formulastats').show();\n          }\n        } else {\n          self.$('.js-formulastats').append(formulaFake());\n          self.$('.js-formulastats').show();\n        }\n      }\n    );\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"WidgetList-option\">\\n  <input class=\"CDB-Checkbox js-checkbox\" type=\"checkbox\" ';\n if (isSelected) { \n__p+='checked=\"checked\"';\n } \n__p+=' />\\n  <span class=\"u-iBlock CDB-Checkbox-face\"></span>\\n</div>\\n\\n<div class=\"WidgetList-inner js-inner\">\\n  <h3 class=\"u-ellipsis CDB-Text CDB-Size-large u-bSpace--m\">'+\n((__t=( columnName ))==null?'':_.escape(__t))+\n'</h3>\\n  <div class=\"js-formulastats\" style=\"display: none;\">\\n    <ul class=\"u-flex CDB-Text CDB-Size-small u-secondaryTextColor u-upperCase\">\\n      <li class=\\'u-rSpace\\'></li>\\n    </ul>\\n  \t<h4 class=\"CDB-Text CDB-Size-huge u-bSpace--m\"></h4>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar FormulaOptionView = require('./formula-option-view.js');\n\n/**\n * View to select formula widget options\n */\nmodule.exports = CoreView.extend({\n\n  className: 'WidgetList',\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this.collection\n      .chain()\n      .filter(this._isFormula)\n      .each(this._renderOption, this);\n    return this;\n  },\n\n  _renderOption: function (m) {\n    var view = new FormulaOptionView({\n      className: 'WidgetList-item',\n      model: m\n    });\n    this.addView(view);\n    this.$el.append(view.render().el);\n  },\n\n  _isFormula: function (m) {\n    return m.get('type') === 'formula';\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Widget-histogramFakeContainer\">\\n  <p class=\"Widget-categoryFakeText\"></p>\\n  <div class=\"Widget-histogramFake\"></div>\\n</div>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar WidgetOptionModel = require('../widget-option-model');\nvar WidgetDefinitionModel = require('../../../../data/widget-definition-model');\n\nmodule.exports = WidgetOptionModel.extend({\n  defaults: _.defaults({type: 'histogram'}, WidgetOptionModel.defaults),\n\n  save: function (widgetDefinitionsCollection) {\n    var styleModel = this.layerDefinitionModel() && this.layerDefinitionModel().styleModel;\n    var isAllowed = styleModel && styleModel.canApplyAutoStyle() || false;\n\n    var attrs = {\n      type: 'histogram',\n      layer_id: this.layerDefinitionModel().id,\n      source: {\n        id: this.analysisDefinitionNodeModel().id\n      },\n      options: {\n        column: this.columnName(),\n        title: this.get('title'),\n        bins: this.get('bins')\n      },\n      style: {\n        widget_style: {\n          definition: WidgetDefinitionModel.getDefaultWidgetStyle('histogram')\n        },\n        auto_style: {\n          allowed: isAllowed,\n          custom: false\n        }\n      }\n    };\n\n    var model = this;\n    widgetDefinitionsCollection.trigger('loading', model);\n\n    return widgetDefinitionsCollection.create(attrs, {\n      wait: true,\n      success: function (mdl, attrs) {\n        widgetDefinitionsCollection.trigger('success', model);\n      },\n      error: function (mdl, e) {\n        widgetDefinitionsCollection.trigger('error', model, e);\n      }\n    });\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar LayerSelectorView = require('../layer-selector-view');\nvar template = require('./histogram-option.tpl');\nvar histogramFake = require('./histogram-fake.tpl');\n\n/**\n * View for an individual histogram option.\n */\nmodule.exports = CoreView.extend({\n\n  events: {\n    'click .js-checkbox': '_onSelect'\n  },\n\n  initialize: function (opts) {\n    this.listenTo(this.model, 'change:layer_index', this.render);\n    this.listenTo(this.model, 'change:selected', this.render);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(this._html());\n    this._renderLayerSelector();\n    var tableStats = this.options.model.stats;\n    if (tableStats) {\n      this._drawGraph();\n    }\n    return this;\n  },\n\n  _html: function () {\n    return template({\n      columnName: this.model.columnName(),\n      isSelected: !!this.model.get('selected')\n    });\n  },\n\n  _renderLayerSelector: function () {\n    var view = new LayerSelectorView({\n      model: this.model\n    });\n    this.addView(view);\n    this.$('.js-inner').append(view.render().el);\n  },\n\n  _onSelect: function () {\n    this.model.set('selected', !this.model.get('selected'));\n  },\n\n  _drawGraph: function () {\n    var self = this;\n    this.options.model.stats.graphFor(\n      this.model.analysisDefinitionNodeModel().get('table_name'),\n      this.model.get('name'), function (graph) {\n        if (graph.stats) {\n          self.$('.js-Histogram').append(graph.getHistogram({\n            color: '#9DE0AD',\n            width: 240,\n            height: 20,\n            bins: 20\n          }));\n          var stats = self.$('.js-histstats').children();\n          self.$(stats[0]).text(graph.getNullsPercentage() + '% null');\n          self.$('.js-histstats').css('display', 'flex');\n        } else {\n          self.$('.js-Histogram').append(histogramFake());\n        }\n      }\n    );\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"WidgetList-option\">\\n  <input class=\"CDB-Checkbox js-checkbox\" type=\"checkbox\" ';\n if (isSelected) { \n__p+='checked=\"checked\"';\n } \n__p+=' />\\n  <span class=\"u-iBlock CDB-Checkbox-face\"></span>\\n</div>\\n\\n<div class=\"WidgetList-inner js-inner\">\\n  <h3 class=\"u-ellipsis CDB-Text CDB-Size-large u-bSpace--m\">'+\n((__t=( columnName ))==null?'':_.escape(__t))+\n'</h3>\\n  <ul class=\"js-histstats u-flex CDB-Text CDB-Size-small u-upperCase\" style=\"display: none;\">\\n    <li class=\\'u-rSpace\\'></li>\\n  </ul>\\n  <div class=\"u-tSpace--m u-bSpace--m js-Histogram\"></div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar HistogramOptionView = require('./histogram-option-view.js');\n\n/**\n * View to select histogram widget options\n */\nmodule.exports = CoreView.extend({\n\n  className: 'WidgetList',\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this.collection\n      .chain()\n      .filter(this._isHistogram)\n      .each(this._renderOption, this);\n    return this;\n  },\n\n  _renderOption: function (m) {\n    var view = new HistogramOptionView({\n      className: 'WidgetList-item',\n      model: m\n    });\n    this.addView(view);\n    this.$el.append(view.render().el);\n  },\n\n  _isHistogram: function (m) {\n    return m.get('type') === 'histogram';\n  }\n\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar analyses = require('../../../data/analyses');\nrequire('../../form-components/index');\nvar CustomListItemView = require('../../form-components/editors/select/select-layer-list-item-view');\nvar itemListTemplate = require('../../form-components/editors/select/select-layer-item.tpl');\nvar selectedItemTemplate = require('../../form-components/editors/select/select-layer-list-item.tpl');\n\n/**\n * View for selecting the layer through which to load the column data.\n */\nmodule.exports = CoreView.extend({\n\n  className: 'SelectorLayer',\n\n  events: {\n    'change': '_onChange'\n  },\n\n  initialize: function (opts) {\n    this.listenTo(this.model, 'change:layer_index', this.render);\n  },\n\n  render: function () {\n    this._unbindEvents();\n    this._initViews();\n    this._bindEvents();\n    return this;\n  },\n\n  _initViews: function () {\n    var self = this;\n    var options = this._buildOptions();\n\n    this._selectView = new Backbone.Form.editors.Select({\n      className: 'Widget-select u-flex u-alignCenter',\n      key: 'name',\n      schema: {\n        options: options\n      },\n      model: self.model,\n      showSearch: false,\n      template: require('./select.tpl'),\n      selectedItemTemplate: selectedItemTemplate,\n      customListItemView: CustomListItemView,\n      itemListTemplate: itemListTemplate\n    });\n\n    this._selectView.setValue(this.model.get('layer_index') || 0);\n    this.$el.html(this._selectView.render().el);\n  },\n\n  _buildOptions: function () {\n    return _.map(this.model.get('tuples'), function (item, index) {\n      var layerDefModel = item.layerDefinitionModel;\n      var nodeDefModel = item.analysisDefinitionNodeModel;\n\n      return {\n        val: index,\n        layerName: layerDefModel.getName(),\n        nodeTitle: analyses.title(nodeDefModel),\n        layer_id: nodeDefModel.id,\n        color: item.layerDefinitionModel.get('color')\n      };\n    });\n  },\n\n  _bindEvents: function () {\n    if (this._selectView) {\n      this._selectView.on('change', this._onChange, this);\n    }\n  },\n\n  _unbindEvents: function () {\n    if (this._selectView) {\n      this._selectView.off('change', this._onChange, this);\n    }\n  },\n\n  _onChange: function () {\n    this.model.set('layer_index', this._selectView.getValue());\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text CDB-Size-small u-upperCase u-altTextColor Widget-selectTitle\">Select Layer</p>\\n<div class=\"CDB-InputText CDB-Text is-cursor js-button u-ellipsis\\n  ';\n if (isDisabled) { \n__p+=' is-disabled ';\n } \n__p+='\\n  ';\n if (!label) { \n__p+=' is-empty ';\n } \n__p+='\"\\n  tabindex=\"0\">\\n  ';\n if (isLoading) { \n__p+='\\n    <div class=\"CDB-LoaderIcon CDB-LoaderIcon--small is-dark\">\\n      <svg class=\"CDB-LoaderIcon-spinner\" viewBox=\"0 0 50 50\">\\n        <circle class=\"CDB-LoaderIcon-path\" cx=\"25\" cy=\"25\" r=\"20\" fill=\"none\"></circle>\\n      </svg>\\n    </div>\\n    <span class=\"u-lSpace u-secondaryTextColor\">'+\n((__t=( _t('components.backbone-forms.select.loading') ))==null?'':_.escape(__t))+\n'</span>\\n  ';\n } else { \n__p+='\\n    ';\n if (isEmpty) { \n__p+='\\n      '+\n((__t=( _t('components.backbone-forms.select.empty') ))==null?'':_.escape(__t))+\n'\\n    ';\n } else { \n__p+='\\n      '+\n((__t=( label || _t('components.backbone-forms.select.placeholder', { keyAttr: keyAttr }) ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n  ';\n } \n__p+='\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+=''+\n((__t=( label ))==null?'':_.escape(__t))+\n'';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Modal-navigation\">\\n  <ul class=\"Modal-navigationInner CDB-Text is-semibold CDB-Size-medium js-menu\"></ul>\\n</div>\\n<div class=\"Modal-inner Modal-inner--with-navigation js-content\">\\n</div>\\n\\n';\n}\nreturn __p;\n};\n",
    "var CDB = require('cartodb.js');\nvar _ = require('underscore');\n\nfunction TableStats (opts) {\n  if (opts.user && opts.api_key) {\n    this.user = opts.username;\n    this.api_key = opts.api_key;\n  } else if (opts.configModel) {\n    this.configModel = opts.configModel;\n    this.userModel = opts.userModel;\n  }\n  this.tables = {};\n  this.queue = {};\n}\n\nTableStats.prototype = {\n\n  graphFor: function (tableName, column, callback) {\n    this._getPgStats(tableName, function (stats) {\n      var graph = new ColumnGraph(stats[column]);\n      callback(graph);\n    });\n  },\n\n  _getPgStats: function (table, callback) {\n    var userModel = this.userModel;\n    var self = this;\n    if (this.tables[table]) {\n      if (!_.isEmpty(this.tables[table])) {\n        callback(this.tables[table]);\n      } else {\n        this.queue[table].push(callback);\n      }\n    } else {\n      this.tables[table] = {};\n      this.queue[table] = [callback];\n\n      var schema = userModel.getSchemaName();\n      var sql = new CDB.SQL({\n        user: this.configModel.get('user_name'),\n        sql_api_template: this.configModel.get('sql_api_template'),\n        api_key: this.configModel.get('api_key')\n      });\n\n      sql.execute(\n        'with a as (select reltuples from pg_class where relname = \\'' + table + '\\'), b as (select * from pg_stats where tablename = \\'' + table + '\\' and schemaname = \\'' + schema + '\\') select * from a,b',\n        null,\n        {\n          rows_per_page: 40,\n          page: 0\n        }\n      ).done(function (data) {\n        data = data || {};\n        var rows = data.rows.map(function (r) {\n          var count = r.reltuples;\n          var bounds = self._reformatToJSON(r.histogram_bounds);\n          if (bounds) {\n            var avgs = bounds.reduce(function (p, c, i) {\n              if (i < bounds.length - 1) {\n                p.push((bounds[i + 1] + c) / 2);\n              }\n              return p;\n            }, []);\n            var binsize = count / (bounds.length - 1);\n            var sum = avgs.reduce(function (p, c) {\n              return p + c * binsize;\n            }, 0);\n            var average = sum / count;\n            var min = bounds[0];\n            var max = _.last(bounds);\n          }\n          var mostCommon = self._reformatToJSON(r.most_common_vals);\n          var trues;\n          if (mostCommon) {\n            var trueIndex = mostCommon.indexOf('t');\n            var falseIndex = mostCommon.indexOf('f');\n            if (trueIndex > -1 && falseIndex > -1) {\n              trues = r.most_common_freqs[trueIndex];\n            }\n          }\n          return {\n            column: r.attname,\n            histogram_bounds: bounds,\n            freqs: r.most_common_freqs,\n            mostcommon: mostCommon,\n            nulls: r.null_frac,\n            count: count,\n            sum: sum,\n            min: min,\n            max: max,\n            avg: average,\n            trues: trues\n          };\n        });\n\n        var stats = rows.reduce(function (p, c) {\n          var column = c.column;\n          delete c.column;\n          p[column] = c;\n          return p;\n        }, {});\n        self.tables[table] = stats;\n        self._processQueue(table);\n      });\n    }\n  },\n\n  _processQueue: function (table) {\n    var self = this;\n    this.queue[table].forEach(function (callback) {\n      callback(self.tables[table]);\n    });\n  },\n\n  _reformatToJSON: function (sqlData) {\n    if (!sqlData) return null;\n    sqlData = sqlData.replace('{', '').replace('}', '').split(',');\n    if (!sqlData.some(isNaN)) {\n      sqlData = sqlData.map(function (n) {\n        return parseInt(n, 10);\n      });\n    }\n    return sqlData;\n  }\n};\n\nfunction ColumnGraph (stats, options) {\n  options = options || {};\n  this.stats = stats;\n  this.normalize = typeof options.normalize === 'undefined' ? true : options.normalize;\n}\n\nColumnGraph.prototype = {\n  getNullsPercentage: function () {\n    return this.stats.nulls;\n  },\n\n  getPercentageInTopCategories: function (topx) {\n    return this.stats.freqs.slice(0, topx || 10).reduce(function (p, c) { return p + c; });\n  },\n\n  getTrues: function () {\n    return this.stats.trues;\n  },\n\n  getHistogram: function (options) {\n    return this._generateHistogram(options.width, options.height, options.color, options.bins);\n  },\n\n  getCategory: function (options) {\n    return this._generateCategory(options.width, options.height, options.color);\n  },\n\n  getMin: function () {\n    return this.stats.min;\n  },\n\n  getMax: function () {\n    return this.stats.max;\n  },\n\n  getAverage: function () {\n    return this.stats.avg;\n  },\n\n  getCount: function () {\n    return this.stats.count;\n  },\n\n  getSum: function () {\n    return this.stats.sum;\n  },\n\n  _generateCategory: function (width, height, color) {\n    if (!this.stats.freqs) return;\n    var canvas = document.createElement('canvas');\n    var context = canvas.getContext('2d');\n    var proportion;\n    if (_.isNumber(this.getTrues())) {\n      proportion = this.getTrues();\n    } else {\n      proportion = this.getPercentageInTopCategories();\n    }\n    canvas.height = height || 10;\n    canvas.width = width || 400;\n    var spacing = 2;\n    var begin = spacing;\n    var end = canvas.width - spacing * 2;\n    var greenPosition = (end - begin) * proportion + begin;\n    context.lineCap = 'round';\n    context.strokeStyle = '#EDEDED';\n    context.lineWidth = 4;\n    context.beginPath();\n    context.moveTo(begin, canvas.height / 2);\n    context.lineTo(end, canvas.height / 2);\n    context.stroke();\n    context.strokeStyle = color;\n    context.beginPath();\n    context.moveTo(begin, canvas.height / 2);\n    context.lineTo(greenPosition, canvas.height / 2);\n    context.stroke();\n    return canvas;\n  },\n\n  _generateHistogram: function (width, height, color, bins) {\n    var histogram;\n\n    if (_.isEmpty(this.stats)) {\n      return;\n    }\n\n    if (this.stats.freqs && this.stats.freqs.length < 60) {\n      histogram = this._getHistogramFromFreqs(bins);\n    } else if (this.stats.histogram_bounds) {\n      histogram = this._getHistogramFromBounds(bins);\n    }\n\n    if (!histogram || _.isEmpty(histogram)) {\n      return;\n    }\n\n    if (this.normalize) {\n      var max = _.max(histogram);\n      histogram = histogram.map(function (bin) {\n        return bin / max;\n      });\n    }\n\n    bins = histogram.length;\n\n    var canvas = document.createElement('canvas');\n    var context = canvas.getContext('2d');\n    canvas.height = height || 90;\n    canvas.width = width || 400;\n\n    var barSeparation = 2;\n    var barWidth = (canvas.width - barSeparation * (bins - 1)) / bins;\n    context.strokeStyle = '#EDEDED';\n    context.lineWidth = 1;\n\n    // Guides\n\n    context.beginPath();\n    context.moveTo(0, 0);\n    context.lineTo(canvas.width, 0);\n    context.stroke();\n    context.beginPath();\n    context.moveTo(0, canvas.height / 2);\n    context.lineTo(canvas.width, canvas.height / 2);\n    context.stroke();\n\n    // Bars\n\n    histogram.forEach(function (bar, index) {\n      var x = index * (barWidth + barSeparation);\n      var barHeight = canvas.height * bar;\n      context.beginPath();\n      context.fillStyle = color;\n      context.fillRect(x, canvas.height - barHeight, barWidth, barHeight);\n    });\n\n    // Base line\n\n    context.strokeStyle = '#A1BBA7';\n    context.lineWidth = 2;\n    context.beginPath();\n    context.moveTo(0, canvas.height);\n    context.lineTo(canvas.width, canvas.height);\n    context.stroke();\n\n    return canvas;\n  },\n\n  _getHistogramFromBounds: function (bins) {\n    var bounds = this.stats.histogram_bounds;\n    bounds = bounds.sort(function (a, b) { return a - b; });\n    var min = bounds[0];\n    var max = bounds[bounds.length - 1];\n    var width = (max - min) / bins;\n    var histogram = new Array(bins + 1).join('0').split('').map(parseFloat);\n    function scaleBin (value) {\n      if (max === min) return min;\n      return Math.floor((bins - 1) * (value - min) / (max - min));\n    }\n\n    var boundProportion = 1 / (bounds.length - 1);\n    for (var i = 0; i < bounds.length - 1; ++i) {\n      var binMin = scaleBin(bounds[i]);\n      var binMax = scaleBin(bounds[i + 1]);\n      if (binMin === binMax) {\n        histogram[binMin] += boundProportion;\n      } else {\n        var proportionForFirstBin = ((min + width * (binMin + 1)) - bounds[i]) / (bounds[i + 1] - bounds[i]);\n        histogram[binMin] += proportionForFirstBin * boundProportion;\n        var proportionForLastBin = (bounds[i + 1] - (min + width * (binMax))) / (bounds[i + 1] - bounds[i]);\n        histogram[binMax] += proportionForLastBin * boundProportion;\n        var remaining = boundProportion - proportionForFirstBin - proportionForLastBin;\n        _.range(binMin + 1, binMax).forEach(function (binIndex, i, array) {\n          histogram[binIndex] = remaining / array.length;\n        });\n      }\n    }\n\n    return histogram;\n  },\n\n  _getHistogramFromFreqs: function (bins) {\n    var values = this.stats.mostcommon;\n    var freqs = this.stats.freqs;\n    bins = Math.min(bins, values.length);\n    var min = _.min(values);\n    var max = _.max(values);\n\n    // If there is only one value, histogram should not be rendered\n    if (min === max) {\n      return [];\n    }\n\n    var histogram = new Array(bins + 1).join('0').split('').map(parseFloat);\n    function scale (value) {\n      if (max === min) return min;\n      return (bins - 1) * (value - min) / (max - min);\n    }\n    values.forEach(function (v, i) {\n      histogram[Math.floor(scale(v))] += freqs[i];\n    });\n    return histogram;\n  }\n\n};\n\nmodule.exports = TableStats;\n",
    "var _ = require('underscore');\nvar WidgetOptionModel = require('../widget-option-model');\n\n/**\n * Special case for the time-series type, when if selected it deletes an existing time-series if there is one,\n * otherwise it does nothing.\n */\nmodule.exports = WidgetOptionModel.extend({\n\n  defaults: _.defaults({type: 'time-series'}, WidgetOptionModel.defaults),\n\n  save: function (widgetDefinitionsCollection) {\n    var m = widgetDefinitionsCollection.find(this._isTimesSeries);\n    if (m) {\n      m.destroy({ wait: true });\n    }\n  },\n\n  _isTimesSeries: function (m) {\n    return m.get('type') === 'time-series';\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./time-series-none-option.tpl');\n\n/**\n * Represents the (default) no-option view, i.e. since time-series options only can have one selection,\n * this serves as the \"unselect\" option.\n */\nmodule.exports = CoreView.extend({\n\n  events: {\n    'click .js-radio': '_onSelect'\n  },\n\n  initialize: function (opts) {\n    this.listenTo(this.model, 'change:selected', this.render);\n  },\n\n  render: function () {\n    this.$el.html(this._html());\n    return this;\n  },\n\n  _html: function () {\n    return template({\n      isSelected: !!this.model.get('selected')\n    });\n  },\n\n  _onSelect: function () {\n    this.model.set('selected', !this.model.get('selected'));\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"WidgetList-option\">\\n  <input class=\"CDB-Radio u-iBlock js-radio\" type=\"radio\" ';\n if (isSelected) { \n__p+='checked=\"checked\"';\n } \n__p+=' />\\n  <span class=\"u-iBlock CDB-Radio-face\"></span>\\n</div>\\n\\n<div class=\"WidgetList-inner js-inner\">\\n  <h3 class=\"WidgetList-title CDB-Text CDB-Size-large u-bSpace--xl\">'+\n((__t=( _t('components.modals.add-widgets.time-series-no-option-title') ))==null?'':_.escape(__t))+\n'</h3>\\n  <p class=\"CDB-Text CDB-Size-small u-altTextColor\">'+\n((__t=( _t('components.modals.add-widgets.time-series-no-option-desc') ))==null?'':_.escape(__t))+\n'</p>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar WidgetOptionModel = require('../widget-option-model');\nvar WidgetDefinitionModel = require('../../../../data/widget-definition-model');\n\nmodule.exports = WidgetOptionModel.extend({\n  defaults: _.defaults({type: 'time-series'}, WidgetOptionModel.defaults),\n\n  save: function (widgetDefinitionsCollection) {\n    var columnName = this.columnName();\n    var layerId = this.layerDefinitionModel().id;\n    var model = this;\n\n    var attrs = {\n      type: 'time-series',\n      layer_id: layerId,\n      source: {\n        id: this.analysisDefinitionNodeModel().id\n      },\n      options: {\n        column: columnName,\n        title: this.get('title'),\n        bins: this.get('bins')\n      },\n      style: {\n        widget_style: {\n          definition: WidgetDefinitionModel.getDefaultWidgetStyle('time-series')\n        }\n      }\n    };\n\n    var attrsSave = {\n      type: 'time-series',\n      layer_id: layerId,\n      source: this.analysisDefinitionNodeModel().id,\n      column: columnName,\n      title: this.get('title'),\n      bins: this.get('bins'),\n      widget_style_definition: WidgetDefinitionModel.getDefaultWidgetStyle('time-series')\n    };\n\n    var successHandler = function (mdl, attrs) {\n      widgetDefinitionsCollection.trigger('success', model);\n    };\n\n    var errorHandler = function (mdl, e) {\n      widgetDefinitionsCollection.trigger('error', model, e);\n    };\n\n    var createNotification = function (type) {\n      if (type === 'create') {\n        widgetDefinitionsCollection.trigger('loading', model);\n      } else {\n        widgetDefinitionsCollection.trigger('updating', model);\n      }\n    };\n\n    var m = widgetDefinitionsCollection.find(this._isTimesSeries);\n    if (m) {\n      // Update existing widget, but only if the column or layer differs\n      if (m.get('column') !== columnName || m.get('layer_id') !== layerId) {\n        createNotification('update');\n        return m.save(attrsSave, {\n          wait: true,\n          success: successHandler,\n          error: errorHandler\n        });\n      }\n    } else {\n      createNotification('create');\n      return widgetDefinitionsCollection.create(attrs, {\n        wait: true,\n        success: successHandler,\n        error: errorHandler\n      });\n    }\n  },\n\n  _isTimesSeries: function (m) {\n    return m.get('type') === 'time-series';\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar LayerSelectorView = require('../layer-selector-view');\nvar template = require('./time-series-option.tpl');\n\n/**\n * View for an individual time-series option.\n */\nmodule.exports = CoreView.extend({\n\n  events: {\n    'click .js-radio': '_onSelect'\n  },\n\n  initialize: function (opts) {\n    this.listenTo(this.model, 'change:layer_index', this.render);\n    this.listenTo(this.model, 'change:selected', this.render);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(this._html());\n    this._renderLayerSelector();\n    return this;\n  },\n\n  _html: function () {\n    return template({\n      columnName: this.model.columnName(),\n      isSelected: !!this.model.get('selected')\n    });\n  },\n\n  _renderLayerSelector: function () {\n    var view = new LayerSelectorView({\n      model: this.model\n    });\n    this.addView(view);\n    this.$('.js-inner').append(view.render().el);\n  },\n\n  _onSelect: function () {\n    this.model.set('selected', !this.model.get('selected'));\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"WidgetList-option\">\\n  <input class=\"CDB-Radio u-iBlock js-radio\" type=\"radio\" ';\n if (isSelected) { \n__p+='checked=\"checked\"';\n } \n__p+=' />\\n  <span class=\"u-iBlock CDB-Radio-face\"></span>\\n</div>\\n\\n<div class=\"WidgetList-inner js-inner\">\\n  <h3 class=\"u-ellipsis CDB-Text CDB-Size-large u-bSpace--m\">'+\n((__t=( columnName ))==null?'':_.escape(__t))+\n'</h3>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar TimeSeriesOptionView = require('./time-series-option-view.js');\nvar TimeSeriesNoneOptionView = require('./time-series-none-option-view.js');\n\n/**\n * View to select time-series widget options\n */\nmodule.exports = CoreView.extend({\n\n  className: 'WidgetList',\n\n  initialize: function () {\n    this.listenTo(this.collection, 'change:selected', this._onSelectedChange);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n\n    this.collection\n      .chain()\n      .filter(this._isTimeSeries)\n      .each(this._renderOption, this);\n    return this;\n  },\n\n  _renderOption: function (m) {\n    var ViewClass = m.has('tuples')\n      ? TimeSeriesOptionView\n      : TimeSeriesNoneOptionView;\n\n    var view = new ViewClass({\n      className: 'WidgetList-item',\n      model: m\n    });\n    this.addView(view);\n    this.$el.append(view.render().el);\n  },\n\n  _isTimeSeries: function (m) {\n    return m.get('type') === 'time-series';\n  },\n\n  _onSelectedChange: function (selectedModel, isSelected) {\n    // Make sure there can only be one selected time-series widget option\n    if (isSelected) {\n      this.collection.each(function (m) {\n        if (this._isTimeSeries(m) && m !== selectedModel) {\n          m.set('selected', false);\n        }\n      }, this);\n    }\n  }\n\n});\n",
    "var Backbone = require('backbone');\n\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    layer_index: 0,\n    tuples: []\n  },\n\n  analysisDefinitionNodeModel: function () {\n    return this._selectedItem().analysisDefinitionNodeModel;\n  },\n\n  layerDefinitionModel: function () {\n    return this._selectedItem().layerDefinitionModel;\n  },\n\n  columnName: function () {\n    return this._selectedItem().columnModel.get('name');\n  },\n\n  save: function () {\n    throw new Error('save should be implemented by child');\n  },\n\n  _selectedItem: function () {\n    var i = this.get('layer_index') || 0;\n    var tuples = this.get('tuples') || [];\n    return tuples[i] || {};\n  }\n\n});\n",
    "var _ = require('underscore');\nvar CategoryOptionModel = require('./category/category-option-model');\nvar CategoryOptionsView = require('./category/category-options-view');\nvar HistogramOptionModel = require('./histogram/histogram-option-model');\nvar HistogramOptionsView = require('./histogram/histogram-options-view');\nvar FormulaOptionModel = require('./formula/formula-option-model');\nvar FormulaOptionsView = require('./formula/formula-options-view');\nvar TimeSeriesOptionModel = require('./time-series/time-series-option-model');\nvar TimeSeriesNoneOptionModel = require('./time-series/time-series-none-option-model');\nvar TimeSeriesOptionsView = require('./time-series/time-series-options-view');\nvar ScrollView = require('../../scroll/scroll-view');\n\nvar CARTODB_ID = 'cartodb_id';\n\n// Order is the same in how things will be presented in the UI\nmodule.exports = [\n  {\n    type: 'category',\n    createOptionModels: function (tuplesItems) {\n      return _.reduce(tuplesItems, function (memo, tuples) {\n        var columnModel = tuples[0].columnModel;\n        var type = columnModel.get('type');\n        var m;\n        if (type === 'string' || type === 'boolean') {\n          m = new CategoryOptionModel({\n            tuples: tuples,\n            title: columnModel.get('name'),\n            name: columnModel.get('name'),\n            aggregation: 'count' // or sum\n          });\n          memo.push(m);\n        }\n        return memo;\n      }, []);\n    },\n    createTabPaneItem: function (optionsCollection) {\n      return {\n        label: _t('components.modals.add-widgets.tab-pane.category-label'),\n        name: 'category',\n        createContentView: function () {\n          return new ScrollView({\n            createContentView: function () {\n              return new CategoryOptionsView({\n                collection: optionsCollection\n              });\n            }\n          });\n        }\n      };\n    }\n  },\n  {\n    type: 'histogram',\n    createOptionModels: function (tuplesItems) {\n      return _.reduce(tuplesItems, function (memo, tuples) {\n        var columnModel = tuples[0].columnModel;\n        if (columnModel.get('type') === 'number') {\n          var m = new HistogramOptionModel({\n            tuples: tuples,\n            title: columnModel.get('name'),\n            name: columnModel.get('name'),\n            bins: 10\n          });\n          memo.push(m);\n        }\n        return memo;\n      }, []);\n    },\n    createTabPaneItem: function (optionsCollection) {\n      return {\n        label: _t('components.modals.add-widgets.tab-pane.histogram-label'),\n        name: 'histogram',\n        createContentView: function () {\n          return new ScrollView({\n            createContentView: function () {\n              return new HistogramOptionsView({\n                collection: optionsCollection\n              });\n            }\n          });\n        }\n      };\n    }\n  },\n  {\n    type: 'formula',\n    createOptionModels: function (tuplesItems) {\n      return _.reduce(tuplesItems, function (memo, tuples) {\n        var columnModel = tuples[0].columnModel;\n        var columnName = columnModel.get('name');\n        var node;\n        var layerDef = tuples[0].layerDefinitionModel;\n        var geometry;\n        var operation = 'avg';\n        var title = columnName;\n\n        if (columnModel.get('type') === 'number') {\n          if (columnName === CARTODB_ID) {\n            node = layerDef.getAnalysisDefinitionNodeModel();\n            if (node && node.queryGeometryModel) {\n              geometry = node.queryGeometryModel.get('simple_geom');\n            }\n            operation = 'count';\n            title = _t('editor.data.stats.number-of', {\n              geometry: geometry\n            });\n          }\n\n          var m = new FormulaOptionModel({\n            tuples: tuples,\n            title: title,\n            operation: operation,\n            name: columnModel.get('name')\n          });\n          memo.push(m);\n        }\n        return memo;\n      }, []);\n    },\n    createTabPaneItem: function (optionsCollection) {\n      return {\n        label: _t('components.modals.add-widgets.tab-pane.formula-label'),\n        name: 'formula',\n        createContentView: function () {\n          return new ScrollView({\n            createContentView: function () {\n              return new FormulaOptionsView({\n                collection: optionsCollection\n              });\n            }\n          });\n        }\n      };\n    }\n  },\n  {\n    type: 'time-series',\n    createOptionModels: function (tuplesItems, widgetDefinitionsCollection) {\n      var existingDefModel = widgetDefinitionsCollection.find(function (m) {\n        return m.get('type') === 'time-series';\n      });\n\n      var models = _.reduce(tuplesItems, function (memo, tuples) {\n        var columnModel = tuples[0].columnModel;\n        var columnName = columnModel.get('name');\n        if (columnModel.get('type') === 'date' || columnModel.get('type') === 'number') {\n          var attrs = {\n            tuples: tuples,\n            title: columnName,\n            bins: 256\n          };\n\n          // Preselect the correct tuple, if there already exists a widget definition\n          if (existingDefModel && existingDefModel.get('column') === columnName) {\n            _.find(tuples, function (d, i) {\n              if (d.layerDefinitionModel.id === existingDefModel.get('layer_id')) {\n                attrs.selected = true;\n                attrs.layer_index = i;\n                return true;\n              }\n            });\n          }\n\n          var m = new TimeSeriesOptionModel(attrs);\n          memo.push(m);\n        }\n\n        return memo;\n      }, []);\n\n      // Special-case; preprend the none-model since it should appear first\n      var noneOptionModel = new TimeSeriesNoneOptionModel();\n      return [noneOptionModel].concat(models);\n    },\n    createTabPaneItem: function (optionsCollection) {\n      return {\n        label: _t('components.modals.add-widgets.tab-pane.time-series-label'),\n        name: 'time-series',\n        createContentView: function () {\n          return new ScrollView({\n            createContentView: function () {\n              return new TimeSeriesOptionsView({\n                collection: optionsCollection\n              });\n            }\n          });\n        }\n      };\n    }\n  }\n];\n",
    "var CoreView = require('backbone/core-view');\nvar $ = require('jquery');\nvar _ = require('underscore');\nvar renderLoading = require('../../loading/render-loading');\nvar ENTER_KEY_CODE = 13;\nvar REQUIRED_OPTS = [\n  'template',\n  'runAction',\n  'modalModel'\n];\n\n/**\n *  Confirmation modal dialog\n */\n\nmodule.exports = CoreView.extend({\n  className: 'Dialog-content',\n\n  events: {\n    'click .js-confirm': '_onConfirm',\n    'click .js-cancel': '_onCancel'\n  },\n\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (!opts[item]) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n\n    if (opts.loadingTitle) {\n      this._hasLoading = true;\n      this._loadingTitle = opts.loadingTitle;\n    }\n\n    if (opts.renderOpts) {\n      this._hasRenderOpts = true;\n      this._renderOpts = opts.renderOpts;\n    }\n\n    this._onKeyDown = this._onKeyDown.bind(this);\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    var html = this._hasRenderOpts ? this._template(this._renderOpts) : this._template();\n    this.$el.html(html);\n\n    return this;\n  },\n\n  _initBinds: function () {\n    $(document).bind('keydown', this._onKeyDown);\n  },\n\n  _disableBinds: function () {\n    $(document).unbind('keydown', this._onKeyDown);\n  },\n\n  _onKeyDown: function (ev) {\n    var keyCode = ev.which;\n    if (keyCode === ENTER_KEY_CODE) {\n      this._onConfirm();\n    }\n  },\n\n  _renderLoadingView: function () {\n    this.$el.html(\n      renderLoading({\n        title: this._loadingTitle\n      })\n    );\n  },\n\n  _$content: function () {\n    return this.$('.js-content');\n  },\n\n  _onConfirm: function () {\n    if (this._hasLoading) {\n      this._renderLoadingView();\n    } else {\n      this._modalModel.destroy();\n    }\n\n    this._runAction();\n  },\n\n  _onCancel: function () {\n    this._modalModel.destroy();\n  },\n\n  clean: function () {\n    this._disableBinds();\n    CoreView.prototype.clean.apply(this);\n  }\n\n});\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar renderLoading = require('../../loading/render-loading');\nvar ErrorView = require('../../error/error-view');\nvar REQUIRED_OPTS = [\n  'errorTitle',\n  'loadingTitle',\n  'runAction',\n  'modalModel'\n];\n\n/**\n *  Remove confirmation dialog\n */\nmodule.exports = CoreView.extend({\n  className: 'Dialog-content',\n\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (!opts[item]) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(\n      renderLoading({\n        title: this._loadingTitle\n      })\n    );\n    this._runAction({\n      error: this._renderErrorView.bind(this)\n    });\n    return this;\n  },\n\n  _renderErrorView: function (errorMessage) {\n    var errorView = new ErrorView({\n      title: this._errorTitle,\n      desc: errorMessage\n    });\n    this.$el.html(errorView.render().el);\n    this.addView(errorView);\n  }\n\n});\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./editor-visualization-warning.tpl');\nvar VisDefinitionModel = require('../../../data/vis-definition-model');\nvar renderLoading = require('../../loading/render-loading');\nvar ErrorView = require('../../error/error-view');\nvar errorParser = require('../../../helpers/error-parser');\nvar VIS_VERSION = 3;\n\n/**\n *  Confirmation modal dialog\n */\n\nmodule.exports = CoreView.extend({\n  className: 'Dialog-content',\n\n  events: {\n    'click .js-open': '_onOpen',\n    'click .js-duplicate': '_onDuplicate',\n    'click .js-cancel': '_onCancel'\n  },\n\n  initialize: function (opts) {\n    if (!opts.visDefinitionModel) throw new Error('visDefinitionModel is required');\n    if (!opts.modalModel) throw new Error('modalModel is required');\n\n    this._visDefinitionModel = opts.visDefinitionModel;\n    this._modalModel = opts.modalModel;\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    this.$el.html(template());\n    return this;\n  },\n\n  _initBinds: function () {\n    this._modalModel.bind('change:show', this._goToDashboard, this);\n    this.add_related_model(this._modalModel);\n  },\n\n  _disableBinds: function () {\n    this._modalModel.unbind('change:show', this._goToDashboard, this);\n  },\n\n  _onOpen: function () {\n    this._disableBinds();\n    this._renderLoading('open');\n\n    this._visDefinitionModel.save({\n      version: VIS_VERSION\n    }, {\n      wait: true,\n      success: function () {\n        this._modalModel.destroy();\n      }.bind(this),\n      error: function (mdl, e) {\n        this._renderError(errorParser(e));\n      }.bind(this)\n    });\n  },\n\n  _onDuplicate: function () {\n    this._renderLoading('duplicate');\n\n    var newVisModel = new VisDefinitionModel({\n      name: this._visDefinitionModel.get('name')\n    }, {\n      configModel: this._visDefinitionModel._configModel\n    });\n\n    newVisModel.save({\n      source_visualization_id: this._visDefinitionModel.get('id')\n    }, {\n      success: function (visModel) {\n        this._redirectToBuilder(visModel.builderURL());\n      }.bind(this),\n      error: function (mdl, e) {\n        this._renderError(errorParser(e));\n      }.bind(this)\n    });\n  },\n\n  _redirectToBuilder: function (redirect) {\n    window.location = redirect;\n  },\n\n  _renderLoading: function (renderOption) {\n    var mapName = this._visDefinitionModel.get('name');\n    var titleText = '';\n\n    if (renderOption === 'duplicate') {\n      titleText = _t('editor.maps.duplicate.loading', { name: mapName });\n    } else if (renderOption === 'open') {\n      titleText = _t('components.modals.editor-vis-warning.opening-title', { name: mapName });\n    }\n\n    this.$el.html(\n      renderLoading({\n        title: titleText\n      })\n    );\n  },\n\n  _renderError: function (errorMessage) {\n    var mapName = this._visDefinitionModel.get('name');\n    var errorView = new ErrorView({\n      title: _t('editor.maps.duplicate.error', { name: mapName }),\n      desc: errorMessage\n    });\n    this.$el.html(errorView.render().el);\n    this.addView(errorView);\n  },\n\n  _goToDashboard: function (redirect) {\n    window.location = redirect;\n  },\n\n  _onCancel: function () {\n    this._goToDashboard(this._visDefinitionModel._configModel.get('base_url'));\n  },\n\n  clean: function () {\n    this._disableBinds();\n    CoreView.prototype.clean.apply(this);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-justifyCenter\">\\n  <div class=\"Modal-inner Modal-inner--medium u-flex u-justifyCenter\">\\n    <div class=\"Modal-icon\">\\n      <svg width=\"32px\" height=\"32px\" viewbox=\"459 348 24 24\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n        <g id=\"Editor-vis-warning\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(459.000000, 348.000000)\">\\n        \t<path d=\"M15.081,7.19c0.472,0.473,1.1,0.732,1.768,0.732c0.667,0,1.295-0.26,1.768-0.732s0.732-1.101,0.732-1.768\\n        \t\tc0-0.668-0.26-1.296-0.732-1.768c-0.945-0.946-2.592-0.944-3.536,0c-0.472,0.472-0.732,1.1-0.732,1.768S14.608,6.719,15.081,7.19z\\n        \t\t M15.788,4.362c0.283-0.283,0.66-0.439,1.061-0.439c0.4,0,0.777,0.156,1.061,0.439c0.284,0.283,0.439,0.659,0.439,1.061\\n        \t\tc0,0.4-0.156,0.777-0.439,1.061c-0.567,0.566-1.556,0.566-2.122,0c-0.283-0.283-0.439-0.659-0.439-1.061S15.504,4.646,15.788,4.362\\n        \t\tz\" fill=\"#FFA500\"/>\\n        \t<path d=\"M13.676,12.131c0.094-0.094,0.146-0.221,0.146-0.354s-0.053-0.26-0.146-0.354l-2.829-2.828\\n        \t\tc-0.195-0.195-0.512-0.195-0.707,0l-2.828,2.828c-0.195,0.195-0.195,0.512,0,0.707l2.828,2.828\\n        \t\tc0.098,0.098,0.226,0.146,0.354,0.146s0.256-0.049,0.354-0.146L13.676,12.131z M8.373,11.777l2.121-2.121l2.122,2.121l-2.122,2.121\\n        \t\tL8.373,11.777z\" fill=\"#FFA500\"/>\\n        \t<path d=\"M23.375,17.965c-0.182-0.205-0.499-0.227-0.706-0.044c-2.704,2.385-6.065,3.678-8.77,3.367\\n        \t\tc-1.699-0.194-3.106-0.991-4.199-2.354l0.989-0.989c0.087,0.331,0.252,0.646,0.511,0.904c0.39,0.39,0.902,0.584,1.414,0.584\\n        \t\tc0.512,0,1.024-0.194,1.415-0.584l2.122-2.122c0.081-0.08,0.139-0.175,0.213-0.26c0.05-0.023,0.099-0.052,0.14-0.093l4.596-4.597\\n        \t\tc0.755-0.755,1.171-1.76,1.171-2.828c0-0.983-0.367-1.904-1.012-2.635c0.059-0.29,0.089-0.588,0.089-0.892\\n        \t\tc0-1.202-0.468-2.332-1.318-3.183c-0.85-0.85-1.98-1.317-3.182-1.317c-0.304,0-0.602,0.03-0.893,0.089\\n        \t\tc-1.569-1.381-3.963-1.339-5.462,0.159L5.897,5.768C5.856,5.809,5.829,5.856,5.806,5.906C5.72,5.98,5.625,6.04,5.544,6.121\\n        \t\tL3.423,8.242c-0.78,0.779-0.78,2.049,0,2.828c0.255,0.255,0.576,0.416,0.915,0.499l-3.744,3.743\\n        \t\tc-0.377,0.378-0.585,0.88-0.585,1.414c0,0.535,0.208,1.037,0.585,1.414c0.756,0.756,2.073,0.756,2.829,0l3.182-3.182\\n        \t\tc0.196-0.195,0.513-0.194,0.708,0c0.195,0.195,0.195,0.513,0,0.708L4.13,18.849c-0.378,0.377-0.586,0.879-0.586,1.414\\n        \t\tS3.752,21.3,4.13,21.677c0.39,0.39,0.902,0.585,1.414,0.585s1.025-0.195,1.415-0.585l2.032-2.032\\n        \t\tc1.244,1.506,2.888,2.419,4.796,2.637c0.298,0.034,0.603,0.051,0.914,0.051c2.789,0,6.012-1.352,8.63-3.661\\n        \t\tC23.538,18.488,23.558,18.172,23.375,17.965z M21.272,8.949c0,0.802-0.312,1.555-0.878,2.121l-2.85,2.85\\n        \t\tc0.035-0.24,0.071-0.48,0.071-0.729c0-1.24-0.466-2.402-1.287-3.319c0.173,0.021,0.344,0.051,0.521,0.051\\n        \t\tc1.202,0,2.332-0.468,3.182-1.318c0.345-0.345,0.608-0.743,0.821-1.166C21.119,7.894,21.272,8.407,21.272,8.949z M19.323,2.947\\n        \t\tc0.661,0.661,1.025,1.54,1.025,2.476c0,0.935-0.364,1.813-1.025,2.475c-1.294,1.292-3.521,1.312-4.855,0.076l-0.176-0.176\\n        \t\tc-1.273-1.37-1.252-3.517,0.082-4.851c0.661-0.661,1.54-1.024,2.475-1.024C17.783,1.923,18.662,2.286,19.323,2.947z M11.201,1.878\\n        \t\tc0.984-0.982,2.482-1.128,3.631-0.458c-0.422,0.213-0.821,0.477-1.165,0.82c-1.01,1.011-1.419,2.385-1.266,3.704\\n        \t\tc-0.918-0.822-2.079-1.288-3.321-1.288c-0.248,0-0.488,0.036-0.728,0.071L11.201,1.878z M6.251,20.97\\n        \t\tc-0.391,0.391-1.025,0.39-1.415,0c-0.188-0.188-0.292-0.439-0.292-0.707s0.104-0.519,0.293-0.707l3.183-3.182\\n        \t\tc0.584-0.586,0.584-1.538,0-2.122c-0.585-0.586-1.537-0.586-2.122,0l-3.182,3.182c-0.378,0.378-1.037,0.376-1.415,0\\n        \t\tc-0.189-0.188-0.292-0.439-0.292-0.707c0-0.267,0.104-0.519,0.292-0.707l5.186-5.185l0.472-0.472l0,0L9.08,8.242\\n        \t\tc0.195-0.195,0.195-0.512,0-0.707s-0.512-0.195-0.707,0L5.78,10.128l-0.236,0.235c-0.378,0.379-1.036,0.377-1.414,0\\n        \t\tc-0.39-0.39-0.39-1.024,0-1.414l2.121-2.121c1.511-1.512,4.146-1.512,5.657,0l1.677,1.677c0.03,0.031,0.051,0.068,0.082,0.1\\n        \t\tc0.032,0.032,0.071,0.054,0.103,0.085l1.674,1.674c0.755,0.756,1.171,1.76,1.171,2.828s-0.416,2.073-1.171,2.828l-2.121,2.122\\n        \t\tc-0.39,0.389-1.024,0.389-1.415,0c-0.189-0.189-0.293-0.44-0.293-0.708c0-0.267,0.104-0.518,0.292-0.707l2.829-2.828\\n        \t\tc0.195-0.195,0.195-0.512,0-0.707s-0.512-0.195-0.707,0l-2.121,2.121l0,0l-0.707,0.707c0,0,0,0.001-0.001,0.001L6.251,20.97z\" fill=\"#FFA500\"/>\\n        </g>\\n      </svg>\\n    </div>\\n\\n    <div>\\n      <h2 class=\"Dialog-headerTitle--warning CDB-Text CDB-Size-huge is-light u-bSpace--m\">'+\n((__t=( _t('components.modals.editor-vis-warning.title') ))==null?'':_.escape(__t))+\n'</h2>\\n      <p class=\"CDB-Text CDB-Size-medium u-secondaryTextColor u-bSpace--xl\">'+\n((__t=( _t('components.modals.editor-vis-warning.explanation') ))==null?'':_.escape(__t))+\n'</p>\\n      <p class=\"CDB-Text CDB-Size-medium is-semibold u-secondaryTextColor\">'+\n((__t=( _t('components.modals.editor-vis-warning.question') ))==null?'':_.escape(__t))+\n'</p>\\n\\n      <ul class=\"Modal-listActions u-flex u-alignCenter\">\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--secondary CDB-Button--big js-cancel\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-small u-upperCase\">\\n              '+\n((__t=( _t('components.modals.editor-vis-warning.go-back') ))==null?'':_.escape(__t))+\n'\\n            </span>\\n          </button>\\n        </li>\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-open\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-small u-upperCase\">\\n              '+\n((__t=( _t('components.modals.editor-vis-warning.open') ))==null?'':_.escape(__t))+\n'\\n            </span>\\n          </button>\\n        </li>\\n      </ul>\\n\\n      <p class=\"CDB-Text CDB-Size-medium u-secondaryTextColor u-tSpace-xl\">or <button class=\"CDB-Text is-semibold u-actionTextColor js-duplicate\">'+\n((__t=( _t('components.modals.editor-vis-warning.duplicate') ))==null?'':_.escape(__t))+\n'</button>.</p>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var $ = require('jquery');\nvar CoreView = require('backbone/core-view');\nvar renderLoading = require('../../loading/render-loading');\nvar ErrorView = require('../../error/error-view');\nvar template = require('./modal-export-data.tpl');\nvar MAX_SQL_GET_LENGTH = 1000;\nvar CSV_FILTER = 'SELECT * FROM (%%sql%%) as subq ';\nvar FORMATS = [\n  {\n    format: 'csv',\n    fetcher: 'fetchCSV',\n    geomRequired: false\n  }, {\n    format: 'shp',\n    fetcher: 'fetch',\n    geomRequired: true\n  }, {\n    format: 'kml',\n    fetcher: 'fetch',\n    geomRequired: true\n  }, {\n    format: 'geojson',\n    label: 'geo json',\n    fetcher: 'fetch',\n    geomRequired: true\n  }, {\n    format: 'svg',\n    fetcher: 'fetchSVG',\n    geomRequired: true\n  }\n];\n\nmodule.exports = CoreView.extend({\n  className: 'Dialog-content',\n\n  events: {\n    'click .js-confirm': '_onConfirm',\n    'click .js-cancel': '_close'\n  },\n\n  options: {\n    autoClose: true\n  },\n\n  initialize: function (opts) {\n    if (!opts.fileName) throw new Error('name is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.queryGeometryModel) throw new Error('queryGeometryModel is required');\n    if (!opts.modalModel) throw new Error('modalModel is required');\n\n    this._configModel = opts.configModel;\n    this._fileName = opts.fileName;\n    this._queryGeometryModel = opts.queryGeometryModel;\n    this._modalModel = opts.modalModel;\n\n    this._initBinds();\n\n    if (this._queryGeometryModel.get('status') === 'unfetched') {\n      this._queryGeometryModel.fetch();\n    }\n  },\n\n  render: function () {\n    var geom = this._queryGeometryModel.get('simple_geom');\n\n    if (this._queryGeometryModel.get('status') === 'fetched' || this._queryGeometryModel.get('status') === 'unavailable') {\n      this.$el.html(\n        template({\n          formats: FORMATS,\n          url: this._configModel.getSqlApiUrl(),\n          isGeoreferenced: !!geom\n        })\n      );\n    } else {\n      this._renderLoadingContent(_t('components.modals.export-data.loading.geometry'));\n    }\n\n    return this;\n  },\n\n  _initBinds: function () {\n    this._queryGeometryModel.bind('change:status', function () {\n      if (this._queryGeometryModel.get('status') !== 'unavailable') {\n        this.render();\n      } else {\n        this.showError(_t('components.modals.export-data.error.geometry-error'));\n      }\n    }, this);\n    this.add_related_model(this._queryGeometryModel);\n  },\n\n  /**\n   * search a format based on its name in the format array\n   * @param  {string} format Format name\n   * @return {Object}\n   */\n  _getFormat: function (format) {\n    for (var n in FORMATS) {\n      if (FORMATS[n].format === format) {\n        return FORMATS[n];\n      }\n    }\n  },\n\n  _onConfirm: function () {\n    this._form = this.$('.js-form');\n    var formatName = $('.js-format[name=format]:checked', this._form).data('format');\n    var format = this._getFormat(formatName);\n\n    this[format.fetcher](formatName);\n  },\n\n  /**\n   * Create a dictionary with the options shared between all the methods\n   * @return {Object}\n   */\n  getBaseOptions: function () {\n    return {\n      filename: this._fileName,\n      apiKey: this._configModel.get('api_key')\n    };\n  },\n\n  /**\n   * Returns a specific sql filtered by the_geom, used on CSV exports\n   * @return {string}\n   */\n  getGeomFilteredSql: function () {\n    var sql = this._queryGeometryModel.get('query');\n    var geom = this._queryGeometryModel.get('simple_geom');\n\n    // if we have \"the_geom\" in our current schema, we apply a custom sql\n    if (geom) {\n      return CSV_FILTER.replace(/%%sql%%/g, sql);\n    }\n    // Otherwise, we apply regular sql\n    return sql;\n  },\n\n  /**\n   * Populates the hidden form with the format related values and submits them to get the file\n   * @param  {Object} options Base options\n   * @param  {String} sql Sql of the document to be retrieved\n   */\n  _fetch: function (options, sql) {\n    this.$('.js-format').val(options.format);\n    this.$('.js-q').val(sql);\n    this.$('.js-filename').val(options.filename);\n    this.$('.js-apiKey').val(options.apiKey);\n\n    var skipFields = ['the_geom_webmercator'];\n    if (options.format !== 'csv') {\n      skipFields.push('the_geom');\n    }\n    this.$('.js-skipfields').val(skipFields.join(','));\n\n    // TODO: track metrics\n\n    // check if the sql is big or not, and send the request as a verb or other. This is a HACK.\n    if (sql.length < MAX_SQL_GET_LENGTH) {\n      var location = this.$('.js-form').attr('action') + '?' + this.$('.js-form').serialize();\n      this._fetchGET(location);\n    } else {\n      // I can't find a way of making the iframe trigger load event when its get a form posted,\n      // so we need to leave like it was until\n      this.submit();\n    }\n\n    this.$('.js-skipfields').attr('disabled', 'disabled');\n\n    if (this.options.autoClose) {\n      this._close();\n    } else {\n      this._renderLoadingContent(_t('components.modals.export-data.loading.preparing'));\n    }\n  },\n\n  showError: function (errorMessage) {\n    var errorView = new ErrorView({\n      title: _t('hello'),\n      desc: errorMessage\n    });\n    this.$el.html(errorView.render().el);\n    this.addView(errorView);\n  },\n\n  _fetchGET: function (url) {\n    function getError (content) {\n      // sql api returns a json when it fails\n      // but if the browser is running some plugin that\n      // formats it, the window content is the html\n      // so search for the word \"error\"\n      var error = null;\n      try {\n        var json = JSON.parse(content);\n        error = json.error[0];\n      } catch (e) {\n        if (content && content.indexOf('error') !== -1) {\n          error = _t('components.modals.export-data.error.unknown');\n        }\n      }\n      return error;\n    }\n\n    var self = this;\n    var checkInterval;\n\n    var w = window.open(url);\n    w.onload = function () {\n      clearInterval(checkInterval);\n      var error = getError(w.document.body.textContent);\n      if (error) {\n        self.showError(error);\n      } else {\n        self._close();\n      }\n      w.close();\n    };\n    window.focus();\n    checkInterval = setInterval(function check () {\n      // safari needs to check the body because it never\n      // calls onload\n      if (w.closed || (w.document && w.document.body.textContent.length === 0)) {\n        self._close();\n        clearInterval(checkInterval);\n      }\n    }, 100);\n  },\n\n  /**\n   * Base fetch, for the formats that don't require special threatment\n   * @param  {String} formatName\n   */\n  fetch: function (formatName) {\n    var options = this.getBaseOptions();\n    options.format = formatName;\n    var sql = this._queryGeometryModel.get('query');\n    this._fetch(options, sql);\n  },\n\n  /**\n   * Gets the options needed for csv format and fetch the document\n   * @param  {String} formatName\n   */\n  fetchCSV: function () {\n    var options = this.getBaseOptions();\n    options.format = 'csv';\n    var sql = this.getGeomFilteredSql();\n    this.$('.js-skipfields').removeAttr('disabled');\n    this._fetch(options, sql);\n  },\n  /**\n   * Gets the options needed for svg format and fetch the document\n   * @param  {String} formatName\n   */\n  fetchSVG: function () {\n    this.fetch('svg');\n  },\n\n  /**\n   * Submits the form. This method is separated to ease the testing\n   */\n  submit: function () {\n    this.$('.js-form').submit();\n  },\n\n  _renderLoadingContent: function (title) {\n    this.$el.html(\n      renderLoading({\n        title: title\n      })\n    );\n  },\n\n  _close: function () {\n    this._modalModel.destroy();\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-justifyCenter\">\\n  <div class=\"Modal-inner u-flex u-justifyCenter\">\\n    <div class=\"Modal-icon\">\\n      <svg width=\"24px\" height=\"24px\" viewbox=\"459 348 24 24\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n        <g id=\"Export-dataset\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(459.000000, 348.000000)\">\\n          <path d=\"M1,1 L11,1 L11,5.5 C11,5.776 11.224,6 11.5,6 L16,6 L16,9.5 L17,9.5 L17,5.502 C17,5.502 17,5.502 17,5.501 C17,5.5 17,5.501 17,5.5 C17,5.447 16.985,5.398 16.97,5.35 C16.966,5.337 16.967,5.323 16.962,5.311 C16.936,5.247 16.896,5.19 16.847,5.142 L11.854,0.147 C11.808,0.101 11.753,0.064 11.692,0.039 C11.632,0.014 11.567,0 11.5,0 L0.5,0 C0.224,0 0,0.224 0,0.5 L0,21.5 C0,21.776 0.224,22 0.5,22 L10.5,22 L10.5,21 L1,21 L1,1 L1,1 Z M12,1.708 L15.291,5 L12,5 L12,1.708 L12,1.708 Z\" id=\"Shape\" fill=\"#2E3C43\"/>\\n          <path d=\"M17.5,11 C13.916,11 11,13.916 11,17.5 C11,21.084 13.916,24 17.5,24 C21.084,24 24,21.084 24,17.5 C24,13.916 21.084,11 17.5,11 L17.5,11 Z M17.5,23 C14.467,23 12,20.533 12,17.5 C12,14.467 14.467,12 17.5,12 C20.533,12 23,14.467 23,17.5 C23,20.533 20.533,23 17.5,23 L17.5,23 Z\" id=\"Shape\" fill=\"#2E3C43\"/>\\n          <path d=\"M17.858,14.425 C17.767,14.331 17.641,14.272 17.5,14.272 C17.359,14.272 17.232,14.331 17.142,14.425 L14.965,16.602 C14.77,16.797 14.77,17.114 14.965,17.309 C15.16,17.504 15.477,17.504 15.672,17.309 L17,15.981 L17,20.226 C17,20.502 17.224,20.726 17.5,20.726 C17.776,20.726 18,20.502 18,20.226 L18,15.981 L19.328,17.309 C19.426,17.407 19.554,17.455 19.682,17.455 C19.81,17.455 19.938,17.406 20.036,17.309 C20.231,17.114 20.231,16.797 20.036,16.602 L17.858,14.425 L17.858,14.425 Z\" id=\"Shape\" fill=\"#2E3C43\" transform=\"translate(17.500500, 17.499000) scale(1, -1) translate(-17.500500, -17.499000) \"/>\\n        </g>\\n      </svg>\\n    </div>\\n\\n    <div>\\n      <h2 class=\"CDB-Text CDB-Size-huge is-light u-bSpace--xl\">'+\n((__t=( _t('components.modals.export-data.title') ))==null?'':_.escape(__t))+\n'</h2>\\n      <p class=\"CDB-Text CDB-Size-large u-altTextColor\">'+\n((__t=( _t('components.modals.export-data.desc') ))==null?'':_.escape(__t))+\n'.</p>\\n      ';\n if (!isGeoreferenced) { \n__p+='\\n        <p class=\"CDB-Text CDB-Size-large u-altTextColor u-tSpace-xl\">'+\n((__t=( _t('components.modals.export-data.no-geometry') ))==null?'':_.escape(__t))+\n'</p>\\n      ';\n } \n__p+='\\n\\n      <div class=\"Modal-listTextItem u-flex u-alignCenter\">\\n        <h3 class=\"CDB-Text CDB-Size-medium is-semibold u-upperCase\">Select format</h3>\\n\\n        <form class=\"js-form\" method=\"POST\" action=\"'+\n((__t=( url ))==null?'':_.escape(__t))+\n'\">\\n          <input type=\"hidden\" class=\"js-filename\" name=\"filename\" />\\n          <input type=\"hidden\" class=\"js-q\" name=\"q\" />\\n          <input type=\"hidden\" class=\"js-apiKey\" name=\"api_key\" />\\n          <input type=\"hidden\" class=\"js-skipfields\" name=\"skipfields\" disabled=\"disabled\" value=\"\" />\\n          <input type=\"hidden\" class=\"js-dp\" name=\"dp\" value=\"4\" disabled=\"disabled\" />\\n\\n          <ul class=\"Modal-listForm u-flex u-alignCenter CDB-Text CDB-Size-medium\">\\n            ';\n _.each(formats, function (format) { \n__p+='\\n            <li class=\"Modal-listFormItem\\n              ';\n if (isGeoreferenced === false && format.geomRequired === true) { \n__p+='\\n                is-disabled\\n              ';\n } \n__p+='\"\\n            >\\n              <input class=\"CDB-Radio js-format\" type=\"radio\" name=\"format\" data-format=\"'+\n((__t=( format.format ))==null?'':_.escape(__t))+\n'\"\\n                ';\n if (isGeoreferenced === false && format.geomRequired === true) { \n__p+='\\n                  disabled\\n                ';\n } \n__p+='\\n\\n                ';\n if (format.format === 'csv') { \n__p+='\\n                  checked\\n                ';\n } \n__p+='\\n              >\\n              <span class=\"u-iBlock CDB-Radio-face\"></span>\\n              <label class=\"u-iBlock u-lSpace u-upperCase\">'+\n((__t=( format.label || format.format ))==null?'':_.escape(__t))+\n'</label>\\n            </li>\\n            ';\n }); \n__p+='\\n          </ul>\\n        </form>\\n\\n      </div>\\n\\n      <ul class=\"Modal-listActions u-flex u-alignCenter\">\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--secondary CDB-Button--big js-cancel\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">'+\n((__t=( _t('components.modals.export-data.cancel') ))==null?'':_.escape(__t))+\n'</span>\\n          </button>\\n        </li>\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-confirm\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">'+\n((__t=( _t('components.modals.export-data.download') ))==null?'':_.escape(__t))+\n'</span>\\n          </button>\\n        </li>\\n      </ul>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./footer.tpl');\n\nmodule.exports = CoreView.extend({\n\n  tagName: 'ul',\n  className: 'Modal-listActions u-flex u-alignCenter ',\n\n  events: {\n    'click .js-save': '_save'\n  },\n\n  initialize: function (opts) {\n    if (!opts.visMetadataModel) throw new Error('visMetadataModel is required');\n    if (!opts.onSaveAction) throw new Error('onSaveAction is required');\n\n    this._visMetadataModel = opts.visMetadataModel;\n    this._onSaveAction = opts.onSaveAction;\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this._visMetadataModel.on('change', this.render, this);\n  },\n\n  render: function () {\n    this.$el.html(\n      template({\n        canFinish: this._visMetadataModel.isValid()\n      })\n    );\n    return this;\n  },\n\n  _save: function () {\n    this._visMetadataModel.isValid() && this._onSaveAction();\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<li class=\"Modal-listActionsitem\">\\n  <button class=\"CDB-Button CDB-Button--secondary CDB-Button--big js-close\">\\n    <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">\\n      '+\n((__t=( _t('components.modals.maps-metadata.cancel-btn') ))==null?'':_.escape(__t))+\n'\\n    </span>\\n  </button>\\n</li>\\n<li class=\"Modal-listActionsitem\">\\n  <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-save '+\n((__t=( canFinish ? '' : 'is-disabled' ))==null?'':_.escape(__t))+\n'\">\\n    <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase \">\\n      '+\n((__t=( _t('components.modals.maps-metadata.save-btn') ))==null?'':_.escape(__t))+\n'\\n    </span>\\n  </button>\\n</li>\\n\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar templateForm = require('./form.tpl');\nrequire('../../../form-components/index');\nvar TipsyTooltipView = require('../../../tipsy-tooltip-view');\nvar utils = require('../../../../helpers/utils');\n\nvar REQUIRED_OPTS = [\n  'visDefinitionModel',\n  'visMetadataModel'\n];\n\nmodule.exports = CoreView.extend({\n  className: 'Metadata-form',\n\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (!opts[item]) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(templateForm());\n    this._initViews();\n    return this;\n  },\n\n  _initViews: function () {\n    this._addInputView();\n    this._addTextareaView();\n    this._addTagsView();\n    this._addTooltip();\n  },\n\n  _addInputView: function () {\n    this._inputView = new Backbone.Form.editors.Text({\n      key: 'name',\n      model: this._visMetadataModel,\n      schema: {\n        options: this._visDefinitionModel.get('name'),\n        editorAttrs: {\n          placeholder: _t('components.modals.maps-metadata.form.name-placeholder')\n        }\n      }\n    });\n    this._inputView.on('change', this._commitView, this);\n\n    this.$('.js-name-field').append(this._inputView.render().$el);\n  },\n\n  _addTextareaView: function () {\n    this._textareaView = new Backbone.Form.editors.TextArea({\n      className: 'CDB-Textarea Metadata-textarea',\n      key: 'description',\n      model: this._visMetadataModel,\n      schema: {\n        options: this._visDefinitionModel.get('description'),\n        editorAttrs: {\n          placeholder: _t('components.modals.maps-metadata.form.description-placeholder')\n        }\n      }\n    });\n\n    this._textareaView.on('change', this._commitView, this);\n\n    this.$('.js-description-field').append(this._textareaView.render().$el);\n  },\n\n  _addTagsView: function () {\n    this._taglistView = new Backbone.Form.editors.Taglist({\n      key: 'tags',\n      model: this._visMetadataModel,\n      schema: {\n        options: {\n          tags: this._visDefinitionModel.get('tags') || []\n        }\n      }\n    });\n\n    this._taglistView.on('change', this._commitView, this);\n\n    this.$('.js-tags-field').append(this._taglistView.render().$el);\n    this.addView(this._taglistView);\n  },\n\n  _addTooltip: function () {\n    var title = this.$('.js-markdown').data('tooltip');\n    this._removeTooltip();\n\n    this._tooltip = new TipsyTooltipView({\n      el: this.$('.js-markdown'),\n      html: true,\n      title: function () {\n        return title;\n      }\n    });\n  },\n\n  _commitView: function (view) {\n    view.commit();\n    // Commit moves values from form to model. We need to override model value after commit()\n    if (view.model.changed.hasOwnProperty('name')) {\n      this._sanitizeName(view.model.get('name'));\n    }\n  },\n\n  _sanitizeName: function (name) {\n    this._visMetadataModel.set('name', utils.sanitizeHtml(name));\n  },\n\n  _removeTooltip: function () {\n    if (this._tooltip) {\n      this._tooltip.clean();\n    }\n  },\n\n  _removeBinds: function () {\n    this._inputView && this._inputView.off('change', this._commitView, this);\n    this._textareaView && this._textareaView.off('change', this._commitView, this);\n    this._taglistView && this._taglistView.off('change', this._commitView, this);\n  },\n\n  clean: function () {\n    this._removeBinds();\n    CoreView.prototype.clean.call(this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-tSpace-xl CDB-Text u-flex js-name-field\">\\n  <label class=\"Metadata-label CDB-Text CDB-Size-medium is-semibold u-upperCase u-ellipsis\">'+\n((__t=( _t('components.modals.maps-metadata.form.name') ))==null?'':_.escape(__t))+\n'</label>\\n</div>\\n\\n<div class=\"u-tSpace-xl CDB-Text u-flex\">\\n  <label class=\"Metadata-label CDB-Text CDB-Size-medium is-semibold u-upperCase u-ellipsis\">'+\n((__t=( _t('components.modals.maps-metadata.form.description') ))==null?'':_.escape(__t))+\n'</label>\\n  <div class=\"u-grow\">\\n    <div class=\"js-description-field u-bSpace\"></div>\\n    <div class=\"Markdown\">\\n      <span class=\"Markdown-tooltip js-markdown\" data-tooltip=\"<em>_italics_</em><br/><b>*bold*</b><br/>[link](http://link.com)\">\\n        <span class=\"Markdown-icon\">\\n          <i class=\"Markdown-icon-text\">M</i>\\n          <i class=\"Markdown-icon-char\"></i>\\n        </span>\\n        '+\n((__t=( _t('components.modals.maps-metadata.form.markdown') ))==null?'':_.escape(__t))+\n'\\n      </span>\\n    </div>\\n  </div>\\n\\n</div>\\n\\n<div class=\"u-tSpace-xl CDB-Text u-flex u-alignCenter js-tags-field\">\\n  <label class=\"Metadata-label CDB-Text CDB-Size-medium is-semibold u-upperCase u-ellipsis\">'+\n((__t=( _t('components.modals.maps-metadata.form.tags') ))==null?'':_.escape(__t))+\n'</label>\\n</div>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"IntermediateInfo\">\\n  <div class=\"Dialog-header Modal-header js-header\">\\n    <div class=\"Dialog-headerIcon Dialog-headerIcon--negative\">\\n      <i class=\"CDB-IconFont CDB-IconFont-cockroach\"></i>\\n    </div>\\n    <h2 class=\"CDB-Text CDB-Size-large u-bSpace u-errorTextColor\">'+\n((__t=( _t('components.modals.maps-metadata.error.title') ))==null?'':_.escape(__t))+\n'</h2>\\n    <h3 class=\"CDB-Text CDB-Size-medium u-secondaryTextColor\">'+\n((__t=( error ))==null?'':__t)+\n'</h3>\\n  </div>\\n\\n  <div class=\"Modal-body\">\\n    <div class=\"Modal-body-inner\">\\n\\n      <div class=\"js-footer\">\\n        <ul class=\"Modal-actions is-narrow\">\\n          <li class=\"Modal-actions-button\">\\n            <button class=\"CDB-Button CDB-Button--primary js-back\">\\n              <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">'+\n((__t=( _t('components.modals.maps-metadata.back-btn') ))==null?'':_.escape(__t))+\n'</span>\\n            </button>\\n          </li>\\n        </ul>\\n      </div>\\n    </div>\\n  </div>\\n</div>';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar VisMetadataModel = require('../../../data/vis-metadata-model');\nvar template = require('./map-metadata.tpl');\nvar FooterView = require('./footer/footer-view');\nvar templateError = require('./map-metadata-error.tpl');\nvar templateLoading = require('../../loading/render-loading');\nvar FormView = require('./form/form-view');\nvar saveMetadata = require('./save-metadata-map');\nvar errorParser = require('../../../helpers/error-parser');\nvar Notifier = require('../../../components/notifier/notifier');\nvar utils = require('../../../helpers/utils');\n\n/**\n * Add layer dialog, typically used from editor\n */\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-back': '_onBackFromError'\n  },\n\n  className: 'Dialog-content Dialog-content--expanded',\n\n  initialize: function (opts) {\n    if (!opts.modalModel) throw new TypeError('modalModel is required');\n    if (!opts.visDefinitionModel) throw new TypeError('visDefinitionModel is required');\n\n    this._modalModel = opts.modalModel;\n    this._visDefinitionModel = opts.visDefinitionModel;\n\n    this._visMetadataModel = new VisMetadataModel({\n      name: this._visDefinitionModel.get('name'),\n      description: this._visDefinitionModel.get('description'),\n      tags: this._visDefinitionModel.get('tags')\n    });\n\n    this._stateModel = new Backbone.Model({\n      status: 'show'\n    });\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    if (this._hasError()) {\n      this._renderError();\n    } else if (this._isLoading()) {\n      this._renderLoading();\n    } else {\n      this.$el.html(template());\n      this._initViews();\n    }\n    return this;\n  },\n\n  _initViews: function () {\n    var formView = new FormView({\n      visDefinitionModel: this._visDefinitionModel,\n      visMetadataModel: this._visMetadataModel\n    });\n\n    this.$('.js-content').append(formView.render().el);\n    this.addView(formView);\n\n    var footerView = new FooterView({\n      visMetadataModel: this._visMetadataModel,\n      onSaveAction: this._onSave.bind(this)\n    });\n\n    this.$('.js-footer').append(footerView.render().el);\n    this.addView(footerView);\n  },\n\n  _renderError: function () {\n    var error = this._stateModel.get('error');\n    this.$el.html(templateError({\n      error: _t('components.modals.maps-metadata.error.subtitle', {error: error})\n    }));\n  },\n\n  _renderLoading: function () {\n    this.$el.html(\n      templateLoading({\n        title: _t('components.modals.maps-metadata.loading')\n      })\n    );\n  },\n\n  _initBinds: function () {\n    this._stateModel.on('change:status', this.render, this);\n    this.add_related_model(this._stateModel);\n  },\n\n  _hasError: function () {\n    return this._stateModel.get('status') === 'error';\n  },\n\n  _isLoading: function () {\n    return this._stateModel.get('status') === 'loading';\n  },\n\n  _onSave: function () {\n    this._stateModel.set({status: 'loading'});\n\n    saveMetadata({\n      onSuccess: this._onSuccessSave.bind(this),\n      onError: this._onErrorSave.bind(this),\n      visDefinitionModel: this._visDefinitionModel,\n      name: this._getMetadataName(),\n      description: this._getMetadataDescription(),\n      tags: this._getMetadataTags()\n    });\n  },\n\n  _onSuccessSave: function () {\n    var self = this;\n    Notifier.addNotification({\n      status: 'success',\n      info: _t('components.modals.maps-metadata.success', {\n        name: self._getMetadataName()\n      }),\n      closable: true,\n      delay: Notifier.DEFAULT_DELAY\n    });\n\n    this._modalModel.destroy();\n  },\n\n  _onErrorSave: function (e) {\n    this._stateModel.set({\n      status: 'error',\n      error: errorParser(e)\n    });\n  },\n\n  _onBackFromError: function () {\n    this._stateModel.set({status: 'show'});\n  },\n\n  _getMetadataName: function () {\n    return utils.sanitizeHtml(this._visMetadataModel.get('name'));\n  },\n\n  _getMetadataDescription: function () {\n    return utils.sanitizeHtml(this._visMetadataModel.get('description'));\n  },\n\n  _getMetadataTags: function () {\n    return _.map(this._visMetadataModel.get('tags'), function (tag) {\n      return utils.sanitizeHtml(tag);\n    });\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-justifyCenter\">\\n  <div class=\"Modal-inner Modal-inner--grid u-flex u-justifyCenter\">\\n    <div class=\"Modal-icon\">\\n      <svg width=\"25px\" height=\"25px\" viewBox=\"0 0 25 25\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n          <g id=\"Group\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\\n              <path d=\"M16,13 L17,13 L17,5.5 C17,5.433 16.986,5.368 16.961,5.308 C16.936,5.247 16.899,5.192 16.853,5.146 L11.854,0.147 C11.808,0.101 11.753,0.064 11.692,0.039 C11.632,0.014 11.567,0 11.5,0 L0.5,0 C0.224,0 0,0.224 0,0.5 L0,21.5 C0,21.776 0.224,22 0.5,22 L9.5,22 L9.5,21 L1,21 L1,1 L11,1 L11,5.5 C11,5.776 11.224,6 11.5,6 L16,6 L16,13 L16,13 Z M12,1.707 L15.293,5 L12,5 L12,1.707 L12,1.707 Z\" id=\"Shape\" fill=\"#2E3C43\"></path>\\n              <path d=\"M23.854,14.646 L21.354,12.146 C21.166,11.958 20.834,11.958 20.647,12.146 L13.146,19.648 C13.089,19.705 13.054,19.773 13.03,19.845 C13.028,19.852 13.021,19.857 13.019,19.865 L12.019,23.365 C11.969,23.539 12.018,23.727 12.146,23.856 C12.241,23.951 12.369,24.002 12.5,24.002 C12.546,24.002 12.592,23.996 12.637,23.983 L16.137,22.983 C16.144,22.981 16.149,22.974 16.157,22.972 C16.229,22.948 16.297,22.913 16.354,22.856 L23.855,15.354 C24.05,15.158 24.05,14.842 23.854,14.646 L23.854,14.646 Z M16,21.795 L14.207,20.002 L19.001,15.207 L20.794,17 L16,21.795 L16,21.795 Z M13.747,20.957 L15.045,22.255 L13.228,22.775 L13.747,20.957 L13.747,20.957 Z M21.501,16.293 L19.708,14.5 L21.001,13.207 L22.794,15 L21.501,16.293 L21.501,16.293 Z\" id=\"Shape\" fill=\"#2E3C43\"></path>\\n          </g>\\n      </svg>\\n    </div>\\n    <div>\\n      <h2 class=\"CDB-Text CDB-Size-huge is-light u-bSpace--xl\">\\n        '+\n((__t=( _t('components.modals.maps-metadata.modal-title') ))==null?'':_.escape(__t))+\n'\\n      </h2>\\n      <p class=\"CDB-Text CDB-Size-large u-altTextColor\">\\n        '+\n((__t=( _t('components.modals.maps-metadata.modal-desc') ))==null?'':_.escape(__t))+\n'\\n      </p>\\n      <div class=\"Modal-listTextItem js-content\"></div>\\n      <div class=\"js-footer\"></div>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var TITLE_SUFIX = require('../visualization-title-suffix-metadata');\n\nmodule.exports = function (opts) {\n  if (!opts.visDefinitionModel) throw new Error('visDefinitionModel is required');\n  if (!opts.name) throw new Error('name is required');\n\n  var visDefinitionModel = opts.visDefinitionModel;\n  var successCallback = opts.onSuccess;\n  var errorCallback = opts.onError;\n  var name = opts.name;\n  var description = opts.description;\n  var tags = opts.tags;\n\n  var oldName = visDefinitionModel.get('name');\n\n  visDefinitionModel.save({\n    name: name,\n    description: description,\n    tags: tags\n  }, {\n    wait: true,\n    success: function (mdl, attrs) {\n      document.title = name + TITLE_SUFIX;\n      successCallback && successCallback();\n    },\n    error: function (mdl, e) {\n      document.title = oldName + TITLE_SUFIX;\n      errorCallback && errorCallback(e);\n    }\n  });\n};\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\n\n/**\n * View model of a modal\n */\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    show: true,\n    createContentView: function () {\n      return new CoreView();\n    }\n  },\n\n  createContentView: function () {\n    return this.get('createContentView')(this);\n  },\n\n  show: function () {\n    this.set('show', true);\n  },\n\n  hide: function () {\n    this.set('show', false);\n  },\n\n  isHidden: function () {\n    return !this.get('show');\n  },\n\n  /**\n   * @override {Backbone.Model.prototype.destroy}\n   */\n  destroy: function () {\n    var args = Array.prototype.slice.call(arguments);\n    this.trigger.apply(this, ['destroy'].concat(args));\n  }\n});\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar template = require('./modal.tpl');\n\n// Ought to match the duration of the .Dialog.is-closing animation.\nvar CLOSE_DELAY_MS = 120;\n\nmodule.exports = CoreView.extend({\n  className: function () {\n    if (this.options.escapeOptionsDisabled) {\n      return 'Dialog is-white';\n    } else {\n      return 'Dialog is-opening is-white';\n    }\n  },\n\n  events: {\n    'click .js-close': '_onClose'\n  },\n\n  initialize: function () {\n    this.listenTo(this.model, 'change:show', this._onShowChange);\n    this.listenTo(this.model, 'destroy', this._onDestroy);\n\n    this._escapeOptionsDisabled = this.options.escapeOptionsDisabled;\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(\n      template({\n        escapeOptionsDisabled: this.options.escapeOptionsDisabled || false\n      })\n    );\n\n    var view = this.model.createContentView();\n    this.addView(view);\n    view.render();\n    this.$('.js-content').append(view.el);\n\n    return this;\n  },\n\n  show: function () {\n    this.model.show();\n  },\n\n  hide: function () {\n    this.model.hide();\n  },\n\n  destroy: function () {\n    // 'remove' would be a better name ofc, but there is already an internal method with that name in CoreView\n    this.model.destroy();\n  },\n\n  _onShowChange: function (m, show) {\n    if (show) {\n      this.$el.show();\n      this.$el.removeClass('is-closing').addClass('is-opening');\n    } else {\n      this.$el.removeClass('is-opening').addClass('is-closing');\n      this._delayDueToAnimation(function () {\n        this.$el.hide();\n      });\n    }\n  },\n\n  _onClose: function (e) {\n    e.stopPropagation();\n    this.destroy();\n  },\n\n  _onDestroy: function () {\n    this.hide();\n    _.invoke(this._subviews, 'allOff');\n    this._delayDueToAnimation(function () {\n      this.clean();\n    });\n  },\n\n  _delayDueToAnimation: function (fn) {\n    setTimeout(fn.bind(this), CLOSE_DELAY_MS);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='';\n if (!escapeOptionsDisabled) { \n__p+='\\n  <button class=\"CDB-Shape js-close Dialog-closeBtn\">\\n    <div class=\"CDB-Shape-close is-blue is-huge\"></div>\\n  </button>\\n';\n } \n__p+='\\n<div class=\"Dialog-contentWrapper js-content\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar ModalView = require('./modal-view');\nvar ModalViewModel = require('./modal-view-model');\n\nvar DESTROYED_MODAL_EVENT = 'destroyedModal';\n\n/**\n * Top-level API to handle modals.\n * Is intended to be instantiated and registered in some top-level namespace to be accessibel within the lifecycle of\n * an client-side application.\n *\n * Example:\n * // In some entry-point:\n * cdb.modals = new ModalsServiceModel();\n *\n * // Later, in any view, calling create will create a new modal viewModel\n * var modalView = cdb.modals.create(fn)\n *\n * You will probably see the name of \"Dialog\" here and there, it's the old nomenclature for the concept of Modal.\n */\nmodule.exports = Backbone.Model.extend({\n\n  /**\n   * Creates a new modal view\n   *\n   * @param {Function} createContentView\n   * @return {View} the new modal view\n   */\n  create: function (createContentView, escapeOptionsDisabled) {\n    if (!_.isFunction(createContentView)) throw new Error('createContentView is required');\n\n    if (escapeOptionsDisabled) {\n      this._escapeOptionsDisabled = escapeOptionsDisabled;\n    }\n\n    if (!this._modalView) {\n      this.trigger('willCreateModal');\n      this._modalView = this._newModalView();\n      this.trigger('didCreateModal', this._modalView);\n      document.body.appendChild(this._modalView.el);\n    }\n\n    this._modalView.model.set('createContentView', createContentView);\n    this._modalView.render();\n\n    return this._modalView;\n  },\n\n  /**\n   * Convenience method to add a listener when current modal is destroyed\n   *\n   * This is the same as doing\n   * modals.create(function (model) {\n   *   model.once('destroy', callback, context); // <-- same as modals.onDestroyOnce(callback, context);\n   *   return new MyView({  });\n   * });\n   *\n   * @param {Function} callback\n   * @param {Object} [context = undefined]\n   */\n  onDestroyOnce: function (callback, context) {\n    this.once(DESTROYED_MODAL_EVENT, callback, context);\n  },\n\n  destroy: function () {\n    if (this._modalView) {\n      this._modalView.model.destroy();\n    }\n  },\n\n  _newModalView: function () {\n    var self = this;\n    var viewModel = new ModalViewModel();\n    this._handleBodyClass(viewModel);\n\n    if (!this._escapeOptionsDisabled) {\n      this._destroyOnEsc(viewModel);\n    }\n\n    this.listenToOnce(viewModel, 'destroy', function () {\n      this._modalView = null;\n      this.trigger.apply(this, [DESTROYED_MODAL_EVENT].concat(Array.prototype.slice.call(arguments)));\n      this.stopListening(viewModel);\n    });\n    return new ModalView({\n      model: viewModel,\n      escapeOptionsDisabled: self._escapeOptionsDisabled\n    });\n  },\n\n  _destroyOnEsc: function (viewModel) {\n    var destroyOnEsc = function (ev) {\n      if (ev.keyCode === 27) {\n        ev.stopPropagation();\n        viewModel.destroy();\n      }\n    };\n    document.addEventListener('keydown', destroyOnEsc);\n    this.listenToOnce(viewModel, 'destroy', function () {\n      document.removeEventListener('keydown', destroyOnEsc);\n    });\n  },\n\n  /**\n   * TL;DR this method manages document.body class state, to enable scroll inside of an open modal.\n   *\n   * Some modal content have too much content that can be displayed in the viewport the scroll needs to be enabled.\n   * Since the modal is implemented as a fixed positioned element the body needs to be fixated too, for the scroll to\n   * be enabled inside the modal instead.\n   */\n  _handleBodyClass: function (viewModel) {\n    var bodyClass = 'is-inDialog';\n    document.body.classList.add(bodyClass);\n    this.set('open', true);\n\n    this.listenTo(viewModel, 'change:show', function (m, show) {\n      document.body.classList[show ? 'add' : 'remove'](bodyClass);\n      this.set('open', show);\n    });\n\n    this.listenToOnce(viewModel, 'destroy', function () {\n      document.body.classList.remove(bodyClass);\n      this.set('open', false);\n    });\n  },\n\n  isOpen: function () {\n    return this.get('open') === true;\n  }\n\n});\n",
    "var _ = require('underscore');\n\n/**\n * type property should match the value given from the API.\n */\nvar ALL_OPTIONS = [{\n  privacy: 'PUBLIC',\n  title: _t('components.modals.publish.privacy.public.title'),\n  desc: _t('components.modals.publish.privacy.public.body'),\n  alwaysEnabled: true,\n  cssClass: 'green'\n}, {\n  privacy: 'LINK',\n  title: _t('components.modals.publish.privacy.link.title'),\n  desc: _t('components.modals.publish.privacy.link.body'),\n  cssClass: 'orange'\n}, {\n  privacy: 'PASSWORD',\n  title: _t('components.modals.publish.privacy.password.title'),\n  desc: _t('components.modals.publish.privacy.password.body'),\n  cssClass: 'orange-dark'\n}, {\n  privacy: 'PRIVATE',\n  title: _t('components.modals.publish.privacy.private.title'),\n  desc: _t('components.modals.publish.privacy.private.body'),\n  cssClass: 'red'\n}];\n\nmodule.exports = function (visDefinitionModel, userModel) {\n  var isVisualization = visDefinitionModel.isVisualization();\n  var actions = userModel.get('actions');\n  var canSelectPremiumOptions = actions[ isVisualization ? 'private_maps' : 'private_tables' ];\n  var currentPrivacy = visDefinitionModel.get('privacy');\n  var availableOptions = visDefinitionModel.privacyOptions();\n\n  return _.chain(ALL_OPTIONS)\n    .filter(function (option) {\n      return _.contains(availableOptions, option.privacy);\n    })\n    .map(function (option) {\n      // Set state that depends on vis and user attrs, they should not vary during the lifecycle of this collection\n      return _.defaults({\n        selected: option.privacy === currentPrivacy,\n        disabled: !(option.alwaysEnabled || canSelectPremiumOptions)\n      }, option);\n    })\n    .value();\n};\n",
    "var Backbone = require('backbone');\nvar PrivacyModel = require('./privacy-model');\nvar PasswordModel = require('./privacy-password-model');\n\n/**\n * Collection that holds the different privacy options.\n */\nmodule.exports = Backbone.Collection.extend({\n\n  model: function (attrs, options) {\n    if (attrs.privacy === 'PASSWORD') {\n      return new PasswordModel(attrs, options);\n    } else {\n      return new PrivacyModel(attrs, options);\n    }\n  },\n\n  initialize: function () {\n    this.bind('change:selected', this._deselectLastSelected, this);\n  },\n\n  searchByPrivacy: function (privacy) {\n    return this.findWhere({privacy: privacy});\n  },\n\n  selectedOption: function () {\n    return this.find(function (option) {\n      return option.get('selected');\n    });\n  },\n\n  passwordOption: function () {\n    return this.find(function (option) {\n      return option.get('privacy') === 'PASSWORD';\n    });\n  },\n\n  _deselectLastSelected: function (m, isSelected) {\n    if (isSelected) {\n      this.each(function (option) {\n        if (option !== m) {\n          option.set({selected: false});\n        }\n      });\n    }\n  }\n});\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\n\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    privacy: 'PUBLIC',\n    disabled: false,\n    selected: false,\n    password: undefined\n  },\n\n  validate: function (attrs) {\n    if (attrs.disabled && attrs.selected) {\n      return 'Option can not be disabled and selected at the same time';\n    }\n  },\n\n  classNames: function () {\n    return _.chain(['disabled', 'selected'])\n      .map(function (attr) { return this.attributes[attr] !== undefined ? 'is-' + attr : undefined; }, this)\n      .compact().value().join(' ');\n  },\n\n  canSave: function () {\n    return !this.get('disabled');\n  },\n\n  isPassword: function () {\n    return false;\n  },\n\n  isSelected: function () {\n    return this.get('selected') === true;\n  },\n\n  saveToVis: function (vis, callbacks) {\n    return vis.save(this._attrsToSave(), _.extend({ wait: true }, callbacks));\n  },\n\n  _attrsToSave: function () {\n    return _.pick(this.attributes, 'privacy', 'password');\n  }\n});\n",
    "var _ = require('underscore');\nvar PrivacyModel = require('./privacy-model');\n\nvar FAKE_PASSWORD = '!@#!@#';\n\n/**\n * View model for the special privacy option representing a password protected map.\n * It handles the logic related to the password that needs to be set for the option.\n */\nmodule.exports = PrivacyModel.extend({\n\n  initialize: function () {\n    PrivacyModel.prototype.initialize.apply(this, arguments);\n    this.set('password', FAKE_PASSWORD);\n  },\n\n  /**\n   * @override OptionModel.attrsToSave\n   */\n  _attrsToSave: function () {\n    var attrs = PrivacyModel.prototype._attrsToSave.call(this);\n\n    if (attrs.password === FAKE_PASSWORD) {\n      delete attrs.password;\n    }\n\n    return attrs;\n  },\n\n  canSave: function () {\n    return !this.get('disabled') && !_.isEmpty(this.get('password'));\n  },\n\n  isPassword: function () {\n    return true;\n  }\n});\n",
    "var $ = require('jquery');\nvar moment = require('moment');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar template = require('./publish-button.tpl');\n\nvar REQUIRED_OPTS = [\n  'visDefinitionModel',\n  'mapcapsCollection',\n  'configModel'\n];\n\nmodule.exports = CoreView.extend({\n\n  events: {\n    'click .js-button': '_onUpdate'\n  },\n\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (opts[item] === undefined) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n\n    this.model = new Backbone.Model({\n      status: 'idle'\n    });\n\n    this._initBinds();\n  },\n\n  render: function () {\n    var publishedOn = this._mapcapsCollection.length > 0\n                    ? _t('components.modals.publish.share.last-published', { date:\n                        this.model.get('status') === 'updated'\n                        ? moment(this._mapcapsCollection.first().get('created_at')).fromNow()\n                        : moment(this._mapcapsCollection.first().get('created_at')).format('Do MMMM YYYY, HH:mm')\n                      })\n                    : _t('components.modals.publish.share.unpublished');\n\n    this.clearSubViews();\n    this.$el.html(template({\n      isPublished: this._mapcapsCollection.length > 0,\n      isLoading: this._isLoading(),\n      isDisabled: this._isDisabled(),\n      publishedOn: publishedOn\n    }));\n    return this;\n  },\n\n  _initBinds: function () {\n    this._mapcapsCollection.on('reset', this.render, this);\n    this.add_related_model(this._mapcapsCollection);\n    this.model.on('change:status', this.render, this);\n  },\n\n  _isLoading: function () {\n    return this.model.get('status') === 'loading';\n  },\n\n  _isDisabled: function () {\n    return this.model.get('status') === 'updated';\n  },\n\n  _onUpdate: function () {\n    var self = this;\n    var url = this._visDefinitionModel.mapcapsURL();\n    var data = {\n      api_key: this._configModel.get('api_key')\n    };\n\n    if (this._isDisabled()) return false;\n\n    self.model.set({status: 'loading'});\n\n    $.post(url, data)\n    .done(function (data) {\n      self._visDefinitionModel.set('visChanges', 0);\n      self._mapcapsCollection.add(data, {at: 0});\n      self.model.set({status: 'updated'});\n    })\n    .fail(function () {\n      self.model.set({status: 'error'});\n    });\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<button class=\"Publish-modalButton CDB-Button CDB-Button--primary CDB-Button--small u-rSpace js-button ';\n if (isDisabled) {\n__p+='is-disabled';\n } \n__p+='\">\\n  <div class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-small u-upperCase u-flex\">\\n    ';\n if (isLoading) { \n__p+='\\n      <div class=\"CDB-LoaderIcon CDB-LoaderIcon--small u-iBlock\">\\n        <svg class=\"CDB-LoaderIcon-spinner\" viewBox=\"0 0 50 50\">\\n          <circle class=\"CDB-LoaderIcon-path\" cx=\"25\" cy=\"25\" r=\"20\" fill=\"none\"></circle>\\n        </svg>\\n      </div>\\n      ';\n if (isPublished) { \n__p+='\\n      '+\n((__t=( _t('components.modals.publish.updating-btn') ))==null?'':_.escape(__t))+\n'\\n      ';\n } else { \n__p+='\\n      '+\n((__t=( _t('components.modals.publish.publishing-btn') ))==null?'':_.escape(__t))+\n'\\n      ';\n } \n__p+='\\n    ';\n } else { \n__p+='\\n      ';\n if (isPublished) { \n__p+='\\n      '+\n((__t=( _t('components.modals.publish.update-btn') ))==null?'':_.escape(__t))+\n'\\n      ';\n } else { \n__p+='\\n      '+\n((__t=( _t('components.modals.publish.publish-btn') ))==null?'':_.escape(__t))+\n'\\n      ';\n } \n__p+='\\n    ';\n } \n__p+='\\n  </div>\\n</button> '+\n((__t=( publishedOn ))==null?'':_.escape(__t))+\n'';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar moment = require('moment');\nvar CoreView = require('backbone/core-view');\nvar template = require('./publish.tpl');\nvar TabPaneTemplate = require('./tab-pane-submenu.tpl');\nvar createTextLabelsTabPane = require('../../tab-pane/create-text-labels-tab-pane');\nvar PublishView = require('./publish/publish-view');\nvar ShareView = require('./share/share-view');\nvar PrivacyDropdown = require('../../privacy-dropdown/privacy-dropdown-view');\nvar PublishButton = require('./publish-button-view');\nvar ShareWith = require('./share-with-view');\nvar UpgradeView = require('./upgrade-view');\n\nvar REQUIRED_OPTS = [\n  'modalModel',\n  'visDefinitionModel',\n  'privacyCollection',\n  'userModel',\n  'configModel'\n];\n\nvar MODE_FULL = 'full';\nvar MODE_SHARE = 'share';\nvar MODE_PUBLISH = 'publish';\n\nmodule.exports = CoreView.extend({\n  className: 'Publish-modal',\n\n  events: {\n    'click .js-done': '_onDone'\n  },\n\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (opts[item] === undefined) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n\n    // Optional options\n    this._mapcapsCollection = opts.mapcapsCollection;\n    this.mode = opts.mode || MODE_FULL;\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template({\n      name: this._visDefinitionModel.get('name'),\n      isSimple: !this._hasTabs(),\n      hasShareStats: this._hasShareStats()\n    }));\n\n    this._initViews();\n\n    if (this.mode === MODE_FULL) {\n      if (!this._hasOrganization()) {\n        this._makePublishView();\n      } else {\n        this._initTabsViews();\n      }\n    } else if (this.mode === MODE_SHARE) {\n      this._makeShareView();\n    } else if (this.mode === MODE_PUBLISH) {\n      this._makePublishView();\n    }\n\n    return this;\n  },\n\n  _hasShareStats: function () {\n    return this.mode !== MODE_PUBLISH && this._hasOrganization();\n  },\n\n  _hasOrganization: function () {\n    return this._userModel.isInsideOrg();\n  },\n\n  _hasTabs: function () {\n    var hasOrganization = this._hasOrganization();\n    return hasOrganization && this.mode === MODE_FULL;\n  },\n\n  _makePublishView: function () {\n    var view = this._createPublishView();\n    this.$('.js-panes').append(view.render().el);\n    this.addView(view);\n  },\n\n  _makeShareView: function () {\n    var view = this._createShareView();\n    this.$('.js-panes').append(view.render().el);\n    this.addView(view);\n  },\n\n  _initViews: function () {\n    var dropdown;\n    var publishButton;\n    var shareWith;\n    var upgradeView;\n    var publishedOn;\n\n    dropdown = new PrivacyDropdown({\n      privacyCollection: this._privacyCollection,\n      visDefinitionModel: this._visDefinitionModel,\n      userModel: this._userModel,\n      configModel: this._configModel\n    });\n\n    this.$('.js-dropdown').append(dropdown.render().el);\n    this.addView(dropdown);\n\n    if (this._mapcapsCollection !== undefined) {\n      publishButton = new PublishButton({\n        visDefinitionModel: this._visDefinitionModel,\n        mapcapsCollection: this._mapcapsCollection,\n        configModel: this._configModel\n      });\n\n      this.$('.js-update').append(publishButton.render().el);\n      this.addView(publishButton);\n    } else {\n      publishedOn = _t('components.modals.publish.share.last-published', { date:\n                      moment(this._visDefinitionModel.get('updated_at')).format('Do MMMM YYYY, HH:mm')\n                    });\n\n      this.$('.js-update').html(publishedOn);\n    }\n\n    if (this._hasShareStats()) {\n      shareWith = new ShareWith({\n        visDefinitionModel: this._visDefinitionModel,\n        userModel: this._userModel,\n        avatarClass: 'Share-user--big',\n        separationClass: 'u-rSpace--xl'\n      });\n      this.$('.js-share-users').append(shareWith.render().el);\n      this.addView(shareWith);\n    }\n\n    if (!this._hasOrganization()) {\n      upgradeView = new UpgradeView();\n      this.$('.js-upgrade').append(upgradeView.render().el);\n      this.addView(upgradeView);\n    }\n  },\n\n  _initTabsViews: function () {\n    var self = this;\n\n    var tabPaneTabs = [{\n      name: 'share',\n      label: _t('components.modals.publish.menu.share'),\n      createContentView: self._createShareView.bind(self)\n    }, {\n      name: 'publish',\n      label: _t('components.modals.publish.menu.publish'),\n      createContentView: self._createPublishView.bind(self)\n    }];\n\n    var tabPaneOptions = {\n      tabPaneOptions: {\n        template: TabPaneTemplate,\n        tabPaneItemOptions: {\n          tagName: 'li',\n          className: 'CDB-NavSubmenu-item'\n        }\n      },\n      tabPaneItemLabelOptions: {\n        tagName: 'button',\n        className: 'CDB-NavSubmenu-link u-upperCase Publish-modalLink'\n      }\n    };\n\n    this._layerTabPaneView = createTextLabelsTabPane(tabPaneTabs, tabPaneOptions);\n    this.$('.js-panes').append(this._layerTabPaneView.render().$el);\n    this.addView(this._layerTabPaneView);\n  },\n\n  _createShareView: function () {\n    return new ShareView({\n      className: 'Share-wrapper',\n      currentUserId: this._userModel.id,\n      visDefinitionModel: this._visDefinitionModel,\n      organization: this._userModel._organizationModel,\n      configModel: this._configModel\n    });\n  },\n\n  _createPublishView: function () {\n    return new PublishView({\n      visDefinitionModel: this._visDefinitionModel,\n      mapcapsCollection: this._mapcapsCollection,\n      userModel: this._userModel\n    });\n  },\n\n  _onDone: function () {\n    this._modalModel.destroy();\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Publish-modalHeader\">\\n  <div class=\"u-inner\">\\n    <div class=\"CDB-Text CDB-Size-huge is-light u-ellipsis u-bSpace--m\">'+\n((__t=( name ))==null?'':_.escape(__t))+\n'</div>\\n    <ul class=\"u-flex u-alignCenter\">\\n      <li class=\"js-dropdown u-rSpace--xl\"></li>\\n      ';\n if (hasShareStats) { \n__p+='\\n      <li class=\"js-share-users\">\\n      </li>\\n      ';\n } \n__p+='\\n      <li class=\"CDB-Text CDB-Size-medium u-altTextColor js-update\">\\n      </li>\\n  </div>\\n</div>\\n\\n<div class=\"Publish-modalBody js-panes\\n';\n if (isSimple) { \n__p+='is-simple';\n } \n__p+='\\n\">\\n  ';\n if (isSimple) { \n__p+='\\n    <div class=\"Publish-modalShadow\"></div>\\n  ';\n } \n__p+='\\n\\n</div>\\n\\n<div class=\"Dialog-footer Dialog-footer--expanded CreateDialog-footer Publish-modalFooter\">\\n  <div>\\n    <div class=\"CreateDialog-footerShadow\"></div>\\n    <div class=\"CreateDialog-footerLine\"></div>\\n    <div class=\"CreateDialog-footerInner \">\\n      <div class=\"CreateDialog-footerInfo\"></div>\\n      <div class=\"CreateDialog-footerActions js-footerActions u-flex u-justifySpace u-grow\">\\n        <div class=\"js-upgrade\"></div>\\n        <button class=\"CDB-Button CDB-Button--secondary js-done\">\\n          <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">'+\n((__t=( _t('components.modals.publish.done-btn') ))==null?'':_.escape(__t))+\n'</span>\\n        </button>\\n      </div>\\n    </div>\\n  </div>\\n</div>';\n}\nreturn __p;\n};\n",
    "var linkIconTemplate = require('./icon-link.tpl');\nvar embedIconTemplate = require('./icon-embed.tpl');\n\nmodule.exports = function (visDefinitionModel) {\n  return [{\n    createIcon: function () {\n      return linkIconTemplate();\n    },\n    type: 'get-link',\n    content: visDefinitionModel.embedURL(),\n    private: visDefinitionModel.get('privacy') === 'PRIVATE'\n  }, {\n    createIcon: function () {\n      return embedIconTemplate();\n    },\n    type: 'embed',\n    content: '<iframe width=\"100%\" height=\"520\" frameborder=\"0\" src=\"' + encodeURI(visDefinitionModel.embedURL()) + '\" allowfullscreen webkitallowfullscreen mozallowfullscreen oallowfullscreen msallowfullscreen></iframe>',\n    url: encodeURI(visDefinitionModel.embedURL()),\n    private: visDefinitionModel.get('privacy') === 'PRIVATE'\n  }];\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='\\n<svg width=\"25px\" height=\"25px\" viewBox=\"682 469 25 25\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n    <path d=\"M697.141667,478.48556 C695.774797,477.117815 695.774797,474.90231 697.141553,473.535553 L697.495051,473.182056 L697.141609,472.828502 L693.960609,469.646502 L693.607124,469.292907 L693.253515,469.646378 L690.685515,472.213378 L691.039,472.567 L691.469343,472.312431 C691.271611,471.978171 691.043454,471.678347 690.778553,471.413447 C689.020272,469.655166 686.171603,469.655166 684.414333,471.41356 C682.657184,473.170709 682.657184,476.020291 684.414447,477.777553 C684.682252,478.044267 684.982655,478.273359 685.314094,478.468734 L685.568,478.038 L685.214447,477.684447 L682.646447,480.252447 L682.292893,480.606 L682.646447,480.959553 L685.828447,484.141553 L686.181887,484.494994 L686.53544,484.141667 C687.903185,482.774797 690.11869,482.774797 691.485447,484.141553 C692.852184,485.508291 692.852184,487.724709 691.485447,489.091447 L691.131893,489.445 L691.485447,489.798553 L694.667447,492.980553 L695.021,493.334107 L695.374553,492.980553 L697.941553,490.413553 L697.588,490.06 L697.157928,490.315025 C697.3561,490.649221 697.584149,490.948256 697.849447,491.213553 C699.60664,492.971872 702.456485,492.971872 704.21278,491.213327 C705.970872,489.45636 705.970872,486.606515 704.212327,484.85022 C703.948015,484.584823 703.647051,484.355236 703.312906,484.158266 L703.059,484.589 L703.412553,484.942553 L705.979553,482.375553 L706.333107,482.022 L705.979553,481.668447 L702.797553,478.486447 L702.444,478.132893 L702.090447,478.486447 C700.725536,479.851357 698.508943,479.851087 697.141327,478.48522 L697.141667,478.48556 Z M696.434673,479.19278 C698.192747,480.948604 701.042155,480.948952 702.797553,479.193553 L702.090447,479.193553 L705.272447,482.375553 L705.272447,481.668447 L702.705447,484.235447 L702.248976,484.691917 L702.805094,485.019734 C703.068228,485.174844 703.301587,485.35286 703.504724,485.55683 C704.873128,486.923485 704.873128,489.13964 703.50556,490.506333 C702.139515,491.874128 699.92336,491.874128 698.556667,490.50656 C698.35252,490.302414 698.175052,490.069704 698.018072,489.804975 L697.689693,489.2512 L697.234447,489.706447 L694.667447,492.273447 L695.374553,492.273447 L692.192553,489.091447 L692.192553,489.798553 C693.949816,488.041291 693.949816,485.191709 692.192553,483.434447 C690.43531,481.677203 687.586815,481.677203 685.82856,483.434333 L686.535553,483.434447 L683.353553,480.252447 L683.353553,480.959553 L685.921553,478.391553 L686.378024,477.935083 L685.821906,477.607266 C685.560783,477.453341 685.327004,477.275057 685.12083,477.069724 C683.754816,475.703709 683.754816,473.487291 685.121553,472.120553 C686.488397,470.752834 688.703728,470.752834 690.071447,472.120553 C690.274695,472.323801 690.452152,472.557 690.608657,472.821569 L690.936742,473.376188 L691.392485,472.920622 L693.960485,470.353622 L693.253391,470.353498 L696.434391,473.535498 L696.434447,472.828447 C694.677203,474.58569 694.677203,477.434185 696.434333,479.19244 L696.434673,479.19278 Z\" id=\"Embed-it\" stroke=\"none\" fill=\"#AAAAAA\" fill-rule=\"evenodd\"></path>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='  <svg width=\"23px\" height=\"23px\" viewBox=\"683 470 23 23\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n      <path d=\"M696.399947,482.106803 L696.485947,482.192803 C697.462209,483.169066 699.044791,483.169066 700.021053,482.192803 L703.986009,478.228848 C705.34724,476.86645 705.34724,474.642218 703.986356,473.279 L702.227953,471.521596 C700.866908,470.159384 698.640092,470.159384 697.278795,471.521848 L693.313991,475.485652 C692.337722,476.461921 692.337722,478.044329 693.31372,479.021577 L693.40202,479.108865 L694.10498,478.397635 L694.01898,478.312635 C693.435278,477.728171 693.435278,476.778579 694.021053,476.192803 L697.986009,472.228848 C698.956908,471.257116 700.550092,471.257116 701.520795,472.228652 L703.279047,473.985904 C704.24976,474.958282 704.24976,476.55005 703.278795,477.521848 L699.313991,481.485652 C698.728209,482.071434 697.778791,482.071434 697.193053,481.485697 L697.107053,481.399697 L696.399947,482.106803 L696.399947,482.106803 Z M692.10498,480.397635 L692.01898,480.312635 C691.044791,479.338434 689.462209,479.338434 688.485947,480.314697 L684.520991,484.278652 C683.159735,485.641076 683.159735,487.866424 684.520795,489.228652 L686.279047,490.985904 C687.640092,492.348116 689.866908,492.348116 691.228205,490.985652 L695.193009,487.021848 C696.169278,486.045579 696.169278,484.463171 695.19328,483.485923 L695.107053,483.399697 L694.399947,484.106803 L694.485947,484.192803 C695.071722,484.779329 695.071722,485.728921 694.485947,486.314697 L690.520991,490.278652 C689.550092,491.250384 687.956908,491.250384 686.986205,490.278848 L685.227953,488.521596 C684.257265,487.550076 684.257265,485.957424 685.228205,484.985652 L689.193009,481.021848 C689.778791,480.436066 690.728209,480.436066 691.313947,481.021803 L691.40202,481.108865 L692.10498,480.397635 L692.10498,480.397635 Z M690.718053,485.495803 L698.496053,477.717803 L697.788947,477.010697 L690.010947,484.788697 L690.718053,485.495803 L690.718053,485.495803 Z\" id=\"Get-link\" stroke=\"none\" fill=\"#AAAAAA\" fill-rule=\"evenodd\"></path>\\n  </svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar CreateShareOptions = require('./create-share-options');\nvar ShareCollection = require('./share-collection');\nvar ShareItemView = require('./share-item-view');\nvar template = require('./publish.tpl');\n\nvar REQUIRED_OPTS = [\n  'visDefinitionModel',\n  'mapcapsCollection',\n  'userModel'\n];\n\nmodule.exports = CoreView.extend({\n  className: 'Publish-modalShare u-inner',\n\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (opts[item] === undefined) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n\n    this.hasOrganization = this._userModel.isInsideOrg();\n\n    var shareOptions = CreateShareOptions(this._visDefinitionModel);\n    this._shareCollection = new ShareCollection(shareOptions);\n\n    this._initBinds();\n  },\n\n  render: function () {\n    var isPublished = this._mapcapsCollection.length > 0;\n    this.clearSubViews();\n    this.$el.html(template({\n      isPublished: isPublished\n    }));\n    this._initViews();\n    return this;\n  },\n\n  _initViews: function () {\n    var renderItemView = this._renderItemView.bind(this);\n    this._shareCollection.each(renderItemView);\n  },\n\n  _renderItemView: function (model) {\n    var self = this;\n    var isPublished = this._mapcapsCollection.length > 0;\n    var view = new ShareItemView({\n      model: model,\n      isPublished: isPublished,\n      hasOrganization: self.hasOrganization\n    });\n\n    this.$('.js-list').append(view.render().el);\n    this.addView(view);\n  },\n\n  _revampPrivacyOptions: function () {\n    var shareOptions = CreateShareOptions(this._visDefinitionModel);\n    this._shareCollection.reset(shareOptions);\n  },\n\n  _initBinds: function () {\n    this._visDefinitionModel.on('sync', this._revampPrivacyOptions, this);\n    this.add_related_model(this._visDefinitionModel);\n\n    this._shareCollection.on('reset', this.render, this);\n    this.add_related_model(this._shareCollection);\n\n    this._mapcapsCollection.on('reset add', this.render, this);\n    this.add_related_model(this._mapcapsCollection);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<ul class=\"Publish-optionsList u-flex u-justifySpace js-list\"></ul>\\n';\n if (!isPublished) { \n__p+='\\n<div class=\"Share-info\">\\n  <div>\\n    <h2 class=\"CDB-Text CDB-Size-large u-secondaryTextColor u-bSpace is-light\">'+\n((__t=( _t('components.modals.publish.share.unpublished-header') ))==null?'':_.escape(__t))+\n'</h2>\\n    <p class=\"CDB-Text CDB-Size-medium is-light\">'+\n((__t=( _t('components.modals.publish.share.unpublished-subheader') ))==null?'':_.escape(__t))+\n'</p>\\n  </div>\\n</div>\\n';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar ShareModel = require('./share-model');\n\nmodule.exports = Backbone.Collection.extend({\n  model: ShareModel\n});\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar Clipboard = require('clipboard');\nvar template = require('./share-item.tpl');\nvar browserDetect = require('../../../../helpers/browser-detect');\n\nvar PRIVATE_LABEL_TEMPLATE = _.template(\"<span class='CDB-Text CDB-Size-small is-semibold u-errorTextColor'><%- private %></span>.<br>\")({\n  private: _t('components.modals.publish.share.private')\n});\n\nmodule.exports = CoreView.extend({\n  className: 'Card',\n  tagName: 'li',\n\n  events: {\n    'click .js-change-privacy': '_onChangePrivacyClick'\n  },\n\n  initialize: function (opts) {\n    if (!opts.model) throw new Error('model is required');\n    if (opts.isPublished == null) throw new Error('isPublished is required');\n\n    this._isPublished = opts.isPublished;\n    this._type = this.model.type();\n    this._hasOrganization = opts.hasOrganization;\n    this._title = _t('components.modals.publish.share.' + this._type + '.title');\n\n    if (this.model.isPrivate()) {\n      this._body = _t('components.modals.publish.share.' + this._type + '.private.body', {\n        private: PRIVATE_LABEL_TEMPLATE\n      });\n    } else {\n      this._body = _t('components.modals.publish.share.' + this._type + '.body');\n    }\n\n    this._link = _t('components.modals.publish.share.' + this._type + '.link');\n    this._copy = this._getButtonLabel();\n    this.$el.toggleClass('is-disabled', this.model.isPrivate());\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this._initViews();\n    if (!this.model.isPrivate() && this._isPublished) {\n      this._initClipboard();\n    }\n    return this;\n  },\n\n  _getButtonLabel: function () {\n    var browser = browserDetect();\n    var label = _t('components.modals.publish.share.' + this._type + '.copy');\n    if (browser.name === 'Safari') {\n      label = _t('components.modals.publish.share.' + this._type + '.select');\n    }\n\n    return label;\n  },\n\n  getValue: function () {\n    return this.$('.js-input').val();\n  },\n\n  _initViews: function () {\n    var view = template({\n      id: this.cid,\n      isPrivate: this.model.isPrivate(),\n      type: this._type,\n      title: this._title,\n      body: this._body,\n      content: this.model.content(),\n      link: this._link,\n      copy: this._copy,\n      url: this.model.url(),\n      isPublished: this._isPublished\n    });\n\n    this.$el.append(view);\n\n    var iconTemplate = this.model.createIcon();\n    this.$('.js-icon').append(iconTemplate());\n  },\n\n  _initClipboard: function () {\n    if (this._clipboard) {\n      this._clipboard.destroy();\n    }\n\n    var btn = this.$('.js-copy');\n    this._clipboard = new Clipboard(btn.get(0));\n  },\n\n  _onChangePrivacyClick: function (e) {\n    this.killEvent(e);\n    this.options.onChangePrivacy && this.options.onChangePrivacy();\n  },\n\n  clean: function () {\n    this._clipboard && this._clipboard.destroy();\n    CoreView.prototype.clean.call(this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Card-icon u-bSpace--xl js-icon\"></div>\\n\\n<div class=\"Card-body u-bSpace--xl\">\\n  ';\n if (isPrivate) { \n__p+='\\n    <h3 class=\"CDB-Text CDB-Size-large u-altTextColor u-bSpace--m\">'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</h3>\\n  ';\n } else { \n__p+='\\n    <h3 class=\"CDB-Text CDB-Size-large u-mainTextColor u-bSpace--m\">'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</h3>\\n  ';\n } \n__p+='\\n  <div class=\"CDB-Text CDB-Size-medium u-altTextColor\">\\n    '+\n((__t=( body ))==null?'':__t)+\n'\\n    <br/>\\n    ';\n if (url && !isPrivate) { \n__p+='\\n    <a href=\"'+\n((__t=( url ))==null?'':_.escape(__t))+\n'\" class=\"Share-link js-link\">'+\n((__t=( link ))==null?'':_.escape(__t))+\n'</a>\\n    ';\n } \n__p+='\\n  </div>\\n</div>\\n\\n';\n if (!isPrivate && isPublished) { \n__p+='\\n  <div class=\"Share-input\">\\n    <input type=\"text\" id=\"'+\n((__t=( id ))==null?'':_.escape(__t))+\n'\" value=\"'+\n((__t=( content ))==null?'':_.escape(__t))+\n'\" class=\"Share-input-field CDB-InputText is-disabled CDB-Text CDB-Size-medium u-ellipsis js-input\" readonly>\\n    <button class=\"Share-copy CDB-Button CDB-Button--small js-copy\" data-clipboard-target=\"#'+\n((__t=( id ))==null?'':_.escape(__t))+\n'\">\\n      <span class=\"CDB-Button-Text CDB-Text CDB-Size-small u-actionTextColor\">'+\n((__t=( copy ))==null?'':_.escape(__t))+\n'</span>\\n    </button>\\n  </div>\\n';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\n\nmodule.exports = Backbone.Model.extend({\n  createIcon: function () {\n    return this.get('createIcon');\n  },\n\n  type: function () {\n    return this.get('type');\n  },\n\n  content: function () {\n    return this.get('content');\n  },\n\n  url: function () {\n    return this.get('url');\n  },\n\n  isPrivate: function () {\n    return this.get('private');\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar template = require('./share-with.tpl');\n\nvar REQUIRED_OPTS = [\n  'visDefinitionModel',\n  'userModel'\n];\n\nmodule.exports = CoreView.extend({\n  className: 'Share-with u-flex u-alignCenter',\n\n  events: {\n    'click .js-action': '_onAction'\n  },\n\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (opts[item] === undefined) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n\n    this.separationClass = opts.separationClass || '';\n    this.avatarClass = opts.avatarClass || '';\n\n    this._acl = this._visDefinitionModel._permissionModel.acl;\n    this._initBinds();\n  },\n\n  render: function () {\n    var people = this._getPeople();\n    var hasAction = this.options.action !== undefined && this._hasOrganization();\n\n    this.clearSubViews();\n    this.$el.html(template({\n      avatar: this._userModel.get('avatar_url'),\n      people: people,\n      avatarClass: this.avatarClass,\n      separationClass: this.separationClass,\n      hasAction: hasAction\n    }));\n    return this;\n  },\n\n  _getPeople: function () {\n    var types = this._acl.pluck('type');\n    if (types.indexOf('org') > -1) {\n      return this._userModel.getOrganization().get('user_count') - 1;\n    } else {\n      var users = [];\n\n      // Grab all ids from every group\n      _.each(this._acl.where({type: 'group'}), function (group) {\n        var entity = group.get('entity');\n        Array.prototype.push.apply(users, entity.users.pluck('id'));\n      }, this);\n\n      // Grab all ids from every user\n      _.each(this._acl.where({type: 'user'}), function (group) {\n        var entity = group.get('entity');\n        users.push(entity.get('id'));\n      }, this);\n\n      // remove current user id because it can be part of a group\n      users = _.without(users, this._userModel.id);\n\n      // counts unique ids\n      return _.unique(users).length;\n    }\n  },\n\n  _hasOrganization: function () {\n    return this._userModel.isInsideOrg();\n  },\n\n  _initBinds: function () {\n    this._acl.on('fetch', this.render, this);\n    this.add_related_model(this._acl);\n  },\n\n  _onAction: function () {\n    this.options.action && this.options.action();\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='';\n if (people > 0) { \n__p+='\\n<div class=\"Share-user '+\n((__t=( avatarClass ))==null?'':_.escape(__t))+\n' u-rSpace u-iBlock\" style=\"background-image: url('+\n((__t=( avatar ))==null?'':_.escape(__t))+\n')\"></div>\\n<span class=\"u-secondaryTextColor CDB-Text CDB-Size-small '+\n((__t=( separationClass ))==null?'':_.escape(__t))+\n'\">+ '+\n((__t=( people ))==null?'':_.escape(__t))+\n'</span>\\n';\n } else { \n__p+='\\n  ';\n if (hasAction) { \n__p+='\\n  <button class=\"CDB-Text CDB-Size-small u-upperCase u-actionTextColor js-action '+\n((__t=( separationClass ))==null?'':_.escape(__t))+\n'\">'+\n((__t=( _t('components.modals.publish.share.add-people') ))==null?'':_.escape(__t))+\n'</button>\\n  ';\n } \n__p+='\\n';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar PermissionView = require('./share-permission-view');\n\nvar REQUIRED_OPTS = [\n  'collection',\n  'currentUserId',\n  'organization',\n  'hasOrganization',\n  'sharePermissionModel',\n  'isVisualization'\n];\n\nmodule.exports = CoreView.extend({\n  className: 'Share-list',\n\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (opts[item] === undefined) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n\n    // To avoid jumps in rendering when the user gets permission\n    // we sort the collection only the first time\n    this._sortedCollection = this._sortCollection();\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this._initViews();\n    return this;\n  },\n\n  _initBinds: function () {\n    this._sharePermissionModel.acl.on('add remove reset change', this.render, this);\n    this.add_related_model(this._sharePermissionModel);\n  },\n\n  _initViews: function () {\n    if (this._hasOrganization) {\n      this._renderOrganization();\n    }\n\n    _.each(this._sortedCollection, this._renderItem, this);\n  },\n\n  _sortCollection: function () {\n    // sharing first\n    var sharing = this._collection.filter(function (model) {\n      var permission = this._sharePermissionModel;\n      var hasWriteAccess = permission.hasWriteAccess(model);\n      var hasReadAccess = permission.hasReadAccess(model);\n      return hasWriteAccess || hasReadAccess;\n    }, this);\n\n    var noSharing = this._collection.filter(function (model) {\n      var permission = this._sharePermissionModel;\n      var hasWriteAccess = permission.hasWriteAccess(model);\n      var hasReadAccess = permission.hasReadAccess(model);\n      return !hasWriteAccess && !hasReadAccess;\n    }, this);\n\n    return sharing.concat(noSharing);\n  },\n\n  _renderOrganization: function () {\n    var self = this;\n    var organization = this._organization;\n    var permission = this._sharePermissionModel;\n    var hasWriteAccessAvailable = !self._isVisualization;\n    var canChangeWriteAccess = permission.canChangeWriteAccess(organization);\n    var hasWriteAccess = permission.hasWriteAccess(organization);\n    var canChangeReadAccess = permission.canChangeReadAccess(organization);\n    var hasReadAccess = permission.hasReadAccess(organization);\n\n    var view = new PermissionView({\n      model: organization,\n      permission: permission,\n      avatar: organization.get('avatar_url'),\n      description: _t('components.modals.publish.share.organization.desc'),\n      name: _t('components.modals.publish.share.organization.title'),\n      canChangeReadAccess: canChangeReadAccess,\n      hasReadAccess: hasReadAccess,\n      hasWriteAccessAvailable: hasWriteAccessAvailable,\n      canChangeWriteAccess: canChangeWriteAccess,\n      hasWriteAccess: hasWriteAccess,\n      isSelected: hasReadAccess || hasWriteAccess\n    });\n\n    this.$el.append(view.render().$el);\n    this.addView(view);\n  },\n\n  _renderItem: function (model) {\n    var self = this;\n    var view;\n    var o = model.get('model');\n    var permission = this._sharePermissionModel;\n    var hasWriteAccessAvailable = !self._isVisualization;\n    var canChangeWriteAccess = permission.canChangeWriteAccess(model);\n    var hasWriteAccess = permission.hasWriteAccess(model);\n    var canChangeReadAccess = permission.canChangeReadAccess(model);\n    var hasReadAccess = permission.hasReadAccess(model);\n    var role = this._getRole(o);\n\n    if (model.id !== this._currentUserId) {\n      view = new PermissionView({\n        model: model,\n        permission: permission,\n        name: model.get('name'),\n        avatar: model.get('avatar_url'),\n        role: role,\n        users: o.users,\n        canChangeReadAccess: canChangeReadAccess,\n        hasReadAccess: hasReadAccess,\n        hasWriteAccessAvailable: hasWriteAccessAvailable,\n        canChangeWriteAccess: canChangeWriteAccess,\n        hasWriteAccess: hasWriteAccess,\n        isSelected: hasReadAccess || hasWriteAccess\n      });\n\n      this.$el.append(view.render().$el);\n      this.addView(view);\n    }\n  },\n\n  _getRole: function (d) {\n    if (d.viewer !== undefined) {\n      return d.viewer === true ? _t('components.modals.publish.share.role.viewer')\n                               : _t('components.modals.publish.share.role.builder');\n    }\n\n    return false;\n  }\n});\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar template = require('./share-permission.tpl');\nvar TipsyTooltipView = require('../../../tipsy-tooltip-view.js');\nvar $ = require('jquery');\nvar UsersGroup = require('./users-group-view');\n\nvar REQUIRED_OPTS = [\n  'model',\n  'permission',\n  'name',\n  'canChangeReadAccess',\n  'hasReadAccess',\n  'hasWriteAccessAvailable',\n  'canChangeWriteAccess',\n  'hasWriteAccess',\n  'isSelected'\n];\n\nvar OPTIONALS_OPT = [\n  'description',\n  'role',\n  'avatar',\n  'users'\n];\n\nmodule.exports = CoreView.extend({\n  className: 'Share-permission',\n\n  events: {\n    'change .js-read': '_onChangeRead',\n    'change .js-write': '_onChangeWrite',\n    'mouseover .js-toggler.is-disabled': '_onHoverDisabledToggler',\n    'mouseout .js-toggler': '_destroyTooltip',\n    'mouseleave .js-toggler': '_destroyTooltip'\n  },\n\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (opts[item] === undefined) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n\n    _.each(OPTIONALS_OPT, function (item) {\n      this['_' + item] = opts[item];\n    }, this);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template({\n      name: this._name,\n      avatar: this._avatar,\n      role: this._role,\n      users: this._users,\n      description: this._description,\n      canChangeReadAccess: this._canChangeReadAccess,\n      hasReadAccess: this._hasReadAccess,\n      hasWriteAccessAvailable: this._hasWriteAccessAvailable,\n      canChangeWriteAccess: this._canChangeWriteAccess,\n      hasWriteAccess: this._hasWriteAccess\n    }));\n\n    if (this._users) {\n      this._renderUsers();\n    }\n\n    this.$el.toggleClass('is-selected', this._isSelected);\n    return this;\n  },\n\n  _renderUsers: function () {\n    var view = new UsersGroup({\n      className: 'u-flex u-alignCenter',\n      users: this._users\n    });\n\n    this.$('.js-users').append(view.render().el);\n    this.addView(view);\n  },\n\n  _onChangeWrite: function () {\n    var p = this._permission;\n    if (p.canChangeWriteAccess(this._model)) {\n      if (p.hasWriteAccess(this._model)) {\n        p.revokeWriteAccess(this._model);\n      } else {\n        p.grantWriteAccess(this._model);\n      }\n    }\n  },\n\n  _onChangeRead: function () {\n    var p = this._permission;\n    if (p.canChangeReadAccess(this._model)) {\n      if (p.hasReadAccess(this._model)) {\n        p.revokeAccess(this._model);\n      } else {\n        p.grantReadAccess(this._model);\n      }\n    }\n  },\n\n  _onHoverDisabledToggler: function (e) {\n    var aclItem = this._permission.findRepresentableAclItem(this._model);\n    var msg;\n    var $el;\n\n    if (aclItem && !aclItem.isOwn(this._model)) {\n      msg = this._inheritedAccessTooltipText(aclItem);\n      $el = $(e.currentTarget);\n\n      this._tooltip = this._createTooltip({\n        $el: $el,\n        msg: msg\n      });\n      this._tooltip.showTipsy();\n    }\n  },\n\n  _createTooltip: function (opts) {\n    return new TipsyTooltipView({\n      el: opts.$el,\n      title: function () {\n        return opts.msg;\n      }\n    });\n  },\n\n  _destroyTooltip: function () {\n    if (this._tooltip) {\n      this._tooltip.hideTipsy();\n      this._tooltip.destroyTipsy();\n    }\n  },\n\n  _inheritedAccessTooltipText: function (aclItem) {\n    var type = aclItem.get('type');\n\n    switch (type) {\n      case 'group':\n        return _t('components.modals.publish.share.tooltip.group', {\n          name: aclItem.get('entity').get('name')\n        });\n      case 'org':\n        return _t('components.modals.publish.share.tooltip.org');\n      default:\n        console.error('Trying to display inherited access for an unrecognized type ' + type);\n        return '';\n    }\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Share-permissionInfo\">\\n  <div class=\"Share-permissionIcon\">\\n    ';\n if (avatar) { \n__p+='\\n      <div class=\"Share-user Share-user--huge\" style=\"background-image: url('+\n((__t=( avatar ))==null?'':_.escape(__t))+\n')\"></div>\\n    ';\n } else { \n__p+='\\n        <i class=\"CDB-IconFont CDB-IconFont-people\"></i>\\n    ';\n } \n__p+='\\n  </div>\\n  <div>\\n    <div class=\"CDB-Text u-mainTextColor CDB-Size-medium is-semibold u-ellipsis\">\\n      '+\n((__t=( name ))==null?'':_.escape(__t))+\n'\\n    </div>\\n\\n\\n    <div class=\"CDB-Text u-mainTextColor u-tSpace CDB-Size-medium u-ellipsis\">\\n      ';\n if (role) { \n__p+='\\n        <i class=\"Tag Tag--outline Tag--'+\n((__t=( role ))==null?'':_.escape(__t))+\n' CDB-Text CDB-Size-small u-upperCase\">'+\n((__t=( role ))==null?'':_.escape(__t))+\n'</i>\\n      ';\n } \n__p+='\\n\\n      ';\n if (users) { \n__p+='\\n        <div class=\"js-users\"></div>\\n      ';\n } \n__p+='\\n    </div>\\n\\n\\n    ';\n if (description) { \n__p+='\\n    <div class=\"CDB-Text u-mainTextColor u-tSpace CDB-Size-medium u-ellipsis\">\\n      '+\n((__t=( description ))==null?'':_.escape(__t))+\n'\\n    </div>\\n    ';\n } \n__p+='\\n  </div>\\n</div>\\n<div class=\"Share-togglers\">\\n  ';\n if (hasWriteAccessAvailable) { \n__p+='\\n    <div class=\"CDB-Text CDB-Size-medium u-rSpace--xl Share-toggler js-toggler ';\n if (!canChangeWriteAccess) { \n__p+='is-disabled';\n } \n__p+='\">\\n      <input class=\"CDB-Toggle u-iBlock js-write\" type=\"checkbox\"\\n        ';\n if (!canChangeWriteAccess) { \n__p+='disabled=\"disabled\"';\n } \n__p+='\\n        ';\n if (hasWriteAccess) { \n__p+=' checked ';\n } \n__p+='\\n      />\\n      <span class=\"u-iBlock CDB-ToggleFace\"></span>\\n      <label class=\"u-iBlock u-altTextColor \">'+\n((__t=( _t('components.modals.publish.share.toggle.write') ))==null?'':_.escape(__t))+\n'</label>\\n    </div>\\n  ';\n } \n__p+='\\n  <div class=\"CDB-Text CDB-Size-medium Share-toggler js-toggler ';\n if (!canChangeReadAccess) { \n__p+='is-disabled';\n } \n__p+='\">\\n    <input class=\"CDB-Toggle u-iBlock js-read\" type=\"checkbox\"\\n      ';\n if (hasReadAccess) { \n__p+=' checked ';\n } \n__p+='\\n      ';\n if (!canChangeReadAccess) { \n__p+='disabled=\"disabled\"';\n } \n__p+='\\n    />\\n    <span class=\"u-iBlock CDB-ToggleFace\"></span>\\n    <label class=\"u-iBlock u-altTextColor \">'+\n((__t=( _t('components.modals.publish.share.toggle.read') ))==null?'':_.escape(__t))+\n'</label>\\n  </div>\\n</div>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar template = require('./share.tpl');\nvar GrantableCollection = require('../../../../data/grantables-collection');\nvar SearchPaginationView = require('../../../../components/pagination-search/pagination-search-view');\nvar ListView = require('./share-list-view');\n\nvar REQUIRED_OPTS = [\n  'configModel',\n  'currentUserId',\n  'organization',\n  'visDefinitionModel'\n];\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (!opts[item]) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n\n    this._grantablesCollection = new GrantableCollection([], {\n      currentUserId: this._currentUserId,\n      organization: this._organization,\n      configModel: this._configModel\n    });\n\n    this._sharePermissionModel = this._visDefinitionModel.getPermissionModel().clone();\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template({\n      name: this._visDefinitionModel.get('name')\n    }));\n    this._initViews();\n    return this;\n  },\n\n  _initBinds: function () {\n    this._sharePermissionModel.acl.on('add remove reset change', this._onSave, this);\n    this.add_related_model(this._sharePermissionModel.acl);\n  },\n\n  _initViews: function () {\n    var self = this;\n\n    this._searchPaginationView = new SearchPaginationView({\n      className: 'u-inner',\n      listCollection: this._grantablesCollection,\n      createContentView: function (opts) {\n        return new ListView(_.extend({}, opts, {\n          collection: self._grantablesCollection,\n          currentUserId: self._currentUserId,\n          sharePermissionModel: self._sharePermissionModel,\n          organization: self._organization,\n          isVisualization: self._visDefinitionModel.isVisualization()\n        }));\n      }\n    });\n    this.addView(this._searchPaginationView);\n    this.$('.js-body').html(this._searchPaginationView.render().el);\n  },\n\n  _onCancel: function () {\n    this._modalModel.destroy();\n  },\n\n  _onBack: function () {\n    this._modalModel.destroy();\n    this._onBack();\n  },\n\n  _onSave: function () {\n    var permission = this._visDefinitionModel.getPermissionModel();\n    permission.overwriteAcl(this._sharePermissionModel);\n    // Show loading here\n    permission.save()\n      .fail(this._searchPaginationView.showError.bind(this._searchPaginationView));\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"js-body\">\\n\\n</div>';\n}\nreturn __p;\n};\n",
    "var $ = require('jquery');\nvar _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar template = require('./user.tpl');\nvar TipsyTooltipView = require('../../../tipsy-tooltip-view');\n\nvar REQUIRED_OPTS = [\n  'username',\n  'avatar'\n];\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (opts[item] === undefined) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template({\n      avatar: this._avatar,\n      username: this._username\n    }));\n\n    this._initViews();\n    return this;\n  },\n\n  _initViews: function () {\n    var tooltip = new TipsyTooltipView({\n      el: this.$('.js-avatar'),\n      title: function () {\n        return $(this).attr('data-title');\n      }\n    });\n\n    this.addView(tooltip);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Share-user u-rSpace js-avatar\" style=\"background-image: url('+\n((__t=( avatar ))==null?'':_.escape(__t))+\n')\" data-title=\"'+\n((__t=( username ))==null?'':_.escape(__t))+\n'\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar template = require('./users-group.tpl');\nvar UserView = require('./user-view');\n\nvar REQUIRED_OPTS = [\n  'users'\n];\n\nvar MAX_USERS_TO_SHOW = 3;\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (!opts[item]) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template({\n      people: this._getRemainsPeople()\n    }));\n    this._renderUsers();\n    return this;\n  },\n\n  _getRemainsPeople: function () {\n    return Math.max(0, this._users.length - MAX_USERS_TO_SHOW);\n  },\n\n  _renderUsers: function () {\n    _.each(this._users.slice(0, MAX_USERS_TO_SHOW), this._renderUser, this);\n  },\n\n  _renderUser: function (user) {\n    var view = new UserView({\n      username: user.username,\n      avatar: user.avatar_url\n    });\n\n    this.$('.js-content').append(view.render().el);\n    this.addView(view);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex js-content\"></div>\\n';\n if (people > 0) { \n__p+='\\n  <div class=\"u-secondaryTextColor CDB-Text CDB-Size-small u-lSpace\">+ '+\n((__t=( people ))==null?'':_.escape(__t))+\n'</div>\\n';\n } \n__p+='';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Publish-modalMenu u-tSpace-xl\">\\n  <nav class=\"CDB-NavMenu u-inner\">\\n    <ul class=\"CDB-Size-medium CDB-Text is-semibold js-menu\"></ul>\\n  </nav>\\n</div>\\n\\n<div class=\"Tab-paneContent Publish-modalContent js-content\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar template = require('./upgrade.tpl');\n\nvar CONTACT_LINK_TEMPLATE = _.template(\"<a href='mailto:<%- mail %>'><%- contact %></a>\")({\n  contact: _t('components.modals.publish.privacy.upgrade.contact'),\n  mail: _t('components.modals.publish.privacy.upgrade.mail')\n});\n\nmodule.exports = CoreView.extend({\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this._initViews();\n    return this;\n  },\n\n  _initViews: function () {\n    var html = template({\n      title: _t('components.modals.publish.privacy.upgrade.title'),\n      desc: _t('components.modals.publish.privacy.upgrade.desc', {\n        contact: CONTACT_LINK_TEMPLATE\n      })\n    });\n    this.$el.html(html);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-alignCenter\">\\n  <div class=\"Upgrade-icon u-rSpace--xl\">\\n    <svg width=\"16px\" height=\"16px\" viewBox=\"578 456 16 16\">\\n      <g id=\"present\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(578.000000, 456.000000)\">\\n        <path d=\"M10.0946667,4.4109223 C10.8886667,4.1368747 11.6846667,3.80147316 12.0073333,3.4715253 C12.7866667,2.67392407 12.7866667,1.37662907 12.0073333,0.579027844 C11.2513333,-0.193350099 9.934,-0.192668389 9.17866667,0.579027844 C8.74133333,1.0262299 8.29266667,2.36033726 8,3.37608583 C7.70666667,2.36033726 7.25866667,1.0262299 6.82133333,0.579027844 C6.066,-0.193350099 4.748,-0.192668389 3.99266667,0.579027844 C3.21266667,1.37662907 3.21266667,2.67392407 3.99266667,3.4715253 C4.316,3.80147316 5.11133333,4.1368747 5.90533333,4.4109223 L0.333333333,4.4109223 C0.149333333,4.4109223 0,4.56362544 0,4.75177753 L0,7.47861934 C0,7.66677142 0.149333333,7.81947456 0.333333333,7.81947456 L0.666666667,7.81947456 L0.666666667,15.6591448 C0.666666667,15.8472969 0.816,16 1,16 L15,16 C15.184,16 15.3333333,15.8472969 15.3333333,15.6591448 L15.3333333,7.81947456 L15.6666667,7.81947456 C15.8506667,7.81947456 16,7.66677142 16,7.47861934 L16,4.75177753 C16,4.56362544 15.8506667,4.4109223 15.6666667,4.4109223 L10.0946667,4.4109223 Z M6,6.95652174 L6,4.86956522 L10,4.86956522 L10,6.95652174 L6,6.95652174 L6,6.95652174 Z M10,7.65217391 L10,15.3043478 L6,15.3043478 L6,7.65217391 L10,7.65217391 L10,7.65217391 Z M9.80833133,1.08822938 C10.0510474,0.834996985 10.3727426,0.695652174 10.7169115,0.695652174 C11.0597961,0.695652174 11.3821334,0.834996985 11.6248495,1.08755946 C12.1250502,1.6101025 12.1250502,2.46023983 11.6248495,2.98278288 C11.2729754,3.34990286 9.79227867,3.85636766 8.66666667,4.17391304 C8.97102496,2.99953105 9.45581507,1.45534937 9.80833133,1.08822938 L9.80833133,1.08822938 Z M4.37515049,1.08822938 C4.6178666,0.834996985 4.94020387,0.695652174 5.28373064,0.695652174 C5.6266153,0.695652174 5.94895256,0.834996985 6.19166867,1.08755946 C6.54354282,1.45467944 7.02833293,2.99886112 7.33333333,4.17391304 C6.20707922,3.85569773 4.72638253,3.34990286 4.37515049,2.98278288 C3.87494984,2.46090976 3.87494984,1.61077243 4.37515049,1.08822938 L4.37515049,1.08822938 Z M0.666666667,4.86956522 L5.33333333,4.86956522 L5.33333333,6.95652174 L1,6.95652174 L0.666666667,6.95652174 L0.666666667,4.86956522 L0.666666667,4.86956522 Z M1.33333333,7.65217391 L5.33333333,7.65217391 L5.33333333,15.3043478 L1.33333333,15.3043478 L1.33333333,7.65217391 L1.33333333,7.65217391 Z M14.6666667,15.3043478 L10.6666667,15.3043478 L10.6666667,7.65217391 L14.6666667,7.65217391 L14.6666667,15.3043478 L14.6666667,15.3043478 Z M15.3333333,6.95652174 L15,6.95652174 L10.6666667,6.95652174 L10.6666667,4.86956522 L15.3333333,4.86956522 L15.3333333,6.95652174 L15.3333333,6.95652174 Z\" id=\"Shape\" fill=\"#9BC63B\"></path>\\n      </g>\\n    </svg>\\n  </div>\\n  <div class=\"Upgrade-body\">\\n    <h2 class=\"CDB-Text CDB-Size-large\">'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</h2>\\n    <p class=\"CDB-Text CDB-Size-medium u-altTextColor \">'+\n((__t=( desc ))==null?'':__t)+\n'</p>\\n  </div>\\n</div>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar ConfirmationView = require('../confirmation/modal-confirmation-view');\nvar ExportView = require('../../../editor/components/modals/export-map/modal-export-map-view.js');\nvar ExportMapModel = require('../../../data/export-map-definition-model.js');\nvar templateConfirmation = require('../../../editor/layers/delete-layer-confirmation.tpl');\nvar removeLayer = require('../../../editor/layers/operations/remove-layer');\nvar REQUIRED_OPTS = [\n  'modalModel',\n  'layerModel',\n  'modals',\n  'widgetDefinitionsCollection',\n  'visDefinitionModel',\n  'userActions'\n];\n/**\n *  Remove layer modal dialog\n */\n\nmodule.exports = ConfirmationView.extend({\n  className: 'Dialog-content',\n\n  events: function () {\n    return _.extend({}, ConfirmationView.prototype.events, {\n      'click [data-event=exportMapAction]': '_exportMap'\n    });\n  },\n\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (!opts[item]) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n\n    if (opts.loadingTitle) {\n      this._hasLoading = true;\n      this._loadingTitle = opts.loadingTitle;\n    }\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    this.$el.html(\n      templateConfirmation({\n        layerName: this._layerModel.getTableName(),\n        layerVisName: this._visDefinitionModel.get('name'),\n        affectedItemsMessages: this._getAffectedItemsMessages()\n      })\n    );\n    return this;\n  },\n\n  _getAffectedItemsByLayer: function () {\n    var layerModel = this._layerModel;\n    var widgetDefinitionsCollection = this._widgetDefinitionsCollection;\n\n    return [\n      { widgets: widgetDefinitionsCollection.widgetsOwnedByLayer(layerModel.get('id')) },\n      { analyses: layerModel.getNumberOfAnalyses() },\n      { layers: layerModel.getAllDependentLayers() }\n    ];\n  },\n\n  _getAffectedItemsMessages: function () {\n    var affectedItems = this._getAffectedItemsByLayer();\n    var affectedTemplateMessages = [];\n\n    for (var i = 0; i < affectedItems.length; i++) {\n      for (var key in affectedItems[i]) {\n        if (affectedItems[i][key] > 0) {\n          var text = _t('editor.layers.delete.' + key, { smart_count: affectedItems[i][key] });\n          affectedTemplateMessages.push(text);\n        }\n      }\n    }\n    return affectedTemplateMessages;\n  },\n\n  _exportMap: function () {\n    var self = this;\n\n    this._modals.create(function () {\n      var exportMapModel = new ExportMapModel({\n        visualization_id: self._visDefinitionModel.get('id')\n      }, {\n        configModel: this.configModel\n      });\n\n      return new ExportView({\n        modalModel: self._modalModel,\n        exportMapModel: exportMapModel,\n        renderOpts: {\n          name: self._visDefinitionModel.get('name')\n        }\n      });\n    });\n  },\n\n  _runAction: function () {\n    removeLayer({\n      userActions: this._userActions,\n      layerDefinitionModel: this._layerModel\n    });\n\n    this._modalModel.destroy();\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./sync-options-modal.tpl');\nvar renderLoading = require('../../loading/render-loading');\nvar ErrorView = require('../../error/error-view');\nvar errorParser = require('../../../helpers/error-parser');\n\nmodule.exports = CoreView.extend({\n  className: 'Dialog-content',\n\n  events: {\n    'click .js-confirm': '_onConfirm',\n    'click .js-cancel': '_onCancel'\n  },\n\n  initialize: function (opts) {\n    if (!opts.modalModel) throw new Error('modalModel is required');\n    if (!opts.syncModel) throw new Error('syncModel is required');\n    if (!opts.tableName) throw new Error('tableName is required');\n\n    this._syncModel = opts.syncModel;\n    this._modalModel = opts.modalModel;\n    this._tableName = opts.tableName;\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(\n      template({\n        interval: this._syncModel.get('interval'),\n        service: this._syncModel.get('service_name') || '',\n        isExternalSource: this._syncModel.get('from_external_source'),\n        url: this._getServiceURL()\n      })\n    );\n  },\n\n  _renderErrorView: function (errorMessage) {\n    var errorView = new ErrorView({\n      title: _t('dataset.sync.error'),\n      desc: errorMessage\n    });\n    this.$el.html(errorView.render().el);\n    this.addView(errorView);\n  },\n\n  _renderLoadingView: function () {\n    this.$el.html(\n      renderLoading({\n        title: _t('dataset.sync.loading', { tableName: this._tableName })\n      })\n    );\n  },\n\n  _getServiceURL: function () {\n    if (this._syncModel.get('service_name') || this._syncModel.get('service_item_id')) {\n      return this._syncModel.get('service_item_id');\n    }\n    return this._syncModel.get('url');\n  },\n\n  _onConfirm: function () {\n    var interval = parseInt(this.$('[name=\"interval\"]:checked').val(), 10);\n    var opts = {\n      wait: true,\n      success: function () {\n        this._modalModel.destroy();\n      }.bind(this),\n      error: function (mdl, e) {\n        this._renderErrorView(errorParser(e));\n      }.bind(this)\n    };\n\n    this._renderLoadingView();\n\n    if (this._syncModel.get('interval') !== interval) {\n      if (!interval) {\n        this._syncModel.destroy(opts);\n      } else {\n        this._syncModel.save({\n          interval: interval\n        }, opts);\n      }\n    } else {\n      this._modalModel.destroy();\n    }\n  },\n\n  _onCancel: function () {\n    this._modalModel.destroy();\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-justifyCenter\">\\n  <div class=\"Modal-inner Modal-inner--full u-flex u-justifyCenter\">\\n    <div class=\"Modal-icon\">\\n      <svg width=\"24px\" height=\"20px\" viewBox=\"0 8 24 20\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n          <g id=\"Icon\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(0.000000, 8.000000)\">\\n              <path d=\"M19.591513,9.26858726 C19.7142261,9.39218837 19.8745043,9.45462604 20.0347826,9.45462604 C20.1950609,9.45462604 20.3553391,9.39218837 20.4780522,9.26858726 C20.7222261,9.0201108 20.7222261,8.61617729 20.4780522,8.36770083 C20.1988174,8.08354571 19.908313,7.81468144 19.6065391,7.56365651 C19.5652174,7.52925208 19.5201391,7.4999446 19.4775652,7.46554017 C17.3914435,5.76952909 14.824487,4.84060942 12.1147826,4.84060942 L12.1122783,4.84060942 L12.1097739,4.84060942 C8.95053913,4.84060942 5.98038261,6.0931856 3.74775652,8.36770083 C3.50358261,8.61617729 3.50358261,9.0201108 3.74775652,9.26858726 C3.87046957,9.3934626 4.03074783,9.45462604 4.19102609,9.45462604 C4.35130435,9.45462604 4.51158261,9.39218837 4.63304348,9.26858726 C6.63151304,7.23490305 9.28737391,6.11484765 12.1122783,6.11484765 C14.9371826,6.11484765 17.5930435,7.23490305 19.591513,9.26858726 L19.591513,9.26858726 Z\" id=\"Shape\" fill=\"#2E3C43\"></path>\\n              <path d=\"M22.7607652,5.95695291 C22.8834783,6.08182825 23.0437565,6.14299169 23.2040348,6.14299169 C23.364313,6.14299169 23.5245913,6.08055402 23.6473043,5.95695291 C23.8914783,5.70847645 23.8914783,5.30454294 23.6473043,5.05606648 C17.2862609,-1.41706371 6.93704348,-1.41451524 0.578504348,5.05606648 C0.334330435,5.30454294 0.334330435,5.70847645 0.578504348,5.95695291 C0.822678261,6.20542936 1.21961739,6.20542936 1.4637913,5.95695291 C7.33398261,-0.0179501385 16.8905739,-0.0166759003 22.7607652,5.95695291 L22.7607652,5.95695291 Z\" id=\"Shape\" fill=\"#2E3C43\"></path>\\n              <path d=\"M9.58789565,9.966759 C8.61495652,10.3273684 7.69586087,10.8854848 6.91575652,11.6793352 C6.67158261,11.9278116 6.67158261,12.3317452 6.91575652,12.5802216 C7.03846957,12.705097 7.19874783,12.7662604 7.35902609,12.7662604 C7.51930435,12.7662604 7.67958261,12.7038227 7.80229565,12.5802216 C10.1789217,10.1642659 14.046887,10.1642659 16.4247652,12.5802216 C16.5474783,12.705097 16.7077565,12.7662604 16.8680348,12.7662604 C17.028313,12.7662604 17.1885913,12.7038227 17.3113043,12.5802216 C17.5554783,12.3317452 17.5554783,11.9278116 17.3113043,11.6793352 C15.2239304,9.55645429 12.1924174,8.99961219 9.58789565,9.966759 L9.58789565,9.966759 Z\" id=\"Shape\" fill=\"#2E3C43\"></path>\\n              <path d=\"M12.1122783,14.1359557 C10.5307826,14.1359557 9.2448,15.4445983 9.2448,17.052687 C9.2448,18.6620499 10.5307826,19.9706925 12.1122783,19.9706925 C13.6925217,19.9706925 14.9785043,18.6620499 14.9785043,17.052687 C14.9785043,15.4458726 13.6925217,14.1359557 12.1122783,14.1359557 L12.1122783,14.1359557 Z M12.1122783,18.6977285 C11.2219826,18.6977285 10.4969739,17.9599446 10.4969739,17.0539612 C10.4969739,16.1479778 11.2219826,15.4114681 12.1122783,15.4114681 C13.0025739,15.4114681 13.7263304,16.1479778 13.7263304,17.0539612 C13.7263304,17.9599446 13.0025739,18.6977285 12.1122783,18.6977285 L12.1122783,18.6977285 Z\" id=\"Shape\" fill=\"#2E3C43\"></path>\\n          </g>\\n      </svg>\\n    </div>\\n    <div>\\n      <h2 class=\"CDB-Text CDB-Size-huge is-light u-bSpace--m\">\\n        '+\n((__t=( _t('dataset.sync.title') ))==null?'':_.escape(__t))+\n'\\n     </h2>\\n      <p class=\"CDB-Text CDB-Size-medium u-altTextColor\">\\n        '+\n((__t=( _t('dataset.sync.desc', {\n          service: service,\n          url: url\n        }) ))==null?'':__t)+\n'\\n      </p>\\n      <div class=\"Modal-listTextItem u-flex u-alignCenter\">\\n        <h3 class=\"CDB-Text CDB-Size-small is-semibold u-upperCase\">'+\n((__t=( _t('dataset.sync.label') ))==null?'':_.escape(__t))+\n'</h3>\\n        <ul class=\"Modal-listForm u-flex u-alignCenter CDB-Text CDB-Size-small js-intervals\">\\n          <li class=\"Modal-listFormItem\">\\n            <input class=\"CDB-Radio\" type=\"radio\" name=\"interval\" value=\"3600\"\\n              ';\n if (interval === 3600) { \n__p+='\\n                checked\\n              ';\n } \n__p+='\\n\\n              ';\n if (isExternalSource) { \n__p+='\\n                disabled\\n              ';\n } \n__p+='\\n            >\\n            <span class=\"u-iBlock CDB-Radio-face\"></span>\\n            <label class=\"u-iBlock u-lSpace u-upperCase\">Every hour</label>\\n          </li>\\n          <li class=\"Modal-listFormItem\">\\n            <input class=\"CDB-Radio\" type=\"radio\" name=\"interval\" value=\"86400\"\\n              ';\n if (interval === 86400) { \n__p+='\\n                checked\\n              ';\n } \n__p+='\\n\\n              ';\n if (isExternalSource) { \n__p+='\\n                disabled\\n              ';\n } \n__p+='\\n            >\\n            <span class=\"u-iBlock CDB-Radio-face\"></span>\\n            <label class=\"u-iBlock u-lSpace u-upperCase\">Every day</label>\\n          </li>\\n          <li class=\"Modal-listFormItem\">\\n            <input class=\"CDB-Radio\" type=\"radio\" name=\"interval\" value=\"604800\"\\n              ';\n if (interval === 604800) { \n__p+='\\n                checked\\n              ';\n } \n__p+='\\n\\n              ';\n if (isExternalSource) { \n__p+='\\n                disabled\\n              ';\n } \n__p+='\\n            >\\n            <span class=\"u-iBlock CDB-Radio-face\"></span>\\n            <label class=\"u-iBlock u-lSpace u-upperCase\">Every week</label>\\n          </li>\\n          <li class=\"Modal-listFormItem\">\\n            <input class=\"CDB-Radio\" type=\"radio\" name=\"interval\" value=\"2592000\"\\n              ';\n if (interval === 2592000) { \n__p+='\\n                checked\\n              ';\n } \n__p+='\\n            >\\n            <span class=\"u-iBlock CDB-Radio-face\"></span>\\n            <label class=\"u-iBlock u-lSpace u-upperCase\">Every month</label>\\n          </li>\\n          <li class=\"Modal-listFormItem\">\\n            <input class=\"CDB-Radio\" type=\"radio\" name=\"interval\" value=\"0\"\\n              ';\n if (interval === 0) { \n__p+='\\n                checked\\n              ';\n } \n__p+='\\n            >\\n            <span class=\"u-iBlock CDB-Radio-face\"></span>\\n            <label class=\"u-iBlock u-lSpace u-upperCase\">Never</label>\\n          </li>\\n        </ul>\\n      </div>\\n      <ul class=\"Modal-listActions u-flex u-alignCenter\">\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--secondary CDB-Button--big js-cancel\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">\\n              '+\n((__t=( _t('dataset.sync.cancel') ))==null?'':_.escape(__t))+\n'\\n            </span>\\n          </button>\\n        </li>\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-confirm\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">\\n              '+\n((__t=( _t('dataset.sync.confirm') ))==null?'':_.escape(__t))+\n'\\n            </span>\\n          </button>\\n        </li>\\n      </ul>\\n    </div>\\n  </div>\\n</div>\\n\\n\\n';\n}\nreturn __p;\n};\n",
    "module.exports = ' | CARTO';\n",
    "var CoreView = require('backbone/core-view');\nvar MosaicView = require('./mosaic/mosaic-view');\n\n/**\n *  Mosaic form view\n */\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    if (!opts.collection) throw new Error('Mosaic collection is required');\n    if (!opts.template) throw new Error('template is required');\n\n    this.template = opts.template;\n    this._disabled = opts.disabled;\n\n    this._initBinds();\n  },\n\n  render: function () {\n    var selectedItem = this.collection.getSelected();\n    var selectedName = selectedItem && selectedItem.getName();\n    this.$el.html(\n      this.template({\n        name: selectedName\n      })\n    );\n    this._initViews();\n    return this;\n  },\n\n  _initBinds: function () {\n    this.collection.bind('change:highlighted', this._onChangeHighlighted, this);\n  },\n\n  _initViews: function () {\n    var mosaic = new MosaicView({\n      collection: this.collection,\n      disabled: this._disabled\n    });\n\n    if (!this.$('.js-selector').length) throw new Error('HTML element with js-selector class is required');\n\n    this.$('.js-selector').append(mosaic.render().el);\n    this.addView(mosaic);\n  },\n\n  _onChangeHighlighted: function () {\n    var item = this.collection.getHighlighted() || this.collection.getSelected();\n    if (item) {\n      var $el = this.$('.js-highlight');\n      if ($el) {\n        $el.text(item.getName());\n      }\n    }\n  }\n\n});\n",
    "var Backbone = require('backbone');\nvar MosaicModel = require('./mosaic-item-model');\n\n/*\n *  List collection, it parses pairs like:\n *\n *  [{ val, label }]\n *  [\"string\"]\n */\n\nmodule.exports = Backbone.Collection.extend({\n\n  model: function (attrs, opts) {\n    var d = {};\n    if (typeof attrs === 'string') {\n      d.val = attrs;\n    } else {\n      d = attrs;\n    }\n    return new MosaicModel(d);\n  },\n\n  initialize: function () {\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this.bind('change:selected', this._onSelectedChange, this);\n  },\n\n  _onSelectedChange: function (changedModel, isSelected) {\n    if (isSelected) {\n      this.each(function (m) {\n        if (m.cid !== changedModel.cid && m.get('selected')) {\n          m.set('selected', false);\n        }\n      });\n    }\n  },\n\n  getSelected: function () {\n    return this.findWhere({ selected: true });\n  },\n\n  getHighlighted: function () {\n    return this.findWhere({ highlighted: true });\n  }\n\n});\n",
    "var Backbone = require('backbone');\n\n/*\n *  List item model\n *\n */\n\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    disabled: false,\n    selected: false,\n    label: '',\n    template: function () {\n      return '';\n    }\n  },\n\n  getName: function () {\n    return this.get('label') || this.getValue();\n  },\n\n  getValue: function () {\n    return this.get('val');\n  }\n\n});\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./mosaic-item.tpl');\n\nmodule.exports = CoreView.extend({\n\n  className: 'Mosaic-item',\n\n  tagName: 'li',\n\n  events: {\n    'mouseenter': '_onMouseEnter',\n    'mouseleave': '_onMouseLeave',\n    'click': '_onClick'\n  },\n\n  initialize: function (opts) {\n    this._disabled = opts.disabled;\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.$el.html(\n      template({\n        name: this.model.getName(),\n        template: this.model.get('template')()\n      })\n    );\n    this.$el.addClass('js-' + this.model.getValue());\n    this.$el.toggleClass('is-selected', !!this.model.get('selected'));\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:selected', this.render, this);\n  },\n\n  _onMouseEnter: function () {\n    this.model.set('highlighted', true);\n  },\n\n  _onMouseLeave: function () {\n    this.model.set('highlighted', false);\n  },\n\n  _onClick: function () {\n    if (this._disabled) {\n      return false;\n    }\n\n    this.model.set('selected', true);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<button class=\"Mosaic-inner\">\\n  '+\n((__t=( template ))==null?'':__t)+\n'\\n</button>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<img src=\"'+\n((__t=( imgURL ))==null?'':__t)+\n'\" class=\"Mosaic-image js-thumbnailImg\" />\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./mosaic.tpl');\nvar MosaicCollection = require('./mosaic-collection');\nvar MosaicItemView = require('./mosaic-item-view');\n\n/*\n *  A mosaic selector\n *\n *  It accepts a collection of (val, label) model attributes or a values array\n *  with the same content or only strings.\n *\n *  new Mosaic({\n *    options: [\n *      {\n *        val: 'hello',\n *        label: 'hi'\n *      }\n *    ]\n *  });\n */\n\nmodule.exports = CoreView.extend({\n\n  className: 'Mosaic',\n\n  tagName: 'div',\n\n  initialize: function (opts) {\n    if (!opts.collection) {\n      if (!opts.options) throw new Error('options array {value, label} is required');\n\n      this.collection = new MosaicCollection(opts.options);\n    }\n\n    this._disabled = opts.disabled;\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template());\n    this._renderList();\n    return this;\n  },\n\n  _renderList: function () {\n    this.collection.each(function (mdl) {\n      this._createItem(mdl);\n    }, this);\n  },\n\n  _createItem: function (mdl) {\n    var view = new MosaicItemView({\n      model: mdl,\n      disabled: this._disabled\n    });\n    this.$('.js-mosaic').append(view.render().el);\n    this.addView(view);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<ul class=\"Mosaic-list js-mosaic\"></ul>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"IntermediateInfo\">\\n  <div class=\"LayoutIcon\">\\n    <i class=\"CDB-IconFont '+\n((__t=( icon ))==null?'':_.escape(__t))+\n'\"></i>\\n  </div>\\n  <h4 class=\"CDB-Text CDB-Size-large u-mainTextColor u-secondaryTextColor u-bSpace--m u-tSpace-xl\">'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</h4>\\n  <p class=\"CDB-Text CDB-Size-medium u-altTextColor\">\\n    '+\n((__t=( desc ))==null?'':_.escape(__t))+\n'\\n  </p>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var template = require('./no-results.tpl');\n\n/**\n * @param {Object} opts\n * @param {String=} opts.icon\n * @param {String=} opts.title\n * @param {String=} opts.desc\n */\n\nmodule.exports = function (opts) {\n  return template({\n    icon: opts.icon || 'CDB-IconFont-cockroach',\n    title: opts.title || '',\n    desc: opts.desc\n  });\n};\n",
    "var CoreView = require('backbone/core-view');\n\nmodule.exports = CoreView.extend({\n  tagName: 'button',\n\n  initialize: function (opts) {\n    if (!opts.template) throw new Error('template is required');\n    if (!opts.editorModel) throw new Error('editorModel is required');\n    this.template = opts.template;\n    this._editorModel = opts.editorModel;\n    this._data = {};\n    if (opts.model) {\n      this._data = opts.model.toJSON();\n    }\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this.listenTo(this._editorModel, 'change:edition', this._changeStyle);\n    this.add_related_model(this._editorModel);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this.$el.append(this.template(this._data));\n    return this;\n  },\n\n  _changeStyle: function () {\n    this.$('.js-theme').toggleClass('is-white', this._editorModel.isEditing());\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<span data-action=\"'+\n((__t=( button ))==null?'':_.escape(__t))+\n'\" class=\"CDB-Text is-semibold u-lSpace u-actionTextColor u-upperCase\">'+\n((__t=( button ))==null?'':_.escape(__t))+\n'</span>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CDB-Shape-close is-blue is-large js-theme\"></div>';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar NotifierModel = require('./notifier-model');\n\nmodule.exports = Backbone.Collection.extend({\n  model: function (attrs, opts) {\n    return new NotifierModel(attrs, opts);\n  },\n\n  findById: function (id) {\n    return this.findWhere({id: id});\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar Template = require('./notifier-item.tpl');\nvar ActionView = require('./notifier-action-view');\nvar closeTemplate = require('./notifier-close.tpl');\nvar actionTemplate = require('./notifier-action.tpl');\n\nmodule.exports = CoreView.extend({\n  className: 'Notifier-inner',\n  tagName: 'li',\n  events: {\n    'click .js-close': '_closeHandler',\n    'click .js-action': '_actionHandler'\n  },\n\n  initialize: function (opts) {\n    if (!opts.notifierModel) throw new Error('notifierModel is required');\n    if (!opts.editorModel) throw new Error('editorModel is required');\n\n    this._editorModel = opts.editorModel;\n    this.template = this.options.template || Template;\n    this._notifierModel = opts.notifierModel;\n    this.$el.attr('id', this._notifierModel.get('id'));\n\n    this._delay = this._notifierModel.get('delay') || this._notifierModel.get('defaultDelay');\n\n    if (this._notifierModel.get('delay') && this._notifierModel.get('closable') !== false) {\n      this._timeout = setTimeout(this._autoClose.bind(this), this._delay);\n    }\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this._initViews();\n    this._changeStyle();\n    return this;\n  },\n\n  _initBinds: function () {\n    this.listenTo(this._notifierModel, 'change', this.render);\n    this.listenTo(this._notifierModel, 'change:status', this._onChangeStatus);\n    this.add_related_model(this._notifierModel);\n\n    this.listenTo(this._editorModel, 'change:edition', this._changeStyle);\n    this.add_related_model(this._editorModel);\n  },\n\n  _initViews: function () {\n    var actionable = this._notifierModel.getButton();\n    var closable = this._notifierModel.isClosable();\n    var view = this.template({\n      status: this._notifierModel.getStatus(),\n      info: this._notifierModel.getInfo(),\n      isActionable: actionable,\n      isClosable: closable\n    });\n\n    this.$el.append(view);\n\n    if (actionable) {\n      this._createActionView(actionable);\n    }\n\n    if (closable) {\n      this._createCloseView();\n    }\n  },\n\n  _createActionView: function (action) {\n    var actionView = new ActionView({\n      template: actionTemplate,\n      className: 'js-action',\n      model: this._notifierModel,\n      editorModel: this._editorModel\n    });\n\n    this.$('.js-actionButton').append(actionView.render().el);\n    this.addView(actionView);\n  },\n\n  _createCloseView: function () {\n    var actionView = new ActionView({\n      template: closeTemplate,\n      className: 'CDB-Shape js-close',\n      editorModel: this._editorModel\n    });\n\n    this.$('.js-closeButton').append(actionView.render().el);\n    this.addView(actionView);\n  },\n\n  _closeHandler: function () {\n    var status = this._notifierModel.getStatus();\n    var action = this._notifierModel.getAction();\n    this._notifierModel.trigger('notification:close', action || status);\n    clearTimeout(this._timeout);\n    if (this._notifierModel && this._notifierModel.collection) {\n      this._notifierModel.collection.remove(this._notifierModel);\n    }\n  },\n\n  _actionHandler: function () {\n    var status = this._notifierModel.getStatus();\n    var action = this._notifierModel.getAction();\n    this._notifierModel.trigger('notification:action', action || status);\n  },\n\n  _changeStyle: function () {\n    this.$('.Notifier-info').toggleClass('u-whiteTextColor', this._editorModel.isEditing());\n    this.$('.Notifier-actions .CDB-Shape-close').toggleClass('is-blue', !this._editorModel.isEditing());\n    this.$('.Notifier-actions .CDB-Shape-close').toggleClass('is-white', this._editorModel.isEditing());\n  },\n\n  _autoClose: function () {\n    this._notifierModel.set({action: 'autoclose'}, {silent: true});\n    this._closeHandler();\n  },\n\n  _onChangeStatus: function (model, status) {\n    if ((status === 'success' || status === 'error') && this._notifierModel.get('closable') !== false && this._notifierModel.get('autoclosable') !== false) {\n      this._timeout = setTimeout(this._autoClose.bind(this), this._delay);\n    }\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Notifier-item Notifier-item--'+\n((__t=( status ))==null?'':_.escape(__t))+\n'\">\\n\\n  ';\n if (status === 'loading') { \n__p+='\\n  <div class=\"Notifier-icon CDB-LoaderIcon is-blue js-theme u-rSpace--m\">\\n    <svg class=\"CDB-LoaderIcon-spinner\" viewBox=\"0 0 50 50\">\\n      <circle class=\"CDB-LoaderIcon-path\" cx=\"25\" cy=\"25\" r=\"20\" fill=\"none\"></circle>\\n    </svg>\\n  </div>\\n  ';\n } \n__p+='\\n\\n  ';\n if (status === 'success') { \n__p+='\\n  <div class=\"Notifier-icon CDB-Shape u-rSpace--m\">\\n    <div class=\"CDB-Shape-CircleItem CDB-Shape-CircleItem--fill is-green\">\\n      <div class=\"CDB-Shape-tick is-medium is-white\"></div>\\n    </div>\\n  </div>\\n  ';\n } \n__p+='\\n\\n  ';\n if (status === 'error' || status === 'warning') { \n__p+='\\n  <div class=\"Notifier-icon CDB-Shape u-rSpace--m\">\\n    <div class=\"CDB-Shape-CircleItem CDB-Shape-CircleItem--fill is-red\">\\n      <div class=\"CDB-Shape-close is-medium is-white\"></div>\\n    </div>\\n  </div>\\n  ';\n } \n__p+='\\n\\n  <div class=\"Notifier-info\">\\n    <p class=\"CDB-Text CDB-Size-medium\">'+\n((__t=( info ))==null?'':__t)+\n' ';\n if (isActionable) { \n__p+=' <span class=\"js-actionButton\"></span> ';\n } \n__p+='</p>\\n  </div>\\n\\n  ';\n if (isClosable) { \n__p+='\\n    <div class=\"Notifier-actions js-closeButton\"></div>\\n  ';\n } \n__p+='\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\n\nmodule.exports = Backbone.Model.extend({\n  defaults: {\n    status: 'idle',\n    info: '',\n    closable: true\n  },\n\n  initialize: function (attrs, opts) {\n    if (attrs.id === undefined) {\n      this.set('id', 'notifier' + this.cid);\n    }\n\n    this.set('defaultDelay', opts.delay);\n\n    if (opts.visDefinitionModel) {\n      this._retriggerEvent(opts.visDefinitionModel, 'vis:reload');\n      this._retriggerEvent(opts.visDefinitionModel, 'vis:error');\n    }\n  },\n\n  isClosable: function () {\n    return this.get('closable') === true;\n  },\n\n  updateClosable: function (val) {\n    this.set({closable: val});\n  },\n\n  getButton: function () {\n    return this.get('button');\n  },\n\n  updateButton: function (val) {\n    this.set({button: val});\n  },\n\n  getStatus: function () {\n    return this.get('status');\n  },\n\n  updateStatus: function (val) {\n    this.set({status: val});\n  },\n\n  getInfo: function () {\n    return this.get('info');\n  },\n\n  getAction: function () {\n    return this.get('action');\n  },\n\n  setAction: function (val) {\n    this.set({action: val});\n  },\n\n  updateInfo: function (val) {\n    this.set({info: val});\n  },\n\n  update: function (state) {\n    this.set(state);\n  },\n\n  _retriggerEvent: function (model, event) {\n    model.on(event, function () {\n      this.trigger(event, arguments);\n    }, this);\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar NotifierItemView = require('./notifier-item-view');\nvar template = require('./notifier.tpl');\n\nmodule.exports = CoreView.extend({\n  className: 'Notifier',\n\n  initialize: function (opts) {\n    if (!opts.collection) throw new Error('collection is mandatory');\n    if (!opts.editorModel) throw new Error('editorModel is mandatory');\n\n    this._editorModel = opts.editorModel;\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template());\n    this._renderAllSubviews();\n    this._renderLoading();\n    return this;\n  },\n\n  rebindEvents: function () {\n    // Just in case\n    this.stopListening(this.collection);\n    this.stopListening(this._editorModel);\n    this._initBinds();\n    return this;\n  },\n\n  _initBinds: function () {\n    this.listenTo(this.collection, 'reset update change:status', this.render);\n    this.add_related_model(this.collection);\n\n    this.listenTo(this._editorModel, 'change:edition', this._changeStyle);\n    this.add_related_model(this._editorModel);\n  },\n\n  _renderAllSubviews: function () {\n    this.collection.each(this._renderSubview, this);\n  },\n\n  _renderSubview: function (model) {\n    var view = new NotifierItemView({\n      notifierModel: model,\n      editorModel: this._editorModel\n    });\n\n    var status = model.get('status');\n    var container = (status === 'success' || status === 'error')\n                    ? this._getDoneContainer()\n                    : this._getLoadingContainer();\n    container.append(view.render().el);\n    this.addView(view);\n  },\n\n  _removeSubview: function (model) {\n    var id = model.get('id');\n    var view = _.first(_.filter(this._subviews, function (subview) {\n      return subview._notifierModel.get('id') === id;\n    }));\n\n    if (view) {\n      this.removeView(view);\n      view.remove();\n    }\n  },\n\n  _renderLoading: function () {\n    this._getLoader().toggleClass('is-visible', this._anyNotificationLoading());\n  },\n\n  _anyNotificationLoading: function () {\n    return this.collection.any(function (model) {\n      return !_.contains(['success', 'error', 'warning'], model.get('status'));\n    });\n  },\n\n  _changeStyle: function () {\n    this.$el.toggleClass('is-dark', this._editorModel.isEditing());\n  },\n\n  _getDoneContainer: function () {\n    return this.$('.js-status-done');\n  },\n\n  _getLoadingContainer: function () {\n    return this.$('.js-status-loading');\n  },\n\n  _getLoader: function () {\n    return this.$('.js-loader');\n  }\n});\n",
    "var NotifierView = require('./notifier-view');\nvar NotifierCollection = require('./notifier-collection');\n\nvar manager = (function () {\n  var initialized = false;\n  var notifierView;\n  var collection = new NotifierCollection();\n  var editorModel;\n\n  function init (opts) {\n    if (!editorModel && !opts) {\n      throw new Error('editorModel is required');\n    }\n\n    if (!editorModel && opts && opts.editorModel) {\n      editorModel = opts.editorModel;\n    }\n\n    initialized = true;\n    notifierView = new NotifierView({\n      collection: collection,\n      editorModel: editorModel\n    });\n  }\n\n  return {\n    DEFAULT_DELAY: 5000,\n    init: function (opts) {\n      if (opts.visDefinitionModel) {\n        this._visDefinitionModel = opts.visDefinitionModel;\n      }\n      init(opts);\n    },\n\n    getView: function () {\n      if (!initialized) init();\n      return notifierView.rebindEvents();\n    },\n\n    getCollection: function () {\n      return collection;\n    },\n\n    getNotification: function (model) {\n      var notification;\n      if (typeof model === 'string') {\n        notification = collection.findById(model);\n      } else {\n        notification = collection.findById(model.id);\n      }\n      return notification;\n    },\n\n    addNotification: function (attrs) {\n      return collection.add(attrs, {\n        visDefinitionModel: this._visDefinitionModel,\n        delay: this.DEFAULT_DELAY\n      });\n    },\n\n    removeNotification: function (model) {\n      var notification;\n      if (typeof model === 'string') {\n        notification = collection.findById(model);\n      } else {\n        notification = collection.findById(model.id);\n      }\n      return collection.remove(notification);\n    }\n  };\n})();\n\nmodule.exports = manager;\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CDB-Loader js-loader\"></div>\\n<ul class=\"Notifier-list js-status-loading\"></ul>\\n<ul class=\"Notifier-list js-status-done\"></ul>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text Onboarding-headerDescription\">\\n  '+\n((__t=( _t('analyses-onboarding.new-column-included') ))==null?'':_.escape(__t))+\n'\\n</p>\\n\\n<ul class=\"Onboarding-list\">\\n  ';\n if (aggregate_function === 'count') { \n__p+='\\n  <li class=\"Onboarding-listItem\">\\n    <div class=\"Onboarding-listItemValue\">count_vals</div>\\n  </li>\\n  <li class=\"Onboarding-listItem\">\\n    <div class=\"Onboarding-listItemValue\">count_vals_density</div>\\n  </li>\\n  ';\n } else {\n__p+='\\n  <li class=\"Onboarding-listItem\">\\n    <div class=\"Onboarding-listItemValue\">'+\n((__t=( aggregate_function ))==null?'':_.escape(__t))+\n'_'+\n((__t=( aggregate_column ))==null?'':_.escape(__t))+\n'</div>\\n  </li>\\n  ';\n } \n__p+='\\n</ul>\\n\\n<p class=\"CDB-Text Onboarding-description\">\\n  '+\n((__t=( _t('analyses-onboarding.aggregate-intersection.description') ))==null?'':_.escape(__t))+\n'\\n</p>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text Onboarding-headerDescription\">\\n  '+\n((__t=( _t('analyses-onboarding.geometries-updated') ))==null?'':_.escape(__t))+\n'\\n</p>\\n\\n<ul class=\"Onboarding-list\">\\n  <li class=\"Onboarding-listItem\">\\n    <div class=\"Onboarding-listItemValue\">the_geom</div>\\n    <p class=\"CDB-Text Onboarding-description\">'+\n((__t=( _t('analyses-onboarding.area-of-influence.the-geom') ))==null?'':_.escape(__t))+\n'</p>\\n  </li>\\n</ul>\\n\\n<p class=\"CDB-Text Onboarding-description\">\\n  '+\n((__t=( _t('analyses-onboarding.area-of-influence.description') ))==null?'':_.escape(__t))+\n'\\n</p>\\n\\n<p class=\"CDB-Text Onboarding-description\">\\n  <a href=\"https://carto.com/learn/guides/analysis/areas-of-influence\" class=\"Onboarding-readMore\" target=\"_blank\">'+\n((__t=( _t('analyses-onboarding.learn-more') ))==null?'':_.escape(__t))+\n'</a>\\n</p>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text Onboarding-headerDescription\">\\n  '+\n((__t=( _t('analyses-onboarding.new-columns-created') ))==null?'':_.escape(__t))+\n'\\n</p>\\n\\n<ul class=\"Onboarding-list\">\\n  <li class=\"Onboarding-listItem\">\\n    <div class=\"Onboarding-listItemValue\">the_geom</div>\\n    <p class=\"CDB-Text Onboarding-description\">'+\n((__t=( _t('analyses-onboarding.centroid.the-geom') ))==null?'':_.escape(__t))+\n'</p>\\n  </li>\\n  <li class=\"Onboarding-listItem\">\\n    <div class=\"Onboarding-listItemValue\">value</div>\\n    <p class=\"CDB-Text Onboarding-description\">\\n      ';\n if (aggregation) { \n__p+='\\n      '+\n((__t=( _t('analyses-onboarding.centroid.aggregated-value') ))==null?'':_.escape(__t))+\n'\\n      ';\n } else { \n__p+='\\n      '+\n((__t=( _t('analyses-onboarding.centroid.non-aggregated-value') ))==null?'':_.escape(__t))+\n'\\n      ';\n } \n__p+='\\n    </p>\\n  </li>\\n  ';\n if (category_column) { \n__p+='\\n  <li class=\"Onboarding-listItem\">\\n    <div class=\"Onboarding-listItemValue\">category</div>\\n    <p class=\"CDB-Text Onboarding-description\">'+\n((__t=( _t('analyses-onboarding.centroid.category') ))==null?'':_.escape(__t))+\n'</p>\\n  </li>\\n  ';\n } \n__p+='\\n</ul>\\n\\n<p class=\"CDB-Text Onboarding-description\">\\n  '+\n((__t=( _t('analyses-onboarding.centroid.description') ))==null?'':_.escape(__t))+\n'\\n</p>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text Onboarding-headerDescription\">\\n  '+\n((__t=( _t('analyses-onboarding.new-columns-created') ))==null?'':_.escape(__t))+\n'\\n</p>\\n\\n<ul class=\"Onboarding-list\">\\n  <li class=\"Onboarding-listItem\">\\n    <div class=\"Onboarding-listItemValue\">the_geom</div>\\n    <p class=\"CDB-Text Onboarding-description\">'+\n((__t=( _t('analyses-onboarding.closest.the-geom') ))==null?'':_.escape(__t))+\n'</p>\\n  </li>\\n  <li class=\"Onboarding-listItem\">\\n    <div class=\"Onboarding-listItemValue\">source_cdb_id</div>\\n    <p class=\"CDB-Text Onboarding-description\">'+\n((__t=( _t('analyses-onboarding.closest.source_cdb_id') ))==null?'':_.escape(__t))+\n'</p>\\n  </li>\\n</ul>\\n\\n<p class=\"CDB-Text Onboarding-description\">\\n  '+\n((__t=( _t('analyses-onboarding.closest.description') ))==null?'':_.escape(__t))+\n'\\n</p>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text Onboarding-headerDescription\">\\n  '+\n((__t=( _t('analyses-onboarding.geometries-updated') ))==null?'':_.escape(__t))+\n'\\n</p>\\n\\n<ul class=\"Onboarding-list\">\\n  <li class=\"Onboarding-listItem\">\\n    <div class=\"Onboarding-listItemValue\">the_geom</div>\\n    <p class=\"CDB-Text Onboarding-description\">'+\n((__t=( _t('analyses-onboarding.connect-with-lines.the-geom') ))==null?'':_.escape(__t))+\n'</p>\\n  </li>\\n</ul>\\n\\n<p class=\"CDB-Text Onboarding-description\">\\n  '+\n((__t=( _t('analyses-onboarding.connect-with-lines.' + type) ))==null?'':_.escape(__t))+\n'\\n</p>\\n\\n<p class=\"CDB-Text Onboarding-description\">\\n  <a href=\"https://carto.com/learn/guides/analysis/connect-with-lines\" class=\"Onboarding-readMore\" target=\"_blank\">'+\n((__t=( _t('analyses-onboarding.learn-more') ))==null?'':_.escape(__t))+\n'</a>\\n</p>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text Onboarding-headerDescription\">\\n  '+\n((__t=( _t('analyses-onboarding.new-column-included') ))==null?'':_.escape(__t))+\n'\\n</p>\\n\\n<ul class=\"Onboarding-list\">\\n  <li class=\"Onboarding-listItem\">\\n    <div class=\"Onboarding-listItemValue\">'+\n((__t=( final_column ))==null?'':_.escape(__t))+\n'</div>\\n    <p class=\"CDB-Text Onboarding-description\">'+\n((__t=( _t('analyses-onboarding.data-observatory-measure.custom-column') ))==null?'':_.escape(__t))+\n'</p>\\n  </li>\\n</ul>\\n\\n<p class=\"CDB-Text Onboarding-description\">\\n  '+\n((__t=( _t('analyses-onboarding.data-observatory-measure.description') ))==null?'':_.escape(__t))+\n'\\n</p>\\n\\n<p class=\"CDB-Text Onboarding-description\">\\n  <a href=\"https://carto.com/learn/guides/analysis/enrich-from-data-observatory\" class=\"Onboarding-readMore\" target=\"_blank\">'+\n((__t=( _t('analyses-onboarding.learn-more') ))==null?'':_.escape(__t))+\n'</a>\\n</p>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text Onboarding-description\">\\n  '+\n((__t=( _t('analyses-onboarding.filter-by-node-column.description') ))==null?'':_.escape(__t))+\n'\\n</p>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text Onboarding-headerDescription\">\\n  '+\n((__t=( _t('analyses-onboarding.new-columns-created') ))==null?'':_.escape(__t))+\n'\\n</p>\\n\\n<p class=\"CDB-Text Onboarding-description\">\\n  '+\n((__t=( _t('analyses-onboarding.filter.description') ))==null?'':_.escape(__t))+\n'\\n</p>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text Onboarding-headerDescription\">\\n  '+\n((__t=( _t('analyses-onboarding.geometries-updated') ))==null?'':_.escape(__t))+\n'\\n</p>\\n\\n<ul class=\"Onboarding-list\">\\n  <li class=\"Onboarding-listItem\">\\n    <div class=\"Onboarding-listItemValue\">the_geom</div>\\n    <p class=\"CDB-Text Onboarding-description\">'+\n((__t=( _t('analyses-onboarding.georeference.the-geom') ))==null?'':_.escape(__t))+\n'</p>\\n  </li>\\n</ul>\\n\\n<p class=\"CDB-Text Onboarding-description\">\\n  '+\n((__t=( _t('analyses-onboarding.georeference.description') ))==null?'':_.escape(__t))+\n'\\n</p>\\n\\n<p class=\"CDB-Text Onboarding-description\">\\n  <a href=\"https://carto.com/learn/guides/analysis/georeference\" class=\"Onboarding-readMore\" target=\"_blank\">'+\n((__t=( _t('analyses-onboarding.learn-more') ))==null?'':_.escape(__t))+\n'</a>\\n</p>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text Onboarding-headerDescription\">\\n  '+\n((__t=( _t('analyses-onboarding.geometries-updated') ))==null?'':_.escape(__t))+\n'\\n</p>\\n\\n<ul class=\"Onboarding-list\">\\n  <li class=\"Onboarding-listItem\">\\n    <div class=\"Onboarding-listItemValue\">the_geom</div>\\n    <p class=\"CDB-Text Onboarding-description\">'+\n((__t=( _t('analyses-onboarding.group-points.the-geom') ))==null?'':_.escape(__t))+\n'</p>\\n  </li>\\n  ';\n if (category_column) { \n__p+='\\n  <li class=\"Onboarding-listItem\">\\n    <div class=\"Onboarding-listItemValue\">'+\n((__t=( category_column ))==null?'':_.escape(__t))+\n'</div>\\n    <p class=\"CDB-Text Onboarding-description\">'+\n((__t=( _t('analyses-onboarding.group-points.category') ))==null?'':_.escape(__t))+\n'</p>\\n  </li>\\n  ';\n } \n__p+='\\n</ul>\\n\\n<p class=\"CDB-Text Onboarding-description\">\\n  '+\n((__t=( _t('analyses-onboarding.group-points.description', { method: _t('analyses.' + type + '.title') }) ))==null?'':_.escape(__t))+\n'\\n</p>\\n\\n<p class=\"CDB-Text Onboarding-description\">\\n  <a href=\"http://postgis.net/docs/manual-2.2/\" class=\"Onboarding-readMore\" target=\"_blank\">'+\n((__t=( _t('analyses-onboarding.read-more') ))==null?'':_.escape(__t))+\n'</a>\\n</p>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text Onboarding-headerDescription\">\\n  '+\n((__t=( _t('analyses-onboarding.new-column-included') ))==null?'':_.escape(__t))+\n'\\n</p>\\n\\n<ul class=\"Onboarding-list\">\\n  <li class=\"Onboarding-listItem\">\\n    <div class=\"Onboarding-listItemValue\">source_cartodb_id</div>\\n    <p class=\"CDB-Text Onboarding-description\">'+\n((__t=( _t('analyses-onboarding.intersection.source-cartodb-id') ))==null?'':_.escape(__t))+\n'</p>\\n  </li>\\n</ul>\\n\\n<p class=\"CDB-Text Onboarding-description\">\\n  '+\n((__t=( _t('analyses-onboarding.intersection.description') ))==null?'':_.escape(__t))+\n'\\n</p>\\n\\n<p class=\"CDB-Text Onboarding-description\">\\n  <a href=\"https://carto.com/learn/guides/analysis/intersect-second-layer\" class=\"Onboarding-readMore\" target=\"_blank\">'+\n((__t=( _t('analyses-onboarding.learn-more') ))==null?'':_.escape(__t))+\n'</a>\\n</p>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text Onboarding-headerDescription\">\\n  '+\n((__t=( _t('analyses-onboarding.new-column-added') ))==null?'':_.escape(__t))+\n'\\n</p>\\n\\n<ul class=\"Onboarding-list\">\\n  <li class=\"Onboarding-listItem\">\\n    <div class=\"Onboarding-listItemValue\">cluster_no</div>\\n    <p class=\"CDB-Text Onboarding-description\">'+\n((__t=( _t('analyses-onboarding.kmeans.cluster-no', { clusters: clusters }) ))==null?'':_.escape(__t))+\n'</p>\\n  </li>\\n</ul>\\n\\n<p class=\"CDB-Text Onboarding-description\">\\n  '+\n((__t=( _t('analyses-onboarding.kmeans.description') ))==null?'':_.escape(__t))+\n'\\n</p>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text Onboarding-headerDescription\">\\n  '+\n((__t=( _t('analyses-onboarding.new-columns-included-based-on-input') ))==null?'':_.escape(__t))+\n'\\n</p>\\n\\n<p class=\"CDB-Text Onboarding-description\">\\n  '+\n((__t=( _t('analyses-onboarding.merge.description') ))==null?'':_.escape(__t))+\n'\\n</p>\\n\\n<p class=\"CDB-Text Onboarding-description\">\\n  <a href=\"https://carto.com/learn/guides/analysis/join-column-from-second-layer\" class=\"Onboarding-readMore\" target=\"_blank\">'+\n((__t=( _t('analyses-onboarding.learn-more') ))==null?'':_.escape(__t))+\n'</a>\\n</p>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text Onboarding-headerDescription\">\\n  '+\n((__t=( _t('analyses-onboarding.new-columns-included') ))==null?'':_.escape(__t))+\n'\\n</p>\\n\\n<ul class=\"Onboarding-list\">\\n  <li class=\"Onboarding-listItem\">\\n    <div class=\"Onboarding-listItemValue\">quads</div>\\n    <p class=\"CDB-Text Onboarding-description\">'+\n((__t=( _t('analyses-onboarding.moran.quads') ))==null?'':_.escape(__t))+\n'</p>\\n  </li>\\n  <li class=\"Onboarding-listItem\">\\n    <div class=\"Onboarding-listItemValue\">significance</div>\\n    <p class=\"CDB-Text Onboarding-description\">'+\n((__t=( _t('analyses-onboarding.moran.significance') ))==null?'':_.escape(__t))+\n'</p>\\n  </li>\\n  <li class=\"Onboarding-listItem\">\\n    <div class=\"Onboarding-listItemValue\">moran</div>\\n    <p class=\"CDB-Text Onboarding-description\">'+\n((__t=( _t('analyses-onboarding.moran.moran') ))==null?'':_.escape(__t))+\n'</p>\\n  </li>\\n  <li class=\"Onboarding-listItem\">\\n    <div class=\"Onboarding-listItemValue\">rowid</div>\\n    <p class=\"CDB-Text Onboarding-description\">'+\n((__t=( _t('analyses-onboarding.moran.rowid') ))==null?'':_.escape(__t))+\n'</p>\\n  </li>\\n</ul>\\n\\n<p class=\"CDB-Text Onboarding-description\">\\n  '+\n((__t=( _t('analyses-onboarding.moran.description') ))==null?'':_.escape(__t))+\n'\\n</p>\\n\\n<p class=\"CDB-Text Onboarding-description\">\\n  <a href=\"https://carto.com/learn/guides/analysis/detect-outliers-and-clusters\" class=\"Onboarding-readMore\" target=\"_blank\">'+\n((__t=( _t('analyses-onboarding.learn-more') ))==null?'':_.escape(__t))+\n'</a>\\n</p>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text Onboarding-headerDescription\">\\n  '+\n((__t=( _t('analyses-onboarding.no-new-columns') ))==null?'':_.escape(__t))+\n'\\n</p>\\n\\n<p class=\"CDB-Text Onboarding-description\">\\n  '+\n((__t=( _t('analyses-onboarding.sampling.description', { percentage: Math.round(sampling * 100) }) ))==null?'':_.escape(__t))+\n'\\n</p>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text Onboarding-headerDescription\">\\n  '+\n((__t=( _t('analyses-onboarding.new-columns-included') ))==null?'':_.escape(__t))+\n'\\n</p>\\n\\n<ul class=\"Onboarding-list\">\\n  <li class=\"Onboarding-listItem\">\\n    <div class=\"Onboarding-listItemValue\">trend</div>\\n    <p class=\"CDB-Text Onboarding-description\">'+\n((__t=( _t('analyses-onboarding.spatial-markov-trend.trend') ))==null?'':_.escape(__t))+\n'</p>\\n  </li>\\n  <li class=\"Onboarding-listItem\">\\n    <div class=\"Onboarding-listItemValue\">trend_up</div>\\n    <p class=\"CDB-Text Onboarding-description\">'+\n((__t=( _t('analyses-onboarding.spatial-markov-trend.trend_up') ))==null?'':_.escape(__t))+\n'</p>\\n  </li>\\n  <li class=\"Onboarding-listItem\">\\n    <div class=\"Onboarding-listItemValue\">trend_down</div>\\n    <p class=\"CDB-Text Onboarding-description\">'+\n((__t=( _t('analyses-onboarding.spatial-markov-trend.trend_down') ))==null?'':_.escape(__t))+\n'</p>\\n  </li>\\n  <li class=\"Onboarding-listItem\">\\n    <div class=\"Onboarding-listItemValue\">volatility</div>\\n    <p class=\"CDB-Text Onboarding-description\">'+\n((__t=( _t('analyses-onboarding.spatial-markov-trend.volatility') ))==null?'':_.escape(__t))+\n'</p>\\n  </li>\\n</ul>\\n\\n<p class=\"CDB-Text Onboarding-description\">\\n  '+\n((__t=( _t('analyses-onboarding.spatial-markov-trend.description') ))==null?'':_.escape(__t))+\n'\\n</p>\\n\\n<p class=\"CDB-Text Onboarding-description\">\\n  <a href=\"https://carto.com/learn/guides/analysis/predict-trends-and-volatility\" class=\"Onboarding-readMore\" target=\"_blank\">'+\n((__t=( _t('analyses-onboarding.learn-more') ))==null?'':_.escape(__t))+\n'</a>\\n</p>\\n';\n}\nreturn __p;\n};\n",
    "var LocalStorage = require('../../../components/local-storage/local-storage');\nvar AnalysisOnboardingView = require('../../../components/onboardings/analysis/analysis-view');\nvar Analyses = require('../../../data/analyses');\nvar STORAGE_KEY = 'onboarding';\n\nvar launcher = (function () {\n  var onboardings;\n  var userModel;\n  var editorModel;\n\n  function init (opts) {\n    if (!onboardings && !opts) {\n      throw new Error('onboardings is required');\n    }\n\n    if (!userModel && !opts) {\n      throw new Error('userModel is required');\n    }\n\n    if (!onboardings && opts && opts.onboardings) {\n      onboardings = opts.onboardings;\n    }\n\n    if (!userModel && opts && opts.userModel) {\n      userModel = opts.userModel;\n    }\n\n    editorModel = onboardings.editorModel;\n  }\n\n  return {\n    init: function (opts) {\n      init(opts);\n\n      LocalStorage.init(STORAGE_KEY, {\n        userModel: userModel\n      });\n    },\n\n    launch: function (type, model) {\n      var genericType = Analyses.getAnalysisByType(type).genericType || type;\n\n      if (!LocalStorage.get(genericType) && genericType) {\n        onboardings.create(function (modalModel) {\n          return new AnalysisOnboardingView({\n            modalModel: modalModel,\n            userModel: userModel,\n            editorModel: editorModel,\n            model: model\n          });\n        });\n      }\n    }\n  };\n})();\n\nmodule.exports = launcher;\n",
    "var LocalStorage = require('../../../components/local-storage/local-storage');\nvar CoreView = require('backbone/core-view');\nvar template = require('./analysis-view.tpl');\nvar Analyses = require('../../../data/analyses');\n\nvar STORAGE_KEY = 'onboarding';\n\nmodule.exports = CoreView.extend({\n  className: 'AnalysisCompletionDetails is-opening',\n\n  events: {\n    'click .js-close': '_close',\n    'click .js-style': '_onStyle'\n  },\n\n  initialize: function (opts) {\n    if (!opts.modalModel) throw new Error('modalModel is required');\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.editorModel) throw new Error('editorModel is required');\n\n    this._modalModel = opts.modalModel;\n    this._userModel = opts.userModel;\n    this._editorModel = opts.editorModel;\n\n    LocalStorage.init(STORAGE_KEY, {\n      userModel: this._userModel\n    });\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.$el.html(template({\n      type: this._getGenericAnalysisType()\n    }));\n\n    var onboardingTemplate = this._typeDef().onboardingTemplate;\n    var html = onboardingTemplate && onboardingTemplate(this.model.attributes);\n    this.$('.js-content').html(html);\n\n    this._onChangeEditorModelEdition(this._editorModel);\n\n    return this;\n  },\n\n  _initBinds: function () {\n    this.listenTo(this.model, 'destroy', this._close);\n    this.listenTo(this._editorModel, 'change:edition', this._onChangeEditorModelEdition);\n    this.add_related_model(this._editorModel);\n  },\n\n  _onChangeEditorModelEdition: function (mdl) {\n    var isEditing = !!mdl.get('edition');\n    this.$el.toggleClass('is-editing', isEditing);\n  },\n\n  _close: function () {\n    this._checkForgetStatus();\n    this.trigger('close', this);\n  },\n\n  _onStyle: function () {\n    this._checkForgetStatus();\n    this.trigger('customEvent', 'style', this);\n  },\n\n  _checkForgetStatus: function () {\n    if (this.$('.js-forget:checked').val()) {\n      this._forget();\n    }\n  },\n\n  _forget: function () {\n    LocalStorage.set(this._getGenericAnalysisType(), true);\n  },\n\n  _typeDef: function (type) {\n    type = type || this.model.get('type');\n    return Analyses.getAnalysisByType(type);\n  },\n\n  _getGenericAnalysisType: function () {\n    var typeDef = this._typeDef();\n    return typeDef && typeDef.genericType || this.model.get('type');\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Onboarding-fake\"></div>\\n<div class=\"Onboarding-contentWrapper\">\\n  <div class=\"Onboarding-body\">\\n    <p class=\"CDB-Text Onboarding-headerTitle\">'+\n((__t=( _t('analyses-onboarding.' + type + '.title') ))==null?'':_.escape(__t))+\n'</p>\\n    <p class=\"CDB-Text Onboarding-headerText\">'+\n((__t=( _t('analyses-onboarding.finished') ))==null?'':_.escape(__t))+\n'</p>\\n\\n    <div class=\"js-content\"></div>\\n\\n    <div class=\"Onboarding-footer\">\\n      <div class=\"Onboarding-footerButtons\">\\n        <button class=\"CDB-Button CDB-Button--secondary CDB-Button--white CDB-Button--big Onboarding-footer--marginRight js-close\">\\n          <span class=\"CDB-Button-Text CDB-Text u-upperCase is-semibold CDB-Size-medium\">'+\n((__t=( _t('analyses-onboarding.done') ))==null?'':_.escape(__t))+\n'</span>\\n        </button>\\n\\n        <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-style\">\\n          <span class=\"CDB-Button-Text CDB-Text u-upperCase is-semibold CDB-Size-medium\">'+\n((__t=( _t('analyses-onboarding.style-analysis') ))==null?'':_.escape(__t))+\n'</span>\\n        </button>\\n      </div>\\n\\n      <div class=\"u-iBlock\">\\n        <input class=\"CDB-Checkbox js-forget\" type=\"checkbox\" id=\"forget-me\" name=\"forget-me\" value=\"true\">\\n        <span class=\"u-iBlock CDB-Checkbox-face\"></span>\\n        <label for=\"forget-me\" class=\"Onboarding-forgetLabel Checkbox-label CDB-Text CDB-Size-small u-altTextColor u-lSpace\">'+\n((__t=( _t('analyses-onboarding.never-show-message') ))==null?'':_.escape(__t))+\n'</label>\\n      </div>\\n    </div>\\n  </div>\\n</div>\\n\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar $ = require('jquery');\nvar template = require('./builder-activated-notification.tpl');\nvar DASHBOARD_NOTIFICATION_KEY = 'builder_activated';\n\nmodule.exports = CoreView.extend({\n  className: 'js-builderNotification',\n  events: {\n    'click .js-close': '_onClose'\n  },\n\n  initialize: function () {\n    if (!this.options.builderActivatedNotification) { throw new Error('builderActivatedNotification is required'); }\n    this._notification = this.options.builderActivatedNotification;\n\n    this.render();\n  },\n\n  render: function () {\n    this.$el.html(template());\n    $('body').prepend(this.$el);\n\n    return this;\n  },\n\n  _onClose: function () {\n    this._notification.setKey(DASHBOARD_NOTIFICATION_KEY, true);\n    this._notification.save();\n\n    this.clean();\n  },\n\n  clean: function () {\n    this.constructor.__super__.clean.apply(this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"onboardingNotification Color-MainDark CDB-Text CDB-Size-medium u-flex u-justifyCenter\">\\n  <p>'+\n((__t=( _t('builder-activated-notification.message') ))==null?'':__t)+\n'</p>\\n\\n  <button class=\"onboardingNotification-closeButton js-close\">\\n    <div class=\"CDB-Shape-close is-large is-white\"></div>\\n  </button>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var $ = require('jquery');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar template = require('./builder-view.tpl');\nvar checkAndBuildOpts = require('../../../helpers/required-opts');\n\nvar BUILDER_KEY = 'onboarding';\n\nvar LEFT_KEY_CODE = 37;\nvar RIGHT_KEY_CODE = 39;\n\nvar REQUIRED_OPTS = [\n  'userModel',\n  'onboardingNotification',\n  'editorModel'\n];\n\nmodule.exports = CoreView.extend({\n  className: 'BuilderOnboarding is-step0 is-opening',\n\n  events: {\n    'click .js-start': '_onClickNext',\n    'click .js-next': '_onClickNext',\n    'click .js-close': '_close'\n  },\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    this._initModels();\n    this._initBinds();\n  },\n\n  render: function () {\n    this.$el.html(template({\n      name: this._userModel.get('name') || this._userModel.get('username')\n    }));\n\n    return this;\n  },\n\n  _initModels: function () {\n    this.model = new Backbone.Model({\n      step: 0\n    });\n  },\n\n  _initBinds: function () {\n    this._keyDown = this._onKeyDown.bind(this);\n    $(document).on('keydown', this._keyDown);\n\n    this.listenTo(this.model, 'change:step', this._onChangeStep);\n    this.listenTo(this.model, 'destroy', this._close);\n    this.listenTo(this._editorModel, 'change:edition', this._changeEdition);\n  },\n\n  _changeEdition: function (mdl) {\n    var isEditing = !!mdl.get('edition');\n    this.$el.toggleClass('is-editing', isEditing);\n  },\n\n  _prev: function () {\n    if (this._currentStep() >= 1) {\n      this.model.set('step', this._currentStep() - 1);\n    }\n  },\n\n  _next: function () {\n    if (this._currentStep() <= 3) {\n      this.model.set('step', this._currentStep() + 1);\n    }\n  },\n\n  _currentStep: function () {\n    return this.model.get('step');\n  },\n\n  _onClickNext: function () {\n    this._next();\n  },\n\n  _onChangeStep: function () {\n    var self = this;\n\n    this.$el.removeClass('is-step' + this.model.previous('step'), function () {\n      self.$el.addClass('is-step' + self._currentStep());\n    });\n\n    this.$('.js-step').removeClass('is-step' + this.model.previous('step'), function () {\n      self.$('.js-step').addClass('is-step' + self._currentStep());\n    });\n  },\n\n  _close: function () {\n    this._checkForgetStatus();\n    this.trigger('close', this);\n  },\n\n  _onKeyDown: function (e) {\n    e.stopPropagation();\n\n    if (e.which === LEFT_KEY_CODE) {\n      this._prev();\n    } else if (e.which === RIGHT_KEY_CODE) {\n      this._next();\n    }\n  },\n\n  _checkForgetStatus: function () {\n    if (this.$('.js-forget:checked').val()) {\n      this._forget();\n    }\n  },\n\n  _forget: function () {\n    this._onboardingNotification.setKey(BUILDER_KEY, true);\n    this._onboardingNotification.save();\n  },\n\n  clean: function () {\n    $(document).off('keydown', this._keyDown);\n    CoreView.prototype.clean.apply(this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"BuilderOnboarding-pad\"></div>\\n<div class=\"BuilderOnboarding-pad2\"></div>\\n<div class=\"BuilderOnboarding-contentWrapper is-step0 js-step\">\\n  <div class=\"BuilderOnboarding-body\">\\n    <div class=\"BuilderOnboarding-header is-step0\">\\n      <p class=\"CDB-Text Onboarding-headerTitle\">'+\n((__t=( _t('builder-onboarding.title')))==null?'':_.escape(__t))+\n'</p>\\n      <p class=\"CDB-Text Onboarding-headerText\">'+\n((__t=( name ))==null?'':_.escape(__t))+\n'</p>\\n\\n      <p class=\"CDB-Text BuilderOnboarding-description\">\\n        '+\n((__t=( _t('builder-onboarding.description')))==null?'':_.escape(__t))+\n'\\n      </p>\\n    </div>\\n\\n    <div class=\"BuilderOnboarding-footer is-step0\">\\n      <div class=\"BuilderOnboarding-footerButtons\">\\n        <button class=\"CDB-Button CDB-Button--secondary CDB-Button--white CDB-Button--big Onboarding-footer--marginRight js-start\">\\n          <span class=\"CDB-Button-Text CDB-Text u-upperCase is-semibold CDB-Size-medium\">'+\n((__t=( _t('builder-onboarding.take-tour')))==null?'':_.escape(__t))+\n'</span>\\n        </button>\\n\\n        <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-close\">\\n          <span class=\"CDB-Button-Text CDB-Text u-upperCase is-semibold CDB-Size-medium\">'+\n((__t=( _t('builder-onboarding.edit-map')))==null?'':_.escape(__t))+\n'</span>\\n        </button>\\n      </div>\\n\\n      <div class=\"u-iBlock is-step1\">\\n        <input class=\"CDB-Checkbox js-forget\" type=\"checkbox\" id=\"forget-me\" name=\"forget-me\" value=\"true\">\\n        <span class=\"u-iBlock CDB-Checkbox-face\"></span>\\n        <label for=\"forget-me\" class=\"BuilderOnboarding-forgetLabel Checkbox-label CDB-Text CDB-Size-small u-altTextColor u-lSpace\">'+\n((__t=( _t('analyses-onboarding.never-show-message') ))==null?'':_.escape(__t))+\n'</label>\\n      </div>\\n    </div>\\n\\n    <div class=\"BuilderOnboarding-step is-step1\">\\n      <p class=\"CDB-Text Onboarding-headerTitle\">1/4</p>\\n      <p class=\"CDB-Text Onboarding-headerText\">'+\n((__t=( _t('builder-onboarding.toolbar.title')))==null?'':_.escape(__t))+\n'</p>\\n      <p class=\"CDB-Text BuilderOnboarding-description\">\\n        '+\n((__t=( _t('builder-onboarding.toolbar.description')))==null?'':_.escape(__t))+\n'\\n      </p>\\n    </div>\\n\\n    <div class=\"BuilderOnboarding-step is-step2\">\\n      <p class=\"CDB-Text Onboarding-headerTitle\">2/4</p>\\n      <p class=\"CDB-Text Onboarding-headerText\">'+\n((__t=( _t('builder-onboarding.configurator.title')))==null?'':_.escape(__t))+\n'</p>\\n      <p class=\"CDB-Text BuilderOnboarding-description\">\\n        '+\n((__t=( _t('builder-onboarding.configurator.description')))==null?'':_.escape(__t))+\n'\\n      </p>\\n    </div>\\n\\n    <div class=\"BuilderOnboarding-step is-step3\">\\n      <p class=\"CDB-Text Onboarding-headerTitle\">3/4</p>\\n      <p class=\"CDB-Text Onboarding-headerText\">'+\n((__t=( _t('builder-onboarding.map.title')))==null?'':_.escape(__t))+\n'</p>\\n      <p class=\"CDB-Text BuilderOnboarding-description\">\\n        '+\n((__t=( _t('builder-onboarding.map.description')))==null?'':_.escape(__t))+\n'\\n      </p>\\n    </div>\\n\\n    <div class=\"BuilderOnboarding-step is-step4\">\\n      <p class=\"CDB-Text Onboarding-headerTitle\">4/4</p>\\n      <p class=\"CDB-Text Onboarding-headerText\">'+\n((__t=( _t('builder-onboarding.widgets.title')))==null?'':_.escape(__t))+\n'</p>\\n      <p class=\"CDB-Text BuilderOnboarding-description\">\\n        '+\n((__t=( _t('builder-onboarding.widgets.description')))==null?'':_.escape(__t))+\n'\\n      </p>\\n    </div>\\n\\n    <div class=\"BuilderOnboarding-footer is-step1 is-step2 is-step3\">\\n      <div class=\"BuilderOnboarding-footerButtons\">\\n        <button class=\"CDB-Button CDB-Button--secondary CDB-Button--white CDB-Button--big Onboarding-footer--marginRight js-close\">\\n          <span class=\"CDB-Button-Text CDB-Text u-upperCase is-semibold CDB-Size-medium\">'+\n((__t=( _t('builder-onboarding.skip')))==null?'':_.escape(__t))+\n'</span>\\n        </button>\\n\\n        <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-next\">\\n          <span class=\"CDB-Button-Text CDB-Text u-upperCase is-semibold CDB-Size-medium\">'+\n((__t=( _t('builder-onboarding.next')))==null?'':_.escape(__t))+\n'</span>\\n        </button>\\n      </div>\\n    </div>\\n\\n    <div class=\"BuilderOnboarding-footer is-step4\">\\n      <div class=\"BuilderOnboarding-footerButtons\">\\n        <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-close\">\\n          <span class=\"CDB-Button-Text CDB-Text u-upperCase is-semibold CDB-Size-medium\">'+\n((__t=( _t('builder-onboarding.edit-map')))==null?'':_.escape(__t))+\n'</span>\\n        </button>\\n      </div>\\n    </div>\\n  </div>\\n</div>\\n\\n<div class=\"BuilderOnboarding-pad3\"></div>\\n<div class=\"BuilderOnboarding-pad4\"></div>\\n<div class=\"BuilderOnboarding-pad5\"></div>\\n<div class=\"BuilderOnboarding-shadow\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var BuilderOnboardingView = require('./builder-view');\nvar checkAndBuildOpts = require('../../../helpers/required-opts');\n\nvar BUILDER_KEY = 'onboarding';\n\nvar REQUIRED_OPTS = [\n  'onboardings',\n  'userModel',\n  'onboardingNotification',\n  'editorModel'\n];\n\nmodule.exports = (function () {\n  return {\n    init: function (opts) {\n      checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n    },\n\n    launch: function () {\n      if (!this._onboardingNotification.getKey(BUILDER_KEY)) {\n        this._onboardings.create(function () {\n          return new BuilderOnboardingView({\n            userModel: this._userModel,\n            editorModel: this._editorModel,\n            onboardingNotification: this._onboardingNotification\n          });\n        }.bind(this));\n      }\n    }\n  };\n})();\n",
    "var _ = require('underscore');\n\nvar GenericOnboardingLauncher = function (launcherOpts, viewOpts) {\n  var _view;\n  var _onboardingNotification;\n  var _notificationKey;\n  var _onboardings;\n  var _viewOpts;\n\n  if (!launcherOpts || !launcherOpts.view) {\n    throw new Error('view is required');\n  }\n\n  if (!launcherOpts.onboardingNotification) {\n    throw new Error('onboardingNotification is required');\n  }\n\n  if (!launcherOpts.notificationKey) {\n    throw new Error('notificationKey is required');\n  }\n\n  if (!launcherOpts.onboardings) {\n    throw new Error('onboardings is required');\n  }\n\n  if (!viewOpts) {\n    throw new Error('viewOpts is required');\n  }\n\n  _view = launcherOpts.view;\n  _onboardingNotification = launcherOpts.onboardingNotification;\n  _notificationKey = launcherOpts.notificationKey;\n  _onboardings = launcherOpts.onboardings;\n  _viewOpts = viewOpts;\n\n  return {\n    launch: function (launchOpts) {\n      if (!_onboardingNotification.getKey(_notificationKey)) {\n        _onboardings.create(function () {\n          var extendedViewOptions = _.extend(_viewOpts, {\n            onboardingNotification: _onboardingNotification,\n            notificationKey: _notificationKey\n          });\n          return new _view(_.extend(extendedViewOptions, launchOpts));\n        });\n      }\n    }\n  };\n};\n\nmodule.exports = GenericOnboardingLauncher;\n",
    "var $ = require('jquery');\nvar Backbone = require('backbone');\nvar _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar checkAndBuildOpts = require('../../../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'onboardingNotification',\n  'editorModel',\n  'template',\n  'numberOfSteps',\n  'selector',\n  'modifier',\n  'notificationKey'\n];\n\nvar LEFT_KEY_CODE = 37;\nvar RIGHT_KEY_CODE = 39;\n\nmodule.exports = CoreView.extend({\n  className: 'is-step0 is-opening',\n\n  events: {\n    'click .js-start': '_onClickNext',\n    'click .js-next': '_onClickNext',\n    'click .js-close': '_close',\n    'click .js-highlight': '_close'\n  },\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n    this.$el.addClass(this._selector);\n    this.model = new Backbone.Model({\n      step: -1\n    });\n    this._defaultBodyPos = {\n      top: 32,\n      left: 380\n    };\n\n    this._keyDown = this._onKeyDown.bind(this);\n    this._initBinds();\n  },\n\n  render: function () {\n    this.$el.addClass(this._selector + this._modifier);\n    this.$el.html(this._template());\n    if (this.model.get('step') === -1) {\n      this._next();\n    }\n    return this;\n  },\n\n  _initBinds: function () {\n    this.listenTo(this.model, 'destroy', this._close);\n    this.listenTo(this.model, 'change:step', this._onChangeStep);\n    this.listenTo(this._editorModel, 'change:edition', this._changeEdition);\n    $(document).on('keydown', this._keyDown);\n  },\n\n  _changeEdition: function (mdl) {\n    var isEditing = !!mdl.get('edition');\n    this.$el.toggleClass('is-editing', isEditing);\n  },\n\n  _prev: function () {\n    if (this._currentStep() >= 1) {\n      this.model.set('step', this._currentStep() - 1);\n    }\n  },\n\n  _next: function () {\n    if (this._currentStep() < this._numberOfSteps) {\n      this.model.set('step', this._currentStep() + 1);\n    }\n  },\n\n  _currentStep: function () {\n    return this.model.get('step');\n  },\n\n  _onClickNext: function () {\n    this._next();\n  },\n\n  _onChangeStep: function () {\n    var prev = this.model.previous('step');\n    var step = this.model.get('step');\n\n    this.$el.removeClass('is-step' + prev, function () {\n      this.$el.addClass('is-step' + step);\n    }.bind(this));\n\n    this.$('.js-step').removeClass('is-step' + prev).addClass('is-step' + step);\n\n    this.$('.' + this._selector + '-body').fadeOut(0).delay(200).fadeIn(100);\n\n    this.$('.' + this._selector + '-step.is-step' + prev).css('display', 'none');\n    this.$('.' + this._selector + '-footer.is-step' + prev).css('display', 'none');\n    this.$('.' + this._selector + '-step.is-step' + step).css('display', 'block');\n    this.$('.' + this._selector + '-footer.is-step' + step).css('display', 'block');\n\n    this.$('.' + this._selector + '-contentBody').css('display', step === 0 ? 'block' : 'none');\n  },\n\n  _close: function () {\n    this._checkForgetStatus();\n    this.trigger('close', this);\n  },\n\n  _onKeyDown: function (e) {\n    e.stopPropagation();\n\n    if (e.which === LEFT_KEY_CODE) {\n      this._prev();\n    } else if (e.which === RIGHT_KEY_CODE) {\n      this._next();\n    }\n  },\n\n  _checkForgetStatus: function () {\n    if (this.$('.js-forget:checked').val()) {\n      this._forget();\n    }\n  },\n\n  _forget: function () {\n    this._onboardingNotification.setKey(this._notificationKey, true);\n    this._onboardingNotification.save();\n  },\n\n  clean: function () {\n    $(document).off('keydown', this._keyDown);\n    CoreView.prototype.clean.apply(this);\n  },\n\n  _setMiddlePad: function (position, padding, body) {\n    var $window = $(window);\n    var $top = this.$('.' + this._selector + '-pads--left .' + this._selector + '-padTop');\n    var $middle = this.$('.' + this._selector + '-pads--left .' + this._selector + '-padMiddle');\n    var $bottom = this.$('.' + this._selector + '-pads--left .' + this._selector + '-padBottom');\n    var vh = $window.height();\n    var vw = $window.width();\n    var isSelector = _.isString(position);\n    var $el;\n    var width = 0;\n    var height = 0;\n    var left = 0;\n    var top = 0;\n    if (isSelector) {\n      $el = $(position);\n      width = $el.outerWidth();\n      height = $el.outerHeight();\n      left = $el.offset().left;\n      top = $el.offset().top;\n    } else {\n      width = position.width;\n      height = position.height;\n      left = position.left;\n      top = position.top;\n    }\n\n    // Apply padding\n    var appliedPadding = this._buildPadding(padding);\n    top -= appliedPadding.top;\n    left -= appliedPadding.left;\n    width += appliedPadding.left + appliedPadding.right;\n    height += appliedPadding.top + appliedPadding.bottom;\n\n    // Is it place outside the viewport?\n    if (vw - left > 0 && vw - left < width) {\n      width = vw - left;\n    } else if (vw - left <= 0) {\n      width = 0;\n    }\n\n    // Left offset\n    this.$('.' + this._selector + '-toolbarOverlay').outerWidth(left);\n\n    // Right panel\n    this.$('.' + this._selector + '-contentWrapper').outerWidth(vw - (left + width));\n\n    // Width\n    this.$('.' + this._selector + '-pads--left').outerWidth(width);\n    $top.outerWidth(width);\n    $middle.outerWidth(width);\n    $bottom.outerWidth(width);\n\n    // Height\n    var topHeight = top;\n    var middleHeight = height;\n    var bottomHeight = vh - (topHeight + middleHeight);\n\n    $top.outerHeight(topHeight);\n    $middle.outerHeight(middleHeight);\n    $bottom.outerHeight(bottomHeight);\n\n    // Body text\n    this.$('.' + this._selector + '-body').css('top', body && body.top ? body.top : this._defaultBodyPos.top);\n    this.$('.' + this._selector + '-body').css('left', body && body.left ? body.left : this._defaultBodyPos.left);\n  },\n\n  _buildPadding: function (padding) {\n    var result = {\n      top: 0,\n      right: 0,\n      bottom: 0,\n      left: 0\n    };\n\n    if (padding) {\n      result.top = this._calculatePadding(padding.top);\n      result.right = this._calculatePadding(padding.right);\n      result.bottom = this._calculatePadding(padding.bottom);\n      result.left = this._calculatePadding(padding.left);\n    }\n\n    return result;\n  },\n\n  _calculatePadding: function (padding) {\n    return (padding && _.isFinite(padding)) ? padding : 0;\n  }\n});\n",
    "var _ = require('underscore');\nvar OnboardingView = require('../../generic/generic-onboarding-view');\nvar AnalysesService = require('../../../../editor/layers/layer-content-views/analyses/analyses-service');\nvar template = require('./analysis-onboarding.tpl');\n\nmodule.exports = OnboardingView.extend({\n  events: OnboardingView.extendEvents({\n    'click .js-add-analysis': '_onAddAnalysisClicked'\n  }),\n\n  initialize: function (opts) {\n    OnboardingView.prototype.initialize.call(this, _.extend(opts, {\n      template: template,\n      numberOfSteps: 0,\n      modifier: '--analysis'\n    }));\n  },\n\n  _onAddAnalysisClicked: function () {\n    this._checkForgetStatus();\n    this.clean();\n    AnalysesService.addAnalysis();\n  },\n\n  _onChangeStep: function () {\n    OnboardingView.prototype._onChangeStep.call(this);\n\n    var step = this.model.get('step');\n\n    if (step === 0) {\n      this._setMiddlePad('.js-editorPanel');\n    }\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"LayerOnboarding-toolbarOverlay\"></div>\\n\\n<div class=\"LayerOnboarding-pads LayerOnboarding-pads--left\">\\n  <div class=\"LayerOnboarding-padTop\"></div>\\n  <div class=\"LayerOnboarding-padMiddle js-highlight\"></div>\\n</div>\\n\\n<div class=\"LayerOnboarding-contentWrapper LayerOnboarding-contentWrapper--analysis is-step0 js-step\">\\n  <div class=\"LayerOnboarding-contentBody LayerOnboarding-contentBody--analysis is-step0 js-step\">\\n    <div class=\"Onboarding-body\">\\n      <p class=\"CDB-Text LayerOnboarding-headerTitle\">'+\n((__t=( _t('analysis-onboarding.title')))==null?'':_.escape(__t))+\n'</p>\\n\\n      <p class=\"CDB-Text Onboarding-headerDescription\">'+\n((__t=( _t('analysis-onboarding.description')))==null?'':_.escape(__t))+\n'</p>\\n\\n      <ul class=\"Onboarding-list\">\\n        <li class=\"Onboarding-listItem\">\\n          <p class=\"CDB-Text LayerOnboarding-description\">'+\n((__t=( _t('analysis-onboarding.description-list.item1')))==null?'':_.escape(__t))+\n'</p>\\n        </li>\\n\\n        <li class=\"Onboarding-listItem\">\\n          <p class=\"CDB-Text LayerOnboarding-description\">'+\n((__t=( _t('analysis-onboarding.description-list.item2')))==null?'':__t)+\n'</p>\\n        </li>\\n\\n        <li class=\"Onboarding-listItem\">\\n          <p class=\"CDB-Text LayerOnboarding-description\">'+\n((__t=( _t('analysis-onboarding.description-list.item3')))==null?'':_.escape(__t))+\n'</p>\\n        </li>\\n\\n        <li class=\"Onboarding-listItem\">\\n          <p class=\"CDB-Text LayerOnboarding-description\">'+\n((__t=( _t('analysis-onboarding.description-list.item4')))==null?'':_.escape(__t))+\n'</p>\\n        </li>\\n      </ul>\\n    </div>\\n\\n    <div class=\"LayerOnboarding-footer\">\\n      <div class=\"LayerOnboarding-footerButtons\">\\n        <button class=\"CDB-Button CDB-Button--secondary CDB-Button--white CDB-Button--big Onboarding-footer--marginRight js-close\">\\n          <span class=\"CDB-Button-Text CDB-Text u-upperCase is-semibold CDB-Size-medium\">'+\n((__t=( _t('analysis-onboarding.done')))==null?'':_.escape(__t))+\n'</span>\\n        </button>\\n\\n        <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-add-analysis\">\\n          <span class=\"CDB-Button-Text CDB-Text u-upperCase is-semibold CDB-Size-medium\">'+\n((__t=( _t('analysis-onboarding.add-analysis')))==null?'':_.escape(__t))+\n'</span>\\n        </button>\\n      </div>\\n\\n      <div class=\"u-iBlock\">\\n        <input class=\"CDB-Checkbox js-forget\" type=\"checkbox\" id=\"forget-me\" name=\"forget-me\" value=\"true\">\\n        <span class=\"u-iBlock CDB-Checkbox-face\"></span>\\n        <label for=\"forget-me\" class=\"Onboarding-forgetLabel Checkbox-label CDB-Text CDB-Size-small u-whiteTextColor is-light u-lSpace\">'+\n((__t=( _t('analyses-onboarding.never-show-message') ))==null?'':_.escape(__t))+\n'</label>\\n      </div>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar $ = require('jquery');\nvar OnboardingView = require('../../generic/generic-onboarding-view');\nvar template = require('./data-onboarding.tpl');\n\nmodule.exports = OnboardingView.extend({\n  initialize: function (opts) {\n    OnboardingView.prototype.initialize.call(this, _.extend(opts, {\n      template: template,\n      numberOfSteps: 4,\n      modifier: '--data'\n    }));\n  },\n\n  _onChangeStep: function () {\n    OnboardingView.prototype._onChangeStep.call(this);\n\n    var step = this.model.get('step');\n\n    if (step === 0) {\n      this._setMiddlePad('.js-editorPanel');\n    } else if (step === 1) {\n      this._setMiddlePad('.js-editorPanelHeader', {top: 16, right: 24, left: 24});\n    } else if (step === 2) {\n      this._setMiddlePad('.js-editorPanelContent', {top: 8, right: 24, left: 24, bottom: -$('.js-optionsBar').outerHeight()});\n    } else if (step === 3) {\n      this._setMiddlePad('.js-optionsBar', null, {top: -190});\n    } else if (step === 4) {\n      var featurePosition = this._getFeatureEditionPosition();\n      this._setMiddlePad(featurePosition, {top: 8, right: 8, bottom: 8, left: 8}, {top: -270, left: -330});\n    }\n  },\n\n  _getFeatureEditionPosition: function () {\n    var $switch = $('.js-mapTableView').first();\n    var $featureEdition = $('.js-newGeometryView').first();\n    var leftOffset = Math.min($switch.length > 0 ? $switch.offset().left : Number.MAX_VALUE, $featureEdition.length > 0 ? $featureEdition.offset().left : Number.MAX_VALUE);\n    var topOffset = Math.min($switch.length > 0 ? $switch.offset().top : Number.MAX_VALUE, $featureEdition.length > 0 ? $featureEdition.offset().top : Number.MAX_VALUE);\n    var rightOffset = Math.max(\n      $switch.length > 0 ? $switch.offset().left + $switch.outerWidth() : Number.MIN_VALUE,\n      $featureEdition.length > 0 ? $featureEdition.offset().left + $featureEdition.outerWidth() : Number.MIN_VALUE\n    );\n    var bottomOffset = Math.max(\n      $switch.length > 0 ? $switch.offset().top + $switch.outerHeight() : Number.MIN_VALUE,\n      $featureEdition.length > 0 ? $featureEdition.offset().top + $featureEdition.outerHeight() : Number.MIN_VALUE\n    );\n\n    return {\n      left: leftOffset,\n      top: topOffset,\n      width: rightOffset - leftOffset,\n      height: bottomOffset - topOffset\n    };\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"LayerOnboarding-toolbarOverlay\"></div>\\n\\n<div class=\"LayerOnboarding-pads LayerOnboarding-pads--left\">\\n  <div class=\"LayerOnboarding-padTop\"></div>\\n  <div class=\"LayerOnboarding-padMiddle js-highlight\">\\n    <div class=\"LayerOnboarding-body is-step0 js-step\">\\n      <div class=\"LayerOnboarding-step is-step1\">\\n        <p class=\"CDB-Text LayerOnboarding-headerTitle\">1/4</p>\\n        <p class=\"CDB-Text LayerOnboarding-headerText\">'+\n((__t=( _t('data-onboarding.layer-options.title')))==null?'':_.escape(__t))+\n'</p>\\n        <p class=\"CDB-Text LayerOnboarding-description\">\\n          '+\n((__t=( _t('data-onboarding.layer-options.description')))==null?'':_.escape(__t))+\n'\\n        </p>\\n      </div>\\n      <div class=\"LayerOnboarding-step is-step2\">\\n        <p class=\"CDB-Text LayerOnboarding-headerTitle\">2/4</p>\\n        <p class=\"CDB-Text LayerOnboarding-headerText\">'+\n((__t=( _t('data-onboarding.data-tab.title')))==null?'':_.escape(__t))+\n'</p>\\n        <p class=\"CDB-Text LayerOnboarding-description\">\\n          '+\n((__t=( _t('data-onboarding.data-tab.description')))==null?'':_.escape(__t))+\n'\\n        </p>\\n      </div>\\n\\n      <div class=\"LayerOnboarding-step is-step3\">\\n        <p class=\"CDB-Text LayerOnboarding-headerTitle\">3/4</p>\\n        <p class=\"CDB-Text LayerOnboarding-headerText\">'+\n((__t=( _t('data-onboarding.sql-editor.title')))==null?'':_.escape(__t))+\n'</p>\\n        <p class=\"CDB-Text LayerOnboarding-description\">\\n          '+\n((__t=( _t('data-onboarding.sql-editor.description')))==null?'':_.escape(__t))+\n'\\n        </p>\\n      </div>\\n\\n      <div class=\"LayerOnboarding-step is-step4\">\\n        <p class=\"CDB-Text LayerOnboarding-headerTitle\">4/4</p>\\n        <p class=\"CDB-Text LayerOnboarding-headerText is-step4\">'+\n((__t=( _t('data-onboarding.add-geometry.title')))==null?'':_.escape(__t))+\n'</p>\\n        <p class=\"CDB-Text LayerOnboarding-description is-step4\">\\n          '+\n((__t=( _t('data-onboarding.add-geometry.description')))==null?'':_.escape(__t))+\n'\\n        </p>\\n      </div>\\n\\n      <div class=\"LayerOnboarding-footer is-step1 is-step2 is-step3\">\\n        <div class=\"LayerOnboarding-footerButtons\">\\n          <button class=\"CDB-Button CDB-Button--secondary CDB-Button--white CDB-Button--big Onboarding-footer--marginRight js-close\">\\n            <span class=\"CDB-Button-Text CDB-Text u-upperCase is-semibold CDB-Size-medium\">'+\n((__t=( _t('data-onboarding.exit')))==null?'':_.escape(__t))+\n'</span>\\n          </button>\\n\\n          <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-next\">\\n            <span class=\"CDB-Button-Text CDB-Text u-upperCase is-semibold CDB-Size-medium\">'+\n((__t=( _t('data-onboarding.next')))==null?'':_.escape(__t))+\n'</span>\\n          </button>\\n        </div>\\n      </div>\\n\\n      <div class=\"LayerOnboarding-footer is-step4\">\\n        <div class=\"LayerOnboarding-footerButtons\">\\n          <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-close\">\\n            <span class=\"CDB-Button-Text CDB-Text u-upperCase is-semibold CDB-Size-medium\">'+\n((__t=( _t('data-onboarding.add-geometry.edit-layer') ))==null?'':_.escape(__t))+\n'</span>\\n          </button>\\n        </div>\\n      </div>\\n    </div>\\n  </div>\\n  <div class=\"LayerOnboarding-padBottom\"></div>\\n</div>\\n\\n<div class=\"LayerOnboarding-contentWrapper is-step0 js-step\">\\n  <div class=\"LayerOnboarding-contentBody is-step0 js-step\">\\n    <div class=\"LayerOnboarding-header is-step0\">\\n      <p class=\"CDB-Text LayerOnboarding-headerTitle\">'+\n((__t=( _t('data-onboarding.title')))==null?'':_.escape(__t))+\n'</p>\\n\\n      <p class=\"CDB-Text LayerOnboarding-description\">\\n        '+\n((__t=( _t('data-onboarding.description')))==null?'':__t)+\n'\\n      </p>\\n    </div>\\n\\n    <div class=\"LayerOnboarding-footer is-step0\">\\n      <div class=\"LayerOnboarding-footerButtons\">\\n        <button class=\"CDB-Button CDB-Button--secondary CDB-Button--white CDB-Button--big Onboarding-footer--marginRight js-start\">\\n          <span class=\"CDB-Button-Text CDB-Text u-upperCase is-semibold CDB-Size-medium\">'+\n((__t=( _t('data-onboarding.take-tour')))==null?'':_.escape(__t))+\n'</span>\\n        </button>\\n\\n        <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-close\">\\n          <span class=\"CDB-Button-Text CDB-Text u-upperCase is-semibold CDB-Size-medium\">'+\n((__t=( _t('data-onboarding.edit-layer')))==null?'':_.escape(__t))+\n'</span>\\n        </button>\\n      </div>\\n\\n      <div class=\"u-iBlock is-step1\">\\n        <input class=\"CDB-Checkbox js-forget\" type=\"checkbox\" id=\"forget-me\" name=\"forget-me\" value=\"true\">\\n        <span class=\"u-iBlock CDB-Checkbox-face\"></span>\\n        <label for=\"forget-me\" class=\"BuilderOnboarding-forgetLabel Checkbox-label CDB-Text CDB-Size-small u-whiteTextColor is-light u-lSpace\">'+\n((__t=( _t('style-onboarding.never-show-message') ))==null?'':_.escape(__t))+\n'</label>\\n      </div>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "module.exports = 'layer-onboarding';\n",
    "var _ = require('underscore');\nvar $ = require('jquery');\nvar OnboardingView = require('../../generic/generic-onboarding-view');\nvar defaultTemplate = require('./style-onboarding.tpl');\nvar pointsTemplate = require('./style-points-onboarding.tpl');\nvar checkAndBuildOpts = require('../../../../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'geom'\n];\n\nmodule.exports = OnboardingView.extend({\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    var template = defaultTemplate;\n    var modifier = '--style';\n    var steps = 2;\n\n    if (this._geom === 'point') {\n      template = pointsTemplate;\n      steps = 3;\n    }\n\n    OnboardingView.prototype.initialize.call(this, _.extend(opts, {\n      template: template,\n      numberOfSteps: steps,\n      modifier: modifier\n    }));\n  },\n\n  _onChangeStep: function () {\n    OnboardingView.prototype._onChangeStep.call(this);\n\n    var step = this.model.get('step');\n\n    switch (step) {\n      case 0:\n        this._setMiddlePad('.js-editorPanel');\n        break;\n      case 1:\n        this._setStepOne();\n        break;\n      case 2:\n        this._setStepTwo();\n        break;\n      case 3:\n        this._highlightOptionsBar();\n        break;\n    }\n  },\n\n  _setStepOne: function () {\n    var $noGeom = $('.js-styleNoGeom');\n\n    if ($noGeom.length > 0) {\n      this._setMiddlePad('.js-styleNoGeom', {top: 8, right: 24, left: 24, bottom: 8});\n    } else if (this._numberOfSteps === 3) {\n      var aggregationInfo = this._getAggregationPositionAndPadding();\n      this._setMiddlePad(aggregationInfo.position, aggregationInfo.padding);\n    } else {\n      this._highlightStyleProperties();\n    }\n  },\n\n  _setStepTwo: function () {\n    if (this._numberOfSteps === 2) {\n      this._highlightOptionsBar();\n    } else {\n      this._highlightStyleProperties();\n    }\n  },\n\n  _highlightStyleProperties: function () {\n    this._setMiddlePad('.js-styleProperties', {top: 8, right: 24, left: 24, bottom: 8});\n  },\n\n  _highlightOptionsBar: function () {\n    this._setMiddlePad('.js-optionsBar', null, {top: -190});\n  },\n\n  _getAggregationPositionAndPadding: function () {\n    var $aggregationTypes = $('.js-aggregationTypes');\n    var $aggregationOptions = $('.js-aggregationOptions');\n    var left = $aggregationTypes.offset().left;\n    var top = $aggregationTypes.offset().top;\n    var width = $aggregationTypes.outerWidth();\n    var height = $aggregationTypes.outerHeight();\n    var bottomPadding = 0;\n\n    if ($aggregationOptions.length > 0) {\n      height += $aggregationOptions.outerHeight();\n      bottomPadding = 8;\n    }\n\n    return {\n      position: {\n        top: top,\n        left: left,\n        width: width,\n        height: height\n      },\n      padding: {\n        top: 8,\n        right: 24,\n        left: 24,\n        bottom: bottomPadding\n      }\n    };\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"LayerOnboarding-toolbarOverlay\"></div>\\n\\n<div class=\"LayerOnboarding-pads LayerOnboarding-pads--left\">\\n  <div class=\"LayerOnboarding-padTop\"></div>\\n  <div class=\"LayerOnboarding-padMiddle js-highlight\">\\n    <div class=\"LayerOnboarding-body is-step0 js-step\">\\n      <div class=\"LayerOnboarding-step is-step1\">\\n        <p class=\"CDB-Text LayerOnboarding-headerTitle\">1/2</p>\\n        <p class=\"CDB-Text LayerOnboarding-headerText\">'+\n((__t=( _t('style-onboarding.style.title')))==null?'':_.escape(__t))+\n'</p>\\n        <p class=\"CDB-Text LayerOnboarding-description LayerOnboarding-description--style\">\\n          '+\n((__t=( _t('style-onboarding.style.short-description')))==null?'':_.escape(__t))+\n'\\n        </p>\\n      </div>\\n\\n      <div class=\"LayerOnboarding-step is-step2\">\\n        <p class=\"CDB-Text LayerOnboarding-headerTitle\">2/2</p>\\n        <p class=\"CDB-Text LayerOnboarding-headerText\">'+\n((__t=( _t('style-onboarding.cartocss.title')))==null?'':_.escape(__t))+\n'</p>\\n        <p class=\"CDB-Text LayerOnboarding-description\">\\n          '+\n((__t=( _t('style-onboarding.cartocss.description')))==null?'':_.escape(__t))+\n'\\n        </p>\\n      </div>\\n\\n      <div class=\"LayerOnboarding-footer is-step1\">\\n        <div class=\"LayerOnboarding-footerButtons\">\\n          <button class=\"CDB-Button CDB-Button--secondary CDB-Button--white CDB-Button--big Onboarding-footer--marginRight js-close\">\\n            <span class=\"CDB-Button-Text CDB-Text u-upperCase is-semibold CDB-Size-medium\">'+\n((__t=( _t('style-onboarding.exit')))==null?'':_.escape(__t))+\n'</span>\\n          </button>\\n\\n          <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-next\">\\n            <span class=\"CDB-Button-Text CDB-Text u-upperCase is-semibold CDB-Size-medium\">'+\n((__t=( _t('style-onboarding.next')))==null?'':_.escape(__t))+\n'</span>\\n          </button>\\n        </div>\\n      </div>\\n\\n      <div class=\"LayerOnboarding-footer is-step2\">\\n        <div class=\"LayerOnboarding-footerButtons\">\\n          <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-close\">\\n            <span class=\"CDB-Button-Text CDB-Text u-upperCase is-semibold CDB-Size-medium\">'+\n((__t=( _t('style-onboarding.style-layer')))==null?'':_.escape(__t))+\n'</span>\\n          </button>\\n        </div>\\n      </div>\\n    </div>\\n  </div>\\n  <div class=\"LayerOnboarding-padBottom\"></div>\\n</div>\\n\\n<div class=\"LayerOnboarding-contentWrapper is-step0 js-step\">\\n  <div class=\"LayerOnboarding-contentBody is-step0 js-step\">\\n    <div class=\"LayerOnboarding-header is-step0\">\\n      <p class=\"CDB-Text LayerOnboarding-headerTitle\">'+\n((__t=( _t('style-onboarding.title')))==null?'':_.escape(__t))+\n'</p>\\n\\n      <p class=\"CDB-Text LayerOnboarding-description\">\\n        '+\n((__t=( _t('style-onboarding.description')))==null?'':_.escape(__t))+\n'\\n      </p>\\n    </div>\\n\\n    <div class=\"LayerOnboarding-footer is-step0\">\\n      <div class=\"LayerOnboarding-footerButtons\">\\n        <button class=\"CDB-Button CDB-Button--secondary CDB-Button--white CDB-Button--big Onboarding-footer--marginRight js-start\">\\n          <span class=\"CDB-Button-Text CDB-Text u-upperCase is-semibold CDB-Size-medium\">'+\n((__t=( _t('style-onboarding.take-tour')))==null?'':_.escape(__t))+\n'</span>\\n        </button>\\n\\n        <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-close\">\\n          <span class=\"CDB-Button-Text CDB-Text u-upperCase is-semibold CDB-Size-medium\">'+\n((__t=( _t('style-onboarding.style-layer')))==null?'':_.escape(__t))+\n'</span>\\n        </button>\\n      </div>\\n\\n      <div class=\"u-iBlock is-step1\">\\n        <input class=\"CDB-Checkbox js-forget\" type=\"checkbox\" id=\"forget-me\" name=\"forget-me\" value=\"true\">\\n        <span class=\"u-iBlock CDB-Checkbox-face\"></span>\\n        <label for=\"forget-me\" class=\"BuilderOnboarding-forgetLabel Checkbox-label CDB-Text CDB-Size-small u-whiteTextColor is-light u-lSpace\">'+\n((__t=( _t('style-onboarding.never-show-message') ))==null?'':_.escape(__t))+\n'</label>\\n      </div>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"LayerOnboarding-toolbarOverlay\"></div>\\n\\n<div class=\"LayerOnboarding-pads LayerOnboarding-pads--left\">\\n  <div class=\"LayerOnboarding-padTop\"></div>\\n  <div class=\"LayerOnboarding-padMiddle js-highlight\">\\n    <div class=\"LayerOnboarding-body is-step0 js-step\">\\n      <div class=\"LayerOnboarding-step is-step1\">\\n        <p class=\"CDB-Text LayerOnboarding-headerTitle\">1/3</p>\\n        <p class=\"CDB-Text LayerOnboarding-headerText\">'+\n((__t=( _t('style-onboarding.aggregation.title')))==null?'':_.escape(__t))+\n'</p>\\n        <p class=\"CDB-Text LayerOnboarding-description\">\\n          '+\n((__t=( _t('style-onboarding.aggregation.description')))==null?'':_.escape(__t))+\n'\\n        </p>\\n      </div>\\n      <div class=\"LayerOnboarding-step is-step2\">\\n        <p class=\"CDB-Text LayerOnboarding-headerTitle\">2/3</p>\\n        <p class=\"CDB-Text LayerOnboarding-headerText\">'+\n((__t=( _t('style-onboarding.style.title')))==null?'':_.escape(__t))+\n'</p>\\n        <p class=\"CDB-Text LayerOnboarding-description LayerOnboarding-description--style\">\\n          '+\n((__t=( _t('style-onboarding.style.description')))==null?'':_.escape(__t))+\n'\\n        </p>\\n      </div>\\n\\n      <div class=\"LayerOnboarding-step is-step3\">\\n        <p class=\"CDB-Text LayerOnboarding-headerTitle\">3/3</p>\\n        <p class=\"CDB-Text LayerOnboarding-headerText\">'+\n((__t=( _t('style-onboarding.cartocss.title')))==null?'':_.escape(__t))+\n'</p>\\n        <p class=\"CDB-Text LayerOnboarding-description\">\\n          '+\n((__t=( _t('style-onboarding.cartocss.description')))==null?'':_.escape(__t))+\n'\\n        </p>\\n      </div>\\n\\n      <div class=\"LayerOnboarding-footer is-step1 is-step2\">\\n        <div class=\"LayerOnboarding-footerButtons\">\\n          <button class=\"CDB-Button CDB-Button--secondary CDB-Button--white CDB-Button--big Onboarding-footer--marginRight js-close\">\\n            <span class=\"CDB-Button-Text CDB-Text u-upperCase is-semibold CDB-Size-medium\">'+\n((__t=( _t('style-onboarding.exit')))==null?'':_.escape(__t))+\n'</span>\\n          </button>\\n\\n          <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-next\">\\n            <span class=\"CDB-Button-Text CDB-Text u-upperCase is-semibold CDB-Size-medium\">'+\n((__t=( _t('style-onboarding.next')))==null?'':_.escape(__t))+\n'</span>\\n          </button>\\n        </div>\\n      </div>\\n\\n      <div class=\"LayerOnboarding-footer is-step3\">\\n        <div class=\"LayerOnboarding-footerButtons\">\\n          <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-close\">\\n            <span class=\"CDB-Button-Text CDB-Text u-upperCase is-semibold CDB-Size-medium\">'+\n((__t=( _t('style-onboarding.style-layer')))==null?'':_.escape(__t))+\n'</span>\\n          </button>\\n        </div>\\n      </div>\\n    </div>\\n  </div>\\n  <div class=\"LayerOnboarding-padBottom\"></div>\\n</div>\\n\\n<div class=\"LayerOnboarding-contentWrapper is-step0 js-step\">\\n  <div class=\"LayerOnboarding-contentBody is-step0 js-step\">\\n    <div class=\"LayerOnboarding-header is-step0\">\\n      <p class=\"CDB-Text LayerOnboarding-headerTitle\">'+\n((__t=( _t('style-onboarding.title')))==null?'':_.escape(__t))+\n'</p>\\n\\n      <p class=\"CDB-Text LayerOnboarding-description\">\\n        '+\n((__t=( _t('style-onboarding.description')))==null?'':_.escape(__t))+\n'\\n      </p>\\n    </div>\\n\\n    <div class=\"LayerOnboarding-footer is-step0\">\\n      <div class=\"LayerOnboarding-footerButtons\">\\n        <button class=\"CDB-Button CDB-Button--secondary CDB-Button--white CDB-Button--big Onboarding-footer--marginRight js-start\">\\n          <span class=\"CDB-Button-Text CDB-Text u-upperCase is-semibold CDB-Size-medium\">'+\n((__t=( _t('style-onboarding.take-tour')))==null?'':_.escape(__t))+\n'</span>\\n        </button>\\n\\n        <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-close\">\\n          <span class=\"CDB-Button-Text CDB-Text u-upperCase is-semibold CDB-Size-medium\">'+\n((__t=( _t('style-onboarding.style-layer')))==null?'':_.escape(__t))+\n'</span>\\n        </button>\\n      </div>\\n\\n      <div class=\"u-iBlock is-step1\">\\n        <input class=\"CDB-Checkbox js-forget\" type=\"checkbox\" id=\"forget-me\" name=\"forget-me\" value=\"true\">\\n        <span class=\"u-iBlock CDB-Checkbox-face\"></span>\\n        <label for=\"forget-me\" class=\"BuilderOnboarding-forgetLabel Checkbox-label CDB-Text CDB-Size-small u-whiteTextColor is-light u-lSpace\">'+\n((__t=( _t('style-onboarding.never-show-message') ))==null?'':_.escape(__t))+\n'</label>\\n      </div>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\n\n/**\n * View model of a onboarding\n */\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    show: true,\n    createContentView: function () {\n      return new CoreView();\n    },\n    getContentClasses: function () {\n      return null;\n    }\n  },\n\n  createContentView: function () {\n    return this.get('createContentView')(this);\n  },\n\n  getContentClasses: function () {\n    return this.get('contentClasses');\n  },\n\n  show: function () {\n    this.set('show', true);\n  },\n\n  hide: function () {\n    this.set('show', false);\n  },\n\n  isHidden: function () {\n    return !this.get('show');\n  },\n\n  /**\n   * @override {Backbone.Model.prototype.destroy}\n   */\n  destroy: function () {\n    var args = Array.prototype.slice.call(arguments);\n    this.trigger.apply(this, ['destroy'].concat(args));\n  }\n});\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar template = require('./onboarding.tpl');\n\n// Ought to match the duration of the .Dialog.is-closing animation.\nvar CLOSE_DELAY_MS = 120;\n\nmodule.exports = CoreView.extend({\n  className: 'Onboarding is-opening',\n\n  initialize: function () {\n    this.listenTo(this.model, 'change:show', this._onShowChange);\n    this.listenTo(this.model, 'destroy', this._onDestroy);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template());\n\n    var view = this.model.createContentView();\n    this.$el.addClass(this.model.getContentClasses());\n    this.addView(view);\n\n    view.bind('customEvent', this._onCustomEvent, this);\n    view.bind('close', this._onClose, this);\n\n    view.render();\n    this.$('.js-content').append(view.el);\n\n    return this;\n  },\n\n  show: function () {\n    this.model.show();\n  },\n\n  hide: function () {\n    this.model.hide();\n  },\n\n  destroy: function () {\n    // 'remove' would be a better name ofc, but there is already an internal method with that name in CoreView\n    this.model.destroy();\n  },\n\n  _onShowChange: function (m, show) {\n    if (show) {\n      this.$el.show();\n      this.$el.removeClass('is-closing').addClass('is-opening');\n    } else {\n      this.$el.removeClass('is-opening').addClass('is-closing');\n      this._delayDueToAnimation(function () {\n        this.$el.hide();\n      });\n    }\n  },\n\n  _onClose: function () {\n    this.destroy();\n  },\n\n  _onCustomEvent: function (customEventName) {\n    this.destroy();\n    this.trigger('customEvent', customEventName, this);\n  },\n\n  _onDestroy: function () {\n    this.hide();\n    _.invoke(this._subviews, 'allOff');\n    this._delayDueToAnimation(function () {\n      this.clean();\n    });\n  },\n\n  _delayDueToAnimation: function (fn) {\n    setTimeout(fn.bind(this), CLOSE_DELAY_MS);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Onboarding js-content\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar OnboardingView = require('./onboarding-view');\nvar OnboardingViewModel = require('./onboarding-view-model');\n\nvar DESTROYED_ONBOARDING_EVENT = 'destroyedOnboarding';\n\n/**\n * Top-level API to handle onboardings.\n * Is intended to be instantiated and registered in some top-level namespace to be accessibel within the lifecycle of\n * an client-side application.\n *\n * Example:\n * // In some entry-point:\n * cdb.onboardings = new OnboardingsServiceModel();\n *\n * // Later, in any view, calling create will create a new onboarding viewModel\n * var onboardingView = cdb.onboardings.create(fn)\n *\n * You will probably see the name of \"Onboarding\" here and there, it's the old nomenclature for the concept of Onboarding.\n */\nmodule.exports = Backbone.Model.extend({\n\n  /**\n   * Creates a new onboarding view\n   *\n   * @param {Function} createContentView\n   * @return {View} the new onboarding view\n   */\n  create: function (createContentView, contentClasses) {\n    if (!_.isFunction(createContentView)) throw new Error('createContentView is required');\n\n    if (!this._onboardingView) {\n      this.trigger('willCreateOnboarding');\n      this._onboardingView = this._newOnboardingView();\n      this.trigger('didCreateOnboarding', this._onboardingView);\n      document.body.appendChild(this._onboardingView.el);\n    }\n\n    this._onboardingView.model.set('createContentView', createContentView);\n    this._onboardingView.model.set('contentClasses', contentClasses);\n    this._onboardingView.render();\n\n    return this._onboardingView;\n  },\n\n  /**\n   * Convenience method to add a listener when current onboarding is destroyed\n   *\n   * This is the same as doing\n   * onboardings.create(function (model) {\n   *   model.once('destroy', callback, context); // <-- same as onboardings.onDestroyOnce(callback, context);\n   *   return new MyView({  });\n   * });\n   *\n   * @param {Function} callback\n   * @param {Object} [context = undefined]\n   */\n  onDestroyOnce: function (callback, context) {\n    this.once(DESTROYED_ONBOARDING_EVENT, callback, context);\n  },\n\n  destroy: function () {\n    if (this._onboardingView) {\n      this._onboardingView.model.destroy();\n    }\n  },\n\n  _newOnboardingView: function () {\n    var viewModel = new OnboardingViewModel();\n    this._handleBodyClass(viewModel);\n    this._destroyOnEsc(viewModel);\n\n    this.listenToOnce(viewModel, 'destroy', function () {\n      this._onboardingView = null;\n      this.trigger.apply(this, [DESTROYED_ONBOARDING_EVENT].concat(Array.prototype.slice.call(arguments)));\n      this.stopListening(viewModel);\n    });\n\n    var onboardingView = new OnboardingView({\n      model: viewModel\n    });\n\n    onboardingView.bind('customEvent', function (eventName) {\n      this.trigger(eventName);\n    }, this);\n\n    return onboardingView;\n  },\n\n  _destroyOnEsc: function (viewModel) {\n    var destroyOnEsc = function (ev) {\n      if (ev.keyCode === 27) {\n        viewModel.destroy();\n      }\n    };\n    document.addEventListener('keydown', destroyOnEsc);\n    this.listenToOnce(viewModel, 'destroy', function () {\n      document.removeEventListener('keydown', destroyOnEsc);\n    });\n  },\n\n  /**\n   * TL;DR this method manages document.body class state, to enable scroll inside of an open onboarding.\n   *\n   * Some onboarding content have too much content that can be displayed in the viewport the scroll needs to be enabled.\n   * Since the onboarding is implemented as a fixed positioned element the body needs to be fixated too, for the scroll to\n   * be enabled inside the onboarding instead.\n   */\n  _handleBodyClass: function (viewModel) {\n    var bodyClass = 'is-inDialog';\n    document.body.classList.add(bodyClass);\n\n    this.listenTo(viewModel, 'change:show', function (m, show) {\n      document.body.classList[show ? 'add' : 'remove'](bodyClass);\n    });\n\n    this.listenToOnce(viewModel, 'destroy', function () {\n      document.body.classList.remove(bodyClass);\n    });\n  }\n\n});\n\n",
    "var Backbone = require('backbone');\n\n/**\n * Model representing the query string params for a \"paged search\" of a collection (matching the server-side APIs).\n *\n * @example usage\n *   pagedSearch = new PaginationSearchModel({  })\n *   pagedSearch.fetch(collection) // => jqXHR, GET /collection/123?page=1&per_page20\n *   pagedSearch.set({ page: 2, per_page: 10, q: 'test' });\n *   pagedSearch.fetch(collection) // => GET /collection/123?page=2&per_page10&q=test\n */\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    per_page: 20,\n    page: 1,\n    q: ''\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.collection) throw new Error('collection is required');\n    if (!opts.collection.totalCount) throw new Error('collection requires to implement totalCount method');\n\n    this.collection = opts.collection;\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this.collection.on('sync', this._updateStateFetched, this);\n    this.collection.on('error', this._updateStateError, this);\n  },\n\n  fetch: function () {\n    this.trigger('fetching', this);\n    return this.collection.fetch({\n      data: this.attributes\n    }, {reset: true});\n  },\n\n  _updateStateFetched: function () {\n    this.trigger('fetched', this);\n  },\n\n  _updateStateError: function () {\n    this.trigger('error', this);\n  }\n});\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar PaginationModel = require('../pagination/pagination-model');\nvar PaginationSearchModel = require('./pagination-search-model');\nvar renderLoading = require('../loading/render-loading');\nvar renderNoResults = require('../no-results/render-no-results');\nvar ErrorView = require('../error/error-view');\nvar template = require('./pagination-search.tpl');\nvar Utils = require('../../helpers/utils');\nvar PaginationView = require('../pagination/pagination-view');\nvar paginationTemplate = require('./pagination.tpl');\n\n/**\n * View to render a searchable/pageable collection.\n * Also allows to filter/search list.\n *\n */\n\nvar REQUIRED_OPTS = [\n  'listCollection',\n  'createContentView'\n];\n\nvar ENTER_KEY_CODE = 13;\nvar ESCAPE_KEY_CODE = 27;\n\nmodule.exports = CoreView.extend({\n\n  events: {\n    'click .js-search-link': '_onSearchClick',\n    'click .js-clean-search': '_onCleanSearchClick',\n    'keydown .js-search-input': '_onKeyDown'\n  },\n\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (opts[item] === undefined) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n\n    this._paginationModel = new PaginationModel({\n      current_page: 1\n    });\n\n    this._paginationSearchModel = new PaginationSearchModel({}, {\n      collection: this._listCollection\n    });\n\n    this._stateModel = new Backbone.Model({\n      state: 'idle'\n    });\n\n    this._initBinds();\n    this._initPagination();\n    this._paginationSearchModel.fetch();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template({\n      q: this._paginationSearchModel.get('q')\n    }));\n    this._initViews();\n    return this;\n  },\n\n  _initBinds: function () {\n    this._paginationSearchModel.on('fetching', this.showLoading, this);\n    this._paginationSearchModel.on('fetched', this._updateStateFetched, this);\n    this._paginationSearchModel.on('error', this.showError, this);\n\n    this._paginationModel.bind('change:current_page', this._fetchByPagination, this);\n\n    this._stateModel.on('change:state', this.render, this);\n\n    this.add_related_model(this._paginationModel);\n    this.add_related_model(this._stateModel);\n    this.add_related_model(this._stateModel);\n  },\n\n  _fetchByPagination: function () {\n    this._paginationSearchModel.set('page', this._paginationModel.get('current_page'));\n    this._paginationSearchModel.fetch();\n  },\n\n  showError: function () {\n    this._stateModel.set('state', 'error');\n  },\n\n  showLoading: function () {\n    this._stateModel.set('state', 'loading');\n  },\n\n  _updateStateFetched: function () {\n    this._paginationModel.set({\n      per_page: this._paginationSearchModel.get('per_page'),\n      total_count: this._listCollection.totalCount()\n    });\n    if (this._listCollection.length > 0) {\n      this._stateModel.set('state', 'show');\n    } else {\n      this._stateModel.set('state', 'no-results');\n    }\n  },\n\n  _initPagination: function () {\n    this._paginationView = new PaginationView({\n      className: 'Pagination Pagination--search Pagination--searchShare',\n      model: this._paginationModel,\n      template: paginationTemplate\n    });\n    this.addView(this._paginationView);\n  },\n\n  _initViews: function () {\n    var state = this._stateModel.get('state');\n    var view;\n\n    this.$el.append(this._paginationView.render().el);\n\n    if (state === 'loading') {\n      this._content().html(renderLoading({\n        title: _t('components.pagination-search.loading.title')\n      }));\n    }\n\n    if (state === 'error') {\n      var errorView = new ErrorView({\n        title: _t('components.pagination-search.error.title'),\n        desc: _t('components.pagination-search.error.desc')\n      });\n      this._content().html(errorView.render().el);\n      this.addView(errorView);\n    }\n\n    if (state === 'show') {\n      view = this._createContentView({\n        hasOrganization: this._paginationSearchModel.get('q') === ''\n      });\n      this._content().html(view.render().el);\n      this.addView(view);\n    }\n\n    if (state === 'no-results') {\n      this._content().html(renderNoResults({\n        icon: 'CDB-IconFont-defaultUser',\n        title: _t('components.pagination-search.no-results.title'),\n        desc: _t('components.pagination-search.no-results.desc')\n      }));\n    }\n  },\n\n  _focusSearchInput: function () {\n    this._searchInput().focus().val();\n  },\n\n  _onSearchClick: function (e) {\n    this.killEvent(e);\n    this._searchInput().focus();\n  },\n\n  _onCleanSearchClick: function (e) {\n    this.killEvent(e);\n    this._cleanSearch();\n  },\n\n  _onKeyDown: function (e) {\n    if (e.which === ENTER_KEY_CODE) {\n      this.killEvent(e);\n      this._submitSearch();\n    } else if (e.which === ESCAPE_KEY_CODE) {\n      if (this._paginationSearchModel.get('q')) {\n        this.killEvent(e);\n        this._cleanSearch();\n      }\n    }\n  },\n\n  _submitSearch: function (e) {\n    this._makeNewSearch(Utils.stripHTML(this._searchInput().val().trim()));\n  },\n\n  _cleanSearch: function () {\n    this._searchInput().val('');\n    this._makeNewSearch('');\n  },\n\n  _makeNewSearch: function (query) {\n    this._paginationSearchModel.set({\n      q: query,\n      page: 1\n    });\n\n    this._paginationSearchModel.fetch();\n  },\n\n  _searchInput: function () {\n    return this.$('.js-search-input');\n  },\n\n  _cleanSearchBtn: function () {\n    return this.$('.js-clean-search');\n  },\n\n  _content: function () {\n    return this.$('.js-content');\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Filters is-relative\">\\n  <div class=\"Filters-inner\">\\n    <div class=\"Filters-row Share-filtersRow js-filters\">\\n      <div class=\"Filters-typeItem Filters-typeItem--searchEnabler\">\\n        <p class=\"Filters-searchLink js-search-link u-alignCenter CDB-Text CDB-Size-medium u-upperCase\">\\n          <i class=\"Filters-searchLinkIcon CDB-IconFont CDB-IconFont-lens u-rSpace--xl\"></i> '+\n((__t=( _t('components.pagination-search.filter.search') ))==null?'':_.escape(__t))+\n'\\n        </p>\\n      </div>\\n      <div class=\"Filters-typeItem Filters-typeItem--searchField\">\\n        <input class=\"Filters-searchInput CDB-Text CDB-Size-medium js-search-input\" type=\"text\" value=\"'+\n((__t=( q ))==null?'':_.escape(__t))+\n'\" placeholder=\"'+\n((__t=( _t('components.pagination-search.filter.placeholder') ))==null?'':_.escape(__t))+\n'\" />\\n        ';\n if (q !== '') { \n__p+='\\n        <button type=\"button\" class=\"CDB-Shape Filters-cleanSearch js-clean-search u-actionTextColor\">\\n          <div class=\"CDB-Shape-close is-blue is-large\"></div>\\n        </button>\\n        ';\n } \n__p+='\\n      </div>\\n    </div>\\n  </div>\\n</div>\\n<div class=\"js-content\"></div>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<span class=\"CDB-Text CDB-Size-medium u-altTextColor Pagination-label\">\\n  Page '+\n((__t=( currentPage ))==null?'':_.escape(__t))+\n' of '+\n((__t=( pagesCount ))==null?'':_.escape(__t))+\n'\\n</span>\\n<ul class=\"Pagination-list CDB-Text CDB-Size-medium\">\\n  ';\n m.pagesToDisplay().forEach(function(page) { \n__p+='\\n    ';\n if (page > 0) { \n__p+='\\n      <li class=\"Pagination-listItem '+\n((__t=( m.isCurrentPage(page) ? 'is-current' : '' ))==null?'':_.escape(__t))+\n'\">\\n        <button class=\"Pagination-listItemInner Pagination-listItemInner--link u-actionTextColor js-listItem\" data-page=\"'+\n((__t=( page ))==null?'':_.escape(__t))+\n'\">'+\n((__t=( page ))==null?'':_.escape(__t))+\n'</button>\\n      </li>\\n    ';\n } else { \n__p+='\\n      <li class=\"Pagination-listItem Pagination-listItem\">\\n        <span class=\"Pagination-listItemInner Pagination-listItemInner--more\">&hellip;</span>\\n      </li>\\n    ';\n } \n__p+='\\n  ';\n }) \n__p+='\\n</ul>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\n\n/**\n * View model intended to be responsible for pagination logic, and to be used in conjunction with a Pagination view.\n */\nmodule.exports = Backbone.Model.extend({\n  defaults: {\n    total_count: 0,\n    per_page: 10,\n    current_page: 1,\n    display_count: 5,\n    extras_display_count: 1,\n    url_to: undefined\n  },\n\n  pagesCount: function () {\n    return Math.max(\n      Math.ceil(\n        this.get('total_count') / this.get('per_page')\n      ), 1);\n  },\n\n  isCurrentPage: function (page) {\n    return this.get('current_page') === page;\n  },\n\n  shouldBeVisible: function () {\n    var pagesCount = this.pagesCount();\n    return this.get('total_count') > 0 && pagesCount > 1 && this.get('current_page') <= pagesCount;\n  },\n\n  urlTo: function (page) {\n    if (this.hasUrl()) {\n      return this.get('url_to')(page);\n    }\n  },\n\n  hasUrl: function () {\n    return typeof this.get('url_to') === 'function';\n  },\n\n  /**\n   * Get the pages that are expected to be displayed.\n   * The current page will be in the middle of the returned sequence.\n   *\n   * @returns {number[]} a sequence of Numbers\n   */\n  pagesToDisplay: function () {\n    var rangeStart;\n\n    if (this._inLowRange()) {\n      rangeStart = 1;\n    } else if (this._inHighRange()) {\n      rangeStart = this.get('current_page') - this._startOffset();\n    } else {\n      // Somewhere between the low and high boundary\n      rangeStart = this.pagesCount() - this.get('display_count') + 1;\n    }\n    rangeStart = Math.max(rangeStart, 1);\n\n    return this._withExtraPages(\n      _.range(rangeStart, this._rangeEnd(rangeStart))\n    );\n  },\n\n  _withExtraPages: function (pagesRelativeToCurrentPage) {\n    var lastPage = this.pagesCount();\n    var extraCount = this.get('extras_display_count');\n    var extraStartPages = _.range(1, extraCount + 1);\n    var extraEndPages = _.range(lastPage - extraCount + 1, lastPage + 1);\n\n    var startPagesDiff = pagesRelativeToCurrentPage[0] - extraStartPages.slice(-1)[0];\n    if (startPagesDiff === 2) {\n      // There is only one missing page in the gap, so add it\n      extraStartPages.push(pagesRelativeToCurrentPage[0] - 1);\n    } else if (startPagesDiff > 2) {\n      // There are more hidden pages at low range, add padding at end\n      extraStartPages.push(-1);\n    }\n\n    var endPagesDiff = extraEndPages[0] - pagesRelativeToCurrentPage.slice(-1);\n    if (endPagesDiff === 2) {\n      // There is only one missing page in the gap, so add it\n      extraEndPages.unshift(extraEndPages[0] - 1);\n    } if (endPagesDiff > 2) {\n      // There are more hidden pages at high range, add padding at beginning\n      extraEndPages.unshift(-2);\n    }\n\n    return _.union(extraStartPages, pagesRelativeToCurrentPage, extraEndPages);\n  },\n\n  _inLowRange: function () {\n    return this.get('current_page') < this._startOffset();\n  },\n\n  _inHighRange: function () {\n    return this.get('current_page') < this._highBoundary();\n  },\n\n  _highBoundary: function () {\n    return this.pagesCount() - this._startOffset();\n  },\n\n  _startOffset: function () {\n    return Math.floor(this.get('display_count') / 2);\n  },\n\n  _rangeEnd: function (rangeStart) {\n    // If we are too close to the range end then cap to the pages count.\n    return Math.min(rangeStart + this.get('display_count'), this.pagesCount() + 1);\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar $ = require('jquery');\nvar navigateThroughRouter = require('../../helpers/navigate-through-router');\nvar template = require('./pagination.tpl');\n\n/**\n * Responsible for pagination.\n *\n * Expected to be created with a pagination model, see the model for available params, here we create w/ the minimum:\n *   new PaginationView({\n *     model: new PaginationModel({\n *       // Compulsory:\n *       urlTo:  function(page) { return '/?page='+ page },\n\n         // Optional, to router clicks on <a> tags through router.navigate by default\n *       routerModel: new Router(...)\n *     })\n *   });\n */\nmodule.exports = CoreView.extend({\n  className: 'Pagination',\n\n  events: {\n    'click .js-listItem': '_paginate'\n  },\n\n  initialize: function (opts) {\n    this._routerModel = opts.routerModel; // Optional\n\n    if (this.router && !this.model.hasUrl()) {\n      throw new Error('since router is set the model must have a url method set too');\n    }\n\n    this.template = opts.template || template;\n    this.model.bind('change', this.render, this);\n  },\n\n  render: function () {\n    if (this.model.shouldBeVisible()) {\n      this.$el.html(\n        this.template({\n          m: this.model,\n          pagesCount: this.model.pagesCount(),\n          currentPage: this.model.get('current_page')\n        })\n      );\n      this.$el.addClass(this.className);\n      this.delegateEvents();\n    } else {\n      this.$el.html('');\n    }\n\n    return this;\n  },\n\n  _paginate: function (ev) {\n    if (this._routerModel) {\n      navigateThroughRouter.apply(this, arguments);\n    } else if (!this.model.hasUrl()) {\n      this.killEvent(ev);\n    }\n\n    var page = $(ev.target).data('page');\n    this.model.set('current_page', page);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<span class=\"CDB-Text CDB-Size-medium u-altTextColor Pagination-label\">\\n  Page '+\n((__t=( currentPage ))==null?'':_.escape(__t))+\n' of '+\n((__t=( pagesCount ))==null?'':_.escape(__t))+\n'\\n</span>\\n<ul class=\"Pagination-list CDB-Text CDB-Size-medium\">\\n  ';\n m.pagesToDisplay().forEach(function(page) { \n__p+='\\n    ';\n if (page > 0) { \n__p+='\\n      <li class=\"Pagination-listItem '+\n((__t=( m.isCurrentPage(page) ? 'is-current' : '' ))==null?'':_.escape(__t))+\n'\">\\n        <a class=\"Pagination-listItemInner Pagination-listItemInner--link js-listItem\" href=\"'+\n((__t=( m.urlTo(page) ))==null?'':_.escape(__t))+\n'\" data-page=\"'+\n((__t=( page ))==null?'':_.escape(__t))+\n'\">'+\n((__t=( page ))==null?'':_.escape(__t))+\n'</a>\\n      </li>\\n    ';\n } else { \n__p+='\\n      <li class=\"Pagination-listItem Pagination-listItem\">\\n        <span class=\"Pagination-listItemInner Pagination-listItemInner--more\">&hellip;</span>\\n      </li>\\n    ';\n } \n__p+='\\n  ';\n }) \n__p+='\\n</ul>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar $ = require('jquery');\n\nvar MutationObserver = window.MutationObserver;\n\nvar MARGINS = {\n  top: 8,\n  bottom: 8\n};\n\nvar initObserver = function (popup, onChangeMutation) {\n  var config = {\n    childList: true,\n    subtree: true\n  };\n\n  if (!MutationObserver) {\n    return;\n  }\n\n  var observer = new MutationObserver(onChangeMutation);\n  observer.observe(popup.get ? popup.get(0) : popup, config);\n  return observer;\n};\n\nvar initScroll = function (reference) {\n  return reference.closest('.js-perfect-scroll');\n};\n\nvar Manager = function (id, reference, popup) {\n  this.id = id;\n  this.reference = reference;\n  this.popup = popup;\n  this.state = {\n    position: 'bottom',\n    scroll: 0\n  };\n\n  // to capture click events and avoid close the dialog\n  popup.attr('data-cid', id);\n  popup.attr('data-dialog', id);\n};\n\nManager.prototype = {\n  append: function (mode) {\n    this.mode = mode;\n    var popup = this.popup.get(0);\n    var ref = this.reference.get(0);\n    if (mode === 'float') {\n      document.body.appendChild(popup);\n    } else {\n      ref.appendChild(popup);\n    }\n  },\n\n  track: function () {\n    if (this.mode !== 'float') {\n      return;\n    }\n\n    // we need to watch when the dialog's height changes in order to reposition it again\n    this.observer = initObserver(this.popup, this.onChangeMutation.bind(this));\n    this.emitter = initScroll(this.reference);\n    this.repositionBinded = _.throttle(this.reposition.bind(this), 15);\n\n    if (this.emitter) {\n      this.emitter\n        .on('ps-scroll-x', this.repositionBinded)\n        .on('ps-scroll-y', this.repositionBinded);\n    }\n\n    this.reposition();\n  },\n\n  onChangeMutation: function (mutations) {\n    _.each(mutations, function (mutation) {\n      var target = $(mutation.target);\n      var id = target.attr('data-cid');\n\n      if (!id) {\n        id = target.closest('[data-cid]').attr('data-cid');\n      }\n\n      if (id === this.id) {\n        this.repositionBinded();\n      }\n    }, this);\n  },\n\n  reposition: function () {\n    if (this.mode !== 'float' || !this.emitter) {\n      return;\n    }\n\n    var scroll = this.emitter.get(0).scrollTop;\n\n    var dh = $(window).height();\n    var ref = this.reference;\n    var popup = this.popup;\n    var state = this.state;\n\n    var refPosition = ref.offset();\n    var ph = popup.outerHeight();\n\n    var onBottom = refPosition.top + ref.outerHeight() + MARGINS.top;\n    var onTop = refPosition.top - ph - MARGINS.bottom;\n    var top;\n\n    // If this condition matches, the dialog has changed its size\n    if (state.scroll === scroll) {\n      // We maintain position unless there is no space\n      if (state.position === 'top') {\n        if (onTop <= 0) {\n          top = onBottom;\n          state.position = 'bottom';\n        } else {\n          top = onTop;\n        }\n      } else {\n        if (onBottom + ph + MARGINS.bottom >= dh) {\n          top = onTop;\n          state.position = 'top';\n        } else {\n          top = onBottom;\n        }\n      }\n    } else {\n      if (onBottom + ph + MARGINS.bottom >= dh) {\n        top = onTop;\n        state.position = 'top';\n      } else {\n        top = onBottom;\n        state.position = 'bottom';\n      }\n    }\n\n    // Boundries come from document height to avoid scroll\n    if (top < 0) {\n      top = MARGINS.top;\n    } else {\n      top = Math.min(top, dh - ph - MARGINS.bottom);\n    }\n\n    popup.css({\n      top: top,\n      left: refPosition.left\n    });\n\n    state.scroll = scroll;\n  },\n\n  untrack: function () {\n    this.observer && this.observer.disconnect();\n    if (this.emitter) {\n      this.emitter\n        .off('ps-scroll-x', this.repositionBinded)\n        .off('ps-scroll-y', this.repositionBinded);\n    }\n  },\n\n  destroy: function () {\n    this.untrack();\n\n    var el = document.querySelector('[data-dialog=' + this.id + ']');\n    if (el) {\n      el.parentNode.removeChild(el);\n    }\n\n    this.emitter = null;\n    this.reference = null;\n    this.popup = null;\n  }\n};\n\nmodule.exports = Manager;\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./password-dialog.tpl');\nvar _ = require('underscore');\n\nvar REQUIRED_OPTS = [\n  'onBack',\n  'onEdit'\n];\n\nvar ESCAPE_KEY_CODE = 27;\nvar ENTER_KEY_CODE = 13;\n\nmodule.exports = CoreView.extend({\n  className: 'Editor-boxModal Editor-PrivacyDialog',\n\n  events: {\n    'click .js-back': '_onClickBack',\n    'keyup .js-input': '_onKeyUpInput'\n  },\n\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (opts[item] === undefined) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n  },\n\n  render: function () {\n    this.$el.empty();\n    this.$el.html(template());\n    return this;\n  },\n\n  _onKeyUpInput: function (e) {\n    if (e.which === ESCAPE_KEY_CODE) {\n      this._onBack();\n    }\n\n    if (e.which === ENTER_KEY_CODE) {\n      this._onEdit && this._onEdit(this.getValue());\n    }\n  },\n\n  _onClickBack: function () {\n    this._onBack();\n  },\n\n  getValue: function () {\n    return this.$('.js-input').val();\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CDB-Box-modalHeader\">\\n  <ul class=\"CDB-Box-modalHeaderItem CDB-Box-modalHeaderItem--block CDB-Box-modalHeaderItem--paddingHorizontal\">\\n    <li class=\"CDB-ListDecoration-item CDB-ListDecoration-itemPadding--vertical\">\\n      <button class=\"u-actionTextColor js-back CDB-Size-medium u-rSpace\">\\n        <i class=\"CDB-IconFont CDB-IconFont-arrowPrev\"></i>\\n      </button>\\n      <span class=\"CDB-Text CDB-Size-medium\">\\n        '+\n((__t=( _t('components.modals.publish.privacy.password.title') ))==null?'':_.escape(__t))+\n'\\n      </span>\\n    </li>\\n  </ul>\\n</div>\\n<ul class=\"CustomList-list js-customList\">\\n  <li class=\"Privacy-passwordField CustomList-item\">\\n    <input type=\"password\" class=\"CDB-Text CDB-InputText js-input\" placeholder=\"'+\n((__t=( _t('components.modals.publish.privacy.password.placeholder') ))==null?'':_.escape(__t))+\n'\">\\n  </li>\\n</ul>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Privacy-cta u-flex\">\\n  <svg width=\"16px\" height=\"16px\" viewBox=\"0 0 16 16\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n    <g id=\"Page-1\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\\n      <path d=\"M10.0946667,4.4109223 C10.8886667,4.1368747 11.6846667,3.80147316 12.0073333,3.4715253 C12.7866667,2.67392407 12.7866667,1.37662907 12.0073333,0.579027844 C11.2513333,-0.193350099 9.934,-0.192668389 9.17866667,0.579027844 C8.74133333,1.0262299 8.29266667,2.36033726 8,3.37608583 C7.70666667,2.36033726 7.25866667,1.0262299 6.82133333,0.579027844 C6.066,-0.193350099 4.748,-0.192668389 3.99266667,0.579027844 C3.21266667,1.37662907 3.21266667,2.67392407 3.99266667,3.4715253 C4.316,3.80147316 5.11133333,4.1368747 5.90533333,4.4109223 L0.333333333,4.4109223 C0.149333333,4.4109223 0,4.56362544 0,4.75177753 L0,7.47861934 C0,7.66677142 0.149333333,7.81947456 0.333333333,7.81947456 L0.666666667,7.81947456 L0.666666667,15.6591448 C0.666666667,15.8472969 0.816,16 1,16 L15,16 C15.184,16 15.3333333,15.8472969 15.3333333,15.6591448 L15.3333333,7.81947456 L15.6666667,7.81947456 C15.8506667,7.81947456 16,7.66677142 16,7.47861934 L16,4.75177753 C16,4.56362544 15.8506667,4.4109223 15.6666667,4.4109223 L10.0946667,4.4109223 Z M6,6.95652174 L6,4.86956522 L10,4.86956522 L10,6.95652174 L6,6.95652174 L6,6.95652174 Z M10,7.65217391 L10,15.3043478 L6,15.3043478 L6,7.65217391 L10,7.65217391 L10,7.65217391 Z M9.80833133,1.08822938 C10.0510474,0.834996985 10.3727426,0.695652174 10.7169115,0.695652174 C11.0597961,0.695652174 11.3821334,0.834996985 11.6248495,1.08755946 C12.1250502,1.6101025 12.1250502,2.46023983 11.6248495,2.98278288 C11.2729754,3.34990286 9.79227867,3.85636766 8.66666667,4.17391304 C8.97102496,2.99953105 9.45581507,1.45534937 9.80833133,1.08822938 L9.80833133,1.08822938 Z M4.37515049,1.08822938 C4.6178666,0.834996985 4.94020387,0.695652174 5.28373064,0.695652174 C5.6266153,0.695652174 5.94895256,0.834996985 6.19166867,1.08755946 C6.54354282,1.45467944 7.02833293,2.99886112 7.33333333,4.17391304 C6.20707922,3.85569773 4.72638253,3.34990286 4.37515049,2.98278288 C3.87494984,2.46090976 3.87494984,1.61077243 4.37515049,1.08822938 L4.37515049,1.08822938 Z M0.666666667,4.86956522 L5.33333333,4.86956522 L5.33333333,6.95652174 L1,6.95652174 L0.666666667,6.95652174 L0.666666667,4.86956522 L0.666666667,4.86956522 Z M1.33333333,7.65217391 L5.33333333,7.65217391 L5.33333333,15.3043478 L1.33333333,15.3043478 L1.33333333,7.65217391 L1.33333333,7.65217391 Z M14.6666667,15.3043478 L10.6666667,15.3043478 L10.6666667,7.65217391 L14.6666667,7.65217391 L14.6666667,15.3043478 L14.6666667,15.3043478 Z M15.3333333,6.95652174 L15,6.95652174 L10.6666667,6.95652174 L10.6666667,4.86956522 L15.3333333,4.86956522 L15.3333333,6.95652174 L15.3333333,6.95652174 Z\" id=\"Shape\" fill=\"#9BC63B\"></path>\\n    </g>\\n  </svg>\\n  <div class=\"CDB-Text CDB-Size CDB-Size-small u-lSpace--xl\">\\n    <h3 class=\"u-secondaryTextColor\">'+\n((__t=( _t('components.modals.publish.privacy.cta.title') ))==null?'':_.escape(__t))+\n'</h3>\\n    <a href=\"'+\n((__t=( upgradeURL ))==null?'':_.escape(__t))+\n'\">\\n      '+\n((__t=( _t( 'components.modals.publish.privacy.cta.desc-' + (showTrial ? 'trial' : 'notrial') ) ))==null?'':_.escape(__t))+\n'\\n    </a>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar CustomListView = require('../custom-list/custom-list-view');\nvar CustomListItemView = require('../custom-list/custom-list-item-view');\nvar privacyCTATemplate = require('./privacy-cta.tpl');\nvar _ = require('underscore');\n\nvar REQUIRED_OPTS = [\n  'model',\n  'collection',\n  'userModel',\n  'configModel'\n];\n\nmodule.exports = CoreView.extend({\n  className: 'Editor-boxModal Privacy-dialog',\n\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (opts[item] === undefined) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n  },\n\n  render: function () {\n    this.$el.empty();\n    this.clearSubViews();\n    this._renderList();\n    return this;\n  },\n\n  _renderList: function () {\n    var disabledOptions = this._collection.where({ disabled: true });\n    var customInstall = this._configModel.get('cartodb_com_hosted');\n    var upgradeURL = this._configModel.get('upgrade_url');\n\n    var listView = new CustomListView({\n      model: this._model,\n      collection: this._collection,\n      ItemView: CustomListItemView\n    });\n    this.$el.append(listView.render().el);\n    this.addView(listView);\n\n    if (disabledOptions.length > 0 && !customInstall && upgradeURL) {\n      this.$el.append(\n        privacyCTATemplate({\n          upgradeURL: upgradeURL,\n          showTrial: this._userModel.canStartTrial()\n        })\n      );\n    }\n  }\n});\n",
    "var $ = require('jquery');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar PrivacyDialogView = require('./privacy-dialog-view');\nvar PasswordDialogView = require('./password-dialog-view');\nvar TabPaneView = require('../tab-pane/tab-pane-view');\nvar TabPaneCollection = require('../tab-pane/tab-pane-collection');\nvar CustomListCollection = require('../custom-list/custom-list-collection');\nvar template = require('./privacy-dropdown.tpl');\nvar templateTabPane = require('./tab-pane.tpl');\n\nvar _ = require('underscore');\n\nvar ESCAPE_KEY_CODE = 27;\n\nvar REQUIRED_OPTS = [\n  'visDefinitionModel',\n  'userModel',\n  'privacyCollection',\n  'configModel'\n];\n\nvar PRIVACY_MAP = {\n  public: 'green',\n  link: 'orange',\n  password: 'orange-dark',\n  private: 'red'\n};\n\nmodule.exports = CoreView.extend({\n\n  events: {\n    'click .js-toggle': '_onToggleDialogClicked'\n  },\n\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (!opts[item]) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n\n    this._triggerElementID = 'toggle' + this.cid;\n\n    this.model = new Backbone.Model({\n      privacy: opts.visDefinitionModel.get('privacy'),\n      state: 'show'\n    });\n\n    this._onEscapePressed = this._onEscapePressed.bind(this);\n    this._onDocumentElementClicked = this._onDocumentElementClicked.bind(this);\n\n    this._configPrivacyCollection();\n    this._configPanes();\n    this._initBinds();\n  },\n\n  render: function () {\n    var privacy = this.model.get('privacy');\n    var cssClass = PRIVACY_MAP[privacy.toLowerCase()];\n\n    this.clearSubViews();\n    this._hideDialog();\n    this.$el.html(template({\n      privacy: privacy,\n      cssClass: cssClass,\n      isLoading: this.model.get('state') === 'loading'\n    }));\n    this._initViews();\n    return this;\n  },\n\n  _initBinds: function () {\n    this._customCollection.on('change:selected', function (menuItem) {\n      if (menuItem.get('disabled')) {\n        return;\n      }\n\n      if (menuItem.get('val') === 'password') {\n        this._showPasswordDialog();\n      } else {\n        this._onToggleDialogClicked();\n        this._setPrivacy(menuItem.get('val'));\n      }\n    }, this);\n\n    this.add_related_model(this._customCollection);\n\n    this.model.on('change:privacy', this._savePrivacy, this);\n    this.model.on('change:state', this.render, this);\n    this.add_related_model(this.model); // explicit\n  },\n\n  _makePrivacyDialog: function () {\n    return new PrivacyDialogView({\n      model: this.model,\n      collection: this._customCollection,\n      userModel: this._userModel,\n      configModel: this._configModel\n    });\n  },\n\n  _makePasswordDialog: function () {\n    return new PasswordDialogView({\n      onBack: this._showPrivacyDialog.bind(this),\n      onEdit: this._setPassword.bind(this)\n    });\n  },\n\n  _setPrivacy: function (privacy) {\n    this.model.set({privacy: privacy});\n  },\n\n  _setPassword: function (password) {\n    if (password !== '') {\n      this._privacyCollection.passwordOption().set({\n        password: password\n      });\n\n      this.model.set({\n        privacy: 'password',\n        password: password\n      });\n    }\n  },\n\n  _savePrivacy: function () {\n    var self = this;\n    var privacy = this.model.get('privacy').toUpperCase();\n    var vis = this._visDefinitionModel;\n    this.model.set({state: 'loading'});\n    this._privacyCollection.searchByPrivacy(privacy).saveToVis(vis, {\n      success: function () {\n        self.model.set({state: 'show'});\n      },\n      error: function () {\n        self.model.set({state: 'error'});\n      }\n    });\n  },\n\n  _transformPrivacyOptions: function () {\n    return this._privacyCollection.map(function (item) {\n      return {\n        label: item.get('title'),\n        val: item.get('privacy').toLowerCase(),\n        disabled: item.get('disabled'),\n        selected: item.get('selected'),\n        renderOptions: {\n          cssClass: item.get('cssClass')\n        }\n      };\n    }).filter(Boolean);\n  },\n\n  _configPrivacyCollection: function () {\n    var models = this._transformPrivacyOptions();\n    this._customCollection = new CustomListCollection(models);\n  },\n\n  _configPanes: function () {\n    var self = this;\n    var tabPaneTabs = [{\n      createContentView: self._showNoneDialog\n    }, {\n      createContentView: self._makePrivacyDialog.bind(self)\n    }, {\n      createContentView: self._makePasswordDialog.bind(self)\n    }];\n\n    this._collectionPane = new TabPaneCollection(tabPaneTabs);\n  },\n\n  _showNoneDialog: function () {\n    return false;\n  },\n\n  _showPasswordDialog: function () {\n    this._collectionPane.at(2).set({selected: true});\n  },\n\n  _showPrivacyDialog: function () {\n    this._customCollection.each(function (m) {\n      m.set({selected: false}, {silent: true});\n    });\n\n    this._collectionPane.at(1).set({selected: true});\n  },\n\n  _onToggleDialogClicked: function () {\n    if (this._isDialogVisible()) {\n      this._hideDialog();\n    } else {\n      this._initDocumentBinds();\n      this._showPrivacyDialog();\n    }\n  },\n\n  _isDialogVisible: function () {\n    return this._collectionPane.at(0).get('selected') === false;\n  },\n\n  _hideDialog: function () {\n    this._destroyDocumentBinds();\n    this._collectionPane.at(0).set({selected: true});\n  },\n\n  _showDialog: function () {\n    this._showPrivacyDialog();\n  },\n\n  _initViews: function () {\n    var view = new TabPaneView({\n      collection: this._collectionPane,\n      template: templateTabPane\n    });\n    this.$('.js-dialog').append(view.render().$el);\n    this.addView(view);\n  },\n\n  _initDocumentBinds: function () {\n    $(document).on('keydown', this._onEscapePressed);\n    $(document).on('mousedown', this._onDocumentElementClicked);\n  },\n\n  _destroyDocumentBinds: function () {\n    $(document).off('keydown', this._onEscapePressed);\n    $(document).off('mousedown', this._onDocumentElementClicked);\n  },\n\n  _onEscapePressed: function (ev) {\n    if (ev.which === ESCAPE_KEY_CODE) {\n      this._hideDialog();\n    }\n  },\n\n  _onDocumentElementClicked: function (ev) {\n    var $el = $(ev.target);\n    if ($el.closest(this.$el).length === 0 && $el.closest($('#' + this._triggerElementID)).length === 0) {\n      this._hideDialog();\n    }\n  },\n\n  clean: function () {\n    this._destroyDocumentBinds();\n    CoreView.prototype.clean.apply(this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Privacy-dropdown\">\\n  <button class=\"Privacy-dropdownTrigger Tag Tag-fill Tag-fill--'+\n((__t=( cssClass ))==null?'':_.escape(__t))+\n' CDB-Text CDB-Size-small u-upperCase js-toggle\">\\n    ';\n if (isLoading) { \n__p+='\\n      <div class=\"CDB-LoaderIcon CDB-LoaderIcon--small u-flex\">\\n        <svg class=\"CDB-LoaderIcon-spinner\" viewBox=\"0 0 50 50\">\\n          <circle class=\"CDB-LoaderIcon-path\" cx=\"25\" cy=\"25\" r=\"20\" fill=\"none\"></circle>\\n        </svg>\\n      </div>\\n    ';\n } else { \n__p+='\\n      '+\n((__t=( privacy ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n  </button>\\n\\n  <div class=\"js-dialog\"></div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Tab-paneContent js-content\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar Ps = require('perfect-scrollbar');\nvar template = require('./scroll.tpl');\nvar MutationObserver = window.MutationObserver;\n\nmodule.exports = CoreView.extend({\n  tagName: 'div',\n  className: 'ScrollView',\n\n  initialize: function (opts) {\n    if (!opts.createContentView) throw new Error('A factory createContentView function is required');\n    this.options = opts || {};\n    this._type = opts.type || 'vertical'; // vertical or horizontal\n    this._maxScroll = 0;\n    this._bindedCheckShadows = this._checkShadows.bind(this);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this._html();\n\n    var view = this.options.createContentView.call(this);\n    this._contentContainer().append(view.render().el);\n    this.addView(view);\n    this._applyScroll();\n    this._updateScrollWhenExist();\n    return this;\n  },\n\n  _html: function () {\n    this.$el.html(template({\n      type: this._type\n    }));\n\n    (this._type === 'horizontal') && this.$el.addClass('ScrollView--horizontal');\n  },\n\n  _contentContainer: function () {\n    return this.$('.js-content');\n  },\n\n  _wrapperContainer: function () {\n    return this.$('.js-wrapper');\n  },\n\n  _updateScrollWhenExist: function () {\n    // Phantom doesn't provide this api for window.\n    if (!MutationObserver) return;\n\n    // even with the changes in PS, we need to check when this element is added to the dom\n    // in order to trigger manually an update.\n    var element = document.body;\n    var self = this._wrapperContainer().get(0);\n    var onMutationObserver = function () {\n      if (element.contains(self)) {\n        Ps.update(self);\n        observer.disconnect();\n      }\n    };\n\n    var observer = new MutationObserver(onMutationObserver);\n    onMutationObserver();\n\n    var config = { subtree: true, childList: true };\n    observer.observe(element, config);\n  },\n\n  _applyScroll: function () {\n    Ps.initialize(this._wrapperContainer().get(0), {\n      wheelSpeed: 2,\n      wheelPropagation: true,\n      stopPropagationOnClick: false,\n      minScrollbarLength: 20,\n      suppressScrollX: this._type === 'vertical',\n      suppressScrollY: this._type === 'horizontal'\n    });\n\n    this._bindScroll();\n  },\n\n  _bindScroll: function () {\n    this._wrapperContainer()\n      .on('ps-dom-change', this._bindedCheckShadows)\n      .on('ps-x-reach-start', this._bindedCheckShadows)\n      .on('ps-x-reach-end', this._bindedCheckShadows)\n      .on('ps-y-reach-start', this._bindedCheckShadows)\n      .on('ps-y-reach-end', this._bindedCheckShadows)\n      .on('ps-scroll-x', this._bindedCheckShadows)\n      .on('ps-scroll-y', this._bindedCheckShadows);\n  },\n\n  _unbindScroll: function () {\n    this._wrapperContainer()\n      .off('ps-dom-change', this._bindedCheckShadows)\n      .off('ps-x-reach-start', this._bindedCheckShadows)\n      .off('ps-x-reach-end', this._bindedCheckShadows)\n      .off('ps-y-reach-start', this._bindedCheckShadows)\n      .off('ps-y-reach-end', this._bindedCheckShadows)\n      .off('ps-scroll-x', this._bindedCheckShadows)\n      .off('ps-scroll-y', this._bindedCheckShadows);\n  },\n\n  _checkShadows: function () {\n    var currentPos;\n    var max;\n    var width;\n    var height;\n    var maxPos;\n\n    if (this._type === 'horizontal') {\n      currentPos = this._wrapperContainer().scrollLeft();\n      max = this._wrapperContainer().get(0).scrollWidth;\n      width = this._wrapperContainer().outerWidth();\n      maxPos = max - width;\n\n      this.$('> .js-leftShadow').toggleClass('is-visible', currentPos > 0);\n      this.$('> .js-rightShadow').toggleClass('is-visible', currentPos < maxPos);\n    } else {\n      currentPos = this._wrapperContainer().scrollTop();\n      max = this._wrapperContainer().get(0).scrollHeight;\n      height = this._wrapperContainer().outerHeight();\n      maxPos = max - height;\n\n      // We use the direct descendant selector to avoid affect others nested view with scroll\n      this.$('> .js-topShadow').toggleClass('is-visible', currentPos > 0);\n      this.$('> .js-bottomShadow').toggleClass('is-visible', currentPos < maxPos);\n    }\n  },\n\n  destroyScroll: function () {\n    this._unbindScroll();\n    Ps.destroy(this._wrapperContainer().get(0));\n  },\n\n  clean: function () {\n    this.destroyScroll();\n    CoreView.prototype.clean.apply(this, arguments);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='';\n if (type === 'vertical') { \n__p+='\\n<div class=\"ScrollView-shadow ScrollView-shadow--top js-topShadow\"></div>\\n<div class=\"ScrollView-shadow ScrollView-shadow--bottom js-bottomShadow\"></div>\\n';\n } else { \n__p+='\\n<div class=\"Carousel-shadow Carousel-shadow--left js-leftShadow\"></div>\\n<div class=\"Carousel-shadow Carousel-shadow--right js-rightShadow\"></div>\\n';\n } \n__p+='\\n<div class=\"ScrollView-wrapper js-wrapper js-perfect-scroll\">\\n  <div class=\"ScrollView-content js-content\"></div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\n\n/**\n *  Stack layout model checks and decides if next or previous\n *  positions are possible.\n */\n\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    position: 0\n  },\n\n  initialize: function (attrs, opts) {\n    this.stackLayoutItems = opts.stackLayoutItems;\n  },\n\n  goToStep: function (position) {\n    var stackLayoutItemsSize = this.stackLayoutItems.size();\n\n    if (position >= stackLayoutItemsSize) {\n      throw new Error('There is no ' + position + ' stack view in the collection');\n    } else {\n      this.set({\n        position: position\n      }, {\n        silent: true\n      });\n      this._rememberStep.apply(this, arguments);\n      this._triggerPositionChanged(position, Array.prototype.slice.call(arguments, 1));\n    }\n  },\n\n  nextStep: function () {\n    var currentPos = this.get('position');\n    var nextPosition = ++currentPos;\n    this.goToStep.apply(this, Array.prototype.concat.apply([nextPosition], arguments));\n  },\n\n  prevStep: function () {\n    var currentPos = this.get('position');\n    var prevPosition = --currentPos;\n    this.goToStep.apply(this, Array.prototype.concat.apply([prevPosition], arguments));\n  },\n\n  goBack: function () {\n    if (this._goBackToArguments) {\n      this.goToStep.apply(this, this._goBackToArguments);\n    }\n  },\n\n  _triggerPositionChanged: function (position, args) {\n    this.trigger('positionChanged', position, Array.prototype.slice.call(args));\n  },\n\n  _rememberStep: function () {\n    this._goBackToArguments = this._lastStepArguments || [ 0 ];\n    this._lastStepArguments = arguments;\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar StackLayoutModel = require('./stack-layout-model');\nvar _ = require('underscore');\n\n/**\n *  Stack layout view manages a \"carousel\" of views.\n *  They can go forward or backward.\n */\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    if (!this.collection || !this.collection.size()) {\n      throw new Error('A collection of stack views should be provided');\n    }\n    this.model = new StackLayoutModel({}, {\n      stackLayoutItems: this.collection\n    });\n    this.model.bind('positionChanged', this._onPositionChange, this);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this._genNewStackView();\n    return this;\n  },\n\n  _onPositionChange: function (newPos, opts) {\n    this._removeOldStackView();\n    this._genNewStackView(_.flatten(opts));\n    this.trigger('positionChanged', this);\n  },\n\n  getCurrentPosition: function () {\n    return this.model.get('position');\n  },\n\n  _removeOldStackView: function () {\n    var oldView = this._getCurrentView();\n    if (oldView) {\n      oldView.clean();\n      this.removeView(oldView);\n    }\n  },\n\n  _getCurrentView: function () {\n    for (var key in this._subviews) break;\n    return this._subviews[key];\n  },\n\n  _genNewStackView: function () {\n    var args = [this.model].concat([_.flatten(arguments)]);\n    var nextView = this.collection.at(this.model.get('position')).get('createStackView').apply(this, args);\n    this.$el.html(nextView.render().el);\n\n    this.addView(nextView);\n  }\n});\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar TabPaneView = require('./tab-pane-view.js');\nvar TabPaneCollection = require('./tab-pane-collection');\nvar IconView = require('./tab-pane-icon-view');\n\n/**\n * Creates a tab pane representing editor's left-vertical menu, where the tab items are large icons,\n * and the content on the right.\n *\n * Example usage:\n * {\n *   icon: 'my-icon',\n *   createContentView: CoreView(),\n *   selected: false\n * }\n * @param {Array} paneItems\n * @param {Object} options\n * @return {Object} instance of a Backbone view\n */\nmodule.exports = function (paneItems, options) {\n  options = options || {};\n  var tabPaneItemIconOptions = options.tabPaneItemIconOptions;\n\n  var items = paneItems.map(function (paneItem) {\n    ['icon', 'createContentView'].forEach(function (check) {\n      if (!paneItem[check]) {\n        throw new Error(check + ' should be provided');\n      }\n    });\n\n    return {\n      selected: paneItem.selected,\n      icon: paneItem.icon,\n      createButtonView: function () {\n        return new IconView(_.extend({ model: this }, tabPaneItemIconOptions));\n      },\n      createContentView: function () {\n        return paneItem.createContentView && paneItem.createContentView() || new CoreView();\n      }\n    };\n  });\n\n  var collection = new TabPaneCollection(items);\n  var tabPaneOptions = options.tabPaneOptions;\n\n  return new TabPaneView(\n    _.extend(\n      { collection: collection },\n      tabPaneOptions\n    )\n  );\n};\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar TabPaneView = require('./tab-pane-view.js');\nvar TabPaneCollection = require('./tab-pane-collection');\nvar MixedLabelView = require('./tab-pane-mixed-view');\nvar ColorView = require('./tab-pane-color-view');\n\n/**\n * Creates a tab pane, where the menu consists of text labels.\n *\n * Example usage:\n * {\n *   label: 'My label',\n *   createContentView: CoreView(),\n *   selected: false\n * }\n *\n * @param {Array} paneItems\n * @param {Object} options\n * @return {Object} instance of CoreView\n */\nmodule.exports = function (paneItems, options) {\n  options = options || {};\n  var tabPaneItemLabelOptions = options.tabPaneItemLabelOptions;\n\n  var items = paneItems.map(function (paneItem) {\n    ['label', 'createContentView'].forEach(function (check) {\n      if (!paneItem[check]) {\n        throw new Error(check + ' should be provided');\n      }\n    });\n\n    return {\n      name: paneItem.name,\n      selected: paneItem.selected,\n      label: paneItem.label,\n      color: paneItem.color,\n      kind: paneItem.kind,\n      selectedChild: paneItem.selectedChild,\n      createButtonView: function () {\n        if (paneItem.type === 'color') {\n          return new ColorView(_.extend({ model: this }, tabPaneItemLabelOptions));\n        } else {\n          return new MixedLabelView(_.extend({ model: this, type: paneItem.type }, tabPaneItemLabelOptions));\n        }\n      },\n      createContentView: function () {\n        return paneItem.createContentView && paneItem.createContentView() || new CoreView();\n      }\n    };\n  });\n\n  this.collection = new TabPaneCollection(items);\n\n  var tabPaneOptions = options.tabPaneOptions;\n\n  return new TabPaneView(\n    _.extend(\n      { collection: this.collection },\n      tabPaneOptions\n    )\n  );\n};\n",
    "var _ = require('underscore');\nvar cdb = require('cartodb.js');\nvar TabPaneView = require('./tab-pane-view.js');\nvar TabPaneCollection = require('./tab-pane-collection');\nvar TemplateView = require('./tab-pane-template-view');\n\n/**\n * Creates a tab pane, where the menu consists of text labels.\n *\n * Example usage:\n * {\n *   label: 'My label',\n *   createContentView: cdb.core.View(),\n *   selected: false\n * }\n *\n * @param {Array} paneItems\n * @param {Object} options\n * @return {Object} instance of cdb.core.View\n */\nmodule.exports = function (paneItems, options) {\n  options = options || {};\n  var tabPaneTemplateOptions = options.tabPaneTemplateOptions;\n\n  var items = paneItems.map(function (paneItem) {\n    ['label', 'name', 'createContentView'].forEach(function (check) {\n      if (!paneItem[check]) {\n        throw new Error(check + ' should be provided');\n      }\n    });\n\n    return {\n      name: paneItem.name,\n      selected: paneItem.selected,\n      label: paneItem.label,\n      createButtonView: function () {\n        return new TemplateView(_.extend({ model: this }, tabPaneTemplateOptions));\n      },\n      createContentView: function () {\n        return paneItem.createContentView && paneItem.createContentView() || new cdb.core.View();\n      }\n    };\n  });\n\n  var collection = new TabPaneCollection(items);\n\n  var tabPaneOptions = options.tabPaneOptions;\n\n  return new TabPaneView(\n    _.extend(\n      { collection: collection },\n      tabPaneOptions\n    )\n  );\n};\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar TabPaneView = require('./tab-pane-view.js');\nvar TabPaneCollection = require('./tab-pane-collection');\nvar LabelView = require('./tab-pane-label-view');\n\n/**\n * Creates a tab pane, where the menu consists of text labels.\n *\n * Example usage:\n * {\n *   label: 'My label',\n *   createContentView: CoreView(),\n *   selected: false\n * }\n *\n * @param {Array} paneItems\n * @param {Object} options\n * @return {Object} instance of CoreView\n */\nmodule.exports = function (paneItems, options) {\n  options = options || {};\n  var tabPaneItemLabelOptions = options.tabPaneItemLabelOptions;\n\n  var items = paneItems.map(function (paneItem) {\n    ['label', 'createContentView'].forEach(function (check) {\n      if (!paneItem[check]) {\n        throw new Error(check + ' should be provided');\n      }\n    });\n\n    return {\n      name: paneItem.name,\n      selected: paneItem.selected,\n      label: paneItem.label,\n      selectedChild: paneItem.selectedChild,\n      createButtonView: function () {\n        return new LabelView(_.extend({ model: this }, tabPaneItemLabelOptions));\n      },\n      createContentView: function () {\n        return paneItem.createContentView && paneItem.createContentView() || new CoreView();\n      }\n    };\n  });\n\n  this.collection = new TabPaneCollection(items);\n\n  var tabPaneOptions = options.tabPaneOptions;\n\n  return new TabPaneView(\n    _.extend(\n      { collection: this.collection },\n      tabPaneOptions\n    )\n  );\n};\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\n\nmodule.exports = Backbone.Collection.extend({\n  constructor: function (models, options) {\n    options = _.extend(options || {}, { silent: false });\n    Backbone.Collection.prototype.constructor.call(this, models, options);\n  },\n\n  initialize: function () {\n    this.bind('reset', this._setSelected, this);\n    this.bind('change:selected', this._onSelectedChange, this);\n    this._setSelected();\n  },\n\n  getSelected: function () {\n    return this.find(function (model) {\n      return model.get('selected');\n    });\n  },\n\n  _setSelected: function () {\n    var isSelected = this.getSelected();\n\n    if (!isSelected && this.size() > 0) {\n      this.at(0).set('selected', true);\n    }\n  },\n\n  _onSelectedChange: function (itemModel, isSelected) {\n    if (!isSelected) {\n      return;\n    }\n\n    this.each(function (model) {\n      if (model !== itemModel) {\n        model.set('selected', false);\n      }\n    }, this);\n  },\n\n  select: function (name, value) {\n    var model = this.find(function (m) {\n      return m.get(name) === value;\n    }, this);\n\n    if (model) {\n      model.set('selected', true);\n    }\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./tab-pane-color.tpl');\n\n/**\n *  Label component\n */\n\nmodule.exports = CoreView.extend({\n  className: 'Label',\n\n  initialize: function () {\n    if (!this.model) {\n      throw new Error('A model should be provided');\n    }\n    this.model.bind('change:label', this.render, this);\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    this.$el.html(template({\n      color: this.model.get('label'),\n      selectedChild: this.model.get('selectedChild') || ''\n    }));\n    return this;\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"ColorBar ColorBar--inline\" style=\"background-color: '+\n((__t=( color ))==null?'':_.escape(__t))+\n';\"></div> ';\n if (selectedChild) { \n__p+=' <span class=\"CDB-NavSubmenu-status js-NavSubmenu-status u-hintTextColor\">'+\n((__t=( selectedChild ))==null?'':_.escape(__t))+\n'</span>';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='';\n if (type === 'text') { \n__p+='\\n'+\n((__t=( label ))==null?'':_.escape(__t))+\n'';\n if (selectedChild) { \n__p+=' <span class=\"CDB-NavSubmenu-status js-NavSubmenu-status u-hintTextColor\">'+\n((__t=( selectedChild ))==null?'':_.escape(__t))+\n'</span>';\n } \n__p+='\\n';\n } else if (kind === 'custom-marker') { \n__p+='\\n<div class=\\'Editor-categoryImagesTag CDB-Text CDB-FontSize-small u-altTextColor is-semibold u-upperCase\\'>'+\n((__t=( _t('form-components.editors.fill.input-color.img') ))==null?'':_.escape(__t))+\n'</div>\\n';\n } else { \n__p+='\\n<div class=\"Tab-paneLabelImageContainer js-image-container\"></div>\\n';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar Template = require('./tab-pane-icon.tpl');\n\n/**\n *  Icon component\n */\n\nmodule.exports = CoreView.extend({\n  tagName: 'i',\n\n  className: 'CDB-IconFont',\n\n  initialize: function (options) {\n    if (!this.model) {\n      throw new Error('A model should be provided');\n    }\n\n    this.template = this.options.template || Template;\n  },\n\n  render: function () {\n    this.$el.html(this.template({\n      icon: this.model.get('icon')\n    }));\n\n    return this;\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<i class=\"CDB-IconFont CDB-IconFont-'+\n((__t=( icon ))==null?'':_.escape(__t))+\n'\"></i>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\n\n/**\n *  TabPaneItem component\n */\n\nmodule.exports = CoreView.extend({\n  tagName: 'button',\n\n  events: {\n    'click': '_onButtonClicked'\n  },\n\n  initialize: function () {\n    if (!this.model) {\n      throw new Error('A model should be provided');\n    }\n\n    this.model.bind('change:selected', this._onChangeSelected, this);\n  },\n\n  render: function () {\n    var view = this.model.get('createButtonView').call(this.model);\n    this.addView(view);\n    this.$el.append(view.render().$el);\n    this.$el.toggleClass('is-selected', !!this.model.get('selected'));\n\n    return this;\n  },\n\n  _onChangeSelected: function () {\n    this.$el.toggleClass('is-selected', !!this.model.get('selected'));\n  },\n\n  _onButtonClicked: function (e) {\n    e.preventDefault();\n    this.model.set('selected', true);\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./tab-pane-label.tpl');\n\n/**\n *  Label component\n */\n\nmodule.exports = CoreView.extend({\n  className: 'Label',\n\n  initialize: function () {\n    if (!this.model) {\n      throw new Error('A model should be provided');\n    }\n  },\n\n  render: function () {\n    this.$el.html(template({\n      label: this.model.get('label'),\n      selectedChild: this.model.get('selectedChild') || ''\n    }));\n    return this;\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+=''+\n((__t=( label ))==null?'':_.escape(__t))+\n'';\n if (selectedChild) { \n__p+=' <span class=\"CDB-NavSubmenu-status js-NavSubmenu-status u-hintTextColor\">'+\n((__t=( selectedChild ))==null?'':_.escape(__t))+\n'</span>';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var template = require('./tab-pane-file.tpl');\nvar CoreView = require('backbone/core-view');\nvar ImageLoaderView = require('../img-loader-view');\n\n/**\n *  File component\n */\n\nmodule.exports = CoreView.extend({\n  tagName: 'i',\n\n  className: 'CDB-IconFont',\n\n  initialize: function (options) {\n    if (!this.model) throw new Error('A model should be provided');\n\n    this.model.bind('change:label', this.render, this);\n    this.model.bind('change:color', this._updateColor, this);\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    var labelType = this._getLabelType();\n\n    this.$el.html(template({\n      type: labelType,\n      label: this.model.get('label'),\n      kind: this.model.get('kind'),\n      selectedChild: this.model.get('selectedChild') || ''\n    }));\n\n    if (labelType === 'file') {\n      this._loadImages();\n    }\n\n    return this;\n  },\n\n  _loadImages: function () {\n    this.iconView = new ImageLoaderView({\n      imageClass: 'Tab-paneLabelImage',\n      imageUrl: this._getImageURL(),\n      color: this.model.get('color')\n    });\n    this.addView(this.iconView);\n    this.$('.js-image-container').append(this.iconView.render().el);\n  },\n\n  _updateColor: function () {\n    this.iconView && this.iconView.updateImageColor(this.model.get('color'));\n  },\n\n  _getLabelType: function () {\n    var label = this.model.get('label');\n    return label && label.match(/^http/) ? 'file' : 'text';\n  },\n\n  _getImageURL: function () {\n    return this.model.get('label');\n  }\n});\n",
    "var cdb = require('cartodb.js');\n\n/**\n *  Icon component\n */\n\nmodule.exports = cdb.core.View.extend({\n\n  initialize: function (options) {\n    if (!this.model) throw new Error('A model should be provided');\n    if (!options.template) throw new Error('A template should be provided');\n    this.template = options.template;\n  },\n\n  render: function () {\n    this.$el.html(this.template(this.model.toJSON()));\n    return this;\n  }\n});\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar TabPaneItem = require('./tab-pane-item-view.js');\nvar Template = require('./tab-pane.tpl');\n\n/**\n *  TabPane component\n */\n\nmodule.exports = CoreView.extend({\n  className: 'Tab-pane',\n\n  initialize: function (options) {\n    if (!this.collection) {\n      throw new Error('A TabPaneCollection should be provided');\n    }\n\n    this._tabPaneItemOptions = this.options.tabPaneItemOptions;\n    this._createContentKey = this.options.createContentKey || 'createContentView';\n    this.template = this.options.template || Template;\n\n    this.collection.bind('change:selected', this._renderSelected, this);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n\n    this.$el.html(this.template(this.options));\n\n    this._renderCollection();\n\n    var model = this.getSelectedTabPane();\n\n    if (model) {\n      this._renderSelected(model, true);\n    }\n\n    return this;\n  },\n\n  getSelectedTabPane: function () {\n    return this.collection.getSelected();\n  },\n\n  getTabPane: function (name) {\n    return _.first(this.collection.where({ name: name }));\n  },\n\n  getSelectedTabPaneName: function () {\n    var selectedTab = this.getSelectedTabPane();\n    return selectedTab ? selectedTab.get('name') : null;\n  },\n\n  setSelectedTabPaneByName: function (name) {\n    return this.collection.select('name', name);\n  },\n\n  _renderSelected: function (model, isSelected) {\n    if (isSelected) {\n      if (this._selectedView) {\n        this._selectedView.clean();\n        this.removeView(this._selectedView);\n      }\n\n      this._selectedView = this._renderTabPaneContentView(model);\n    }\n  },\n\n  _renderCollection: function () {\n    this.collection.each(function (paneModel) {\n      if (paneModel.get('createButtonView')) {\n        this._renderTabPaneItemView(paneModel);\n      }\n    }, this);\n  },\n\n  _renderTabPaneItemView: function (model) {\n    var tabPaneItemView = new TabPaneItem(_.extend({ model: model }, this._tabPaneItemOptions));\n    this.addView(tabPaneItemView);\n    this.$('.js-menu').append(tabPaneItemView.render().el);\n  },\n\n  _renderTabPaneContentView: function (model) {\n    var tabPaneContentView = model.get(this._createContentKey).call(model);\n    if (tabPaneContentView) {\n      this.addView(tabPaneContentView);\n      this.$('.js-content').append(tabPaneContentView.render().el);\n    }\n    return tabPaneContentView;\n  },\n\n  changeStyleMenu: function (m) {\n    this.$('.js-theme').toggleClass('is-dark', m.isEditing());\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"js-menu\"></div>\\n<div class=\"Tab-paneContent js-content\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-justifyCenter\">\\n  <div class=\"Modal-inner Modal-inner--grid u-flex u-justifyCenter\">\\n    <div class=\"Modal-icon\">\\n      <svg width=\"24px\" height=\"25px\" viewbox=\"521 436 24 25\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n        <path d=\"M524.5,440 L540.5,440 L540.5,460 L524.5,460 L524.5,440 Z M528.5,437 L536.5,437 L536.5,440 L528.5,440 L528.5,437 Z M522,440 L544,440 L522,440 Z M528.5,443.5 L528.5,455.5 L528.5,443.5 Z M532.5,443.5 L532.5,455.5 L532.5,443.5 Z M536.5,443.5 L536.5,455.5 L536.5,443.5 Z\" id=\"Shape\" stroke=\"#F19243\" stroke-width=\"1\" fill=\"none\"/>\\n      </svg>\\n    </div>\\n    <div>\\n      <h2 class=\" CDB-Text CDB-Size-huge is-light u-bSpace--xl\">\\n        '+\n((__t=( _t('components.table.rows.destroy.title', { cartodb_id: cartodb_id }) ))==null?'':_.escape(__t))+\n'\\n      </h2>\\n      <p class=\"CDB-Text CDB-Size-large u-altTextColor\">'+\n((__t=( _t('components.table.rows.destroy.desc') ))==null?'':_.escape(__t))+\n'</p>\\n      <ul class=\"Modal-listActions u-flex u-alignCenter\">\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--secondary CDB-Button--big js-cancel\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">\\n              '+\n((__t=( _t('components.table.rows.destroy.cancel') ))==null?'':_.escape(__t))+\n'\\n            </span>\\n          </button>\\n        </li>\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-confirm\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">\\n              '+\n((__t=( _t('components.table.rows.destroy.confirm') ))==null?'':_.escape(__t))+\n'\\n            </span>\\n          </button>\\n        </li>\\n      </ul>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<td class=\"Table-cellItem\" data-attribute=\"'+\n((__t=( columnName ))==null?'':_.escape(__t))+\n'\" title=\"'+\n((__t=( value ))==null?'':_.escape(__t))+\n'\" data-clipboard-text=\\''+\n((__t=( value ))==null?'':_.escape(__t))+\n'\\'>\\n  <div class=\"\\n      Table-cell u-flex u-justifySpace\\n      '+\n((__t=( columnName === 'cartodb_id' ||(type === 'geometry' && geometry !== 'point') ? 'Table-cell--short' : '' ))==null?'':_.escape(__t))+\n'\\n    \">\\n    <p class=\"\\n      CDB-Text CDB-Size-medium\\n      u-ellipsis u-rSpace--xl\\n      '+\n((__t=( type === 'number' && columnName !== 'cartodb_id' ? 'is-number' : '' ))==null?'':_.escape(__t))+\n'\\n      '+\n((__t=( value === null ? 'is-null' : '' ))==null?'':_.escape(__t))+\n'\\n      '+\n((__t=( columnName === 'cartodb_id' ? 'is-cartodbId' : '' ))==null?'':_.escape(__t))+\n'\\n      js-value\\n    \">\\n      '+\n((__t=( value === null ? 'null' : formattedValue ))==null?'':_.escape(__t))+\n'\\n    </p>\\n\\n    ';\n if (columnName !== 'cartodb_id') { \n__p+='\\n      <button class=\"CDB-Shape-threePoints is-blue is-small Table-cellItemOptions js-cellOptions\">\\n        <div class=\"CDB-Shape-threePointsItem\"></div>\\n        <div class=\"CDB-Shape-threePointsItem\"></div>\\n        <div class=\"CDB-Shape-threePointsItem\"></div>\\n      </button>\\n    ';\n } \n__p+='\\n  </div>\\n</td>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar cellTemplate = require('./table-body-cell.tpl');\nvar pointGeojsonParser = require('../../../helpers/point-geojson-parser');\n\nvar FORMATTED_TYPE_VALUES = {\n  'geometry': pointGeojsonParser\n};\n\n/*\n *  Table body row view\n */\n\nmodule.exports = CoreView.extend({\n\n  className: 'Table-row',\n  tagName: 'tr',\n\n  options: {\n    simpleGeometry: ''\n  },\n\n  initialize: function (opts) {\n    if (!opts.columnsCollection) throw new Error('columnsCollection is required');\n    if (!opts.tableViewModel) throw new Error('tableViewModel is required');\n\n    this._columnsCollection = opts.columnsCollection;\n    this._tableViewModel = opts.tableViewModel;\n\n    this.el.setAttribute('data-model', this.model.cid);\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.$el.empty();\n    this._generateRowsHTML();\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.bind('change', this.render, this);\n    this.model.bind('destroy', this.remove, this);\n  },\n\n  _generateRowsHTML: function () {\n    var r = [];\n\n    for (var i = 0, l = this._columnsCollection.size(); i < l; i++) {\n      var mdl = this._columnsCollection.at(i);\n      var columnName = mdl.get('name');\n\n      if (columnName !== 'the_geom_webmercator' || (this._tableViewModel.isDisabled() && columnName === 'the_geom_webmercator')) {\n        r[i] = this._generateCellHTML(columnName);\n      }\n    }\n\n    this.el.innerHTML = r.join('');\n  },\n\n  _generateCellHTML: function (columnName) {\n    var simpleGeometry = this.options.simpleGeometry;\n    var columnModel = _.first(this._columnsCollection.where({ name: columnName }));\n    var columnType = columnModel.get('type');\n    var value = this.model.get(columnName);\n    var formattedValue = value;\n\n    if (columnType === 'geometry') {\n      if (simpleGeometry === 'point') {\n        formattedValue = FORMATTED_TYPE_VALUES[columnType](value);\n      } else {\n        formattedValue = simpleGeometry && (simpleGeometry.charAt(0).toUpperCase() + simpleGeometry.slice(1));\n      }\n    } else if (FORMATTED_TYPE_VALUES[columnType]) {\n      formattedValue = FORMATTED_TYPE_VALUES[columnType](value);\n    }\n\n    return cellTemplate({\n      value: value,\n      formattedValue: formattedValue,\n      type: columnType,\n      columnName: columnName,\n      geometry: simpleGeometry\n    });\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar $ = require('jquery');\nvar _ = require('underscore');\nvar Clipboard = require('clipboard');\nvar TableBodyRowView = require('./table-body-row-view');\nvar ContextMenuView = require('../../context-menu/context-menu-view');\nvar CustomListCollection = require('../../custom-list/custom-list-collection');\nvar addTableRowOperation = require('../operations/table-add-row');\nvar removeTableRowOperation = require('../operations/table-remove-row');\nvar editCellOperation = require('../operations/table-edit-cell');\nvar ConfirmationModalView = require('../../modals/confirmation/modal-confirmation-view');\nvar TablePaginatorView = require('../paginator/table-paginator-view');\nvar tableBodyTemplate = require('./table-body.tpl');\nvar renderLoading = require('../../loading/render-loading');\nvar ErrorView = require('../../error/error-view');\nvar tableNoRowsTemplate = require('./table-no-rows.tpl');\nvar EditorsServiceModel = require('../editors/editors-service-model');\nvar EditorsModel = require('../editors/types/editor-model');\nvar errorParser = require('../../../helpers/error-parser');\nvar magicPositioner = require('../../../helpers/magic-positioner');\nvar checkAndBuildOpts = require('../../../helpers/required-opts');\n\nvar EDITORS_MAP = {\n  'string': require('../editors/types/editor-string-view'),\n  'number': require('../editors/types/editor-base-view'),\n  'boolean': require('../editors/types/editor-boolean-view'),\n  'date': require('../editors/types/editor-date-view'),\n  'default': require('../editors/types/editor-string-view')\n};\n\nvar REQUIRED_OPTS = [\n  'columnsCollection',\n  'modals',\n  'queryGeometryModel',\n  'querySchemaModel',\n  'rowsCollection',\n  'tableViewModel'\n];\n\n/*\n *  Table body view\n */\n\nmodule.exports = CoreView.extend({\n\n  className: 'Table-body',\n  tagName: 'div',\n\n  events: {\n    'click': '_onClick',\n    'dblclick': '_onDblClick'\n  },\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    this._editors = new EditorsServiceModel();\n\n    this._closeEditor = this._closeEditor.bind(this);\n    this._hideContextMenu = this._hideContextMenu.bind(this);\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this._destroyScrollBinding();\n    this.$el.empty();\n\n    // Render results when we have the schema and goemetry is not being fetched\n    if (this._querySchemaModel.isFetched() && !this._queryGeometryModel.isFetching() && !this._rowsCollection.isFetching()) {\n      if (!this._rowsCollection.size()) {\n        this._renderNoRows();\n      } else {\n        this.$el.html(tableBodyTemplate());\n        this._rowsCollection.each(this._renderBodyRow, this);\n        this._initPaginator();\n      }\n    } else {\n      this._renderQueryState();\n    }\n\n    this.$el.toggleClass('Table-body--relative', !!this._tableViewModel.get('relativePositionated'));\n\n    return this;\n  },\n\n  _initBinds: function () {\n    this._queryGeometryModel.bind('change:status', this.render, this);\n    this._querySchemaModel.bind('change:status', this.render, this);\n    this._rowsCollection.bind('reset', _.debounce(this.render.bind(this), 20), this);\n    this._rowsCollection.bind('add', function (model) {\n      if (this._rowsCollection.size() === 1) {\n        this.render();\n      } else {\n        this._renderBodyRow(model);\n        this._scrollToBottom();\n      }\n    }, this);\n    this._rowsCollection.bind('remove', this._onRemoveRow, this);\n    this._rowsCollection.bind('fail', function (mdl, response) {\n      if (!response || (response && response.statusText !== 'abort')) {\n        this._renderError(errorParser(response));\n      }\n    }, this);\n    this.add_related_model(this._queryGeometryModel);\n    this.add_related_model(this._querySchemaModel);\n    this.add_related_model(this._rowsCollection);\n  },\n\n  _renderQueryState: function () {\n    var querySchemaStatus = this._querySchemaModel.get('status');\n    var nodeReady = this._querySchemaModel.get('ready');\n    var geometryStatus = this._queryGeometryModel.get('status');\n\n    if (nodeReady) {\n      if (querySchemaStatus === 'unavailable' && geometryStatus === 'unavailable') {\n        this._renderError(this._querySchemaModel.get('query_errors'));\n      } else {\n        this._renderLoading();\n      }\n    } else {\n      this._renderLoading();\n    }\n  },\n\n  _renderLoading: function () {\n    this.$el.html(\n      renderLoading({\n        title: _t('components.table.rows.loading.title')\n      })\n    );\n  },\n\n  _renderError: function (desc) {\n    var view = new ErrorView({\n      title: _t('components.table.rows.error.title'),\n      desc: desc || _t('components.table.rows.error.desc')\n    });\n    this.addView(view);\n    this.$el.html(view.render().el);\n  },\n\n  _renderNoRows: function () {\n    this.$el.html(\n      tableNoRowsTemplate({\n        page: this._tableViewModel.get('page'),\n        customQuery: this._tableViewModel.isCustomQueryApplied()\n      })\n    );\n  },\n\n  _initPaginator: function () {\n    var paginatorView = new TablePaginatorView({\n      rowsCollection: this._rowsCollection,\n      tableViewModel: this._tableViewModel\n    });\n\n    // Bug in Chrome with position:fixed :(, so we have to choose body as\n    // parent\n    var $el = $('body');\n    // But if we have chosen relativePositionated, we should add close\n    // to the table view\n    if (this._tableViewModel.get('relativePositionated')) {\n      $el = this.$el.closest('.Table').parent();\n    }\n\n    $el.append(paginatorView.render().el);\n    this.addView(paginatorView);\n  },\n\n  _initScrollBinding: function () {\n    $('.Table').scroll(this._hideContextMenu);\n    this.$('.js-tbody').scroll(this._hideContextMenu);\n  },\n\n  _destroyScrollBinding: function () {\n    $('.Table').off('scroll', this._hideContextMenu);\n    this.$('.js-tbody').off('scroll', this._hideContextMenu);\n  },\n\n  _renderBodyRow: function (mdl) {\n    var view = new TableBodyRowView({\n      model: mdl,\n      columnsCollection: this._columnsCollection,\n      simpleGeometry: this._queryGeometryModel.get('simple_geom'),\n      tableViewModel: this._tableViewModel\n    });\n    this.addView(view);\n    this.$('.js-tbody').append(view.render().el);\n  },\n\n  _onRemoveRow: function () {\n    if (!this._rowsCollection.size()) {\n      this._rowsCollection.resetFetch();\n\n      var page = this._tableViewModel.get('page');\n      if (page > 0) {\n        this._tableViewModel.set('page', page - 1);\n      } else {\n        this.render();\n      }\n    }\n  },\n\n  _hasContextMenu: function () {\n    return this._menuView;\n  },\n\n  _hideContextMenu: function () {\n    this._unhighlightCell();\n    this._destroyScrollBinding();\n    this._menuView.collection.unbind(null, null, this);\n    this.removeView(this._menuView);\n    this._menuView.clean();\n    delete this._menuView;\n  },\n\n  _highlightCell: function ($tableCellItem, $tableRow) {\n    $tableCellItem.addClass('is-highlighted');\n    $tableRow.addClass('is-highlighted');\n  },\n\n  _unhighlightCell: function () {\n    this.$('.Table-cellItem.is-highlighted, .Table-row.is-highlighted').removeClass('is-highlighted');\n  },\n\n  _showContextMenu: function (ev) {\n    var self = this;\n    var position = { x: ev.clientX, y: ev.clientY };\n    var $tableRow = $(ev.target).closest('.Table-row');\n    var $tableCellItem = $(ev.target).closest('.Table-cellItem');\n    var modelCID = $tableRow.data('model');\n    var attribute = $tableCellItem.data('attribute');\n    var rowModel = self._rowsCollection.get({ cid: modelCID });\n    var menuItems = [];\n\n    menuItems.push({\n      label: _t('components.table.rows.options.copy'),\n      val: 'copy',\n      action: function () {\n        self._copyValue($tableCellItem);\n      }\n    });\n\n    if (!this._tableViewModel.isDisabled()) {\n      menuItems = [\n        {\n          label: _t('components.table.rows.options.edit'),\n          val: 'edit',\n          action: function () {\n            self._editCell(rowModel, attribute);\n          }\n        }, {\n          label: _t('components.table.rows.options.create'),\n          val: 'create',\n          action: function () {\n            self._addRow();\n          }\n        }\n      ].concat(menuItems);\n\n      menuItems.push({\n        label: _t('components.table.rows.options.delete'),\n        val: 'delete',\n        destructive: true,\n        action: function () {\n          self._removeRow(rowModel);\n        }\n      });\n    }\n\n    // No options?, don't open anything\n    if (!menuItems.length) {\n      return false;\n    }\n\n    var collection = new CustomListCollection(menuItems);\n\n    this._menuView = new ContextMenuView({\n      className: 'Table-rowMenu ' + ContextMenuView.prototype.className,\n      collection: collection,\n      triggerElementID: modelCID,\n      position: position\n    });\n\n    this._menuView.$el.css(\n      magicPositioner({\n        parentView: $('body'),\n        posX: position.x,\n        posY: position.y\n      })\n    );\n\n    collection.bind('change:selected', function (menuItem) {\n      var action = menuItem.get('action');\n      action && action();\n    }, this);\n\n    this._menuView.model.bind('change:visible', function (model, isContextMenuVisible) {\n      if (this._hasContextMenu() && !isContextMenuVisible) {\n        this._hideContextMenu();\n      }\n    }, this);\n\n    this._menuView.show();\n    this.addView(this._menuView);\n\n    this._highlightCell($tableCellItem, $tableRow);\n    this._initScrollBinding();\n  },\n\n  _onClick: function (ev) {\n    var isCellOptions = $(ev.target).hasClass('js-cellOptions');\n    if (isCellOptions) {\n      if (this._hasContextMenu()) {\n        this._hideContextMenu();\n      } else {\n        this._showContextMenu(ev);\n      }\n    }\n  },\n\n  _onDblClick: function (ev) {\n    var $tableCellItem = $(ev.target).closest('.Table-cellItem');\n    var isCellOptions = $(ev.target).hasClass('js-cellOptions');\n\n    if ($tableCellItem && !isCellOptions) {\n      var $tableRow = $tableCellItem.closest('.Table-row');\n      var modelCID = $tableRow.data('model');\n      var attribute = $tableCellItem.data('attribute');\n      var rowModel = this._rowsCollection.get({ cid: modelCID });\n\n      if (!this._tableViewModel.isDisabled() && rowModel && attribute && attribute !== 'cartodb_id') {\n        this._editCell(rowModel, attribute);\n      }\n    }\n  },\n\n  _copyValue: function ($el) {\n    // Work-around for Clipboard \\o/\n    this._clipboard = new Clipboard($el.get(0));\n    $el.click();\n    this._clipboard.destroy();\n  },\n\n  _addRow: function () {\n    addTableRowOperation({\n      rowsCollection: this._rowsCollection\n    });\n  },\n\n  _initEditorScrollBinding: function () {\n    $('.Table').scroll(this._closeEditor);\n    this.$('.js-tbody').scroll(this._closeEditor);\n  },\n\n  _destroyEditorScrollBinding: function () {\n    $('.Table').unbind('scroll', this._closeEditor);\n    this.$('.js-tbody').unbind('scroll', this._closeEditor);\n  },\n\n  _closeEditor: function () {\n    this._unhighlightCell();\n    this._destroyEditorScrollBinding();\n    this._editors.unbind(null, null, this);\n    this._editors.destroy();\n  },\n\n  _saveValue: function (rowModel, attribute, newValue) {\n    if (rowModel.get(attribute) !== newValue) {\n      editCellOperation({\n        rowModel: rowModel,\n        attribute: attribute,\n        newValue: newValue\n      });\n    }\n  },\n\n  _doCellEdition: function (rowModel, attribute) {\n    var $tableRow = this.$('[data-model=\"' + rowModel.cid + '\"]');\n    var $tableCell = $tableRow.find('[data-attribute=\"' + attribute + '\"]');\n    var $options = $tableCell.find('.js-cellOptions');\n    var columnModel = _.first(this._columnsCollection.where({ name: attribute }));\n    var type = columnModel.get('type');\n\n    this._highlightCell($tableCell, $tableRow);\n    this._initEditorScrollBinding();\n\n    var model = new EditorsModel({\n      type: type,\n      value: rowModel.get(attribute)\n    });\n\n    this._editors.bind('destroyedEditor', this._closeEditor, this);\n    this._editors.bind('confirmedEditor', function () {\n      if (model.isValid()) {\n        this._saveValue(\n          rowModel,\n          attribute,\n          model.get('value')\n        );\n      }\n    }, this);\n\n    var position = $options.offset();\n\n    if ($tableCell.index() > 1) {\n      position.right = window.innerWidth - position.left;\n      delete position.left;\n    }\n\n    if (this._rowsCollection.size() > 4 && ($tableRow.index() + 2) >= (this._rowsCollection.size() - 1)) {\n      position.bottom = window.innerHeight - position.top;\n      delete position.top;\n    } else {\n      position.top = position.top + 20;\n    }\n\n    var View = EDITORS_MAP[type];\n\n    if (!View) {\n      View = EDITORS_MAP['default'];\n    }\n\n    this._editors.create(\n      function (editorModel) {\n        return new View({\n          editorModel: editorModel,\n          model: model\n        });\n      },\n      position\n    );\n  },\n\n  _editCell: function (rowModel, attribute) {\n    var callback = this._doCellEdition.bind(this, rowModel, attribute);\n    rowModel.fetchRowIfGeomIsNotLoaded(callback);\n  },\n\n  _removeRow: function (rowModel) {\n    var self = this;\n\n    this._modals.create(\n      function (modalModel) {\n        return new ConfirmationModalView({\n          modalModel: modalModel,\n          template: require('./modals-templates/remove-table-row.tpl'),\n          renderOpts: {\n            cartodb_id: rowModel.get('cartodb_id')\n          },\n          loadingTitle: _t('components.table.rows.destroy.loading', {\n            cartodb_id: rowModel.get('cartodb_id')\n          }),\n          runAction: function () {\n            removeTableRowOperation({\n              tableViewModel: self._tableViewModel,\n              rowModel: rowModel,\n              onSuccess: function () {\n                modalModel.destroy();\n              },\n              onError: function (e) {\n                modalModel.destroy();\n              }\n            });\n          }\n        });\n      }\n    );\n  },\n\n  _scrollToBottom: function () {\n    var tbodyHeight = this.$('.js-tbody').get(0).scrollHeight;\n    this.$('.js-tbody').animate({\n      scrollTop: tbodyHeight\n    }, 'slow');\n  },\n\n  clean: function () {\n    this._destroyScrollBinding();\n    CoreView.prototype.clean.apply(this);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<table>\\n  <tbody class=\"js-tbody\"></tbody>\\n</table>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"IntermediateInfo\">\\n  <div class=\"LayoutIcon\">\\n    <i class=\"CDB-IconFont CDB-IconFont-rows\"></i>\\n  </div>\\n  <h3 class=\"CDB-Text CDB-Size-large u-mainTextColor u-secondaryTextColor u-bSpace--m u-tSpace-xl\">\\n    ';\n if (page !== 0) { \n__p+='\\n      '+\n((__t=( _t('components.table.rows.result.no-page-title', { page: page }) ))==null?'':_.escape(__t))+\n'\\n    ';\n } else { \n__p+='\\n      '+\n((__t=( _t('components.table.rows.result.no-results-title') ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n  </h3>\\n  <p class=\"CDB-Text CDB-Size-medium u-altTextColor\">\\n    ';\n if (page !== 0) { \n__p+='\\n      '+\n((__t=( _t('components.table.rows.result.no-page-desc', { page: page }) ))==null?'':_.escape(__t))+\n'\\n    ';\n } else { \n__p+='\\n      '+\n((__t=( _t('components.table.rows.result.no-results-desc', {\n        addRow: _t('components.table.rows.result.no-results-button')\n      }) ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n  </p>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\n\n/**\n * View model of an editor\n */\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    show: true,\n    createContentView: function () {\n      return new CoreView();\n    }\n  },\n\n  createContentView: function () {\n    return this.get('createContentView')(this);\n  },\n\n  show: function () {\n    this.set('show', true);\n  },\n\n  hide: function () {\n    this.set('show', false);\n  },\n\n  isHidden: function () {\n    return !this.get('show');\n  },\n\n  confirm: function () {\n    var args = Array.prototype.slice.call(arguments);\n    this.trigger.apply(this, ['confirm'].concat(args));\n  },\n\n  /**\n   * @override {Backbone.Model.prototype.destroy}\n   */\n  destroy: function () {\n    var args = Array.prototype.slice.call(arguments);\n    this.trigger.apply(this, ['destroy'].concat(args));\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\n\nmodule.exports = CoreView.extend({\n  className: 'CDB-Box-modal Table-editor',\n\n  initialize: function () {\n    this.listenTo(this.model, 'change:show', this._onShowChange);\n    this.listenTo(this.model, 'destroy', this._onDestroy);\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    var view = this.model.createContentView();\n    this.addView(view);\n    view.render();\n    this.$el.append(view.el);\n    this.$el.css(this.options.position);\n\n    return this;\n  },\n\n  show: function () {\n    this.model.show();\n  },\n\n  hide: function () {\n    this.model.hide();\n  },\n\n  destroy: function () {\n    this.model.destroy();\n  },\n\n  _onShowChange: function (m, show) {\n    this.$el[show ? 'show' : 'hide']();\n  },\n\n  _onClose: function () {\n    this.destroy();\n  },\n\n  _onDestroy: function () {\n    this.hide();\n    this.clean();\n  }\n\n});\n",
    "var _ = require('underscore');\nvar $ = require('jquery');\nvar Backbone = require('backbone');\nvar EditorView = require('./editor-view');\nvar EditorViewModel = require('./editor-view-model');\nvar ESC_KEY_CODE = 27;\nvar DESTROYED_EDITOR_EVENT = 'destroyedEditor';\nvar CONFIRMED_EDITOR_EVENT = 'confirmedEditor';\n\n/**\n * Top-level API to handle editor views.\n *\n * Example:\n * // In some entry-point:\n * table.editors = new EditorsServiceModel();\n *\n * // Later, in any view, calling create will create a new editor viewModel\n * var editorView = table.editors.create(fn);\n *\n * Same concept @viddo introduced with Modals.\n */\nmodule.exports = Backbone.Model.extend({\n\n  /**\n   * Creates a new editor view\n   *\n   * @param {Function} createContentView\n   * @return {View} the new editor view\n   */\n  create: function (createContentView, position) {\n    if (!_.isFunction(createContentView)) throw new Error('createContentView is required');\n    position = position || {\n      left: '50%',\n      top: '50%'\n    };\n\n    if (!this._editorView) {\n      this._editorView = this._newEditorView(position);\n      document.body.appendChild(this._editorView.el);\n    }\n\n    this._editorView.model.set('createContentView', createContentView);\n    this._editorView.render();\n\n    return this._editorView;\n  },\n\n  /**\n   * Convenience method to add a listener when current editor is destroyed\n   *\n   * This is the same as doing\n   * editors.create(function (model) {\n   *   model.once('destroy', callback, context);\n   *   return new MyView({  });\n   * });\n   *\n   * @param {Function} callback\n   * @param {Object} [context = undefined]\n   */\n\n  confirm: function () {\n    if (this._editorView) {\n      this._editorView.model.confirm();\n    }\n  },\n\n  destroy: function () {\n    if (this._editorView) {\n      this._editorView.model.destroy();\n    }\n  },\n\n  _newEditorView: function (position) {\n    var viewModel = new EditorViewModel();\n    this._destroyOnEsc(viewModel);\n    this.listenToOnce(viewModel, 'destroy', function () {\n      this._editorView = null;\n      this.trigger.apply(this, [DESTROYED_EDITOR_EVENT].concat(Array.prototype.slice.call(arguments)));\n      this.stopListening(viewModel);\n    });\n    this.listenToOnce(viewModel, 'confirm', function () {\n      this.trigger.apply(this, [CONFIRMED_EDITOR_EVENT].concat(Array.prototype.slice.call(arguments)));\n      this.destroy();\n    });\n    var view = new EditorView({\n      model: viewModel,\n      position: position\n    });\n    this._destroyOnClickOutside(view);\n    return view;\n  },\n\n  _destroyOnClickOutside: function (view) {\n    var destroyOnClickOutside = function (ev) {\n      if ($(ev.target).closest(view.el).length === 0) {\n        view.model.confirm();\n      }\n    };\n    document.addEventListener('click', destroyOnClickOutside);\n    this.listenToOnce(view.model, 'destroy', function () {\n      document.removeEventListener('click', destroyOnClickOutside);\n    });\n  },\n\n  _destroyOnEsc: function (viewModel) {\n    var destroyOnEsc = function (ev) {\n      if (ev.which === ESC_KEY_CODE) {\n        viewModel.destroy();\n      }\n    };\n    document.addEventListener('keydown', destroyOnEsc);\n    this.listenToOnce(viewModel, 'destroy', function () {\n      document.removeEventListener('keydown', destroyOnEsc);\n    });\n  }\n\n});\n",
    "var CoreView = require('backbone/core-view');\nvar $ = require('jquery');\nvar ENTER_KEY_CODE = 13;\n\nmodule.exports = CoreView.extend({\n\n  tagName: 'input',\n  className: 'CDB-InputText CDB-Text',\n\n  events: {\n    'keyup': '_onValueChange',\n    'change': '_onValueChange'\n  },\n\n  initialize: function (opts) {\n    if (!opts.editorModel) throw new Error('editorModel is required');\n    this._editorModel = opts.editorModel;\n    this._onKeyPressed = this._onKeyPressed.bind(this);\n    this._onValueChange = this._onValueChange.bind(this);\n  },\n\n  render: function () {\n    this.$el.val(\n      this.model.get('value')\n    );\n    this._setFocus();\n    this._initDocumentBind();\n    return this;\n  },\n\n  _setFocus: function () {\n    setTimeout(function () {\n      this.$el.focus();\n    }.bind(this), 100);\n  },\n\n  _initDocumentBind: function () {\n    $(document).bind('keydown', this._onKeyPressed);\n  },\n\n  _destroyDocumentBind: function () {\n    $(document).unbind('keydown', this._onKeyPressed);\n  },\n\n  _onKeyPressed: function (ev) {\n    if (ev.which === ENTER_KEY_CODE) {\n      if (this.model.isValid()) {\n        this._editorModel.confirm();\n      } else {\n        return false;\n      }\n    }\n  },\n\n  _onValueChange: function () {\n    this._setValue();\n    this._checkValidity();\n  },\n\n  _setValue: function () {\n    this.model.set('value', this.$el.val());\n  },\n\n  _checkValidity: function () {\n    this.$el.toggleClass('has-error', !this.model.isValid());\n  },\n\n  clean: function () {\n    this._destroyDocumentBind();\n    CoreView.prototype.clean.apply(this);\n  }\n\n});\n",
    "var EditorBaseView = require('./editor-base-view');\nvar $ = require('jquery');\nvar template = require('./editor-boolean.tpl');\n\nmodule.exports = EditorBaseView.extend({\n\n  tagName: 'div',\n  className: 'u-flex',\n\n  events: {\n    'change input:radio': '_onRadioChanged'\n  },\n\n  render: function () {\n    var value = this.model.get('value');\n    this.$el.html(\n      template({\n        value: value !== null ? value.toString() : 'null'\n      })\n    );\n    return this;\n  },\n\n  _onRadioChanged: function (ev) {\n    var value = $(ev.target).val();\n    switch (value) {\n      case 'true':\n        value = true;\n        break;\n      case 'false':\n        value = false;\n        break;\n      default:\n        value = null;\n    }\n    this.model.set('value', value);\n    this._editorModel.confirm();\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-iBlock CDB-Text CDB-Size-medium u-rSpace--xl\">\\n  <input class=\"CDB-Radio\" type=\"radio\" name=\"value\" value=\"true\" ';\n if (value === 'true') { \n__p+='checked';\n } \n__p+='>\\n  <span class=\"u-iBlock CDB-Radio-face\"></span>\\n  <label class=\"u-iBlock u-lSpace\">True</label>\\n</div>\\n<div class=\"u-iBlock CDB-Text CDB-Size-medium u-rSpace--xl\">\\n  <input class=\"CDB-Radio\" type=\"radio\" name=\"value\" value=\"false\" ';\n if (value === 'false') { \n__p+='checked';\n } \n__p+='>\\n  <span class=\"u-iBlock CDB-Radio-face\"></span>\\n  <label class=\"u-iBlock u-lSpace\">False</label>\\n</div>\\n<div class=\"u-iBlock CDB-Text CDB-Size-medium u-rSpace--xl\">\\n  <input class=\"CDB-Radio\" type=\"radio\" name=\"value\" value=\"null\" ';\n if (value === 'null') { \n__p+='checked';\n } \n__p+='>\\n  <span class=\"u-iBlock CDB-Radio-face\"></span>\\n  <label class=\"u-iBlock u-lSpace\">Null</label>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar moment = require('moment');\nvar Utils = require('../../../../helpers/utils');\nvar MONTHS = [\n  {\n    val: 0,\n    label: _t('months.january')\n  }, {\n    val: 1,\n    label: _t('months.february')\n  }, {\n    val: 2,\n    label: _t('months.march')\n  }, {\n    val: 3,\n    label: _t('months.april')\n  }, {\n    val: 4,\n    label: _t('months.may')\n  }, {\n    val: 5,\n    label: _t('months.june')\n  }, {\n    val: 6,\n    label: _t('months.july')\n  }, {\n    val: 7,\n    label: _t('months.august')\n  }, {\n    val: 8,\n    label: _t('months.september')\n  }, {\n    val: 9,\n    label: _t('months.october')\n  }, {\n    val: 10,\n    label: _t('months.november')\n  }, {\n    val: 11,\n    label: _t('months.december')\n  }\n];\n\nmodule.exports = Backbone.Model.extend({\n\n  parse: function (attrs) {\n    var date;\n\n    if (!attrs.date) {\n      date = moment().utc();\n    } else {\n      date = moment(attrs.date).utc();\n    }\n\n    return {\n      day: date.date(),\n      month: date.month(),\n      year: date.year(),\n      time: date.format('HH:mm:ss'),\n      utcOffset: date.utcOffset()\n    };\n  },\n\n  initialize: function () {\n    this.schema = {\n      day: {\n        title: '',\n        type: 'Text',\n        validators: [\n          'required',\n          /^([12]?\\d{0,1}|3[01]{0,2})$/,\n          function (value, formValues) {\n            var date = moment(Utils.formatDate(formValues));\n            if (!date.isValid()) {\n              return {\n                type: 'date',\n                message: _t('components.datepicker.invalid-date')\n              };\n            }\n          }\n        ]\n      },\n      month: {\n        type: 'Select',\n        title: '',\n        options: MONTHS\n      },\n      year: {\n        title: '',\n        type: 'Text',\n        validators: ['required', /^([0-9]{0,4})$/]\n      },\n      time: {\n        title: '',\n        type: 'Text',\n        validators: ['required', /^([01]{1}[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]$/]\n      }\n    };\n  },\n\n  getFormattedDate: function () {\n    return Utils.formatDate(this.toJSON());\n  }\n\n});\n",
    "var Backbone = require('backbone');\nvar EditorBaseView = require('./editor-base-view');\nvar EditorDateFormModel = require('./editor-date-form-model');\nrequire('../../../form-components/index');\n\nmodule.exports = EditorBaseView.extend({\n\n  tagName: 'div',\n  className: 'Table-editorDate',\n\n  initialize: function (opts) {\n    EditorBaseView.prototype.initialize.apply(this, arguments);\n\n    this._formModel = new EditorDateFormModel({\n      date: this.model.get('value')\n    }, {\n      parse: true\n    });\n\n    this._setValue();\n    this._formModel.bind('change', this._setValue, this);\n    this.add_related_model(this._formModel);\n  },\n\n  render: function () {\n    this._formView = new Backbone.Form({\n      model: this._formModel\n    });\n\n    this._formView.bind('change', function () {\n      this.commit();\n    });\n\n    this.$el.html(this._formView.render().el);\n\n    return this;\n  },\n\n  _setValue: function () {\n    this.model.set('value', this._formModel.getFormattedDate());\n  },\n\n  clean: function () {\n    this._formView.remove();\n    EditorBaseView.prototype.clean.apply(this);\n  }\n\n});\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\n\nmodule.exports = Backbone.Model.extend({\n\n  // Error labels will not be showed, not needed to be translated\n  validate: function (attrs, opts) {\n    if (attrs.type === 'number' && isNaN(attrs.value)) {\n      return 'Number not valid';\n    }\n\n    if (attrs.type === 'boolean' && (!_.isBoolean(attrs.value) && attrs.value !== null)) {\n      return 'Boolean not valid';\n    }\n  }\n\n});\n",
    "var EditorBaseView = require('./editor-base-view');\nvar ENTER_KEY_CODE = 13;\n\nmodule.exports = EditorBaseView.extend({\n\n  tagName: 'textarea',\n  className: 'Table-editorTextarea CDB-Textarea CDB-Text',\n\n  _onKeyPressed: function (ev) {\n    if (!ev.shiftKey && ev.which === ENTER_KEY_CODE) {\n      this._onValueChange();\n      this._editorModel.confirm();\n    }\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-justifyCenter\">\\n  <div class=\"Modal-inner Modal-inner--grid u-flex u-justifyCenter\">\\n    <div class=\"Modal-icon\">\\n      <svg width=\"25px\" height=\"25px\" viewBox=\"-1 4 25 25\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n        <g id=\"Outline_Icons\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(-1.000000, 4.000000)\">\\n          <path d=\"M1.9477838,21.5 C1.6977511,21.5 1.5,21.3016354 1.5,21.0431048 L1.5,1.95689523 C1.5,1.70555616 1.70315066,1.5 1.94113901,1.5 L16.058861,1.5 C16.2975949,1.5 16.5,1.70783627 16.5,1.96250326 L16.5,13.2661378 L17.5,13.2661378 L17.5,1.96250326 C17.5,1.16139088 16.8558926,0.5 16.058861,0.5 L1.94113901,0.5 C1.14821378,0.5 0.5,1.15588925 0.5,1.95689523 L0.5,21.0431048 C0.5,21.8532278 1.1447717,22.5 1.9477838,22.5 L10.0155676,22.5 L10.0155676,21.5 L1.9477838,21.5 Z\" id=\"path-1\" fill=\"#F19243\"></path>\\n          <rect id=\"Rectangle-2\" fill=\"#F19243\" x=\"1\" y=\"5\" width=\"16\" height=\"1\"></rect>\\n          <path d=\"M23.854,14.646 L21.354,12.146 C21.166,11.958 20.834,11.958 20.647,12.146 L13.146,19.648 C13.089,19.705 13.054,19.773 13.03,19.845 C13.028,19.852 13.021,19.857 13.019,19.865 L12.019,23.365 C11.969,23.539 12.018,23.727 12.146,23.856 C12.241,23.951 12.369,24.002 12.5,24.002 C12.546,24.002 12.592,23.996 12.637,23.983 L16.137,22.983 C16.144,22.981 16.149,22.974 16.157,22.972 C16.229,22.948 16.297,22.913 16.354,22.856 L23.855,15.354 C24.05,15.158 24.05,14.842 23.854,14.646 L23.854,14.646 L23.854,14.646 Z M16,21.795 L14.207,20.002 L19.001,15.207 L20.794,17 L16,21.795 L16,21.795 L16,21.795 Z M13.747,20.957 L15.045,22.255 L13.228,22.775 L13.747,20.957 L13.747,20.957 L13.747,20.957 Z M21.501,16.293 L19.708,14.5 L21.001,13.207 L22.794,15 L21.501,16.293 L21.501,16.293 L21.501,16.293 Z\" id=\"Shape\" fill=\"#F19243\"></path>\\n        </g>\\n      </svg>\\n    </div>\\n    <div>\\n      <h2 class=\" CDB-Text CDB-Size-huge is-light u-bSpace--xl\">\\n        '+\n((__t=( _t('components.table.columns.change-type.title', { columnName: columnName, newType: newType }) ))==null?'':_.escape(__t))+\n'\\n      </h2>\\n      <p class=\"CDB-Text CDB-Size-large u-altTextColor\">\\n        '+\n((__t=( _t('components.table.columns.change-type.desc') ))==null?'':_.escape(__t))+\n'\\n      </p>\\n      <ul class=\"Modal-listActions u-flex u-alignCenter\">\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--secondary CDB-Button--big js-cancel\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">\\n              '+\n((__t=( _t('components.table.columns.change-type.cancel') ))==null?'':_.escape(__t))+\n'\\n            </span>\\n          </button>\\n        </li>\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-confirm\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">\\n              '+\n((__t=( _t('components.table.columns.change-type.confirm') ))==null?'':_.escape(__t))+\n'\\n            </span>\\n          </button>\\n        </li>\\n      </ul>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-justifyCenter\">\\n  <div class=\"Modal-inner Modal-inner--grid u-flex u-justifyCenter\">\\n    <div class=\"Modal-icon\">\\n      <svg width=\"24px\" height=\"25px\" viewbox=\"521 436 24 25\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n        <path d=\"M524.5,440 L540.5,440 L540.5,460 L524.5,460 L524.5,440 Z M528.5,437 L536.5,437 L536.5,440 L528.5,440 L528.5,437 Z M522,440 L544,440 L522,440 Z M528.5,443.5 L528.5,455.5 L528.5,443.5 Z M532.5,443.5 L532.5,455.5 L532.5,443.5 Z M536.5,443.5 L536.5,455.5 L536.5,443.5 Z\" id=\"Shape\" stroke=\"#F19243\" stroke-width=\"1\" fill=\"none\"/>\\n      </svg>\\n    </div>\\n    <div>\\n      <h2 class=\" CDB-Text CDB-Size-huge is-light u-bSpace--xl\">\\n        '+\n((__t=( _t('components.table.columns.destroy.title', { columnName: name }) ))==null?'':_.escape(__t))+\n'\\n      </h2>\\n      <p class=\"CDB-Text CDB-Size-large u-altTextColor\">'+\n((__t=( _t('components.table.columns.destroy.desc') ))==null?'':_.escape(__t))+\n'</p>\\n      <ul class=\"Modal-listActions u-flex u-alignCenter\">\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--secondary CDB-Button--big js-cancel\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">\\n              '+\n((__t=( _t('components.table.columns.destroy.cancel') ))==null?'':_.escape(__t))+\n'\\n            </span>\\n          </button>\\n        </li>\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-confirm\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">\\n              '+\n((__t=( _t('components.table.columns.destroy.confirm') ))==null?'':_.escape(__t))+\n'\\n            </span>\\n          </button>\\n        </li>\\n      </ul>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-justifyCenter\">\\n  <div class=\"Modal-inner Modal-inner--grid u-flex u-justifyCenter\">\\n    <div class=\"Modal-icon\">\\n      <svg width=\"25px\" height=\"25px\" viewBox=\"67 153 25 25\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n        <g id=\"Group-Copy\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(67.000000, 153.000000)\">\\n          <path d=\"M16,13 L17,13 L17,5.5 C17,5.433 16.986,5.368 16.961,5.308 C16.936,5.247 16.899,5.192 16.853,5.146 L11.854,0.147 C11.808,0.101 11.753,0.064 11.692,0.039 C11.632,0.014 11.567,0 11.5,0 L0.5,0 C0.224,0 0,0.224 0,0.5 L0,21.5 C0,21.776 0.224,22 0.5,22 L9.5,22 L9.5,21 L1,21 L1,1 L11,1 L11,5.5 C11,5.776 11.224,6 11.5,6 L16,6 L16,13 L16,13 Z M12,1.707 L15.293,5 L12,5 L12,1.707 L12,1.707 Z\" id=\"Shape\" fill=\"#F19243\"></path>\\n          <path d=\"M23.854,14.646 L21.354,12.146 C21.166,11.958 20.834,11.958 20.647,12.146 L13.146,19.648 C13.089,19.705 13.054,19.773 13.03,19.845 C13.028,19.852 13.021,19.857 13.019,19.865 L12.019,23.365 C11.969,23.539 12.018,23.727 12.146,23.856 C12.241,23.951 12.369,24.002 12.5,24.002 C12.546,24.002 12.592,23.996 12.637,23.983 L16.137,22.983 C16.144,22.981 16.149,22.974 16.157,22.972 C16.229,22.948 16.297,22.913 16.354,22.856 L23.855,15.354 C24.05,15.158 24.05,14.842 23.854,14.646 L23.854,14.646 Z M16,21.795 L14.207,20.002 L19.001,15.207 L20.794,17 L16,21.795 L16,21.795 Z M13.747,20.957 L15.045,22.255 L13.228,22.775 L13.747,20.957 L13.747,20.957 Z M21.501,16.293 L19.708,14.5 L21.001,13.207 L22.794,15 L21.501,16.293 L21.501,16.293 Z\" id=\"Shape\" fill=\"#F19243\"></path>\\n        </g>\\n      </svg>\\n    </div>\\n    <div>\\n      <h2 class=\" CDB-Text CDB-Size-huge is-light u-bSpace--m\">\\n        '+\n((__t=( _t('components.table.columns.rename.title', {\n          columnName: columnName,\n          newName: newName\n        }) ))==null?'':_.escape(__t))+\n'\\n      </h2>\\n      <p class=\"CDB-Text CDB-Size-medium u-altTextColor\">\\n        '+\n((__t=( _t('components.table.columns.rename.desc', {\n              columnName: columnName,\n              newName: newName\n        }) ))==null?'':_.escape(__t))+\n'\\n      </p>\\n      <ul class=\"Modal-listActions u-flex u-alignCenter\">\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--secondary CDB-Button--big js-cancel\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">\\n              '+\n((__t=( _t('components.table.columns.rename.cancel') ))==null?'':_.escape(__t))+\n'\\n            </span>\\n          </button>\\n        </li>\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-confirm\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">\\n              '+\n((__t=( _t('components.table.columns.rename.confirm') ))==null?'':_.escape(__t))+\n'\\n            </span>\\n          </button>\\n        </li>\\n      </ul>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var $ = require('jquery');\nvar CoreView = require('backbone/core-view');\nvar template = require('./table-head-item.tpl');\nvar ContextMenuView = require('../../context-menu/context-menu-view');\nvar CustomListCollection = require('../../custom-list/custom-list-collection');\nvar TableHeadOptionsItemView = require('./table-head-options-item-view');\nvar tableHeadOptionsItemTemplate = require('./table-head-options-item.tpl');\nvar ConfirmationModalView = require('../../modals/confirmation/modal-confirmation-view');\nvar QueryColumnModel = require('../../../data/query-column-model');\nvar addColumnOperation = require('../operations/table-add-column');\nvar renameColumnOperation = require('../operations/table-rename-column');\nvar changeColumnTypeOperation = require('../operations/table-change-column-type');\nvar removeTableColumnOperation = require('../operations/table-remove-column');\nvar ENTER_KEY_CODE = 13;\nvar ESC_KEY_CODE = 27;\n\n/*\n *  Main table view\n */\n\nmodule.exports = CoreView.extend({\n\n  className: 'Table-headItem',\n  tagName: 'th',\n\n  events: {\n    'dblclick .js-attribute': '_onAttributeDblClicked',\n    'focusout .js-attribute': '_saveNewName',\n    'click .js-columnOptions': '_showContextMenu'\n  },\n\n  initialize: function (opts) {\n    if (!opts.tableViewModel) throw new Error('tableViewModel is required');\n    if (!opts.columnsCollection) throw new Error('columnsCollection is required');\n    if (!opts.modals) throw new Error('modals is required');\n\n    this._tableViewModel = opts.tableViewModel;\n    this._columnsCollection = opts.columnsCollection;\n    this._modals = opts.modals;\n\n    this._hideContextMenu = this._hideContextMenu.bind(this);\n    this._onKeyDown = this._onKeyDown.bind(this);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    var columnName = this.model.get('name');\n    this.$el.html(\n      template({\n        name: columnName,\n        type: this.model.get('type'),\n        isOrderBy: this._tableViewModel.get('order_by') === columnName,\n        sortBy: this._tableViewModel.get('sort_order'),\n        geometry: this.options.simpleGeometry\n      })\n    );\n    return this;\n  },\n\n  _hasContextMenu: function () {\n    return this._menuView;\n  },\n\n  _hideContextMenu: function () {\n    this._unhighlightHead();\n    this._destroyScrollBinding();\n    this._menuView.collection.unbind(null, null, this);\n    this.removeView(this._menuView);\n    this._menuView.clean();\n    delete this._menuView;\n  },\n\n  _highlightHead: function () {\n    this.$el.addClass('is-highlighted');\n  },\n\n  _unhighlightHead: function () {\n    this.$el.removeClass('is-highlighted');\n  },\n\n  _initScrollBinding: function () {\n    $('.Table').scroll(this._hideContextMenu);\n  },\n\n  _destroyScrollBinding: function () {\n    $('.Table').off('scroll', this._hideContextMenu);\n  },\n\n  _showContextMenu: function (ev) {\n    var self = this;\n    var position = { x: ev.clientX, y: ev.clientY };\n    var elementIndex = this.$el.index();\n    var modelCID = this.model.cid;\n    var columnName = this.model.get('name');\n\n    this._highlightHead();\n\n    var menuItems = [{\n      label: _t('components.table.columns.options.order'),\n      val: 'order',\n      isOrderBy: this._tableViewModel.get('order_by') === columnName,\n      sortBy: this._tableViewModel.get('sort_order'),\n      action: function (mdl) {\n        self._tableViewModel.set({\n          sort_order: mdl.get('sort'),\n          order_by: columnName\n        });\n      }\n    }];\n\n    if (!this._tableViewModel.isDisabled()) {\n      if (!this.model.isCartoDBIDColumn() && !this.model.isGeometryColumn()) {\n        menuItems = menuItems.concat([\n          {\n            label: _t('components.table.columns.options.rename'),\n            val: 'rename',\n            action: function () {\n              self._startEditing();\n            }\n          }, {\n            label: _t('components.table.columns.options.change'),\n            type: this.model.get('type'),\n            isLastColumns: (this._columnsCollection.size() - elementIndex) < 3,\n            val: 'change',\n            action: function (mdl) {\n              self._changeColumnType(mdl.get('type'));\n            }\n          }\n        ]);\n      }\n\n      menuItems.push({\n        label: _t('components.table.columns.options.create'),\n        val: 'create',\n        action: function () {\n          self._addColumn();\n        }\n      });\n\n      if (!this.model.isCartoDBIDColumn() && !this.model.isGeometryColumn()) {\n        menuItems.push(\n          {\n            label: _t('components.table.columns.options.delete'),\n            val: 'delete',\n            destructive: true,\n            action: function () {\n              self._removeColumn();\n            }\n          }\n        );\n      }\n    }\n\n    var collection = new CustomListCollection(menuItems);\n\n    this._menuView = new ContextMenuView({\n      className: ContextMenuView.prototype.className + ' Table-columnMenu',\n      collection: collection,\n      itemTemplate: tableHeadOptionsItemTemplate,\n      itemView: TableHeadOptionsItemView,\n      triggerElementID: modelCID,\n      position: position\n    });\n\n    collection.bind('change:selected', function (menuItem) {\n      var action = menuItem.get('action');\n      action && action(menuItem);\n    }, this);\n\n    this._menuView.model.bind('change:visible', function (model, isContextMenuVisible) {\n      if (this._hasContextMenu() && !isContextMenuVisible) {\n        this._hideContextMenu();\n      }\n    }, this);\n\n    this._menuView.show();\n    this.addView(this._menuView);\n\n    this._initScrollBinding();\n  },\n\n  _addColumn: function () {\n    addColumnOperation({\n      tableViewModel: this._tableViewModel,\n      columnsCollection: this._columnsCollection\n    });\n  },\n\n  _changeColumnType: function (newType) {\n    var self = this;\n    var oldType = this.model.get('type');\n    var isTypeChangeDestructive = QueryColumnModel.isTypeChangeDestructive(oldType, newType);\n    if (!isTypeChangeDestructive) {\n      changeColumnTypeOperation({\n        columnModel: this.model,\n        newType: newType\n      });\n    } else {\n      this._modals.create(\n        function (modalModel) {\n          return new ConfirmationModalView({\n            modalModel: modalModel,\n            template: require('./modals-templates/change-table-column-type.tpl'),\n            renderOpts: {\n              columnName: self.model.get('name'),\n              newType: newType\n            },\n            loadingTitle: _t('components.table.columns.change-type.loading', {\n              columnName: self.model.get('name')\n            }),\n            runAction: function () {\n              changeColumnTypeOperation({\n                columnModel: self.model,\n                newType: newType,\n                onSuccess: function () {\n                  modalModel.destroy();\n                },\n                onError: function (e) {\n                  modalModel.destroy();\n                }\n              });\n            }\n          });\n        }\n      );\n    }\n  },\n\n  _removeColumn: function () {\n    var self = this;\n    this._modals.create(\n      function (modalModel) {\n        return new ConfirmationModalView({\n          modalModel: modalModel,\n          template: require('./modals-templates/remove-table-column.tpl'),\n          renderOpts: {\n            name: self.model.get('name')\n          },\n          loadingTitle: _t('components.table.columns.destroy.loading', {\n            columnName: self.model.get('name')\n          }),\n          runAction: function () {\n            removeTableColumnOperation({\n              columnModel: self.model,\n              onSuccess: function () {\n                modalModel.destroy();\n              },\n              onError: function (e) {\n                modalModel.destroy();\n              }\n            });\n          }\n        });\n      }\n    );\n  },\n\n  _onAttributeDblClicked: function () {\n    if (this.model.isEditable() && !this._tableViewModel.isDisabled()) {\n      this._startEditing();\n    }\n  },\n\n  _initRenameBinds: function () {\n    $(document).bind('keydown', this._onKeyDown);\n  },\n\n  _destroyRenameBinds: function () {\n    $(document).unbind('keydown', this._onKeyDown);\n  },\n\n  _onKeyDown: function (ev) {\n    var keyCode = ev.which;\n    if (keyCode === ENTER_KEY_CODE) {\n      this._saveNewName();\n    } else if (keyCode === ESC_KEY_CODE) {\n      this._finishEditing();\n    }\n  },\n\n  _startEditing: function () {\n    this.$('.js-attribute')\n      .addClass('is-active')\n      .removeAttr('readonly');\n\n    this._initRenameBinds();\n  },\n\n  _finishEditing: function () {\n    this.$('.js-attribute')\n      .val(this.model.get('name'))\n      .removeClass('is-active')\n      .attr('readonly', '');\n\n    this._destroyRenameBinds();\n  },\n\n  _saveNewName: function () {\n    if (this.model.isEditable()) {\n      var newName = this.$('.js-attribute').val();\n      var columnModel = this.model;\n      var oldName = columnModel.get('name');\n\n      if (oldName !== newName && newName !== '') {\n        this._modals.create(\n          function (modalModel) {\n            return new ConfirmationModalView({\n              modalModel: modalModel,\n              template: require('./modals-templates/rename-table-column.tpl'),\n              renderOpts: {\n                columnName: oldName,\n                newName: newName\n              },\n              loadingTitle: _t('components.table.columns.rename.loading', {\n                columnName: oldName,\n                newName: newName\n              }),\n              runAction: function () {\n                renameColumnOperation({\n                  columnModel: columnModel,\n                  newName: newName,\n                  onSuccess: function () {\n                    modalModel.destroy();\n                  },\n                  onError: function (e) {\n                    modalModel.destroy();\n                  }\n                });\n              }\n            });\n          }\n        );\n      }\n    }\n\n    // Setting old name just in case user cancel it\n    this._finishEditing();\n  },\n\n  clean: function () {\n    this._destroyRenameBinds();\n    this._destroyScrollBinding();\n    CoreView.prototype.clean.apply(this);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"\\n    Table-headItemWrapper\\n    '+\n((__t=( name === 'cartodb_id' ||(type === 'geometry' && geometry !== 'point') ? 'Table-headItemWrapper--short' : '' ))==null?'':_.escape(__t))+\n'\\n  \">\\n  <div class=\"u-flex u-justifySpace\">\\n    <input class=\"Table-headItemName CDB-Text CDB-Size-medium is-semibold u-ellipsis js-attribute\" value=\"'+\n((__t=( name ))==null?'':_.escape(__t))+\n'\" title=\"'+\n((__t=( name ))==null?'':_.escape(__t))+\n'\" readonly />\\n\\n    ';\n if (isOrderBy) { \n__p+='\\n      <i class=\"CDB-Size CDB-Size-small CDB-IconFont CDB-IconFont-arrowNext\\n        Table-columnSorted\\n        Table-columnSorted--';\n if (sortBy === 'asc') {\n__p+='asc';\n } else {\n__p+='desc';\n } \n__p+='\\n        u-rSpace u-altTextColor\\n      \"></i>\\n    ';\n } \n__p+='\\n\\n    <button class=\"CDB-Shape-threePoints is-blue is-small js-columnOptions\">\\n      <div class=\"CDB-Shape-threePointsItem\"></div>\\n      <div class=\"CDB-Shape-threePointsItem\"></div>\\n      <div class=\"CDB-Shape-threePointsItem\"></div>\\n    </button>\\n  </div>\\n  <p class=\"CDB-Size-small Table-headItemInfo u-altTextColor\">'+\n((__t=( type ))==null?'':_.escape(__t))+\n'</p>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar CustomListItemView = require('../../custom-list/custom-list-item-view');\nvar CustomListView = require('../../custom-list/custom-view');\nvar QueryColumnModel = require('../../../data/query-column-model');\n\nmodule.exports = CustomListItemView.extend({\n\n  events: _.extend(\n    CustomListItemView.prototype.events,\n    {\n      'click .js-desc': '_onDescClick',\n      'click .js-asc': '_onAscClick',\n      'click .js-order': 'killEvent'\n    }\n  ),\n\n  render: function () {\n    this.$el.empty();\n    this.clearSubViews();\n\n    this.$el.append(\n      this.options.template(\n        {\n          typeLabel: this.options.typeLabel,\n          isSelected: this.model.get('selected'),\n          isDisabled: this.model.get('disabled'),\n          isDestructive: this.model.get('destructive'),\n          isOrderBy: this.model.get('isOrderBy'),\n          sortBy: this.model.get('sortBy'),\n          name: this.model.getName(),\n          val: this.model.getValue()\n        }\n      )\n    );\n\n    this.$el\n      .attr('data-val', this.model.getValue())\n      .toggleClass('is-disabled', !!this.model.get('disabled'));\n\n    return this;\n  },\n\n  _onClick: function (ev) {\n    this.killEvent(ev);\n\n    if (this.model.getValue() === 'change') {\n      this._openSubContextMenu(ev);\n    } else {\n      this.model.set('selected', true);\n    }\n  },\n\n  _hideSubContextMenu: function () {\n    if (this._subContextMenu) {\n      this._subContextMenu.clean();\n      this.removeView(this._subContextMenu);\n      delete this.collection;\n      delete this._subContextMenu;\n    }\n  },\n\n  _openSubContextMenu: function (ev) {\n    if (this._subContextMenu) {\n      this._hideSubContextMenu();\n    }\n\n    var subContextClassName = 'Table-columnTypeMenu ';\n    if (this.model.get('isLastColumns')) {\n      subContextClassName += ' Table-columnTypeMenu--toLeft ';\n    }\n\n    this._subContextMenu = new CustomListView({\n      className: subContextClassName + CustomListView.prototype.className,\n      options: [\n        {\n          label: _t('components.table.columns.types.number'),\n          disabled: !QueryColumnModel.isTypeChangeAllowed(this.model.get('type'), 'number'),\n          val: 'number'\n        }, {\n          label: _t('components.table.columns.types.string'),\n          disabled: !QueryColumnModel.isTypeChangeAllowed(this.model.get('type'), 'string'),\n          val: 'string'\n        }, {\n          label: _t('components.table.columns.types.date'),\n          disabled: !QueryColumnModel.isTypeChangeAllowed(this.model.get('type'), 'date'),\n          val: 'date'\n        }, {\n          label: _t('components.table.columns.types.boolean'),\n          disabled: !QueryColumnModel.isTypeChangeAllowed(this.model.get('type'), 'boolean'),\n          val: 'boolean'\n        }\n      ],\n      showSearch: false,\n      typeLabel: ''\n    });\n\n    this._subContextMenu.collection.bind('change:selected', function (menuItem) {\n      if (!menuItem.get('disabled')) {\n        this.model.set({\n          type: menuItem.getValue(),\n          selected: true\n        });\n      }\n    }, this);\n\n    this.$el.closest('.Table-columnMenu').append(this._subContextMenu.render().el);\n    this._subContextMenu.show();\n    this.addView(this._subContextMenu);\n  },\n\n  _onAscClick: function (ev) {\n    this.killEvent(ev);\n    this.model.set({\n      sort: 'asc',\n      selected: true\n    });\n  },\n\n  _onDescClick: function (ev) {\n    this.killEvent(ev);\n    this.model.set({\n      sort: 'desc',\n      selected: true\n    });\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='';\n if (val === 'order') { \n__p+='\\n  <div class=\"u-flex u-justifySpace CDB-ListDecoration-itemLink js-order\">\\n    <p class=\"CDB-Text CDB-Size-medium\">'+\n((__t=( name ))==null?'':_.escape(__t))+\n'</p>\\n    <ul class=\"u-flex\">\\n      <li class=\"js-asc\">\\n        <i class=\"CDB-Text CDB-IconFont\\n          CDB-IconFont-arrowNext u-actionTextColor\\n          Table-columnSorted\\n          Table-columnSorted--asc\\n           ';\n if (isOrderBy && sortBy === 'asc') { \n__p+='is-disabled';\n } \n__p+='\\n           ';\n if (isOrderBy && sortBy === 'desc') { \n__p+='is-semibold';\n } \n__p+='\\n        \"></i>\\n      </li>\\n      <li class=\"js-desc u-lSpace--xl\">\\n        <i class=\"CDB-Text CDB-IconFont\\n          CDB-IconFont-arrowNext u-actionTextColor\\n          Table-columnSorted\\n          Table-columnSorted--desc\\n           ';\n if (isOrderBy && sortBy === 'desc') { \n__p+='is-disabled';\n } \n__p+='\\n           ';\n if (isOrderBy && sortBy === 'asc') { \n__p+='is-semibold';\n } \n__p+='\\n        \"></i>\\n      </li>\\n    </ul>\\n  </div>\\n';\n } else if (val === 'change') { \n__p+='\\n  <div class=\"CDB-ListDecoration-itemLink u-actionTextColor u-flex u-justifySpace u-alignCenter\" title=\"'+\n((__t=( name ))==null?'':_.escape(__t))+\n'\">\\n    <span>'+\n((__t=( name ))==null?'':_.escape(__t))+\n'</span>\\n    <i class=\"CDB-Text CDB-Size-small is-semibold CDB-IconFont CDB-IconFont-rArrowLight\"></i>\\n  </div>\\n';\n } else { \n__p+='\\n  <div class=\"CDB-ListDecoration-itemLink\\n    ';\n if (isDestructive) { \n__p+='  u-errorTextColor ';\n } else { \n__p+=' u-actionTextColor ';\n } \n__p+='\\n    ';\n if (val === 'change') { \n__p+=' u-flex ';\n } \n__p+='\\n    \" title=\"'+\n((__t=( name ))==null?'':_.escape(__t))+\n'\">\\n    '+\n((__t=( name ))==null?'':_.escape(__t))+\n'\\n    ';\n if (val === 'change') { \n__p+='\\n      <span>\\n        <i class=\"CDB-Text CDB-Size-small is-semibold CDB-IconFont CDB-IconFont-rArrowLight\"></i>\\n      </span>\\n    ';\n } \n__p+='\\n  </div>\\n';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var $ = require('jquery');\nvar CoreView = require('backbone/core-view');\nvar TableHeadItemView = require('./table-head-item-view');\nvar template = require('./table-head.tpl');\n\n/*\n *  Main table head view\n */\n\nmodule.exports = CoreView.extend({\n  className: 'Table-head',\n  tagName: 'table',\n\n  initialize: function (opts) {\n    if (!opts.columnsCollection) throw new Error('columnsCollection is required');\n    if (!opts.tableViewModel) throw new Error('tableViewModel is required');\n    if (!opts.queryGeometryModel) throw new Error('queryGeometryModel is required');\n    if (!opts.modals) throw new Error('modals is required');\n\n    this._columnsCollection = opts.columnsCollection;\n    this._tableViewModel = opts.tableViewModel;\n    this._queryGeometryModel = opts.queryGeometryModel;\n    this._modals = opts.modals;\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this.$el.append(template());\n    this._columnsCollection.each(this._renderColumnHead, this);\n    return this;\n  },\n\n  _initBinds: function () {\n    this._queryGeometryModel.bind('change:simple_geom', this.render, this);\n    this.add_related_model(this._queryGeometryModel);\n    this._tableViewModel.bind('change:sort_order change:order_by', this.render, this);\n    this.add_related_model(this._tableViewModel);\n    this._columnsCollection.bind('reset', function () {\n      this.render();\n\n      if (this._newColumn) {\n        var scrollWidth = this.$el.get(0).scrollWidth;\n\n        setTimeout(function () {\n          this._scrollToLeft({\n            pos: scrollWidth\n          });\n        }.bind(this), 500);\n\n        delete this._newColumn;\n      }\n    }, this);\n    this._columnsCollection.bind('add', function (mdl) {\n      this._newColumn = mdl;\n    }, this);\n    this.add_related_model(this._columnsCollection);\n  },\n\n  _renderColumnHead: function (mdl) {\n    if (!this._tableViewModel.isDisabled() && mdl.get('name') === 'the_geom_webmercator') {\n      return;\n    }\n\n    var view = new TableHeadItemView({\n      model: mdl,\n      modals: this._modals,\n      columnsCollection: this._columnsCollection,\n      tableViewModel: this._tableViewModel,\n      simpleGeometry: this._queryGeometryModel.get('simple_geom')\n    });\n    this.$('.js-headRow').append(view.render().el);\n    this.addView(view);\n  },\n\n  _scrollToLeft: function (opts) {\n    opts = opts || {};\n    $('.Table').animate({\n      scrollLeft: opts.pos || 0\n    }, opts.speed || 'slow');\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<thead>\\n  <tr class=\"js-headRow\"></tr>\\n</thead>\\n';\n}\nreturn __p;\n};\n",
    "var Notifier = require('../../../components/notifier/notifier');\nvar errorParser = require('../../../helpers/error-parser');\n\nmodule.exports = function (opts) {\n  if (!opts.columnsCollection) throw new Error('columnsCollection is required');\n\n  var columnsCollection = opts.columnsCollection;\n  var successCallback = opts.onSuccess;\n  var errorCallback = opts.onError;\n  var notification = Notifier.addNotification({\n    status: 'loading',\n    info: _t('components.table.columns.create.loading'),\n    closable: false\n  });\n\n  columnsCollection.addColumn({\n    success: function (mdl, attrs) {\n      successCallback && successCallback(mdl, attrs);\n      notification.set({\n        status: 'success',\n        info: _t('components.table.columns.create.success', { columnName: attrs.name }),\n        closable: true\n      });\n    },\n    error: function (mdl, e) {\n      errorCallback && errorCallback(mdl, e);\n      notification.set({\n        status: 'error',\n        info: _t('components.table.columns.create.error', { error: errorParser(e) }),\n        closable: true\n      });\n    }\n  });\n};\n",
    "var Notifier = require('../../../components/notifier/notifier');\nvar errorParser = require('../../../helpers/error-parser');\n\nmodule.exports = function (opts) {\n  if (!opts.rowsCollection) { throw new Error('rowsCollection is required'); }\n\n  var rowsCollection = opts.rowsCollection;\n  var successCallback = opts.onSuccess;\n  var errorCallback = opts.onError;\n  var notification = Notifier.addNotification({\n    status: 'loading',\n    info: _t('components.table.rows.create.loading'),\n    closable: false\n  });\n\n  rowsCollection.addRow({\n    success: function (mdl, attrs) {\n      successCallback && successCallback(mdl, attrs);\n      notification.set({\n        status: 'success',\n        info: _t('components.table.rows.create.success'),\n        closable: true\n      });\n    },\n    error: function (mdl, e) {\n      errorCallback && errorCallback(mdl, e);\n      notification.set({\n        status: 'error',\n        info: _t('components.table.rows.create.error', { error: errorParser(e) }),\n        closable: true\n      });\n    }\n  });\n};\n",
    "var Notifier = require('../../../components/notifier/notifier');\nvar errorParser = require('../../../helpers/error-parser');\n\nmodule.exports = function (opts) {\n  if (!opts.columnModel) { throw new Error('columnModel is required'); }\n  if (!opts.newType) { throw new Error('newType is required'); }\n\n  var columnModel = opts.columnModel;\n  var newType = opts.newType;\n\n  var successCallback = opts.onSuccess;\n  var errorCallback = opts.onError;\n\n  var notification = Notifier.addNotification({\n    status: 'loading',\n    info: _t('components.table.columns.change-type.loading', {\n      columnName: columnModel.get('name')\n    }),\n    closable: false\n  });\n\n  columnModel.save({\n    type: newType\n  }, {\n    wait: true,\n    success: function (mdl, attrs) {\n      successCallback && successCallback(mdl, attrs);\n      notification.set({\n        status: 'success',\n        info: _t('components.table.columns.change-type.success', {\n          columnName: columnModel.get('name'),\n          newType: newType\n        }),\n        closable: true\n      });\n    },\n    error: function (mdl, e) {\n      errorCallback && errorCallback(mdl, e);\n      notification.set({\n        status: 'error',\n        info: _t('components.table.columns.change-type.error', {\n          columnName: columnModel.get('name'),\n          newType: newType,\n          error: errorParser(e)\n        }),\n        closable: true\n      });\n    }\n  });\n};\n",
    "var Notifier = require('../../../components/notifier/notifier');\nvar errorParser = require('../../../helpers/error-parser');\n\nmodule.exports = function (opts) {\n  if (!opts.rowModel) throw new Error('rowModel is required');\n  if (opts.newValue === undefined) throw new Error('newValue is required');\n  if (!opts.attribute) throw new Error('attribute is required');\n\n  var rowModel = opts.rowModel;\n  var newValue = opts.newValue;\n  var attribute = opts.attribute;\n  var cartodbId = rowModel.get('cartodb_id');\n  var successCallback = opts.onSuccess;\n  var errorCallback = opts.onError;\n  var notification = Notifier.addNotification({\n    status: 'loading',\n    info: _t('components.table.rows.edit.loading', {\n      attribute: attribute,\n      cartodbId: cartodbId\n    }),\n    closable: false\n  });\n\n  // In order to preserve \"previous\" attribute\n  rowModel.set(attribute, newValue);\n  rowModel.save(null, {\n    success: function (mdl, attrs) {\n      successCallback && successCallback(mdl, attrs);\n      notification.set({\n        status: 'success',\n        info: _t('components.table.rows.edit.success', {\n          attribute: attribute,\n          cartodbId: cartodbId\n        }),\n        closable: true\n      });\n    },\n    error: function (mdl, e) {\n      errorCallback && errorCallback(mdl, e);\n      notification.set({\n        status: 'error',\n        info: _t('components.table.rows.edit.error', {\n          attribute: attribute,\n          cartodbId: cartodbId,\n          error: errorParser(e)\n        }),\n        closable: true\n      });\n    }\n  });\n};\n",
    "var Notifier = require('../../../components/notifier/notifier');\nvar errorParser = require('../../../helpers/error-parser');\n\nmodule.exports = function (opts) {\n  if (!opts.columnModel) { throw new Error('columnModel is required'); }\n\n  var columnModel = opts.columnModel;\n  var successCallback = opts.onSuccess;\n  var errorCallback = opts.onError;\n  var notification = Notifier.addNotification({\n    status: 'loading',\n    info: _t('components.table.columns.destroy.loading', { columnName: columnModel.get('name') }),\n    closable: false\n  });\n\n  columnModel.destroy({\n    wait: true,\n    success: function (mdl, attrs) {\n      successCallback && successCallback(mdl, attrs);\n      notification.set({\n        status: 'success',\n        info: _t('components.table.columns.destroy.success', { columnName: columnModel.get('name') }),\n        closable: true\n      });\n    },\n    error: function (mdl, e) {\n      errorCallback && errorCallback(mdl, e);\n      notification.set({\n        status: 'error',\n        info: _t('components.table.columns.destroy.error', {\n          columnName: columnModel.get('name'),\n          error: errorParser(e)\n        }),\n        closable: true\n      });\n    }\n  });\n};\n",
    "var Notifier = require('../../../components/notifier/notifier');\nvar errorParser = require('../../../helpers/error-parser');\n\nmodule.exports = function (opts) {\n  if (!opts.rowModel) { throw new Error('rowModel is required'); }\n\n  var rowModel = opts.rowModel;\n  var successCallback = opts.onSuccess;\n  var errorCallback = opts.onError;\n  var cartodbId = rowModel.get('cartodb_id');\n  var notification = Notifier.addNotification({\n    status: 'loading',\n    info: _t('components.table.rows.destroy.loading', { cartodb_id: cartodbId }),\n    closable: false\n  });\n\n  rowModel.destroy({\n    wait: true,\n    success: function (mdl, attrs) {\n      successCallback && successCallback(mdl, attrs);\n      notification.set({\n        status: 'success',\n        info: _t('components.table.rows.destroy.success', { cartodb_id: cartodbId }),\n        closable: true\n      });\n    },\n    error: function (mdl, e) {\n      errorCallback && errorCallback(mdl, e);\n      notification.set({\n        status: 'error',\n        info: _t('components.table.rows.destroy.error', { cartodb_id: cartodbId, error: errorParser(e) }),\n        closable: true\n      });\n    }\n  });\n};\n",
    "var Notifier = require('../../../components/notifier/notifier');\nvar errorParser = require('../../../helpers/error-parser');\n\nmodule.exports = function (opts) {\n  if (!opts.columnModel) { throw new Error('columnModel is required'); }\n  if (!opts.newName) { throw new Error('newName is required'); }\n\n  var columnModel = opts.columnModel;\n  var oldName = columnModel.get('name');\n  var newName = opts.newName;\n\n  var successCallback = opts.onSuccess;\n  var errorCallback = opts.onError;\n\n  var notification = Notifier.addNotification({\n    status: 'loading',\n    info: _t('components.table.columns.rename.loading', { oldName: oldName, newName: newName }),\n    closable: false\n  });\n\n  columnModel.save({\n    new_name: newName,\n    old_name: columnModel.get('name')\n  }, {\n    wait: true,\n    success: function (mdl, attrs) {\n      successCallback && successCallback(mdl, attrs);\n      notification.set({\n        status: 'success',\n        info: _t('components.table.columns.rename.success', {\n          columnName: oldName,\n          newName: newName\n        }),\n        closable: true\n      });\n    },\n    error: function (mdl, e) {\n      errorCallback && errorCallback(mdl, e);\n      notification.set({\n        status: 'error',\n        info: _t('components.table.columns.rename.error', {\n          columnName: oldName,\n          newName: newName,\n          error: errorParser(e)\n        }),\n        closable: true\n      });\n    }\n  });\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CDB-LoaderIcon is-dark\">\\n  <svg class=\"CDB-LoaderIcon-spinner\" viewbox=\"0 0 50 50\">\\n    <circle class=\"CDB-LoaderIcon-path\" cx=\"25\" cy=\"25\" r=\"20\" fill=\"none\"/>\\n  </svg>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar template = require('./table-paginator.tpl');\nvar templateLoader = require('./table-paginator-loader.tpl');\nvar Notifier = require('../../../components/notifier/notifier');\nvar errorParser = require('../../../helpers/error-parser');\n\nmodule.exports = CoreView.extend({\n\n  tagName: 'div',\n  className: 'Table-paginator js-tablePaginator',\n\n  events: {\n    'click .js-prev': '_onPrevPage',\n    'click .js-next': '_onNextPage'\n  },\n\n  initialize: function (opts) {\n    if (!opts.rowsCollection) throw new Error('rowsCollection is required');\n    if (!opts.tableViewModel) throw new Error('tableViewModel is required');\n\n    this._tableViewModel = opts.tableViewModel;\n    this._rowsCollection = opts.rowsCollection;\n\n    this._rowsCollection.bind('loading', function (item) {\n      // Don't take into account row model loading triggers\n      if (item.models) {\n        this._isLoading = true;\n      }\n    }, this);\n    this._rowsCollection.bind('add remove', this.render, this);\n    this._tableViewModel.bind('change:page', this._onTablePageChange, this);\n    this.add_related_model(this._tableViewModel);\n    this.add_related_model(this._rowsCollection);\n  },\n\n  render: function () {\n    var rowsSize = this._rowsCollection.size();\n    var page = this._tableViewModel.get('page');\n    var maxRowsPerPage = this._rowsCollection.DEFAULT_FETCH_OPTIONS.rows_per_page;\n\n    this.$el.html(\n      template({\n        page: this._tableViewModel.get('page'),\n        size: rowsSize,\n        isNextAvailable: rowsSize >= maxRowsPerPage,\n        isPrevAvailable: page > 0\n      })\n    );\n\n    this.$el.toggleClass('Table-paginator--relative', !!this._tableViewModel.get('relativePositionated'));\n    return this;\n  },\n\n  _onTablePageChange: function () {\n    this._rowsCollection.fetch({\n      data: _.extend(\n        this._tableViewModel.pick('page', 'order_by', 'sort_order'),\n        {\n          exclude: !this._tableViewModel.isCustomQueryApplied() ? ['the_geom_webmercator'] : []\n        }\n      ),\n      error: function (mdl, response) {\n        this._isLoading = false;\n        this.render();\n\n        Notifier.addNotification({\n          status: 'error',\n          info: _t('components.table.rows.paginator.error', { error: errorParser(response) }),\n          closable: true\n        });\n      }.bind(this)\n    });\n  },\n\n  _onPrevPage: function (ev) {\n    if (!this._isLoading) {\n      this.$('.js-prev').html(templateLoader());\n      this._tableViewModel.set('page', this._tableViewModel.get('page') - 1);\n    }\n  },\n\n  _onNextPage: function (ev) {\n    if (!this._isLoading) {\n      this.$('.js-next').html(templateLoader());\n      this._tableViewModel.set('page', this._tableViewModel.get('page') + 1);\n    }\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<button class=\"Table-paginatorButton Table-paginatorButton--prev\\n  ';\n if (isPrevAvailable) { \n__p+='\\n    js-prev\\n  ';\n } \n__p+='\\n\">\\n  <i class=\"CDB-Text is-semibold CDB-IconFont CDB-IconFont-lArrowLight CDB-Size-small\\n  ';\n if (isPrevAvailable) { \n__p+='\\n    u-actionTextColor\\n  ';\n } else { \n__p+='\\n    u-hintTextColor\\n  ';\n } \n__p+='\\n  \"></i>\\n</button>\\n<p class=\"Table-paginatorText CDB-Text CDB-Size-small is-semibold u-upperCase\">\\n  ';\n if (!size) {\n__p+='\\n   <span class=\"u-mainTextColor\"></span>\\n  ';\n } else { \n__p+='\\n    <span class=\"u-mainTextColor\">'+\n((__t=( (page * 40) + 1 ))==null?'':_.escape(__t))+\n'</span>\\n    <span class=\"u-altTextColor u-lSpace u-rSpace\">'+\n((__t=( _t('components.table.rows.paginator.to') ))==null?'':_.escape(__t))+\n'</span>\\n    <span class=\"u-mainTextColor\">'+\n((__t=( (page * 40) + size ))==null?'':_.escape(__t))+\n'</span>\\n  ';\n } \n__p+='\\n</p>\\n<button class=\"Table-paginatorButton Table-paginatorButton--next\\n  ';\n if (isNextAvailable) { \n__p+='\\n    js-next\\n  ';\n } \n__p+='\\n\">\\n  <i class=\"CDB-Text is-semibold CDB-IconFont CDB-IconFont-rArrowLight CDB-Size-small\\n  ';\n if (isNextAvailable) { \n__p+='\\n    u-actionTextColor\\n  ';\n } else { \n__p+='\\n    u-hintTextColor\\n  ';\n } \n__p+='\\n  \"></i>\\n</button>\\n';\n}\nreturn __p;\n};\n",
    "var TableView = require('./table-view');\nvar QueryColumnsCollection = require('../../data/query-columns-collection');\nvar TableNameUtils = require('../../helpers/table-name-utils');\nvar checkAndBuildOpts = require('../../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'analysisDefinitionNodeModel',\n  'configModel',\n  'modals',\n  'userModel'\n];\n\n/**\n *  Table manager that generates necessary models/collections\n *  for the view\n *\n */\n\nmodule.exports = {\n  create: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    // Adds the owner username if it's in an organization and the table name is not already qualified\n    var tableName = this._analysisDefinitionNodeModel.get('table_name');\n    var userName = TableNameUtils.getUsername(tableName) || this._userModel.get('username');\n    tableName = TableNameUtils.getQualifiedTableName(\n      tableName,\n      userName,\n      this._userModel.isInsideOrg()\n    );\n\n    var querySchemaModel = this._analysisDefinitionNodeModel.querySchemaModel;\n\n    var columnsCollection = new QueryColumnsCollection(\n      querySchemaModel.columnsCollection.toJSON(),\n      {\n        configModel: this._configModel,\n        tableName: tableName,\n        querySchemaModel: querySchemaModel\n      }\n    );\n\n    return new TableView({\n      relativePositionated: opts.relativePositionated,\n      modals: this._modals,\n      analysisDefinitionNodeModel: this._analysisDefinitionNodeModel,\n      columnsCollection: columnsCollection,\n      tableName: tableName\n    });\n  },\n\n  destroy: function (tableView) {\n    if (!tableView) throw new Error('tableView object is needed');\n    tableView.clean();\n  }\n};\n",
    "var Backbone = require('backbone');\n\n/**\n *  Table view model\n */\n\nmodule.exports = Backbone.Model.extend({\n  defaults: {\n    page: 0,\n    order_by: '',\n    sort_order: '',\n    readonly: false,\n    tableName: ''\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.analysisDefinitionNodeModel) throw new Error('analysisDefinitionNodeModel is required');\n    if (!opts.columnsCollection) throw new Error('columnsCollection is required');\n\n    this._analysisDefinitionNodeModel = opts.analysisDefinitionNodeModel;\n    this._columnsCollection = opts.columnsCollection;\n\n    this._setOrderAndSort();\n\n    this.listenTo(this._columnsCollection, 'reset', this._setOrderAndSort);\n  },\n\n  _setOrderAndSort: function () {\n    var hasCartodbId = this._columnsCollection.where({name: 'cartodb_id'}).length;\n\n    if (hasCartodbId && !this.isCustomQueryApplied()) {\n      this.set({\n        'order_by': 'cartodb_id',\n        'sort_order': 'asc'\n      }, {\n        silent: true\n      });\n    }\n  },\n\n  resetFetchDefaults: function () {\n    this.set({\n      page: this.defaults.page,\n      order_by: '',\n      sort_order: ''\n    }, {\n      silent: true\n    });\n  },\n\n  isDisabled: function () {\n    return this._analysisDefinitionNodeModel.isReadOnly();\n  },\n\n  isCustomQueryApplied: function () {\n    return this._analysisDefinitionNodeModel.isCustomQueryApplied();\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar $ = require('jquery');\nvar TableViewModel = require('./table-view-model.js');\nvar TableHeadView = require('./head/table-head-view');\nvar TableBodyView = require('./body/table-body-view');\nvar addTableRow = require('./operations/table-add-row');\nvar addTableColumn = require('./operations/table-add-column');\nvar SQLUtils = require('../../helpers/sql-utils');\nvar checkAndBuildOpts = require('../../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'analysisDefinitionNodeModel',\n  'columnsCollection',\n  'modals'\n];\n\n/*\n *  Main table view\n */\n\nmodule.exports = CoreView.extend({\n\n  className: 'Table-wrapper',\n  tagName: 'div',\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    this._rowsCollection = this._analysisDefinitionNodeModel.queryRowsCollection;\n    this._queryGeometryModel = this._analysisDefinitionNodeModel.queryGeometryModel;\n    this._querySchemaModel = this._analysisDefinitionNodeModel.querySchemaModel;\n    this._tableModel = this._analysisDefinitionNodeModel.isSourceType() && this._analysisDefinitionNodeModel.getTableModel();\n\n    this._tableViewModel = new TableViewModel({\n      relativePositionated: opts.relativePositionated,\n      tableName: opts.tableName\n    }, {\n      analysisDefinitionNodeModel: this._analysisDefinitionNodeModel,\n      columnsCollection: this._columnsCollection\n    });\n\n    this._initBinds();\n\n    if (this._queryGeometryModel.shouldFetch()) {\n      this._queryGeometryModel.fetch();\n    }\n\n    if (this._querySchemaModel.shouldFetch()) {\n      this._querySchemaModel.fetch();\n    } else if (this._rowsCollection.shouldFetch()) {\n      this._fetchRowsData();\n    }\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    var tableElement = $('<div>').addClass('Table js-table');\n    this.$el.append(tableElement);\n    this._initViews();\n\n    this.$('.js-table').toggleClass('Table--relative', !!this._tableViewModel.get('relativePositionated'));\n    this._setDisableState();\n    return this;\n  },\n\n  _initBinds: function () {\n    this._onChangeQueryOrStatus = this._onChangeQueryOrStatus.bind(this);\n\n    this.listenTo(this._querySchemaModel, 'change:query change:status', _.debounce(this._onChangeQueryOrStatus, 100));\n    this.listenTo(this._querySchemaModel, 'change:status', this._setDisableState);\n    this.listenTo(this._querySchemaModel, 'change:query', this._onQueryChanged);\n    this.listenTo(this._querySchemaModel, 'change:status', this._fetchRowsData);\n    this.listenTo(this._tableViewModel, 'change:sort_order change:order_by', this._fetchRowsData);\n\n    if (this._tableModel && this._tableModel.isSync()) {\n      var syncModel = this._tableModel.getSyncModel();\n      this.listenTo(syncModel, 'destroy', this.render);\n    }\n  },\n\n  _setDisableState: function () {\n    this.$('.js-table').toggleClass('is-disabled', !!this._tableViewModel.isDisabled());\n  },\n\n  _fetchRowsData: function (mdl) {\n    var attrsChanged = mdl && _.keys(mdl.changed);\n    var altersData = SQLUtils.altersData(this._querySchemaModel.get('query'));\n    var isCustomQueryApplied = this._tableViewModel.isCustomQueryApplied();\n    var changeComeFromSortOrOrder = false;\n\n    if (attrsChanged && (_.contains(attrsChanged, 'sort_order') || _.contains(attrsChanged, 'order_by'))) {\n      changeComeFromSortOrOrder = true;\n    }\n\n    if (this._querySchemaModel.isFetched() && !altersData) {\n      this._rowsCollection.fetch({\n        data: {\n          page: this._tableViewModel.get('page'),\n          order_by: !isCustomQueryApplied || changeComeFromSortOrOrder ? this._tableViewModel.get('order_by') : '',\n          sort_order: !isCustomQueryApplied || changeComeFromSortOrOrder ? this._tableViewModel.get('sort_order') : '',\n          exclude: !isCustomQueryApplied || changeComeFromSortOrOrder ? ['the_geom_webmercator'] : []\n        }\n      });\n    }\n  },\n\n  _initViews: function () {\n    var tableHeadView = new TableHeadView({\n      modals: this._modals,\n      queryGeometryModel: this._queryGeometryModel,\n      columnsCollection: this._columnsCollection,\n      tableViewModel: this._tableViewModel\n    });\n\n    this.addView(tableHeadView);\n    this.$('.js-table').append(tableHeadView.render().el);\n\n    var tableBodyView = new TableBodyView({\n      modals: this._modals,\n      columnsCollection: this._columnsCollection,\n      rowsCollection: this._rowsCollection,\n      queryGeometryModel: this._queryGeometryModel,\n      querySchemaModel: this._querySchemaModel,\n      tableViewModel: this._tableViewModel\n    });\n\n    this.addView(tableBodyView);\n    this.$('.js-table').append(tableBodyView.render().el);\n  },\n\n  _onChangeQueryOrStatus: function () {\n    var schemaStatus = this._querySchemaModel.get('status');\n    var geometryStatus = this._queryGeometryModel.get('status');\n\n    if (schemaStatus === 'unfetched' && this._querySchemaModel.canFetch()) {\n      this._querySchemaModel.fetch();\n    }\n\n    if (geometryStatus === 'unfetched' && this._queryGeometryModel.canFetch()) {\n      this._queryGeometryModel.fetch();\n    }\n  },\n\n  addRow: function () {\n    addTableRow({\n      tableViewModel: this._tableViewModel,\n      rowsCollection: this._rowsCollection\n    });\n  },\n\n  addColumn: function () {\n    addTableColumn({\n      tableViewModel: this._tableViewModel,\n      columnsCollection: this._columnsCollection\n    });\n  },\n\n  getColumnsCollection: function () {\n    return this._columnsCollection;\n  },\n\n  _onQueryChanged: function () {\n    this._tableViewModel.resetFetchDefaults();\n  },\n\n  // Remove elements that are not applied in the view\n  remove: function () {\n    $('.Table-paginator').remove();\n    CoreView.prototype.remove.apply(this);\n  }\n\n});\n",
    "var CoreView = require('backbone/core-view');\nrequire('tipsy');\n\n/**\n *  Tipsy tooltip view.\n *\n *  - Needs an element to work.\n *  - Inits tipsy library.\n *  - Clean bastard tipsy bindings easily.\n *\n */\n\nmodule.exports = CoreView.extend({\n  options: {\n    gravity: 's',\n    opacity: 1,\n    fade: true\n  },\n\n  initialize: function (opts) {\n    if (!opts.el) throw new Error('Element is needed to have tipsy tooltip working');\n    this._tipsyOpenedManually = opts.trigger === 'manual';\n    this._initTipsy();\n  },\n\n  _initTipsy: function () {\n    this.$el.tipsy(this.options);\n    this.tipsy = this.$el.data('tipsy');\n  },\n\n  showTipsy: function () {\n    this.$el.tipsy('show');\n  },\n\n  hideTipsy: function () {\n    this.$el.tipsy('hide');\n  },\n\n  destroyTipsy: function () {\n    if (this.tipsy) {\n      // tipsy does not return this\n      this.tipsy.hide();\n      this.$el.unbind('mouseleave mouseenter');\n    }\n    if (this._tipsyOpenedManually) {\n      this.$el.tipsy('hide');\n    }\n\n    this.$el.removeData('tipsy');\n    delete this.tipsy;\n  },\n\n  clean: function () {\n    this.destroyTipsy();\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./toggler.tpl');\n\nmodule.exports = CoreView.extend({\n\n  className: 'Toggle',\n\n  events: {\n    'click .js-input': '_onClick'\n  },\n\n  initialize: function (opts) {\n    if (!opts.editorModel) throw new Error('editorModel should be provided');\n\n    this._editorModel = opts.editorModel;\n    this._labelsArray = opts.labels;\n    this._isDisableable = opts.isDisableable;\n\n    this.listenTo(this._editorModel, 'change:edition', this.render);\n    this.listenTo(this._editorModel, 'change:disabled', this.render);\n    this.add_related_model(this._editorModel);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this._initViews();\n    return this;\n  },\n\n  _initViews: function () {\n    var checked = this._editorModel.get('edition');\n    var disabled = this._editorModel.get('disabled') && this._isDisableable;\n\n    var _template = template({\n      labels: this._labelsArray,\n      checked: checked,\n      disabled: disabled\n    });\n\n    this.$el.append(_template);\n    return this;\n  },\n\n  _onClick: function () {\n    var checked = this._editorModel.get('edition');\n    this._editorModel.set({ edition: !checked });\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CDB-Text CDB-Size-small is-semibold u-rSpace--xl';\n if (disabled) { \n__p+=' is-disabled';\n } \n__p+='\">\\n  <label class=\"u-iBlock u-upperCase\">'+\n((__t=( labels[0] ))==null?'':_.escape(__t))+\n'</label>\\n  <input class=\"CDB-Toggle u-iBlock js-input\" type=\"checkbox\"\\n    ';\n if (disabled) { \n__p+=' disabled';\n } \n__p+='\\n    ';\n if (checked) { \n__p+=' checked ';\n } \n__p+=' >\\n  <span class=\"u-iBlock CDB-ToggleFace\"></span>\\n  <label class=\"u-iBlock u-upperCase\">'+\n((__t=( labels[1] ))==null?'':_.escape(__t))+\n'</label>\\n</div>';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./undo-redo.tpl');\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-redo': '_onRedoClick',\n    'click .js-undo': '_onUndoClick',\n    'click .js-apply': '_onApplyClick',\n    'click .js-clear': '_onClearClick'\n  },\n\n  options: {\n    applyButton: false,\n    cancelButton: false\n  },\n\n  initialize: function (opts) {\n    if (!opts.editorModel) throw new Error('editorModel is required');\n    if (!opts.trackModel) throw new Error('trackModel is required');\n\n    this._trackModel = opts.trackModel;\n    this._editorModel = opts.editorModel;\n    this._clearModel = opts.clearModel;\n\n    this._initBinds();\n  },\n\n  render: function () {\n    var canClear = false;\n    if (this._clearModel) {\n      canClear = this._clearModel.get('visible') === true;\n    }\n\n    this.$el.html(\n      template({\n        canUndo: this._trackModel.canUndo(),\n        canRedo: this._trackModel.canRedo(),\n        canApply: this.options.applyButton && this._editorModel.isEditing(),\n        canClear: canClear\n      })\n    );\n    this._checkButtonsStyle();\n    return this;\n  },\n\n  _initBinds: function () {\n    this._trackModel.bind('undo redo', this.render, this);\n    this._trackModel.bind('unredoChanged', this.render, this);\n    this._editorModel.bind('change:edition', this._checkButtonsStyle, this);\n    this.add_related_model(this._trackModel);\n    this.add_related_model(this._editorModel);\n\n    if (this._clearModel) {\n      this._clearModel.bind('change', this.render, this);\n      this.add_related_model(this._clearModel);\n    }\n  },\n\n  _onUndoClick: function () {\n    if (this._trackModel.canUndo()) {\n      this._trackModel.undo();\n    }\n  },\n\n  _onRedoClick: function () {\n    if (this._trackModel.canRedo()) {\n      this._trackModel.redo();\n    }\n  },\n\n  _onApplyClick: function () {\n    if (this.options.applyButton && this.options.onApplyClick) {\n      this.options.onApplyClick();\n    }\n  },\n\n  _onClearClick: function () {\n    if (this.options.clearButton && this.options.onClearClick) {\n      this.options.onClearClick();\n    }\n  },\n\n  _checkButtonsStyle: function (m) {\n    var editing = this._editorModel.isEditing();\n    this._getIcons().toggleClass('u-whiteTextColor', editing);\n  },\n\n  _getIcons: function () {\n    return this.$('.js-theme');\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-alignCenter\">\\n  <button class=\"js-undo\">\\n    <i class=\"CDB-IconFont CDB-IconFont-undo Size-large u-actionTextColor js-theme ';\n if (!canUndo) { \n__p+='is-disabled';\n } \n__p+='\"></i>\\n  </button>\\n  <button class=\"u-lSpace--xl js-redo\">\\n    <i class=\"CDB-IconFont CDB-IconFont-redo Size-large u-actionTextColor js-theme ';\n if (!canRedo) { \n__p+='is-disabled';\n } \n__p+='\"></i>\\n  </button>\\n  ';\n if (canClear) { \n__p+='\\n  <button class=\"u-lSpace--xl CDB-Button CDB-Button--secondary CDB-Button--white js-clear\">\\n    <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-small\">'+\n((__t=( _t('components.undo-redo.clear') ))==null?'':_.escape(__t))+\n'</span>\\n  </button>\\n  ';\n } \n__p+='\\n  ';\n if (canApply) { \n__p+='\\n  <button class=\"u-lSpace--xl CDB-Button CDB-Button--primary js-apply\">\\n    <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-small\">'+\n((__t=( _t('components.undo-redo.apply') ))==null?'':_.escape(__t))+\n'</span>\\n  </button>\\n  ';\n } \n__p+='\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\n\n/**\n * Convenient factory to create views without having to create new files.\n */\nmodule.exports = {\n\n  /**\n   * @param {String} html e.g. '<div>whatever</div>'\n   * @param {Object,undefined} viewOpts view options, .e.g {className: 'Whatever'}\n   * @return {Object} instance of CoreView, which takes two params of template and templateData\n   */\n  createByHTML: function (html, viewOpts) {\n    var view = new CoreView(viewOpts);\n    view.render = function () {\n      this.$el.html(html);\n      return this;\n    };\n\n    return view;\n  },\n\n  /**\n   * @param {Function} template e.g. from a `require('-/my-template.tpl')`\n   * @param {Object,undefined} templatedata\n   * @param {Object,undefined} viewOpts view options, .e.g {className: 'Whatever'}\n   * @return {Object} instance of CoreView, which takes two params of template and templateData\n   */\n  createByTemplate: function (template, templateData, viewOpts) {\n    var view = new CoreView(viewOpts);\n    view.render = function () {\n      this.$el.html(\n        template(templateData)\n      );\n      return this;\n    };\n\n    return view;\n  },\n\n  /**\n   * Creates an anonymous view to render a list of views as one.\n   * Useful when wanting to interact with other components that requires a single view as content.\n   *\n   * @example\n   *   var createViewList = [\n   *     function() { return new HeaderView({}); },\n   *     function() { return new ItemsView({}); },\n   *     function() { return new FooterView({}); }\n   *   ]\n   *   viewFactory.createListView(createViewList, {className: 'jsdoc-example'})\n   *\n   * @param {Array} fns - list of functions, each which should return a view representing an item in the list\n   * @param {Object} viewOpts\n   * @return {Object} A view\n   */\n  createListView: function (createViewFns, viewOpts) {\n    if (!(createViewFns && createViewFns.forEach)) throw new Error('createViewFns is required as an iterable list');\n    if (!_.all(createViewFns, _.isFunction)) throw new Error('createViewFns must only contain functions');\n\n    var listView = new CoreView(viewOpts);\n\n    listView.render = function () {\n      this.clearSubViews();\n\n      createViewFns.forEach(function (createItemView) {\n        var view = createItemView();\n        this.addView(view);\n        this.$el.append(view.render().el);\n      }, this);\n\n      return this;\n    };\n\n    return listView;\n  }\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./panel-with-options.tpl');\nvar InfoboxView = require('../../components/infobox/infobox-view');\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    if (!opts.createContentView) throw new Error('createContentView factory function is mandatory');\n    if (!opts.editorModel) throw new Error('editorModel is required');\n\n    this.template = this.options.template || template;\n\n    this._createContentView = opts.createContentView;\n    this._editorModel = opts.editorModel;\n    this._createControlView = opts.createControlView;\n    this._createActionView = opts.createActionView;\n    this._infoboxModel = opts.infoboxModel;\n    this._infoboxCollection = opts.infoboxCollection;\n\n    this._editorModel.on('change:edition', this._setStyleMenu, this);\n    this.add_related_model(this._editorModel);\n  },\n\n  render: function () {\n    var contentView;\n    var controlView;\n    var actionView;\n    var infoboxView;\n\n    this.clearSubViews();\n    this.$el.empty();\n\n    this.$el.html(this.template());\n\n    contentView = this._createContentView();\n\n    this._content().html(contentView.render().el);\n    this.addView(contentView);\n\n    if (this._infoboxModel) {\n      infoboxView = new InfoboxView({\n        infoboxModel: this._infoboxModel,\n        infoboxCollection: this._infoboxCollection\n      });\n\n      this._info().html(infoboxView.render().el);\n      this.addView(infoboxView);\n    }\n\n    if (this._createControlView) {\n      controlView = this._createControlView();\n      this._controls().html(controlView.render().el);\n      this.addView(controlView);\n    }\n\n    if (this._createActionView) {\n      actionView = this._createActionView();\n      this._actions().html(actionView.render().el);\n      this.addView(actionView);\n    }\n\n    this._setStyleMenu();\n\n    return this;\n  },\n\n  _content: function () {\n    return this.$('.js-content');\n  },\n\n  _controls: function () {\n    return this.$('.js-controls');\n  },\n\n  _actions: function () {\n    return this.$('.js-actions');\n  },\n\n  _info: function () {\n    return this.$('.js-info');\n  },\n\n  _setStyleMenu: function () {\n    this.$('.js-theme').toggleClass('is-dark', this._editorModel.isEditing());\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-content js-content\"></div>\\n<div class=\"js-info\"></div>\\n<ul class=\"Options-bar u-flex u-justifySpace js-theme js-optionsBar\">\\n  <li class=\"CDB-InfoBox-footerItem js-controls\"></li>\\n  <li class=\"CDB-InfoBox-footerItem CDB-InfoBox-footerItem--right js-actions\"></li>\\n</ul>';\n}\nreturn __p;\n};\n",
    "/**\n *  Default upload config\n */\n\nmodule.exports = {\n  uploadStates: [\n    'pending',\n    'enqueued',\n    'uploading',\n    'unpacking',\n    'importing',\n    'guessing',\n    'complete'\n  ],\n  fileExtensions: [\n    'csv',\n    'xls',\n    'xlsx',\n    'zip',\n    'kml',\n    'geojson',\n    'json',\n    'ods',\n    'kmz',\n    'tsv',\n    'gpx',\n    'tar',\n    'gz',\n    'tgz',\n    'osm',\n    'bz2',\n    'tif',\n    'tiff',\n    'txt',\n    'rar'\n  ],\n  // How big should the file be?\n  fileTimesBigger: 3\n};\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar PermissionModel = require('./permission-model');\nvar OWN_ATTR_NAMES = ['id', 'username', 'avatar_url', 'name'];\n\nmodule.exports = Backbone.Model.extend({\n  defaults: {\n    access: 'r'\n  },\n\n  isOwn: function (model) {\n    return model.id === this.get('entity').id;\n  },\n\n  validate: function (attrs, options) {\n    if (attrs.access !== PermissionModel.READ_ONLY && attrs.access !== PermissionModel.READ_WRITE) {\n      return \"access can't take 'r' or 'rw' values\";\n    }\n  },\n\n  toJSON: function () {\n    var entity = _.pick(this.get('entity').toJSON(), OWN_ATTR_NAMES);\n    // translate name to username\n    if (!entity.username) {\n      entity.username = entity.name;\n      delete entity.name;\n    }\n    return {\n      type: this.get('type') || 'user',\n      entity: entity,\n      access: this.get('access')\n    };\n  }\n});\n",
    "var _ = require('underscore');\nvar camshaftReference = require('./camshaft-reference');\nvar AreaOfInfluenceFormModel = require('../editor/layers/layer-content-views/analyses/analysis-form-models/area-of-influence-form-model');\nvar AggregateIntersectionFormModel = require('../editor/layers/layer-content-views/analyses/analysis-form-models/aggregate-intersection-form-model');\nvar FilterIntersectionFormModel = require('../editor/layers/layer-content-views/analyses/analysis-form-models/filter-intersection-form-model');\nvar FallbackFormModel = require('../editor/layers/layer-content-views/analyses/analysis-form-models/fallback-form-model');\nvar UnknownTypeFormModel = require('../editor/layers/layer-content-views/analyses/analysis-form-models/unknown-type-form-model');\nvar MergeAnalysisOptionModel = require('../components/modals/add-analysis/analysis-option-models/merge-analysis-option-model');\nvar DataServicesApiCheck = require('../editor/layers/layer-content-views/analyses/analyses-quota/analyses-quota-info');\n\nvar DAO_TYPES = ['age-and-gender', 'boundaries', 'education', 'employment', 'families', 'housing', 'income', 'language', 'migration', 'nationality', 'population-segments', 'race-and-ethnicity', 'religion', 'transportation'];\n\nvar MAP = {\n  'aggregate-intersection': {\n    title: _t('analyses.aggregate-intersection.short-title'),\n    FormModel: AggregateIntersectionFormModel,\n    modalTitle: _t('components.modals.add-analysis.option-types.aggregate-intersection.title'),\n    modalDesc: _t('components.modals.add-analysis.option-types.aggregate-intersection.desc'),\n    modalCategory: 'data_transformation',\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/aggregate-intersection.tpl'),\n    animationTemplate: require('../components/modals/add-analysis/animation-templates/intersect.tpl')\n  },\n  'bounding-box': {\n    title: _t('analyses.bounding-box.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/group-points-form-model'),\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/group-points.tpl'),\n    genericType: 'group-points'\n  },\n  'bounding-circle': {\n    title: _t('analyses.bounding-circle.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/group-points-form-model'),\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/group-points.tpl'),\n    genericType: 'group-points'\n  },\n  'buffer': {\n    title: _t('analyses.area-of-influence.short-title'),\n    FormModel: AreaOfInfluenceFormModel,\n    modalTitle: _t('components.modals.add-analysis.option-types.area-of-influence.title'),\n    modalDesc: _t('components.modals.add-analysis.option-types.area-of-influence.desc'),\n    modalCategory: 'data_transformation',\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/area-of-influence.tpl'),\n    animationTemplate: require('../components/modals/add-analysis/animation-templates/aoi.tpl'),\n    genericType: 'area-of-influence'\n  },\n  'centroid': {\n    title: _t('analyses.centroid.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/centroid-form-model'),\n    modalTitle: _t('components.modals.add-analysis.option-types.centroid.title'),\n    modalDesc: _t('components.modals.add-analysis.option-types.centroid.desc'),\n    modalCategory: 'data_transformation',\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/centroid.tpl'),\n    animationTemplate: require('../components/modals/add-analysis/animation-templates/centroid.tpl'),\n    genericType: 'centroid'\n  },\n  'convex-hull': {\n    title: _t('analyses.convex-hull.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/group-points-form-model'),\n    modalTitle: _t('components.modals.add-analysis.option-types.group-points.title'),\n    modalDesc: _t('components.modals.add-analysis.option-types.group-points.desc'),\n    modalCategory: 'data_transformation',\n    onboardingTemplate: require('../components/onboardings/analysis/analyses//group-points.tpl'),\n    animationTemplate: require('../components/modals/add-analysis/animation-templates/group-points.tpl'),\n    animationParams: {\n      method: _t('analyses-onboarding.placeholders.method')\n    },\n    genericType: 'group-points'\n  },\n  'concave-hull': {\n    title: _t('analyses.concave-hull.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/group-points-form-model'),\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/group-points.tpl'),\n    genericType: 'group-points'\n  },\n  'data-observatory-measure': {\n    title: _t('analyses.data-observatory-measure.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/data-observatory-measure-model'),\n    modalTitle: _t('components.modals.add-analysis.option-types.data-observatory-measure.title'),\n    modalDesc: _t('components.modals.add-analysis.option-types.data-observatory-measure.desc'),\n    modalCategory: 'create_clean',\n    checkIfEnabled: function (configModel) {\n      return checkIfDataObservatoryIsEnabled(configModel);\n    },\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/data-observatory-measure.tpl'),\n    animationTemplate: require('../components/modals/add-analysis/animation-templates/data-observatory-measure.tpl'),\n    genericType: 'data-observatory-measure'\n  },\n  'filter-by-node-column': {\n    title: _t('analyses.filter-by-node-column.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/filter-by-node-column'),\n    modalTitle: _t('components.modals.add-analysis.option-types.filter-by-node-column.title'),\n    modalDesc: _t('components.modals.add-analysis.option-types.filter-by-node-column.desc'),\n    modalCategory: 'create_clean',\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/filter-by-node-column.tpl'),\n    animationTemplate: require('../components/modals/add-analysis/animation-templates/filter-by-layer.tpl'),\n    animationParams: {\n      name_of_the_layer: _t('analyses-onboarding.placeholders.layer-name')\n    }\n  },\n  'filter-category': {\n    title: _t('analyses.filter.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/filter-form-model'),\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/filter.tpl'),\n    genericType: 'filter'\n  },\n  'filter-range': {\n    title: _t('analyses.filter.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/filter-form-model'),\n    modalTitle: _t('components.modals.add-analysis.option-types.filter.title'),\n    modalDesc: _t('components.modals.add-analysis.option-types.filter.desc'),\n    modalCategory: 'data_transformation',\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/filter.tpl'),\n    animationTemplate: require('../components/modals/add-analysis/animation-templates/filter-by-column-value.tpl'),\n    genericType: 'filter'\n  },\n  'georeference-city': {\n    title: _t('analyses.georeference.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/georeference-form-model'),\n    checkIfEnabled: function (configModel) {\n      return checkIfInternalGeocodingIsEnabled(configModel);\n    },\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/georeference.tpl'),\n    genericType: 'georeference'\n  },\n  'georeference-ip-address': {\n    title: _t('analyses.georeference.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/georeference-form-model'),\n    checkIfEnabled: function (configModel) {\n      return checkIfInternalGeocodingIsEnabled(configModel);\n    },\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/georeference.tpl'),\n    genericType: 'georeference'\n  },\n  'georeference-country': {\n    title: _t('analyses.georeference.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/georeference-form-model'),\n    checkIfEnabled: function (configModel) {\n      return checkIfInternalGeocodingIsEnabled(configModel);\n    },\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/georeference.tpl'),\n    genericType: 'georeference'\n  },\n  'georeference-long-lat': {\n    title: _t('analyses.georeference.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/georeference-form-model'),\n    modalTitle: _t('components.modals.add-analysis.option-types.georeference.title'),\n    modalDesc: _t('components.modals.add-analysis.option-types.georeference.desc'),\n    modalCategory: 'create_clean',\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/georeference.tpl'),\n    animationTemplate: require('../components/modals/add-analysis/animation-templates/georeference.tpl'),\n    genericType: 'georeference'\n  },\n  'georeference-postal-code': {\n    title: _t('analyses.georeference.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/georeference-form-model'),\n    checkIfEnabled: function (configModel) {\n      return checkIfInternalGeocodingIsEnabled(configModel);\n    },\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/georeference.tpl'),\n    genericType: 'georeference'\n  },\n  'georeference-street-address': {\n    title: _t('analyses.georeference.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/georeference-form-model'),\n    checkIfEnabled: function (configModel) {\n      return checkIfExternalGeocodingIsEnabled(configModel);\n    },\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/georeference.tpl'),\n    genericType: 'georeference'\n  },\n  'georeference-admin-region': {\n    title: _t('analyses.georeference.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/georeference-form-model'),\n    checkIfEnabled: function (configModel) {\n      return checkIfInternalGeocodingIsEnabled(configModel);\n    },\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/georeference.tpl'),\n    genericType: 'georeference'\n  },\n  'intersection': {\n    title: _t('analyses.filter-intersection.short-title'),\n    FormModel: FilterIntersectionFormModel,\n    modalTitle: _t('components.modals.add-analysis.option-types.filter-intersection.title'),\n    modalDesc: _t('components.modals.add-analysis.option-types.filter-intersection.desc'),\n    modalCategory: 'data_transformation',\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/intersection.tpl'),\n    animationTemplate: require('../components/modals/add-analysis/animation-templates/filter-by-polygon.tpl')\n  },\n  'kmeans': {\n    title: _t('analyses.kmeans.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/kmeans-form-model'),\n    modalTitle: _t('components.modals.add-analysis.option-types.kmeans.title'),\n    modalDesc: _t('components.modals.add-analysis.option-types.kmeans.desc'),\n    modalCategory: 'analyze_predict',\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/kmeans.tpl'),\n    animationTemplate: require('../components/modals/add-analysis/animation-templates/kmeans.tpl'),\n    animationParams: {\n      method: _t('analyses-onboarding.placeholders.clusters')\n    }\n  },\n  'line-to-column': {\n    title: _t('analyses.connect-with-lines.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/connect-with-lines-form-model'),\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/connect-with-lines.tpl'),\n    animationTemplate: require('../components/modals/add-analysis/animation-templates/connect-with-lines.tpl'),\n    genericType: 'connect-with-lines'\n  },\n  'line-to-single-point': {\n    title: _t('analyses.connect-with-lines.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/connect-with-lines-form-model'),\n    modalTitle: _t('components.modals.add-analysis.option-types.connect-with-lines.title'),\n    modalDesc: _t('components.modals.add-analysis.option-types.connect-with-lines.desc'),\n    modalCategory: 'data_transformation',\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/connect-with-lines.tpl'),\n    animationTemplate: require('../components/modals/add-analysis/animation-templates/connect-with-lines.tpl'),\n    genericType: 'connect-with-lines'\n  },\n  'line-source-to-target': {\n    title: _t('analyses.connect-with-lines.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/connect-with-lines-form-model'),\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/connect-with-lines.tpl'),\n    animationTemplate: require('../components/modals/add-analysis/animation-templates/connect-with-lines.tpl'),\n    genericType: 'connect-with-lines'\n  },\n  'line-sequential': {\n    title: _t('analyses.connect-with-lines.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/connect-with-lines-form-model'),\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/connect-with-lines.tpl'),\n    animationTemplate: require('../components/modals/add-analysis/animation-templates/connect-with-lines.tpl'),\n    genericType: 'connect-with-lines'\n  },\n  'merge': {\n    title: _t('analyses.merge.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/merge-form-model'),\n    modalTitle: _t('components.modals.add-analysis.option-types.merge.title'),\n    modalDesc: _t('components.modals.add-analysis.option-types.merge.desc'),\n    ModalModel: MergeAnalysisOptionModel,\n    modalCategory: 'create_clean',\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/merge.tpl'),\n    animationTemplate: require('../components/modals/add-analysis/animation-templates/join-two-columns.tpl')\n  },\n  'moran': {\n    title: _t('analyses.moran-cluster.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/moran-form-model'),\n    modalTitle: _t('components.modals.add-analysis.option-types.moran-cluster.title'),\n    modalDesc: _t('components.modals.add-analysis.option-types.moran-cluster.desc'),\n    modalCategory: 'analyze_predict',\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/moran.tpl'),\n    animationTemplate: require('../components/modals/add-analysis/animation-templates/outliers.tpl')\n  },\n  'routing-sequential': {\n    title: _t('analyses.routing.short-title'),\n    FormModel: FallbackFormModel,\n    checkIfEnabled: function (configModel) {\n      return checkIfRoutingIsEnabled(configModel);\n    }\n  },\n  'routing-to-layer-all-to-all': {\n    title: _t('analyses.routing.short-title'),\n    FormModel: FallbackFormModel,\n    checkIfEnabled: function (configModel) {\n      return checkIfRoutingIsEnabled(configModel);\n    }\n  },\n  'routing-to-single-point': {\n    title: _t('analyses.routing.short-title'),\n    FormModel: FallbackFormModel,\n    checkIfEnabled: function (configModel) {\n      return checkIfRoutingIsEnabled(configModel);\n    }\n  },\n  'sampling': {\n    title: _t('analyses.sampling.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/sampling-form-model'),\n    modalTitle: _t('components.modals.add-analysis.option-types.sampling.title'),\n    modalDesc: _t('components.modals.add-analysis.option-types.sampling.desc'),\n    modalCategory: 'data_transformation',\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/sampling.tpl'),\n    animationTemplate: require('../components/modals/add-analysis/animation-templates/sampling.tpl'),\n    animationParams: {\n      percentage: _t('analyses-onboarding.placeholders.percentage')\n    },\n    genericType: 'sampling'\n  },\n  'spatial-markov-trend': {\n    title: _t('analyses.spatial-markov-trend.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/spatial-markov-trend-model'),\n    modalTitle: _t('components.modals.add-analysis.option-types.spatial-markov-trend.title'),\n    modalDesc: _t('components.modals.add-analysis.option-types.spatial-markov-trend.desc'),\n    modalCategory: 'analyze_predict',\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/spatial-markov-trend.tpl'),\n    animationTemplate: require('../components/modals/add-analysis/animation-templates/predict-trends.tpl')\n  },\n  'trade-area': {\n    title: _t('analyses.area-of-influence.short-title'),\n    FormModel: AreaOfInfluenceFormModel,\n    checkIfEnabled: function (configModel) {\n      if (!configModel) throw new Error('configModel is required');\n      return !!configModel.dataServiceEnabled('isolines');\n    },\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/area-of-influence.tpl'),\n    genericType: 'area-of-influence'\n  },\n  'weighted-centroid': {\n    title: _t('analyses.centroid.short-title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/centroid-form-model'),\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/centroid.tpl'),\n    genericType: 'centroid'\n  },\n  'closest': {\n    title: _t('editor.layers.analysis-form.find-nearest.title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/closest-form-model'),\n    modalTitle: _t('editor.layers.analysis-form.find-nearest.modal-title'),\n    modalDesc: _t('editor.layers.analysis-form.find-nearest.modal-desc'),\n    modalCategory: 'analyze_predict',\n    animationTemplate: require('../components/modals/add-analysis/animation-templates/closest.tpl'),\n    onboardingTemplate: require('../components/onboardings/analysis/analyses/closest.tpl')\n  },\n  'deprecated-sql-function': {\n    title: _t('editor.layers.analysis-form.deprecated-sql-function.title'),\n    FormModel: require('../editor/layers/layer-content-views/analyses/analysis-form-models/deprecated-sql-function-form-model'),\n    modalTitle: _t('components.modals.add-analysis.option-types.deprecated-sql-function.title'),\n    modalDesc: _t('components.modals.add-analysis.option-types.deprecated-sql-function.desc'),\n    modalCategory: 'data_transformation',\n    checkIfEnabled: function (configModel, userModel) {\n      return userModel.featureEnabled('deprecated-sql-function');\n    }\n  }\n};\n\nvar checkIfInternalGeocodingIsEnabled = function (configModel) {\n  if (!configModel) throw new Error('configModel is required');\n  return isDataServicesReady(configModel) && !!configModel.dataServiceEnabled('geocoder_internal');\n};\n\nvar checkIfRoutingIsEnabled = function (configModel) {\n  if (!configModel) throw new Error('configModel is required');\n  return isDataServicesReady(configModel) && !!configModel.dataServiceEnabled('routing');\n};\n\nvar checkIfExternalGeocodingIsEnabled = function (configModel) {\n  if (!configModel) throw new Error('configModel is required');\n  return isDataServicesReady(configModel) && !!configModel.dataServiceEnabled('hires_geocoder');\n};\n\nvar checkIfDataObservatoryIsEnabled = function (configModel) {\n  if (!configModel) throw new Error('configModel is required');\n  return isDataServicesReady(configModel) && !!configModel.dataServiceEnabled('data_observatory');\n};\n\nvar definitionByType = function (m) {\n  var type = 'unknown';\n\n  if (typeof m === 'string' && m !== '') {\n    type = m;\n  } else if (m && m.get) {\n    type = m.get('type');\n\n    if (type === 'data-observatory-measure' && m.has('measurement')) {\n      var measurement = m.get('measurement').toLowerCase().split(' ').join('-');\n\n      if (_.contains(DAO_TYPES, measurement)) {\n        var measurementType = _.clone(MAP[type]);\n        measurementType.title = _t('analyses.data-observatory-measure.' + measurement);\n        return measurementType;\n      }\n    }\n  }\n\n  return MAP[type] || {\n    title: _t('analyses.' + type),\n    FormModel: FallbackFormModel\n  };\n};\n\nvar isDataServicesReady = function (configModel) {\n  return DataServicesApiCheck.get(configModel).isReady();\n};\n\nvar isAnalysisValidByType = function (type, configModel, userModel) {\n  var analysis = MAP[type];\n  return analysis && analysis.checkIfEnabled ? analysis.checkIfEnabled(configModel, userModel) : true;\n};\n\nmodule.exports = {\n  MAP: MAP,\n\n  findFormModelByType: function (type) {\n    return camshaftReference.hasType(type)\n      ? definitionByType(type).FormModel\n      : UnknownTypeFormModel;\n  },\n\n  getAnalysesByModalCategory: function (category, configModel, userModel) {\n    return _.reduce(MAP, function (memo, item, analysisType) {\n      if (item.modalCategory === category) {\n        if (isAnalysisValidByType(analysisType, configModel, userModel)) {\n          var obj = {\n            nodeAttrs: {\n              type: analysisType\n            },\n            title: item.modalTitle,\n            desc: item.modalDesc\n          };\n\n          if (item.ModalModel) {\n            obj.Model = item.ModalModel;\n          }\n\n          memo.push(obj);\n        }\n      }\n\n      return memo;\n    }, []);\n  },\n\n  isAnalysisValidByType: function (type, configModel, userModel) {\n    return isAnalysisValidByType(type, configModel, userModel);\n  },\n\n  getAnalysisByType: function (type) {\n    return MAP[type];\n  },\n\n  title: function (m) {\n    return definitionByType(m).title;\n  }\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar syncAbort = require('./backbone/sync-abort');\n\n/**\n * Analysis definition model.\n * Points to a node that is the head of the particular analysis.\n */\nmodule.exports = Backbone.Model.extend({\n\n  /**\n   * @override {Backbone.prototype.sync} abort ongoing request if there is any\n   */\n  sync: syncAbort,\n\n  initialize: function (attrs, opts) {\n    if (!opts.analysisDefinitionNodesCollection) throw new Error('analysisDefinitionNodesCollection is required');\n\n    this.USER_SAVED = false; // flag to indicate if the user saved the node and avoid triggering the onboarding model if they didn't\n\n    this._analysisDefinitionNodesCollection = opts.analysisDefinitionNodesCollection;\n  },\n\n  parse: function (r, opts) {\n    // If parse is called on a new model it have not yet called initialize and thus don't have the collection\n    var nodesCollection = this._analysisDefinitionNodesCollection || opts.analysisDefinitionNodesCollection;\n\n    // Merge and parse are used to sync all nodes in a definition with the backend response\n    nodesCollection.add(r.analysis_definition, {silent: true, merge: true, parse: true});\n\n    var attrs = _.omit(r, 'analysis_definition');\n    attrs.node_id = r.analysis_definition.id;\n\n    return attrs;\n  },\n\n  toJSON: function () {\n    return {\n      id: this.id,\n      analysis_definition: this.getNodeDefinitionModel().toJSON()\n    };\n  },\n\n  containsNode: function (other) {\n    var nodeDefModel = this.getNodeDefinitionModel();\n    return !!(nodeDefModel && nodeDefModel.containsNode(other));\n  },\n\n  getNodeDefinitionModel: function () {\n    return this._analysisDefinitionNodesCollection.get(this.get('node_id'));\n  }\n\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar camshaftReference = require('./camshaft-reference');\nvar QueryGeometryModel = require('./query-geometry-model');\nvar QuerySchemaModel = require('./query-schema-model');\nvar nodeIds = require('../value-objects/analysis-node-ids');\nvar checkAndBuildOpts = require('../helpers/required-opts');\nvar QueryRowsCollection = require('./query-rows-collection');\nvar fetchAllQueryObjects = require('../helpers/fetch-all-query-objects');\n\nvar REQUIRED_OPTS = [\n  'configModel'\n];\n\n/**\n *  Base model for an analysis definition node.\n *  May point to one or multiple nodes in turn (referenced by ids).\n *\n *\n *  Analysis-definition-node-model\n *    Query-Schema-Model\n *    Query-Geometry-Model\n *    Query-Rows-Collection\n */\nmodule.exports = Backbone.Model.extend({\n\n  initialize: function (attrs, opts) {\n    if (!this.id) throw new Error('id is required');\n\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    var modelOpts = {\n      configModel: this._configModel,\n      userModel: opts.userModel\n    };\n\n    var simpleGeom = this.get('simple_geom');\n\n    this.querySchemaModel = new QuerySchemaModel(undefined, modelOpts);\n\n    this.queryGeometryModel = new QueryGeometryModel({\n      simple_geom: simpleGeom,\n      status: simpleGeom ? 'fetched' : 'unfetched'\n    }, modelOpts);\n\n    this.queryRowsCollection = new QueryRowsCollection([], {\n      configModel: this._configModel,\n      userModel: opts.userModel,\n      tableName: '',\n      querySchemaModel: this.querySchemaModel\n    });\n\n    this.listenTo(this.queryGeometryModel, 'change:simple_geom', this._onGeometryTypeChanged);\n  },\n\n  fetchQueryObjects: function () {\n    if (this.get('status') === 'ready' && !this.get('error')) {\n      fetchAllQueryObjects({\n        queryGeometryModel: this.queryGeometryModel,\n        querySchemaModel: this.querySchemaModel,\n        queryRowsCollection: this.queryRowsCollection\n      });\n    }\n  },\n\n  /**\n   * @override {Backbone.prototype.parse}  flatten the provided analysis data and create source nodes if there are any.\n   */\n  parse: function (r, opts) {\n    // Allow omitting type when merging into an existing node\n    var sourceNames = (!r.type && opts.merge) ? [] : camshaftReference.getSourceNamesForAnalysisType(r.type);\n\n    var parsedParams = _.reduce(r.params, function (memo, val, name) {\n      var sourceName = sourceNames[sourceNames.indexOf(name)];\n\n      if (sourceName) {\n        this.collection.add(val, opts);\n        memo[name] = val.id;\n      } else {\n        memo[name] = val;\n      }\n\n      return memo;\n    }, {}, this);\n\n    var parsedOptions = _.reduce(r.options, function (memo, val, name) {\n      memo[name] = val;\n      return memo;\n    }, {}, this);\n\n    return _.defaults(\n      _.omit(r, 'params', 'options'),\n      parsedOptions,\n      parsedParams\n    );\n  },\n\n  /**\n   * @override {Backbone.prototype.toJSON} unflatten the internal structure to the expected nested JSON data structure.\n   * @param {Object} options\n   * @param {Boolean} options.skipOptions - Add or not analysis options to the definition\n   */\n  toJSON: function (options) {\n    options = options || {};\n\n    var analysisParams = [];\n    var paramsforJSON = {};\n    var paramsForType = camshaftReference.paramsForType(this.get('type'));\n\n    // Undo the parsing of the params previously done in .parse() (when model was created)\n    for (var name in paramsForType) {\n      var param = paramsForType[name];\n      var val = this.get(name);\n      var includeParamInJSON = true;\n\n      if (param.type === 'node') {\n        var node = this.collection.get(val);\n        if (node) {\n          val = node.toJSON(options);\n        } else if (param.optional) { // Node has no value but is optional. We don't serialize it.\n          includeParamInJSON = false;\n        } else { // Node has no value and is required. Throw error.\n          throw new Error('no node found for param \"' + name + '\" with id \"' + val + '\" in node ' + JSON.stringify(this.attributes));\n        }\n      }\n\n      if (includeParamInJSON) {\n        paramsforJSON[name] = val;\n        analysisParams.push(name);\n      }\n    }\n\n    var json = {\n      id: this.get('id'),\n      type: this.get('type'),\n      params: paramsforJSON\n    };\n\n    // style_history is not sent at all (neither inside params nor options). It is always set by the backend.\n    var optionsAttrs = _.omit(this.attributes, analysisParams.concat('id', 'type', 'status', 'style_history'));\n    if (!(options.skipOptions || _.isEmpty(optionsAttrs))) {\n      json['options'] = optionsAttrs;\n    }\n\n    return json;\n  },\n\n  /**\n   * @override {Backbone.prototype.isNew} for this.destroy() to work (not try to send DELETE request)\n   */\n  isNew: function () {\n    return true;\n  },\n\n  isReadOnly: function () {\n    // By default, any node should be read only by default, except the source node (with exceptions)\n    return true;\n  },\n\n  isCustomQueryApplied: function () {\n    // By default, any node shouldn't have a custom query applied, except the source node\n    return false;\n  },\n\n  canBeDeletedByUser: function () {\n    return this.hasPrimarySource();\n  },\n\n  hasFailed: function () {\n    return this.get('status') === 'failed';\n  },\n\n  isDone: function () {\n    return this.get('status') === 'ready';\n  },\n\n  destroy: function () {\n    if (this.querySchemaModel) {\n      this.querySchemaModel.destroy();\n      this.querySchemaModel = null;\n    }\n\n    return Backbone.Model.prototype.destroy.apply(this, arguments);\n  },\n\n  /**\n   * Creates a new node that have same params as the current node, with only the id differing.\n   * @param {String} newId - e.g. 'b1'\n   * @return {Object} instance of analysis-definition-node-model\n   */\n  clone: function (newId) {\n    if (!newId) throw new Error('newId is required');\n    if (!_.isString(newId) || newId.length < 2) throw new Error('newId is required as a non-empty string');\n    if (newId === this.id) throw new Error('newId must be different from current id, ' + this.id);\n\n    var attrs = this.toJSON();\n    attrs.id = newId;\n    return this.collection.add(attrs);\n  },\n\n  linkedListBySameLetter: function () {\n    var list = [this];\n    var prev = this;\n    var letter = this.letter();\n\n    while (true) {\n      var current = prev.getPrimarySource();\n      if (current && current.letter() === letter) {\n        list.push(current);\n        prev = current;\n      } else {\n        break;\n      }\n    }\n\n    return list;\n  },\n\n  /**\n   * @return {Boolean, null} null if the geoemtry type of this node is not known,\n   *   this is to indicate that the query model is not ready yet, up to caller to make the call or not\n   */\n  isValidAsInputForType: function (analysisType) {\n    if (analysisType === 'source') return false;\n\n    var geometry = this.queryGeometryModel.get('simple_geom');\n    return geometry\n      ? camshaftReference.isValidInputGeometryForType(geometry, analysisType)\n      : null;\n  },\n\n  containsNode: function (other) {\n    if (!other) return false;\n    return this.id === other.id || this._sourcesContains(other);\n  },\n\n  hasPrimarySource: function () {\n    return !!this.getPrimarySource();\n  },\n\n  hasSecondarySource: function () {\n    return !!this.getSecondarySource();\n  },\n\n  getPrimarySource: function () {\n    return this.collection.get(this._getPrimarySourceId());\n  },\n\n  getSecondarySource: function () {\n    // Assumption: there are only 1-2 sources, so secondary is the one that's not the primary\n    var primarySourceId = this._getPrimarySourceId();\n    var secondarySourceId = _.find(this.sourceIds(), function (sourceId) {\n      return sourceId !== primarySourceId;\n    });\n    return this.collection.get(secondarySourceId);\n  },\n\n  // Default query by default is the query already applied in the node.\n  // For source node is totally different\n  getDefaultQuery: function () {\n    return this.get('query');\n  },\n\n  /**\n   * @return {Array} e.g. ['c3', 'b2']\n   */\n  sourceIds: function () {\n    return _.map(this._sourceNames(), function (sourceName) {\n      return this.get(sourceName);\n    }, this);\n  },\n\n  changeSourceIds: function (currentId, newId, silenty) {\n    this._sourceNames().forEach(function (sourceName) {\n      if (this.get(sourceName) === currentId) {\n        this.set(sourceName, newId, { silent: silenty });\n      }\n    }, this);\n  },\n\n  isSourceType: function () {\n    return this.get('type') === 'source';\n  },\n\n  letter: function () {\n    return nodeIds.letter(this.id);\n  },\n\n  getStyleHistoryForLayer: function (layer_id) {\n    var styleHistory = this.get('style_history');\n    return styleHistory && styleHistory[layer_id];\n  },\n\n  // Private methods\n\n  _sourcesContains: function (other) {\n    var primarySource = this.getPrimarySource();\n    var secondarySource = this.getSecondarySource();\n    return !!(\n      (primarySource && primarySource.containsNode(other)) ||\n      (secondarySource && secondarySource.containsNode(other))\n    );\n  },\n\n  _getPrimarySourceId: function () {\n    var primarySourceName = this.get('primary_source_name') || this._sourceNames()[0];\n    return this.get(primarySourceName);\n  },\n\n  /**\n   * @return {Array} e.g. ['polygons_source', 'points_source']\n   */\n  _sourceNames: function () {\n    return camshaftReference.getSourceNamesForAnalysisType(this.get('type'));\n  },\n\n  _onGeometryTypeChanged: function (m, value) {\n    this.set('simple_geom', value);\n  }\n\n});\n",
    "var AnalysisDefinitionNodeModel = require('./analysis-definition-node-model');\nvar TableModel = require('./table-model');\nvar SQLUtils = require('../helpers/sql-utils');\n\n/**\n *  Case of a node model representing a source node.\n *  - It should provide new info about if the node is read only or not.\n *\n *  Analysis-definition-node-source-model\n *    Query-Schema-Model\n *    Query-Geometry-Model\n *    Table-Model\n */\nmodule.exports = AnalysisDefinitionNodeModel.extend({\n\n  defaults: {\n    status: 'ready'\n  },\n\n  /**\n   * @override AnalysisDefinitionNodeModel.prototype.initialize\n   */\n  initialize: function (attrs, opts) {\n    if (!opts.userModel) throw new Error('userModel is required');\n\n    this._userModel = opts.userModel;\n    AnalysisDefinitionNodeModel.prototype.initialize.apply(this, arguments);\n\n    var query = this.get('query');\n    this.querySchemaModel.set({\n      query: query,\n      ready: true\n    }, { silent: true });\n\n    this.queryGeometryModel.set({\n      query: query,\n      ready: true\n    }, { silent: true });\n\n    // TODO: we should check if it is necessary to check if we have to overwrite the whole\n    //       initialize or with this change is enough.\n    this.queryRowsCollection._tableName = this.get('table_name');\n\n    var tableData = opts.tableData || { name: this.get('table_name') };\n    this.tableModel = new TableModel(tableData, {\n      configModel: opts.configModel,\n      parse: true\n    });\n  },\n\n  getDefaultQuery: function () {\n    return SQLUtils.getDefaultSQL(\n      this.get('table_name'),\n      this.tableModel.getOwnerName(),\n      this._userModel.isInsideOrg()\n    );\n  },\n\n  isCustomQueryApplied: function () {\n    return !SQLUtils.isSameQuery(\n      this.querySchemaModel.get('query'),\n      this.getDefaultQuery()\n    );\n  },\n\n  isReadOnly: function () {\n    var isTableReadOnly = this.tableModel.isReadOnly(this._userModel);\n    var hasCustomQuery = this.isCustomQueryApplied();\n    return isTableReadOnly || hasCustomQuery;\n  },\n\n  getTableModel: function () {\n    return this.tableModel;\n  },\n\n  fetchTable: function () {\n    if (!this.tableModel.get('id')) {\n      this.tableModel.fetch();\n    }\n  },\n\n  setTableName: function (name) {\n    if (!name) throw new Error('name is required');\n\n    this.set('table_name', name);\n    this.tableModel.set('name', name);\n    this.queryRowsCollection.setTableName(name);\n    this.querySchemaModel.set({\n      status: 'unfetched',\n      query: this.getDefaultQuery()\n    });\n  }\n\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar AnalysisDefinitionNodeSourceModel = require('./analysis-definition-node-source-model');\nvar AnalysisDefinitionNodeModel = require('./analysis-definition-node-model');\nvar SQLUtils = require('../helpers/sql-utils');\nvar TableNameUtils = require('../helpers/table-name-utils');\nvar checkAndBuildOpts = require('../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'userModel',\n  'configModel'\n];\n\n/**\n * Collection of analysis definitions nodes.\n */\nmodule.exports = Backbone.Collection.extend({\n\n  initialize: function (models, opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    this._relatedTableData = opts.relatedTableData || [];\n\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this.on('queryObjectsUpdated', this._onQueryObjectsUpdated);\n  },\n\n  addRelatedTableData: function (tableData) {\n    this._relatedTableData.push(tableData);\n  },\n\n  model: function (r, opts) {\n    var self = opts.collection;\n\n    opts = _.extend(\n      {\n        parse: true,\n        configModel: self._configModel,\n        userModel: self._userModel\n      },\n      opts\n    );\n\n    if (r.type === 'source') {\n      var tableData = _.find(self._relatedTableData, function (t) {\n        return TableNameUtils.isSameTableName(r.options.table_name, t.name, self._configModel.get('user_name'));\n      });\n      if (tableData) {\n        opts.tableData = tableData;\n      }\n      return new AnalysisDefinitionNodeSourceModel(r, opts);\n    } else {\n      return new AnalysisDefinitionNodeModel(r, opts);\n    }\n  },\n\n  createSourceNode: function (d) {\n    d = d || {};\n    if (!d.id) throw new Error('id is required');\n    if (!d.tableName) throw new Error('tableName is required');\n\n    return this.add({\n      id: d.id,\n      type: 'source',\n      params: {\n        query: d.query || SQLUtils.getDefaultSQL(d.tableName, TableNameUtils.getUsername(d.tableName), true)\n      },\n      options: {\n        table_name: d.tableName\n      }\n    });\n  },\n\n  _onQueryObjectsUpdated: function (model) {\n    this._fetchQueryObjectsIfOnTop(model);\n  },\n\n  _fetchQueryObjectsIfOnTop: function (model) {\n    if (this._isNodeOnTop(model)) {\n      model.fetchQueryObjects();\n    }\n  },\n\n  _isNodeOnTop: function (model) {\n    var currentPos = this.indexOf(model);\n\n    return currentPos === this._getTopNodeIndex();\n  },\n\n  _getTopNodeIndex: function () {\n    var nodeOnTop = this._getNodeOnTop();\n    var at = this.indexOf(nodeOnTop);\n\n    return at;\n  },\n\n  _getNodeOnTop: function () {\n    return this.last();\n  }\n});\n",
    "var Backbone = require('backbone');\nvar nodeIds = require('../value-objects/analysis-node-ids');\nvar AnalysisDefinitionModel = require('./analysis-definition-model');\n\n/**\n * Collection of analysis definitions.\n */\nmodule.exports = Backbone.Collection.extend({\n\n  model: function (d, opts) {\n    var self = opts.collection;\n\n    var m = new AnalysisDefinitionModel(d, {\n      parse: true,\n      collection: self, // used implicitly, for model to use collection.url()\n      analysisDefinitionNodesCollection: self._analysisDefinitionNodesCollection\n    });\n\n    return m;\n  },\n\n  initialize: function (models, options) {\n    if (!options.configModel) throw new Error('configModel is required');\n    if (!options.vizId) throw new Error('vizId is required');\n    if (!options.analysisDefinitionNodesCollection) throw new Error('analysisDefinitionNodesCollection is required');\n\n    this._configModel = options.configModel;\n    this._vizId = options.vizId;\n    this._analysisDefinitionNodesCollection = options.analysisDefinitionNodesCollection;\n  },\n\n  url: function () {\n    var baseUrl = this._configModel.get('base_url');\n    return baseUrl + '/api/v3/viz/' + this._vizId + '/analyses';\n  },\n\n  findAnalysisThatContainsNode: function (nodeDefModel) {\n    return this.findWhere({node_id: nodeDefModel.id}) ||\n      this.find(function (m) {\n        return m.containsNode(nodeDefModel);\n      });\n  },\n\n  findAnalysisForLayer: function (layerDefModel) {\n    var layerLetter = layerDefModel.get('letter');\n\n    return this.find(function (m) {\n      var letter = nodeIds.letter(m.get('node_id'));\n      return letter === layerLetter;\n    });\n  },\n\n  newAnalysisForNode: function (nodeDefModel) {\n    return this.add({analysis_definition: nodeDefModel.toJSON()});\n  },\n\n  /**\n   * @param {object} layerDefModel - instance of an analysis-definition-node-model\n   * @return {jqXHR, undefined} A promise if created a new analysis\n   */\n  saveAnalysisForLayer: function (layerDefModel) {\n    if (!layerDefModel) throw new Error('layerDefModel is required');\n\n    var nodeDefModel = layerDefModel.getAnalysisDefinitionNodeModel();\n    var analysisDefModel = this.findAnalysisForLayer(layerDefModel);\n\n    if (layerDefModel.isOwnerOfAnalysisNode(nodeDefModel)) {\n      if (analysisDefModel) {\n        analysisDefModel.set('node_id', nodeDefModel.id);\n      } else {\n        analysisDefModel = this.add({analysis_definition: nodeDefModel.toJSON()});\n      }\n    } else {\n      if (analysisDefModel) {\n        analysisDefModel.destroy(); // layer's node is owned by another layer, so the existing analysis should be deleted\n      }\n    }\n\n    this.each(function (analysisDefModel) {\n      if (analysisDefModel.containsNode(nodeDefModel)) {\n        analysisDefModel.save();\n      }\n    });\n\n    return analysisDefModel;\n  }\n\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar Utils = require('../helpers/utils');\n\nrequire('backbone-model-file-upload');\n\nmodule.exports = Backbone.Model.extend({\n  fileAttribute: 'filename',\n\n  defaults: {\n    type: '',\n    filename: '',\n    interval: 0,\n    progress: 0,\n    state: 'idle',\n    option: ''\n  },\n\n  _initBinds: function () {\n    this.bind('progress', function (progress) {\n      this.set({\n        progress: progress * 100,\n        state: 'uploading'\n      });\n    }, this);\n\n    this.bind('change:filename change:url', function () {\n      if (this.get('state') === 'error') {\n        this.set({ state: 'idle' });\n        this.unset('get_error_text', { silent: true });\n      }\n    }, this);\n\n    this.bind('error invalid', function (m, d) {\n      this.set({\n        state: 'error',\n        error_code: (d && d.error_code) || '',\n        get_error_text: {\n          title: _t('componentes.data.asset-model.invalid-import'),\n          what_about: (d && d.msg) || ''\n        }\n      }, { silent: true });\n      // We need this, if not validate will run again and again and again... :(\n      this.trigger('change');\n    }, this);\n  },\n\n  validate: function (attrs) {\n    if (!attrs) {\n      return;\n    }\n\n    if (attrs.type === 'filename') { // Number of files\n      if (attrs.filename && attrs.filename.length) {\n        return {\n          msg: _t('componentes.data.asset-model.one-file-per-upload')\n        };\n      }\n      // File extension\n      var name = attrs.filename.name;\n      var ext = name.substr(name.lastIndexOf('.') + 1);\n\n      if (ext) {\n        ext = ext.toLowerCase();\n      }\n\n      if (!_.contains(['jpg', 'png', 'gif', 'svg'], ext)) {\n        return {\n          msg: _t('componentes.data.asset-model.invalid-extension')\n        };\n      }\n    }\n\n    if (attrs.type === 'url') { // Valid URL?\n      if (!Utils.isURL(attrs.url)) {\n        return {\n          msg: _t('componentes.data.asset-model.invalid-url')\n        };\n      }\n    }\n  },\n\n  isValid: function () {\n    return (this.get('filename') || this.get('url')) && this.get('state') !== 'error';\n  },\n\n  upload: function () {\n    var self = this;\n\n    var options = {\n      kind: this.get('kind')\n    };\n\n    if (this.get('type') === 'file') {\n      options.filename = this.get('filename');\n    } else if (this.get('type') === 'url') {\n      options.filename = this.get('filename');\n    }\n\n    this.xhr = this.save(options, {\n      success: function (m) {\n        m.set('state', 'uploaded');\n      },\n\n      error: function (m, msg) {\n        var response;\n        var message = _t('componentes.data.asset-model.connection-error');\n\n        if (msg && msg.status === 429) {\n          response = JSON.parse(msg.responseText);\n          message = response.error;\n        } else if (msg && msg.status === 400) {\n          response = JSON.parse(msg.responseText);\n          message = response.error;\n        }\n\n        self.set({\n          state: 'error',\n          get_error_text: { title: _t('componentes.data.asset-model.error'), what_about: message }\n        });\n      },\n\n      complete: function () {\n        delete self.xhr;\n      }\n    });\n  },\n\n  stopUpload: function () {\n    if (this.xhr) this.xhr.abort();\n  }\n});\n",
    "var Backbone = require('backbone');\nvar AssetModel = require('./asset-model');\nvar checkAndBuildOpts = require('../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'configModel',\n  'userModel'\n];\n\nmodule.exports = Backbone.Collection.extend({\n  model: AssetModel,\n\n  url: function (method) {\n    var baseUrl = this._configModel.get('base_url');\n    var version = this._configModel.urlVersion('asset', method);\n    return baseUrl + '/api/' + version + '/users/' + this._userModel.get('id') + '/assets';\n  },\n\n  initialize: function (models, opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n  },\n\n  parse: function (resp, xhr) {\n    return resp.assets;\n  },\n\n  selectAll: function () {\n    this.each(function (mdl) {\n      mdl.set('state', 'selected');\n    });\n  },\n\n  deselectAll: function (m) {\n    this.each(function (mdl) {\n      if (mdl !== m && mdl.get('state') === 'selected') {\n        mdl.set('state', '');\n      }\n    });\n  }\n});\n",
    "var Backbone = require('backbone');\n\n/**\n * Custom sync method to only allow a single request at a time,\n * any prev ongoing request at a time of a sync call will be aborted.\n *\n * @example\n *   var MyModel = Backbone.Model.extend({\n *     // \n *     sync: syncAbort,\n */\nmodule.exports = function (method, self, opts) {\n  if (this._xhr) {\n    this._xhr.abort();\n  }\n\n  var xhr = this._xhr = Backbone.Model.prototype.sync.apply(this, arguments);\n  xhr.always(function () {\n    self._xhr = null;\n  });\n\n  return xhr;\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar ImportsModel = require('./imports-model');\nvar POLL_TIMER = 30000;\n\n/**\n *  Imports collection\n *\n *  If it is fetched, it will add the import\n *\n */\n\nmodule.exports = Backbone.Collection.extend({\n\n  initialize: function (models, opts) {\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._userModel = opts.userModel;\n    this._configModel = opts.configModel;\n  },\n\n  model: function (attrs, opts) {\n    return new ImportsModel(attrs, {\n      userModel: opts.collection._userModel,\n      configModel: opts.collection._configModel\n    });\n  },\n\n  url: function (method) {\n    var version = this._configModel.urlVersion('import');\n    var baseUrl = this._configModel.get('base_url');\n    return baseUrl + '/api/' + version + '/imports';\n  },\n\n  parse: function (r) {\n    var self = this;\n\n    if (r.imports.length === 0) {\n      this.destroyCheck();\n    } else {\n      _.each(r.imports, function (id) {\n        // Check if that import exists...\n        var imports = self.filter(function (mdl) {\n          return mdl._importModel.get('item_queue_id') === id;\n        });\n\n        if (imports.length === 0) {\n          var importsModel = new ImportsModel({\n            id: id\n          }, {\n            userModel: self._userModel,\n            configModel: self._configModel\n          });\n\n          self.add(importsModel);\n        }\n      });\n    }\n\n    return this.models;\n  },\n\n  canImport: function () {\n    var importQuota = this._userModel.getMaxConcurrentImports();\n    var total = this.size();\n    var finished = 0;\n\n    this.each(function (m) {\n      if (m.hasFailed() || m.hasCompleted()) {\n        ++finished;\n      }\n    });\n\n    return (total - finished) < importQuota;\n  },\n\n  pollCheck: function (i) {\n    if (this.pollTimer) {\n      return;\n    }\n\n    var self = this;\n\n    this.pollTimer = setInterval(function () {\n      self.fetch();\n    }, POLL_TIMER || 2000);\n\n    this.fetch();\n  },\n\n  destroyCheck: function () {\n    clearInterval(this.pollTimer);\n    delete this.pollTimer;\n  },\n\n  failedItems: function () {\n    return this.filter(function (item) {\n      return item.hasFailed();\n    });\n  }\n});\n",
    "var Backbone = require('backbone');\nvar ImportsCollection = require('./background-importer-imports-collection');\n\nvar POLLINGS_TIMER = 3000;\n\n/**\n *  Background polling default model\n *\n */\n\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    showSuccessDetailsButton: true,\n    importsPolling: false // enable imports polling\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._userModel = opts.userModel;\n    this._configModel = opts.configModel;\n\n    this.importsCollection = opts.importsCollection || new ImportsCollection(null, {\n      userModel: this._userModel,\n      configModel: this._configModel\n    });\n\n    this._initBinds();\n    this.startPollings();\n  },\n\n  _initBinds: function () {\n    this.importsCollection.bind('change:state', function (mdl) {\n      this.trigger('change', mdl, this);\n      this._onImportsStateChange(mdl);\n    }, this);\n\n    this.importsCollection.bind('remove', function (mdl) {\n      this.trigger('importRemoved', mdl, this);\n    }, this);\n\n    this.importsCollection.bind('add', function (mdl) {\n      this.trigger('importAdded', mdl, this);\n    }, this);\n  },\n\n  getTotalFailedItems: function () {\n    return this.importsCollection.failedItems().length;\n  },\n\n  removeImportItem: function (mdl) {\n    if (!mdl) {\n      return false;\n    }\n    this.importsCollection.remove(mdl);\n  },\n\n  addImportItem: function (mdl) {\n    if (!mdl) {\n      return false;\n    }\n    this.importsCollection.add(mdl);\n  },\n\n  canAddImport: function () {\n    return this.importsCollection.canImport();\n  },\n\n  getTotalImports: function () {\n    return this.importsCollection.size();\n  },\n\n  getTotalPollings: function () {\n    return this.importsCollection.size();\n  },\n\n  stopPollings: function () {\n    if (this.get('importsPolling')) {\n      this.importsCollection.destroyCheck();\n    }\n  },\n\n  startPollings: function () {\n    var self = this;\n    // Don't start pollings inmediately\n    setTimeout(function () {\n      if (self.get('importsPolling')) {\n        self.importsCollection.pollCheck();\n      }\n    }, POLLINGS_TIMER);\n  },\n\n  _onImportsStateChange: function () {},\n\n  clean: function () {\n    this.importsCollection.unbind(null, null, this);\n  }\n});\n",
    "var _ = require('underscore');\nvar Poller = require('./poller');\n\nvar ImportModelPoller = function (model) {\n  var POLLING_INTERVAL = 2000; // Interval time between poll checkings\n  var POLLING_INTERVAL_MULTIPLIER = 2.5;  // Multiply interval by this number\n  var POLLING_REQUESTS_BEFORE_INTERVAL_CHANGE = 30; // Max tries until interval change\n\n  var options = {\n    interval: function (numberOfRequests) {\n      if (numberOfRequests >= POLLING_REQUESTS_BEFORE_INTERVAL_CHANGE) {\n        return POLLING_INTERVAL * POLLING_INTERVAL_MULTIPLIER;\n      }\n      return POLLING_INTERVAL;\n    },\n    stopWhen: function (model) {\n      var state = model.get('state');\n      return (state === 'complete' || state === 'failure');\n    }\n  };\n\n  Poller.call(this, model, options);\n};\n\nImportModelPoller.prototype = _.extend({}, Poller.prototype);\n\nmodule.exports = ImportModelPoller;\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar ImportModelPoller = require('./import-model-poller');\nvar SynchronizationModel = require('../synchronization-model');\n\n/**\n *  New import model that controls\n *  the state of an import\n *\n */\nmodule.exports = Backbone.Model.extend({\n\n  idAttribute: 'item_queue_id',\n\n  initialize: function (attrs, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._configModel = opts.configModel;\n\n    this._initBinds();\n    this.poller = new ImportModelPoller(this);\n  },\n\n  urlRoot: function () {\n    var version = this._configModel.urlVersion('import');\n    var baseUrl = this._configModel.get('base_url');\n\n    return baseUrl + '/api/' + version + '/imports';\n  },\n\n  _initBinds: function () {\n    this.bind('change:item_queue_id', this._checkQueueId, this);\n  },\n\n  createImport: function (data) {\n    var d = this._prepareData(data);\n    this[d.interval === 0 ? '_createRegularImport' : '_createSyncImport'](d);\n  },\n\n  _checkQueueId: function () {\n    if (this.get('item_queue_id')) {\n      this.pollCheck();\n    }\n  },\n\n  _prepareData: function (data) {\n    var d = {\n      create_vis: data.create_vis,\n      privacy: data.privacy\n    };\n\n    var type = data.type;\n\n    if (type !== 'remote') {\n      _.extend(d, {\n        type_guessing: data.type_guessing,\n        content_guessing: data.content_guessing,\n        interval: data.interval\n      });\n    }\n\n    var service = data.service_name;\n\n    if (type === 'url') {\n      _.extend(d, {\n        url: data.value\n      });\n    }\n\n    if (type === 'remote') {\n      _.extend(d, {\n        type: 'remote',\n        interval: null,\n        remote_visualization_id: data.remote_visualization_id,\n        create_vis: false,\n        value: data.value\n      });\n    }\n\n    if (type === 'sql') {\n      _.extend(d, {\n        table_name: data.table_name,\n        sql: data.value\n      });\n    }\n\n    if (type === 'duplication') {\n      _.extend(d, {\n        table_name: data.table_name,\n        table_copy: data.value\n      });\n    }\n\n    if (type === 'service') {\n      // If service is Twitter, service_item_id should be\n      // sent stringified\n      var service_item_id = (service === 'twitter_search') ? JSON.stringify(data.service_item_id) : data.service_item_id;\n\n      if (data.user_defined_limits) {\n        d.user_defined_limits = data.user_defined_limits;\n      }\n\n      _.extend(d, {\n        value: data.value,\n        service_name: data.service_name,\n        service_item_id: service_item_id\n      });\n    }\n\n    return d;\n  },\n\n  _createSyncImport: function (d) {\n    var self = this;\n    this._synchronizationModel = new SynchronizationModel(d, {\n      configModel: this._configModel\n    });\n\n    this._synchronizationModel.save(null, {\n      success: function (m) {\n        self.set('item_queue_id', m.get('data_import').item_queue_id);\n      },\n      error: function (mdl, r, opts) {\n        self._setErrorState(r);\n      }\n    });\n  },\n\n  _createRegularImport: function (d) {\n    var self = this;\n\n    this.save(d, {\n      error: function (mdl, r, opts) {\n        self._setErrorState(r);\n      }\n    });\n  },\n\n  _setErrorState: function (r) {\n    var msg;\n    try {\n      msg = r && JSON.parse(r.responseText).errors.imports;\n    } catch (err) {\n      msg = _t('data.import-model.error-starting-import');\n    }\n    this.set({\n      state: 'failure',\n      get_error_text: {\n        title: _t('data.import-model.error-title'),\n        what_about: msg\n      }\n    });\n  },\n\n  pollCheck: function () {\n    this.poller.start();\n  },\n\n  destroyCheck: function () {\n    this.poller.stop();\n  }\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar ImportModel = require('./import-model');\nvar UploadModel = require('../upload-model');\nvar VisDefinitionModel = require('../vis-definition-model');\nvar PermissionModel = require('../permission-model');\n\n/**\n *  Upload/import model\n *\n *  It takes the control of the upload and import,\n *  listening the change of any of these steps.\n *\n *  Steps:\n *  - upload\n *  - import\n *\n */\n\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    step: 'upload',\n    state: ''\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._userModel = opts.userModel;\n    this._configModel = opts.configModel;\n\n    this._uploadModel = new UploadModel(opts.upload, {\n      userModel: this._userModel,\n      configModel: this._configModel\n    });\n\n    if (_.isEmpty(opts)) {\n      opts = {};\n    }\n\n    this._importModel = new ImportModel(opts.import, {\n      configModel: this._configModel\n    });\n    this._initBinds();\n    this._checkStatus();\n  },\n\n  _initBinds: function () {\n    this.bind('change:import', this._onImportChange, this);\n    this.bind('change:upload', this._onUploadChange, this);\n    this.bind('change:id', this._onIdChange, this);\n\n    this._importModel.bind('change', function () {\n      this.trigger('change:import', this);\n      this.trigger('change', this);\n    }, this);\n\n    this._uploadModel.bind('change', function () {\n      this.trigger('change:upload', this);\n      this.trigger('change', this);\n    }, this);\n  },\n\n  _destroyBinds: function () {\n    this._uploadModel.unbind(null, null, this);\n    this._importModel.unbind(null, null, this);\n  },\n\n  _onIdChange: function () {\n    var item_queue_id = this.get('id');\n    if (item_queue_id) this._importModel.set('item_queue_id', item_queue_id);\n    this.set('step', 'import');\n  },\n\n  _onUploadChange: function (m, i) {\n    if (this.get('step') === 'upload') {\n      var item_queue_id = this._uploadModel.get('item_queue_id');\n      var state = this._uploadModel.get('state');\n\n      if (item_queue_id) this.set('id', item_queue_id);\n      if (state) this.set('state', state);\n    }\n  },\n\n  _onImportChange: function () {\n    if (this.get('step') === 'import') {\n      var state = this._importModel.get('state');\n      if (state) this.set('state', state);\n    }\n  },\n\n  _checkStatus: function () {\n    if (!this.get('id') && !this._uploadModel.isValid()) {\n      this.trigger('change:upload');\n      return;\n    }\n\n    if (this._uploadModel.get('type') === 'file') {\n      this._uploadModel.upload();\n    } else if (this.get('id')) {\n      this.set('step', 'import');\n      this._importModel.set('item_queue_id', this.get('id'));\n    } else if (!this._importModel.get('item_queue_id') && this._uploadModel.get('type') !== '') {\n      this.set('step', 'import');\n      this._importModel.createImport(this._uploadModel.toJSON());\n    }\n  },\n\n  pause: function () {\n    this.stopUpload();\n    this.stopImport();\n  },\n\n  hasFailed: function () {\n    var state = this.get('state');\n    var step = this.get('step');\n\n    return (step === 'import' && state === 'failure') || (step === 'upload' && state === 'error');\n  },\n\n  hasCompleted: function () {\n    return this.get('step') === 'import' && this._importModel && this._importModel.get('state') === 'complete';\n  },\n\n  getWarnings: function () {\n    return this.get('step') === 'import' ? this._importModel.get('warnings') : '';\n  },\n\n  getError: function () {\n    if (this.hasFailed()) {\n      var step = this.get('step');\n      return _.extend(\n        {\n          errorCode: this[step === 'upload' ? '_uploadModel' : '_importModel'].get('error_code'),\n          itemQueueId: step === 'import' ? this._importModel.get('id') : '',\n          originalUrl: step === 'import' ? this._importModel.get('original_url') : '',\n          dataType: step === 'import' ? this._importModel.get('data_type') : '',\n          httpResponseCode: step === 'import' ? this._importModel.get('http_response_code') : '',\n          httpResponseCodeMessage: step === 'import' ? this._importModel.get('http_response_code_message') : ''\n        },\n        this[step === 'upload' ? '_uploadModel' : '_importModel'].get('get_error_text'));\n    }\n\n    return {\n      title: '',\n      what_about: '',\n      error_code: ''\n    };\n  },\n\n  importedVis: function () {\n    if (this.get('import').derived_visualization_id) {\n      return this._getMapVis();\n    } else {\n      return this._getDatasetVis();\n    }\n  },\n\n  _getMapVis: function () {\n    var derivedVisId = this._importModel.get('derived_visualization_id');\n\n    if (!derivedVisId) {\n      return false;\n    }\n\n    return this._createVis({\n      type: 'derived',\n      id: derivedVisId\n    });\n  },\n\n  _getDatasetVis: function () {\n    var tableName = this._importModel.get('table_name');\n\n    if (!tableName) {\n      return false;\n    }\n\n    return this._createVis({\n      type: 'table',\n      table: {\n        name: tableName\n      }\n    });\n  },\n\n  _createVis: function (attrs) {\n    var vis = new VisDefinitionModel(attrs, {\n      configModel: this._configModel\n    });\n\n    vis.permission = new PermissionModel(null, {\n      configModel: this._configModel,\n      userModel: this._userModel\n    });\n\n    return vis;\n  },\n\n  setError: function (opts) {\n    var stepModel = this[this.get('step') === 'upload' ? '_uploadModel' : '_importModel'];\n\n    this.stopUpload();\n    this.stopImport();\n\n    stepModel.set(opts);\n\n    this.set('state', 'error');\n  },\n\n  stopUpload: function () {\n    this._uploadModel.stopUpload();\n  },\n\n  stopImport: function () {\n    this._importModel.destroyCheck();\n  },\n\n  get: function (attr) {\n    if (attr === 'upload') {\n      return this._uploadModel.toJSON();\n    }\n\n    if (attr === 'import') {\n      return this._importModel.toJSON();\n    }\n\n    return Backbone.Model.prototype.get.call(this, attr);\n  },\n\n  toJSON: function () {\n    return {\n      step: this.get('step'),\n      id: this.get('id'),\n      state: this.get('state'),\n      upload: this._uploadModel.toJSON(),\n      import: this._importModel.toJSON()\n    };\n  }\n});\n",
    "var _ = require('underscore');\n\n/*\n * Periodically fetches a model/collection. It waits for ongoing\n * fetch requests before trying to fetch again. A stop condition\n * can be specified.\n *\n * Usage example:\n *\n * var poller = new Poller(model, {\n *   interval: 1000,\n *   stopWhen: function (model) {\n *     return model.get('state') === 'completed';\n *   }\n * });\n *\n * poller.start();\n *\n * // ...\n *\n * poller.stop();\n *\n */\nvar Poller = function (model, opts) {\n  this.model = model;\n  this.numberOfRequests = 0;\n  this.polling = false;\n  this.interval = opts.interval;\n  if (typeof this.interval !== 'function') {\n    this.interval = function () { return opts.interval; };\n  }\n  this.stopWhen = opts.stopWhen;\n  this.error = opts.error;\n  this.autoStart = opts.autoStart;\n\n  if (this.autoStart) {\n    this.start();\n  }\n};\n\nPoller.prototype.start = function () {\n  if (this.timeout) {\n    return;\n  }\n\n  this._scheduleFetch();\n};\n\nPoller.prototype._scheduleFetch = function () {\n  this.timeout = setTimeout(this._fetch.bind(this), this.interval(this.numberOfRequests));\n};\n\nPoller.prototype._fetch = function () {\n  var self = this;\n  if (!self.polling) {\n    self.polling = true;\n    self.model.fetch({\n      success: function () {\n        self.polling = false;\n        self.numberOfRequests++;\n        if (self._continuePolling()) {\n          self._scheduleFetch();\n        }\n      },\n      error: function (e) {\n        _.isFunction(self.error) && self.error(self.model);\n      }\n    });\n  }\n};\n\nPoller.prototype._continuePolling = function () {\n  return !this.stopWhen ||\n    (_.isFunction(this.stopWhen) && !this.stopWhen(this.model));\n};\n\nPoller.prototype.stop = function () {\n  this.polling = false;\n  clearTimeout(this.timeout);\n  delete this.timeout;\n};\n\nmodule.exports = Poller;\n",
    "var PROVIDER_LEAFLET = 'leaflet';\nvar PROVIDER_GOOGLE_MAPS = 'googlemaps';\nvar CATEGORY_GOOGLE_MAPS = 'GMaps';\nvar LAYER_TYPE_GOOGLE_MAPS = 'GMapsBase';\nvar LAYER_TYPE_TILED = 'Tiled';\n\nmodule.exports = {\n  getProvider: function (layerType) {\n    if (layerType === LAYER_TYPE_GOOGLE_MAPS) {\n      return PROVIDER_GOOGLE_MAPS;\n    }\n    return PROVIDER_LEAFLET;\n  },\n\n  getLayerType: function (category) {\n    if (this.isGoogleMapsCategory(category)) {\n      return LAYER_TYPE_GOOGLE_MAPS;\n    }\n    return LAYER_TYPE_TILED;\n  },\n\n  isGoogleMapsCategory: function (category) {\n    return category === CATEGORY_GOOGLE_MAPS;\n  }\n};\n",
    "var _ = require('underscore');\nvar camshaftReference = require('camshaft-reference').getVersion('latest');\nvar DefaultCartography = require('./default-cartography.json');\n\nvar SOURCE_NAMES_MAP = {}; // string -> array, e.g. {'intersection': ['source', 'target']}\nvar DEFAULT_MISSING_PARAM_VALUES = [undefined, null, '', NaN];\n\nmodule.exports = {\n  hasType: function (type) {\n    return !!camshaftReference.analyses[type];\n  },\n\n  paramsForType: function (type) {\n    if (!this.hasType(type)) throw new Error('no analysis params found for type: ' + type);\n\n    return _.clone(camshaftReference.analyses[type].params);\n  },\n\n  /**\n   * Validate raw form attrs\n   * @param {Object} formAttrs - e.g. {type: 'buffer', source: 'a0', radius: 'meh'}\n   * @return {Object, undefined} returns an object with keys as faulty input, e.g. {radius: 'invalid-value'} for above\n   */\n  validate: function (formAttrs) {\n    var errors = {};\n\n    var parsedAttrs = this.parse(formAttrs);\n    var params = this.paramsForType(formAttrs.type);\n\n    for (var name in params) {\n      var param = params[name];\n      var val = parsedAttrs[name];\n\n      if (!param.optional || val !== undefined) {\n        switch (param.type) {\n          case 'node':\n            if (!val) {\n              errors[name] = _t('data.analysis-definition-node-model.validation.invalid-source');\n            }\n            break;\n          case 'number':\n            if (isNaN(val)) {\n              errors[name] = _t('data.analysis-definition-node-model.validation.invalid-value');\n            }\n            break;\n          case 'enum':\n            if (!_.contains(param.values, val)) {\n              errors[name] = _t('data.analysis-definition-node-model.validation.invalid-enum', {expectedValues: JSON.stringify(param.values)});\n            }\n            break;\n          default:\n            if (val === null) {\n              errors[name] = _t('data.analysis-definition-node-model.validation.missing-required');\n            }\n        }\n      }\n    }\n\n    if (!_.isEmpty(errors)) {\n      return errors;\n    }\n  },\n\n  /**\n   * Get type-parsed attrs from the raw form attrs\n   * @param {Object} formAttrs - e.g. {type: 'buffer', source: 'a0 ', radius: '123', dissolved: 'false'}\n   * @return {Object} e.g. {type: 'buffer', source: 'a0', radius: 123, dissolved: false}\n   */\n  parse: function (formAttrs) {\n    var parsedAttrs = _.extend({}, formAttrs);\n    var params = this.paramsForType(formAttrs.type);\n\n    for (var name in params) {\n      var param = params[name];\n      var val = parsedAttrs[name];\n\n      if (param.optional && _.contains(DEFAULT_MISSING_PARAM_VALUES, val)) {\n        delete parsedAttrs[name];\n      } else {\n        switch (param.type) {\n          case 'node':\n            parsedAttrs[name] = (val || '').trim();\n            break;\n          case 'number':\n            parsedAttrs[name] = parseFloat(val, 10);\n            break;\n          case 'boolean':\n            parsedAttrs[name] = val === 'true' || val === true;\n            break;\n          default:\n            if (_.contains(DEFAULT_MISSING_PARAM_VALUES, val)) {\n              parsedAttrs[name] = null;\n            } else if (_.isString(val)) {\n              parsedAttrs[name] = val.trim();\n            }\n        }\n      }\n    }\n\n    return parsedAttrs;\n  },\n\n  getSourceNamesForAnalysisType: function (type) {\n    if (!SOURCE_NAMES_MAP[type]) {\n      var sourceNames = [];\n      var params = this.paramsForType(type);\n\n      for (var name in params) {\n        var param = params[name];\n        if (param.type === 'node') {\n          sourceNames.push(name);\n        }\n      }\n\n      SOURCE_NAMES_MAP[type] = sourceNames;\n    }\n\n    return SOURCE_NAMES_MAP[type];\n  },\n\n  getDefaultCartoCSSForType: function () {\n    return _.template([\n      \"#layer['mapnik::geometry_type'=1] {\",\n      '  marker-width: <%= point.fill.size.fixed %>;',\n      '  marker-fill: <%= point.fill.color.fixed %>;',\n      '  marker-fill-opacity: <%= point.fill.color.opacity %>;',\n      '  marker-line-color: <%= point.stroke.color.fixed %>;',\n      '  marker-line-width: <%= point.stroke.size.fixed %>;',\n      '  marker-line-opacity: <%= point.stroke.color.opacity %>;',\n      '  marker-placement: point;',\n      '  marker-type: ellipse;',\n      '  marker-allow-overlap: true;',\n      '}',\n      \"#layer['mapnik::geometry_type'=2] {\",\n      '  line-color: <%= line.stroke.color.fixed %>;',\n      '  line-width: <%= line.stroke.size.fixed %>;',\n      '  line-opacity: 1;',\n      '}',\n      \"#layer['mapnik::geometry_type'=3] {\",\n      '  polygon-fill: <%= polygon.fill.color.fixed %>;',\n      '  polygon-opacity: <%= polygon.fill.color.opacity %>;',\n      '  polygon-gamma: 0.5;',\n      '  line-color: <%= polygon.stroke.color.fixed%>;',\n      '  line-width: <%= polygon.stroke.size.fixed %>;',\n      '  line-opacity: <%= polygon.stroke.color.opacity %>;',\n      '  line-comp-op: soft-light;',\n      '}'\n    ].join('\\n'))(DefaultCartography.simple);\n  },\n\n  isValidInputGeometryForType: function (simpleGeometryType, analysisType) {\n    var validGeometries = this.getValidInputGeometriesForType(analysisType);\n    return _.contains(validGeometries, simpleGeometryType) || _.contains(validGeometries, '*');\n  },\n\n  getValidInputGeometriesForType: function (analysisType) {\n    var params = this.paramsForType(analysisType);\n\n    var geometries = [];\n\n    for (var name in params) {\n      var param = params[name];\n      if (param.type === 'node') {\n        geometries = _.union(geometries, param.geometry);\n      }\n    }\n\n    return geometries;\n  }\n};\n",
    "var Backbone = require('backbone');\n\nmodule.exports = Backbone.Model.extend({\n  idAttribute: 'name'\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar CDB = require('cartodb.js');\n\nvar queryTemplate = _.template('SELECT <%= column %> FROM (<%= sql %>) _table_sql GROUP BY <%= column %> ORDER BY <%= column %> ASC');\nvar MAX_ROW_COUNT = 100;\n\nmodule.exports = Backbone.Model.extend({\n  initialize: function (attrs, opts) {\n    if (!opts.configModel) throw new Error('configModel param is required');\n    if (!opts.nodeDefModel) throw new Error('nodeDefModel param is required');\n\n    this._query = opts.nodeDefModel.querySchemaModel.get('query');\n    this._rowData = [];\n\n    this._SQL = new CDB.SQL({\n      user: opts.configModel.get('user_name'),\n      sql_api_template: opts.configModel.get('sql_api_template'),\n      api_key: opts.configModel.get('api_key')\n    });\n\n    this.on('change:column', this.fetch, this);\n  },\n\n  _onQueryDone: function (r) {\n    var resultCount = _.size(r.rows);\n\n    if (resultCount && resultCount < MAX_ROW_COUNT) {\n      this._rowData = _.pluck(r.rows, this.get('column'));\n      this.trigger('columnsFetched', this._rowData);\n    }\n  },\n\n  fetch: function () {\n    if (this.get('column') && this._query) {\n      this._SQL.execute(\n        queryTemplate({\n          sql: this._query,\n          column: this.get('column')\n        }),\n        null,\n        {\n          extra_params: ['page', 'rows_per_page'],\n          page: 0,\n          rows_per_page: 40,\n          success: this._onQueryDone.bind(this),\n          error: function () {\n            // TODO: what happens if fails?\n          }\n        }\n      );\n    }\n  },\n\n  getRows: function () {\n    var rowDataCount = _.size(this._rowData);\n    if (rowDataCount > 0) {\n      if (rowDataCount && rowDataCount < MAX_ROW_COUNT) {\n        return _.reject(this._rowData, _.isNull);\n      } else {\n        return false;\n      }\n    } else {\n      return false;\n    }\n  }\n});\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\n\n/**\n * Model for general frontend configuration.\n * Ported from old cdb.config, since we can't reuse the older model that's tied to v3 of cartodb.js\n *\n * Also, rather than putting it as a global object, it's intended to be instantiated at the entry point and passed as\n * a collaborator object the models that needs it, e.g.:\n * var myModel = new MyModel({ id: 123,  }, {\n *   configModel: configModel\n * })\n */\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    base_url: '/CHANGEME' // expected to be set when model is created\n  },\n\n  urlVersion: function (modelName, method, defaultVersion) {\n    method = method || '';\n    var version = this.get(modelName + '_' + method + '_url_version');\n    return version || defaultVersion || 'v1';\n  },\n\n  /**\n   * @param {String} [version=v2] Version of API to use\n   * @return {String} the full sql api url, including the api endpoint, e.g. http://user.carto.com/api/v2/sql\n   */\n  getSqlApiUrl: function (version) {\n    version = version || 'v2';\n    return this._getSqlApiBaseUrl() + '/api/' + version + '/sql';\n  },\n\n  /**\n   * @return {String} returns the base url to compose the final url, e.g. http://user.carto.com/\n   */\n  _getSqlApiBaseUrl: function () {\n    var url;\n    if (this.get('sql_api_template')) {\n      url = this.get('sql_api_template').replace('{user}', this.get('user_name'));\n    } else {\n      url = this.get('sql_api_protocol') + '://' +\n        this.get('user_name') + '.' +\n        this.get('sql_api_domain') + ':' +\n        this.get('sql_api_port');\n    }\n    return url;\n  },\n\n  dataServiceEnabled: function (name) {\n    var dataServices = this.get('dataservices_enabled');\n    if (!dataServices || !_.size(dataServices) || !name) {\n      return false;\n    }\n    return !!dataServices[name];\n  }\n});\n",
    "/* global Image */\n\nvar Backbone = require('backbone');\nvar _ = require('underscore');\n\nmodule.exports = Backbone.Model.extend({\n\n  getAttributes: function () {\n    return JSON.parse(JSON.stringify(this.attributes));\n  },\n\n  _generateClassName: function (urlTemplate) {\n    if (urlTemplate) {\n      return urlTemplate.replace(/\\s+/g, '').replace(/[^a-zA-Z_0-9 ]/g, '').toLowerCase();\n    } else return '';\n  },\n\n  parse: function (data) {\n    var attrs = {};\n\n    _.extend(attrs, data.options, {\n      id: data.id,\n      className: this._generateClassName(data.options.urlTemplate),\n      type: 'Tiled',\n      order: data.order,\n      parent_id: data.parent_id\n    });\n\n    return attrs;\n  },\n\n  toJSON: function () {\n    var layerOptions = _.clone(_.omit(this.attributes, ['order', 'id']));\n    var json = {\n      kind: 'tiled',\n      options: layerOptions,\n      order: this.get('order'),\n      id: this.id\n    };\n\n    return json;\n  },\n\n  getValue: function () {\n    return this.get('val');\n  },\n\n  /**\n   * validateTemplateURL - Validates current urlTemplate of layer.\n   *\n   * @param {Object} callbacks with success and error functions defined to be called depending on validation outcome.\n   */\n  validateTemplateURL: function (callbacks) {\n    var subdomains = ['a', 'b', 'c'];\n    var image = new Image();\n    image.onload = callbacks.success;\n    image.onerror = callbacks.error;\n    image.src = this.get('urlTemplate').replace(/\\{s\\}/g, function () {\n      return subdomains[Math.floor(Math.random() * 3)];\n    })\n      .replace(/\\{x\\}/g, '0')\n      .replace(/\\{y\\}/g, '0')\n      .replace(/\\{z\\}/g, '0');\n  }\n\n});\n",
    "var Backbone = require('backbone');\nvar CustomBaselayerModel = require('./custom-baselayer-model');\nvar checkAndBuildOpts = require('../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'configModel',\n  'currentUserId'\n];\n\nmodule.exports = Backbone.Collection.extend({\n\n  model: function (d, opts) {\n    var self = opts.collection;\n\n    var m = new CustomBaselayerModel(d, {\n      parse: true,\n      collection: self\n    });\n\n    return m;\n  },\n\n  url: function () {\n    var baseUrl = this._configModel.get('base_url');\n    var version = this._configModel.urlVersion('user');\n    return baseUrl + '/api/' + version + '/users/' + this._currentUserId + '/layers';\n  },\n\n  initialize: function (models, opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n  },\n\n  isCustomCategory: function () {\n    var custom = this.where(function (mdl) {\n      return ['NASA', 'TileJSON', 'WMS', 'Mapbox', 'Custom', undefined].some(function (category) {\n        return mdl.get('category') === category;\n      });\n    });\n    return custom;\n  },\n\n  getSelected: function () {\n    return this.findWhere({ selected: true });\n  },\n\n  hasCustomBaseLayer: function (className) {\n    if (!className) return;\n\n    var customBaseLayer = this.where({ className: className });\n\n    return customBaseLayer.length > 0;\n  }\n\n});\n",
    "module.exports={\n  \"simple\": {\n\n    \"point\": {\n      \"fill\": {\n        \"size\": {\n          \"fixed\": 7\n        },\n        \"color\": {\n          \"fixed\": \"#FFB927\",\n          \"opacity\": 0.9\n        }\n      },\n      \"stroke\": {\n        \"size\": {\n          \"fixed\": 1\n        },\n        \"color\": {\n          \"fixed\": \"#FFF\",\n          \"opacity\": 1\n        }\n      }\n    },\n\n    \"line\": {\n      \"fill\": {},\n      \"stroke\": {\n        \"size\": {\n          \"fixed\": 1.5\n        },\n        \"color\": {\n          \"fixed\": \"#3EBCAE\",\n          \"opacity\": 1\n        }\n      }\n    },\n\n    \"polygon\": {\n      \"fill\": {\n        \"color\": {\n          \"fixed\": \"#374C70\",\n          \"opacity\": 0.9\n        }\n      },\n      \"stroke\": {\n        \"size\": {\n          \"fixed\": 1\n        },\n        \"color\": {\n          \"fixed\": \"#FFF\",\n          \"opacity\": 0.5\n        }\n      }\n    }\n  }\n}\n",
    "module.exports={\n  \"fill\": {\n    \"size\": {\n      \"fixed\": 7\n    },\n    \"color\": {\n      \"fixed\": \"#FFB927\",\n      \"opacity\": 0.9\n    }\n  },\n  \"stroke\": {\n    \"size\": {\n      \"fixed\": 1\n    },\n    \"color\": {\n      \"fixed\": \"#FFF\",\n      \"opacity\": 1\n    }\n  },\n  \"blending\": \"none\",\n  \"aggregation\": {},\n  \"labels\": {\n    \"enabled\": false,\n    \"attribute\": null,\n    \"font\": \"DejaVu Sans Book\",\n    \"fill\": {\n      \"size\": {\n        \"fixed\": 10\n      },\n      \"color\": {\n        \"fixed\": \"#FFFFFF\",\n        \"opacity\": 1\n      }\n    },\n    \"halo\": {\n      \"size\": {\n        \"fixed\": 1\n      },\n      \"color\": {\n        \"fixed\": \"#6F808D\",\n        \"opacity\": 1\n      }\n    },\n    \"offset\": -10,\n    \"overlap\": true,\n    \"placement\": \"point\"\n  }\n}\n",
    "var BackgroundPollingModel = require('./background-importer/background-polling-model');\nvar TableModel = require('./table-model');\n\n/**\n *  Background polling model for the editor context.\n */\n\nmodule.exports = BackgroundPollingModel.extend({\n\n  initialize: function (attrs, opts) {\n    BackgroundPollingModel.prototype.initialize.apply(this, arguments);\n\n    if (!opts.userActions) { throw new Error('userActions is required'); }\n\n    this._userActions = opts.userActions;\n  },\n\n  _onImportsStateChange: function (importsModel) {\n    if (importsModel.hasCompleted()) {\n      var tableName = importsModel.importedVis().get('table').name;\n      var tableModel = new TableModel({\n        name: tableName\n      }, {\n        configModel: this._configModel\n      });\n\n      // Provide table geometry in order to set properly styles when\n      // layer is added to the current map\n      var onTableFetched = function () {\n        this._userActions.createLayerFromTable(tableModel);\n        this.trigger('importCompleted', importsModel, this);\n      }.bind(this);\n\n      tableModel.fetch().always(onTableFetched);\n    }\n  }\n});\n",
    "var Backbone = require('backbone');\n\n/**\n * Model for general editor configuration.\n */\nmodule.exports = Backbone.Model.extend({\n  defaults: {\n    edition: false,\n    disabled: false\n  },\n  isEditing: function () {\n    return !!this.get('edition');\n  },\n  isDisabled: function () {\n    return !!this.get('disabled');\n  }\n});\n",
    "var Backbone = require('backbone');\n\n/**\n * Model that represents a visualization export (v3)\n */\n\nmodule.exports = Backbone.Model.extend({\n\n  initialize: function (attrs, opts) {\n    if (!attrs.visualization_id) throw new Error('visualization_id is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._configModel = opts.configModel;\n  },\n\n  urlRoot: function () {\n    var baseUrl = this._configModel.get('base_url');\n\n    return baseUrl + '/api/v3/visualization_exports';\n  },\n\n  requestExport: function () {\n    this.save(null, {\n      success: this._requestExportSuccessHandler.bind(this)\n    });\n\n    // TODO add metrics for private and public exports\n  },\n\n  cancelExport: function () {\n    this._interrupt();\n  },\n\n  _requestExportSuccessHandler: function () {\n    this._pollPID = setInterval(function () {\n      this.fetch({\n        success: this._checkState.bind(this),\n        error: this._errorHandler.bind(this)\n      });\n    }.bind(this), 2000);\n  },\n\n  _checkState: function () {\n    if (this.get('state') === 'complete') {\n      this._finishExport();\n    } else if (this.get('state') === 'failure') {\n      this._errorHandler();\n    }\n  },\n\n  _finishExport: function () {\n    clearInterval(this._pollPID);\n  },\n\n  _errorHandler: function () {\n    this._interrupt();\n\n    throw new Error('There is a problem with your export. Please try again.');\n  },\n\n  _interrupt: function () {\n    clearInterval(this._pollPID);\n\n    this.set('state', 'failure');\n  }\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar QueryRowModel = require('./query-row-model');\n\nvar TYPES_POINT = 'point';\nvar TYPES_LINE = 'line';\nvar TYPES_POLYGON = 'polygon';\n\nvar GEOJSON_TO_FEATURE_TYPE = {\n  Point: TYPES_POINT,\n  MultiPoint: TYPES_POINT,\n  LineString: TYPES_LINE,\n  MultiLineString: TYPES_LINE,\n  Polygon: TYPES_POLYGON,\n  MultiPolygon: TYPES_POLYGON\n};\n\nvar convertGeoJSONTypeToFeatureType = function (the_geom) {\n  var geoJSON = null;\n\n  try {\n    geoJSON = JSON.parse(the_geom);\n  } catch (err) {\n    // if the geom is not a valid json value\n  }\n\n  var geometryType = geoJSON && geoJSON.type;\n  var featureType = GEOJSON_TO_FEATURE_TYPE[geometryType];\n  if (!featureType) {\n    throw new Error(\"unsupported geometry type: '\" + geometryType + \"'\");\n  }\n\n  return featureType;\n};\n\nvar BLACKLISTED_COLUMNS = ['cartodb_id', 'created_at', 'the_geom_webmercator', 'updated_at'];\n\nvar FeatureDefinitionModel = Backbone.Model.extend({\n\n  initialize: function (attrs, options) {\n    if (!options.configModel) throw new Error('configModel is required');\n    if (!options.layerDefinitionModel) throw new Error('layerDefinitionModel is required');\n    if (!options.userModel) throw new Error('userModel is required');\n\n    this._configModel = options.configModel;\n    this._layerDefinitionModel = options.layerDefinitionModel;\n    this._userModel = options.userModel;\n    this._featureType = options.featureType;\n\n    this._firstNode = this._getAnalysisDefinitionNodeModel();\n    this._changesHistory = [];\n\n    if (this._firstNode.isSourceType()) {\n      this._tableNodeModel = this._firstNode.getTableModel();\n    }\n\n    this._onChange = _.debounce(this._onChange.bind(this), 500);\n\n    if (this.isNew()) {\n      // Bind change event in order to \"store\" all changed columns after creation\n      this._bindChangeEvent();\n    }\n  },\n\n  isNew: function () {\n    return !this.has('cartodb_id');\n  },\n\n  isPoint: function () {\n    return this._isType(TYPES_POINT);\n  },\n\n  isPolygon: function () {\n    return this._isType(TYPES_POLYGON);\n  },\n\n  isLine: function () {\n    return this._isType(TYPES_LINE);\n  },\n\n  _isType: function (type) {\n    return this._getType() === type;\n  },\n\n  isEditable: function () {\n    var analysisDefinitionModel = this._getAnalysisDefinitionNodeModel();\n    return !analysisDefinitionModel.isReadOnly();\n  },\n\n  _getPermissionModel: function () {\n    return this._tableNodeModel && this._tableNodeModel.getPermissionModel();\n  },\n\n  isReadOnly: function () {\n    return this._tableNodeModel && this._tableNodeModel.isReadOnly(this._userModel);\n  },\n\n  hasAnalyses: function () {\n    return this._layerDefinitionModel.hasAnalyses();\n  },\n\n  isCustomQueryApplied: function () {\n    var analysisDefinitionModel = this._getAnalysisDefinitionNodeModel();\n    return analysisDefinitionModel.isCustomQueryApplied();\n  },\n\n  _getAnalysisDefinitionNodeModel: function () {\n    return this._layerDefinitionModel.getAnalysisDefinitionNodeModel();\n  },\n\n  isEqual: function (featureDefinition) {\n    return this.get('cartodb_id') === featureDefinition.get('cartodb_id') &&\n      this.getLayerId() === featureDefinition.getLayerId();\n  },\n\n  getLayerId: function () {\n    return this._layerDefinitionModel.id;\n  },\n\n  getLayerDefinition: function () {\n    return this._layerDefinitionModel;\n  },\n\n  _cleanChangesHistory: function () {\n    this._changesHistory = [];\n  },\n\n  _bindChangeEvent: function () {\n    this.on('change', this._onChange, this);\n  },\n\n  _unbindChangeEvent: function () {\n    this.off('change', this._onChange, this);\n  },\n\n  _onChange: function () {\n    _.each(this.changed, function (value, key) {\n      if (!_.contains(this._changesHistory, key)) {\n        this._changesHistory.push(key);\n      }\n    }, this);\n  },\n\n  hasBeenChangedAfterLastSaved: function (key) {\n    return _.contains(this._changesHistory, key);\n  },\n\n  getFeatureType: function () {\n    if (this.isPoint()) {\n      return 'point';\n    }\n    if (this.isLine()) {\n      return 'line';\n    }\n    if (this.isPolygon()) {\n      return 'polygon';\n    }\n  },\n\n  fetch: function (options) {\n    options = options || {};\n    this._unbindChangeEvent();\n\n    this._getQueryRowModel().fetch({\n      success: function (data) {\n        this.set(data.toJSON());\n        // Bind change event in order to \"store\" all changed columns after starting edition\n        this._bindChangeEvent();\n        options.success && options.success();\n      }.bind(this)\n    });\n  },\n\n  save: function (options) {\n    options = options || {};\n    var columns = this._layerDefinitionModel.getColumnNamesFromSchema();\n    var attrs = _.pick(this.toJSON(), _.difference(columns, BLACKLISTED_COLUMNS));\n\n    this._getQueryRowModel().save(attrs, {\n      success: function (queryRowModel) {\n        if (this.isNew()) {\n          this.set('cartodb_id', queryRowModel.get('cartodb_id'));\n        }\n        this.trigger('save', this, options);\n        options.success && options.success();\n        this._cleanChangesHistory();\n      }.bind(this),\n      error: function () {\n        options.error && options.error();\n      }\n    });\n  },\n\n  destroy: function (options) {\n    options = options || {};\n    this._getQueryRowModel().destroy({\n      success: function () {\n        this.trigger('remove', this, options);\n        options.success && options.success();\n      }.bind(this),\n      error: function () {\n        options.error && options.error();\n      }\n    });\n  },\n\n  _getQueryRowModel: function () {\n    var attrs = {};\n\n    if (this.has('cartodb_id')) {\n      attrs.cartodb_id = this.get('cartodb_id');\n    }\n\n    this._queryRowModel = this._queryRowModel || new QueryRowModel(attrs, {\n      tableName: this._layerDefinitionModel.getTableName(),\n      configModel: this._configModel,\n      permissionModel: this._getPermissionModel(),\n      userModel: this._userModel\n    });\n\n    return this._queryRowModel;\n  },\n\n  _getType: function () {\n    var the_geom = this.get('the_geom');\n    var type = the_geom && convertGeoJSONTypeToFeatureType(the_geom) || this._featureType;\n\n    return type;\n  }\n});\n\nmodule.exports = FeatureDefinitionModel;\n",
    "var MAP = {\n  'st_multipolygon': 'polygon',\n  'st_polygon': 'polygon',\n  'st_multilinestring': 'line',\n  'st_linestring': 'line',\n  'st_multipoint': 'point',\n  'st_point': 'point'\n};\n\n/**\n * @param {String} val e.g. 'ST_MultiPoint'\n * @return {String} e.g. 'point'\n */\nmodule.exports = function (val) {\n  return MAP[val.toLowerCase()];\n};\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar syncAbort = require('./backbone/sync-abort');\nvar UserModel = require('./user-model');\nvar GroupModel = require('./group-model');\n\n/**\n * A collection of Grantable objects.\n */\nmodule.exports = Backbone.Collection.extend({\n\n  model: function (attrs, options) {\n    var type = attrs.type;\n    var configModel = attrs.configModel;\n    options = _.extend(options, {\n      configModel: configModel\n    });\n\n    if (attrs.model) {\n      attrs = _.extend({}, attrs, attrs.model);\n    }\n\n    if (type === 'user') {\n      return new UserModel(_.omit(attrs, 'configModel'), options);\n    } else if (type === 'group') {\n      return new GroupModel(_.omit(attrs, 'configModel'), options);\n    }\n  },\n\n  sync: syncAbort,\n\n  url: function (method) {\n    var baseUrl = this.configModel.get('base_url');\n    var version = this.configModel.urlVersion('organizationGrantables', method);\n    return baseUrl + '/api/' + version + '/organization/' + this.organization.id + '/grantables';\n  },\n\n  initialize: function (users, opts) {\n    if (!opts.organization) throw new Error('Organization is required');\n    if (!opts.currentUserId) throw new Error('currentUserId is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this.configModel = opts.configModel;\n    this.organization = opts.organization;\n    this.currentUserId = opts.currentUserId;\n  },\n\n  parse: function (response) {\n    this.trigger('fetched', this);\n    this.total_entries = response.total_entries;\n\n    return _.reduce(response.grantables, function (memo, m) {\n      if (m.id === this.currentUserId) {\n        this.total_entries--;\n      } else {\n        m.organization = this.organization;\n        m.configModel = this.configModel;\n        memo.push(m);\n      }\n      return memo;\n    }, [], this);\n  },\n\n  fetch: function (opts) {\n    opts = opts || {};\n    this.trigger('fetching', this);\n    opts.error = function (model, response) {\n      this.trigger('error', this);\n    }.bind(this);\n\n    return Backbone.Collection.prototype.fetch.call(this, opts);\n  },\n\n  totalCount: function () {\n    return this.total_entries;\n  }\n\n});\n",
    "var Backbone = require('backbone');\nvar UsersGroup = require('./users-group-collection');\n\n/**\n * Model representing a group.\n * Expected to be used in the context of a groups collection (e.g. OrganizationGroups),\n * which defines its API endpoint path.\n */\n\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    display_name: ''\n  },\n\n  initialize: function (attrs, opts) {\n    this.parse(attrs || {}, opts); // handle given attrs in the same way as for .fetch()\n  },\n\n  parse: function (attrs, opts) {\n    this.users = new UsersGroup(attrs.users, {\n      group: this,\n      configModel: opts.configModel,\n      organization: opts.organization\n    });\n\n    return attrs;\n  }\n});\n",
    "var InfowindowDefinitionModel = require('./infowindow-definition-model');\n\nmodule.exports = InfowindowDefinitionModel.extend({\n\n  defaults: {\n    template_name: '',\n    latlng: [0, 0],\n    offset: [28, 0], // offset of the tip calculated from the bottom left corner\n    maxHeight: 180, // max height of the content, not the whole infowindow\n    autoPan: true,\n    template: '',\n    content: '',\n    visibility: false,\n    alternative_names: { },\n    fields: null, // contains the fields displayed in the infowindow,\n    width: 226,\n    headerColor: {\n      color: {\n        fixed: '#35AAE5',\n        opacity: 1\n      }\n    }\n  },\n\n  TEMPLATES: {\n    infowindow_light: require('../mustache-templates/infowindows/infowindow_light.jst.mustache'),\n    infowindow_dark: require('../mustache-templates/infowindows/infowindow_dark.jst.mustache'),\n    infowindow_color: require('../mustache-templates/infowindows/infowindow_color.jst.mustache'),\n    infowindow_header_with_image: require('../mustache-templates/infowindows/infowindow_header_with_image.jst.mustache'),\n    custom_infowindow_light: require('../mustache-templates/infowindows_custom/infowindow_light.jst.mustache'),\n    custom_infowindow_dark: require('../mustache-templates/infowindows_custom/infowindow_dark.jst.mustache'),\n    custom_infowindow_color: require('../mustache-templates/infowindows_custom/infowindow_color.jst.mustache'),\n    custom_infowindow_header_with_image: require('../mustache-templates/infowindows_custom/infowindow_header_with_image.jst.mustache')\n  },\n\n  _transformTemplate: function (template) {\n    var fixed = this.get('headerColor').color.fixed;\n\n    return template.replace('background: #35AAE5', 'background: ' + fixed);\n  },\n\n  setTemplate: function (templateName) {\n    var template = (typeof (this.TEMPLATES[templateName]) === 'undefined') ? '' : this.TEMPLATES[templateName];\n\n    if (templateName === 'infowindow_color') {\n      template = this._transformTemplate(template);\n    }\n\n    var attrs = {\n      'template_name': templateName,\n      'template': template,\n      'template_type': 'mustache'\n    };\n\n    if (templateName === '') {\n      attrs.fields = [];\n    }\n\n    this.set(attrs);\n  },\n\n  isEmptyTemplate: function () {\n    var isEmpty = this.fieldCount() === 0;\n    return this.hasTemplate() && isEmpty;\n  },\n\n  setDefault: function () {\n    this.setTemplate(this.defaults.template_name);\n  }\n\n});\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar $ = require('jquery');\n\nmodule.exports = Backbone.Model.extend({\n\n  SYSTEM_COLUMNS: ['the_geom', 'the_geom_webmercator', 'created_at', 'updated_at', 'cartodb_id', 'cartodb_georef_status'],\n\n  TEMPLATES: {},\n\n  initialize: function (attrs, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._configModel = opts.configModel;\n  },\n\n  clearFields: function () {\n    this.set({ 'fields': [] });\n  },\n\n  saveFields: function (where) {\n    where = where || 'old_fields';\n    this.set(where, _.clone(this.get('fields')));\n  },\n\n  fieldCount: function () {\n    var fields = this.get('fields');\n    if (!fields) return 0;\n    return fields.length;\n  },\n\n  restoreFields: function (whiteList, from) {\n    from = from || 'old_fields';\n    var fields = this.get(from);\n    if (whiteList) {\n      fields = fields.filter(function (f) {\n        return _.contains(whiteList, f.name);\n      });\n    }\n    if (fields && fields.length) {\n      this._setFields(fields);\n    }\n    this.unset(from);\n  },\n\n  containsField: function (fieldName) {\n    var fields = this.get('fields') || [];\n    return _.contains(_(fields).pluck('name'), fieldName);\n  },\n\n  getFieldProperty: function (fieldName, k) {\n    if (this.containsField(fieldName)) {\n      var fields = this.get('fields') || [];\n      var idx = _.indexOf(_(fields).pluck('name'), fieldName);\n      return fields[idx][k];\n    }\n    return null;\n  },\n\n  setFieldProperty: function (fieldName, k, v) {\n    if (this.containsField(fieldName)) {\n      var fields = this._cloneFields() || [];\n      var idx = _.indexOf(_(fields).pluck('name'), fieldName);\n      fields[idx][k] = v;\n      this._setFields(fields);\n    }\n    return this;\n  },\n\n  _cloneFields: function () {\n    return _(this.get('fields')).map(function (v) {\n      return _.clone(v);\n    });\n  },\n\n  _setFields: function (f) {\n    f.sort(function (a, b) { return a.position - b.position; });\n    this.set({ 'fields': f });\n  },\n\n  sortFields: function () {\n    this.get('fields').sort(function (a, b) { return a.position - b.position; });\n  },\n\n  _addField: function (fieldName, at) {\n    var dfd = $.Deferred();\n    if (!this.containsField(fieldName)) {\n      var fields = this.get('fields');\n\n      if (fields) {\n        at = at === undefined ? fields.length : at;\n        fields.push({ name: fieldName, title: true, position: at });\n      } else {\n        at = at === undefined ? 0 : at;\n        this.set('fields', [{ name: fieldName, title: true, position: at }], { silent: true });\n      }\n    }\n    dfd.resolve();\n    return dfd.promise();\n  },\n\n  addField: function (fieldName, at) {\n    var self = this;\n    $.when(this._addField(fieldName, at)).then(function () {\n      self.sortFields();\n      self.trigger('add:fields');\n      self.trigger('change:fields', self, self.get('fields'));\n      self.trigger('change', self);\n    });\n    return this;\n  },\n\n  removeField: function (fieldName) {\n    if (this.containsField(fieldName)) {\n      var fields = this._cloneFields() || [];\n      var idx = _.indexOf(_(fields).pluck('name'), fieldName);\n      if (idx >= 0) {\n        fields.splice(idx, 1);\n      }\n      this._setFields(fields);\n      this.trigger('remove:fields');\n    }\n    return this;\n  },\n\n  getAlternativeName: function (fieldName) {\n    return this.get('alternative_names') && this.get('alternative_names')[fieldName];\n  },\n\n  setAlternativeName: function (fieldName, alternativeName) {\n    var alternativeNames = _.clone(this.get('alternative_names') || {});\n\n    alternativeNames[fieldName] = alternativeName;\n    this.set({ 'alternative_names': alternativeNames });\n    this.trigger('change:alternative_names');\n  },\n\n  getFieldPos: function (fieldName) {\n    var p = this.getFieldProperty(fieldName, 'position');\n    if (p === undefined) {\n      return Number.MAX_VALUE;\n    }\n    return p;\n  },\n\n  unsetTemplate: function () {\n    this.setTemplate('');\n  },\n\n  setTemplate: function (templateName) {\n    var template = (typeof (this.TEMPLATES[templateName]) === 'undefined') ? '' : this.TEMPLATES[templateName];\n\n    var attrs = {\n      'template_name': templateName,\n      'template': template,\n      'template_type': 'mustache'\n    };\n\n    if (templateName === '') {\n      attrs.fields = [];\n    }\n\n    this.set(attrs);\n  },\n\n  getTemplate: function () {\n    var template_name = this.get('template_name');\n\n    if (template_name !== '') {\n      return this.TEMPLATES['custom_' + template_name];\n    } else {\n      return this.get('template');\n    }\n  },\n\n  hasTemplate: function () {\n    return !!this.get('template_name') && this.TEMPLATES[this.get('template_name')];\n  },\n\n  isCustomTemplate: function () {\n    return this.get('template_name') === '' && this.get('template') !== '';\n  }\n\n});\n",
    "var InfowindowDefinitionModel = require('./infowindow-definition-model');\n\nmodule.exports = InfowindowDefinitionModel.extend({\n\n  defaults: {\n    vertical_offset: 0,\n    horizontal_offset: 0,\n    position: 'top|center',\n    template_name: '',\n    template: ''\n  },\n\n  TEMPLATES: {\n    tooltip_dark: require('../mustache-templates/tooltips/tooltip_dark.jst.mustache'),\n    tooltip_light: require('../mustache-templates/tooltips/tooltip_light.jst.mustache'),\n    custom_tooltip_dark: require('../mustache-templates/tooltips_custom/tooltip_dark.jst.mustache'),\n    custom_tooltip_light: require('../mustache-templates/tooltips_custom/tooltip_light.jst.mustache')\n  },\n\n  setDefault: function () {\n    this.setTemplate(this.defaults.template_name);\n  }\n\n});\n",
    "module.exports = {\n  COLORS: [\n    '#66B79E',\n    '#E65176',\n    '#528995',\n    '#FF710F',\n    '#305482',\n    '#CCD859',\n    '#565175',\n    '#FFB927',\n    '#3EBCAE',\n    '#E54C1F'\n  ],\n\n  /**\n   * Returns a color given a letter\n   * @param  {String} Letter. eg: 'a', 'b', 'c', etc.\n   * @return {String} Hex color code: eg: '#7F3C8D'\n   */\n  getColorForLetter: function (letter) {\n    if (!letter) {\n      return this.COLORS[0];\n    }\n\n    var letterNumber = letter.charCodeAt(0) - 97;\n    var colorIndex = ((letterNumber / this.COLORS.length % 1) * 10).toFixed();\n    return this.COLORS[colorIndex] || this.COLORS[0];\n  }\n};\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar syncAbort = require('./backbone/sync-abort');\nvar StyleDefinitionModel = require('../editor/style/style-definition-model');\nvar StyleCartoCSSModel = require('../editor/style/style-cartocss-model');\nvar DataSQLModel = require('../editor/layers/layer-content-views/data/data-sql-model');\nvar layerTypesAndKinds = require('./layer-types-and-kinds');\nvar InfowindowModel = require('./infowindow-click-model');\nvar TooltipModel = require('./infowindow-hover-model');\nvar TableNameUtils = require('../helpers/table-name-utils');\n\n// from_layer_id and from_letter are not attributes for the model, but are sent to the layer creation\n// endpoint when creating a layer from an existing analysis node (see user-actions)\nvar OWN_ATTR_NAMES = ['id', 'order', 'infowindow', 'tooltip', 'error', 'from_layer_id', 'from_letter'];\n\n/**\n * Model to edit a layer definition.\n * Should always exist as part of a LayerDefinitionsCollection, so its URL is given from there.\n */\nmodule.exports = Backbone.Model.extend({\n\n  /**\n   * @override {Backbone.prototype.sync} abort ongoing request if there is any\n   */\n  sync: syncAbort,\n\n  parse: function (r, opts) {\n    r.options = r.options || {};\n\n    // Flatten the attrs, to avoid having this.get('options').foobar internally\n    var attrs = _\n      .defaults(\n        _.pick(r, OWN_ATTR_NAMES),\n        _.omit(r.options, ['query', 'tile_style'])\n    );\n\n    // Only use type on the frontend, it will be mapped back when the model is serialized (see .toJSON)\n    attrs.type = attrs.type || layerTypesAndKinds.getType(r.kind);\n\n    // Map API endpoint attrs to the new names used client-side (cartodb.js in particular)\n    if (r.options.tile_style) {\n      attrs.cartocss = r.options.tile_style;\n    }\n    if (r.options.query) {\n      attrs.sql = r.options.query;\n    }\n\n    if (r.infowindow) {\n      if (!this.infowindowModel) {\n        this.infowindowModel = new InfowindowModel(r.infowindow, {\n          configModel: opts.configModel || this._configModel\n        });\n      }\n    }\n    if (r.tooltip) {\n      if (!this.tooltipModel) {\n        this.tooltipModel = new TooltipModel(r.tooltip, {\n          configModel: opts.configModel || this._configModel\n        });\n      }\n    }\n    if (r.options.table_name) {\n      // Set autostyle as false if it doesn't contain any id\n      attrs.autoStyle = attrs.autoStyle || false;\n\n      if (!this.styleModel) {\n        this.styleModel = new StyleDefinitionModel(r.options.style_properties, {\n          parse: true\n        });\n\n        this.cartocssModel = new StyleCartoCSSModel({\n          content: attrs.cartocss\n        }, {\n          history: r.options.cartocss_history || r.options.tile_style_history\n        });\n      }\n\n      if (!this.sqlModel) {\n        this.sqlModel = new DataSQLModel({\n          content: attrs.sql\n        }, {\n          history: r.options.sql_history\n        });\n      }\n    }\n\n    // Flatten the rest of the attributes\n    return attrs;\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._configModel = opts.configModel;\n\n    this.on('change:source change:sql', this._onPosibleLayerSchemaChanged, this);\n\n    if (this.styleModel) {\n      this.styleModel.bind('change:type change:animated', function () {\n        if (this.styleModel.isAggregatedType() || this.styleModel.isAnimation()) {\n          // setTemplate will clear fields\n          this.infowindowModel && this.infowindowModel.unsetTemplate();\n          this.tooltipModel && this.tooltipModel.unsetTemplate();\n        }\n      }, this);\n    }\n  },\n\n  save: function (attrs, options) {\n    // We assume that if the layer is saved, we have to disable autostyle\n    var autoStyleAttrs = {\n      autoStyle: false\n    };\n\n    // But if the layer is saved with shouldPreserveAutoStyle option, we should preserve autostyle\n    if (options && options.shouldPreserveAutoStyle) {\n      delete autoStyleAttrs.autoStyle;\n    } else if (this.get('autoStyle')) {\n      this.styleModel && this.styleModel.resetPropertiesFromAutoStyle();\n    }\n\n    attrs = _.extend(\n      {},\n      autoStyleAttrs,\n      attrs\n    );\n\n    return Backbone.Model.prototype.save.apply(this, [attrs, options]);\n  },\n\n  toJSON: function () {\n    // Un-flatten the internal attrs to the datastructure that's expected by the API endpoint\n    var options = _.omit(this.attributes, OWN_ATTR_NAMES.concat(['cartocss', 'sql', 'autoStyle']));\n\n    // Map back internal attrs to the expected attrs names by the API endpoint\n    var cartocss = this.get('cartocss');\n\n    if (cartocss) {\n      options.tile_style = cartocss;\n    }\n    var sql = this.get('sql');\n    if (sql) {\n      options.query = sql;\n    }\n\n    var d = {\n      kind: layerTypesAndKinds.getKind(this.get('type')),\n      options: options\n    };\n\n    var infowindowData = this.infowindowModel && this.infowindowModel.toJSON();\n    if (!_.isEmpty(infowindowData)) {\n      d.infowindow = this.infowindowModel.toJSON();\n    }\n\n    var tooltipData = this.tooltipModel && this.tooltipModel.toJSON();\n    if (!_.isEmpty(tooltipData)) {\n      d.tooltip = this.tooltipModel.toJSON();\n    }\n\n    if (this.styleModel && !this.styleModel.isAutogenerated()) {\n      d.options.style_properties = this.styleModel.toJSON();\n    }\n\n    if (this.cartocssModel) {\n      d.options.cartocss_history = this.cartocssModel.getHistory();\n    }\n\n    if (this.sqlModel) {\n      d.options.sql_history = this.sqlModel.getHistory();\n    }\n\n    var attributes = _.omit(this.attributes, 'infowindow', 'tooltip', 'options', 'error', 'autoStyle');\n\n    return _.defaults(\n      d,\n      _.pick(attributes, OWN_ATTR_NAMES)\n    );\n  },\n\n  canBeDeletedByUser: function () {\n    return this.collection.getNumberOfDataLayers() > 1 && this.isDataLayer() &&\n      (this._canBeFoldedUnderAnotherLayer() || !this._isAllDataLayersDependingOnAnyAnalysisOfThisLayer());\n  },\n\n  isOwnerOfAnalysisNode: function (nodeModel) {\n    return nodeModel && nodeModel.letter() === this.get('letter');\n  },\n\n  ownedPrimaryAnalysisNodes: function () {\n    var nodeDefModel = this.getAnalysisDefinitionNodeModel();\n    return this.isOwnerOfAnalysisNode(nodeDefModel)\n      ? nodeDefModel.linkedListBySameLetter()\n      : [];\n  },\n\n  getName: function () {\n    return this.get('name') ||\n    this.get('table_name_alias') ||\n    this.get('table_name');\n  },\n\n  getTableName: function () {\n    return this.get('table_name') || '';\n  },\n\n  containsNode: function (other) {\n    var nodeDefModel = this.getAnalysisDefinitionNodeModel();\n    return nodeDefModel && nodeDefModel.containsNode(other);\n  },\n\n  getAnalysisDefinitionNodeModel: function () {\n    return this.findAnalysisDefinitionNodeModel(this.get('source'));\n  },\n\n  findAnalysisDefinitionNodeModel: function (id) {\n    return this.collection && this.collection.findAnalysisDefinitionNodeModel(id);\n  },\n\n  _onPosibleLayerSchemaChanged: function (eventName, attrs, options) {\n    // Used to avoid resetting styles on source_id changes when we have saved styles for the node\n    if (options && options.ignoreSchemaChange) {\n      return;\n    }\n\n    if (this.infowindowModel) {\n      this.infowindowModel.clearFields();\n    }\n    if (this.tooltipModel) {\n      this.tooltipModel.clearFields();\n    }\n    if (this.styleModel) {\n      this.styleModel.resetStyles();\n    }\n  },\n\n  toggleVisible: function () {\n    this.set('visible', !this.get('visible'));\n  },\n\n  toggleCollapse: function () {\n    this.set('collapsed', !this.get('collapsed'));\n  },\n\n  hasAnalyses: function () {\n    return this.getNumberOfAnalyses() > 0;\n  },\n\n  getNumberOfAnalyses: function () {\n    var analysisNode = this.getAnalysisDefinitionNodeModel();\n    var count = 0;\n\n    while (analysisNode && this.isOwnerOfAnalysisNode(analysisNode)) {\n      analysisNode = analysisNode.getPrimarySource();\n\n      if (analysisNode) {\n        count += 1;\n      }\n    }\n\n    return count;\n  },\n\n  getQualifiedTableName: function () {\n    var userName = this.get('user_name') || this.collection.userModel.get('username');\n    return TableNameUtils.getQualifiedTableName(\n      this.getTableName(),\n      userName,\n      this.collection.userModel.isInsideOrg()\n    );\n  },\n\n  getColumnNamesFromSchema: function () {\n    return this._getQuerySchemaModel().getColumnNames();\n  },\n\n  _getQuerySchemaModel: function () {\n    var nodeDefModel = this.getAnalysisDefinitionNodeModel();\n    return nodeDefModel.querySchemaModel;\n  },\n\n  isDataLayer: function () {\n    var layerType = this.get('type');\n    return layerTypesAndKinds.isCartoDBType(layerType) ||\n      layerTypesAndKinds.isTorqueType(layerType);\n  },\n\n  isTorqueLayer: function () {\n    return this.get('type') === 'torque';\n  },\n\n  _canBeFoldedUnderAnotherLayer: function () {\n    var thisNodeDefModel = this.getAnalysisDefinitionNodeModel();\n\n    return this.collection.any(function (m) {\n      if (m !== this && m.isDataLayer()) {\n        var otherNodeDefModel = m.getAnalysisDefinitionNodeModel();\n        if (otherNodeDefModel === thisNodeDefModel) return true;\n\n        var lastNode = _.last(otherNodeDefModel.linkedListBySameLetter());\n        return lastNode.getPrimarySource() === thisNodeDefModel;\n      }\n    }, this);\n  },\n\n  _isAllDataLayersDependingOnAnyAnalysisOfThisLayer: function () {\n    var nodeDefModel = this.getAnalysisDefinitionNodeModel();\n    if (!nodeDefModel) return false;\n    if (!this.isOwnerOfAnalysisNode(nodeDefModel)) return false;\n\n    var linkedNodesList = nodeDefModel.linkedListBySameLetter();\n\n    return this.collection.chain()\n      .filter(function (m) {\n        return m !== this && !!m.get('source');\n      }, this)\n      .all(function (m) {\n        return _.any(linkedNodesList, function (node) {\n          return m.containsNode(node);\n        });\n      }, this)\n      .value();\n  },\n\n  getAllDependentLayers: function () {\n    var self = this;\n    var layersCount = 0;\n\n    var layerDefinitionsCollectionModels = self.collection.models;\n\n    for (var i = 0; i < layerDefinitionsCollectionModels.length; i++) {\n      var layer = layerDefinitionsCollectionModels[i];\n      var dependentAnalysis = false;\n\n      if (layer !== self) {\n        var analysisNode = layer.getAnalysisDefinitionNodeModel();\n\n        while (analysisNode) {\n          if (self.isOwnerOfAnalysisNode(analysisNode)) {\n            dependentAnalysis = true;\n          }\n          analysisNode = analysisNode.getPrimarySource();\n        }\n\n        if (dependentAnalysis) {\n          layersCount += 1;\n        }\n      }\n    }\n    return layersCount;\n  },\n\n  matchesAttrs: function (otherAttrs) {\n    if (this.get('type') !== otherAttrs.type) {\n      return false;\n    }\n\n    if (layerTypesAndKinds.isTiledType(otherAttrs.type)) {\n      return this.get('name') === otherAttrs.name &&\n        this.get('urlTemplate') === otherAttrs.urlTemplate;\n    }\n\n    if (layerTypesAndKinds.isGMapsBase(otherAttrs.type)) {\n      return this.get('name') === otherAttrs.name &&\n        this.get('baseType') === otherAttrs.baseType &&\n          this.get('style') === otherAttrs.style;\n    }\n\n    if (layerTypesAndKinds.isPlainType(otherAttrs.type)) {\n      return this.get('color') === otherAttrs.color;\n    }\n\n    return false;\n  },\n\n  canBeGeoreferenced: function () {\n    var hasGeocodingAnalysisApplied = function () {\n      var analysisNode = this.getAnalysisDefinitionNodeModel();\n\n      if (analysisNode && analysisNode.get('type') === 'geocoding') {\n        return true;\n      }\n\n      while (analysisNode && this.isOwnerOfAnalysisNode(analysisNode)) {\n        analysisNode = analysisNode.getPrimarySource();\n\n        if (analysisNode && analysisNode.get('type') === 'geocoding') {\n          return true;\n        }\n      }\n\n      return false;\n    }.bind(this);\n\n    var analysisDefinitionNodeModel = this.getAnalysisDefinitionNodeModel();\n    return !hasGeocodingAnalysisApplied() &&\n           !analysisDefinitionNodeModel.queryGeometryModel.hasValue() &&\n           !analysisDefinitionNodeModel.isCustomQueryApplied() &&\n           !analysisDefinitionNodeModel.queryRowsCollection.isEmpty();\n  }\n});\n",
    "var $ = require('jquery');\nvar _ = require('underscore');\nvar Backbone = require('backbone');\nvar LayerDefinitionModel = require('./layer-definition-model');\nvar layerLetters = require('./layer-letters');\nvar layerColors = require('./layer-colors');\nvar nodeIds = require('../value-objects/analysis-node-ids');\nvar layerTypesAndKinds = require('./layer-types-and-kinds');\nvar SQLUtils = require('../helpers/sql-utils');\nvar TableNameUtils = require('../helpers/table-name-utils');\nvar checkAndBuildOpts = require('../helpers/required-opts');\nvar REQUIRED_OPTS = [\n  'analysisDefinitionNodesCollection',\n  'configModel',\n  'mapId',\n  'stateDefinitionModel',\n  'userModel'\n];\n\nvar generateLabelsLayerName = function (layerName) {\n  return layerName + ' Labels';\n};\n\n/**\n * Collection of layer definitions\n */\nmodule.exports = Backbone.Collection.extend({\n\n  initialize: function (models, opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n  },\n\n  url: function () {\n    var baseUrl = this._configModel.get('base_url');\n    return baseUrl + '/api/v1/maps/' + this._mapId + '/layers';\n  },\n\n  parse: function (r) {\n    return r.layers;\n  },\n\n  save: function (options) {\n    this.each(function (layerDefModel, index) {\n      layerDefModel.set('order', index, { silent: true });\n    });\n    Backbone.sync('update', this, options);\n  },\n\n  toJSON: function () {\n    return {\n      layers: Backbone.Collection.prototype.toJSON.apply(this, arguments)\n    };\n  },\n\n  /**\n   * Intended to be called from entry point, to make sure initial layers are taken into account\n   */\n  resetByLayersData: function (layersData) {\n    this.reset(layersData, {\n      silent: true,\n      initialLetters: _.chain(layersData)\n        .pluck('options')\n        .pluck('letter')\n        .compact()\n        .value()\n    });\n  },\n\n  comparator: function (m) {\n    return m.get('order');\n  },\n\n  model: function (d, opts) {\n    var self = opts.collection;\n\n    // Add data required for new editor if not set (e.g. a vis created on old editor doesn't contain letter and source)\n    var o = _.clone(d.options) || {};\n    var attrs = _.defaults(\n      { options: o },\n      _.omit(d, ['options']\n    ));\n\n    if (!isNaN(opts.at)) {\n      attrs.options.order = opts.at;\n    }\n\n    if (layerTypesAndKinds.isKindDataLayer(attrs.kind)) {\n      o.letter = o.letter || layerLetters.next(self._takenLetters(opts.initialLetters));\n      o.color = o.color || layerColors.getColorForLetter(o.letter);\n\n      // Create source attr if it does not already exist\n      var sourceId = nodeIds.next(o.letter);\n\n      if (o.table_name && (!o.source || o.source === sourceId)) {\n        var tableName = TableNameUtils.getUnqualifiedName(o.table_name);\n        var userName = o.user_name || TableNameUtils.getUsername(o.table_name);\n\n        var qualifyTableName = (userName && self._configModel.get('user_name') !== userName) || self._userModel.isInsideOrg();\n        tableName = TableNameUtils.getQualifiedTableName(o.table_name, userName, qualifyTableName);\n\n        o.source = o.source || sourceId;\n        o.query = o.query || SQLUtils.getDefaultSQLFromTableName(tableName);\n\n        // Add analysis definition unless already existing\n        self._analysisDefinitionNodesCollection.createSourceNode({\n          id: sourceId,\n          tableName: tableName,\n          query: o.query\n        });\n      }\n    }\n\n    var parseAttrs = typeof opts.parse === 'boolean' ? opts.parse : true;\n    var m = new LayerDefinitionModel(attrs, {\n      parse: parseAttrs,\n      collection: self,\n      configModel: self._configModel\n    });\n\n    return m;\n  },\n\n  nextLetter: function () {\n    return layerLetters.next(this._takenLetters());\n  },\n\n  findAnalysisDefinitionNodeModel: function (id) {\n    return this._analysisDefinitionNodesCollection.get(id);\n  },\n\n  findOwnerOfAnalysisNode: function (nodeDefModel) {\n    return this.find(function (layerDefModel) {\n      return layerDefModel.isOwnerOfAnalysisNode(nodeDefModel);\n    });\n  },\n\n  findPrimaryParentLayerToAnalysisNode: function (nodeDefModel, opts) {\n    if (!nodeDefModel) return;\n\n    opts = opts || {};\n    if (!_.isArray(opts.exclude)) {\n      opts.exclude = [opts.exclude];\n    }\n    var owner = this.findOwnerOfAnalysisNode(nodeDefModel);\n\n    return this.find(function (layerDefModel) {\n      if (layerDefModel === owner) return;\n      if (_.contains(opts.exclude, layerDefModel)) return;\n\n      var layerHeadNode = layerDefModel.getAnalysisDefinitionNodeModel();\n      if (nodeDefModel === layerHeadNode) return true;\n\n      if (layerHeadNode) {\n        var primarySourceOfLastOwnNode = _.last(layerHeadNode.linkedListBySameLetter()).getPrimarySource();\n        return nodeDefModel === primarySourceOfLastOwnNode;\n      }\n    });\n  },\n\n  isThereAnyGeometryData: function () {\n    return this.filter(function (layerDefModel) {\n      return layerDefModel.isDataLayer();\n    }).some(function (layerDefModel) {\n      var queryGeometryModel = layerDefModel.getAnalysisDefinitionNodeModel().queryGeometryModel;\n      return queryGeometryModel && queryGeometryModel.hasValue();\n    });\n  },\n\n  loadAllQueryGeometryModels: function (callback) {\n    var promises = this.filter(function (layerDefModel) {\n      return layerDefModel.isDataLayer();\n    }).map(function (layerDefModel) {\n      var queryGeometryModel = layerDefModel.getAnalysisDefinitionNodeModel().queryGeometryModel;\n      var status = queryGeometryModel.get('status');\n      var deferred = new $.Deferred();\n\n      if (queryGeometryModel.isFetched()) {\n        deferred.resolve();\n      } else if (queryGeometryModel.canFetch()) {\n        if (status !== 'fetching') {\n          queryGeometryModel.fetch({\n            success: function () {\n              deferred.resolve();\n            },\n            error: function () {\n              deferred.reject();\n            }\n          });\n        } else {\n          deferred.resolve();\n        }\n      } else {\n        deferred.reject();\n      }\n\n      return deferred.promise();\n    }, this);\n\n    $.when.apply($, promises).done(callback);\n  },\n\n  isThereAnyTorqueLayer: function () {\n    return this.any(function (m) {\n      return layerTypesAndKinds.isTorqueType(m.get('type'));\n    });\n  },\n\n  isThereAnyCartoDBLayer: function () {\n    return this.any(function (m) {\n      return layerTypesAndKinds.isCartoDBType(m.get('type'));\n    });\n  },\n\n  anyContainsNode: function (nodeDefModel) {\n    return this.any(function (layerDefModel) {\n      return layerDefModel.containsNode(nodeDefModel);\n    });\n  },\n\n  isDataLayerOnTop: function (lyrModel) {\n    var currentPos = this.indexOf(lyrModel);\n    return currentPos === this.getTopDataLayerIndex();\n  },\n\n  getTopDataLayerIndex: function () {\n    var layerOnTop = this.getLayerOnTop();\n    var at = this.indexOf(layerOnTop);\n    var hasLabels = layerOnTop &&\n      !layerTypesAndKinds.isCartoDBType(layerOnTop.get('type')) &&\n      !layerTypesAndKinds.isTorqueType(layerOnTop.get('type'));\n\n    if (hasLabels) { at--; }\n\n    return at;\n  },\n\n  getNumberOfDataLayers: function () {\n    return this.select(function (m) {\n      return layerTypesAndKinds.isCartoDBType(m.get('type')) ||\n        layerTypesAndKinds.isTorqueType(m.get('type'));\n    }).length;\n  },\n\n  _takenLetters: function (otherLetters) {\n    var valuesFromAddedModels = _.compact(this.pluck('letter'));\n\n    // When adding multiple items the models created so far are stored in the internal object this._byId,\n    // need to make sure to take them into account when returning already taken letter.\n    var valuesFromModelsNotYetAdded = _.chain(this._byId).values().invoke('get', 'letter').value();\n\n    return _.union(valuesFromAddedModels, valuesFromModelsNotYetAdded, otherLetters);\n  },\n\n  setBaseLayer: function (newBaseLayerAttrs) {\n    this.trigger('changingBaseLayer');\n\n    newBaseLayerAttrs = _.clone(newBaseLayerAttrs);\n    if (this.isBaseLayerAdded(newBaseLayerAttrs)) {\n      this.trigger('baseLayerChanged');\n      return false;\n    }\n\n    var newBaseLayerHasLabels = newBaseLayerAttrs.labels && newBaseLayerAttrs.labels.url;\n\n    var labelsLayerOptions = {\n      silent: true,\n      wait: true, // do not add/remove the layer unless it's created/removed/updated successfully\n      success: function () {\n        this.trigger('baseLayerChanged');\n      }.bind(this),\n      error: function () {\n        this.trigger('baseLayerFailed');\n      }.bind(this)\n    };\n\n    var baseLayerOptions = {\n      silent: true,\n      wait: true, // do not update the layer unless it's created/updated successfully\n      success: function () {\n        var labelsLayer = this.getLabelsLayer();\n        if (newBaseLayerHasLabels) {\n          if (labelsLayer) {\n            this._updateLabelsLayer(newBaseLayerAttrs, labelsLayerOptions);\n          } else {\n            this._addLabelsLayer(newBaseLayerAttrs, labelsLayerOptions);\n          }\n        } else {\n          if (labelsLayer) {\n            this._destroyLabelsLayer(labelsLayerOptions);\n          } else {\n            this.trigger('baseLayerChanged');\n          }\n        }\n      }.bind(this),\n      error: function () {\n        this.trigger('baseLayerFailed');\n      }.bind(this)\n    };\n\n    if (this.getBaseLayer()) {\n      this._updateBaseLayer(newBaseLayerAttrs, baseLayerOptions);\n    } else {\n      this._createBaseLayer(newBaseLayerAttrs, baseLayerOptions);\n    }\n  },\n\n  isBaseLayerAdded: function (basemapAttrs) {\n    var baseLayerDefinitionModel = this.getBaseLayer();\n    return baseLayerDefinitionModel.matchesAttrs(basemapAttrs);\n  },\n\n  _updateBaseLayer: function (basemapAttrs, opts) {\n    var currentBaseLayer = this.getBaseLayer();\n    var newBaseLayerAttrs = _.omit(basemapAttrs, [ 'id', 'order', 'labels', 'template' ]);\n\n    currentBaseLayer.attributes = _.extend({\n      order: 0\n    }, _.pick(currentBaseLayer.attributes, [\n      'id',\n      'type',\n      'category'\n    ]));\n    currentBaseLayer.save(newBaseLayerAttrs, opts);\n  },\n\n  _createBaseLayer: function (newBaseLayerAttrs, opts) {\n    newBaseLayerAttrs = _.extend(newBaseLayerAttrs, {\n      order: 0\n    });\n    return this.create(newBaseLayerAttrs, _.extend({ at: 0 }, opts));\n  },\n\n  _updateLabelsLayer: function (newBaseLayerAttrs, opts) {\n    var labelsLayer = this.getLabelsLayer();\n    var newAttrs = _.omit(newBaseLayerAttrs, 'labels');\n    newAttrs = _.pick(newAttrs, _.identity);\n    newAttrs = _.extend(newAttrs, {\n      name: generateLabelsLayerName(newBaseLayerAttrs.name),\n      urlTemplate: newBaseLayerAttrs.labels.url\n    });\n    labelsLayer.save(newAttrs, opts);\n  },\n\n  _addLabelsLayer: function (newBaseLayerAttrs, opts) {\n    var optionsAttribute = _.pick(newBaseLayerAttrs, ['type', 'subdomains', 'minZoom', 'maxZoom', 'name', 'className', 'attribution', 'category']);\n    optionsAttribute = _.extend(optionsAttribute, {\n      urlTemplate: newBaseLayerAttrs.labels.url,\n      name: generateLabelsLayerName(newBaseLayerAttrs.name)\n    });\n\n    var labelsLayerAttrs = {\n      order: this.getLayerOnTop().get('order') + 1,\n      options: optionsAttribute\n    };\n\n    this.create(labelsLayerAttrs, opts);\n  },\n\n  _destroyLabelsLayer: function (opts) {\n    this.getLayerOnTop().destroy(opts);\n  },\n\n  getBaseLayer: function () {\n    return this.first();\n  },\n\n  getLabelsLayer: function () {\n    var layerOnTop = this.getLayerOnTop();\n    if (this.size() > 1 && layerTypesAndKinds.isTiledType(layerOnTop.get('type'))) {\n      return layerOnTop;\n    }\n  },\n\n  getLayerOnTop: function () {\n    return this.last();\n  }\n});\n",
    "var _ = require('underscore');\n\nmodule.exports = {\n\n  /**\n   * Get the next available letter.\n   * @param {Array} letters e.g. ['a', 'b', 'd']\n   * @return {String} e.g. 'c'\n   */\n  next: function (letters) {\n    return _.chain(letters)\n      .sort()\n      .reduce(function (memo, letter) {\n        if (letter === memo) {\n          return String.fromCharCode(letter.charCodeAt() + 1);\n        } else {\n          return memo;\n        }\n      }, 'a')\n      .value();\n  }\n\n};\n",
    "// Types\nvar PLAIN = 'Plain';\nvar CARTODB = 'CartoDB';\nvar TILED = 'Tiled';\nvar TORQUE = 'torque';\nvar GMAPSBASE = 'GMapsBase';\nvar WMS = 'WMS';\n\n// Values of `kind` attribute that the backend/DB knows about\nvar KIND_TO_TYPE_MAP = {\n  'background': PLAIN,\n  'carto': CARTODB,\n  'gmapsbase': GMAPSBASE,\n  'tiled': TILED,\n  'torque': TORQUE,\n  'wms': WMS\n};\n\nmodule.exports = {\n  getType: function (kind) {\n    var type = KIND_TO_TYPE_MAP[kind];\n\n    if (!type) {\n      throw new Error('no type found for given kind ' + kind);\n    }\n\n    return type;\n  },\n\n  getKind: function (type) {\n    if (!type) {\n      throw new Error('no kind found for given type ' + type);\n    }\n\n    var kind;\n    for (kind in KIND_TO_TYPE_MAP) {\n      if (KIND_TO_TYPE_MAP[kind] === type) {\n        break;\n      }\n    }\n\n    return kind;\n  },\n\n  isKindDataLayer: function (kind) {\n    var type = KIND_TO_TYPE_MAP[kind];\n    return this.isTypeDataLayer(type);\n  },\n\n  isTypeDataLayer: function (type) {\n    return this.isCartoDBType(type) || this.isTorqueType(type);\n  },\n\n  isCartoDBType: function (type) {\n    return type === CARTODB;\n  },\n\n  isTorqueType: function (type) {\n    return type === TORQUE;\n  },\n\n  isTiledType: function (type) {\n    return type === TILED;\n  },\n\n  isPlainType: function (type) {\n    return type === PLAIN;\n  },\n\n  isGMapsBase: function (type) {\n    return type === GMAPSBASE;\n  }\n};\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar syncAbort = require('../backbone/sync-abort');\nvar LegendsState = require('./legends-state');\n\n/*\n  Base model for a legend. It should have a reference to a layerDefinitionModel.\n */\nmodule.exports = Backbone.Model.extend({\n  defaults: {\n    type: 'none',\n    title: '',\n    postHTMLSnippet: '',\n    preHTMLSnippet: ''\n  },\n\n  sync: syncAbort,\n\n  parse: function (r) {\n    var attrs = _.extend({},\n      _.omit(r, 'created_at', 'updated_at', 'definition', 'pre_html', 'post_html')\n    );\n\n    if (r.conf && r.conf.columns) {\n      attrs.customState = r.conf.columns;\n    }\n\n    attrs.preHTMLSnippet = r.pre_html;\n    attrs.postHTMLSnippet = r.post_html;\n    return attrs;\n  },\n\n  urlRoot: function () {\n    var baseUrl = this.configModel.get('base_url');\n    return baseUrl + '/api/v3/viz/' + this.vizId + '/layer/' + this.layerDefinitionModel.id + '/legends';\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.layerDefinitionModel) throw new Error('layerDefinitionModel is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.vizId) throw new Error('vizId is required');\n\n    this.layerDefinitionModel = opts.layerDefinitionModel;\n    this.configModel = opts.configModel;\n    this.vizId = opts.vizId;\n  },\n\n  getStyles: function () {\n    return this.layerDefinitionModel && this.layerDefinitionModel.styleModel || null;\n  },\n\n  fetch: function () {\n    throw new Error('This model should not make any fetch calls. It should be created from the vizJSON.');\n  },\n\n  getType: function () {\n    return this.get('type');\n  },\n\n  toJSON: function () {\n    return _.extend(\n      this.attributes,\n      {\n        type: this.getType()\n      }\n    );\n  },\n\n  getAttributes: function () {\n    return _.extend(\n      {},\n      _.pick(this.attributes, _.keys(this.defaults)),\n      _.omit(this.attributes, 'pre_html', 'post_html', 'customState')\n    );\n  },\n\n  setAttributes: function (attrs) {\n    // Store the real values\n    LegendsState.set(this.layerDefinitionModel, this.get('type') || attrs.type, attrs);\n    this.set(attrs);\n  },\n\n  // Overriding set\n  set: function (key, val, options) {\n    var attrs;\n    if (typeof key === 'object') {\n      attrs = key;\n      options = val;\n    } else {\n      (attrs = {})[key] = val;\n    }\n\n    options || (options = {});\n\n    var layerDefinitionModel = this.layerDefinitionModel || options.layerDefinitionModel;\n    var type = this.get('type') || attrs.type;\n\n    // Override attributes with the current custom state\n    var state = LegendsState.get(layerDefinitionModel, type);\n    var attributes = _.extend(attrs, {\n      customState: _.keys(state)\n    }, state);\n\n    return Backbone.Model.prototype.set.call(this, attributes, options);\n  },\n\n  hasCustomHtml: function () {\n    return false;\n  }\n});\n",
    "var _ = require('underscore');\nvar LegendBaseDefModel = require('./legend-base-definition-model');\nvar LegendColorHelper = require('../../editor/layers/layer-content-views/legend/form/legend-color-helper');\nvar DEFAULT_BUBBLES_COLOR = '#999999';\n\nmodule.exports = LegendBaseDefModel.extend({\n  defaults: _.extend({}, LegendBaseDefModel.prototype.defaults,\n    {\n      type: 'bubble',\n      fillColor: DEFAULT_BUBBLES_COLOR,\n      topLabel: '',\n      bottomLabel: ''\n    }\n  ),\n\n  parse: function (r, opts) {\n    var attrs = LegendBaseDefModel.prototype.parse.call(this, r);\n\n    if (opts.layerDefinitionModel) {\n      if (r.definition) {\n        attrs.fillColor = r.definition.color;\n        attrs.topLabel = r.definition.top_label;\n        attrs.bottomLabel = r.definition.bottom_label;\n      } else {\n        attrs.fillColor = this._inheritStyleColor(opts.layerDefinitionModel.styleModel);\n      }\n    }\n    return attrs;\n  },\n\n  toJSON: function () {\n    return _.extend(\n      {},\n      _.omit(this.attributes, 'fill', 'fillColor', 'topLabel', 'bottomLabel', 'postHTMLSnippet', 'preHTMLSnippet', 'customState'),\n      {\n        pre_html: this.get('preHTMLSnippet'),\n        post_html: this.get('postHTMLSnippet')\n      },\n      {\n        conf: {\n          columns: this.get('customState')\n        }\n      },\n      {\n        definition: {\n          color: this.get('fillColor'),\n          top_label: this.get('topLabel'),\n          bottom_label: this.get('bottomLabel')\n        }\n      }\n    );\n  },\n\n  _inheritStyleColor: function (styleModel) {\n    var fill = styleModel.get('fill');\n    var stroke = styleModel.get('stroke');\n    var color = (fill && fill.color) || (stroke && stroke.color);\n\n    if (color && (color.fixed || color.range)) {\n      return LegendColorHelper.getBubbles(color).color.fixed;\n    } else {\n      return DEFAULT_BUBBLES_COLOR;\n    }\n  }\n});\n",
    "var _ = require('underscore');\nvar LegendBaseDefModel = require('./legend-base-definition-model');\n\nmodule.exports = LegendBaseDefModel.extend({\n  defaults: _.extend({}, LegendBaseDefModel.prototype.defaults,\n    {\n      type: 'category'\n    }\n  ),\n\n  toJSON: function () {\n    return _.extend(\n      {},\n      _.omit(this.attributes, 'postHTMLSnippet', 'preHTMLSnippet', 'customState'),\n      {\n        pre_html: this.get('preHTMLSnippet'),\n        post_html: this.get('postHTMLSnippet')\n      },\n      {\n        conf: {\n          columns: this.get('customState')\n        }\n      }\n    );\n  }\n});\n",
    "var _ = require('underscore');\nvar LegendBaseDefModel = require('./legend-base-definition-model');\n\nmodule.exports = LegendBaseDefModel.extend({\n  defaults: _.extend({}, LegendBaseDefModel.prototype.defaults,\n    {\n      type: 'choropleth',\n      prefix: '',\n      suffix: '',\n      leftLabel: '',\n      rightLabel: ''\n    }\n  ),\n\n  parse: function (r, opts) {\n    var attrs = LegendBaseDefModel.prototype.parse.call(this, r);\n    if (r.definition) {\n      attrs.prefix = r.definition.prefix;\n      attrs.suffix = r.definition.suffix;\n      attrs.leftLabel = r.definition.left_label;\n      attrs.rightLabel = r.definition.right_label;\n    }\n    return attrs;\n  },\n\n  toJSON: function () {\n    var definition = {\n      prefix: this.get('prefix'),\n      suffix: this.get('suffix'),\n      left_label: this.get('leftLabel'),\n      right_label: this.get('rightLabel')\n    };\n\n    return _.extend(\n      {},\n      _.omit(this.attributes, 'prefix', 'suffix', 'leftLabel', 'rightLabel', 'postHTMLSnippet', 'preHTMLSnippet', 'customState'),\n      {\n        pre_html: this.get('preHTMLSnippet'),\n        post_html: this.get('postHTMLSnippet')\n      },\n      {\n        conf: {\n          columns: this.get('customState')\n        }\n      },\n      {\n        definition: _.pick(definition, _.identity)\n      }\n    );\n  }\n});\n",
    "var _ = require('underscore');\nvar LegendBaseDefModel = require('./legend-base-definition-model');\n\nmodule.exports = LegendBaseDefModel.extend({\n  defaults: _.extend({}, LegendBaseDefModel.prototype.defaults,\n    {\n      type: 'custom_choropleth',\n      prefix: '',\n      suffix: '',\n      colors: [],\n      leftLabel: '',\n      rightLabel: ''\n    }\n  ),\n\n  parse: function (r, opts) {\n    var attrs = LegendBaseDefModel.prototype.parse.call(this, r);\n    var fill;\n    var stroke;\n    var color;\n\n    if (r.definition) {\n      attrs.colors = r.definition.colors;\n      attrs.prefix = r.definition.prefix;\n      attrs.suffix = r.definition.suffix;\n      attrs.leftLabel = r.definition.left_label;\n      attrs.rightLabel = r.definition.right_label;\n    } else {\n      fill = opts.layerDefinitionModel.styleModel.get('fill');\n      stroke = opts.layerDefinitionModel.styleModel.get('stroke');\n      color = fill.color || stroke.color;\n      attrs.colors = this._inheritStyleColors(color);\n    }\n    return attrs;\n  },\n\n  toJSON: function () {\n    var definition = {\n      prefix: this.get('prefix'),\n      suffix: this.get('suffix'),\n      left_label: this.get('leftLabel'),\n      right_label: this.get('rightLabel'),\n      colors: this.get('colors').map(function (item) {\n        return {\n          color: item.color\n        };\n      })\n    };\n\n    return _.extend(\n      {},\n      _.omit(this.attributes, 'prefix', 'suffix', 'leftLabel', 'rightLabel', 'colors', 'postHTMLSnippet', 'preHTMLSnippet', 'customState'),\n      {\n        pre_html: this.get('preHTMLSnippet'),\n        post_html: this.get('postHTMLSnippet')\n      },\n      {\n        conf: {\n          columns: this.get('customState')\n        }\n      },\n      {\n        definition: _.pick(definition, _.identity)\n      }\n    );\n  },\n\n  _inheritStyleColors: function (color) {\n    var range = 0;\n    var colors = [];\n\n    if (color.range) {\n      range = color.range.length;\n\n      colors = _.range(range).map(function (v, index) {\n        return {\n          color: color.range[index]\n        };\n      });\n    }\n\n    return colors;\n  }\n});\n",
    "var _ = require('underscore');\nvar LegendBaseDefModel = require('./legend-base-definition-model');\nvar LegendColorHelper = require('../../editor/layers/layer-content-views/legend/form/legend-color-helper');\n\nmodule.exports = LegendBaseDefModel.extend({\n  defaults: _.extend({}, LegendBaseDefModel.prototype.defaults,\n    {\n      type: 'custom',\n      items: [],\n      html: ''\n    }\n  ),\n\n  parse: function (r, opts) {\n    var attrs = LegendBaseDefModel.prototype.parse.call(this, r);\n    var fill;\n    var stroke;\n    var color;\n\n    if (r.definition) {\n      attrs.items = r.definition.categories;\n      attrs.html = r.definition.html || '';\n    } else {\n      fill = opts.layerDefinitionModel.styleModel.get('fill');\n      stroke = opts.layerDefinitionModel.styleModel.get('stroke');\n      color = fill.color || stroke.color;\n      attrs.items = this.inheritStyleCategories(color);\n    }\n    attrs.type = 'custom';\n    return attrs;\n  },\n\n  toJSON: function () {\n    var definition = {\n      categories: this.get('items').map(function (item) {\n        return {\n          title: item.title || _t('editor.legend.legend-form.untitled'),\n          color: item.color,\n          icon: item.image || item.icon\n        };\n      })\n    };\n\n    if (this.hasCustomHtml()) {\n      definition.html = this.get('html');\n    }\n\n    return _.extend(\n      {},\n      _.omit(this.attributes, 'items', 'html', 'postHTMLSnippet', 'preHTMLSnippet', 'customState'),\n      {\n        pre_html: this.get('preHTMLSnippet'),\n        post_html: this.get('postHTMLSnippet')\n      },\n      {\n        conf: {\n          columns: this.get('customState')\n        }\n      },\n      {\n        definition: definition\n      }\n    );\n  },\n\n  inheritStyleCategories: function (color) {\n    var range = 0;\n    var items = [];\n\n    if (color.range) {\n      range = color.range.length;\n\n      items = _.range(range).map(function (v, index) {\n        return {\n          color: color.range[index],\n          title: color.domain && LegendColorHelper.unquoteColor(color.domain[index]) || '',\n          icon: color.images && color.images[index] || ''\n        };\n      });\n    } else if (color.fixed) {\n      items = [{\n        color: color.fixed,\n        icon: color.image,\n        title: ''\n      }];\n    }\n\n    return items;\n  },\n\n  hasCustomHtml: function () {\n    return this.get('html') !== '';\n  }\n});\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar LegendBaseDefModel = require('./legend-base-definition-model');\nvar layerTypesAndKinds = require('../layer-types-and-kinds');\n\nvar CategoryModel = require('./legend-category-definition-model');\nvar BubbleModel = require('./legend-bubble-definition-model');\nvar ChoroplethModel = require('./legend-choropleth-definition-model');\nvar CustomChoroplethModel = require('./legend-custom-choropleth-definition-model');\nvar CustomModel = require('./legend-custom-definition-model');\n\nvar LEGEND_MODEL_TYPE = {\n  'bubble': BubbleModel,\n  'category': CategoryModel,\n  'choropleth': ChoroplethModel,\n  'custom_choropleth': CustomChoroplethModel,\n  'custom': CustomModel,\n  'html': CustomModel\n};\n\nmodule.exports = Backbone.Collection.extend({\n  model: LegendBaseDefModel,\n\n  initialize: function (models, options) {\n    if (!options.configModel) throw new Error('configModel is required');\n    if (!options.layerDefinitionsCollection) throw new Error('layerDefinitionsCollection is required');\n    if (!options.vizId) throw new Error('vizId is required');\n\n    this.configModel = options.configModel;\n    this.layerDefinitionsCollection = options.layerDefinitionsCollection;\n    this.vizId = options.vizId;\n  },\n\n  /**\n   * Intended to be called from entry point, to make sure initial layers are taken into account\n   */\n  resetByData: function (vizJSON) {\n    var models = [];\n    var layers = _.filter(vizJSON.layers, function (layer) {\n      return this._isDataLayer(layer.type);\n    }, this);\n\n    _.each(layers, function (layer) {\n      var layerDefModel = this._findLayerDefinitionModel(layer.id);\n      var legends = [];\n      if (layer.legends) {\n        legends = layer.legends.map(function (legend) {\n          var Klass = LEGEND_MODEL_TYPE[legend.type];\n\n          return new Klass(legend, {\n            layerDefinitionModel: layerDefModel,\n            configModel: this.configModel,\n            vizId: this.vizId,\n            parse: true\n          });\n        }, this);\n      }\n\n      models.push(legends);\n    }, this);\n\n    this.reset(_.flatten(models));\n  },\n\n  fetch: function () {\n    throw new Error('This collection should not make any fetch calls. It should be populated from the vizJSON.');\n  },\n\n  _isDataLayer: function (layerType) {\n    return layerTypesAndKinds.isCartoDBType(layerType) ||\n      layerTypesAndKinds.isTorqueType(layerType);\n  },\n\n  _findLayerDefinitionModel: function (id) {\n    return this.layerDefinitionsCollection.findWhere({id: id});\n  },\n\n  findByLayerDefModel: function (layerDefModel) {\n    var id = layerDefModel.id;\n    return this.filter(function (legendDefModel) {\n      var layerDefModel = legendDefModel.layerDefinitionModel;\n      return layerDefModel.id === id;\n    });\n  },\n\n  findByLayerDefModelAndType: function (layerDefModel, type) {\n    var id = layerDefModel.id;\n    return this.find(function (legendDefModel) {\n      var layerDefModel = legendDefModel.layerDefinitionModel;\n      return layerDefModel.id === id && legendDefModel.get('type') === type;\n    });\n  },\n\n  findByLayerDefModelAndTypes: function (layerDefModel, types) {\n    var id = layerDefModel.id;\n    return this.filter(function (legendDefModel) {\n      var layerDefModel = legendDefModel.layerDefinitionModel;\n      var type = legendDefModel.get('type');\n      return layerDefModel.id === id && types.indexOf(type) !== -1;\n    });\n  }\n});\n",
    "var LEGENDS_METADATA = {\n  bubble: {\n    legendType: 'size'\n  },\n  category: {\n    legendType: 'color'\n  },\n  choropleth: {\n    legendType: 'color'\n  },\n  custom: {\n    legendType: 'color'\n  },\n  custom_choropleth: {\n    legendType: 'color'\n  }\n};\n\nmodule.exports = LEGENDS_METADATA;\n",
    "var _ = require('underscore');\nvar legendsMetadata = require('./legends-metadata');\n\nvar CUSTOM_ATTRIBUTES = ['title'];\nvar instance;\nvar legends;\n\nvar State = (function () {\n  var getType = function (type) {\n    var legend = legendsMetadata[type];\n    return legend && legend.legendType;\n  };\n\n  var onLayerAdded = function (layer) {\n    instance[layer.id] = {};\n  };\n\n  var onLayerRemoved = function (layer) {\n    delete instance[layer.id];\n  };\n\n  return {\n    init: function (layersDefinitionCollection, legendsDefinitionCollection) {\n      if (!instance) {\n        instance = {};\n        layersDefinitionCollection.on('add', onLayerAdded);\n        layersDefinitionCollection.on('remove', onLayerRemoved);\n        legends = legendsDefinitionCollection;\n        this.reset();\n      }\n    },\n\n    reset: function () {\n      legends.each(function (legend) {\n        var layer = legend.layerDefinitionModel;\n        if (!instance[layer.id]) {\n          instance[layer.id] = {};\n        }\n\n        var legendType = getType(legend.get('type'));\n        if (!instance[layer.id][legendType]) {\n          instance[layer.id][legendType] = {};\n        }\n\n        var state = _.pick(legend.attributes, legend.attributes.conf.columns);\n        instance[layer.id][legendType] = state;\n      });\n    },\n\n    set: function (layer, type, attrs) {\n      var attributes = _.pick(attrs, CUSTOM_ATTRIBUTES);\n      var legendType = getType(type);\n      if (instance && legendType) {\n        if (!instance[layer.id]) {\n          instance[layer.id] = {};\n        }\n        instance[layer.id][legendType] = attributes;\n      }\n    },\n\n    get: function (layer, type) {\n      var legendType = getType(type);\n      return instance && legendType && instance[layer.id] && instance[layer.id][legendType];\n    },\n\n    getInstance: function () {\n      return instance;\n    }\n  };\n})();\n\nmodule.exports = State;\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar OWN_ATTRS = ['drag', 'id', 'keyboard'];\nvar EMBED_ATTRS = ['legends', 'scrollwheel', 'layer_selector', 'dashboard_menu'];\nvar basemapProvidersAndCategories = require('./basemap-providers-and-categories');\n/**\n * Model that represents a visualization's Map\n */\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    drag: true,\n    keyboard: true,\n    cartodb_logo: false,\n    legends: true,\n    layer_selector: false,\n    dashboard_menu: true,\n    scrollwheel: true\n  },\n\n  parse: function (r) {\n    return _.extend({\n      provider: r['map_provider']\n    },\n      _.pick(r, OWN_ATTRS),\n      _.pick(r.options, EMBED_ATTRS)\n    );\n  },\n\n  urlRoot: function () {\n    var baseUrl = this._configModel.get('base_url');\n    return baseUrl + '/api/v2/maps/';\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.layerDefinitionsCollection) throw new Error('layerDefinitionsCollection is required');\n    if (!opts.userModel) throw new Error('userModel is required');\n\n    this._configModel = opts.configModel;\n    this._userModel = opts.userModel;\n    this._layerDefinitionsCollection = opts.layerDefinitionsCollection;\n\n    this._layerDefinitionsCollection.bind('baseLayerChanged', this._onBaseLayerChanged, this);\n  },\n\n  _onBaseLayerChanged: function () {\n    var baseLayer = this._layerDefinitionsCollection.getBaseLayer();\n    var newProvider = basemapProvidersAndCategories.getProvider(baseLayer.get('type'));\n\n    this.save({\n      provider: newProvider,\n      minZoom: baseLayer.get('minZoom'),\n      maxZoom: baseLayer.get('maxZoom')\n    });\n  },\n\n  toJSON: function () {\n    return _.extend(\n      {},\n      _.omit(this.attributes, EMBED_ATTRS),\n      {\n        attribution: _.unique(this._layerDefinitionsCollection.pluck('attribution')),\n        user_id: this._userModel.get('id')\n      },\n      {\n        options: _.pick(this.attributes, EMBED_ATTRS)\n      }\n    );\n  },\n\n  setMapViewSize: function (size) {\n    this._mapViewSize = size;\n  },\n\n  getMapViewSize: function () {\n    return this._mapViewSize;\n  },\n\n  setStaticImageURLTemplate: function (staticImageURLTemplate) {\n    this._staticImageURLTemplate = staticImageURLTemplate;\n  },\n\n  getStaticImageURLTemplate: function () {\n    return this._staticImageURLTemplate;\n  },\n\n  setImageExportMetadata: function (metadata) {\n    this._imageExportMetadata = metadata;\n  },\n\n  getImageExportMetadata: function () {\n    return this._imageExportMetadata;\n  },\n\n  setConverters: function (converters) {\n    _.each(converters, function (converter, key) {\n      this[key] = converter;\n    }, this);\n  }\n});\n",
    "module.exports = function (overlaysCollection, mapDefModel, userModel) {\n  var overlays = overlaysCollection.pluck('type');\n  var canRemoveLogo = userModel.get('actions').remove_logo;\n\n  return [{\n    setting: 'search',\n    label: _t('editor.settings.preview.options.elements.search'),\n    related: 'overlays',\n    disabled: false,\n    active: overlays.indexOf('search') > 0\n  },\n  {\n    setting: 'zoom',\n    label: _t('editor.settings.preview.options.elements.zoom'),\n    related: 'overlays',\n    disabled: false,\n    active: overlays.indexOf('zoom') > 0\n  },\n  {\n    setting: 'logo',\n    label: _t('editor.settings.preview.options.elements.logo'),\n    related: 'overlays',\n    disabled: !canRemoveLogo,\n    active: overlays.indexOf('logo') > 0\n  },\n  {\n    setting: 'legends',\n    label: _t('editor.settings.preview.options.elements.legends'),\n    related: 'map',\n    disabled: false,\n    active: mapDefModel.get('legends') === true\n  },\n  {\n    setting: 'layer_selector',\n    label: _t('editor.settings.preview.options.elements.layer_selector'),\n    related: 'map',\n    disabled: false,\n    active: mapDefModel.get('layer_selector') === true\n  },\n  {\n    setting: 'dashboard_menu',\n    label: _t('editor.settings.preview.options.elements.dashboard_menu'),\n    related: 'map',\n    disabled: false,\n    active: mapDefModel.get('dashboard_menu') === true\n  },\n  {\n    setting: 'scrollwheel',\n    label: _t('editor.settings.preview.options.elements.scrollwheel'),\n    related: 'map',\n    disabled: false,\n    active: mapDefModel.get('scrollwheel') === true\n  }];\n};\n",
    "var Backbone = require('backbone');\n\nmodule.exports = Backbone.Collection.extend({\n\n  initialize: function (models, opts) {\n    if (!opts.visDefinitionModel) throw new Error('visDefinitionModel is required');\n    this.url = opts.visDefinitionModel.mapcapsURL();\n  }\n});\n",
    "var Backbone = require('backbone');\nvar AssetModel = require('./asset-model');\nvar checkAndBuildOpts = require('../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'configModel',\n  'orgId'\n];\n\nmodule.exports = Backbone.Collection.extend({\n  model: AssetModel,\n\n  url: function (method) {\n    var baseUrl = this._configModel.get('base_url');\n    var version = this._configModel.urlVersion('organization-assets', method);\n    return baseUrl + '/api/' + version + '/organization/' + this._orgId + '/assets';\n  },\n\n  initialize: function (models, opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n  },\n\n  deselectAll: function (m) {\n    this.each(function (mdl) {\n      if (mdl !== m && mdl.get('state') === 'selected') {\n        mdl.set('state', '');\n      }\n    });\n  }\n\n});\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\n\n/**\n *  Organization info model\n *\n */\nmodule.exports = Backbone.Model.extend({\n\n  url: function () {\n    var baseUrl = this._configModel.get('base_url');\n    return baseUrl + '/api/v1/org';\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._configModel = opts.configModel;\n\n    if (!_.isEmpty(this.get('owner'))) {\n      this._ownerModel = new Backbone.Model(\n        _.omit(this.get('owner'), 'organization')\n      );\n    }\n  },\n\n  getOwnerId: function () {\n    return this._ownerModel && this._ownerModel.get('id');\n  },\n\n  getOwnerEmail: function () {\n    return this._ownerModel && this._ownerModel.get('email');\n  },\n\n  isOrgAdmin: function (user) {\n    return this.getOwnerId() === user.get('id') || !!_.find(this.get('admins'), function (u) {\n      return u.id === user.get('id');\n    });\n  }\n});\n",
    "var Backbone = require('backbone');\n\nmodule.exports = Backbone.Collection.extend({\n  initialize: function (models, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.visId) throw new Error('visId is required');\n\n    this._configModel = opts.configModel;\n    this._visId = opts.visId;\n  },\n\n  url: function () {\n    var baseUrl = this._configModel.get('base_url');\n    var version = this._configModel.urlVersion('overlays');\n    return baseUrl + '/api/' + version + '/viz/' + this._visId + '/overlays';\n  },\n\n  hasFetched: function () {\n    return this.length > 0;\n  },\n\n  removeOverlay: function (type) {\n    var overlay = this.findWhere({type: type});\n    overlay && overlay.destroy();\n  },\n\n  createOverlay: function (type) {\n    var types = {\n      'fullscreen': this._createFullScreenOverlay,\n      'layer_selector': this._createLayerSelectorOverlay,\n      'search': this._createSearchOverlay,\n      'zoom': this._createZoomOverlay,\n      'logo': this._createLogoOverlay\n    };\n    var fn = types[type];\n    fn && fn.call(this);\n  },\n\n  _createZoomOverlay: function () {\n    var options = {\n      type: 'zoom',\n      order: 6,\n      display: true,\n      x: 20,\n      y: 20\n    };\n    this.create(options);\n  },\n\n  _createLogoOverlay: function () {\n    var options = {\n      type: 'logo',\n      order: 10,\n      display: true,\n      x: 10,\n      y: 40\n    };\n    this.create(options);\n  },\n\n  _createSearchOverlay: function () {\n    var options = {\n      type: 'search',\n      order: 3,\n      display: true,\n      x: 60,\n      y: 20\n    };\n    this.create(options);\n  },\n\n  _createFullScreenOverlay: function () {\n    var options = {\n      type: 'fullscreen',\n      order: 7,\n      display: true,\n      x: 20,\n      y: 172\n    };\n\n    this.create(options);\n  }\n});\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar Utils = require('../helpers/utils');\nvar UserModel = require('./user-model');\nvar OrganizationModel = require('./organization-model');\nvar GroupModel = require('./group-model');\nvar ACLItemModel = require('./acl-item-model');\nvar READ_ONLY = 'r';\nvar READ_WRITE = 'rw';\n\n/**\n * manages a cartodb permission object, it contains:\n * - owner: an UserModel instance\n * - acl: a collection which includes the user and their permission.\n *\n *   see https://github.com/Vizzuality/cartodb-management/wiki/multiuser-REST-API#permissions-object\n *\n *   this object is not created to work alone, it should be a member of\n *   an object like visualization table\n *\n */\nvar PermissionModel = module.exports = Backbone.Model.extend({\n  urlRoot: function () {\n    var baseUrl = this._configModel.get('base_url');\n    var version = this._configModel.urlVersion('perm');\n    return baseUrl + '/api/' + version + '/perm';\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._configModel = opts.configModel;\n    this.acl = new Backbone.Collection();\n    this.owner = opts._userModel;\n    this._generateOwner();\n    this._generateAcl();\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this.bind('change:owner', this._generateOwner, this);\n    this.bind('change:acl', this._generateAcl, this);\n  },\n\n  _generateOwner: function () {\n    if (!this.owner) {\n      this.owner = new UserModel(null, {\n        configModel: this._configModel\n      });\n    }\n    this.owner.set(this.get('owner'));\n  },\n\n  getOwner: function () {\n    return this.owner;\n  },\n\n  _generateAcl: function () {\n    var self = this;\n    this.acl.reset([], { silent: true });\n    _.each(this.get('acl'), function (aclItem) {\n      var model;\n      switch (aclItem.type) {\n        case 'user':\n          model = new UserModel(aclItem.entity, {\n            configModel: self._configModel\n          });\n          break;\n        case 'org':\n          model = new OrganizationModel(aclItem.entity, {\n            configModel: self._configModel\n          });\n          break;\n        case 'group':\n          model = new GroupModel(aclItem.entity, {\n            configModel: self._configModel\n          });\n          break;\n        default:\n          throw new Error('Unknown ACL item type: ' + aclItem.type);\n      }\n      this._grantAccess(model, aclItem.access);\n    }, this);\n  },\n\n  cleanPermissions: function () {\n    this.acl.reset();\n  },\n\n  hasAccess: function (model) {\n    // Having at least read access is the same as having any access\n    return this.hasReadAccess(model);\n  },\n\n  hasReadAccess: function (model) {\n    // If there is a representable ACL item it must be one of at least READ_ONLY access\n    return !!this.findRepresentableAclItem(model);\n  },\n\n  hasWriteAccess: function (model) {\n    var access = Utils.result(this.findRepresentableAclItem(model), 'get', 'access');\n    return access === READ_WRITE;\n  },\n\n  canChangeReadAccess: function (model) {\n    return this._canChangeAccess(model);\n  },\n\n  canChangeWriteAccess: function (model) {\n    return (!model.isBuilder || model.isBuilder()) && this._canChangeAccess(model, function (representableAclItem) {\n      return Utils.result(representableAclItem, 'get', 'access') !== READ_WRITE;\n    });\n  },\n\n  _canChangeAccess: function (model) {\n    var representableAclItem = this.findRepresentableAclItem(model);\n    return this.isOwner(model) || !representableAclItem ||\n    representableAclItem === this._ownAclItem(model) || Utils.result(arguments, 1, representableAclItem) || false;\n  },\n\n  grantWriteAccess: function (model) {\n    this._grantAccess(model, READ_WRITE);\n  },\n\n  grantReadAccess: function (model) {\n    this._grantAccess(model, READ_ONLY);\n  },\n\n  revokeWriteAccess: function (model) {\n    // Effectively \"downgrades\" to READ_ONLY\n    this.grantReadAccess(model);\n  },\n\n  /**\n   * Revokes access to a set of items\n   * @param {Object} model A single model or an array of models\n   */\n  revokeAccess: function (model) {\n    var aclItem = this._ownAclItem(model);\n    if (aclItem) {\n      this.acl.remove(aclItem);\n    }\n  },\n\n  isOwner: function (model) {\n    return _.result(this.owner, 'id') === _.result(model, 'id');\n  },\n\n  toJSON: function () {\n    return {\n      entity: this.get('entity'),\n      acl: this.acl.toJSON()\n    };\n  },\n\n  getUsersWithAnyPermission: function () {\n    return this.acl.chain()\n      .filter(this._hasTypeUser)\n      .map(this._getEntity)\n      .value();\n  },\n\n  isSharedWithOrganization: function () {\n    return this.acl.any(this._hasTypeOrg);\n  },\n\n  clone: function () {\n    var attrs = _.clone(this.attributes);\n    delete attrs.id;\n    return new PermissionModel(attrs, {\n      configModel: this._configModel\n    });\n  },\n\n  /**\n   * Overwrite this ACL list from other permission object\n   * @param otherPermission {Object} instance of PermissionModel\n   */\n  overwriteAcl: function (otherPermission) {\n    this.acl.reset(otherPermission.acl.models);\n  },\n\n  // Note that this may return an inherited ACL item\n  // use ._ownAclItem instead if only model's own is wanted (if there is any)\n  findRepresentableAclItem: function (model) {\n    if (this.isOwner(model)) {\n      return this._newAclItem(model, READ_WRITE);\n    } else {\n      var checkList = ['_ownAclItem', '_organizationAclItem', '_mostPrivilegedGroupAclItem'];\n      return this._findMostPrivilegedAclItem(checkList, function (fnName) {\n        return this[fnName](model);\n      });\n    }\n  },\n\n  _hasTypeUser: function (m) {\n    return m.get('type') === 'user';\n  },\n\n  _getEntity: function (m) {\n    return m.get('entity');\n  },\n\n  _hasTypeOrg: function (m) {\n    return m.get('type') === 'org';\n  },\n\n  _isOrganization: function (object) {\n    return object instanceof OrganizationModel;\n  },\n\n  _ownAclItem: function (model) {\n    if (!model || !_.isFunction(model.isNew)) {\n      console.log('model is required to find an ACL item');\n    }\n    if (!model.isNew()) {\n      return this.acl.find(function (aclItem) {\n        return aclItem.get('entity').id === model.id;\n      });\n    }\n  },\n\n  _organizationAclItem: function (m) {\n    var org = _.result(m.collection, 'organization') || m.organization;\n    if (org) {\n      return this._ownAclItem(org);\n    }\n  },\n\n  _mostPrivilegedGroupAclItem: function (m) {\n    var groups = _.result(m.groups, 'models');\n    if (groups) {\n      return this._findMostPrivilegedAclItem(groups, this._ownAclItem);\n    }\n  },\n\n  /**\n   * Iterates over a items in given list using the iteratee, stops and returns when found the ACL item with best access (i.e. READ_WRITE), or the\n   * list is completed.\n   * @param {Array} list\n   * @param {Function} iteratee that takes an item from list and returns an access\n   *   iteratee is called in context of this model.\n   * @Return {String} 'r', 'rw', or undefined if there were no access for given item\n   */\n  _findMostPrivilegedAclItem: function (list, iteratee) {\n    var aclItem;\n    for (var i = 0, x = list[i]; x && Utils.result(aclItem, 'get', 'access') !== READ_WRITE; x = list[++i]) {\n      // Keep last ACL item if iteratee returns nothing\n      aclItem = iteratee.call(this, x) || aclItem;\n    }\n    return aclItem;\n  },\n\n  /**\n   * Grants access to a set of items\n   * @param {Object} model\n   * @param {String} access can take the following values:\n   * - 'r': read only\n   * - 'rw': read and write permission\n   */\n  _grantAccess: function (model, access) {\n    var aclItem = this._ownAclItem(model);\n    if (aclItem) {\n      aclItem.set('access', access);\n    } else {\n      aclItem = this._newAclItem(model, access);\n      if (aclItem.isValid()) {\n        this.acl.add(aclItem);\n      } else {\n        throw new Error(access + ' is not a valid ACL access');\n      }\n    }\n  },\n\n  _newAclItem: function (model, access) {\n    var type;\n    if (model instanceof UserModel) {\n      type = 'user';\n    } else if (model instanceof GroupModel) {\n      type = 'group';\n    } else if (this._isOrganization(model)) {\n      type = 'org';\n    } else {\n      throw new Error('model not recognized as a valid ACL entity ' + model);\n    }\n\n    return new ACLItemModel({\n      type: type,\n      entity: model,\n      access: access\n    });\n  }\n});\n\nexports.READ_ONLY = READ_ONLY;\nexports.READ_WRITE = READ_WRITE;\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar DEACTIVATE_MATRIX = {\n  'number': ['date'],\n  'boolean': ['date'],\n  'date': ['boolean']\n};\nvar DESTRUCTIVE_MATRIX = {\n  'string': {\n    'string': false,\n    'number': true,\n    'date': true,\n    'boolean': true\n  },\n  'number': {\n    'string': false,\n    'number': false,\n    'date': true,\n    'boolean': true\n  },\n  'date': {\n    'string': false,\n    'number': true,\n    'date': false,\n    'boolean': true\n  },\n  'boolean': {\n    'string': false,\n    'number': false,\n    'date': true,\n    'boolean': false\n  }\n};\nvar NON_EDITABLE_ATTRIBUTES = [\n  'the_geom_webmercator',\n  'cartodb_id',\n  'the_geom'\n];\n\nmodule.exports = Backbone.Model.extend({\n\n  url: function () {\n    if (this._tableName) {\n      var baseUrl = this._configModel.get('base_url');\n      var version = this._configModel.urlVersion('column');\n      var url = baseUrl + '/api/' + version + '/tables/' + this._tableName + '/columns/';\n\n      if (!this.isNew()) {\n        // If name changes, we should point to the \"old\" name\n        // in order to make the correct call\n        url += this.previous('name') || this.get('name');\n      }\n\n      return url;\n    }\n\n    return false;\n  },\n\n  parse: function (attrs) {\n    return {\n      name: attrs.name,\n      type: attrs.cartodb_type || attrs.type,\n      isNew: false\n    };\n  },\n\n  initialize: function (models, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._tableName = opts.tableName;\n    this._configModel = opts.configModel;\n  },\n\n  isNew: function () {\n    return this.get('isNew');\n  },\n\n  isEditable: function () {\n    return !_.contains(NON_EDITABLE_ATTRIBUTES, this.get('name'));\n  },\n\n  // This is relative becuase we could set any value to cartodb_id\n  isCartoDBIDColumn: function () {\n    return this.get('name') === 'cartodb_id' && this.get('type') === 'number';\n  },\n\n  isGeometryColumn: function () {\n    return this.get('type') === 'geometry';\n  }\n}, {\n  isTypeChangeDestructive: function (type, newType) {\n    return DESTRUCTIVE_MATRIX[type][newType];\n  },\n\n  isTypeChangeAllowed: function (type, newType) {\n    var deactivated = DEACTIVATE_MATRIX[type] || [];\n    deactivated = deactivated.concat([type]);\n    return !_.contains(deactivated, newType);\n  }\n});\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar QueryColumnModel = require('./query-column-model');\n\nmodule.exports = Backbone.Collection.extend({\n\n  model: function (attrs, opts) {\n    var self = opts.collection;\n    return new QueryColumnModel(attrs, {\n      configModel: self._configModel,\n      tableName: self._tableName\n    });\n  },\n\n  url: function () {\n    if (this._tableName) {\n      var baseUrl = this._configModel.get('base_url');\n      var version = this._configModel.urlVersion('column');\n      return baseUrl + '/api/' + version + '/tables/' + this._tableName + '/columns';\n    }\n\n    return false;\n  },\n\n  initialize: function (models, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.querySchemaModel) throw new Error('querySchemaModel is required');\n\n    this._tableName = opts.tableName;\n    this._querySchemaModel = opts.querySchemaModel;\n    this._configModel = opts.configModel;\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this.bind('add remove change:type change:name', function () {\n      this.reset();\n      this._querySchemaModel.set('status', 'unfetched');\n      this._querySchemaModel.fetch();\n    }, this);\n    this._querySchemaModel.bind('change:status', function (mdl, status) {\n      if (status === 'fetched') {\n        this.reset(this._querySchemaModel.columnsCollection.toJSON());\n      }\n    }, this);\n  },\n\n  setTableName: function (name) {\n    if (!name) return;\n\n    if (this._tableName) {\n      this._tableName = name;\n\n      this.each(function (columnModel) {\n        columnModel._tableName = name;\n      });\n    }\n  },\n\n  addColumn: function (opts) {\n    opts = opts || {};\n    this.create(\n      {\n        name: 'column_' + new Date().getTime(),\n        type: 'string',\n        isNew: true\n      },\n      _.extend(\n        opts,\n        {\n          wait: true,\n          parse: false\n        }\n      )\n    );\n  }\n\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar syncAbort = require('./backbone/sync-abort');\n/* eslint-disable */\nvar template = _.template(\"\" +\n\"SELECT CASE LOWER(ST_GeometryType(<%= geom_column %>)) \" +\n\"     WHEN 'st_polygon' THEN 'polygon' \" +\n\"     WHEN 'st_multipolygon' THEN 'polygon' \" +\n\"     WHEN 'st_multilinestring' THEN 'line' \" +\n\"     WHEN 'st_linestring' THEN 'line' \" +\n\"     WHEN 'st_multipoint' THEN 'point' \" +\n\"     WHEN 'st_point' THEN 'point' \" +\n\"     ELSE '' \" +\n\"  END AS the_geom FROM (<%= sql %>) __wrapped WHERE <%= geom_column %> IS NOT NULL\"\n/* eslint-enable */\n);\n\nvar THE_GEOM_NOT_FOUND_ERROR = 'column \\\"the_geom\\\" does not exist';\nvar MAX_GET_LENGTH = 1024;\nvar PARAMS = {\n  sort_order: 'asc',\n  rows_per_page: 40,\n  page: 0\n};\nvar STATUS = {\n  unavailable: 'unavailable',\n  unfetched: 'unfetched',\n  fetching: 'fetching',\n  fetched: 'fetched'\n};\n\n/**\n * Model to represent a schema of a SQL query.\n */\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    query: '',\n    status: STATUS.unavailable, // , unfetched, fetching, fetched\n    simple_geom: '', // , 'point', 'polygon', 'line'\n    ready: false // until true there's no data available on the table(s) used in the query\n  },\n\n  /**\n   * @override {Backbone.prototype.sync} abort ongoing request if there is any\n   */\n  sync: syncAbort,\n\n  initialize: function (attrs, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._configModel = opts.configModel;\n\n    this._addChangeListener();\n  },\n\n  url: function () {\n    return this._configModel.getSqlApiUrl();\n  },\n\n  _addChangeListener: function () {\n    this.bind('change', this._onChange, this);\n  },\n\n  _removeChangeListener: function () {\n    this.unbind('change', this._onChange, this);\n  },\n\n  isFetched: function () {\n    return this.get('status') === STATUS.fetched;\n  },\n\n  isFetching: function () {\n    return this.get('status') === STATUS.fetching;\n  },\n\n  canFetch: function () {\n    return this.hasQuery() && this.get('ready');\n  },\n\n  hasQuery: function () {\n    return !!this.get('query');\n  },\n\n  shouldFetch: function () {\n    return this.canFetch() && !this.isFetched() && !this.isFetching();\n  },\n\n  resetFetch: function () {\n    this.set('status', STATUS.unfetched);\n  },\n\n  fetch: function (opts) {\n    if (!this.canFetch()) return;\n\n    this.set('status', STATUS.fetching);\n\n    opts = opts || {};\n    var errorCallback = opts && opts.error;\n\n    opts.data = _.extend(\n      opts.data || {},\n      {\n        api_key: this._configModel.get('api_key'),\n        q: this._getSqlApiQueryParam(opts.geomColumnName)\n      },\n      PARAMS\n    );\n\n    opts.method = this._httpMethod();\n\n    opts.error = function (model, response) {\n      if (response && response.statusText !== 'abort') {\n        var error = response.responseText ? JSON.parse(response.responseText).error : [];\n        // in case we get an error of the_geom does not exists try with the_geom_webmercator to get the geometry type\n        if (error.length === 1 && error[0] === THE_GEOM_NOT_FOUND_ERROR) {\n          this.fetch(_.extend({}, opts, { geomColumnName: 'the_geom_webmercator' }));\n        } else {\n          errorCallback && errorCallback(error);\n          this.set({\n            simple_geom: '',\n            query_errors: error,\n            status: STATUS.unavailable\n          });\n        }\n      }\n    }.bind(this);\n\n    return Backbone.Model.prototype.fetch.call(this, opts);\n  },\n\n  parse: function (r) {\n    var simpleGeom;\n\n    _.some(r.rows, function (row) {\n      return !!(simpleGeom = row.the_geom); // to stop when found a valid simple geom\n    });\n\n    return {\n      status: STATUS.fetched,\n      simple_geom: simpleGeom || ''\n    };\n  },\n\n  isNew: function () {\n    return true; // override Backbone.Model.prototype.isNew for this.destroy() to do its w/o sending a DELETE request\n  },\n\n  hasValue: function () {\n    return !!this.get('simple_geom');\n  },\n\n  _onChange: function () {\n    this._removeChangeListener();\n\n    if (!this.hasChanged('status') && this.get('status') === STATUS.fetching) {\n      // If it is already fetching just redo the fetch with latest attrs\n      // in case the query has changed\n      if (this.hasChanged('query')) {\n        this.fetch();\n      }\n    } else if (this.hasChanged('query') || this.hasChanged('ready')) {\n      this.set('status', this.get('query') ? STATUS.unfetched : STATUS.unavailable);\n    }\n\n    this._addChangeListener();\n  },\n\n  _getSqlApiQueryParam: function (geomColumnName) {\n    return template({\n      geom_column: geomColumnName || 'the_geom',\n      sql: this.get('query')\n    });\n  },\n\n  _httpMethod: function () {\n    return this._getSqlApiQueryParam().length > MAX_GET_LENGTH\n      ? 'POST'\n      : 'GET';\n  }\n\n});\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\n\nmodule.exports = Backbone.Model.extend({\n\n  // In case that there is already an id attribute\n  idAttribute: '__id',\n\n  url: function () {\n    if (this._tableName && this._configModel) {\n      var baseUrl = this._configModel.get('base_url');\n      var version = this._configModel.urlVersion('record');\n      var url = baseUrl + '/api/' + version + '/tables/';\n\n      if (this.hasWriteAccess(this._userModel) && !this.isOwner(this._userModel)) {\n        var owner = this._permissionModel.getOwner();\n        var ownerUsername = owner.get('username');\n\n        url += ownerUsername + '.' + this._tableName + '/records';\n      } else {\n        url += this._tableName + '/records';\n      }\n\n      if (!this.isNew()) {\n        url += '/' + this.get('cartodb_id');\n      }\n\n      return url;\n    }\n\n    return false;\n  },\n\n  initialize: function (attrs, opts) {\n    this.collection = this.collection || {};\n\n    this._tableName = opts.tableName || this.collection._tableName;\n    this._configModel = opts.configModel || this.collection._configModel;\n    this._permissionModel = opts.permissionModel || this.collection._permissionModel;\n    this._userModel = opts.userModel || this.collection._userModel;\n\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this.bind('error', this._onError, this);\n  },\n\n  hasWriteAccess: function (userModel) {\n    if (!userModel || !this._permissionModel) {\n      return false;\n    }\n    return this._permissionModel.hasWriteAccess(userModel);\n  },\n\n  isOwner: function (userModel) {\n    if (!userModel || !this._permissionModel) {\n      return false;\n    }\n    return this._permissionModel.isOwner(userModel);\n  },\n\n  isNew: function () {\n    return !this.has('cartodb_id');\n  },\n\n  isGeomLoaded: function () {\n    try {\n      JSON.parse(this.get('the_geom'));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  },\n\n  fetchRowIfGeomIsNotLoaded: function (callback) {\n    if (this.isGeomLoaded()) {\n      callback();\n      return;\n    }\n\n    this.fetch({\n      success: callback\n    });\n  },\n\n  _onError: function () {\n    this.set(this.previousAttributes());\n  },\n\n  sync: function () {\n    this.trigger('loading', this);\n    Backbone.Model.prototype.sync.apply(this, arguments);\n  },\n\n  parse: function (attrs) {\n    if (!attrs.__id) {\n      attrs.__id = _.uniqueId();\n    }\n    return attrs;\n  },\n\n  toJSON: function () {\n    return _.omit(\n      this.attributes,\n      '__id',\n      'the_geom_webmercator'\n    );\n  }\n\n});\n",
    "var Backbone = require('backbone');\nvar QueryRowModel = require('./query-row-model');\nvar syncAbort = require('./backbone/sync-abort');\nvar _ = require('underscore');\n\nvar MAX_GET_LENGTH = 1024;\nvar WRAP_SQL_TEMPLATE = 'select <%= selectedColumns %> from (<%= sql %>) __wrapped';\n\nvar STATUS = {\n  unavailable: 'unavailable',\n  unfetched: 'unfetched',\n  fetching: 'fetching',\n  fetched: 'fetched'\n};\n\nmodule.exports = Backbone.Collection.extend({\n\n  DEFAULT_FETCH_OPTIONS: {\n    rows_per_page: 40,\n    sort_order: 'asc',\n    page: 0\n  },\n\n  // Due to a problem how Backbone checks if there is a duplicated model\n  // or not, we can't create the model with a function + its necessary options\n  model: QueryRowModel,\n\n  sync: syncAbort,\n\n  url: function () {\n    return this._configModel.getSqlApiUrl();\n  },\n\n  initialize: function (models, opts) {\n    opts = opts || {};\n\n    this._tableName = opts.tableName;\n    this._querySchemaModel = opts.querySchemaModel;\n    this._configModel = opts.configModel;\n\n    this.statusModel = new Backbone.Model({\n      status: STATUS.unavailable\n    });\n\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this.listenTo(this._querySchemaModel, 'change:query', this._onQuerySchemaQueryChange);\n  },\n\n  isFetched: function () {\n    return this.statusModel.get('status') === STATUS.fetched;\n  },\n\n  isFetching: function () {\n    return this.statusModel.get('status') === STATUS.fetching;\n  },\n\n  shouldFetch: function () {\n    return !this.isFetched() && !this.isFetching() && this.canFetch();\n  },\n\n  resetFetch: function () {\n    this.statusModel.set('status', STATUS.unfetched);\n  },\n\n  isEmpty: function () {\n    return this.size() === 0;\n  },\n\n  canFetch: function () {\n    return !!this._querySchemaModel.get('query') && this._querySchemaModel.get('ready') && this._querySchemaModel.isFetched();\n  },\n\n  _onQuerySchemaQueryChange: function () {\n    this.statusModel.set('status', 'unfetched');\n    this.reset([], { silent: true });\n  },\n\n  _geometryColumnSQL: function (column) {\n    /* eslint-disable */\n    return [\n      \"CASE\",\n      \"WHEN GeometryType(\" + column + \") = 'POINT' THEN\",\n        \"ST_AsGeoJSON(\" + column + \",8)\",\n      \"WHEN (\" + column + \" IS NULL) THEN\",\n        \"NULL\",\n      \"ELSE\",\n        \"GeometryType(\" + column + \")\",\n      \"END \" + column\n    ].join(' ');\n    /* eslint-enable */\n  },\n\n  // return wrapped SQL removing the_geom and the_geom_webmercator\n  // to avoid fetching those columns.\n  // So for a sql like\n  // select * from table the returned value is\n  // select column1, column2, column3... from table\n  _getWrappedSQL: function (excludeColumns) {\n    var self = this;\n    var schema = this._querySchemaModel.columnsCollection.toJSON();\n\n    var selectedColumns = _\n      .chain(schema)\n      .omit(function (item) {\n        return _.contains(excludeColumns, item.name);\n      })\n      .map(function (item, index) {\n        if (item.type === 'geometry') {\n          return self._geometryColumnSQL(item.name);\n        }\n        return '\"' + item.name + '\"';\n      })\n      .value();\n\n    return _.template(WRAP_SQL_TEMPLATE)({\n      selectedColumns: selectedColumns.join(','),\n      sql: this._querySchemaModel.get('query')\n    });\n  },\n\n  _httpMethod: function () {\n    return this._querySchemaModel.get('query').length > MAX_GET_LENGTH\n      ? 'POST'\n      : 'GET';\n  },\n\n  fetch: function (opts) {\n    opts = opts || {};\n\n    this.statusModel.set('status', STATUS.fetching);\n\n    var excludeColumns = (opts.data && opts.data.exclude) || [];\n\n    opts = opts || {};\n    opts.data = _.extend(\n      {},\n      this.DEFAULT_FETCH_OPTIONS,\n      opts.data && _.omit(opts.data, 'exclude') || {},\n      {\n        api_key: this._configModel.get('api_key'),\n        q: this._getWrappedSQL(excludeColumns)\n      }\n    );\n\n    opts.method = this._httpMethod();\n    var errorCallback = opts.error;\n    opts.error = function (coll, resp) {\n      this.trigger('fail', coll, resp);\n      this.statusModel.set('status', STATUS.unavailable);\n      errorCallback && errorCallback(coll, resp);\n    }.bind(this);\n\n    var successCallback = opts.success;\n    opts.success = function (coll, resp) {\n      this.statusModel.set('status', STATUS.fetched);\n      successCallback && successCallback(coll, resp);\n    }.bind(this);\n\n    // Needed to reset the whole collection when a fetch is done\n    opts.reset = true;\n\n    return Backbone.Collection.prototype.fetch.call(this, opts);\n  },\n\n  parse: function (r) {\n    return this._parseWithID(r.rows);\n  },\n\n  reset: function (result, opts) {\n    var items = [];\n\n    if (result && result.rows) {\n      // If reset comes from a fetch, we need to parse the rows\n      items = result.rows;\n    } else {\n      // If it comes directly from a simple reset function\n      items = result;\n    }\n\n    Backbone.Collection.prototype.reset.apply(this, [this._parseWithID(items)]);\n  },\n\n  _parseWithID: function (array) {\n    return _.map(array, function (attrs) {\n      attrs.__id = _.uniqueId();\n      return attrs;\n    });\n  },\n\n  addRow: function (opts) {\n    opts = opts || {};\n    this.create(\n      {\n        __id: _.uniqueId()\n      },\n      _.extend(\n        opts,\n        {\n          wait: true,\n          parse: true\n        }\n      )\n    );\n  },\n\n  setTableName: function (name) {\n    if (!name) return;\n\n    if (this._tableName) {\n      this._tableName = name;\n\n      this.each(function (rowModel) {\n        rowModel._tableName = name;\n      });\n    }\n  }\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar syncAbort = require('./backbone/sync-abort');\nvar QueryRowsCollection = require('./query-rows-collection');\nvar SQLUtils = require('../helpers/sql-utils');\n\nvar DEFAULT_TABLE_QUERY_TEMPLATE = _.template('SELECT * FROM <%= tableName %>');\nvar WRAPPED_SQL_QUERY_TEMPLATE = _.template('SELECT * FROM (<%= sql %>) __wrapped');\n\nvar MAX_GET_LENGTH = 1024;\nvar STATUS = {\n  unavailable: 'unavailable',\n  unfetched: 'unfetched',\n  fetching: 'fetching',\n  fetched: 'fetched'\n};\n\n/**\n * Model to represent a schema of a SQL query.\n */\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    query: '',\n    sort_order: 'asc',\n    rows_per_page: 0,\n    page: 0,\n    status: STATUS.unavailable, // unfetched, fetching, fetched\n    ready: false // until true there's no data available on the table(s) used in the query\n  },\n\n  sync: syncAbort, // override {Backbone.prototype.sync} abort ongoing request if there is any\n\n  initialize: function (attrs, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._configModel = opts.configModel;\n    this.columnsCollection = new Backbone.Collection([]);\n    this.rowsCollection = new QueryRowsCollection([]);\n\n    if (this.get('status') === STATUS.unavailable) {\n      this._setStatusPerQueryValue();\n    }\n\n    this._addChangeListener();\n  },\n\n  url: function () {\n    return this._configModel.getSqlApiUrl();\n  },\n\n  _addChangeListener: function () {\n    this.bind('change', this._onChange, this);\n  },\n\n  _removeChangeListener: function () {\n    this.unbind('change', this._onChange, this);\n  },\n\n  isFetched: function () {\n    return this.get('status') === STATUS.fetched;\n  },\n\n  isFetching: function () {\n    return this.get('status') === STATUS.fetching;\n  },\n\n  canFetch: function () {\n    return this.hasQuery() && this.get('ready');\n  },\n\n  hasQuery: function () {\n    return !!this.get('query');\n  },\n\n  shouldFetch: function () {\n    return this.canFetch() && !this.isFetched() && !this.isFetching();\n  },\n\n  fetch: function (opts) {\n    if (!this.canFetch()) return;\n\n    this.set('status', STATUS.fetching);\n\n    opts = opts || {};\n    var errorCallback = opts && opts.error;\n\n    opts.data = _.extend(\n      opts.data || {},\n      {\n        sort_order: this.get('sort_order'),\n        rows_per_page: this.get('rows_per_page'),\n        page: this.get('page'),\n        api_key: this._configModel.get('api_key'),\n        q: this._getSqlApiQueryParam()\n      }\n    );\n\n    opts.method = this._httpMethod();\n\n    opts.error = function (model, response) {\n      if (response && response.statusText !== 'abort') {\n        var error = response.responseText ? JSON.parse(response.responseText).error : [];\n        errorCallback && errorCallback(error);\n        this.set({\n          query_errors: error,\n          status: STATUS.unavailable\n        });\n      }\n    }.bind(this);\n\n    return Backbone.Model.prototype.fetch.call(this, opts);\n  },\n\n  parse: function (r) {\n    this.rowsCollection.reset(r.rows);\n\n    this.columnsCollection.reset(\n      _.map(r.fields, function (d, name) {\n        return {\n          name: name,\n          type: d.type\n        };\n      })\n    );\n\n    return { status: STATUS.fetched };\n  },\n\n  /**\n   * @override {Backbone.prototype.isNew} for this.destroy() to work (not try to send DELETE request)\n   */\n  isNew: function () {\n    return true;\n  },\n\n  hasDefaultQueryFor: function (tableName) {\n    if (!this.hasQuery()) {\n      return false;\n    }\n    var defaultQueryForTableName = DEFAULT_TABLE_QUERY_TEMPLATE({ tableName: tableName });\n    return SQLUtils.isSameQuery(this.get('query'), defaultQueryForTableName);\n  },\n\n  getColumnNames: function () {\n    return this.columnsCollection.pluck('name');\n  },\n\n  _onChange: function () {\n    this._removeChangeListener();\n\n    if (!this.hasChanged('status') && this.get('status') === STATUS.fetching) {\n      this.fetch(); // If is already fetching just redo the fetch with latest attrs\n    } else {\n      if (this.hasChanged('query')) {\n        this.columnsCollection.reset();\n        this._setStatusPerQueryValue();\n      }\n    }\n\n    this._addChangeListener();\n  },\n\n  _setStatusPerQueryValue: function () {\n    this.set('status', this.get('query') ? STATUS.unfetched : STATUS.unavailable);\n  },\n\n  // Basically checks if an schema is different than the current one\n  hasDifferentSchemaThan: function (schemaArray) {\n    return !_.every(schemaArray, function (columnObj) {\n      var columnModel = this.columnsCollection.findWhere({ name: columnObj.name });\n      return columnModel && (columnModel.get('type') === columnObj.type || columnObj.type == null);\n    }, this);\n  },\n\n  resetDueToAlteredData: function () {\n    this.set('status', STATUS.unfetched);\n    this.trigger('resetDueToAlteredData');\n    this.fetch();\n  },\n\n  _getSqlApiQueryParam: function () {\n    return WRAPPED_SQL_QUERY_TEMPLATE({\n      sql: this.get('query')\n    });\n  },\n\n  _httpMethod: function () {\n    return this._getSqlApiQueryParam().length > MAX_GET_LENGTH\n      ? 'POST'\n      : 'GET';\n  },\n\n  resetFetch: function () {\n    this.set('status', STATUS.unfetched);\n  }\n\n});\n",
    "var Backbone = require('backbone');\nvar syncAbort = require('./backbone/sync-abort');\n\n/**\n * State definition model.\n * Used to persist the dashboard state at any time\n */\nmodule.exports = Backbone.Model.extend({\n\n  /**\n   * @override {Backbone.prototype.sync} abort ongoing request if there is any\n   */\n  sync: syncAbort,\n\n  url: function () {\n    return this._visDefinitionModel.stateURL();\n  },\n\n  isNew: function () {\n    return false;\n  },\n\n  initialize: function (attrs, opts) {\n    if (!attrs.json) throw new Error('state json is required');\n    if (!opts.visDefinitionModel) throw new Error('visDefinitionModel is required');\n\n    this._visDefinitionModel = opts.visDefinitionModel;\n  },\n\n  toJSON: function () {\n    return {\n      json: this.get('json')\n    };\n  },\n\n  updateState: function (state) {\n    this.save({\n      json: state\n    });\n  },\n\n  setBounds: function (bounds) {\n    this.trigger('boundsSet', bounds);\n  },\n\n  getZoom: function () {\n    return this.get('json').map.zoom;\n  },\n\n  getCenter: function () {\n    return this.get('json').map.center;\n  }\n});\n",
    "var _ = require('underscore');\nvar AssetModel = require('./asset-model');\n\nmodule.exports = AssetModel.extend({\n\n  defaults: {\n    ext: 'svg',\n    folder: 'maki-icons',\n    host: 'https://s3.amazonaws.com',\n    bucket: 'com.cartodb.users-assets.production',\n    kind: 'marker',\n    name: '',\n    public_url: '',\n    size: '18',\n    state: 'idle'\n  },\n\n  getURLFor: function (name) {\n    var url = this.get('host') + '/' + this.get('bucket') + '/' + this.get('folder') + '/' + name;\n    var size = this.get('size') ? '-' + this.get('size') : '';\n    return url + size + '.' + this.get('ext');\n  },\n\n  toJSON: function () {\n    var c = _.clone(this.attributes);\n\n    c['public_url'] = this.getURLFor(c['icon']);\n    return c;\n  },\n\n  get: function (attr) {\n    var r = this.attributes[attr];\n\n    if (attr === 'public_url') {\n      r = this.getURLFor(this.attributes['icon']);\n    }\n\n    return r;\n  }\n});\n",
    "var StaticAssetModel = require('./static-asset-model');\nvar AssetsCollection = require('./assets-collection');\n\nmodule.exports = AssetsCollection.extend({\n  model: StaticAssetModel,\n\n  url: function () {\n    return '';\n  },\n\n  initialize: function (models, opts) {\n\n  },\n\n  parse: function (resp, xhr) {\n    return [];\n  }\n});\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar $ = require('jquery');\nvar MULTIPLIER = 1.2; // Multiply current interval for this number\nvar INTERVAL = 1500; // Interval time between poll checkings\nvar SYNC_GAP = 900000; // Gap (in ms) necessary to perform next synchronization\nvar POLLING_GAP = 15000; // Gap (in seconds) necessary to start polling and checking synchronization\n\n/**\n *  Synced table model\n */\n\nmodule.exports = Backbone.Model.extend({\n  defaults: {\n    name: '',\n    url: '',\n    state: '',\n    run_at: 0,\n    ran_at: 0,\n    retried_times: 0,\n    interval: 0,\n    error_code: 0,\n    error_message: '',\n    service_name: '',\n    service_item_id: '',\n    content_guessing: true,\n    type_guessing: true\n  },\n\n  urlRoot: function () {\n    var version = this._configModel.urlVersion('synchronizations');\n    var baseUrl = this._configModel.get('base_url');\n    return baseUrl + '/api/' + version + '/synchronizations/';\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n    this._configModel = opts.configModel;\n\n    this.bind('destroy', function () {\n      this.unset('id');\n    });\n\n    this._checkState();\n\n    this.bind('change:error_code change:error_message change:state', this._checkState, this);\n  },\n\n  toJSON: function () {\n    var c = _.clone(this.attributes);\n\n    var d = {\n      url: c.url,\n      interval: c.interval,\n      content_guessing: c.content_guessing,\n      type_guessing: c.type_guessing,\n      create_vis: c.create_vis\n    };\n\n    if (c.type === 'remote') {\n      _.extend(d, {\n        remote_visualization_id: c.remote_visualization_id,\n        create_vis: false,\n        value: c.value\n      });\n    }\n\n    if (c.id !== undefined) {\n      d.id = c.id;\n    }\n\n    // Comes from a service?\n    if (c.service_name) {\n      d.service_name = c.service_name;\n      d.service_item_id = c.service_item_id;\n    }\n\n    return d;\n  },\n\n  _checkState: function () {\n    if (this.get('error_code') || this.get('error_message')) {\n      this.set('state', 'failure');\n    }\n  },\n\n  syncNow: function (callback) {\n    if (!callback) throw new Error('callback is required');\n\n    $.ajax({\n      url: this.url() + '/sync_now',\n      type: 'PUT'\n    }).always(callback);\n  },\n\n  // Checks for poll to finish\n  pollCheck: function (i) {\n    var self = this;\n    var interval = INTERVAL;\n\n    this.pollTimer = setInterval(request, interval);\n\n    function request () {\n      self.destroyCheck();\n\n      self.fetch({\n        error: function (m, e) {\n          self.set({\n            error_message: e.statusText || '',\n            state: 'failure'\n          });\n        }\n      });\n\n      interval = interval * MULTIPLIER;\n\n      self.pollTimer = setInterval(request, interval);\n    }\n  },\n\n  destroyCheck: function () {\n    clearInterval(this.pollTimer);\n  },\n\n  isSync: function () {\n    return !this.isNew() && this.get('interval') > 0;\n  },\n\n  isSyncing: function () {\n    return this.get('state') === 'syncing' || this.get('state') === 'queued';\n  },\n\n  canSyncNow: function () {\n    var ranAt = new Date(this.get('ran_at'));\n    var now = new Date();\n    var gap = SYNC_GAP; // Importer needs some time to perform the next sync, set 15 min as default.\n\n    if (this.isSyncing()) {\n      return false;\n    }\n\n    return (now.getTime() - ranAt.getTime()) > gap;\n  },\n\n  linkToTable: function (tableModel) {\n    var self = this;\n    if (tableModel.has('synchronization')) {\n      this.set(tableModel.get('synchronization'));\n    }\n\n    tableModel.bind('change:synchronization', function () {\n      self.set(tableModel.get('synchronization'));\n    }, tableModel);\n\n    tableModel.bind('destroy', function destroy () {\n      self.unbind(null, null, tableModel);\n      self.destroy();\n    }, tableModel);\n  }\n}, {\n  SYNC_GAP: SYNC_GAP,\n  POLLING_GAP: POLLING_GAP\n});\n",
    "var Backbone = require('backbone');\nvar ColumnModel = require('./column-model');\n\n/**\n * A collection of table columns\n */\nmodule.exports = Backbone.Collection.extend({\n\n  model: ColumnModel,\n\n  initialize: function (models, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.tableModel) throw new Error('tableModel is required');\n\n    this._configModel = opts.configModel;\n    this._tableModel = opts.tableModel;\n  },\n\n  url: function () {\n    var baseUrl = this._configModel.get('base_url');\n    var version = this._configModel.urlVersion('column');\n    return baseUrl + '/api/' + version + '/tables/' + this._tableModel.get('name') + '/columns';\n  }\n\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar TableColumnsCollection = require('./table-columns-collection');\nvar getSimpleGeometryType = require('./get-simple-geometry-type');\nvar PermissionModel = require('./permission-model');\nvar SyncModel = require('./synchronization-model');\nvar TableNameUtils = require('../helpers/table-name-utils');\n\n/**\n * Model representing a table.\n */\nmodule.exports = Backbone.Model.extend({\n\n  idAttribute: 'name',\n\n  defaults: {\n    // always not fetched to begin with, since the only way to currently get table data is by an individual request\n    fetched: false,\n    schema: []\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._configModel = opts.configModel;\n  },\n\n  urlRoot: function () {\n    var baseUrl = this._configModel.get('base_url');\n    var version = this._configModel.urlVersion('table');\n    return baseUrl + '/api/' + version + '/tables';\n  },\n\n  parse: function (r, opts) {\n    var configModel = (opts && opts.configModel) || this._configModel;\n\n    // \"Sometimes\" table presenter returns the needed data within table_visualization\n    // attribute, because it returns the canonical visualization data. So we have to take\n    // the data from there.\n    if (r.table_visualization && !_.isEmpty(r.table_visualization)) {\n      r = _.extend(\n        {},\n        r.table_visualization,\n        {\n          geometry_types: r.geometry_types\n        }\n      );\n    }\n\n    if (r.synchronization) {\n      if (!this._syncModel) {\n        this._syncModel = new SyncModel(r.synchronization, {\n          configModel: configModel\n        });\n      } else {\n        this._syncModel.set(r.synchronization);\n      }\n    }\n\n    if (r.permission) {\n      if (!this._permissionModel) {\n        this._permissionModel = new PermissionModel(r.permission, {\n          configModel: configModel\n        });\n      } else {\n        this._permissionModel.set(r.permission);\n      }\n    }\n\n    var attrs = _.defaults({\n      fetched: true\n    }, r);\n\n    var columnsAttrs = _.map(r.schema, function (d) {\n      return {\n        name: d[0],\n        type: d[1]\n      };\n    }, this);\n\n    if (!this.columnsCollection) {\n      this.columnsCollection = new TableColumnsCollection(columnsAttrs, {\n        configModel: configModel,\n        tableModel: this\n      });\n    } else {\n      this.columnsCollection.reset(columnsAttrs);\n    }\n\n    return attrs;\n  },\n\n  isOwner: function (userModel) {\n    if (!userModel || !this._permissionModel) {\n      return false;\n    }\n    return this._permissionModel.isOwner(userModel);\n  },\n\n  getUnqualifiedName: function () {\n    return TableNameUtils.getUnqualifiedName(this.get('name'));\n  },\n\n  getOwnerName: function () {\n    var name = this.get('name');\n    if (!name) return null;\n    var tk = name.split('.');\n    if (tk.length === 2) {\n      return tk[0].replace(/\"/g, '');\n    } else if (this._permissionModel) {\n      var ownerModel = this._permissionModel.getOwner();\n      return ownerModel.get('username');\n    } else {\n      return '';\n    }\n  },\n\n  // \"user\".table -> user.table\n  getUnquotedName: function () {\n    var name = this.get('name');\n    return name && name.replace(/\"/g, '');\n  },\n\n  getGeometryType: function () {\n    var types = this.get('geometry_types');\n    var geomTypes = [];\n    if (!_.isArray(types)) {\n      return [];\n    }\n\n    for (var t in types) {\n      var type = types[t];\n      // when there are rows with no geo type null is returned as geotype\n      if (type) {\n        var a = getSimpleGeometryType(type.toLowerCase());\n        if (a) {\n          geomTypes.push(a);\n        }\n      }\n    }\n\n    return _.uniq(geomTypes);\n  },\n\n  getPermissionModel: function () {\n    return this._permissionModel;\n  },\n\n  isReadOnly: function (userModel) {\n    return this.isSync() || !this.hasWriteAccess(userModel);\n  },\n\n  isSync: function () {\n    var syncModel = this.getSyncModel();\n    var isSync = syncModel && syncModel.get('id');\n\n    return !!isSync;\n  },\n\n  hasWriteAccess: function (userModel) {\n    if (!userModel || !this._permissionModel) {\n      return false;\n    }\n    return this._permissionModel.hasWriteAccess(userModel);\n  },\n\n  getSyncModel: function () {\n    return this._syncModel;\n  }\n\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar TableModel = require('./table-model');\n\nvar DEFAULT_FETCH_OPTIONS = {\n  type: 'table',\n  order: 'updated_at',\n  page: 1,\n  per_page: 20,\n  exclude_shared: false,\n  exclude_raster: true,\n  tags: '',\n  q: ''\n};\n\n/**\n * A collection that holds Table models\n */\nmodule.exports = Backbone.Collection.extend({\n\n  model: function (d, opts) {\n    var configModel = opts.collection._configModel;\n    return new TableModel(d, {\n      configModel: configModel,\n      parse: true\n    });\n  },\n\n  modelId: function (attrs) {\n    return attrs.name;\n  },\n\n  initialize: function (models, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n    this._configModel = opts.configModel;\n    this._stats = {};\n  },\n\n  url: function () {\n    var version = this._configModel.urlVersion('visualization');\n    var baseUrl = this._configModel.get('base_url');\n    return baseUrl + '/api/' + version + '/viz';\n  },\n\n  // Overrides the default fetch, to use the internal methods to construct parmas\n  fetch: function (opts) {\n    opts = opts || {\n      data: {\n        // If reaches this code path it's because there were no opts given, i.e. should do a 'full fetch'\n        // Since there is no current way to really do a full fetch let's just set a really high number to get all\n        // TODO this is obviously bad for organization users, how can we do this differently\n        per_page: 1000\n      }\n    };\n    opts.data = _.extend({}, DEFAULT_FETCH_OPTIONS, opts.data);\n    return Backbone.Collection.prototype.fetch.call(this, opts);\n  },\n\n  getTotalStat: function (attribute) {\n    return this._stats[attribute] || 0;\n  },\n\n  parse: function (res) {\n    this._stats = _.omit(res, 'visualizations');\n\n    return _.map(res.visualizations, function (d) {\n      var dt = d.table; // embedded table data in the vis response\n      return {\n        // From embedded table with same key/value\n        id: dt.id,\n        geometry_types: dt.geometry_types,\n        name: dt.name,\n        privacy: dt.privacy,\n\n        // From embedded table with same value, but different key\n        // so re-map them to match what's returned from a GET /tables/t-id\n        rows_counted: dt.row_count,\n        table_size: dt.size,\n        table_type: d.type // table or remote\n      };\n    }, this);\n  }\n});\n",
    "var _ = require('underscore');\nvar BackboneUndo = require('backbone-undo');\nvar MAXIMUM_STACK_LENGTH = 30;\n\nmodule.exports = {\n  init: function (model, opts) {\n    if (!model) throw new Error('model is required to initialize undoManager');\n\n    opts = opts || {};\n    this.model = model;\n\n    this.model._undoManager = this.undoManager = new BackboneUndo({\n      maximumStackLength: opts.maximumStackLength || MAXIMUM_STACK_LENGTH,\n      register: this.model,\n      track: opts.track\n    });\n\n    this._trackEvents();\n    this._addMethods();\n\n    if (!_.isEmpty(opts.history)) {\n      opts.track && this.undoManager.stopTracking();\n      this._addHistory(opts.history);\n      opts.track && this.undoManager.startTracking();\n    }\n  },\n\n  _trackEvents: function () {\n    _.each(['undo', 'redo'], function (eventType) {\n      this.undoManager.bind(eventType, function () {\n        this.trigger(eventType, this.changed, this);\n      }, this.model);\n    }, this);\n\n    this.undoManager.stack.bind('add remove reset', function () {\n      this.trigger('unredoChanged', this.changed, this);\n    }, this.model);\n  },\n\n  _addHistory: function (history) {\n    var stack = this.undoManager.stack;\n\n    _.each(history, function (attrs, i) {\n      if (history[i + 1]) {\n        stack.add({\n          after: history[i + 1],\n          before: attrs,\n          type: 'change',\n          undoTypes: this.undoManager.undoTypes,\n          object: this.model,\n          magicFusionIndex: 0\n        });\n      }\n    }, this);\n\n    stack.pointer = stack.length - 1;\n  },\n\n  _addMethods: function () {\n    _.extend(\n      this.model,\n      {\n        undo: function () {\n          this._undoManager.undo();\n        },\n\n        redo: function () {\n          this._undoManager.redo();\n        },\n\n        canUndo: function () {\n          return this._undoManager.isAvailable('undo');\n        },\n\n        canRedo: function () {\n          return this._undoManager.isAvailable('redo');\n        },\n\n        getUndoHistory: function () {\n          var list = this._undoManager.stack.toJSON();\n          var data = _.reduce(list, function (memo, attrs, i) {\n            memo.push(attrs.before);\n            return memo;\n          }, [], this);\n          data.push(this.attributes);\n          return data;\n        }\n      }\n    );\n  }\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar UploadConfig = require('../config/upload-config');\nvar Utils = require('../helpers/utils.js');\nvar moment = require('moment');\nrequire('backbone-model-file-upload');\n\n/**\n * Model that allows uploading files to CartoDB endpoints.\n *\n * NOTE: this model extends Backbone.Model instead of Backbone.Model, because\n * it's required for the vendor/backbone-model-file-upload.\n */\nmodule.exports = Backbone.Model.extend({\n  url: function () {\n    var baseUrl = this._configModel.get('base_url');\n    return baseUrl + '/api/v1/imports';\n  },\n\n  fileAttribute: 'filename',\n\n  defaults: {\n    type: '',\n    value: '',\n    interval: 0,\n    privacy: '',\n    progress: 0,\n    state: 'idle',\n    service_item_id: '',\n    service_name: '',\n    option: '',\n    content_guessing: true,\n    type_guessing: true,\n    create_vis: true\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._userModel = opts.userModel;\n    this._configModel = opts.configModel;\n    this._initBinds();\n    // We need to validate entry attributes\n    this._validate(this.attributes, { validate: true });\n  },\n\n  setUpload: function (d) {\n    this.set(d, {\n      validate: true\n    });\n  },\n\n  isValidToUpload: function () {\n    return this.get('value') && this.get('state') !== 'error';\n  },\n\n  setFresh: function (d) {\n    if (d && !_.isEmpty(d)) {\n      // Set upload properties except create_vis (defined when created)\n      this.set(_.omit(d, 'create_vis'));\n    } else {\n      this.clear();\n    }\n  },\n\n  _initBinds: function () {\n    this.bind('progress', function (progress) {\n      this.set({\n        progress: progress * 100,\n        state: 'uploading'\n      });\n    }, this);\n\n    this.bind('change:value', function () {\n      if (this.get('state') === 'error') {\n        this.set({ state: 'idle' });\n        this.unset('get_error_text', { silent: true });\n      }\n    }, this);\n\n    this.bind('error invalid', function (m, d) {\n      this.set({\n        state: 'error',\n        error_code: (d && d.error_code) || '',\n        get_error_text: {\n          title: _t('data.upload-model.invalid-import'),\n          what_about: (d && d.msg) || ''\n        }\n      });\n    }, this);\n  },\n\n  validate: function (attrs) {\n    if (!attrs) return;\n\n    if (attrs.type === 'file') {\n      // Number of files\n      if (attrs.value && attrs.value.length) {\n        return {\n          msg: _t('data.upload-model.one-file')\n        };\n      }\n\n      // File name\n      var name = attrs.value.name;\n      if (!name) {\n        return {\n          msg: _t('data.upload-model.file-defined')\n        };\n      }\n\n      // File extension\n      var ext = name.substr(name.lastIndexOf('.') + 1);\n      if (ext) {\n        ext = ext.toLowerCase();\n      }\n      if (!_.contains(UploadConfig.fileExtensions, ext)) {\n        return {\n          msg: _t('data.upload-model.file-extension')\n        };\n      }\n      // File size\n      if ((this._userModel.get('remaining_byte_quota') * UploadConfig.fileTimesBigger) < attrs.value.size) {\n        return {\n          msg: _t('data.upload-model.file-size'),\n          error_code: 8001\n        };\n      }\n    }\n\n    if (attrs.type === 'remote') {\n      // Valid remote visualization id?\n      if (!attrs.remote_visualization_id) {\n        return {\n          msg: _t('data.upload-model.visualization-id')\n        };\n      }\n      // Remote size?\n      if (attrs.size && ((this._userModel.get('remaining_byte_quota') * UploadConfig.fileTimesBigger) < attrs.size)) {\n        return {\n          msg: _t('data.upload-model.remote-file-size'),\n          error_code: 8001\n        };\n      }\n    }\n\n    if (attrs.type === 'url') {\n      // Valid URL?\n      if (!Utils.isURL(attrs.value)) {\n        return {\n          msg: _t('data.upload-model.url-invalid')\n        };\n      }\n    }\n\n    if (attrs.type === 'sql') {\n      if (!attrs.value) {\n        return {\n          msg: _t('data.upload-model.query-undefined')\n        };\n      }\n    }\n\n    if (attrs.type === 'duplication') {\n      if (!attrs.value) {\n        return {\n          msg: _t('data.upload-model.dataset-copy-undefined')\n        };\n      }\n    }\n\n    if (attrs.type === 'service' && attrs.service_name === 'twitter_search') {\n      var service_item_id = attrs.service_item_id;\n\n      // Empty?\n      if (!service_item_id || _.isEmpty(service_item_id)) {\n        return {\n          msg: _t('data.upload-model.twitter-data')\n        };\n      }\n\n      // Categories?\n      if (_.isEmpty(service_item_id.categories)) {\n        return {\n          msg: _t('data.upload-model.twitter-categories-invalid')\n        };\n      }\n\n      // Dates?\n      var dates = service_item_id.dates;\n      if (!dates || _.isEmpty(dates)) {\n        return {\n          msg: _t('data.upload-model.twitter-dates-empty')\n        };\n      }\n      var isToDateValid = moment(dates.fromDate) <= moment(new Date());\n      if (!dates.fromDate || !dates.toDate || !isToDateValid) {\n        return {\n          msg: _t('data.upload-model.twitter-dates-invalid')\n        };\n      }\n    }\n  },\n\n  isValid: function () {\n    return this.get('value') && this.get('state') !== 'error';\n  },\n\n  upload: function () {\n    if (this.get('type') === 'file') {\n      var self = this;\n      this.xhr = this.save(\n        {\n          filename: this.get('value')\n        },\n        {\n          success: function (m) {\n            m.set('state', 'uploaded');\n          },\n          error: function (m, msg) {\n            var message = _t('data.upload-model.connection-error');\n\n            if (msg && msg.status === 429) {\n              var response = JSON.parse(msg.responseText);\n              message = response.errors.imports;\n            }\n\n            self.set({\n              state: 'error',\n              get_error_text: {\n                title: _t('data.upload-model.error-happened'),\n                what_about: message\n              }\n            });\n          },\n          complete: function () {\n            delete self.xhr;\n          }\n        }\n      );\n    }\n  },\n\n  stopUpload: function () {\n    if (this.xhr) this.xhr.abort();\n  },\n\n  setGuessing: function (val) {\n    this.set({\n      type_guessing: val,\n      content_guessing: val\n    });\n  },\n\n  setPrivacy: function (val) {\n    this.set('privacy', val);\n  }\n\n});\n",
    "var $ = require('jquery');\nvar _ = require('underscore');\nvar nodeIds = require('../value-objects/analysis-node-ids');\nvar MetricsTracker = require('../components/metrics/metrics-tracker');\nvar SimpleStyleDefaults = require('../editor/style/style-defaults/simple-style-defaults');\nvar camshaftReference = require('./camshaft-reference');\nvar layerTypesAndKinds = require('./layer-types-and-kinds');\nvar layerColors = require('./layer-colors');\nvar Notifier = require('../components/notifier/notifier');\nvar resetStylePerNode = require('../helpers/reset-style-per-node');\n\n/**\n * Coordinate side-effects done on explicit interactions.\n * @param {Object} params\n * @param {Object} params.userModel\n * @param {Object} params.analysisDefinitionsCollection\n * @param {Object} params.analysisDefinitionNodesCollection\n * @param {Object} params.widgetDefinitionsCollection\n * @return {Object} that contains all user-actions that the user may do related to a map\n */\nmodule.exports = function (params) {\n  if (!params.userModel) throw new Error('userModel is required');\n  if (!params.analysisDefinitionsCollection) throw new Error('analysisDefinitionsCollection is required');\n  if (!params.analysisDefinitionNodesCollection) throw new Error('analysisDefinitionNodesCollection is required');\n  if (!params.layerDefinitionsCollection) throw new Error('layerDefinitionsCollection is required');\n  if (!params.widgetDefinitionsCollection) throw new Error('widgetDefinitionsCollection is required');\n\n  var userModel = params.userModel;\n  var analysisDefinitionsCollection = params.analysisDefinitionsCollection;\n  var analysisDefinitionNodesCollection = params.analysisDefinitionNodesCollection;\n  var layerDefinitionsCollection = params.layerDefinitionsCollection;\n  var widgetDefinitionsCollection = params.widgetDefinitionsCollection;\n\n  var createDefaultCartoDBAttrs = function (oldLayerStyle) {\n    return {\n      kind: 'carto',\n      options: {\n        interactivity: '',\n        tile_style: (oldLayerStyle && oldLayerStyle.options.tile_style) || camshaftReference.getDefaultCartoCSSForType(),\n        cartocss: (oldLayerStyle && oldLayerStyle.options.tile_style) || camshaftReference.getDefaultCartoCSSForType(),\n        style_version: '2.1.1',\n        visible: true,\n        style_properties: (oldLayerStyle && oldLayerStyle.options.style_properties),\n        sql_wrap: (oldLayerStyle && oldLayerStyle.options.sql_wrap)\n      },\n      tooltip: oldLayerStyle ? oldLayerStyle.tooltip : {},\n      infowindow: oldLayerStyle ? oldLayerStyle.infowindow : {}\n    };\n  };\n\n  var deleteOrphanedAnalyses = function () {\n    analysisDefinitionNodesCollection\n      .toArray()\n      .forEach(function (nodeDefModel) {\n        if (!layerDefinitionsCollection.anyContainsNode(nodeDefModel)) {\n          nodeDefModel.destroy();\n        }\n      });\n\n    analysisDefinitionsCollection\n      .toArray()\n      .forEach(function (analysisDefModel) {\n        if (!analysisDefModel.getNodeDefinitionModel()) {\n          analysisDefModel.destroy();\n        }\n      });\n  };\n\n  var restoreWidgetsFromLayer = function (affectedWidgets, layerDefModel, callback, callbackOptions) {\n    if (!affectedWidgets || !_.isArray(affectedWidgets)) throw new Error('affectedWidgets is required');\n    if (!layerDefModel) throw new Error('layerDefModel is required');\n    if (!callback) throw new Error('callback is required');\n\n    var notification;\n    var restoringError;\n    var onWidgetFinished = _.after(affectedWidgets.length, function () {\n      if (!restoringError) {\n        notification.set({\n          status: 'success',\n          info: _t('notifications.widgets.restored'),\n          closable: true\n        });\n      } else {\n        Notifier.removeNotification(notification);\n      }\n      callback(layerDefModel, callbackOptions);\n    });\n\n    if (affectedWidgets.length > 0) {\n      notification = Notifier.addNotification({\n        status: 'loading',\n        info: _t('notifications.widgets.restoring'),\n        closable: false\n      });\n\n      // Create widgets with new source and layer_id\n      _.each(affectedWidgets, function (attrs) {\n        attrs.layer_id = attrs.layer_id || layerDefModel.id;\n\n        widgetDefinitionsCollection.create(\n          attrs, {\n            wait: true,\n            success: onWidgetFinished,\n            error: function (e, mdl) {\n              notification = Notifier.addNotification({\n                status: 'error',\n                info: _t('notifications.widgets.error.title') +\n                  _t('notifications.widgets.error.body', {\n                    body: '',\n                    error: mdl && mdl.get('title')\n                  }),\n                closable: true\n              });\n              restoringError = true;\n              onWidgetFinished();\n            }\n          }\n        );\n      });\n    } else {\n      callback(layerDefModel, callbackOptions);\n    }\n  };\n\n  return {\n    _resetStylePerNode: function (nodeDefModel, layerDefModel, forceStyleUpdate, resetQueryReady) {\n      resetStylePerNode(nodeDefModel, layerDefModel, forceStyleUpdate, resetQueryReady);\n    },\n\n    saveAnalysis: function (analysisFormModel) {\n      if (!analysisFormModel.isValid()) return;\n\n      var nodeDefModel = analysisDefinitionNodesCollection.get(analysisFormModel.id);\n\n      if (nodeDefModel) {\n        analysisFormModel.updateNodeDefinition(nodeDefModel);\n        var layerDefModel = layerDefinitionsCollection.findOwnerOfAnalysisNode(nodeDefModel);\n        analysisDefinitionsCollection.saveAnalysisForLayer(layerDefModel);\n\n        MetricsTracker.track('Modified analysis', {\n          analysis: {\n            id: analysisFormModel.attributes['id'],\n            natural_id: analysisFormModel.attributes['id'],\n            type: analysisFormModel.attributes['type']\n          }\n        });\n\n        this._resetStylePerNode(nodeDefModel, layerDefModel, false, true);\n      } else {\n        nodeDefModel = analysisFormModel.createNodeDefinition(this); // delegate creation to the form, but expect it to call userActions.createAnalysisNode when done with its internal stuff\n      }\n      nodeDefModel.USER_SAVED = true;\n    },\n\n    /**\n     * Creates a new analysis node on a particular layer.\n     * It's assumed to be created on top of an existing node.\n     * @param {Object} nodeAttrs\n     * @param {Object} layerDefModel - instance of layer-definition-model\n     * @return {Object} instance of analysis-definition-node-model\n     */\n    createAnalysisNode: function (nodeAttrs, layerDefModel) {\n      var nodeDefModel = analysisDefinitionNodesCollection.add(nodeAttrs, {parse: false});\n\n      layerDefModel.save({\n        cartocss: camshaftReference.getDefaultCartoCSSForType(),\n        source: nodeDefModel.id\n      });\n      analysisDefinitionsCollection.saveAnalysisForLayer(layerDefModel);\n\n      MetricsTracker.track('Created analysis', {\n        analysis: {\n          id: nodeDefModel.attributes['id'],\n          natural_id: nodeDefModel.attributes['id'],\n          type: nodeDefModel.attributes['type']\n        }\n      });\n\n      this._resetStylePerNode(nodeDefModel, layerDefModel);\n\n      return nodeDefModel;\n    },\n\n    saveAnalysisSourceQuery: function (query, nodeDefModel, layerDefModel) {\n      if (!nodeDefModel) throw new Error('nodeDefModel is required');\n      if (nodeDefModel.get('type') !== 'source') throw new Error('nodeDefModel must be a source node');\n\n      nodeDefModel.set('query', query || '');\n\n      analysisDefinitionsCollection.saveAnalysisForLayer(layerDefModel);\n      this._resetStylePerNode(nodeDefModel, layerDefModel);\n      layerDefModel.save(); // to make sure layer's source ref is persisted\n    },\n\n    saveWidgetOption: function (widgetOptionModel) {\n      if (!widgetOptionModel) throw new Error('widgetOptionModel is required');\n\n      if (widgetOptionModel.analysisDefinitionNodeModel()) { // Might not always have a node-definition, e.g. time-series none-option\n        var layerDefModel = widgetOptionModel.layerDefinitionModel();\n        analysisDefinitionsCollection.saveAnalysisForLayer(layerDefModel);\n      }\n\n      return widgetOptionModel.save(widgetDefinitionsCollection); // delegate back to form model to decide how to save\n    },\n\n    saveWidget: function (widgetDefModel) {\n      if (!widgetDefModel) throw new Error('widgetDefModel is required');\n\n      var widgetLayerId = widgetDefModel.get('layer_id');\n      layerDefinitionsCollection.some(function (layerDefModel) {\n        if (layerDefModel.id === widgetLayerId) {\n          analysisDefinitionsCollection.saveAnalysisForLayer(layerDefModel);\n          return true; // aborts the \"some\"-iterator\n        }\n      });\n\n      widgetDefModel.save();\n    },\n\n    deleteAnalysisNode: function (nodeId) {\n      var nodeDefModel = analysisDefinitionNodesCollection.get(nodeId);\n      if (!nodeDefModel) return false; // abort if there is no node-definition; nothing to delete/change\n      if (!nodeDefModel.canBeDeletedByUser()) return false;\n\n      var layerDefModel = layerDefinitionsCollection.findOwnerOfAnalysisNode(nodeDefModel);\n      var primarySourceNode = nodeDefModel.getPrimarySource();\n\n      var containsNode = function (m) {\n        return m !== layerDefModel && m !== nodeDefModel && m.containsNode(nodeDefModel);\n      };\n      _\n        .flatten([\n          widgetDefinitionsCollection.filter(containsNode),\n          layerDefinitionsCollection.filter(containsNode),\n          analysisDefinitionsCollection.filter(containsNode),\n          analysisDefinitionNodesCollection.filter(containsNode),\n          nodeDefModel\n        ], true)\n        .forEach(function (m) {\n          m.destroy();\n        });\n\n      // Try to restore old styles if we have them, reset them if not\n      var oldNodeStyle = primarySourceNode.getStyleHistoryForLayer(layerDefModel.id);\n      if (oldNodeStyle) {\n        layerDefModel.set({source: primarySourceNode.id}, {ignoreSchemaChange: true});\n        layerDefModel.styleModel.set(layerDefModel.styleModel.parse(oldNodeStyle.options.style_properties));\n        layerDefModel.set({\n          cartocss: oldNodeStyle.options.tile_style,\n          infowindow: oldNodeStyle.infowindow,\n          tooltip: oldNodeStyle.tooltip,\n          sql_wrap: oldNodeStyle.options.sql_wrap\n        });\n      } else {\n        layerDefModel.set({source: primarySourceNode.id});\n      }\n      layerDefModel.save();\n      analysisDefinitionsCollection.saveAnalysisForLayer(layerDefModel);\n\n      MetricsTracker.track('Deleted analysis', {\n        analysis: {\n          id: nodeDefModel.attributes['id'],\n          natural_id: nodeDefModel.attributes['id'],\n          type: nodeDefModel.attributes['type']\n        }\n      });\n\n      this._resetStylePerNode(primarySourceNode, layerDefModel);\n\n      deleteOrphanedAnalyses();\n    },\n\n    /**\n     * Create a new layer for a given table name\n     * @param {model} [tableModel]\n     * @param {object} [options]\n     * @param {number} [options.at]\n     */\n    createLayerFromTable: function (tableModel, options) {\n      options = options || {};\n\n      var tableName = tableModel.getUnqualifiedName();\n      var ownerName = tableModel.getOwnerName() || userModel.get('username');\n      var tableGeometry = tableModel.getGeometryType() && tableModel.getGeometryType()[0];\n\n      // Setting at assumes there to be at least one non-basemap layer\n      var at = options.at || layerDefinitionsCollection.length;\n      var layerOnTop = layerDefinitionsCollection.getLayerOnTop();\n      var layerOnTopPos = layerDefinitionsCollection.indexOf(layerOnTop);\n      var hasTorque = layerDefinitionsCollection.isThereAnyTorqueLayer();\n      var hasLabels = layerOnTop &&\n        !layerTypesAndKinds.isCartoDBType(layerOnTop.get('type')) &&\n        !layerTypesAndKinds.isTorqueType(layerOnTop.get('type'));\n\n      if (hasTorque || hasLabels) {\n        layerOnTop.set('order', layerOnTopPos + 1); // persisted on collection.save in success callback below\n\n        if (hasLabels) { at--; }\n        if (hasTorque) { at--; }\n      }\n\n      var newLetter = layerDefinitionsCollection.nextLetter();\n      var attrs = createDefaultCartoDBAttrs();\n      attrs.letter = newLetter;\n      attrs.options.table_name = tableName;\n      if (ownerName) {\n        attrs.options.user_name = ownerName;\n      }\n\n      if (tableGeometry) {\n        attrs.options.style_properties = {\n          type: 'simple',\n          properties: SimpleStyleDefaults.generateAttributes(tableGeometry)\n        };\n      }\n\n      analysisDefinitionNodesCollection.addRelatedTableData(tableModel.toJSON());\n\n      return layerDefinitionsCollection.create(attrs, {\n        wait: true,\n        at: at,\n        error: options.error,\n        success: function () {\n          layerDefinitionsCollection.each(function (layerDefModel) {\n            if (!layerDefModel.isDataLayer()) return;\n            if (analysisDefinitionsCollection.findAnalysisForLayer(layerDefModel)) return;\n\n            analysisDefinitionsCollection.saveAnalysisForLayer(layerDefModel);\n          });\n          layerDefinitionsCollection.save();\n          options.success && options.success();\n        }\n      });\n    },\n\n    /**\n     * A layer for an existing node have different side-effects depending on the context in which the node exists.\n     * @param {string} nodeid\n     * @param {object} cfg\n     * @param {number} cfg.at\n     */\n    createLayerForAnalysisNode: function (nodeId, cfg) {\n      var userMaxLayers = userModel.get('limits').max_layers;\n      if (layerDefinitionsCollection.getNumberOfDataLayers() >= userMaxLayers) {\n        var err = new Error('max layers reached');\n        err.userMaxLayers = userMaxLayers;\n        throw err;\n      }\n\n      var nodeDefModel = analysisDefinitionNodesCollection.get(nodeId);\n      if (!nodeDefModel) throw new Error('node with id ' + nodeId + ' does not exist');\n      if (!cfg) throw new Error('cfg is required');\n      if (isNaN(cfg.at) || cfg.at <= 0) throw new Error('cfg.at must be on top of the base layer');\n\n      var newPosition = cfg.at;\n\n      var attrs;\n      var tableName;\n      var tableNameAlias;\n      var ownerName;\n      var oldNodeStyle;\n      var newLetter = layerDefinitionsCollection.nextLetter();\n      var affectedWidgetAttrsBySourceChange = [];\n\n      var onNewLayerSaved = function (layer, forceResetStyles) {\n        this._resetStylePerNode(layer.getAnalysisDefinitionNodeModel(), layer, forceResetStyles);\n        layerDefinitionsCollection.save(); // to persist layers order\n      }.bind(this);\n\n      var prevLayer = layerDefinitionsCollection.findWhere({source: nodeId});\n      if (prevLayer) {\n        if (nodeDefModel.hasPrimarySource()) {\n          // Node is head of a layer, e.g. given nodeId A3 it should rename prev layer (A => B), and create a new layer (A)\n          // where the prev layer was to take over its letter identity and its primary source (A2).\n          // The motivation for this is to maintain the layer's state (styles, popup etc.) which really depends on the\n          // last analysis output than the layer itself:\n          //   _______       _______   ______\n          //  | A    |      | A    |  | B    | <-- note that B is really A which just got moved & had it's nodes renamed\n          //  |      |      |      |  |      |\n          //  | {A3} |  =>  |      |  | {B1} |\n          //  | [A2] |      | [A2] |  | [A2] |\n          //  | [A1] |      | [A1] |  |      |\n          //  | [A0] |      | [A0] |  |      |\n          //  |______|      |______|  |______|\n          var prevOrder = layerDefinitionsCollection.indexOf(prevLayer);\n          var prevLetter = prevLayer.get('letter');\n\n          // Change identity of prevLayer (A) so it appears as the new layer (B), including its analysis\n          var renamedNodeId = newLetter + '1';\n          var renamedNodeDefModel = nodeDefModel.clone(renamedNodeId); // e.g. A3 => B1\n          analysisDefinitionNodesCollection.invoke('changeSourceIds', nodeId, renamedNodeId);\n\n          // We have to manage all widgets associated with the layer due to the operations we do\n          // creating a new one and managing the previous one\n          var prevLayerNodeIds = _.pluck(prevLayer.ownedPrimaryAnalysisNodes(), 'id');\n          var affectedWidgetsBySourceChange = widgetDefinitionsCollection.filter(function (widgetDefModel) {\n            return _.contains(prevLayerNodeIds, widgetDefModel.get('source'));\n          });\n\n          _.each(affectedWidgetsBySourceChange, function (widgetDefModel) {\n            var attrs;\n            var widgetSourceId = widgetDefModel.get('source');\n\n            // If this widget doesn't point to the \"dragged\" node, it will\n            // keep the source but the layer_id will be totally different\n            if (widgetSourceId !== nodeId) {\n              attrs = _.extend(\n                _.omit(widgetDefModel.toJSON(), 'id', 'layer_id', 'order'),\n                {\n                  avoidNotification: true\n                }\n              );\n            } else {\n              // On the other hand, if there is a widget pointing to the dragged node,\n              // it will keep the layer_id but the source will be different\n              attrs = _.extend(\n                _.omit(widgetDefModel.toJSON(), 'id', 'source', 'order'),\n                {\n                  source: {\n                    id: renamedNodeId\n                  },\n                  avoidNotification: true\n                }\n              );\n            }\n\n            affectedWidgetAttrsBySourceChange.push(attrs);\n            widgetDefModel.attributes.avoidNotification = true;\n            widgetDefModel.destroy();\n          });\n\n          prevLayer.save({\n            letter: newLetter,\n            color: layerColors.getColorForLetter(newLetter),\n            source: renamedNodeId\n          }, {ignoreSchemaChange: true});\n\n          analysisDefinitionsCollection.newAnalysisForNode(renamedNodeDefModel); // will be saved by saveAnalysisForLayer later since containing that layer's node\n\n          // Remove prevLayer (A) temporarily, to move the layers to expected positions\n          layerDefinitionsCollection.remove(prevLayer, {silent: true}); // silent to avoid unwanted side-effects; re-added again later\n\n          // New layer takes over the identity of the old layer (A), and its primary source as its head node\n          // We apply the styles from the new header node (A2) if available\n          oldNodeStyle = nodeDefModel.getPrimarySource().getStyleHistoryForLayer(prevLayer.id);\n          tableName = prevLayer.get('table_name');\n          tableNameAlias = prevLayer.get('table_name_alias');\n          ownerName = prevLayer.get('user_name') || userModel.get('username');\n          attrs = createDefaultCartoDBAttrs(oldNodeStyle);\n          attrs.options = _.extend({}, attrs.options, {\n            sql: 'SELECT * FROM ' + tableName,\n            table_name: tableName,\n            table_name_alias: tableNameAlias,\n            letter: prevLetter,\n            color: layerColors.getColorForLetter(prevLetter),\n            source: nodeDefModel.getPrimarySource().id\n          });\n          if (ownerName) {\n            attrs.options.user_name = ownerName;\n          }\n\n          // Tell the backend that this layer is a copy of the old one, and how to rename the analysis nodes.\n          // This is used to keep the style_history valid in both the old a new layer\n          attrs.from_layer_id = prevLayer.get('id');\n          attrs.from_letter = prevLetter;\n          var newLayerDefModel = layerDefinitionsCollection.add(attrs, {at: prevOrder});\n          analysisDefinitionsCollection.saveAnalysisForLayer(newLayerDefModel);\n\n          // Re-add source layer again, but after the new layer was created and before layer is getting saved\n          layerDefinitionsCollection.add(prevLayer, {at: newPosition});\n\n          // Reset styles from previous layer\n          this._resetStylePerNode(prevLayer.getAnalysisDefinitionNodeModel(), prevLayer);\n\n          newLayerDefModel.save(null, {\n            success: function () {\n              restoreWidgetsFromLayer(affectedWidgetAttrsBySourceChange, newLayerDefModel, onNewLayerSaved, !oldNodeStyle);\n            },\n            error: function () {\n              Notifier.addNotification({\n                status: 'error',\n                info: _t('notifications.layer.error'),\n                closable: true\n              });\n            }\n          });\n          nodeDefModel.destroy(); // replaced by new node\n        } else {\n          // Node is the source of a prevLayer\n          // Create a new layer which simply points to that source\n          //   _______       _______   ______\n          //  | A    |      | A    |  | B    |\n          //  |      |      |      |  |      |\n          //  | [A0] |  =>  | [A0] |  | [A0] |\n          //  |______|      |______|  |______|\n\n          // Keep the same style in the new layer\n          oldNodeStyle = {\n            options: {\n              tile_style: prevLayer.get('cartocss'),\n              sql_wrap: prevLayer.get('sql_wrap'),\n              style_properties: prevLayer.get('style_properties')\n            },\n            infowindow: prevLayer.get('infowindow'),\n            tooltip: prevLayer.get('tooltip')\n          };\n          tableName = prevLayer.get('table_name');\n          tableNameAlias = prevLayer.get('table_name_alias');\n          ownerName = prevLayer.get('user_name') || userModel.get('username');\n          attrs = createDefaultCartoDBAttrs(oldNodeStyle);\n          attrs.options = _.extend({}, attrs.options, {\n            sql: 'SELECT * FROM ' + tableName,\n            table_name: tableName,\n            table_name_alias: tableNameAlias,\n            letter: newLetter,\n            color: layerColors.getColorForLetter(newLetter),\n            source: nodeId\n          });\n          if (ownerName) {\n            attrs.options.user_name = ownerName;\n          }\n          newLayerDefModel = layerDefinitionsCollection.create(attrs, {\n            at: newPosition,\n            success: function () {\n              onNewLayerSaved(newLayerDefModel, false);\n            },\n            error: function () {\n              Notifier.addNotification({\n                status: 'error',\n                info: _t('notifications.layer.error'),\n                closable: true\n              });\n            }\n          });\n        }\n      } else {\n        // Node is NOT a head of a node, e.g. given nodeId is 'a2' this would create a new layer B which takes over the\n        // ownership of the given node and its underlying nodes\n        //   _______       _______   ______\n        //  | A    |      | A    |  | B    |\n        //  |      |      |      |  |      |\n        //  | [A3] |      | [A3] |  | {B2} |\n        //  | {A2} |  =>  | {B2} |  | [B1] |\n        //  | [A1] |      |      |  | [B0] |\n        //  | [A0] |      |      |  |      |\n        //  |______|      |______|  |______|\n\n        var linkedNodesList = nodeDefModel.linkedListBySameLetter();\n\n        var moveNode = function (oldNode) {\n          var newId = nodeIds.changeLetter(oldNode.id, newLetter);\n          var newNode = oldNode.clone(newId);\n          var affectedWidgetsBySourceChange = widgetDefinitionsCollection.where({ source: oldNode.id });\n\n          analysisDefinitionNodesCollection.invoke('changeSourceIds', oldNode.id, newId);\n\n          _.each(affectedWidgetsBySourceChange, function (m) {\n            // Store attrs from affected widget for creating a new\n            // instance when layer is created\n            affectedWidgetAttrsBySourceChange.push(\n              _.extend(\n                _.omit(m.toJSON(), 'id', 'layer_id', 'source', 'order'),\n                {\n                  avoidNotification: true,\n                  source: {\n                    id: newId\n                  }\n                }\n              )\n            );\n\n            // Destroy widgets pointing to that source until new layer is created\n            m.attributes.avoidNotification = true;\n            m.destroy();\n          });\n\n          return newNode;\n        };\n        var newLayerHeadNode = moveNode(linkedNodesList[0]);\n        _.rest(linkedNodesList).forEach(moveNode);\n\n        // Create the new layer (B). Copy the layer style from the dragged node.\n        var ownerLayer = layerDefinitionsCollection.findOwnerOfAnalysisNode(nodeDefModel);\n        oldNodeStyle = nodeDefModel.getStyleHistoryForLayer(ownerLayer.id);\n        tableName = ownerLayer.get('table_name');\n        tableNameAlias = ownerLayer.get('table_name_alias');\n        ownerName = ownerLayer.get('user_name') || userModel.get('username');\n        attrs = createDefaultCartoDBAttrs(oldNodeStyle);\n        attrs.options = _.extend({}, attrs.options, {\n          sql: 'SELECT * FROM ' + tableName,\n          table_name: tableName,\n          table_name_alias: tableNameAlias,\n          letter: newLetter,\n          color: layerColors.getColorForLetter(newLetter),\n          source: newLayerHeadNode.id\n        });\n        if (ownerName) {\n          attrs.options.user_name = ownerName;\n        }\n\n        // Tell the backend that this layer is a copy of the old one, and how to rename the analysis nodes.\n        // This is used to keep the style_history valid in both the old a new layer\n        attrs.from_layer_id = ownerLayer.get('id');\n        attrs.from_letter = ownerLayer.get('letter');\n        newLayerDefModel = layerDefinitionsCollection.create(attrs, {\n          at: newPosition,\n          success: function () {\n            restoreWidgetsFromLayer(affectedWidgetAttrsBySourceChange, newLayerDefModel, onNewLayerSaved, !oldNodeStyle);\n          },\n          error: function () {\n            Notifier.addNotification({\n              status: 'error',\n              info: _t('notifications.layer.error'),\n              closable: true\n            });\n          }\n        });\n\n        analysisDefinitionsCollection.saveAnalysisForLayer(newLayerDefModel);\n        nodeDefModel.destroy(); // replaced by new node\n      }\n\n      deleteOrphanedAnalyses();\n    },\n\n    moveLayer: function (d) {\n      var from = d.from;\n      var to = d.to;\n\n      var movingLayer = layerDefinitionsCollection.at(from);\n      layerDefinitionsCollection.remove(movingLayer, {silent: true});\n      layerDefinitionsCollection.add(movingLayer, {at: to, parse: false, silent: true});\n\n      var saveAnalysisPromises = layerDefinitionsCollection\n        .chain()\n        .map(function (layerDefModel) {\n          var nodeDefModel = layerDefModel.getAnalysisDefinitionNodeModel();\n          if (nodeDefModel) {\n            return analysisDefinitionsCollection.saveAnalysisForLayer(layerDefModel);\n          }\n        })\n        .compact()\n        .value();\n\n      $.when.apply($, saveAnalysisPromises).done(function () { // http://api.jquery.com/jQuery.when/\n        layerDefinitionsCollection.save({\n          success: function () {\n            layerDefinitionsCollection.trigger('layerMoved', movingLayer, from, to);\n          }\n        });\n      });\n    },\n\n    deleteLayer: function (id) {\n      var layerToDelete = layerDefinitionsCollection.get(id);\n      if (!layerToDelete.canBeDeletedByUser()) return;\n\n      var parentLayer;\n      var toDestroy = [];\n\n      // Iterate over each node in the list, to decide how to remove dependent objects or fold nodes (if possible)\n      // under another layer's linked nodes list.\n      var linkedNodesList = layerToDelete.ownedPrimaryAnalysisNodes();\n      var nodeDefModel;\n\n      for (var i = 0; i < linkedNodesList.length; i++) {\n        nodeDefModel = linkedNodesList[i];\n\n        parentLayer = layerDefinitionsCollection.findPrimaryParentLayerToAnalysisNode(nodeDefModel, {exclude: toDestroy});\n\n        // No parent layer? delete all dependent objects, since can't move current nodeDefModel elsewhere\n        if (!parentLayer) {\n          toDestroy.push(nodeDefModel);\n\n          layerDefinitionsCollection.each(function (layer) {\n            if (layer.containsNode(nodeDefModel)) {\n              if (!_.contains(toDestroy, layer)) {\n                toDestroy.push(layer);\n              }\n\n              widgetDefinitionsCollection.each(function (widget) {\n                if (!_.contains(toDestroy, widget) && widget.containsNode(nodeDefModel)) {\n                  toDestroy.unshift(widget);\n                }\n              });\n            }\n          });\n\n          continue; // to process all sequent nodes in the linekd list, and their (possibly) dependent objects\n        }\n\n        var newParentLinkedNodesList = parentLayer\n          .ownedPrimaryAnalysisNodes()\n          .concat(nodeDefModel.linkedListBySameLetter());\n\n        // Since will reassign ids from the start of list need to calculate which sequence id to start on\n        var idSequence = newParentLinkedNodesList.length;\n        var firstSequence = nodeIds.sequence(newParentLinkedNodesList[0].id);\n\n        // If first node has a higher sequence start from that one to avoid issues on renaming nodes\n        if (idSequence <= firstSequence) {\n          idSequence = firstSequence;\n        }\n\n        var lastNode = _.last(newParentLinkedNodesList);\n        if (lastNode.get('type') !== 'source') {\n          idSequence++; // to start on right id sequence, so last item in newParentLinkedNodesList gets assigned x1 as id, since its source will be a none-source node belong to another layer\n        }\n\n        // Reassign ids one-by-one, from start of list to avoid ids overlapping (e.g. [c2,c1]+[b2,b1] = [c4,c3,c2,c1])\n        var prevId = parentLayer.get('letter') + idSequence;\n        var moveNodeToParentLayer = function (node) {\n          var oldNodeId = node.id;\n          var newId = nodeIds.prev(prevId);\n\n          node.set('id', newId);\n\n          // Update any depending objects' source\n          analysisDefinitionNodesCollection.each(function (m) {\n            if (!_.contains(toDestroy, m)) {\n              m.changeSourceIds(oldNodeId, newId, true);\n            }\n          });\n          var maybeUpdateSource = function (m) {\n            if (m.get('source') === oldNodeId && !_.contains(toDestroy, m)) {\n              m.save({ source: newId }, { silent: true });\n            }\n          };\n          layerDefinitionsCollection.each(maybeUpdateSource);\n          widgetDefinitionsCollection.each(maybeUpdateSource);\n\n          prevId = newId;\n\n          return node;\n        };\n        var newParentLayerNode = moveNodeToParentLayer(newParentLinkedNodesList[0]);\n        _.rest(newParentLinkedNodesList).forEach(moveNodeToParentLayer);\n\n        parentLayer.save({source: newParentLayerNode.id});\n\n        break; // since the remaining nodes have been move to a parent layer\n      }\n\n      if (!_.contains(toDestroy, layerToDelete)) {\n        toDestroy.push(layerToDelete);\n      }\n\n      var promise = $.when.apply($, // http://api.jquery.com/jQuery.when/\n        _.chain(toDestroy)\n          .reduce(function (memo, m) {\n            memo.push(m);\n            var layerDefModel = layerDefinitionsCollection.get(m.id);\n            if (layerDefModel) { // Also delete analyses associated with layers that are being deleted\n              var aDefModel = analysisDefinitionsCollection.findAnalysisForLayer(layerDefModel);\n              if (aDefModel) {\n                memo.push(aDefModel);\n              }\n            }\n\n            return memo;\n          }, [])\n          .unique()\n          .map(function (m) {\n            m.set({avoidNotification: true}, {silent: true});\n            return m.destroy();\n          })\n          .value());\n\n      if (parentLayer) {\n        analysisDefinitionsCollection.saveAnalysisForLayer(parentLayer);\n      }\n      deleteOrphanedAnalyses();\n\n      return promise;\n    },\n\n    /**\n     * E.g. for styles, infowindows etc.\n     * @param {object} layerDefModel - layer-definition-model\n     * @param {object} options\n     */\n    saveLayer: function (layerDefModel, options) {\n      if (!layerDefModel) throw new Error('layerDefModel is required');\n\n      if (layerDefModel.isDataLayer()) {\n        analysisDefinitionsCollection.saveAnalysisForLayer(layerDefModel);\n      }\n\n      deleteOrphanedAnalyses();\n\n      var saveDefaultOptions = {\n        shouldPreserveAutoStyle: false\n      };\n      options = _.extend({}, saveDefaultOptions, options);\n\n      return layerDefModel.save(null, options);\n    }\n\n  };\n};\n",
    "var Backbone = require('backbone');\nvar GroupModel = require('./group-model');\n\n/**\n * Collection of a User's groups.\n */\nmodule.exports = Backbone.Collection.extend({\n  model: GroupModel,\n\n  initialize: function (models, opts) {\n    this.organization = opts.organization;\n  }\n});\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar OrganizationModel = require('./organization-model');\nvar UserGroups = require('./user-groups-collection');\nvar CustomBaselayersCollection = require('./custom-baselayers-collection');\n\n/**\n *  User model\n *\n */\n\nvar UserModel = Backbone.Model.extend({\n  urlRoot: function () {\n    var baseUrl = this._configModel.get('base_url');\n    return baseUrl + '/api/v1/users';\n  },\n\n  defaults: {\n    avatar_url: 'http://cartodb.s3.amazonaws.com/static/public_dashboard_default_avatar.png',\n    username: '',\n    email: ''\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n    this._configModel = opts.configModel;\n    attrs = attrs || {};\n\n    if (!_.isEmpty(this.get('organization'))) {\n      this._organizationModel = new OrganizationModel(\n        this.get('organization'),\n        {\n          configModel: this._configModel,\n          currentUserId: this.id\n        }\n      );\n    }\n\n    if (this.get('layers')) {\n      this.layers = new CustomBaselayersCollection(this.get('layers'), {\n        configModel: this._configModel,\n        currentUserId: this.id\n      });\n    }\n\n    this.groups = new UserGroups(attrs.groups, {\n      organization: this._organizationModel\n    });\n  },\n\n  isViewer: function () {\n    return this.get('viewer') === true;\n  },\n\n  isBuilder: function () {\n    return !this.isViewer();\n  },\n\n  canCreateDatasets: function () {\n    if (!this.get('remaining_byte_quota') || this.get('remaining_byte_quota') <= 0) {\n      return false;\n    }\n    return true;\n  },\n\n  hasCreateMapsFeature: function () {\n    return this.isBuilder();\n  },\n\n  canCreateTwitterDataset: function () {\n    return !((this.get('twitter').quota - this.get('twitter').monthly_use) <= 0 && this.get('twitter').hard_limit);\n  },\n\n  canStartTrial: function () {\n    return !this.isInsideOrg() && this.get('account_type') === 'FREE' && this.get('table_count') > 0;\n  },\n\n  isActionEnabled: function (action) {\n    return this.get('actions') && this.get('actions')[action];\n  },\n\n  canCreatePrivateDatasets: function () {\n    var actions = this.get('actions');\n    return actions && actions.private_tables;\n  },\n\n  isInsideOrg: function () {\n    if (this._organizationModel) {\n      return !!this._organizationModel.id || this.isOrgOwner();\n    }\n    return false;\n  },\n\n  isOrgOwner: function () {\n    if (this._organizationModel) {\n      return this._organizationModel.getOwnerId() === this.get('id');\n    }\n    return false;\n  },\n\n  isOrgAdmin: function () {\n    if (this._organizationModel) {\n      return this._organizationModel.isOrgAdmin(this);\n    }\n    return false;\n  },\n\n  featureEnabled: function (name) {\n    var featureFlags = this.get('feature_flags');\n    if (!featureFlags || featureFlags.length === 0 || !name) {\n      return false;\n    }\n    return _.contains(featureFlags, name);\n  },\n\n  upgradeContactEmail: function () {\n    if (this.isInsideOrg()) {\n      if (this.isOrgOwner()) {\n        return 'enterprise-support@carto.com';\n      } else {\n        return this._organizationModel.getOwnerEmail();\n      }\n    } else {\n      return 'support@carto.com';\n    }\n  },\n\n  nameOrUsername: function () {\n    return this.get('name') || this.get('username');\n  },\n\n  getMaxConcurrentImports: function () {\n    return (this.get('limits') && this.get('limits').concurrent_imports) || 1;\n  },\n\n  getSchemaName: function () {\n    return this.isInsideOrg() ? this.get('username') : 'public';\n  },\n\n  renderData: function (currentUser) {\n    var name = this.get('username');\n    if (currentUser && currentUser.id === this.id) {\n      name = _t('user.you');\n    }\n    return {\n      username: name,\n      avatar_url: this.get('avatar_url')\n    };\n  },\n\n  clone: function () {\n    var attrs = _.clone(this.attributes);\n    delete attrs.id;\n    return new UserModel(attrs, {\n      configModel: this._configModel\n    });\n  },\n\n  getOrganization: function () {\n    return this._organizationModel;\n  }\n});\n\nmodule.exports = UserModel;\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\n\n/**\n *  User Notifications\n *\n */\n\nvar UserNotifications = Backbone.Model.extend({\n  sync: function (method, model, options) {\n    return Backbone.sync('update', model, options);\n  },\n\n  url: function () {\n    var baseUrl = this._configModel.get('base_url');\n    return baseUrl + '/api/v3/notifications/' + this.get('key');\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.key) throw new Error('key is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._configModel = opts.configModel;\n    this.attributes = _.extend({ notifications: attrs }, { key: opts.key });\n  },\n\n  getKey: function (key) {\n    var notifications = this.get('notifications') || {};\n    return notifications[key];\n  },\n\n  setKey: function (key, value) {\n    var notifications = this.get('notifications') || {};\n    notifications[key] = value;\n    this.set('notifications', notifications);\n  }\n});\n\nmodule.exports = UserNotifications;\n",
    "var Backbone = require('backbone');\nvar syncAbort = require('./backbone/sync-abort');\n\n/**\n * A collection representing a set of users in a group.\n */\nmodule.exports = Backbone.Collection.extend({\n\n  sync: syncAbort,\n\n  initialize: function (models, opts) {\n    if (!opts.group) throw new Error('group is required');\n    this.group = opts.group;\n    this.configModel = opts.configModel;\n    this.organization = opts.organization;\n  },\n\n  url: function (method) {\n    var baseUrl = this.configModel.get('base_url');\n    var version = this.configModel.urlVersion('organizationGroups', method);\n    return baseUrl + '/api/' + version + '/organization/' + this.organization.id + '/groups/' + this.group.id + '/users';\n  },\n\n  parse: function (response) {\n    this.total_entries = response.total_entries;\n    this.total_user_entries = response.total_user_entries;\n\n    return response.users;\n  },\n\n  totalCount: function () {\n    return this.total_user_entries;\n  }\n\n});\n",
    "var $ = require('jquery');\nvar _ = require('underscore');\nvar UsersGroup = require('./users-group-collection');\n\n// This module fetch the user for every group present\n// in the ACL permission collection. The vizjson doesn't\n// provide and we need it for the sharing stats in the header.\n\nmodule.exports = {\n  track: function (opts) {\n    this.acl = opts.acl;\n    this.configModel = opts.configModel;\n    this.userModel = opts.userModel;\n\n    this.acl.on('reset', this.fetchUsers, this);\n    this.fetchUsers();\n  },\n\n  fetchUsers: function () {\n    var self = this;\n    var promises = [];\n\n    promises = _.map(this.acl.where({type: 'group'}), function (group) {\n      var entity = group.get('entity');\n      var deferred = new $.Deferred();\n\n      if (!entity.users || entity.users.length === 0) {\n        entity.users = new UsersGroup([], {\n          group: entity,\n          configModel: self.configModel,\n          organization: self.userModel.getOrganization()\n        });\n\n        entity.users.fetch({\n          success: function () {\n            deferred.resolve();\n          }\n        });\n      } else {\n        deferred.resolve();\n      }\n\n      return deferred.promise();\n    }, this);\n\n    $.when.apply($, promises).done(function () {\n      self.acl.trigger('fetch');\n    });\n  }\n};\n",
    "var Backbone = require('backbone');\nvar PermissionModel = require('./permission-model');\n\n/**\n * Model that represents a visualization (v3)\n *\n * Even though a table might be represented as a Visualization in some cases, please use TableModel if you want to work\n * with the table data instead of adding table-specific methods here.\n */\n\nvar PRIVACY_OPTIONS = ['PUBLIC', 'LINK', 'PRIVATE', 'PASSWORD'];\n\nmodule.exports = Backbone.Model.extend({\n  defaults: {\n    visChanges: 0\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._configModel = opts.configModel;\n\n    if (this.get('permission')) {\n      this._permissionModel = new PermissionModel(this.get('permission'), {\n        configModel: opts.configModel\n      });\n      this.unset('permission');\n    }\n  },\n\n  urlRoot: function () {\n    var baseUrl = this._configModel.get('base_url');\n    var version = this._configModel.urlVersion('visualization');\n    return baseUrl + '/api/' + version + '/viz';\n  },\n\n  mapcapsURL: function () {\n    var baseUrl = this._configModel.get('base_url');\n    return baseUrl + '/api/v3/viz/' + this.id + '/mapcaps';\n  },\n\n  embedURL: function () {\n    var baseUrl = this._configModel.get('base_url');\n    return baseUrl + '/builder/' + this.id + '/embed';\n  },\n\n  builderURL: function () {\n    var baseUrl = this._configModel.get('base_url');\n    return baseUrl + '/builder/' + this.id + '/';\n  },\n\n  vizjsonURL: function () {\n    var baseUrl = this._configModel.get('base_url');\n    var version = this._configModel.urlVersion('vizjson', 'read', 'v3');\n    return baseUrl + '/api/' + version + '/viz/' + this.id + '/viz.json';\n  },\n\n  stateURL: function () {\n    var baseUrl = this._configModel.get('base_url');\n    return baseUrl + '/api/v3/viz/' + this.id + '/state';\n  },\n\n  isVisualization: function () {\n    return this.get('type') === 'derived';\n  },\n\n  privacyOptions: function () {\n    return PRIVACY_OPTIONS;\n  },\n\n  recordChange: function () {\n    var visChanges = this.get('visChanges');\n    this.set('visChanges', visChanges + 1);\n  },\n\n  resetChanges: function () {\n    this.set('visChanges', 0);\n  },\n\n  getPermissionModel: function () {\n    return this._permissionModel;\n  }\n});\n",
    "var Backbone = require('backbone');\n\n/**\n *  Edit vis metadata dialog model\n *  to control if name and metadata\n *  are editable or not.\n *\n */\n\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    name: ''\n  },\n\n  validate: function (attrs) {\n    if (!attrs) return;\n    if (!attrs.name) {\n      return _t('components.modals.maps-metadata.validation.error.name');\n    }\n  }\n});\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar TableModel = require('./table-model');\nvar PermissionModel = require('./permission-model');\nvar SynchronizationModel = require('./synchronization-model');\nvar LikesModel = require('../components/likes/likes-model');\n\n/**\n * Model that represents a table visualization (v3)\n *\n */\n\nvar PRIVACY_OPTIONS = ['PUBLIC', 'LINK', 'PRIVATE'];\n\nmodule.exports = Backbone.Model.extend({\n\n  urlRoot: function () {\n    var baseUrl = this._configModel.get('base_url');\n    var version = this._configModel.urlVersion('visualization');\n    return baseUrl + '/api/' + version + '/viz';\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n    this._configModel = opts.configModel;\n\n    this._initModels();\n  },\n\n  _initModels: function () {\n    var d = this.get('table');\n    if (!_.isEmpty(this.get('external_source'))) {\n      d = this.get('external_source');\n    }\n    this._tableModel = new TableModel(d, {\n      configModel: this._configModel,\n      parse: true\n    });\n\n    if (this.get('permission')) {\n      this._permissionModel = new PermissionModel(this.get('permission'), {\n        configModel: this._configModel\n      });\n      this.unset('permission');\n    }\n\n    this._likesModel = LikesModel.newByVisData({\n      vis_id: this.id,\n      liked: this.get('liked'),\n      likes: this.get('likes'),\n      configModel: this._configModel\n    });\n\n    if (this.get('synchronization')) {\n      this._synchronizationModel = new SynchronizationModel(this.get('synchronization'), {\n        configModel: this._configModel\n      });\n      this._synchronizationModel.linkToTable(this._tableModel);\n    }\n  },\n\n  isVisualization: function () {\n    return false;\n  },\n\n  getTableModel: function () {\n    return this._tableModel;\n  },\n\n  getLikesModel: function () {\n    return this._likesModel;\n  },\n\n  getPermissionModel: function () {\n    return this._permissionModel;\n  },\n\n  getSynchronizationModel: function () {\n    return this._synchronizationModel;\n  },\n\n  vizjsonURL: function () {\n    var baseUrl = this._configModel.get('base_url');\n    var version = this._configModel.urlVersion('vizjson', 'read', 'v3');\n    return baseUrl + '/api/' + version + '/viz/' + this.id + '/viz.json';\n  },\n\n  isRaster: function () {\n    return this.get('kind') === 'raster';\n  },\n\n  datasetURL: function () {\n    var baseUrl = this._configModel.get('base_url');\n    var tableName = this.getTableModel().getUnquotedName();\n    return baseUrl + '/dataset/' + tableName;\n  },\n\n  privacyOptions: function () {\n    return PRIVACY_OPTIONS;\n  },\n\n  toJSON: function () {\n    return _.omit(this.attributes, 'synchronization', 'stats', 'table');\n  }\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar VisualizationTableModel = require('./visualization-table-model');\nvar VisualizationModel = require('./vis-definition-model');\n\n/**\n * A collection that holds visualization models\n */\nmodule.exports = Backbone.Collection.extend({\n\n  DEFAULT_FETCH_OPTIONS: {\n    type: 'table',\n    order: 'updated_at',\n    page: 1,\n    per_page: 20,\n    exclude_shared: false,\n    exclude_raster: true,\n    tags: '',\n    q: ''\n  },\n\n  model: function (d, opts) {\n    var configModel = opts.collection._configModel;\n    var Klass;\n\n    if (d.type !== 'derived') {\n      Klass = VisualizationTableModel;\n    } else {\n      Klass = VisualizationModel;\n    }\n\n    return new Klass(d, {\n      configModel: configModel\n    });\n  },\n\n  initialize: function (models, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n    this._configModel = opts.configModel;\n\n    // this.DEFAULT_FETCH_OPTIONS = _.extendOwn(this.DEFAULT_FETCH_OPTIONS, opts);\n    this._stats = {};\n  },\n\n  url: function () {\n    var version = this._configModel.urlVersion('visualization');\n    var baseUrl = this._configModel.get('base_url');\n    return baseUrl + '/api/' + version + '/viz';\n  },\n\n  // Overrides the default fetch, to use the internal methods to construct parmas\n  fetch: function (opts) {\n    this.trigger('loading', this);\n    opts = opts || {\n      data: {\n        // If reaches this code path it's because there were no opts given, i.e. should do a 'full fetch'\n        // Since there is no current way to really do a full fetch let's just set a really high number to get all\n        // TODO this is obviously bad for organization users, how can we do this differently\n        per_page: 1000\n      }\n    };\n    opts.data = _.extend({}, this.DEFAULT_FETCH_OPTIONS, opts.data);\n    return Backbone.Collection.prototype.fetch.call(this, opts);\n  },\n\n  getDefaultParam: function (param) {\n    return this.DEFAULT_FETCH_OPTIONS[param];\n  },\n\n  getTotalStat: function (attribute) {\n    return this._stats[attribute] || 0;\n  },\n\n  parse: function (res) {\n    this._stats = _.omit(res, 'visualizations');\n    return res.visualizations;\n  }\n});\n",
    "var Backbone = require('backbone');\n\n/**\n * Model that encapsulates params for fetching data in a cdb.admin.Visualizations collection.\n */\nmodule.exports = Backbone.Model.extend({\n  defaults: {\n    content_type: '',\n    page: 1,\n    q: '',\n    tag: '',\n    category: '',\n    shared: 'no',\n    locked: false,\n    liked: false,\n    library: false,\n    order: 'updated_at',\n    deepInsights: false\n  },\n\n  isSearching: function () {\n    return this.get('q') || this.get('tag');\n  },\n\n  isDatasets: function () {\n    return this.get('content_type') === 'datasets';\n  },\n\n  isMaps: function () {\n    return this.get('content_type') === 'maps';\n  },\n\n  isDeepInsights: function () {\n    return this.isMaps() && this.get('deepInsights');\n  }\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar syncAbort = require('./backbone/sync-abort');\nvar CartoColor = require('cartocolor');\n\nvar ATTRS_AT_TOP_LEVEL = ['id', 'layer_id', 'source', 'title', 'type', 'order'];\nvar STYLE_PROPERTIES = ['widget_style_definition', 'auto_style_definition', 'auto_style_allowed'];\n\nvar DEFAULT_WIDGET_COLOR = '#9DE0AD';\nvar TIME_SERIES_WIDGET_COLOR = '#F2CC8F';\nvar DEFAULT_WIDGET_STYLE = {\n  color: {\n    fixed: DEFAULT_WIDGET_COLOR,\n    opacity: 1\n  }\n};\n\nvar getDefaultCategoriesByRange = function (range) {\n  var widgetDomain = [];\n  for (var i = 0, l = range.length; i < l; i++) {\n    widgetDomain.push(_t('form-components.editors.fill.quantification.methods.category') + ' #' + (i + 1));\n  }\n  return widgetDomain;\n};\n\n/**\n * Widget definition Model\n */\nmodule.exports = Backbone.Model.extend({\n  defaults: {\n    sync_on_data_change: true,\n    sync_on_bbox_change: true,\n    auto_style_allowed: true,\n    widget_style_definition: DEFAULT_WIDGET_STYLE\n  },\n\n  /**\n   * @override {Backbone.prototype.sync} abort ongoing request if there is any\n   */\n  sync: syncAbort,\n\n  initialize: function (attrs, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.mapId) throw new Error('mapId is required');\n\n    this._configModel = opts.configModel;\n    this._mapId = opts.mapId;\n  },\n\n  urlRoot: function () {\n    // Since widget are stored under layers the collection can't figure out the URL by itself,\n    // thus each widget sets its own urlRoot\n    var baseUrl = this._configModel.get('base_url');\n    var layerId = this.get('layer_id');\n    return baseUrl + '/api/v3/maps/' + this._mapId + '/layers/' + layerId + '/widgets';\n  },\n\n  /**\n   * The API response format is a little bit different, and may\n   * @param {Object} r API response\n   * @return {Object} attrs to be set on model\n   */\n  parse: function (r) {\n    var attrs = _.defaults(\n      _.pick(r, ATTRS_AT_TOP_LEVEL),\n      r.options\n    );\n\n    if (!_.isEmpty(r.style)) {\n      var style = JSON.parse(JSON.stringify(r.style));\n      if (style.auto_style) {\n        var autoStyle = style.auto_style;\n        var autoStyleDefinition = autoStyle.definition;\n        if (autoStyleDefinition && autoStyleDefinition.color && autoStyleDefinition.color.quantification === 'category') {\n          autoStyle.definition.color.domain = getDefaultCategoriesByRange(autoStyleDefinition.color.range);\n        }\n        attrs.auto_style_definition = autoStyle.definition;\n        attrs.auto_style_allowed = autoStyle.allowed;\n      }\n      attrs.widget_style_definition = r.style.widget_style.definition;\n    }\n\n    attrs.source = attrs.source && attrs.source.id;\n\n    return attrs;\n  },\n\n  /**\n   * @override Backbone.Model.prototype.toJSON\n   * Formats the JSON to match the server-side API\n   */\n  toJSON: function () {\n    var o = _.pick(this.attributes, ATTRS_AT_TOP_LEVEL);\n    o.source = {id: this.get('source')};\n    o.options = _.omit(this.attributes, ATTRS_AT_TOP_LEVEL, STYLE_PROPERTIES);\n\n    if (this.get('widget_style_definition')) {\n      o.style = {\n        widget_style: {\n          definition: this.get('widget_style_definition')\n        }\n      };\n\n      o.style.auto_style = {\n        custom: !!this.get('auto_style_definition'),\n        allowed: this.get('auto_style_allowed')\n      };\n\n      if (this.get('auto_style_definition')) {\n        var autoStyleDefinition = JSON.parse(JSON.stringify(this.get('auto_style_definition')));\n        autoStyleDefinition.color = _.omit(autoStyleDefinition.color, 'domain', 'bins');\n        o.style.auto_style.definition = autoStyleDefinition;\n      }\n    }\n\n    return o;\n  },\n\n  changeType: function (type) {\n    var attrsForNewType = _\n      .defaults(\n        { type: type },\n        this.collection.attrsForThisType(type, this)\n    );\n\n    // Unset now irrelevant attributes due to the type change\n    _\n      .chain(this.attributes)\n      .keys()\n      .difference(\n        ['sync_on_data_change', 'sync_on_bbox_change'].concat(ATTRS_AT_TOP_LEVEL, STYLE_PROPERTIES),\n        _.keys(attrsForNewType)\n    )\n      .each(function (key) {\n        this.unset(key, { silent: true });\n      }, this);\n\n    this.set(attrsForNewType);\n  },\n\n  containsNode: function (otherNodeDefModel) {\n    if (!otherNodeDefModel) return false;\n\n    var sourceId = this.get('source');\n    var nodeDefModel = otherNodeDefModel.collection.get(sourceId);\n\n    return !!(sourceId === otherNodeDefModel.id ||\n    nodeDefModel && nodeDefModel.containsNode(otherNodeDefModel));\n  }\n\n}, {\n\n  getDefaultWidgetStyle: function (type) {\n    var widgetColor = type === 'time-series' ? TIME_SERIES_WIDGET_COLOR : DEFAULT_WIDGET_COLOR;\n    var defaultWidgetStyle = DEFAULT_WIDGET_STYLE;\n    defaultWidgetStyle.color.fixed = widgetColor;\n    return defaultWidgetStyle;\n  },\n\n  getDefaultAutoStyle: function (type, columnName) {\n    var defaultWidgetCategories = 10;\n    var defaultWidgetRampSize = 7;\n    var widgetRamp = _.first(\n      _.compact(\n        _.map(CartoColor, function (ramp) {\n          return _.clone(ramp[defaultWidgetRampSize]);\n        }, this)\n      )\n    );\n    var widgetCategories = _.clone(CartoColor.Prism[defaultWidgetCategories]);\n    var widgetRange = type === 'category' ? widgetCategories : widgetRamp;\n    var widgetQuantification = type === 'category' ? 'category' : 'quantiles';\n\n    var attrs = {\n      color: {\n        attribute: columnName,\n        quantification: widgetQuantification,\n        range: widgetRange\n      }\n    };\n\n    if (type === 'category') {\n      attrs.color.domain = getDefaultCategoriesByRange(widgetCategories);\n    } else {\n      attrs.color.bins = type === 'time-series' ? 256 : defaultWidgetRampSize;\n    }\n\n    return attrs;\n  }\n});\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar WidgetDefinitionModel = require('./widget-definition-model');\n\n/**\n * Collection of widget definitions, synhronizes the internal definitions and the widget models.\n */\nmodule.exports = Backbone.Collection.extend({\n  comparator: 'order',\n\n  model: function (d, opts) {\n    var self = opts.collection;\n    d.order = !_.isUndefined(d.order) ? d.order : self._getNextOrder();\n    var m = new WidgetDefinitionModel(d, {\n      parse: true, // make sure data is structured as expected\n      collection: self,\n      configModel: self._configModel,\n      mapId: self._mapId\n    });\n    return m;\n  },\n\n  initialize: function (models, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.mapId) throw new Error('mapId is required');\n    if (!opts.layerDefinitionsCollection) throw new Error('layerDefinitionsCollection is required');\n\n    this._configModel = opts.configModel;\n    this._mapId = opts.mapId;\n    this._layerDefinitionsCollection = opts.layerDefinitionsCollection;\n\n    this._bindLayerStyleChanges();\n\n    this._attrsForThisTypeMap = {\n      formula: function (m) {\n        return {\n          column: m.get('column'),\n          operation: m.get('operation') || 'max'\n        };\n      },\n      category: function (m) {\n        var columnName = m.get('column');\n        return {\n          aggregation: m.get('aggregation') || 'count',\n          aggregation_column: m.get('aggregation_column') || columnName,\n          column: columnName,\n          widget_style_definition: m.get('widget_style_definition') || WidgetDefinitionModel.getDefaultWidgetStyle('category'),\n          auto_style_definition: undefined\n        };\n      },\n      histogram: function (m) {\n        return {\n          column: m.get('column'),\n          bins: m.get('bins') || 10,\n          widget_style_definition: m.get('widget_style_definition') || WidgetDefinitionModel.getDefaultWidgetStyle('histogram'),\n          auto_style_definition: undefined\n        };\n      },\n      'time-series': function (m) {\n        return {\n          column: m.get('column'),\n          bins: m.get('bins') || 256,\n          widget_style_definition: m.get('widget_style_definition') || WidgetDefinitionModel.getDefaultWidgetStyle('time-series')\n        };\n      }\n    };\n  },\n\n  url: function () {\n    throw new Error('Not possible, see WidgetDefinitionModel.urlRoot');\n  },\n\n  _bindLayerStyleChanges: function () {\n    this._layerDefinitionsCollection.bind('change:style_properties', this._onLayerStyleChanged, this);\n  },\n\n  _onLayerStyleChanged: function (layerDefModel) {\n    var styleModel = layerDefModel.styleModel;\n    var isAllowed = styleModel && styleModel.canApplyAutoStyle();\n    var affectedWidgets = this.where({ layer_id: layerDefModel.id });\n\n    _.each(affectedWidgets, function (widgetDefModel) {\n      var isNowAllowed = widgetDefModel.get('auto_style_allowed');\n      var willBeAllowed = isAllowed;\n      var attrs = {\n        auto_style_allowed: willBeAllowed\n      };\n\n      if (isNowAllowed !== willBeAllowed) {\n        // if autostyle is not allow, we should clean auto_style_definition\n        if (willBeAllowed === false) {\n          attrs = _.extend(attrs, { auto_style_definition: '' });\n        }\n        widgetDefModel.save(attrs);\n      }\n    });\n  },\n\n  attrsForThisType: function (newType, m) {\n    return this._attrsForThisTypeMap[newType](m);\n  },\n\n  isThereTimeSeries: function (opts) {\n    opts = opts || {};\n\n    var timeSeries = opts.animated ? this.findWhere({ type: 'time-series', animated: opts.animated }) : this.findWhere({ type: 'time-series' });\n    return !!timeSeries;\n  },\n\n  isThereOtherWidgets: function () {\n    return !!this.find(function (widgetModel) {\n      return widgetModel.get('type') !== 'time-series';\n    });\n  },\n\n  _getNextOrder: function () {\n    if (this.isEmpty()) {\n      return 0;\n    } else {\n      var lastItemByOrder = this.max(function (mdl) {\n        return mdl.get('order');\n      });\n      return lastItemByOrder.get('order') + 1;\n    }\n  },\n\n  widgetsOwnedByLayer: function (layerId) {\n    var widgets = this.where({ layer_id: layerId });\n\n    return widgets.length;\n  }\n\n});\n",
    "var _ = require('underscore');\n\nvar PROXY_URL = 'https://cartodb-wms.global.ssl.fastly.net/api';\nvar PROXY_TILES = 'https://cartodb-wms.global.ssl.fastly.net/mapproxy';\nvar METHOD_TO_URL = {\n  'read': '/check',\n  'create': '/add'\n};\nvar SUPPORTED_MATRIX_SETS = [\n  'EPSG:4326',\n  'EPSG:4258'\n];\n\nfunction WMSService () {\n  this._wms_url = null;\n}\n\nWMSService.prototype.generateURL = function (opts) {\n  var req = PROXY_URL + METHOD_TO_URL[opts.method];\n  var url = this._wms_url;\n\n  var parser = document.createElement('a');\n\n  parser.href = url;\n\n  var params = parser.search.substr(1).split('&');\n\n  var hasCapabilities = _.find(params, function (p) { return p.toLowerCase().indexOf('request=getcapabilities') !== -1; });\n  var hasService = _.find(params, function (p) { return p.toLowerCase().indexOf('service=wms') !== -1; });\n\n  // If the user didn't provided the necessary params, let's add them\n\n  if (!hasCapabilities) {\n    params.push('request=GetCapabilities');\n  }\n\n  if (!hasService) {\n    params.push('service=WMS');\n  }\n\n  url += '?' + params.join('&');\n  req += '?url=' + encodeURIComponent(url);\n\n  var isWMTS = opts.type === 'wmts';\n  req += '&type=' + (isWMTS ? 'wmts' : 'wms');\n\n  if (opts.method === 'create') {\n    if (opts.layer && opts.srs) {\n      req += '&layer=' + opts.layer;\n      req += '&srs=EPSG:' + opts.srs[0].split(':')[1];\n    } else if (isWMTS && opts.layer && opts.matrix_sets.length > 0) {\n      req += '&layer=' + opts.layer;\n      req += '&matrix_set=' + this.supportedMatrixSets(opts.matrix_sets || [])[0];\n    }\n  }\n\n  return req;\n};\n\nWMSService.prototype.getFetchLayersURL = function () {\n  return this.generateURL({\n    method: 'read'\n  });\n};\n\nWMSService.prototype.saveLayerURL = function (opts) {\n  var createOpts = _.extend({\n    method: 'create'\n  }, opts);\n\n  return this.generateURL(createOpts);\n};\n\nWMSService.prototype.supportedMatrixSets = function (matrixSets) {\n  return _.intersection(matrixSets, SUPPORTED_MATRIX_SETS);\n};\n\nWMSService.prototype.getProxyTilesURL = function () {\n  return PROXY_TILES;\n};\n\nWMSService.prototype.setUrl = function (url) {\n  this._wms_url = url;\n};\n\nmodule.exports = WMSService;\n",
    "var $ = require('jquery');\nvar _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar ConfirmationView = require('../components/modals/confirmation/modal-confirmation-view');\nvar templateConfirmation = require('./start-edition-confirmation.tpl');\nvar templateEditGeometry = require('./edit-geometry.tpl');\nvar TipsyTooltipView = require('../components/tipsy-tooltip-view');\nvar Notifier = require('../components/notifier/notifier');\n\nvar EditFeatureOverlay = CoreView.extend({\n\n  MAX_VERTEXES: 1000,\n\n  className: 'CDB-Overlay',\n  type: 'custom',\n\n  events: {\n    'click .js-edit-feature': '_onEditButtonClicked'\n  },\n\n  initialize: function (options) {\n    if (!options.map) throw new Error('map is required');\n    if (!options.mapModeModel) throw new Error('mapModeModel is required');\n    if (!options.modals) throw new Error('modals is required');\n\n    this._map = options.map;\n    this._mapModeModel = options.mapModeModel;\n    this._modals = options.modals;\n\n    this._onEditButtonClicked = this._onEditButtonClicked.bind(this);\n    this.hide = this.hide.bind(this);\n    this.show = this.show.bind(this);\n\n    this._map.on('change:center', this.hide, this);\n    this._map.on('change:zoom', this.hide, this);\n\n    this._position = {\n      x: 0,\n      y: 0\n    };\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    var isEditable = this._isEditable();\n\n    this.$el.html(templateEditGeometry({\n      isEditable: isEditable,\n      hasAnalyses: this._hasAnalyses(),\n      isCustomQueryApplied: this._isCustomQueryApplied(),\n      isReadOnly: this._isReadOnly(),\n      disabled: this._disabledTooltip()\n    }));\n\n    if (!isEditable) {\n      var tooltip = new TipsyTooltipView({\n        el: this.$('.js-edit-feature'),\n        gravity: 's',\n        offset: 0,\n        title: function () {\n          return $(this).data('tooltip');\n        }\n      });\n      this.addView(tooltip);\n      this.undelegateEvents();\n    } else {\n      this.delegateEvents();\n    }\n\n    return this;\n  },\n\n  _disabledTooltip: function () {\n    var disabledLayerType;\n\n    if (this._hasAnalyses()) {\n      disabledLayerType = _t('editor.edit-feature.analysis');\n    } else if (this._isCustomQueryApplied()) {\n      disabledLayerType = _t('editor.edit-feature.custom-sql');\n    } else if (this._isReadOnly()) {\n      disabledLayerType = _t('editor.edit-feature.sync');\n    }\n\n    return _t('editor.edit-feature.disabled', { disabledLayerType: disabledLayerType });\n  },\n\n  _isEditable: function () {\n    return this._featureDefinition && this._featureDefinition.isEditable();\n  },\n\n  _hasAnalyses: function () {\n    return this._featureDefinition && this._featureDefinition.hasAnalyses();\n  },\n\n  _isCustomQueryApplied: function () {\n    return this._featureDefinition && this._featureDefinition.isCustomQueryApplied();\n  },\n\n  _isReadOnly: function () {\n    return this._featureDefinition && this._featureDefinition.isReadOnly();\n  },\n\n  hide: function (event) {\n    this.killEvent(event);\n    this.$el.hide();\n    $(document).off('click', this.hide);\n  },\n\n  show: function () {\n    this.$el.css({\n      width: '20px',\n      top: this._position.y,\n      left: this._position.x,\n      position: 'absolute'\n    });\n    this.$el.show();\n\n    $(document).on('click', this.hide);\n  },\n\n  setPosition: function (position) {\n    this._position = position;\n  },\n\n  setFeatureDefinition: function (featureDefinition) {\n    this._featureDefinition = featureDefinition;\n  },\n\n  getFeatureDefinition: function () {\n    return this._featureDefinition;\n  },\n\n  _getGeomCount: function (geojson) {\n    var count = 0;\n\n    _.each(geojson.coordinates, function (pol1, i) {\n      _.each(pol1, function (pol2, j) {\n        count = count + pol2.length;\n      });\n    });\n\n    return count;\n  },\n\n  _confirmStopEdition: function () {\n    var self = this;\n\n    this._modals.create(function (modalModel) {\n      return new ConfirmationView({\n        modalModel: modalModel,\n        template: templateConfirmation,\n        runAction: self._startEdition.bind(self)\n      });\n    });\n  },\n\n  _startEdition: function () {\n    // Exit editing feature mode to re-enter this mode again\n    if (this._mapModeModel.isEditingFeatureMode()) {\n      this._mapModeModel.enterViewingMode();\n    }\n    this._mapModeModel.enterEditingFeatureMode(this._featureDefinition);\n  },\n\n  _onEditButtonClicked: function (ev) {\n    this.killEvent(ev);\n    this.hide();\n\n    if (!this._isEditable()) {\n      return false;\n    }\n\n    var notification = Notifier.addNotification({\n      status: 'loading',\n      info: _t('notifications.edit-feature.edit.loading'),\n      closable: false\n    });\n\n    this._featureDefinition && this._featureDefinition.fetch({\n      success: function () {\n        Notifier.removeNotification(notification);\n\n        var geojson = JSON.parse(this._featureDefinition.get('the_geom'));\n\n        if (this._getGeomCount(geojson) > this.MAX_VERTEXES) {\n          this._confirmStopEdition();\n        } else {\n          this._startEdition();\n        }\n      }.bind(this),\n      error: function () {\n        notification.set({\n          status: 'error',\n          info: _t('notifications.edit-feature.edit.error'),\n          closable: true,\n          delay: Notifier.DEFAULT_DELAY\n        });\n      }\n    });\n  }\n});\n\nmodule.exports = EditFeatureOverlay;\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<button class=\"CDB-Attribution-button js-edit-feature\\n  ';\n if (!isEditable) { \n__p+='is-disabled';\n } \n__p+='\\n  ';\n if (hasAnalyses) { \n__p+='t-hasAnalyses';\n } \n__p+='\\n  ';\n if (isCustomQueryApplied) { \n__p+='t-isCustomQueryApplied';\n } \n__p+='\\n  ';\n if (isReadOnly) { \n__p+='t-isReadOnly';\n } \n__p+='\" data-tooltip=\"'+\n((__t=( disabled ))==null?'':_.escape(__t))+\n'\">\\n  <svg width=\"32\" height=\"32\" viewBox=\"0 0 32 32\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M10 22.91l1.217-3.65 8.924-8.924c.448-.448 1.177-.448 1.624 0l.81.81c.448.448.448 1.175 0 1.623l-8.923 8.924L10 22.91zm10.952-8.518l-2.434-2.434 2.434 2.434zm-7.3 7.302l-2.435-2.434 2.434 2.434z\" stroke=\"#636D72\" fill=\"none\" fill-rule=\"evenodd\"/></svg>\\n</button>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar LegendFactory = require('../editor/layers/layer-content-views/legend/legend-factory');\nvar LegendColorHelper = require('../editor/layers/layer-content-views/legend/form/legend-color-helper');\nvar DEFAULT_BUBBLES_COLOR = '#999999';\n\nvar onChange = function (layerDefModel) {\n  var styleModel = layerDefModel.styleModel;\n  var autoStyle = layerDefModel.get('autoStyle');\n  var isAutoStyleApplied = autoStyle != null && autoStyle !== false;\n  var fill;\n  var stroke;\n  var color;\n  var size;\n\n  function createColorLegend (layerDefModel, color) {\n    var styleModel = layerDefModel.styleModel;\n\n    if (styleModel.get('type') === 'animation') {\n      LegendFactory.removeLegend(layerDefModel, 'choropleth', function () {\n        LegendFactory.removeLegend(layerDefModel, 'custom_choropleth', function () {\n          LegendFactory.createLegend(layerDefModel, 'category', {title: color.attribute});\n        });\n      });\n    } else if (styleModel.get('type') === 'heatmap') {\n      LegendFactory.removeLegend(layerDefModel, 'category', function () {\n        LegendFactory.removeLegend(layerDefModel, 'choropleth', function () {\n          LegendFactory.createLegend(layerDefModel, 'custom_choropleth', {title: _t('editor.legend.pixel-title')});\n        });\n      });\n    } else {\n      if ((color.attribute_type && color.attribute_type === 'string') || color.quantification === 'category') {\n        LegendFactory.removeLegend(layerDefModel, 'choropleth', function () {\n          LegendFactory.removeLegend(layerDefModel, 'custom_choropleth', function () {\n            if (!isAutoStyleApplied) {\n              LegendFactory.createLegend(layerDefModel, 'category', {title: color.attribute});\n            } else {\n              LegendFactory.removeLegend(layerDefModel, 'category');\n            }\n          });\n        });\n      } else {\n        LegendFactory.removeLegend(layerDefModel, 'category', function () {\n          LegendFactory.removeLegend(layerDefModel, 'custom_choropleth', function () {\n            if (!isAutoStyleApplied) {\n              LegendFactory.createLegend(layerDefModel, 'choropleth', {title: color.attribute});\n            } else {\n              LegendFactory.removeLegend(layerDefModel, 'choropleth');\n            }\n          });\n        });\n      }\n    }\n  }\n\n  if (!styleModel) return;\n\n  fill = styleModel.get('fill');\n  stroke = styleModel.get('stroke');\n\n  if (!fill && !stroke || _.isEmpty(fill) && _.isEmpty(stroke)) return;\n\n  color = fill && fill.color || stroke && stroke.color;\n  size = fill && fill.size || stroke && stroke.size;\n\n  if (LegendFactory.isEnabledType('size')) {\n    if (size && size.attribute !== undefined) {\n      var attrs = { title: size.attribute };\n\n      if (!isAutoStyleApplied) {\n        // Do not apply the fill color of an autostyle ramp\n        attrs.fillColor = color && (color.fixed || color.range)\n          ? LegendColorHelper.getBubbles(color).color.fixed\n          : DEFAULT_BUBBLES_COLOR;\n      }\n\n      LegendFactory.createLegend(layerDefModel, 'bubble', attrs);\n    } else {\n      LegendFactory.removeLegend(layerDefModel, 'bubble');\n    }\n  }\n\n  if (LegendFactory.isEnabledType('color')) {\n    if (color && color.attribute !== undefined) {\n      var hasCustomLegend = LegendFactory.find(layerDefModel, 'custom');\n\n      if (!hasCustomLegend) {\n        createColorLegend(layerDefModel, color);\n      }\n    } else {\n      LegendFactory.removeLegend(layerDefModel, 'category');\n      LegendFactory.removeLegend(layerDefModel, 'choropleth');\n      LegendFactory.removeLegend(layerDefModel, 'custom_choropleth');\n    }\n  }\n};\n\nmodule.exports = {\n  track: function (layerDefModel) {\n    var onStyleChange = function () {\n      onChange(layerDefModel);\n    };\n\n    var styleModel = layerDefModel.styleModel;\n\n    layerDefModel.on('change:cartocss', onChange);\n    styleModel && styleModel.on('style:update', onStyleChange);\n\n    layerDefModel.on('destroy', function () {\n      layerDefModel.off('change:cartocss', onChange);\n      styleModel && styleModel.off('style:update', onStyleChange);\n    });\n  }\n};\n",
    "var infowindowNoneTemplate = require('../mustache-templates/infowindows/infowindow_none.tpl');\n\nmodule.exports = function linkLayerInfowindow (layerDef, visMap) {\n  if (!layerDef.infowindowModel) return;\n\n  function updateInfowindow (infowindowModel) {\n    var attrs = JSON.parse(JSON.stringify(infowindowModel.attributes));\n\n    if (infowindowModel.isEmptyTemplate()) {\n      var node = layerDef.getAnalysisDefinitionNodeModel();\n\n      var cartodb_id = node && node.querySchemaModel.columnsCollection.find(function (m) {\n        return m.get('name') === 'cartodb_id';\n      });\n\n      if (cartodb_id) {\n        attrs.fields = [{\n          name: 'cartodb_id',\n          title: true,\n          position: 0\n        }];\n\n        attrs.template = infowindowNoneTemplate({\n          title: _t('editor.layers.infowindow.no-fields'),\n          subtitle: _t('editor.layers.infowindow.select-fields')\n        });\n      }\n    }\n\n    var infowindow = visMap.getLayerById(layerDef.id).infowindow;\n    // some layers like basemaps, torque, or aggregated don't have infowindows so skip update\n    if (infowindow) {\n      infowindow.update(attrs);\n    }\n  }\n\n  function onChange (infowindowModel) {\n    updateInfowindow(infowindowModel);\n  }\n\n  updateInfowindow(layerDef.infowindowModel);\n\n  layerDef.infowindowModel.bind('change', onChange);\n\n  layerDef.bind('destroy', function () {\n    layerDef.infowindowModel.unbind('change', onChange);\n  });\n};\n",
    "module.exports = function linkLayerTooltip (layerDef, visMap) {\n  if (!layerDef.tooltipModel) return;\n\n  function onChange (tooltipModel) {\n    var attrs = JSON.parse(JSON.stringify(tooltipModel.attributes));\n    var tooltip = visMap.getLayerById(layerDef.id).tooltip;\n    // some layers like basemaps, torque, or aggregated don't have infowindows\n    // so skip update\n    tooltip && tooltip.update(attrs);\n  }\n\n  var tooltipModel = layerDef.tooltipModel;\n  if (tooltipModel.get('template_name')) {\n    tooltipModel.setTemplate(tooltipModel.get('template_name'));\n  }\n\n  tooltipModel.bind('change', onChange);\n\n  layerDef.bind('destroy', function () {\n    tooltipModel.unbind('change', onChange);\n  });\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-justifyCenter\">\\n  <div class=\"Modal-inner Modal-inner--grid u-flex u-justifyCenter\">\\n    <div class=\"Modal-icon\">\\n      <svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\">\\n        <path d=\"M1 25l2.262-6.787 16.59-16.59c.832-.83 2.185-.83 3.016 0l1.508 1.51c.83.83.83 2.182 0 3.015l-16.59 16.59L1 25zM21.36 9.165L16.835 4.64l4.525 4.525zM7.787 22.738l-4.525-4.525 4.525 4.525z\" stroke=\"#F19243\" fill=\"none\" fill-rule=\"evenodd\"/>\\n      </svg>\\n    </div>\\n    <div>\\n      <h2 class=\" CDB-Text CDB-Size-huge is-light u-bSpace--m\">'+\n((__t=( _t('components.modals.edit-feature.confirmation.title') ))==null?'':_.escape(__t))+\n'</h2>\\n      <p class=\"CDB-Text CDB-Size-medium u-altTextColor\">'+\n((__t=( _t('components.modals.edit-feature.confirmation.desc') ))==null?'':_.escape(__t))+\n'</p>\\n      <ul class=\"Modal-listActions u-flex u-alignCenter\">\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--secondary CDB-Button--big js-cancel\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">\\n              '+\n((__t=( _t('components.modals.edit-feature.confirmation.cancel') ))==null?'':_.escape(__t))+\n'\\n            </span>\\n          </button>\\n        </li>\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-confirm\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">'+\n((__t=( _t('components.modals.edit-feature.confirmation.continue') ))==null?'':_.escape(__t))+\n'</span>\\n          </button>\\n        </li>\\n      </ul>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar $ = require('jquery');\nvar linkLayerInfowindow = require('./deep-insights-integration/link-layer-infowindow');\nvar linkLayerTooltip = require('./deep-insights-integration/link-layer-tooltip');\nvar LegendManager = require('./deep-insights-integration/legend-manager');\nvar AnalysisNotifications = require('./editor/layers/analysis-views/analysis-notifications');\nvar WidgetsNotifications = require('./widgets-notifications');\nvar AnalysisOnboardingLauncher = require('./components/onboardings/analysis/analysis-launcher');\nvar NotificationErrorMessageHandler = require('./editor/layers/notification-error-message-handler');\nvar VisNotifications = require('./vis-notifications');\nvar WidgetsService = require('./editor/widgets/widgets-service');\nvar WidgetDefinitionModel = require('./data/widget-definition-model');\nvar FeatureDefinitionModel = require('./data/feature-definition-model');\nvar Notifier = require('./components/notifier/notifier');\nvar layerTypesAndKinds = require('./data/layer-types-and-kinds');\nvar basemapProvidersAndCategories = require('./data/basemap-providers-and-categories');\nvar getStylesWithoutAutostyles = require('./helpers/styles-without-autostyle');\n\n/**\n * Integration between various data collections/models with cartodb.js and deep-insights.\n */\nvar F = function (opts) {\n  if (!opts.deepInsightsDashboard) throw new Error('deepInsightsDashboard is required');\n  if (!opts.analysisDefinitionNodesCollection) throw new Error('analysisDefinitionNodesCollection is required');\n  if (!opts.analysisDefinitionsCollection) throw new Error('analysisDefinitionsCollection is required');\n  if (!opts.layerDefinitionsCollection) throw new Error('layerDefinitionsCollection is required');\n  if (!opts.widgetDefinitionsCollection) throw new Error('widgetDefinitionsCollection is required');\n  if (!opts.legendDefinitionsCollection) throw new Error('legendDefinitionsCollection is required');\n  if (!opts.visDefinitionModel) throw new Error('visDefinitionModel is required');\n  if (!opts.userModel) throw new Error('userModel is required');\n  if (!opts.onboardings) throw new Error('onboardings is required');\n  if (!opts.mapDefinitionModel) throw new Error('mapDefinitionModel is required');\n  if (!opts.stateDefinitionModel) throw new Error('stateDefinitionModel is required');\n  if (!opts.overlayDefinitionsCollection) throw new Error('overlayDefinitionsCollection is required');\n  if (!opts.mapModeModel) throw new Error('mapModeModel is required');\n  if (!opts.configModel) throw new Error('configModel is required');\n  if (!opts.editorModel) throw new Error('editorModel is required');\n  if (!opts.editFeatureOverlay) throw new Error('editFeatureOverlay is required');\n\n  this._diDashboard = opts.deepInsightsDashboard;\n  this._analysisDefinitionNodesCollection = opts.analysisDefinitionNodesCollection;\n  this._analysisDefinitionsCollection = opts.analysisDefinitionsCollection;\n  this._layerDefinitionsCollection = opts.layerDefinitionsCollection;\n  this._visDefinitionModel = opts.visDefinitionModel;\n  this._stateDefinitionModel = opts.stateDefinitionModel;\n  this._userModel = opts.userModel;\n  this._mapDefinitionModel = opts.mapDefinitionModel;\n  this._onboardings = opts.onboardings;\n  this._overlayDefinitionsCollection = opts.overlayDefinitionsCollection;\n  this._mapModeModel = opts.mapModeModel;\n  this._configModel = opts.configModel;\n  this._widgetDefinitionsCollection = opts.widgetDefinitionsCollection;\n  this._editorModel = opts.editorModel;\n  this._editFeatureOverlay = opts.editFeatureOverlay;\n  this._legendsDefinitionCollection = opts.legendDefinitionsCollection;\n\n  this._getStylesWithoutAutostyles = getStylesWithoutAutostyles();\n  this._layerDefinitionsCollection.each(this._linkLayerErrors, this);\n\n  opts.analysisDefinitionNodesCollection.each(function (analysisDefinitionNode) {\n    analysisDefinitionNode.queryRowsCollection.on('remove', this._invalidateMap, this);\n  }, this);\n\n  this._analysisDefinitionNodesCollection.on('add', this._analyseDefinitionNodeAdded, this);\n  this._analysisDefinitionNodesCollection.on('change', this._analyseDefinitionNode, this);\n  this._analysisDefinitionNodesCollection.on('change:id', this._onAnalysisDefinitionNodeIdChanged, this);\n  this._analysisDefinitionNodesCollection.on('remove', this._onAnalysisDefinitionNodeRemoved, this);\n  this._analysisDefinitionsCollection.on('add change:node_id sync', this._analyseDefinition, this);\n\n  opts.layerDefinitionsCollection.on('add', this._onLayerDefinitionAdded, this);\n  opts.layerDefinitionsCollection.on('sync', this._onLayerDefinitionSynced, this);\n  opts.layerDefinitionsCollection.on('change', this._onLayerDefinitionChanged, this);\n  opts.layerDefinitionsCollection.on('remove', this._onLayerDefinitionRemoved, this);\n  opts.layerDefinitionsCollection.on('layerMoved', this._onLayerDefinitionMoved, this);\n  opts.layerDefinitionsCollection.on('baseLayerChanged', this._onBaseLayerChanged, this);\n\n  opts.layerDefinitionsCollection.each(function (layerDefModel) {\n    LegendManager.track(layerDefModel);\n\n    linkLayerInfowindow(layerDefModel, this.visMap());\n    linkLayerTooltip(layerDefModel, this.visMap());\n\n    if (layerDefModel.has('source')) {\n      this._resetStylesIfNoneApplied(layerDefModel);\n    }\n  }, this);\n\n  opts.legendDefinitionsCollection.on('add', this._onLegendDefinitionAdded, this);\n  opts.legendDefinitionsCollection.on('change', this._onLegendDefinitionChanged, this);\n  opts.legendDefinitionsCollection.on('remove', this._onLegendDefinitionRemoved, this);\n\n  opts.widgetDefinitionsCollection.on('add', this._onWidgetDefinitionAdded, this);\n  opts.widgetDefinitionsCollection.on('sync', this._onWidgetDefinitionSynced, this);\n  opts.widgetDefinitionsCollection.on('change', this._onWidgetDefinitionChanged, this);\n  opts.widgetDefinitionsCollection.on('destroy', this._onWidgetDefinitionDestroyed, this);\n  opts.widgetDefinitionsCollection.on('add remove reset', this._invalidateSize, this);\n\n  opts.widgetDefinitionsCollection.each(this._onWidgetDefinitionAdded, this);\n\n  opts.overlayDefinitionsCollection.on('add', this._onOverlayDefinitionAdded, this);\n  opts.overlayDefinitionsCollection.on('remove', this._onOverlayDefinitionRemoved, this);\n\n  opts.mapDefinitionModel.on('change:minZoom change:maxZoom', _.debounce(this._onMinMaxZoomChanged.bind(this), 300), this);\n  opts.mapDefinitionModel.on('change:scrollwheel', this._onScrollWheelChanged, this);\n  opts.mapDefinitionModel.on('change:legends', this._onLegendsChanged, this);\n  opts.mapDefinitionModel.on('change:layer_selector', this._onLayerSelectorChanged, this);\n\n  this._onScrollWheelChanged();\n\n  WidgetsNotifications.track(this._widgetDefinitionsCollection);\n\n  opts.editorModel.on('change:settingsView', this._onEditorSettingsChanged, this);\n\n  this._analysisDefinitionsCollection.each(this._analyseDefinition, this);\n  this._vis().on('reload', this._visReload, this);\n  this._vis().on('change:error', this._visErrorChange, this);\n\n  var saveStateDefinition = _.debounce(this._saveStateDefinition.bind(this), 500);\n  this._diDashboard.onStateChanged(saveStateDefinition);\n  this._stateDefinitionModel.on('boundsSet', this._onBoundsSet, this);\n\n  // In order to sync layer selector and layer visbility\n  this._getLayers().on('change:visible', function (layer, visible) {\n    var layerDefModel = opts.layerDefinitionsCollection.findWhere({id: layer.id});\n    if (layerDefModel) {\n      if (layerDefModel.get('visible') !== visible) {\n        layerDefModel.save({visible: visible});\n      }\n    }\n  }, this);\n\n  VisNotifications.track(this._vis());\n\n  opts.mapModeModel.on('change:mode', this._onMapModeChanged, this);\n\n  this.visMap().on('featureClick', this._onFeatureClicked, this);\n  this.visMap().on('mapViewSizeChanged', this._setMapViewSize, this);\n\n  // Needed to image export feature\n  this._getVisMetadata();\n  this._setMapConverters();\n  this._setMapViewSize();\n};\n\nF.prototype._onFeatureClicked = function (event) {\n  var layerId = event.layer.id;\n  var featureId = event.feature.cartodb_id;\n  var position = event.position;\n  var layerDefinitionModel = this._layerDefinitionsCollection.get(layerId);\n  var isFeatureBeingEdited = false;\n\n  var featureDefinition = new FeatureDefinitionModel({\n    cartodb_id: featureId\n  }, {\n    configModel: this._configModel,\n    layerDefinitionModel: layerDefinitionModel,\n    userModel: this._userModel\n  });\n\n  if (this._mapModeModel.isEditingFeatureMode()) {\n    var editingFeatureDefinitionModel = this._mapModeModel.getFeatureDefinition();\n    isFeatureBeingEdited = featureDefinition.isEqual(editingFeatureDefinitionModel);\n  }\n\n  if (!isFeatureBeingEdited) {\n    this._editFeatureOverlay.setPosition(position);\n    this._editFeatureOverlay.setFeatureDefinition(featureDefinition);\n    this._editFeatureOverlay\n      .render()\n      .show();\n  }\n};\n\nF.prototype._onMapModeChanged = function (mapModeModel) {\n  var map = this.visMap();\n  var featureDefinition;\n  var geometry;\n\n  // VIEWING MODE\n  if (mapModeModel.isViewingMode()) {\n    map.stopDrawingGeometry();\n    map.stopEditingGeometry();\n  }\n\n  // DRAWING FEATURES\n  if (mapModeModel.isDrawingFeatureMode()) {\n    featureDefinition = mapModeModel.getFeatureDefinition();\n    if (featureDefinition.isPoint()) {\n      geometry = map.drawPoint();\n    } else if (featureDefinition.isLine()) {\n      geometry = map.drawPolyline();\n    } else if (featureDefinition.isPolygon()) {\n      geometry = map.drawPolygon();\n    }\n\n    if (!geometry) {\n      throw new Error(\"couldn't get geometry for feature of type \" + featureDefinition.get('type'));\n    }\n  }\n\n  // EDITING FEATURES\n  if (mapModeModel.isEditingFeatureMode()) {\n    featureDefinition = mapModeModel.getFeatureDefinition();\n    var geojson = JSON.parse(featureDefinition.get('the_geom'));\n    geometry = map.editGeometry(geojson);\n  }\n\n  if (featureDefinition && geometry) {\n    this._bindGeometryToFeatureDefinition(geometry, featureDefinition);\n    featureDefinition.on('save', function () {\n      if (featureDefinition.hasBeenChangedAfterLastSaved('the_geom') || featureDefinition.hasBeenChangedAfterLastSaved('cartodb_id')) {\n        this._invalidateMap();\n        geometry.setCoordinatesFromGeoJSON(JSON.parse(featureDefinition.get('the_geom')));\n      }\n    }, this);\n    featureDefinition.on('remove', function () {\n      this._invalidateMap();\n    }, this);\n  }\n};\n\nF.prototype._bindGeometryToFeatureDefinition = function (geometry, featureDefinition) {\n  geometry.on('change', function () {\n    if (geometry.isComplete()) {\n      $('.js-editOverlay').fadeOut(200, function () {\n        $('.js-editOverlay').remove();\n      });\n\n      var geojson = geometry.toGeoJSON();\n      geojson = geojson.geometry || geojson;\n      featureDefinition.set({\n        the_geom: JSON.stringify(geojson)\n      });\n      featureDefinition.trigger('updateFeature');\n    }\n  });\n};\n\nF.prototype._resetStylesIfNoneApplied = function (layerDefModel) {\n  var nodeDefModel = layerDefModel.getAnalysisDefinitionNodeModel();\n  var analysisCollection = this._analysis();\n  var nodeModel = analysisCollection && analysisCollection.findNodeById(layerDefModel.get('source'));\n  var isAnalysisNode = nodeModel && nodeModel.get('type') !== 'source';\n  var isDone = nodeModel && nodeModel.isDone();\n  var queryGeometryModel = nodeDefModel.queryGeometryModel;\n  var styleModel = layerDefModel.styleModel;\n\n  if (isAnalysisNode && styleModel.hasNoneStyles() && isDone) {\n    var simpleGeom = queryGeometryModel.get('simple_geom');\n\n    var applyDefaultStyles = function () {\n      simpleGeom = queryGeometryModel.get('simple_geom');\n      styleModel.setDefaultPropertiesByType('simple', simpleGeom);\n    };\n\n    if (!simpleGeom) {\n      queryGeometryModel.once('change:simple_geom', applyDefaultStyles, this);\n      queryGeometryModel.fetch();\n    } else {\n      applyDefaultStyles();\n    }\n  }\n};\n\nF.prototype._visReload = function () {\n  this._getVisMetadata();\n  this._visDefinitionModel.trigger('vis:reload');\n  this._visDefinitionModel.recordChange();\n};\n\nF.prototype._getVisMetadata = function () {\n  var vis = this._vis();\n  var map = this.visMap();\n  var layers = this._getLayers();\n\n  var imageExportMetadata = {\n    zoom: map.get('zoom'),\n    mapType: map.getBaseLayer().get('baseType'),\n    style: layers.at(0).get('style'),\n    attribution: map.get('attribution'),\n    provider: map.get('provider')\n  };\n\n  this._mapDefinitionModel.setImageExportMetadata(imageExportMetadata);\n  this._mapDefinitionModel.setStaticImageURLTemplate(vis.getStaticImageURL.bind(vis));\n};\n\nF.prototype._setMapConverters = function () {\n  var map = this.visMap();\n  this._mapDefinitionModel.setConverters({\n    pixelToLatLng: map.pixelToLatLng(),\n    latLngToPixel: map.latLngToPixel()\n  });\n};\n\nF.prototype._setMapViewSize = function () {\n  this._mapDefinitionModel.setMapViewSize(this.visMap().getMapViewSize());\n};\n\nF.prototype._visErrorChange = function () {\n  this._visDefinitionModel && this._visDefinitionModel.trigger('vis:error', this._vis().get('error'));\n};\n\nF.prototype._analyseDefinition = function (m) {\n  var id = m.get('node_id');\n  var nodeDefModel = this._analysisDefinitionNodesCollection.get(id);\n  this._analyseDefinitionNode(nodeDefModel);\n};\n\nF.prototype._analyseDefinitionNodeAdded = function (m) {\n  m.queryRowsCollection.on('remove', this._invalidateMap, this);\n  this._analyseDefinitionNode(m);\n};\n\nF.prototype._analyseDefinitionNode = function (m) {\n  if (!this._hasUpdateOnlyNodeAnalysisId(m)) {\n    var attrs = m.toJSON({ skipOptions: true });\n    this._analysis().analyse(attrs);\n\n    // Unfortunately have to try to setup sync until this point, since a node doesn't exist until after analyse call\n    this._analysisDefinitionNodesCollection.each(this._tryToSetupDefinitionNodeSync, this);\n  }\n};\n\nF.prototype._onAnalysisDefinitionNodeIdChanged = function (m, changedAttributes) {\n  if (this._hasUpdateOnlyNodeAnalysisId(m)) {\n    var node = this._analysis().findNodeById(m.previous('id'));\n    node && node.set('id', m.id);\n  }\n};\n\nF.prototype._onAnalysisDefinitionNodeRemoved = function (m) {\n  m.queryRowsCollection.off('remove', this._invalidateMap, this);\n\n  var node = this._analysis().findNodeById(m.id);\n  if (node) {\n    node.set({avoidNotification: (m && !!m.get('avoidNotification'))}, {silent: true});\n    node.remove();\n  }\n};\n\nF.prototype._hasUpdateOnlyNodeAnalysisId = function (nodeDefModel) {\n  return nodeDefModel.hasChanged('id') && _.size(nodeDefModel.changed) === 1;\n};\n\nF.prototype._tryToSetupDefinitionNodeSync = function (m) {\n  if (m.__syncSetup) return; // only setup once\n\n  var node = this._analysis().findNodeById(m.id);\n  var layerDefModel = this._layerDefinitionsCollection.findOwnerOfAnalysisNode(m);\n  if (!node) return; // might not exist when method is called, so do nothing to allow retries\n\n  m.__syncSetup = true;\n  m.__initialization = true;\n\n  // Don't need to sync source nodes\n  if (node.get('type') !== 'source') {\n    AnalysisNotifications.track(node, layerDefModel);\n\n    var updateAnalysisQuerySchema = function () {\n      var query = node.get('query');\n      var status = node.get('status');\n      var error = node.get('error');\n\n      m.querySchemaModel.set({\n        status: 'unfetched',\n        query: query,\n        ready: status === 'ready'\n      });\n      m.queryGeometryModel.set({\n        status: 'unfetched',\n        query: query,\n        ready: status === 'ready'\n      });\n\n      m.set({\n        status: status,\n        error: error\n      });\n\n      if (status === 'ready') {\n        if (!m.__initialization) {\n          m.trigger('queryObjectsUpdated', m);\n        }\n\n        m.__initialization = false;\n      }\n    };\n\n    AnalysisOnboardingLauncher.init({\n      onboardings: this._onboardings,\n      userModel: this._userModel\n    });\n\n    m.listenTo(node, 'change:status', function (model, status) {\n      if (status === 'ready' && m.USER_SAVED) {\n        AnalysisOnboardingLauncher.launch(node.get('type'), model);\n        m.USER_SAVED = false;\n      }\n    });\n\n    updateAnalysisQuerySchema();\n\n    m.listenTo(node, 'change:query change:status change:error', updateAnalysisQuerySchema);\n    m.listenToOnce(node, 'destroy', m.stopListening);\n  } else {\n    m.listenTo(m.querySchemaModel, 'resetDueToAlteredData', this._invalidateMap.bind(this));\n  }\n};\n\nF.prototype._onWidgetDefinitionAdded = function (m) {\n  var widgetModel = this._diDashboard.getWidget(m.id);\n  if (widgetModel) {\n    widgetModel.set({\n      show_stats: true,\n      show_options: true\n    });\n\n    this._bindWidgetChanges(widgetModel);\n  }\n};\n\nF.prototype._onWidgetDefinitionSynced = function (m) {\n  var widgetModel = this._diDashboard.getWidget(m.id);\n  if (!widgetModel) {\n    this._createWidgetModel(m);\n  }\n};\n\nF.prototype._onWidgetAutoStyleColorChanged = function (m) {\n  var isAutoStyleApplied = m.isAutoStyle();\n  var autoStyleInfo = m.getAutoStyle();\n  var layerId = m.dataviewModel.layer.id;\n  var layerDefModel = this._layerDefinitionsCollection.findWhere({ id: layerId });\n  var nodeDefModel = layerDefModel && layerDefModel.getAnalysisDefinitionNodeModel();\n  var styleModel = layerDefModel && layerDefModel.styleModel;\n  var geometryType = nodeDefModel && nodeDefModel.get('simple_geom');\n\n  if (layerDefModel) {\n    layerDefModel.set({\n      autoStyle: isAutoStyleApplied ? m.id : false,\n      cartocss: autoStyleInfo.cartocss\n    });\n  }\n\n  if (isAutoStyleApplied && styleModel && geometryType) {\n    styleModel.setPropertiesFromAutoStyle({\n      definition: autoStyleInfo.definition,\n      geometryType: geometryType,\n      widgetId: m.id\n    });\n  }\n};\n\nF.prototype._onWidgetAutoStyleChanged = function (m) {\n  var isAutoStyleApplied = m.isAutoStyle();\n  var autoStyleInfo = m.getAutoStyle();\n  var layerId = m.dataviewModel.layer.id;\n  var layerDefModel = this._layerDefinitionsCollection.findWhere({ id: layerId });\n  var nodeDefModel = layerDefModel && layerDefModel.getAnalysisDefinitionNodeModel();\n  var styleModel = layerDefModel && layerDefModel.styleModel;\n  var onLayerChange = _.debounce(function () {\n    var dontResetStyles = true; // In order to make it more visible\n    m.cancelAutoStyle(dontResetStyles);\n  }, 10);\n\n  var stylesWithoutAutostyles = this._getStylesWithoutAutostyles(layerDefModel);\n\n  if (layerDefModel && nodeDefModel) {\n    if (isAutoStyleApplied) {\n      layerDefModel.set({\n        autoStyle: m.id\n      });\n    }\n  } else {\n    return;\n  }\n\n  if (isAutoStyleApplied) {\n    var geometryType = nodeDefModel.get('simple_geom');\n    styleModel.setPropertiesFromAutoStyle({\n      definition: autoStyleInfo.definition,\n      geometryType: geometryType,\n      widgetId: m.id\n    });\n\n    layerDefModel.set(_.extend(\n      {\n        cartocss: autoStyleInfo.cartocss,\n        cartocss_custom: false\n      },\n      stylesWithoutAutostyles\n    ));\n\n    layerDefModel.once('change:autoStyle change:cartocss', onLayerChange, this);\n  } else {\n    layerDefModel.unbind('change:autoStyle change:cartocss', onLayerChange, this);\n    var autoStyleId = layerDefModel.get('autoStyle');\n\n    if (autoStyleId && autoStyleId === m.id) {\n      styleModel.resetPropertiesFromAutoStyle();\n\n      layerDefModel.set({\n        autoStyle: false,\n        cartocss_custom: layerDefModel.get('previousCartoCSSCustom'),\n        cartocss: layerDefModel.get('previousCartoCSS')\n      });\n\n      // Because we are messing with the autoStyle property on saving,\n      // whenever we disable autoStyle, we save the layer to force\n      // the sync on the cartocss\n      layerDefModel.save();\n    }\n  }\n};\n\nF.prototype._onWidgetCustomAutoStyleColorChanged = function (m) {\n  var isAutoStyleApplied = m.isAutoStyle();\n  var autoStyleInfo = m.getAutoStyle();\n  var layerId = m.dataviewModel.layer.id;\n  var layerDefModel = this._layerDefinitionsCollection.findWhere({ id: layerId });\n  var nodeDefModel = layerDefModel && layerDefModel.getAnalysisDefinitionNodeModel();\n  var styleModel = layerDefModel && layerDefModel.styleModel;\n\n  if (isAutoStyleApplied) {\n    var geometryType = nodeDefModel.get('simple_geom');\n    styleModel.setPropertiesFromAutoStyle({\n      definition: autoStyleInfo.definition,\n      geometryType: geometryType,\n      widgetId: m.id\n    });\n\n    layerDefModel.set({\n      cartocss: autoStyleInfo.cartocss,\n      cartocss_custom: false\n    }, {silent: true});\n\n    // In order to make legends aware\n    styleModel.trigger('style:update');\n  }\n};\n\nF.prototype._onWidgetDefinitionChanged = function (m) {\n  var widgetModel = this._diDashboard.getWidget(m.id);\n\n  // Only try to update if there's a corresponding widget model\n  // E.g. the change of type will remove the model and provoke change events, which are not of interest (here),\n  // since the widget model should be re-created for the new type anyway.\n  if (widgetModel) {\n    if (m.hasChanged('type')) {\n      widgetModel.remove();\n      this._createWidgetModel(m);\n    } else {\n      var attrs = this._formatWidgetAttrs(m.changedAttributes(), m);\n      widgetModel.update(attrs);\n    }\n  }\n};\n\nF.prototype._onWidgetDefinitionDestroyed = function (m) {\n  var widgetModel = this._diDashboard.getWidget(m.id);\n\n  if (widgetModel) {\n    if (widgetModel.isAutoStyle()) {\n      widgetModel.cancelAutoStyle();\n    }\n    this._unbindWidgetChanges(widgetModel);\n    widgetModel.remove();\n  }\n};\n\nF.prototype._onEditWidget = function (m) {\n  var widgetDefModel = this._widgetDefinitionsCollection.get(m.id);\n  if (widgetDefModel) {\n    WidgetsService.editWidget(widgetDefModel);\n  }\n};\n\nF.prototype._onRemoveWidget = function (m) {\n  var widgetDefModel = this._widgetDefinitionsCollection.get(m.id);\n  if (widgetDefModel) {\n    WidgetsService.removeWidget(widgetDefModel);\n  }\n};\n\nF.prototype._bindWidgetChanges = function (m) {\n  m.bind('editWidget', this._onEditWidget, this);\n  m.bind('removeWidget', this._onRemoveWidget, this);\n  m.bind('customAutoStyle', this._onWidgetCustomAutoStyleColorChanged, this);\n  m.bind('change:autoStyle', this._onWidgetAutoStyleChanged, this);\n  m.bind('change:color', this._onWidgetAutoStyleColorChanged, this);\n};\n\nF.prototype._unbindWidgetChanges = function (m) {\n  m.unbind('editWidget', this._onEditWidget, this);\n  m.unbind('removeWidget', this._onRemoveWidget, this);\n  m.unbind('customAutoStyle', this._onWidgetCustomAutoStyleColorChanged, this);\n  m.unbind('change:autoStyle', this._onWidgetAutoStyleChanged, this);\n  m.unbind('change:color', this._onWidgetAutoStyleColorChanged, this);\n};\n\nF.prototype._createWidgetModel = function (m) {\n  // e.g. 'time-series' => createTimeSeriesWidget\n  var infix = m.get('type').replace(/(^\\w|-\\w)/g, function (match) {\n    return match.toUpperCase().replace('-', '');\n  });\n  var methodName = 'create' + infix + 'Widget';\n\n  var layerModel = this.visMap().getLayerById(m.get('layer_id'));\n  var attrs = this._formatWidgetAttrs(m.attributes, m);\n\n  var widgetModel = this._diDashboard[methodName](attrs, layerModel);\n\n  if (widgetModel) {\n    widgetModel.set({\n      show_stats: true,\n      show_options: true\n    });\n\n    this._bindWidgetChanges(widgetModel);\n  }\n};\n\n/**\n * Massage some data points to the expected format of deep-insights API\n */\nF.prototype._formatWidgetAttrs = function (changedAttrs, widgetDefModel) {\n  var widgetStyleParams = ['widget_style_definition', 'auto_style_definition', 'auto_style_allowed'];\n  var formattedAttrs = changedAttrs;\n\n  // Source formatting\n  if (_.isString(formattedAttrs.source)) {\n    formattedAttrs = _.omit(formattedAttrs, 'source');\n    formattedAttrs.source = {id: changedAttrs.source};\n  }\n\n  // Widget style or auto style changes\n  var thereIsWidgetStyleChange = _.find(formattedAttrs, function (value, key) {\n    return _.contains(widgetStyleParams, key);\n  });\n\n  if (!_.isUndefined(thereIsWidgetStyleChange)) {\n    formattedAttrs = _.omit(formattedAttrs, widgetStyleParams);\n    formattedAttrs.style = widgetDefModel.toJSON().style;\n  }\n\n  return formattedAttrs;\n};\n\nF.prototype._onLayerDefinitionAdded = function (m, c, opts) {\n  // Base and labels layers are synced in a separate method\n  if (!layerTypesAndKinds.isTypeDataLayer(m.get('type'))) {\n    return;\n  }\n\n  // If added but not yet saved, postpone the creation until persisted (see sync listener)\n  if (!m.isNew()) {\n    if (!this._getLayer(m)) {\n      this._createLayer(m);\n    } else {\n      // we need to sync model positions\n      this._tryUpdateLayerPosition(m);\n    }\n  }\n};\n\nF.prototype._tryUpdateLayerPosition = function (m) {\n  var builderPosition = this._layerDefinitionsCollection.indexOf(m);\n  var cdbLayer = this._getLayer(m);\n  var cdbPosition;\n\n  if (cdbLayer) {\n    cdbPosition = this._getLayers().indexOf(cdbLayer);\n  }\n\n  var indexChanges = m.isDataLayer() && cdbPosition > 0 && builderPosition > 0 && builderPosition !== cdbPosition;\n\n  if (indexChanges) {\n    this.visMap().moveCartoDBLayer(cdbPosition, builderPosition);\n  }\n};\n\nF.prototype._onLayerDefinitionSynced = function (m) {\n  // Base and labels layers are synced in a separate method\n  if (!layerTypesAndKinds.isTypeDataLayer(m.get('type'))) {\n    return;\n  }\n\n  if (!this._getLayer(m)) {\n    this._createLayer(m);\n  }\n};\n\nF.prototype._onLayerDefinitionChanged = function (layerDefinitionModel, changedAttributes) {\n  var attrs = layerDefinitionModel.changedAttributes();\n  var attrsNames = _.keys(attrs);\n\n  // Base and labels layers are synced in a separate method\n  if (!layerTypesAndKinds.isTypeDataLayer(layerDefinitionModel.get('type'))) {\n    return;\n  }\n\n  // return if only the 'error' attribute has changed (no need to sync anything)\n  if (attrsNames.length === 1 && attrsNames[0] === 'error') {\n    return;\n  }\n\n  var layer = this._getLayer(layerDefinitionModel);\n  if (!layerDefinitionModel.isNew()) {\n    if (!layer) {\n      this._createLayer(layerDefinitionModel);\n      return;\n    }\n\n    if (attrs.type) {\n      layer.remove();\n      this._createLayer(layerDefinitionModel);\n    } else {\n      if (layerDefinitionModel.get('source') && !layer.get('source')) {\n        attrs.source = layerDefinitionModel.get('source');\n      }\n      attrs = this._adaptAttrsToCDBjs(layerDefinitionModel.get('type'), attrs);\n      layer.update(attrs);\n    }\n    this._manageTimeSeriesForTorque(layerDefinitionModel);\n  }\n};\n\nF.prototype._onBaseLayerChanged = function () {\n  var baseLayerDefinition = this._layerDefinitionsCollection.getBaseLayer();\n  var newBaseLayerAttrs = baseLayerDefinition.changedAttributes();\n\n  var newBaseLayerType = baseLayerDefinition.get('type');\n  var newMapProvider = basemapProvidersAndCategories.getProvider(newBaseLayerType);\n  var mapProviderChanged = false;\n  if (baseLayerDefinition.hasChanged('type')) {\n    var previousBaseLayerType = baseLayerDefinition.previous('type');\n    var previousMapProvider = basemapProvidersAndCategories.getProvider(previousBaseLayerType);\n    mapProviderChanged = previousMapProvider !== newMapProvider;\n  }\n\n  // If the map provider has changed (eg: Leaflet -> Google Maps), we add/update/remove base and\n  // labels layers silently so that CartoDB.js doesn't pick up those changes and tries to add/update/remove\n  // layers until the new map provider has been set\n  var handleLayersSilently = mapProviderChanged;\n\n  // Base layer\n  var cdbjsLayer = this._getLayer(baseLayerDefinition);\n\n  // If the type of base layer has changed. eg: Tiled -> Plain\n  if (newBaseLayerAttrs.type) {\n    cdbjsLayer.remove({ silent: handleLayersSilently });\n    this._createLayer(baseLayerDefinition, { silent: handleLayersSilently });\n  } else {\n    cdbjsLayer.update(this._adaptAttrsToCDBjs(baseLayerDefinition.get('type'), newBaseLayerAttrs), {\n      silent: handleLayersSilently\n    });\n  }\n\n  // Labels layer\n  var labelsLayerDefinition = this._layerDefinitionsCollection.getLabelsLayer();\n  var cdbjsTopLayer = this._getLayers().last();\n  var cdbjsHasLabelsLayer = cdbjsTopLayer.get('type') === 'Tiled';\n\n  if (labelsLayerDefinition) {\n    if (cdbjsHasLabelsLayer) {\n      var changedAttrs = labelsLayerDefinition.changedAttributes();\n      if (changedAttrs) {\n        cdbjsTopLayer.update(this._adaptAttrsToCDBjs(labelsLayerDefinition.get('type'), changedAttrs), {\n          silent: handleLayersSilently\n        });\n      }\n    } else {\n      this._createLayer(labelsLayerDefinition, { silent: handleLayersSilently });\n    }\n  } else if (cdbjsHasLabelsLayer) {\n    cdbjsTopLayer.remove({ silent: handleLayersSilently });\n  }\n\n  // Map provider\n  this.visMap().set('provider', newMapProvider);\n\n  if (handleLayersSilently) {\n    // Reload map if everything (previously) was done silently\n    this._diDashboard.reloadMap();\n  }\n\n  // Render again the edit-feature-overlay, in order to\n  // decide if delegate or not events\n  this._editFeatureOverlay.render();\n  this._setMapConverters();\n};\n\nvar CARTODBJS_TO_CARTODB_ATTRIBUTE_MAPPINGS = {\n  'layer_name': ['table_name_alias', 'table_name']\n};\n\nvar BLACKLISTED_LAYER_DEFINITION_ATTRS = {\n  'all': [ 'letter', 'kind' ],\n  'Tiled': [ 'category', 'selected', 'highlighted' ],\n  'CartoDB': [ 'color', 'letter' ],\n  'torque': [ 'color', 'letter' ]\n};\n\nF.prototype._adaptAttrsToCDBjs = function (layerType, attrs) {\n  attrs = _.omit(attrs, BLACKLISTED_LAYER_DEFINITION_ATTRS['all'], BLACKLISTED_LAYER_DEFINITION_ATTRS[layerType]);\n  _.each(CARTODBJS_TO_CARTODB_ATTRIBUTE_MAPPINGS, function (cdbAttrs, cdbjsAttr) {\n    _.each(cdbAttrs, function (cdbAttr) {\n      if (attrs[cdbAttr] && !attrs[cdbjsAttr]) {\n        attrs[cdbjsAttr] = attrs[cdbAttr];\n      }\n    });\n  });\n\n  return attrs;\n};\n\nF.prototype._onLegendDefinitionAdded = function (m) {\n  var layerDefModel = m.layerDefinitionModel;\n  var layer = this._getLayer(layerDefModel);\n  var type = m.get('type');\n  var legend;\n  if (layer && layer.legends) {\n    legend = layer.legends[type];\n    if (legend) {\n      legend.reset();\n      legend.set(m.getAttributes());\n      legend.show();\n    }\n  }\n};\n\nF.prototype._onLegendDefinitionRemoved = function (m) {\n  var layerDefModel = m.layerDefinitionModel;\n  var layer = this._getLayer(layerDefModel);\n  var type = m.get('type');\n  var legend;\n  if (layer && layer.legends) {\n    legend = layer.legends[type];\n    legend && legend.hide();\n  }\n};\n\nF.prototype._onLegendDefinitionChanged = function (m) {\n  var layerDefModel = m.layerDefinitionModel;\n  var layer = this._getLayer(layerDefModel);\n  var type = m.get('type');\n  var legend;\n  if (layer && layer.legends) {\n    legend = layer.legends[type];\n    if (legend) {\n      legend.reset();\n      legend.set(m.getAttributes());\n    }\n  }\n};\n\nF.prototype._manageTimeSeriesForTorque = function (m) {\n  function recreateWidget (currentTimeseries, newLayer, animated) {\n    var persistName = currentTimeseries && currentTimeseries.get('title');\n    this._createTimeseries(newLayer, animated, persistName);\n  }\n\n  // not a cartodb layer\n  if (!m.styleModel) return;\n  var animatedChanged = m.styleModel.changedAttributes().animated;\n  var attributeChanged;\n  if (animatedChanged) attributeChanged = animatedChanged.attribute;\n  var typeChanged = m.styleModel.changedAttributes().type;\n  var animatedAttribute = m.styleModel.get('animated') && m.styleModel.get('animated').attribute;\n  var previousType = m.styleModel.previous('type');\n\n  if (!typeChanged && !attributeChanged) return;\n\n  var type = m.styleModel.get('type');\n  var widgetModel = this._diDashboard.getWidgets().filter(function (m) {\n    return m.get('type') === 'time-series';\n  })[0];\n\n  var currentTimeseries = this._getTimeseriesDefinition();\n  var persistWidget = !!currentTimeseries && currentTimeseries.get('title') !== 'time_date__t';\n  var newLayer = this._getLayer(m);\n\n  if (type !== 'animation' && previousType === 'animation' && this._lastType !== type) {\n    if (widgetModel) {\n      this._removeTimeseries();\n    }\n\n    if (persistWidget) {\n      recreateWidget.call(this, currentTimeseries, newLayer, _.extend({ animated: false }, animatedChanged, { attribute: animatedAttribute }));\n    }\n    this._lastType = type;\n    this._lastTSAnimateChange = '';\n  }\n\n  if (type === 'animation' && (this._lastTSAnimateChange !== attributeChanged || this._lastType !== 'animation')) {\n    if (widgetModel) {\n      this._removeTimeseries();\n    }\n\n    if (newLayer.get('type') === 'torque' || m.get('type') === 'torque' || persistWidget) {\n      recreateWidget.call(this, currentTimeseries, newLayer, _.extend({ animated: true }, animatedChanged, { attribute: animatedAttribute }));\n    }\n\n    this._lastType = type;\n    this._lastTSAnimateChange = attributeChanged;\n  }\n};\n\nF.prototype._removeTimeseries = function () {\n  this._widgetDefinitionsCollection.models.forEach(function (def) {\n    if (def.get('type') === 'time-series') {\n      def.set({avoidNotification: true}, {silent: true});\n      def.destroy();\n    }\n  });\n};\n\nF.prototype._getTimeseriesDefinition = function () {\n  return this._widgetDefinitionsCollection.where({type: 'time-series'})[0];\n};\n\nF.prototype._createTimeseries = function (newLayer, animatedChanged, persist) {\n  this._removeTimeseries();\n  var attribute = animatedChanged && animatedChanged.attribute || '';\n  var animated = animatedChanged && animatedChanged.animated;\n  if (attribute) {\n    var baseAttrs = {\n      type: 'time-series',\n      layer_id: newLayer.get('id'),\n      source: {\n        id: newLayer.get('source')\n      },\n      options: {\n        column: attribute,\n        title: persist || 'time_date__t',\n        bins: 256,\n        animated: animated\n      },\n      style: {\n        widget_style: WidgetDefinitionModel.getDefaultWidgetStyle('time-series')\n      }\n    };\n    this._widgetDefinitionsCollection.create(baseAttrs, {wait: true});\n  }\n};\n\nF.prototype._onLayerDefinitionRemoved = function (m) {\n  if (!m.isNew()) {\n    var layer = this._getLayer(m);\n    layer && layer.remove();\n  }\n};\n\nF.prototype._onLayerDefinitionMoved = function (m, from, to) {\n  this.visMap().moveCartoDBLayer(from, to);\n};\n\nvar LAYER_TYPE_TO_LAYER_CREATE_METHOD = {\n  'cartodb': 'createCartoDBLayer',\n  'gmapsbase': 'createGMapsBaseLayer',\n  'plain': 'createPlainLayer',\n  'tiled': 'createTileLayer',\n  'torque': 'createTorqueLayer',\n  'wms': 'createWMSLayer'\n};\n\nF.prototype._createLayer = function (layerDefModel, options) {\n  options = options || {};\n  var attrs = JSON.parse(JSON.stringify(layerDefModel.attributes)); // deep clone\n  attrs = this._adaptAttrsToCDBjs(layerDefModel.get('type'), attrs);\n\n  // create the legends for the new layer\n  var legends = this._legendsDefinitionCollection.findByLayerDefModel(layerDefModel);\n  if (legends.length > 0) {\n    attrs.legends = _.map(legends, function (legend) {\n      return legend.toJSON();\n    });\n  }\n\n  var createMethodName = LAYER_TYPE_TO_LAYER_CREATE_METHOD[attrs.type.toLowerCase()];\n  if (!createMethodName) throw new Error('no create method name found for type ' + attrs.type);\n\n  if (attrs.source) {\n    // Make sure the analysis is created first\n    var nodeDefModel = this._analysisDefinitionNodesCollection.get(attrs.source);\n    this._analyseDefinitionNode(nodeDefModel);\n  }\n\n  var visMap = this.visMap();\n  var layerPosition = this._layerDefinitionsCollection.indexOf(layerDefModel);\n  visMap[createMethodName](attrs, _.extend({\n    at: layerPosition\n  }, options));\n\n  linkLayerInfowindow(layerDefModel, visMap);\n  linkLayerTooltip(layerDefModel, visMap);\n  LegendManager.track(layerDefModel);\n\n  this._linkLayerErrors(layerDefModel);\n};\n\nF.prototype._linkLayerErrors = function (m) {\n  var layer = this._getLayer(m);\n  if (layer) {\n    if (layer.get('error')) {\n      this._setLayerError(m, layer.get('error'));\n    }\n    layer.on('change:error', function (model, cdbError) {\n      this._setLayerError(m, cdbError);\n    }, this);\n  }\n};\n\nF.prototype._setLayerError = function (layerDefinitionModel, cdbError) {\n  var notification = Notifier.getNotification(layerDefinitionModel.id);\n  var mainErrorMessage = layerDefinitionModel.getName() + ': ' + (cdbError && cdbError.message);\n\n  if (!cdbError) {\n    layerDefinitionModel.unset('error');\n    notification && Notifier.removeNotification(notification);\n    return;\n  }\n\n  var errorMessage = NotificationErrorMessageHandler.extractError(mainErrorMessage);\n\n  if (notification) {\n    notification.update({\n      status: errorMessage.type,\n      info: errorMessage.message\n    });\n  } else {\n    Notifier.addNotification({\n      id: layerDefinitionModel.id,\n      status: errorMessage.type,\n      closable: true,\n      button: false,\n      info: errorMessage.message\n    });\n  }\n\n  if (cdbError.type === 'turbo-carto') {\n    var line;\n    try {\n      line = cdbError.context.source.start.line;\n    } catch (error) {}\n\n    layerDefinitionModel.set('error', {\n      type: cdbError.type,\n      line: line,\n      message: cdbError.message\n    });\n  } else if (errorMessage) {\n    layerDefinitionModel.set('error', {\n      type: errorMessage.type,\n      message: errorMessage.message\n    });\n  }\n};\n\nF.prototype._onOverlayDefinitionAdded = function (mdl) {\n  this._vis().overlaysCollection.add(mdl.toJSON());\n};\n\nF.prototype._onOverlayDefinitionRemoved = function (mdl) {\n  var collection = this._vis().overlaysCollection;\n  var overlay = collection.findWhere({ type: mdl.get('type') });\n  overlay && collection.remove(overlay);\n};\n\nF.prototype._onMinMaxZoomChanged = function () {\n  var currentZoom = this.visMap().get('zoom');\n  var maxZoom = this._mapDefinitionModel.get('maxZoom');\n  var minZoom = this._mapDefinitionModel.get('minZoom');\n\n  this.visMap().set({\n    minZoom: minZoom,\n    maxZoom: maxZoom,\n    zoom: Math.min(currentZoom, maxZoom)\n  });\n};\n\nF.prototype._saveStateDefinition = function () {\n  var state = this._diDashboard.getState();\n  this._stateDefinitionModel.updateState(state);\n  this._getVisMetadata();\n};\n\nF.prototype._onScrollWheelChanged = function () {\n  var scrollwheel = this._mapDefinitionModel.get('scrollwheel');\n  var method = scrollwheel ? 'enableScrollWheel' : 'disableScrollWheel';\n  var map = this.visMap();\n  map && map[method] && map[method]();\n};\n\nF.prototype._onLegendsChanged = function () {\n  var legends = this._mapDefinitionModel.get('legends');\n  this._vis().settings.set('showLegends', legends);\n};\n\nF.prototype._onLayerSelectorChanged = function () {\n  var layerSelector = this._mapDefinitionModel.get('layer_selector');\n  this._vis().settings.set('showLayerSelector', layerSelector);\n};\n\nF.prototype._onEditorSettingsChanged = function () {\n  var settingsView = this._editorModel.get('settingsView');\n  this._vis().settings.set('layerSelectorEnabled', settingsView);\n};\n\nF.prototype._getLayer = function (m) {\n  return this.visMap().getLayerById(m.id);\n};\n\nF.prototype._getLayers = function (m) {\n  return this.visMap().layers;\n};\n\nF.prototype.visMap = function () {\n  return this._vis().map;\n};\n\nF.prototype._analysis = function () {\n  return this._vis().analysis;\n};\n\nF.prototype._vis = function () {\n  return this._diDashboard.getMap();\n};\n\nF.prototype._invalidateSize = function () {\n  this._vis().invalidateSize();\n};\n\nF.prototype._invalidateMap = function () {\n  this._vis().reload();\n};\n\nF.prototype._onBoundsSet = function (bounds) {\n  this._diDashboard._dashboard.vis.map.setBounds(bounds);\n};\n\nmodule.exports = F;\n",
    "var ACTIVE_LOCALE = window.ACTIVE_LOCALE;\nif (ACTIVE_LOCALE !== 'en') {\n  require('moment/locale/' + ACTIVE_LOCALE);\n}\nvar Locale = require('../../locale/index');\nvar Polyglot = require('node-polyglot');\nvar polyglot = new Polyglot({\n  locale: ACTIVE_LOCALE, // Needed for pluralize behaviour\n  phrases: Locale[ACTIVE_LOCALE]\n});\nwindow._t = polyglot.t.bind(polyglot);\n\nvar $ = require('jquery');\nvar _ = require('underscore');\nvar Backbone = require('backbone');\nvar deepInsights = require('cartodb-deep-insights.js');\nvar ConfigModel = require('./data/config-model');\nvar EditorMapView = require('./editor/editor-map-view');\nvar MapDefinitionModel = require('./data/map-definition-model');\nvar AnalysisDefinitionNodesCollection = require('./data/analysis-definition-nodes-collection');\nvar AnalysisDefinitionsCollection = require('./data/analysis-definitions-collection');\nvar LayerDefinitionsCollection = require('./data/layer-definitions-collection');\nvar WidgetDefinitionsCollection = require('./data/widget-definitions-collection');\nvar VisDefinitionModel = require('./data/vis-definition-model');\nvar createEditorMenuTabPane = require('./components/tab-pane/create-editor-menu-tab-pane');\nvar editorPaneTemplate = require('./editor/editor-pane.tpl');\nvar editorPaneIconItemTemplate = require('./editor/editor-pane-icon.tpl');\nvar ModalsServiceModel = require('./components/modals/modals-service-model');\nvar AnalysesService = require('./editor/layers/layer-content-views/analyses/analyses-service.js');\nvar OnboardingsServiceModel = require('./components/onboardings/onboardings-service-model');\nvar BuilderOnboardingLauncher = require('./components/onboardings/builder/launcher');\nvar viewFactory = require('./components/view-factory');\nvar UserModel = require('./data/user-model');\nvar UserNotifications = require('./data/user-notifications');\nvar EditorModel = require('./data/editor-model');\nvar UserActions = require('./data/user-actions');\nvar ImporterManager = require('./components/background-importer/background-importer');\nvar BackgroundPollingModel = require('./data/editor-background-polling-model');\nvar StyleManager = require('./editor/style/style-manager');\nvar DeepInsightsIntegrations = require('./deep-insights-integrations');\nvar EditFeatureOverlay = require('./deep-insights-integration/edit-feature-overlay');\nvar Notifier = require('./components/notifier/notifier');\nvar MetricsTracker = require('./components/metrics/metrics-tracker');\nvar FeedbackButtonView = require('./editor/feedback/feedback-button-view');\nvar SettingsOptions = require('./data/map-settings');\nvar SettingsView = require('./editor/editor-settings-view');\nvar OverlaysCollection = require('./data/overlays-definition-collection');\nvar MapcapsCollection = require('./data/mapcaps-collection');\nvar PrivacyCollection = require('./components/modals/publish/privacy-collection');\nvar CreatePrivacyOptions = require('./components/modals/publish/create-privacy-options');\nvar UserGroupFetcher = require('./data/users-group-fetcher');\nvar State = require('./data/state-definition-model');\nvar LegendDefinitionsCollection = require('./data/legends/legend-definitions-collection');\nvar LegendsState = require('./data/legends/legends-state');\nvar LegendFactory = require('./editor/layers/layer-content-views/legend/legend-factory');\nvar EditorVisualizationWarningView = require('./components/modals/editor-visualization-warning/editor-visualization-warning-view');\nvar MapModeModel = require('./map-mode-model');\nvar BuilderActivatedNotification = require('./components/onboardings/builder-activated/builder-activated-notification-view');\nvar NodeGeometryTracker = require('./node-geometry-tracker');\nvar WidgetsService = require('./editor/widgets/widgets-service');\nvar DataServicesApiCheck = require('./editor/layers/layer-content-views/analyses/analyses-quota/analyses-quota-info');\n\n// JSON data passed from entry point (editor/visualizations/show.html):\nvar vizJSON = window.vizJSON;\nvar stateJSON = window.stateJSON;\nvar userData = window.userData;\nvar frontendConfig = window.frontendConfig;\nvar visualizationData = window.visualizationData;\nvar layersData = window.layersData;\nvar analysesData = window.analysesData;\nvar builderNotifications = window.builderNotifications;\nvar dashboardNotifications = window.dashboardNotifications;\nvar mapcapsData = window.mapcapsData;\nvar overlaysData = window.overlaysData;\nvar basemaps = window.basemaps;\n\nvar configModel = new ConfigModel(\n  _.defaults(\n    {\n      base_url: userData.base_url,\n      api_key: userData.api_key\n    },\n    frontendConfig\n  )\n);\n\nDataServicesApiCheck.get(configModel).fetch();\n\nvar onboardingNotification = new UserNotifications(builderNotifications, {\n  key: 'builder',\n  configModel: configModel\n});\n\nvar userModel = new UserModel(userData, {\n  configModel: configModel\n});\n\nvar editorModel = new EditorModel();\n\nvar visDefinitionModel = new VisDefinitionModel(visualizationData, {\n  configModel: configModel\n});\nvar modals = new ModalsServiceModel();\nvar onboardings = new OnboardingsServiceModel();\nonboardings.editorModel = editorModel;\n\nUserGroupFetcher.track({\n  userModel: userModel,\n  configModel: configModel,\n  acl: visDefinitionModel.getPermissionModel().acl\n});\n\nvar stateDefModel = new State({\n  json: stateJSON\n}, {\n  visDefinitionModel: visDefinitionModel\n});\n\nvar mapId = visualizationData.map_id;\n\nvar analysisDefinitionNodesCollection = new AnalysisDefinitionNodesCollection(null, {\n  userModel: userModel,\n  configModel: configModel,\n  relatedTableData: visualizationData.related_tables\n});\n\nvar layerDefinitionsCollection = new LayerDefinitionsCollection(null, {\n  configModel: configModel,\n  userModel: userModel,\n  analysisDefinitionNodesCollection: analysisDefinitionNodesCollection,\n  mapId: mapId,\n  stateDefinitionModel: stateDefModel\n});\n\nvar analysisDefinitionsCollection = new AnalysisDefinitionsCollection(analysesData, {\n  configModel: configModel,\n  analysisDefinitionNodesCollection: analysisDefinitionNodesCollection,\n  layerDefinitionsCollection: layerDefinitionsCollection,\n  vizId: visDefinitionModel.id\n});\n\nlayerDefinitionsCollection.resetByLayersData(layersData);\n\n// Track geometry changes over any node definition model\nNodeGeometryTracker.track({\n  analysisDefinitionsCollection: analysisDefinitionsCollection,\n  analysisDefinitionNodesCollection: analysisDefinitionNodesCollection,\n  layerDefinitionsCollection: layerDefinitionsCollection\n});\n\nvar widgetDefinitionsCollection = new WidgetDefinitionsCollection(null, {\n  configModel: configModel,\n  mapId: mapId,\n  layerDefinitionsCollection: layerDefinitionsCollection\n});\n\nvizJSON.widgets.forEach(function (d) {\n  widgetDefinitionsCollection.add(d);\n});\n\nvar legendDefinitionsCollection = new LegendDefinitionsCollection(null, {\n  configModel: configModel,\n  layerDefinitionsCollection: layerDefinitionsCollection,\n  vizId: visDefinitionModel.id\n});\nlegendDefinitionsCollection.resetByData(vizJSON);\nLegendFactory.init(legendDefinitionsCollection);\nLegendsState.init(layerDefinitionsCollection, legendDefinitionsCollection);\n\nNotifier.init({\n  editorModel: editorModel,\n  visDefinitionModel: visDefinitionModel\n});\n\nMetricsTracker.init({\n  userId: userModel.get('id'),\n  visId: visDefinitionModel.get('id'),\n  configModel: configModel\n});\n\nBuilderOnboardingLauncher.init({\n  onboardings: onboardings,\n  userModel: userModel,\n  editorModel: editorModel,\n  onboardingNotification: onboardingNotification\n});\n\nAnalysesService.init({\n  onboardings: onboardings,\n  layerDefinitionsCollection: layerDefinitionsCollection,\n  modals: modals,\n  userModel: userModel,\n  configModel: configModel\n});\n\nvar userActions = UserActions({\n  userModel: userModel,\n  analysisDefinitionsCollection: analysisDefinitionsCollection,\n  analysisDefinitionNodesCollection: analysisDefinitionNodesCollection,\n  layerDefinitionsCollection: layerDefinitionsCollection,\n  widgetDefinitionsCollection: widgetDefinitionsCollection\n});\n\nvar privacyOptions = CreatePrivacyOptions(visDefinitionModel, userModel);\nvar privacyCollection = new PrivacyCollection(privacyOptions);\n\nvar mapcapsCollection = new MapcapsCollection(mapcapsData, {\n  visDefinitionModel: visDefinitionModel\n});\n\nvar backgroundPollingModel = new BackgroundPollingModel({\n  importsPolling: false\n}, {\n  configModel: configModel,\n  userModel: userModel,\n  userActions: userActions\n});\n\nImporterManager.init({\n  pollingModel: backgroundPollingModel,\n  createVis: false,\n  userModel: userModel,\n  configModel: configModel,\n  modals: modals\n});\n\nvar mapDefModel = new MapDefinitionModel(\n  _.extend(\n    vizJSON,\n    {\n      id: visualizationData.map_id\n    }\n  ),\n  {\n    parse: true,\n    configModel: configModel,\n    userModel: userModel,\n    layerDefinitionsCollection: layerDefinitionsCollection\n  }\n);\n\nvar overlaysCollection = new OverlaysCollection(overlaysData, {\n  configModel: configModel,\n  visId: visDefinitionModel.id\n});\n\nvar mapModeModel = new MapModeModel();\n\nWidgetsService.init({\n  widgetDefinitionsCollection: widgetDefinitionsCollection,\n  analysisDefinitionNodesCollection: analysisDefinitionNodesCollection,\n  layerDefinitionsCollection: layerDefinitionsCollection,\n  userActions: userActions,\n  modals: modals\n});\n\nvar mapCreation = function () {\n  BuilderOnboardingLauncher.launch();\n\n  if (!configModel.get('cartodb_com_hosted')) {\n    if (userModel.get('actions').builder_enabled && userModel.get('show_builder_activated_message') &&\n        _.isEmpty(dashboardNotifications)) {\n      var builderActivatedNotification = new UserNotifications(dashboardNotifications, {\n        key: 'dashboard',\n        configModel: configModel\n      });\n\n      var builderActivatedNotificationView = new BuilderActivatedNotification({\n        builderActivatedNotification: builderActivatedNotification\n      });\n\n      $('.js-editor').addClass('Editor--topBar');\n      builderActivatedNotificationView.bind('clean', function () {\n        $('.js-editor').removeClass('Editor--topBar');\n      }, this);\n    }\n  }\n\n  deepInsights.createDashboard('#dashboard', vizJSON, {\n    apiKey: configModel.get('api_key'),\n    no_cdn: false,\n    cartodb_logo: false,\n    renderMenu: false,\n    show_empty_infowindow_fields: true,\n    state: stateJSON,\n    interactiveFeatures: true,\n    layerSelectorEnabled: false\n  }, function (error, dashboard) {\n    if (error) {\n      console.error('Dashboard has some errors:\\n', error);\n    }\n\n    var vis = dashboard.getMap();\n    var dashboardView = dashboard.getView();\n\n    dashboardView.listenTo(editorModel, 'change:edition', function (m) {\n      dashboardView.$el.toggleClass('is-dark', m.isEditing());\n    });\n\n    var styleManager = new StyleManager(layerDefinitionsCollection, vis.map, configModel);\n\n    var editFeatureOverlay = new EditFeatureOverlay({\n      map: vis.map,\n      mapModeModel: mapModeModel,\n      modals: modals\n    });\n    editFeatureOverlay.hide();\n    vis.addCustomOverlay(editFeatureOverlay);\n\n    var deepInsightsIntegrations = new DeepInsightsIntegrations({\n      onboardings: onboardings,\n      userModel: userModel,\n      deepInsightsDashboard: dashboard,\n      analysisDefinitionsCollection: analysisDefinitionsCollection,\n      analysisDefinitionNodesCollection: analysisDefinitionNodesCollection,\n      layerDefinitionsCollection: layerDefinitionsCollection,\n      legendDefinitionsCollection: legendDefinitionsCollection,\n      widgetDefinitionsCollection: widgetDefinitionsCollection,\n      overlayDefinitionsCollection: overlaysCollection,\n      overlaysCollection: overlaysCollection,\n      visDefinitionModel: visDefinitionModel,\n      mapDefinitionModel: mapDefModel,\n      stateDefinitionModel: stateDefModel,\n      mapModeModel: mapModeModel,\n      configModel: configModel,\n      editorModel: editorModel,\n      editFeatureOverlay: editFeatureOverlay\n    });\n\n    // Expose things after Map initialization\n    window.deepInsightsIntegrations = deepInsightsIntegrations;\n    window.styleManager = styleManager;\n    window.dashboard = dashboard;\n    window.vis = vis;\n  });\n};\n\nif (visDefinitionModel.get('version') === 2 && modals) {\n  visDefinitionModel.bind('change:version', function () {\n    mapcapsCollection.fetch();\n    mapCreation();\n  }, this);\n\n  modals.create(function (modalModel) {\n    return new EditorVisualizationWarningView({\n      modalModel: modalModel,\n      visDefinitionModel: visDefinitionModel\n    });\n  }, true);\n} else {\n  mapCreation();\n}\n\nvar editorTabPaneView = createEditorMenuTabPane([\n  {\n    icon: 'pencil',\n    selected: true,\n    createContentView: function () {\n      editorModel.set({settingsView: false});\n      return new EditorMapView({\n        basemaps: basemaps,\n        userActions: userActions,\n        configModel: configModel,\n        userModel: userModel,\n        editorModel: editorModel,\n        pollingModel: backgroundPollingModel,\n        mapDefinitionModel: mapDefModel,\n        onboardings: onboardings,\n        modals: modals,\n        visDefinitionModel: visDefinitionModel,\n        layerDefinitionsCollection: layerDefinitionsCollection,\n        analysisDefinitionNodesCollection: analysisDefinitionNodesCollection,\n        widgetDefinitionsCollection: widgetDefinitionsCollection,\n        mapcapsCollection: mapcapsCollection,\n        privacyCollection: privacyCollection,\n        legendDefinitionsCollection: legendDefinitionsCollection,\n        mapModeModel: mapModeModel,\n        stateDefinitionModel: stateDefModel,\n        onboardingNotification: onboardingNotification\n      });\n    }\n  }, {\n    icon: 'settings',\n    createContentView: function () {\n      editorModel.set({settingsView: true});\n      return new SettingsView({\n        mapDefinitionModel: mapDefModel,\n        overlaysCollection: overlaysCollection,\n        mapcapsCollection: mapcapsCollection,\n        visDefinitionModel: visDefinitionModel,\n        privacyCollection: privacyCollection,\n        configModel: configModel,\n        userModel: userModel,\n        modals: modals,\n        editorModel: editorModel,\n        settingsCollection: new Backbone.Collection(SettingsOptions(overlaysCollection, mapDefModel, userModel)),\n        stateDefinitionModel: stateDefModel\n      });\n    }\n  }\n], {\n  tabPaneOptions: {\n    className: 'Editor-wrapper',\n    template: editorPaneTemplate,\n    url: userModel.get('base_url'),\n    avatar_url: userModel.get('avatar_url'),\n    tabPaneItemOptions: {\n      tagName: 'li',\n      className: 'EditorMenu-navigationItem'\n    }\n  },\n  tabPaneItemIconOptions: {\n    tagName: 'button',\n    template: editorPaneIconItemTemplate,\n    className: 'EditorMenu-navigationLink'\n  }\n});\n\n$('.js-editor').prepend(editorTabPaneView.render().$el);\n\neditorTabPaneView.listenTo(editorModel, 'change:edition', function (m) {\n  editorTabPaneView.$('.Editor-panelWrapper').toggleClass('is-larger', m.isEditing());\n});\neditorTabPaneView.add_related_model(editorModel);\n\nif (!configModel.get('cartodb_com_hosted')) {\n  var feedbackView = new FeedbackButtonView({ modals: modals });\n  $('.js-editorMenu').append(feedbackView.render().el);\n}\n\ndocument.title = visDefinitionModel.get('name') + ' |CARTO';\n\nif (window.__backboneAgent) {\n  window.__backboneAgent.handleBackbone(Backbone);\n}\n\n// Expose the root stuff to be able to inspect and modify state from\n// developer console (before views)\nwindow.configModel = configModel;\nwindow.modals = modals;\nwindow.onboardings = onboardings;\nwindow.userActions = userActions;\nwindow.userModel = userModel;\nwindow.viewFactory = viewFactory;\nwindow.visDefinitionModel = visDefinitionModel;\nwindow.layerDefinitionsCollection = layerDefinitionsCollection;\nwindow.widgetDefinitionsCollection = widgetDefinitionsCollection;\nwindow.analysisDefinitionsCollection = analysisDefinitionsCollection;\nwindow.analysisDefinitionNodesCollection = analysisDefinitionNodesCollection;\nwindow.legendDefinitionsCollection = legendDefinitionsCollection;\nwindow.editorModel = editorModel;\nwindow.mapDefModel = mapDefModel;\nwindow.overlaysCollection = overlaysCollection;\nwindow.mapcapsCollection = mapcapsCollection;\nwindow.stateDefModel = stateDefModel;\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-justifyCenter\">\\n  <div class=\"Modal-inner Modal-inner--grid u-flex u-justifyCenter\">\\n    <div class=\"Modal-icon\">\\n      <svg width=\"24px\" height=\"24px\" viewbox=\"459 348 24 24\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n        <g id=\"Export-dataset\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(459.000000, 348.000000)\">\\n          <path d=\"M1,1 L11,1 L11,5.5 C11,5.776 11.224,6 11.5,6 L16,6 L16,9.5 L17,9.5 L17,5.502 C17,5.502 17,5.502 17,5.501 C17,5.5 17,5.501 17,5.5 C17,5.447 16.985,5.398 16.97,5.35 C16.966,5.337 16.967,5.323 16.962,5.311 C16.936,5.247 16.896,5.19 16.847,5.142 L11.854,0.147 C11.808,0.101 11.753,0.064 11.692,0.039 C11.632,0.014 11.567,0 11.5,0 L0.5,0 C0.224,0 0,0.224 0,0.5 L0,21.5 C0,21.776 0.224,22 0.5,22 L10.5,22 L10.5,21 L1,21 L1,1 L1,1 Z M12,1.708 L15.291,5 L12,5 L12,1.708 L12,1.708 Z\" id=\"Shape\" fill=\"#2E3C43\"/>\\n          <path d=\"M17.5,11 C13.916,11 11,13.916 11,17.5 C11,21.084 13.916,24 17.5,24 C21.084,24 24,21.084 24,17.5 C24,13.916 21.084,11 17.5,11 L17.5,11 Z M17.5,23 C14.467,23 12,20.533 12,17.5 C12,14.467 14.467,12 17.5,12 C20.533,12 23,14.467 23,17.5 C23,20.533 20.533,23 17.5,23 L17.5,23 Z\" id=\"Shape\" fill=\"#2E3C43\"/>\\n          <path d=\"M17.858,14.425 C17.767,14.331 17.641,14.272 17.5,14.272 C17.359,14.272 17.232,14.331 17.142,14.425 L14.965,16.602 C14.77,16.797 14.77,17.114 14.965,17.309 C15.16,17.504 15.477,17.504 15.672,17.309 L17,15.981 L17,20.226 C17,20.502 17.224,20.726 17.5,20.726 C17.776,20.726 18,20.502 18,20.226 L18,15.981 L19.328,17.309 C19.426,17.407 19.554,17.455 19.682,17.455 C19.81,17.455 19.938,17.406 20.036,17.309 C20.231,17.114 20.231,16.797 20.036,16.602 L17.858,14.425 L17.858,14.425 Z\" id=\"Shape\" fill=\"#2E3C43\" transform=\"translate(17.500500, 17.499000) scale(1, -1) translate(-17.500500, -17.499000) \"/>\\n        </g>\\n      </svg>\\n    </div>\\n    <div>\\n      <h2 class=\" CDB-Text CDB-Size-huge is-light u-bSpace--xl\">'+\n((__t=( _t('editor.maps.export.confirmation.title', { name: name }) ))==null?'':_.escape(__t))+\n'</h2>\\n      <p class=\"CDB-Text CDB-Size-large u-altTextColor\">'+\n((__t=( _t('editor.maps.export.confirmation.desc') ))==null?'':_.escape(__t))+\n'</p>\\n      <ul class=\"Modal-listActions u-flex u-alignCenter\">\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--secondary CDB-Button--big js-cancel\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">\\n               '+\n((__t=( _t('editor.maps.export.confirmation.cancel') ))==null?'':_.escape(__t))+\n'\\n            </span>\\n          </button>\\n        </li>\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-confirm\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">\\n              '+\n((__t=( _t('editor.maps.export.confirmation.confirm') ))==null?'':_.escape(__t))+\n'\\n            </span>\\n          </button>\\n        </li>\\n      </ul>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Dialog-header\">\\n  <div class=\"Dialog-headerIcon Dialog-headerIcon--neutral\">\\n    <i class=\"CDB-IconFont CDB-IconFont-download\"></i>\\n  </div>\\n  <h2 class=\"CDB-Text CDB-Size-large u-bSpace\">\\n    '+\n((__t=( _t('editor.maps.export.download.title') ))==null?'':_.escape(__t))+\n'\\n  </h2>\\n  <h3 class=\"CDB-Text CDB-Size-medium u-altTextColor\">\\n    '+\n((__t=( _t('editor.maps.export.download.tip') ))==null?'':_.escape(__t))+\n'</br>\\n    '+\n((__t=( _t('editor.maps.export.download.desc') ))==null?'':_.escape(__t))+\n'\\n  </h3>\\n</div>\\n<div class=\"Dialog-footer--simple u-inner\">\\n  <button class=\"CDB-Button CDB-Button--primary u-tSpace--m js-download\">\\n    <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">\\n      '+\n((__t=( _t('editor.maps.export.download.confirm') ))==null?'':_.escape(__t))+\n'\\n    </span>\\n  </button>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar $ = require('jquery');\nvar _ = require('underscore');\nvar renderLoading = require('../../../../components/loading/render-loading.js');\nvar templateExportMapConfirmation = require('../../../components/modals/export-map/export-map-confirmation.tpl');\nvar templateExportMapDownload = require('../../../components/modals/export-map/export-map-download.tpl');\nvar ErrorView = require('../../../../components/error/error-view.js');\n\nvar ENTER_KEY_CODE = 13;\nvar REQUIRED_OPTS = [\n  'renderOpts',\n  'modalModel',\n  'exportMapModel'\n];\n\nmodule.exports = CoreView.extend({\n  className: 'Dialog-content',\n\n  events: {\n    'click .js-confirm': '_onConfirm',\n    'click .js-cancel': '_onCancel',\n    'click .js-download': '_download'\n  },\n\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (!opts[item]) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n\n    this._onKeyDown = this._onKeyDown.bind(this);\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    var state = this._exportMapModel.get('state');\n\n    if (state === 'complete') {\n      this._renderCompleteView();\n    } else if (state === 'pending' || state === 'exporting' || state === 'uploading') {\n      this._renderLoadingView(state);\n    } else if (state === 'failure') {\n      this._renderFailureView();\n    } else {\n      this._renderConfirmationView();\n    }\n  },\n\n  _renderCompleteView: function () {\n    var w = window.open(this._exportMapModel.get('url'));\n\n    // If w is nullish, popup was blocked: we show a \"click to download\" modal. Else, download has started.\n    if (w == null) {\n      this.$el.html(templateExportMapDownload());\n    } else {\n      w.focus();\n      this._modalModel.destroy();\n    }\n  },\n\n  _renderLoadingView: function (state) {\n    var loadingTitle = state.charAt(0).toUpperCase() + state.slice(1) + ' ...';\n\n    this.$el.html(\n      renderLoading({\n        title: loadingTitle\n      })\n    );\n  },\n\n  _renderFailureView: function () {\n    var errorView = new ErrorView({\n      title: _t('editor.maps.export.error.title'),\n      desc: _t('editor.maps.export.error.desc')\n    });\n\n    this.$el.html(errorView.render().el);\n  },\n\n  _renderConfirmationView: function () {\n    this.$el.html(\n      templateExportMapConfirmation({\n        name: this._renderOpts.name\n      })\n    );\n  },\n\n  _initBinds: function () {\n    $(document).bind('keydown', this._onKeyDown);\n\n    this._exportMapModel.bind('change:state', function () {\n      this.render();\n    }, this);\n  },\n\n  _disableBinds: function () {\n    $(document).unbind('keydown', this._onKeyDown);\n  },\n\n  _onKeyDown: function (ev) {\n    var keyCode = ev.which;\n    if (keyCode === ENTER_KEY_CODE) {\n      this._onConfirm();\n    }\n  },\n\n  _onConfirm: function () {\n    this._exportMapModel.requestExport();\n  },\n\n  _onCancel: function () {\n    this._exportMapModel.cancelExport();\n\n    this._modalModel.destroy();\n  },\n\n  _download: function () {\n    window.open(this._exportMapModel.get('url'));\n    window.focus();\n\n    this._modalModel.destroy();\n  },\n\n  clean: function () {\n    this._disableBinds();\n    CoreView.prototype.clean.apply(this);\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./overlay.tpl');\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    if (!opts.overlayModel) throw new Error('overlayModel is required');\n    this.overlayModel = opts.overlayModel;\n    this._initBinds();\n  },\n\n  render: function () {\n    this.$el.empty();\n    this.$el.append(template({\n      visible: !this.overlayModel.get('visible') ? 'is-hidden' : ''\n    }));\n    return this;\n  },\n\n  _initBinds: function () {\n    this.listenTo(this.overlayModel, 'change:visible', this.render);\n    this.add_related_model(this.overlayModel);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Disable-overlay '+\n((__t=( visible ))==null?'':_.escape(__t))+\n'\"></div>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-justifyCenter\">\\n  <div class=\"Modal-inner Modal-inner--grid u-flex u-justifyCenter\">\\n    <div class=\"Modal-icon\">\\n      <svg width=\"24px\" height=\"25px\" viewbox=\"521 436 24 25\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n        <path d=\"M524.5,440 L540.5,440 L540.5,460 L524.5,460 L524.5,440 Z M528.5,437 L536.5,437 L536.5,440 L528.5,440 L528.5,437 Z M522,440 L544,440 L522,440 Z M528.5,443.5 L528.5,455.5 L528.5,443.5 Z M532.5,443.5 L532.5,455.5 L532.5,443.5 Z M536.5,443.5 L536.5,455.5 L536.5,443.5 Z\" id=\"Shape\" stroke=\"#F19243\" stroke-width=\"1\" fill=\"none\"/>\\n      </svg>\\n    </div>\\n    <div>\\n      <h2 class=\" CDB-Text CDB-Size-huge is-light u-bSpace--xl\">\\n     '+\n((__t=( _t('editor.maps.delete.title', { name: name }) ))==null?'':_.escape(__t))+\n'</h2>\\n      <p class=\"CDB-Text CDB-Size-large u-altTextColor\">'+\n((__t=( _t('editor.maps.delete.desc') ))==null?'':_.escape(__t))+\n'</p>\\n      <ul class=\"Modal-listActions u-flex u-alignCenter\">\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--secondary CDB-Button--big js-cancel\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">\\n              '+\n((__t=( _t('editor.maps.delete.cancel') ))==null?'':_.escape(__t))+\n'\\n            </span>\\n          </button>\\n        </li>\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-confirm\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">\\n              '+\n((__t=( _t('editor.maps.delete.confirm') ))==null?'':_.escape(__t))+\n'\\n            </span>\\n          </button>\\n        </li>\\n      </ul>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar template = require('./editor-header.tpl');\nvar moment = require('moment');\nvar ConfirmationView = require('../components/modals/confirmation/modal-confirmation-view');\nvar EditMetadataView = require('../components/modals/map-metadata/map-metadata-view');\nvar templateConfirmation = require('./delete-map-confirmation.tpl');\nvar ExportView = require('./components/modals/export-map/modal-export-map-view');\nvar ExportMapModel = require('../data/export-map-definition-model.js');\nvar removeMap = require('./map-operations/remove-map');\nvar renameMap = require('./map-operations/rename-map');\nvar InlineEditorView = require('../components/inline-editor/inline-editor-view');\nvar templateInlineEditor = require('./inline-editor.tpl');\nvar CreationModalView = require('../components/modals/creation/modal-creation-view');\nvar VisDefinitionModel = require('../data/vis-definition-model');\nvar errorParser = require('../helpers/error-parser');\nvar ShareWith = require('../components/modals/publish/share-with-view');\nvar ContextMenuFactory = require('../components/context-menu-factory-view');\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-privacy': '_onClickPrivacy'\n  },\n\n  initialize: function (opts) {\n    if (!opts.editorModel) throw new Error('editorModel is required');\n    if (!opts.modals) throw new Error('modals is required');\n    if (!opts.visDefinitionModel) throw new Error('visDefinitionModel is required');\n    if (!opts.privacyCollection) throw new Error('privacyCollection is required');\n    if (!opts.onClickPrivacy) throw new Error('onClickPrivacy is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.userModel) throw new Error('userModel is required');\n\n    this._userModel = opts.userModel;\n    this._editorModel = opts.editorModel;\n    this._configModel = opts.configModel;\n    this._modals = opts.modals;\n    this._visDefinitionModel = opts.visDefinitionModel;\n    this._title = this._visDefinitionModel.get('name');\n    this._privacyCollection = opts.privacyCollection;\n    this._mapcapsCollection = opts.mapcapsCollection;\n\n    _.bind(this._changeStyle, this);\n    this._bindEvents();\n  },\n\n  render: function () {\n    var model = this._privacyCollection.searchByPrivacy(this._visDefinitionModel.get('privacy'));\n    var published = this._mapcapsCollection.length > 0\n                    ? _t('editor.published', { when: moment(this._mapcapsCollection.first().get('created_at')).fromNow() })\n                    : _t('editor.unpublished');\n    this.$el.html(\n      template({\n        title: this._title,\n        privacy: model.get('privacy'),\n        cssClass: model.get('cssClass'),\n        avatar: this._userModel.get('avatar_url'),\n        isSimple: !this._userModel.isInsideOrg(),\n        published: published\n      })\n    );\n\n    this._initViews();\n    return this;\n  },\n\n  _initViews: function () {\n    var self = this;\n    this._inlineEditor = new InlineEditorView({\n      template: templateInlineEditor,\n      renderOptions: {\n        name: self._visDefinitionModel.get('name')\n      },\n      onEdit: self._renameMap.bind(self)\n    });\n\n    this.$('.js-header').append(this._inlineEditor.render().el);\n    this.addView(this._inlineEditor);\n\n    var shareWith = new ShareWith({\n      visDefinitionModel: this._visDefinitionModel,\n      userModel: this._userModel,\n      action: this._onClickPrivacy.bind(this),\n      separationClass: 'u-rSpace--m'\n    });\n\n    this.$('.js-share-users').append(shareWith.render().el);\n    this.addView(shareWith);\n\n    var menuItems = [{\n      label: _t('editor.maps.options.rename'),\n      val: 'rename-map',\n      action: this._onRenameMap.bind(this)\n    }, {\n      label: _t('editor.maps.options.duplicate'),\n      val: 'duplicate-map',\n      action: this._duplicateMap.bind(this)\n    }, {\n      label: _t('editor.maps.options.edit-metadata'),\n      val: 'metadata-map',\n      action: this._editMetadata.bind(this)\n    }, {\n      label: _t('editor.maps.options.export-map'),\n      val: 'export-map',\n      action: this._exportMap.bind(this)\n    }, {\n      label: _t('editor.maps.options.export-image'),\n      val: 'export-image',\n      action: this._exportImage.bind(this)\n    }, {\n      label: _t('editor.maps.options.remove'),\n      val: 'delete-map',\n      destructive: true,\n      action: this._confirmDeleteLayer.bind(this)\n    }];\n\n    this._contextMenuFactory = new ContextMenuFactory({\n      menuItems: menuItems\n    });\n\n    this.$('.js-context-menu').append(this._contextMenuFactory.render().el);\n    this.addView(this._contextMenuFactory);\n  },\n\n  _bindEvents: function () {\n    this.listenTo(this._visDefinitionModel, 'change:privacy change:name', this.render);\n    this.add_related_model(this._visDefinitionModel);\n\n    this.listenTo(this._editorModel, 'change:edition', this._changeStyle);\n    this.add_related_model(this._editorModel);\n\n    this._mapcapsCollection.on('add reset', this.render, this);\n    this._mapcapsCollection.on('change:status', this.render, this);\n    this.add_related_model(this._mapcapsCollection);\n  },\n\n  _renameMap: function () {\n    var newName = this._inlineEditor.getValue();\n\n    if (newName !== '' && newName !== this._visDefinitionModel.get('name')) {\n      // Speed!\n      this._onRenameSuccess(newName);\n\n      renameMap({\n        newName: newName,\n        visDefinitionModel: this._visDefinitionModel,\n        onError: this._onRenameError.bind(this)\n      });\n    }\n  },\n\n  _onRenameMap: function () {\n    this._inlineEditor.edit();\n  },\n\n  _duplicateMap: function () {\n    var self = this;\n    var mapName = this._visDefinitionModel.get('name');\n\n    this._modals.create(function (modalModel) {\n      return new CreationModalView({\n        modalModel: modalModel,\n        loadingTitle: _t('editor.maps.duplicate.loading', { name: mapName }),\n        errorTitle: _t('editor.maps.duplicate.error', { name: mapName }),\n        runAction: function (opts) {\n          var newVisModel = new VisDefinitionModel({\n            name: mapName\n          }, {\n            configModel: self._configModel\n          });\n\n          newVisModel.save({\n            source_visualization_id: self._visDefinitionModel.get('id')\n          }, {\n            success: function (visModel) {\n              window.location = visModel.builderURL();\n            },\n            error: function (mdl, e) {\n              opts.error && opts.error(errorParser(e));\n            }\n          });\n        }\n      });\n    });\n  },\n\n  _confirmDeleteLayer: function () {\n    var self = this;\n    var mapName = this._visDefinitionModel.get('name');\n\n    this._modals.create(function (modalModel) {\n      return new ConfirmationView({\n        modalModel: modalModel,\n        template: templateConfirmation,\n        loadingTitle: _t('editor.maps.delete.loading', {name: mapName}),\n        renderOpts: {\n          name: mapName\n        },\n        runAction: function () {\n          removeMap({\n            onSuccess: self._onSuccessDestroyMap.bind(self, modalModel),\n            onError: self._onErrorDestroyMap.bind(self, modalModel),\n            visDefinitionModel: self._visDefinitionModel\n          });\n        }\n      });\n    });\n  },\n\n  _exportMap: function () {\n    var mapName = this._visDefinitionModel.get('name');\n    var visID = this._visDefinitionModel.get('id');\n\n    var exportMapModel = new ExportMapModel({\n      visualization_id: visID\n    }, {\n      configModel: this._configModel\n    });\n\n    this._modals.create(function (modalModel) {\n      return new ExportView({\n        modalModel: modalModel,\n        exportMapModel: exportMapModel,\n        renderOpts: {\n          name: mapName\n        }\n      });\n    });\n  },\n\n  _exportImage: function () {\n    this.trigger('export-image', this);\n  },\n\n  _editMetadata: function () {\n    var self = this;\n\n    this._modals.create(function (modalModel) {\n      return new EditMetadataView({\n        modalModel: modalModel,\n        visDefinitionModel: self._visDefinitionModel\n      });\n    });\n  },\n\n  _onSuccessDestroyMap: function (modal) {\n    this.options.onRemoveMap && this.options.onRemoveMap();\n  },\n\n  _onErrorDestroyMap: function (modal) {\n    modal.destroy();\n  },\n\n  _onRenameSuccess: function (newName) {\n    this.$('.js-title').text(newName).show();\n    this._inlineEditor.hide();\n  },\n\n  _onRenameError: function (oldName) {\n    this.$('.js-title').text(oldName).show();\n    this._inlineEditor.hide();\n  },\n\n  _changeStyle: function (m) {\n    this._getTitle().toggleClass('is-dark', m.isEditing());\n  },\n\n  _getTitle: function () {\n    return this.$('.Editor-HeaderInfo');\n  },\n\n  _onClickPrivacy: function () {\n    this.options.onClickPrivacy && this.options.onClickPrivacy();\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-HeaderInfoEditor\">\\n  <div class=\"Editor-HeaderInfo-inner Editor-HeaderInfo-inner--wide\">\\n    <div class=\"Editor-HeaderInfo-title u-bSpace--m js-context-menu\">\\n      <div class=\"Editor-HeaderInfo-titleText u-bSpace js-header\">\\n      </div>\\n    </div>\\n    <div class=\"u-bSpace--xl u-flex u-alignCenter\">\\n      <button class=\"u-rSpace--m u-actionTextColor js-privacy\">\\n        <i class=\"Tag Tag-fill Tag-fill--'+\n((__t=( cssClass ))==null?'':_.escape(__t))+\n' CDB-Text CDB-Size-small u-upperCase\">'+\n((__t=( privacy ))==null?'':_.escape(__t))+\n'</i>\\n      </button>\\n      ';\n if (!isSimple) { \n__p+='\\n      <div class=\"js-share-users\"></div>\\n      ';\n } \n__p+='\\n      <p class=\"Editor-HeaderInfo-publishDate u-ellipsis CDB-Text CDB-Size-medium u-altTextColor\">'+\n((__t=( published ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "module.exports = [{\n  keywords: 'buffer-size',\n  type: 'Map'\n}, {\n  keywords: 'marker-fill marker-width marker-fill-opacity marker-opacity marker-line-color marker-line-width marker-line-opacity marker-comp-op marker-allow-overlap marker-file marker-type marker-height marker-width marker-transform marker-placement marker-ignore-placement marker-spacing marker-avoid-edges point-file point-opacity point-comp-op point-allow-overlap point-placement point-ignore-placement point-transform',\n  type: 'Points'\n}, {\n  keywords: 'line-color line-width line-opacity line-comp-op line-pattern-file line-join line-cap line-dasharray line-dash-offset line-offset line-simplify line-simplify-algorithm line-smooth line-clip',\n  type: 'Lines'\n}, {\n  keywords: 'polygon-fill polygon-opacity polygon-comp-op polygon-pattern-file polygon-pattern-alignment polygon-pattern-opacity polygon-smooth polygon-simplify polygon-simplify-algorithm polygon-gamma polygon-gamma-method polygon-geometry-transform polygon-clip',\n  type: 'Polygons'\n}, {\n  keywords: 'text-name text-face-name text-size text-fill text-opacity text-comp-op text-halo-radius text-halo-fill text-halo-rasterizer text-allow-overlap text-transform text-placement text-placement-type text-dx text-dy text-wrap-width text-wrap-before text-character-spacing text-line-spacing text-min-distance text-avoid-edges text-orientation text-vertical-alignment',\n  type: 'Text'\n}, {\n  keywords: 'building-fill building-fill-opacity building-height',\n  type: 'Building'\n}, {\n  keywords: 'shield-name shield-face-name shield-size shield-file shield-fill shield-opacity shield-text-opacity shield-allow-overlap shield-placements shield-placement-type shield-dy shield-dx shield-text-dx shield-text-dy shield-min-distance shield-avoid-edges',\n  type: 'Shield'\n}, {\n  keywords: 'image-filters comp-op opacity',\n  type: ''\n}];\n",
    "var _ = require('underscore');\nvar TableNameUtils = require('../../helpers/table-name-utils');\n\nvar memo = {};\n\nvar OPTIONAL_OPTS = [\n  'querySchemaModel',\n  'layerDefinitionModel',\n  'tokens'\n];\n\nvar defaults = {\n  tableName: true,\n  columnsName: true,\n  keywords: true\n};\n\nmodule.exports = {\n  init: function (opts) {\n    if (!opts) throw new Error('options are required for hints');\n\n    this.options = _.defaults(\n      _.pick(opts, ['tableName', 'columnsName', 'keywords'])\n      , defaults\n    );\n\n    _.each(OPTIONAL_OPTS, function (item) {\n      this['_' + item] = opts[item];\n    }, this);\n  },\n\n  hints: function () {\n    // array of objects {text, type}\n    return this.hints;\n  },\n\n  reset: function () {\n    this.hints = _.union(this._getTableName(), this._getColumns(), this._getKeywords());\n    return this;\n  },\n\n  _getKeywords: function () {\n    if (this.options.keywords) {\n      return this._tokens && this._memo(this._tokens);\n    } else {\n      return [];\n    }\n  },\n\n  _getColumns: function () {\n    if (!this.options.columnsName) {\n      return [];\n    }\n\n    var columns = this._querySchemaModel.columnsCollection;\n    return columns.map(function (mdl) {\n      var columnName = mdl.get('name');\n      return {\n        text: columnName,\n        type: 'Column_name'\n      };\n    });\n  },\n\n  _getTableName: function () {\n    if (!this.options.tableName) {\n      return [];\n    }\n\n    var tableName = this._layerDefinitionModel.getTableName();\n    tableName = TableNameUtils.getUnqualifiedName(tableName);\n    return [{\n      text: tableName,\n      type: 'Table_name'\n    }];\n  },\n\n  _memo: function (str, type) {\n    if (str in memo) {\n      return memo[str];\n    } else {\n      return (memo[str] = this._make(str, type));\n    }\n  },\n\n  _make: function (str, type) {\n    return _.chain(str).map(function (set) {\n      return set.keywords.split(' ').map(function (item) {\n        return {\n          text: item,\n          type: set.type\n        };\n      });\n    }).flatten().value();\n  }\n};\n",
    "module.exports = [{\n  keywords: 'alter and as asc between by count create delete desc distinct drop from group having in insert into is join like not on or order select set table union update values where limit',\n  type: 'Sql'\n}, {\n  keywords: 'ST_GeometryType ST_polygon ST_multipolygon ST_multilinestring ST_linestring ST_multipoint ST_point',\n  type: 'Postgis'\n}];\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar checkAndBuildOpts = require('../helpers/required-opts');\nvar EditorView = require('./editor-view');\nvar AnalysesService = require('./layers/layer-content-views/analyses/analyses-service');\nvar StackLayoutView = require('../components/stack-layout/stack-layout-view');\nvar BasemapContentView = require('./layers/basemap-content-view');\nvar LayerContentView = require('./layers/layer-content-view');\nvar EditFeatureContentView = require('./layers/edit-feature-content-view');\nvar WidgetsFormContentView = require('./widgets/widgets-form/widgets-form-content-view');\nvar Notifier = require('../components/notifier/notifier');\nvar WidgetsService = require('./widgets/widgets-service');\n\nvar REQUIRED_OPTS = [\n  'userActions',\n  'basemaps',\n  'visDefinitionModel',\n  'layerDefinitionsCollection',\n  'analysisDefinitionNodesCollection',\n  'legendDefinitionsCollection',\n  'widgetDefinitionsCollection',\n  'mapcapsCollection',\n  'privacyCollection',\n  'modals',\n  'onboardings',\n  'userModel',\n  'configModel',\n  'editorModel',\n  'pollingModel',\n  'mapDefinitionModel',\n  'mapModeModel',\n  'stateDefinitionModel',\n  'onboardingNotification'\n];\n\nmodule.exports = CoreView.extend({\n  className: 'MapEditor Editor-panel',\n\n  events: {\n    'click .js-add-analysis': '_onAddAnalysisClicked',\n    'click .js-georeference': '_onGeoreferenceClicked'\n  },\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    this._initBinds();\n  },\n\n  render: function () {\n    var self = this;\n\n    var stackViewCollection = new Backbone.Collection([{\n      createStackView: function (stackLayoutModel, opts) {\n        var selectedTabItem = opts[0] || 'layers';\n\n        return new EditorView({\n          className: 'Editor-content',\n          modals: self._modals,\n          userModel: self._userModel,\n          userActions: self._userActions,\n          configModel: self._configModel,\n          editorModel: self._editorModel,\n          pollingModel: self._pollingModel,\n          mapDefinitionModel: self._mapDefinitionModel,\n          visDefinitionModel: self._visDefinitionModel,\n          layerDefinitionsCollection: self._layerDefinitionsCollection,\n          analysisDefinitionNodesCollection: self._analysisDefinitionNodesCollection,\n          widgetDefinitionsCollection: self._widgetDefinitionsCollection,\n          mapcapsCollection: self._mapcapsCollection,\n          privacyCollection: self._privacyCollection,\n          mapStackLayoutModel: stackLayoutModel,\n          selectedTabItem: selectedTabItem,\n          mapModeModel: self._mapModeModel,\n          stateDefinitionModel: self._stateDefinitionModel\n        });\n      }\n    }, {\n      createStackView: function (stackLayoutModel, opts) {\n        var viewType = opts[1];\n\n        switch (viewType) {\n          case 'basemaps':\n            return new BasemapContentView({\n              className: 'Editor-content',\n              basemaps: self._basemaps,\n              layerDefinitionsCollection: self._layerDefinitionsCollection,\n              stackLayoutModel: stackLayoutModel,\n              customBaselayersCollection: self._userModel.layers,\n              modals: self._modals,\n              configModel: self._configModel\n            });\n          case 'layer-content':\n            var layerDefinitionModel = opts[0];\n            var selectedTabItem = opts[2];\n            var analysisPayload = opts[3];\n\n            return new LayerContentView({\n              className: 'Editor-content',\n              userActions: self._userActions,\n              userModel: self._userModel,\n              layerDefinitionModel: layerDefinitionModel,\n              mapDefinitionModel: self._mapDefinitionModel,\n              widgetDefinitionsCollection: self._widgetDefinitionsCollection,\n              layerDefinitionsCollection: self._layerDefinitionsCollection,\n              analysisDefinitionNodesCollection: self._analysisDefinitionNodesCollection,\n              legendDefinitionsCollection: self._legendDefinitionsCollection,\n              analysis: self._analysis,\n              modals: self._modals,\n              onboardings: self._onboardings,\n              stackLayoutModel: stackLayoutModel,\n              analysisPayload: analysisPayload,\n              configModel: self._configModel,\n              editorModel: self._editorModel,\n              mapModeModel: self._mapModeModel,\n              stateDefinitionModel: self._stateDefinitionModel,\n              onboardingNotification: self._onboardingNotification,\n              visDefinitionModel: self._visDefinitionModel,\n              selectedTabItem: selectedTabItem\n            });\n          case 'widget-content':\n            var widgetDefinitionModel = opts[0];\n            var stackLayoutPrevStep = opts[1];\n\n            return new WidgetsFormContentView({\n              className: 'Editor-content',\n              modals: self._modals,\n              userModel: self._userModel,\n              configModel: self._configModel,\n              userActions: self._userActions,\n              widgetDefinitionModel: widgetDefinitionModel,\n              layerDefinitionsCollection: self._layerDefinitionsCollection,\n              analysisDefinitionNodesCollection: self._analysisDefinitionNodesCollection,\n              stackLayoutPrevStep: stackLayoutPrevStep,\n              stackLayoutModel: stackLayoutModel\n            });\n          case 'element-content':\n            console.log(viewType + 'view is not implemented yet');\n            break;\n          default:\n            console.log(viewType + 'view doesn\\'t exist');\n        }\n      }\n    }, {\n      createStackView: function (stackLayoutModel, opts) {\n        var layerDefinitionModel = opts[0];\n        var isValidGeometry = opts[1];\n\n        return new EditFeatureContentView({\n          layerDefinitionModel: layerDefinitionModel,\n          configModel: self._configModel,\n          stackLayoutModel: stackLayoutModel,\n          mapModeModel: self._mapModeModel,\n          editorModel: self._editorModel,\n          model: new Backbone.Model({\n            hasChanges: false,\n            isValidAttributes: true,\n            isValidGeometry: isValidGeometry\n          }),\n          modals: self._modals\n        });\n      }\n    }]);\n\n    this._stackLayoutView = new StackLayoutView({\n      className: 'Editor-content',\n      collection: stackViewCollection\n    });\n\n    this.$el.append(this._stackLayoutView.render().$el);\n    this.addView(this._stackLayoutView);\n\n    var notifierView = Notifier.getView();\n    this.$el.append(notifierView.render().el);\n    this.addView(notifierView);\n\n    this._setServices();\n\n    return this;\n  },\n\n  _setServices: function () {\n    AnalysesService.setStackLayoutView(this._stackLayoutView);\n\n    WidgetsService.setStackLayoutBehaviour(\n      this._stackLayoutView.model,\n      {\n        position: 1,\n        arguments: 'widget-content'\n      }, {\n        position: 0,\n        arguments: 'widgets'\n      }\n    );\n  },\n\n  _initBinds: function () {\n    this._editorModel.on('change:edition', this._changeStyle, this);\n    this.add_related_model(this._editorModel);\n\n    this._mapModeModel.on('change:mode', this._onMapModeChanged, this);\n    this.add_related_model(this._mapModeModel);\n  },\n\n  _onMapModeChanged: function (mapModeModel) {\n    var stackLayoutModel = this._stackLayoutView.model;\n\n    if (mapModeModel.isEditingFeatureMode() || mapModeModel.isDrawingFeatureMode()) {\n      var feature = mapModeModel.getFeatureDefinition();\n      stackLayoutModel.goToStep(2, feature.getLayerDefinition(), !feature.isNew());\n    } else {\n      stackLayoutModel.goBack();\n    }\n  },\n\n  _changeStyle: function () {\n    this.$el.toggleClass('is-dark', this._editorModel.isEditing());\n  },\n\n  _onAddAnalysisClicked: function () {\n    AnalysesService.addAnalysis();\n  },\n\n  _onGeoreferenceClicked: function () {\n    AnalysesService.addGeoreferenceAnalysis();\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<i class=\"CDB-IconFont CDB-IconFont-'+\n((__t=( icon ))==null?'':_.escape(__t))+\n' EditorMenu-navigationIcon\"></i>\\n';\n}\nreturn __p;\n};\n",
    "var $ = require('jquery');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar createTextLabelsTabPane = require('../components/tab-pane/create-text-labels-tab-pane');\nvar AddWidgetsView = require('../components/modals/add-widgets/add-widgets-view');\nvar AddLayerView = require('../components/modals/add-layer/add-layer-view');\nvar AddLayerModel = require('../components/modals/add-layer/add-layer-model');\nvar StackLayoutView = require('../components/stack-layout/stack-layout-view');\nvar Header = require('./editor-header.js');\nvar EditorTabPaneTemplate = require('./editor-tab-pane.tpl');\nvar EditorWidgetsView = require('./widgets/widgets-view');\nvar LayersView = require('./layers/layers-view');\nvar ScrollView = require('../components/scroll/scroll-view');\nvar PanelWithOptionsView = require('../components/view-options/panel-with-options-view');\nvar ShareButtonView = require('./layers/share-button-view');\nvar PublishView = require('../components/modals/publish/publish-view');\nvar checkAndBuildOpts = require('../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'userActions',\n  'modals',\n  'configModel',\n  'userModel',\n  'editorModel',\n  'pollingModel',\n  'analysisDefinitionNodesCollection',\n  'layerDefinitionsCollection',\n  'privacyCollection',\n  'widgetDefinitionsCollection',\n  'mapcapsCollection',\n  'visDefinitionModel',\n  'mapStackLayoutModel',\n  'stateDefinitionModel',\n  'selectedTabItem'\n];\n\nmodule.exports = CoreView.extend({\n\n  className: 'Editor-content',\n\n  events: {\n    'click .js-add': '_addItem'\n  },\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    this._initModels();\n    this._initBinds();\n  },\n\n  render: function () {\n    var self = this;\n\n    this.clearSubViews();\n    this.$el.empty();\n\n    var tabPaneTabs = [{\n      name: 'layers',\n      label: _t('editor.tab-pane.layers.title-label'),\n      selected: this._selectedTabItem === 'layers',\n      createContentView: function () {\n        var layersStackViewCollection = new Backbone.Collection([{\n          createStackView: function (stackLayoutModel, opts) {\n            return new PanelWithOptionsView({\n              className: 'Editor-content js-editorPanelContent',\n              editorModel: self._editorModel,\n              createContentView: function () {\n                return new ScrollView({\n                  createContentView: function () {\n                    return new LayersView({\n                      modals: self._modals,\n                      userModel: self._userModel,\n                      editorModel: self._editorModel,\n                      configModel: self._configModel,\n                      userActions: self._userActions,\n                      layerDefinitionsCollection: self._layerDefinitionsCollection,\n                      analysisDefinitionNodesCollection: self._analysisDefinitionNodesCollection,\n                      stackLayoutModel: self._mapStackLayoutModel,\n                      stateDefinitionModel: self._stateDefinitionModel,\n                      widgetDefinitionsCollection: self._widgetDefinitionsCollection,\n                      visDefinitionModel: self._visDefinitionModel\n                    });\n                  }\n                });\n              },\n              createActionView: function () {\n                return new ShareButtonView({\n                  visDefinitionModel: self._visDefinitionModel,\n                  onClickAction: self._share.bind(self)\n                });\n              }\n            });\n          }\n        }]);\n\n        return new StackLayoutView({\n          className: 'Editor-content',\n          collection: layersStackViewCollection\n        });\n      }\n    }, {\n      name: 'widgets',\n      label: _t('editor.tab-pane.widgets.title-label'),\n      selected: this._selectedTabItem === 'widgets',\n      createContentView: function () {\n        var widgetsStackViewCollection = new Backbone.Collection([{\n          createStackView: function (stackLayoutModel, opts) {\n            return new PanelWithOptionsView({\n              className: 'Editor-content',\n              editorModel: self._editorModel,\n              createContentView: function () {\n                return new ScrollView({\n                  createContentView: function () {\n                    return new EditorWidgetsView({\n                      userActions: self._userActions,\n                      modals: self._modals,\n                      layerDefinitionsCollection: self._layerDefinitionsCollection,\n                      widgetDefinitionsCollection: self._widgetDefinitionsCollection,\n                      stackLayoutModel: self._mapStackLayoutModel\n                    });\n                  }\n                });\n              },\n              createActionView: function () {\n                return new ShareButtonView({\n                  visDefinitionModel: self._visDefinitionModel,\n                  onClickAction: self._share.bind(self)\n                });\n              }\n            });\n          }\n        }]);\n\n        return new StackLayoutView({\n          className: 'Editor-content',\n          collection: widgetsStackViewCollection\n        });\n      }\n    }];\n\n    var header = new Header({\n      editorModel: self._editorModel,\n      mapcapsCollection: self._mapcapsCollection,\n      modals: self._modals,\n      visDefinitionModel: self._visDefinitionModel,\n      privacyCollection: self._privacyCollection,\n      onClickPrivacy: self._share.bind(self),\n      onRemoveMap: self._onRemoveMap.bind(self),\n      configModel: self._configModel,\n      userModel: self._userModel\n    });\n\n    header.bind('export-image', this._onExportImage, this);\n\n    this.$el.append(header.render().$el);\n    this.addView(header);\n\n    var tabPaneOptions = {\n      tabPaneOptions: {\n        template: EditorTabPaneTemplate,\n        tabPaneItemOptions: {\n          tagName: 'li',\n          className: 'CDB-NavMenu-item'\n        }\n      },\n      tabPaneItemLabelOptions: {\n        tagName: 'button',\n        className: 'CDB-NavMenu-link u-upperCase'\n      }\n    };\n\n    this._mapTabPaneView = createTextLabelsTabPane(tabPaneTabs, tabPaneOptions);\n    this._mapTabPaneView.collection.bind('change:selected', this._updateAddButtonState, this);\n\n    this.$el.append(this._mapTabPaneView.render().$el);\n    this.addView(this._mapTabPaneView);\n\n    this._updateAddButtonState();\n\n    return this;\n  },\n\n  _initModels: function () {\n    this._updatedModel = new Backbone.Model({\n      date: ''\n    });\n  },\n\n  _initBinds: function () {\n    this.listenTo(this._widgetDefinitionsCollection, 'reset remove add', this._updateAddButtonState);\n    this.listenTo(this._editorModel, 'change:edition', this._changeStyle);\n    this.listenTo(this._layerDefinitionsCollection, 'reset remove add', this._updateAddButtonState);\n    this.listenTo(this._layerDefinitionsCollection, 'add', function () {\n      this._visDefinitionModel.fetch();\n    });\n  },\n\n  _onExportImage: function () {\n    this.trigger('export-image', this);\n  },\n\n  _onRemoveMap: function () {\n    window.location = this._userModel.get('base_url');\n  },\n\n  _hideAddButton: function () {\n    this.$('.js-add').addClass('is-hidden');\n  },\n\n  _showAddButton: function () {\n    this.$('.js-add').removeClass('is-hidden');\n  },\n\n  _updateAddButtonState: function () {\n    this._hideAddButton();\n\n    switch (this._mapTabPaneView.getSelectedTabPaneName()) {\n      case 'widgets':\n        if (this._widgetDefinitionsCollection.size()) {\n          this._showAddButton();\n        }\n        break;\n      case 'layers':\n        if (this._layerDefinitionsCollection.size()) {\n          this._showAddButton();\n        }\n        break;\n      case 'elements':\n        // TODO: trigger element creation\n        break;\n    }\n  },\n\n  _addItem: function () {\n    switch (this._mapTabPaneView.getSelectedTabPaneName()) {\n      case 'layers': return this._addLayer();\n      case 'widgets': return this._addWidget();\n    }\n  },\n\n  _addLayer: function () {\n    var self = this;\n    var modal = this._modals.create(function (modalModel) {\n      var addLayerModel = new AddLayerModel({}, {\n        userModel: self._userModel,\n        userActions: self._userActions,\n        configModel: self._configModel,\n        pollingModel: self._pollingModel\n      });\n\n      return new AddLayerView({\n        modalModel: modalModel,\n        configModel: self._configModel,\n        userModel: self._userModel,\n        createModel: addLayerModel,\n        pollingModel: self._pollingModel\n      });\n    });\n    modal.show();\n  },\n\n  _addWidget: function () {\n    var self = this;\n\n    this._modals.create(function (modalModel) {\n      return new AddWidgetsView({\n        modalModel: modalModel,\n        userModel: self._userModel,\n        userActions: self._userActions,\n        configModel: self._configModel,\n        analysisDefinitionNodesCollection: self._analysisDefinitionNodesCollection,\n        layerDefinitionsCollection: self._layerDefinitionsCollection,\n        widgetDefinitionsCollection: self._widgetDefinitionsCollection\n      });\n    });\n  },\n\n  _share: function () {\n    var self = this;\n\n    this._modals.create(function (modalModel) {\n      return new PublishView({\n        mapcapsCollection: self._mapcapsCollection,\n        modalModel: modalModel,\n        visDefinitionModel: self._visDefinitionModel,\n        privacyCollection: self._privacyCollection,\n        userModel: self._userModel,\n        configModel: self._configModel\n      });\n    });\n  },\n\n  _changeStyle: function (m) {\n    this.$el.toggleClass('is-dark');\n    this._mapTabPaneView.changeStyleMenu(m);\n  },\n\n  _setUpdateFromCreation: function () {\n    this._updatedModel.set({date: this._visDefinitionModel.get('created_at')});\n  },\n\n  _setUpdateFromMapcap: function (mapcaps) {\n    this._updatedModel.set({date: mapcaps[0].created_at});\n  },\n\n  _getMapcaps: function () {\n    var updateFromCreation = this._setUpdateFromCreation.bind(this);\n    var updateFromMapcap = this._setUpdateFromMapcap.bind(this);\n    var url = this._visDefinitionModel.mapcapsURL();\n    var data = {\n      api_key: this._configModel.get('api_key')\n    };\n\n    $.get(url, data)\n      .done(function (data) {\n        if (data.length > 0) {\n          updateFromMapcap(data);\n        } else {\n          updateFromCreation();\n        }\n      })\n      .fail(function () {\n        updateFromCreation();\n      });\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"EditorMenu js-editorMenu\">\\n  <a class=\"EditorMenu-logo\" href=\"'+\n((__t=( url ))==null?'':_.escape(__t))+\n'\">\\n    <svg width=\"32px\" height=\"32px\" viewBox=\"762 -58 32 32\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n      <g class=\"imago\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(762.000000, -58.000000)\">\\n        <circle class=\"Halo\" fill=\"#FFFFFF\" opacity=\"0.2\" cx=\"16\" cy=\"16\" r=\"16\"></circle>\\n        <circle class=\"point\" fill=\"#FFFFFF\" cx=\"16\" cy=\"16\" r=\"5\"></circle>\\n        <g class=\"arrow\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(11.000000, 16.000000)\">\\n          <rect id=\"Rectangle-32\" fill=\"#1181FB\" x=\"0\" y=\"0\" width=\"10\" height=\"1\"></rect>\\n          <rect class=\"arrowTop\" fill=\"#1181FB\" x=\"0\" y=\"0\" width=\"6\" height=\"1\"></rect>\\n          <rect class=\"arrowBottom\" fill=\"#1181FB\" x=\"0\" y=\"0\" width=\"6\" height=\"1\"></rect>\\n        </g>\\n      </g>\\n    </svg>\\n  </a>\\n  <ul class=\"EditorMenu-navigation js-menu\"></ul>\\n</div>\\n<div class=\"Editor-panelWrapper js-editorPanel\">\\n  <div class=\"js-content\"></div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar OptionsView = require('./settings/preview/preview-view');\nvar ScrollView = require('../components/scroll/scroll-view');\nvar Header = require('./editor-header.js');\nvar PublishView = require('../components/modals/publish/publish-view');\nvar ShareButtonView = require('./layers/share-button-view');\nvar PanelWithOptionsView = require('../components/view-options/panel-with-options-view');\nvar checkAndBuildOpts = require('../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'configModel',\n  'editorModel',\n  'mapDefinitionModel',\n  'mapcapsCollection',\n  'modals',\n  'overlaysCollection',\n  'privacyCollection',\n  'settingsCollection',\n  'userModel',\n  'visDefinitionModel'\n];\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n    this._editorModel.set('edition', false);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n\n    var header = new Header({\n      userModel: this._userModel,\n      editorModel: this._editorModel,\n      configModel: this._configModel,\n      mapcapsCollection: this._mapcapsCollection,\n      modals: this._modals,\n      visDefinitionModel: this._visDefinitionModel,\n      privacyCollection: this._privacyCollection,\n      onClickPrivacy: this._share.bind(this),\n      onRemoveMap: this._onRemoveMap.bind(this)\n    });\n\n    header.bind('export-image', function () {\n      this.trigger('export-image', this);\n    }, this);\n\n    this.$el.append(header.render().$el);\n    this.addView(header);\n\n    var view = new PanelWithOptionsView({\n      className: 'Editor-content',\n      editorModel: this._editorModel,\n      createContentView: function () {\n        return new ScrollView({\n          createContentView: function () {\n            return new OptionsView({\n              mapDefinitionModel: this._mapDefinitionModel,\n              settingsCollection: this._settingsCollection,\n              overlaysCollection: this._overlaysCollection\n            });\n          }.bind(this)\n        });\n      }.bind(this),\n      createActionView: function () {\n        return new ShareButtonView({\n          visDefinitionModel: this._visDefinitionModel,\n          onClickAction: this._share.bind(this)\n        });\n      }.bind(this)\n    });\n\n    this.$el.append(view.render().$el);\n    this.addView(view);\n\n    return this;\n  },\n\n  _share: function () {\n    this._modals.create(function (modalModel) {\n      return new PublishView({\n        mapcapsCollection: this._mapcapsCollection,\n        modalModel: modalModel,\n        visDefinitionModel: this._visDefinitionModel,\n        privacyCollection: this._privacyCollection,\n        userModel: this._userModel,\n        configModel: this._configModel\n      });\n    }.bind(this));\n  },\n\n  _onRemoveMap: function () {\n    window.location = this._userModel.get('base_url');\n  }\n});\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar EditorSettingsPane = require('./editor-settings-pane');\nvar ExportImagePane = require('./export-image-pane/export-image-pane');\nvar StackLayoutView = require('../components/stack-layout/stack-layout-view');\nvar Notifier = require('../components/notifier/notifier');\n\nvar checkAndBuildOpts = require('../helpers/required-opts');\nvar REQUIRED_OPTS = [\n  'configModel',\n  'editorModel',\n  'mapcapsCollection',\n  'mapDefinitionModel',\n  'modals',\n  'overlaysCollection',\n  'privacyCollection',\n  'settingsCollection',\n  'visDefinitionModel',\n  'userModel',\n  'stateDefinitionModel'\n];\n\nmodule.exports = CoreView.extend({\n  className: 'Editor-panel',\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n    this._editorModel.set('edition', false);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this._generateStackLayoutView();\n\n    var notifierView = Notifier.getView();\n    this.$el.append(notifierView.render().el);\n    this.addView(notifierView);\n\n    return this;\n  },\n\n  _generateStackLayoutView: function () {\n    var stackViewCollection = new Backbone.Collection([{\n      createStackView: function (stackLayoutModel, opts) {\n        return this._createEditorSettingsView(stackLayoutModel, opts).bind(this);\n      }.bind(this)\n    }]);\n\n    stackViewCollection.push({\n      createStackView: function (stackLayoutModel, opts) {\n        return this._createExportImageView(stackLayoutModel, opts).bind(this);\n      }.bind(this)\n    });\n\n    this._stackLayoutView = new StackLayoutView({\n      className: 'Editor-content',\n      collection: stackViewCollection\n    });\n    this.addView(this._stackLayoutView);\n    this.$el.append(this._stackLayoutView.render().$el);\n  },\n\n  _createEditorSettingsView: function (stackLayoutModel, opts) {\n    var view = new EditorSettingsPane({\n      className: 'Editor-content',\n      configModel: this._configModel,\n      editorModel: this._editorModel,\n      mapcapsCollection: this._mapcapsCollection,\n      mapDefinitionModel: this._mapDefinitionModel,\n      modals: this._modals,\n      overlaysCollection: this._overlaysCollection,\n      privacyCollection: this._privacyCollection,\n      settingsCollection: this._settingsCollection,\n      userModel: this._userModel,\n      visDefinitionModel: this._visDefinitionModel\n    });\n\n    view.bind('export-image', function () {\n      this._stackLayoutView.model.goToStep(1);\n    }, this);\n\n    return view;\n  },\n\n  _createExportImageView: function (stackLayoutModel, opts) {\n    var view = new ExportImagePane({\n      className: 'Editor-content',\n      canvasClassName: 'CDB-Map',\n      configModel: this._configModel,\n      stackLayoutModel: stackLayoutModel,\n      userModel: this._userModel,\n      visDefinitionModel: this._visDefinitionModel,\n      stateDefinitionModel: this._stateDefinitionModel,\n      mapDefinitionModel: this._mapDefinitionModel,\n      editorModel: this._editorModel\n    });\n\n    return view;\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<nav class=\"CDB-NavMenu js-theme\">\\n  <ul class=\"CDB-NavMenu-inner CDB-Text is-semibold CDB-Size-medium js-menu\"></ul>\\n  <button class=\"Editor-buttonNavigation CDB-Button CDB-Button--small CDB-Button--primary js-add\">\\n    <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-small u-upperCase\">\\n      '+\n((__t=( _t('editor.button_add') ))==null?'':_.escape(__t))+\n'\\n    </span>\\n  </button>\\n</nav>\\n<div class=\"Editor-content js-content\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar Backbone = require('backbone');\nvar EditorPane = require('./editor-pane');\nvar ExportImagePane = require('./export-image-pane/export-image-pane');\nvar checkAndBuildOpts = require('../helpers/required-opts');\nvar StackLayoutView = require('../components/stack-layout/stack-layout-view');\n\nvar REQUIRED_OPTS = [\n  'userActions',\n  'modals',\n  'configModel',\n  'userModel',\n  'editorModel',\n  'pollingModel',\n  'analysisDefinitionNodesCollection',\n  'layerDefinitionsCollection',\n  'privacyCollection',\n  'widgetDefinitionsCollection',\n  'mapcapsCollection',\n  'mapDefinitionModel',\n  'visDefinitionModel',\n  'mapStackLayoutModel',\n  'stateDefinitionModel',\n  'selectedTabItem'\n];\n\nmodule.exports = CoreView.extend({\n\n  className: 'Editor-content',\n\n  events: {\n    'click .js-add': '_addItem'\n  },\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this._generateStackLayoutView();\n    return this;\n  },\n\n  _generateStackLayoutView: function () {\n    var stackViewCollection = new Backbone.Collection([{\n      createStackView: function (stackLayoutModel, opts) {\n        return this._createEditorView(stackLayoutModel, opts).bind(this);\n      }.bind(this)\n    }]);\n\n    stackViewCollection.push({\n      createStackView: function (stackLayoutModel, opts) {\n        return this._createExportImageView(stackLayoutModel, opts).bind(this);\n      }.bind(this)\n    });\n\n    this._stackLayoutView = new StackLayoutView({\n      className: 'Editor-content',\n      collection: stackViewCollection\n    });\n\n    this.addView(this._stackLayoutView);\n    this.$el.append(this._stackLayoutView.render().$el);\n  },\n\n  _createEditorView: function (stackLayoutModel, opts) {\n    var view = new EditorPane({\n      analysisDefinitionNodesCollection: this._analysisDefinitionNodesCollection,\n      configModel: this._configModel,\n      editorModel: this._editorModel,\n      layerDefinitionsCollection: this._layerDefinitionsCollection,\n      mapStackLayoutModel: this._mapStackLayoutModel,\n      mapcapsCollection: this._mapcapsCollection,\n      modals: this._modals,\n      pollingModel: this._pollingModel,\n      privacyCollection: this._privacyCollection,\n      stateDefinitionModel: this._stateDefinitionModel,\n      userActions: this._userActions,\n      userModel: this._userModel,\n      visDefinitionModel: this._visDefinitionModel,\n      widgetDefinitionsCollection: this._widgetDefinitionsCollection,\n      selectedTabItem: this._selectedTabItem\n    });\n\n    view.bind('export-image', function () {\n      this._stackLayoutView.model.goToStep(1);\n    }, this);\n\n    return view;\n  },\n\n  _createExportImageView: function (stackLayoutModel, opts) {\n    var view = new ExportImagePane({\n      visDefinitionModel: this._visDefinitionModel,\n      canvasClassName: 'CDB-Map',\n      configModel: this._configModel,\n      stackLayoutModel: stackLayoutModel,\n      userModel: this._userModel,\n      mapDefinitionModel: this._mapDefinitionModel,\n      stateDefinitionModel: this._stateDefinitionModel,\n      editorModel: this._editorModel\n    });\n\n    return view;\n  }\n});\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar checkAndBuildOpts = require('../../helpers/required-opts');\nvar REQUIRED_OPTS = [\n  'userModel',\n  'hasGoogleBasemap'\n];\n\nvar DIMENSION_LIMIT = 8192;\nvar GOOGLE_DIMENSION_LIMIT = 640;\nvar GOOGLE_DIMENSION_LIMIT_PREMIUM = 2048;\n\nvar OPTIONS = [{\n  type: 'png',\n  label: '.png',\n  className: 'track-ImageExport track-typePNG'\n}, {\n  type: 'jpg',\n  label: '.jpg',\n  className: 'track-ImageExport track-typeJPG'\n}];\n\nmodule.exports = Backbone.Model.extend({\n  defaults: {\n    type: 'none',\n    title: ''\n  },\n\n  initialize: function (attrs, opts) {\n    checkAndBuildOpts(attrs, REQUIRED_OPTS, this);\n\n    this.schema = this._generateSchema();\n    this._setSchema();\n    this.on('change:format change:width change:height', this._setSchema, this);\n  },\n\n  _setSchema: function () {\n    this.schema = this._generateSchema();\n  },\n\n  _generateSchema: function () {\n    return {\n      width: {\n        type: 'Number',\n        title: _t('editor.export-image.properties.width') + ' (px)',\n        validators: ['required', this._validateDimension.bind(this)],\n        showSlider: false,\n        editorAttrs: {\n          className: 'track-ImageExport track-inputWidth',\n          placeholder: _t('editor.export-image.properties.width')\n        }\n      },\n      height: {\n        type: 'Number',\n        title: _t('editor.export-image.properties.height') + ' (px)',\n        validators: ['required', this._validateDimension.bind(this)],\n        showSlider: false,\n        editorAttrs: {\n          className: 'track-ImageExport track-inputHeight',\n          placeholder: _t('editor.export-image.properties.height')\n        }\n      },\n      format: {\n        type: 'Radio',\n        title: _t('editor.export-image.properties.format'),\n        options: _.map(OPTIONS, function (d) {\n          return {\n            val: d.type,\n            label: d.label,\n            className: d.className\n          };\n        }, this)\n      }\n    };\n  },\n\n  _validateDimension: function (value, formValues) {\n    var numericValue = +value;\n\n    var limit = DIMENSION_LIMIT;\n    var googleMapsKey;\n\n    if (this._hasGoogleBasemap) {\n      limit = GOOGLE_DIMENSION_LIMIT;\n      googleMapsKey = this._userModel.get('google_maps_key');\n\n      if (googleMapsKey.indexOf('signature') !== -1) {\n        limit = GOOGLE_DIMENSION_LIMIT_PREMIUM;\n      }\n    }\n\n    if (_.isNumber(numericValue) && numericValue >= 1 && numericValue <= limit) {\n      return null; // valid dimension\n    }\n\n    return {\n      message: _t('editor.export-image.invalid-dimension', { limit: limit })\n    };\n  },\n\n  setErrors: function (errors) {\n    // we don't want to set these errors as part as attributes\n    // then we manually check if we should trigger the custom event\n    var shouldTrigger = errors !== this._validationErrors;\n    this._validationErrors = errors;\n    shouldTrigger && this.trigger('change:errors');\n  },\n\n  canExport: function () {\n    return _.isUndefined(this._validationErrors);\n  },\n\n  toJSON: function () {\n    return _.extend(\n      this.attributes,\n      {\n        type: this.get('type')\n      }\n    );\n  }\n});\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar template = require('./export-image-form.tpl');\nrequire('../../components/form-components/index');\nvar checkAndBuildOpts = require('../../helpers/required-opts');\nvar REQUIRED_OPTS = [\n  'formModel'\n];\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this._removeFormView();\n    this._renderForm();\n    this._initBinds();\n    return this;\n  },\n\n  _renderForm: function () {\n    this.clearSubViews();\n    this._removeFormView();\n\n    this._formView = new Backbone.Form({\n      template: template,\n      model: this._formModel\n    });\n\n    this.$('form').on('submit', function (e) {\n      e.preventDefault();\n    });\n\n    this.$el.append(this._formView.render().$el);\n  },\n\n  _initBinds: function () {\n    this.listenTo(this._formView, 'change', this._updateChanges);\n    this.listenTo(this._formModel, 'change:width change:height', this._updateSchema);\n  },\n\n  _updateSchema: function () {\n    this._formView.fields.width.setValue(this._formModel.get('width'));\n    this._formView.fields.height.setValue(this._formModel.get('height'));\n    this._updateChanges();\n  },\n\n  _updateChanges: function () {\n    var errors = this._formView.commit({validate: true});\n    this._formView.model.setErrors(errors);\n  },\n\n  _removeFormView: function () {\n    this._formView && this._formView.remove();\n  },\n\n  clean: function () {\n    this.$('form').off('submit');\n    this._removeFormView();\n    CoreView.prototype.clean.call(this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-bSpace--xl\">\\n  <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">1</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"width,height\">\\n    <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n      <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.export-image.properties.size') ))==null?'':_.escape(__t))+\n'</h2>\\n    </div>\\n    <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.export-image.properties.size-subtitle') ))==null?'':_.escape(__t))+\n'</p>\\n  </div>\\n</div>\\n<div class=\"u-flex u-bSpace--xl\">\\n  <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">2</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"format\">\\n    <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n      <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.export-image.properties.format') ))==null?'':_.escape(__t))+\n'</h2>\\n    </div>\\n    <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.export-image.properties.format-subtitle') ))==null?'':_.escape(__t))+\n'</p>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var $ = require('jquery');\nvar _ = require('underscore');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar FooterView = require('./footer/footer-view');\nvar ExportImageFormView = require('./export-image-form-view.js');\nvar ExportImageFormModel = require('./export-image-form-model');\nvar ExportImageWidget = require('./export-image-widget');\nvar template = require('./export-image-pane.tpl');\nvar Utils = require('../../helpers/utils');\nvar Notifier = require('../../components/notifier/notifier');\nvar browser = require('../../helpers/browser-detect');\n\nvar Infobox = require('../../components/infobox/infobox-factory');\nvar InfoboxView = require('../../components/infobox/infobox-view');\nvar InfoboxModel = require('../../components/infobox/infobox-model');\nvar InfoboxCollection = require('../../components/infobox/infobox-collection');\n\nvar DEFAULT_EXPORT_FORMAT = 'png';\nvar DEFAULT_EXPORT_WIDTH = 300;\nvar DEFAULT_EXPORT_HEIGHT = 200;\n\nvar CARTO_ATTRIBUTION = '@CARTO';\nvar ATTRIBUTION_WIDTH = 15;\nvar ATTRIBUTION_HEIGHT = 16;\n\nvar NOTIFICATION_ID = 'exportImageNotification';\nvar LOGO_PATH = '/unversioned/images/carto.png';\nvar GMAPS_STATIC_MAP_ENDPOINT = 'https://maps.googleapis.com/maps/api/staticmap';\n\nvar checkAndBuildOpts = require('../../helpers/required-opts');\nvar REQUIRED_OPTS = [\n  'canvasClassName',\n  'configModel',\n  'stackLayoutModel',\n  'userModel',\n  'visDefinitionModel',\n  'stateDefinitionModel',\n  'mapDefinitionModel',\n  'editorModel'\n];\n\nmodule.exports = CoreView.extend({\n  className: 'Editor-content',\n\n  events: {\n    'click .js-back': '_goStepBack'\n  },\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    this._canvasModel = new Backbone.Model();\n    this._$map = $('.' + this._canvasClassName);\n\n    var width = DEFAULT_EXPORT_WIDTH;\n    var height = DEFAULT_EXPORT_HEIGHT;\n\n    var x = Math.ceil(this._$map.width() / 2 - (width / 2));\n    var y = Math.ceil(this._$map.height() / 2 - (height / 2));\n\n    this._exportImageFormModel = new ExportImageFormModel({\n      userModel: this._userModel,\n      hasGoogleBasemap: this._hasGoogleMapsBasemap(),\n      format: DEFAULT_EXPORT_FORMAT,\n      x: x,\n      y: y,\n      width: width,\n      height: height\n    });\n  },\n\n  _addErrorNotification: function (error) {\n    Notifier.addNotification({\n      id: NOTIFICATION_ID,\n      status: 'error',\n      closable: true,\n      button: false,\n      delay: Notifier.DEFAULT_DELAY,\n      info: error + ' ' + _t('editor.maps.export-image.errors.try-again')\n    });\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    this.$el.append(\n      template({\n        title: _t('editor.maps.export-image.title')\n      })\n    );\n\n    this._createWidget();\n    this._createForm();\n    this._createDisclaimer();\n    this._createFooter();\n\n    return this;\n  },\n\n  _createForm: function () {\n    this._exportImageFormView = new ExportImageFormView({\n      formModel: this._exportImageFormModel,\n      canvasModel: this._exportImageFormModel\n    });\n\n    this.$('.js-content').append(this._exportImageFormView.render().$el);\n    this.addView(this._exportImageFormView);\n  },\n\n  _createDisclaimer: function () {\n    var infoboxSstates = [{\n      state: 'disclaimer',\n      createContentView: function () {\n        return Infobox.createWithAction({\n          type: 'warning',\n          title: _t('editor.maps.export-image.disclaimer.title'),\n          body: _t('editor.maps.export-image.disclaimer.body')\n        });\n      }\n    }];\n\n    this._infoboxModel = new InfoboxModel({\n      state: 'disclaimer'\n    });\n\n    this._infoboxCollection = new InfoboxCollection(infoboxSstates);\n\n    this._infoboxView = new InfoboxView({\n      infoboxModel: this._infoboxModel,\n      infoboxCollection: this._infoboxCollection\n    });\n\n    this.$('.js-disclaimer').append(this._infoboxView.render().el);\n    this.addView(this._infoboxView);\n  },\n\n  _createFooter: function () {\n    this._footerView = new FooterView({\n      configModel: this._configModel,\n      userModel: this._userModel,\n      formModel: this._exportImageFormModel\n    });\n\n    this.addView(this._footerView);\n    this._footerView.bind('finish', this._exportImage, this);\n    this.$('.js-footer').append(this._footerView.render().el);\n  },\n\n  _createWidget: function () {\n    this._exportImageWidget = new ExportImageWidget({\n      mapViewClass: 'CDB-Map-wrapper',\n      dashboardCanvasClass: 'CDB-Dashboard-canvas',\n      model: this._exportImageFormModel,\n      stateDefinitionModel: this._stateDefinitionModel,\n      mapDefinitionModel: this._mapDefinitionModel\n    });\n\n    this.addView(this._exportImageWidget);\n    this._$map.prepend(this._exportImageWidget.render().$el);\n  },\n\n  _getStaticMapURL: function () {\n    var getStaticImageURL = this._mapDefinitionModel.getStaticImageURLTemplate();\n    var imageMapMetadata = this._mapDefinitionModel.getImageExportMetadata();\n    return getStaticImageURL({\n      zoom: imageMapMetadata.zoom,\n      width: this._exportImageFormModel.get('width'),\n      height: this._exportImageFormModel.get('height'),\n      lat: this._exportImageFormModel.get('lat'),\n      lng: this._exportImageFormModel.get('lng'),\n      format: 'png' // we always use 'png' to allow merging layers\n    });\n  },\n\n  _getStaticStyles: function (styles) {\n    if (!styles) {\n      return;\n    }\n\n    var result = [];\n    var propertyname;\n    var propertyval;\n    var style = '';\n\n    JSON.parse(styles).forEach(function (s) {\n      style = '';\n      if (s.stylers && s.stylers.length > 0) {\n        style += (s.hasOwnProperty('featureType') ? 'feature:' + s.featureType : 'feature:all') + '|';\n        style += (s.hasOwnProperty('elementType') ? 'element:' + s.elementType : 'element:all') + '|';\n\n        s.stylers.forEach(function (val) {\n          propertyname = Object.keys(val)[0];\n          propertyval = val[propertyname].toString().replace('#', '0x');\n          style += propertyname + ':' + propertyval + '|';\n        });\n      }\n\n      if (style) {\n        result.push('style=' + style);\n      }\n    });\n\n    return result.join('&');\n  },\n\n  _removeNotification: function () {\n    if (Notifier.getNotification(NOTIFICATION_ID)) {\n      Notifier.removeNotification(NOTIFICATION_ID);\n    }\n  },\n\n  _exportImage: function () {\n    var self = this;\n\n    this._removeNotification();\n\n    var def = $.Deferred();\n\n    var logo = function () {\n      return self._loadLogo();\n    };\n\n    var basemap = function () {\n      if (self._hasGoogleMapsBasemap()) {\n        return self._loadBasemap(self._getGMapBasemapURL());\n      }\n    };\n\n    var image = function () {\n      return self._onLoadImage(self._downloadImage.bind(self));\n    };\n\n    var attribution = function () {\n      return self._loadAttribution();\n    };\n\n    def.then(logo)\n    .then(basemap)\n    .then(attribution)\n    .then(image)\n    .fail(this._onFail.bind(this));\n\n    def.resolve();\n  },\n\n  _onFail: function (error) {\n    this._footerView.stopLoader();\n    this._addErrorNotification(error);\n  },\n\n  _downloadImage: function (canvas) {\n    var browserInfo = browser();\n    var imageFormat = this._exportImageFormModel.get('format');\n    var fileName = this._visDefinitionModel.get('name') + '.' + imageFormat;\n\n    if (canvas.msToBlob) {\n      var image = canvas.msToBlob();\n      window.navigator.msSaveBlob(\n        new Blob([image], { type: 'image/' + imageFormat }), // eslint-disable-line\n        fileName\n      );\n    } else {\n      var dataUri = canvas.toDataURL('image/' + imageFormat);\n      var link = document.createElement('a');\n      document.body.appendChild(link);\n\n      link.download = fileName;\n      link.href = dataUri;\n\n      if (browserInfo.name !== 'Safari') {\n        link.target = '_blank';\n      } else {\n        dataUri.replace(/^data:image\\/[^;]/, 'data:application/octet-stream');\n      }\n\n      link.click();\n\n      document.body.removeChild(link);\n    }\n\n    this._footerView.stopLoader();\n  },\n\n  _hasGoogleMapsBasemap: function () {\n    var imageMapMetadata = this._mapDefinitionModel.getImageExportMetadata();\n    return imageMapMetadata.provider === 'googlemaps';\n  },\n\n  _onLoadImage: function (callback) {\n    var self = this;\n    var url = this._getStaticMapURL();\n\n    var basemap = this._basemap;\n\n    var width = +this._exportImageFormModel.get('width');\n    var height = +this._exportImageFormModel.get('height');\n\n    var image = new Image(); // eslint-disable-line\n\n    image.setAttribute('crossOrigin', 'anonymous');\n\n    image.onload = function () {\n      var canvas = document.createElement('canvas');\n      var ctx = canvas.getContext('2d');\n\n      canvas.width = this.naturalWidth;\n      canvas.height = this.naturalHeight;\n\n      if (basemap) {\n        ctx.drawImage(basemap, 0, 0);\n      }\n\n      ctx.drawImage(this, 0, 0);\n\n      self._drawLogo(ctx, width, height);\n      self._drawAttribution(ctx, width, height);\n\n      callback(canvas);\n    };\n\n    image.onerror = function (e) {\n      self._onFail(_t('editor.maps.export-image.errors.error-image'));\n    };\n\n    image.src = url;\n  },\n\n  _drawLogo: function (ctx, width, height) {\n    if (this._logo) {\n      var left = (width / 2) - (this._logo.width / 2);\n      var top = height - this._logo.height - 5;\n\n      ctx.drawImage(this._logo, left, top);\n    }\n  },\n\n  _drawAttribution: function (ctx, width, height) {\n    if (this._attribution) {\n      var left = width - this._attribution.width - 3;\n      var top = height - this._attribution.height;\n\n      if (this._hasGoogleMapsBasemap()) {\n        var attributionWidth = this._$map.find('.gm-style-cc').width();\n\n        if (attributionWidth >= width / 2) {\n          top = top - ATTRIBUTION_HEIGHT / 2;\n        }\n\n        top = height - this._attribution.height - ATTRIBUTION_HEIGHT;\n      }\n\n      ctx.drawImage(this._attribution, left, top);\n    }\n  },\n\n  _getDimensionString: function () {\n    var width = this._exportImageFormModel.get('width');\n    var height = this._exportImageFormModel.get('height');\n\n    return width + 'x' + height;\n  },\n\n  _getCenterString: function () {\n    var lat = +this._exportImageFormModel.get('lat').toFixed(6);\n    var lng = +this._exportImageFormModel.get('lng').toFixed(6);\n\n    return lat + ',' + lng;\n  },\n\n  _getGMapBasemapURL: function () {\n    var visMetadata = this._mapDefinitionModel.getImageExportMetadata();\n    var params = {\n      center: this._getCenterString().replace(',', ';'), // we'll replace it below with a comma\n      zoom: visMetadata.zoom,\n      size: this._getDimensionString(),\n      mapType: visMetadata.mapType,\n      rnd: Math.random(1000)\n    };\n\n    var flattenedParams = _.pairs(params).join('&').replace(/,/g, '=').replace(/;/g, ',');\n    var style = this._getStaticStyles(visMetadata.style);\n    var key = this._userModel.get('google_maps_key');\n\n    return GMAPS_STATIC_MAP_ENDPOINT + '?' + flattenedParams + '&style=' + style + '&' + key;\n  },\n\n  _loadAttribution: function () {\n    var self = this;\n    var visMetadata = this._mapDefinitionModel.getImageExportMetadata();\n    var deferred = $.Deferred();\n\n    var image = new Image(); // eslint-disable-line\n    var canvas = document.createElement('canvas');\n    var ctx = canvas.getContext('2d');\n\n    var text = this._hasGoogleMapsBasemap() ? CARTO_ATTRIBUTION : Utils.stripHTML(visMetadata.attribution.join(' '));\n    var dimension = ctx.measureText(text);\n    var width = dimension.width;\n\n    ctx.font = '11px';\n    ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';\n    ctx.fillRect(-ATTRIBUTION_WIDTH, 0, width + ATTRIBUTION_WIDTH + 2, ATTRIBUTION_HEIGHT - 3);\n\n    ctx.fillStyle = '#333';\n    ctx.fillText(text, 0, 10);\n\n    image.onload = function () {\n      self._attribution = this;\n      deferred.resolve();\n    };\n\n    image.onerror = function () {\n      deferred.reject(_t('editor.maps.export-image.errors.error-attribution'));\n    };\n\n    image.width = width;\n    image.height = ATTRIBUTION_HEIGHT - 3;\n    image.src = canvas.toDataURL();\n\n    return deferred.promise();\n  },\n\n  _loadLogo: function () {\n    var self = this;\n\n    var image = new Image(); // eslint-disable-line\n    image.setAttribute('crossOrigin', 'anonymous');\n\n    var deferred = $.Deferred();\n\n    image.onload = function () {\n      self._logo = this;\n      deferred.resolve();\n    };\n\n    image.onerror = function () {\n      deferred.reject(_t('editor.maps.export-image.errors.error-image'));\n    };\n\n    image.src = this._configModel.get('app_assets_base_url') + LOGO_PATH;\n\n    return deferred.promise();\n  },\n\n  _loadBasemap: function (url) {\n    var self = this;\n    var deferred = $.Deferred();\n    var image = new Image(); // eslint-disable-line\n\n    image.setAttribute('crossOrigin', 'anonymous');\n\n    image.onload = function () {\n      self._basemap = this;\n      deferred.resolve();\n    };\n\n    image.onerror = function () {\n      deferred.reject(_t('editor.maps.export-image.errors.error-basemap'));\n    };\n\n    image.src = url;\n    return deferred.promise();\n  },\n\n  _goStepBack: function () {\n    this._stackLayoutModel.prevStep();\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-HeaderInfoEditor Editor-HeaderInfo--noMargin\">\\n  <div class=\"u-rSpace--xl u-actionTextColor Editor-HeaderInfoEditorShape\">\\n    <button class=\"js-back\">\\n      <i class=\"CDB-IconFont CDB-IconFont-arrowPrev Size-large\"></i>\\n    </button>\\n  </div>\\n  <div class=\"CDB-Text CDB-Size-huge is-light u-ellipsis\">'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</div>\\n</div>\\n\\n<div class=\"Editor-content js-content\"></div>\\n<div class=\"js-disclaimer\"></div>\\n<div class=\"Options-bar Options-bar--right u-flex js-footer\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar $ = require('jquery');\nvar CoreView = require('backbone/core-view');\nvar template = require('./export-image-widget.tpl');\nvar checkAndBuildOpts = require('../../helpers/required-opts');\n\nvar TRACK_CONTEXT_CLASS = 'track-ImageExport';\n\nvar REQUIRED_OPTS = [\n  'mapViewClass',\n  'dashboardCanvasClass',\n  'stateDefinitionModel',\n  'mapDefinitionModel'\n];\n\nmodule.exports = CoreView.extend({\n  className: 'ExportImageView',\n\n  events: {\n    'mouseenter .js-canvas': '_onEnter',\n    'mouseleave .js-canvas': '_onLeave'\n  },\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    this._$dashBoardCanvas = $('.' + this._dashboardCanvasClass);\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.$el.append(template(this.model.attributes));\n    this._initViews();\n\n    return this;\n  },\n\n  _initViews: function () {\n    this._setupCanvas();\n    this._updateHelpers();\n\n    var x = +this.model.get('x');\n    var y = +this.model.get('y');\n    var width = +this.model.get('width');\n    var height = +this.model.get('height');\n\n    this._updateCoordinates(x, y, width, height);\n  },\n\n  _initBinds: function () {\n    this.listenTo(this.model, 'change:x change:y change:width change:height', this._updateHelpers);\n    this.listenTo(this._stateDefinitionModel, 'change:json', this._onChangeMap);\n\n    this._resize = _.debounce(this._onResizeWindow.bind(this), 20);\n    $(window).on('resize', this._resize);\n\n    this.listenTo(this._stateDefinitionModel, 'change', this._updateCanvasCoordinates);\n  },\n\n  _onEnter: function () {\n    _.debounce(this.$el.addClass('is-top'), 50);\n  },\n\n  _onLeave: function () {\n    _.debounce(this.$el.removeClass('is-top'), 50);\n  },\n\n  _onResizeWindow: function (e) {\n    if (e.target === window) {\n      var latLngToPixel = this._mapDefinitionModel.latLngToPixel;\n\n      var coordinates = latLngToPixel({\n        lat: this.model.get('lat'),\n        lng: this.model.get('lng')\n      });\n\n      var width = this.model.get('width');\n      var height = this.model.get('height');\n\n      this.model.set({\n        x: coordinates.x - width / 2,\n        y: coordinates.y - height / 2\n      });\n\n      this._updateCanvasCoordinates();\n      this._updateHelpers();\n    }\n  },\n\n  _setupCanvas: function () {\n    this.$('.js-canvas').resizable({\n      resize: this._onResize.bind(this),\n      handles: 'n, e, s, w, ne, se, sw, nw',\n      containment: this._$dashBoardCanvas\n    });\n\n    this.$('.js-canvas').draggable({\n      drag: this._updateCanvasCoordinates.bind(this),\n      stop: this._updateCanvasCoordinates.bind(this),\n      containment: this._$dashBoardCanvas\n    });\n\n    this._setupTracks();\n\n    this.$('.js-canvas').css({\n      top: +this.model.get('x'),\n      left: +this.model.get('y'),\n      width: +this.model.get('width'),\n      height: +this.model.get('height')\n    });\n  },\n\n  _updateHelpers: function () {\n    var x = +this.model.get('x');\n    var y = +this.model.get('y');\n    var width = +this.model.get('width');\n    var height = +this.model.get('height');\n\n    var size = this._mapDefinitionModel.getMapViewSize();\n    var canvasWidth = size.x;\n    var canvasHeight = size.y;\n\n    var bottom = y + height + 1;\n    var right = x + width + 1;\n\n    this.$('.js-canvas').css({\n      top: y,\n      left: x,\n      height: height,\n      width: width\n    });\n\n    if (x >= 0 && y >= 0) {\n      this.$('.js-helper-north').css({ top: 0, width: right, height: y + 1 });\n      this.$('.js-helper-west').css({ left: 0, top: y + 1, width: x + 1, height: height });\n      this.$('.js-helper-south').css({ top: bottom, left: 0, width: canvasWidth, height: canvasHeight - height - y });\n      this.$('.js-helper-east').css({ left: right, top: 0, width: canvasWidth - width - x - 1, height: bottom });\n    }\n\n    if (right + 1 >= canvasWidth) {\n      this.$('.js-helper-east').css('width', 0);\n    }\n    if (x <= 0) {\n      this.$('.js-helper-west').css('width', 0);\n    }\n    if (bottom + 1 >= canvasHeight) {\n      this.$('.js-helper-south').css('height', 0);\n    }\n    if (y <= 0) {\n      this.$('.js-helper-north').css('height', 0);\n    }\n  },\n\n  _updateCanvasCoordinates: function () {\n    var width = this.$('.js-canvas').width();\n    var height = this.$('.js-canvas').height();\n    var x = this.$('.js-canvas').position().left;\n    var y = this.$('.js-canvas').position().top;\n\n    this._updateCoordinates(x, y, width, height);\n  },\n\n  _onChangeMap: function () {\n    var coordinates = this._calcCenter();\n\n    this.model.set({\n      lat: coordinates.lat,\n      lng: coordinates.lng\n    });\n  },\n\n  _onResize: function (e, ui) {\n    var width = ui.helper.width();\n    var height = ui.helper.height();\n    var x = ui.helper.position().left;\n    var y = ui.helper.position().top;\n\n    this._updateCoordinates(x, y, width, height);\n  },\n\n  _updateCoordinates: function (x, y, width, height) {\n    var coordinates = this._calcCenter();\n\n    this.model.set({\n      x: x,\n      y: y,\n      width: width,\n      height: height,\n      lat: coordinates.lat,\n      lng: coordinates.lng\n    });\n  },\n\n  _calcCenter: function () {\n    var x = this.model.get('x') + this.model.get('width') / 2;\n    var y = this.model.get('y') + this.model.get('height') / 2;\n    var pixelToLatLng = this._mapDefinitionModel.pixelToLatLng;\n    return pixelToLatLng({ x: x, y: y });\n  },\n\n  _setupTracks: function () {\n    this.$('.js-canvas .ui-resizable-nw').addClass(TRACK_CONTEXT_CLASS + ' ' + 'track-nodeTopLeft');\n    this.$('.js-canvas .ui-resizable-n').addClass(TRACK_CONTEXT_CLASS + ' ' + 'track-nodeTopCenter');\n    this.$('.js-canvas .ui-resizable-ne').addClass(TRACK_CONTEXT_CLASS + ' ' + 'track-nodeTopRight');\n    this.$('.js-canvas .ui-resizable-w').addClass(TRACK_CONTEXT_CLASS + ' ' + 'track-nodeMiddleLeft');\n    this.$('.js-canvas .ui-resizable-e').addClass(TRACK_CONTEXT_CLASS + ' ' + 'track-nodeMiddleCenter');\n    this.$('.js-canvas .ui-resizable-sw').addClass(TRACK_CONTEXT_CLASS + ' ' + 'track-nodeBottomLeft');\n    this.$('.js-canvas .ui-resizable-s').addClass(TRACK_CONTEXT_CLASS + ' ' + 'track-nodeBottomCenter');\n    this.$('.js-canvas .ui-resizable-se').addClass(TRACK_CONTEXT_CLASS + ' ' + 'track-nodeBottomRight');\n  },\n\n  clean: function () {\n    $(window).off('resize', this._resize);\n    CoreView.prototype.clean.apply(this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"ExportHelper ExportHelper--north js-export-helper js-helper-north\"></div>\\n<div class=\"ExportHelper ExportHelper--west  js-export-helper js-helper-west\"></div>\\n<div class=\"ExportHelper ExportHelper--south js-export-helper js-helper-south\"></div>\\n<div class=\"ExportHelper ExportHelper--east  js-export-helper js-helper-east\"></div>\\n<div class=\"CanvasExport js-canvas\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar template = require('./footer.tpl');\nvar checkAndBuildOpts = require('../../../helpers/required-opts');\n\nvar LOADING = 'loading';\n\nvar REQUIRED_OPTS = [\n  'userModel',\n  'configModel',\n  'formModel'\n];\n\nmodule.exports = CoreView.extend({\n  className: 'Editor-FooterInfoEditor',\n\n  events: {\n    'click .js-ok': '_finish'\n  },\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n    this.model = new Backbone.Model({ state: '' });\n    this.listenTo(this.model, 'change:state', this.render);\n    this.listenTo(this._formModel, 'change:errors', this.render);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template({\n      isLoading: this._isLoading(),\n      isDisabled: !(this._formModel.canExport() && !this._isLoading())\n    }));\n\n    return this;\n  },\n\n  stopLoader: function (e) {\n    this.model.unset('state');\n  },\n\n  _isLoading: function () {\n    return this.model.get('state') === LOADING;\n  },\n\n  _finish: function (e) {\n    this.killEvent(e);\n    this.model.set('state', LOADING);\n    this.trigger('finish', this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<button class=\"CDB-Button CDB-Button--primary js-ok track-ImageExport track-export\\n  ';\n if (isLoading || isDisabled) { \n__p+=' is-disabled ';\n } \n__p+='\\n  \"\\n  ';\n if (isDisabled) { \n__p+=' disabled ';\n } \n__p+='>\\n  <div class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-small u-upperCase u-flex\">\\n    ';\n if (isLoading) { \n__p+='\\n    <div class=\"CDB-LoaderIcon CDB-LoaderIcon--small u-iBlock\">\\n      <svg class=\"CDB-LoaderIcon-spinner\" viewBox=\"0 0 50 50\">\\n        <circle class=\"CDB-LoaderIcon-path\" cx=\"25\" cy=\"25\" r=\"20\" fill=\"none\"></circle>\\n      </svg>\\n    </div>\\n     '+\n((__t=( _t('editor.maps.export-image.generating') ))==null?'':_.escape(__t))+\n'\\n    ';\n } else { \n__p+='\\n     '+\n((__t=( _t('editor.maps.export-image.export') ))==null?'':_.escape(__t))+\n'\\n    ';\n } \n__p+='\\n  </div>\\n</button>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar ViewFactory = require('../../components/view-factory');\nvar template = require('./feedback-button.tpl');\nvar TipsyTooltipView = require('../../components/tipsy-tooltip-view');\nvar feedbackModalTemplate = require('./feedback-modal.tpl');\n\nmodule.exports = CoreView.extend({\n\n  tagName: 'button',\n  className: 'EditorMenu-feedback typeform-share button js-feedback',\n\n  events: {\n    'click': '_onClick'\n  },\n\n  initialize: function (opts) {\n    if (!opts.modals) throw new Error('modals is required');\n    this._modals = opts.modals;\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.el.setAttribute('data-mode', '1');\n    this.el.setAttribute('target', '_blank');\n\n    this.$el.append(template());\n\n    var tooltip = new TipsyTooltipView({\n      el: this.el,\n      gravity: 'w',\n      title: function () {\n        return _t('feedback');\n      }\n    });\n    this.addView(tooltip);\n\n    return this;\n  },\n\n  _onClick: function () {\n    this._modals.once('destroyedModal', this.clean, this);\n    this._modals.create(function (modalModel) {\n      return ViewFactory.createByTemplate(feedbackModalTemplate, null, {\n        className: 'Editor-feedbackModal'\n      });\n    });\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"18px\" height=\"16px\" viewBox=\"-1 -1 18 16\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n <g id=\"feedback\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\\n   <path d=\"M16,11 L8,11 L5,14 L5,11 L0,11 L0,0 L16,0 L16,11 Z M7.29289322,10.2928932 L7.58578644,10 L8,10 L15,10.0047607 L15.0084229,1 L1,0.993103027 L1,10 L5,10 L6,10 L6,11 L6,11.5374756 L7.29289322,10.2928932 Z\" id=\"Combined-Shape\" fill=\"#FFFFFF \"></path>\\n   <rect id=\"Rectangle-25\" fill=\"#FFFFFF \" x=\"4\" y=\"3\" width=\"8\" height=\"1\"></rect>\\n   <rect id=\"Rectangle-25\" fill=\"#FFFFFF \" x=\"4\" y=\"5\" width=\"8\" height=\"1\"></rect>\\n   <rect id=\"Rectangle-25\" fill=\"#FFFFFF \" x=\"4\" y=\"7\" width=\"5\" height=\"1\"></rect>\\n </g>\\n</svg>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"typeform-widget\" data-url=\"https://cartohq.typeform.com/to/t7Dk8K\" data-text=\"CARTO Builder\" style=\"width:100%;height:100%;\"></div>\\n<script>(function(){var qs,js,q,s,d=document,gi=d.getElementById,ce=d.createElement,gt=d.getElementsByTagName,id=\\'typef_orm\\',b=\\'https://s3-eu-west-1.amazonaws.com/share.typeform.com/\\';if(!gi.call(d,id)){js=ce.call(d,\\'script\\');js.id=id;js.src=b+\\'widget.js\\';q=gt.call(d,\\'script\\')[0];q.parentNode.insertBefore(js,q)}})()</script>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<h2 class=\"Inline-editor\">\\n  <div class=\"CDB-Text CDB-Size-huge is-light u-ellipsis js-title Inline-editor-text\">'+\n((__t=( name ))==null?'':_.escape(__t))+\n'</div>\\n  <input type=\"text\" name=\"text\" class=\"Inline-editor-input Inline-editor-input--small CDB-Text CDB-InputText js-input\" value=\"'+\n((__t=( name ))==null?'':_.escape(__t))+\n'\" readonly>\\n</h2>';\n}\nreturn __p;\n};\n",
    "var $ = require('jquery');\nvar cdb = require('cartodb.js');\nvar CoreView = require('backbone/core-view');\nvar TipsyTooltipView = require('../../../components/tipsy-tooltip-view.js');\nvar NotificationErrorMessageHandler = require('../notification-error-message-handler');\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    if (!opts.analysisNode) throw new Error('analysisNode is required');\n    if (!opts.element) throw new Error('element is required');\n    if (!opts.triggerSelector) throw new Error('triggerSelector is required');\n\n    this.analysisNode = opts.analysisNode;\n    this.$el = opts.element;\n    this.selector = opts.triggerSelector;\n\n    this.$el.on('mouseover', this.selector, this._showTooltip.bind(this));\n    this.$el.on('mouseout', this.selector, this._destroyTooltip.bind(this));\n    this.$el.on('mouseleave', this.selector, this._destroyTooltip.bind(this));\n  },\n\n  _showTooltip: function (e) {\n    var status = this.analysisNode.get('status');\n\n    if (status === 'failed') {\n      var message = NotificationErrorMessageHandler.extractErrorFromAnalysisNode(this.analysisNode);\n\n      this.tooltip = this._createTooltip({\n        $el: $(e.target),\n        msg: message.message\n      });\n\n      this.tooltip.showTipsy();\n    }\n  },\n\n  _createTooltip: function (opts) {\n    return new TipsyTooltipView({\n      el: opts.$el,\n      title: function () {\n        return opts.msg;\n      }\n    });\n  },\n\n  _destroyTooltip: function () {\n    if (this.tooltip) {\n      this.tooltip.hideTipsy();\n      this.tooltip.destroyTipsy();\n      delete this.tooltip;\n    }\n  },\n\n  clean: function () {\n    this.$el.off('mouseover', this.selector);\n    this.$el.off('mouseout', this.selector);\n    this.$el.off('mouseleave', this.selector);\n\n    this._destroyTooltip();\n    cdb.core.View.prototype.clean.call(this);\n  }\n});\n",
    "var _ = require('underscore');\nvar Notifier = require('../../../components/notifier/notifier');\nvar NotificationErrorMessageHandler = require('../notification-error-message-handler');\n\nvar DEFAULT_DELAY = Notifier.DEFAULT_DELAY;\nvar STATUS_READY = 'ready';\nvar STATUS_PENDING = 'pending';\nvar STATUS_RUNNING = 'running';\nvar STATUS_WAITING = 'waiting';\nvar STATUS_FAILED = 'failed';\n\nvar AnalysisNotifications = {\n\n  track: function (analysisNode, layerDefModel) {\n    analysisNode.on('change:status', this._addStatusChangedNotification, this);\n    analysisNode.on('change:error', this._onErrorChanged, this);\n    analysisNode.once('destroy', this._addRemovedNotification, this);\n    this._layerDefModel = layerDefModel;\n\n    if (analysisNode.get('status') && analysisNode.get('status') !== STATUS_READY) {\n      this._addStatusChangedNotification(analysisNode);\n    }\n  },\n\n  _addRemovedNotification: function (analysisNode) {\n    if (analysisNode.get('avoidNotification') === true) {\n      return;\n    }\n\n    var nodeId = analysisNode.get('id');\n    var notificationAttrs = {\n      status: 'success',\n      info: _t('notifications.analysis.removed', {\n        nodeId: nodeId.toUpperCase()\n      }),\n      closable: true,\n      delay: DEFAULT_DELAY\n    };\n    this._addOrUpdateNotification(analysisNode.cid, notificationAttrs);\n  },\n\n  _addStatusChangedNotification: function (analysisNode) {\n    var status = analysisNode.get('status');\n    if (status === STATUS_WAITING || status === STATUS_PENDING) {\n      this._addAnalysisWaitingNotification(analysisNode);\n    }\n    if (status === STATUS_RUNNING) {\n      this._addAnalysisRunningNotification(analysisNode);\n    }\n    if (status === STATUS_READY) {\n      this._addAnalysisReadyNotification(analysisNode);\n    }\n    if (status === STATUS_FAILED) {\n      this._addAnalysisFailedNotification(analysisNode);\n    }\n  },\n\n  _addAnalysisWaitingNotification: function (analysisNode) {\n    var notificationAttrs = {\n      status: 'loading',\n      info: _t('notifications.analysis.waiting', {\n        nodeId: analysisNode.get('id').toUpperCase()\n      })\n    };\n    this._addOrUpdateNotification(analysisNode.cid, notificationAttrs);\n  },\n\n  _addAnalysisRunningNotification: function (analysisNode) {\n    var notificationAttrs = {\n      status: 'loading',\n      info: _t('notifications.analysis.running', {\n        nodeId: analysisNode.get('id').toUpperCase()\n      })\n    };\n    this._addOrUpdateNotification(analysisNode.cid, notificationAttrs);\n  },\n\n  _addAnalysisReadyNotification: function (analysisNode) {\n    var notificationAttrs = {\n      status: 'success',\n      info: _t('notifications.analysis.completed', {\n        nodeId: analysisNode.get('id').toUpperCase()\n      }),\n      closable: true,\n      delay: DEFAULT_DELAY\n    };\n    this._addOrUpdateNotification(analysisNode.cid, notificationAttrs);\n  },\n\n  _addAnalysisFailedNotification: function (analysisNode) {\n    var message = NotificationErrorMessageHandler.extractErrorFromAnalysisNode(analysisNode, this._layerDefModel);\n\n    var notificationAttrs = {\n      status: message.type,\n      info: message.message,\n      closable: true,\n      autoclosable: false\n    };\n\n    this._addOrUpdateNotification(analysisNode.cid, notificationAttrs);\n  },\n\n  _addOrUpdateNotification: function (notificationId, notificationAttrs) {\n    var notification = this._getNotification(notificationId);\n    if (notification) {\n      notification.set(notificationAttrs);\n    } else {\n      this._addNotification(notificationId, notificationAttrs);\n    }\n  },\n\n  _addNotification: function (notificationId, notificationAttrs) {\n    notificationAttrs = _.extend({\n      id: notificationId\n    }, notificationAttrs);\n    Notifier.addNotification(notificationAttrs);\n  },\n\n  _getNotification: function (notificationId) {\n    return Notifier.getNotification(notificationId);\n  },\n\n  _onErrorChanged: function (analysisNode, error) {\n    if (error) {\n      this._addAnalysisFailedNotification(analysisNode);\n    }\n  }\n};\n\nmodule.exports = AnalysisNotifications;\n",
    "var CoreView = require('backbone/core-view');\nvar SourceLayerAnalysisView = require('./source-layer-analysis-view');\nvar DefaultLayerAnalysisView = require('./default-layer-analysis-view');\nvar template = require('./composite-layer-analysis-view.tpl');\n\n/**\n * View for an analysis node which have two source nodes as input.\n * The primary source node is rendered separately, this view renders the own node + the secondary one.\n *  _____________         ___________________\n * |  own node  | ------ |  secondary node  |\n * |____________|        |__________________|\n *       |\n *  ________________\n * |  primary node  |\n * |________________|\n *\n * this.model is expected to be a analysis-definition-node-nodel\n */\nmodule.exports = CoreView.extend({\n\n  tagName: 'li',\n  className: 'Editor-ListAnalysis-item',\n\n  initialize: function (opts) {\n    if (!opts.analysisDefinitionNodesCollection) throw new Error('analysisDefinitionNodesCollection is required');\n    if (!opts.layerDefinitionModel) throw new Error('layerDefinitionModel is required');\n\n    this._analysisDefinitionNodesCollection = opts.analysisDefinitionNodesCollection;\n    this._layerDefinitionModel = opts.layerDefinitionModel;\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    this.$el.html(template());\n\n    this._renderOwnNode();\n    this._renderSecondaryNode();\n\n    return this;\n  },\n\n  _renderOwnNode: function () {\n    var view = new DefaultLayerAnalysisView({\n      tagName: 'div',\n      model: this.model,\n      analysisNode: this._analysisDefinitionNodesCollection.get(this.model.id),\n      layerDefinitionModel: this._layerDefinitionModel\n    });\n    this.addView(view);\n    this.$('.js-primary-source').append(view.render().el);\n  },\n\n  _renderSecondaryNode: function () {\n    var nodeDefModel = this.model.getSecondarySource();\n    var layerDefModel = this._layerDefinitionModel.collection.findOwnerOfAnalysisNode(nodeDefModel);\n\n    if (nodeDefModel) {\n      var view = nodeDefModel.get('type') === 'source'\n        ? new SourceLayerAnalysisView({\n          model: nodeDefModel,\n          analysisNode: this._analysisDefinitionNodesCollection.get(nodeDefModel.id),\n          layerDefinitionModel: this._layerDefinitionModel,\n          showId: !!(layerDefModel && this._isOwnedByOtherLayer(layerDefModel))\n        })\n        : new DefaultLayerAnalysisView({\n          tagName: 'div',\n          model: nodeDefModel,\n          analysisNode: this._analysisDefinitionNodesCollection.get(nodeDefModel.id),\n          layerDefinitionModel: layerDefModel\n        });\n\n      this.addView(view);\n      this.$('.js-secondary-source').append(view.render().el);\n    }\n  },\n\n  _isOwnedByOtherLayer: function (layerDefModel) {\n    return layerDefModel !== this._layerDefinitionModel;\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<ul class=\"Editor-ListAnalysis-inner\">\\n  <li class=\"Editor-ListAnalysis-innerItem js-primary-source\"></li>\\n  <li class=\"Editor-ListAnalysis-innerItem js-secondary-source\"></li>\\n</ul>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar nodeIds = require('../../../value-objects/analysis-node-ids');\nvar layerColors = require('../../../data/layer-colors');\nvar template = require('./default-layer-analysis-view.tpl');\nvar Analyses = require('../../../data/analyses');\nvar AnalysisTooltip = require('./analyses-tooltip-error');\n\n/**\n * View for an analysis node with a single input\n *\n * this.model is expected to be a analysis-definition-node-nodel\n */\nmodule.exports = CoreView.extend({\n\n  tagName: 'li',\n  className: 'Editor-ListAnalysis-item Editor-ListAnalysis-layer CDB-Text is-semibold CDB-Size-small js-analysis-node',\n\n  events: {\n    'mouseenter': '_onMouseEnter',\n    'mouseleave': '_onMouseLeave'\n  },\n\n  initialize: function (opts) {\n    if (!opts.analysisNode) throw new Error('analysisNode is required');\n\n    this._analysisNode = opts.analysisNode;\n    this._analysisNode.on('change:status', this.render, this);\n    this.add_related_model(this._analysisNode);\n\n    this._analysisTooltip = new AnalysisTooltip({\n      analysisNode: this._analysisNode,\n      element: this.$el,\n      triggerSelector: '.Editor-ListAnalysis-itemError'\n    });\n    this.addView(this._analysisTooltip);\n\n    this._stateModel = new Backbone.Model({\n      highlighted: false\n    });\n\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this._stateModel.on('change:highlighted', this._toggleHover, this);\n    this.add_related_model(this._stateModel);\n  },\n\n  render: function () {\n    var status = this._analysisNode.get('status');\n\n    this.$el.html(template({\n      id: this.model.id,\n      bgColor: this._bgColor(),\n      isDone: status === 'ready' || status === 'failed',\n      title: Analyses.title(this.model),\n      hasError: status === 'failed'\n    }));\n    this.$el.toggleClass('has-error', status === 'failed');\n\n    this.el.dataset.analysisNodeId = this.model.id;\n\n    return this;\n  },\n\n  _bgColor: function () {\n    var letter = nodeIds.letter(this._analysisNode.id);\n    return layerColors.getColorForLetter(letter);\n  },\n\n  _onMouseEnter: function () {\n    this._stateModel.set('highlighted', true);\n  },\n\n  _onMouseLeave: function () {\n    this._stateModel.set('highlighted', false);\n  },\n\n  _toggleHover: function () {\n    var $layer = this.$el.closest('.js-layer');\n    var $title = $layer.find('.js-Editor-ListLayer-titleText');\n\n    $title.toggleClass('is-hover', this._stateModel.get('highlighted'));\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-ListAnalysis-itemInfo u-rSpace--m CDB-Text is-semibold CDB-Size-small u-upperCase\" style=\"background: '+\n((__t=( bgColor ))==null?'':_.escape(__t))+\n'; color: #fff\">\\n  ';\n if (isDone) { \n__p+='\\n    <span class=\"CDB-Text u-rSpace\">\\n      '+\n((__t=( id ))==null?'':_.escape(__t))+\n'\\n    </span>\\n    <i class=\"CDB-IconFont CDB-IconFont-ray CDB-Size-medium\"></i>\\n  ';\n } else { \n__p+='\\n    <div class=\"CDB-LoaderIcon\">\\n      <svg class=\"CDB-LoaderIcon-spinner\" viewBox=\"0 0 50 50\">\\n        <circle class=\"CDB-LoaderIcon-path\" cx=\"25\" cy=\"25\" r=\"20\" fill=\"none\"></circle>\\n      </svg>\\n    </div>\\n  ';\n } \n__p+='\\n</div>\\n<p class=\"Editor-ListAnalysis-title CDB-Text CDB-Size-small u-secondaryTextColor u-ellipsis\" title=\"'+\n((__t=( title ))==null?'':_.escape(__t))+\n'\">'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</p>\\n\\n';\n if (hasError) { \n__p+='\\n<div class=\"Editor-ListAnalysis-itemError\"></div>\\n';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar nodeIds = require('../../../value-objects/analysis-node-ids');\nvar layerColors = require('../../../data/layer-colors');\nvar analyses = require('../../../data/analyses');\nvar template = require('./ref-layer-analysis-view.tpl');\n\n/**\n * View for an analysis node that belongs to another layer\n *\n * this.model is expected to be a analysis-definition-node-nodel\n */\nmodule.exports = CoreView.extend({\n\n  tagName: 'li',\n  className: 'Editor-ListAnalysis-item Editor-ListAnalysis-layer CDB-Text is-semibold CDB-Size-small js-analysis-node',\n\n  events: {\n    'mouseenter': '_onMouseEnter',\n    'mouseleave': '_onMouseLeave'\n  },\n\n  initialize: function (opts) {\n    if (!opts.layerDefinitionModel) throw new Error('layerDefinitionModel is required');\n    if (!opts.analysisNode) throw new Error('analysisNode is required');\n\n    this._layerDefinitionModel = opts.layerDefinitionModel;\n    this._analysisNode = opts.analysisNode;\n\n    this._stateModel = new Backbone.Model({\n      highlighted: false\n    });\n\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this.listenTo(this._analysisNode, 'change:status', this.render);\n    this.add_related_model(this._analysisNode);\n\n    this.listenTo(this._layerDefinitionModel, 'change', this.render);\n    this.add_related_model(this._layerDefinitionModel);\n\n    this.listenTo(this._stateModel, 'change:highlighted', this._toggleHover);\n    this.add_related_model(this._stateModel);\n  },\n\n  render: function () {\n    var status = this._analysisNode.get('status');\n\n    this.$el.html(template({\n      id: this.model.id,\n      layerName: this._layerDefinitionModel.getName(),\n      bgColor: this._bgColor(),\n      isDone: status === 'ready' || status === 'failed',\n      title: analyses.title(this.model)\n    }));\n    this.$el.toggleClass('has-error', status === 'failed');\n\n    this.el.dataset.analysisNodeId = this.model.id;\n\n    return this;\n  },\n\n  _bgColor: function () {\n    var letter = nodeIds.letter(this._analysisNode.id);\n    return layerColors.getColorForLetter(letter);\n  },\n\n  _onMouseEnter: function () {\n    this._stateModel.set('highlighted', true);\n  },\n\n  _onMouseLeave: function () {\n    this._stateModel.set('highlighted', false);\n  },\n\n  _toggleHover: function () {\n    var $layer = this.$el.closest('.js-layer');\n    var $title = $layer.find('.js-Editor-ListLayer-titleText');\n\n    $title.toggleClass('is-hover', this._stateModel.get('highlighted'));\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-ListAnalysis-itemInfo u-rSpace--m CDB-Text is-semibold CDB-Size-small u-upperCase\" style=\"background: '+\n((__t=( bgColor ))==null?'':_.escape(__t))+\n'; color: #fff\">\\n  ';\n if (isDone) { \n__p+='\\n    <span class=\"CDB-Text u-rSpace\">\\n      '+\n((__t=( id ))==null?'':_.escape(__t))+\n'\\n    </span>\\n    <i class=\"CDB-IconFont CDB-IconFont-ray CDB-Size-medium\"></i>\\n  ';\n } else { \n__p+='\\n    <div class=\"CDB-LoaderIcon\">\\n      <svg class=\"CDB-LoaderIcon-spinner\" viewBox=\"0 0 50 50\">\\n        <circle class=\"CDB-LoaderIcon-path\" cx=\"25\" cy=\"25\" r=\"20\" fill=\"none\"></circle>\\n      </svg>\\n    </div>\\n  ';\n } \n__p+='\\n</div>\\n<p class=\"Editor-ListAnalysis-title CDB-Text CDB-Size-small u-secondaryTextColor u-ellipsis u-flex\" title=\"'+\n((__t=( title ))==null?'':_.escape(__t))+\n'\">\\n  '+\n((__t=( title ))==null?'':_.escape(__t))+\n' <span class=\"u-altTextColor u-lSpace u-ellipsis\">'+\n((__t=( layerName ))==null?'':_.escape(__t))+\n'</span>\\n</p>\\n';\n}\nreturn __p;\n};\n",
    "var $ = require('jquery');\nvar _ = require('underscore');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar template = require('./source-layer-analysis-view.tpl');\nvar TipsyTooltipView = require('../../../components/tipsy-tooltip-view');\nvar moment = require('moment');\n\n/**\n * View for a analysis source (i.e. SQL query).\n *\n * this.model is expected to be a analysis-definition-node-model and belong to the given layer-definition-model\n */\nmodule.exports = CoreView.extend({\n\n  tagName: 'li',\n  className: 'Editor-ListAnalysis-item Editor-ListAnalysis-layer js-base is-base',\n\n  events: {\n    'mouseenter': '_onMouseEnter',\n    'mouseleave': '_onMouseLeave'\n  },\n\n  initialize: function (opts) {\n    if (!opts.layerDefinitionModel) throw new Error('layerDefinitionModel is required');\n    if (!opts.analysisNode) throw new Error('analysisNode is required');\n\n    this._layerDefinitionModel = opts.layerDefinitionModel;\n    this._analysisNode = opts.analysisNode;\n    this._tableNodeModel = this._analysisNode.getTableModel();\n    this._stateModel = new Backbone.Model({\n      highlighted: false\n    });\n\n    this._initBinds();\n  },\n\n  options: {\n    showId: true\n  },\n\n  render: function () {\n    var isSync = this._tableNodeModel && this._tableNodeModel.isSync();\n    var syncData = {};\n\n    if (isSync) {\n      var syncModel = this._tableNodeModel.getSyncModel();\n      var runAt = syncModel.get('run_at');\n\n      syncData = {\n        ranAt: moment(syncModel.get('ran_at') || new Date()).fromNow(),\n        runAt: moment(runAt).fromNow(),\n        state: syncModel.get('state'),\n        errorCode: syncModel.get('error_code'),\n        errorMessage: syncModel.get('error_message')\n      };\n\n      // Due to the time we need to polling, we have to display to the user\n      // that the sync will be in a moment\n      if (!runAt || (new Date(runAt) <= new Date())) {\n        syncData.runAt = _t('dataset.sync.in-a-moment');\n      }\n    }\n\n    var isCustomQueryApplied = this._analysisNode.isCustomQueryApplied();\n    this.$el.html(template(_.extend({\n      id: this.options.showId\n        ? this.model.id\n        : '',\n      tableName: this.model.get('table_name'),\n      customQueryApplied: isCustomQueryApplied,\n      isSync: isSync\n    }, syncData)));\n\n    if (isSync) {\n      var tooltip = new TipsyTooltipView({\n        el: this.$('.js-sync'),\n        gravity: 's',\n        offset: 0,\n        title: function () {\n          return (syncData.errorCode || syncData.errorMessage) ? _t('dataset.sync.error-code', { errorCode: syncData.errorCode }) + ':' + syncData.errorMessage : $(this).data('tooltip');\n        }\n      });\n      this.addView(tooltip);\n    }\n\n    return this;\n  },\n\n  _initBinds: function () {\n    this._stateModel.on('change:highlighted', this._toggleHover, this);\n    this.add_related_model(this._stateModel);\n    this._tableNodeModel.on('change:synchronization', this.render, this);\n    this.add_related_model(this._tableNodeModel);\n  },\n\n  _onMouseEnter: function () {\n    this._stateModel.set('highlighted', true);\n  },\n\n  _onMouseLeave: function () {\n    this._stateModel.set('highlighted', false);\n  },\n\n  _toggleHover: function () {\n    var $layer = this.$el.closest('.js-layer');\n    var $title = $layer.find('.js-Editor-ListLayer-titleText');\n\n    $title.toggleClass('is-hover', this._stateModel.get('highlighted'));\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-ListAnalysis-itemInfo u-rSpace--m CDB-Text is-semibold CDB-Size-small u-altTextColor\">\\n  '+\n((__t=( id ))==null?'':_.escape(__t))+\n'\\n  <div class=\"CDB-Shape Editor-ListAnalysis-itemInfoIcon\">\\n    <ul class=\"CDB-Shape-Dataset is-small is-grey\">\\n      <li class=\"CDB-Shape-DatasetItem\"></li>\\n      <li class=\"CDB-Shape-DatasetItem\"></li>\\n    </ul>\\n  </div>\\n</div>\\n<p class=\"CDB-Text CDB-Size-small u-secondaryTextColor Editor-ListAnalysis-itemInfoDataset u-ellipsis\">\\n  '+\n((__t=( tableName ))==null?'':_.escape(__t))+\n'\\n</p>\\n';\n if (isSync) { \n__p+='\\n  <span class=\"Editor-ListAnalysis-itemInfoIcon\">\\n    <div class=\"u-flex u-alignCenter CDB-Text CDB-Size-small u-altTextColor SyncInfo-message--'+\n((__t=( state ))==null?'':_.escape(__t))+\n' js-sync\" data-tooltip=\"';\n if (errorCode || errorMessage) { \n__p+=''+\n((__t=( _t('dataset.sync.sync-failed') ))==null?'':_.escape(__t))+\n'';\n } else { \n__p+=''+\n((__t=( ranAt ))==null?'':_.escape(__t))+\n'';\n } \n__p+='\">\\n      <i class=\"CDB-IconFont CDB-IconFont-wifi\"></i>\\n    </div>\\n  </span>\\n';\n } \n__p+='\\n';\n if (customQueryApplied) { \n__p+='\\n  <span class=\"Editor-ListAnalysis-itemInfoIcon Tag Tag--outline Tag-outline--dark CDB-Text CDB-Size-small\">\\n    SQL\\n  </span>\\n';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar CarouselCollection = require('../../components/custom-carousel/custom-carousel-collection');\nvar template = require('./basemap-content.tpl');\nvar BasemapHeaderView = require('./basemap-content-views/basemap-header-view');\nvar BasemapModelFactory = require('./basemap-content-views/basemap-model-factory');\nvar BasemapsCollection = require('./basemap-content-views/basemaps-collection');\nvar BasemapInnerView = require('./basemap-content-views/basemap-inner-view');\nvar ScrollView = require('../../components/scroll/scroll-view');\nvar Notifier = require('../../components/notifier/notifier');\n\nvar NOTIFICATION_ID = 'basemapNotification';\n\nvar BASEMAP_ICONS = {\n  gmaps: require('./basemap-content-views/basemap-icons/basemap-gmaps.tpl'),\n  carto: require('./basemap-content-views/basemap-icons/basemap-carto.tpl'),\n  stamen: require('./basemap-content-views/basemap-icons/basemap-stamen.tpl'),\n  color: require('./basemap-content-views/basemap-icons/basemap-color.tpl'),\n  mapbox: require('./basemap-content-views/basemap-icons/basemap-mapbox.tpl'),\n  custom: require('./basemap-content-views/basemap-icons/basemap-custom.tpl'),\n  here: require('./basemap-content-views/basemap-icons/basemap-here.tpl'),\n  wms: require('./basemap-content-views/basemap-icons/basemap-wms.tpl'),\n  tilejson: require('./basemap-content-views/basemap-icons/basemap-tilejson.tpl'),\n  nasa: require('./basemap-content-views/basemap-icons/basemap-nasa.tpl')\n};\n\nmodule.exports = CoreView.extend({\n\n  events: {\n    'click .js-back': '_onClickBack'\n  },\n\n  initialize: function (opts) {\n    if (!opts.layerDefinitionsCollection) throw new Error('layerDefinitionsCollection is required');\n    if (!opts.stackLayoutModel) throw new Error('StackLayoutModel is required');\n    if (!opts.customBaselayersCollection) throw new Error('customBaselayersCollection is required');\n    if (!opts.basemaps) throw new Error('basemaps is required');\n    if (!opts.modals) throw new Error('modals is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._layerDefinitionsCollection = opts.layerDefinitionsCollection;\n    this._stackLayoutModel = opts.stackLayoutModel;\n    this._customBaselayersCollection = opts.customBaselayersCollection;\n    this._modals = opts.modals;\n    this._configModel = opts.configModel;\n\n    this._baseLayer = this._layerDefinitionsCollection.getBaseLayer();\n\n    this.model = new Backbone.Model({\n      disabled: false\n    });\n\n    this._basemapModelFactory = new BasemapModelFactory(this._layerDefinitionsCollection, this._configModel);\n\n    this._initCollections(opts.basemaps);\n    this._initBinds();\n  },\n\n  _initCollections: function (basemaps) {\n    this._basemapsCollection = new BasemapsCollection();\n    var basemapModel;\n\n    // Basemaps defined in app_config.yml\n    _(basemaps).each(function (categoryBasemaps, category) {\n      _.map(categoryBasemaps, function (basemap) {\n        basemapModel = this._basemapModelFactory.createBasemapModel(category, basemap);\n        this._basemapsCollection.add(basemapModel);\n      }, this);\n    }, this);\n\n    // userlayers basemaps\n    this._customBaselayersCollection.each(function (customBaseLayerDefinitionModel) {\n      var category = customBaseLayerDefinitionModel.get('category') || 'Custom';\n      basemapModel = this._basemapModelFactory.createBasemapModel(category, customBaseLayerDefinitionModel.attributes);\n      this._basemapsCollection.add(basemapModel);\n    }, this);\n\n    // Plain color or image basemap\n    basemapModel = this._basemapModelFactory.createBasemapModel('Color', {\n      color: this._baseLayer.get('color') || '',\n      image: this._baseLayer.get('image') || '',\n      selected: this._baseLayer.get('className') === 'plain'\n    });\n    this._basemapsCollection.add(basemapModel);\n\n    this._categoriesCollection = new CarouselCollection(\n      _.map(this._basemapsCollection.getCategories(), function (category) {\n        return {\n          selected: this._getBaseLayerCategory() === category,\n          val: category,\n          label: category,\n          template: function () {\n            var template = this._getTemplateForCategory(category.toLowerCase());\n            return template();\n          }.bind(this)\n        };\n      }, this)\n    );\n  },\n\n  _getTemplateForCategory: function (categoryName) {\n    var template = BASEMAP_ICONS[categoryName.toLowerCase()];\n    if (!template) {\n      template = function () {\n        return categoryName;\n      };\n    }\n    return template;\n  },\n\n  _onChangingBaseLayer: function () {\n    this.model.set('disabled', true);\n\n    if (Notifier.getNotification(NOTIFICATION_ID)) {\n      Notifier.removeNotification(NOTIFICATION_ID);\n    }\n\n    this.notification = Notifier.addNotification({\n      id: NOTIFICATION_ID,\n      status: 'loading',\n      info: _t('editor.layers.basemap.saving.loading'),\n      closable: false\n    });\n  },\n\n  _onBaseLayerChanged: function () {\n    this.model.set('disabled', false);\n\n    this.notification.set({\n      status: 'success',\n      info: _t('editor.layers.basemap.saving.success'),\n      closable: true\n    });\n  },\n\n  _onBaseLayerFailed: function () {\n    this.model.set('disabled', false);\n\n    this.notification.set({\n      status: 'error',\n      info: _t('editor.layers.basemap.saving.error'),\n      closable: true\n    });\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:disabled', function () {\n      this.$('.js-basemapContent').toggleClass('is-disabled', this.model.get('disabled'));\n    }, this);\n\n    this._basemapsCollection.bind('change:category', function (mdl) {\n      var userLayersMdl = this._customBaselayersCollection.get(mdl.get('id'));\n      userLayersMdl.set('category', mdl.get('category'));\n      userLayersMdl.save();\n    }, this);\n    this._basemapsCollection.bind('remove', function (mdl) {\n      var userLayersMdl = this._customBaselayersCollection.get(mdl.get('id'));\n      userLayersMdl.destroy();\n    }, this);\n    this._basemapsCollection.bind('add', this._onAddBasemap, this);\n    this.add_related_model(this._basemapsCollection);\n\n    this._layerDefinitionsCollection.bind('changingBaseLayer', this._onChangingBaseLayer, this);\n    this._layerDefinitionsCollection.bind('baseLayerChanged', this._onBaseLayerChanged, this);\n    this._layerDefinitionsCollection.bind('baseLayerFailed', this._onBaseLayerFailed, this);\n    this._layerDefinitionsCollection.bind('change', function () {\n      this._renderHeader();\n\n      this._baseLayer = this._layerDefinitionsCollection.getBaseLayer();\n      this._updateSelectedCategory(this._baseLayer.get('category'));\n    }, this);\n    this.add_related_model(this._layerDefinitionsCollection);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template());\n\n    this._initViews();\n    return this;\n  },\n\n  _updateSelectedCategory: function (category) {\n    var newCategory = this._categoriesCollection.findWhere({ val: category });\n    newCategory && newCategory.set({ selected: true });\n  },\n\n  _onChangeSelectedCategory: function (mdl, isSelected) {\n    if (isSelected) {\n      this._renderContent();\n    }\n  },\n\n  _getBaseLayerCategory: function () {\n    var category = this._basemapsCollection.getDefaultCategory();\n\n    if (this._baseLayer.get('category')) {\n      category = this._baseLayer.get('category');\n    } else if (this._baseLayer.get('type') === 'Plain') {\n      category = 'Color';\n    } else if (this._customBaselayersCollection.hasCustomBaseLayer(this._baseLayer.get('className'))) {\n      category = 'Custom';\n    }\n\n    return category;\n  },\n\n  _initViews: function () {\n    this._renderHeader();\n    this._renderContent();\n  },\n\n  _renderContent: function () {\n    var self = this;\n\n    if (this._contentView) {\n      this.removeView(this._contentView);\n      this._contentView.clean();\n    }\n\n    this._contentView = new ScrollView({\n      createContentView: function () {\n        return new BasemapInnerView({\n          model: self.model,\n          categoriesCollection: self._categoriesCollection,\n          layerDefinitionsCollection: self._layerDefinitionsCollection,\n          basemapsCollection: self._basemapsCollection,\n          customBaselayersCollection: self._customBaselayersCollection,\n          modals: self._modals\n        });\n      }\n    });\n    this.addView(this._contentView);\n    this.$('.js-basemapContent').html(this._contentView.render().el);\n  },\n\n  _renderHeader: function () {\n    if (this._headerView) {\n      this.removeView(this._headerView);\n      this._headerView.clean();\n    }\n\n    this._headerView = new BasemapHeaderView({\n      model: this._layerDefinitionsCollection.getBaseLayer(),\n      category: this._getBaseLayerCategory()\n    });\n    this.addView(this._headerView);\n    this.$('.js-basemapHeader').html(this._headerView.render().el);\n  },\n\n  _onAddBasemap: function (mdl) {\n    this._basemapsCollection.updateSelected(mdl.getValue());\n  },\n\n  _onClickBack: function () {\n    this._stackLayoutModel.prevStep('layers');\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"js-selector\">\\n  <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n    <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.layers.basemap.category.title-label') ))==null?'':_.escape(__t))+\n'</h2>\\n  </div>\\n  <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m js-highlight\">'+\n((__t=( _t('editor.layers.basemap.category.select-category') ))==null?'':_.escape(__t))+\n'</p>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./basemap-categories.tpl');\nvar CarouselFormView = require('../../../components/carousel-form-view');\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    if (!opts.categoriesCollection) throw new Error('categoriesCollection is required');\n\n    this._categoriesCollection = opts.categoriesCollection;\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    this.$el.html(template());\n\n    this._renderCarousel();\n\n    return this;\n  },\n\n  _renderCarousel: function () {\n    var view = new CarouselFormView({\n      collection: this._categoriesCollection,\n      template: require('./basemap-carousel.tpl')\n    });\n    this.addView(view);\n    this.$('.js-select').append(view.render().el);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-HeaderInfo\">\\n  <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">1</div>\\n  <div class=\"Editor-HeaderInfo-inner CDB-Text js-select\"></div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar DEBOUNCE_TIME = 650;\n\nmodule.exports = Backbone.Model.extend({\n\n  initialize: function (attrs, opts) {\n    if (!opts.layerDefinitionsCollection) throw new Error('layerDefinitionsCollection is required');\n    if (!opts.basemapsCollection) throw new Error('basemapsCollection is required');\n\n    this._layerDefinitionsCollection = opts.layerDefinitionsCollection;\n    this._basemapsCollection = opts.basemapsCollection;\n    this._disabled = opts.disabled;\n\n    this._generateSchema();\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this._onChange = this._onChange.bind(this);\n    this.bind('change', _.debounce(this._onChange, DEBOUNCE_TIME), this);\n  },\n\n  _onChange: function () {\n    if (this.hasChanged('color')) {\n      var color = this.get('color').color.fixed;\n      this._updatePlainBasemap(color);\n    }\n  },\n\n  _updatePlainBasemap: function (color) {\n    var plainBasemap = this._basemapsCollection.find(function (mdl) {\n      return mdl.get('className') === 'plain';\n    });\n    var isAlreadySelected = plainBasemap.get('selected');\n\n    plainBasemap.set({\n      color: color,\n      image: '',\n      maxZoom: 32\n    });\n\n    if (isAlreadySelected) {\n      this._layerDefinitionsCollection.setBaseLayer(plainBasemap.toJSON());\n    } else {\n      this._basemapsCollection.updateSelected(plainBasemap.getValue());\n    }\n  },\n\n  _generateSchema: function () {\n    this.schema = {\n      color: {\n        type: 'Fill',\n        title: _t('editor.layers.basemap.style.color'),\n        options: [],\n        editorAttrs: {\n          color: {\n            hidePanes: ['value'],\n            disableOpacity: true\n          },\n          disabled: this._disabled\n        },\n        validators: ['required']\n      }\n    };\n  }\n\n});\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar template = require('./basemap-form.tpl');\nvar BasemapFormModel = require('./basemap-form-model');\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    if (!opts.layerDefinitionsCollection) throw new Error('layerDefinitionsCollection is required');\n    if (!opts.basemapsCollection) throw new Error('basemapsCollection is required');\n\n    this._layerDefinitionsCollection = opts.layerDefinitionsCollection;\n    this._basemapsCollection = opts.basemapsCollection;\n    this._disabled = opts.disabled;\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template());\n\n    this._generateForms();\n\n    return this;\n  },\n\n  _generateForms: function () {\n    if (this._formView) {\n      this._formView.remove();\n    }\n\n    var color = {\n      color: {\n        fixed: '',\n        opacity: 1\n      }\n    };\n\n    if (typeof this.model.get('color') === 'string') {\n      color.color.fixed = this.model.get('color');\n    }\n\n    this._formModel = new BasemapFormModel({\n      color: color,\n      image: this.model.get('image') || ''\n    }, {\n      basemapsCollection: this._basemapsCollection,\n      layerDefinitionsCollection: this._layerDefinitionsCollection,\n      disabled: this._disabled\n    });\n\n    this._formView = new Backbone.Form({\n      model: this._formModel\n    });\n\n    this._formView.bind('change', function () {\n      this.commit();\n    });\n\n    this.$('.js-form').append(this._formView.render().$el);\n  },\n\n  clean: function () {\n    if (this._formView) {\n      this._formView.remove();\n    }\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"js-selector\">\\n  <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n    <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.layers.infowindow.style.title-label') ))==null?'':_.escape(__t))+\n'</h2>\\n  </div>\\n  <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m js-highlight\">'+\n((__t=( _t('editor.layers.infowindow.style.select-style') ))==null?'':_.escape(__t))+\n'</p>\\n</div>\\n\\n<div class=\"js-form\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./basemap-header.tpl');\n\nvar DEFAULT_NAME = _t('editor.layers.basemap.custom-basemap');\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    if (!opts.category) throw new Error('category is required');\n\n    this.category = opts.category;\n  },\n\n  render: function () {\n    this.$el.html(\n      template({\n        title: _t('editor.layers.basemap.title-label'),\n        description: this._getName()\n      })\n    );\n    return this;\n  },\n\n  _getName: function () {\n    var name = this.model.getName();\n\n    if (!name) {\n      name = DEFAULT_NAME;\n    } else {\n      name = this.model.getName().replace(/_/g, '') + ' ' + _t('editor.layers.basemap.by') + ' ' + this.category;\n    }\n\n    return name;\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-HeaderInfo u-alignStart\">\\n  <button class=\"u-rSpace--xl u-actionTextColor js-back Editor-HeaderInfoEditorShape\">\\n    <i class=\"CDB-IconFont CDB-IconFont-arrowPrev Size-large\"></i>\\n  </button>\\n  <div class=\"Editor-HeaderInfo-inner\">\\n    <div class=\"Editor-HeaderInfo-title u-bSpace\">\\n      <h2 class=\"Editor-HeaderInfo-titleText CDB-Text CDB-Size-huge is-light u-ellipsis\">'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</h2>\\n    </div>\\n    <p class=\"Editor-HeaderInfo-description CDB-Text CDB-Size-medium u-altTextColor u-iBlock\">'+\n((__t=( description ))==null?'':_.escape(__t))+\n'</p>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAAA4CAYAAAB5YT9uAAAAAXNSR0IArs4c6QAAB51JREFUeAHtW+tv21QUP3HeTtykTdt1a9d1GxNIwBAggRD/O1+RkPgAQhogNq2dlnVdm+Yd23lxfm5v5zqO48dtfTX1SpGvr69Pzv35+ryd+f3Pv+akYGuevKfPHx/Q7s62NO6mpkVjy6JSbS0xTXs8ppFpUrVcpsl0Ru1ej3IZjcp6mfRy6Yp+7qqnWKdULEoFF8vLloo0nUxp0O5QpV5LtOIJ08lqWRrwQ0O7t9lg2hPK5q5Dev0s0V/Ku3kyndJGrS6PoItSoaqTeXziGonXBY8VfmBuQN19QVUTHZWO/eGA9h/cU4mlBV5mDLAfoN6JSgIMJt1yzMt0knO8xrlCMQkJ514tm6X3p2cr6SgHMF697cb6SsbjThictkjfSCZ/8d9r1QrlsznqD4aOslvGj3IAdwd92ttRWzwIMMvlImmaRqPhhaIT4+6jckoun9WokM+7eYzchxjATvW2DGv9yuaGdzj2ebl0YY6Zl5aEHyH1AM4nZ0konzWJNrQfeBizLJsKheUbQikRcd7p0MGDB8vWEmkcdm5Xgjm26k+LxQLZ1tixgf3mKgNwq9Nm02yH6hK8LCwUTsVtgbzBSrPTHRC8O9GGI9PpJn8fBcWYx5OzU+fO/d37tCNRPoIoQL6tBpBbrQ6bgDma2BMa2ZZjaqYOsFGt0nrNoINdOaLBCygUm58L650n4xwgQyaXWGxow4xDMnURUS6W6LzTlbE+XxrGdsPXovCdLGEQMjmbuQAX5FIHGEwUJFgOoBPU7P4w6LK0a3hbII8HLIPRTx3gdq9LTx7uSVugHyGYa2a/T4Oz86Xa3u++OGOd3oAgKkSYNXWAs1qGhMHuXtAqF9Q9N0wfIJdY1vs5IGHuDzMHPNuTsSOHMR/2eOpKTmMl5G0IZMN4T+rReekKB8Q7LvO8qusEOSxa6jt4NltMqHR6fengYsEQEUkD7QI4v2O1orPsHV2zh1MF2LJt2mpcD6y3zjv07+sjP/4TjUHhTNkRuEnbuNsfOOLO/ealCnCn31uwf9+dfqAJg+H2ihIhyzdbrNWH522pgR4/nuBgIIzpbqnLYAStNzluMGID3bbH1O0NnWSnexe4GY7Tt60RGVubcW5deQ/ejHanxwotS9m8tuDUZNLMKk9nYzI5UGJaphO4/vn7b6UrNwAwZu0uI5PsRRu0YfNWDd3RGfDi+iwm6mytCIWa6g7OanmqlPHTWXbp1B8OaadyfadhEYJZ7wLDnI/Z4Nc48yC7IZhjjiyqrVWu+IP1kON4do8fKJT3xnotfUdDLFzn4HWbd4Nor982nZzX4btjMRTraPNikUmW2aAfEGSHQ+F9+DhHRLBmVOiMrRb5jzbmSs7aLVZ4uwRgm+8/UI89r7379xwR0qp2nN0Qk7TU2+BMQAljdwa1C6ANSlUGuxlEshPp+qpe4dfswvlAAP6n7567p0XuQ8TAe5OV3YAZuQpcN5OpmmluRgBq3Vi7AhfXZvOpe0qsPnZSiUOipqSIXY4DU1FMSGUA9kMvw7Ve2IFJG2SwfZlhQH0atH3chmoeuPJhmzIyOCzDcechmyxydJpRdcypRoj6C2GKzeczyrOVgIoev+DUMr7U3sGUWdDSyxayahyiQshhxAyQ2oE8xS+oweSCKQZwx7zzda6edAdzgu7FNWV3MJTeei1YU69anLiOXWiyt4VYROGytLRmGM5lXIM5RRw2ZaFP7l0NUYBqTOfhVBkqjxss6AcdlQUYydAfnn8VxHvoa7AiEEXzC/QAPAEqlJd7R6NyR1wL/WeeicqYaR6+uKh56tjCMsy0m3KVvTz7nSsrg2G2ZS/tYT/Gw45h995EHCLs/ysLMBYwntiJzDRYDTJr0cKC6p6nNMAWhy+n88WMh3sBy/pQXlBokLFpNqUBbtTXY6eOhlxlk2dzLO2mNMBDzm/FbfNZuBL/uPTD3qc0wBnYpjEbzLLbKjYJYlFpgEvF5XW3QYvCNdi81jD+G7CKftjrygKMip/He7th1+E7D2Ii7aYswPCq8BXlTbQOf5V5Wy1dGyZglQZbAElMLDwgwNh8eUimPaLpdO4kV/FFZo5NNxGLCGBByiUlAe4NBlwQ+LFeuM3BclQrbnF4EaWhq4AXaScgtFY1qFS4eBOQXEUu7bD5mgacYP3i8cFKWklRVjIWgUDPj998TW+Oj+kEiUPOCussLpCnE1kOBOPzXIvw9OHDqxQOdu0fL/7hHZon1B0HNcQ6ulz48uWzJze6m5UEGF/aF7n4r2bUrqWQ/AA7ar6lCsdoSwwo6isa9WifaUGZbnIC87NH+37kE48pCXDUVb08OqT6mhEZXPE/qJErFgr07NGu8/U8PgGQVVmkpAwWCw97fLr/yAlvhp3vnQdw8ZXTyNpaqC3zzo16rqyZFnUhItUf9T73fJTNym6fDMAygBFl/zJoCRp3AF8iATHx3+FRpJS8ADHoeAfwJTqwkbv9Ef3y62+RCkuCwD3jmuRPQskFLTLKNVgO+DByyEGiQi16oAmAvnrTpDzXCc/nGcepuQPY9QSEooQrHaX9ze44ihcL+SIZlY8V7nB27kSEB8ntjQa9ePnKM7r8FG457Gg4OG5wxR3/AwJZx54EdH2PAAAAAElFTkSuQmCC\" />';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"23px\" height=\"25px\" viewBox=\"1383 664 23 25\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n    <g id=\"color\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(1383.000000, 664.000000)\">\\n        <path d=\"M19.04725,12.691 C19.12525,12.504 19.08225,12.289 18.93925,12.146 L9.93925,3.146 C9.84125,3.049 9.71325,3 9.58525,3 L9.58525,2.5 C9.58525,1.122 8.46325,0 7.08525,0 C5.70725,0 4.58525,1.122 4.58525,2.5 L4.58525,7.793 L0.73125,11.647 C-0.24375,12.622 -0.24375,14.208 0.73125,15.183 L5.40325,19.854 C5.87525,20.326 6.50325,20.586 7.17125,20.586 C7.83925,20.586 8.46625,20.326 8.93925,19.854 L15.79225,13 L18.58525,13 C18.78725,13 18.97025,12.878 19.04725,12.691 L19.04725,12.691 Z M5.58525,2.5 C5.58525,1.673 6.25825,1 7.08525,1 C7.91225,1 8.58525,1.673 8.58525,2.5 L8.58525,3.793 L5.58525,6.793 L5.58525,2.5 L5.58525,2.5 Z M15.58525,12 C15.45225,12 15.32525,12.053 15.23125,12.146 L8.23125,19.146 C7.66525,19.712 6.67625,19.712 6.11025,19.146 L1.43825,14.475 C0.85325,13.89 0.85325,12.938 1.43825,12.353 L5.38925,8.401 C5.42025,8.377 5.44725,8.351 5.47125,8.32 L8.58525,5.207 L8.58525,10.5 C8.58525,10.776 8.80925,11 9.08525,11 C9.36125,11 9.58525,10.776 9.58525,10.5 L9.58525,4.207 L17.37825,12 L15.58525,12 L15.58525,12 Z\" id=\"Shape\" fill=\"#AAAAAA\"></path>\\n        <path d=\"M20.01225,15.241 C19.83125,14.942 19.33825,14.942 19.15825,15.241 C18.89425,15.674 16.58525,19.522 16.58525,21 C16.58525,22.654 17.93125,24 19.58525,24 C21.23925,24 22.58525,22.654 22.58525,21 C22.58525,19.522 20.27625,15.674 20.01225,15.241 L20.01225,15.241 Z M19.58525,23 C18.48225,23 17.58525,22.103 17.58525,21 C17.58525,20.225 18.68125,18.061 19.58525,16.485 C20.48925,18.061 21.58525,20.225 21.58525,21 C21.58525,22.103 20.68825,23 19.58525,23 L19.58525,23 Z\" id=\"Shape\" fill=\"#AAAAAA\"></path>\\n    </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"22px\" height=\"24px\" viewBox=\"966 769 22 24\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n    <path d=\"M973.5,791.5 L966.5,786.5 L966.5,770.5 L973.5,775.5 L980.5,770.5 L987.5,775.5 L987.5,791.5 L980.5,786.5 L973.5,791.5 Z M973.5,775.5 L973.5,791.5 L973.5,775.5 Z M980.5,786.5 L980.5,770.531 L980.5,786.5 Z\" id=\"Shape\" stroke=\"#AAAAAA\" stroke-width=\"1\" fill=\"none\"></path>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text CDB-Size-small u-upperCase u-altTextColor\">Google maps</p>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAAA4CAYAAAB5YT9uAAAAAXNSR0IArs4c6QAAFuFJREFUeAHVnHlw3dV1x89bJD3tq/Uky5YxAowx2BgabKCFEJhQpswAmWb6R5tJykySJm3TpNOmZdopkE6bTDvTkK0kKdmmnZBOoaFpAw5tEnANttm8ETBxjFfZkqztaX3v6emp53N+78hXwisQoZ6Z97u/u/zu8r3nnnvOuVeKfW5LYUYWiBqqEufV0oeuKMyWn57Xy2w2J6lUhRTyOSkURcYzwxKvqLDyjQ0NkoiJ8A3lCoWCjI6NyY7tr8n6DauktqZGpgpTVrYyVWn1zDakL/4taWNj41a2tqpS9h3fL6lYo5TLlMTLK2Q4NyDlVUmpKqY0rcLapxz9gSazk5KMXhfXs6I0D7lcTpI6EEBKxsXeC4VpyQz022AYAFTUchBgAebQ8LDFAbq6skLGtRigdl2yzEC+4earrSwT5GD6hHmcCnhnIvLa5ujEpKxMd0kymZTsxJjVn0otlbJ4TFJVNdrHrNTUVFtfyaRu2l6UAOemRa6u6ZPMYE7qm5qMO21EpQecOj05IbEy5djpglRUphT8lOUCSFmyzIAgAS5mcjRBVqzskNGRMek+0mvvnk8IIGGc9/HJaOLqdXKYOACDMpNZqW9skPrSiiGtoqza2uI9nLhFCTCdzFY0S2v7jHUaAKGcDszBHFeuTcxMS6q+YRZMuAiCkyDnRlZBQVcB1NczLCu7OiLQgzLkeXnenVgFEc2dAOqEXHTxLRROFGmLFuA1LQXtfCQrnDtr6uptEAO9vSYiampqFdzE7LKEexETIVAsfSdESkWqXOrrlCNVTlaUQPF8wEKmSzxp9cKxuSldTkoVZSf3D1bQ8Ik+aVjSankObtguGbZ6rMQifFSVJ6yDYyMZyY6PSyye0MGn7D1RWaUytdaWLQAjF0fHRiPRoOIA2Q2AhXzWRAcigvhL2/fK9Teul2EZkoZ4o9UfggMMWf9O65wsH5bGZNrQcU4lAlczySO2F1TaipkPrn2kD6TToiPf5AZ6jstUcUZa2pcaxwJ0qrraNjVkIprDQP+AAR1XuQsHZ/MFA9N28JJcZoDjqkXksnkTDTXFRqlQLnRwLV/l7eDouGGBiLENKhaT/nyPpc1/wMXl1bWSG482vFnuLxVk5VD/gomI8rJ563F+j4P42nQke5vb2o1TyIJjk8o5dBxZPEu6yQEmomFSAc4MjcjP9hyQwpQCPT0tRR05IbT6ss453EsaWgmrwHb9WCRXTSxoWm2sVWrLxUBmUlgplEWMwMWsLq9DitHEOqDUZ1qQlViAR1zmKbJnaPOiurzmJmYHQFFkIFxCxxEVrvcCLO8obKhrqfK4gYu+W6zS3V4aJKOwlmt9sVRScjIhQzPKycUKaUmkJaH1AqjLWNoAxJBayttsYmfTVUYz0awuOJn0bDbS2V3mm+ailZyziKiIzwi/N0vZSK8/58+dU6tVS0DZZ+BObHbN6bRxLeBCAI3qRPn33LpBnnlqt4wMjRu4zQpQpehyVlDS0iFLKjoNXK8PgKifH8s6FB3+jsiA253jAZA2mVT6Stw1CFfn0DTigHbiZ9t0Rk/utt5wGOYnRmTzV+87a7nwmzf7jiI/NjQgeeU3liWylYGFg+edTQwOQnVjcK46Mdg733eDHNs7Iql8jXWDSemoWyGTZdGydkAdVApRp6c7sMQhQudgAHVrrb65xUQUZUhHXPX19JomYsCPD/fJ9n/5B7nxY/dLbedqyp2WThx4VWaQZ+fM93OrGp6YlrOZy3d1DthHuWrdsHTh904ctfZayhpmOYwCDBjQ2M1TOkgIUCIREjFLorwo2cm8zNQNSTKvMlQ5qiynqp6q1SGAIYie7vV5HnEDDDms4+/tHZTnX9ghQ5kRqdANNpGIS9fKZbJyZadWHll7z7+wS5I1zWn59Xu+JIQsYzg6FrRyqqWdKqM5UbBnJFfUUZWI9PpUJL9UPKmM8hxRk1JxOllUPB+NoaNyXK5uUw7RMpnBCaluaJKO1IpZjqI74UA93n/8mKSXLp0FnjLkIQ3hsPql6j/4xQHZuORqS2MDYvliofly9qH6t95jb8/bcu70/K1bn5Ply1bIjTddZ+ohm2vfRI/MpIoSU3lcX98sIyq+koB06MUfyyW/eqfa1FXSf/A1OfLcT2VKd8r69k5Z/q6bJV4ZKfhUPnz8kBx98Slrp33dddK2ap0BTcJxTX9x/x4pT9XKqg03yZIVXYLZG5vKykubfyida66Vnz/zuFpVWblow7tl2arLrZ7yYl5FwqjpuvqInCSskpK1ZIX0EYKBCof65kCEIZyK5VbXVC0Dh4Zl39G9srLtIpXlBdNZATesy+snpB7Pc3BJ9wlBZGXU1zE9XZR1V622dMqlUmquM6twkSo51FOtalx8upCXV598TIqTo5JR8J596LNS075C2i/fKHkFYmo82kRoBNr56NelRtWnZHW9bPmnv5Ge13YZxz//8Bdk75YnZWnXFQpwpWz60r3Su/9V49ypXFZ2/eC7svkbn5OG9FL7/keaP9LfZxOwd6LR9NvWtrQg03CgZIaGZwfq4NE+74iF1vZ2onMoBIbV0FTWKkn1VwwcUf1W1SjAMUut9FUIZlgRHA7Heuh5phvrhhjXX2EqLwMnBj3LwoQaQ7EhBViJ7yFX2ywy0ntcKuuaZOU1N0tSN4/lV2609FBMXHHHh4xrLWM6Jwef2ySNLW1yeOez8v77HpS6lsh8zKuw3/mT78utXSfl+jV3fVA6r7jaPj26Y7sce223rNx4i8WRpwwYAwJi43IACCFCA1cnIqSQ0/wdLq7VQhuvvVq2bH5WNv90l1x741pbzng2Ejq+cEJc9yUNbsUjh9OovvakE8f706LayuVXrJUtW7ZJc3ODLFveIcs6tE8zMzLTKKoYRvJ+ulicu121r16v1kmdPP7XH5Gnv3Kv7Nv8mBRUDQmpcekFJqtJq13aJaPHeyQ7qBNT22jgIhKgTq1r9PCBKFJ6pi+81DiWaFlVSsFE351LDA6wMSacCxi0/yjNQFHiXdEnzcHiHY3DQl2xcPLGjVeZH/jV3a+bIcJKpg5+cCmhawjEIQwJB/dUba9bv1ree9tN0rykWY4e6Zb/eGyT7N11aBZc788sB6OmYj7e+Pv3y9hArwwdOSB7n/xXGVNZt/quj1mjPBJqfkY8ppvY5JhNSIXK7mmVsw4u5SZGhhTFSl5nKZZImLnBBhfSBy73GqNUuAcOdn3SywIEei5cPFNUjaS52UBmQiAGBfCIF9OJcdZoHPmYUxN6eGhMrtnY5NVZedqgXojvpyoyMqkdbIxHq8SB8nybjNLewCS0XBVpN3t27JLde/bKmrWXSqPme51xNXyMUAxyo1r50AnTKBAPbWveJZMTc2Xw8Vd3CNoCZQ9u/W9ZesV6aevssjr2bXlc0AqQ3cjjzis3mLYQtXD6p3Ocl0AGh0RnvcOu+6I9uC4K4HBz77FjyvWRrxYH+ew3yrEH9nfL6vUXz1Y7HziPF3SZn468Pi/r5ZDrKy++SCa0zWHVJsj31TfLwRQeOnZQXvzeP9p35eqxyqtTe8MHP+X1WPj6M0/IjkceVBAnFcDrZOWG22SmrFxu+vCfy+ZvPyC7N/27cXPrqstk3W/89hxVbU5FQWTfJ74mk+oEh2LLl0jnve8XNjy4D8Bsh1aucJEwo5smecZ9KlLIh+rrIznOe1G5mJWApQXXZ4Yn1A+sjgUlN0gsMu+B+QyQgOSAUiQElfR9r+2T9g7dsNUxxETvffkVqdLjoiXNUR9c64g9sP2NZ3KICKi6odU0BDY5131Jh3sRFWyEvgGma9WmV9GXG+qTWEWN1NZWzdF1+Q6iTKgTE19zz19IvjtaKeUdDbLioY+bPhnPxrSulIGESKhpbDZQsZQQIQA6nxwUJsPkuAK8a8dBVakulnQ6Eg+IwpD8G9IcyDDN0z2NiXvxuR0yMHBydaNVvPumG6Szs90mhlW56fH/kaQDFDaYrIvkT05nRvgpzSmXqo+UeQR3iXpHo40lVdNsjpNQHofvFA8NkAtrIheh10OIsg7VNUZuxUwmMm9dJuOHgHzAvM/nOHPSq1Nm584DtsEtaWqg2Bu4lzocVPLDOokDFBugO4TIR/be8t6bTAx0Hz6uKyguKZ00Vop/zze3vPfdc9U0KnyrxERkS6cAXteZzOPXx6pleVNa6kqFK5enJd1wUsdFFJhPWFUj77zXSzgf2DCeU/ECAQjkomF+PR4PgbYP+EaBcvJyxHFA4QtecUG7KQf0k801Gde2dGJ7i4fUKq56+wH2zoQhgKeCI5cwj/cjf/oJS0KbCAHifXhgwLQFCrCZOEj2gT7CQYcAoZ5B7mSPYiefbEIuJz01rMs3KdcyANrrZ0UhftBU6A/fERIHZKiiscrCUjfs/Zf2mCNeztBKCK4Xwxym00P9/Rb6wAlZvh738oRurR0+0KOnx5E4CfN5ZwKsDp00uNHJQSTuExCmubhCTM2fbOKkA7QMFGVa940FAZjO4knjdyZ66nDUnd5st3HLcLFPhoq91unGlhbrOP5fgIWzcJIThgA4F7KzDw6OStvSlll1LmwbMIzLdTmbJqB1hhPs4Hp95Dm4rndTH+lh+6SxicIYyUxSYgt5s4fGzySPyQ8pvNlDOoNF5438v5FqNp+LGCzyEELF2/T4c3L7nTdYnIcDx7vf2nEZ7UA5qJQhjTgh2gvc6VpIWC4sG74vOMA0/lZBHhsaVMtsShJqkEyr1WWA6+0a5CTLHhBRpSZGRuT48UgmXr5ulXGsGyf0IwSbuAPMu4MXpsHBfoXAZbNrGd4u3zrx7RxDwzMWfagmtyp7s/cS0Hkz6pnDZGcHHxvJSkIPQ9NqrFTV1cnWp3fL/sqDNqy2dHSsFDmV5urD4bgBx0FmRbBS0GbUwjKQyXNwCX2yABrwnRYc4PPhXjrpg/QBu4hgM3HuQibyM8uNYyTl5EZ1e7LZcRlv3foL5NDBfpnU041Jdea0t+ekuTVtAPlh6qnaAiw/82OVYBVOqXx10PgW5xDgOgczcZnRyDVKnQu2ydEYNF9HjlJP/4Q76DxAA67t0mrBObh86e+4EZtbmu0wMqwRTl57pTr/9V5Ex4q0nuOpWyDTa5cIfQJpw8lclxoBXGQu536oZYBMuW1bX1QX6DbpV+0GcOkjhEzH5xxtmgXL88mwAgvxQGULze6ztYlcdWUfSwmuxJfrBEAOsKfZoLUcdGJwWF7ZdcDeGxrVhNeLfJmiggUwkwWbNMvUB9cBkLEsceQt5jkyOxMbkK62LnnggW/Ik0/+r1y6aoXeJJqUo4e75b77/0x+ZcPakvyP5DoriZVDuKAAn694cMPDAWDgeMzwpDnNB9fTAYYT3j0v7ZeOZc2y6tIL7NYPHKbH1RHpPGVjkbVXVZOS0RNqkk9k9fhq2m5uZqpHJBfPqtc1Ji/s3SE/euIn8pmv/Yl0pFulEFdHVIaztzrjakQDnJtRLmZCqmIXmAW5YACfL7gg8M8vJwVVDS5laeKq5I6aL+sIpYiDQ6Api447MTqpg04ZuMaJxX41Xyvs+J5vu0cOKcdGEEyMKVc3qijAvIa7lcuZiKpktZDX09ujjq8ySTc2aT8KMqVuzVR90oyJntxRmc5Pyw8e2yMHXj8kra1N8r7fVHVOxdWCy2AH5VxC7gizgyN7ARcyK6n0MaCGwJLsVhx31LY+87I62NfYMgfwzvoVpS9VBuvynZopyFh+1H5wMBdTADyR1IqVUnpdBXDJW3vlZXprKCYP3PdN2b3zFamp1CuyWa5RFaQx0SZf//x3ZcdLu+X6X9soWfVufeqP/sqYYsH04DfDwU1lU7Kxoc9ADQ0KQD2V7O2f7pW8Dljvq8jL247YTUqz1hQsODjckFxnJp+6qbM31zMLbmW+wcqzcWWU87kddKB3vzzy8H/J7u2vmkZy623vkQ9/9HdU1+6VP/zYPfK9R/RAGP+wyv+7f/eP5SMf/cDCyODz2dSMdUqPwaky0xqcS+eLhrAs79Pq2uZk98RwdNrr4GJ5JVXMQMhKgIYIqdtVLe6gOalL3ziwTP3RVQm1GlVc1DVWy90f/y1p/mSbcusuefAr31FpktBLhZfaZ5/8g7/0z2VQfcU9x0YXCuCTLr/ZHpzjy+hMn1QWIh9z+Ml80Ilzmsvd3+HuMWlqjbxZzvnkM0EOLnU5uP5OPvI7NBSyenpSmYy4ObwMc+1118jhQ92yddvzqkVcJZWV5fLlr37OJpD62Ez5LYgMPl/dlw46cUY2Gu9/w8bm+WHIOdzUUF7vAo9La5ceCqhYQEcFuLNyf4nDmQA/Wea9QkEiBHh0X/dzIAZeeH6nHtcvl9WrV1k3Nj3xYzuJRkzY6tG7GIteBl93sXKwykO4isG5LHVg4ULSM4ODEtcLL9Bgn/KxHj52reo0fRQRcSaAmYTIdI44/Jvf+r709+upuFJLS6N8+O675OevHZTP/u0XpKenTze9Ot38RuQi1Yfvvf/TgoGzfdtu+bu/f1BvOSnHq8lerueUD3378wsjIuho6Ko81w3vssoekRG9/5sbVqsquoxCXYXSxgQXDZSArdcLL2xcpGXr9EKM+oK5XgpNqArlf5LAhEAOuKl0JS6NcvTCtYKb0b9GcqJs1yUXyLe+83mz3jg5rtMLKViNXt+GjWvl0UcflKO64UHL2qPD0wXTg72zhOdyy5JyW0aWy11NGb0zV6lLVE+X1WOG/Y+VlVNgucfGLXhAda2A72r1UsvoyES0TDXu4JI3n1j+DhJA+ntYjjSfELiVX0j+HSGuT+r08u8IwGHnzvSOJZfNJmVcVa96debAbRCOHcBmWXsacrdeZR/6LVeeIGQyJqsDQBpO/IZ4qwEZpjsglEEsOPl7CHxY1suR5j4JTyNc1ADTQbghpX+mCvnuzmDgZPdRkJfTm5MONhe22zua9L6fngirjguhI3PnISTnTEJ+XgaZGxLthQB73nzZTX/4eb2Ue0cAfrN6sQ/sVIOFe21Aph4l5Lrrr7T4t/f4EDtKny8187sUeQNwzuGeT3iq9kh3QHkPKZwQbz3M/6W/n+mE+VSNhwP0zhM6xyIqzImjH8Px6M4N+hdCJ8GdW6un335ZtyT1T7UQGXCvv88tPTdGu05wcLiKPO4cTPi2qGmhVhBqC96R+WFYfn7em4mHZ3cO3vnU40D7NwAeUjipng54+I0dYJ9sJhhi44XeEsCnAupsAJ/qG+vJO/y4c82xOT0IQXaudRAp6Ho5Mt5UQ92IMTAg4q6vv2lLbrECZSN8Gx8OLhxr5q8iBpdi7QEuoAOm/ZWpvls5QFex1at/hXreAAPs6cD9/8q9zMdjPzvpxId7AdZFA6BBgAaY3NtwR1KUE/3NHMBzjAToTEb6fP3BpwOWRt6Kv8E7+U6HgOyiAVD5OQcTunzFY9ebVSszoBzg66bnRFlON86bg72C+eG5Xo+a/91ijzv30k9/xzEP2YmIIgg34xTiL/6d4GLSzklNOxPnUuHZRIM3GpZDFz5fdc3rWejQufjYZLc1zakHJxlZnE96pxvRcWT8kNTpKQeOeQgRYeqjxU7xOBuofBICdooqzpjk11zPpZ0zVvQ2Z6LmoVG4qKB6OJdNjeOl/FBRl35GuTMldfoPkg71d+vfnRT0PkpMkstr9O87JmdN9X2jlafm4HOxtN4KuCEm1LPYuDkEl77CwWbI6KnG0088LT/8z+02BP6MoqxML/jpYSj0xS9/Rv94My3/9otIXSPtDXrw2Qb7dgFL46ejxcDVfppNH32z83/Owb9E6Ci/UH7vI5+W22+/We6441Z5+JVI2nK7Kvwbnv8DhIvVBPHl9tUAAAAASUVORK5CYII=\" />';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text CDB-Size-small u-upperCase u-altTextColor\">Mapbox</p>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text CDB-Size-small u-upperCase u-altTextColor\">nasa</p>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAAA3CAYAAACIN427AAAAAXNSR0IArs4c6QAALs1JREFUeAFNnFmMrel1ltee56HmqjN3t9t92u223Z3YcQgWYFBsUIhCCLmIUC7ghgskkAL3RtxwgSIFReQiIMQFFyChKCiRAIGQCDgeSLvb7bZjd58+Q52h5trzPPA8X3UFdndpn9r7/79hfWu9613DX5l/+MHz9WK9isl8FqPpLKazWcz48T0iG5VKNRr1ehSLRX7LRCaTiXqjEsvlKsbjUcwnsyjkclGt1iKzjpjMprFYzKNSa3B/xGgyiWK5FI1Gg/En8ez0LBa5YgynoyitljFajON5fxin60wMSszDvJ/LLOLtGMdv/sJXY/zOf4tH//sPo11bRX1vIwqspdNdRjZTjGqjGYVCKZbcWyiXWW6eNY1jnclGPp+PUiEfOda2WsxiwjpW83lks9lYThdpP363WCz4mbGfZSx9Z/5sJqJRKaf95JBNOVeIOZ8Pe91YzhdRypeiubUTC+Y6Pz+NfKmY5usN+jEaDWK1WjF3MUqlUuQVgpMquOl0Gp1eL24c3EDg05gvVnyXixED9Rh8vVxHvpCJ3mUg+FJstreivrXJwhcMPOLafOxutINzQLBzBs5wXSvOLjrx4Ucfxng6j3J7I1q3ttOG+oPLGM/ZOKtolqqRY+GZxTSWLPJLX/5slGIaH3/8o6gyZ4F1HF90o7LOsfhGnJ92YrHMxEuv7ESwmX5/EGs21m63EXYlZuyl3+2kddVYa7PZjAWHf3l5GdusWyGoSL67f4U9Wy9joZKgCGuUZDmbhwJu1Rtp/ut7psNhsOkY8j4cDaPMfJPpMAb8riLl8tko5laRW04UfCGGEzSR03WSaqMepWqFzVUU/dVCxpMYrdexYNBAcx1gNupHj8VllmiwWjGZxozf16sFcs0z4RhtZsGBpiPYLNpUXGdjyqE9PbmMyWoWVU5isVqHJ3/OIa7y1cgO+7HZPYtXb/98zAdPY3RxEu2Yp8OeZHJRzBcjk8vHwc2bUSqW0+ExRNRYd5a9nJ+fx2yxjI2NDayqmjRUxVEBivlc1LC0sdqMxqq9Cq1QYFwsNJ/LJGFHfxlsJGn9YjKODBNUEeIaGWS5pnt6gfb22dk6KqVClIvrGPWxnNk4cqtS5JAb+pve8yvMFAuLXLEQjVKZTa/j8OlhMutivsykTM6GNjc3k9oXssu4ubsZ/d5FTIYTFoQ2YyJ1Fr5AeGqFp6rmaxVrPlOrDu7ciuFgHA/PL+Kj0/Moo1Wlcg7zXsclm1ixWfAhVgiiXspHA+EfHz6JGptv5WuRr3D427uRa7RieNSLvYOtyJWr8ezZYQwGoyijFIVSjkOdR7fbTea5tYW1tFox6F1p8qIobKjt/bQvzoXdBgcyT4LGRJMQt7a22TOWWixF9xxIY22DwSCmQ8wfK8hlEe1ilMaoAEXF/DrqrC+W2cguxzEdTSPLvTmharZcJM3NoRkrNExoeP3+60zLxGNweYA58CrlOBXBiRU9+OhBtBs1Bi4kzJtwTS5bYHGZGLOAFe8TFl1Eg7Z2tsHbWYKIbm8YC4TS2m3EAOyeDVksi7rZ2o0xMHCCpkXnNN68eSs2Yxn950+iXa9FGS2pNtDuGzfRRDC+UI7j49N06Ddv30OA3RiMxpFHo++9/hkWfoWXFxcXkeegtcgcQppxeGL0BockPvoa8ll/0I3heHCFwcjjgms3W200V+0uoIlotifBPRnGy+bU2A7z9tPcWkoeBW3WqkkZx+I5FjxALvmtnS0mmYBNF5hxMXbaOwlbOh0H6KUFbrZbUUa46+U8ZkDBGqSYDJdMLnazAMz/GsdrTPTw8GlUmFTL6IOnCjPPQvcO9mPVrkd/3onbxVasfjiOWq4VTy9OY9nk+0YpVtlJ/O2ffStKhx/FORqca7DJzXYc9y9j4/gsHvzkUTRYY6WxgQnjiDNDrKfJIVRxzNOYnp0kOFghjwoWqSCFvzkOzAPfAU+PHj2PBZ9Vq+XY3N5KB3hycpIwWKwuYpYLDlv4KBXBVyBsiAYXgai2++LzcrMYszJkAJ+BouLoS0BlBuiZRx6IzGLpNeSW2//rv/INGUEFr7nCgSjYDGa75BSxhCjkM1EGu3I6Aj7H6qPd3Ig6C63VwGs2UAIiKpVKFPm3HvXOnbvR3Ny4Mn/NE0HkELCw0WdB75w8jFG3H+WzSezWNnFlGcbI4Tyfx9c+dSd+/bVXovz04yj2zgIgjn7mCsMXnTHYh3bt3ACHizFlXL27h8viY4bQxMkaWs8yExNSuNcsJofFTdD07fbmldMCRcXiGQzKVw0NTJqLmWbZKCqVtDeP4ErApHCZZXwF6NyD4ZjDg5HAkgoolvP3UcrVGrhjXNeUV0BrAD2peb6S8EkzKkN7GghNx1eEf2kaed493ZkwwClqNjNYwBxYkerNXSwmpkOpQKEYnEXX0BLoFIs4O7+MixdP4tObu7GeLuNgvxo3dvehHGjJAuc2KcavfeUvBEcT73//nVgc/hg8O42Nl27EG5/9bFwOTpOm1qFqE9YvJVzrQ9i0rwVzq8VajuuTmilgX2Uw8Zop1dA2NIYbGINrpGleN2HeMZpakfIhuAXQtuY9j7BVoBm+YsYBSQ212hzQBcdFjpkrJ8wYI3zAAnmgoZFHJnlvHMMSBPF8nkmAADmhHreC5ywBA57EAtVfzpdpIfVqHcHn0XT4KNiuF/Y1Z7MzNF+qssJJLFb8SI59MYYLv4GjWtSLyUFuVZocHBCAVufHw/jC3dvxOh54fPwgilCcV+6/HINLHFnvNB4/eBTZaTa2NvfShgps0MNTe1WOJGTY0AyhjKFZKo7K4eceuALXulQcFUhtdO8yjDX78LWAhs4RUGaJk2bdOt4FWLpmrwXgpsKYXMT/yIdD3kDjjQUcY8i1KmEZiMmh8VPm1Gnm9ZACuZAwGkzA3wELrsUSKuaipGrpxcAThDBhsAKgo1NTuL683x/sCaEidBxmn4VNoWlZzEyzPMfhwO+ixeEMIfqFNZutIOgJBzvpxW5hHb/69hdiYzWIx+9+O8qZSbQ3dqN957NRe/oEmFlHC9jJgolHR0dpg86tALUe1zpg7bKYRquJgLJJmAp5zJrV1CLXVDj87mUnabT3+/lsNkmHUUWI2VIFOeB7uG8FO1iivWr3Ao0XJioItd/tcbAZ7oHacRBLvhNO/LdWUoQFDeHlGkleerUSv/D6ZcxY83PRBQYrIuQCVwlx2RWUCpqTQYBXQcWV4D19oyYFvMoAE3x/Cb5yYzRbGwhp48qJ6iiYtDAGeqotZi5EBuvIMfdWJRNv7e7Eawx59t57MXn2KBaj4/h+93G8fPcOVlRmsfmob+zEZacfW7t7ia8rVAWaLxfT/HLfLOudY54Kzn24tgobUJEUlGv3HkXidzkszUMw2hvIedmPXB6poS3zpJ1TaOeoT1TLAZThyyuEOwa3V/NPBGrsgHUwHWMTDzB+oAiVOuxCiRvartDQEjglEfeCxGG5Q43NIjTVvYRQyg3NrJ6+956VgQUbyCEsNcmDqnFIU75j/sRJR2M9rY4Uh6iwgMUpVOQQ09+pZWNvPYk3dzdigWPrvv+9qGemsbHfiimbPCPaG/WALuBh7xaWwtzSMoAsCU1zFw6qhPQ5nTHCKuGw/exaqAq6hAIs3CtBj0xByFK4lQohPQdliDuEH8+xLvFzRVAlI3CPjjMBeuZo+gL5FBH0GiEnT8qYmAtOFweIEsgkMh4qPw3oYH7NAK26TkivvEhOTgHn0EajmRUnZYwu8U4nCIb1OpcpmmIFf2YSWRxHjskk133w3BPuAQ1yYBlEuUq4CU8VR3ILokfg6MX5i9isbEazsIr7G63of/Ct2IYxlFocRBVsztQ5MAOVA4RBLmNZhMtrOWge+LTGy+axtLKahVCvX2KiNLGEYA0q/N1ILTl0GBOqHF0CJUNdLc9QWo02YKoUyU+gEApTCpqp52BSxAdDAwtggnnmjCvuO55jTzm0JVQ3RcAc9JrPCszH0iPz9999tB5+EgnVagA0J7HRbkaPaMhw11hc7dV0agzewuzHozngbgJlmMxQWpKSJbyvEfLO3j6JnWkM+DG2z2MZK063zzyd7gANgS4tCL+Lg5gfP4x//qt/M94c9eL7v/vbaHMvDl7G+dW4rJJH0cDSNYyk2I5pTsswiiJIwaG5Vh2qFpSUgt91fHL1MYfrmkrAXhIsQhFStMwJQi+jUPrfYZ8gA+hSWfKMo3PLMMfcvaMsVwmgOVDXSof0HPzf3ttjHVcRo9qtpnqACVo5sOnsKgTfhSHla5z+ZrOdBDPBPEbkGEqY2giHNgY3xeEtBm/CLefgyzlEvtXciUw1w2bKCdDVHB2Fp7nkQHqdLtkDcX1BngOuKCXk9I30FEYBR+KhTufjaMF/N9n0Bg767s5G7LOeVWGKFlejw/fHZxexVS3F3s1dwlSiyD/9MPYIPBSujEDhKTSh4vyMPASWk0JUfQibFoulbgrbw9gEHjpkq9rRgtUU0zUzhLKENibsRZPVaLhFgoj1isMDBo0KZR1q7vW/G8CFc2sFarH47u9q8iWJKZ1hXo3sYPInJEmKaNr29hZ0bB4tgog6JjNG0HNozwyn5QnJmU9PjxHpJylBuKCDTuHDVwIm9IYn1iu1qGHGRRxEB2Gi2wiEcBcMXZE1w+VFebCOOxtN0kpYw/kJ6cDT6BQIZcl76PkrzUZ8emM/Jp11vHj0MDJkwT7301+IJenNBWtK2AicmS5V0C0iJwVqeCzdWrFWIaRF6jQDNsos/P727dsps2Z0NiQwWDKXTr1MJOvhJMrKGApO2NDRn5wc408uookjzbO/AkrovpPlsgYjPyQEXOEP+JlxX89I+IwQ0QvrnIzRy5QFbEBzSghuhSnjumIK1xuS5apxgqbuxlNMCLXUwSWPSUTkRDqNAgmiqSoLPopdaqxONFElTjnDYiYssA81q2CW92/eCtI2sUCr1jiWOT/vvf9eVHfamJdhKUmo4k5sHdyNJc7TkH6TdWT43ANVa8T+a+3yXQELEbIGsbnBYbPJFO72gYQCOKvimNI0313f2EwBRefiLDpnp0nY9Ro5bwS2xgqEnTZp1gE5izrXm3f2QNbseUEgItQYgGVxbE20+vT0FKeKn+D7vILRlNokNzwxX2WckYPNMe8cXLAG3ciIxbw0TbNUCtgITlxT0L7LJEx6rInZjXRmeOqxThTTLGLOXBFThJ5hg/VWPQ7mq/jiSy+TOVuBz710QFKg3d2DqGxyT4kM3ZyFr8kn4ERGBAJjYKfEXGbFNHk1V0GqJFqY6xDr1dg82rggpL3AaSEqHLZsaJ2c2wQM14Gbf5kzx5rv1jjAROuAKaPULmzF8fb2OGD23MY3eYAvXjy/8k1cb0KoKMTw77nY7/ogFtscWh255m/sHUQPgu7gOdKH4tqw30uLdrIyGLlUA9GUucykwUa4foHzAVmT0N2Y5mpu10BDPJpCdQYwiCHYbI4jh8kUCU4k5aMVkRtVixxCaxHtzQYXcfTwEXlhHCvJnu32Tor0ytlGbNU34vSkEz/88ffQ4FrceuVVuHAHMzSyQhBqDj8qSsJ3NrsqoFnMr3UpfJWiyPzux9xuhSSPGjYDZoy4TvAZS3C6inLs7eymgMoiwvXLcRxbnD89PUF7yTvw7xEsZAEUVQzDkYWMbMX8E76zcDDlAPMuQILuAoeYTR/hmoYUIkrg7grhOoFCNCPmYlcchhrhKftSuFOSzUtOMws2qVVZDsAN1Qo1TBLCjTdnKARP7pcIzw22sZTbhSrR0SLu33sl1ttQrVU/fvz4Q7QTp0pq8mJwRhpwI75CjkI/cAquDQg2TBWmXDVaoom6frmu5mzAVABCFliSVilkaKVq4wRndnx8nLC1SYDQBnbGlV5ckP4c4JQGl100kuoG6YMyh9JoN3DcCxL5ZyhiD8zux639g6SQYxRtDszgtVkL/FeoQB4ZZHoBZpeA3bwUK+VTYQwFBLO/S64ArdP8ZQMmLhos5NaNfU4xgA5ibDQxURkk5gENoWuerkkWoaGIM8uThStiok7qS496hid+0r2MDydEYyxoSX74+Rd+OmqX/Th68DTyQ0Li3mHs3NpKQYs4V29uUYFYxsMPfxKrZjm22Fw5S6rSpDYLus5DJL7LWjJopB58H7NuHuzFmvWeneA80XqFbRg76PRwskveL2EVUCwEqulbvRjDd6Vm3cvz2N7cToo2GBCdQdsa4O8mDvMEiJBBmGVslBq8w8/R1hlzzdHio2dPEgzdvH0TDZ5JoMkDU1tTE0+eP7vyxGhfidC4DjfOogmn553EIDSx6RjvqPD4PGkt2pqzMIhZTqnFnRHrl3AsWaxADLzE+/bw2KBBbOFAZ5j66dFJHMIini1ycbe+Hw+eXsTtdTdutitEjuPoYr69BdhINaNU3ow2+d5JFW9NzquMRUgvh6QLDRbqBErbJJGuw+BStQCVAj8p7ZgsL2v6cNcSjguJJWzsXp7FJcypu+wk3i+GZxBYHeYiXbsKecmeoTxtaFd2BrVkrhyYXcWKKzo5LKJzchQrILEB66qgXDKSg+2NGEEtx52zyMtvTVx3OxeYmeEjHh1N8GZPrdMxsc6A3KDJrzmEKhtUewwNF1yXwUmYPcvOwVihmcWmMgynqVZbtmlSNnITEzS78+I4bh3cJPO0jMfDVfzsQS52738+Dv/oB2TbNqPbP4tchWwVGlTduIVj4vDg54vVBAghUc4cMysb4J/cfLDsQZ/aOKLtP2MLphp1OkKZNE5LHQMvFg2q7KNdb5E1WyWlEjpMs/rufxXgRJgbYm0PH5CXBmKEyjlWKlxukXRa4CSdf4ns1lj5BBKwRh6G11eQCrtgvITBbtzBWV0aOJ0mnwkTUiEzRwo3CV9nxmAW8YUMvqIOpQZf5QHWOLFNStpd8RwN0+ll+MygQzO+4PMmkU8Gjc+WV/FfvvvN+PTPfTn+4l/9+Xh3/JN41HnIZuCfDFwcCQFgDNraLOM8cYBTsLZcIxDAiZTKTfDRaGwsCklxEh+Vz874XGtzL5a6lhyMTmkGL++hoVVgTMjwe1OfCtTyVB6WY05mb2cnUbbu+SkWBb/lszl0tQPMNYGJlYIln1InaCIPis9hnyyhgP+yGq1wjGpzX/w7f+8bBhiJP/KlzswipQJ1YrNrZvoVso6EC/hB4JyqJuUC/ch3naA43gVvryq3nCCfufgiZirPduJLBHIIRBj2Pnz4AKUkF/zKnXj99VciU4avciij8Souj4j2qGJUdZhlvH4BdsKhtxDsuD/CeTIua7bImvkkSjTKQl3RTDbJupAXU6LHaKg4Kb7KX6vwY9estq0QjtVyrWHONT24tvGAWutYhtCOlWADq6giVBPzExQIU0+CtV9iyX4U8op37x+C57mv/oN//A3r+jqLDLiqs1Ko4tmSRSl4hTtiE2pzEcEX8ZpyPx2ai3T2FCmBS35mKamOY6zCn7Ps0LKKAtchKuAcC3Qp5EqjtdVi4WNKSaNobjdif+dONA4OSDtSY7vEgZ5TjCTvkSUbNy+zCbymZaPTo+NEhyYIyI3kOWxL60ahKVWJYIzcFIDCNqgQ9kCoJBiFphDGZNH+LGOGhk5wdGqp2i73r0Jb3eOY36fwaeGmhYNbIGgVroCDM1oEAphLOVBaQkacR1K8vBQtoYPqjdCSN8WchYxr4m547CRqol0+NqAAEOmahFtca1hqXlmMHk1JSLOQJbhsUmRGjkOYaFFGKmKGh6fd+NIXX4qnsAc1qgm2/vjyKGrPzmJ+62bcqr8at9++HXe278fF938YYxyv4WuuVSDqIuF9hgP7ZE1VqJTZtGJSBPIc7OEK1lwja0JJDPVlRmouS2KdcnW1FaEjFOEtw8EZieYRWBV4kE3IEloEYIbBExTOspcphBKkYFm3Gm9xE9/Df3OEqsBV9iU0tIasaqQh8joC+xkm66vOHM1YrlcC6IskjX25mevEhoJeskAXLhanF2wiaTK/+12K9PjeYueYhM2Ikrh55dNTDo1F9VhAkCgaEs6qgUV7Gpq78ZjUW/fRs7jdLMXPUBr69J1XYqdYi+n7ZOK6zwmjMVs8dgHI2ATGalRHagjAFOgUAY4I55c4ViSJ44GfAw0GAL5YNvuwmLuEfm0mQY+n5Cy0Kq6xVGaK0kDLiz2AKTCloxI+RvSAGECIr1MsODlYFCqDAmXxJ+5/zUGtmHNBWV/j8ZU3bpZuiUXYbyLkmtiNGzfSZP7bk5E/SuMuKVw20MSkuQjU0zf3KR77mZknD02vrAcy2lKr7JeQ5vT5boMw8sMf/TjKhJ/2Y3z3ne8DAwNaBihVjS9JyPfib/3M2/Hr9z8XN2grKN2gDrfqxOV0EL3xGXkTwnqwV7ZjY4jrN6lvtq5OOLvkENYZsmquDcsxI7jOkp9lh4BM6iczqZO0l/De9XltCevc2qKNgVStghZuLAsVSlkCjhbaafoSuFNTwRod9XoNTAqbyMAxHNN7tThhljqgiXYIOqDhRVY0NtCKGqQ6RUBpIwjHnCkvb/Z00+L5zpNb0D7l5qzTuVizSAMGLzFGhkUZ8YjN+4ShDRY9InTeJWs3ZJwiFOynXn2DKJLGwIuTOIEDZ2hF+o/fez/eoly0DZ8ubpKBe05NDvN88OgIujWloWWPtRi1WbiELsES5OxrxrdRRc3U8WBmqYwlPXOtOsUywYXVcBXimh2ZB1aRUrMKeq8SWUVOVR72MaIraUaetwaXtgvKl8L0pdzsLLItQfjRsR/Aux0vv0vklnrJBHy0wA+VvkIUl9RaF++/fTmAm3IDfpc0GUg3iOArjG2dio46ypSeRLPllRqqaT5DSdSbcnYVbKRziNRj5+Q8OiM8PNx3994mHT5HQMcl3ZZ0S3L5khzF8xeH+AA6LJm73iL/xsH1ic5cg+uxtmhgZK+Ce0A/sQ7slEWlijgC1jGbAhjCclLegOukfeKmwldpFLidSh6EyqJlykW1UjF4lTQ/UqdRhfVKQ5XFlM8dP0+McMn4c6ii96eanIOqmZpaEiiT+m6/gAI0vWdRz5c0xpyx0DHE615hGLjMhtyYJW2rviWcDn1QSXuEHsfzlQU3l2jeCLzLoV0NFlLf3o7MJdVk4Ofk2ZOIO7SxgqsE5STuYQGkNge0Kq3INt2+c5NghmSLcIQWZqdsgvVnwXbfDXutl7Fn2AG1Re5P36Mg6ogBiDmUDMLXqaU1M5bm717dz7Vm6mJGcnksZAF2G/GqZjJeKpFksdkzWjzlPn3PGOzP4jiLKM8SbU73iIvEV+kEFbCnKGVzsuUSusEA4q8nn+AAUHdRvq6iOReGtjBKzlPmc8NWy9tiUJ/x9cxmluYIuQpreYjGmiYsFzkQHMfZaT9eXJJztpuWe+lOoReFxg02AMoRxfkN1yZyv06JnhJwIYx5+HMO22p2AQHLdBTkko3O3CyCFzJWmJjtAz3WRGdputY9uD/DfnO57kv/UUU5lMMMiBnIsXFySQmBAS20jYJ58O6HDloCH+iogQh+R8VLKQIgE4HB39moIXI6SU5JwTqp6m0rlL/jH1kxq+IGnaNc+dqkrg5CBwkEAPrec9XQfBW0uNAipmt535So4yS+ygITXaL/YUHOOVdDk0mcFOrl6Bx1Ypcoby9LM926E104bx2t7IOBtqcaOZVRQw89z6FO4MlCmsrioSsw16VQLI76b72+c+tXpG12BGlVhvQeSpPgxR7kIde5N1/KwJ/FkoNingr5EIVqZ88ChXGfOvNUTWbv1h512spvidJ5D3isICjo8CFqmBaYkhoIxjL4/9NaTMyJUQ+rxC7e2p0m5edpQ3wuDj0/O0vaa7+u418J+eogPWF/H0DwxxPMHmHk2+R261gI5t5h87XN3djLDWPfLmU49Jyqyx4aW6zZ3ILXB860mClzO5ZaXJwR6cGEtBoFZVGzBjZbDLAz3QqGnTmpZG9QxXb7ON/RhQGVfgW2g3Dci07acVUErXmkhfK7exYCOxd0oANF8L6E5bblqjvVViNdXwUGbfSecVh5HZoanDwhk/hyoQ7oTxIqBqqTuxbwxNwvxpuDDbi4dGK8m0m6wm6Lp1CUT0LwZDZols1xlyTZkSYeH6fUyMXJxXl89OJJPJ9gTgevxufvvhydpw+iQopww8WA02tytPUb8F1yACME7FqMMoUAN+1B5q2mAAd24BjVudakoWC9FueejEJ1fmhRCk50Xu7fViuvWdI+oCV4nzldqybCDjekYKlAQ4c0LdXuZBIcpDkWo0stKW+Z37AeH7HA2kZ96oOeliaSnBxmp8BKZTXPRgoBQQegFsL71FRM3Q4e4Dp9ltqHWMT8E5jhUOPeyy/FGVpM/JIEoJab5lOjBlwwgpUUGLNKmnGfGt+a/uDsBc9qLDJxRDK8iVOZkYtGXZi/EF0cTa9PHQ1cG2aIxkjUlOiTWLMOUBPnZycoTdAJZniOAwgZkBy3/dZqt/Bkr90SOtmFkUjFDihLmW9OSsNC18wp1cwgsA1CeJWiyPav8hgwHL5bU7pSDjk4cMJ47lNGshijuTEdTfaEdCrnrBcmotDr5gu4yBqVA0ivqlYfmChhMVrthUKAWqmjGJM30BVLWzSHGqxAE7EWZjNcAe0qkExJURWtntbjdKBMFLv0CH909BRW0I3qqgn37UUPLtyo70SWPPKS/ogmGjEl8zbDgoi10exb8Xz4DDyeASF0YXKAg0UvNje2wU6E0Z0QYGyRtH+c6FofTFZJDijvn5ENKzSIGglkrJJMwc2tg5149Pxp1KmmTKFkhx99TJp0h07PnXj80U+IDun6pMBQwDGOx9C7PAwBB3t6yt5QlCGPD6iUVSrkfn7Sox8avq5zr9fa8fTFixRP2IWUv64IKGRPc0oOWByVOfiZ2meaUQHLDbehVLbzu+BLsM2nbBSuz01wtokPv2ACvXwF4WuaZ2fnyRSLJHmalGBMovggybAziSPqbXPal/Yb2/EZhL9FKjJ/9Czqo33WgxJjiuc0CO6zngrdPi2CFXYXK/jmArh5+uKMFOSSam83jp4/J9LskK/djFdeeSm6Jm0ogT350aO4efuGHC0pS6paoOGPz56khr6b+9uUsWZxfPI07t29RSUaDKc3YkLwY6IqT7tXk2rKwmQ3EHRK37K1xhkbbxPcmH1s8e7+u2hxk70zEesHLqxhCQtqqe86uGsuqAaLTeKUGi2MlCkYrkdXCWpzGHpQJWEyR56IDRG2XhUbuZmDwcrBJZx2old2aH7+82/EBRDQ7cCjB1Q8uGhydgJ8cJjradzKLuIGXT1SvnyF/CwVimaTlll4tSFu53kX6GENMIAJWGcDdIf8SWt3mzJ7Pk4RbHtIuIsPqAFDm3TDV7PQtynMA9hpkalr0oCYe3WThr9BPKfPo7nVIAd8kGqSJyhUQ63BxxD7kf2DtrLHGdoP94i9l17CNTAv+8XYCP9pRWC+HNYqv09PNLGnFRaXMFhB6ix8Tw4OzRXsFXhiBzqHT7R5gtb1WZR5XzNvRfvNcBbiF26Qd+J2yukKXwg1jXmdKHJMQ9Z3vvPtNC75uajT0+aTTZkmJRme51pRlMzSI7HB4wR0IMScsku7Tj9GzQSO9TUoW+k21WCwF4bQJGkkVP0Y07770p24dXMH6Ciz4QtKO/Q7gM0v37gZTz5+iFMmVWnICbedYeaNGxsEC9C7MQLexSp4JODF4UmUslgaOF6rbLAjLJM8hhy3BtSUm3QczfrsQyy+enYQ20evzJ9zD1V4nwcUw6ccUv6S007OC4lLqdRStdDPzH0q2Gv48ACM2GpzYn4Ep/A9EDvNTTbrzU2AmHfQ0ZhosXlvgmDsSahwGBWep9jYrLFAcG0EBeNAptwzxQFRh8CMJ/Hq/l68XIMGoi0fvvcu9TAiSvIlLQ7i2fBRcBZ8Y/YLTCRYKRdZ+4p62YQ0Jti8Cx6edoax6hLKU86iRSjKaHoLrRWz/U5KdvYUiKDL/q23PxMXYPtPHr5P0NDmuTy6L2mgGWGpZtiyWebndMoKGPpXtrfOQ2JvbXIWZX6UkQ+9nEPhXnvtM4mZqGS0Tl1liYQAYULt88kb/y1NU4A6N7X5CiLonAEXVYREZzBZWCKpQUJhHJkTcULpBG1OMdIxf+wJG/F5uuUqnBKMY5lgIO/QG58x87k3g+MCWl5GmzNAxgUYu8cgUxI8wUaKmuG4i8+WJgJFcNACD9S8efcGs9LWdXwU52jU9sYOAsCmwO7Hx895jGEPFgKMkd1bAxkNYKdW4YHICpZAR2eFiskeWJxZ85DOOdo3JM8xJLBCe03wLMh/dvonFH8PwfdPUSbEiSMTK8k9hGofiJg8IkFk15IBiYqaV6AKRe305XvSVG72XSH6kzSV6CUPSzBcVFMVtGZSRUhOJglHqRNlM/Nkl6G9BTXIuqGseD6Cu0p5rH1BoOCO1NRIQ56DyQU2mcH5UIqLDAewprC209qJ0sWMTV9ifvYqUDyFXBTgrBvQoyVV30z3JPHq08PHMTzlGTxqfoHTCVjCHDYzJIUZW+3osb78nGMgasvyKG+ZyQddKNVHj+MOB7S1tReHj08QMlFdrpagq8k4NaLLAZBzQSV6yaNngyfPUlKdi8hDkP7kQR+0BHZyI7EPyeMCOml2LW+/gC8xWCHKGOxKvw4OpCM+hGhIqLMz+vF5tDUmPSZxIkxcH4o1BP89JCsnO9nc3UqHYBlmTrbMpjhbZNdGbQQGy9FVZSRPOchs2O7BdlQWO1GlmrvBZuW77Rv3UtPHKU9fjgsz1rIfhzxeW+H+W9tbRGf1uED4yyEN3U/Po0oP2Shbjvee8sDMrZdoGGzGza/95VjyZNHt7bsgKrQRx3r8wfvxrf/xezEFRt585XNAyzDe+eP/I0LFvTufQ7uBKHIdPv0EaQTLeUASp9Cmn3kFtC3sy0DBKpVC7MIiqOOzZ/mwqQWSWyiSzCTzLx5frq8xVmflS4iQSVju8SU2+5OwmunqtLvOMQcF7o95YPmzmi2cWAnxWqMtm/6ux/B9hPkvLWDyXZ6+h/QwDdxypoaziRxQkYHWffWVl+Lrt/diE4uY8czc0wc/iKdHDxHIUewADahePHv8MN64fz+1pH744U+A2lasEcphfxTnjLn75tvx2l/6KzEqbcX7/VP6kSvxaRzkJuvYBu+3aD/pf/xuvPeH/yHuIKDx6YvYarThtrIkODAWVN8goOHaLF34jz/+Qexv3wDLoXLkTS54du+UAmkRDd9AmXIWUvE7DVoIXtjscsYjcb97MqG6/EmUxlBqoAljtblLt48xtULTcYnXdRpHfAhbfPYQNHtpmPiM5Sf2IVu4OhBsGbHncXh5NMH/xKqHTw7h0zSCgL1aENmMqEKTZqS5urCGGodwj/G+BOd9a78ZsEruXER3RY5g1osaCZ8+Duq73/lWokRa2YdPHkUW5zYEo3v83P2pn4n1/o341uNn8b3D4xiYeWvTN4Ef2MVvfOXVe/Hl3Xa8BRTlLx7H6oN34uk734kiDrlPRaNAoLIFL7/oU2EGTqo18h1wMv3NcFwCUj4Fx+VxBr7vEDTJMooIuImMLgmYbGBEfSLz248u12boFZjN02KpVQiFbs0t4S+arJYrRCnRk8MXiaJdO8FrKocc0vVe64+Cn0PulzgbHyRf0k3pg4P7bcwfjlkGuz3xLlp7ztPqrJuyDT0GsJIsiz5AC9+4dStutBO/CHrRYRqUrb7/w7hLU0qHQGcBlp/S5vTh46exybUNhPrRER07GN/HFFcfn9NETsP43t1XOdxcPCaKHC3OaDocxFs4r9/4a1+Lt8nmZX3o8YPvxX/+3d9ifTzAAjt57UtvUT05BU8xIyJXqxznPajimHbZJg8zsj7ElvrsDNCsUhfgxvsId00EOoCtpIT7dfLCU1ArU55Tp4WAUxmeNlI1+vjsNGF0GU2Zz694sxrvSyFfv6vBOjF5oTmNMtqQg9wblBB1Rhaln3VIMtFI0qA8NUGrJpaZSFEW6nQ3iutCDJHa5YOPsRJ62C6O4/m0iwNaxAFBw80t/lwBDnfJDoWdY7qKVs/JPTyDrpXpYYaeFes349VX7pLf5fkPMHrSn2I59+Ix1xZqmfiD//VNei/+fXzjl38pvszTo7FzGjkw/qJzGLnpRbQ+MNeLUsHDO1jxCVEnni8qW/vJsfnQeRuScJMeOH2Y3aQj+u56J1BflKtVhUf/zmGPHmOiOJRfiqFzq3OT7+nBbo1C7eZdwfljdJTwGsEo4GuNVchqvIXD1DOM5qrB1vx8V6N9xi5PRFU3gcTZjAlFR2jIDKfSxRMPdZ6wlTqH04KKZeXRBBRGeR346BgB14Ec2wdOoEeXOGUMg/UBc9I88honZxexS8qzVWoiVB6yvESTeBSgybrzrXJcNBdxfEmbAHmVGtm8rxAB/qOv/bm4RxT54Pf+bVz+yX+P7eUFHfpTghZwnSxen+LmI8a5c/8NWrXIA2PVC5TOP2dgd48huW2//oWCRr1NugEWQgqApz39yyUkcDBLHVYqAyEkYUNss+bkd74Mq7fIRXQpgCb2YDj5/72EFzNXh9AlX6b6UjoRuLBLyKxTTazGfCy/+9dSgEsyazg9zNTM2AJO6qYUyHJgfZCoiJBwANM4RfBHhKQDNHpnCw7L9Ke0sk7JEfgUaZsngpokdN544w7Y2I8nz56TXzjlAcSgIQ+Oizauipk4fE60BiU4Y60P0OzbuUr8waPj+PpeJT71i78Yf/hHvx+trFm6HulPCl9UWxbA2nkP6sWfUsjgjGv06jURbq1ANMvhesg+D+B+//jbf0zTIo5v71Zk/vURlSSErFcXBtLJICjLIArYKO2CvxySSksISm23gipGmxdQexX2NUT4eRMLsFnFlxruuGbrfIg6B4PQ6xpB2t9lCnPBGMfQvx7amSMQGNLWWlzkeeqTyA9NyKMhY7C6g6b7PPEMR2Q1wV4F593BZA3bTxDmBRRvc28LBiSNws3ADgZEaU/PT7CMCVSRKnVmMz56RmUEk4YOxBZPxn+2tIh/+ktfjT8Pzv/pv/lncfk//1PcouR6CyH1skDi5r049kknPHl5DB2kgdxHHnTmZuks42OYBDYl/nrARfzXP/pmTKGZmd98cLoWZ5OmAQUKzGjLl7QrRSsI/xoKdIDitAmW6w5zf1eI3pvaALgfn5Cgxc/8zuaTDFqZhzcSZKaqbJH8r7zbR2+bO5sxQYgmgYYkgYo8artLUNHE+4ufj8lBXCLUHMmmyYxQl6SOOYARZm6C25eMJEWYaLuhbYZe/gycO0fURoWOZD89c30aztdbOOuN+BPYDHgYDa3nyY/id379V+Lr3LN7+N34V3/3l2OHAOZNHkTPt2/Gans/tt/8clzgK5qwigKRnZ3xF4TMYEGqNba4pu1TqK+9AR/F0dy8F5nfOuojuyssvdZEE9IGCmqjJ2Q6ThwWSsRYHwdQqNdaa5ZfzPYzBavmS4f8zPuMFq0ycHxkxngYG0FpKXCbNMdcmMJStCJDjy26M8cQeTvZndMch1azInqUL6+gc1YhtKAabagqx5jyjMpgZGmE+e4HP+B5tt1Udn/49FGaUz+yS8m/vML7E/C8AP/f/SGeDOioo5FfwgP/y7/x9XhtPYiz3/930f8Wf5DpO78fb7z5ZjzH8S1xyK995gsxPRnE1s2X4wGQ+u2PH8XdL/1clHdukWx6PbZf8g+CgHs4YsK3yPzTj4+A4U86dFioAlFQCje11DOIAtMELaG4UTXcsNiX1/k3FxRmevyfw2qiFR6QyT5fKYHEu9cpDEtHjqHDdG6x1EO2B8ED7dMXZpuTuQyFbp9bCYw1T52OgH/rK7QMgcjalwdk+F4F2sbjqxyIHUQeRJfqguOavz56wYOECGqOZU1xxifAxJIETvfF03gZfP/NX/sFYIK0x/AkvvlPfiOyL35IgmhMA3eVbN8oHj7+EY87fCVWBC9nJK6Kr96PG1/8OTJz91mb+T/+DA8OkeWlhyn/L2wDeLbycE5IAAAAAElFTkSuQmCC\" />';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text CDB-Size-small u-upperCase u-altTextColor\">tilejson</p>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text CDB-Size-small u-upperCase u-altTextColor\">wms/wmts</p>';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar BasemapCategoriesView = require('./basemap-categories-view');\nvar BasemapSelectView = require('./basemap-select-view');\nvar template = require('./basemap-inner.tpl');\n\nmodule.exports = CoreView.extend({\n\n  className: 'Editor-inner',\n\n  initialize: function (opts) {\n    if (!opts.categoriesCollection) throw new Error('categoriesCollection is required');\n    if (!opts.layerDefinitionsCollection) throw new Error('layerDefinitionsCollection is required');\n    if (!opts.basemapsCollection) throw new Error('basemapsCollection is required');\n    if (!opts.customBaselayersCollection) throw new Error('customBaselayersCollection is required');\n    if (!opts.modals) throw new Error('modals is required');\n\n    this._categoriesCollection = opts.categoriesCollection;\n    this._layerDefinitionsCollection = opts.layerDefinitionsCollection;\n    this._basemapsCollection = opts.basemapsCollection;\n    this._customBaselayersCollection = opts.customBaselayersCollection;\n    this._modals = opts.modals;\n\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:disabled', function () {\n      this._renderSelect();\n    }, this);\n\n    this._basemapsCollection.bind('add remove', function () {\n      this._renderSelect();\n    }, this);\n    this.add_related_model(this._basemapsCollection);\n\n    this._categoriesCollection.bind('change:selected', this._renderSelect, this);\n    this.add_related_model(this._categoriesCollection);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template());\n\n    this._initViews();\n    return this;\n  },\n\n  _initViews: function () {\n    this._renderCategories();\n    this._renderSelect();\n  },\n\n  _renderCategories: function () {\n    if (this._categoriesView) {\n      this.removeView(this._categoriesView);\n      this._categoriesView.clean();\n    }\n\n    this._categoriesView = new BasemapCategoriesView({\n      categoriesCollection: this._categoriesCollection\n    });\n\n    this.addView(this._categoriesView);\n    this.$('.js-basemapCategory').html(this._categoriesView.render().el);\n  },\n\n  _renderSelect: function () {\n    if (this._selectView) {\n      this.removeView(this._selectView);\n      this._selectView.clean();\n    }\n\n    this._selectView = new BasemapSelectView({\n      layerDefinitionsCollection: this._layerDefinitionsCollection,\n      basemapsCollection: this._basemapsCollection,\n      customBaselayersCollection: this._customBaselayersCollection,\n      selectedCategoryVal: this._categoriesCollection.getSelectedValue(),\n      modals: this._modals,\n      disabled: this.model.get('disabled')\n    });\n    this.addView(this._selectView);\n    this.$('.js-basemapSelect').html(this._selectView.render().el);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"js-basemapCategory\"></div>\\n<div class=\"js-basemapSelect\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar basemapProvidersAndCategories = require('../../../data/basemap-providers-and-categories');\nvar mosaicThumbnail = require('../../../components/mosaic/mosaic-thumbnail.tpl');\nvar BasemapModel = require('./basemap-model');\n\nvar DEFAULT_SUBDOMAIN = 'a';\nvar DEFAULT_X_POSITION = 30;\nvar DEFAULT_Y_POSISTION = 24;\nvar DEFAULT_ZOOM = 6;\n\n// 'CartoDB', 'Stamen', 'Here'\n\nvar BASEMAP_CONFIG_TO_BASEMAP_ATTR_MAPPINGS = {\n  'url': 'urlTemplate'\n};\n\nvar createLeafletBasemapModel = function (category, basemap, baseLayerDefinition, assetsBaseURL) {\n  var value;\n  var currentValue;\n  var label;\n  var imageURL;\n\n  var basemapAttrs = {};\n  _.each(basemap, function (value, key) {\n    key = BASEMAP_CONFIG_TO_BASEMAP_ATTR_MAPPINGS[key] || key;\n    basemapAttrs[key] = value;\n  });\n\n  var type = basemapProvidersAndCategories.getLayerType(category);\n  value = basemap.className;\n  currentValue = baseLayerDefinition.get('className');\n  label = basemap.name;\n  imageURL = lowerXYZ(basemap.url, basemap.subdomains);\n\n  _.extend(basemapAttrs, {\n    type: type,\n    name: basemap.name,\n    category: category,\n    selected: currentValue === value,\n    val: value,\n    label: label,\n    template: function () {\n      return mosaicThumbnail({\n        imgURL: imageURL\n      });\n    }\n  });\n\n  return new BasemapModel(basemapAttrs);\n};\n\nvar lowerXYZ = function (urlTemplate, subdomains) {\n  return urlTemplate\n    .replace('{s}', getSubdomain(subdomains))\n    .replace('{z}', DEFAULT_ZOOM)\n    .replace('{x}', DEFAULT_X_POSITION)\n    .replace('{y}', DEFAULT_Y_POSISTION);\n};\n\nvar getSubdomain = function (subdomains) {\n  return (subdomains && subdomains.length) ? subdomains[0] : DEFAULT_SUBDOMAIN;\n};\n\n// Google Maps\n\nvar createGoogleMapsBasemapModel = function (category, basemapAttrs, baseLayerDefinition, assetsBaseURL) {\n  var value;\n  var currentValue;\n  var label;\n  var imageURL;\n\n  var type = basemapProvidersAndCategories.getLayerType(category);\n  var generateValue = function (baseType, baseName) {\n    var value = baseType;\n    if (baseName) {\n      value = value + '_' + baseName;\n    }\n    return value;\n  };\n  value = generateValue(basemapAttrs.baseType, basemapAttrs.baseName);\n  currentValue = generateValue(baseLayerDefinition.get('baseType'), baseLayerDefinition.get('baseName'));\n  label = basemapAttrs.name.replace('GMaps ', '');\n  imageURL = [\n    assetsBaseURL,\n    'unversioned/images/google-maps-basemap-icons',\n    value + '.jpg'\n  ].join('/');\n\n  _.extend(basemapAttrs, {\n    type: type,\n    name: basemapAttrs.name,\n    category: category,\n    selected: currentValue === value,\n    val: value,\n    label: label,\n    template: function () {\n      return mosaicThumbnail({\n        imgURL: imageURL\n      });\n    }\n  });\n\n  return new BasemapModel(basemapAttrs);\n};\n\n// Custom\n\nvar createCustomBasemapModel = function (category, customBaseLayerAttrs, baseLayerDefinition, configModel) {\n  var name = customBaseLayerAttrs.name ? customBaseLayerAttrs.name : 'Custom basemap ' + customBaseLayerAttrs.order;\n  var className = customBaseLayerAttrs.className;\n  var urlTemplate = customBaseLayerAttrs.urlTemplate;\n\n  return new BasemapModel({\n    id: customBaseLayerAttrs.id,\n    urlTemplate: urlTemplate,\n    minZoom: customBaseLayerAttrs.minZoom || 0,\n    maxZoom: customBaseLayerAttrs.maxZoom || 21,\n    name: name,\n    className: className,\n    attribution: customBaseLayerAttrs.attribution,\n    category: category || 'Custom',\n    tms: customBaseLayerAttrs.tms,\n    selected: baseLayerDefinition.get('className') === className,\n    val: className,\n    label: name,\n    template: function (imgURL) {\n      return mosaicThumbnail({\n        imgURL: imgURL\n      });\n    }\n  });\n};\n\n// Color\n\nvar createColorBasemapModel = function (category, basemapAttrs, baseLayerDefinition, configModel) {\n  return new BasemapModel({\n    default: false,\n    color: basemapAttrs.color || '',\n    image: basemapAttrs.image || '',\n    maxZoom: 32,\n    className: 'plain',\n    category: 'Color',\n    type: 'Plain',\n    selected: baseLayerDefinition.get('className') === 'plain',\n    val: 'plain',\n    label: 'plain',\n    template: function () {\n      return 'plain';\n    }\n  });\n};\n\n//  Factory\n\nvar CATEGORY_CARTODB = 'CARTO';\nvar CATEGORY_STAMEN = 'Stamen';\nvar CATEGORY_HERE = 'Here';\nvar CATEGORY_GMAPS = 'GMaps';\nvar CATEGORY_CUSTOM = 'Custom';\nvar CATEGORY_NASA = 'NASA';\nvar CATEGORY_TILEJSON = 'TileJSON';\nvar CATEGORY_MAPBOX = 'Mapbox';\nvar CATEGORY_WMS = 'WMS';\nvar CATEGORY_COLOR = 'Color';\n\nvar CREATE_METHODS = {};\nCREATE_METHODS[CATEGORY_CARTODB] = createLeafletBasemapModel;\nCREATE_METHODS[CATEGORY_STAMEN] = createLeafletBasemapModel;\nCREATE_METHODS[CATEGORY_HERE] = createLeafletBasemapModel;\nCREATE_METHODS[CATEGORY_GMAPS] = createGoogleMapsBasemapModel;\nCREATE_METHODS[CATEGORY_CUSTOM] = createCustomBasemapModel;\nCREATE_METHODS[CATEGORY_NASA] = createCustomBasemapModel;\nCREATE_METHODS[CATEGORY_TILEJSON] = createCustomBasemapModel;\nCREATE_METHODS[CATEGORY_MAPBOX] = createCustomBasemapModel;\nCREATE_METHODS[CATEGORY_WMS] = createCustomBasemapModel;\nCREATE_METHODS[CATEGORY_COLOR] = createColorBasemapModel;\n\nvar BasemapModelFactory = function (layerDefinitionsCollection, configModel) {\n  if (!layerDefinitionsCollection) throw new Error('layerDefinitionsCollection is required');\n  if (!configModel) throw new Error('configModel is required');\n\n  this._layerDefinitionsCollection = layerDefinitionsCollection;\n  this._configModel = configModel;\n};\n\nBasemapModelFactory.prototype.createBasemapModel = function (basemapCategory, basemapAttrs) {\n  var baseLayer = this._layerDefinitionsCollection.getBaseLayer();\n  var assetsBaseURL = this._configModel.get('app_assets_base_url');\n\n  var createMethod = CREATE_METHODS[basemapCategory];\n  if (!createMethod) {\n    throw new Error(\"Can't create basemapModel for basemap of type: \" + basemapCategory);\n  }\n  return createMethod(basemapCategory, basemapAttrs, baseLayer, assetsBaseURL);\n};\n\nmodule.exports = BasemapModelFactory;\n",
    "var Backbone = require('backbone');\n\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    default: false,\n    minZoom: 0,\n    maxZoom: 21,\n    name: '',\n    category: 'Custom',\n    type: 'Tiled',\n    selected: false,\n    val: '',\n    label: '',\n    template: function () {\n      return '';\n    }\n  },\n\n  getName: function () {\n    return this.get('label') || this.getValue();\n  },\n\n  getValue: function () {\n    return this.get('val');\n  }\n\n});\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('../../../components/mosaic/mosaic-item.tpl');\nvar AddBasemapView = require('../../../components/modals/add-basemap/add-basemap-view');\nvar AddBasemapModel = require('../../../components/modals/add-basemap/add-basemap-model');\n\nmodule.exports = CoreView.extend({\n\n  className: 'Mosaic-item Mosaic-item--dashed',\n\n  tagName: 'li',\n\n  events: {\n    'mouseenter': '_onMouseEnter',\n    'mouseleave': '_onMouseLeave',\n    'click': '_onClick'\n  },\n\n  initialize: function (opts) {\n    if (!opts.layerDefinitionsCollection) throw new Error('layerDefinitionsCollection is required');\n    if (!opts.modals) throw new Error('modals is required');\n    if (!opts.basemapsCollection) throw new Error('basemapsCollection is required');\n    if (!opts.customBaselayersCollection) throw new Error('customBaselayersCollection is required');\n    if (!opts.mosaicModel) throw new Error('mosaicModel is required');\n\n    this._layerDefinitionsCollection = opts.layerDefinitionsCollection;\n    this._basemapsCollection = opts.basemapsCollection;\n    this._customBaselayersCollection = opts.customBaselayersCollection;\n    this._modals = opts.modals;\n    this._currentTab = opts.currentTab;\n    this._mosaicModel = opts.mosaicModel;\n\n    this.add_related_model(this._mosaicModel);\n  },\n\n  render: function () {\n    this.$el.html(\n      template({\n        name: this.model.getName(),\n        template: this.model.get('template')()\n      })\n    );\n    return this;\n  },\n\n  _onMouseEnter: function () {\n    this._mosaicModel.set('highlightedAdd', true);\n  },\n\n  _onMouseLeave: function () {\n    this._mosaicModel.set('highlightedAdd', false);\n  },\n\n  _onClick: function () {\n    var self = this;\n\n    var modal = this._modals.create(function (modalModel) {\n      var addBasemapModel = new AddBasemapModel({}, {\n        layerDefinitionsCollection: self._layerDefinitionsCollection,\n        basemapsCollection: self._basemapsCollection,\n        customBaselayersCollection: self._customBaselayersCollection,\n        currentTab: self._currentTab\n      });\n\n      return new AddBasemapView({\n        modalModel: modalModel,\n        createModel: addBasemapModel\n      });\n    });\n    modal.show();\n  }\n\n});\n",
    "var BasemapMosaicView = require('./basemap-mosaic-view');\nvar BasemapMosaicModel = require('./basemap-mosaic-model');\nvar MosaicFormView = require('../../../components/mosaic-form-view');\n\n/**\n *  Mosaic form view\n */\n\nmodule.exports = MosaicFormView.extend({\n\n  initialize: function (opts) {\n    if (!opts.collection) throw new Error('Mosaic collection is required');\n    if (!opts.template) throw new Error('template is required');\n    if (!opts.layerDefinitionsCollection) throw new Error('layerDefinitionsCollection is required');\n    if (!opts.basemapsCollection) throw new Error('basemapsCollection is required');\n    if (!opts.customBaselayersCollection) throw new Error('customBaselayersCollection is required');\n    if (!opts.modals) throw new Error('modals is required');\n\n    this.template = opts.template;\n    this._layerDefinitionsCollection = opts.layerDefinitionsCollection;\n    this._basemapsCollection = opts.basemapsCollection;\n    this._customBaselayersCollection = opts.customBaselayersCollection;\n    this._modals = opts.modals;\n    this._disabled = opts.disabled;\n    this._currentTab = opts.currentTab;\n\n    this._initBinds();\n  },\n\n  _initViews: function () {\n    this.mosaic = new BasemapMosaicView({\n      model: new BasemapMosaicModel(),\n      collection: this.collection,\n      layerDefinitionsCollection: this._layerDefinitionsCollection,\n      basemapsCollection: this._basemapsCollection,\n      customBaselayersCollection: this._customBaselayersCollection,\n      modals: this._modals,\n      disabled: this._disabled,\n      currentTab: this._currentTab\n    });\n    this.mosaic.model.bind('change:highlightedAdd', this._onChangeHighlighted, this);\n\n    if (!this.$('.js-selector').length) throw new Error('HTML element with js-selector class is required');\n\n    this.$('.js-selector').append(this.mosaic.render().el);\n    this.addView(this.mosaic);\n  },\n\n  _onChangeHighlighted: function () {\n    var item = this.collection.getHighlighted() || this.mosaic.model.getHighlighted() || this.collection.getSelected();\n    if (item) {\n      var $el = this.$('.js-highlight');\n      if ($el) {\n        $el.text(item.getName());\n      }\n    }\n  }\n\n});\n",
    "/* global Image */\n\nvar template = require('../../../components/mosaic/mosaic-item.tpl');\nvar MosaicItemView = require('../../../components/mosaic/mosaic-item-view');\nvar BasemapMosaicRemoveView = require('./basemap-mosaic-remove-view');\n\nvar DEFAULT_SUBDOMAIN = 'a';\nvar DEFAULT_X_POSITION = 30;\nvar DEFAULT_Y_POSISTION = 24;\nvar DEFAULT_ZOOM = 6;\nvar DEFAULT_IMG = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAAAZ9JREFUWAntWUtugzAUNKbAJl1EYtcz9Ba5UE6SC+UWPUN3SNlkw78zVhJRCeIXbCup6ic5gP08Ho/x40ESBauq6iNJkgPKDpdb1j3RTuM4HlH2ZVl+JySXpukXygaksiViRVEsNd3qu65Tfd/frpdO8jxXEGO2GcTUMAxtXddnYH1qKqe1fof3IrlZpECVJA6xMgiyMdzws0N5CzTealiIlpGbBsKz77nZSYAc67ck+NIWCbouj1cFL/eNK6df/UW7FztKMT7ZTOJDDMQ5RUyJGYK2IMyBm6ax4nFQGxZBEIStWFcH2TSu3pZjiCX2StDCf1VzJLhKtkmnqOBEjFWn/0tBaaB+REoTqJkJ2wxJpM3FtPvGMgQlabrkCUEcCcF7Kf9UBT5xvN6DIZbYK8Hp7H2dR4KuSkYFo4KPKBAiYTWBmoHznvEdQpKm82ljw+I4DObElJghaJu59AWHA9qw6CMlR9+4i6mCi0UFXdRj3z+hIL8Ju040VP+TBrkjtn0bagQH3JbcSHB/+WDNCgc8r11bZOdncjPfWV/5b4gfOaaYLUG/QVoAAAAASUVORK5CYII=';\nvar DEFAULT_NAME = _t('editor.layers.basemap.custom-basemap');\n\nmodule.exports = MosaicItemView.extend({\n\n  initialize: function (opts) {\n    if (!opts.basemapsCollection) throw new Error('basemapsCollection is required');\n\n    this._basemapsCollection = opts.basemapsCollection;\n    this._disabled = opts.disabled;\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.$el.html(\n      template({\n        name: this._getName(),\n        template: this.model.get('template')(this._getImageURL())\n      })\n    );\n    this.$el.addClass('js-' + this.model.getValue());\n    this.$el.toggleClass('is-selected', !!this.model.get('selected'));\n\n    this._initViews();\n\n    return this;\n  },\n\n  _initViews: function () {\n    var basemapMosaicRemoveView = new BasemapMosaicRemoveView({\n      model: this.model,\n      basemapsCollection: this._basemapsCollection\n    });\n    this.addView(basemapMosaicRemoveView);\n    this.$el.append(basemapMosaicRemoveView.render().el);\n  },\n\n  _getImageURL: function () {\n    var self = this;\n    var url = this._lowerXYZ();\n\n    var image = new Image();\n    image.onerror = function () {\n      self.$('.js-thumbnailImg').attr('src', DEFAULT_IMG);\n    };\n    image.src = url;\n\n    return url;\n  },\n\n  _getSubdomain: function () {\n    var subdomains = this.model.get('subdomains'); // eg: 'abcd' or '1234'\n\n    return (subdomains && subdomains.length) ? subdomains[0] : DEFAULT_SUBDOMAIN;\n  },\n\n  _lowerXYZ: function () {\n    return this.model.get('urlTemplate')\n      .replace('{s}', this._getSubdomain())\n      .replace('{z}', DEFAULT_ZOOM)\n      .replace('{x}', DEFAULT_X_POSITION)\n      .replace('{y}', DEFAULT_Y_POSISTION);\n  },\n\n  _getName: function () {\n    var name = this.model.getName();\n\n    if (!name) {\n      name = this.model.get('order') ? DEFAULT_NAME + ' ' + this.model.get('order') : DEFAULT_NAME;\n    } else {\n      name.replace(/_/g, '');\n    }\n\n    return name;\n  }\n\n});\n",
    "var Backbone = require('backbone');\n\n/*\n *  List item model\n *\n */\n\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    highlightedAdd: false\n  },\n\n  getHighlighted: function () {\n    return this.get('highlightedAdd') && this;\n  },\n\n  getName: function () {\n    return 'Add';\n  }\n\n});\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./basemap-mosaic-remove.tpl');\nvar CustomListCollection = require('../../../components/custom-list/custom-list-collection');\nvar ContextMenuView = require('../../../components/context-menu/context-menu-view');\n\nmodule.exports = CoreView.extend({\n\n  tagName: 'span',\n  className: 'Mosaic-remove CDB-Shape-threePoints is-white is-small js-Mosaic-remove',\n\n  events: {\n    'click': '_onToggleContextMenuClicked'\n  },\n\n  initialize: function (opts) {\n    if (!opts.basemapsCollection) throw new Error('basemapsCollection is required');\n\n    this._basemapsCollection = opts.basemapsCollection;\n  },\n\n  render: function () {\n    this.$el.html(template());\n\n    return this;\n  },\n\n  _hasContextMenu: function () {\n    return this._menuView;\n  },\n\n  _hideContextMenu: function () {\n    this.removeView(this._menuView);\n    this._menuView.clean();\n    delete this._menuView;\n  },\n\n  _showContextMenu: function (position) {\n    this._menuItems = new CustomListCollection([{\n      label: _t('editor.layers.basemap.remove-baselayer'),\n      val: 'remove-baselayer',\n      destructive: true\n    }]);\n\n    var triggerElementID = 'context-menu-trigger-' + this.model.cid;\n    this.$('.js-Mosaic-remove').attr('id', triggerElementID);\n    this._menuView = new ContextMenuView({\n      collection: this._menuItems,\n      triggerElementID: triggerElementID,\n      position: position\n    });\n\n    this._menuItems.bind('change:selected', function (menuItem) {\n      if (menuItem.get('val') === 'remove-baselayer') {\n        this._deleteBaselayer();\n      }\n    }, this);\n    this.add_related_model(this._menuItems);\n\n    this._menuView.model.bind('change:visible', function (model, isContextMenuVisible) {\n      if (this._hasContextMenu() && !isContextMenuVisible) {\n        this._hideContextMenu();\n      }\n    }, this);\n\n    this._menuView.show();\n    this.addView(this._menuView);\n  },\n\n  _deleteBaselayer: function () {\n    this._basemapsCollection.remove(this.model);\n  },\n\n  _onToggleContextMenuClicked: function (e) {\n    this.killEvent(e);\n\n    if (this._hasContextMenu()) {\n      this._hideContextMenu();\n    } else {\n      this._showContextMenu({\n        x: e.pageX + 215, // CustomList--small width\n        y: e.pageY\n      });\n    }\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CDB-Shape-threePointsItem\"></div>\\n<div class=\"CDB-Shape-threePointsItem\"></div>\\n<div class=\"CDB-Shape-threePointsItem\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var template = require('../../../components/mosaic/mosaic.tpl');\nvar MosaicView = require('../../../components/mosaic/mosaic-view');\nvar MosaicItemModel = require('../../../components/mosaic/mosaic-item-model');\nvar BasemapMosaicItemView = require('./basemap-mosaic-item-view');\nvar MosaicAddItemView = require('./basemap-mosaic-add-item-view');\n\nmodule.exports = MosaicView.extend({\n\n  initialize: function (opts) {\n    if (!opts.layerDefinitionsCollection) throw new Error('layerDefinitionsCollection is required');\n    if (!opts.basemapsCollection) throw new Error('basemapsCollection is required');\n    if (!opts.customBaselayersCollection) throw new Error('customBaselayersCollection is required');\n    if (!opts.modals) throw new Error('modals is required');\n\n    this._layerDefinitionsCollection = opts.layerDefinitionsCollection;\n    this._basemapsCollection = opts.basemapsCollection;\n    this._customBaselayersCollection = opts.customBaselayersCollection;\n    this._modals = opts.modals;\n    this._disabled = opts.disabled;\n    this._currentTab = opts.currentTab;\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template());\n    this._renderList();\n    this._createAddItem();\n    return this;\n  },\n\n  _createItem: function (mdl) {\n    var view = new BasemapMosaicItemView({\n      model: mdl,\n      disabled: this._disabled,\n      basemapsCollection: this._basemapsCollection\n    });\n    this.$('.js-mosaic').append(view.render().el);\n    this.addView(view);\n  },\n\n  _createAddItem: function () {\n    var view = new MosaicAddItemView({\n      model: new MosaicItemModel({\n        label: 'Add',\n        val: 'add',\n        template: function () {\n          return '<div class=\"Mosaic-button\">+</div>';\n        }\n      }),\n      layerDefinitionsCollection: this._layerDefinitionsCollection,\n      basemapsCollection: this._basemapsCollection,\n      customBaselayersCollection: this._customBaselayersCollection,\n      mosaicModel: this.model,\n      modals: this._modals,\n      currentTab: this._currentTab\n    });\n    this.$('.js-mosaic').append(view.render().el);\n    this.addView(view);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"js-selector\">\\n  <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n    <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.layers.basemap.style.title-label') ))==null?'':_.escape(__t))+\n'</h2>\\n  </div>\\n  <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m js-highlight\">'+\n((__t=( _t('editor.layers.basemap.style.select-style') ))==null?'':_.escape(__t))+\n'</p>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./basemap-select.tpl');\nvar MosaicFormView = require('../../../components/mosaic-form-view');\nvar BasemapFormView = require('./basemap-form-view');\nvar MosaicCollection = require('../../../components/mosaic/mosaic-collection');\nvar BasemapMosaicFormView = require('./basemap-mosaic-form-view');\nvar checkAndBuildOpts = require('../../../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'layerDefinitionsCollection',\n  'basemapsCollection',\n  'customBaselayersCollection',\n  'selectedCategoryVal',\n  'modals'\n];\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    this._baseLayer = this._layerDefinitionsCollection.getBaseLayer();\n    this._disabled = opts.disabled;\n\n    this._initCollection();\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template());\n\n    var category = this._selectedCategoryVal.toLowerCase();\n\n    switch (category) {\n      case 'color':\n        this._renderForm();\n        break;\n      case 'custom':\n        this._renderCustomMosaic();\n        break;\n      case 'nasa':\n      case 'tilejson':\n      case 'mapbox':\n      case 'wms':\n        this._renderCustomMosaic(category);\n        break;\n      default:\n        this._renderMosaic();\n    }\n\n    return this;\n  },\n\n  _initCollection: function () {\n    this._filteredBasemapsCollection = new MosaicCollection(\n      this._basemapsCollection.findByCategory(this._selectedCategoryVal)\n    );\n  },\n\n  _initBinds: function () {\n    this._filteredBasemapsCollection.bind('change:selected', function (mdl) {\n      if (mdl.get('selected')) {\n        var value = mdl.getValue();\n\n        this._changeBasemap(value);\n      }\n    }, this);\n    this.add_related_model(this._filteredBasemapsCollection);\n  },\n\n  _changeBasemap: function (value) {\n    var basemap = this._basemapsCollection.getByValue(value);\n\n    this._layerDefinitionsCollection.setBaseLayer(basemap.toJSON());\n  },\n\n  _renderMosaic: function () {\n    var view = new MosaicFormView({\n      collection: this._filteredBasemapsCollection,\n      template: require('./basemap-mosaic.tpl'),\n      disabled: this._disabled\n    });\n    this.addView(view);\n    this.$('.js-select').append(view.render().el);\n  },\n\n  _renderCustomMosaic: function (category) {\n    var view = new BasemapMosaicFormView({\n      collection: this._filteredBasemapsCollection,\n      template: require('./basemap-mosaic.tpl'),\n      layerDefinitionsCollection: this._layerDefinitionsCollection,\n      basemapsCollection: this._basemapsCollection,\n      customBaselayersCollection: this._customBaselayersCollection,\n      modals: this._modals,\n      disabled: this._disabled,\n      currentTab: category\n    });\n    this.addView(view);\n    this.$('.js-select').append(view.render().el);\n  },\n\n  _renderForm: function () {\n    var view = new BasemapFormView({\n      model: this._baseLayer,\n      basemapsCollection: this._basemapsCollection,\n      layerDefinitionsCollection: this._layerDefinitionsCollection,\n      disabled: this._disabled\n    });\n    this.addView(view);\n    this.$('.js-select').append(view.render().el);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-HeaderInfo\">\\n  <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">2</div>\\n  <div class=\"Editor-HeaderInfo-inner CDB-Text js-select\"></div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar BasemapModel = require('./basemap-model');\nvar _ = require('underscore');\n\n/*\n *  Basemap collection, extends Mosaic collection\n */\n\nmodule.exports = Backbone.Collection.extend({\n\n  model: BasemapModel,\n\n  initialize: function () {\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this.bind('change:selected', this._onSelectedChange, this);\n  },\n\n  _onSelectedChange: function (changedModel, isSelected) {\n    if (isSelected) {\n      this.each(function (m) {\n        if (m.cid !== changedModel.cid && m.get('selected')) {\n          m.set('selected', false);\n        }\n      });\n    }\n  },\n\n  findByCategory: function (category) {\n    return this.where({ category: category });\n  },\n\n  getDefaultCategory: function () {\n    var defaultCategory = this.findWhere({ default: true });\n    defaultCategory = defaultCategory || this.first();\n\n    return defaultCategory.get('category');\n  },\n\n  getCategories: function () {\n    var categories = this.chain()\n      .map(function (model) { return model.get('category'); })\n      .concat('Custom')\n      .concat('NASA')\n      .concat('TileJSON')\n      .concat('Mapbox')\n      .concat('WMS')\n      .uniq()\n      .value();\n\n    return categories;\n  },\n\n  getSelected: function () {\n    return this.findWhere({ selected: true });\n  },\n\n  updateSelected: function (value) {\n    var newSelected = this.getByValue(value);\n    newSelected.set({ selected: true });\n  },\n\n  updateCategory: function (value, category) {\n    var newCategory = this.getByValue(value);\n    newCategory.set({ category: category });\n  },\n\n  getByValue: function (value) {\n    return _.first(this.where({ val: value }));\n  },\n\n  getThumbnailImage: function (urlTemplate, subdomains) {\n    return this._lowerXYZ(urlTemplate, subdomains);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"js-basemapHeader\"></div>\\n<div class=\"js-basemapContent Editor-content\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<ul class=\"u-flex u-alignCenter Editor-contextSwitcher js-mapTableView\\n  ';\n if (context === 'table') { \n__p+='in-table';\n } \n__p+='\\n  ';\n if (isThereOtherWidgets && context === 'map') { \n__p+='is-moved';\n } \n__p+='\\n  ';\n if (isThereTimeSeries && context === 'map') { \n__p+='\\n    has-timeSeries\\n    ';\n if (isThereAnimatedTimeSeries) { \n__p+='\\n      has-timeSeries--animated\\n    ';\n } \n__p+='\\n  ';\n } \n__p+='\\n  \">\\n  <li class=\"Editor-contextSwitcherItem\">\\n    <div class=\"Editor-contextSwitcherButton js-showTable\\n        ';\n if (context === 'table') { \n__p+='is-selected';\n } \n__p+='\\n      \">\\n      <svg width=\"11px\" height=\"10px\" viewBox=\"505 436 11 10\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n        <g id=\"Group\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(505.000000, 436.000000)\">\\n          <path d=\"M3,0 L3,10 L0,10 L0,0 L3,0 Z M1,1 L1,9 L2,9 L2,1 L1,1 Z\" id=\"Combined-Shape\" class=\"Editor-contextSwitcherMedia\" ></path>\\n          <path d=\"M7,0 L7,10 L4,10 L4,0 L7,0 Z M5,1 L5,9 L6,9 L6,1 L5,1 Z\" id=\"Combined-Shape-Copy\" class=\"Editor-contextSwitcherMedia\" ></path>\\n          <path d=\"M11,0 L11,10 L8,10 L8,0 L11,0 Z M9,1 L9,9 L10,9 L10,1 L9,1 Z\" id=\"Combined-Shape-Copy-2\" class=\"Editor-contextSwitcherMedia\" ></path>\\n        </g>\\n      </svg>\\n    </div>\\n  </li>\\n  <li class=\"Editor-contextSwitcherItem\">\\n    <div class=\"Editor-contextSwitcherButton js-showMap\\n        ';\n if (context === 'map') { \n__p+='is-selected';\n } \n__p+='\\n      \">\\n      <svg width=\"9px\" height=\"12px\" viewBox=\"538 435 9 12\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n        <path d=\"M547,438.913043 C547,441.07513 542.5,447 542.5,447 C542.5,447 538,441.07513 538,438.913043 C538,436.752 540.0142,435 542.5,435 C544.9852,435 547,436.752 547,438.913043 Z M543.908614,443.22687 C544.16716,442.824347 544.408524,442.43401 544.629457,442.059548 C545.498835,440.586034 546,439.426635 546,438.913043 C546,437.337768 544.461567,436 542.5,436 C540.538058,436 539,437.337565 539,438.913043 C539,439.426635 539.501165,440.586034 540.370543,442.059548 C540.591476,442.43401 540.83284,442.824347 541.091386,443.22687 C541.539951,443.925227 542.019537,444.628807 542.501367,445.306148 C542.537557,445.357022 543.426358,443.97768 543.908614,443.22687 Z\" id=\"Combined-Shape\" stroke=\"none\" class=\"Editor-contextSwitcherMedia\" fill-rule=\"evenodd\"></path>\\n      </svg>\\n    </div>\\n  </li>\\n</ul>\\n\\n<div class=\"EditOverlay js-editOverlay is-hidden\"><p class=\"EditOverlay-inner CDB-Text CDB-Size-medium u-whiteTextColor js-editOverlay-text\"></p></div>\\n\\n<ul class=\"u-flex u-alignRight Editor-contextSwitcher Editor-contextSwitcher--geom js-mapTableView js-newGeometryView\\n';\n if (context === 'table') { \n__p+='in-table';\n } \n__p+='\\n';\n if (isThereOtherWidgets && context === 'map') { \n__p+='is-moved';\n } \n__p+='\\n';\n if (isThereTimeSeries && context === 'map') { \n__p+='\\n  has-timeSeries\\n  ';\n if (isThereAnimatedTimeSeries) { \n__p+='\\n    has-timeSeries--animated\\n  ';\n } \n__p+='\\n';\n } \n__p+='\\n\"\\n';\n if (isReadOnly || !isVisible) { \n__p+='data-tooltip=\"'+\n((__t=( _t('editor.edit-feature.geometry-disabled') ))==null?'':_.escape(__t))+\n'\"';\n } \n__p+='\\n>\\n  ';\n if (queryGeometryModel === 'point' || !queryGeometryModel) { \n__p+='\\n    <li class=\"Editor-contextSwitcherItem js-newGeometryItem ';\n if (isReadOnly ||!isVisible) { \n__p+='is-disabled';\n } \n__p+='\">\\n      <div class=\"Editor-contextSwitcherButton js-newGeometry\" data-feature-type=\\'point\\'>\\n        <svg width=\"12\" height=\"12\" viewBox=\"0 0 12 12\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n          <defs>\\n            <path d=\"M0 2h3v1H0V2zm0-2h3v1H0V0zm2 1h1v1H2V1zM0 1h1v1H0V1z\" id=\"a\"/>\\n            <path d=\"M0 2h3v1H0V2zm0-2h3v1H0V0zm2 1h1v1H2V1zM0 1h1v1H0V1z\" id=\"c\"/>\\n            <path d=\"M0 2h3v1H0V2zm0-2h3v1H0V0zm2 1h1v1H2V1zM0 1h1v1H0V1z\" id=\"e\"/>\\n          </defs>\\n          <g fill=\"none\" fill-rule=\"evenodd\">\\n            <path fill=\"#FFF\" d=\"M4 3h3v1H4v3H3V4H0V3h3V0h1\"/>\\n            <g transform=\"rotate(180 2.5 6)\">\\n              <mask id=\"b\" fill=\"#fff\">\\n                <use xlink:href=\"#a\"/>\\n              </mask>\\n              <path d=\"M0 2h3v1H0V2zm0-2h3v1H0V0zm2 1h1v1H2V1zM0 1h1v1H0V1z\" mask=\"url(#b)\" stroke=\"#FFF\" stroke-width=\"2\"/>\\n            </g>\\n            <g transform=\"rotate(180 6 6)\">\\n              <mask id=\"d\" fill=\"#fff\">\\n                <use xlink:href=\"#c\"/>\\n              </mask>\\n              <path d=\"M0 2h3v1H0V2zm0-2h3v1H0V0zm2 1h1v1H2V1zM0 1h1v1H0V1z\" mask=\"url(#d)\" stroke=\"#FFF\" stroke-width=\"2\"/>\\n            </g>\\n            <g transform=\"rotate(180 6 2.5)\">\\n              <mask id=\"f\" fill=\"#fff\">\\n                <use xlink:href=\"#e\"/>\\n              </mask>\\n              <path d=\"M0 2h3v1H0V2zm0-2h3v1H0V0zm2 1h1v1H2V1zM0 1h1v1H0V1z\" mask=\"url(#f)\" stroke=\"#FFF\" stroke-width=\"2\"/>\\n            </g>\\n          </g>\\n        </svg>\\n      </div>\\n    </li>\\n  ';\n } \n__p+='\\n  ';\n if (queryGeometryModel === 'line' || !queryGeometryModel) { \n__p+='\\n    <li class=\"Editor-contextSwitcherItem js-newGeometryItem ';\n if (isReadOnly || !isVisible) { \n__p+='is-disabled';\n } \n__p+='\">\\n      <div class=\"Editor-contextSwitcherButton js-newGeometry\" data-feature-type=\\'line\\'>\\n        <svg width=\"14\" height=\"14\" viewBox=\"0 0 14 14\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n          <defs>\\n            <path d=\"M0 2h3v1H0V2zm0-2h3v1H0V0zm2 1h1v1H2V1zM0 1h1v1H0V1z\" id=\"a\"/>\\n            <path d=\"M0 2h3v1H0V2zm0-2h3v1H0V0zm2 1h1v1H2V1zM0 1h1v1H0V1z\" id=\"c\"/>\\n          </defs>\\n          <g fill=\"none\" fill-rule=\"evenodd\">\\n            <path fill=\"#FFF\" d=\"M11.5 5l-.707-.707-6.354 6.853.705.708\"/>\\n            <g transform=\"translate(11 2)\">\\n              <mask id=\"b\" fill=\"#fff\">\\n                <use xlink:href=\"#a\"/>\\n              </mask>\\n              <path d=\"M0 2h3v1H0V2zm0-2h3v1H0V0zm2 1h1v1H2V1zM0 1h1v1H0V1z\" mask=\"url(#b)\" stroke=\"#FFF\" stroke-width=\"2\"/>\\n            </g>\\n            <g transform=\"translate(2 11)\">\\n              <mask id=\"d\" fill=\"#fff\">\\n                <use xlink:href=\"#c\"/>\\n              </mask>\\n              <path d=\"M0 2h3v1H0V2zm0-2h3v1H0V0zm2 1h1v1H2V1zM0 1h1v1H0V1z\" mask=\"url(#d)\" stroke=\"#FFF\" stroke-width=\"2\"/>\\n            </g>\\n            <path fill=\"#FFF\" d=\"M3 4H0V3h3V0h1v3h3v1H4v3H3\"/>\\n          </g>\\n        </svg>\\n      </div>\\n    </li>\\n  ';\n } \n__p+='\\n  ';\n if (queryGeometryModel === 'polygon' || !queryGeometryModel) { \n__p+='\\n    <li class=\"Editor-contextSwitcherItem js-newGeometryItem ';\n if (isReadOnly || !isVisible) { \n__p+='is-disabled';\n } \n__p+='\">\\n      <div class=\"Editor-contextSwitcherButton js-newGeometry\" data-feature-type=\\'polygon\\'>\\n        <svg width=\"14\" height=\"14\" viewBox=\"0 0 14 14\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n          <defs>\\n            <path d=\"M0 2h3v1H0V2zm0-2h3v1H0V0zm2 1h1v1H2V1zM0 1h1v1H0V1z\" id=\"a\"/>\\n            <path d=\"M0 2h3v1H0V2zm0-2h3v1H0V0zm2 1h1v1H2V1zM0 1h1v1H0V1z\" id=\"c\"/>\\n            <path d=\"M0 2h3v1H0V2zm0-2h3v1H0V0zm2 1h1v1H2V1zM0 1h1v1H0V1z\" id=\"e\"/>\\n          </defs>\\n          <g fill=\"none\" fill-rule=\"evenodd\">\\n            <path d=\"M13 11.5V5h-1v7h1m-.5-7.5l-.707-.707-7.647 7.353-.353.354.707.707.354-.353M4 3h3v1H4v3H3V4H0V3h3V0h1\" fill=\"#FFF\"/>\\n            <path fill=\"#FFF\" d=\"M4.5 13H12v-1H4v1\"/>\\n            <g transform=\"rotate(180 7 7)\">\\n              <mask id=\"b\" fill=\"#fff\">\\n                <use xlink:href=\"#a\"/>\\n              </mask>\\n              <path d=\"M0 2h3v1H0V2zm0-2h3v1H0V0zm2 1h1v1H2V1zM0 1h1v1H0V1z\" stroke=\"#FFF\" stroke-width=\"2\" mask=\"url(#b)\"/>\\n            </g>\\n            <g transform=\"rotate(180 7 2.5)\">\\n              <mask id=\"d\" fill=\"#fff\">\\n                <use xlink:href=\"#c\"/>\\n              </mask>\\n              <path d=\"M0 2h3v1H0V2zm0-2h3v1H0V0zm2 1h1v1H2V1zM0 1h1v1H0V1z\" stroke=\"#FFF\" stroke-width=\"2\" mask=\"url(#d)\"/>\\n            </g>\\n            <g transform=\"rotate(180 2.5 7)\">\\n              <mask id=\"f\" fill=\"#fff\">\\n                <use xlink:href=\"#e\"/>\\n              </mask>\\n              <path d=\"M0 2h3v1H0V2zm0-2h3v1H0V0zm2 1h1v1H2V1zM0 1h1v1H0V1z\" stroke=\"#FFF\" stroke-width=\"2\" mask=\"url(#f)\"/>\\n            </g>\\n          </g>\\n        </svg>\\n      </div>\\n    </li>\\n  ';\n } \n__p+='\\n</ul>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-justifyCenter\">\\n  <div class=\"Modal-inner Modal-inner--grid u-flex u-justifyCenter\">\\n    <div class=\"Modal-icon\">\\n      <svg width=\"24px\" height=\"25px\" viewbox=\"521 436 24 25\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n            <path d=\"M524.5,440 L540.5,440 L540.5,460 L524.5,460 L524.5,440 Z M528.5,437 L536.5,437 L536.5,440 L528.5,440 L528.5,437 Z M522,440 L544,440 L522,440 Z M528.5,443.5 L528.5,455.5 L528.5,443.5 Z M532.5,443.5 L532.5,455.5 L532.5,443.5 Z M536.5,443.5 L536.5,455.5 L536.5,443.5 Z\" id=\"Shape\" stroke=\"#F19243\" stroke-width=\"1\" fill=\"none\"/>\\n      </svg>\\n    </div>\\n    <div>\\n      <h2 class=\" CDB-Text CDB-Size-huge is-light u-bSpace--xl\">'+\n((__t=( _t('editor.layers.delete.title', { layerName: layerName }) ))==null?'':_.escape(__t))+\n'</h2>\\n      <p class=\"CDB-Text CDB-Size-large u-altTextColor\">'+\n((__t=( _t('editor.layers.delete.desc', { layerVisName: layerVisName }) ))==null?'':__t)+\n'</p>\\n      <ul class=\"Modal-listText\">\\n        ';\n if (affectedItemsMessages.length > 0) { \n__p+='\\n          <li class=\"Modal-listTextItem\">\\n            <p class=\"CDB-Text CDB-Size-large\">\\n              '+\n((__t=( _t('editor.layers.delete.affected-items') ))==null?'':__t)+\n'\\n              ';\n for (var i = 0; i < affectedItemsMessages.length; i++) { \n__p+='\\n                  <span class=\"CDB-Text is-semibold\">'+\n((__t=( affectedItemsMessages[i] ))==null?'':_.escape(__t))+\n'</span>\\n                  ';\n if (i < (affectedItemsMessages.length - 2)) { \n__p+='\\n                    ,\\n                  ';\n } else if (i == (affectedItemsMessages.length - 2)) { \n__p+='\\n                    '+\n((__t=( _t('editor.layers.delete.and') ))==null?'':__t)+\n'\\n                  ';\n } \n__p+='\\n              ';\n } \n__p+='\\n              .</p>\\n          </li>\\n        ';\n } \n__p+='\\n        <li class=\"Modal-listTextItem\">\\n          <p class=\"CDB-Text CDB-Size-large\">'+\n((__t=( _t('editor.layers.delete.link-to-export') ))==null?'':__t)+\n'</p>\\n        </li>\\n      </ul>\\n      <ul class=\"Modal-listActions u-flex u-alignCenter\">\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--secondary CDB-Button--big js-cancel\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">\\n              '+\n((__t=( _t('editor.layers.delete.cancel') ))==null?'':_.escape(__t))+\n'\\n            </span>\\n          </button>\\n        </li>\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-confirm\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">\\n              '+\n((__t=( _t('editor.layers.delete.confirm') ))==null?'':_.escape(__t))+\n'\\n            </span>\\n          </button>\\n        </li>\\n      </ul>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar $ = require('jquery');\nvar CoreView = require('backbone/core-view');\nvar template = require('./edit-feature-content.tpl');\nvar EditFeatureActionView = require('./edit-feature-content-views/edit-feature-action-view');\nvar EditFeatureControlView = require('./edit-feature-content-views/edit-feature-control-view');\nvar EditFeatureHeaderView = require('./edit-feature-content-views/edit-feature-header-view');\nvar VisTableModel = require('../../data/visualization-table-model');\nvar EditFeatureInnerView = require('./edit-feature-content-views/edit-feature-inner-view');\nvar PanelWithOptionsView = require('../../components/view-options/panel-with-options-view');\nvar ScrollView = require('../../components/scroll/scroll-view');\nvar Notifier = require('../../components/notifier/notifier');\nvar EditFeatureGeometryFormModel = require('./edit-feature-content-views/edit-feature-geometry-form-model');\nvar EditFeatureGeometryPointFormModel = require('./edit-feature-content-views/edit-feature-geometry-point-form-model');\nvar EditFeatureAttributesFormModel = require('./edit-feature-content-views/edit-feature-attributes-form-model');\n\nvar NOTIFICATION_ID = 'editFeatureNotification';\nvar NOTIFICATION_ERROR_TEMPLATE = _.template(\"<span class='u-errorTextColor'><%- title %></span>\");\n\nvar REQUIRED_OPTS = [\n  'stackLayoutModel',\n  'layerDefinitionModel',\n  'configModel',\n  'mapModeModel',\n  'editorModel',\n  'modals'\n];\n\nmodule.exports = CoreView.extend({\n\n  className: 'Editor-content',\n\n  events: {\n    'click .js-back': 'clean'\n  },\n\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (opts[item] === undefined) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n\n    this._featureModel = this._mapModeModel.getFeatureDefinition();\n    this._tableName = '';\n    this._url = '';\n\n    this._editorModel.set({\n      edition: false\n    });\n\n    this._getTable();\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template());\n\n    this._initViews();\n\n    return this;\n  },\n\n  _initBinds: function () {\n    if (this._querySchemaModel.get('status') !== 'fetched') {\n      // status can be: fetched, unavailable, fetching\n      this._querySchemaModel.bind('change:status', this.render, this);\n      this._querySchemaModel.fetch();\n    }\n    this._featureModel.bind('updateFeature', this._updateForms, this);\n    this._featureModel.bind('destroyFeature', this._onDestroyFeature, this);\n    this._featureModel.bind('destroyFeatureSuccess', this._onDestroyFeatureSuccess, this);\n    this._featureModel.bind('destroyFeatureFailed', this._onDestroyFeatureFailed, this);\n    this._featureModel.bind('addFeature', this._onAddFeature, this);\n    this._featureModel.bind('saveFeature', this._onSaveFeature, this);\n    this._featureModel.bind('saveFeatureSuccess', this._onSaveFeatureSuccess, this);\n    this._featureModel.bind('saveFeatureFailed', this._onSaveFeatureFailed, this);\n\n    this.add_related_model(this._featureModel);\n  },\n\n  _initViews: function () {\n    if (this._featureModel.isNew()) {\n      this._addRow();\n    } else {\n      this._renderInfo();\n    }\n  },\n\n  _updateForms: function () {\n    this._updateGeometry();\n    this._attributesFormModel.trigger('updateFeature');\n  },\n\n  _updateGeometry: function () {\n    var geojson = null;\n\n    try {\n      geojson = JSON.parse(this._featureModel.get('the_geom'));\n    } catch (err) {\n      // if the geom is not a valid json value\n    }\n\n    var attrs;\n\n    if (this._featureModel.isPoint()) {\n      attrs = {\n        lng: geojson && geojson.coordinates[0],\n        lat: geojson && geojson.coordinates[1]\n      };\n    } else {\n      attrs = {\n        the_geom: this._featureModel.get('the_geom')\n      };\n    }\n\n    this._geometryFormModel.set(attrs);\n    this._geometryFormModel.trigger('updateFeature', attrs);\n  },\n\n  _addRow: function () {\n    this._renderInfo();\n  },\n\n  _renderInfo: function () {\n    this._renderHeader();\n    this._renderContent();\n  },\n\n  _renderHeader: function () {\n    if (this._headerView) {\n      this.removeView(this._headerView);\n      this._headerView.clean();\n    }\n\n    this._headerView = new EditFeatureHeaderView({\n      url: this._url,\n      tableName: this._tableName,\n      model: this._featureModel,\n      modals: this._modals,\n      isNew: this._featureModel.isNew(),\n      backAction: this.clean.bind(this)\n    });\n    this.addView(this._headerView);\n    this.$('.js-editFeatureHeader').html(this._headerView.render().el);\n  },\n\n  _renderContent: function () {\n    var self = this;\n\n    if (this._contentView) {\n      this.removeView(this._contentView);\n      this._contentView.clean();\n    }\n\n    var geojson = null;\n\n    try {\n      geojson = JSON.parse(this._featureModel.get('the_geom'));\n    } catch (err) {\n      // if the geom is not a valid json value\n    }\n\n    if (this._featureModel.isPoint()) {\n      this._geometryFormModel = new EditFeatureGeometryPointFormModel({\n        lng: geojson && geojson.coordinates[0],\n        lat: geojson && geojson.coordinates[1]\n      }, {\n        featureModel: this._featureModel\n      });\n    } else {\n      this._geometryFormModel = new EditFeatureGeometryFormModel({\n        the_geom: this._featureModel.get('the_geom')\n      }, {\n        featureModel: this._featureModel\n      });\n    }\n\n    this._attributesFormModel = new EditFeatureAttributesFormModel(this._featureModel.toJSON(), {\n      featureModel: this._featureModel,\n      columnsCollection: this._sourceNode.querySchemaModel.columnsCollection,\n      configModel: this._configModel,\n      nodeDefModel: this._layerDefinitionModel.getAnalysisDefinitionNodeModel()\n    });\n\n    this._contentView = new PanelWithOptionsView({\n      className: 'Editor-content',\n      editorModel: self._editorModel,\n      createContentView: function () {\n        return new ScrollView({\n          createContentView: function () {\n            return new EditFeatureInnerView({\n              featureModel: self._featureModel,\n              geometryFormModel: self._geometryFormModel,\n              attributesFormModel: self._attributesFormModel\n            });\n          }\n        });\n      },\n      createControlView: function () {\n        return new EditFeatureControlView();\n      },\n      createActionView: function () {\n        return new EditFeatureActionView({\n          model: self.model,\n          featureModel: self._featureModel,\n          geometryFormModel: self._geometryFormModel,\n          attributesFormModel: self._attributesFormModel\n        });\n      }\n    });\n    this.addView(this._contentView);\n    this.$('.js-editFeatureContent').html(this._contentView.render().el);\n  },\n\n  _onDestroyFeature: function () {\n    if (Notifier.getNotification(NOTIFICATION_ID)) {\n      Notifier.removeNotification(NOTIFICATION_ID);\n    }\n\n    this.notification = Notifier.addNotification({\n      id: NOTIFICATION_ID,\n      status: 'loading',\n      info: _t('notifications.edit-feature.destroy.loading'),\n      closable: false\n    });\n  },\n\n  _onDestroyFeatureSuccess: function () {\n    this._onUpdateFeature('destroy');\n\n    this.notification.set({\n      status: 'success',\n      info: _t('notifications.edit-feature.destroy.success'),\n      closable: true\n    });\n  },\n\n  _onDestroyFeatureFailed: function (mdl, error) {\n    this.notification.set({\n      status: 'error',\n      info: NOTIFICATION_ERROR_TEMPLATE({\n        title: _t('notifications.edit-feature.destroy.error')\n      }),\n      closable: true\n    });\n  },\n\n  _onAddFeature: function () {\n    if (Notifier.getNotification(NOTIFICATION_ID)) {\n      Notifier.removeNotification(NOTIFICATION_ID);\n    }\n\n    this.notification = Notifier.addNotification({\n      id: NOTIFICATION_ID,\n      status: 'loading',\n      info: _t('notifications.edit-feature.adding'),\n      closable: false\n    });\n  },\n\n  _onSaveFeature: function () {\n    if (Notifier.getNotification(NOTIFICATION_ID)) {\n      Notifier.removeNotification(NOTIFICATION_ID);\n    }\n\n    this.notification = Notifier.addNotification({\n      id: NOTIFICATION_ID,\n      status: 'loading',\n      info: _t('notifications.edit-feature.save.loading'),\n      closable: false\n    });\n  },\n\n  _onSaveFeatureSuccess: function (op) {\n    this._onUpdateFeature(op);\n    this.render();\n\n    this.notification.set({\n      status: 'success',\n      info: _t('notifications.edit-feature.save.success'),\n      closable: true\n    });\n  },\n\n  _onSaveFeatureFailed: function (mdl, error) {\n    this.notification.set({\n      status: 'error',\n      info: NOTIFICATION_ERROR_TEMPLATE({\n        title: _t('notifications.edit-feature.save.error')\n      }),\n      closable: true\n    });\n  },\n\n  _onUpdateFeature: function (operation) {\n    if (operation !== 'save' || !this._queryGeometryModel.hasValue()) {\n      this._queryGeometryModel.resetFetch();\n    }\n\n    if (operation === 'add' || operation === 'destroy') {\n      this._rowsCollection.resetFetch();\n    }\n  },\n\n  _getTable: function () {\n    this._sourceNode = this._getSourceNode();\n\n    if (this._sourceNode) {\n      var tableName = this._sourceNode.get('table_name');\n      this._visTableModel = new VisTableModel({\n        id: tableName,\n        table: {\n          name: tableName\n        }\n      }, {\n        configModel: this._configModel\n      });\n\n      this._querySchemaModel = this._sourceNode.querySchemaModel;\n      this._queryGeometryModel = this._sourceNode.queryGeometryModel;\n      this._rowsCollection = this._sourceNode.queryRowsCollection;\n    }\n\n    if (this._visTableModel) {\n      var tableModel = this._visTableModel.getTableModel();\n      this._tableName = tableModel.getUnquotedName();\n      this._url = this._visTableModel && this._visTableModel.datasetURL();\n    }\n  },\n\n  _getSourceNode: function () {\n    var node = this._layerDefinitionModel.getAnalysisDefinitionNodeModel();\n    var source;\n    if (node.get('type') === 'source') {\n      source = node;\n    } else {\n      var primarySource = node.getPrimarySource();\n      if (primarySource && primarySource.get('type') === 'source') {\n        source = primarySource;\n      }\n    }\n\n    return source;\n  },\n\n  _destroyContextOverlay: function () {\n    $('.js-editOverlay').fadeOut(200, function () {\n      $('.js-editOverlay').remove();\n    });\n  },\n\n  clean: function () {\n    this._destroyContextOverlay();\n    this._mapModeModel.enterViewingMode();\n    CoreView.prototype.clean.apply(this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-justifyCenter\">\\n  <div class=\"Modal-inner Modal-inner--grid u-flex u-justifyCenter\">\\n    <div class=\"Modal-icon\">\\n      <svg width=\"24px\" height=\"25px\" viewbox=\"521 436 24 25\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n        <path d=\"M524.5,440 L540.5,440 L540.5,460 L524.5,460 L524.5,440 Z M528.5,437 L536.5,437 L536.5,440 L528.5,440 L528.5,437 Z M522,440 L544,440 L522,440 Z M528.5,443.5 L528.5,455.5 L528.5,443.5 Z M532.5,443.5 L532.5,455.5 L532.5,443.5 Z M536.5,443.5 L536.5,455.5 L536.5,443.5 Z\" id=\"Shape\" stroke=\"#F19243\" stroke-width=\"1\" fill=\"none\"/>\\n      </svg>\\n    </div>\\n    <div>\\n      <h2 class=\" CDB-Text CDB-Size-huge is-light u-bSpace--xl\">'+\n((__t=( _t('components.modals.edit-feature.delete.title') ))==null?'':_.escape(__t))+\n'</h2>\\n      <p class=\"CDB-Text CDB-Size-large u-altTextColor\">'+\n((__t=( _t('components.modals.edit-feature.delete.desc') ))==null?'':_.escape(__t))+\n'</p>\\n      <ul class=\"Modal-listActions u-flex u-alignCenter\">\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--secondary CDB-Button--big js-cancel\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">\\n              '+\n((__t=( _t('components.modals.edit-feature.delete.cancel') ))==null?'':_.escape(__t))+\n'\\n            </span>\\n          </button>\\n        </li>\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-confirm\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">\\n              '+\n((__t=( _t('components.modals.edit-feature.delete.confirm') ))==null?'':_.escape(__t))+\n'\\n            </span>\\n          </button>\\n        </li>\\n      </ul>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./edit-feature-action.tpl');\n\n/**\n * View representing the apply button for a form\n */\nmodule.exports = CoreView.extend({\n\n  events: {\n    'click .js-save': '_onSaveClicked'\n  },\n\n  initialize: function (opts) {\n    if (!opts.featureModel) throw new Error('featureModel is required');\n    if (!opts.geometryFormModel) throw new Error('geometryFormModel is required');\n    if (!opts.attributesFormModel) throw new Error('attributesFormModel is required');\n\n    this._featureModel = opts.featureModel;\n    this._geometryFormModel = opts.geometryFormModel;\n    this._attributesFormModel = opts.attributesFormModel;\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    this.$el.html(template({\n      label: this._featureModel.isNew() ? _t('editor.edit-feature.add') : _t('editor.edit-feature.save'),\n      isDisabled: !this._canSave()\n    }));\n\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.on('change', this.render, this);\n    this._featureModel.on('change', function () {\n      this.model.set('hasChanges', true);\n    }, this);\n    this.add_related_model(this._featureModel);\n    this._geometryFormModel.bind('validate', function (isValid) {\n      this.model.set('isValidGeometry', !isValid);\n    }, this);\n    this.add_related_model(this._geometryFormModel);\n    this._attributesFormModel.bind('validate', function (isValid) {\n      this.model.set('isValidAttributes', !isValid);\n    }, this);\n    this.add_related_model(this._attributesFormModel);\n  },\n\n  _canSave: function () {\n    var hasChanges = this.model.get('hasChanges');\n    var isValidGeometry = this.model.get('isValidGeometry');\n    var isValidAttributes = this.model.get('isValidAttributes');\n\n    return isValidGeometry && isValidAttributes && hasChanges;\n  },\n\n  _onSaveClicked: function () {\n    if (this._canSave()) {\n      this._saveFeature();\n    }\n  },\n\n  _saveFeature: function () {\n    var self = this;\n\n    var op = this._featureModel.isNew() ? 'add' : 'save';\n    var ev = op + 'Feature';\n    this._featureModel.trigger(ev);\n\n    this._featureModel.save({\n      success: function () {\n        self._featureModel.trigger('saveFeatureSuccess', op);\n        self.model.set('hasChanges', false);\n      },\n      error: function () {\n        self._featureModel.trigger('saveFeatureFailed');\n      }\n    });\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<button class=\"CDB-Button CDB-Button--primary js-save ';\n if (isDisabled) { \n__p+='is-disabled';\n } \n__p+='\">\\n  <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-small u-upperCase\">\\n    '+\n((__t=( label ))==null?'':_.escape(__t))+\n'\\n  </span>\\n</button>';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar ColumnRowData = require('../../../data/column-row-data');\n\nvar FIELDTYPE_TO_FORMTYPE = {\n  string: 'Text',\n  boolean: 'Radio',\n  number: 'Number',\n  date: 'DateTime',\n  geometry: 'Text'\n};\n\nvar BLACKLISTED_COLUMNS = ['created_at', 'the_geom', 'the_geom_webmercator', 'updated_at'];\n\nmodule.exports = Backbone.Model.extend({\n\n  initialize: function (attrs, opts) {\n    if (!opts.featureModel) throw new Error('featureModel is required');\n    if (!opts.columnsCollection) throw new Error('columnsCollection is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.nodeDefModel) throw new Error('nodeDefModel is required');\n\n    this._featureModel = opts.featureModel;\n    this._columnsCollection = opts.columnsCollection;\n    this._configModel = opts.configModel;\n    this._nodeDefModel = opts.nodeDefModel;\n\n    this._generateSchema();\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this.bind('change', this._onChange, this);\n  },\n\n  _onChange: function () {\n    _.each(this.changed, function (val, key) {\n      this._featureModel.set(key, val);\n    }, this);\n  },\n\n  _getInputType: function (columnRowData) {\n    var rows = columnRowData.getRows();\n    return rows && rows.length ? 'Suggest' : 'Text';\n  },\n\n  _getSupportedColumnType: function (columnType) {\n    var supportedColumnType = _.find(_.keys(FIELDTYPE_TO_FORMTYPE), function (fieldType) {\n      return fieldType === columnType;\n    });\n\n    return supportedColumnType || 'string';\n  },\n\n  _generateSchema: function () {\n    var self = this;\n\n    this.schema = {};\n\n    this._columnsCollection.each(function (mdl) {\n      var columnName = mdl.get('name');\n      var columnType = this._getSupportedColumnType(mdl.get('type'));\n\n      if (!_.contains(BLACKLISTED_COLUMNS, columnName)) {\n        // default field type\n        this.schema[columnName] = {\n          type: FIELDTYPE_TO_FORMTYPE[columnType]\n        };\n\n        if (columnType === 'date') {\n          this.schema[columnName].dialogMode = 'float';\n        }\n\n        if (columnType === 'string') {\n          var columnRowData = new ColumnRowData({\n            column: columnName\n          }, {\n            nodeDefModel: this._nodeDefModel,\n            configModel: this._configModel\n          });\n          columnRowData.bind('columnsFetched', function (rows) {\n            var type = self._getInputType(this);\n            if (self.schema[columnName].type !== type) {\n              self.schema[columnName].type = type;\n              if (type === 'Suggest') {\n                self.schema[columnName].dialogMode = 'float';\n              }\n              self.schema[columnName].editorAttrs = {\n                showSearch: true,\n                allowFreeTextInput: true,\n                collectionData: rows\n              };\n\n              self._onChangeSchema();\n            }\n          });\n          columnRowData.fetch();\n        }\n\n        if (columnType === 'number') {\n          this.schema[columnName].isFormatted = true;\n          this.schema[columnName].showSlider = false;\n        }\n\n        if (columnType === 'boolean') {\n          this.schema[columnName].options = [\n            {\n              label: _t('form-components.editors.radio.true'),\n              val: true\n            }, {\n              label: _t('form-components.editors.radio.false'),\n              val: false\n            }, {\n              label: _t('form-components.editors.radio.null'),\n              val: null\n            }\n          ];\n        }\n\n        if (columnName === 'cartodb_id') {\n          this.schema[columnName].isFormatted = false;\n          this.schema[columnName].editorAttrs = {\n            disabled: true\n          };\n        }\n      }\n    }, this);\n  },\n\n  _onChangeSchema: function () {\n    this.trigger('changeSchema');\n  }\n\n});\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar template = require('./edit-feature-attributes-form.tpl');\n\nmodule.exports = CoreView.extend({\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template());\n\n    this._generateForms();\n\n    this.model.bind('changeSchema', this._generateForms, this);\n\n    return this;\n  },\n\n  _generateForms: function () {\n    var self = this;\n\n    if (this._formView) {\n      this._formView.remove();\n    }\n\n    this._formView = new Backbone.Form({\n      model: this.model\n    });\n\n    this._formView.bind('change', function () {\n      var validate = this.validate();\n      self.model.trigger('validate', !!validate);\n\n      if (!validate) {\n        this.commit();\n      }\n    });\n\n    this.$('.js-form').append(this._formView.render().$el);\n  },\n\n  clean: function () {\n    if (this._formView) {\n      this._formView.remove();\n    }\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-HeaderInfo\">\\n  <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">2</div>\\n\\n  <div class=\"Editor-HeaderInfo-inner CDB-Text\">\\n    <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n      <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.edit-feature.attributes') ))==null?'':_.escape(__t))+\n'</h2>\\n    </div>\\n    <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.edit-feature.attributes-columns') ))==null?'':_.escape(__t))+\n'</p>\\n    <div class=\"js-form\"></div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./edit-feature-control.tpl');\n\nmodule.exports = CoreView.extend({\n\n  render: function () {\n    this.$el.html(template());\n\n    return this;\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<button class=\"CDB-Button u-upperCase js-back\">\\n  <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-small u-actionTextColor\">'+\n((__t=( _t('editor.edit-feature.cancel') ))==null?'':_.escape(__t))+\n'</span>\\n</button>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\n\nmodule.exports = Backbone.Model.extend({\n\n  initialize: function (attrs, opts) {\n    if (!opts.featureModel) throw new Error('featureModel is required');\n\n    this._featureModel = opts.featureModel;\n\n    this._generateSchema();\n  },\n\n  _generateSchema: function () {\n    this.schema = {};\n\n    this.schema.the_geom = {\n      type: 'Text',\n      validators: ['required'],\n      editorAttrs: {\n        disabled: true\n      },\n      hasCopyButton: this._featureModel.has('the_geom')\n    };\n  }\n\n});\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar template = require('./edit-feature-geometry-form.tpl');\n\nmodule.exports = CoreView.extend({\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template());\n\n    this._generateForms();\n\n    return this;\n  },\n\n  _generateForms: function () {\n    if (this._formView) {\n      this._formView.remove();\n    }\n\n    this._formView = new Backbone.Form({\n      model: this.model\n    });\n\n    this._formView.bind('change', this._validateForm, this);\n\n    this.model.bind('updateFeature', function (attrs) {\n      _.each(attrs, function (value, key) {\n        this._formView.fields[key].editor.setValue(value);\n      }, this);\n      this._validateForm();\n    }, this);\n\n    this.$('.js-form').append(this._formView.render().$el);\n  },\n\n  _validateForm: function () {\n    var validate = this._formView.validate();\n    this.model.trigger('validate', !!validate);\n\n    if (!validate) {\n      this._formView.commit();\n    }\n  },\n\n  clean: function () {\n    if (this._formView) {\n      this._formView.remove();\n    }\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-HeaderInfo\">\\n  <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">1</div>\\n  <div class=\"Editor-HeaderInfo-inner CDB-Text\">\\n    <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n      <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.edit-feature.geometry') ))==null?'':_.escape(__t))+\n'</h2>\\n    </div>\\n    <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.edit-feature.geometry-edit') ))==null?'':_.escape(__t))+\n'</p>\\n    <div class=\"js-form\"></div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar EditFeatureGeometryFormModel = require('./edit-feature-geometry-form-model');\n\nvar formatCoordinate = function (coordinate) {\n  if (isValidCoordinate(coordinate)) {\n    return parseFloat(parseFloat(coordinate).toFixed(8));\n  }\n};\n\nvar isValidCoordinate = function (coordinate) {\n  return _.isNumber(coordinate) || _.isString(coordinate);\n};\n\nvar getCoordinatesFromGeoJSON = function (geoJSON) {\n  if (geoJSON && geoJSON.coordinates && geoJSON.coordinates.length === 2) {\n    return geoJSON.coordinates;\n  }\n};\n\nvar MIN_LAT = -90;\nvar MAX_LAT = 90;\n\nvar MIN_LNG = -180;\nvar MAX_LNG = 180;\n\nmodule.exports = EditFeatureGeometryFormModel.extend({\n\n  initialize: function () {\n    EditFeatureGeometryFormModel.prototype.initialize.apply(this, arguments);\n\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this.bind('change:lat', this._onLatLngChange, this);\n    this.bind('change:lng', this._onLatLngChange, this);\n  },\n\n  _onLatLngChange: function () {\n    var newGeoJSON = this._toGeoJSON();\n    var currentGeoJSON = {};\n\n    if (this._featureModel.get('the_geom')) {\n      currentGeoJSON = JSON.parse(this._featureModel.get('the_geom'));\n    }\n\n    // Only set `the_geom` if there's new geoJSON\n    if (!_.isEqual(newGeoJSON, currentGeoJSON)) {\n      this._featureModel.set('the_geom', JSON.stringify(newGeoJSON));\n    }\n  },\n\n  _toGeoJSON: function () {\n    var latitude = this._getLatitude();\n    var longitude = this._getLongitude();\n    if (isValidCoordinate(latitude) && isValidCoordinate(longitude)) {\n      return {\n        'type': 'Point',\n        'coordinates': [ longitude, latitude ]\n      };\n    }\n  },\n\n  _getLatitude: function () {\n    if (this.has('lat')) {\n      return formatCoordinate(this.get('lat'));\n    }\n\n    var geoJSON = JSON.parse(this._featureModel.get('the_geom'));\n    var geoJSONCoordinates = getCoordinatesFromGeoJSON(geoJSON);\n    var latitudeFromGeoJSON = geoJSONCoordinates && geoJSONCoordinates[1];\n    if (latitudeFromGeoJSON) {\n      return formatCoordinate(latitudeFromGeoJSON);\n    }\n  },\n\n  _getLongitude: function () {\n    if (this.has('lng')) {\n      return formatCoordinate(this.get('lng'));\n    }\n\n    var geoJSON = JSON.parse(this._featureModel.get('the_geom'));\n    var geoJSONCoordinates = getCoordinatesFromGeoJSON(geoJSON);\n    var longitudeFromGeoJSON = geoJSONCoordinates && geoJSONCoordinates[1];\n    if (longitudeFromGeoJSON) {\n      return formatCoordinate(longitudeFromGeoJSON);\n    }\n  },\n\n  _validateLatitude: function (value, formValues) {\n    var numericValue = +value;\n\n    var error = {\n      type: 'lat',\n      message: _t('editor.edit-feature.valid-lat')\n    };\n\n    if (_.isNumber(numericValue) && numericValue >= MIN_LAT && numericValue <= MAX_LAT) {\n      return null; // valid latitude\n    }\n\n    if (_.isNumber(numericValue) && (numericValue > MAX_LAT || numericValue < MIN_LAT)) {\n      error.message = _t('editor.edit-feature.out-of-bounds-lat');\n    }\n\n    return error;\n  },\n\n  _validateLongitude: function (value, formValues) {\n    var numericValue = +value;\n\n    var error = {\n      type: 'lng',\n      message: _t('editor.edit-feature.valid-lng')\n    };\n\n    if (_.isNumber(numericValue) && numericValue >= MIN_LNG && numericValue <= MAX_LNG) {\n      return null; // valid longitude\n    }\n\n    if (_.isNumber(numericValue) && (numericValue > MAX_LNG || numericValue < MIN_LNG)) {\n      error.message = _t('editor.edit-feature.out-of-bounds-lng');\n    }\n\n    return error;\n  },\n\n  _generateSchema: function () {\n    this.schema = {};\n\n    this.schema.lng = {\n      type: 'Number',\n      validators: ['required', this._validateLongitude],\n      showSlider: false\n    };\n\n    this.schema.lat = {\n      type: 'Number',\n      validators: ['required', this._validateLatitude],\n      showSlider: false\n    };\n  }\n\n});\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./edit-feature-header.tpl');\nvar ContextMenuFactory = require('../../../components/context-menu-factory-view');\nvar ConfirmationView = require('../../../components/modals/confirmation/modal-confirmation-view');\nvar templateConfirmation = require('./delete-feature-confirmation.tpl');\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    if (!opts.url) throw new Error('url is required');\n    if (!opts.tableName) throw new Error('tableName is required');\n    if (!opts.modals) throw new Error('modals is required');\n    if (opts.isNew === undefined) throw new Error('isNew is required');\n    if (!opts.backAction) throw new Error('backAction is required');\n\n    this._url = opts.url;\n    this._tableName = opts.tableName;\n    this._modals = opts.modals;\n    this._isNew = opts.isNew;\n    this._backAction = opts.backAction;\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    var featureType = this.model.getFeatureType();\n\n    this.$el.html(\n      template({\n        url: this._url,\n        tableName: this._tableName,\n        featureType: featureType ? _t('editor.edit-feature.features.' + featureType) : _t('editor.edit-feature.features.geometry')\n      })\n    );\n\n    if (!this._isNew) {\n      this._initViews();\n    }\n\n    return this;\n  },\n\n  _initViews: function () {\n    var menuItems = [{\n      label: _t('editor.edit-feature.delete', { featureType: _t('editor.edit-feature.features.' + this.model.getFeatureType()) }),\n      val: 'delete-feature',\n      destructive: true,\n      action: this._confirmDeleteFeature.bind(this)\n    }];\n\n    this._contextMenuFactory = new ContextMenuFactory({\n      menuItems: menuItems\n    });\n\n    this.$('.js-context-menu').append(this._contextMenuFactory.render().el);\n    this.addView(this._contextMenuFactory);\n  },\n\n  _confirmDeleteFeature: function () {\n    var self = this;\n\n    this._modals.create(function (modalModel) {\n      return new ConfirmationView({\n        modalModel: modalModel,\n        template: templateConfirmation,\n        runAction: self._destroyFeature.bind(self)\n      });\n    });\n  },\n\n  _destroyFeature: function () {\n    var self = this;\n\n    this.model.trigger('destroyFeature');\n\n    this.model.destroy({\n      success: function () {\n        self.model.trigger('destroyFeatureSuccess');\n        self._backAction();\n      },\n      error: function () {\n        self.model.trigger('destroyFeatureFailed');\n      }\n    });\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-HeaderInfoEditor\">\\n  <div class=\"u-rSpace--xl u-actionTextColor js-back Editor-HeaderInfoEditorShape\">\\n    <button>\\n      <i class=\"CDB-IconFont CDB-IconFont-arrowPrev Size-large\"></i>\\n    </button>\\n  </div>\\n\\n  <div class=\"Editor-HeaderInfo-inner u-ellipsis\">\\n    <div class=\"Editor-HeaderInfo-title u-bSpace\">\\n      <h2 class=\"Inline-editor\">\\n        <div class=\"CDB-Text CDB-Size-huge is-light u-ellipsis\">'+\n((__t=( _t('editor.edit-feature.edit', { featureType: featureType }) ))==null?'':_.escape(__t))+\n'</div>\\n      </h2>\\n    </div>\\n    <div class=\"u-flex u-ellipsis\">\\n      <p class=\"Editor-headerLayerName CDB-Text CDB-Size-medium u-ellipsis\">\\n        <a href=\"'+\n((__t=( url ))==null?'':_.escape(__t))+\n'\" target=\"_blank\" title=\"'+\n((__t=( tableName ))==null?'':_.escape(__t))+\n'\" class=\"Editor-headerLayerName\">'+\n((__t=( tableName ))==null?'':_.escape(__t))+\n'</a>\\n      </p>\\n    </div>\\n  </div>\\n  <div class=\"u-flex u-tSpace-xl js-context-menu\"></div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar EditFeatureGeometryFormView = require('./edit-feature-geometry-form-view');\nvar EditFeatureAttributesFormView = require('./edit-feature-attributes-form-view');\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    if (!opts.featureModel) throw new Error('featureModel is required');\n    if (!opts.geometryFormModel) throw new Error('geometryFormModel is required');\n    if (!opts.attributesFormModel) throw new Error('attributesFormModel is required');\n\n    this._featureModel = opts.featureModel;\n    this._geometryFormModel = opts.geometryFormModel;\n    this._attributesFormModel = opts.attributesFormModel;\n  },\n\n  render: function () {\n    if (this._editFeatureGeometryFormView) {\n      this._editFeatureGeometryFormView.clean();\n    }\n\n    if (this._editFeatureAttributesFormView) {\n      this._editFeatureAttributesFormView.clean();\n    }\n\n    this.clearSubViews();\n\n    this.$el.empty();\n\n    this._editFeatureGeometryFormView = new EditFeatureGeometryFormView({\n      model: this._geometryFormModel\n    });\n\n    this.addView(this._editFeatureGeometryFormView);\n    this.$el.append(this._editFeatureGeometryFormView.render().el);\n\n    this._editFeatureAttributesFormView = new EditFeatureAttributesFormView({\n      model: this._attributesFormModel\n    });\n\n    this.addView(this._editFeatureAttributesFormView);\n    this.$el.append(this._editFeatureAttributesFormView.render().el);\n\n    return this;\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"js-editFeatureHeader\"></div>\\n<div class=\"Editor-content js-editFeatureContent\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<h2 class=\"Editor-HeaderInfo-titleText Inline-editor\" title=\"'+\n((__t=( alias ))==null?'':_.escape(__t))+\n'\">\\n  <div class=\"CDB-Text CDB-Size-huge is-light u-ellipsis js-title Inline-editor-text\">'+\n((__t=( alias ))==null?'':_.escape(__t))+\n'</div>\\n  <input type=\"text\" name=\"text\" class=\"Inline-editor-input Inline-editor-input--small CDB-Text CDB-InputText js-input\" value=\"'+\n((__t=( alias ))==null?'':_.escape(__t))+\n'\" readonly>\\n</h2>';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar LayerAnalysisDraggableView = require('./layer-analysis-draggable-view');\n\n/**\n * View of analyses within a layer\n * this.model is the layer-definition-model\n */\nmodule.exports = CoreView.extend({\n\n  tagName: 'ul',\n\n  options: {\n    sortableSelector: ''\n  },\n\n  initialize: function (opts) {\n    if (!this.options.sortableSelector) throw new Error('sortableSelector is required');\n    if (!opts.layerAnalysisViewFactory) throw new Error('layerAnalysisViewFactory is required');\n\n    this._layerAnalysisViewFactory = opts.layerAnalysisViewFactory;\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    var nodeDefModel = this.model.getAnalysisDefinitionNodeModel();\n    this._renderNode(nodeDefModel);\n\n    return this;\n  },\n\n  /**\n   * @param {Object} current instance of a analysis-layer-node-model\n   */\n  _renderNode: function (current) {\n    this._createNodeView(current);\n\n    var next = current.getPrimarySource();\n    if (next && this.model.isOwnerOfAnalysisNode(current)) {\n      this._renderNode(next);\n    }\n  },\n\n  _createNodeView: function (current) {\n    var view = this._layerAnalysisViewFactory.createView(current, this.model);\n    this.addView(view);\n    this.$el.append(view.render().el);\n    this._attachDraggableToNodeView(view, current);\n  },\n\n  _attachDraggableToNodeView: function (nodeView, nodeDefModel) {\n    if (!this.model.isOwnerOfAnalysisNode(nodeDefModel)) return;\n\n    var draggableView = new LayerAnalysisDraggableView({\n      model: nodeDefModel,\n      getNextLetter: this.model.collection.nextLetter.bind(this.model.collection),\n      $nodeViewElement: nodeView.$el,\n      sortableSelector: this.options.sortableSelector\n    });\n    this.addView(draggableView);\n  }\n\n});\n",
    "require('jquery-ui');\nvar CoreView = require('backbone/core-view');\nvar template = require('./layer-analysis-draggable.tpl');\nvar analyses = require('../../data/analyses');\nvar layerColors = require('../../data/layer-colors');\n\n/**\n * Attach draggable behavior to an analysis node\n * Implemented as a view to hook into Backbone's lifecycle handling, but really it's just attaching the behavior to the\n * provided $nodeViewElement\n */\nmodule.exports = CoreView.extend({\n  options: {\n    getNextLetter: function () { return 'x'; },\n    sortableSelector: '',\n    $nodeViewElement: null\n  },\n\n  initialize: function () {\n    if (!this.options.sortableSelector) throw new Error('sortableSelector is required');\n    if (!this.options.$nodeViewElement) throw new Error('$nodeViewElement is required');\n\n    this.options.$nodeViewElement.draggable({\n      appendTo: this.options.sortableSelector,\n      connectToSortable: this.options.sortableSelector,\n      cursor: 'move',\n      axis: 'y',\n      cursorAt: { top: 40 },\n      helper: this._createHelper.bind(this)\n    });\n  },\n\n  _createHelper: function () {\n    var nextLetter = this.options.getNextLetter();\n    return template({\n      nodeId: this.model.id,\n      nextLetter: nextLetter,\n      nextBgColor: layerColors.getColorForLetter(nextLetter),\n      title: analyses.title(this.model)\n    });\n  },\n\n  clean: function () {\n    if (this.options.$nodeViewElement && this.options.$nodeViewElement.data('ui-draggable')) {\n      this.options.$nodeViewElement.draggable('destroy');\n    }\n\n    this.options.$nodeViewElement = null; // remove DOM reference to avoid memory leak\n    CoreView.prototype.clean.apply(this, arguments);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<li class=\"Editor-newLayerContainer\" data-analysis-node-id=\"'+\n((__t=( nodeId ))==null?'':_.escape(__t))+\n'\" style=\"width: 294px;\">\\n  <div class=\"Editor-ListLayer-item\">\\n    <div class=\"Editor-ListLayer-itemHeader\">\\n      <div class=\"Editor-ListLayer-media u-rSpace--m\" style=\"background: '+\n((__t=( nextBgColor ))==null?'':_.escape(__t))+\n'; color: #fff\">\\n        <p class=\"CDB-Text CDB-Size-large is-semibold u-upperCase\">'+\n((__t=( nextLetter ))==null?'':_.escape(__t))+\n'</p>\\n      </div>\\n      <div class=\"Editor-ListLayer-inner\">\\n        <div class=\"Editor-ListLayer-title\">\\n          <h2 class=\"Editor-ListLayer-titleText CDB-Text CDB-Size-large u-ellipsis\">'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</h2>\\n        </div>\\n        <button class=\"CDB-Text CDB-Size-small u-actionTextColor u-upperCase\">'+\n((__t=( _t('editor.layers.layer.add-analysis') ))==null?'':_.escape(__t))+\n'</button>\\n      </div>\\n    </div>\\n  </div>\\n  <div class=\"Editor-layerInfo CDB-Text CDB-Size-small u-whiteTextColor\">\\n    Created new layer based on ['+\n((__t=( nodeId ))==null?'':_.escape(__t))+\n']\\n  </div>\\n</li>\\n';\n}\nreturn __p;\n};\n",
    "var RefLayerAnalysisView = require('./analysis-views/ref-layer-analysis-view');\nvar DefaultLayerAnalysisView = require('./analysis-views/default-layer-analysis-view');\nvar SourceLayerAnalysisView = require('./analysis-views/source-layer-analysis-view');\nvar CompositeLayerAnalysisView = require('./analysis-views/composite-layer-analysis-view');\n\nvar LayerAnalysisViewFactory = function (analysisDefinitionNodesCollection) {\n  this._analysisDefinitionNodesCollection = analysisDefinitionNodesCollection;\n};\n\n/**\n * @param {Object} nodeDefModel - an analysis-definition-node-model\n * @param {Object} layerDefinitionModel\n * @param {String} [tagName = 'li']\n * @return {Object} instance of CoreView\n * @throws {Error} if node model can not be found, or view can not be found for the given mode\n */\nLayerAnalysisViewFactory.prototype.createView = function (nodeDefModel, layerDefinitionModel) {\n  if (!nodeDefModel) throw new Error('nodeDefModel is required');\n  if (!layerDefinitionModel) throw new Error('layerDefinitionModel is required');\n\n  var analysisNode = this._analysisDefinitionNodesCollection.get(nodeDefModel.id);\n  var sourcesCount = nodeDefModel.sourceIds().length;\n\n  var ownerLayer = layerDefinitionModel.collection.findOwnerOfAnalysisNode(nodeDefModel);\n  if (ownerLayer !== layerDefinitionModel) {\n    sourcesCount = null; // to force default ref view\n  }\n\n  switch (sourcesCount) {\n    case 2:\n      return new CompositeLayerAnalysisView({\n        model: nodeDefModel,\n        analysisDefinitionNodesCollection: this._analysisDefinitionNodesCollection,\n        layerDefinitionModel: layerDefinitionModel\n      });\n    case 0:\n      return new SourceLayerAnalysisView({\n        model: nodeDefModel,\n        analysisNode: analysisNode,\n        layerDefinitionModel: layerDefinitionModel\n      });\n    case 1:\n      return new DefaultLayerAnalysisView({\n        model: nodeDefModel,\n        analysisNode: analysisNode,\n        layerDefinitionModel: layerDefinitionModel\n      });\n    default:\n      return new RefLayerAnalysisView({\n        model: nodeDefModel,\n        analysisNode: analysisNode,\n        layerDefinitionModel: ownerLayer || layerDefinitionModel // use same layer model as fallback\n      });\n  }\n};\n\nmodule.exports = LayerAnalysisViewFactory;\n",
    "var _ = require('underscore');\nvar $ = require('jquery');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar createTextLabelsTabPane = require('../../components/tab-pane/create-text-labels-tab-pane');\nvar TabPaneTemplate = require('./layer-tab-pane.tpl');\nvar LayerHeaderView = require('./layer-header-view.js');\nvar LayerContentAnalysesView = require('./layer-content-views/analyses/analyses-view');\nvar StyleView = require('../style/style-view');\nvar InfowindowsView = require('./layer-content-views/infowindow/infowindows-view');\nvar TablesCollection = require('../../data/tables-collection');\nvar AnalysisSourceOptionsModel = require('./layer-content-views/analyses/analysis-source-options-model');\nvar AnalysisFormsCollection = require('./layer-content-views/analyses/analysis-forms-collection');\nvar TableManager = require('../../components/table/table-manager');\nvar changeViewButtons = require('./change-view-buttons.tpl');\nvar DataView = require('./layer-content-views/data/data-view');\nvar LegendsView = require('./layer-content-views/legend/legends-view');\nvar FeatureDefinitionModel = require('../../data/feature-definition-model');\nvar AnalysesService = require('./layer-content-views/analyses/analyses-service');\nvar checkAndBuildOpts = require('../../helpers/required-opts');\nvar TipsyTooltipView = require('../../components/tipsy-tooltip-view');\n\nvar REQUIRED_OPTS = [\n  'userActions',\n  'analysisDefinitionNodesCollection',\n  'layerDefinitionsCollection',\n  'layerDefinitionModel',\n  'widgetDefinitionsCollection',\n  'legendDefinitionsCollection',\n  'stackLayoutModel',\n  'modals',\n  'onboardings',\n  'configModel',\n  'editorModel',\n  'userModel',\n  'mapDefinitionModel',\n  'mapModeModel',\n  'visDefinitionModel',\n  'stateDefinitionModel',\n  'onboardingNotification'\n];\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-back': '_onClickBack',\n    'click .js-fix-sql': '_onClickFixSQL'\n  },\n\n  options: {\n    selectedTabItem: null,\n    analysisPayload: null // id or a new analysis node attrs (may not be complete)\n  },\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    this.model = new Backbone.Model({\n      context: 'map' // map or table\n    });\n\n    this._styleViewId = null;\n\n    AnalysesService.setLayerId(this._layerDefinitionModel.get('id'));\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this._unbindEvents();\n    this.clearSubViews();\n    this._destroyTable();\n    this.$el.empty();\n\n    var self = this;\n    var selectedTabItem = this.options.selectedTabItem;\n    var analysisPayload = this.options.analysisPayload;\n    var analysisDefinitionNodeModel = this._getAnalysisDefinitionNodeModel();\n    var tableNodeModel = analysisDefinitionNodeModel.isSourceType() && analysisDefinitionNodeModel.getTableModel();\n\n    var tabPaneTabs = [{\n      label: _t('editor.layers.menu-tab-pane-labels.data'),\n      name: 'data',\n      selected: (!selectedTabItem || selectedTabItem === 'data'),\n      createContentView: function () {\n        return new DataView({\n          className: 'Editor-content',\n          widgetDefinitionsCollection: self._widgetDefinitionsCollection,\n          layerDefinitionModel: self._layerDefinitionModel,\n          stackLayoutModel: self._stackLayoutModel,\n          userActions: self._userActions,\n          configModel: self._configModel,\n          editorModel: self._editorModel,\n          userModel: self._userModel,\n          onboardings: self._onboardings,\n          onboardingNotification: self._onboardingNotification\n        });\n      }\n    }, {\n      label: _t('editor.layers.menu-tab-pane-labels.analyses'),\n      name: 'analyses',\n      selected: (selectedTabItem && selectedTabItem === 'analyses') && !!analysisPayload,\n      createContentView: function () {\n        var analysisSourceOptionsModel = new AnalysisSourceOptionsModel(null, {\n          analysisDefinitionNodesCollection: self._analysisDefinitionNodesCollection,\n          layerDefinitionsCollection: self._layerDefinitionsCollection,\n          tablesCollection: new TablesCollection(null, {\n            configModel: self._configModel\n          })\n        });\n        analysisSourceOptionsModel.fetch();\n\n        var analysisFormsCollection = new AnalysisFormsCollection(null, {\n          userActions: self._userActions,\n          configModel: self._configModel,\n          layerDefinitionModel: self._layerDefinitionModel,\n          analysisSourceOptionsModel: analysisSourceOptionsModel\n        });\n        analysisFormsCollection.resetByLayerDefinition();\n\n        // e.g. when selected from layers view\n        var selectedNodeId;\n        if (_.isString(analysisPayload)) {\n          selectedNodeId = analysisPayload;\n        } else if (_.isObject(analysisPayload)) {\n          // payload passed after continue when an option was selected in add-analysis-view\n          selectedNodeId = analysisPayload.id;\n          analysisFormsCollection.addHead(analysisPayload);\n        } else {\n          selectedNodeId = self._layerDefinitionModel.get('source');\n        }\n\n        // remove payload once we have used it, to not have it being invoked again when switching tabs\n        selectedTabItem = null;\n        analysisPayload = null;\n\n        return new LayerContentAnalysesView({\n          className: 'Editor-content',\n          userActions: self._userActions,\n          analysisDefinitionNodesCollection: self._analysisDefinitionNodesCollection,\n          editorModel: self._editorModel,\n          userModel: self._userModel,\n          analysisFormsCollection: analysisFormsCollection,\n          configModel: self._configModel,\n          layerDefinitionModel: self._layerDefinitionModel,\n          stackLayoutModel: self._stackLayoutModel,\n          selectedNodeId: selectedNodeId,\n          onboardings: self._onboardings,\n          onboardingNotification: self._onboardingNotification\n        });\n      }\n    }, {\n      label: _t('editor.layers.menu-tab-pane-labels.style'),\n      name: 'style',\n      selected: selectedTabItem && selectedTabItem === 'style',\n      createContentView: function () {\n        // remove payload once we have used it, to not have it being invoked again when switching tabs\n        selectedTabItem = null;\n\n        var styleView = new StyleView({\n          className: 'Editor-content',\n          configModel: self._configModel,\n          userModel: self._userModel,\n          userActions: self._userActions,\n          analysisDefinitionsCollection: self.analysisDefinitionsCollection,\n          queryGeometryModel: self._getQueryGeometryModel(),\n          querySchemaModel: self._getQuerySchemaModel(),\n          queryRowsCollection: self._getQueryRowsCollection(),\n          layerDefinitionsCollection: self._layerDefinitionsCollection,\n          layerDefinitionModel: self._layerDefinitionModel,\n          editorModel: self._editorModel,\n          modals: self._modals,\n          onboardings: self._onboardings,\n          onboardingNotification: self._onboardingNotification\n        });\n\n        self._styleViewId = styleView.cid;\n        return styleView;\n      }\n    }, {\n      label: _t('editor.layers.menu-tab-pane-labels.infowindow'),\n      name: 'infowindow',\n      createContentView: function () {\n        var nodeDefModel = self._layerDefinitionModel.getAnalysisDefinitionNodeModel();\n        return new InfowindowsView({\n          className: 'Editor-content',\n          userActions: self._userActions,\n          layerDefinitionModel: self._layerDefinitionModel,\n          queryGeometryModel: nodeDefModel.queryGeometryModel,\n          querySchemaModel: nodeDefModel.querySchemaModel,\n          queryRowsCollection: nodeDefModel.queryRowsCollection,\n          configModel: self._configModel,\n          editorModel: self._editorModel\n        });\n      }\n    }, {\n      label: _t('editor.layers.menu-tab-pane-labels.legends'),\n      name: 'legends',\n      createContentView: function () {\n        var nodeDefModel = self._layerDefinitionModel.getAnalysisDefinitionNodeModel();\n        return new LegendsView({\n          className: 'Editor-content',\n          mapDefinitionModel: self._mapDefinitionModel,\n          userActions: self._userActions,\n          layerDefinitionModel: self._layerDefinitionModel,\n          queryGeometryModel: nodeDefModel.queryGeometryModel,\n          querySchemaModel: nodeDefModel.querySchemaModel,\n          queryRowsCollection: nodeDefModel.queryRowsCollection,\n          legendDefinitionsCollection: self._legendDefinitionsCollection,\n          editorModel: self._editorModel,\n          userModel: self._userModel,\n          configModel: self._configModel,\n          modals: self._modals\n        });\n      }\n    }];\n\n    var layerHeaderView = new LayerHeaderView({\n      layerDefinitionsCollection: this._layerDefinitionsCollection,\n      layerDefinitionModel: this._layerDefinitionModel,\n      userActions: this._userActions,\n      configModel: this._configModel,\n      modals: this._modals,\n      tableNodeModel: tableNodeModel,\n      editorModel: this._editorModel,\n      stateDefinitionModel: this._stateDefinitionModel,\n      visDefinitionModel: this._visDefinitionModel,\n      userModel: this._userModel,\n      widgetDefinitionsCollection: this._widgetDefinitionsCollection\n    });\n\n    this.addView(layerHeaderView);\n    this.$el.append(layerHeaderView.render().$el);\n\n    var tabPaneOptions = {\n      tabPaneOptions: {\n        template: TabPaneTemplate,\n        tabPaneItemOptions: {\n          tagName: 'li',\n          className: 'CDB-NavMenu-item'\n        }\n      },\n      tabPaneItemLabelOptions: {\n        tagName: 'button',\n        className: 'CDB-NavMenu-link u-upperCase'\n      }\n    };\n\n    this._layerTabPaneView = createTextLabelsTabPane(tabPaneTabs, tabPaneOptions);\n    this._bindEvents();\n    this.$el.append(this._layerTabPaneView.render().el);\n    this.addView(this._layerTabPaneView);\n\n    this._layerTabPaneView.$el.addClass('js-editorPanelContent');\n    this._renderContextButtons();\n\n    return this;\n  },\n\n  _initBinds: function () {\n    this.listenTo(this.model, 'change:context', this._renderContextButtons);\n\n    this.listenTo(this._layerDefinitionModel, 'remove', this._onClickBack);\n    this.listenTo(this._layerDefinitionModel, 'change:source', function () {\n      if (this.model.get('context') === 'table') {\n        this._initTable();\n      }\n\n      this._renderContextButtons();\n    }.bind(this));\n    this.listenTo(this._layerDefinitionModel, 'change:visible', this._renderContextButtons);\n\n    this.listenTo(this._editorModel, 'change:edition', this._changeStyle);\n\n    this.listenTo(this._widgetDefinitionsCollection, 'add remove', this._renderContextButtons);\n\n    this.listenTo(this._getQuerySchemaModel(), 'change:query', this._renderContextButtons);\n\n    this.listenTo(this._onboardings, 'style', function () {\n      this._layerTabPaneView.collection.select('name', 'style');\n    });\n\n    // Fetch geometry type if there isn't one yet\n    var queryGeometryModel = this._getQueryGeometryModel();\n    if (queryGeometryModel.shouldFetch()) {\n      queryGeometryModel.once('change:simple_geom', function (mdl, simpleGeom) {\n        // Reset styles form in order to prevent a sync problem with styles\n        if (mdl.hasValue()) {\n          this._layerDefinitionModel.styleModel.setDefaultPropertiesByType('simple', simpleGeom, true);\n          this.render();\n        }\n        this._renderContextButtons();\n      }, this);\n      this.add_related_model(queryGeometryModel);\n      queryGeometryModel.fetch();\n    }\n  },\n\n  _destroyTable: function () {\n    if (this._tableView) {\n      TableManager.destroy(this._tableView);\n      delete this._tableView;\n    }\n  },\n\n  _initTable: function () {\n    if (this._tableView) {\n      this._destroyTable();\n    }\n\n    this._tableView = TableManager.create({\n      analysisDefinitionNodeModel: this._getAnalysisDefinitionNodeModel(),\n      configModel: this._configModel,\n      modals: this._modals,\n      userModel: this._userModel\n    });\n\n    $('.js-editor .CDB-Dashboard-canvas').append(this._tableView.render().el);\n  },\n\n  _renderContextButtons: function () {\n    this._destroyContextButtons();\n\n    var analysisDefinitionNodeModel = this._getAnalysisDefinitionNodeModel();\n    var isReadOnly = analysisDefinitionNodeModel.isReadOnly();\n    var isVisible = this._layerDefinitionModel.get('visible');\n    var queryGeometryModel = this._getQueryGeometryModel();\n\n    $('.CDB-Dashboard-canvas').append(\n      changeViewButtons({\n        context: this.model.get('context'),\n        isThereOtherWidgets: this._widgetDefinitionsCollection.isThereOtherWidgets(),\n        isThereTimeSeries: this._widgetDefinitionsCollection.isThereTimeSeries(),\n        isThereAnimatedTimeSeries: this._widgetDefinitionsCollection.isThereTimeSeries({ animated: true }),\n        queryGeometryModel: queryGeometryModel.get('simple_geom'),\n        isSourceType: analysisDefinitionNodeModel.isSourceType(),\n        isVisible: isVisible,\n        isReadOnly: isReadOnly\n      })\n    );\n    $('.js-showMap').bind('click', this._onMapClick.bind(this));\n    $('.js-showTable').bind('click', this._onTableClick.bind(this));\n    $('.js-newGeometry').bind('click', this._onClickNewGeometry.bind(this));\n\n    if (isReadOnly || !isVisible) {\n      var tooltip = new TipsyTooltipView({\n        el: $('.js-newGeometryView'),\n        title: function () {\n          return $(this).data('tooltip');\n        }\n      });\n      this.addView(tooltip);\n    }\n  },\n\n  _destroyContextButtons: function () {\n    $('.js-mapTableView').remove();\n    $('.js-newGeometryView').remove();\n  },\n\n  _onMapClick: function (ev) {\n    var currentContext = this.model.get('context');\n    if (currentContext !== 'map') {\n      this._destroyTable();\n      this.model.set('context', 'map');\n    }\n  },\n\n  _onTableClick: function (ev) {\n    var currentContext = this.model.get('context');\n    if (currentContext !== 'table') {\n      this._initTable();\n      this.model.set('context', 'table');\n    }\n  },\n\n  _unbindEvents: function () {\n    if (this._layerTabPaneView && this._layerTabPaneView.collection) {\n      this._layerTabPaneView.collection.off('change:selected', this._quitEditing, this);\n    }\n  },\n\n  _bindEvents: function () {\n    this._layerTabPaneView.collection.on('change:selected', this._quitEditing, this);\n    this.add_related_model(this._layerTabPaneView.collection);\n  },\n\n  _onClickBack: function () {\n    this._editorModel.set({ edition: false });\n    this._stackLayoutModel.prevStep('layers');\n  },\n\n  _onClickNewGeometry: function (ev) {\n    var $target = $(ev.target).closest('.js-newGeometry');\n    var featureType = $target.data('feature-type');\n\n    if ($target.closest('.js-newGeometryItem').hasClass('is-disabled')) return false;\n\n    var editOverlayText = _t('editor.edit-feature.overlay-text', { featureType: _t('editor.edit-feature.features.' + featureType) });\n\n    $('.js-editOverlay-text').html(editOverlayText);\n    $('.js-editOverlay').fadeIn(200, function () {\n      $('.js-editOverlay').removeClass('is-hidden');\n    });\n\n    var feature = this._newFeatureDefinitionModel({ featureType: featureType });\n    this._mapModeModel.enterDrawingFeatureMode(feature);\n  },\n\n  _newFeatureDefinitionModel: function (opts) {\n    return new FeatureDefinitionModel({}, {\n      configModel: this._configModel,\n      layerDefinitionModel: this._layerDefinitionModel,\n      userModel: this._userModel,\n      featureType: opts.featureType\n    });\n  },\n\n  _onClickFixSQL: function () {\n    this._editorModel.set({edition: false}, {silent: true});\n    this._layerTabPaneView.getTabPane('data').set({selected: true});\n  },\n\n  _changeStyle: function () {\n    this._layerTabPaneView.changeStyleMenu(this._editorModel);\n  },\n\n  _quitEditing: function () {\n    if (this._layerTabPaneView.getSelectedTabPaneName() !== 'style' &&\n        this._layerTabPaneView.getSelectedTabPaneName() !== 'infowindow' &&\n        this._layerTabPaneView.getSelectedTabPaneName() !== 'legends') {\n      this._editorModel.set({ edition: false });\n    }\n  },\n\n  _getAnalysisDefinitionNodeModel: function () {\n    return this._layerDefinitionModel.getAnalysisDefinitionNodeModel();\n  },\n\n  _getQueryGeometryModel: function () {\n    return this._getAnalysisDefinitionNodeModel().queryGeometryModel;\n  },\n\n  _getQuerySchemaModel: function () {\n    return this._getAnalysisDefinitionNodeModel().querySchemaModel;\n  },\n\n  _getQueryRowsCollection: function () {\n    return this._getAnalysisDefinitionNodeModel().queryRowsCollection;\n  },\n\n  clean: function () {\n    this._destroyContextButtons();\n    this._destroyTable();\n    CoreView.prototype.clean.apply(this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<h2 class=\"CDB-Text CDB-Size-huge is-light u-secondaryTextColor\">'+\n((__t=( _t('editor.layers.analysis-form.placeholder-text') ))==null?'':_.escape(__t))+\n'</h2>\\n<div class=\"BlockList-item is-dashed no-hover is-space u-tSpace-xl\">\\n  <ul class=\"HorizontalBlockList\">\\n    <li class=\"HorizontalBlockList-item\"></li>\\n    <li class=\"HorizontalBlockList-item\"></li>\\n  </ul>\\n\\n  <button class=\"CDB-Button CDB-Button--primary js-add-analysis\">\\n    <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">'+\n((__t=( _t('editor.layers.layer.add-analysis') ))==null?'':_.escape(__t))+\n'</span>\\n  </button>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar $ = require('jquery');\nvar cdb = require('cartodb.js');\nvar errorParse = require('../../../../../helpers/error-parser');\n\nvar ENOUGH_QUOTA_QUERY = _.template(\"select cdb_dataservices_client.cdb_enough_quota('<%= analysis %>', <%= rows %>);\");\n\nmodule.exports = {\n  init: function (configModel) {\n    this.SQL = new cdb.SQL({\n      user: configModel.get('user_name'),\n      sql_api_template: configModel.get('sql_api_template'),\n      api_key: configModel.get('api_key')\n    });\n  },\n\n  fetch: function (service, rows) {\n    var query = ENOUGH_QUOTA_QUERY({\n      analysis: service,\n      rows: rows\n    });\n\n    if (!this.deferred || this.deferred.state() !== 'pending') {\n      var deferred = $.Deferred();\n      this.deferred = deferred;\n\n      var errorCallback = function (err) {\n        deferred.reject(errorParse(err));\n      };\n\n      var successCallback = function (data) {\n        // response is something like:\n        // {\"rows\":[{\"cdb_enough_quota\":false}],\"time\":0.024,\"fields\":{\"cdb_enough_quota\":{\"type\":\"boolean\"}},\"total_rows\":1}\n        deferred.resolve(data.rows[0].cdb_enough_quota);\n      };\n\n      this.SQL.execute(query, null, {\n        success: successCallback,\n        error: errorCallback\n      });\n    }\n\n    return this.deferred.promise();\n  }\n};\n",
    "var _ = require('underscore');\nvar $ = require('jquery');\nvar cdb = require('cartodb.js');\nvar errorParse = require('../../../../../helpers/error-parser');\n\nvar ESTIMATION_QUOTA_QUERY = _.template('SELECT CDB_EstimateRowCount($$<%= query %>;$$)  AS row_count;');\n\nmodule.exports = {\n  init: function (configModel) {\n    this.SQL = new cdb.SQL({\n      user: configModel.get('user_name'),\n      sql_api_template: configModel.get('sql_api_template'),\n      api_key: configModel.get('api_key')\n    });\n  },\n\n  fetch: function (query) {\n    var estimationQuery = ESTIMATION_QUOTA_QUERY({\n      query: query\n    });\n\n    if (!this.deferred || this.deferred.state() !== 'pending') {\n      var deferred = $.Deferred();\n      this.deferred = deferred;\n\n      var parseResponse = function (response) {\n        return response.rows[0].row_count;\n      };\n\n      var errorCallback = function (err) {\n        deferred.reject(errorParse(err));\n      };\n\n      var successCallback = function (data) {\n        deferred.resolve(parseResponse(data));\n      };\n\n      this.SQL.execute(estimationQuery, null, {\n        success: successCallback,\n        error: errorCallback\n      });\n    }\n\n    return this.deferred.promise();\n  }\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar cdb = require('cartodb.js');\nvar errorParse = require('../../../../../helpers/error-parser');\n\nvar SERVICE_QUOTA_QUERY = 'select * from cdb_dataservices_client.cdb_service_quota_info();';\n\nvar QuotaInfo = Backbone.Collection.extend({\n  initialize: function (models, options) {\n    if (!options || !options.configModel) throw new Error('configModel is required');\n\n    var configModel = options.configModel;\n    this.SQL = new cdb.SQL({\n      user: configModel.get('user_name'),\n      sql_api_template: configModel.get('sql_api_template'),\n      api_key: configModel.get('api_key')\n    });\n\n    this._state = 'unfetched';\n    this._ready = 'notready';\n  },\n\n  fetch: function (options) {\n    this._success = options && options.success;\n    this._error = options && options.error;\n\n    if (!this.isFetching()) {\n      this._state = 'fetching';\n      this.SQL.execute(SERVICE_QUOTA_QUERY, null, {\n        success: function (data) {\n          this._state = 'fetched';\n          this._ready = 'ready';\n          this._onFetchSuccess(data);\n          this._success && this._success();\n        }.bind(this),\n        error: function (err) {\n          this._state = 'error';\n          this._error && this._error(errorParse(err));\n        }.bind(this)\n      });\n    }\n  },\n\n  _onFetchSuccess: function (data) {\n    var models = data.rows;\n    _.each(models, function (model) {\n      var m = this.getService(model.service);\n      m ? m.set(model) : this.add(model);\n    }, this);\n  },\n\n  getService: function (service) {\n    return this.findWhere({service: service});\n  },\n\n  isFetching: function () {\n    return this.getState() === 'fetching';\n  },\n\n  isReady: function () {\n    return this._ready === 'ready';\n  },\n\n  needsCheck: function () {\n    var state = this.getState();\n    return state === 'unfetched' || state === 'fetching';\n  },\n\n  getState: function () {\n    return this._state;\n  }\n});\n\nvar collection;\n\nmodule.exports = {\n  get: function (configModel) {\n    if (collection === undefined) {\n      collection = new QuotaInfo([], {\n        configModel: configModel\n      });\n    }\n    return collection;\n  }\n};\n",
    "var _ = require('underscore');\n\n/**\n *  Control which analysis requires quota\n */\n\nvar unity = function (input) {\n  return input;\n};\n\nvar routingAnalysisQuota = {\n  name: _t('editor.layers.analysis-form.quota.analysis-type.routing'),\n  api: 'routing',\n  user: 'mapzen_routing',\n  needsQuota: true,\n  transform: unity\n};\n\nvar ANALYSES_WITH_QUOTA_MAP = {\n  'trade-area': {\n    name: _t('editor.layers.analysis-form.quota.analysis-type.trade-area'),\n    api: 'isolines',\n    user: 'here_isolines',\n    transform: function (input, formModel) {\n      // the isoline analysis consume N rows x M tracts\n      return input * formModel.get('isolines');\n    },\n    needsQuota: function (quotaInfo) {\n      var info = quotaInfo.getService('isolines');\n      var provider = info && info.get('provider');\n      return !!provider;\n    }\n  },\n  'georeference-street-address': {\n    name: _t('editor.layers.analysis-form.quota.analysis-type.georeference-street-address'),\n    api: 'hires_geocoder',\n    user: 'geocoding',\n    transform: unity,\n    needsQuota: function (quotaInfo) {\n      var info = quotaInfo.getService('hires_geocoder');\n      var provider = info && info.get('provider');\n      return provider !== 'google';\n    }\n  },\n  'data-observatory-measure': {\n    name: _t('editor.layers.analysis-form.quota.analysis-type.data-observatory-measure'),\n    api: 'observatory',\n    user: 'obs_general',\n    needsQuota: true,\n    transform: unity\n  },\n  'routing-sequential': routingAnalysisQuota,\n  'routing-to-layer-all-to-all': routingAnalysisQuota,\n  'routing-to-single-point': routingAnalysisQuota\n};\n\nmodule.exports = {\n  requiresQuota: function (type, quotaInfo) {\n    if (ANALYSES_WITH_QUOTA_MAP[type] !== undefined) {\n      var needsQuota = ANALYSES_WITH_QUOTA_MAP[type].needsQuota;\n      if (_.isFunction(needsQuota)) {\n        return needsQuota(quotaInfo);\n      } else {\n        return needsQuota;\n      }\n    }\n    return false;\n  },\n\n  transformInput: function (type, input, formModel) {\n    if (ANALYSES_WITH_QUOTA_MAP[type] !== undefined) {\n      var transform = ANALYSES_WITH_QUOTA_MAP[type].transform;\n      return transform(input, formModel);\n    }\n    return input;\n  },\n\n  getAnalysisName: function (type) {\n    if (ANALYSES_WITH_QUOTA_MAP[type]) {\n      return ANALYSES_WITH_QUOTA_MAP[type].name;\n    }\n    return null;\n  },\n\n  getServiceName: function (type) {\n    if (ANALYSES_WITH_QUOTA_MAP[type]) {\n      return ANALYSES_WITH_QUOTA_MAP[type].api;\n    }\n    return null;\n  },\n\n  getUserDataName: function (type) {\n    if (ANALYSES_WITH_QUOTA_MAP[type]) {\n      return ANALYSES_WITH_QUOTA_MAP[type].user;\n    }\n    return null;\n  }\n\n};\n",
    "var _ = require('underscore');\nvar AnalysesQuotaOptions = require('./analyses-quota-options');\nvar CONTACT_LINK_TEMPLATE = _.template(\"<a href='mailto:<%- mail %>'><%- contact %></a>\");\n\nfunction getOwnerEmail (userModel) {\n  return userModel._organizationModel && userModel._organizationModel.get('admin_email');\n}\n\nfunction getEmail (configModel, userModel) {\n  var isSaas = configModel.get('cartodb_com_hosted') === false;\n  var insideOrganization = userModel.isInsideOrg();\n  var ownerOrganization = userModel.isOrgOwner();\n  var email = _t('editor.layers.analysis-form.quota.emails.support');\n\n  if (isSaas) {\n    if (insideOrganization) {\n      email = ownerOrganization ? _t('editor.layers.analysis-form.quota.emails.support') : getOwnerEmail(userModel);\n    } else {\n      email = _t('editor.layers.analysis-form.quota.emails.saas');\n    }\n  }\n\n  return email;\n}\n\nfunction getMessage (configModel, userModel, notAssignedQuota) {\n  var insideOrganization = userModel.isInsideOrg();\n  var ownerOrganization = userModel.isOrgOwner();\n  var message;\n\n  if (notAssignedQuota) {\n    if (insideOrganization && !ownerOrganization) {\n      message = _t('editor.layers.analysis-form.quota.contact-message.no-quota-assigned.organization');\n    } else {\n      message = _t('editor.layers.analysis-form.quota.contact-message.no-quota-assigned.regular');\n    }\n  } else {\n    if (insideOrganization && !ownerOrganization) {\n      message = _t('editor.layers.analysis-form.quota.contact-message.no-credits.organization');\n    } else {\n      message = _t('editor.layers.analysis-form.quota.contact-message.no-credits.regular');\n    }\n  }\n\n  return message;\n}\n\nvar getNoCreditMessage = function (quota, type, configModel, userModel) {\n  var link;\n  var message;\n\n  link = CONTACT_LINK_TEMPLATE({\n    mail: getEmail(configModel, userModel),\n    contact: getMessage(configModel, userModel, quota.totalQuota === 0)\n  });\n\n  if (quota.totalQuota === 0) {\n    message = _t('editor.layers.analysis-form.quota.no-quota-assigned-body', {\n      analysis: AnalysesQuotaOptions.getAnalysisName(type),\n      contact: link\n    });\n  } else {\n    message = _t('editor.layers.analysis-form.quota.no-credits-body', {\n      contact: link\n    });\n  }\n\n  return message;\n};\n\nmodule.exports = {\n  make: function (data, configModel, userModel) {\n    var blockPrice = (data.quotaInfo.blockPrice / 100);\n    var estimation = data.estimation;\n    var blockSize = data.quotaInfo.blockSize;\n    var body = '';\n    var type = '';\n    var link;\n\n    if (data.quotaInfo.hardLimit) {\n      if (data.creditsLeft > 0) {\n        if (data.quotaInfo.enoughQuota) {\n          // You need to use approximately xxx of your credits.\n          body = _t('editor.layers.analysis-form.quota.enough-quota', {\n            credits: estimation\n          });\n          type = 'success';\n        } else {\n          // We're sorry the current quota is insufficient to enrich your data. Rows will be set to null and analysis may not complete. Please contact us to extend your quota for this function.\n          link = CONTACT_LINK_TEMPLATE({\n            mail: getEmail(configModel, userModel),\n            contact: getMessage(configModel, userModel, false)\n          });\n\n          body = _t('editor.layers.analysis-form.quota.hard-limit-not-enough-quota', {\n            contact: link\n          });\n          type = 'alert';\n        }\n      } else {\n        // To get access to the [service] you will need more credits. Your current quota is not enough. Contact us.\n        body = getNoCreditMessage(data.quotaInfo, data.type, configModel, userModel);\n        type = 'alert';\n      }\n    } else {\n      if (data.creditsLeft > 0) {\n        // enoughQuota wil be true when soft_limit, becuase in this case, the api asume true\n        if (data.creditsLeft >= estimation) {\n          // You need to use some of your credits for this (data.estimation)\n          body = _t('editor.layers.analysis-form.quota.enough-quota', {\n            credits: estimation\n          });\n          type = 'success';\n        } else {\n          // Using this analysis component may incur extra fees depending on your account quota. Please review your current quota and/or request a larger allocation.\n          body = _t('editor.layers.analysis-form.quota.soft-limit-enough-quota', {\n            credits: estimation,\n            blockSize: blockSize,\n            blockPrice: blockPrice\n          });\n          type = 'alert';\n        }\n      } else {\n        if (data.quotaInfo.totalQuota === 0) {\n          body = getNoCreditMessage(data.quotaInfo, data.type, configModel, userModel);\n        } else {\n          // Using this analysis component may incur extra fees depending on your account quota. Please review your current quota and/or request a larger allocation.\n          body = _t('editor.layers.analysis-form.quota.soft-limit-enough-quota', {\n            credits: estimation,\n            blockSize: blockSize,\n            blockPrice: blockPrice\n          });\n        }\n        type = 'alert';\n      }\n    }\n\n    return {\n      type: type,\n      body: body\n    };\n  }\n};\n\n",
    "var _ = require('underscore');\nvar AnalysesQuotaOptions = require('./analyses-quota-options');\n/**\n *  Provide info about quota\n *  It handles the source of data: api and user model\n */\n\nvar QUOTA_DEFAULTS = {\n  totalQuota: 0,\n  usedQuota: 0,\n  blockSize: 1000,\n  blockPrice: 0,\n  enoughQuota: true\n};\n\nmodule.exports = function (type, userModel, quotaInfo, enoughQuota) {\n  var apiData = quotaInfo.getService(AnalysesQuotaOptions.getServiceName(type)) || {};\n  var userData = userModel.get(AnalysesQuotaOptions.getUserDataName(type)) || {};\n\n  // Remove null | undefined | falsy values\n  userData = _.pick(userData, _.identity);\n  return _.defaults(\n    {\n      blockSize: userData.block_size,\n      blockPrice: userData.block_price\n    },\n    {\n      totalQuota: apiData.get('monthly_quota'),\n      usedQuota: apiData.get('used_quota'),\n      hardLimit: !apiData.get('soft_limit')\n    },\n    {\n      enoughQuota: enoughQuota\n    },\n    QUOTA_DEFAULTS\n  );\n};\n",
    "// Make common analyses actions available whin editor context\nvar checkAndBuildOpts = require('../../../../helpers/required-opts');\nvar AddAnalysisView = require('../../../../components/modals/add-analysis/add-analysis-view');\nvar nodeIds = require('../../../../value-objects/analysis-node-ids');\n\nvar REQUIRED_OPTS = [\n  'onboardings',\n  'layerDefinitionsCollection',\n  'modals',\n  'userModel',\n  'configModel'\n];\n\nmodule.exports = (function () {\n  return {\n    init: function (opts) {\n      checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n    },\n\n    setLayerId: function (layerId) {\n      var layerDefinitionModel = this._layerDefinitionsCollection.get(layerId);\n      if (!layerDefinitionModel) {\n        throw new Error('no layer-definition found for id' + layerId + ', available layer ids are: ' + this._layerDefinitionsCollection.pluck('id') + ')');\n      }\n\n      this._layerId = layerId;\n    },\n\n    setStackLayoutView: function (stackLayoutView) {\n      if (!stackLayoutView) {\n        throw new Error('stackLayoutView is required');\n      }\n\n      this._stackLayoutView = stackLayoutView;\n    },\n\n    addGeoreferenceAnalysis: function () {\n      var layerDefinitionModel = this._layerDefinitionsCollection.get(this._layerId);\n\n      var letter = layerDefinitionModel.get('letter');\n      var sourceId = layerDefinitionModel.get('source');\n\n      this._stackLayoutView.model.goToStep(1, layerDefinitionModel, 'layer-content', 'analyses', {\n        source: sourceId,\n        id: letter === nodeIds.letter(sourceId)\n          ? nodeIds.next(sourceId)\n          : letter + '1',\n        type: 'georeference-long-lat'\n      });\n    },\n\n    addAnalysis: function () {\n      this._onboardings.destroy();\n\n      var layerDefinitionModel = this._layerDefinitionsCollection.get(this._layerId);\n\n      this._modals.create(function (modalModel) {\n        return new AddAnalysisView({\n          userModel: this._userModel,\n          configModel: this._configModel,\n          modalModel: modalModel,\n          layerDefinitionModel: layerDefinitionModel\n        });\n      }.bind(this));\n      this._modals.onDestroyOnce(function (analysisFormAttrs) {\n        if (analysisFormAttrs) {\n          // A analysis option was seleted, redirect to layer-content view with new attrs\n          this._stackLayoutView.model.goToStep(1, layerDefinitionModel, 'layer-content', 'analyses', analysisFormAttrs);\n        }\n      }, this);\n    }\n  };\n})();\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<h2 class=\"CDB-Text CDB-Size-huge is-light u-secondaryTextColor\">\\n  '+\n((__t=( body ))==null?'':__t)+\n'\\n</h2>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar Infobox = require('../../../../components/infobox/infobox-factory');\nvar InfoboxModel = require('../../../../components/infobox/infobox-model');\nvar InfoboxCollection = require('../../../../components/infobox/infobox-collection');\nvar PanelWithOptionsView = require('../../../../components/view-options/panel-with-options-view');\nvar panelTemplate = require('./panel-with-options.tpl');\nvar LayerContentAnalysesView = require('./layer-content-analyses-view');\nvar OnboardingLauncher = require('../../../../components/onboardings/generic/generic-onboarding-launcher');\nvar OnboardingView = require('../../../../components/onboardings/layers/analysis-onboarding/analysis-onboarding-view');\nvar layerOnboardingKey = require('../../../../components/onboardings/layers/layer-onboarding-key');\nvar checkAndBuildOpts = require('../../../../helpers/required-opts');\nvar fetchAllQueryObjectsIfNecessary = require('../../../../helpers/fetch-all-query-objects');\nvar AnalysesService = require('./analyses-service.js');\n\nvar REQUIRED_OPTS = [\n  'userActions',\n  'analysisFormsCollection',\n  'layerDefinitionModel',\n  'analysisDefinitionNodesCollection',\n  'configModel',\n  'userModel',\n  'editorModel',\n  'stackLayoutModel',\n  'onboardings',\n  'onboardingNotification'\n];\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    this._selectedNodeId = opts.selectedNodeId;\n\n    this._infoboxModel = new InfoboxModel({\n      state: ''\n    });\n\n    this._overlayModel = new Backbone.Model({\n      visible: this._isLayerHidden()\n    });\n\n    this._onboardingLauncher = new OnboardingLauncher({\n      view: OnboardingView,\n      onboardingNotification: this._onboardingNotification,\n      notificationKey: layerOnboardingKey,\n      onboardings: this._onboardings\n    }, {\n      editorModel: this._editorModel,\n      selector: 'LayerOnboarding'\n    });\n\n    this._getQueryAndCheckState();\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this._launchOnboarding();\n    this.clearSubViews();\n    this.$el.empty();\n\n    var self = this;\n    var infoboxSstates = [\n      {\n        state: 'georeference',\n        createContentView: function () {\n          var name = this._layerDefinitionModel ? this._layerDefinitionModel.getTableName() : '';\n          var body = [_t('editor.tab-pane.layers.georeference.body', { name: name }),\n                      _t('editor.layers.georeference.manually-add')].join(' ');\n\n          return Infobox.createWithAction({\n            type: 'alert',\n            title: _t('editor.tab-pane.layers.georeference.title'),\n            body: body,\n            mainAction: {\n              label: _t('editor.layers.georeference.georeference-button')\n            }\n          });\n        },\n        mainAction: self._onGeoreferenceClicked.bind(self)\n      }, {\n        state: 'layer-hidden',\n        createContentView: function () {\n          return Infobox.createWithAction({\n            type: 'alert',\n            title: _t('editor.style.messages.layer-hidden.title'),\n            body: _t('editor.style.messages.layer-hidden.body'),\n            mainAction: {\n              label: _t('editor.style.messages.layer-hidden.show')\n            }\n          });\n        },\n        mainAction: self._showHiddenLayer.bind(self)\n      }\n    ];\n\n    var infoboxCollection = new InfoboxCollection(infoboxSstates);\n\n    var panelWithOptionsView = new PanelWithOptionsView({\n      template: panelTemplate,\n      className: 'Editor-content',\n      editorModel: self._editorModel,\n      infoboxModel: self._infoboxModel,\n      infoboxCollection: infoboxCollection,\n      createContentView: function () {\n        return new LayerContentAnalysesView({\n          className: 'Editor-content',\n          userActions: self._userActions,\n          analysisDefinitionNodesCollection: self._analysisDefinitionNodesCollection,\n          userModel: self._userModel,\n          analysisFormsCollection: self._analysisFormsCollection,\n          configModel: self._configModel,\n          layerDefinitionModel: self._layerDefinitionModel,\n          stackLayoutModel: self._stackLayoutModel,\n          selectedNodeId: self._selectedNodeId,\n          overlayModel: self._overlayModel\n        });\n      }\n    });\n\n    this.$el.append(panelWithOptionsView.render().el);\n    this.addView(panelWithOptionsView);\n    return this;\n  },\n\n  _initBinds: function () {\n    // Only when there is no nodes we should check if node can be georeferenced\n    this.listenTo(this._analysisFormsCollection, 'reset remove', this._getQueryAndCheckState);\n  },\n\n  _getQueryAndCheckState: function () {\n    var setStateAndRender = function () {\n      this._infoboxState();\n      this.render();\n    }.bind(this);\n\n    if (!this._analysisFormsCollection.isEmpty()) {\n      setStateAndRender();\n      return;\n    }\n\n    var analysisDefinitionNodeModel = this._layerDefinitionModel.getAnalysisDefinitionNodeModel();\n\n    fetchAllQueryObjectsIfNecessary(\n      {\n        queryRowsCollection: analysisDefinitionNodeModel.queryRowsCollection,\n        queryGeometryModel: analysisDefinitionNodeModel.queryGeometryModel,\n        querySchemaModel: analysisDefinitionNodeModel.querySchemaModel\n      },\n      setStateAndRender\n    );\n  },\n\n  _launchOnboarding: function () {\n    if (this._onboardingNotification.getKey(layerOnboardingKey)) {\n      return;\n    }\n\n    if (this._analysisFormsCollection.isEmpty()) {\n      this._onboardingLauncher.launch();\n    }\n  },\n\n  _infoboxState: function () {\n    if (this._isLayerHidden()) {\n      this._infoboxModel.set({state: 'layer-hidden'});\n      this._overlayModel.set({visible: true});\n    } else if (this._layerDefinitionModel.canBeGeoreferenced() && this._analysisFormsCollection.isEmpty()) {\n      this._infoboxModel.set({state: 'georeference'});\n      this._overlayModel.set({visible: false});\n    } else {\n      this._infoboxModel.set({state: ''});\n      this._overlayModel.set({visible: false});\n    }\n  },\n\n  _showHiddenLayer: function () {\n    this._layerDefinitionModel.toggleVisible();\n    this._userActions.saveLayer(this._layerDefinitionModel);\n\n    this._infoboxState();\n  },\n\n  _isLayerHidden: function () {\n    return this._layerDefinitionModel.get('visible') === false;\n  },\n\n  _onGeoreferenceClicked: function () {\n    AnalysesService.addGeoreferenceAnalysis();\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./analyses-workflow-item.tpl');\nvar nodeIds = require('../../../../value-objects/analysis-node-ids');\nvar layerColors = require('../../../../data/layer-colors');\nvar AnalysisTooltip = require('../../analysis-views/analyses-tooltip-error');\n\nmodule.exports = CoreView.extend({\n\n  tagName: 'li',\n  className: 'HorizontalBlockList-item',\n\n  events: {\n    'click': '_onNodeClick'\n  },\n\n  initialize: function (opts) {\n    if (!opts.analysisNode && !opts.formModel) throw new Error('analysisNode or formModel is required');\n    if (!opts.viewModel) throw new Error('viewModel is required');\n\n    this._isNew = !opts.analysisNode;\n    this._analysisNode = opts.analysisNode || opts.formModel; // if form model represents a new node there is no analysis yet; use form model as fallback\n    this._viewModel = opts.viewModel;\n\n    this._analysisNode.on('change:status', this.render, this);\n    this.add_related_model(this._analysisNode);\n\n    this._analysisTooltip = new AnalysisTooltip({\n      analysisNode: this._analysisNode,\n      element: this.$el,\n      triggerSelector: '.Editor-ListAnalysis-itemError'\n    });\n\n    this.addView(this._analysisTooltip);\n  },\n\n  render: function () {\n    var status = this._analysisNode.get('status');\n    var isDone = this._isNew || status === 'ready' || status === 'failed';\n    var isSelected = this._analysisNode.id === this._viewModel.get('selectedNodeId');\n    var letter = nodeIds.letter(this._analysisNode.id);\n    var bgColor = layerColors.getColorForLetter(letter);\n\n    this.$el.html(\n      template({\n        isNew: this._isNew,\n        isDone: isDone,\n        bgColor: bgColor,\n        isSelected: isSelected,\n        nodeId: this._analysisNode.id,\n        hasError: status === 'failed'\n      })\n    );\n\n    this.$el.css({\n      background: isSelected ? bgColor : '',\n      border: isSelected ? '1px solid ' + bgColor : ''\n    });\n    this.$el.toggleClass('is-selected', isSelected);\n    this.$el.toggleClass('has-error', status === 'failed');\n\n    return this;\n  },\n\n  _onNodeClick: function () {\n    this._viewModel.set('selectedNodeId', this._analysisNode.id);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='';\n if (isDone) { \n__p+='\\n  <div class=\"HorizontalBlockList-item-actionBlock CDB-Text CDB-Size-small u-upperCase\">\\n    <span class=\"HorizontalBlockList-item-text\">\\n      '+\n((__t=( nodeId ))==null?'':_.escape(__t))+\n'\\n    </span>\\n    ';\n if (!isNew) { \n__p+='\\n      <i class=\"CDB-IconFont CDB-IconFont-ray CDB-Size-medium HorizontalBlockList-item-icon\"></i>\\n    ';\n } \n__p+='\\n  </div>\\n';\n } else { \n__p+='\\n  ';\n if (isSelected) { \n__p+='\\n    <div class=\"CDB-LoaderIcon\">\\n      <svg class=\"CDB-LoaderIcon-spinner\" viewBox=\"0 0 50 50\">\\n        <circle class=\"CDB-LoaderIcon-path\" cx=\"25\" cy=\"25\" r=\"20\" fill=\"none\"></circle>\\n      </svg>\\n    </div>\\n  ';\n } else { \n__p+='\\n    <div class=\"CDB-LoaderIcon is-dark\">\\n      <svg class=\"CDB-LoaderIcon-spinner\" viewBox=\"0 0 50 50\">\\n        <circle class=\"CDB-LoaderIcon-path\" cx=\"25\" cy=\"25\" r=\"20\" fill=\"none\"></circle>\\n      </svg>\\n    </div>\\n  ';\n } \n__p+='\\n';\n } \n__p+='\\n\\n';\n if (hasError) { \n__p+='\\n<div class=\"Editor-ListAnalysis-itemError\"></div>\\n';\n } \n__p+='\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar AnalysesWorkflowItemView = require('./analyses-workflow-item-view');\nvar template = require('./analyses-workflow-list.tpl');\n\nmodule.exports = CoreView.extend({\n\n  className: 'HorizontalBlockList u-tSpace',\n  tagName: 'ul',\n\n  initialize: function (opts) {\n    if (!opts.analysisDefinitionNodesCollection) throw new Error('analysisDefinitionNodesCollection is required');\n    if (!opts.analysisFormsCollection) throw new Error('analysisFormsCollection is required');\n    if (!opts.model) throw new Error('model is required');\n    if (!opts.layerId) throw new Error('layerId is required');\n\n    this._analysisDefinitionNodesCollection = opts.analysisDefinitionNodesCollection;\n    this.analysis = opts.analysis;\n    this.analysisFormsCollection = opts.analysisFormsCollection;\n    this._layerId = opts.layerId;\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template({\n      layerId: this._layerId\n    }));\n\n    this.analysisFormsCollection.each(this._renderWorkflowItem, this);\n    return this;\n  },\n\n  _renderWorkflowItem: function (formModel) {\n    var view = new AnalysesWorkflowItemView({\n      analysisNode: this._analysisDefinitionNodesCollection.get(formModel.id),\n      formModel: formModel,\n      viewModel: this.model,\n      layerId: this._layerId\n    });\n    this.$el.append(view.render().el);\n    this.addView(view);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<li class=\"HorizontalBlockList-item is-add\">\\n  <div class=\"HorizontalBlockList-item-actionBlock js-add-analysis\" data-layer-id=\"'+\n((__t=( layerId ))==null?'':_.escape(__t))+\n'\">\\n    <div class=\"CDB-Shape\">\\n      <div class=\"CDB-Shape-add is-blue is-small\"></div>\\n    </div>\\n  </div>\\n</li>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./analyses-workflow.tpl');\nvar ListView = require('./analyses-workflow-list-view');\nvar ScrollView = require('../../../../components/scroll/scroll-view');\n\nmodule.exports = CoreView.extend({\n\n  events: {\n    'click .js-delete': '_deleteAnalysis'\n  },\n\n  initialize: function (opts) {\n    if (!opts.analysisDefinitionNodesCollection) throw new Error('analysisDefinitionNodesCollection is required');\n    if (!opts.analysisFormsCollection) throw new Error('analysisFormsCollection is required');\n    if (!opts.viewModel) throw new Error('viewModel is required');\n    if (!opts.layerDefinitionModel) throw new Error('layerDefinitionModel is required');\n\n    this._analysisDefinitionNodesCollection = opts.analysisDefinitionNodesCollection;\n    this.analysisFormsCollection = opts.analysisFormsCollection;\n    this.viewModel = opts.viewModel;\n    this._layerDefinitionModel = opts.layerDefinitionModel;\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(this._html());\n    this._renderAnalysesView();\n    return this;\n  },\n\n  _html: function () {\n    return template({\n      canDelete: this._canDeleteSelectedNode(),\n      deleteLabel: !this._nodeDefModel()\n        ? _t('editor.layers.layer.cancel-delete-analysis')\n        : _t('editor.layers.layer.delete'),\n      selectedNodeId: this.viewModel.get('selectedNodeId'),\n      layerAnalysisCount: this._layerDefinitionModel.getNumberOfAnalyses()\n    });\n  },\n\n  _renderAnalysesView: function () {\n    var self = this;\n    var view = new ScrollView({\n      type: 'horizontal',\n      createContentView: function () {\n        return new ListView({\n          analysisDefinitionNodesCollection: self._analysisDefinitionNodesCollection,\n          analysisFormsCollection: self.analysisFormsCollection,\n          model: self.viewModel,\n          layerId: self._layerDefinitionModel.id\n        });\n      }\n    });\n\n    this.$('.js-content').append(view.render().el);\n    this.addView(view);\n  },\n\n  _deleteAnalysis: function () {\n    if (this._canDeleteSelectedNode()) {\n      this.analysisFormsCollection.deleteNode(this.viewModel.get('selectedNodeId'));\n    }\n  },\n\n  _canDeleteSelectedNode: function () {\n    var nodeDefModel = this._nodeDefModel();\n    return !nodeDefModel || nodeDefModel.canBeDeletedByUser();\n  },\n\n  _nodeDefModel: function () {\n    var nodeId = this.viewModel.get('selectedNodeId');\n    return this._layerDefinitionModel.findAnalysisDefinitionNodeModel(nodeId);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-HeaderInfo\">\\n  <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">1</div>\\n  <div class=\"Editor-HeaderInfo-inner CDB-Text js-content\">\\n    <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n      <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">\\n        '+\n((__t=( _t('editor.layers.analysis-form.workflow') ))==null?'':_.escape(__t))+\n'\\n        <span class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large u-altTextColor\">('+\n((__t=( layerAnalysisCount ))==null?'':_.escape(__t))+\n')</span>\\n      </h2>\\n    </div>\\n    <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--xl\">\\n      '+\n((__t=( _t('editor.layers.layer.analysis') ))==null?'':_.escape(__t))+\n' '+\n((__t=( selectedNodeId ))==null?'':_.escape(__t))+\n'\\n      ';\n if (canDelete) { \n__p+='\\n        <button class=\"js-delete u-actionTextColor u-upperCase\">'+\n((__t=( deleteLabel ))==null?'':_.escape(__t))+\n'</button>\\n      ';\n } \n__p+='\\n    </p>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    this.template = opts.template;\n    this.model = opts.model;\n    this._initBinds();\n  },\n\n  render: function () {\n    var html = this.template(this.model.attributes);\n\n    this.clearSubViews();\n    this.$el.empty();\n    this.$el.append(html);\n    return this;\n  },\n\n  _initBinds: function () {\n    this.listenTo(this.model, 'change:isDisabled', this.render);\n  }\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar template = require('./analysis-controls.tpl');\nvar InfoboxFactory = require('../../../../components/infobox/infobox-factory');\nvar InfoboxModel = require('../../../../components/infobox/infobox-model');\nvar InfoboxCollection = require('../../../../components/infobox/infobox-collection');\nvar AnalysesQuotaPresenter = require('./analyses-quota/analyses-quota-presenter');\nvar AnalysesQuotaOptions = require('./analyses-quota/analyses-quota-options');\nvar AnalysesQuotaProvider = require('./analyses-quota/analyses-quota-provider');\nvar AnalysesQuotaEstimation = require('./analyses-quota/analyses-quota-estimation-input');\nvar AnalysesQuotaEnough = require('./analyses-quota/analyses-quota-enough');\nvar checkAndBuildOpts = require('../../../../helpers/required-opts');\nvar AnalysisButtonView = require('./analysis-button-view');\nvar AnalysisQuotaView = require('./analysis-quota-view');\n\nvar REQUIRED_OPTS = [\n  'formModel',\n  'userActions',\n  'userModel',\n  'stackLayoutModel',\n  'configModel',\n  'querySchemaModel',\n  'quotaInfo'\n];\n\n/**\n * View representing the apply button for a form\n */\nmodule.exports = CoreView.extend({\n  className: 'Options-bar Options-bar--right u-flex',\n\n  events: {\n    'click .js-save': '_onSaveClicked'\n  },\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n    this._analysisNode = opts.analysisNode;\n\n    AnalysesQuotaEstimation.init(opts.configModel);\n    AnalysesQuotaEnough.init(opts.configModel);\n\n    this._viewModel = new Backbone.Model({\n      isNewAnalysis: !opts.analysisNode,\n      hasChanges: !opts.analysisNode,\n      type: this._formModel.get('type')\n    });\n\n    this._infoboxModel = new InfoboxModel({\n      state: this._quotaInfo.getState(),\n      visible: true\n    });\n\n    this._initBinds();\n\n    if (!opts.analysisNode) {\n      this._fetchQuotaIfNeeded();\n    }\n\n    this.render = this.render.bind(this);\n    this._onFormModelChanged = this._onFormModelChanged.bind(this);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    var type = this._formModel.get('type');\n    var isValid = this._formModel.isValid();\n\n    // If no dataservice, requiresQuota returns false because the model doesn't exist and it's converted to boolean\n    var requiresQuota = AnalysesQuotaOptions.requiresQuota(type, this._quotaInfo);\n    var view;\n\n    if (this._isAnalysisDone() && !this._hasChanges()) {\n      view = this._createButtonView();\n    } else {\n      // If the analysis doesn't require quota, let's not wait or check the fetching state\n      if (!requiresQuota || !isValid) {\n        view = this._createButtonView();\n      } else {\n        view = this._createQuotaView();\n      }\n    }\n\n    this.addView(view);\n    this.$el.append(view.render().el);\n    this._setTrackingClass();\n\n    return this;\n  },\n\n  _setTrackingClass: function () {\n    this.$('.js-save').addClass('track-' + this._formModel.get('type') + '-analysis track-apply');\n  },\n\n  _initBinds: function () {\n    this.listenTo(this._formModel, 'change', this._onFormModelChanged);\n\n    if (this._analysisNode) {\n      this.listenTo(this._analysisNode, 'change:status', function () {\n        var isAnalysisDone = this._isAnalysisDone();\n        if (isAnalysisDone) {\n          this.render();\n        }\n      });\n    }\n  },\n\n  _onFormModelChanged: function () {\n    var isAnalysisDone = this._isAnalysisDone();\n    var isDone = this._viewModel.get('isNewAnalysis') || isAnalysisDone;\n    var canSave = this._formModel.isValid() && isDone;\n\n    this._viewModel.set({\n      hasChanges: true,\n      type: this._formModel.get('type'),\n      isDisabled: !canSave\n    });\n\n    this.render();\n    this._fetchQuotaIfNeeded();\n  },\n\n  _fetchQuotaIfNeeded: function () {\n    var type = this._formModel.get('type');\n    var isValid = this._formModel.isValid();\n    var quota = this._quotaInfo;\n    if ((quota.needsCheck() || AnalysesQuotaOptions.requiresQuota(type, quota)) && isValid) {\n      this._fetchQuota();\n    }\n  },\n\n  _fetchQuota: function () {\n    this._infoboxModel.set('state', 'fetching');\n\n    this._quotaInfo.fetch({\n      success: function () {\n        this._buildQuotaViewInfo();\n      }.bind(this),\n      error: function (error) {\n        this._viewModel.set({error: error});\n        this._infoboxModel.set('state', 'error');\n      }.bind(this)\n    });\n  },\n\n  _createButtonView: function () {\n    var label = this._formModel.get('persisted')\n        ? _t('editor.layers.analysis-form.apply-btn')\n        : _t('editor.layers.analysis-form.create-btn');\n\n    this._viewModel.set({\n      label: label,\n      isDisabled: !this._canSave()\n    });\n\n    return new AnalysisButtonView({\n      template: template,\n      model: this._viewModel\n    });\n  },\n\n  _buildQuotaViewInfo: function () {\n    var formModel = this._formModel;\n    var userModel = this._userModel;\n    var type = formModel.get('type');\n    var service = AnalysesQuotaOptions.getServiceName(type);\n    var query = this._querySchemaModel.get('query');\n    var quotaData = this._quotaInfo;\n\n    this.payload = {};\n    this.payload.type = type;\n\n    var errorCallback = function (error) {\n      this._viewModel.set('error', error);\n      this._infoboxModel.set('state', 'error');\n    }.bind(this);\n\n    var checkEnoughQuota = function (data) {\n      // Apply transformation to the input\n      // for example isolines takes tracts in in order to calculate estimation\n      var rows = AnalysesQuotaOptions.transformInput(type, data, formModel);\n      this.payload.estimation = rows;\n      // with the input, we calculate wether the quota is enough\n      return AnalysesQuotaEnough.fetch(service, rows);\n    }.bind(this);\n\n    var buildPayload = function (enoughQuota) {\n      var payload = this.payload;\n      // then we can get the full set of data\n      payload.quotaInfo = AnalysesQuotaProvider(type, userModel, quotaData, enoughQuota);\n      payload.creditsLeft = payload.quotaInfo.totalQuota - payload.quotaInfo.usedQuota;\n      payload.canRunAnalysis = ((enoughQuota && payload.quotaInfo.totalQuota > 0) ||\n                               (payload.quotaInfo.hardLimit === false && payload.quotaInfo.totalQuota > 0));\n\n      // finally we are ready to show the information\n      this._infoboxModel.set('state', 'ready');\n    }.bind(this);\n\n    var dsReady = quotaData.isReady();\n\n    // Only checks api if analysis belongs to a service with quota\n    if (service !== null && dsReady) {\n      if (formModel.isValid()) {\n        // get the estimation for this analysis\n        AnalysesQuotaEstimation.fetch(query)\n          .then(checkEnoughQuota, errorCallback)\n          .then(buildPayload, errorCallback);\n      } else {\n        // to render the simple button view.\n        this.render();\n      }\n    } else if (!dsReady) {\n      errorCallback(_t('editor.layers.analysis-form.quota.quota-dataservice-down'));\n    }\n  },\n\n  _createQuotaView: function () {\n    var states = [\n      {\n        state: 'fetching',\n        createContentView: function () {\n          return InfoboxFactory.createLoading({\n            body: _t('editor.layers.analysis-form.quota.loading')\n          });\n        }\n      },\n      {\n        state: 'ready',\n        createContentView: function () {\n          var payload = this.payload;\n          var confirmLabel = _t('editor.layers.analysis-form.confirm-analysis');\n          var quotaMessage = '';\n\n          if (payload.creditsLeft > 0) {\n            quotaMessage = _t('editor.layers.analysis-form.quota.credits-left-message', {\n              smart_count: payload.creditsLeft\n            });\n          } else {\n            quotaMessage = _t('editor.layers.analysis-form.quota.no-credits-message');\n          }\n          payload.quotaInfo.quotaMessage = quotaMessage;\n\n          var dataInfobox = _.extend(AnalysesQuotaPresenter.make(payload, this._configModel, this._userModel), {\n            title: _t('editor.layers.analysis-form.quota.title'),\n            mainAction: {\n              label: confirmLabel,\n              type: 'primary',\n              disabled: !this._canSave() || !payload.canRunAnalysis\n            },\n            quota: payload.quotaInfo\n          });\n\n          return InfoboxFactory.createQuota(dataInfobox);\n        }.bind(this),\n        mainAction: function () {\n          var payload = this.payload;\n          if (this._canSave() && payload.canRunAnalysis) {\n            this._saveAnalysis();\n          }\n        }.bind(this),\n        closeAction: function () {\n          this._stackLayoutModel.prevStep('layers');\n        }.bind(this)\n      },\n      {\n        state: 'error',\n        createContentView: function () {\n          return InfoboxFactory.createWithAction({\n            title: _t('editor.layers.analysis-form.quota.title'),\n            type: 'error',\n            body: _t('editor.layers.analysis-form.quota.quota-fetch-error', {\n              error: this._viewModel.get('error')\n            }),\n            mainAction: {\n              label: _t('editor.layers.analysis-form.quota.cancel')\n            }\n          });\n        }.bind(this),\n        mainAction: function () {\n          this._stackLayoutModel.prevStep('layers');\n        }.bind(this)\n      }\n    ];\n\n    return new AnalysisQuotaView({\n      className: 'Infobox-wrapper',\n      infoboxModel: this._infoboxModel,\n      infoboxCollection: new InfoboxCollection(states)\n    });\n  },\n\n  _canSave: function () {\n    var isAnalysisDone = this._isAnalysisDone();\n    var isDone = this._viewModel.get('isNewAnalysis') || isAnalysisDone;\n    var hasChanges = this._viewModel.get('hasChanges');\n    return this._formModel.isValid() && isDone && hasChanges;\n  },\n\n  _onSaveClicked: function () {\n    if (this._canSave()) {\n      this._saveAnalysis();\n    }\n  },\n\n  _hasChanges: function () {\n    return this._viewModel.get('hasChanges') === true;\n  },\n\n  _isAnalysisDone: function () {\n    return this._analysisNode && (this._analysisNode.isDone() || this._analysisNode.hasFailed());\n  },\n\n  _saveAnalysis: function () {\n    this._infoboxModel.set('state', 'idle');\n    this._userActions.saveAnalysis(this._formModel);\n    this._viewModel.set('hasChanges', false);\n    this.render();\n  }\n});\n",
    "var _ = require('underscore');\nvar BaseAnalysisFormModel = require('./base-analysis-form-model');\nvar template = require('./aggregate-intersection-form.tpl');\nvar ColumnOptions = require('../column-options');\nvar AGGREGATE_FORMAT_FIELDS_NAMES = [\n  'type',\n  'aggregate_column',\n  'aggregate_function'\n];\n\n/**\n * Form model for the aggregate intersection analysis\n */\nmodule.exports = BaseAnalysisFormModel.extend({\n  parse: function (attrs) {\n    if (!attrs.aggregate_column) {\n      attrs.aggregate_column = 'cartodb_id';\n    }\n    if (!attrs.aggregate_function) {\n      attrs.aggregate_function = 'count';\n    }\n    attrs.aggregate = {\n      operator: attrs.aggregate_function,\n      attribute: attrs.aggregate_function === 'count' ? '' : attrs.aggregate_column\n    };\n    return attrs;\n  },\n\n  initialize: function () {\n    BaseAnalysisFormModel.prototype.initialize.apply(this, arguments);\n\n    this._columnOptions = new ColumnOptions({}, {\n      configModel: this._configModel\n    });\n\n    this.listenTo(this._analysisSourceOptionsModel, 'change:fetching', this._setSchema);\n    this.listenTo(this._columnOptions, 'columnsFetched', this._setSchema);\n\n    this.on('change:aggregate', this._onChangeAggregate, this);\n    this.on('change:target', this._onChangeTarget, this);\n\n    this._setSchema();\n    this._fetchColumns();\n  },\n\n  _formatAttrs: function (formAttrs) {\n    var customFormattedFormAttrs = _.pick(formAttrs, ['id', 'source', 'target'].concat(AGGREGATE_FORMAT_FIELDS_NAMES));\n    return BaseAnalysisFormModel.prototype._formatAttrs.call(this, customFormattedFormAttrs);\n  },\n\n  getTemplate: function () {\n    return template;\n  },\n\n  getTemplateData: function () {\n    return {\n      dataFields: 'aggregate'\n    };\n  },\n\n  _filterSchemaFieldsByType: function (schema) {\n    // Always include the source and target fields in addition to the type-specific fields\n    return _.pick(schema, ['source', 'target', 'aggregate']);\n  },\n\n  /**\n   * @override {BaseAnalysisFormModel._setSchema}\n   */\n  _setSchema: function () {\n    BaseAnalysisFormModel.prototype._setSchema.call(this, this._filterSchemaFieldsByType({\n      source: this._primarySourceSchemaItem(_t('editor.layers.analysis-form.base-layer')),\n      target: {\n        type: 'NodeDataset',\n        title: _t('editor.layers.analysis-form.intersection-layer'),\n        options: this._getSourceOptionsForSource({\n          sourceAttrName: 'target'\n        }),\n        validators: ['required'],\n        dialogMode: 'float',\n        editorAttrs: {\n          disabled: this._isSourceDisabled('target')\n        }\n      },\n      aggregate: {\n        type: 'Operators',\n        title: _t('editor.layers.analysis-form.operation'),\n        dialogMode: 'float',\n        options: this._columnOptions.filterByType('number')\n      }\n    }));\n  },\n\n  _onChangeAggregate: function () {\n    var aggregate = this.get('aggregate');\n    this.set({\n      aggregate_column: aggregate.attribute || 'cartodb_id',\n      aggregate_function: aggregate.operator\n    });\n  },\n\n  _onChangeTarget: function () {\n    this.set('aggregate', {\n      operator: 'count',\n      attribute: ''\n    });\n    this._analysisSourceOptionsModel.createSourceNodeUnlessExisting(this.get('target'));\n    this._fetchColumns();\n  },\n\n  _fetchColumns: function () {\n    var target = this.get('target');\n    var nodeDefModel = this._layerDefinitionModel.findAnalysisDefinitionNodeModel(target);\n\n    if (nodeDefModel) {\n      this._columnOptions.setNode(nodeDefModel);\n    } else if (target) {\n      this._columnOptions.setDataset(target);\n    }\n  },\n\n  _isSourceDisabled: function (sourceAttrName) {\n    return this._isPrimarySource(sourceAttrName) || this._isFetchingOptions();\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<form>\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">2</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"source,target\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('analyses.aggregate-intersection.title') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.input-layer') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">3</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"'+\n((__t=( dataFields ))==null?'':_.escape(__t))+\n'\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.layers.analysis-form.measure-by') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--xl\">'+\n((__t=( _t('editor.layers.analysis-form.filter-aggregate') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n</form>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar DistanceConverter = require('../../../../../value-objects/distance-converter');\n\nvar DEFAULT_DISTANCE = 'meters';\n\nmodule.exports = {\n  type: 'buffer',\n  label: _t('editor.layers.analysis-form.distance'),\n  parametersDataFields: 'type,distance,radius,isolines,dissolved',\n\n  parse: function (nodeAttrs) {\n    var formAttrs = _.extend({}, nodeAttrs);\n\n    try {\n      formAttrs.radius = DistanceConverter.toDistance(nodeAttrs.radius, nodeAttrs.distance);\n      formAttrs.distance = nodeAttrs.distance || DEFAULT_DISTANCE;\n      formAttrs.dissolved = nodeAttrs.dissolved === undefined ? false : nodeAttrs.dissolved;\n      formAttrs.isolines = nodeAttrs.isolines || 1;\n    } catch (err) {\n      formAttrs.radius = 100;\n      formAttrs.isolines = 1;\n      formAttrs.distance = DEFAULT_DISTANCE;\n      formAttrs.dissolved = false;\n    }\n\n    return formAttrs;\n  },\n\n  formatAttrs: function (formAttrs) {\n    return _.defaults(\n      {\n        radius: DistanceConverter.toMeters(formAttrs.radius, formAttrs.distance)\n      },\n      formAttrs\n    );\n  }\n};\n",
    "var _ = require('underscore');\nvar BaseAnalysisFormModel = require('./base-analysis-form-model');\nvar template = require('./area-of-influence-form.tpl');\nvar DistanceConverter = require('../../../../../value-objects/distance-converter');\n\nvar AREA_OF_INFLUENCE_TYPES = require('./area-of-influence-types');\nvar TYPE_TO_META_MAP = {};\nAREA_OF_INFLUENCE_TYPES.map(function (d) {\n  TYPE_TO_META_MAP[d.type] = d;\n});\n\nmodule.exports = BaseAnalysisFormModel.extend({\n\n  parse: function (attrs) {\n    return _.defaults(\n      _.pick(attrs, 'id', 'source'), // maintain default attrs\n      this._typeDef(attrs.type).parse(attrs)\n    );\n  },\n\n  initialize: function () {\n    BaseAnalysisFormModel.prototype.initialize.apply(this, arguments);\n\n    this._setSchema();\n\n    this.on('change:type', this._onTypeChanged, this);\n    this.on('change:distance', this._onDistanceChanged, this);\n    this.on('change:kind', this._onKindChanged, this);\n  },\n\n  getTemplate: function () {\n    return template;\n  },\n\n  getTemplateData: function () {\n    return {parametersDataFields: this._typeDef().parametersDataFields};\n  },\n\n  /**\n   * @override {BaseAnalysisFormModel.updateNodeDefinition}\n   */\n  updateNodeDefinition: function (nodeDefModel) {\n    var attrs = this._formatAttrs(this.attributes);\n    nodeDefModel.clear({silent: true});\n    nodeDefModel.set(attrs);\n  },\n\n  _formatAttrs: function (formAttrs) {\n    var customFormattedFormAttrs = this._typeDef().formatAttrs(formAttrs);\n    return BaseAnalysisFormModel.prototype._formatAttrs.call(this, customFormattedFormAttrs);\n  },\n\n  /**\n   * @override {BaseAnalysisFormModel._setSchema}\n   */\n  _setSchema: function () {\n    BaseAnalysisFormModel.prototype._setSchema.call(this,\n      this._filterSchemaFieldsByType({\n        source: this._primarySourceSchemaItem(),\n        type: {\n          type: 'Radio',\n          text: _t('editor.layers.analysis-form.type'),\n          options: AREA_OF_INFLUENCE_TYPES.map(function (d) {\n            var isAnalysisTypeEnabled = this._analyses.isAnalysisValidByType(d.type, this._configModel);\n            var canChangeToType = this._canChangeToType(d.type);\n            var isDisabled = !isAnalysisTypeEnabled || !canChangeToType;\n            var helpMessage = !isAnalysisTypeEnabled ? _t('editor.layers.analysis-form.disabled-by-config') : _t('editor.layers.analysis-form.valid-type');\n\n            return {\n              val: d.type,\n              label: d.label,\n              disabled: isDisabled,\n              help: isDisabled ? helpMessage : ''\n            };\n          }, this)\n        },\n        distance: {\n          type: 'Radio',\n          title: _t('editor.layers.analysis-form.units'),\n          options: _.map(DistanceConverter.OPTIONS, function (d) {\n            return {\n              val: d.distance,\n              label: this._distanceLabel(d.distance)\n            };\n          }, this)\n        },\n        radius: {\n          type: 'Number',\n          label: _t('editor.layers.analysis-form.radius'),\n          validators: ['required', this._radiusInterval()]\n        },\n        kind: {\n          type: 'Select',\n          title: _t('editor.layers.analysis-form.by'),\n          dialogMode: 'float',\n          options: [\n            {\n              val: 'walk',\n              label: _t('editor.layers.analysis-form.by-walk')\n            }, {\n              val: 'car',\n              label: _t('editor.layers.analysis-form.by-car')\n            }\n          ]\n        },\n        isolines: {\n          type: 'Number',\n          title: _t('editor.layers.analysis-form.tracts'),\n          help: _t('editor.layers.analysis-form.tracts-help'),\n          validators: ['required', {\n            type: 'interval',\n            min: 1,\n            max: 4\n          }]\n        },\n        time: {\n          type: 'Number',\n          title: _t('editor.layers.analysis-form.time-seconds'),\n          validators: ['required', this._timeInterval()]\n        },\n        dissolved: {\n          type: 'Radio',\n          title: _t('editor.layers.analysis-form.boundaries'),\n          options: [\n            {\n              val: 'false',\n              label: _t('editor.layers.analysis-form.intact'),\n              help: _t('editor.layers.analysis-form.intact-help')\n            }, {\n              val: 'true',\n              label: _t('editor.layers.analysis-form.dissolved'),\n              help: _t('editor.layers.analysis-form.dissolved-help')\n            }\n          ]\n        }\n      })\n    );\n  },\n\n  _canChangeToType: function (type) {\n    if (type === this.get('type')) return true;\n\n    var source = this._layerDefinitionModel.findAnalysisDefinitionNodeModel(this.get('source'));\n    return source.isValidAsInputForType(type);\n  },\n\n  _filterSchemaFieldsByType: function (schema) {\n    // Always include the source field in addition to the type-specific fields\n    var fields = ['source'].concat(this._typeDef().parametersDataFields.split(','));\n    return _.pick(schema, fields);\n  },\n\n  _onTypeChanged: function () {\n    this._replaceAttrs();\n    this._setSchema();\n  },\n\n  _onDistanceChanged: function () {\n    this._fitParamToRange('radius', this._radiusInterval());\n    this._setSchema();\n  },\n\n  _onKindChanged: function () {\n    this._fitParamToRange('time', this._timeInterval());\n    this._setSchema();\n  },\n\n  _fitParamToRange: function (paramName, range) {\n    var val = this.get(paramName);\n    if (val < range.min) {\n      val = range.min;\n    } else if (val > range.max) {\n      val = range.max;\n    }\n    this.set(paramName, val, {silent: true});\n  },\n\n  _replaceAttrs: function () {\n    var attrs = this.parse(this.attributes);\n    this.clear({silent: true});\n    this.set('type', attrs.type, {silent: true}); // re-set type to avoid change:type event to trigger again\n    this.set(attrs);\n  },\n\n  _typeDef: function (type) {\n    type = type || this.get('type');\n    return TYPE_TO_META_MAP[type];\n  },\n\n  _radiusInterval: function () {\n    switch (this.get('distance')) {\n      case 'meters':\n        return {\n          type: 'interval',\n          min: 10,\n          max: 10000\n        };\n      case 'kilometers':\n      case 'miles':\n        return {\n          type: 'interval',\n          min: 0.5,\n          max: 100,\n          step: 0.5\n        };\n      default:\n        return {\n          type: 'interval',\n          min: 1,\n          max: 100\n        };\n    }\n  },\n\n  _timeInterval: function () {\n    switch (this.get('kind')) {\n      case 'car':\n        return {\n          type: 'interval',\n          min: 60,\n          max: 14400,\n          step: 10\n        };\n      case 'walk':\n      default:\n        return {\n          type: 'interval',\n          min: 60,\n          max: 3600\n        };\n    }\n  },\n\n  _distanceLabel: function (distance) {\n    switch (distance) {\n      case 'meters':\n        return _t('editor.layers.analysis-form.meters');\n      case 'kilometers':\n        return _t('editor.layers.analysis-form.kilometers');\n      case 'miles':\n        return _t('editor.layers.analysis-form.miles');\n      default:\n        return '';\n    }\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<form>\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">2</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('analyses.area-of-influence.title') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.reference-layer-pluralize', { smart_count: 1 }) ))==null?'':_.escape(__t))+\n'</p>\\n      <div class=\"u-tSpace-xl CDB-Text CDB-Fieldset\">\\n        <p class=\"CDB-Legend u-upperCase u-iBlock CDB-Text is-semibold CDB-Size-small u-rSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.input') ))==null?'':_.escape(__t))+\n'</p>\\n        <div class=\"Editor-formInput u-ellipsis\" data-editors=\"source\"></div>\\n      </div>\\n    </div>\\n  </div>\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">3</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"'+\n((__t=( parametersDataFields ))==null?'':_.escape(__t))+\n'\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.layers.analysis-form.parameters') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--xl\">'+\n((__t=( _t('editor.layers.analysis-form.parameters-description') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n</form>\\n';\n}\nreturn __p;\n};\n",
    "module.exports = {\n  type: 'trade-area',\n  label: _t('editor.layers.analysis-form.time'),\n  parametersDataFields: 'type,kind,time,isolines,dissolved',\n\n  parse: function (nodeAttrs) {\n    return {\n      type: 'trade-area',\n      kind: nodeAttrs.kind || 'walk',\n      isolines: nodeAttrs.isolines || 1,\n      time: nodeAttrs.time || 100,\n      dissolved: nodeAttrs.dissolved === 'true' || nodeAttrs.dissolved === true\n    };\n  },\n\n  formatAttrs: function (formAttrs) {\n    return formAttrs;\n  }\n};\n",
    "module.exports = [\n  require('./area-of-influence-buffer'),\n  require('./area-of-influence-trade-area')\n];\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='WITH dep_fns AS (\\n    SELECT oid, proname, proargnames, proargtypes FROM pg_catalog.pg_proc WHERE proname ~* \\'^dep_ext_\\'\\n),\\nfns_argstypes AS (SELECT oid, array_agg((\\n        SELECT\\n        CASE\\n            WHEN typcategory = \\'A\\' THEN \\'array\\'\\n            WHEN typcategory = \\'N\\' THEN \\'number\\'\\n            WHEN typcategory = \\'S\\' THEN \\'string\\'\\n            WHEN typcategory = \\'B\\' THEN \\'boolean\\'\\n        ELSE \\'unknown\\' END\\n        FROM pg_catalog.pg_type\\n        WHERE argtype = pg_catalog.pg_type.oid\\n    )) as argtypes\\n    FROM (\\n        SELECT pg_proc.oid, unnest(pg_proc.proargtypes) as argtype\\n        FROM pg_catalog.pg_proc, dep_fns\\n        WHERE pg_proc.oid = dep_fns.oid\\n    ) _q\\n    group by oid\\n),\\nfns_meta AS (\\n    SELECT\\n        dep_fns.proname,\\n        dep_fns.proargnames,\\n        fns_argstypes.argtypes,\\n        CASE WHEN fns_argstypes.argtypes[6] = \\'array\\' THEN\\n            -- [whether it has a secondary node or not, where the extra parameters start, where to stop]\\n            ARRAY[1,7,array_length(argtypes,1)]\\n        ELSE\\n            ARRAY[0,5,array_length(argtypes,1)]\\n        END as p\\n    FROM dep_fns, fns_argstypes\\n    WHERE dep_fns.oid = fns_argstypes.oid\\n)\\nSELECT\\n    proname as fn_name,\\n    proargnames[p[2]:p[3]] as params_names,\\n    argtypes[p[2]:p[3]] as params_types,\\n    p[1]::boolean as has_secondary_node\\nFROM fns_meta\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar camshaftReference = require('../../../../../data/camshaft-reference');\nvar layerColors = require('../../../../../data/layer-colors');\n\n/**\n * Base model for all analysis form models.\n */\nmodule.exports = Backbone.Model.extend({\n\n  initialize: function (attrs, opts) {\n    if (!opts.analyses) throw new Error('analyses is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.layerDefinitionModel) throw new Error('layerDefinitionModel is required');\n    if (!opts.analysisSourceOptionsModel) throw new Error('analysisSourceOptionsModel is required');\n\n    this._analyses = opts.analyses;\n    this._configModel = opts.configModel;\n    this._layerDefinitionModel = opts.layerDefinitionModel;\n    this._analysisSourceOptionsModel = opts.analysisSourceOptionsModel;\n\n    this.schema = {};\n  },\n\n  isNew: function () {\n    return true; // so one can call .destroy() on it to clean up bindings etc. and have it removed from its collection\n  },\n\n  getTemplate: function () {\n    return undefined; // override to return custom template\n  },\n\n  getTemplateData: function () {\n    return undefined; // override to return custom template data\n  },\n\n  _getSourceOption: function () {\n    var sourceNodeDefModel = this._layerDefinitionModel.findAnalysisDefinitionNodeModel(this.get('source'));\n    return sourceNodeDefModel && [{\n      val: sourceNodeDefModel.id,\n      type: 'node',\n      nodeTitle: this._analyses.title(sourceNodeDefModel),\n      layerName: this._layerDefinitionModel.getName(),\n      color: layerColors.getColorForLetter(sourceNodeDefModel.letter())\n    }];\n  },\n\n  _primarySourceSchemaItem: function (customLabel) {\n    return {\n      type: 'NodeDataset',\n      title: customLabel || _t('editor.layers.analysis-form.source'),\n      dialogMode: 'float',\n      options: this._getSourceOption(),\n      editorAttrs: {disabled: true}\n    };\n  },\n\n  setFormValidationErrors: function (errors) {\n    this._formValidationErrors = errors;\n    this.trigger('change', this);\n  },\n\n  validate: function () {\n    var errors = _.extend(\n      {},\n      camshaftReference.validate(this.attributes),\n      this._formValidationErrors\n    );\n\n    if (!_.isEmpty(errors)) {\n      return errors;\n    }\n  },\n\n  /**\n   * @override {Backbone.Model.prototype.set} Maintain persisted attr if model is clear'ed\n   */\n  set: function (key, val, options) {\n    if (key == null) return this;\n\n    var attrs;\n    if (typeof key === 'object') {\n      attrs = key;\n      options = val;\n    } else {\n      (attrs = {})[key] = val;\n    }\n\n    options || (options = {});\n\n    var persisted = attrs.persisted || this.get('persisted');\n\n    Backbone.Model.prototype.set.call(this, attrs, options);\n\n    if (persisted !== undefined) {\n      Backbone.Model.prototype.set.call(this, 'persisted', persisted, {silent: true});\n    }\n\n    return this;\n  },\n\n  updateNodeDefinition: function (nodeDefModel) {\n    var nodeAttrs = this._formatAttrs(this.attributes);\n    nodeDefModel.set(nodeAttrs);\n  },\n\n  /**\n   * @deprecated use updateNodeDefinition instead\n   */\n  _updateNodeDefinition: function () {\n    this.updateNodeDefinition.apply(this, arguments);\n  },\n\n  createNodeDefinition: function (userActions) {\n    var nodeAttrs = this._formatAttrs(this.attributes);\n    this.set('persisted', true);\n    return userActions.createAnalysisNode(nodeAttrs, this._layerDefinitionModel);\n  },\n\n  _formatAttrs: function (formAttrs) {\n    return _.omit(camshaftReference.parse(formAttrs), 'persisted');\n  },\n\n  _setSchema: function (schema) {\n    this.schema = schema;\n    this.trigger('changeSchema', this);\n  },\n\n  _isPrimarySource: function (sourceAttrName) {\n    return sourceAttrName === this.get('primary_source_name');\n  },\n\n  _isFetchingOptions: function () {\n    return this._analysisSourceOptionsModel.get('fetching');\n  },\n\n  _getSourceOptionsForSource: function (options) {\n    options = options || {};\n    var sourceAttrName = null;\n    var requiredSimpleGeometryType = '*';\n    var ignorePrimarySource = false;\n    var includeSourceNode = options.includeSourceNode || false;\n\n    // options validation and defaults\n    if (options.sourceAttrName === void 0) {\n      throw new Error('sourceAttrName is required.');\n    } else {\n      sourceAttrName = options.sourceAttrName;\n    }\n\n    if (options.requiredSimpleGeometryType !== void 0) {\n      requiredSimpleGeometryType = options.requiredSimpleGeometryType;\n    }\n\n    if (options.ignorePrimarySource) {\n      ignorePrimarySource = true;\n    }\n\n    var currentSource = this.get(sourceAttrName);\n\n    if (!ignorePrimarySource && this._isPrimarySource(sourceAttrName)) {\n      return [currentSource];\n    }\n    if (this._isFetchingOptions()) {\n      return [{\n        val: currentSource,\n        label: _t('editor.layers.analysis-form.loading'),\n        isLoading: true\n      }];\n    } else {\n      // fetched\n      var sourceId = this._layerDefinitionModel.get('source');\n      return this._analysisSourceOptionsModel\n        .getSelectOptions(requiredSimpleGeometryType)\n        .filter(function (d) {\n          return (\n            (includeSourceNode ? true : d.val !== sourceId) &&\n            (options.onlyNodes ? d.type === 'node' : true)\n          );\n        });\n    }\n  }\n});\n",
    "var _ = require('underscore');\nvar BaseAnalysisFormModel = require('./base-analysis-form-model');\nvar template = require('./centroid-form.tpl');\nvar ColumnOptions = require('../column-options');\n\nvar FORMAT_FIELD_NAMES = 'category_column,aggregation,aggregation_column,weight_column';\nvar PARAMETERS_DATA_FIELDS = 'source,category,weight';\n\n/**\n * Form model for a centroid and weighted-centroid analysis\n * It has a rather complicated schema, that depends on several data points and state.\n * https://github.com/CartoDB/camshaft/blob/master/reference/versions/0.38.0/reference.json\n */\n\nmodule.exports = BaseAnalysisFormModel.extend({\n  parse: function (attrs) {\n    var operator = {\n      operator: attrs.aggregation || 'count',\n      attribute: attrs.aggregation === 'count' ? '' : attrs.aggregation_column\n    };\n\n    var aggregate_value = (!!attrs.aggregation_column || !!attrs.aggregation) ? operator : '';\n\n    return _.extend(attrs, {\n      category: attrs.category_column || '',\n      weight: attrs.weight_column || '',\n      aggregate: aggregate_value\n    });\n  },\n\n  initialize: function () {\n    BaseAnalysisFormModel.prototype.initialize.apply(this, arguments);\n\n    this._columnOptions = new ColumnOptions({}, {\n      configModel: this._configModel,\n      nodeDefModel: this._layerDefinitionModel.findAnalysisDefinitionNodeModel(this.get('source'))\n    });\n\n    this.listenTo(this._columnOptions, 'columnsFetched', this._setSchema);\n\n    this.on('change:category', this._onChangeCategory, this);\n    this.on('change:aggregate', this._updateAggregation, this);\n    this.on('change:weight', this._onChangeWeight, this);\n    this.on('change:type', this._setSchema, this);\n\n    this._updateAggregation();\n\n    this._setSchema();\n  },\n\n  updateNodeDefinition: function (nodeDefModel) {\n    var attrs = this._formatAttrs(this.attributes);\n    nodeDefModel.clear({silent: true});\n    nodeDefModel.set(attrs);\n  },\n\n  _getFormatFieldNames: function () {\n    var fields = FORMAT_FIELD_NAMES.split(',');\n\n    if (this.get('aggregate') === '') {\n      fields = _.difference(fields, ['aggregation', 'aggregation_column']);\n    }\n\n    return fields.join(',');\n  },\n\n  _formatAttrs: function (formAttrs) {\n    var customFormattedFormAttrs = _.pick(formAttrs, ['id', 'source', 'type'].concat(this._getFormatFieldNames().split(',')));\n\n    return BaseAnalysisFormModel.prototype._formatAttrs.call(this, customFormattedFormAttrs);\n  },\n\n  getTemplate: function () {\n    return template;\n  },\n\n  getTemplateData: function () {\n    return {\n      parametersDataFields: PARAMETERS_DATA_FIELDS\n    };\n  },\n\n  /*\n  /**\n   * @override {BaseAnalysisFormModel._setSchema}\n   */\n  _setSchema: function () {\n    var operator = {\n      operator: this.get('aggregation'),\n      attribute: this.get('aggregation_column')\n    };\n\n    BaseAnalysisFormModel.prototype._setSchema.call(this, {\n      source: this._primarySourceSchemaItem(),\n\n      category: {\n        type: 'EnablerEditor',\n        title: '',\n        label: _t('editor.layers.analysis-form.categorize-by'),\n        help: _t('editor.layers.analysis-form.categorize-by-help'),\n        editor: {\n          type: 'Select',\n          options: this._columnOptions.all(),\n          dialogMode: 'float',\n          label: _t('editor.layers.analysis-form.column')\n        }\n      },\n\n      weight: {\n        type: 'EnablerEditor',\n        title: '',\n        label: _t('editor.layers.analysis-form.weighted-by'),\n        help: _t('editor.layers.analysis-form.weighted-by-help'),\n        validators: ['required'],\n        editor: {\n          type: 'Select',\n          options: this._columnOptions.filterByType('number'),\n          dialogMode: 'float',\n          label: _t('editor.layers.analysis-form.column')\n        }\n      },\n\n      aggregate: {\n        type: 'EnablerEditor',\n        title: '',\n        label: _t('editor.layers.analysis-form.aggregate-by'),\n        help: _t('editor.layers.analysis-form.aggregate-by-help'),\n        defaultValue: operator,\n        editor: {\n          type: 'Operators',\n          options: this._columnOptions.filterByType('number'),\n          dialogMode: 'float',\n          label: _t('editor.layers.analysis-form.column')\n        }\n      }\n    });\n  },\n\n  _onChangeWeight: function () {\n    if (this.get('weight') !== '') {\n      this.set('type', 'weighted-centroid');\n      this.set('weight_column', this.get('weight'));\n    } else {\n      this.set('type', 'centroid');\n      this.unset('weight_column');\n    }\n    this._setSchema();\n  },\n\n  _onChangeCategory: function () {\n    // category_column is optional but if we send it empty,\n    // it has influence in the final result\n    if (this.get('category') === '') {\n      this.unset('category_column');\n    } else {\n      this.set('category_column', this.get('category'));\n    }\n    this._setSchema();\n  },\n\n  _updateAggregation: function () {\n    var aggregate = this.get('aggregate');\n    if (aggregate === '') {\n      this.set({\n        aggregation: 'count',\n        aggregation_column: ''\n      });\n    } else {\n      this.set({\n        aggregation_column: aggregate.attribute,\n        aggregation: aggregate.operator\n      });\n    }\n\n    this._setSchema();\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<form>\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">2</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"'+\n((__t=( parametersDataFields ))==null?'':__t)+\n'\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('analyses.centroid.title') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.input-layer') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">3</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"aggregate\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.layers.analysis-form.value-aggregation') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--xl\">'+\n((__t=( _t('editor.layers.analysis-form.value-aggregation-centroids') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n</form>\\n';\n}\nreturn __p;\n};\n",
    "var BaseAnalysisFormModel = require('./base-analysis-form-model');\nvar ColumnOptions = require('../column-options');\nvar template = require('./closest-form.tpl');\n\nvar MAX_RESPONSES = 32;\n\nmodule.exports = BaseAnalysisFormModel.extend({\n  parse: function (attrs) {\n    if (!attrs.responses) {\n      attrs.responses = 1;\n    }\n\n    return attrs;\n  },\n\n  initialize: function () {\n    BaseAnalysisFormModel.prototype.initialize.apply(this, arguments);\n\n    this._resetColumnOptions();\n    this._initBinds();\n    this._setSchema();\n    this._fetchColumns();\n  },\n\n  _initBinds: function () {\n    this.listenTo(this._analysisSourceOptionsModel, 'change:fetching', this._onSourceOptionsFetched);\n    this.on('change:target', this._onChangeTarget, this);\n  },\n\n  getTemplate: function () {\n    return template;\n  },\n\n  getTemplateData: function () {\n    return {};\n  },\n\n  _resetColumnOptions: function () {\n    this._columnOptions = new ColumnOptions({}, {\n      configModel: this._configModel\n    });\n    this.listenTo(this._columnOptions, 'columnsFetched', this._onColumnsFetched);\n  },\n\n  _onSourceOptionsFetched: function () {\n    this._setSchema();\n  },\n\n  _setSchema: function () {\n    BaseAnalysisFormModel.prototype._setSchema.call(this, {\n      source: this._primarySourceSchemaItem(_t('editor.layers.analysis-form.find-nearest.input')),\n      target: {\n        type: 'NodeDataset',\n        title: _t('editor.layers.analysis-form.find-nearest.target'),\n        options: this._getSourceOptionsForSource({\n          sourceAttrName: 'target',\n          includeSourceNode: true\n        }),\n        dialogMode: 'float',\n        validators: ['required'],\n        editorAttrs: {\n          disabled: this._isSourceDisabled('target')\n        }\n      },\n      category: {\n        type: 'EnablerEditor',\n        title: '',\n        label: _t('editor.layers.analysis-form.find-nearest.categorized'),\n        help: _t('editor.layers.analysis-form.find-nearest.categorized-help'),\n        editor: {\n          type: 'Select',\n          options: this._columnOptions.filterByType('string'),\n          dialogMode: 'float',\n          editorAttrs: {\n            showLabel: false\n          }\n        }\n      },\n      responses: {\n        type: 'Number',\n        title: _t('editor.layers.analysis-form.find-nearest.max-results'),\n        value: 1,\n        validators: ['required', {\n          type: 'interval',\n          min: 1,\n          max: MAX_RESPONSES\n        }]\n      }\n    });\n  },\n\n  _isSourceDisabled: function (sourceAttrName) {\n    return this._isPrimarySource(sourceAttrName) || this._isFetchingOptions();\n  },\n\n  _onChangeTarget: function () {\n    this.set('category', '');\n    this._setSchema();\n\n    this._analysisSourceOptionsModel.createSourceNodeUnlessExisting(this.get('target'));\n    this._fetchColumns();\n  },\n\n  _fetchColumns: function () {\n    var target = this.get('target');\n\n    var nodeDefModel = this._layerDefinitionModel.findAnalysisDefinitionNodeModel(target);\n\n    if (nodeDefModel) {\n      this._columnOptions.setNode(nodeDefModel);\n    } else if (target) {\n      this._columnOptions.setDataset(target);\n    }\n  },\n\n  _onColumnsFetched: function () {\n    this._setSchema();\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<form>\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">2</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"source,target\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.layers.analysis-form.find-nearest.title') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.find-nearest.criteria') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">3</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"responses,category\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.layers.analysis-form.find-nearest.define-params') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.find-nearest.define-params-desc') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n</form>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar BaseAnalysisFormModel = require('./base-analysis-form-model');\nvar template = require('./connect-with-lines.tpl');\nvar ColumnOptions = require('../column-options');\n\nvar CONNECT_WITH_LINES = require('./connect-with-lines-types');\n\nvar TYPE_TO_META_MAP = {};\nCONNECT_WITH_LINES.map(function (d) {\n  TYPE_TO_META_MAP[d.type] = d;\n});\n\n/**\n * Form model for a convex hull analysis\n */\nmodule.exports = BaseAnalysisFormModel.extend({\n  defaults: {\n    closest: true,\n    order_type: 'asc'\n  },\n\n  parse: function (attrs) {\n    return _.defaults(\n      _.pick(attrs, 'id', 'source'), // maintain default attrs\n      this._typeDef(attrs.type).parse(attrs)\n    );\n  },\n\n  validate: function () {\n    var errors = BaseAnalysisFormModel.prototype.validate.apply(this, arguments);\n\n    if (errors && errors.target_column) {\n      if (!this._hasSecondGeometry()) {\n        errors.target_column = _t('editor.layers.analysis-form.second-geom-required');\n      }\n    }\n\n    return errors;\n  },\n\n  initialize: function () {\n    BaseAnalysisFormModel.prototype.initialize.apply(this, arguments);\n\n    this._columnOptions = new ColumnOptions({}, {\n      configModel: this._configModel,\n      nodeDefModel: this._layerDefinitionModel.findAnalysisDefinitionNodeModel(this.get('source'))\n    });\n\n    this._targetColumnOptions = new ColumnOptions({}, {\n      configModel: this._configModel,\n      nodeDefModel: this._layerDefinitionModel.findAnalysisDefinitionNodeModel(this.get('source'))\n    });\n\n    this.listenTo(this._columnOptions, 'columnsFetched', this._setSchema);\n    this.listenTo(this._targetColumnOptions, 'columnsFetched', this._setSchema);\n    this.listenTo(this._analysisSourceOptionsModel, 'change:fetching', this._setSchema);\n\n    this.on('change:target', this._onChangeTarget, this);\n    this.on('change:type', this._onTypeChanged, this);\n    this.on('change:group', this._setSchema, this);\n\n    this._setSchema();\n    this._fetchColumns();\n  },\n\n  _onTypeChanged: function () {\n    this._replaceAttrs();\n    this._setSchema();\n  },\n\n  _replaceAttrs: function () {\n    var attrs = this.parse(this.attributes);\n    this.clear({ silent: true });\n    this.set('type', attrs.type, { silent: true }); // re-set type to avoid change:type event to trigger again\n    this.set(_.extend(attrs, this.defaults));\n  },\n\n  updateNodeDefinition: function (nodeDefModel) {\n    var attrs = this._formatAttrs(this.attributes);\n    nodeDefModel.clear({ silent: true });\n    nodeDefModel.set(attrs);\n  },\n\n  _formatAttrs: function (formAttrs) {\n    var customFormattedFormAttrs = this._typeDef().formatAttrs(formAttrs, this._columnOptions);\n    return BaseAnalysisFormModel.prototype._formatAttrs.call(this, customFormattedFormAttrs);\n  },\n\n  getTemplate: function () {\n    return template;\n  },\n\n  getTemplateData: function () {\n    return {\n      type: this.get('type'),\n      group: this.get('group'),\n      parametersDataFields: this._typeDef().parametersDataFields\n    };\n  },\n\n  _filterSchemaFieldsByType: function (schema) {\n    // Always include the source field in addition to the type-specific fields\n    var fields = ['source', 'type'].concat(this._typeDef().parametersDataSchema.split(','));\n    return _.pick(schema, fields);\n  },\n\n  /**\n   * @override {BaseAnalysisFormModel._setSchema}\n   */\n  _setSchema: function () {\n    BaseAnalysisFormModel.prototype._setSchema.call(this, this._filterSchemaFieldsByType({\n      source: this._primarySourceSchemaItem(),\n      type: {\n        type: 'Select',\n        title: _t('editor.layers.analysis-form.type'),\n        dialogMode: 'float',\n        options: CONNECT_WITH_LINES.map(function (d) {\n          return {\n            val: d.type,\n            label: d.label\n          };\n        }, this)\n      },\n      source_column: {\n        type: 'Select',\n        title: _t('editor.layers.analysis-form.source'),\n        dialogMode: 'float',\n        options: this._getColumnOptions('source_column', ['string', 'number'])\n      },\n      target: {\n        type: 'NodeDataset',\n        title: _t('editor.layers.analysis-form.target'),\n        options: this._getSourceOptionsForSource('target', 'point'),\n        dialogMode: 'float',\n        editorAttrs: {\n          disabled: this._isSourceDisabled('target')\n        },\n        validators: ['required']\n      },\n      target_column: {\n        type: 'Select',\n        title: _t('editor.layers.analysis-form.target-column'),\n        dialogMode: 'float',\n        options: this._getColumnOptionsForTarget()\n      },\n      target_source_column: {\n        type: 'Select',\n        title: _t('editor.layers.analysis-form.target-column'),\n        options: this._getTargetSourceColumnOptions('target_source_column'),\n        dialogMode: 'float',\n        editorAttrs: {\n          disabled: this._isTargetColumnDisabled()\n        }\n      },\n      destination_longitude: {\n        type: 'Text',\n        title: _t('editor.layers.analysis-form.longitude'),\n        validators: ['required'],\n        editorAttrs: {\n          placeholder: _t('editor.layers.analysis-form.enter-longitude')\n        }\n      },\n      destination_latitude: {\n        type: 'Text',\n        title: _t('editor.layers.analysis-form.latitude'),\n        validators: ['required'],\n        editorAttrs: {\n          placeholder: _t('editor.layers.analysis-form.enter-latitude')\n        }\n      },\n      closest: {\n        type: 'Radio',\n        title: 'closest',\n        options: [\n          { label: _t('editor.layers.analysis-form.to-closest'), val: 'true' },\n          { label: _t('editor.layers.analysis-form.all-to-all'), val: 'false' }\n        ]\n      },\n      group: {\n        type: 'Enabler',\n        label: _t('editor.layers.analysis-form.group-by'),\n        title: '',\n        editorAttrs: {\n          reversed: true\n        }\n      },\n      category_column: {\n        type: 'EnablerEditor',\n        title: '',\n        label: _t('editor.layers.analysis-form.group-by'),\n        editor: {\n          type: 'Select',\n          options: this._columnOptions.all(),\n          dialogMode: 'float',\n          editorAttrs: {\n            showLabel: false\n          }\n        }\n      },\n      order_column: {\n        type: 'Select',\n        title: _t('editor.layers.analysis-form.order-by'),\n        options: this._columnOptions.filterByType(['date', 'number']),\n        dialogMode: 'float',\n        validators: ['required']\n      },\n      order_type: {\n        type: 'Radio',\n        title: _t('editor.layers.analysis-form.order'),\n        options: [\n          { label: _t('editor.layers.analysis-form.asc'), val: 'asc' },\n          { label: _t('editor.layers.analysis-form.desc'), val: 'desc' }\n        ]\n      }\n    }));\n  },\n\n  _onChangeTarget: function () {\n    this.set('target_source_column', '');\n    this._analysisSourceOptionsModel.createSourceNodeUnlessExisting(this.get('target'));\n    this._fetchColumns();\n  },\n\n  _fetchColumns: function () {\n    var target = this.get('target');\n    var nodeDefModel = this._layerDefinitionModel.findAnalysisDefinitionNodeModel(target);\n\n    if (nodeDefModel) {\n      this._targetColumnOptions.setNode(nodeDefModel);\n    } else if (target) {\n      this._targetColumnOptions.setDataset(target);\n    }\n  },\n\n  _getColumnOptionsForTarget: function () {\n    var columns = this._getColumnOptions('target_column', 'geometry');\n\n    return _.reject(columns, function (column) {\n      return (column.val === 'the_geom' || column.val === 'the_geom_webmercator');\n    }, this);\n  },\n\n  _getColumnOptions: function (attr, attrType) {\n    var opts = this._columnOptions.filterByType(attrType);\n\n    if (this._columnOptions.get('columnsFetched') && this.get(attr)) {\n      var attrExists = false;\n      var value = this.get(attr);\n\n      var customValue = {\n        val: value,\n        label: '\"' + value + '\"'\n      };\n\n      if (opts && opts.length) {\n        attrExists = _.find(opts, function (attr) {\n          return attr.val === customValue.val;\n        });\n      }\n\n      if (!attrExists) {\n        opts.push(customValue);\n        opts = _.sortBy(opts, function (d) {\n          return d.val;\n        });\n      }\n    }\n\n    return opts;\n  },\n\n  _getTargetSourceColumnOptions: function (attr) {\n    var opts = this._targetColumnOptions.all();\n\n    if (this._targetColumnOptions.get('columnsFetched') && this.get(attr)) {\n      var attrExists = false;\n      var value = this.get(attr);\n\n      var customValue = {\n        val: value,\n        label: '\"' + value + '\"'\n      };\n\n      if (opts && opts.length) {\n        attrExists = _.find(opts, function (attr) {\n          return attr.val === customValue.val;\n        });\n      }\n\n      if (!attrExists) {\n        opts.push(customValue);\n        opts = _.sortBy(opts, function (d) {\n          return d.val;\n        });\n      }\n    }\n    return opts;\n  },\n\n  _typeDef: function (type) {\n    type = type || this.get('type');\n    return TYPE_TO_META_MAP[type];\n  },\n\n  _getSourceOptionsForSource: function (sourceAttrName, requiredSimpleGeometryType) {\n    var currentSource = this.get(sourceAttrName);\n\n    if (this._isFetchingOptions()) {\n      return [{\n        val: currentSource,\n        label: _t('editor.layers.analysis-form.loading'),\n        isLoading: true\n      }];\n    } else {\n      // fetched\n      var source = this._getSourceOption()[0];\n      return this._analysisSourceOptionsModel\n      .getSelectOptions(requiredSimpleGeometryType)\n      .filter(function (d) {\n        return d.val !== source.val && d.val !== source.layerName;\n      });\n    }\n  },\n\n  _hasSecondGeometry: function () {\n    return this._getColumnOptionsForTarget().length;\n  },\n\n  _isTargetColumnDisabled: function () {\n    return !this._targetColumnOptions.get('columnsFetched');\n  },\n\n  _isSourceDisabled: function (sourceAttrName) {\n    return this._isPrimarySource(sourceAttrName) || this._isFetchingOptions();\n  }\n});\n",
    "module.exports = [\n  require('./connect-with-lines/line-to-single-point'),\n  require('./connect-with-lines/line-to-column'),\n  require('./connect-with-lines/line-source-to-target'),\n  require('./connect-with-lines/line-sequential')\n];\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<form>\\n  <div class=\"Editor-HeaderInfo Editor-HeaderInfo--noMargin\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">3</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"'+\n((__t=( parametersDataFields ))==null?'':__t)+\n'\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('analyses.connect-with-lines.title') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--xl\">'+\n((__t=( _t('editor.layers.analysis-form.define-reference-and-target') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n\\n  ';\n if (type == 'line-sequential') { \n__p+='\\n    <div class=\"Editor-HeaderInfo\">\\n      <div class=\"Editor-HeaderPad u-rSpace--m\"></div>\\n        <div class=\"Editor-checker\" data-fields=\"category_column\"></div>\\n      </div>\\n    </div>\\n  ';\n } \n__p+='\\n\\n  ';\n if (type == 'line-source-to-target') { \n__p+='\\n    <div class=\"Editor-HeaderInfo\">\\n      <div class=\"Editor-HeaderPad u-rSpace--m\"></div>\\n      <div class=\"Editor-HeaderInfo-inner CDB-Text\">\\n\\n        <div class=\"Editor-checker Editor-checker--slim u-flex u-alignCenter\" data-fields=\"group\"></div>\\n\\n        ';\n if (group) { \n__p+='\\n          <div class=\"Editor-formInner--nested\">\\n            <div class=\"CDB-Text Editor-formInner Editor-formInner--noMargin\">\\n              <p class=\"CDB-Legend u-upperCase u-iBlock CDB-Text is-semibold CDB-Size-small u-rSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.source-col') ))==null?'':_.escape(__t))+\n'</p>\\n              <div class=\"Editor-formInput\" data-editors=\"source_column\"></div>\\n            </div>\\n\\n            <div class=\"CDB-Text Editor-formInner\">\\n              <p class=\"CDB-Legend u-upperCase u-iBlock CDB-Text is-semibold CDB-Size-small u-rSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.target-col') ))==null?'':_.escape(__t))+\n'</p>\\n              <div class=\"Editor-formInput\" data-editors=\"target_source_column\"></div>\\n            </div>\\n          </div>\\n        ';\n } \n__p+='\\n      </div>\\n    </div>\\n  ';\n } \n__p+='\\n</form>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\n\nmodule.exports = {\n  type: 'line-sequential',\n  label: _t('editor.layers.analysis-form.line-sequential'),\n  parametersDataFields: 'source,type,order_column,order_type',\n  parametersDataSchema: 'order_column,order_type,category_column',\n\n  parse: function (nodeAttrs) {\n    return {\n      type: 'line-sequential',\n      order_column: nodeAttrs.order_column,\n      category_column: nodeAttrs.category_column,\n      order_type: nodeAttrs.order_type\n    };\n  },\n\n  formatAttrs: function (formAttrs, columnOptions) {\n    if (!formAttrs.category_column) {\n      formAttrs = _.omit(formAttrs, 'category_column');\n    }\n    return formAttrs;\n  }\n};\n",
    "var _ = require('underscore');\n\nmodule.exports = {\n  type: 'line-source-to-target',\n  label: _t('editor.layers.analysis-form.line-source-to-target'),\n  parametersDataFields: 'source,type,target,closest',\n  parametersDataSchema: 'target,closest,group,source_column,target_source_column',\n\n  parse: function (nodeAttrs) {\n    return {\n      type: 'line-source-to-target',\n      target: nodeAttrs.target,\n      closest: nodeAttrs.closest,\n      source_column: nodeAttrs.source_column,\n      group: nodeAttrs.target_column && nodeAttrs.source_column,\n      target_source_column: nodeAttrs.target_column\n    };\n  },\n\n  formatAttrs: function (formAttrs, columnOptions) {\n    formAttrs.target_column = formAttrs.target_source_column;\n\n    if (!formAttrs.group) {\n      formAttrs = _.omit(formAttrs, ['source_column', 'target_column']);\n    }\n\n    formAttrs = _.omit(formAttrs, ['target_source_column', 'group']);\n    return formAttrs;\n  }\n};\n",
    "module.exports = {\n  type: 'line-to-column',\n  label: _t('editor.layers.analysis-form.line-to-column'),\n\n  parametersDataFields: 'source,type,target_column',\n  parametersDataSchema: 'target_column',\n\n  parse: function (nodeAttrs, options) {\n    return {\n      type: 'line-to-column',\n      target_column: nodeAttrs.target_column\n    };\n  },\n\n  formatAttrs: function (formAttrs, columnOptions) {\n    return formAttrs;\n  }\n};\n",
    "module.exports = {\n  type: 'line-to-single-point',\n  label: _t('editor.layers.analysis-form.line-to-single-point'),\n\n  parametersDataFields: 'source,type,destination_longitude,destination_latitude',\n  parametersDataSchema: 'destination_longitude,destination_latitude',\n\n  parse: function (nodeAttrs) {\n    return {\n      type: 'line-to-single-point',\n      destination_longitude: nodeAttrs.destination_longitude,\n      destination_latitude: nodeAttrs.destination_latitude\n    };\n  },\n\n  formatAttrs: function (formAttrs, columnOptions) {\n    return formAttrs;\n  }\n};\n",
    "var BaseAnalysisFormModel = require('./base-analysis-form-model');\nvar template = require('./data-observatory-measure.tpl');\nvar DataObservartoryMetadata = require('../data-observatory-metadata');\nvar Utils = require('../../../../../helpers/utils');\n\nmodule.exports = BaseAnalysisFormModel.extend({\n  initialize: function () {\n    BaseAnalysisFormModel.prototype.initialize.apply(this, arguments);\n\n    this.nodeDefModel = this._layerDefinitionModel.findAnalysisDefinitionNodeModel(this.get('source'));\n\n    this.doMetadata = new DataObservartoryMetadata(null, {\n      configModel: this._configModel,\n      geometryType: null\n    });\n\n    // check if the geometry type is available, if not wait until it's finished\n    if (this.nodeDefModel.queryGeometryModel.isFetched()) {\n      this._fetchDOMetadata();\n    } else {\n      this.nodeDefModel.queryGeometryModel.once('change:status', this._fetchDOMetadata, this);\n    }\n    this._setSchema();\n  },\n\n  _formatAttrs: function (formAttrs) {\n    formAttrs.final_column = Utils.sanitizeString(formAttrs.final_column);\n    return BaseAnalysisFormModel.prototype._formatAttrs.call(this, formAttrs);\n  },\n\n  _fetchDOMetadata: function () {\n    var simpleGeometryType = this.nodeDefModel.queryGeometryModel.get('simple_geom') || 'point';\n    this.doMetadata.setGeometryType(simpleGeometryType);\n    this.listenTo(this.doMetadata, 'sync', this._setSchema);\n    this.on('change:area', this._areaChanged, this);\n    this.on('change:measurement', this._measurementChanged, this);\n    this.on('change:segments', this._setSegment, this);\n    this.doMetadata.fetch();\n  },\n\n  _areaChanged: function () {\n    this.set({ measurement: '', segments: '' }, { silent: true });\n    this._setSchema();\n  },\n\n  _measurementChanged: function () {\n    this.set({ segments: '' }, { silent: true });\n    this._setSchema();\n  },\n\n  _normalizeSegment: function (s) {\n    return s.replace(/\\./g, '_', /\\-/g, '_');\n  },\n\n  _setSegment: function () {\n    var s = this.doMetadata.segment(this.get('area'), this.get('measurement'), this.get('segments'));\n    if (s) {\n      this.set('segment_name', s);\n    }\n  },\n\n  getTemplate: function () {\n    return template;\n  },\n\n  /**\n   * @override {BaseAnalysisFormModel._setSchema}\n   */\n  _setSchema: function () {\n    var areas = this.doMetadata.areas();\n    var schema = {\n      source: this._primarySourceSchemaItem(),\n      area: {\n        type: 'Select',\n        title: _t('editor.layers.analysis-form.data-observatory-measurement-area'),\n        // remove Global for the moment since it only includes Boundaries\n        options: areas.length === 0 ? _t('editor.layers.analysis-form.loading') : areas.filter(function (f) { return f !== 'Global'; }).sort(),\n        dialogMode: 'float',\n        editorAttrs: {\n          disabled: areas.length === 0\n        }\n      },\n      final_column: {\n        title: _t('editor.layers.analysis-form.data-observatory-measurement-column'),\n        type: 'Text',\n        help: _t('editor.layers.analysis-form.data-observatory-measurement-column-help'),\n        validators: ['required']\n      },\n      measurement: {\n        type: 'Select',\n        title: _t('editor.layers.analysis-form.data-observatory-measurement-measurement'),\n        options: this.doMetadata.measurement(this.get('area')).sort(),\n        dialogMode: 'float'\n      },\n      segments: {\n        type: 'Select',\n        title: _t('editor.layers.analysis-form.data-observatory-measurement-segments'),\n        options: this.doMetadata.columns(this.get('area'), this.get('measurement')).sort(),\n        dialogMode: 'float'\n      }\n    };\n\n    BaseAnalysisFormModel.prototype._setSchema.call(this, schema);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<form>\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">2</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"source,final_column\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('analyses.data-observatory-measure.title') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.data-observatory-measurement-desc') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">3</div>\\n        <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"area,measurement,segments\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.layers.analysis-form.parameters') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.data-observatory-measurement-refine') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n\\n</form>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar cdb = require('cartodb.js');\nvar BaseAnalysisFormModel = require('./base-analysis-form-model');\nvar checkAndBuildOpts = require('../../../../../helpers/required-opts');\nvar availableFunctionsQuery = require('./available-functions.tpl');\nvar template = require('./deprecated-sql-function.tpl');\nvar track = require('../../../../../helpers/errorTracking.js');\n\nvar REQUIRED_OPTS = [\n  'configModel'\n];\n\nmodule.exports = BaseAnalysisFormModel.extend({\n  initialize: function (attrs, opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n    this._SQL = new cdb.SQL({\n      user: this._configModel.get('user_name'),\n      sql_api_template: this._configModel.get('sql_api_template'),\n      api_key: this._configModel.get('api_key')\n    });\n\n    BaseAnalysisFormModel.prototype.initialize.apply(this, arguments);\n\n    this.set('fetchStatus', 'unfetched');\n    this._functionsInfo = [];\n\n    this._setSchema();\n    this._initBinds();\n    this._fetchAvailableFunctions();\n  },\n\n  _initBinds: function () {\n    this.listenTo(this, 'change:fetchStatus', this._onFetchStatusChanged);\n    this.listenTo(this, 'change:function_name', this._onFunctionSelected);\n    this.listenTo(this._analysisSourceOptionsModel, 'change:fetching', this._onSourceOptionsFetched);\n  },\n\n  validate: function (attrs, options) {\n    this.set('primary_source', this.get('source'));\n    this._serializeFunctionArgs();\n\n    return BaseAnalysisFormModel.prototype.validate.call(this, attrs, options);\n  },\n\n  getTemplate: function () {\n    return template;\n  },\n\n  getTemplateData: function () {\n    var fields = [];\n    var data = {\n      fields: ''\n    };\n    var selectedFunction = this._getSelectedFunction();\n    if (selectedFunction) {\n      if (selectedFunction.hasSecondaryNode) {\n        fields.push('secondary_source');\n      }\n\n      _.reduce(selectedFunction.params, function (memo, value, key) {\n        memo.push(key);\n        return memo;\n      }, fields, this);\n    }\n    data.fields = fields.join(',');\n\n    return data;\n  },\n\n  _buildSchema: function () {\n    var schema = {};\n    var selectedFunction = this._getSelectedFunction();\n\n    // Source\n    schema.source = this._primarySourceSchemaItem(_t('editor.layers.analysis-form.deprecated-sql-function.input'));\n\n    // Function\n    schema.function_name = {\n      type: 'Select',\n      title: _t('editor.layers.analysis-form.deprecated-sql-function.function'),\n      options: this._parseFunctionOptions(),\n      dialogMode: 'float',\n      editorAttrs: this._getSelectFunctionAttrs()\n    };\n\n    if (selectedFunction) {\n      if (selectedFunction.hasSecondaryNode) {\n        schema.secondary_source = {\n          type: 'NodeDataset',\n          title: _t('editor.layers.analysis-form.deprecated-sql-function.target'),\n          options: this._getSourceOptionsForSource({\n            sourceAttrName: 'secondary_source'\n          }),\n          dialogMode: 'float',\n          editorAttrs: {\n            disabled: this._isSourceDisabled('secondary_source')\n          },\n          validators: ['required']\n        };\n      }\n\n      _.each(selectedFunction.params, function (value, key) {\n        this._addParamToSchema(key, selectedFunction.params[key], schema);\n      }, this);\n    }\n\n    return schema;\n  },\n\n  _setSchema: function () {\n    BaseAnalysisFormModel.prototype._setSchema.call(this, this._buildSchema());\n  },\n\n  _addParamToSchema: function (key, type, schema) {\n    var item = null;\n    var initialValue = null;\n\n    switch (type) {\n      case 'string': {\n        item = {\n          type: 'Text',\n          title: key,\n          validators: ['required']\n        };\n        initialValue = '';\n        break;\n      }\n      case 'number': {\n        item = {\n          type: 'Number',\n          title: key,\n          showSlider: false,\n          validators: ['required']\n        };\n        initialValue = 0;\n        break;\n      }\n      case 'boolean': {\n        item = {\n          type: 'Radio',\n          title: key,\n          options: [\n            {val: 'true', label: 'true'},\n            {val: 'false', label: 'false'}\n          ]\n        };\n        initialValue = true;\n        break;\n      }\n    }\n    if (item) {\n      schema[key] = item;\n      if (!this.has(key)) {\n        this.set(key, initialValue);\n      }\n    }\n  },\n\n  _onSourceOptionsFetched: function () {\n    this._setSchema();\n  },\n\n  _onFetchStatusChanged: function () {\n    this._setSchema();\n  },\n\n  _onFunctionSelected: function () {\n    this._setSchema();\n  },\n\n  _getSelectedFunction: function () {\n    var functionName = this.get('function_name');\n    if (functionName) {\n      return _.first(_.filter(this._functionsInfo, function (info) {\n        return info.functionName === functionName;\n      }, this));\n    }\n    return null;\n  },\n\n  _fetchAvailableFunctions: function () {\n    var query = availableFunctionsQuery();\n    this.set('fetchStatus', 'fetching');\n\n    this._SQL.execute(query, null, {\n      success: function (metadata) {\n        this._functionsInfo = this._parseFunctionsMetadata(metadata);\n        this.set('fetchStatus', 'fetched');\n      }.bind(this),\n      error: function (errors) {\n        this.set('fetchStatus', 'error');\n        if (errors && errors.responseJSON) {\n          track(errors.responseJSON);\n        }\n      }.bind(this)\n    });\n  },\n\n  _parseFunctionsMetadata: function (metadata) {\n    if (!metadata || !metadata.rows) {\n      return [];\n    }\n\n    return _.map(metadata.rows, function (data) {\n      var info = {};\n      info.functionName = this._capitalizeFunctionName(data.fn_name);\n      info.hasSecondaryNode = data.has_secondary_node;\n      info.params = {};\n      for (var i = 0; i < data.params_names.length; i++) {\n        info.params[data.params_names[i]] = data.params_types[i];\n      }\n      return info;\n    }, this);\n  },\n\n  _capitalizeFunctionName: function (name) {\n    var depExtRegex = /^dep_ext/i;\n    return name && name.replace(depExtRegex, 'DEP_EXT');\n  },\n\n  _getSelectFunctionAttrs: function () {\n    var fetchStatus = this.get('fetchStatus');\n    var status = {\n      disabled: true\n    };\n\n    switch (fetchStatus) {\n      case 'unfetched':\n        break;\n      case 'fetching':\n        status = {\n          disabled: true,\n          loading: true\n        };\n        break;\n      case 'fetched': {\n        status = {};\n        if (this._functionsInfo.length > 0) {\n          status.placeholder = _t('editor.layers.analysis-form.deprecated-sql-function.choose-function-small');\n        }\n        break;\n      }\n      case 'error': {\n        status = {\n          disabled: true,\n          placeholder: 'error'\n        };\n        break;\n      }\n    }\n\n    return status;\n  },\n\n  _parseFunctionOptions: function () {\n    return _.map(this._functionsInfo, function (info) {\n      return {\n        val: info.functionName,\n        label: info.functionName\n      };\n    }, this);\n  },\n\n  _serializeFunctionArgs: function () {\n    var values = [];\n    var selectedFunction = this._getSelectedFunction();\n    if (selectedFunction) {\n      values = _.reduce(selectedFunction.params, function (memo, value, key) {\n        memo.push(this.get(key));\n        return memo;\n      }, [], this);\n\n      this.set('function_args', values);\n    }\n  },\n\n  _isPrimarySource: function (sourceAttrName) {\n    return sourceAttrName === this.get('source');\n  },\n\n  _isSourceDisabled: function (sourceAttrName) {\n    return this._isPrimarySource(sourceAttrName) || this._isFetchingOptions();\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<form>\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">2</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"source,function_name\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.layers.analysis-form.deprecated-sql-function.title') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.deprecated-sql-function.choose-function') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n\\n  ';\n if (fields) { \n__p+='\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">3</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"'+\n((__t=( fields ))==null?'':__t)+\n'\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.layers.analysis-form.deprecated-sql-function.params') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.deprecated-sql-function.define-params') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n  ';\n } \n__p+='\\n\\n</form>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar camshaftReference = require('../../../../../data/camshaft-reference');\nvar BaseAnalysisFormModel = require('./base-analysis-form-model');\n\nvar ARRAY_SPLIT_COMBO = ',';\n\n/**\n * A fallback form model in case the type is not supported (yet).\n */\nmodule.exports = BaseAnalysisFormModel.extend({\n\n  initialize: function () {\n    BaseAnalysisFormModel.prototype.initialize.apply(this, arguments);\n\n    this.listenTo(this._analysisSourceOptionsModel, 'change:fetching', this._updateSchema);\n\n    this._updateSchema();\n  },\n\n  getTemplate: function () {\n    return undefined;\n  },\n\n  getTemplateData: function () {\n    return {};\n  },\n\n  /**\n   * @override {BaseAnalysisFormModel._formatAttrs}\n   */\n  _formatAttrs: function () {\n    var attrs = BaseAnalysisFormModel.prototype._formatAttrs.apply(this, arguments);\n\n    var params = camshaftReference.paramsForType(this.get('type'));\n    for (var name in params) {\n      var param = params[name];\n      if (param.type === 'array') {\n        if (!_.isString(attrs[name]) || attrs[name].trim() === '') {\n          attrs[name] = null;\n        } else {\n          attrs[name] = attrs[name]\n            .split(ARRAY_SPLIT_COMBO)\n            .map(function (val) {\n              return val.trim();\n            });\n        }\n      }\n    }\n\n    return attrs;\n  },\n\n  _updateSchema: function () {\n    var schema = {\n      type: {\n        type: 'Text',\n        title: 'Type',\n        editorAttrs: {disabled: true}\n      }\n    };\n    var params = camshaftReference.paramsForType(this.get('type'));\n\n    var sourceCount = _.reduce(Object.keys(params), function (memo, name) {\n      if (params[name].type === 'node') {\n        memo++;\n      }\n      return memo;\n    }, 0);\n\n    Object.keys(params)\n      .forEach(function (name) {\n        var param = params[name];\n        var label = name + ' (' + param.type + ')';\n        var validators = [];\n        var isRequired = !param.optional;\n\n        if (isRequired) {\n          label += '*';\n          validators.push('required');\n        }\n\n        switch (param.type) {\n          case 'node':\n            schema[name] = sourceCount === 1\n              ? {\n                type: 'Select',\n                text: label,\n                options: [ this.get('source') ],\n                dialogMode: 'float',\n                editorAttrs: { disabled: true }\n              }\n              : {\n                type: 'Select',\n                dialogMode: 'float',\n                title: label,\n                options: this._getSourceOptionsForSource({\n                  sourceAttrName: 'target',\n                  ignorePrimarySource: true\n                })\n              };\n            break;\n          case 'string':\n            var fieldDef;\n\n            // If is meant to represent a column try to get columns if possible\n            if (/column/.test(name) && sourceCount === 1) {\n              var nodeDefModel = this._layerDefinitionModel.findAnalysisDefinitionNodeModel(this.get('source'));\n              if (nodeDefModel && nodeDefModel.querySchemaModel.columnsCollection.length > 0) {\n                fieldDef = {\n                  type: 'Text',\n                  title: label,\n                  validators: validators\n                };\n              }\n            }\n\n            if (!fieldDef) {\n              fieldDef = {\n                type: 'Text',\n                title: label,\n                validators: validators\n              };\n            }\n\n            schema[name] = fieldDef;\n            break;\n          case 'enum':\n            schema[name] = {\n              type: 'Select',\n              title: label,\n              options: param.values.map(function (val) {\n                return {\n                  val: val,\n                  label: val\n                };\n              }),\n              dialogMode: 'float',\n              validators: validators\n            };\n            break;\n          case 'number':\n            schema[name] = {\n              type: 'Text',\n              label: label,\n              validators: validators\n            };\n            break;\n          case 'boolean':\n            schema[name] = {\n              type: 'Radio',\n              text: label,\n              options: [\n                {val: 'true', label: 'true'},\n                {val: 'false', label: 'false'}\n              ],\n              validators: validators\n            };\n            break;\n          case 'array':\n            schema[name] = {\n              type: 'Text',\n              title: label,\n              validators: validators,\n              help: 'Separate values by \"' + ARRAY_SPLIT_COMBO + '\"'\n            };\n            break;\n          default:\n            return null;\n        }\n      }, this);\n\n    this._setSchema(schema);\n  }\n});\n",
    "var BaseAnalysisFormModel = require('./base-analysis-form-model');\nvar template = require('./filter-by-node-column.tpl');\nvar ColumnOptions = require('../column-options');\n\n/**\n * Form model for a centroid and weighted-centroid analysis\n * It has a rather complicated schema, that depends on several data points and state.\n */\nmodule.exports = BaseAnalysisFormModel.extend({\n  initialize: function () {\n    BaseAnalysisFormModel.prototype.initialize.apply(this, arguments);\n\n    var nodeDefModel = this._layerDefinitionModel.findAnalysisDefinitionNodeModel(this.get('source'));\n    this._columnOptions = new ColumnOptions({}, {\n      configModel: this._configModel,\n      nodeDefModel: nodeDefModel\n    });\n\n    this._filterColumnOptions = new ColumnOptions({}, {\n      configModel: this._configModel\n    });\n\n    this.listenTo(this._columnOptions, 'columnsFetched', this._setSchema);\n    this.listenTo(this._filterColumnOptions, 'columnsFetched', this._setSchema);\n    this.listenTo(this._analysisSourceOptionsModel, 'change:fetching', this._setSchema);\n    this.on('change:filter_source', this._onFilterSourceChange, this);\n    this._onFilterSourceChange();\n    this._setSchema();\n  },\n\n  _onFilterSourceChange: function () {\n    var nodeDefModel = this._layerDefinitionModel.findAnalysisDefinitionNodeModel(this.get('filter_source'));\n    if (nodeDefModel) {\n      this._filterColumnOptions.setNode(nodeDefModel);\n      this._setSchema();\n    }\n  },\n\n  getTemplate: function () {\n    return template;\n  },\n\n  /**\n   * @override {BaseAnalysisFormModel._setSchema}\n   */\n  _setSchema: function () {\n    var schema = {\n      source: this._primarySourceSchemaItem(),\n      filter_source: {\n        type: 'NodeDataset',\n        title: _t('editor.layers.analysis-form.linked-layer'),\n        dialogMode: 'float',\n        editorAttrs: {\n          disabled: this._isFetchingOptions()\n        },\n        options: this._getSourceOptionsForSource({\n          sourceAttrName: 'filter_source',\n          ignorePrimarySource: true,\n          onlyNodes: true\n        })\n      },\n      column: {\n        type: 'Select',\n        title: _t('editor.layers.analysis-form.source-column'),\n        dialogMode: 'float',\n        options: this._columnOptions.all()\n      },\n      filter_column: {\n        type: 'Select',\n        title: _t('editor.layers.analysis-form.filter-column'),\n        dialogMode: 'float',\n        validators: ['required', this._validateFilterColumn.bind(this)],\n        options: this._filterColumnOptions.all()\n      }\n    };\n\n    BaseAnalysisFormModel.prototype._setSchema.call(this, schema);\n  },\n\n  _validateFilterColumn: function (value, formValues) {\n    var filterColumnValue = formValues.filter_column;\n    var columnValue = formValues.column;\n\n    // if we don't have both fields we don't validate\n    if (filterColumnValue === void 0 || columnValue === void 0) return null;\n\n    var error = {\n      message: _t('editor.layers.analysis-form.should-match')\n    };\n\n    var filterColumn = this._filterColumnOptions.findColumn(filterColumnValue);\n    var filterColumnType = filterColumn && filterColumn.type;\n\n    var column = this._columnOptions.findColumn(columnValue);\n    var columnType = column && column.type;\n\n    if (filterColumnType === columnType) {\n      return null; // types match\n    }\n\n    return error;\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<form>\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">2</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"source,filter_source\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('analyses.filter-by-node-column.title') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.link-layer-desc') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">3</div>\\n        <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"column,filter_column\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.layers.analysis-form.key-columns') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--xl\">'+\n((__t=( _t('editor.layers.analysis-form.key-columns-desc') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n</form>\\n\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\n\nvar PARAMS_FOR_IS_EQUAL = 'kind,text';\n\nmodule.exports = {\n  type: 'filter-category',\n  label: 'Filter category',\n  parametersDataFields: 'text,accept_reject',\n  filterDataFields: 'accept,reject',\n\n  parse: function (nodeAttrs) {\n    var formAttrs = _.extend({}, nodeAttrs);\n\n    formAttrs.type = 'filter-category';\n    formAttrs.column = nodeAttrs.column || '';\n\n    if (nodeAttrs.accept) {\n      formAttrs.text = nodeAttrs.accept.join(',');\n    } else if (nodeAttrs.reject) {\n      formAttrs.text = nodeAttrs.reject.join(',');\n    }\n\n    formAttrs.accept_reject = (nodeAttrs.accept || !(nodeAttrs.accept || nodeAttrs.reject)) ? 'accept' : 'reject';\n\n    return formAttrs;\n  },\n\n  formatAttrs: function (formAttrs) {\n    var attrs = ['id', 'type', 'source', 'column'];\n    var isFromIsEqualToKind = formAttrs.kind === 'is-equal-to';\n    var text;\n\n    if (isFromIsEqualToKind) {\n      text = [+formAttrs.text];\n    } else if (formAttrs.text) {\n      text = formAttrs.text.split(',');\n    }\n\n    if (formAttrs.accept_reject === 'accept' || isFromIsEqualToKind) {\n      formAttrs.accept = text;\n    } else if (formAttrs.accept_reject === 'reject') {\n      formAttrs.reject = text;\n    }\n\n    if (isFromIsEqualToKind) {\n      return _.pick(formAttrs, attrs.concat(['kind', 'accept']));\n    } else {\n      return _.pick(formAttrs, attrs.concat(formAttrs.accept_reject));\n    }\n  },\n\n  getParameters: function (kind) {\n    var params = this.parametersDataFields;\n\n    if (kind === 'is-equal-to') {\n      params = PARAMS_FOR_IS_EQUAL;\n    }\n\n    return params;\n  }\n};\n",
    "var _ = require('underscore');\nvar BaseAnalysisFormModel = require('./base-analysis-form-model');\nvar template = require('./filter-form.tpl');\nvar ColumnData = require('../column-data');\nvar ColumnRowData = require('../../../../../data/column-row-data');\nvar ColumnOptions = require('../column-options');\n\nvar FILTER_TYPES = require('./filter-types');\nvar TYPE_TO_META_MAP = {};\n\nFILTER_TYPES.map(function (d) {\n  TYPE_TO_META_MAP[d.type] = d;\n});\n\nvar FILTER_RANGE_KINDS = [\n  { val: 'between', label: _t('editor.layers.filter-options.between') },\n  { val: 'is-equal-to', label: _t('editor.layers.filter-options.is-equal-to') },\n  { val: 'is-greater-than', label: _t('editor.layers.filter-options.is-greater-than') },\n  { val: 'is-less-than', label: _t('editor.layers.filter-options.is-less-than') }\n];\n\nvar LESS_GREATER_KINDS = ['is-greater-than', 'is-less-than'];\n\nmodule.exports = BaseAnalysisFormModel.extend({\n\n  defaults: {\n    accept_reject: 'accept'\n  },\n\n  parse: function (attrs) {\n    return _.defaults(\n      _.pick(attrs, 'id', 'source', 'column'), // maintain default attrs\n      this._typeDef(attrs.type).parse(attrs)\n    );\n  },\n\n  initialize: function () {\n    BaseAnalysisFormModel.prototype.initialize.apply(this, arguments);\n\n    var nodeDefModel = this._layerDefinitionModel.findAnalysisDefinitionNodeModel(this.get('source'));\n\n    this._columnData = new ColumnData({\n      column: this.get('column')\n    }, {\n      nodeDefModel: nodeDefModel,\n      configModel: this._configModel\n    });\n\n    this._columnRowData = new ColumnRowData({\n      column: this.get('column')\n    }, {\n      nodeDefModel: nodeDefModel,\n      configModel: this._configModel\n    });\n\n    this._columnOptions = new ColumnOptions({}, {\n      configModel: this._configModel,\n      nodeDefModel: nodeDefModel\n    });\n\n    this.on('change:kind change:column', this._updateSchema, this);\n    this.on('change:histogram_stats', this._setSchema, this);\n\n    this.listenTo(this._columnOptions, 'columnsFetched', this._setSchema);\n    this.listenTo(this._columnRowData, 'columnsFetched', this._setSchema);\n    this.listenTo(this._columnData, 'columnsFetched', this._storeHistogramStats);\n\n    this._columnData.fetch();\n    this._columnRowData.fetch();\n    this._setSchema();\n  },\n\n  getTemplate: function () {\n    return template;\n  },\n\n  getTemplateData: function () {\n    return {\n      column: this.get('column'),\n      histogram_stats: this.get('histogram_stats'),\n      parametersDataFields: this._typeDef().getParameters(this.get('kind'))\n    };\n  },\n\n  _formatAttrs: function (formAttrs) {\n    var customFormattedFormAttrs = this._typeDef().formatAttrs(formAttrs);\n    return BaseAnalysisFormModel.prototype._formatAttrs.call(this, customFormattedFormAttrs);\n  },\n\n  /**\n   * @override {BaseAnalysisFormModel.updateNodeDefinition}\n   */\n  updateNodeDefinition: function (nodeDefModel) {\n    var attrs = this._formatAttrs(this.attributes);\n    nodeDefModel.clear({ silent: true });\n    nodeDefModel.set(attrs);\n  },\n\n  _setSchema: function () {\n    BaseAnalysisFormModel.prototype._setSchema.call(this, this._filterSchemaFieldsByType({\n      source: this._primarySourceSchemaItem(_t('editor.layers.analysis-form.input')),\n      column: {\n        type: 'Select',\n        text: _t('editor.layers.analysis-form.column'),\n        options: this._columnOptions.filterByType(['string', 'number']),\n        dialogMode: 'float',\n        validators: ['required']\n      },\n      kind: {\n        type: 'Select',\n        title: _t('editor.layers.analysis-form.filter'),\n        dialogMode: 'float',\n        options: this._getKindOptions(),\n        editorAttrs: {\n          showSearch: false\n        }\n      },\n      min: {\n        type: 'Text',\n        title: this._getMinLabel(),\n        validators: ['required'],\n        editorAttrs: {\n          placeholder: 'Write min value'\n        }\n      },\n      max: {\n        type: 'Text',\n        title: this._getMaxLabel(),\n        validators: ['required'],\n        editorAttrs: {\n          placeholder: 'Write max value'\n        }\n      },\n      text: {\n        type: this._getInputType(),\n        title: _t('editor.layers.analysis-form.input'),\n        validators: ['required'],\n        options: _.map(this._columnRowData.getRows(), function (d) {\n          return { label: d, val: d };\n        }),\n        dialogMode: 'float',\n        editorAttrs: {\n          showSearch: true,\n          allowFreeTextInput: true\n        }\n      },\n      accept_reject: {\n        type: 'Radio',\n        title: _t('editor.layers.analysis-form.result'),\n        options: [\n          { label: _t('editor.layers.analysis-form.show'), val: 'accept' },\n          { label: _t('editor.layers.analysis-form.hide'), val: 'reject' }\n        ],\n        validators: ['required']\n      }\n    }));\n\n    this._generateHistogram();\n    this._generateHistogramStats();\n  },\n\n  _getInputType: function () {\n    var rows = this._columnRowData.getRows();\n    return rows && rows.length ? 'Select' : 'Text';\n  },\n\n  _getMinLabel: function () {\n    return _.contains(LESS_GREATER_KINDS, this.get('kind')) ? _t('editor.layers.analysis-form.value') : _t('editor.layers.analysis-form.min');\n  },\n\n  _getMaxLabel: function () {\n    return _.contains(LESS_GREATER_KINDS, this.get('kind')) ? _t('editor.layers.analysis-form.value') : _t('editor.layers.analysis-form.max');\n  },\n\n  _getSourceColumns: function () {\n    var nodeDefModel = this._layerDefinitionModel.findAnalysisDefinitionNodeModel(this.get('source'));\n\n    var sourceColumns = nodeDefModel.querySchemaModel.columnsCollection.map(function (columnModel) {\n      var columnName = columnModel.get('name');\n      return {\n        val: columnName,\n        label: columnName,\n        type: columnModel.get('type')\n      };\n    });\n\n    return sourceColumns;\n  },\n\n  _filterSchemaFieldsByType: function (schema) {\n    // Always include the source and column fields in addition to the type-specific fields\n    var kind = this.get('kind');\n    var fields = ['source', 'column'].concat(this._typeDef().getParameters(kind).split(','));\n    return _.pick(schema, fields);\n  },\n\n  _updateSchema: function () {\n    this._columnData.set('column', this.get('column'));\n    this._columnRowData.set('column', this.get('column'));\n\n    this._setType();\n    this._setSchema();\n  },\n\n  _getSelectedColumnType: function () {\n    var columns = this._getSourceColumns();\n    var columnType = null;\n\n    for (var i in columns) {\n      if (columns[i]['label'] === this.get('column')) {\n        columnType = columns[i]['type'];\n      }\n    }\n\n    return columnType;\n  },\n\n  _getKindOptions: function () {\n    if (this.get('type') !== 'filter-category' || this.get('kind') === 'is-equal-to') {\n      return FILTER_RANGE_KINDS;\n    }\n  },\n\n  _setType: function () {\n    var columnType = this._getSelectedColumnType();\n    var kind = this.get('kind');\n    var attrs = {\n      type: 'filter-range'\n    };\n\n    if (columnType === 'number' && kind === 'is-equal-to') {\n      attrs.type = 'filter-category';\n      attrs.accept_reject = 'accept';\n    } else if (columnType === 'string') {\n      attrs.kind = null;\n      attrs.type = 'filter-category';\n    }\n\n    this.set(attrs);\n  },\n\n  _getColumnType: function (columnName) {\n    var nodeDefModel = this._layerDefinitionModel.findAnalysisDefinitionNodeModel(this.get('source'));\n    var column = nodeDefModel.querySchemaModel.columnsCollection.find(function (c) {\n      return c.get('name') === columnName;\n    }, this);\n\n    return column && column.get('type');\n  },\n\n  _generateHistogramStats: function (data) {\n    if (data) {\n      this.trigger('onColData', this);\n    }\n  },\n\n  _storeHistogramStats: function (data) {\n    if (data && this._getSelectedColumnType() === 'number') {\n      this.set('histogram_stats', data.attributes);\n    } else {\n      this.set('histogram_stats', null);\n    }\n  },\n\n  _generateHistogram: function () {\n    var type;\n    var tableName = this._getSourceOption()[0].layerName;\n    var columnName = this.get('column');\n\n    if (columnName) {\n      type = this._getColumnType(columnName);\n    }\n\n    if (tableName && columnName && type === 'number') {\n      this.trigger('generateHistogram', { columnName: columnName, tableName: tableName });\n    }\n  },\n\n  _typeDef: function (type) {\n    type = type || this.get('type');\n    return TYPE_TO_META_MAP[type];\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<form>\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">2</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('analyses.filter.title') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.select-column') ))==null?'':_.escape(__t))+\n'</p>\\n      <div class=\"u-tSpace-xl CDB-Text CDB-Fieldset\">\\n        <p class=\"CDB-Legend u-upperCase u-iBlock CDB-Text is-semibold CDB-Size-small u-rSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.input') ))==null?'':_.escape(__t))+\n'</p>\\n        <div class=\"Editor-formInput u-ellipsis\" data-editors=\"source\"></div>\\n      </div>\\n      <div class=\"u-tSpace-xl CDB-Text CDB-Fieldset\">\\n        <p class=\"CDB-Legend u-upperCase u-iBlock CDB-Text is-semibold CDB-Size-small u-rSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.column') ))==null?'':_.escape(__t))+\n'</p>\\n        <div class=\"Editor-formInput\" data-editors=\"column\"></div>\\n      </div>\\n      ';\n if (histogram_stats) { \n__p+='\\n      <div class=\"u-tSpace-xl CDB-Text CDB-Fieldset \">\\n        <p class=\"CDB-Legend u-upperCase u-iBlock CDB-Text is-semibold CDB-Size-small u-rSpace--m\"></p>\\n        <div class=\"Analysis-Histogram js-histogram\">\\n          <ul class=\"Analysis-HistogramInfo u-flex CDB-Text CDB-Size-small u-secondaryTextColor u-upperCase\">\\n            <li class=\"u-rSpace\"><span class=\"js-min\"></span> '+\n((__t=( _t('editor.layers.analysis-form.min') ))==null?'':_.escape(__t))+\n'</li>\\n            <li><span class=\"js-max\"></span> '+\n((__t=( _t('editor.layers.analysis-form.max') ))==null?'':_.escape(__t))+\n'</li>\\n          </ul>\\n          <div class=\"Analysis-HistogramChart js-histogramChart\"></div>\\n        </div>\\n      </div>\\n      ';\n } \n__p+='\\n    </div>\\n  </div>\\n  ';\n if (column) { \n__p+='\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">3</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"'+\n((__t=( parametersDataFields ))==null?'':_.escape(__t))+\n'\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.layers.analysis-form.parameters') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--xl\">'+\n((__t=( _t('editor.layers.analysis-form.parameters-description') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n  ';\n } \n__p+='\\n</form>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar BaseAnalysisFormModel = require('./base-analysis-form-model');\nvar template = require('./filter-intersection-form.tpl');\nvar ColumnOptions = require('../column-options');\n\n/**\n *  Filter points in polygon model\n */\nmodule.exports = BaseAnalysisFormModel.extend({\n\n  initialize: function () {\n    BaseAnalysisFormModel.prototype.initialize.apply(this, arguments);\n\n    this._columnOptions = new ColumnOptions({}, {\n      configModel: this._configModel\n    });\n\n    this.listenTo(this._analysisSourceOptionsModel, 'change:fetching', this._setSchema);\n    this.listenTo(this._columnOptions, 'columnsFetched', this._setSchema);\n\n    this.on('change:target', this._onChangeTarget, this);\n\n    this._setSchema();\n    this._fetchColumns();\n  },\n\n  _formatAttrs: function (formAttrs) {\n    var customFormattedFormAttrs = _.pick(formAttrs, ['id', 'source', 'target', 'type']);\n    return BaseAnalysisFormModel.prototype._formatAttrs.call(this, customFormattedFormAttrs);\n  },\n\n  getTemplate: function () {\n    return template;\n  },\n\n  getTemplateData: function () {\n    return {};\n  },\n\n  _filterSchemaFieldsByType: function (schema) {\n    // Always include the source and target fields in addition to the type-specific fields\n    return _.pick(schema, ['source', 'target', 'type']);\n  },\n\n  /**\n   * @override {BaseAnalysisFormModel._setSchema}\n   */\n  _setSchema: function () {\n    BaseAnalysisFormModel.prototype._setSchema.call(this, this._filterSchemaFieldsByType({\n      source: this._primarySourceSchemaItem(_t('editor.layers.analysis-form.base-layer')),\n      target: {\n        type: 'NodeDataset',\n        title: _t('editor.layers.analysis-form.filtering-layer'),\n        options: this._getSourceOptionsForSource({\n          sourceAttrName: 'target',\n          requiredSimpleGeometryType: 'point'\n        }),\n        dialogMode: 'float',\n        validators: ['required'],\n        editorAttrs: {\n          disabled: this._isSourceDisabled('target')\n        }\n      }\n    }));\n  },\n\n  _onChangeTarget: function () {\n    this._analysisSourceOptionsModel.createSourceNodeUnlessExisting(this.get('target'));\n    this._fetchColumns();\n  },\n\n  _fetchColumns: function () {\n    var target = this.get('target');\n\n    var nodeDefModel = this._layerDefinitionModel.findAnalysisDefinitionNodeModel(target);\n\n    if (nodeDefModel) {\n      this._columnOptions.setNode(nodeDefModel);\n    } else if (target) {\n      this._columnOptions.setDataset(target);\n    }\n  },\n\n  _isSourceDisabled: function (sourceAttrName) {\n    return this._isPrimarySource(sourceAttrName) || this._isFetchingOptions();\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<form>\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">2</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"source,target\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('analyses.filter-intersection.title') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.input-layer') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n</form>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\n\nvar PARAMETERS_FOR_KIND = {\n  'between': 'kind,min,max',\n  'is-equal-to': 'kind,text',\n  'is-less-than': 'kind,max',\n  'is-greater-than': 'kind,min'\n};\n\nmodule.exports = {\n  type: 'filter-range',\n  label: 'Filter range', // TODO: localize?\n\n  parse: function (nodeAttrs) {\n    var formAttrs = _.extend({}, nodeAttrs);\n\n    formAttrs.type = 'filter-range';\n    formAttrs.kind = nodeAttrs.kind || 'between';\n    formAttrs.column = nodeAttrs.column || '';\n    formAttrs.min = nodeAttrs.min != null ? nodeAttrs.min : 0;\n    formAttrs.max = nodeAttrs.max != null ? nodeAttrs.max : 50;\n\n    return formAttrs;\n  },\n\n  getParameters: function (kind) {\n    if (!kind) {\n      kind = 'is-equal-to';\n    }\n    return PARAMETERS_FOR_KIND[kind];\n  },\n\n  formatAttrs: function (formAttrs) {\n    var attrs = this.getParameters(formAttrs.kind);\n    return _.pick(formAttrs, ['id', 'type', 'source', 'column'].concat(attrs.split(',')));\n  }\n};\n",
    "module.exports = [\n  require('./filter-category'),\n  require('./filter-range')\n];\n",
    "module.exports = {\n  type: 'georeference-admin-region',\n  label: _t('editor.layers.analysis-form.georeference.admin-region'),\n  fieldAttrs: {\n    admin_region_column: {\n      showSearch: true\n    },\n    country: {\n      showSearch: true,\n      allowFreeTextInput: true\n    }\n  },\n\n  validatorFor: {\n    admin_region_column: ['required']\n  },\n\n  parametersDataFields: 'admin_region_column,country',\n\n  getParameters: function () {\n    var params = this.parametersDataFields;\n\n    return params;\n  },\n\n  parse: function (nodeAttrs) {\n    return {\n      type: 'georeference-admin-region',\n      admin_region_column: nodeAttrs.admin_region_column,\n      country: nodeAttrs.country || nodeAttrs.country_column\n    };\n  },\n\n  formatAttrs: function (formAttrs, columnOptions) {\n    if (formAttrs.country && columnOptions.findColumn(formAttrs.country, 'string')) {\n      formAttrs.country_column = formAttrs.country;\n      delete formAttrs.country;\n    } else {\n      delete formAttrs.country_column;\n    }\n    return formAttrs;\n  }\n};\n",
    "var _ = require('underscore');\n\nmodule.exports = {\n  type: 'georeference-city',\n  label: _t('editor.layers.analysis-form.georeference.city'),\n  fieldAttrs: {\n    city_column: {\n      showSearch: true\n    },\n    admin_region: {\n      showSearch: true,\n      allowFreeTextInput: true\n    },\n    country: {\n      showSearch: true,\n      allowFreeTextInput: true\n    }\n  },\n\n  validatorFor: {\n    city_column: ['required']\n  },\n\n  parametersDataFields: 'city_column,admin_region,country',\n\n  getParameters: function () {\n    var params = this.parametersDataFields;\n\n    return params;\n  },\n\n  parse: function (nodeAttrs) {\n    return {\n      type: 'georeference-city',\n      city_column: nodeAttrs.city_column,\n      admin_region: nodeAttrs.admin_region || nodeAttrs.admin_region_column,\n      country: nodeAttrs.country || nodeAttrs.country_column\n    };\n  },\n\n  formatAttrs: function (formAttrs, columnOptions) {\n    _.each(['country', 'admin_region'], function (attr) {\n      if (formAttrs[attr] && columnOptions.findColumn(formAttrs[attr], 'string')) {\n        formAttrs[attr + '_column'] = formAttrs[attr];\n        delete formAttrs[attr];\n      } else {\n        delete formAttrs[attr + '_column'];\n      }\n    }, this);\n\n    return formAttrs;\n  }\n};\n",
    "module.exports = {\n  type: 'georeference-country',\n  label: _t('editor.layers.analysis-form.georeference.country'),\n  fieldAttrs: {\n    country_column: {\n      showSearch: true\n    }\n  },\n\n  validatorFor: {\n    country_column: ['required']\n  },\n\n  parametersDataFields: 'country_column',\n\n  getParameters: function () {\n    var params = this.parametersDataFields;\n\n    return params;\n  },\n\n  parse: function (nodeAttrs) {\n    return {\n      type: 'georeference-country',\n      country_column: nodeAttrs.country_column || nodeAttrs.country\n    };\n  },\n\n  formatAttrs: function (formAttrs) {\n    return formAttrs;\n  }\n};\n",
    "var _ = require('underscore');\nvar BaseAnalysisFormModel = require('./base-analysis-form-model');\nvar template = require('./georeference-form.tpl');\nvar ColumnOptions = require('../column-options');\nvar GEOREFERENCE_TYPES = require('./georeference-types');\n\nvar TYPE_TO_META_MAP = {};\nGEOREFERENCE_TYPES.map(function (d) {\n  TYPE_TO_META_MAP[d.type] = d;\n});\n\n/**\n * Form model for a georeference analysis\n * It has a rather complicated schema, that depends on several data points and state.\n */\nmodule.exports = BaseAnalysisFormModel.extend({\n  parse: function (attrs) {\n    return _.defaults(\n      _.pick(attrs, 'id', 'source', 'context'), // maintain default attrs\n      this._typeDef(attrs.type).parse(attrs)\n    );\n  },\n\n  initialize: function () {\n    BaseAnalysisFormModel.prototype.initialize.apply(this, arguments);\n\n    this._columnOptions = new ColumnOptions({}, {\n      configModel: this._configModel,\n      nodeDefModel: this._layerDefinitionModel.findAnalysisDefinitionNodeModel(this.get('source'))\n    });\n\n    this.listenTo(this._columnOptions, 'columnsFetched', this._setSchema);\n    this.on('change:type change:context', this._onTypeChanged, this);\n\n    this._setSchema();\n  },\n\n  updateNodeDefinition: function (nodeDefModel) {\n    var attrs = this._formatAttrs(this.attributes);\n    nodeDefModel.clear({silent: true});\n    nodeDefModel.set(attrs);\n  },\n\n  _formatAttrs: function (formAttrs) {\n    var customFormattedFormAttrs = this._typeDef().formatAttrs(formAttrs, this._columnOptions);\n    return BaseAnalysisFormModel.prototype._formatAttrs.call(this, customFormattedFormAttrs);\n  },\n\n  getTemplate: function () {\n    return template;\n  },\n\n  getTemplateData: function () {\n    return {parametersDataFields: this._typeDef().getParameters(this.get('context'))};\n  },\n\n  _filterSchemaFieldsByType: function (schema) {\n    // Always include the source field in addition to the type-specific fields\n    // If the model has a context attribute it will be used to filter the fields\n    var context = this.get('context');\n    var fields = ['source', 'type'].concat(this._typeDef().getParameters(context).split(','));\n\n    return _.pick(schema, fields);\n  },\n\n  /*\n  /**\n   * @override {BaseAnalysisFormModel._setSchema}\n   */\n  _setSchema: function () {\n    BaseAnalysisFormModel.prototype._setSchema.call(this, this._filterSchemaFieldsByType({\n      type: {\n        type: 'Select',\n        title: _t('editor.layers.analysis-form.type'),\n        options: _.compact(\n          GEOREFERENCE_TYPES.map(function (d) {\n            if (!this._analyses.isAnalysisValidByType(d.type, this._configModel)) {\n              return false;\n            }\n\n            return {\n              val: d.type,\n              label: d.label\n            };\n          }, this)\n        ),\n        dialogMode: 'float'\n      },\n      context: {\n        type: 'Toggle',\n        title: '',\n        label: '',\n        options: [\n          {\n            val: 'advance',\n            label: _t('editor.layers.analysis-form.georeference.advance'),\n            help: _t('editor.layers.analysis-form.georeference.street-address-help'),\n            selected: false\n          }, {\n            val: 'normal',\n            label: _t('editor.layers.analysis-form.georeference.normal'),\n            selected: true\n          }\n        ]\n      },\n      source: {\n        type: 'NodeDataset',\n        text: _t('editor.layers.analysis-form.source'),\n        options: this._getSourceOption(),\n        dialogMode: 'float',\n        editorAttrs: { disabled: true }\n      },\n      latitude: {\n        type: 'Select',\n        title: _t('editor.layers.analysis-form.latitude'),\n        options: this._columnOptions.filterByType(['string', 'number']),\n        dialogMode: 'float',\n        validators: this._getFieldValidator('latitude'),\n        placeholder: _t('editor.layers.analysis-form.georeference.select-latitude'),\n        searchPlaceholder: _t('editor.layers.analysis-form.search-by-column-name')\n      },\n      longitude: {\n        type: 'Select',\n        title: _t('editor.layers.analysis-form.longitude'),\n        options: this._columnOptions.filterByType(['string', 'number']),\n        dialogMode: 'float',\n        validators: this._getFieldValidator('longitude'),\n        placeholder: _t('editor.layers.analysis-form.georeference.select-longitude'),\n        searchPlaceholder: _t('editor.layers.analysis-form.search-by-column-name')\n      },\n      admin_region: {\n        type: 'EnablerEditor',\n        title: '',\n        label: _t('editor.layers.analysis-form.admin-region'),\n        help: _t('editor.layers.analysis-form.georeference.admin-region-extended-help'),\n        validators: this._getFieldValidator('admin_region'),\n        editor: {\n          type: 'Select',\n          options: this._getColumnOptions('admin_region', 'string'),\n          dialogMode: 'float',\n          editorAttrs: this._getFieldAttrs('admin_region'),\n          placeholder: _t('editor.layers.analysis-form.georeference.select-admin'),\n          searchPlaceholder: _t('editor.layers.analysis-form.georeference.enter-region-name')\n        }\n      },\n      admin_region_column: {\n        type: 'Select',\n        title: _t('editor.layers.analysis-form.admin-region'),\n        options: this._columnOptions.filterByType('string'),\n        dialogMode: 'float',\n        help: _t('editor.layers.analysis-form.georeference.admin-region-help'),\n        validators: this._getFieldValidator('admin_region'),\n        editorAttrs: this._getFieldAttrs('admin_region'),\n        placeholder: _t('editor.layers.analysis-form.georeference.select-admin'),\n        searchPlaceholder: _t('editor.layers.analysis-form.search-by-column-name')\n      },\n      country_column: {\n        type: 'Select',\n        title: _t('editor.layers.analysis-form.country'),\n        options: this._columnOptions.filterByType('string'),\n        dialogMode: 'float',\n        help: _t('editor.layers.analysis-form.georeference.country-help'),\n        validators: this._getFieldValidator('country_column'),\n        editorAttrs: this._getFieldAttrs('country_column'),\n        placeholder: _t('editor.layers.analysis-form.georeference.select-a-country'),\n        searchPlaceholder: _t('editor.layers.analysis-form.search-by-column-name')\n      },\n      city: {\n        type: 'EnablerEditor',\n        title: '',\n        label: _t('editor.layers.analysis-form.city'),\n        help: _t('editor.layers.analysis-form.georeference.city-extended-help'),\n        validators: this._getFieldValidator('city'),\n        editor: {\n          type: 'Select',\n          options: this._getColumnOptions('city', 'string'),\n          dialogMode: 'float',\n          editorAttrs: this._getFieldAttrs('city'),\n          placeholder: _t('editor.layers.analysis-form.georeference.select-city'),\n          searchPlaceholder: _t('editor.layers.analysis-form.georeference.enter-city-name')\n        }\n      },\n      city_column: {\n        type: 'Select',\n        title: _t('editor.layers.analysis-form.city'),\n        options: this._columnOptions.filterByType('string'),\n        dialogMode: 'float',\n        help: _t('editor.layers.analysis-form.georeference.city-help'),\n        validators: this._getFieldValidator('city_column'),\n        editorAttrs: this._getFieldAttrs('city_column'),\n        placeholder: _t('editor.layers.analysis-form.georeference.select-city'),\n        searchPlaceholder: _t('editor.layers.analysis-form.search-by-column-name')\n      },\n      postal_code_column: {\n        type: 'Select',\n        title: _t('editor.layers.analysis-form.postal-code'),\n        options: this._columnOptions.filterByType(['string', 'number']),\n        dialogMode: 'float',\n        help: _t('editor.layers.analysis-form.georeference.postal-code-help'),\n        validators: this._getFieldValidator('postal_code_column'),\n        placeholder: _t('editor.layers.analysis-form.georeference.select-postal-code'),\n        searchPlaceholder: _t('editor.layers.analysis-form.search-by-column-name')\n      },\n      ip_address: {\n        type: 'Select',\n        title: _t('editor.layers.analysis-form.georeference.ip-address-column'),\n        options: this._columnOptions.filterByType('string'),\n        dialogMode: 'float',\n        help: _t('editor.layers.analysis-form.georeference.ip-address-help'),\n        validators: this._getFieldValidator('ip_address'),\n        placeholder: _t('editor.layers.analysis-form.georeference.select-ip'),\n        searchPlaceholder: _t('editor.layers.analysis-form.search-by-column-name')\n      },\n      street_address_template: {\n        type: 'CodeEditor',\n        title: '',\n        label: '',\n        tokens: this._getColumnHints(this._columnOptions.filterByType(['string', 'number'])),\n        validators: this._getFieldValidator('street_address_template'),\n        placeholder: '{{street_number}} {{street_name}}, {{postal_code}} {{country}}'\n      },\n      street_address_column: {\n        type: 'Select',\n        title: _t('editor.layers.analysis-form.georeference.street-address-column'),\n        options: this._columnOptions.filterByType('string'),\n        dialogMode: 'float',\n        help: _t('editor.layers.analysis-form.georeference.street-address-column-help'),\n        validators: this._getFieldValidator('street_address_column'),\n        placeholder: _t('editor.layers.analysis-form.georeference.select-street-address'),\n        searchPlaceholder: _t('editor.layers.analysis-form.search-by-column-name')\n      },\n      state: {\n        type: 'EnablerEditor',\n        title: '',\n        label: _t('editor.layers.analysis-form.state'),\n        help: _t('editor.layers.analysis-form.georeference.state-help'),\n        validators: this._getFieldValidator('state'),\n        editor: {\n          type: 'Select',\n          options: this._getColumnOptions('state', 'string'),\n          dialogMode: 'float',\n          editorAttrs: this._getFieldAttrs('state'),\n          placeholder: _t('editor.layers.analysis-form.georeference.select-state'),\n          searchPlaceholder: _t('editor.layers.analysis-form.georeference.enter-state-name')\n        }\n      },\n      country: {\n        type: 'EnablerEditor',\n        title: '',\n        label: _t('editor.layers.analysis-form.country'),\n        help: _t('editor.layers.analysis-form.georeference.country-extended-help'),\n        validators: this._getFieldValidator('country'),\n        editor: {\n          type: 'Select',\n          options: this._getColumnOptions('country', 'string'),\n          dialogMode: 'float',\n          editorAttrs: this._getFieldAttrs('country'),\n          placeholder: _t('editor.layers.analysis-form.georeference.select-country'),\n          searchPlaceholder: _t('editor.layers.analysis-form.georeference.enter-country-name')\n        }\n      }\n    }));\n  },\n\n  _onTypeChanged: function () {\n    this._replaceAttrs();\n    this._setSchema();\n  },\n\n  _replaceAttrs: function () {\n    var attrs = this.parse(this.attributes);\n    this.clear({silent: true});\n    this.set({\n      type: attrs.type,\n      context: attrs.context\n    }, { silent: true }); // re-set type to avoid change:type change:context event to trigger again\n    this.set(attrs);\n  },\n\n  _typeDef: function (type) {\n    type = type || this.get('type');\n    return TYPE_TO_META_MAP[type];\n  },\n\n  _getFieldAttrs: function (fieldName) {\n    return this._typeDef() && this._typeDef().fieldAttrs[fieldName];\n  },\n\n  _getFieldValidator: function (fieldName) {\n    return this._typeDef() && this._typeDef().validatorFor[fieldName] || null;\n  },\n\n  _getColumnHints: function (columns) {\n    if (!columns) {\n      return [];\n    }\n\n    return [{\n      keywords: columns.map(function (column) { return column.val; }).join(' '),\n      type: 'Column_name'\n    }];\n  },\n\n  _getColumnOptions: function (attr, attrType) {\n    var opts = this._columnOptions.filterByType(attrType);\n\n    if (this._columnOptions.get('columnsFetched') && this.get(attr)) {\n      var attrExists = false;\n      var value = this.get(attr);\n\n      var customValue = {\n        val: value,\n        label: '\"' + value + '\"'\n      };\n\n      if (opts && opts.length) {\n        attrExists = _.find(opts, function (attr) {\n          return attr.val === customValue.val;\n        });\n      }\n\n      if (!attrExists) {\n        opts.push(customValue);\n        opts = _.sortBy(opts, function (d) {\n          return d.val;\n        });\n      }\n    }\n    return opts;\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<form>\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">2</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('analyses.georeference.title') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.select-type') ))==null?'':_.escape(__t))+\n'</p>\\n      <div class=\"u-tSpace-xl CDB-Text CDB-Fieldset\">\\n        <p class=\"CDB-Legend u-upperCase u-iBlock CDB-Text is-semibold CDB-Size-small u-rSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.input') ))==null?'':_.escape(__t))+\n'</p>\\n        <div class=\"Editor-formInput u-ellipsis\" data-editors=\"source\"></div>\\n      </div>\\n      <div class=\"u-tSpace-xl CDB-Text CDB-Fieldset\">\\n        <p class=\"CDB-Legend u-upperCase u-iBlock CDB-Text is-semibold CDB-Size-small u-rSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.type') ))==null?'':_.escape(__t))+\n'</p>\\n        <div class=\"Editor-formInput\" data-editors=\"type\"></div>\\n      </div>\\n    </div>\\n  </div>\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">3</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"'+\n((__t=( parametersDataFields ))==null?'':__t)+\n'\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.layers.analysis-form.parameters') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--xl\">'+\n((__t=( _t('editor.layers.analysis-form.tune-analysis') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n</form>\\n';\n}\nreturn __p;\n};\n",
    "module.exports = {\n  type: 'georeference-ip-address',\n  label: _t('editor.layers.analysis-form.georeference.ip-address'),\n  fieldAttrs: {\n    ip_address: {\n      showSearch: true\n    }\n  },\n\n  validatorFor: {\n    ip_address: ['required']\n  },\n\n  parametersDataFields: 'ip_address',\n\n  getParameters: function () {\n    var params = this.parametersDataFields;\n\n    return params;\n  },\n\n  parse: function (nodeAttrs) {\n    return {\n      type: 'georeference-ip-address',\n      ip_address: nodeAttrs.ip_address\n    };\n  },\n\n  formatAttrs: function (formAttrs) {\n    return formAttrs;\n  }\n};\n",
    "module.exports = {\n  type: 'georeference-long-lat',\n  label: _t('editor.layers.analysis-form.georeference.long-lat'),\n  parametersDataFields: 'latitude,longitude',\n  fieldAttrs: {\n    latitude: {\n      showSearch: true\n    },\n    longitude: {\n      showSearch: true\n    }\n  },\n\n  validatorFor: {\n    latitudde: ['required'],\n    longitude: ['required']\n  },\n\n  parse: function (nodeAttrs) {\n    return {\n      type: 'georeference-long-lat',\n      latitude: nodeAttrs.latitude,\n      longitude: nodeAttrs.longitude\n    };\n  },\n\n  getParameters: function () {\n    var params = this.parametersDataFields;\n\n    return params;\n  },\n\n  formatAttrs: function (formAttrs) {\n    return formAttrs;\n  }\n};\n\n",
    "module.exports = {\n  type: 'georeference-postal-code',\n  label: _t('editor.layers.analysis-form.georeference.postal-code'),\n  fieldAttrs: {\n    postal_code_column: {\n      showSearch: true\n    },\n    country: {\n      showSearch: true,\n      allowFreeTextInput: true\n    }\n  },\n\n  validatorFor: {\n    city_column: ['required']\n  },\n\n  parametersDataFields: 'postal_code_column,country',\n\n  getParameters: function () {\n    var params = this.parametersDataFields;\n\n    return params;\n  },\n\n  parse: function (nodeAttrs) {\n    return {\n      type: 'georeference-postal-code',\n      postal_code_column: nodeAttrs.postal_code_column,\n      country: nodeAttrs.country || nodeAttrs.country_column\n    };\n  },\n\n  formatAttrs: function (formAttrs, columnOptions) {\n    if (formAttrs.country && columnOptions.findColumn(formAttrs.country, 'string')) {\n      formAttrs.country_column = formAttrs.country;\n      delete formAttrs.country;\n    } else {\n      delete formAttrs.country_column;\n    }\n    return formAttrs;\n  }\n};\n",
    "var _ = require('underscore');\n\nvar PARAMETERS_FOR_CONTEXT = {\n  'normal': 'street_address_column,context,city,state,country',\n  'advance': 'street_address_template,context,city,state,country'\n};\n\nmodule.exports = {\n  type: 'georeference-street-address',\n  label: _t('editor.layers.analysis-form.georeference.street-address'),\n  fieldAttrs: {\n    street_address_column: {\n      showSearch: true\n    },\n    city: {\n      showSearch: true,\n      allowFreeTextInput: true\n    },\n    state: {\n      showSearch: true,\n      allowFreeTextInput: true\n    },\n    country: {\n      showSearch: true,\n      allowFreeTextInput: true\n    }\n  },\n\n  validatorFor: {\n    street_address_column: ['required'],\n    street_address_template: ['required']\n  },\n\n  parse: function (nodeAttrs) {\n    var attrs = {\n      type: 'georeference-street-address',\n      city: nodeAttrs.city || nodeAttrs.city_column || '',\n      state: nodeAttrs.state || nodeAttrs.state_column || '',\n      country: nodeAttrs.country || nodeAttrs.country_column || ''\n    };\n\n    if (nodeAttrs.context === 'advance') {\n      attrs.street_address_template = nodeAttrs.street_address_column && this._wrapInBraces(nodeAttrs.street_address_column) || nodeAttrs.street_address_template || '';\n    } else {\n      attrs.street_address_column = nodeAttrs.street_address_column || '';\n    }\n\n    return attrs;\n  },\n\n  _wrapInBraces: function (fragments) {\n    return ['{{', fragments, '}}'].join('');\n  },\n\n  getParameters: function (context) {\n    if (!context) {\n      context = 'normal';\n    }\n    return PARAMETERS_FOR_CONTEXT[context];\n  },\n\n  formatAttrs: function (formAttrs, columnOptions) {\n    _.each(['city', 'state', 'country'], function (attr) {\n      if (formAttrs[attr] && columnOptions.findColumn(formAttrs[attr], 'string')) {\n        formAttrs[attr + '_column'] = formAttrs[attr];\n        delete formAttrs[attr];\n      } else {\n        delete formAttrs[attr + '_column'];\n      }\n    }, this);\n\n    return formAttrs;\n  }\n};\n",
    "module.exports = [\n  require('./georeference-long-lat-model'),\n  require('./georeference-city-model'),\n  require('./georeference-country-model'),\n  require('./georeference-admin-region-model'),\n  require('./georeference-postal-code-model'),\n  require('./georeference-ip-address-model'),\n  require('./georeference-street-address-model')\n];\n",
    "var _ = require('underscore');\nvar BaseAnalysisFormModel = require('./base-analysis-form-model');\nvar template = require('./group-points.tpl');\nvar ColumnOptions = require('../column-options');\n\nvar ANALYSES_TYPES = require('./group-points-types');\n\nvar TYPE_TO_META_MAP = {};\nANALYSES_TYPES.map(function (d) {\n  TYPE_TO_META_MAP[d.type] = d;\n});\n\nmodule.exports = BaseAnalysisFormModel.extend({\n  parse: function (attrs) {\n    return _.defaults(\n      _.pick(attrs, 'id', 'source'), // maintain default attrs\n      this._typeDef(attrs.type).parse(attrs)\n    );\n  },\n\n  initialize: function () {\n    BaseAnalysisFormModel.prototype.initialize.apply(this, arguments);\n\n    this._columnOptions = new ColumnOptions({}, {\n      configModel: this._configModel,\n      nodeDefModel: this._layerDefinitionModel.findAnalysisDefinitionNodeModel(this.get('source'))\n    });\n\n    this.listenTo(this._columnOptions, 'columnsFetched', this._setSchema);\n    this.on('change:aggregate', this._updateAggregation, this);\n    this.on('change:type', this._onTypeChanged, this);\n\n    this._updateAggregation();\n    this._setSchema();\n  },\n\n  _updateAggregation: function () {\n    var aggregate = this.get('aggregate');\n\n    if (aggregate === '') {\n      this.set({aggregation: 'count', aggregation_column: ''});\n    } else {\n      this.set({aggregation_column: aggregate.attribute, aggregation: aggregate.operator});\n    }\n\n    this._setSchema();\n  },\n\n  _onTypeChanged: function () {\n    this._replaceAttrs();\n    this._setSchema();\n  },\n\n  _replaceAttrs: function () {\n    var attrs = this.parse(this.attributes);\n    this.clear({ silent: true });\n    this.set('type', attrs.type, { silent: true }); // re-set type to avoid change:type event to trigger again\n    this.set(_.extend(attrs, this.defaults));\n  },\n\n  updateNodeDefinition: function (nodeDefModel) {\n    var attrs = this._formatAttrs(this.attributes);\n    nodeDefModel.clear({ silent: true });\n    nodeDefModel.set(attrs);\n  },\n\n  _formatAttrs: function (formAttrs) {\n    var customFormattedFormAttrs = this._typeDef().formatAttrs(formAttrs, this._columnOptions);\n    return BaseAnalysisFormModel.prototype._formatAttrs.call(this, customFormattedFormAttrs);\n  },\n\n  getTemplate: function () {\n    return template;\n  },\n\n  getTemplateData: function () {\n    return {\n      parametersDataFields: this._typeDef().parametersDataFields\n    };\n  },\n\n  _filterSchemaFieldsByType: function (schema) {\n    // Always include the source field in addition to the type-specific fields\n    var fields = ['source', 'type', 'aggregate'].concat(this._typeDef().parametersDataFields.split(','));\n    return _.pick(schema, fields);\n  },\n\n  /**\n   * @override {BaseAnalysisFormModel._setSchema}\n   */\n  _setSchema: function () {\n    BaseAnalysisFormModel.prototype._setSchema.call(this, this._filterSchemaFieldsByType({\n      source: this._primarySourceSchemaItem(),\n      type: {\n        type: 'Select',\n        title: _t('editor.layers.analysis-form.method'),\n        options: ANALYSES_TYPES.map(function (d) {\n          return {\n            val: d.type,\n            label: d.label\n          };\n        }, this),\n        dialogMode: 'float'\n      },\n      target_percentage: {\n        type: 'Number',\n        title: _t('editor.layers.analysis-form.target-percent'),\n        help: _t('editor.layers.analysis-form.target-percent-help'),\n        validators: ['required', {\n          type: 'interval',\n          min: 0,\n          max: 100\n        }]\n      },\n      allow_holes: {\n        type: 'Radio',\n        title: _t('editor.layers.analysis-form.allow-holes'),\n        options: [\n          { val: false, label: _t('editor.layers.analysis-form.no') },\n          { val: true, label: _t('editor.layers.analysis-form.yes') }\n        ]\n      },\n      category_column: {\n        type: 'EnablerEditor',\n        title: '',\n        label: _t('editor.layers.analysis-form.group-by'),\n        editor: {\n          type: 'Select',\n          options: this._columnOptions.all(),\n          dialogMode: 'float',\n          editorAttrs: {\n            showLabel: false\n          }\n        }\n      },\n      aggregate: {\n        type: 'Operators',\n        title: _t('editor.layers.analysis-form.operation'),\n        options: this._columnOptions.filterByType('number'),\n        dialogMode: 'float'\n      }\n    }));\n  },\n\n  _getColumnOptions: function (attr, attrType) {\n    var opts = this._columnOptions.filterByType(attrType);\n\n    if (this._columnOptions.get('columnsFetched') && this.get(attr)) {\n      var attrExists = false;\n      var value = this.get(attr);\n\n      var customValue = {\n        val: value,\n        label: '\"' + value + '\"'\n      };\n\n      if (opts && opts.length) {\n        attrExists = _.find(opts, function (attr) {\n          return attr.val === customValue.val;\n        });\n      }\n\n      if (!attrExists) {\n        opts.push(customValue);\n        opts = _.sortBy(opts, function (d) {\n          return d.val;\n        });\n      }\n    }\n    return opts;\n  },\n\n  _typeDef: function (type) {\n    type = type || this.get('type');\n    return TYPE_TO_META_MAP[type];\n  }\n});\n",
    "module.exports = [\n  require('./group-points/convex-hull'),\n  require('./group-points/concave-hull'),\n  require('./group-points/bounding-circle'),\n  require('./group-points/bounding-box')\n];\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<form>\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">2</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"'+\n((__t=( parametersDataFields ))==null?'':__t)+\n'\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('analyses.group-points.title') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.input-layer') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">3</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"aggregate\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.layers.analysis-form.value-aggregation') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--xl\">'+\n((__t=( _t('editor.layers.analysis-form.value-aggregation-desc') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n</form>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\n\nmodule.exports = {\n  type: 'bounding-box',\n  label: _t('editor.layers.analysis-form.bounding-box'),\n  parametersDataFields: 'source,type,category_column',\n\n  parse: function (nodeAttrs) {\n    if (!nodeAttrs.aggregation_column) {\n      nodeAttrs.aggregation_column = 'cartodb_id';\n    }\n    if (!nodeAttrs.aggregation) {\n      nodeAttrs.aggregation = 'count';\n    }\n    var aggregate = {\n      operator: nodeAttrs.aggregation,\n      attribute: nodeAttrs.aggregation === 'count' ? '' : nodeAttrs.aggregation_column\n    };\n\n    return {\n      type: 'bounding-box',\n      category_column: nodeAttrs.category_column,\n      aggregate: aggregate\n    };\n  },\n\n  formatAttrs: function (formAttrs) {\n    formAttrs = _.omit(formAttrs, 'aggregate');\n\n    if (!formAttrs.aggregation_column) {\n      formAttrs = _.omit(formAttrs, 'aggregation_column');\n    }\n\n    if (!formAttrs.category_column) {\n      formAttrs = _.omit(formAttrs, 'category_column');\n    }\n\n    return formAttrs;\n  }\n};\n",
    "var _ = require('underscore');\n\nmodule.exports = {\n  type: 'bounding-circle',\n  label: _t('editor.layers.analysis-form.bounding-circle'),\n  parametersDataFields: 'source,type,category_column',\n\n  parse: function (nodeAttrs) {\n    if (!nodeAttrs.aggregation_column) {\n      nodeAttrs.aggregation_column = 'cartodb_id';\n    }\n    if (!nodeAttrs.aggregation) {\n      nodeAttrs.aggregation = 'count';\n    }\n    var aggregate = {\n      operator: nodeAttrs.aggregation,\n      attribute: nodeAttrs.aggregation === 'count' ? '' : nodeAttrs.aggregation_column\n    };\n    return {\n      type: 'bounding-circle',\n      category_column: nodeAttrs.category_column,\n      aggregate: aggregate\n    };\n  },\n\n  formatAttrs: function (formAttrs) {\n    formAttrs = _.omit(formAttrs, 'aggregate');\n\n    if (!formAttrs.aggregation_column) {\n      formAttrs = _.omit(formAttrs, 'aggregation_column');\n    }\n\n    if (!formAttrs.category_column) {\n      formAttrs = _.omit(formAttrs, 'category_column');\n    }\n\n    return formAttrs;\n  }\n};\n\n",
    "var _ = require('underscore');\n\nmodule.exports = {\n  type: 'concave-hull',\n  label: _t('editor.layers.analysis-form.concave-hull'),\n  parametersDataFields: 'source,type,target_percentage,allow_holes,category_column',\n\n  parse: function (nodeAttrs) {\n    if (!nodeAttrs.aggregation_column) {\n      nodeAttrs.aggregation_column = 'cartodb_id';\n    }\n    if (!nodeAttrs.aggregation) {\n      nodeAttrs.aggregation = 'count';\n    }\n\n    var aggregate = {\n      operator: nodeAttrs.aggregation,\n      attribute: nodeAttrs.aggregation === 'count' ? '' : nodeAttrs.aggregation_column\n    };\n\n    var target_percentage = 70;\n\n    if (nodeAttrs.target_percent === 0) {\n      target_percentage = 0;\n    } else if (nodeAttrs.target_percent) {\n      target_percentage = nodeAttrs.target_percent * 100;\n    }\n\n    return {\n      type: 'concave-hull',\n      target_percentage: target_percentage,\n      category_column: nodeAttrs.category_column,\n      aggregate: aggregate\n    };\n  },\n\n  formatAttrs: function (formAttrs) {\n    formAttrs = _.omit(formAttrs, 'aggregate');\n\n    formAttrs.target_percent = formAttrs.target_percentage / 100;\n    formAttrs = _.omit(formAttrs, 'target_percentage');\n\n    if (!formAttrs.aggregation_column) {\n      formAttrs = _.omit(formAttrs, 'aggregation_column');\n    }\n\n    if (!formAttrs.allow_holes) {\n      formAttrs = _.omit(formAttrs, 'allow_holes');\n    }\n\n    if (!formAttrs.category_column) {\n      formAttrs = _.omit(formAttrs, 'category_column');\n    }\n\n    return formAttrs;\n  }\n};\n\n",
    "var _ = require('underscore');\n\nmodule.exports = {\n  type: 'convex-hull',\n  label: _t('editor.layers.analysis-form.convex-hull'),\n  parametersDataFields: 'source,type,category_column',\n\n  parse: function (nodeAttrs) {\n    if (!nodeAttrs.aggregation_column) {\n      nodeAttrs.aggregation_column = 'cartodb_id';\n    }\n    if (!nodeAttrs.aggregation) {\n      nodeAttrs.aggregation = 'count';\n    }\n    var aggregate = {\n      operator: nodeAttrs.aggregation,\n      attribute: nodeAttrs.aggregation === 'count' ? '' : nodeAttrs.aggregation_column\n    };\n    return {\n      type: 'convex-hull',\n      category_column: nodeAttrs.category_column,\n      aggregate: aggregate\n    };\n  },\n\n  formatAttrs: function (formAttrs) {\n    formAttrs = _.omit(formAttrs, 'aggregate');\n\n    if (!formAttrs.aggregation_column) {\n      formAttrs = _.omit(formAttrs, 'aggregation_column');\n    }\n\n    if (!formAttrs.category_column) {\n      formAttrs = _.omit(formAttrs, 'category_column');\n    }\n\n    return formAttrs;\n  }\n};\n",
    "var BaseAnalysisFormModel = require('./base-analysis-form-model');\nvar template = require('./kmeans-form.tpl');\n\n/**\n * Form model for a means analysis\n * It has a rather complicated schema, that depends on several data points and state.\n */\nmodule.exports = BaseAnalysisFormModel.extend({\n  defaults: {\n    clusters: 2\n  },\n\n  initialize: function () {\n    BaseAnalysisFormModel.prototype.initialize.apply(this, arguments);\n\n    this._setSchema();\n  },\n\n  getTemplate: function () {\n    return template;\n  },\n\n  /**\n   * @override {BaseAnalysisFormModel._setSchema}\n   */\n  _setSchema: function () {\n    BaseAnalysisFormModel.prototype._setSchema.call(this, {\n      source: this._primarySourceSchemaItem(),\n      clusters: {\n        type: 'Number',\n        title: _t('editor.layers.analysis-form.clusters-num'),\n        validators: ['required', {\n          type: 'interval',\n          min: 2,\n          max: 16\n        }]\n      }\n    });\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<form>\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">2</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"source\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('analyses.kmeans.title') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.input-layer') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">3</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"clusters\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.layers.analysis-form.parameters') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--xl\">'+\n((__t=( _t('editor.layers.analysis-form.tune-clusters') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n</form>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar BaseAnalysisFormModel = require('./base-analysis-form-model');\nvar template = require('./merge-form.tpl');\nvar ColumnOptions = require('../column-options');\n\nvar MERGE_FIELDS = 'join_operator,left_source_column,right_source_column,source_geometry_selector,left_source_columns,right_source_columns';\n\n/**\n * Form model for the merge analysis\n */\nmodule.exports = BaseAnalysisFormModel.extend({\n  defaults: {\n    join_operator: 'inner',\n    source_geometry: 'left_source',\n    right_source_columns: []\n  },\n\n  parse: function (attrs) {\n    if (attrs.source_geometry === 'left_source' || !attrs.source_geometry) {\n      attrs.source_geometry_selector = attrs.left_source;\n    } else {\n      attrs.source_geometry_selector = attrs.right_source;\n    }\n\n    return attrs;\n  },\n\n  initialize: function () {\n    BaseAnalysisFormModel.prototype.initialize.apply(this, arguments);\n\n    this.on('change', this._onChange, this);\n\n    this._leftColumnOptions = new ColumnOptions({}, {\n      configModel: this._configModel\n    });\n\n    this._rightColumnOptions = new ColumnOptions({}, {\n      configModel: this._configModel\n    });\n\n    this.listenTo(this._analysisSourceOptionsModel, 'change:fetching', this._setSchema);\n\n    this.listenTo(this._leftColumnOptions, 'columnsFetched', this._setSchema);\n    this.listenTo(this._rightColumnOptions, 'columnsFetched', this._setSchema);\n\n    this.on('change:type', this._setSchema, this);\n    this.on('change:right_source', this._onChangeRightSource, this);\n    this.on('change:join_operator, change:right_source, change:left_source_column, change:right_source_column', this._setSchema, this);\n\n    this._setSchema();\n    this._fetchLeftColumns();\n    this._fetchRightColumns();\n  },\n\n  _getFormFieldNames: function () {\n    return MERGE_FIELDS;\n  },\n\n  _getFormatFieldNames: function () {\n    return MERGE_FIELDS;\n  },\n\n  _formatAttrs: function (formAttrs) {\n    var customFormattedFormAttrs = _.pick(formAttrs, ['id', 'type', 'left_source', 'right_source'].concat(this._getFormatFieldNames().split(',')));\n\n    if (this.get('left_source') === this.get('source_geometry_selector')) {\n      customFormattedFormAttrs.source_geometry = 'left_source';\n    } else {\n      customFormattedFormAttrs.source_geometry = 'right_source';\n    }\n\n    if (!formAttrs.left_source_columns) {\n      customFormattedFormAttrs.left_source_columns = [];\n    }\n\n    if (!formAttrs.right_source_columns) {\n      customFormattedFormAttrs.right_source_columns = [];\n    }\n\n    return BaseAnalysisFormModel.prototype._formatAttrs.call(this, customFormattedFormAttrs);\n  },\n\n  getTemplate: function () {\n    return template;\n  },\n\n  getTemplateData: function () {\n    return {\n      right_source: this.get('right_source'),\n      hasLeftAndRightSourceColumns: this.get('left_source_column') && this.get('right_source_column')\n    };\n  },\n\n  _filterSchemaFieldsByType: function (schema) {\n    // Always include the source and target fields in addition to the type-specific fields\n    return _.pick(schema, ['left_source', 'right_source'].concat(this._getFormFieldNames().split(',')));\n  },\n\n  _onChangeRightSource: function () {\n    this._fetchRightColumns();\n    this.unset('right_source_column');\n    this.set('right_source_columns', []);\n  },\n\n  _getLeftSourceLabel: function () {\n    var source = this._getSourceOption()[0];\n    if (source) {\n      return source.layerName;\n    }\n  },\n\n  _getRightSourceLabel: function () {\n    var source = this._getSourceOptionsForSourceId(this.get('right_source'), 'right_source', '*');\n    if (source) {\n      return source.label;\n    }\n  },\n\n  /**\n   * @override {BaseAnalysisFormModel._setSchema}\n   */\n  _setSchema: function () {\n    BaseAnalysisFormModel.prototype._setSchema.call(this, this._filterSchemaFieldsByType({\n      left_source: this._primarySourceSchemaItem(_t('editor.layers.analysis-form.input-num', { num: 1 })),\n      right_source: {\n        type: 'NodeDataset',\n        title: _t('editor.layers.analysis-form.input-num', { num: 2 }),\n        options: this._getSourceOptionsForSource('right_source', '*'),\n        dialogMode: 'float',\n        validators: ['required'],\n        editorAttrs: {\n          disabled: this._isSourceDisabled('right_source')\n        }\n      },\n      join_operator: {\n        type: 'Radio',\n        title: _t('editor.layers.analysis-form.join-type'),\n        options: [\n          { label: _t('editor.layers.analysis-form.left'), val: 'left', help: _t('editor.layers.analysis-form.merge-type.left') },\n          { label: _t('editor.layers.analysis-form.inner'), val: 'inner', help: _t('editor.layers.analysis-form.merge-type.inner') }\n        ],\n        validators: ['required']\n      },\n      left_source_column: {\n        type: 'Select',\n        title: this._getLeftSourceLabel(),\n        options: this._leftColumnOptions.all(),\n        dialogMode: 'float',\n        validators: ['required']\n      },\n      right_source_column: {\n        type: 'Select',\n        title: this._getRightSourceLabel(),\n        options: this._rightColumnOptions.all(),\n        dialogMode: 'float',\n        validators: ['required', this._validateRightSourceColumn.bind(this)]\n      },\n      source_geometry_selector: {\n        type: 'NodeDataset',\n        title: _t('editor.layers.analysis-form.geometry-from'),\n        options: this._getSourcesSelector(),\n        dialogMode: 'float',\n        editorAttrs: {\n          disabled: this._isSourceDisabled('right_source')\n        }\n      },\n      left_source_columns: {\n        type: 'MultiSelect',\n        title: this._getLeftSourceLabel(),\n        options: this._leftColumnOptions.filterByType(['string', 'number', 'date', 'boolean']),\n        dialogMode: 'float'\n      },\n      right_source_columns: {\n        type: 'MultiSelect',\n        title: this._getRightSourceLabel(),\n        options: this._rightColumnOptions.filterByType(['string', 'number', 'date', 'boolean']),\n        dialogMode: 'float'\n      }\n    }));\n  },\n\n  _validateRightSourceColumn: function (value, formValues) {\n    var leftColumnValue = formValues.left_source_column;\n    var rightColumnValue = formValues.right_source_column;\n\n    // if we don't have both fields we don't validate\n    if (leftColumnValue === void 0 || rightColumnValue === void 0) return null;\n\n    var error = {\n      message: _t('editor.layers.analysis-form.should-match')\n    };\n\n    var leftColumn = this._leftColumnOptions.findColumn(leftColumnValue);\n    var leftColumnType = leftColumn && leftColumn.type;\n\n    var rightColumn = this._rightColumnOptions.findColumn(rightColumnValue);\n    var rightColumnType = rightColumn && rightColumn.type;\n\n    if (leftColumnType === rightColumnType) {\n      return null; // types match\n    }\n\n    return error;\n  },\n\n  _fetchColumns: function (sourceName, columnOptions) {\n    var source = this.get(sourceName);\n\n    var nodeDefModel = this._layerDefinitionModel.findAnalysisDefinitionNodeModel(source);\n\n    if (nodeDefModel) {\n      columnOptions.setNode(nodeDefModel);\n    } else if (source) {\n      columnOptions.setDataset(source);\n    }\n  },\n\n  _fetchLeftColumns: function () {\n    this._fetchColumns('left_source', this._leftColumnOptions);\n  },\n\n  _fetchRightColumns: function () {\n    this._fetchColumns('right_source', this._rightColumnOptions);\n  },\n\n  _isSourceDisabled: function (sourceAttrName) {\n    return this._isPrimarySource(sourceAttrName) || this._isFetchingOptions();\n  },\n\n  _getSourcesSelector: function () {\n    return _.compact([this._getSourceOption()[0], this._getRightSource()]);\n  },\n\n  _getRightSource: function () {\n    if (this.get('right_source')) {\n      var source = this._getSourceOptionsForSourceId(this.get('right_source'), 'right_source', '*');\n      if (source) {\n        return {\n          val: this.get('right_source'),\n          type: source.type,\n          nodeTitle: this._analyses.title(source),\n          layerName: source.layerName,\n          color: source.color\n        };\n      }\n    }\n  },\n\n  _getSourceOptionsForSourceId: function (sourceId, sourceAttrName, requiredSimpleGeometryType) {\n    return this._analysisSourceOptionsModel\n    .getSelectOptions(requiredSimpleGeometryType)\n    .find(function (d) {\n      // Can't select own layer as source, so exclude it\n      return d.val === sourceId;\n    });\n  },\n\n  _getSourceOptionsForSource: function (sourceAttrName, requiredSimpleGeometryType) {\n    var currentSource = this.get(sourceAttrName);\n\n    if (this._isFetchingOptions()) {\n      return [{\n        val: currentSource,\n        label: _t('editor.layers.analysis-form.loading'),\n        isLoading: true\n      }];\n    } else {\n      // fetched\n      var source = this._getSourceOption()[0];\n      return this._analysisSourceOptionsModel\n      .getSelectOptions(requiredSimpleGeometryType)\n      .filter(function (d) {\n        return d.val !== source.val && d.val !== source.layerName;\n      });\n    }\n  },\n\n  _getSourceOption: function () {\n    var leftSourceId = this.get('left_source');\n    var nodeDefModel = this._layerDefinitionModel.findAnalysisDefinitionNodeModel(leftSourceId);\n    return [{\n      val: leftSourceId,\n      type: 'node',\n      nodeTitle: this._analyses.title(nodeDefModel),\n      layerName: this._layerDefinitionModel.getName(),\n      color: this._layerDefinitionModel.get('color')\n    }];\n  },\n\n  _onChange: function () {\n    var changedSourceId = this.changed.left_source || this.changed.right_source;\n    if (changedSourceId) {\n      this._analysisSourceOptionsModel.createSourceNodeUnlessExisting(changedSourceId);\n    }\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<form>\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">2</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"left_source,right_source,join_operator\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('analyses.merge.title') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.define-two-layers') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n  ';\n if (right_source) { \n__p+='\\n    <div class=\"Editor-HeaderInfo\">\\n      <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">3</div>\\n      <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"left_source_column,right_source_column\">\\n        <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n          <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.layers.analysis-form.foreign-keys') ))==null?'':_.escape(__t))+\n'</h2>\\n        </div>\\n        <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--xl\">'+\n((__t=( _t('editor.layers.analysis-form.no-coincidence') ))==null?'':_.escape(__t))+\n'</p>\\n      </div>\\n    </div>\\n    ';\n if (hasLeftAndRightSourceColumns) { \n__p+='\\n      <div class=\"Editor-HeaderInfo\">\\n        <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">4</div>\\n        <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"source_geometry_selector,left_source_columns,right_source_columns\">\\n          <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n            <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.layers.analysis-form.columns') ))==null?'':_.escape(__t))+\n'</h2>\\n          </div>\\n          <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--xl\">'+\n((__t=( _t('editor.layers.analysis-form.keep-columns') ))==null?'':_.escape(__t))+\n'</p>\\n        </div>\\n      </div>\\n    ';\n } \n__p+='\\n  ';\n } \n__p+='\\n</form>\\n';\n}\nreturn __p;\n};\n",
    "var BaseAnalysisFormModel = require('./base-analysis-form-model');\nvar template = require('./moran-form.tpl');\nvar ColumnOptions = require('../column-options');\n\n/**\n * Form model for a moran analysis\n * It has a rather complicated schema, that depends on several data points and state.\n */\nmodule.exports = BaseAnalysisFormModel.extend({\n  defaults: {\n    significance: 0.05,\n    neighbours: 5,\n    permutations: 99,\n    w_type: 'knn'\n  },\n\n  initialize: function () {\n    BaseAnalysisFormModel.prototype.initialize.apply(this, arguments);\n\n    this._columnOptions = new ColumnOptions({}, {\n      configModel: this._configModel,\n      nodeDefModel: this._layerDefinitionModel.findAnalysisDefinitionNodeModel(this.get('source'))\n    });\n\n    this.listenTo(this._columnOptions, 'columnsFetched', this._setSchema);\n\n    this._setSchema();\n  },\n\n  getTemplate: function () {\n    return template;\n  },\n\n  /*\n  /**\n   * @override {BaseAnalysisFormModel._setSchema}\n   */\n  _setSchema: function () {\n    var schema = {\n      source: this._primarySourceSchemaItem(),\n      numerator_column: {\n        type: 'Select',\n        title: _t('editor.layers.analysis-form.numerator'),\n        options: this._columnOptions.filterByType('number'),\n        dialogMode: 'float',\n        help: _t('editor.layers.analysis-form.numerator-help')\n      },\n      denominator_column: {\n        type: 'EnablerEditor',\n        title: '',\n        label: _t('editor.layers.analysis-form.denominator'),\n        help: _t('editor.layers.analysis-form.denominator-help'),\n        editor: {\n          type: 'Select',\n          title: _t('editor.layers.analysis-form.denominator'),\n          options: this._columnOptions.filterByType('number'),\n          dialogMode: 'float'\n        }\n      },\n      significance: {\n        type: 'Number',\n        title: _t('editor.layers.analysis-form.significance'),\n        help: _t('editor.layers.analysis-form.significance-help'),\n        validators: ['required', {\n          type: 'interval',\n          min: 0,\n          max: 1,\n          step: 0.05\n        }]\n      },\n      neighbours: {\n        type: 'Number',\n        title: _t('editor.layers.analysis-form.neighbors'),\n        help: _t('editor.layers.analysis-form.neighbors-help'),\n        validators: ['required', {\n          type: 'interval',\n          min: 1,\n          max: 100\n        }]\n      }\n      // hidden as per https://github.com/CartoDB/cartodb/pull/7893#issuecomment-226803659\n      /*\n      permutations: {\n        type: 'Number',\n        title: _t('editor.layers.analysis-form.permutations'),\n        validators: ['required', {\n          type: 'interval',\n          min: 1,\n          max: 100\n        }]\n      },\n      w_type: {\n        type: 'Select',\n        title: _t('editor.layers.analysis-form.weight-type'),\n        options: ['knn', 'queen'],\n        validators: []\n      }\n      */\n    };\n    BaseAnalysisFormModel.prototype._setSchema.call(this, schema);\n  },\n\n  updateNodeDefinition: function (nodeDefModel) {\n    var nodeAttrs = this._formatAttrs(this.attributes);\n    // It could happen that denominator_column is not present, and if we use `set`\n    // instead of the thing below, it could keep returning that attribute for the analysis\n    nodeDefModel.attributes = nodeAttrs;\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<form>\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">2</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"source\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('analyses.moran-cluster.title') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.input-layer') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">3</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"numerator_column,denominator_column,significance,neighbours\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.layers.analysis-form.parameters') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--xl\">'+\n((__t=( _t('editor.layers.analysis-form.define-columns') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n</form>\\n';\n}\nreturn __p;\n};\n",
    "var BaseAnalysisFormModel = require('./base-analysis-form-model');\nvar template = require('./sampling-form.tpl');\nvar _ = require('underscore');\n\nvar DEFAULT_PERCENT = 10;\n\n/**\n * Form model for a sampling\n */\nmodule.exports = BaseAnalysisFormModel.extend({\n\n  initialize: function () {\n    BaseAnalysisFormModel.prototype.initialize.apply(this, arguments);\n    this.bind('change:percent', function () {\n      this.set('sampling', +this.get('percent') / 100);\n    }, this);\n    this._setSchema();\n  },\n\n  parse: function (attrs) {\n    return _.defaults(attrs, {\n      percent: DEFAULT_PERCENT,\n      sampling: DEFAULT_PERCENT / 100\n    });\n  },\n\n  getTemplate: function () {\n    return template;\n  },\n\n  /**\n   * @override {BaseAnalysisFormModel._setSchema}\n   */\n  _setSchema: function () {\n    var schema = {\n      source: this._primarySourceSchemaItem(),\n      percent: {\n        type: 'Number',\n        title: _t('editor.layers.analysis-form.sampling-rate'),\n        validators: ['required', {\n          type: 'interval',\n          min: 0,\n          max: 100,\n          step: 1\n        }]\n      }\n    };\n\n    BaseAnalysisFormModel.prototype._setSchema.call(this, schema);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<form>\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">2</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"source,percent\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('analyses.sampling.title') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.sampling-desc') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n</form>\\n\\n';\n}\nreturn __p;\n};\n",
    "var BaseAnalysisFormModel = require('./base-analysis-form-model');\nvar template = require('./spatial-markov-trend.tpl');\nvar ColumnOptions = require('../column-options');\n\nmodule.exports = BaseAnalysisFormModel.extend({\n  initialize: function () {\n    BaseAnalysisFormModel.prototype.initialize.apply(this, arguments);\n    var nodeDefModel = this._layerDefinitionModel.findAnalysisDefinitionNodeModel(this.get('source'));\n    this._columnOptions = new ColumnOptions({}, {\n      configModel: this._configModel,\n      nodeDefModel: nodeDefModel\n    });\n    this.listenTo(this._columnOptions, 'columnsFetched', this._setSchema);\n    this._setSchema();\n  },\n\n  getTemplate: function () {\n    return template;\n  },\n\n  /**\n   * @override {BaseAnalysisFormModel._setSchema}\n   */\n  _setSchema: function () {\n    var schema = {\n      source: this._primarySourceSchemaItem(),\n      time_columns: {\n        type: 'MultiSelect',\n        title: _t('editor.layers.analysis-form.spatial-markov-trend-time-columns'),\n        options: this._columnOptions.filterByType(['string', 'number']),\n        dialogMode: 'float',\n        help: _t('editor.layers.analysis-form.spatial-markov-trend-time-columns-help'),\n        editorAttrs: {\n          showSearch: true\n        }\n      }\n    };\n\n    BaseAnalysisFormModel.prototype._setSchema.call(this, schema);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<form>\\n  <div class=\"Editor-HeaderInfo\">\\n    <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">2</div>\\n    <div class=\"Editor-HeaderInfo-inner CDB-Text\" data-fields=\"source,time_columns\">\\n      <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n        <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('analyses.spatial-markov-trend.title') ))==null?'':_.escape(__t))+\n'</h2>\\n      </div>\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.layers.analysis-form.spatial-markov-trend-desc') ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n</form>\\n\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar BaseAnalysisFormModel = require('./base-analysis-form-model');\n\n/**\n * A fallback form model in case the type is not supported (yet).\n */\nmodule.exports = BaseAnalysisFormModel.extend({\n\n  validate: function () {\n    return true; // always fail, should not be able to save an unknown node\n  },\n\n  getTemplate: function () {\n    return _.template('<form>Unknown analysis type <%- type %></form>');\n  },\n\n  getTemplateData: function () {\n    return {type: this.get('type') || ''};\n  },\n\n  // Don't allow to update or create an unknown type\n  updateNodeDefinition: function () {},\n  createNodeDefinition: function () {}\n\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar TableStats = require('../../../../components/modals/add-widgets/tablestats');\nvar Utils = require('../../../../helpers/utils');\nrequire('../../../../components/form-components/index');\n\nvar CHECK_FORM_VALIDATION_TOO = {validate: true};\n\n/**\n * This view is required because a schema change require the Backbone.Form object to be re-created to update the view as expected.\n */\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    if (!opts.formModel) throw new Error('formModel is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._configModel = opts.configModel;\n    this._userModel = opts.userModel;\n    this._formModel = opts.formModel;\n\n    this.tableStats = new TableStats({\n      configModel: this._configModel,\n      userModel: this._userModel\n    });\n\n    this._formModel.on('changeSchema', this.render, this);\n    this._formModel.on('generateHistogram', this._generateHistogram, this);\n    this._formModel.on('change:histogram_stats', this._showHistogramStats, this);\n\n    this.add_related_model(this._formModel);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n\n    this._formView = new Backbone.Form({\n      model: this._formModel,\n      trackingClass: 'track-' + this._formModel.get('type') + '-analysis',\n      template: this._formModel.getTemplate(),\n      templateData: this._formModel.getTemplateData()\n    });\n\n    this._formView.bind('change', this._onChangeAnalysisFormView, this);\n    this.$el.append(this._formView.render().el);\n\n    return this;\n  },\n\n  _onChangeAnalysisFormView: function (data) {\n    var formId = this._formView.cid;\n    this._formView.model.setFormValidationErrors(undefined);\n    var formValue = this._formView.getValue();\n    this._formView.model.set(formValue); // <-- This can trigger change events and their callbacks will be run. That could provoke some 'race conditions'.\n    this._showAnalysisFormErrors(formId); // To avoid race condition of running this function against a new form view.\n  },\n\n  _showAnalysisFormErrors: function (formId) {\n    if (this._formView.cid === formId && this._formView.$el) {\n      var formValidationErrors = this._formView.commit(CHECK_FORM_VALIDATION_TOO);\n      this._formView.model.setFormValidationErrors(formValidationErrors);\n    }\n  },\n\n  _generateHistogram: function (data) {\n    this.tableStats.graphFor(data.tableName, data.columnName, this._drawHistogram.bind(this));\n  },\n\n  _showHistogramStats: function () {\n    var stats = this._formModel.get('histogram_stats');\n\n    if (!stats || !_.isNumber(stats.max) || !_.isNumber(stats.min)) {\n      this.$('.js-histogram').hide();\n      return;\n    }\n\n    var max = stats.max < 10000 ? Utils.formatNumber(stats.max) : Utils.readizableNumber(stats.max);\n    var min = stats.min < 10000 ? Utils.formatNumber(stats.min) : Utils.readizableNumber(stats.min);\n\n    this.$('.js-max').html(max);\n    this.$('.js-min').html(min);\n    this.$('.js-histogram').show();\n  },\n\n  _drawHistogram: function (graph) {\n    var stats = this._formModel.get('histogram_stats');\n\n    if (!stats || !_.isNumber(stats.max) || !_.isNumber(stats.min)) {\n      return;\n    }\n\n    this.$('.js-histogramChart').html(graph.getHistogram({\n      color: '#9DE0AD',\n      width: 158,\n      height: 20,\n      bins: 20\n    }));\n\n    this._showHistogramStats();\n  },\n\n  /**\n   * @override CoreView.prototype.clearSubViews\n   */\n  clearSubViews: function () {\n    if (this._formView) {\n      this._formView.remove(); // the Backbone.Form equivalent to \"view.clean()\"\n    }\n\n    return CoreView.prototype.clearSubViews.apply(this, arguments);\n  }\n\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar Analyses = require('../../../../data/analyses');\n\nmodule.exports = Backbone.Collection.extend({\n\n  initialize: function (models, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.layerDefinitionModel) throw new Error('layerDefinitionModel is required');\n    if (!opts.analysisSourceOptionsModel) throw new Error('analysisSourceOptionsModel is required');\n    if (!opts.userActions) throw new Error('userActions is required');\n\n    this._configModel = opts.configModel;\n    this._layerDefinitionModel = opts.layerDefinitionModel;\n    this._analysisSourceOptionsModel = opts.analysisSourceOptionsModel;\n    this._userActions = opts.userActions;\n  },\n\n  model: function (attrs, opts) {\n    var self = opts.collection;\n\n    var FormModel = Analyses.findFormModelByType(attrs.type);\n\n    return new FormModel(attrs, {\n      configModel: self._configModel,\n      analyses: Analyses,\n      layerDefinitionModel: self._layerDefinitionModel,\n      analysisSourceOptionsModel: self._analysisSourceOptionsModel,\n      collection: self,\n      parse: true\n    });\n  },\n\n  resetByLayerDefinition: function () {\n    var current = this._layerDefinitionModel.getAnalysisDefinitionNodeModel();\n    if (current) {\n      var attrsList = [];\n      this._walkAnalysisChain(current, this._layerDefinitionModel, function (nodeDefModel) {\n        var attrs = _.extend({persisted: true}, nodeDefModel.attributes);\n        attrsList.push(attrs);\n      });\n      this.reset(attrsList);\n    }\n  },\n\n  addHead: function (attrs) {\n    this.remove(attrs.id); // if having the same id it's because the existing node is a temporary one,\n    return this.add(attrs, {at: 0}); // so replace it with the new attrs\n  },\n\n  deleteNode: function (nodeId) {\n    var nodeDefModel = this._layerDefinitionModel.findAnalysisDefinitionNodeModel(nodeId);\n    if (nodeDefModel) {\n      this._userActions.deleteAnalysisNode(nodeId);\n    } else {\n      this.remove(nodeId);\n    }\n  },\n\n  _walkAnalysisChain: function (current, layerDefModel, visitorFn) {\n    if (!current.hasPrimarySource()) return;\n\n    visitorFn.call(this, current);\n\n    var next = current.getPrimarySource();\n    if (layerDefModel.isOwnerOfAnalysisNode(next)) {\n      this._walkAnalysisChain(next, layerDefModel, visitorFn);\n    }\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar InfoboxView = require('../../../../components/infobox/infobox-view');\nvar checkAndBuildOpts = require('../../../../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'infoboxModel',\n  'infoboxCollection'\n];\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this._initViews();\n    return this;\n  },\n\n  _initViews: function () {\n    var view = new InfoboxView({\n      infoboxModel: this._infoboxModel,\n      infoboxCollection: this._infoboxCollection\n    });\n    this.addView(view);\n    this.$el.append(view.render().el);\n  }\n});\n",
    "var _ = require('underscore');\nvar queueAsync = require('queue-async');\nvar Backbone = require('backbone');\nvar analyses = require('../../../../data/analyses');\n\n/**\n * Analysis source options are not trivial to get and requires some coordination of events.\n *\n * It's intended to be fetched\n */\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    fetching: false,\n    nodes_options: []\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.analysisDefinitionNodesCollection) throw new Error('analysisDefinitionNodesCollection is required');\n    if (!opts.layerDefinitionsCollection) throw new Error('layerDefinitionsCollection is required');\n    if (!opts.tablesCollection) throw new Error('tablesCollection is required');\n\n    this._analysisDefinitionNodesCollection = opts.analysisDefinitionNodesCollection;\n    this._layerDefinitionsCollection = opts.layerDefinitionsCollection;\n    this._tablesCollection = opts.tablesCollection;\n  },\n\n  fetch: function () {\n    this.set({\n      fetching: true,\n      nodes_options: []\n    });\n\n    var queue = queueAsync();\n\n    this._fetchTables(queue);\n    this._createOptionsFromNodes(queue);\n\n    queue.awaitAll(function () {\n      this.set('fetching', false);\n    }.bind(this));\n  },\n\n  /**\n   * @param {String, Array<String>} requiredSimpleGeometryTypes\n   */\n  getSelectOptions: function (requiredSimpleGeometryTypes) {\n    if (this.get('fetching')) return [];\n\n    if (_.isString(requiredSimpleGeometryTypes)) {\n      requiredSimpleGeometryTypes = [requiredSimpleGeometryTypes];\n    }\n\n    return _.flatten([\n      this.get('nodes_options')\n        .filter(function (d) {\n          return this._isValidGeometry(requiredSimpleGeometryTypes, d.simpleGeometryType);\n        }, this)\n        .map(function (d) {\n          var node = this._analysisDefinitionNodesCollection.get(d.val);\n          var layer = this._layerDefinitionsCollection.findOwnerOfAnalysisNode(node);\n\n          return _.extend({\n            layerName: layer && layer.getName(),\n            nodeTitle: analyses.title(node),\n            color: layer && layer.get('color'),\n            type: 'node'\n          }, d);\n        }, this),\n      this._getTablesSelectOptions(requiredSimpleGeometryTypes)\n    ]);\n  },\n\n  /**\n   * @param {String} val val from select option\n   */\n  createSourceNodeUnlessExisting: function (val) {\n    var tableModel = this._tablesCollection.get(val);\n\n    // If there is no table with given val as id, then it must be a layer source which already exist, so nothing to do\n    if (tableModel) {\n      var tableName = tableModel.get('name');\n      this._analysisDefinitionNodesCollection.createSourceNode({\n        id: tableName, // to avoid duplicats\n        tableName: tableName\n      });\n    }\n  },\n\n  _isValidGeometry: function (requiredSimpleGeometryTypes, simpleGeometryType) {\n    return _.contains(requiredSimpleGeometryTypes, simpleGeometryType) || requiredSimpleGeometryTypes[0] === '*';\n  },\n\n  _fetchTables: function (queue) {\n    queue.defer(function (cb) {\n      this._tablesCollection.fetch({\n        data: {\n          show_likes: false,\n          show_liked: false,\n          show_stats: false,\n          show_table_size_and_row_count: false,\n          show_permission: false,\n          show_synchronization: false,\n          show_uses_builder_features: false,\n          load_totals: false,\n          per_page: 1000\n        }\n      });\n      this._tablesCollection.once('sync error', function () {\n        cb();\n      });\n    }.bind(this));\n  },\n\n  _createOptionsFromNodes: function (queue) {\n    var self = this;\n\n    this._analysisDefinitionNodesCollection\n      .each(function (nodeDefModel) {\n        var queryGeometryModel = nodeDefModel.queryGeometryModel;\n\n        queue.defer(function (cb) {\n          if (queryGeometryModel.isFetched()) {\n            self._appendNodeOption(nodeDefModel);\n            return cb();\n          }\n\n          if (!queryGeometryModel.canFetch()) {\n            return cb();\n          }\n\n          var onStatusChange = function () {\n            if (queryGeometryModel.get('status') === 'fetching') return;\n            queryGeometryModel.off('change:status', onStatusChange);\n            self._appendNodeOption(nodeDefModel);\n            cb();\n          };\n          queryGeometryModel.on('change:status', onStatusChange);\n          queryGeometryModel.fetch();\n        });\n      });\n  },\n\n  _appendNodeOption: function (nodeDefModel) {\n    var geom = nodeDefModel.queryGeometryModel.get('simple_geom');\n    // If a node doesn't belong to a layer, we should not append it as a node option\n    // It could be an intersection node, for example.\n    var belongsToLayer = this._layerDefinitionsCollection.findOwnerOfAnalysisNode(nodeDefModel);\n\n    if (!geom || !belongsToLayer) return;\n\n    this.get('nodes_options')\n      .push({\n        simpleGeometryType: geom,\n        val: nodeDefModel.id,\n        label: nodeDefModel.id\n      });\n  },\n\n  _getTablesSelectOptions: function (requiredSimpleGeometryTypes) {\n    return this._tablesCollection.reduce(function (memo, m) {\n      var simpleGeometryType = m.getGeometryType()[0];\n\n      if (this._isValidGeometry(requiredSimpleGeometryTypes, simpleGeometryType)) {\n        memo.push({\n          val: m.id,\n          label: m.get('name'),\n          type: 'dataset'\n        });\n      }\n\n      return memo;\n    }, [], this);\n  }\n\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar CDB = require('cartodb.js');\nvar queryTemplate = _.template('SELECT min(<%= column %>) as min, max(<%= column %>) as max FROM (<%= sql %>) _table_sql');\n\nmodule.exports = Backbone.Model.extend({\n  initialize: function (attrs, opts) {\n    if (!opts.configModel) throw new Error('configModel param is required');\n    if (!opts.nodeDefModel) throw new Error('nodeDefModel param is required');\n\n    this._nodeDefModel = opts.nodeDefModel;\n\n    this._SQL = new CDB.SQL({\n      user: opts.configModel.get('user_name'),\n      sql_api_template: opts.configModel.get('sql_api_template'),\n      api_key: opts.configModel.get('api_key')\n    });\n\n    this._query = opts.nodeDefModel.querySchemaModel.get('query');\n\n    this.on('change:column', this.fetch, this);\n  },\n\n  _onQueryDone: function (r) {\n    if (_.size(r.rows) > 0) {\n      this.trigger('columnsFetched', _.first(r.rows));\n    }\n  },\n\n  fetch: function () {\n    if (this.get('column') && this._query) {\n      this._SQL.execute(\n        queryTemplate({\n          sql: this._query,\n          column: this.get('column')\n        }),\n        null,\n        {\n          extra_params: ['page', 'rows_per_page'],\n          page: 0,\n          rows_per_page: 40,\n          success: this._onQueryDone.bind(this),\n          error: function () {\n            // TODO: what happens if fails?\n          }\n        }\n      );\n    }\n  }\n});\n",
    "var _ = require('underscore');\nvar CDB = require('cartodb.js');\nvar Backbone = require('backbone');\nvar tableQueryTemplate = _.template('SELECT * FROM <%= tableName %>');\n\nmodule.exports = Backbone.Model.extend({\n  defaults: {\n    columnsFetched: false\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._columnOptions = [];\n\n    this._SQL = new CDB.SQL({\n      user: opts.configModel.get('user_name'),\n      sql_api_template: opts.configModel.get('sql_api_template'),\n      api_key: opts.configModel.get('api_key')\n    });\n\n    if (opts.nodeDefModel) {\n      this.setNode(opts.nodeDefModel);\n    }\n  },\n\n  _fetch: function () {\n    if (this._query) {\n      this.set('columnsFetched', false);\n      this._SQL.execute(\n        this._query,\n        null,\n        {\n          extra_params: ['page', 'rows_per_page'],\n          page: 0,\n          rows_per_page: 40,\n          success: this._onQueryDone.bind(this),\n          error: function () {\n            // TODO: what happens if fails?\n          }\n        }\n      );\n    }\n  },\n\n  setDataset: function (tableName) {\n    this._columnOptions = [];\n    this._query = tableQueryTemplate({ tableName: tableName });\n    this._fetch();\n  },\n\n  setNode: function (nodeDefModel) {\n    this._columnOptions = [];\n    this._query = nodeDefModel.querySchemaModel.get('query');\n    this._fetch();\n  },\n\n  findColumn: function (columnName, columnType) {\n    return _.find(this.filterByType(columnType), function (column) {\n      return column.val === columnName;\n    }, this);\n  },\n\n  all: function () {\n    return this.filterByType();\n  },\n\n  filterByType: function (columnType) {\n    if (!_.size(this._columnOptions)) {\n      return [];\n    }\n\n    var columns = _.map(this._columnOptions, function (value, key) {\n      var columnName = key;\n      return {\n        val: columnName,\n        label: columnName,\n        type: value.type\n      };\n    });\n\n    if (_.isArray(columnType)) {\n      columns = columns.filter(function (column) {\n        return _.contains(columnType, column.type);\n      });\n    } else if (columnType) {\n      columns = columns.filter(function (column) {\n        return column.type === columnType;\n      });\n    }\n    return columns;\n  },\n\n  _onQueryDone: function (r) {\n    this._columnOptions = r.fields;\n    this.set('columnsFetched', true);\n    this.trigger('columnsFetched');\n  }\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar cdb = require('cartodb.js');\n\nfunction getQueryForGeometryType (geometryType) {\n  if (geometryType === 'polygon') {\n    return \"select * from obs_legacybuildermetadata('sum')\";\n  } else {\n    return 'select * from obs_legacybuildermetadata()';\n  }\n}\n\n/**\n * this class fetches information from observatory metadata\n */\nmodule.exports = Backbone.Model.extend({\n  initialize: function (attrs, opts) {\n    this._configModel = opts.configModel;\n    this._geometryType = opts.geometryType;\n  },\n\n  sync: function (method, model, options) {\n    var sql = new cdb.SQL({\n      user: this._configModel.get('user_name'),\n      sql_api_template: this._configModel.get('sql_api_template'),\n      api_key: this._configModel.get('api_key')\n    });\n    sql.execute(getQueryForGeometryType(this._geometryType)).done(function (data) {\n      options.success && options.success(data);\n    }).error(function (errors) {\n      // console.log(\"errors:\" + errors);\n    });\n  },\n\n  setGeometryType: function (geometryType) {\n    this._geometryType = geometryType;\n  },\n\n  parse: function (attrs) {\n    var a = {};\n    _.each(attrs.rows, function (r) {\n      var sub = {};\n      _.each(r.subsection, function (s) {\n        var cols = {};\n        _.each(s.f1.columns, function (c) {\n          cols[c.f1.name] = c.f1.id;\n        });\n        sub[s.f1.name] = cols;\n      });\n      a[r.name] = sub;\n    });\n    return a;\n  },\n\n  measurement: function (area) {\n    var subsection = this.get(area);\n    if (subsection) {\n      return _.keys(subsection);\n    }\n    return [];\n  },\n\n  columns: function (area, subsectionName) {\n    var subsection = this.get(area);\n    if (subsection) {\n      return _.keys(subsection[subsectionName] || {});\n    }\n    return [];\n  },\n\n  segment: function (area, subsectionName, column) {\n    var subsection = this.get(area);\n    if (subsection) {\n      return subsection[subsectionName][column];\n    }\n    return null;\n  },\n\n  areas: function () {\n    return _.keys(this.attributes);\n  }\n});\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar ScrollView = require('../../../../components/scroll/scroll-view');\nvar ViewFactory = require('../../../../components/view-factory');\nvar analysisPlaceholderTemplate = require('../analyses/analyses-placeholder.tpl');\nvar analysisSQLErrorTemplate = require('../analyses/analyses-sql-error.tpl');\nvar AnalysisFormView = require('../analyses/analysis-form-view');\nvar AnalysesWorkflowView = require('../analyses/analyses-workflow-view');\nvar AnalysisControlsView = require('../analyses/analysis-controls-view');\nvar QuerySanity = require('../../query-sanity-check');\nvar actionErrorTemplate = require('../../sql-error-action.tpl');\nvar OverlayView = require('../../../components/overlay/overlay-view');\nvar AnalysesQuotaInfo = require('./analyses-quota/analyses-quota-info');\n\nvar STATES = {\n  ready: 'ready',\n  loading: 'loading',\n  fetched: 'fetched',\n  error: 'error'\n};\n\n/**\n * LayerContentAnalysesView:\n *    ScrollView\n *   |    ListView:\n *   |        WorkflowView\n *   |        FormTypeView\n *    ControlsView\n */\nmodule.exports = CoreView.extend({\n\n  options: {\n    selectedNodeId: false // or an id, e.g. 'a1'\n  },\n\n  initialize: function (opts) {\n    if (!opts.userActions) throw new Error('userActions is required');\n    if (!opts.analysisFormsCollection) throw new Error('analysisFormsCollection is required');\n    if (!opts.layerDefinitionModel) throw new Error('layerDefinitionModel is required');\n    if (!opts.analysisDefinitionNodesCollection) throw new Error('analysisDefinitionNodesCollection is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.stackLayoutModel) throw new Error('stackLayoutModel is required');\n    if (!opts.overlayModel) throw new Error('overlayModel is required');\n\n    this._userActions = opts.userActions;\n    this._stackLayoutModel = opts.stackLayoutModel;\n    this._userModel = opts.userModel;\n    this._analysisFormsCollection = opts.analysisFormsCollection;\n    this._layerDefinitionModel = opts.layerDefinitionModel;\n    this._analysisDefinitionNodesCollection = opts.analysisDefinitionNodesCollection;\n    this._configModel = opts.configModel;\n    this._overlayModel = opts.overlayModel;\n\n    this._viewModel = new Backbone.Model({selectedNodeId: this.options.selectedNodeId});\n    this._querySchemaModel = this._layerDefinitionModel.getAnalysisDefinitionNodeModel().querySchemaModel;\n\n    this._quotaInfo = AnalysesQuotaInfo.get(opts.configModel);\n\n    this.modelView = new Backbone.Model({\n      state: this._getInitialState()\n    });\n\n    this._initBinds();\n\n    QuerySanity.track(this, this.render.bind(this));\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n\n    if (this._hasError()) {\n      this.$el.html(\n        analysisSQLErrorTemplate({\n          body: _t('editor.error-query.body', {\n            action: actionErrorTemplate({\n              label: _t('editor.error-query.label')\n            })\n          })\n        })\n      );\n    } else {\n      if (this._analysisFormsCollection.isEmpty()) {\n        this.$el.html(analysisPlaceholderTemplate());\n      } else {\n        var formModel = this._formModel();\n        this._renderScrollableListView(formModel);\n        this._renderControlsView(formModel);\n      }\n    }\n    this._renderOverlay();\n    return this;\n  },\n\n  clean: function () {\n    CoreView.prototype.clean.apply(this);\n    this._selectedNodeId(null, {silent: true});\n  },\n\n  _renderOverlay: function () {\n    var view = new OverlayView({\n      overlayModel: this._overlayModel\n    });\n    this.addView(view);\n    this.$el.append(view.render().el);\n  },\n\n  _getInitialState: function () {\n    return STATES.loading;\n  },\n\n  _hasError: function () {\n    return this.modelView.get('state') === STATES.error;\n  },\n\n  _initBinds: function () {\n    // Init listeners\n    this._viewModel.on('change:selectedNodeId', this.render, this);\n    this.add_related_model(this._viewModel);\n\n    this._layerDefinitionModel.on('change:source', this._onLayerDefSourceChanged, this);\n    this.add_related_model(this._layerDefinitionModel);\n\n    this._analysisFormsCollection.on('add', this._onFormModelAdded, this);\n    this._analysisFormsCollection.on('remove', this._onFormModelRemoved, this);\n    this.add_related_model(this._analysisFormsCollection);\n  },\n\n  _renderScrollableListView: function (formModel) {\n    var self = this;\n\n    var view = new ScrollView({\n      createContentView: function () {\n        return ViewFactory.createListView([\n          function () {\n            return new AnalysesWorkflowView({\n              analysisDefinitionNodesCollection: self._analysisDefinitionNodesCollection,\n              layerDefinitionModel: self._layerDefinitionModel,\n              analysisFormsCollection: self._analysisFormsCollection,\n              viewModel: self._viewModel\n            });\n          },\n          function () {\n            return new AnalysisFormView({\n              formModel: formModel,\n              configModel: self._configModel,\n              userModel: self._userModel\n            });\n          }\n        ]);\n      }\n    });\n    this.$el.append(view.render().el);\n    this.addView(view);\n  },\n\n  _renderControlsView: function (formModel) {\n    var analysisNode = this._analysisDefinitionNodesCollection.get(formModel.id);\n\n    var view = new AnalysisControlsView({\n      configModel: this._configModel,\n      analysisNode: analysisNode,\n      userActions: this._userActions,\n      userModel: this._userModel,\n      stackLayoutModel: this._stackLayoutModel,\n      formModel: formModel,\n      quotaInfo: this._quotaInfo,\n      querySchemaModel: this._getQuerySchemaModelForEstimation()\n    });\n    this.addView(view);\n    this.$el.append(view.render().el);\n  },\n\n  _formModel: function () {\n    return this._analysisFormsCollection.get(this._selectedNodeId()) || this._analysisFormsCollection.first();\n  },\n\n  _getQuerySchemaModelForEstimation: function () {\n    var node = this._analysisDefinitionNodesCollection.get(this._selectedNodeId());\n    var index;\n\n    if (!node) {\n      node = this._layerDefinitionModel.getAnalysisDefinitionNodeModel();\n    } else {\n      index = this._analysisDefinitionNodesCollection.indexOf(node);\n      node = this._analysisDefinitionNodesCollection.at(index - 1);\n    }\n\n    return node.querySchemaModel;\n  },\n\n  _selectedNodeId: function (id, options) {\n    if (!this._viewModel) {\n      return;\n    }\n\n    if (id === undefined) {\n      return this._viewModel.get('selectedNodeId');\n    } else {\n      this._viewModel.set('selectedNodeId', id, options);\n    }\n  },\n\n  _onLayerDefSourceChanged: function () {\n    // When reset, the parent view is rendered again, creating a new instance of this one\n    // calling here this._renderWithDefaultNodeSelected(); will cause a race condition\n    // ending up in two instance of this being rendered\n    this._analysisFormsCollection.resetByLayerDefinition();\n  },\n\n  _onFormModelAdded: function () {\n    this._renderWithDefaultNodeSelected();\n  },\n\n  _onFormModelRemoved: function () {\n    this._renderWithDefaultNodeSelected();\n  },\n\n  _renderWithDefaultNodeSelected: function () {\n    var selectedNodeId = this._analysisFormsCollection.pluck('id')[0];\n    this._selectedNodeId(selectedNodeId, {silent: true});\n    this.render();\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-content js-content\"></div>\\n<div class=\"js-info\"></div>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<ul class=\"CodeMirror-error\">\\n  <li class=\"CodeMirror-errorMessage u-lSpace--xl u-rSpace--xl\">\\n    '+\n((__t=( _t('components.codemirror.syntax-error') ))==null?'':_.escape(__t))+\n': <span>'+\n((__t=( message ))==null?'':_.escape(__t))+\n'</span>\\n  </li>\\n  <li class=\"CodeMirror-errorDocs\">\\n    <a href=\"https://carto.com/docs/carto-engine/sql-api/\" target=\"_black\">'+\n((__t=( _t('components.codemirror.docs') ))==null?'':_.escape(__t))+\n'</a>\\n  </li>\\n</ul>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\n\nvar BLACKLISTED_COLUMNS = ['created_at', 'the_geom', 'the_geom_webmercator', 'updated_at'];\n\nmodule.exports = function (nodeDefModel, layerDefinitionModel) {\n  var tuplesItems = {};\n\n  if (!layerDefinitionModel) return tuplesItems; // e.g. if the node is one of those temporary tables\n\n  var querySchemaModel = nodeDefModel.querySchemaModel;\n  if (!querySchemaModel) return tuplesItems;\n\n  querySchemaModel.columnsCollection.each(function (m) {\n    var columnName = m.get('name');\n\n    if (!_.contains(BLACKLISTED_COLUMNS, columnName)) {\n      var key = columnName + '-' + m.get('type');\n      var tuples = tuplesItems[key] = tuplesItems[key] || [];\n      tuples.push({\n        analysisDefinitionNodeModel: nodeDefModel,\n        layerDefinitionModel: layerDefinitionModel,\n        columnModel: m\n      });\n    }\n  });\n\n  return tuplesItems;\n};\n",
    "var $ = require('jquery');\nvar Backbone = require('backbone');\nvar createTuplesItems = require('./create-tuples-items');\nvar widgetsTypes = require('./widgets-types');\n\nmodule.exports = Backbone.Model.extend({\n  defaults: {\n    render: false\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.layerDefinitionModel) { throw new Error('layerDefinitionModel is required'); }\n    if (!opts.widgetDefinitionsCollection) { throw new Error('widgetDefinitionsCollection is required'); }\n    if (!opts.tableStats) { throw new Error('tablestats is required'); }\n\n    this._layerDefinitionModel = opts.layerDefinitionModel;\n    this._analysisDefinitionNode = this._layerDefinitionModel.getAnalysisDefinitionNodeModel();\n    this._widgetDefinitionsCollection = opts.widgetDefinitionsCollection;\n    this._tableStats = opts.tableStats;\n    this._columnsCollection = new Backbone.Collection();\n  },\n\n  getCollection: function () {\n    return this._columnsCollection;\n  },\n\n  createColumnCollection: function () {\n    var tuplesItems = createTuplesItems(this._analysisDefinitionNode, this._layerDefinitionModel);\n    var models = widgetsTypes(tuplesItems);\n    this._columnsCollection.reset(models);\n    this._generateGraphs();\n  },\n\n  _generateGraphs: function () {\n    var self = this;\n\n    var promises = this._columnsCollection.map(function (stat) {\n      var table = stat.get('table');\n      var column = stat.get('name');\n      var deferred = new $.Deferred();\n\n      self._locateWidget(stat);\n\n      self._tableStats.graphFor(table, column, function (graph) {\n        if (graph.stats) {\n          stat.set({graph: graph});\n        }\n        deferred.resolve();\n      });\n\n      return deferred.promise();\n    }, this);\n\n    $.when.apply($, promises).done(function () {\n      self.set({render: self._columnsCollection.length > 0});\n    });\n  },\n\n  findWidget: function (model) {\n    var type = model.get('type');\n    var column = model.get('name');\n\n    return this._widgetDefinitionsCollection.findWhere({\n      type: type,\n      source: model.analysisDefinitionNodeModel().id,\n      column: column\n    });\n  },\n\n  _locateWidget: function (model) {\n    var widget = this.findWidget(model);\n\n    if (widget) {\n      model.set({\n        selected: true,\n        widget: widget\n      }, {silent: true});\n    }\n  },\n\n  getColumnsWithWidgetAndGraph: function () {\n    return this._columnsCollection.filter(function (model) {\n      return !!model.get('widget') && !!model.get('graph');\n    });\n  },\n\n  getColumnsWithWidget: function () {\n    return this._columnsCollection.filter(function (model) {\n      return !!model.get('widget') && !model.get('graph');\n    });\n  },\n\n  getColumnsWithGraph: function () {\n    return this._columnsCollection.filter(function (model) {\n      return !!model.get('graph') && !model.get('widget');\n    });\n  },\n\n  getColumnsWithoutGraph: function () {\n    return this._columnsCollection.filter(function (model) {\n      return !model.get('graph') && !model.get('widget');\n    });\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<h2 class=\"CDB-Text CDB-Size-huge is-light u-secondaryTextColor\">\\n  '+\n((__t=( body ))==null?'':__t)+\n'\\n</h2>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='';\n if (renderLoading) { \n__p+='\\n<div class=\"Data-loaderContainer\">\\n  <div class=\"CDB-Loader is-visible\"></div>\\n</div>\\n';\n } \n__p+='\\n\\n<div class=\"FormPlaceholder-paragraph u-tSpace-m u-flex\">\\n  <div class=\"FormPlaceholder-step u-rSpace--m\"></div>\\n  <div class=\"FormPlaceholder-inner\">\\n    <span class=\"FormPlaceholder-label FormPlaceholder-size--med u-tSpace-xl\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med u-tSpace-xl\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med\"></span>\\n    <span class=\"FormPlaceholder-label FormPlaceholder-size--short u-tSpace-xl\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--long u-tSpace-xl\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--long\"></span>\\n  </div>\\n</div>\\n\\n<div class=\"FormPlaceholder-paragraph u-tSpace-m u-flex\">\\n  <div class=\"FormPlaceholder-step u-rSpace--m\"></div>\\n  <div class=\"FormPlaceholder-inner\">\\n    <span class=\"FormPlaceholder-label FormPlaceholder-size--med u-tSpace-xl\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med u-tSpace-xl\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med\"></span>\\n    <span class=\"FormPlaceholder-label FormPlaceholder-size--short u-tSpace-xl\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--long u-tSpace-xl\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--long\"></span>\\n  </div>\\n</div>\\n\\n<div class=\"FormPlaceholder-paragraph u-tSpace-m u-flex\">\\n  <div class=\"FormPlaceholder-step u-rSpace--m\"></div>\\n  <div class=\"FormPlaceholder-inner\">\\n    <span class=\"FormPlaceholder-label FormPlaceholder-size--med u-tSpace-xl\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med u-tSpace-xl\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med\"></span>\\n    <span class=\"FormPlaceholder-label FormPlaceholder-size--short u-tSpace-xl\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--long u-tSpace-xl\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--long\"></span>\\n  </div>\\n</div>\\n\\n<div class=\"FormPlaceholder-paragraph u-tSpace-m u-flex\">\\n  <div class=\"FormPlaceholder-step u-rSpace--m\"></div>\\n  <div class=\"FormPlaceholder-inner\">\\n    <span class=\"FormPlaceholder-label FormPlaceholder-size--med u-tSpace-xl\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med u-tSpace-xl\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med\"></span>\\n    <span class=\"FormPlaceholder-label FormPlaceholder-size--short u-tSpace-xl\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--long u-tSpace-xl\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--long\"></span>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar StatView = require('./stat-view');\nvar dataNotReadyTemplate = require('./data-content-not-ready.tpl');\nvar dataErrorTemplate = require('./data-content-error.tpl');\nvar actionErrorTemplate = require('../../sql-error-action.tpl');\nvar QuerySanity = require('../../query-sanity-check');\nvar OverlayView = require('../../../components/overlay/overlay-view');\nvar checkAndBuildOpts = require('../../../../helpers/required-opts');\n\nvar STATES = {\n  ready: 'ready',\n  loading: 'loading',\n  nogeometry: 'no-geometry',\n  error: 'error'\n};\n\nvar REQUIRED_OPTS = [\n  'columnsModel',\n  'infoboxModel',\n  'overlayModel',\n  'queryGeometryModel',\n  'querySchemaModel',\n  'stackLayoutModel',\n  'userActions',\n  'widgetDefinitionsCollection'\n];\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    this._columnsCollection = this._columnsModel.getCollection();\n\n    this.modelView = new Backbone.Model({\n      state: this._getInitialState(),\n      renderLoading: true\n    });\n\n    this._initBinds();\n    QuerySanity.track(this, this.render.bind(this));\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n\n    if (this._hasError()) {\n      this._showError();\n    } else if (this._hasNoGeometryData()) {\n      this._showNoGeometryData();\n    } else if (this._isLoading()) {\n      this._showLoading();\n    } else if (this._isReady()) {\n      this._renderStats();\n    }\n\n    this._renderOverlay();\n    return this;\n  },\n\n  _renderOverlay: function () {\n    var view = new OverlayView({\n      overlayModel: this._overlayModel\n    });\n    this.addView(view);\n    this.$el.append(view.render().el);\n  },\n\n  _showLoading: function () {\n    this.$el.empty();\n    this.$el.append(\n      dataNotReadyTemplate({\n        renderLoading: this.modelView.get('renderLoading')\n      })\n    );\n  },\n\n  _showError: function () {\n    this.$el.append(\n      dataErrorTemplate({\n        body: _t('editor.error-query.body', {\n          action: actionErrorTemplate({\n            label: _t('editor.error-query.label')\n          })\n        })\n      })\n    );\n  },\n\n  _showNoGeometryData: function () {\n    this.$el.append(\n      dataErrorTemplate({\n        body: _t('editor.data.no-geometry-data')\n      })\n    );\n  },\n\n  _getInitialState: function () {\n    return this._columnsReady() ? STATES.ready : STATES.loading;\n  },\n\n  _hasError: function () {\n    return this.modelView.get('state') === STATES.error;\n  },\n\n  _isLoading: function () {\n    return this.modelView.get('state') === STATES.loading;\n  },\n\n  _isReady: function () {\n    return this.modelView.get('state') === STATES.ready;\n  },\n\n  _columnsReady: function () {\n    return this._columnsModel.get('render') === true;\n  },\n\n  _hasNoGeometryData: function () {\n    return this.modelView.get('state') === STATES.nogeometry;\n  },\n\n  _initBinds: function () {\n    this.listenTo(this.modelView, 'change:state', this.render);\n    this.listenTo(this._queryGeometryModel, 'change:status', this._checkGeometry);\n    this.listenTo(this._queryGeometryModel, 'change:simple_geom', this.render);\n    this.listenTo(this._columnsModel, 'change:render', this._handleStats);\n    this.listenTo(this._columnsCollection, 'change:selected', this._handleWidget);\n  },\n\n  _checkGeometry: function (m, status) {\n    var hasGeometryData;\n    if (status === 'fetched') {\n      hasGeometryData = this._queryGeometryModel.hasValue();\n      !hasGeometryData && this.modelView.set({state: STATES.nogeometry});\n    }\n  },\n\n  _handleWidget: function (model) {\n    var m, candidate;\n    if (model.get('selected') === true) {\n      candidate = this._columnsModel.findWidget(model);\n      if (!candidate) {\n        m = this._userActions.saveWidgetOption(model);\n        model.set({widget: m});\n\n        // uncheck previous date column\n        if (model.get('type') === 'time-series') {\n          this._normalizeTimeSeriesColumn(model);\n        }\n      } else {\n        model.set({widget: candidate});\n      }\n    } else {\n      m = model.get('widget');\n      m && m.destroy();\n    }\n  },\n\n  _normalizeTimeSeriesColumn: function (lastModel) {\n    var existingDefModel = this._columnsCollection.findWhere(function (m) {\n      return m.get('type') === 'time-series' && m.get('selected') === true && m.cid !== lastModel.cid;\n    });\n\n    existingDefModel && existingDefModel.set({\n      selected: false,\n      widget: null\n    });\n  },\n\n  _handleStats: function () {\n    if (this._columnsReady()) {\n      // we force render because the state could be ready already\n      this.modelView.set({\n        state: STATES.ready,\n        renderLoading: true\n      }, {\n        silent: true\n      });\n      this.render();\n    } else {\n      // if there are not stats, we hide loading and show placeholder\n      this.modelView.set({\n        state: STATES.loading,\n        renderLoading: false\n      });\n    }\n  },\n\n  _renderStats: function () {\n    if (!this._columnsReady()) {\n      return;\n    }\n    var withWidgetAndGraph = this._columnsModel.getColumnsWithWidgetAndGraph();\n    var withWidget = this._columnsModel.getColumnsWithWidget();\n    var withGraph = this._columnsModel.getColumnsWithGraph();\n    var withoutGraph = this._columnsModel.getColumnsWithoutGraph();\n    var all;\n    if (withWidgetAndGraph.length === 0 && withWidget.length === 0 &&\n      withGraph.length === 0 && withoutGraph.length === 0) {\n      this._infoboxModel.set({\n        state: 'no-data',\n        renderLoading: false\n      });\n      this._showLoading();\n    } else {\n      this.$el.empty();\n      all = _.union(withWidgetAndGraph, withWidget, withGraph, withoutGraph);\n      this._renderColumns(all);\n    }\n  },\n\n  _renderColumns: function (stats) {\n    _.each(stats, function (stat, index) {\n      var view = new StatView({\n        stackLayoutModel: this._stackLayoutModel,\n        statModel: stat\n      });\n\n      this.addView(view);\n      this.$el.append(view.render().el);\n    }, this);\n  }\n});\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar UndoManager = require('../../../../data/undo-manager.js');\n\n/**\n *  Data SQL Undo-redo model\n */\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    content: ''\n  },\n\n  initialize: function (attrs, opts) {\n    this._history = this._generateHistory(opts && opts.history);\n\n    UndoManager.init(this, {\n      track: true,\n      history: this._history\n    });\n  },\n\n  _generateHistory: function (history) {\n    if (history && history.length) {\n      var data = _.reduce(history, function (memo, sql) {\n        memo.push({\n          content: sql\n        });\n        return memo;\n      }, [], this);\n      return data;\n    }\n\n    return false;\n  },\n\n  getHistory: function () {\n    return _.pluck(\n      this.getUndoHistory(),\n      'content'\n    );\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar CodeMirrorView = require('../../../../components/code-mirror/code-mirror-view');\nvar ErrorTemplate = require('./code-mirror-error.tpl');\nvar FactoryHints = require('../../../editor-hints/factory-hints');\nvar SQLHints = require('../../../editor-hints/sql-hints');\n\nmodule.exports = CoreView.extend({\n\n  className: 'Editor-dataContentSQL Editor-content',\n\n  initialize: function (opts) {\n    if (!opts.layerDefinitionModel) throw new Error('layerDefinitionModel is required');\n    if (!opts.querySchemaModel) throw new Error('querySchemaModel is required');\n    if (!opts.codemirrorModel) throw new Error('codemirrorModel is required');\n    if (!opts.onApplyEvent) throw new Error('onApplyEvent');\n\n    this._layerDefinitionModel = opts.layerDefinitionModel;\n    this._querySchemaModel = opts.querySchemaModel;\n    this._codemirrorModel = opts.codemirrorModel;\n\n    this._initBinds();\n\n    FactoryHints.init({\n      querySchemaModel: this._querySchemaModel,\n      layerDefinitionModel: this._layerDefinitionModel,\n      tokens: SQLHints\n    });\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this._initViews();\n    return this;\n  },\n\n  _initBinds: function () {\n    this._querySchemaModel.on('change:query', this._onQueryChanged, this);\n    this.add_related_model(this._querySchemaModel);\n  },\n\n  _onQueryChanged: function (mdl, status) {\n    if (status === 'fetched') {\n      this.codeMirrorView.updateHints(SQLHints.reset().hints);\n    }\n  },\n\n  _initViews: function () {\n    var hints = FactoryHints.reset().hints;\n    this.codeMirrorView = new CodeMirrorView({\n      model: this._codemirrorModel,\n      hints: hints,\n      mode: 'text/x-pgsql',\n      tip: _t('editor.data.code-mirror.tip'),\n      errorTemplate: ErrorTemplate\n    });\n\n    this.codeMirrorView.bind('codeSaved', this._triggerCodeSaved, this);\n    this.addView(this.codeMirrorView);\n    this.$el.append(this.codeMirrorView.render().el);\n  },\n\n  _updateEditorContent: function () {\n    this.codeMirrorView.setContent(this._layerDefinitionModel.get('sql'));\n  },\n\n  _triggerCodeSaved: function (code, view) {\n    this.options.onApplyEvent && this.options.onApplyEvent();\n  }\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar PanelWithOptionsView = require('../../../../components/view-options/panel-with-options-view');\nvar ScrollView = require('../../../../components/scroll/scroll-view');\nvar DatasetBaseView = require('../../../../components/dataset/dataset-base-view');\nvar DataContentView = require('./data-content-view');\nvar DataSQLView = require('./data-sql-view');\nvar TabPaneView = require('../../../../components/tab-pane/tab-pane-view');\nvar TabPaneCollection = require('../../../../components/tab-pane/tab-pane-collection');\nvar Toggler = require('../../../../components/toggler/toggler-view');\nvar UndoButtons = require('../../../../components/undo-redo/undo-redo-view');\nvar Infobox = require('../../../../components/infobox/infobox-factory');\nvar InfoboxModel = require('../../../../components/infobox/infobox-model');\nvar InfoboxCollection = require('../../../../components/infobox/infobox-collection');\nvar TableStats = require('../../../../components/modals/add-widgets/tablestats');\nvar DataColumnsModel = require('./data-columns-model');\nvar SQLNotifications = require('../../../../sql-notifications');\nvar MetricsTracker = require('../../../../components/metrics/metrics-tracker');\nvar OnboardingLauncher = require('../../../../components/onboardings/generic/generic-onboarding-launcher');\nvar OnboardingView = require('../../../../components/onboardings/layers/data-onboarding/data-onboarding-view');\nvar layerOnboardingKey = require('../../../../components/onboardings/layers/layer-onboarding-key');\nvar checkAndBuildOpts = require('../../../../helpers/required-opts');\nvar AnalysesService = require('../analyses/analyses-service.js');\n\nvar REQUIRED_OPTS = [\n  'widgetDefinitionsCollection',\n  'stackLayoutModel',\n  'userActions',\n  'layerDefinitionModel',\n  'userModel',\n  'onboardings',\n  'onboardingNotification'\n];\n\nmodule.exports = DatasetBaseView.extend({\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n    this._nodeModel = opts.layerDefinitionModel.getAnalysisDefinitionNodeModel();\n    this._querySchemaModel = this._nodeModel.querySchemaModel;\n    this._queryGeometryModel = this._nodeModel.queryGeometryModel;\n\n    DatasetBaseView.prototype.initialize.call(this, {\n      layerDefinitionModel: opts.layerDefinitionModel,\n      editorModel: opts.editorModel,\n      configModel: opts.configModel,\n      querySchemaModel: this._querySchemaModel\n    });\n\n    var canBeGeoreferenced = this._layerDefinitionModel.canBeGeoreferenced() ? 'georeference' : '';\n\n    this._infoboxModel = new InfoboxModel({\n      state: this._isLayerHidden() ? 'layer-hidden' : canBeGeoreferenced\n    });\n\n    this._overlayModel = new Backbone.Model({\n      visible: this._isLayerHidden()\n    });\n\n    this._tableStats = new TableStats({\n      configModel: this._configModel,\n      userModel: this._userModel\n    });\n\n    this._columnsModel = new DataColumnsModel({}, {\n      layerDefinitionModel: this._layerDefinitionModel,\n      widgetDefinitionsCollection: this._widgetDefinitionsCollection,\n      tableStats: this._tableStats\n    });\n\n    SQLNotifications.track(this);\n\n    this._parseSQL = this._internalParseSQL.bind(this, this._afterAlterDataSuccess);\n\n    this._onboardingLauncher = new OnboardingLauncher({\n      view: OnboardingView,\n      onboardingNotification: this._onboardingNotification,\n      notificationKey: layerOnboardingKey,\n      onboardings: this._onboardings\n    }, {\n      editorModel: this._editorModel,\n      selector: 'LayerOnboarding'\n    });\n\n    this._configPanes();\n    this._initBinds();\n    this._initData();\n  },\n\n  render: function () {\n    this._launchOnboarding();\n    this.clearSubViews();\n    this.$el.empty();\n    this._initViews();\n    return this;\n  },\n\n  _launchOnboarding: function () {\n    if (this._onboardingNotification.getKey(layerOnboardingKey)) {\n      return;\n    }\n\n    if (!this._editorModel.isEditing()) {\n      this._onboardingLauncher.launch({\n        numberOfWidgets: this._widgetDefinitionsCollection.length,\n        hasTimeSeries: this._widgetDefinitionsCollection.isThereTimeSeries(),\n        hasAnimatedTimeSeries: this._widgetDefinitionsCollection.isThereTimeSeries({ animated: true })\n      });\n    }\n  },\n\n  _initData: function () {\n    if (this._hasFetchedQuerySchema()) {\n      this._onQuerySchemaStatusChange();\n    }\n  },\n\n  _redirectIfErrors: function () {\n    var errors = this._querySchemaModel.get('query_errors');\n    if (errors && errors.length > 0) {\n      this._showErrors();\n      this._editorModel.set({\n        edition: true\n      });\n    }\n  },\n\n  _onQuerySchemaChange: function () {\n    if (this._hasFetchedQuerySchema()) {\n      this._codemirrorModel.set({content: this._querySchemaModel.get('query')});\n    }\n  },\n\n  _onQuerySchemaStatusChange: function () {\n    if (this._hasFetchedQuerySchema()) {\n      this._columnsModel.createColumnCollection();\n    }\n  },\n\n  _hasFetchedQuerySchema: function () {\n    return this._querySchemaModel.isFetched();\n  },\n\n  _initBinds: function () {\n    this.listenTo(this._editorModel, 'change:edition', this._onChangeEdition);\n\n    this.listenTo(this._querySchemaModel, 'change:query', this._onQuerySchemaChange);\n    this.listenTo(this._querySchemaModel, 'change:status', this._onQuerySchemaStatusChange);\n    this.listenTo(this._querySchemaModel, 'change:query_errors', this._showErrors);\n\n    this.listenTo(this._sqlModel, 'undo redo', function () {\n      this._codemirrorModel.set('content', this._sqlModel.get('content'));\n    }.bind(this));\n\n    this.listenTo(this._layerDefinitionModel, 'change:visible', this._infoboxState);\n  },\n\n  _runQuery: function (query, callback) {\n    this._querySchemaModel.set({\n      query: query,\n      status: 'unfetched'\n    });\n\n    this._queryGeometryModel.set({\n      query: query\n    });\n\n    SQLNotifications.showNotification({\n      status: 'loading',\n      info: _t('notifications.sql.applying'),\n      closable: false\n    });\n\n    var saveSQL = _.after(2, callback);\n    this._querySchemaModel.fetch({ success: saveSQL });\n    this._queryGeometryModel.fetch({ complete: saveSQL });\n  },\n\n  _saveSQL: function () {\n    var query = this._codemirrorModel.get('content');\n\n    this._sqlModel.set('content', query);\n    this._userActions.saveAnalysisSourceQuery(query, this._nodeModel, this._layerDefinitionModel);\n    this._querySchemaModel.set('query_errors', []);\n\n    SQLNotifications.showNotification({\n      status: 'success',\n      info: _t('notifications.sql.success'),\n      closable: true\n    });\n\n    this._checkClearButton();\n\n    MetricsTracker.track('Applied sql', {\n      node_id: this._nodeModel.get('id'),\n      sql: this._nodeModel.get('query')\n    });\n  },\n\n  _isQueryAlreadyApplied: function (query) {\n    var history = this._sqlModel.getUndoHistory();\n    var last = _.last(history);\n    return last && last.content && last.content.toLowerCase() === query.toLowerCase();\n  },\n\n  _updateVisNotification: function () {\n    SQLNotifications.showNotification({\n      status: 'success',\n      info: _t('notifications.sql.success'),\n      closable: true\n    });\n  },\n\n  _defaultSQL: function () {\n    return this._nodeModel.getDefaultQuery();\n  },\n\n  _afterAlterDataSuccess: function () {\n    var originalQuery = this._defaultSQL();\n    this._userActions.saveAnalysisSourceQuery(originalQuery, this._nodeModel, this._layerDefinitionModel);\n  },\n\n  _hasAnalysisApplied: function () {\n    return this._nodeModel.get('type') !== 'source';\n  },\n\n  _onChangeEdition: function () {\n    this._infoboxState();\n\n    var edition = this._editorModel.get('edition');\n    var index = edition ? 1 : 0;\n    this._collectionPane.at(index).set({ selected: true });\n  },\n\n  _configPanes: function () {\n    var self = this;\n    var tabPaneTabs = [{\n      selected: !this._editorModel.get('edition'),\n      createContentView: function () {\n        return new ScrollView({\n          createContentView: function () {\n            return new DataContentView({\n              className: 'Editor-content',\n              stackLayoutModel: self._stackLayoutModel,\n              widgetDefinitionsCollection: self._widgetDefinitionsCollection,\n              columnsModel: self._columnsModel,\n              querySchemaModel: self._querySchemaModel,\n              queryGeometryModel: self._queryGeometryModel,\n              userActions: self._userActions,\n              infoboxModel: self._infoboxModel,\n              overlayModel: self._overlayModel\n            });\n          }\n        });\n      },\n      createActionView: function () {\n        return new CoreView();\n      }\n    }, {\n      selected: this._editorModel.get('edition'),\n      createContentView: function () {\n        return new DataSQLView({\n          layerDefinitionModel: self._layerDefinitionModel,\n          querySchemaModel: self._querySchemaModel,\n          codemirrorModel: self._codemirrorModel,\n          onApplyEvent: self._parseSQL\n        });\n      },\n      createActionView: function () {\n        var isAnalysis = self._hasAnalysisApplied();\n        if (!isAnalysis) {\n          self._checkClearButton();\n          return new UndoButtons({\n            trackModel: self._sqlModel,\n            editorModel: self._editorModel,\n            clearModel: self._clearSQLModel,\n            applyButton: true,\n            clearButton: true,\n            onApplyClick: self._parseSQL,\n            onClearClick: self._clearSQL.bind(self)\n          });\n        }\n      }\n    }];\n\n    this._collectionPane = new TabPaneCollection(tabPaneTabs);\n  },\n\n  _confirmReadOnly: function () {\n    this._infoboxModel.set({state: ''});\n  },\n\n  _initViews: function () {\n    var self = this;\n\n    var infoboxSstates = [\n      {\n        state: 'georeference',\n        createContentView: function () {\n          var name = this._layerDefinitionModel ? this._layerDefinitionModel.getTableName() : '';\n          var body = [_t('editor.tab-pane.layers.georeference.body', { name: name }),\n                      _t('editor.layers.georeference.manually-add')].join(' ');\n\n          return Infobox.createWithAction({\n            type: 'alert',\n            title: _t('editor.tab-pane.layers.georeference.title'),\n            body: body,\n            mainAction: {\n              label: _t('editor.layers.georeference.georeference-button')\n            }\n          });\n        },\n        mainAction: self._onGeoreferenceClicked.bind(self)\n      }, {\n        state: 'readonly',\n        createContentView: function () {\n          return Infobox.createWithAction({\n            type: 'code',\n            title: _t('editor.data.messages.sql-readonly.title'),\n            body: _t('editor.data.messages.sql-readonly.body'),\n            mainAction: {\n              label: _t('editor.data.messages.sql-readonly.accept')\n            }\n          });\n        },\n        mainAction: self._confirmReadOnly.bind(self)\n      }, {\n        state: 'layer-hidden',\n        createContentView: function () {\n          return Infobox.createWithAction({\n            type: 'alert',\n            title: _t('editor.style.messages.layer-hidden.title'),\n            body: _t('editor.style.messages.layer-hidden.body'),\n            mainAction: {\n              label: _t('editor.style.messages.layer-hidden.show')\n            }\n          });\n        },\n        mainAction: self._showHiddenLayer.bind(self)\n      }, {\n        state: 'no-data',\n        createContentView: function () {\n          return Infobox.createInfo({\n            type: 'alert',\n            title: _t('editor.data.messages.empty-data.title'),\n            body: _t('editor.data.messages.empty-data.body')\n          });\n        }\n      }\n    ];\n\n    var infoboxCollection = new InfoboxCollection(infoboxSstates);\n\n    var panelWithOptionsView = new PanelWithOptionsView({\n      className: 'Editor-content',\n      editorModel: self._editorModel,\n      infoboxModel: self._infoboxModel,\n      infoboxCollection: infoboxCollection,\n      createContentView: function () {\n        return new TabPaneView({\n          collection: self._collectionPane\n        });\n      },\n      createControlView: function () {\n        return new Toggler({\n          editorModel: self._editorModel,\n          labels: [_t('editor.data.data-toggle.values'), _t('editor.data.data-toggle.cartocss')]\n        });\n      },\n      createActionView: function () {\n        return new TabPaneView({\n          collection: self._collectionPane,\n          createContentKey: 'createActionView'\n        });\n      }\n    });\n\n    this.$el.append(panelWithOptionsView.render().el);\n    this.addView(panelWithOptionsView);\n\n    // TOFIX\n    // If there are errors in the SQL, open the sql editor by default\n    // we defer it to not interfere with the high order tabpane item selection\n    setTimeout(this._redirectIfErrors.bind(this), 0);\n  },\n\n  _infoboxState: function () {\n    var edition = this._editorModel.get('edition');\n    var isAnalysis = this._hasAnalysisApplied();\n\n    if (edition && isAnalysis) {\n      this._codemirrorModel.set({readonly: true});\n      this._infoboxModel.set({state: 'readonly'});\n    } else if (!edition && this._isLayerHidden()) {\n      this._infoboxModel.set({state: 'layer-hidden'});\n      this._overlayModel.set({visible: true});\n    } else if (!edition && this._layerDefinitionModel.canBeGeoreferenced()) {\n      this._infoboxModel.set({state: 'georeference'});\n      this._overlayModel.set({visible: false});\n    } else {\n      this._codemirrorModel.set({readonly: false});\n      this._infoboxModel.set({state: ''});\n      this._overlayModel.set({visible: false});\n    }\n  },\n\n  _showHiddenLayer: function () {\n    var savingOptions = {\n      shouldPreserveAutoStyle: true\n    };\n    this._layerDefinitionModel.toggleVisible();\n    this._userActions.saveLayer(this._layerDefinitionModel, savingOptions);\n  },\n\n  _isLayerHidden: function () {\n    return this._layerDefinitionModel.get('visible') === false;\n  },\n\n  _onGeoreferenceClicked: function () {\n    AnalysesService.addGeoreferenceAnalysis();\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<ul class=\"u-flex CDB-Text CDB-Size-small u-upperCase u-bSpace u-secondaryTextColor\">\\n  <li class=\\'u-rSpace--m js-null\\'></li>\\n  <li class=\\'js-percent\\'></li>\\n</ul>\\n<div class=\"js-category-stat\"></div>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<h4 class=\"CDB-Text CDB-Size-huge js-formula-stat\"></h4>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CDB-Text CDB-Size-small u-upperCase u-bSpace u-secondaryTextColor js-histogram-numbers\"></div>\\n<div class=\"js-histogram-stat\"></div>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar template = require('./stat.tpl');\nvar utils = require('../../../../helpers/utils');\nvar templateCategory = require('./stat-category.tpl');\nvar templateHistogram = require('./stat-histogram.tpl');\nvar templateFormula = require('./stat-formula.tpl');\n\nmodule.exports = CoreView.extend({\n  className: 'StatsList',\n\n  events: {\n    'click .js-checkbox': '_onSelect',\n    'click .js-style': '_onEdit'\n  },\n\n  initialize: function (opts) {\n    if (!opts.statModel) throw new Error('statModel is required');\n    if (!opts.stackLayoutModel) throw new Error('StackLayoutModel is required');\n\n    this._statModel = opts.statModel;\n    this._stackLayoutModel = opts.stackLayoutModel;\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this._initViews();\n    return this;\n  },\n\n  _initBinds: function () {\n    this._statModel.on('change:selected', this.render, this);\n    this.add_related_model(this._statModel);\n  },\n\n  _initViews: function () {\n    var graph = this._statModel.get('graph');\n    var type = this._statModel.get('type');\n\n    this._renderTemplate();\n\n    if (graph) {\n      // No graph for formula\n      if (type === 'histogram') {\n        this._showHistogram(graph);\n      } else if (type === 'category') {\n        this._showCategory(graph);\n      } else if (type === 'formula') {\n        this._showFormula(graph);\n      }\n    }\n  },\n\n  _renderTemplate: function () {\n    this.$el.append(template({\n      column: this._statModel.get('title'),\n      type: this._statModel.get('column'),\n      graph: this._statModel.get('type'),\n      isSelected: this._statModel.get('selected')\n    }));\n  },\n\n  _onSelect: function () {\n    this._statModel.set('selected', !this._statModel.get('selected'));\n  },\n\n  _onEdit: function (e) {\n    e.preventDefault();\n    this._stackLayoutModel.goToStep(1, this._statModel.get('widget'), 'widget-content');\n  },\n\n  _showCategory: function (graph) {\n    if (graph.stats && graph.stats.freqs) {\n      this.$('.js-stat').append(templateCategory());\n      this.$('.js-category-stat').append(graph.getCategory({\n        color: '#9DE0AD',\n        width: 262,\n        height: 10\n      }));\n\n      this.$('.js-null').text(utils.formatDecimalPositions(graph.getNullsPercentage() * 100) + _t('editor.data.stats.null'));\n      if (this.options.statModel.attributes.column !== 'boolean') {\n        this.$('.js-percent').text(utils.formatDecimalPositions(graph.getPercentageInTopCategories() * 100) + _t('editor.data.stats.top-cat'));\n      } else {\n        var numOfTrues = graph.getTrues();\n        if (utils.isNumeric(numOfTrues)) {\n          this.$('.js-percent').text(utils.formatDecimalPositions(numOfTrues * 100) + _t('editor.data.stats.trues'));\n        }\n      }\n    }\n  },\n\n  _showHistogram: function (graph) {\n    if (graph.stats) {\n      this.$('.js-stat').append(templateHistogram());\n      this.$('.js-histogram-stat').append(graph.getHistogram({\n        color: '#9DE0AD',\n        width: 262,\n        height: 20,\n        bins: 20\n      }));\n      this.$('.js-histogram-numbers').text(graph.getNullsPercentage() + _t('editor.data.stats.null'));\n    }\n  },\n\n  _showFormula: function (graph) {\n    var aggregation;\n    if (graph.stats) {\n      aggregation = graph.getCount();\n      if (_.isNumber(aggregation)) {\n        this.$('.js-stat').append(templateFormula());\n        this.$('.js-formula-stat').text(aggregation.toFixed().toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ','));\n      }\n    }\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"StatsList-item\">\\n  <div class=\"u-rSpace--m\">\\n    <input class=\"CDB-Checkbox js-checkbox\" type=\"checkbox\" ';\n if (isSelected) { \n__p+='checked=\"checked\"';\n } \n__p+=' />\\n    <span class=\"u-iBlock CDB-Checkbox-face\"></span>\\n  </div>\\n\\n  <div class=\"WidgetList-inner js-inner\">\\n    <div class=\"StatsList-header u-flex u-justifySpace u-alignCenter u-bSpace--m\">\\n      <h3 class=\"u-ellipsis CDB-Text CDB-Size-medium\">'+\n((__t=( _t('editor.data.stats.add-widget') ))==null?'':_.escape(__t))+\n'</h3>\\n      ';\n if (isSelected) { \n__p+='\\n      <button class=\"StatsList-style CDB-Text CDB-Size-small js-style u-actionTextColor\">\\n        <div class=\"StatsList-arrow CDB-Shape-Arrow is-blue u-iBlock  u-rSpace--m\"></div> '+\n((__t=( _t('editor.data.stats.edit') ))==null?'':_.escape(__t))+\n'\\n      </button>\\n      ';\n } \n__p+='\\n    </div>\\n    <div class=\"u-flex u-alignCenter u-bSpace\">\\n      <h2 class=\"js-title u-ellipsis CDB-Text CDB-Size-large u-rSpace--m\">'+\n((__t=( column ))==null?'':_.escape(__t))+\n'</h2>\\n      <div class=\"StatsList-tag Tag Tag--outline Tag-outline--grey CDB-Text CDB-Size-small u-upperCase\">'+\n((__t=( type ))==null?'':_.escape(__t))+\n'</div>\\n    </div>\\n    <div class=\"js-stat\"></div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar FormulaOptionModel = require('../../../../components/modals/add-widgets/formula/formula-option-model');\nvar CategoryOptionModel = require('../../../../components/modals/add-widgets/category/category-option-model');\nvar HistogramOptionModel = require('../../../../components/modals/add-widgets/histogram/histogram-option-model');\nvar TimeSeriesOptionModel = require('../../../../components/modals/add-widgets/time-series/time-series-option-model');\n\nvar CARTODB_ID = 'cartodb_id';\n\nmodule.exports = function (tuplesItems) {\n  return _.reduce(tuplesItems, function (memo, tuples) {\n    var columnModel = tuples[0].columnModel;\n    var layerDef = tuples[0].layerDefinitionModel;\n    var table = layerDef.getTableName();\n    var type = columnModel.get('type');\n    var columnName = columnModel.get('name');\n    var m;\n    var node;\n    var geometry = _t('editor.data.stats.geometry-fallback');\n\n    if (columnName === CARTODB_ID) {\n      node = layerDef.getAnalysisDefinitionNodeModel();\n      if (node && node.queryGeometryModel) {\n        geometry = node.queryGeometryModel.get('simple_geom');\n      }\n\n      m = new FormulaOptionModel({\n        tuples: tuples,\n        table: table,\n        title: _t('editor.data.stats.number-of', {\n          geometry: geometry\n        }),\n        column: columnModel.get('type'),\n        operation: 'count',\n        name: columnName\n      });\n      memo.push(m);\n    } else if (type === 'string' || type === 'boolean') {\n      m = new CategoryOptionModel({\n        tuples: tuples,\n        table: table,\n        title: columnName,\n        name: columnName,\n        column: columnModel.get('type'),\n        aggregation: 'count' // or sum\n      });\n      memo.push(m);\n    } else if (columnModel.get('type') === 'number') {\n      m = new HistogramOptionModel({\n        tuples: tuples,\n        table: table,\n        title: columnName,\n        name: columnName,\n        column: columnModel.get('type'),\n        bins: 10\n      });\n      memo.push(m);\n    } else if (columnModel.get('type') === 'date') {\n      m = new TimeSeriesOptionModel({\n        tuples: tuples,\n        table: table,\n        title: columnName,\n        name: columnName,\n        column: columnModel.get('type'),\n        bins: 256\n      });\n      memo.push(m);\n    }\n    return memo;\n  }, []);\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<ul class=\"CodeMirror-error\">\\n  <li class=\"CodeMirror-errorMessage u-lSpace--xl u-rSpace--xl\">\\n    '+\n((__t=( _t('components.codemirror.syntax-error') ))==null?'':_.escape(__t))+\n'. '+\n((__t=( _t('components.codemirror.line') ))==null?'':_.escape(__t))+\n' '+\n((__t=( line ))==null?'':_.escape(__t))+\n': <span>'+\n((__t=( message ))==null?'':_.escape(__t))+\n'</span>\\n  </li>\\n</ul>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<h2 class=\"CDB-Text CDB-Size-huge is-light u-secondaryTextColor\">'+\n((__t=( _t('editor.layers.infowindow.placeholder-geometry') ))==null?'':_.escape(__t))+\n' '+\n((__t=( _t('editor.layers.georeference.manually-add') ))==null?'':_.escape(__t))+\n'</h2>\\n<div class=\"BlockList-item is-dashed no-hover is-space u-tSpace-xl\">\\n  <ul class=\"HorizontalBlockList\">\\n    <li class=\"HorizontalBlockList-item\"></li>\\n    <li class=\"HorizontalBlockList-item\"></li>\\n  </ul>\\n\\n  <button class=\"CDB-Button CDB-Button--primary js-georeference\">\\n    <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">'+\n((__t=( _t('editor.layers.georeference.georeference-button') ))==null?'':_.escape(__t))+\n'</span>\\n  </button>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./infowindow-apply-button.tpl');\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-apply': '_onApplyClick'\n  },\n\n  initialize: function (opts) {\n    if (!opts.onApplyClick) throw new Error('onApplyClick is required');\n  },\n\n  render: function () {\n    this.$el.html(template());\n    return this;\n  },\n\n  _onApplyClick: function () {\n    this.options.onApplyClick();\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<button class=\"u-lSpace--xl CDB-Button CDB-Button--primary CDB-Button--small js-apply\">\\n  <span class=\"CDB-Text is-semibold CDB-Size-small\">'+\n((__t=( _t(\"editor.infowindow.apply\") ))==null?'':_.escape(__t))+\n'</span>\\n</button>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"js-selector\">\\n  <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n    <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.layers.infowindow.style.title-label') ))==null?'':_.escape(__t))+\n'</h2>\\n  </div>\\n  <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m js-highlight\">'+\n((__t=( _t('editor.layers.infowindow.style.select-style') ))==null?'':_.escape(__t))+\n'</p>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var InfowindowView = require('./infowindow-view');\n\n/**\n * Select for an Infowindow style type.\n */\nmodule.exports = InfowindowView.extend({\n\n  _initTemplates: function () {\n    this._templates = [\n      {\n        value: '',\n        infowindowIcon: require('./infowindow-icons/infowindow-none.tpl'),\n        label: _t('editor.layers.infowindow.style.none')\n      }, {\n        value: 'infowindow_light',\n        infowindowIcon: require('./infowindow-icons/infowindow-light.tpl'),\n        label: _t('editor.layers.infowindow.style.infowindow_light')\n      }, {\n        value: 'infowindow_dark',\n        infowindowIcon: require('./infowindow-icons/infowindow-dark.tpl'),\n        label: _t('editor.layers.infowindow.style.infowindow_dark')\n      }, {\n        value: 'infowindow_color',\n        infowindowIcon: require('./infowindow-icons/infowindow-color.tpl'),\n        label: _t('editor.layers.infowindow.style.infowindow_color')\n      }, {\n        value: 'infowindow_header_with_image',\n        infowindowIcon: require('./infowindow-icons/infowindow-image.tpl'),\n        label: _t('editor.layers.infowindow.style.infowindow_header_with_image')\n      }\n    ];\n  }\n\n});\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar InfowindowSelectView = require('./infowindow-select-view');\nvar InfowindowItemsView = require('./infowindow-items-view');\nvar CarouselCollection = require('../../../../components/custom-carousel/custom-carousel-collection');\nvar loadingTemplate = require('../../panel-loading-template.tpl');\nvar OverlayView = require('../../../components/overlay/overlay-view');\n\n/**\n * Select for an Infowindow select type.\n */\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    if (!opts.querySchemaModel) throw new Error('querySchemaModel is required');\n    if (!opts.layerDefinitionModel) throw new Error('layerDefinitionModel is required');\n    if (!opts.templates) throw new Error('templates is required');\n    if (!opts.overlayModel) throw new Error('overlayModel is required');\n    if (!opts.editorModel) throw new Error('editorModel is required');\n\n    this._querySchemaModel = opts.querySchemaModel;\n    this._layerDefinitionModel = opts.layerDefinitionModel;\n    this._overlayModel = opts.overlayModel;\n    this._templates = opts.templates;\n    this._editorModel = opts.editorModel;\n\n    this._initCollection();\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n\n    if (this._querySchemaModel.get('status') === 'fetched') {\n      this._initViews();\n    } else {\n      this._renderStateless();\n    }\n    this._renderOverlay();\n\n    return this;\n  },\n\n  _renderStateless: function () {\n    this.$el.append(\n      loadingTemplate()\n    );\n  },\n\n  _renderOverlay: function () {\n    var view = new OverlayView({\n      overlayModel: this._overlayModel\n    });\n    this.addView(view);\n    this.$el.append(view.render().el);\n  },\n\n  _initCollection: function () {\n    this._templatesCollection = new CarouselCollection(\n      _.map(this._templates, function (template) {\n        return {\n          selected: this.model.get('template_name') === template.value,\n          val: template.value,\n          label: template.label,\n          template: function () {\n            return (template.infowindowIcon && template.infowindowIcon()) || template.value;\n          }\n        };\n      }, this)\n    );\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:template_name', this._renderItems, this);\n    this.model.bind('change:template', this._updateEditor, this);\n\n    if (this._querySchemaModel.get('status') !== 'fetched') {\n      // status can be: fetched, unavailable, fetching\n      this._querySchemaModel.bind('change:status', this.render, this);\n      this._querySchemaModel.fetch();\n    }\n  },\n\n  _updateEditor: function () {\n    this._editorModel.set('disabled', !this.model.hasTemplate());\n  },\n\n  _initViews: function () {\n    var selectView = new InfowindowSelectView({\n      model: this.model,\n      templatesCollection: this._templatesCollection\n    });\n    this.addView(selectView);\n    this.$el.append(selectView.render().el);\n\n    this._renderItems();\n  },\n\n  _renderItems: function () {\n    if (this._itemsView) {\n      this.removeView(this._itemsView);\n      this._itemsView.clean();\n    }\n\n    this._itemsView = new InfowindowItemsView({\n      model: this.model,\n      querySchemaModel: this._querySchemaModel,\n      layerDefinitionModel: this._layerDefinitionModel,\n      hasValidTemplate: !!this._checkValidTemplate()\n    });\n    this.addView(this._itemsView);\n    this.$el.append(this._itemsView.render().el);\n  },\n\n  _checkValidTemplate: function () {\n    var template = this._templatesCollection.find(function (mdl) {\n      return this.model.get('template_name') === mdl.get('val');\n    }, this);\n\n    return template && template.get('val') !== '';\n  }\n\n});\n",
    "var template = require('./infowindow-description.tpl');\nvar CoreView = require('backbone/core-view');\n\nmodule.exports = CoreView.extend({\n\n  events: {\n    'click .js-toggle': '_toggle'\n  },\n\n  initialize: function (opts) {\n    if (typeof opts.namesCount === 'undefined') throw new Error('namesCount has to be defined');\n\n    this._namesCount = opts.namesCount;\n  },\n\n  render: function () {\n    var totalFields = this._namesCount;\n    var selectedFields = this.model.fieldCount();\n\n    this.$el.html(\n      template({\n        allSelected: selectedFields && (selectedFields === totalFields),\n        noneSelected: !selectedFields,\n        selectedFields: selectedFields\n      })\n    );\n\n    return this;\n  },\n\n  _toggle: function () {\n    this.trigger('toggle');\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-justifySpace u-alignCenter\">\\n  <p class=\"CDB-Text is-semibold CDB-Size-small u-upperCase js-textInfo\">\\n    ';\n if (noneSelected) { \n__p+='\\n      None selected\\n    ';\n } else { \n__p+='\\n      '+\n((__t=( allSelected ? \"All selected\" : selectedFields + \" selected\" ))==null?'':_.escape(__t))+\n'\\n    ';\n }\n__p+='\\n  </p>\\n \\n  <button class=\"CDB-Text CDB-Size-small u-upperCase u-actionTextColor js-toggle\">';\n if (allSelected) { \n__p+='none';\n } else { \n__p+='all';\n } \n__p+='</button>\\n</div>';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar template = require('./infowindow-field.tpl');\n\n/**\n * View for an individual column model.\n */\nmodule.exports = CoreView.extend({\n\n  tagName: 'li',\n\n  className: 'js-field Infowindow-listFieldItem',\n\n  events: {\n    'click .js-checkbox': 'toggle',\n    'keyup .js-input': '_onKeyUp',\n    'blur .js-input': '_onBlur'\n  },\n\n  initialize: function (opts) {\n    if (!opts.layerInfowindowModel) throw new Error('layerInfowindowModel is required');\n\n    this._layerInfowindowModel = opts.layerInfowindowModel;\n\n    this.fieldName = opts.field.name;\n    this.fieldTitle = opts.field.title;\n    this.position = opts.position;\n\n    this._layerInfowindowModel.bind('change:fields', this.render, this);\n\n    this.model = new Backbone.Model({\n      title: this._layerInfowindowModel.getAlternativeName(this.fieldName) || this.fieldName,\n      selected: !!this._layerInfowindowModel.containsField(this.fieldName)\n    });\n    this.model.bind('change:title', this._updateTitle, this);\n    this.model.bind('change:selected', this._updateSelected, this);\n  },\n\n  _onBlur: function (e) {\n    var value = this.$el.find('.js-input').val();\n    value = this._stripHTML(value);\n\n    this.model.set('title', value);\n  },\n\n  _updateTitle: function () {\n    var value = this.model.get('title');\n    value = this._stripHTML(value);\n    this._layerInfowindowModel.setAlternativeName(this.fieldName, value);\n\n    var isBlank = this._isBlank(value);\n    this._layerInfowindowModel.setFieldProperty(this.fieldName, 'title', !isBlank);\n  },\n\n  _onKeyUp: function (e) {\n    if (e.keyCode === 13) { // Enter\n      var value = this.$el.find('.js-input').val();\n      value = this._stripHTML(value);\n\n      this.model.set('title', value);\n    // } else if (e.keyCode === 27) { // Esc\n    //   this._close();\n    }\n  },\n\n  _isBlank: function (str) {\n    return (!str || /^\\s*$/.test(str));\n  },\n\n  _stripHTML: function (input, allowed) {\n    allowed = (((allowed || '') + '').toLowerCase().match(/<[a-z][a-z0-9]*>/g) || []).join('');\n    var tags = /<\\/?([a-z][a-z0-9]*)\\b[^>]*>/gi;\n    if (!input || (typeof input !== 'string')) return '';\n    return input.replace(tags, function ($0, $1) {\n      return allowed.indexOf('<' + $1.toLowerCase() + '>') > -1 ? $0 : '';\n    });\n  },\n\n  render: function () {\n    this.$el.html(template({\n      name: this.fieldName,\n      title: this._layerInfowindowModel.getFieldProperty(this.fieldName, 'title'),\n      alternativeName: this._layerInfowindowModel.getAlternativeName(this.fieldName),\n      isSelected: !!this._layerInfowindowModel.containsField(this.fieldName)\n    }));\n    this.$el.attr('data-view-cid', this.cid);\n\n    return this;\n  },\n\n  toggle: function (e) {\n    e && e.preventDefault();\n\n    this.model.set('selected', !this.model.get('selected'));\n\n    return false;\n  },\n\n  _updateSelected: function (e) {\n    if (!this._layerInfowindowModel.containsField(this.fieldName)) {\n      this._layerInfowindowModel.addField(this.fieldName, this.position);\n    } else {\n      this.model.set('title', null);\n      this._layerInfowindowModel.removeField(this.fieldName);\n    }\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CDB-Text CDB-Fieldset u-tSpace--m\">\\n  <div class=\"CDB-Legend CDB-Legend--big u-ellipsis CDB-Text CDB-Size-medium u-rSpace--m\">\\n    <div class=\"Infowindow-listFieldsOrder CDB-Shape u-iblock u-malign\">\\n      <div class=\"CDB-Shape-rectsHandle is-small\">\\n        <div class=\"CDB-Shape-rectsHandleItem CDB-Shape-rectsHandleItem--grey is-first\"></div>\\n        <div class=\"CDB-Shape-rectsHandleItem CDB-Shape-rectsHandleItem--grey is-second\"></div>\\n        <div class=\"CDB-Shape-rectsHandleItem CDB-Shape-rectsHandleItem--grey is-third\"></div>\\n      </div>\\n    </div>\\n    <input class=\"CDB-Checkbox js-checkbox\" type=\"checkbox\" ';\n if (isSelected) { \n__p+='checked=\"checked\"';\n } \n__p+='\">\\n    <span class=\"u-iBlock CDB-Checkbox-face u-rSpace\"></span>\\n    <label class=\"u-rSpace--m\" title=\"'+\n((__t=( name ))==null?'':_.escape(__t))+\n'\">'+\n((__t=( name ))==null?'':_.escape(__t))+\n'</label>\\n  </div>\\n  <input type=\"text\" name=\"text\" placeholder=\\'\"'+\n((__t=( name ))==null?'':_.escape(__t))+\n'\"\\' value=\"';\n if (!isSelected) { \n__p+=''+\n((__t=( name ))==null?'':_.escape(__t))+\n'';\n } else { \n__p+='';\n if (title) { \n__p+='';\n if (alternativeName) { \n__p+=''+\n((__t=( alternativeName ))==null?'':_.escape(__t))+\n'';\n } else { \n__p+=''+\n((__t=( name ))==null?'':_.escape(__t))+\n'';\n } \n__p+='';\n } \n__p+='';\n } \n__p+='\" class=\"CDB-InputText js-input\" ';\n if (!isSelected) { \n__p+='disabled';\n } \n__p+='>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var FieldView = require('./infowindow-field-view.js');\nvar InfowindowDescriptionView = require('./infowindow-description-view.js');\nvar template = require('./infowindow-fields.tpl');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar $ = require('jquery');\nrequire('jquery-ui');\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    if (!opts.querySchemaModel) throw new Error('querySchemaModel is required');\n    if (!opts.layerDefinitionModel) throw new Error('layerDefinitionModel is required');\n\n    this._querySchemaModel = opts.querySchemaModel;\n    this._layerDefinitionModel = opts.layerDefinitionModel;\n\n    // An internal collection to keep track of the columns and their order\n    this._sortedFields = new Backbone.Collection();\n    this._sortedFields.comparator = function (model) {\n      return model.get('position');\n    };\n\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this.model.bind('remove:fields', this._renderDescription, this);\n    this.model.bind('add:fields', this._renderDescription, this);\n  },\n\n  render: function () {\n    this._destroySortable();\n    this.clearSubViews();\n\n    this.$el.html(template());\n\n    this._renderDescription();\n    this._renderFields();\n    this._initSortable();\n    this._renderSelectAll();\n    this._storeSortedFields();\n\n    return this;\n  },\n\n  _renderDescription: function () {\n    if (this._fieldsDescriptionView) {\n      this.removeView(this._fieldsDescriptionView);\n      this._fieldsDescriptionView.clean();\n    }\n\n    this._fieldsDescriptionView = new InfowindowDescriptionView({\n      model: this.model,\n      namesCount: this._getColumnNames().length\n    });\n\n    this._fieldsDescriptionView.bind('toggle', this.manageAll, this);\n\n    this.addView(this._fieldsDescriptionView);\n    this.$('.js-description').append(this._fieldsDescriptionView.render().el);\n\n    this._renderSelectAll();\n  },\n\n  _renderSelectAll: function () {\n    this.selectedAll = this._allFieldsSelected();\n  },\n\n  _allFieldsSelected: function () {\n    var self = this;\n\n    var selectedAll = true;\n\n    _.each(this._getColumnNames(), function (field) {\n      if (!self.model.containsField(field)) {\n        selectedAll = false;\n      }\n    });\n\n    return selectedAll;\n  },\n\n  manageAll: function (e) {\n    if (!this.selectedAll) {\n      this._selectAll();\n    } else {\n      this._unselectAll();\n    }\n  },\n\n  _selectAll: function () {\n    var self = this;\n\n    var names = this._sortedFields.map(function (w) { return w.get('name'); });\n    var promises = [];\n\n    _.each(names, function (f) {\n      if (!self.model.containsField(f)) {\n        promises.push(self.model._addField(f));\n      }\n    });\n\n    $.when.apply($, promises).then(function () {\n      self.model.sortFields();\n      self.model.trigger('add:fields');\n      self.model.trigger('change:fields', self.model, self.model.get('fields'));\n      self.model.trigger('change', self.model);\n\n      self._toggleSelectAll();\n    });\n  },\n\n  _unselectAll: function () {\n    this.model.clearFields();\n    this.model.trigger('change:fields');\n    this._toggleSelectAll();\n  },\n\n  _toggleSelectAll: function () {\n    this.selectedAll = !this.selectedAll;\n    this._renderDescription();\n  },\n\n  _initSortable: function () {\n    this.$('.js-fields').sortable({\n      axis: 'y',\n      items: '> li',\n      opacity: 0.8,\n      update: this._onSortableFinish.bind(this),\n      forcePlaceholderSize: false\n    });\n  },\n\n  _destroySortable: function () {\n    if (this.$('.js-fields').data('ui-sortable')) {\n      this.$('.js-fields').sortable('destroy');\n    }\n  },\n\n  _onSortableFinish: function () {\n    var self = this;\n    this._sortedFields.reset([]);\n\n    this.$('.js-fields > .js-field').each(function (index, item) {\n      var view = self._subviews[$(item).data('view-cid')];\n\n      self.model.setFieldProperty(view.fieldName, 'position', index);\n      view.position = index;\n\n      self._sortedFields.add({\n        name: view.fieldName,\n        position: index\n      });\n    });\n  },\n\n  _getSortedColumnNames: function () {\n    var self = this;\n    var names = this._getColumnNames();\n\n    if (self.model.fieldCount() > 0) {\n      names.sort(function (a, b) {\n        var pos_a = self.model.getFieldPos(a);\n        var pos_b = self.model.getFieldPos(b);\n        return pos_a - pos_b;\n      });\n    }\n    return names;\n  },\n\n  _storeSortedFields: function () {\n    var self = this;\n\n    this._sortedFields.reset([]);\n\n    var names = this._getSortedColumnNames();\n    _(names).each(function (name, position) {\n      self._sortedFields.add({\n        name: name,\n        position: position\n      });\n    });\n  },\n\n  _getColumnNames: function () {\n    var self = this;\n\n    var filteredColumns = this._querySchemaModel.columnsCollection.filter(function (c) {\n      return !_.contains(self.model.SYSTEM_COLUMNS, c.get('name'));\n    });\n\n    var columnNames = [];\n\n    _.each(filteredColumns, function (m) {\n      columnNames.push(m.get('name'));\n    });\n\n    return columnNames;\n  },\n\n  _renderFields: function () {\n    var self = this;\n\n    var names = this._getSortedColumnNames();\n\n    _(names).each(function (f, i) {\n      var title = self.model.getFieldProperty(f, 'title');\n\n      var view = new FieldView({\n        layerInfowindowModel: self.model,\n        field: { name: f, title: title },\n        position: self.model.getFieldPos(f)\n      });\n\n      self.addView(view);\n      self.$('.js-fields').append(view.render().el);\n    });\n  },\n\n  clean: function () {\n    this._destroySortable();\n    CoreView.prototype.clean.apply(this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"js-description\"></div>\\n<ul class=\"js-fields Infowindow-listFields\"></ul>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar DEBOUNCE_TIME = 350;\n\nmodule.exports = Backbone.Model.extend({\n\n  initialize: function (attrs, opts) {\n    if (!opts.layerInfowindowModel) throw new Error('layerInfowindowModel is required');\n    this._layerInfowindowModel = opts.layerInfowindowModel;\n\n    this._generateSchema();\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this.bind('change', _.debounce(this._onChange.bind(this), DEBOUNCE_TIME), this);\n  },\n\n  _onChange: function () {\n    var self = this;\n\n    _.each(this.changed, function (val, key) {\n      // if the attr doesn't exist in the infowindowModel it will be created, BOOM\n      self._layerInfowindowModel.set(key, val);\n    });\n  },\n\n  _generateSchema: function () {\n    this.schema = {};\n\n    var type = this._layerInfowindowModel.get('template_name');\n\n    if (type !== '' && type !== 'none') {\n      if (this._layerInfowindowModel.has('width')) {\n        this.schema.width = {\n          type: 'Number',\n          title: _t('editor.layers.infowindow.style.window-size'),\n          validators: ['required', {\n            type: 'interval',\n            min: 200,\n            max: 400\n          }]\n        };\n      }\n    }\n\n    if (type === 'infowindow_color') {\n      this.schema.headerColor = {\n        type: 'Fill',\n        title: _t('editor.layers.infowindow.style.header-color'),\n        options: [],\n        dialogMode: 'float',\n        editorAttrs: {\n          color: {\n            hidePanes: ['value']\n          }\n        },\n        validators: ['required']\n      };\n    }\n  }\n\n});\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar template = require('./infowindow-form.tpl');\nvar InfowindowFormModel = require('./infowindow-form-model');\n\nmodule.exports = CoreView.extend({\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template());\n\n    this._generateForms();\n    this._initBinds();\n\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:template_name', this._generateForms, this);\n  },\n\n  _generateForms: function () {\n    if (this._formView) {\n      this._formView.remove();\n    }\n\n    this._formModel = new InfowindowFormModel({\n      width: this.model.get('width'),\n      headerColor: this.model.get('headerColor')\n    }, {\n      layerInfowindowModel: this.model\n    });\n\n    this._formView = new Backbone.Form({\n      model: this._formModel\n    });\n\n    this._formView.bind('change', function () {\n      this.commit();\n    });\n\n    this.$('.js-form').append(this._formView.render().$el);\n  },\n\n  clean: function () {\n    if (this._formView) {\n      this._formView.remove();\n    }\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"js-form\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var InfowindowView = require('./infowindow-view');\n\n/**\n * Select for an Infowindow style type.\n */\nmodule.exports = InfowindowView.extend({\n\n  _initTemplates: function () {\n    this._templates = [\n      {\n        value: '',\n        infowindowIcon: require('./tooltip-icons/tooltip-none.tpl'),\n        label: _t('editor.layers.infowindow.style.none')\n      }, {\n        value: 'tooltip_light',\n        infowindowIcon: require('./tooltip-icons/tooltip-light.tpl'),\n        label: _t('editor.layers.infowindow.style.infowindow_light')\n      }, {\n        value: 'tooltip_dark',\n        infowindowIcon: require('./tooltip-icons/tooltip-dark.tpl'),\n        label: _t('editor.layers.infowindow.style.infowindow_dark')\n      }\n    ];\n  }\n\n});\n",
    "var CoreView = require('backbone/core-view');\nvar CodeMirrorView = require('../../../../components/code-mirror/code-mirror-view');\nvar ErrorTemplate = require('./code-mirror-error.tpl');\n\nmodule.exports = CoreView.extend({\n\n  className: 'Editor-content',\n\n  initialize: function (opts) {\n    if (!opts.codemirrorModel) throw new Error('codemirrorModel is required');\n    if (!opts.onApplyEvent) throw new Error('onApplyEvent');\n\n    this._codemirrorModel = opts.codemirrorModel;\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this._initViews();\n    return this;\n  },\n\n  _initViews: function () {\n    this.codeMirrorView = new CodeMirrorView({\n      model: this._codemirrorModel,\n      tip: _t('editor.infowindow.code-mirror.save'),\n      errorTemplate: ErrorTemplate\n    });\n\n    this.codeMirrorView.bind('codeSaved', this._triggerCodeSaved, this);\n    this.addView(this.codeMirrorView);\n    this.$el.append(this.codeMirrorView.render().el);\n  },\n\n  _triggerCodeSaved: function (code, view) {\n    this.options.onApplyEvent && this.options.onApplyEvent();\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"58px\" height=\"38px\" viewBox=\"608 430 58 38\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n    <g id=\"PopUp\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(608.000000, 431.000000)\">\\n        <path d=\"M1,2.00174332 C1,0.89621101 1.90230818,0 2.99306965,0 L55.0069304,0 C56.1076723,0 57,0.889261723 57,2.00174332 L57,29.9982567 C57,31.103789 56.1032859,32 55.0073354,32 L18.4262695,32 L9,36 L9,32 L2.99810135,32 C1.89458045,32 1,31.1107383 1,29.9982567 L1,2.00174332 L1,2.00174332 Z\" id=\"Rectangle-2087\" stroke=\"#EEEEEE\" fill=\"#FFFFFF\"></path>\\n        <path d=\"M15,4.35207426e-14 L10.3214747,12 L1,12 L1,3.48144531 C1,3.48144531 0.787841764,1.33203125 1.49902344,0.666015625 C2.21020511,4.35207426e-14 3.82543945,4.35207426e-14 3.82543945,4.35207426e-14 L15,4.35207426e-14 Z\" id=\"Rectangle-678\" fill=\"#9AE0AA\"></path>\\n        <polygon id=\"Rectangle-678\" fill=\"#F4F1DE\" points=\"27 0 22.3214747 12 9 12 13.6785253 0\"></polygon>\\n        <polygon id=\"Rectangle-678\" fill=\"#E37E62\" points=\"39 0 34.3214747 12 21 12 25.6785253 0\"></polygon>\\n        <polygon id=\"Rectangle-678\" fill=\"#3D3D5B\" points=\"51 0 46.3214747 12 33 12 37.6785253 0\"></polygon>\\n        <path d=\"M54.2199707,0 C54.2199707,0 56.0734097,0.047231609 56.5109863,0.508300759 C57.0344286,1.05984554 57.1030273,3.0378418 57.1030273,3.0378418 L57.1030273,12 L46,12 L50.6785253,0 L54.2199707,0 Z\" id=\"Rectangle-678\" fill=\"#F2CF8F\"></path>\\n        <rect id=\"Rectangle-678\" fill=\"#FFFFFF\" opacity=\"0.32\" x=\"7\" y=\"4\" width=\"36\" height=\"4\"></rect>\\n        <rect id=\"Rectangle-679\" fill=\"#DDDDDD\" x=\"6\" y=\"17\" width=\"45\" height=\"2\"></rect>\\n        <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"6\" y=\"21\" width=\"26\" height=\"2\"></rect>\\n        <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"6\" y=\"25\" width=\"19\" height=\"2\"></rect>\\n    </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"56px\" height=\"36px\" viewBox=\"512 431 56 36\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n    <g id=\"PopUp\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(512.000000, 431.000000)\">\\n        <path d=\"M0,2.00174332 C0,0.89621101 0.902308181,0 1.99306965,0 L54.0069304,0 C55.1076723,0 56,0.889261723 56,2.00174332 L56,29.9982567 C56,31.103789 55.1032859,32 54.0073354,32 L17.4262695,32 L8,36 L8,32 L1.99810135,32 C0.894580447,32 0,31.1107383 0,29.9982567 L0,2.00174332 L0,2.00174332 Z\" id=\"Rectangle-2087\" fill=\"#2E3C43\"></path>\\n        <rect id=\"Rectangle-679\" fill=\"#636D72\" x=\"5\" y=\"15\" width=\"45\" height=\"2\"></rect>\\n        <rect id=\"Rectangle-680\" fill=\"#636D72\" x=\"5\" y=\"19\" width=\"26\" height=\"2\"></rect>\\n        <rect id=\"Rectangle-680\" fill=\"#636D72\" x=\"5\" y=\"23\" width=\"19\" height=\"2\"></rect>\\n        <rect id=\"Rectangle-680\" fill=\"#636D72\" x=\"5\" y=\"11\" width=\"26\" height=\"2\"></rect>\\n        <rect id=\"Rectangle-680\" fill=\"#636D72\" x=\"5\" y=\"7\" width=\"36\" height=\"2\"></rect>\\n    </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"58px\" height=\"38px\" viewBox=\"688 430 58 38\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n    <g id=\"IMG\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(689.000000, 431.000000)\">\\n        <path d=\"M0,2.00174332 C0,0.89621101 0.902308181,0 1.99306965,0 L54.0069304,0 C55.1076723,0 56,0.889261723 56,2.00174332 L56,29.9982567 C56,31.103789 55.1032859,32 54.0073354,32 L17.4262695,32 L8,36 L8,32 L1.99810135,32 C0.894580447,32 0,31.1107383 0,29.9982567 L0,2.00174332 L0,2.00174332 Z\" id=\"Rectangle-2087\" stroke=\"#EEEEEE\" fill=\"#FFFFFF\"></path>\\n        <path d=\"M54.0069304,0 C55.1076723,0 56,0.901950359 56,2.0085302 L56,12 L0,12 L0,2.0085302 C0,0.899249601 0.902308181,0 1.99306965,0 L54.0069304,0 Z\" id=\"Rectangle-678\" fill=\"#CBCED0\"></path>\\n        <rect id=\"Rectangle-678\" fill=\"#FFFFFF\" opacity=\"0.32\" x=\"6\" y=\"4\" width=\"28\" height=\"4\"></rect>\\n        <rect id=\"Rectangle-679\" fill=\"#DDDDDD\" x=\"5\" y=\"17\" width=\"45\" height=\"2\"></rect>\\n        <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"5\" y=\"21\" width=\"26\" height=\"2\"></rect>\\n        <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"5\" y=\"25\" width=\"19\" height=\"2\"></rect>\\n        <path d=\"M43.6,6 L46,8 L49.6,2 L52,10 L40,10 L43.6,6 Z M41,4 C41.5522847,4 42,3.55228475 42,3 C42,2.44771525 41.5522847,2 41,2 C40.4477153,2 40,2.44771525 40,3 C40,3.55228475 40.4477153,4 41,4 Z\" id=\"Rectangle-5896\" fill=\"#FFFFFF\"></path>\\n    </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"58px\" height=\"38px\" viewBox=\"429 431 58 38\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n    <g id=\"PopUp-Copy\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(430.000000, 432.000000)\">\\n        <path d=\"M0,2.00174332 C0,0.89621101 0.902308181,0 1.99306965,0 L54.0069304,0 C55.1076723,0 56,0.889261723 56,2.00174332 L56,29.9982567 C56,31.103789 55.1032859,32 54.0073354,32 L17.4262695,32 L8,36 L8,32 L1.99810135,32 C0.894580447,32 0,31.1107383 0,29.9982567 L0,2.00174332 L0,2.00174332 Z\" id=\"Rectangle-2087\" stroke=\"#EEEEEE\" fill=\"#FFFFFF\"></path>\\n        <rect id=\"Rectangle-679\" fill=\"#DDDDDD\" x=\"4\" y=\"14\" width=\"45\" height=\"2\"></rect>\\n        <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"4\" y=\"18\" width=\"26\" height=\"2\"></rect>\\n        <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"4\" y=\"22\" width=\"19\" height=\"2\"></rect>\\n        <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"4\" y=\"10\" width=\"26\" height=\"2\"></rect>\\n        <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"4\" y=\"6\" width=\"36\" height=\"2\"></rect>\\n    </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text CDB-Size-small u-altTextColor u-upperCase\">None</p>';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./infowindow-items.tpl');\nvar InfowindowFieldsView = require('./infowindow-fields-view');\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    if (!opts.querySchemaModel) throw new Error('querySchemaModel is required');\n    if (!opts.layerDefinitionModel) throw new Error('layerDefinitionModel is required');\n    if (typeof opts.hasValidTemplate === 'undefined') throw new Error('hasValidTemplate has to be defined');\n    this._querySchemaModel = opts.querySchemaModel;\n    this._layerDefinitionModel = opts.layerDefinitionModel;\n    this._hasValidTemplate = opts.hasValidTemplate;\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n\n    if (this._hasValidTemplate) {\n      this._initViews();\n    }\n\n    return this;\n  },\n\n  _initViews: function () {\n    this.$el.html(template({\n      title: _t('editor.layers.infowindow.items.title-label')\n    }));\n\n    if (this._infowindowFieldsView) {\n      this.removeView(this._infowindowFieldsView);\n      this._infowindowFieldsView.clean();\n    }\n\n    this._infowindowFieldsView = new InfowindowFieldsView({\n      model: this.model,\n      querySchemaModel: this._querySchemaModel,\n      layerDefinitionModel: this._layerDefinitionModel\n    });\n\n    this.$('.js-content').append(this._infowindowFieldsView.render().$el);\n    this.addView(this._infowindowFieldsView);\n\n    return this;\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-HeaderInfo\">\\n  <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">2</div>\\n\\n  <div class=\"Editor-HeaderInfo-Inner CDB-Text\">\\n    <div class=\"Editor-HeaderInfo-Title u-bSpace--m\">\\n      <h2 class=\"Editor-HeaderInfo-TitleText CDB-Text CDB-Size-large\">'+\n((__t=( _t('editor.layers.infowindow.items.title-label') ))==null?'':_.escape(__t))+\n'</h2>\\n    </div>\\n\\n    <div class=\"js-content\"></div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./infowindow-select.tpl');\nvar CarouselFormView = require('../../../../components/carousel-form-view');\nvar InfowindowFormView = require('./infowindow-form-view');\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    if (!opts.templatesCollection) throw new Error('templatesCollection is required');\n    this._templatesCollection = opts.templatesCollection;\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    this.$el.html(template());\n\n    this._renderCarousel();\n    this._renderForm();\n\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:headerColor', this._onColorChange, this);\n  },\n\n  _onColorChange: function () {\n    this._setTemplate(this.model.get('template_name'));\n  },\n\n  _checkValidTemplate: function () {\n    var template = this._templatesCollection.find(function (mdl) {\n      return this.model.get('template_name') === mdl.get('val');\n    }, this);\n\n    return template && template.get('val') !== '';\n  },\n\n  _setNoneTemplate: function () {\n    var noneTemplate = this._templatesCollection.find(function (mdl) {\n      return mdl.get('val') === '';\n    }, this);\n\n    noneTemplate.set('selected', true);\n  },\n\n  _setTemplate: function (template_name) {\n    this.model.setTemplate(template_name);\n  },\n\n  _renderCarousel: function () {\n    if (!this._checkValidTemplate()) {\n      this._setNoneTemplate();\n    }\n\n    this._templatesCollection.bind('change:selected', function (mdl) {\n      if (mdl.get('selected')) {\n        var value = mdl.getValue();\n        this._setTemplate(value);\n      }\n    }, this);\n    this.add_related_model(this._templatesCollection);\n\n    var view = new CarouselFormView({\n      collection: this._templatesCollection,\n      template: require('./infowindow-carousel.tpl')\n    });\n    this.addView(view);\n    this.$('.js-select').append(view.render().el);\n  },\n\n  _renderForm: function () {\n    if (this._infowindowFormView) {\n      this.removeView(this._infowindowFormView);\n      this._infowindowFormView.clean();\n    }\n\n    this._infowindowFormView = new InfowindowFormView({\n      model: this.model\n    });\n    this.addView(this._infowindowFormView);\n    this.$('.js-select').append(this._infowindowFormView.render().el);\n  }\n\n});\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar PanelWithOptionsView = require('../../../../components/view-options/panel-with-options-view');\nvar InfoWindowHTMLView = require('./infowindow-html-view');\nvar InfowindowContentView = require('./infowindow-content-view');\nvar ScrollView = require('../../../../components/scroll/scroll-view');\nvar TabPaneView = require('../../../../components/tab-pane/tab-pane-view');\nvar TabPaneCollection = require('../../../../components/tab-pane/tab-pane-collection');\nvar Toggler = require('../../../../components/toggler/toggler-view');\nvar ApplyView = require('./infowindow-apply-button-view');\nvar Infobox = require('../../../../components/infobox/infobox-factory');\nvar InfoboxModel = require('../../../../components/infobox/infobox-model');\nvar InfoboxCollection = require('../../../../components/infobox/infobox-collection');\n\nvar cdb = require('cartodb.js');\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    if (!opts.layerDefinitionModel) throw new Error('layerDefinitionModel is required');\n    if (!opts.userActions) throw new Error('userActions is required');\n    if (!opts.editorModel) throw new Error('editorModel is required');\n\n    this._layerDefinitionModel = opts.layerDefinitionModel;\n    this._userActions = opts.userActions;\n    this._editorModel = opts.editorModel;\n\n    this._initModels();\n    this._initBinds();\n    this._configPanes();\n    this._initTemplates();\n  },\n\n  _initModels: function () {\n    var content;\n    if (this.model.isCustomTemplate()) {\n      content = this.model.get('template');\n    } else {\n      content = this._getTemplateContent();\n    }\n\n    this._codemirrorModel = new Backbone.Model({\n      content: content\n    });\n\n    this._infoboxModel = new InfoboxModel({\n      state: this._isLayerHidden() ? 'layer-hidden' : ''\n    });\n\n    this._overlayModel = new Backbone.Model({\n      visible: this._isLayerHidden()\n    });\n\n    // Set edition attribute in case custom html is applied and\n    // in case none template is applied\n    this._editorModel.set({\n      edition: this.model.isCustomTemplate(),\n      disabled: !this.model.hasTemplate() && !this.model.isCustomTemplate()\n    });\n  },\n\n  _setContent: function () {\n    if (this._editorModel.get('edition')) {\n      return;\n    }\n\n    var html_value = this._getTemplateContent();\n    this._codemirrorModel.set({\n      content: html_value\n    });\n  },\n\n  _initBinds: function () {\n    this.model.bind('change', this._onChange.bind(this), this.model);\n\n    this.listenTo(this._editorModel, 'change:edition', this._onChangeEdition);\n    this.add_related_model(this._editorModel);\n\n    this.listenTo(this._layerDefinitionModel, 'change:visible', this._infoboxState);\n    this.add_related_model(this._layerDefinitionModel);\n  },\n\n  _saveInfowindowHTML: function () {\n    var content = this._codemirrorModel.get('content');\n    // Parse\n    var errors = this._getErrors(content);\n\n    if (errors.length === 0) {\n      this._clearErrors();\n\n      // Save old fields\n      if (!this.model.get('old_fields')) {\n        this.model.saveFields();\n      }\n\n      // Save old template name\n      if (!this.model.get('old_template_name')) {\n        this.model.set('old_template_name', this.model.get('template_name'));\n      }\n\n      // new custom template\n      this.model.set({\n        template: content,\n        template_name: ''\n      });\n\n      this._userActions.saveLayer(this._layerDefinitionModel);\n    } else {\n      this._parseErrors(errors);\n    }\n  },\n\n  _getErrors: function (content) {\n    try {\n      var template = new cdb.core.Template({\n        template: content,\n        type: 'mustache'\n      });\n      template.compile()();\n      if (content === '') {\n        return [{\n          line: 1,\n          message: _t('editor.infowindow.code-mirror.errors.empty')\n        }];\n      } else {\n        return [];\n      }\n    } catch (e) {\n      return e;\n    }\n  },\n\n  _showErrors: function (model) {\n    var errors = this._querySchemaModel.get('query_errors');\n    this._codemirrorModel.set('errors', this._parseErrors(errors));\n  },\n\n  _parseErrors: function (errors) {\n    return errors.map(function (error) {\n      return {\n        line: error.line,\n        message: error.message.split('\\n\\n')[1]\n      };\n    });\n  },\n\n  _clearErrors: function () {\n    this._codemirrorModel.set({errors: []});\n  },\n\n  _getTemplateContent: function () {\n    var fields = [];\n    var alternative_names = this.model.get('alternative_names');\n\n    _.each(this.model.get('fields'), function (field, i) {\n      var f = _.clone(field);\n      f.position = i;\n      if (alternative_names && alternative_names[f.name]) {\n        f.alternative_name = alternative_names[f.name];\n      }\n      fields.push(f);\n    });\n\n    var tmpl = new cdb.core.Template({\n      template: this.model.getTemplate(),\n      type: 'mustache'\n    });\n\n    return tmpl.render({content: { fields: fields }});\n  },\n\n  _configPanes: function () {\n    var self = this;\n\n    var tabPaneTabs = [{\n      selected: !self.model.isCustomTemplate(),\n      createContentView: function () {\n        return new ScrollView({\n          createContentView: function () {\n            return new InfowindowContentView(_.extend(self.options, {\n              templates: self._templates,\n              overlayModel: self._overlayModel\n            }));\n          }\n        });\n      },\n      createActionView: function () {\n        return new CoreView();\n      }\n    }, {\n      selected: self.model.isCustomTemplate(),\n      createContentView: function () {\n        return new InfoWindowHTMLView({\n          onApplyEvent: self._saveInfowindowHTML.bind(self),\n          codemirrorModel: self._codemirrorModel\n        });\n      },\n      createActionView: function () {\n        return new ApplyView({\n          onApplyClick: self._saveInfowindowHTML.bind(self)\n        });\n      }\n    }];\n\n    this._collectionPane = new TabPaneCollection(tabPaneTabs);\n  },\n\n  _onChange: function () {\n    this._userActions.saveLayer(this._layerDefinitionModel);\n    this._setContent();\n  },\n\n  _onChangeEdition: function () {\n    this._infoboxState();\n\n    var edition = this._editorModel.get('edition');\n    var index = edition ? 1 : 0;\n    this._collectionPane.at(index).set({ selected: true });\n  },\n\n  _cancelHTML: function () {\n    this.model.setDefault();\n    this._infoboxModel.set({state: ''});\n    this._overlayModel.set({visible: false});\n  },\n\n  _isLayerHidden: function () {\n    return this._layerDefinitionModel.get('visible') === false;\n  },\n\n  _infoboxState: function () {\n    var edition = this._editorModel.get('edition');\n    var html_custom = this.model.isCustomTemplate();\n\n    if (!edition && html_custom) {\n      this._infoboxModel.set({state: 'confirm'});\n      this._overlayModel.set({visible: true});\n    } else if (!edition && this._isLayerHidden()) {\n      this._infoboxModel.set({state: 'layer-hidden'});\n      this._overlayModel.set({visible: true});\n    } else {\n      this._infoboxModel.set({state: ''});\n      this._overlayModel.set({visible: false});\n    }\n  },\n\n  _showHiddenLayer: function () {\n    var savingOptions = {\n      shouldPreserveAutoStyle: true\n    };\n    this._layerDefinitionModel.toggleVisible();\n    this._userActions.saveLayer(this._layerDefinitionModel, savingOptions);\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    var self = this;\n\n    var infoboxSstates = [\n      {\n        state: 'confirm',\n        createContentView: function () {\n          return Infobox.createWithAction({\n            type: 'alert',\n            title: _t('editor.infowindow.messages.custom-html-applied.title'),\n            body: _t('editor.infowindow.messages.custom-html-applied.body'),\n            mainAction: {\n              label: _t('editor.infowindow.messages.custom-html-applied.accept')\n            }\n          });\n        },\n        mainAction: self._cancelHTML.bind(self)\n      }, {\n        state: 'layer-hidden',\n        createContentView: function () {\n          return Infobox.createWithAction({\n            type: 'alert',\n            title: _t('editor.infowindow.messages.layer-hidden.title'),\n            body: _t('editor.infowindow.messages.layer-hidden.body'),\n            mainAction: {\n              label: _t('editor.infowindow.messages.layer-hidden.show')\n            }\n          });\n        },\n        mainAction: self._showHiddenLayer.bind(self)\n      }\n    ];\n\n    var infoboxCollection = new InfoboxCollection(infoboxSstates);\n\n    var panelWithOptionsView = new PanelWithOptionsView({\n      className: 'Editor-content',\n      editorModel: self._editorModel,\n      infoboxModel: self._infoboxModel,\n      infoboxCollection: infoboxCollection,\n      createContentView: function () {\n        return new TabPaneView({\n          collection: self._collectionPane\n        });\n      },\n      createControlView: function () {\n        return new Toggler({\n          editorModel: self._editorModel,\n          labels: [_t('editor.infowindow.html-toggle.values'), _t('editor.infowindow.html-toggle.html')],\n          isDisableable: true\n        });\n      },\n      createActionView: function () {\n        return new TabPaneView({\n          collection: self._collectionPane,\n          createContentKey: 'createActionView'\n        });\n      }\n    });\n\n    this.$el.append(panelWithOptionsView.render().el);\n    this.addView(panelWithOptionsView);\n\n    return this;\n  },\n\n  clean: function () {\n    this.model.unbind('change', null, this.model);\n    CoreView.prototype.clean.apply(this);\n  }\n\n});\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar InfowindowView = require('./infowindow-click-view');\nvar TooltipView = require('./infowindow-hover-view');\nvar createTextLabelsTabPane = require('../../../../components/tab-pane/create-text-labels-tab-pane');\nvar TabPaneTemplate = require('../../../tab-pane-submenu.tpl');\nvar popupPlaceholderTemplate = require('./popups-placeholder.tpl');\nvar georeferencePlaceholderTemplate = require('./georeference-placeholder.tpl');\nvar loadingTemplate = require('../../panel-loading-template.tpl');\nvar checkAndBuildOpts = require('../../../../helpers/required-opts');\nvar Infobox = require('../../../../components/infobox/infobox-factory');\nvar InfoboxModel = require('../../../../components/infobox/infobox-model');\nvar InfoboxCollection = require('../../../../components/infobox/infobox-collection');\nvar PanelWithOptionsView = require('../../../../components/view-options/panel-with-options-view');\nvar ViewFactory = require('../../../../components/view-factory');\nvar panelTemplate = require('./panel-with-options.tpl');\nvar OverlayView = require('../../../components/overlay/overlay-view');\nvar fetchAllQueryObjectsIfNecessary = require('../../../../helpers/fetch-all-query-objects');\n\nvar REQUIRED_OPTS = [\n  'configModel',\n  'userActions',\n  'layerDefinitionModel',\n  'queryGeometryModel',\n  'querySchemaModel',\n  'queryRowsCollection',\n  'editorModel'\n];\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n    this.render = this.render.bind(this);\n\n    this._layerInfowindowModel = this._layerDefinitionModel.infowindowModel;\n    this._layerTooltipModel = this._layerDefinitionModel.tooltipModel;\n\n    this._initModels();\n    this._initBinds();\n\n    this._fetchAllQueryObjectsIfNecessary();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n\n    if (this._queryGeometryModel.isFetching()) {\n      this._renderLoading();\n    } else if (this._layerInfowindowModel && this._hasColumns() && this._canAddInfowindow() && this._queryGeometryModel.hasValue()) {\n      this._initViews();\n      this._bindEvents();\n    } else {\n      this._renderPlaceholder();\n    }\n\n    this._renderOverlay();\n    return this;\n  },\n\n  _renderOverlay: function () {\n    var view = new OverlayView({\n      overlayModel: this._overlayModel\n    });\n    this.addView(view);\n    this.$('.js-content').append(view.render().el);\n  },\n\n  _initModels: function () {\n    this._infoboxModel = new InfoboxModel({\n      state: this._isLayerHidden() ? 'layer-hidden' : ''\n    });\n\n    this._overlayModel = new Backbone.Model({\n      visible: this._isLayerHidden()\n    });\n\n    this._editorModel.set({\n      edition: false\n    });\n  },\n\n  _isLayerHidden: function () {\n    return this._layerDefinitionModel.get('visible') === false;\n  },\n\n  _initBinds: function () {\n    this.listenTo(this._querySchemaModel, 'change:status', this._onStatusChanged);\n    this.listenTo(this._queryGeometryModel, 'change:status', this._onStatusChanged);\n    this.listenTo(this._queryRowsCollection.statusModel, 'change:status', this._onStatusChanged);\n    this.listenTo(this._editorModel, 'change:edition', this._changeStyle);\n  },\n\n  _fetchAllQueryObjectsIfNecessary: function () {\n    fetchAllQueryObjectsIfNecessary({\n      queryRowsCollection: this._queryRowsCollection,\n      queryGeometryModel: this._queryGeometryModel,\n      querySchemaModel: this._querySchemaModel\n    });\n  },\n\n  _onStatusChanged: function () {\n    fetchAllQueryObjectsIfNecessary({\n      queryRowsCollection: this._queryRowsCollection,\n      queryGeometryModel: this._queryGeometryModel,\n      querySchemaModel: this._querySchemaModel\n    }, this.render);\n  },\n\n  _hasColumns: function () {\n    if (!this._querySchemaModel.isFetched()) return false;\n\n    var columns = this._querySchemaModel.columnsCollection.models;\n\n    var filteredColumns = _(columns).filter(function (c) {\n      return !_.contains(this._layerInfowindowModel.SYSTEM_COLUMNS, c.get('name'));\n    }, this);\n\n    return filteredColumns.length;\n  },\n\n  _canAddInfowindow: function () {\n    var styleModel = this._layerDefinitionModel.styleModel;\n    return styleModel && !styleModel.isAggregatedType() && !styleModel.isAnimation();\n  },\n\n  _renderPlaceholder: function () {\n    if (this._layerInfowindowModel && !this._hasColumns()) {\n      this.$el.append(popupPlaceholderTemplate({\n        placeholder: _t('editor.layers.infowindow.placeholder-columns-text')\n      }));\n    } else if (!this._queryGeometryModel.hasValue()) {\n      if (this._layerDefinitionModel.canBeGeoreferenced()) {\n        this._renderGeoreferencePlaceholder();\n      } else {\n        this.$el.append(popupPlaceholderTemplate({\n          placeholder: _t('editor.layers.infowindow.placeholder-geometry')\n        }));\n      }\n    } else {\n      this.$el.append(popupPlaceholderTemplate({\n        placeholder: _t('editor.layers.infowindow.placeholder-interactivity-text')\n      }));\n    }\n  },\n\n  _renderGeoreferencePlaceholder: function () {\n    var self = this;\n\n    var infoboxSstates = [\n      {\n        state: 'layer-hidden',\n        createContentView: function () {\n          return Infobox.createWithAction({\n            type: 'alert',\n            title: _t('editor.infowindow.messages.layer-hidden.title'),\n            body: _t('editor.infowindow.messages.layer-hidden.body'),\n            mainAction: {\n              label: _t('editor.infowindow.messages.layer-hidden.show')\n            }\n          });\n        },\n        mainAction: self._showHiddenLayer.bind(self)\n      }\n    ];\n\n    var infoboxCollection = new InfoboxCollection(infoboxSstates);\n\n    var panelWithOptionsView = new PanelWithOptionsView({\n      template: panelTemplate,\n      className: 'Editor-content',\n      editorModel: self._editorModel,\n      infoboxModel: self._infoboxModel,\n      infoboxCollection: infoboxCollection,\n      createContentView: function () {\n        return ViewFactory.createByHTML(georeferencePlaceholderTemplate());\n      }\n    });\n\n    this.$el.append(panelWithOptionsView.render().el);\n    this.addView(panelWithOptionsView);\n  },\n\n  _renderLoading: function () {\n    this.$el.append(loadingTemplate());\n  },\n\n  _initViews: function () {\n    var self = this;\n\n    var clickTemplate = _t('editor.layers.infowindow.style.none');\n    var hoverTemplate = _t('editor.layers.tooltip.style.none');\n\n    if (this._layerInfowindowModel.isCustomTemplate()) {\n      clickTemplate = _t('editor.layers.infowindow.style.custom');\n    } else if (this._layerInfowindowModel.hasTemplate()) {\n      clickTemplate = _t('editor.layers.infowindow.style.' + this._layerInfowindowModel.get('template_name'));\n    }\n\n    if (this._layerTooltipModel.isCustomTemplate()) {\n      hoverTemplate = _t('editor.layers.tooltip.style.custom');\n    } else if (this._layerTooltipModel.hasTemplate()) {\n      hoverTemplate = _t('editor.layers.tooltip.style.' + this._layerTooltipModel.get('template_name'));\n    }\n\n    var tabPaneTabs = [{\n      name: 'click',\n      label: _t('editor.layers.infowindow-menu-tab-pane-labels.click'),\n      createContentView: function () {\n        return new InfowindowView({\n          model: self._layerInfowindowModel,\n          className: 'Editor-content',\n          querySchemaModel: self._querySchemaModel,\n          userActions: self._userActions,\n          editorModel: self._editorModel,\n          layerDefinitionModel: self._layerDefinitionModel\n        });\n      },\n      selectedChild: clickTemplate\n    }, {\n      name: 'hover',\n      label: _t('editor.layers.infowindow-menu-tab-pane-labels.hover'),\n      createContentView: function () {\n        return new TooltipView({\n          className: 'Editor-content',\n          querySchemaModel: self._querySchemaModel,\n          userActions: self._userActions,\n          editorModel: self._editorModel,\n          model: self._layerTooltipModel,\n          layerDefinitionModel: self._layerDefinitionModel\n        });\n      },\n      selectedChild: hoverTemplate\n    }];\n\n    var tabPaneOptions = {\n      tabPaneOptions: {\n        template: TabPaneTemplate,\n        tabPaneItemOptions: {\n          tagName: 'li',\n          className: 'CDB-NavSubmenu-item'\n        }\n      },\n      tabPaneItemLabelOptions: {\n        tagName: 'button',\n        className: 'CDB-NavSubmenu-link u-upperCase'\n      }\n    };\n\n    this._layerTabPaneView = createTextLabelsTabPane(tabPaneTabs, tabPaneOptions);\n    this.$el.append(this._layerTabPaneView.render().$el);\n    this.addView(this._layerTabPaneView);\n  },\n\n  _changeStyle: function (m) {\n    this._layerTabPaneView && this._layerTabPaneView.changeStyleMenu(m);\n  },\n\n  _updateSelectedChild: function () {\n    var selectedChild;\n    var selectedChildTxt;\n\n    switch (this._layerTabPaneView.getSelectedTabPaneName()) {\n      case 'click':\n        selectedChild = this._layerInfowindowModel.get('template_name');\n        selectedChildTxt = _t('editor.layers.infowindow.style.none');\n\n        if (this._layerInfowindowModel.isCustomTemplate()) {\n          selectedChildTxt = _t('editor.layers.infowindow.style.custom');\n        } else if (this._layerInfowindowModel.hasTemplate()) {\n          selectedChildTxt = _t('editor.layers.infowindow.style.' + selectedChild);\n        }\n\n        break;\n      case 'hover':\n        selectedChild = this._layerTooltipModel.get('template_name');\n        selectedChildTxt = _t('editor.layers.tooltip.style.none');\n\n        if (this._layerTooltipModel.isCustomTemplate()) {\n          selectedChildTxt = _t('editor.layers.tooltip.style.custom');\n        } else if (this._layerTooltipModel.hasTemplate()) {\n          selectedChildTxt = _t('editor.layers.tooltip.style.' + selectedChild);\n        }\n\n        break;\n    }\n\n    this._layerTabPaneView.$('.js-menu .CDB-NavSubmenu-item.is-selected .js-NavSubmenu-status').html(selectedChildTxt);\n    this._layerTabPaneView.$('.js-list .Carousel-item').removeClass('is-selected');\n    this._layerTabPaneView.$('.js-list .Carousel-item.js-' + selectedChild).addClass('is-selected');\n  },\n\n  _bindEvents: function () {\n    this._layerInfowindowModel.on('change:template', this._onChangeTemplate, this);\n    this.add_related_model(this._layerInfowindowModel);\n    this._layerTooltipModel.on('change:template', this._onChangeTemplate, this);\n    this.add_related_model(this._layerTooltipModel);\n  },\n\n  _onChangeTemplate: function () {\n    this._updateSelectedChild();\n  },\n\n  _showHiddenLayer: function () {\n    var savingOptions = {\n      shouldPreserveAutoStyle: true\n    };\n    this._layerDefinitionModel.toggleVisible();\n    this._userActions.saveLayer(this._layerDefinitionModel, savingOptions);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<h2 class=\"CDB-Text CDB-Size-huge is-light u-secondaryTextColor\">'+\n((__t=( placeholder ))==null?'':_.escape(__t))+\n'</h2>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"58px\" height=\"32px\" viewBox=\"494 496 58 32\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n    <g id=\"PopUp-Copy-3\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(494.000000, 496.000000)\">\\n        <path d=\"M2.99306965,0 L55.0069304,0 C56.1076723,0 57,0.889261723 57,2.00174332 L57,29.9982567 C57,31.103789 56.1032859,32 55.0073354,32 L18.4262695,32 L9,32 L0.998101354,32 L1,2.00174332 C1,0.89621101 1.90230818,0 2.99306965,0 Z\" id=\"Rectangle-2087\" fill=\"#2E3C43\"></path>\\n        <rect id=\"Rectangle-679\" fill=\"#636D72\" x=\"6\" y=\"15\" width=\"45\" height=\"2\"></rect>\\n        <rect id=\"Rectangle-680\" fill=\"#636D72\" x=\"6\" y=\"19\" width=\"26\" height=\"2\"></rect>\\n        <rect id=\"Rectangle-680\" fill=\"#636D72\" x=\"6\" y=\"23\" width=\"19\" height=\"2\"></rect>\\n        <rect id=\"Rectangle-680\" fill=\"#636D72\" x=\"6\" y=\"11\" width=\"26\" height=\"2\"></rect>\\n        <rect id=\"Rectangle-680\" fill=\"#636D72\" x=\"6\" y=\"7\" width=\"36\" height=\"2\"></rect>\\n    </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"58px\" height=\"34px\" viewBox=\"429 496 58 34\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n    <g id=\"PopUp-Copy-2\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(429.000000, 497.000000)\">\\n        <path d=\"M2.99306965,0 L55.0069304,0 C56.1076723,0 57,0.889261723 57,2.00174332 L57,29.9982567 C57,31.103789 56.1032859,32 55.0073354,32 L18.4262695,32 L9,32 L0.998101354,32 L1,2.00174332 C1,0.89621101 1.90230818,0 2.99306965,0 Z\" id=\"Rectangle-2087\" stroke=\"#EEEEEE\" fill=\"#FFFFFF\"></path>\\n        <rect id=\"Rectangle-679\" fill=\"#DDDDDD\" x=\"5\" y=\"14\" width=\"45\" height=\"2\"></rect>\\n        <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"5\" y=\"18\" width=\"26\" height=\"2\"></rect>\\n        <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"5\" y=\"22\" width=\"19\" height=\"2\"></rect>\\n        <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"5\" y=\"10\" width=\"26\" height=\"2\"></rect>\\n        <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"5\" y=\"6\" width=\"36\" height=\"2\"></rect>\\n    </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./apply-button.tpl');\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-apply': '_onApplyClick'\n  },\n\n  initialize: function (opts) {\n    if (!opts.onApplyClick) throw new Error('onApplyClick is required');\n  },\n\n  render: function () {\n    this.$el.html(template());\n    return this;\n  },\n\n  _onApplyClick: function () {\n    this.options.onApplyClick();\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"42px\" height=\"18px\" viewBox=\"7 7 42 18\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n    <g id=\"Group\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(7.000000, 7.000000)\">\\n        <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"0\" y=\"0\" width=\"11\" height=\"2\"></rect>\\n        <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"0\" y=\"4\" width=\"9\" height=\"2\"></rect>\\n        <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"0\" y=\"8\" width=\"16\" height=\"2\"></rect>\\n        <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"0\" y=\"12\" width=\"13\" height=\"2\"></rect>\\n        <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"0\" y=\"16\" width=\"16\" height=\"2\"></rect>\\n        <ellipse id=\"Oval-1585\" fill-opacity=\"0.2\" fill=\"#9DE0AD\" cx=\"33\" cy=\"9\" rx=\"9\" ry=\"9\"></ellipse>\\n        <ellipse id=\"Oval-1585\" fill-opacity=\"0.4\" fill=\"#9DE0AD\" cx=\"33\" cy=\"11\" rx=\"7\" ry=\"7\"></ellipse>\\n        <ellipse id=\"Oval-1585\" fill-opacity=\"0.5\" fill=\"#9DE0AD\" cx=\"33\" cy=\"13\" rx=\"5\" ry=\"5\"></ellipse>\\n        <ellipse id=\"Oval-1585\" fill-opacity=\"0.8\" fill=\"#9DE0AD\" cx=\"33\" cy=\"15\" rx=\"3\" ry=\"3\"></ellipse>\\n        <ellipse id=\"Oval-1585\" fill=\"#9DE0AD\" cx=\"33\" cy=\"17\" rx=\"1\" ry=\"1\"></ellipse>\\n    </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"56px\" height=\"32px\" viewBox=\"529 429 56 32\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n  <defs>\\n    <rect id=\"path-1\" x=\"0\" y=\"0\" width=\"56\" height=\"32\" rx=\"2\"></rect>\\n    <mask id=\"mask-2\" maskContentUnits=\"userSpaceOnUse\" maskUnits=\"objectBoundingBox\" x=\"0\" y=\"0\" width=\"56\" height=\"32\" fill=\"white\">\\n        <use xlink:href=\"#path-1\"></use>\\n    </mask>\\n  </defs>\\n  <g id=\"category\" transform=\"translate(529.000000, 429.000000)\">\\n    <use id=\"Rectangle-2\" stroke=\"#EEEEEE\" mask=\"url(#mask-2)\" stroke-width=\"2\" fill=\"#FFFFFF\" xlink:href=\"#path-1\"></use>\\n    <rect id=\"Rectangle-679\" fill=\"#DDDDDD\" x=\"7\" y=\"15\" width=\"23\" height=\"2\"></rect>\\n    <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"7\" y=\"19\" width=\"13\" height=\"2\"></rect>\\n    <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"7\" y=\"23\" width=\"10\" height=\"2\"></rect>\\n    <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"7\" y=\"11\" width=\"13\" height=\"2\"></rect>\\n    <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"7\" y=\"7\" width=\"19\" height=\"2\"></rect>\\n    <rect id=\"Rectangle-680\" fill=\"#9CE0AC\" x=\"45\" y=\"7\" width=\"3\" height=\"2\"></rect>\\n    <rect id=\"Rectangle-680\" fill=\"#F4F1DE\" x=\"45\" y=\"11\" width=\"3\" height=\"2\"></rect>\\n    <rect id=\"Rectangle-680\" fill=\"#E17C60\" x=\"45\" y=\"15\" width=\"3\" height=\"2\"></rect>\\n    <rect id=\"Rectangle-680\" fill=\"#3D3F5B\" x=\"45\" y=\"19\" width=\"3\" height=\"2\"></rect>\\n    <rect id=\"Rectangle-680\" fill=\"#F2CD8F\" x=\"45\" y=\"23\" width=\"3\" height=\"2\"></rect>\\n  </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"56px\" height=\"32px\" viewBox=\"529 429 56 32\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n  <defs>\\n    <rect id=\"path-1\" x=\"0\" y=\"0\" width=\"56\" height=\"32\" rx=\"2\"></rect>\\n    <mask id=\"mask-2\" maskContentUnits=\"userSpaceOnUse\" maskUnits=\"objectBoundingBox\" x=\"0\" y=\"0\" width=\"56\" height=\"32\" fill=\"white\">\\n        <use xlink:href=\"#path-1\"></use>\\n    </mask>\\n  </defs>\\n  <g id=\"category\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(529.000000, 429.000000)\">\\n    <use id=\"Rectangle-2\" stroke=\"#EEEEEE\" mask=\"url(#mask-2)\" stroke-width=\"2\" fill=\"#FFFFFF\" xlink:href=\"#path-1\"></use>\\n    <rect id=\"Rectangle-679\" fill=\"#DDDDDD\" x=\"14\" y=\"15\" width=\"23\" height=\"2\"></rect>\\n    <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"14\" y=\"19\" width=\"13\" height=\"2\"></rect>\\n    <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"14\" y=\"23\" width=\"10\" height=\"2\"></rect>\\n    <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"14\" y=\"11\" width=\"13\" height=\"2\"></rect>\\n    <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"14\" y=\"7\" width=\"19\" height=\"2\"></rect>\\n    <rect id=\"Rectangle-680\" fill=\"#9CE0AC\" x=\"7\" y=\"7\" width=\"3\" height=\"2\"></rect>\\n    <rect id=\"Rectangle-680\" fill=\"#F4F1DE\" x=\"7\" y=\"11\" width=\"3\" height=\"2\"></rect>\\n    <rect id=\"Rectangle-680\" fill=\"#E17C60\" x=\"7\" y=\"15\" width=\"3\" height=\"2\"></rect>\\n    <rect id=\"Rectangle-680\" fill=\"#3D3F5B\" x=\"7\" y=\"19\" width=\"3\" height=\"2\"></rect>\\n    <rect id=\"Rectangle-680\" fill=\"#F2CD8F\" x=\"7\" y=\"23\" width=\"3\" height=\"2\"></rect>\\n  </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"54px\" height=\"24px\" viewBox=\"519 458 54 24\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n  <defs>\\n    <linearGradient x1=\"90.736547%\" y1=\"49.7500002%\" x2=\"9.63471511%\" y2=\"49.7500002%\" id=\"linearGradient-1\">\\n      <stop stop-color=\"#C11F22\" offset=\"0%\"></stop>\\n      <stop stop-color=\"#F53F15\" offset=\"23.9588524%\"></stop>\\n      <stop stop-color=\"#FF9030\" offset=\"49.5142003%\"></stop>\\n      <stop stop-color=\"#FFCF52\" offset=\"75.4982561%\"></stop>\\n      <stop stop-color=\"#FFFEAE\" offset=\"100%\"></stop>\\n    </linearGradient>\\n  </defs>\\n  <g id=\"color\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(519.000000, 458.000000)\">\\n    <rect id=\"bg\" fill=\"#FFFFFF\" x=\"0\" y=\"0\" width=\"54\" height=\"23\" rx=\"2\"></rect>\\n    <path d=\"M1,20.9991358 C1,21.5484057 1.45096651,22 2.00209026,22 L51.9979097,22 C52.5538814,22 53,21.5535154 53,20.9991358 L53,2.00086422 C53,1.45159429 52.5490335,1 51.9979097,1 L2.00209026,1 C1.44611861,1 1,1.44648455 1,2.00086422 L1,20.9991358 Z M2.00209026,0 L51.9979097,0 C53.1036337,0 54,0.901627257 54,2.00086422 L54,20.9991358 C54,22.1041826 53.1077828,23 51.9979097,23 L2.00209026,23 C0.896366344,23 0,22.0983727 0,20.9991358 L0,2.00086422 C0,0.895817426 0.892217249,0 2.00209026,0 Z\" id=\"Rectangle-2087-Copy\" fill=\"#EEEEEE\"></path>\\n    <rect id=\"Rectangle-680\" fill=\"url(#linearGradient-1)\" x=\"6\" y=\"12\" width=\"42\" height=\"5\"></rect>\\n    <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"6\" y=\"6\" width=\"6\" height=\"2\"></rect>\\n    <rect id=\"Rectangle-680\" fill=\"#DDDDDD\" x=\"42\" y=\"6\" width=\"6\" height=\"2\"></rect>\\n  </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text CDB-Size-small u-upperCase u-altTextColor\">None</p>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\n\nmodule.exports = [\n  {\n    value: 'none',\n    legendIcon: require('../carousel-icons/none.tpl'),\n    label: _t('editor.legend.types.none')\n  }, {\n    value: 'category',\n    legendIcon: require('../carousel-icons/category.tpl'),\n    label: _t('editor.legend.types.category'),\n    isStyleCompatible: function (styleModel) {\n      var type = styleModel.get('type');\n      var fill = styleModel.get('fill');\n      var stroke = styleModel.get('stroke');\n      var color;\n\n      if (!fill && !stroke || _.isEmpty(fill) && _.isEmpty(stroke)) return false;\n\n      color = fill && fill.color || stroke && stroke.color;\n      return (type === 'animation') ||\n             color && color.quantification === 'category' ||\n             color && color.attribute && color.attribute_type && color.attribute_type === 'string';\n    }\n  }, {\n    value: 'choropleth',\n    legendIcon: require('../carousel-icons/gradient.tpl'),\n    label: _t('editor.legend.types.gradient'),\n    isStyleCompatible: function (styleModel) {\n      var type = styleModel.get('type');\n      var fill = styleModel.get('fill');\n      var stroke = styleModel.get('stroke');\n      var color;\n\n      if (type === 'animation' || type === 'heatmap') return false;\n      if (!fill && !stroke || _.isEmpty(fill) && _.isEmpty(stroke)) return false;\n\n      color = fill && fill.color || stroke && stroke.color;\n\n      if (color && color.quantification === 'category') return false;\n\n      return color && color.attribute && (color.attribute_type === undefined || color.attribute_type && color.attribute_type !== 'string');\n    }\n  }, {\n    value: 'custom_choropleth',\n    legendIcon: require('../carousel-icons/gradient.tpl'),\n    label: _t('editor.legend.types.gradient'),\n    isStyleCompatible: function (styleModel) {\n      var type = styleModel.get('type');\n      var fill = styleModel.get('fill');\n      var stroke = styleModel.get('stroke');\n      var color;\n\n      if (!fill && !stroke || _.isEmpty(fill) && _.isEmpty(stroke)) return false;\n\n      color = fill && fill.color || stroke && stroke.color;\n      return type === 'heatmap' && color && color.attribute && (color.attribute_type === undefined || color.attribute_type && color.attribute_type !== 'string');\n    }\n  }, {\n    value: 'custom',\n    legendIcon: require('../carousel-icons/custom.tpl'),\n    label: _t('editor.legend.types.custom')\n  }\n];\n",
    "var LegendTypes = require('./legend-color-types');\nvar LegendTypeBaseView = require('../legend-base-type-view');\n\nmodule.exports = LegendTypeBaseView.extend({\n  initialize: function (opts) {\n    this.legendTypes = LegendTypes;\n    LegendTypeBaseView.prototype.initialize.call(this, opts);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<ul>\\n  ';\n for(var i in items) { \n__p+='\\n    <li class=\"Legend-categoryListItem u-flex u-justifySpace u-alignCenter\">\\n      <p class=\"Legend-categoryTitle CDB-Text CDB-Size-small u-upperCase u-ellipsis\" title=\"'+\n((__t=( items[i].title ))==null?'':__t)+\n'\">'+\n((__t=( items[i].title ))==null?'':__t)+\n'</p>\\n      ';\n if (items[i].color) { \n__p+='\\n        <span class=\"Legend-categoryCircle\" style=\"opacity:1; background: '+\n((__t=( items[i].color ))==null?'':__t)+\n';\"></span>\\n      ';\n } else if (items[i].icon) { \n__p+='\\n        <span class=\"Legend-categoryIcon js-image-container\" data-icon=\"'+\n((__t=( items[i].icon ))==null?'':__t)+\n'\" ';\n if (items[i].color) { \n__p+='data-color=\"'+\n((__t=( items[i].color ))==null?'':__t)+\n'\"';\n } \n__p+='></span>\\n      ';\n } \n__p+='\\n    </li>\\n  ';\n } \n__p+='\\n</ul>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\n\n/*\n  Base model form legend.\n */\nmodule.exports = Backbone.Model.extend({\n  defaults: {\n    type: 'none',\n    title: ''\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.legendDefinitionModel) throw new Error('legendDefinitionModel is required');\n    this.legendDefinitionModel = opts.legendDefinitionModel;\n\n    this.schema = this._generateSchema();\n  },\n\n  _generateSchema: function () {\n    return {\n      title: {\n        type: 'EnablerEditor',\n        title: '',\n        label: _t('editor.legend.legend-form.title'),\n        defaultValue: this._titlePlaceholder,\n        editor: {\n          type: 'Text',\n          editorAttrs: {\n            placeholder: this._titlePlaceholder\n          }\n        }\n      }\n    };\n  },\n\n  toJSON: function () {\n    return _.extend(\n      this.attributes,\n      {\n        type: this.get('type')\n      }\n    );\n  }\n});\n",
    "var _ = require('underscore');\nvar LegendBaseDefModel = require('./legend-base-definition-form-model');\nvar LegendColorHelper = require('./legend-color-helper');\n\nmodule.exports = LegendBaseDefModel.extend({\n  defaults: _.extend({}, LegendBaseDefModel.prototype.defaults,\n    {\n      type: 'bubble',\n      fillColor: null\n    }\n  ),\n\n  initialize: function (attrs, opts) {\n    this._titlePlaceholder = _t('editor.legend.legend-form.by-size');\n    LegendBaseDefModel.prototype.initialize.call(this, attrs, opts);\n\n    this.on('change:fill', function () {\n      this.set('fillColor', this.get('fill').color.fixed);\n    }, this);\n\n    this._initialColor();\n  },\n\n  toJSON: function () {\n    return _.extend(\n      {},\n      _.omit(this.attributes, 'fill')\n    );\n  },\n\n  _initialColor: function () {\n    var color = this.legendDefinitionModel.get('fillColor');\n    var fill = LegendColorHelper.getBubbles(color);\n    this.set({fill: fill});\n  },\n\n  _generateSchema: function () {\n    var schema = LegendBaseDefModel.prototype._generateSchema.call(this);\n    return _.extend(\n      schema,\n      {\n        fill: {\n          type: 'Fill',\n          title: _t('editor.legend.legend-form.fill'),\n          options: [],\n          dialogMode: 'float',\n          editorAttrs: {\n            color: {\n              hidePanes: ['value']\n            }\n          }\n        },\n        topLabel: {\n          type: 'EnablerEditor',\n          title: '',\n          label: _t('editor.legend.legend-form.top-label'),\n          editor: {\n            type: 'Text',\n            editorAttrs: {\n              placeholder: _t('editor.legend.legend-form.custom-label-placeholder')\n            }\n          }\n        },\n        bottomLabel: {\n          type: 'EnablerEditor',\n          title: '',\n          label: _t('editor.legend.legend-form.bottom-label'),\n          editor: {\n            type: 'Text',\n            editorAttrs: {\n              placeholder: _t('editor.legend.legend-form.custom-label-placeholder')\n            }\n          }\n        }\n      }\n    );\n  }\n});\n",
    "var _ = require('underscore');\nvar LegendBaseDefModel = require('./legend-base-definition-form-model');\n\nmodule.exports = LegendBaseDefModel.extend({\n  defaults: _.extend({}, LegendBaseDefModel.prototype.defaults,\n    {\n      type: 'category'\n    }\n  ),\n\n  initialize: function (attrs, opts) {\n    this._titlePlaceholder = _t('editor.legend.legend-form.by-color');\n    LegendBaseDefModel.prototype.initialize.call(this, attrs, opts);\n  }\n});\n",
    "var _ = require('underscore');\nvar LegendBaseDefModel = require('./legend-base-definition-form-model');\n\nmodule.exports = LegendBaseDefModel.extend({\n  defaults: _.extend({}, LegendBaseDefModel.prototype.defaults,\n    {\n      type: 'choropleth',\n      prefix: '',\n      suffix: '',\n      leftLabel: '',\n      rightLabel: ''\n    }\n  ),\n\n  initialize: function (attrs, opts) {\n    this._titlePlaceholder = _t('editor.legend.legend-form.by-color');\n    LegendBaseDefModel.prototype.initialize.call(this, attrs, opts);\n  },\n\n  _generateSchema: function () {\n    var schema = LegendBaseDefModel.prototype._generateSchema.call(this);\n    return _.extend(\n      schema,\n      {\n        leftLabel: {\n          type: 'EnablerEditor',\n          title: '',\n          label: _t('editor.legend.legend-form.left-label'),\n          editor: {\n            type: 'Text',\n            editorAttrs: {\n              placeholder: _t('editor.legend.legend-form.custom-label-placeholder')\n            }\n          }\n        },\n        rightLabel: {\n          type: 'EnablerEditor',\n          title: '',\n          label: _t('editor.legend.legend-form.right-label'),\n          editor: {\n            type: 'Text',\n            editorAttrs: {\n              placeholder: _t('editor.legend.legend-form.custom-label-placeholder')\n            }\n          }\n        },\n        suffix: {\n          type: 'EnablerEditor',\n          title: '',\n          label: _t('editor.legend.legend-form.suffix'),\n          editor: {\n            type: 'Text'\n          }\n        },\n        prefix: {\n          type: 'EnablerEditor',\n          title: '',\n          label: _t('editor.legend.legend-form.prefix'),\n          editor: {\n            type: 'Text'\n          }\n        }\n      }\n    );\n  }\n});\n",
    "var _ = require('underscore');\n\nfunction buildSwatch (color, name, icon) {\n  if (_.isString(color)) {\n    color = {\n      fixed: color,\n      opacity: 1,\n      image: icon\n    };\n  }\n\n  return {\n    fill: {\n      color: color\n    },\n    title: name\n  };\n}\n\nfunction _unquote (c) {\n  return c && c.replace && c.replace(/^\"(.+(?=\"$))\"$/, '$1');\n}\n\nfunction simpleColor (color) {\n  return [buildSwatch(color, '', color.image || '')];\n}\n\nfunction collectionColor (color) {\n  var range = color.range.length;\n  return _.range(range).map(function (v, index) {\n    // if style attribute is number there is no domain (choropleth)\n    return buildSwatch(\n      color.range[index],\n      color.domain && _unquote(color.domain[index]) || '',\n      color.images && color.images[index]);\n  });\n}\n\nmodule.exports = {\n  buildSwatch: buildSwatch,\n  getCategories: function (color) {\n    if (color.fixed !== undefined) {\n      return simpleColor(color);\n    } else if (color.attribute) {\n      return collectionColor(color);\n    }\n  },\n\n  unquoteColor: _unquote,\n  getBubbles: function (color) {\n    return _.omit(_.first(this.getCategories(color)), 'title').fill;\n  }\n};\n",
    "var _ = require('underscore');\n\nfunction rotateCollection (array) {\n  var first = _.first(array);\n  array = _.rest(array);\n  return array.concat([first]);\n}\n\nvar COLORS = [\n  '#66B79E',\n  '#E65176',\n  '#528995',\n  '#FF710F',\n  '#305482',\n  '#CCD859',\n  '#565175',\n  '#FFB927',\n  '#3EBCAE',\n  '#E54C1F'\n];\n\nmodule.exports = {\n  getNextColor: function () {\n    COLORS = rotateCollection(COLORS);\n    return _.first(COLORS);\n  },\n\n  getColors: function () {\n    return COLORS;\n  },\n\n  setColors: function (collection) {\n    COLORS = collection;\n  }\n};\n",
    "var _ = require('underscore');\nvar LegendBaseDefModel = require('./legend-choropleth-definition-form-model');\n\nmodule.exports = LegendBaseDefModel.extend({\n  defaults: _.extend({}, LegendBaseDefModel.prototype.defaults,\n    {\n      type: 'custom_choropleth'\n    }\n  )\n});\n",
    "var _ = require('underscore');\nvar LegendBaseDefModel = require('./legend-base-definition-form-model');\nvar NestedCategory = require('./legend-nested-category-definition-form-model');\nvar templateItem = require('./legend-list-item.tpl');\nvar templateList = require('./legend-list.tpl');\nvar LegendColorHelper = require('./legend-color-helper');\n\nmodule.exports = LegendBaseDefModel.extend({\n  defaults: _.extend({}, LegendBaseDefModel.prototype.defaults,\n    {\n      type: 'custom',\n      items: []\n    }\n  ),\n\n  initialize: function (attrs, opts) {\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.modals) throw new Error('configModel is required');\n\n    this._userModel = opts.userModel;\n    this._configModel = opts.configModel;\n    this._modals = opts.modals;\n\n    this._titlePlaceholder = _t('editor.legend.legend-form.by-color');\n    LegendBaseDefModel.prototype.initialize.call(this, attrs, opts);\n\n    this._initialItems();\n  },\n\n  _initialItems: function () {\n    var items;\n    var categories = this.legendDefinitionModel.get('items');\n    items = categories.map(function (v, index) {\n      return LegendColorHelper.buildSwatch(v.color, v.title, v.icon);\n    });\n    this.set({items: items});\n  },\n\n  _generateSchema: function () {\n    var schema = LegendBaseDefModel.prototype._generateSchema.call(this);\n    return _.extend(\n      schema,\n      {\n        items: {\n          type: 'SortableList',\n          itemType: 'CategoryModel',\n          model: NestedCategory,\n          title: '',\n          itemTemplate: templateItem,\n          listTemplate: templateList,\n          editorAttrs: {\n            className: 'u-flex',\n            userModel: this._userModel,\n            configModel: this._configModel,\n            modals: this._modals\n          }\n        }\n      }\n    );\n  },\n\n  toJSON: function () {\n    return _.extend(\n      {},\n      _.omit(this.attributes, 'items'),\n      {\n        items: this.get('items').map(function (item) {\n          return {\n            title: item.title,\n            color: item.fill.color.fixed,\n            image: item.fill.color.image\n          };\n        })\n      }\n    );\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"LegendItem js-sortable\">\\n  <div class=\"LegendItem-listFieldsOrder CDB-Shape\">\\n    <div class=\"CDB-Shape-rectsHandle is-small\">\\n      <div class=\"CDB-Shape-rectsHandleItem CDB-Shape-rectsHandleItem--grey is-first\"></div>\\n      <div class=\"CDB-Shape-rectsHandleItem CDB-Shape-rectsHandleItem--grey is-second\"></div>\\n      <div class=\"CDB-Shape-rectsHandleItem CDB-Shape-rectsHandleItem--grey is-third\"></div>\\n    </div>\\n  </div>\\n  <div data-editor class=\"u-grow\">\\n  </div>\\n  <button class=\"LegendItem-deteleButton\" type=\"button\" data-action=\"remove\">\\n    <svg width=\"8px\" height=\"8px\" viewBox=\"435 377 8 8\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n      <path d=\"M436,380 L442,380 L442,384.000193 C442,384.552371 441.549025,385 441.009222,385 L436.990778,385 C436.443586,385 436,384.556283 436,384.000193 L436,380 Z M435,378 L443,378 L443,379 L435,379 L435,378 Z M437,377 L441,377 L441,378 L437,378 L437,377 Z\" id=\"Delete\" stroke=\"none\" fill=\"#AAAAAA\" fill-rule=\"evenodd\"></path>\\n    </svg>\\n  </button>\\n</div>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-grow  LegendItems-container\">\\n  <div data-items class=\"u-bSpace--xl\">\\n\\n  </div>\\n  <div class=\"u-flex u-justifyEnd\" style=\"width: 100%;\"> <!-- We need a fucking u-full helper -->\\n    <button class=\"CDB-Text CDB-Size-small u-actionTextColor u-upperCase\" type=\"button\" data-action=\"add\">\\n      '+\n((__t=( _t('editor.legend.legend-form.add') ))==null?'':_.escape(__t))+\n'\\n    </button>\\n  </div>\\n</div>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar LegendColors = require('./legend-color-range');\n\nvar defaultFill = {\n  color: {\n    fixed: '#fabada',\n    opacity: 0.9\n  }\n};\n\nmodule.exports = Backbone.Model.extend({\n  schema: {\n    fill: {\n      type: 'Fill',\n      title: '',\n      options: [],\n      dialogMode: 'float',\n      editorAttrs: {\n        color: {\n          hidePanes: ['value'],\n          imageEnabled: true\n        },\n        className: 'LegendItem-inner'\n      }\n    },\n    title: {\n      type: 'Text',\n      title: '',\n      editorAttrs: {\n        className: 'LegendItem-inner',\n        placeholder: _t('editor.legend.legend-form.untitled')\n      }\n    }\n  },\n\n  initialize: function (attrs, opts) {\n    this._userModel = opts.userModel;\n    this._configModel = opts.configModel;\n    this._modals = opts.modals;\n\n    this._setOptions();\n\n    var fill = _.clone(defaultFill);\n    if (attrs.fill === undefined) {\n      fill.color.fixed = LegendColors.getNextColor();\n      this.set({fill: fill}, {silent: true});\n    }\n  },\n\n  _setOptions: function () {\n    this.schema.fill.editorAttrs.userModel = this._userModel;\n    this.schema.fill.editorAttrs.configModel = this._configModel;\n    this.schema.fill.editorAttrs.modals = this._modals;\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<h2 class=\"CDB-Text CDB-Size-huge is-light u-secondaryTextColor\">'+\n((__t=( _t('editor.legend.no-geometry-data') ))==null?'':_.escape(__t))+\n' '+\n((__t=( _t('editor.layers.georeference.manually-add') ))==null?'':_.escape(__t))+\n'</h2>\\n<div class=\"BlockList-item is-dashed no-hover is-space u-tSpace-xl\">\\n  <ul class=\"HorizontalBlockList\">\\n    <li class=\"HorizontalBlockList-item\"></li>\\n    <li class=\"HorizontalBlockList-item\"></li>\\n  </ul>\\n\\n  <button class=\"CDB-Button CDB-Button--primary js-georeference\">\\n    <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">'+\n((__t=( _t('editor.layers.georeference.georeference-button') ))==null?'':_.escape(__t))+\n'</span>\\n  </button>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var cdb = require('cartodb.js');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar PanelWithOptionsView = require('../../../../components/view-options/panel-with-options-view');\nvar LegendContentView = require('./legend-content-view');\nvar LegendEditorView = require('./legend-editor-view');\nvar ScrollView = require('../../../../components/scroll/scroll-view');\nvar TabPaneView = require('../../../../components/tab-pane/tab-pane-view');\nvar TabPaneCollection = require('../../../../components/tab-pane/tab-pane-collection');\nvar Toggler = require('../../../../components/toggler/toggler-view');\nvar ApplyView = require('./apply-button-view');\nvar Infobox = require('../../../../components/infobox/infobox-factory');\nvar InfoboxModel = require('../../../../components/infobox/infobox-model');\nvar InfoboxCollection = require('../../../../components/infobox/infobox-collection');\nvar LegendDefinitionModel = require('../../../../data/legends/legend-base-definition-model');\nvar LegendFactory = require('./legend-factory');\nvar htmlTemplate = require('./color/legend-custom-template.tpl');\n\nvar REQUIRED_OPTS = [\n  'mapDefinitionModel',\n  'layerDefinitionModel',\n  'editorModel',\n  'modelView',\n  'legendDefinitionsCollection',\n  'type',\n  'userActions',\n  'userModel',\n  'configModel',\n  'modals'\n];\n\nvar PLACEHOLDER = '[[Legend]]';\nvar HTML_TEMPLATE = _.template('<%= preSnippet %>\\r\\n<%- placeholder %>\\r\\n<%= postSnippet %>');\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (opts[item] === undefined) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n\n    // this.legendTypes is defined in the subview\n    this._legendDefinitionModel = this._getUserLegend(this.legendTypes);\n\n    this._codemirrorModel = new Backbone.Model({\n      content: this._getEditorContent()\n    });\n\n    this._editorModel.set({\n      edition: this._legendDefinitionModel.hasCustomHtml(),\n      disabled: this._isToggleDisable() // if there is an sql error or none style is selected, set to true\n    });\n\n    this._infoboxModel = new InfoboxModel({\n      state: ''\n    });\n\n    this._overlayModel = new Backbone.Model({\n      visible: this._isLayerHidden() || this._legendDefinitionModel.hasCustomHtml()\n    });\n\n    this._infoboxState();\n    this._configPanes();\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this._initViews();\n    return this;\n  },\n\n  _getEditorContent: function () {\n    var content;\n    var type = this._legendDefinitionModel.get('type');\n\n    if (type === 'custom') {\n      if (this._legendDefinitionModel.hasCustomHtml()) {\n        content = this._legendDefinitionModel.get('html');\n      } else {\n        content = '';\n      }\n    } else {\n      content = this._getReadOnlyContent();\n    }\n\n    return content;\n  },\n\n  _getReadOnlyContent: function () {\n    var content = HTML_TEMPLATE({\n      preSnippet: this._legendDefinitionModel.get('preHTMLSnippet') || _t('editor.legend.code-mirror.pre-html'),\n      placeholder: PLACEHOLDER,\n      postSnippet: this._legendDefinitionModel.get('postHTMLSnippet') || _t('editor.legend.code-mirror.post-html')\n    });\n\n    return content;\n  },\n\n  _getCustomContent: function () {\n    var items;\n    var result = this._legendDefinitionModel.get('html');\n    if (result === '') {\n      items = this._legendDefinitionModel.get('items');\n      result = htmlTemplate({items: items});\n    }\n    return result;\n  },\n\n  _handleEditorContent: function (expertMode) {\n    var type = this._legendDefinitionModel.get('type');\n    if (expertMode) {\n      this._codemirrorModel.set({content: type === 'custom' ? this._getCustomContent() : this._getReadOnlyContent()});\n    }\n  },\n\n  _getUserLegend: function (types) {\n    var self = this;\n    var values = _.map(types, function (type) { return type.value; });\n    var selected = this._legendDefinitionsCollection.find(function (legendDefModel) {\n      return values.indexOf(legendDefModel.get('type')) !== -1 && legendDefModel.layerDefinitionModel.id === self._layerDefinitionModel.id;\n    });\n\n    if (selected === undefined) {\n      selected = new LegendDefinitionModel(null, {\n        layerDefinitionModel: this._layerDefinitionModel,\n        configModel: this._legendDefinitionsCollection.configModel,\n        vizId: this._legendDefinitionsCollection.vizId\n      });\n    }\n\n    return selected;\n  },\n\n  _isToggleDisable: function () {\n    return this._modelView.get('state') === 'error' || this._legendDefinitionModel.get('type') === 'none' || this._areLegendsDisabled();\n  },\n\n  _isLayerHidden: function () {\n    return this._layerDefinitionModel.get('visible') === false;\n  },\n\n  _initBinds: function () {\n    this.listenTo(this._editorModel, 'change:edition', this._onChangeEdition);\n    this.add_related_model(this._editorModel);\n\n    this.listenTo(this._modelView, 'change:state', this._infoboxState);\n    this.add_related_model(this._modelView);\n\n    this.listenTo(this._layerDefinitionModel, 'change:visible', this._infoboxState);\n    this.add_related_model(this._layerDefinitionModel);\n\n    this.listenTo(this._mapDefinitionModel, 'change:legends', this._infoboxState);\n    this.add_related_model(this._mapDefinitionModel);\n  },\n\n  _onChangeState: function () {\n    var isDisabled = this._modelView.get('state') === 'error';\n    this._editorModel.set({disabled: isDisabled});\n  },\n\n  _onChangeEdition: function () {\n    this._infoboxState();\n\n    var edition = this._editorModel.get('edition');\n    this._handleEditorContent(edition);\n\n    var index = edition ? 1 : 0;\n    this._collectionPane.at(index).set({ selected: true });\n  },\n\n  _initViews: function () {\n    var self = this;\n\n    var infoboxSstates = [\n      {\n        state: 'html-legend',\n        createContentView: function () {\n          return Infobox.createWithAction({\n            type: 'alert',\n            title: _t('editor.legend.messages.custom-legend.title'),\n            body: _t('editor.legend.messages.custom-legend.body'),\n            mainAction: {\n              label: _t('editor.legend.messages.custom-legend.accept')\n            }\n          });\n        },\n        mainAction: self._deleteCustomHtmlLegend.bind(self)\n      }, {\n        state: 'layer-hidden',\n        createContentView: function () {\n          return Infobox.createWithAction({\n            type: 'alert',\n            title: _t('editor.legend.messages.layer-hidden.title'),\n            body: _t('editor.legend.messages.layer-hidden.body'),\n            mainAction: {\n              label: _t('editor.legend.messages.layer-hidden.show')\n            }\n          });\n        },\n        mainAction: self._showHiddenLayer.bind(self)\n      }, {\n        state: 'legends-disabled',\n        createContentView: function () {\n          return Infobox.createWithAction({\n            type: 'alert',\n            title: _t('editor.legend.messages.legends-disabled.title'),\n            body: _t('editor.legend.messages.legends-disabled.body'),\n            mainAction: {\n              label: _t('editor.legend.messages.legends-disabled.show')\n            }\n          });\n        },\n        mainAction: self._enableLegends.bind(self)\n      }\n    ];\n\n    var infoboxCollection = new InfoboxCollection(infoboxSstates);\n\n    var panelWithOptionsView = new PanelWithOptionsView({\n      className: 'Editor-content',\n      editorModel: self._editorModel,\n      infoboxModel: self._infoboxModel,\n      infoboxCollection: infoboxCollection,\n      createContentView: function () {\n        return new TabPaneView({\n          collection: self._collectionPane\n        });\n      },\n      createControlView: function () {\n        return new Toggler({\n          editorModel: self._editorModel,\n          labels: [_t('editor.legend.data-toggle.values'), _t('editor.legend.data-toggle.html')],\n          isDisableable: true\n        });\n      },\n      createActionView: function () {\n        return new TabPaneView({\n          collection: self._collectionPane,\n          createContentKey: 'createActionView'\n        });\n      }\n    });\n\n    this.$el.append(panelWithOptionsView.render().el);\n    this.addView(panelWithOptionsView);\n  },\n\n  _showHiddenLayer: function () {\n    var savingOptions = {\n      shouldPreserveAutoStyle: true\n    };\n    this._layerDefinitionModel.toggleVisible();\n    this._userActions.saveLayer(this._layerDefinitionModel, savingOptions);\n  },\n\n  _deleteCustomHtmlLegend: function () {\n    var type = this._legendDefinitionModel.get('type');\n    this._legendDefinitionModel && this._legendDefinitionModel.set({\n      html: ''\n    });\n    LegendFactory.createLegend(this._layerDefinitionModel, type);\n    this._infoboxState();\n  },\n\n  _saveLegendHTML: function () {\n    var content = this._codemirrorModel.get('content');\n    var type = this._legendDefinitionModel.get('type');\n    var parts;\n\n    if (type === 'custom') {\n      this._legendDefinitionModel && this._legendDefinitionModel.set({\n        html: content\n      });\n    } else {\n      parts = content.split(PLACEHOLDER).map(function (part) {\n        return cdb.core.sanitize.html(part);\n      });\n\n      this._legendDefinitionModel && this._legendDefinitionModel.set({\n        preHTMLSnippet: parts[0],\n        postHTMLSnippet: parts[1]\n      });\n    }\n\n    LegendFactory.createLegend(this._layerDefinitionModel, type);\n  },\n\n  _infoboxState: function () {\n    var edition = this._editorModel.get('edition');\n\n    if (!edition && this._areLegendsDisabled()) {\n      this._infoboxModel.set({state: 'legends-disabled'});\n      this._overlayModel.set({visible: true});\n    } else if (!edition && this._legendDefinitionModel.hasCustomHtml()) {\n      this._infoboxModel.set({state: 'html-legend'});\n      this._overlayModel.set({visible: true});\n    } else if (!edition && this._isLayerHidden()) {\n      this._infoboxModel.set({state: 'layer-hidden'});\n      this._overlayModel.set({visible: true});\n    } else {\n      this._infoboxModel.set({state: ''});\n      this._overlayModel.set({visible: false});\n    }\n  },\n\n  _areLegendsDisabled: function () {\n    return this._mapDefinitionModel.get('legends') === false;\n  },\n\n  _enableLegends: function () {\n    this._mapDefinitionModel.save({legends: true});\n  },\n\n  // we need to update the reference to the model\n  _updateLegend: function (newLegendDefModel) {\n    this._legendDefinitionModel = newLegendDefModel;\n  },\n\n  _configPanes: function () {\n    var self = this;\n    var tabPaneTabs = [{\n      selected: !self._legendDefinitionModel.hasCustomHtml(),\n      createContentView: function () {\n        return new ScrollView({\n          createContentView: function () {\n            return new LegendContentView({\n              className: 'Editor-content',\n              overlayModel: self._overlayModel,\n              editorModel: self._editorModel,\n              legendTypes: self.legendTypes,\n              layerDefinitionModel: self._layerDefinitionModel,\n              legendDefinitionModel: self._getUserLegend(self.legendTypes),\n              legendDefinitionsCollection: self._legendDefinitionsCollection,\n              updateLegend: self._updateLegend.bind(self),\n              type: self._type,\n              userModel: self._userModel,\n              configModel: self._configModel,\n              modals: self._modals\n            });\n          }\n        });\n      },\n      createActionView: function () {\n        return new CoreView();\n      }\n    }, {\n      selected: self._legendDefinitionModel.hasCustomHtml(),\n      createContentView: function () {\n        return new LegendEditorView({\n          isCustom: self._legendDefinitionModel.get('type') === 'custom',\n          codemirrorModel: self._codemirrorModel,\n          onApplyEvent: self._saveLegendHTML.bind(self)\n        });\n      },\n      createActionView: function () {\n        return new ApplyView({\n          onApplyClick: self._saveLegendHTML.bind(self)\n        });\n      }\n    }];\n\n    this._collectionPane = new TabPaneCollection(tabPaneTabs);\n  }\n});\n",
    "var map = {};\n\nmodule.exports = {\n  add: function (model) {\n    var key = model.layerDefinitionModel.id + ':' + model.get('type');\n    map[key] = model;\n  },\n\n  find: function (layerDefModel, type) {\n    var key = layerDefModel.id + ':' + type;\n    return map[key];\n  },\n\n  remove: function (model) {\n    var key = model.layerDefinitionModel.id + ':' + model.get('type');\n    delete map[key];\n  }\n};\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar CarouselFormView = require('../../../../components/carousel-form-view');\nvar CarouselCollection = require('../../../../components/custom-carousel/custom-carousel-collection');\nvar OverlayView = require('../../../../editor/components/overlay/overlay-view');\nvar FormView = require('./legend-properties-form');\n\nvar CustomFormModel = require('./form/legend-custom-definition-form-model');\nvar CategoryFormModel = require('./form/legend-category-definition-form-model');\nvar BubbleFormModel = require('./form/legend-bubble-definition-form-model');\nvar ChoroplethFormModel = require('./form/legend-choropleth-definition-form-model');\nvar CustomChoroplethFormModel = require('./form/legend-custom-choropleth-definition-form-model');\n\nvar template = require('./legend-content.tpl');\nvar LegendFactory = require('./legend-factory');\n\nvar DEBOUNCE_TIME = 350;\n\nvar REQUIRED_OPTS = [\n  'editorModel',\n  'legendTypes',\n  'updateLegend',\n  'overlayModel',\n  'layerDefinitionModel',\n  'legendDefinitionModel',\n  'legendDefinitionsCollection',\n  'type',\n  'userModel',\n  'configModel',\n  'modals'\n];\n\nvar LEGEND_MODEL_TYPE = {\n  bubble: BubbleFormModel,\n  custom: CustomFormModel,\n  category: CategoryFormModel,\n  choropleth: ChoroplethFormModel,\n  custom_choropleth: CustomChoroplethFormModel\n};\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (!opts[item]) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n\n    var type = this._legendDefinitionModel.get('type');\n\n    this._onDebouncedChange = _.debounce(this._updateChanges.bind(this), DEBOUNCE_TIME);\n\n    this._createFormModel(type);\n\n    var styleModel = this._layerDefinitionModel.styleModel;\n    this._carouselCollection = new CarouselCollection(\n      _.chain(this._legendTypes).filter(function (legend) {\n        return legend.isStyleCompatible ? legend.isStyleCompatible(styleModel) : true;\n      }, this).map(function (legend) {\n        return {\n          selected: type === legend.value,\n          val: legend.value,\n          label: legend.label,\n          template: function () {\n            return (legend.legendIcon && legend.legendIcon()) || legend.value;\n          }\n        };\n      }, this).value()\n    );\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this.$el.html(template());\n    this._initViews();\n    return this;\n  },\n\n  _createFormModel: function (type) {\n    var Klass;\n    var attrs;\n\n    if (this._formModel) {\n      this._unBindFormModel(this._formModel);\n      delete this._formModel;\n    }\n\n    if (type && type !== 'none') {\n      Klass = LEGEND_MODEL_TYPE[type];\n      attrs = this._pickAttrs(this._legendDefinitionModel);\n      this._formModel = new Klass(attrs, {\n        legendDefinitionModel: this._legendDefinitionModel,\n        userModel: this._userModel,\n        configModel: this._configModel,\n        modals: this._modals\n      });\n\n      this._bindFormModel(this._formModel);\n    }\n  },\n\n  _pickAttrs: function (legendDefinitionModel) {\n    var attrs = _.pick(legendDefinitionModel.attributes, 'title', 'prefix', 'suffix', 'leftLabel', 'rightLabel', 'topLabel', 'bottomLabel', 'items');\n    return attrs;\n  },\n\n  _initBinds: function () {\n    this._carouselCollection.on('change:selected', this._onCarouselChange, this);\n    this.add_related_model(this._carouselCollection);\n  },\n\n  _onCarouselChange: function (mdl) {\n    var type = mdl.getValue();\n\n    if (mdl.get('selected') === true) {\n      this._updateLegendModel(type);\n      this._createFormModel(type);\n      this._renderForm(type);\n      this._updateToggle(type);\n    }\n\n    // Remove legend\n    if (mdl.get('selected') === false && type !== 'none') {\n      LegendFactory.removeLegend(this._layerDefinitionModel, type);\n    }\n  },\n\n  _initViews: function () {\n    var type = this._legendDefinitionModel.get('type');\n    this._renderCarousel();\n    this._renderForm(type);\n    this._renderOverlay();\n    this._updateToggle(type);\n  },\n\n  _renderOverlay: function () {\n    var view = new OverlayView({\n      overlayModel: this._overlayModel\n    });\n    this.addView(view);\n    this.$el.append(view.render().el);\n  },\n\n  _updateLegendModel: function (type) {\n    if (type && type !== 'none') {\n      LegendFactory.enableLegend(this._type);\n      this._legendDefinitionModel = LegendFactory.createLegend(this._layerDefinitionModel, type);\n      this._updateLegend(this._legendDefinitionModel);\n    } else {\n      LegendFactory.disableLegend(this._type);\n      this._updateLegend(null);\n      delete this._legendDefinitionModel;\n    }\n  },\n\n  _renderForm: function (type) {\n    this._removeForm();\n\n    if (type && type !== 'none') {\n      this._addForm();\n    }\n  },\n\n  _addForm: function () {\n    this._formView = new FormView({\n      formModel: this._formModel\n    });\n    this.addView(this._formView);\n    this.$('.js-form').html(this._formView.render().el);\n  },\n\n  _removeForm: function () {\n    if (this._formView) {\n      this.removeView(this._formView);\n      this._formView.clean();\n    }\n  },\n\n  _updateToggle: function (type) {\n    var isDisabled = type === 'none';\n    this._editorModel.set({disabled: isDisabled});\n  },\n\n  _renderCarousel: function () {\n    var view = new CarouselFormView({\n      collection: this._carouselCollection,\n      template: require('./legend-form-types.tpl')\n    });\n    this.addView(view);\n    this.$('.js-carousel').html(view.render().el);\n  },\n\n  _bindFormModel: function (model) {\n    if (model) {\n      model.on('change', this._onDebouncedChange, this);\n      this.add_related_model(model);\n    }\n  },\n\n  _unBindFormModel: function (model) {\n    model && model.off('change', this._onDebouncedChange, this);\n  },\n\n  _updateChanges: function () {\n    if (this._legendDefinitionModel) {\n      this._legendDefinitionModel.setAttributes(this._formModel.toJSON());\n      LegendFactory.createLegend(this._layerDefinitionModel, this._legendDefinitionModel.get('type'));\n    }\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"js-carousel\"></div>\\n<div class=\"js-form\"></div>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar CodeMirrorView = require('../../../../components/code-mirror/code-mirror-view');\nvar ErrorTemplate = require('./code-mirror-error.tpl');\n\nvar REQUIRED_OPTS = [\n  'codemirrorModel',\n  'onApplyEvent',\n  'isCustom'\n];\n\nvar PLACEHOLDER = '[[Legend]]';\n\nmodule.exports = CoreView.extend({\n\n  className: 'Editor-content',\n\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (opts[item] === undefined) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this._initViews();\n    return this;\n  },\n\n  _initViews: function () {\n    this.codeMirrorView = new CodeMirrorView({\n      model: this._codemirrorModel,\n      tip: _t('editor.legend.code-mirror.save'),\n      errorTemplate: ErrorTemplate\n    });\n\n    this.codeMirrorView.bind('codeSaved', this._triggerCodeSaved, this);\n    this.addView(this.codeMirrorView);\n    this.$el.append(this.codeMirrorView.render().el);\n\n    if (!this._isCustom) {\n      this._markReadOnly();\n    }\n  },\n\n  _markReadOnly: function () {\n    var cursor = this.codeMirrorView.search(PLACEHOLDER);\n    this.codeMirrorView.markReadOnly(cursor.from, cursor.to);\n  },\n\n  _triggerCodeSaved: function (code, view) {\n    this.options.onApplyEvent && this.options.onApplyEvent();\n  }\n});\n",
    "var _ = require('underscore');\nvar CategoryModel = require('../../../../data/legends/legend-category-definition-model');\nvar BubbleModel = require('../../../../data/legends/legend-bubble-definition-model');\nvar ChoroplethModel = require('../../../../data/legends/legend-choropleth-definition-model');\nvar CustomChoroplethModel = require('../../../../data/legends/legend-custom-choropleth-definition-model');\nvar CustomhModel = require('../../../../data/legends/legend-custom-definition-model');\nvar Validations = require('./legend-validations');\nvar Buffer = require('./legend-buffer');\n\nvar LEGEND_MODEL_TYPE = {\n  'bubble': BubbleModel,\n  'category': CategoryModel,\n  'choropleth': ChoroplethModel,\n  'custom_choropleth': CustomChoroplethModel,\n  'custom': CustomhModel\n};\n\nvar manager = (function () {\n  return {\n    init: function (legendDefinitionsCollection) {\n      if (!legendDefinitionsCollection) {\n        throw new Error('legendDefinitionsCollection is required');\n      }\n      this.legendDefinitionsCollection = legendDefinitionsCollection;\n    },\n\n    getLegendsCollection: function () {\n      return this.legendDefinitionsCollection;\n    },\n\n    add: function (model, callback) {\n      var self = this;\n      model.save(null, {\n        success: function (model) {\n          Buffer.remove(model);\n          self.legendDefinitionsCollection.add(model);\n        },\n        complete: function () {\n          callback && callback();\n        }\n      });\n    },\n\n    save: function (model, callback) {\n      model.save(null, {complete: function (model) {\n        callback && callback();\n      }});\n    },\n\n    remove: function (model, callback) {\n      var self = this;\n      model.destroy({\n        success: function (model) {\n          self.legendDefinitionsCollection.remove(model);\n        },\n        complete: function () {\n          callback && callback();\n        }\n      });\n    },\n\n    createLegend: function (layerDefModel, type, attrs, callback) {\n      var model = this.legendDefinitionsCollection.findByLayerDefModelAndType(layerDefModel, type);\n      var inQueue = Buffer.find(layerDefModel, type);\n      var Klass;\n      var validation = Validations[type];\n      var isValid = validation(layerDefModel.styleModel);\n      attrs = attrs || {};\n\n      if (inQueue) {\n        return inQueue;\n      }\n\n      if (!model) {\n        Klass = LEGEND_MODEL_TYPE[type];\n        model = new Klass(attrs, {\n          layerDefinitionModel: layerDefModel,\n          configModel: this.legendDefinitionsCollection.configModel,\n          vizId: this.legendDefinitionsCollection.vizId,\n          parse: true\n        });\n\n        if (isValid) {\n          Buffer.add(model);\n          this.add(model, callback);\n        }\n      } else {\n        if (!isValid) {\n          this.remove(model, callback);\n        } else {\n          model.set(attrs);\n          this.save(model, callback);\n        }\n      }\n\n      return model;\n    },\n\n    removeLegend: function (layerDefModel, type, cb) {\n      var legend = this.legendDefinitionsCollection.findByLayerDefModelAndType(layerDefModel, type);\n      if (legend) {\n        this.remove(legend, cb);\n      } else {\n        cb && cb();\n      }\n      return legend;\n    },\n\n    find: function (layerDefModel, type) {\n      return this.legendDefinitionsCollection.findByLayerDefModelAndType(layerDefModel, type);\n    },\n\n    removeAllLegend: function (layerDefModel) {\n      var legends = this.legendDefinitionsCollection.findByLayerDefModel(layerDefModel);\n      _.each(legends, function (legend) {\n        legend.get('type') !== 'custom' && this.remove(legend);\n      }, this);\n    },\n\n    hasMigratedLegend: function (layerDefModel) {\n      var legend = this.legendDefinitionsCollection.findByLayerDefModelAndType(layerDefModel, 'html');\n      return !!legend;\n    },\n\n    disableLegend: function (type) {\n      this[type] = false;\n    },\n\n    enableLegend: function (type) {\n      this[type] = true;\n    },\n\n    // By default, it's undefined so we are removing this condition from the equation\n    isEnabledType: function (type) {\n      return this[type] === undefined ? true : !!this[type];\n    }\n  };\n})();\n\nmodule.exports = manager;\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-bSpace--xl\">\\n  <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">1</div>\\n  <div class=\"Editor-HeaderInfo-inner CDB-Text\">\\n    <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n      <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.legend.legend-form.type.title') ))==null?'':_.escape(__t))+\n'</h2>\\n    </div>\\n    <div class=\"js-selector u-bSpace--xl\">\\n      <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m js-highlight\">'+\n((__t=( name ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<h2 class=\"CDB-Text CDB-Size-huge is-light u-secondaryTextColor\">\\n  '+\n((__t=( _t('editor.legend.no-geometry-data') ))==null?'':_.escape(__t))+\n'\\n</h2>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar template = require('./legend-properties-form.tpl');\nrequire('../../../../components/form-components/index');\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    if (!opts.formModel) throw new Error('formModel is required');\n    this._formModel = opts.formModel;\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this._removeFormView();\n    this.$el.html(template());\n    this._initViews();\n    return this;\n  },\n\n  _initViews: function () {\n    this._formView = new Backbone.Form({\n      model: this._formModel\n    });\n\n    this._formView.on('change', this._updateChanges, this);\n    this.add_related_model(this._formView);\n\n    this.$('.js-propertiesForm').append(this._formView.render().el);\n\n    this.$('form').on('submit', function (e) {\n      e.preventDefault();\n    });\n  },\n\n  _updateChanges: function () {\n    this._formView.commit();\n  },\n\n  _removeFormView: function () {\n    this._formView && this._formView.remove();\n  },\n\n  clean: function () {\n    this.$('form').off('submit');\n    this._removeFormView();\n    CoreView.prototype.clean.call(this);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-bSpace--xl\">\\n  <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">2</div>\\n  <div class=\"Editor-HeaderInfo-inner CDB-Text js-selector\">\\n    <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n      <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.legend.legend-form.properties.title') ))==null?'':_.escape(__t))+\n'</h2>\\n    </div>\\n    <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.legend.legend-form.properties.subtitle') ))==null?'':_.escape(__t))+\n'</p>\\n    <div class=\"js-propertiesForm\"></div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\n\nvar noOp = function () {\n  return true;\n};\n\nvar getStyleAttrs = function (styleModel) {\n  var fill = styleModel.get('fill');\n  var stroke = styleModel.get('stroke');\n  if (!fill && !stroke || _.isEmpty(fill) && _.isEmpty(stroke)) return false;\n\n  return {\n    fill: fill,\n    stroke: stroke\n  };\n};\n\nvar validateColorRange = function (styleModel) {\n  var attributes = getStyleAttrs(styleModel);\n  if (!attributes) return false;\n\n  var color = attributes.fill && attributes.fill.color || attributes.stroke && attributes.stroke.color;\n  return color.range && color.range.length > 0;\n};\n\nvar validateSizeRange = function (styleModel) {\n  var attributes = getStyleAttrs(styleModel);\n  if (!attributes) return false;\n\n  var size = attributes.fill && attributes.fill.size || attributes.stroke && attributes.stroke.size;\n  return size.range && size.range.length > 0;\n};\n\nvar validateRangeAndDomain = function (styleModel) {\n  var attributes = getStyleAttrs(styleModel);\n  if (!attributes) return false;\n\n  var color = attributes.fill && attributes.fill.color || attributes.stroke && attributes.stroke.color;\n  return color.range && color.range.length > 0 && color.domain && color.domain.length > 0 && color.range && color.range.length > 0;\n};\n\nvar validations = {\n  bubble: validateSizeRange,\n  category: validateRangeAndDomain,\n  choropleth: validateColorRange,\n  custom_choropleth: validateColorRange,\n  custom: noOp\n};\n\nmodule.exports = validations;\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar LegendColorView = require('./color/legend-color-view');\nvar LegendSizeView = require('./size/legend-size-view');\nvar createTextLabelsTabPane = require('../../../../components/tab-pane/create-text-labels-tab-pane');\nvar TabPaneTemplate = require('../../../tab-pane-submenu.tpl');\nvar sqlErrorTemplate = require('./legend-content-sql-error.tpl');\nvar actionErrorTemplate = require('../../sql-error-action.tpl');\nvar loadingTemplate = require('../../panel-loading-template.tpl');\nvar legendNoGeometryTemplate = require('./legend-no-geometry-template.tpl');\nvar QuerySanity = require('../../query-sanity-check');\nvar georeferencePlaceholderTemplate = require('./georeference-placeholder.tpl');\nvar checkAndBuildOpts = require('../../../../helpers/required-opts');\nvar Infobox = require('../../../../components/infobox/infobox-factory');\nvar InfoboxModel = require('../../../../components/infobox/infobox-model');\nvar InfoboxCollection = require('../../../../components/infobox/infobox-collection');\nvar PanelWithOptionsView = require('../../../../components/view-options/panel-with-options-view');\nvar ViewFactory = require('../../../../components/view-factory');\nvar panelTemplate = require('./panel-with-options.tpl');\nvar OverlayView = require('../../../components/overlay/overlay-view');\nvar fetchAllQueryObjectsIfNecessary = require('../../../../helpers/fetch-all-query-objects');\n\nvar STATES = {\n  ready: 'ready',\n  loading: 'loading',\n  fetched: 'fetched',\n  error: 'error'\n};\n\nvar REQUIRED_OPTS = [\n  'mapDefinitionModel',\n  'userActions',\n  'layerDefinitionModel',\n  'queryGeometryModel',\n  'querySchemaModel',\n  'queryRowsCollection',\n  'legendDefinitionsCollection',\n  'editorModel',\n  'userModel',\n  'configModel',\n  'modals'\n];\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n    this.render = this.render.bind(this);\n\n    this._layerInfowindowModel = this._layerDefinitionModel.infowindowModel;\n    this._layerTooltipModel = this._layerDefinitionModel.tooltipModel;\n\n    this._initModels();\n    this._initBinds();\n\n    this._fetchAllQueryObjectsIfNecessary();\n\n    // In order to handle sql errors\n    QuerySanity.track(this, this._onQueryChanged.bind(this));\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n\n    if (this._queryGeometryModel.isFetching()) {\n      this._renderLoading();\n    } else if (this._hasError()) {\n      this._renderError();\n    } else if (this._queryGeometryModel.hasValue()) {\n      this._initViews();\n    } else {\n      if (this._layerDefinitionModel.canBeGeoreferenced()) {\n        this._renderGeoreferencePlaceholder();\n      } else {\n        this._renderEmptyGeometry();\n      }\n    }\n\n    this._renderOverlay();\n    return this;\n  },\n\n  _renderOverlay: function () {\n    var view = new OverlayView({\n      overlayModel: this._overlayModel\n    });\n    this.addView(view);\n    this.$('.js-content').append(view.render().el);\n  },\n\n  _initModels: function () {\n    this._infoboxModel = new InfoboxModel({\n      state: this._isLayerHidden() ? 'layer-hidden' : ''\n    });\n\n    this._overlayModel = new Backbone.Model({\n      visible: this._isLayerHidden()\n    });\n\n    this.modelView = new Backbone.Model({\n      state: this._getInitialState()\n    });\n  },\n\n  _isLayerHidden: function () {\n    return this._layerDefinitionModel.get('visible') === false;\n  },\n\n  _initBinds: function () {\n    this.listenTo(this._querySchemaModel, 'change:status', this._onStatusChanged);\n    this.listenTo(this._queryGeometryModel, 'change:status', this._onStatusChanged);\n    this.listenTo(this._queryRowsCollection.statusModel, 'change:status', this._onStatusChanged);\n    this.listenTo(this._editorModel, 'change:edition', this._changeStyle);\n    this.listenTo(this._queryGeometryModel, 'change:status', this._onGeometryChanged);\n    this.listenTo(this._editorModel, 'change:edition', this._changeStyle);\n  },\n\n  _fetchAllQueryObjectsIfNecessary: function () {\n    fetchAllQueryObjectsIfNecessary({\n      queryRowsCollection: this._queryRowsCollection,\n      queryGeometryModel: this._queryGeometryModel,\n      querySchemaModel: this._querySchemaModel\n    });\n  },\n\n  _onStatusChanged: function () {\n    fetchAllQueryObjectsIfNecessary({\n      queryRowsCollection: this._queryRowsCollection,\n      queryGeometryModel: this._queryGeometryModel,\n      querySchemaModel: this._querySchemaModel\n    }, this.render);\n  },\n\n  _onQueryChanged: function () {\n    if (this._hasError()) {\n      this.render();\n    }\n  },\n\n  _getInitialState: function () {\n    return STATES.ready;\n  },\n\n  _hasError: function () {\n    return this.modelView.get('state') === STATES.error;\n  },\n\n  _renderError: function () {\n    this.$el.append(\n      sqlErrorTemplate({\n        body: _t('editor.error-query.body', {\n          action: actionErrorTemplate({\n            label: _t('editor.error-query.label')\n          })\n        })\n      })\n    );\n  },\n\n  _renderGeoreferencePlaceholder: function () {\n    var self = this;\n\n    var infoboxSstates = [\n      {\n        state: 'layer-hidden',\n        createContentView: function () {\n          return Infobox.createWithAction({\n            type: 'alert',\n            title: _t('editor.infowindow.messages.layer-hidden.title'),\n            body: _t('editor.infowindow.messages.layer-hidden.body'),\n            mainAction: {\n              label: _t('editor.infowindow.messages.layer-hidden.show')\n            }\n          });\n        },\n        mainAction: self._showHiddenLayer.bind(self)\n      }\n    ];\n\n    var infoboxCollection = new InfoboxCollection(infoboxSstates);\n\n    var panelWithOptionsView = new PanelWithOptionsView({\n      template: panelTemplate,\n      className: 'Editor-content',\n      editorModel: self._editorModel,\n      infoboxModel: self._infoboxModel,\n      infoboxCollection: infoboxCollection,\n      createContentView: function () {\n        return ViewFactory.createByHTML(georeferencePlaceholderTemplate());\n      }\n    });\n\n    this.$el.append(panelWithOptionsView.render().el);\n    this.addView(panelWithOptionsView);\n  },\n\n  _renderEmptyGeometry: function () {\n    this.$el.append(legendNoGeometryTemplate());\n  },\n\n  _renderLoading: function () {\n    this.$el.append(loadingTemplate());\n  },\n\n  _initViews: function () {\n    var self = this;\n\n    var tabPaneTabs = [{\n      name: 'color',\n      label: _t('editor.legend.menu-tab-pane-labels.color'),\n      createContentView: function () {\n        return new LegendColorView({\n          className: 'Editor-content',\n          mapDefinitionModel: self._mapDefinitionModel,\n          editorModel: self._editorModel,\n          userActions: self._userActions,\n          modelView: self.modelView,\n          layerDefinitionModel: self._layerDefinitionModel,\n          legendDefinitionsCollection: self._legendDefinitionsCollection,\n          type: 'color',\n          userModel: self._userModel,\n          configModel: self._configModel,\n          modals: self._modals\n        });\n      }\n    }, {\n      name: 'size',\n      label: _t('editor.legend.menu-tab-pane-labels.size'),\n      createContentView: function () {\n        return new LegendSizeView({\n          className: 'Editor-content',\n          mapDefinitionModel: self._mapDefinitionModel,\n          editorModel: self._editorModel,\n          userActions: self._userActions,\n          userModel: self._userModel,\n          configModel: self._configModel,\n          modals: self._modals,\n          modelView: self.modelView,\n          layerDefinitionModel: self._layerDefinitionModel,\n          legendDefinitionsCollection: self._legendDefinitionsCollection,\n          type: 'size'\n        });\n      }\n    }];\n\n    var tabPaneOptions = {\n      tabPaneOptions: {\n        template: TabPaneTemplate,\n        tabPaneItemOptions: {\n          tagName: 'li',\n          className: 'CDB-NavSubmenu-item'\n        }\n      },\n      tabPaneItemLabelOptions: {\n        tagName: 'button',\n        className: 'CDB-NavSubmenu-link u-upperCase'\n      }\n    };\n\n    this._layerTabPaneView = createTextLabelsTabPane(tabPaneTabs, tabPaneOptions);\n    this.$el.append(this._layerTabPaneView.render().$el);\n    this.addView(this._layerTabPaneView);\n    this._changeStyle(this._editorModel);\n  },\n\n  _changeStyle: function (m) {\n    this._layerTabPaneView.changeStyleMenu(m);\n  },\n\n  _showHiddenLayer: function () {\n    var savingOptions = {\n      shouldPreserveAutoStyle: true\n    };\n    this._layerDefinitionModel.toggleVisible();\n    this._userActions.saveLayer(this._layerDefinitionModel, savingOptions);\n  }\n});\n",
    "var _ = require('underscore');\n\nmodule.exports = [\n  {\n    value: 'none',\n    legendIcon: require('../carousel-icons/none.tpl'),\n    label: _t('editor.legend.types.none')\n  }, {\n    value: 'bubble',\n    legendIcon: require('../carousel-icons/bubble.tpl'),\n    label: _t('editor.legend.types.bubble'),\n    isStyleCompatible: function (styleModel) {\n      var fill = styleModel.get('fill');\n      var stroke = styleModel.get('stroke');\n      var size;\n\n      if (!fill && !stroke || _.isEmpty(fill) && _.isEmpty(stroke)) return false;\n\n      size = fill && fill.size || stroke && stroke.size;\n      return size && size.attribute !== undefined;\n    }\n  }\n];\n",
    "var LegendTypes = require('./legend-size-types');\nvar LegendTypeBaseView = require('../legend-base-type-view');\n\nmodule.exports = LegendTypeBaseView.extend({\n  initialize: function (opts) {\n    this.legendTypes = LegendTypes;\n    LegendTypeBaseView.prototype.initialize.call(this, opts);\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar Backbone = require('backbone');\nvar template = require('./layer-header.tpl');\nvar SyncInfoView = require('./sync-info/sync-info-view');\nvar ContextMenuView = require('../../components/context-menu/context-menu-view');\nvar CustomListCollection = require('../../components/custom-list/custom-list-collection');\nvar VisTableModel = require('../../data/visualization-table-model');\nvar renameLayer = require('./operations/rename-layer');\nvar DeleteLayerConfirmationView = require('../../components/modals/remove-layer/delete-layer-confirmation-view');\nvar InlineEditorView = require('../../components/inline-editor/inline-editor-view');\nvar ModalExportDataView = require('../../components/modals/export-data/modal-export-data-view');\nvar templateInlineEditor = require('./inline-editor.tpl');\nvar layerColors = require('../../data/layer-colors');\nvar zoomToData = require('../map-operations/zoom-to-data');\nvar TipsyTooltipView = require('../../components/tipsy-tooltip-view');\nvar checkAndBuildOpts = require('../../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'modals',\n  'userActions',\n  'layerDefinitionModel',\n  'layerDefinitionsCollection',\n  'configModel',\n  'stateDefinitionModel',\n  'editorModel',\n  'userModel',\n  'visDefinitionModel',\n  'widgetDefinitionsCollection'\n];\n\nmodule.exports = CoreView.extend({\n  className: 'js-editorPanelHeader',\n\n  events: {\n    'click .js-toggle-menu': '_onToggleContextMenuClicked',\n    'click .js-zoom': '_onZoomClicked',\n    'blur .js-input': '_hideRenameInput',\n    'keyup .js-input': '_onKeyUpInput'\n  },\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    this._tableNodeModel = opts.tableNodeModel;\n    this._sourceNode = this._getSourceNode();\n    this._topQueryGeometryModel = null;\n\n    if (this._sourceNode) {\n      var tableName = this._sourceNode.get('table_name');\n      this._visTableModel = new VisTableModel({\n        id: tableName,\n        table: {\n          name: tableName\n        }\n      }, {\n        configModel: this._configModel\n      });\n    }\n\n    this._uiModel = new Backbone.Model({\n      zoomVisible: this._isQueryGeometryVisible()\n    });\n\n    this._changeStyle = this._changeStyle.bind(this);\n    this._bindEvents();\n    this._onSourceChanged();\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    var tableName = '';\n    var url = '';\n\n    if (this._visTableModel) {\n      var tableModel = this._visTableModel.getTableModel();\n      tableName = tableModel.getUnquotedName();\n      url = this._visTableModel && this._visTableModel.datasetURL();\n    }\n\n    var letter = this._layerDefinitionModel.get('letter');\n\n    this.$el.html(\n      template({\n        letter: letter,\n        bgColor: layerColors.getColorForLetter(letter),\n        isTableSource: !!this._sourceNode,\n        url: url,\n        tableName: tableName,\n        title: this._layerDefinitionModel.getTableName().replace(/_/gi, ' '),\n        alias: this._layerDefinitionModel.getName()\n      })\n    );\n\n    var tooltip = new TipsyTooltipView({\n      el: this._getZoom(),\n      gravity: 'w',\n      title: function () {\n        return _t('editor.layers.options.center-map');\n      }\n    });\n    this.addView(tooltip);\n\n    this._showOrHideZoomVisibility();\n    this._initViews();\n    return this;\n  },\n\n  _initViews: function () {\n    this._addSyncInfo();\n\n    this._inlineEditor = new InlineEditorView({\n      template: templateInlineEditor,\n      renderOptions: {\n        alias: this._layerDefinitionModel.getName()\n      },\n      onEdit: this._renameLayer.bind(this)\n    });\n    this.addView(this._inlineEditor);\n\n    this.$('.js-header').append(this._inlineEditor.render().el);\n  },\n\n  _addSyncInfo: function () {\n    var nodeModel = this._layerDefinitionModel.getAnalysisDefinitionNodeModel();\n    if (nodeModel && nodeModel.tableModel && nodeModel.tableModel.isSync()) {\n      this._createSyncInfo(nodeModel.tableModel);\n    }\n  },\n\n  _createSyncInfo: function (tableModel) {\n    var syncModel = tableModel.getSyncModel();\n    this._syncInfoView = new SyncInfoView({\n      modals: this._modals,\n      syncModel: tableModel._syncModel,\n      tableModel: tableModel,\n      userModel: this._userModel\n    });\n\n    this.addView(this._syncInfoView);\n    this.$el.prepend(this._syncInfoView.render().el);\n\n    syncModel.bind('destroy', this._destroySyncInfo, this);\n    this.add_related_model(syncModel);\n  },\n\n  _destroySyncInfo: function () {\n    this.removeView(this._syncInfoView);\n    this._syncInfoView.clean();\n    delete this._syncInfoView;\n  },\n\n  _bindEvents: function () {\n    if (this._tableNodeModel) {\n      this._tableNodeModel.bind('change:synchronization', this.render, this);\n      this.add_related_model(this._tableNodeModel);\n    }\n    this._layerDefinitionModel.bind('change:source', this.render, this);\n    this._layerDefinitionModel.bind('change:source', this._onSourceChanged, this);\n    this._editorModel.on('change:edition', this._changeStyle, this);\n    this._uiModel.on('change:zoomVisible', this._showOrHideZoomVisibility, this);\n    this.add_related_model(this._editorModel);\n    this.add_related_model(this._layerDefinitionModel);\n  },\n\n  _getSourceNode: function () {\n    var node = this._layerDefinitionModel.getAnalysisDefinitionNodeModel();\n    var source;\n    if (node.get('type') === 'source') {\n      source = node;\n    } else {\n      var primarySource = node.getPrimarySource();\n      if (primarySource && primarySource.get('type') === 'source') {\n        source = primarySource;\n      }\n    }\n\n    return source;\n  },\n\n  _onSourceChanged: function () {\n    var nodeModel = this._layerDefinitionModel.getAnalysisDefinitionNodeModel();\n    if (this._topQueryGeometryModel !== null) {\n      this._topQueryGeometryModel.unbind('change:simple_geom');\n    }\n    this._topQueryGeometryModel = nodeModel.queryGeometryModel.bind('change:simple_geom', this._checkIfGeometryVisible, this);\n    this._checkIfGeometryVisible();\n  },\n\n  _isQueryGeometryVisible: function () {\n    var nodeModel = this._layerDefinitionModel.getAnalysisDefinitionNodeModel();\n    return !!nodeModel.queryGeometryModel.get('simple_geom');\n  },\n\n  _checkIfGeometryVisible: function () {\n    this._uiModel.set('zoomVisible', this._isQueryGeometryVisible());\n  },\n\n  _changeStyle: function () {\n    var editing = this._editorModel.isEditing();\n    this._getTitle().toggleClass('u-whiteTextColor', editing);\n    this._getIcon().toggleClass('is-white', editing);\n    this._getInlineEditor().toggleClass('u-mainTextColor', editing);\n    this._getLink().toggleClass('u-altTextColor', editing);\n    this._getBack().toggleClass('u-whiteTextColor', editing);\n    this._getToggleMenu().toggleClass('is-white', editing);\n    this._getZoom().toggleClass('is-white', editing);\n  },\n\n  _getInlineEditor: function () {\n    return this.$('.Inline-editor-input');\n  },\n\n  _getTitle: function () {\n    return this.$('.Editor-HeaderInfo-titleText');\n  },\n\n  _getIcon: function () {\n    return this.$('.CDB-Shape-Dataset');\n  },\n\n  _getLink: function () {\n    return this.$('.CDB-Text a');\n  },\n\n  _getBack: function () {\n    return this.$('.js-back');\n  },\n\n  _getToggleMenu: function () {\n    return this.$('.CDB-Shape-threePoints');\n  },\n\n  _getZoom: function () {\n    return this.$('.js-zoom');\n  },\n\n  _onToggleContextMenuClicked: function (event) {\n    if (this._hasContextMenu()) {\n      this._hideContextMenu();\n    } else {\n      this._showContextMenu({\n        x: event.pageX,\n        y: event.pageY\n      });\n    }\n  },\n\n  _hasContextMenu: function () {\n    return this._menuView != null;\n  },\n\n  _showContextMenu: function (position) {\n    var menuItems = new CustomListCollection([{\n      label: _t('editor.layers.options.rename'),\n      val: 'rename-layer'\n    }, {\n      label: this._layerHidden() ? _t('editor.layers.options.show') : _t('editor.layers.options.hide'),\n      val: 'toggle-layer'\n    }, {\n      label: _t('editor.layers.options.export'),\n      val: 'export-data'\n    }]);\n    if (this._layerDefinitionModel.canBeDeletedByUser()) {\n      menuItems.add({\n        label: _t('editor.layers.options.delete'),\n        val: 'delete-layer',\n        destructive: true\n      });\n    }\n\n    var triggerElementID = 'context-menu-trigger-' + this._layerDefinitionModel.cid;\n    this.$('.js-toggle-menu').attr('id', triggerElementID);\n    this._menuView = new ContextMenuView({\n      collection: menuItems,\n      triggerElementID: triggerElementID,\n      position: position\n    });\n\n    menuItems.bind('change:selected', function (menuItem) {\n      if (menuItem.get('val') === 'delete-layer') {\n        this._confirmDeleteLayer();\n      }\n      if (menuItem.get('val') === 'rename-layer') {\n        this._inlineEditor.edit();\n      }\n      if (menuItem.get('val') === 'toggle-layer') {\n        var savingOptions = {\n          shouldPreserveAutoStyle: true\n        };\n        this._layerDefinitionModel.toggleVisible();\n        this._userActions.saveLayer(this._layerDefinitionModel, savingOptions);\n      }\n      if (menuItem.get('val') === 'export-data') {\n        this._exportLayer();\n      }\n    }, this);\n\n    this._menuView.model.bind('change:visible', function (model, isContextMenuVisible) {\n      if (this._hasContextMenu() && !isContextMenuVisible) {\n        this._hideContextMenu();\n      }\n    }, this);\n\n    this._menuView.show();\n    this.addView(this._menuView);\n  },\n\n  _confirmDeleteLayer: function () {\n    this._modals.create(function (modalModel) {\n      var deleteLayerConfirmationView = new DeleteLayerConfirmationView({\n        userActions: this._userActions,\n        modals: this._modals,\n        layerModel: this._layerDefinitionModel,\n        modalModel: modalModel,\n        visDefinitionModel: this._visDefinitionModel,\n        widgetDefinitionsCollection: this._widgetDefinitionsCollection\n      });\n\n      return deleteLayerConfirmationView;\n    }.bind(this));\n  },\n\n  _hideContextMenu: function () {\n    this.removeView(this._menuView);\n    this._menuView.clean();\n    delete this._menuView;\n  },\n\n  _exportLayer: function () {\n    var nodeDefModel = this._layerDefinitionModel.getAnalysisDefinitionNodeModel();\n    var queryGeometryModel = nodeDefModel.queryGeometryModel;\n\n    this._modals.create(function (modalModel) {\n      return new ModalExportDataView({\n        modalModel: modalModel,\n        queryGeometryModel: queryGeometryModel,\n        configModel: this._configModel,\n        fileName: this._layerDefinitionModel.getName()\n      });\n    }.bind(this));\n  },\n\n  _renameLayer: function () {\n    var newName = this._inlineEditor.getValue();\n\n    if (newName !== '') {\n      // Optimistic\n      this._onSaveSuccess(newName);\n\n      renameLayer({\n        newName: newName,\n        userActions: this._userActions,\n        layerDefinitionsCollection: this._layerDefinitionsCollection,\n        layerDefinitionModel: this._layerDefinitionModel,\n        onError: this._onSaveError.bind(this)\n      });\n    }\n  },\n\n  _onSaveSuccess: function (newName) {\n    this.$('.js-title').text(newName).show();\n    this._inlineEditor.hide();\n  },\n\n  _onSaveError: function (oldName) {\n    this.$('.js-title').text(oldName).show();\n    this._inlineEditor.hide();\n  },\n\n  _layerHidden: function () {\n    return this._layerDefinitionModel.get('visible') === false;\n  },\n\n  _onZoomClicked: function () {\n    var nodeModel = this._layerDefinitionModel.getAnalysisDefinitionNodeModel();\n    var query = nodeModel.querySchemaModel.get('query');\n    zoomToData(this._configModel, this._stateDefinitionModel, query);\n  },\n\n  _showOrHideZoomVisibility: function () {\n    this._getZoom().toggle(this._isQueryGeometryVisible());\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-HeaderInfoEditor\">\\n  <div class=\"u-rSpace--xl u-actionTextColor js-back Editor-HeaderInfoEditorShape\">\\n    <button>\\n      <i class=\"CDB-IconFont CDB-IconFont-arrowPrev Size-large\"></i>\\n    </button>\\n  </div>\\n\\n  <div class=\"Editor-HeaderInfo-inner u-ellipsis\">\\n    <div class=\"Editor-HeaderInfo-title u-bSpace js-header\">\\n      <span class=\"SelectorLayer-letter CDB-Text CDB-Size-small u-whiteTextColor u-tSpace--m u-rSpace--m u-upperCase\" style=\"background-color: '+\n((__t=( bgColor ))==null?'':_.escape(__t))+\n';\">\\n        '+\n((__t=( letter ))==null?'':_.escape(__t))+\n'\\n      </span>\\n    </div>\\n    <div class=\"u-flex u-ellipsis\">\\n      ';\n if (isTableSource) { \n__p+='\\n        <div class=\"CDB-Shape CDB-Size-medium u-rSpace\">\\n          <ul class=\"CDB-Shape-Dataset is-small is-grey\">\\n            <li class=\"CDB-Shape-DatasetItem\"></li>\\n            <li class=\"CDB-Shape-DatasetItem\"></li>\\n          </ul>\\n        </div>\\n        <p class=\"CDB-Text CDB-Size-medium u-ellipsis\">\\n          <a href=\"'+\n((__t=( url ))==null?'':_.escape(__t))+\n'\" target=\"_blank\" title=\"'+\n((__t=( tableName ))==null?'':_.escape(__t))+\n'\" class=\"Editor-headerLayerName\">'+\n((__t=( tableName ))==null?'':_.escape(__t))+\n'</a>\\n        </p>\\n      ';\n } \n__p+='\\n    </div>\\n  </div>\\n\\n  <ul class=\"u-flex u-tSpace-xl\">\\n    <li class=\"u-rSpace\">\\n      <button class=\"Editor-HeaderInfo-zoom CDB-Shape js-zoom\">\\n        <svg width=\"16px\" height=\"15px\" viewBox=\"287 30 16 15\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n          <g id=\"Icon\" stroke=\"none\" stroke-width=\"1\" fill-rule=\"evenodd\" transform=\"translate(288.000000, 30.000000)\">\\n            <circle id=\"Oval\" cx=\"7.5\" cy=\"7.5\" r=\"0.5\"></circle>\\n            <path d=\"M7,0 L8,0 L8,5 L7,5 L7,0 Z M6,3 L7,3 L7,4 L6,4 L6,3 Z M8,3 L9,3 L9,4 L8,4 L8,3 Z M9,2 L10,2 L10,3 L9,3 L9,2 Z M5,2 L6,2 L6,3 L5,3 L5,2 Z\" id=\"Combined-Shape\"></path>\\n            <path d=\"M7,10 L8,10 L8,15 L7,15 L7,10 Z M6,13 L7,13 L7,14 L6,14 L6,13 Z M8,13 L9,13 L9,14 L8,14 L8,13 Z M9,12 L10,12 L10,13 L9,13 L9,12 Z M5,12 L6,12 L6,13 L5,13 L5,12 Z\" id=\"Combined-Shape\" transform=\"translate(7.500000, 12.500000) scale(1, -1) translate(-7.500000, -12.500000) \"></path>\\n            <path d=\"M12,5 L13,5 L13,10 L12,10 L12,5 Z M11,8 L12,8 L12,9 L11,9 L11,8 Z M13,8 L14,8 L14,9 L13,9 L13,8 Z M14,7 L15,7 L15,8 L14,8 L14,7 Z M10,7 L11,7 L11,8 L10,8 L10,7 Z\" id=\"Combined-Shape\" transform=\"translate(12.500000, 7.500000) scale(1, -1) rotate(90.000000) translate(-12.500000, -7.500000) \"></path>\\n            <path d=\"M2,5 L3,5 L3,10 L2,10 L2,5 Z M1,8 L2,8 L2,9 L1,9 L1,8 Z M3,8 L4,8 L4,9 L3,9 L3,8 Z M4,7 L5,7 L5,8 L4,8 L4,7 Z M0,7 L1,7 L1,8 L0,8 L0,7 Z\" id=\"Combined-Shape\" transform=\"translate(2.500000, 7.500000) scale(-1, -1) rotate(90.000000) translate(-2.500000, -7.500000) \"></path>\\n          </g>\\n        </svg>\\n      </button>\\n    </li>\\n    <li class=\"CDB-Shape\">\\n      <button class=\"CDB-Shape-threePoints is-blue is-small js-toggle-menu\">\\n        <div class=\"CDB-Shape-threePointsItem\"></div>\\n        <div class=\"CDB-Shape-threePointsItem\"></div>\\n        <div class=\"CDB-Shape-threePointsItem\"></div>\\n      </button>\\n    </li>\\n  </ul>\\n\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<nav class=\"CDB-NavMenu js-theme\">\\n  <ul class=\"CDB-NavMenu-inner CDB-Text is-semibold CDB-Size-medium js-menu\"></ul>\\n</nav>\\n<div class=\"Editor-content js-content\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar layerTypesAndKinds = require('../../data/layer-types-and-kinds');\nvar BaseTiledLayerView = require('./layer-views/base-tiled-layer-view');\nvar PlainColorLayerView = require('./layer-views/plain-color-layer-view');\nvar BackgroundImageLayerView = require('./layer-views/background-image-layer-view');\nvar GoogleMapsBaseLayerView = require('./layer-views/google-maps-base-layer-view');\nvar DataLayerView = require('./layer-views/data-layer-view');\nvar LabelsLayerView = require('./layer-views/labels-layer-view');\nvar LayerAnalysesView = require('./layer-analyses-view');\nvar LayerAnalysisViewFactory = require('./layer-analysis-view-factory');\nvar checkAndBuildOpts = require('../../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'stackLayoutModel',\n  'userActions',\n  'layerDefinitionsCollection',\n  'analysisDefinitionNodesCollection',\n  'modals',\n  'configModel',\n  'sortableSelector',\n  'stateDefinitionModel',\n  'visDefinitionModel',\n  'widgetDefinitionsCollection'\n];\n\nvar LayerViewFactory = function (opts) {\n  opts = opts || {};\n  checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n};\n\nLayerViewFactory.prototype.createLayerView = function (layerDefinitionModel) {\n  var layerViewOptions = {\n    model: layerDefinitionModel,\n    stackLayoutModel: this._stackLayoutModel,\n    modals: this._modals,\n    stateDefinitionModel: this._stateDefinitionModel,\n    configModel: this._configModel\n  };\n\n  if (layerDefinitionModel.isDataLayer()) {\n    layerViewOptions = _.extend(layerViewOptions, {\n      userActions: this._userActions,\n      layerDefinitionsCollection: this._layerDefinitionsCollection,\n      newAnalysesView: this._newAnalysesView.bind(this),\n      widgetDefinitionsCollection: this._widgetDefinitionsCollection,\n      visDefinitionModel: this._visDefinitionModel,\n      analysisDefinitionNodesCollection: this._analysisDefinitionNodesCollection\n    });\n  }\n\n  var LayerViewClass = this._getLayerViewClass(layerDefinitionModel);\n  return new LayerViewClass(layerViewOptions);\n};\n\nLayerViewFactory.prototype._getLayerViewClass = function (layerDefinitionModel) {\n  // Base layers\n  if (this._isTiledBaseLayer(layerDefinitionModel)) {\n    return BaseTiledLayerView;\n  }\n  if (this._isPlainColorBaseLayer(layerDefinitionModel)) {\n    return PlainColorLayerView;\n  }\n  if (this._isBackgroundImageBaseLayer(layerDefinitionModel)) {\n    return BackgroundImageLayerView;\n  }\n  if (this._isGoogleMapsBaseLayer(layerDefinitionModel)) {\n    return GoogleMapsBaseLayerView;\n  }\n\n  // Data layers\n  if (layerDefinitionModel.isDataLayer()) {\n    return DataLayerView;\n  }\n\n  // Labels layer\n  if (this._isLabelsLayer(layerDefinitionModel)) {\n    return LabelsLayerView;\n  }\n\n  throw new Error('No layer view for type \"' + layerDefinitionModel.get('type') + '\" just yet.');\n};\n\nLayerViewFactory.prototype._isBaseLayer = function (layerDefinitionModel) {\n  return layerDefinitionModel.get('order') === 0;\n};\n\nLayerViewFactory.prototype._isTiledBaseLayer = function (layerDefinitionModel) {\n  var layerType = layerDefinitionModel.get('type');\n  return layerTypesAndKinds.isTiledType(layerType) &&\n    this._isBaseLayer(layerDefinitionModel);\n};\n\nLayerViewFactory.prototype._isPlainColorBaseLayer = function (layerDefinitionModel) {\n  var layerType = layerDefinitionModel.get('type');\n  return layerTypesAndKinds.isPlainType(layerType) &&\n    this._isBaseLayer(layerDefinitionModel) &&\n      layerDefinitionModel.get('color');\n};\n\nLayerViewFactory.prototype._isBackgroundImageBaseLayer = function (layerDefinitionModel) {\n  var layerType = layerDefinitionModel.get('type');\n  return layerTypesAndKinds.isPlainType(layerType) &&\n    this._isBaseLayer(layerDefinitionModel) &&\n      layerDefinitionModel.get('image');\n};\n\nLayerViewFactory.prototype._isGoogleMapsBaseLayer = function (layerDefinitionModel) {\n  var layerType = layerDefinitionModel.get('type');\n  return layerTypesAndKinds.isGMapsBase(layerType) &&\n    this._isBaseLayer(layerDefinitionModel);\n};\n\nLayerViewFactory.prototype._isLabelsLayer = function (layerDefinitionModel) {\n  var layerType = layerDefinitionModel.get('type');\n  return layerTypesAndKinds.isTiledType(layerType) &&\n    !this._isBaseLayer(layerDefinitionModel);\n};\n\nLayerViewFactory.prototype._newAnalysesView = function (el, layerDefinitionModel) {\n  var layerAnalysisViewFactory = new LayerAnalysisViewFactory(this._analysisDefinitionNodesCollection);\n  return new LayerAnalysesView({\n    el: el,\n    model: layerDefinitionModel,\n    layerAnalysisViewFactory: layerAnalysisViewFactory,\n    sortableSelector: this._sortableSelector\n  });\n};\n\nmodule.exports = LayerViewFactory;\n",
    "var _ = require('underscore');\nvar BaseLayerViewBase = require('./base-layer-view-base');\nvar template = require('./image-thumbnail-layer.tpl');\n\nmodule.exports = BaseLayerViewBase.extend({\n  _getCompiledTemplate: function () {\n    return template({\n      title: this._getImageFileName(),\n      desc: _t('editor.layers.image.title-label'),\n      imgURL: this.model.get('image')\n    });\n  },\n\n  _getImageFileName: function () {\n    var imageURL = this.model.get('image');\n    var fileNameWithParameters = _.last(imageURL.split('/'));\n    var fileName = fileNameWithParameters.split('?')[0];\n    return fileName;\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\n\n/**\n * Base view for all base layer views.\n */\nmodule.exports = CoreView.extend({\n\n  tagName: 'li',\n\n  className: 'BlockList-item js-layer ui-state-disabled',\n\n  events: {\n    'click': '_onEditBasemap'\n  },\n\n  initialize: function (opts) {\n    if (!opts.stackLayoutModel) throw new Error('stackLayoutModel is required');\n\n    this._stackLayoutModel = opts.stackLayoutModel;\n\n    this.listenTo(this.model, 'change', this.render);\n  },\n\n  render: function () {\n    this.$el.html(this._getCompiledTemplate());\n\n    return this;\n  },\n\n  _getCompiledTemplate: function () {\n    throw new Error('subclasses of BasemapLayerViewBase must implement _getCompiledTemplate');\n  },\n\n  _onEditBasemap: function (e) {\n    e.stopPropagation();\n\n    this._stackLayoutModel.nextStep(this.model, 'basemaps');\n  }\n});\n",
    "/* global Image */\n\nvar BaseLayerViewBase = require('./base-layer-view-base');\nvar template = require('./image-thumbnail-layer.tpl');\n\nvar DEFAULT_SUBDOMAIN = 'a';\nvar DEFAULT_X_POSITION = 30;\nvar DEFAULT_Y_POSISTION = 24;\nvar DEFAULT_ZOOM = 6;\nvar DEFAULT_IMG = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAAAZ9JREFUWAntWUtugzAUNKbAJl1EYtcz9Ba5UE6SC+UWPUN3SNlkw78zVhJRCeIXbCup6ic5gP08Ho/x40ESBauq6iNJkgPKDpdb1j3RTuM4HlH2ZVl+JySXpukXygaksiViRVEsNd3qu65Tfd/frpdO8jxXEGO2GcTUMAxtXddnYH1qKqe1fof3IrlZpECVJA6xMgiyMdzws0N5CzTealiIlpGbBsKz77nZSYAc67ck+NIWCbouj1cFL/eNK6df/UW7FztKMT7ZTOJDDMQ5RUyJGYK2IMyBm6ax4nFQGxZBEIStWFcH2TSu3pZjiCX2StDCf1VzJLhKtkmnqOBEjFWn/0tBaaB+REoTqJkJ2wxJpM3FtPvGMgQlabrkCUEcCcF7Kf9UBT5xvN6DIZbYK8Hp7H2dR4KuSkYFo4KPKBAiYTWBmoHznvEdQpKm82ljw+I4DObElJghaJu59AWHA9qw6CMlR9+4i6mCi0UFXdRj3z+hIL8Ju040VP+TBrkjtn0bagQH3JbcSHB/+WDNCgc8r11bZOdncjPfWV/5b4gfOaaYLUG/QVoAAAAASUVORK5CYII=';\nvar DEFAULT_NAME = _t('editor.layers.basemap.custom-basemap');\n\nmodule.exports = BaseLayerViewBase.extend({\n\n  _getCompiledTemplate: function () {\n    var title = this.model.getName() || DEFAULT_NAME;\n    var desc = _t('editor.layers.basemap.title-label');\n\n    return template({\n      title: title,\n      desc: title === desc ? '' : desc,\n      imgURL: this._getImageURL()\n    });\n  },\n\n  _getImageURL: function () {\n    var self = this;\n    var url = this._lowerXYZ();\n\n    var image = new Image();\n    image.onerror = function () {\n      self.$('.js-thumbnailImg').attr('src', DEFAULT_IMG);\n    };\n    image.src = url;\n\n    return url;\n  },\n\n  _getSubdomain: function () {\n    var subdomains = this.model.get('subdomains'); // eg: 'abcd' or '1234'\n\n    return (subdomains && subdomains.length) ? subdomains[0] : DEFAULT_SUBDOMAIN;\n  },\n\n  _lowerXYZ: function () {\n    return this.model.get('urlTemplate')\n      .replace('{s}', this._getSubdomain())\n      .replace('{z}', DEFAULT_ZOOM)\n      .replace('{x}', DEFAULT_X_POSITION)\n      .replace('{y}', DEFAULT_Y_POSISTION);\n  }\n});\n",
    "var _ = require('underscore');\nvar $ = require('jquery');\nvar CoreView = require('backbone/core-view');\nvar template = require('./data-layer.tpl');\nvar ContextMenuView = require('../../../components/context-menu/context-menu-view');\nvar CustomListCollection = require('../../../components/custom-list/custom-list-collection');\nvar renameLayer = require('../operations/rename-layer');\nvar DeleteLayerConfirmationView = require('../../../components/modals/remove-layer/delete-layer-confirmation-view');\nvar ModalExportDataView = require('../../../components/modals/export-data/modal-export-data-view');\nvar InlineEditorView = require('../../../components/inline-editor/inline-editor-view');\nvar TipsyTooltipView = require('../../../components/tipsy-tooltip-view');\nvar zoomToData = require('../../map-operations/zoom-to-data');\nvar templateInlineEditor = require('./inline-editor.tpl');\nvar geometryNoneTemplate = require('./geometry-none.tpl');\nvar geometryPointsTemplate = require('./geometry-points.tpl');\nvar geometryLinesTemplate = require('./geometry-lines.tpl');\nvar geometryPolygonsTemplate = require('./geometry-polygons.tpl');\nvar checkAndBuildOpts = require('../../../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'userActions',\n  'stackLayoutModel',\n  'layerDefinitionsCollection',\n  'modals',\n  'configModel',\n  'stateDefinitionModel',\n  'widgetDefinitionsCollection',\n  'visDefinitionModel',\n  'analysisDefinitionNodesCollection'\n];\n\nmodule.exports = CoreView.extend({\n\n  tagName: 'li',\n  className: 'Editor-ListLayer-item js-layer',\n\n  events: {\n    'click': '_onEditLayer',\n    'click .js-base': '_onClickSource',\n    'click .js-title': '_onClickTitle',\n    'click .js-toggle-menu': '_onToggleContextMenuClicked',\n    'click .js-toggle': '_onToggleLayerClicked',\n    'click .js-analysis-node': '_onAnalysisNodeClicked'\n  },\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    if (!_.isFunction(opts.newAnalysesView)) throw new Error('newAnalysesView is required as a function');\n\n    this._newAnalysesView = opts.newAnalysesView;\n    this._styleModel = this.model.styleModel;\n\n    var nodeDefModel = this.model.getAnalysisDefinitionNodeModel();\n\n    this._queryGeometryModel = nodeDefModel.queryGeometryModel;\n\n    this._bindEvents();\n\n    if (this._queryGeometryModel.shouldFetch()) {\n      this._queryGeometryModel.fetch();\n    }\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    var m = this.model;\n    var self = this;\n    var isTorque = m.isTorqueLayer();\n    var isAnimation = this._styleModel.isAnimation();\n    var geometryTemplate = this._getGeometryTemplate(this._queryGeometryModel.get('simple_geom'));\n\n    this.$el.html(template({\n      layerId: m.id,\n      title: m.getName(),\n      color: m.get('color'),\n      isVisible: m.get('visible'),\n      isAnimated: isAnimation,\n      isTorque: isTorque,\n      hasError: this._hasError(),\n      isCollapsed: this._isCollapsed(),\n      numberOfAnalyses: m.getNumberOfAnalyses(),\n      numberOfWidgets: this._widgetDefinitionsCollection.widgetsOwnedByLayer(m.id),\n      hasGeom: this._queryGeometryHasGeom()\n    }));\n\n    this._inlineEditor = new InlineEditorView({\n      template: templateInlineEditor,\n      renderOptions: {\n        title: m.getName()\n      },\n      onClick: self._onEditLayer.bind(self),\n      onEdit: self._renameLayer.bind(self)\n    });\n    this.addView(this._inlineEditor);\n\n    this.$('.js-thumbnail').append(geometryTemplate({\n      letter: m.get('letter')\n    }));\n    this.$('.js-header').append(this._inlineEditor.render().el);\n\n    this.$el.toggleClass('is-unavailable', m.isNew());\n    this.$el.toggleClass('js-sortable-item', !isTorque);\n    this.$el.toggleClass('is-animated', isTorque);\n    this.$('.js-thumbnail').toggleClass('is-hidden', this._isHidden());\n    this.$('.js-title').toggleClass('is-hidden', this._isHidden());\n    this.$('.js-analyses-widgets-info').toggleClass('is-hidden', this._isHidden());\n\n    if (isTorque) {\n      var torqueTooltip = new TipsyTooltipView({\n        el: this.$('.js-torqueIcon'),\n        gravity: 's',\n        offset: 0,\n        title: function () {\n          return $(this).data('tooltip');\n        }\n      });\n      this.addView(torqueTooltip);\n    }\n\n    if (!this._queryGeometryHasGeom()) {\n      var georeferenceTooltip = new TipsyTooltipView({\n        el: this.$('.js-georeferenceIcon'),\n        gravity: 's',\n        offset: 0,\n        title: function () {\n          return $(this).data('tooltip');\n        }\n      });\n      this.addView(georeferenceTooltip);\n    }\n\n    this._toggleClickEventsOnCapturePhase('remove'); // remove any if rendered previously\n    if (m.isNew()) {\n      this._toggleClickEventsOnCapturePhase('add');\n    }\n\n    if (m.get('source')) {\n      var analysesView = this._newAnalysesView(this.$('.js-analyses'), m);\n      this.addView(analysesView);\n      analysesView.render();\n    }\n\n    if (this._hasError()) {\n      var errorTooltip = new TipsyTooltipView({\n        el: this.$('.js-error'),\n        gravity: 's',\n        offset: 0,\n        title: function () {\n          return this.model.get('error') && this.model.get('error').message;\n        }.bind(this)\n      });\n      this.addView(errorTooltip);\n    }\n\n    return this;\n  },\n\n  _bindEvents: function () {\n    this.listenTo(this.model, 'change', this.render);\n    this.listenToOnce(this.model, 'destroy', this._onDestroy);\n    this.listenTo(this.model, 'change:collapsed', this.render);\n    this.listenTo(this._queryGeometryModel, 'change:simple_geom', this.render);\n  },\n\n  _getGeometryTemplate: function (geometry) {\n    switch (geometry) {\n      case 'line':\n        return geometryLinesTemplate;\n      case 'point':\n        return geometryPointsTemplate;\n      case 'polygon':\n        return geometryPolygonsTemplate;\n      default:\n        return geometryNoneTemplate;\n    }\n  },\n\n  _isHidden: function () {\n    return !this.model.get('visible');\n  },\n\n  _hasError: function () {\n    return !!this.model.get('error');\n  },\n\n  _isCollapsed: function () {\n    return !!this.model.get('collapsed');\n  },\n\n  _onClickTitle: function (event) {\n    // event is handled with inlineEditor\n    event.stopPropagation();\n  },\n\n  _onAnalysisNodeClicked: function (event) {\n    event.stopPropagation();\n\n    var nodeId = event.currentTarget && event.currentTarget.dataset.analysisNodeId;\n    if (!nodeId) throw new Error('missing data-analysis-node-id on element to edit analysis node, the element was: ' + event.currentTarget.outerHTML);\n\n    var nodeDefModel = this._analysisDefinitionNodesCollection.get(nodeId);\n    var layerDefModel = this._layerDefinitionsCollection.findOwnerOfAnalysisNode(nodeDefModel);\n    if (!layerDefModel) throw new Error('no owning layer found for node ' + nodeId);\n\n    this._stackLayoutModel.nextStep(layerDefModel, 'layer-content', 'analyses', nodeId);\n  },\n\n  _onClickSource: function (event) {\n    event.stopPropagation();\n\n    this._stackLayoutModel.nextStep(this.model, 'layer-content');\n  },\n\n  _onEditLayer: function (event) {\n    event && event.stopPropagation();\n\n    this._stackLayoutModel.nextStep(this.model, 'layer-content', 'style');\n  },\n\n  _onToggleCollapsedLayer: function () {\n    this.model.toggleCollapse();\n  },\n\n  _onToggleLayerClicked: function (event) {\n    event.stopPropagation();\n\n    var savingOptions = {\n      shouldPreserveAutoStyle: true\n    };\n\n    this.model.toggleVisible();\n    this._userActions.saveLayer(this.model, savingOptions);\n  },\n\n  _onToggleContextMenuClicked: function (event) {\n    event.stopPropagation();\n\n    if (this._hasContextMenu()) {\n      this._hideContextMenu();\n    } else {\n      this._showContextMenu({\n        x: event.pageX,\n        y: event.pageY\n      });\n    }\n  },\n\n  _hasContextMenu: function () {\n    return this._menuView;\n  },\n\n  _hideContextMenu: function () {\n    this.removeView(this._menuView);\n    this._menuView.clean();\n    delete this._menuView;\n  },\n\n  _showContextMenu: function (position) {\n    var menuItems = new CustomListCollection([{\n      label: this._isCollapsed() ? _t('editor.layers.options.expand') : _t('editor.layers.options.collapse'),\n      val: 'collapse-expand-layer'\n    }, {\n      label: _t('editor.layers.options.rename'),\n      val: 'rename-layer'\n    }, {\n      label: _t('editor.layers.options.export'),\n      val: 'export-data'\n    }, {\n      label: _t('editor.layers.options.edit'),\n      val: 'edit-layer'\n    }]);\n    if (this._queryGeometryHasGeom()) {\n      menuItems.add({\n        label: _t('editor.layers.options.center-map'),\n        val: 'center-map'\n      });\n    }\n    if (this.model.canBeDeletedByUser()) {\n      menuItems.add({\n        label: _t('editor.layers.options.delete'),\n        val: 'delete-layer',\n        destructive: true\n      });\n    }\n\n    var triggerElementID = 'context-menu-trigger-' + this.model.cid;\n    this.$('.js-toggle-menu').attr('id', triggerElementID);\n    this._menuView = new ContextMenuView({\n      collection: menuItems,\n      triggerElementID: triggerElementID,\n      position: position\n    });\n\n    menuItems.bind('change:selected', function (menuItem) {\n      var selectedItem = menuItem.get('val');\n      if (selectedItem === 'delete-layer') {\n        this._confirmDeleteLayer();\n      }\n      if (selectedItem === 'collapse-expand-layer') {\n        this._onToggleCollapsedLayer();\n      }\n      if (selectedItem === 'rename-layer') {\n        this._inlineEditor.edit();\n      }\n      if (selectedItem === 'export-data') {\n        this._exportLayer();\n      }\n      if (selectedItem === 'edit-layer') {\n        this._onEditLayer();\n      }\n      if (selectedItem === 'center-map') {\n        this._centerMap();\n      }\n    }, this);\n\n    this._menuView.model.bind('change:visible', function (model, isContextMenuVisible) {\n      if (this._hasContextMenu() && !isContextMenuVisible) {\n        this._hideContextMenu();\n      }\n    }, this);\n\n    this._menuView.show();\n    this.addView(this._menuView);\n  },\n\n  _exportLayer: function () {\n    var nodeDefModel = this.model.getAnalysisDefinitionNodeModel();\n    var queryGeometryModel = nodeDefModel.queryGeometryModel;\n\n    this._modals.create(function (modalModel) {\n      return new ModalExportDataView({\n        modalModel: modalModel,\n        queryGeometryModel: queryGeometryModel,\n        configModel: this._configModel,\n        fileName: this.model.getName()\n      });\n    }.bind(this));\n  },\n\n  _confirmDeleteLayer: function () {\n    this._modals.create(function (modalModel) {\n      var deleteLayerConfirmationView = new DeleteLayerConfirmationView({\n        userActions: this._userActions,\n        modals: this._modals,\n        layerModel: this.model,\n        modalModel: modalModel,\n        visDefinitionModel: this._visDefinitionModel,\n        widgetDefinitionsCollection: this._widgetDefinitionsCollection\n      });\n\n      return deleteLayerConfirmationView;\n    }.bind(this));\n  },\n\n  _renameLayer: function () {\n    var newName = this._inlineEditor.getValue();\n\n    if (newName !== '') {\n      // Optimistic\n      this._onSaveSuccess(newName);\n\n      renameLayer({\n        newName: newName,\n        userActions: this._userActions,\n        layerDefinitionsCollection: this._layerDefinitionsCollection,\n        layerDefinitionModel: this.model,\n        onError: this._onSaveError.bind(this)\n      });\n    }\n  },\n\n  _onSaveSuccess: function (newName) {\n    this.$('.js-title').text(newName).show();\n    this._inlineEditor.hide();\n  },\n\n  _onSaveError: function (oldName) {\n    this.$('.js-title').text(oldName).show();\n    this._inlineEditor.hide();\n  },\n\n  _onDestroy: function () {\n    this.clean();\n  },\n\n  _disableEventsOnCapturePhase: function (evt) {\n    evt.stopPropagation();\n    evt.preventDefault();\n  },\n\n  _toggleClickEventsOnCapturePhase: function (str) {\n    var addOrRemove = str === 'add'\n      ? 'add'\n      : 'remove';\n    this.el[addOrRemove + 'EventListener']('click', this._disableEventsOnCapturePhase, true);\n  },\n\n  _centerMap: function () {\n    var nodeModel = this.model.getAnalysisDefinitionNodeModel();\n    var query = nodeModel.querySchemaModel.get('query');\n    zoomToData(this._configModel, this._stateDefinitionModel, query);\n  },\n\n  _queryGeometryHasGeom: function () {\n    return !!this._queryGeometryModel.hasValue();\n  },\n\n  clean: function () {\n    this._toggleClickEventsOnCapturePhase('remove');\n    CoreView.prototype.clean.apply(this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='';\n if (hasError) { \n__p+='\\n  <div class=\"Editor-ListLayer-itemError js-error\"></div>\\n';\n } \n__p+='\\n\\n';\n if (!isTorque) { \n__p+='\\n  <div class=\"Editor-ListLayer-dragIcon\">\\n    <div class=\"CDB-Shape\">\\n      <div class=\"CDB-Shape-rectsHandle is-small\">\\n        <div class=\"CDB-Shape-rectsHandleItem CDB-Shape-rectsHandleItem--grey is-first\"></div>\\n        <div class=\"CDB-Shape-rectsHandleItem CDB-Shape-rectsHandleItem--grey is-second\"></div>\\n        <div class=\"CDB-Shape-rectsHandleItem CDB-Shape-rectsHandleItem--grey is-third\"></div>\\n      </div>\\n    </div>\\n  </div>\\n';\n } \n__p+='\\n<div class=\"Editor-ListLayer-itemHeader\">\\n  <div class=\"Editor-ListLayer-media u-rSpace--m js-thumbnail\" style=\"background: '+\n((__t=( color ))==null?'':_.escape(__t))+\n'; color: #fff\">\\n  </div>\\n  <div class=\"Editor-ListLayer-inner\">\\n    <div class=\"Editor-ListLayer-title\">\\n      <div class=\"Editor-ListLayer-titleText js-Editor-ListLayer-titleText js-header\"></div>\\n      <ul class=\"Editor-HeaderInfo-actions\">\\n        ';\n if (isTorque) { \n__p+='\\n          <li class=\"Editor-HeaderInfo-actionsItem u-rSpace\">\\n            ';\n if (isAnimated) { \n__p+='\\n              <svg class=\"js-torqueIcon\" width=\"19px\" height=\"8px\" viewBox=\"222 24 19 8\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" data-tooltip=\"'+\n((__t=( _t('editor.layers.layer.animated') ))==null?'':_.escape(__t))+\n'\">\\n                <g id=\"Animated-Icon\" opacity=\"0.6\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(222.000000, 24.000000)\">\\n                  <rect id=\"Rectangle-649\" fill=\"#2E3C43\" x=\"11\" y=\"0\" width=\"8\" height=\"8\" rx=\"4\"></rect>\\n                  <rect id=\"Rectangle-649\" fill=\"#2E3C43\" opacity=\"0.5\" x=\"5\" y=\"0\" width=\"8\" height=\"8\" rx=\"4\"></rect>\\n                  <rect id=\"Rectangle-649\" fill=\"#2E3C43\" opacity=\"0.2\" x=\"0\" y=\"0\" width=\"8\" height=\"8\" rx=\"4\"></rect>\\n                </g>\\n              </svg>\\n            ';\n } else { \n__p+='\\n              <svg class=\"js-torqueIcon\" width=\"31px\" height=\"17px\" viewBox=\"563 512 31 17\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" data-tooltip=\"'+\n((__t=( _t('editor.layers.layer.heatmap') ))==null?'':_.escape(__t))+\n'\">\\n                <g id=\"Group\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(563.000000, 512.000000)\">\\n                  <ellipse id=\"Oval-120\" fill=\"#E6E8E8\" transform=\"translate(27.020000, 12.197917) rotate(-90.000000) translate(-27.020000, -12.197917) \" cx=\"27.02\" cy=\"12.1979167\" rx=\"3.875\" ry=\"3.84\"></ellipse>\\n                  <path d=\"M26.93,13.0729167 C27.3442136,13.0729167 27.68,12.7371302 27.68,12.3229167 C27.68,11.9087031 27.3442136,11.5729167 26.93,11.5729167 C26.5157864,11.5729167 26.18,11.9087031 26.18,12.3229167 C26.18,12.7371302 26.5157864,13.0729167 26.93,13.0729167 Z\" id=\"Oval-120-Copy-2\" fill=\"#828A8F\" opacity=\"0.8\" transform=\"translate(26.930000, 12.322917) rotate(-90.000000) translate(-26.930000, -12.322917) \"></path>\\n                  <ellipse id=\"Oval-120\" fill=\"#E6E8E8\" transform=\"translate(8.140000, 8.000000) rotate(-90.000000) translate(-8.140000, -8.000000) \" cx=\"8.14\" cy=\"8\" rx=\"7.75\" ry=\"7.68\"></ellipse>\\n                  <path d=\"M7.96,10.75 C9.34071187,10.75 10.46,9.63071187 10.46,8.25 C10.46,6.86928813 9.34071187,5.75 7.96,5.75 C6.57928813,5.75 5.46,6.86928813 5.46,8.25 C5.46,9.63071187 6.57928813,10.75 7.96,10.75 Z\" id=\"Oval-120-Copy-2\" fill=\"#828A8F\" transform=\"translate(7.960000, 8.250000) rotate(-90.000000) translate(-7.960000, -8.250000) \"></path>\\n                  <path d=\"M15.1403347,6.71285923 C15.4606435,9.05621552 17.487459,10.8625 19.94,10.8625 C22.6151293,10.8625 24.78375,8.7134668 24.78375,6.0625 C24.78375,3.4115332 22.6151293,1.2625 19.94,1.2625 C17.2648707,1.2625 15.09625,3.4115332 15.09625,6.0625 C15.09625,6.28307774 15.1112641,6.50018043 15.1403347,6.71285923 Z\" id=\"Oval-120\" fill=\"#E6E8E8\" transform=\"translate(19.940000, 6.062500) rotate(-90.000000) translate(-19.940000, -6.062500) \"></path>\\n                  <path d=\"M20.64,7.90625 C21.4684271,7.90625 22.14,7.23467712 22.14,6.40625 C22.14,5.57782288 21.4684271,4.90625 20.64,4.90625 C19.8115729,4.90625 19.14,5.57782288 19.14,6.40625 C19.14,7.23467712 19.8115729,7.90625 20.64,7.90625 Z\" id=\"Oval-120-Copy-2\" fill=\"#828A8F\" opacity=\"0.8\" transform=\"translate(20.640000, 6.406250) rotate(-90.000000) translate(-20.640000, -6.406250) \"></path>\\n                  <path d=\"M13.5625,2.88 C13.5625,2.88 16.1458333,5.12 18.0833333,2.56 C17.4375,4.16 17.1145833,5.44 17.1145833,5.44 L16.46875,6.72 L14.2083333,4.8 L13.5625,2.88 Z\" id=\"Path-494\" fill=\"#E6E8E8\"></path>\\n                  <path d=\"M22.3894032,6.40571996 C22.3894032,6.40571996 24.9727365,8.64571996 26.9102365,6.08571996 C26.2644032,7.68571996 25.9414865,8.96571996 25.9414865,8.96571996 L25.2956532,10.24572 L23.0352365,8.32571996 L22.3894032,6.40571996 Z\" id=\"Path-494\" fill=\"#E6E8E8\" transform=\"translate(24.649820, 8.165720) rotate(52.000000) translate(-24.649820, -8.165720) \"></path>\\n                  <path d=\"M20.6462245,8.51753488 C20.6462245,8.51753488 23.9604656,11.3038091 25.8979656,8.74380905 C25.2521323,10.3438091 25.078218,11.598674 25.078218,11.598674 L24.4323847,12.878674 L21.1028976,9.87517984 L20.6462245,8.51753488 Z\" id=\"Path-494\" fill=\"#E6E8E8\" transform=\"translate(23.272095, 10.698104) rotate(-135.000000) translate(-23.272095, -10.698104) \"></path>\\n                  <path d=\"M18.2927779,9.85808612 C18.2927779,9.85808612 15.6067281,8.91370489 14.3461002,11.8663856 C14.5856745,10.1576712 14.5893391,8.83757209 14.5893391,8.83757209 L14.4253034,7.30493626 L14.7514729,5.70339822 L18.2927779,9.85808612\" id=\"Path-494\" fill=\"#E6E8E8\"></path>\\n                  <path d=\"\" id=\"Path-499\" stroke=\"#979797\" stroke-width=\"0.64\"></path>\\n                  <polygon id=\"Path-500\" fill=\"#828A8F\" points=\"9.94618849 9.56 11.6875 7.72609277 9.6875 6.56\"></polygon>\\n                </g>\\n              </svg>\\n            ';\n } \n__p+='\\n          </li>\\n        ';\n } \n__p+='\\n        <li class=\"Editor-HeaderInfo-actionsItem CDB-Shape\">\\n          ';\n if (!hasGeom) { \n__p+='\\n            <svg class=\"js-georeferenceIcon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"12\" viewBox=\"0 0 14 12\" data-tooltip=\"'+\n((__t=( _t('editor.layers.georeference.visualize') ))==null?'':_.escape(__t))+\n'\"><path fill=\"#FFB300\" fill-rule=\"evenodd\" d=\"M5.012 1.48C6.11-.444 7.887-.45 8.988 1.48l4.526 7.92c.82 1.436.15 2.6-1.523 2.6H2.01C.346 12-.333 10.83.485 9.4l4.526-7.92zM1.354 9.895C.917 10.66 1.116 11 2.01 11h9.98c.903 0 1.097-.333.656-1.104L8.12 1.976C7.404.72 6.596.722 5.88 1.975l-4.526 7.92zM6 9h2v1H6V9zm0-5h2v4H6V4z\"/></svg>\\n          ';\n } else { \n__p+='\\n            <button class=\"js-toggle\">\\n              ';\n if (isVisible) { \n__p+='\\n                <i class=\"CDB-IconFont CDB-IconFont-view u-actionTextColor\"></i>\\n              ';\n } else { \n__p+='\\n                <i class=\"CDB-IconFont CDB-IconFont-hide u-actionTextColor\"></i>\\n              ';\n } \n__p+='\\n            </button>\\n          ';\n } \n__p+='\\n        </li>\\n        <li class=\"Editor-HeaderInfo-actionsItem CDB-Shape\">\\n          <button class=\"CDB-Shape-threePoints is-blue is-small js-toggle-menu\">\\n            <div class=\"CDB-Shape-threePointsItem\"></div>\\n            <div class=\"CDB-Shape-threePointsItem\"></div>\\n            <div class=\"CDB-Shape-threePointsItem\"></div>\\n          </button>\\n        </li>\\n      </ul>\\n    </div>\\n    <div class=\"u-flex Editor-ListLayer-info js-analyses-widgets-info\">\\n      <span class=\"CDB-Text CDB-Size-small u-secondaryTextColor u-upperCase u-rSpace--m\">\\n        '+\n((__t=( _t('editor.layers.layer.analyses-count', { smart_count: numberOfAnalyses }) ))==null?'':_.escape(__t))+\n'\\n      </span>\\n      <span class=\"CDB-Text CDB-Size-small u-secondaryTextColor u-upperCase\">\\n        '+\n((__t=( _t('editor.layers.layer.widgets-count', { smart_count: numberOfWidgets }) ))==null?'':_.escape(__t))+\n'\\n      </span>\\n    </div>\\n  </div>\\n</div>\\n<ul class=\"Editor-ListAnalysis js-analyses '+\n((__t=( isVisible ? '' : 'is-hidden' ))==null?'':_.escape(__t))+\n'  '+\n((__t=( isCollapsed ? 'is-collapsed' : '' ))==null?'':_.escape(__t))+\n'\"></ul>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text CDB-Size-large is-semibold u-upperCase\">'+\n((__t=( letter ))==null?'':_.escape(__t))+\n' <svg width=\"12px\" height=\"12px\" viewBox=\"0 0 12 12\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n  <path d=\"M8.30379432,3.06016671 C8.11128812,2.75281724 8,2.38940498 8,2 C8,0.8954305 8.8954305,0 10,0 C11.1045695,0 12,0.8954305 12,2 C12,3.1045695 11.1045695,4 10,4 C9.70653076,4 9.42782451,3.93679216 9.17675238,3.82324762 L3.82324762,9.17675238 C3.93679216,9.42782451 4,9.70653076 4,10 C4,11.1045695 3.1045695,12 2,12 C0.8954305,12 0,11.1045695 0,10 C0,8.8954305 0.8954305,8 2,8 C2.38940498,8 2.75281724,8.11128812 3.06016671,8.30379432 L8.30379432,3.06016671 Z\" stroke=\"none\" fill=\"#FFFFFF\" fill-rule=\"evenodd\"></path>\\n</svg></p>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text CDB-Size-large is-semibold u-upperCase\">'+\n((__t=( letter ))==null?'':_.escape(__t))+\n'</p>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text CDB-Size-large is-semibold u-upperCase\">'+\n((__t=( letter ))==null?'':_.escape(__t))+\n' <svg width=\"12px\" height=\"12px\" viewBox=\"589 382 12 12\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n  <g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(589.000000, 382.000000)\">\\n    <circle fill=\"#FFFFFF\" cx=\"2\" cy=\"2\" r=\"2\"></circle>\\n    <circle fill=\"#FFFFFF\" cx=\"2\" cy=\"10\" r=\"2\"></circle>\\n    <circle fill=\"#FFFFFF\" cx=\"10\" cy=\"10\" r=\"2\"></circle>\\n  </g>\\n</svg></p>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<p class=\"CDB-Text CDB-Size-large is-semibold u-upperCase\">'+\n((__t=( letter ))==null?'':_.escape(__t))+\n' <svg width=\"12px\" height=\"12px\" viewBox=\"589 382 12 12\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n  <g stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(589.000000, 382.000000)\">\\n    <path d=\"M1,2 L1,2 L2,1 L2,11 L1,10 L11,10 L10,11 L10,1 L11,2 L1,2 Z M1,1 L11,1 L11,11 L1,11 L1,1 L1,1 Z\" id=\"Rectangle-2\" fill=\"#FFFFFF\"></path>\\n    <circle fill=\"#FFFFFF\" cx=\"2\" cy=\"2\" r=\"2\"></circle>\\n    <circle fill=\"#FFFFFF\" cx=\"10\" cy=\"2\" r=\"2\"></circle>\\n    <circle fill=\"#FFFFFF\" cx=\"2\" cy=\"10\" r=\"2\"></circle>\\n    <circle fill=\"#FFFFFF\" cx=\"10\" cy=\"10\" r=\"2\"></circle>\\n  </g>\\n</svg></p>';\n}\nreturn __p;\n};\n",
    "var BaseLayerViewBase = require('./base-layer-view-base');\nvar template = require('./image-thumbnail-layer.tpl');\n\nmodule.exports = BaseLayerViewBase.extend({\n  initialize: function (opts) {\n    BaseLayerViewBase.prototype.initialize.apply(this, arguments);\n\n    if (!opts.configModel) throw new Error('configModel is required');\n\n    this._configModel = opts.configModel;\n  },\n\n  _getCompiledTemplate: function () {\n    return template({\n      title: this._getTitle(),\n      desc: _t('editor.layers.gmaps.title-label'),\n      imgURL: this._getImageURL()\n    });\n  },\n\n  _getImageURL: function () {\n    var imageName = this.model.get('baseType');\n    if (this.model.get('baseName')) {\n      imageName = imageName + '_' + this.model.get('baseName');\n    }\n    var imageURL = [\n      this._configModel.get('app_assets_base_url'),\n      'unversioned/images/google-maps-basemap-icons',\n      imageName + '.jpg'\n    ].join('/');\n    return imageURL;\n  },\n\n  _getTitle: function () {\n    return this.model.get('name').replace('GMaps ', '');\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"BlockList-media u-rSpace--xl js-thumbnail\">\\n  <img src=\"'+\n((__t=( imgURL ))==null?'':_.escape(__t))+\n'\" class=\"BlockList-mediaImg js-thumbnailImg\" />\\n</div>\\n<div class=\"BlockList-inner\">\\n  <div class=\"BlockList-title u-bSpace\">\\n    <h2 class=\"BlockList-titleText CDB-Text CDB-Size-large u-ellipsis js-title\">'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</h2>\\n  </div>\\n  <p class=\"CDB-Text CDB-Size-medium u-secondaryTextColor\">'+\n((__t=( desc ))==null?'':_.escape(__t))+\n'</p>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<h2 class=\"Inline-editor\">\\n  <div class=\"CDB-Text CDB-Size-large u-ellipsis js-title Inline-editor-text\">'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</div>\\n  <input type=\"text\" name=\"text\" class=\"Inline-editor-input Inline-editor-input--small CDB-Text CDB-InputText js-input\" value=\"'+\n((__t=( title ))==null?'':_.escape(__t))+\n'\" readonly>\\n</h2>';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./image-thumbnail-layer.tpl');\n\nmodule.exports = CoreView.extend({\n\n  tagName: 'li',\n\n  className: 'BlockList-item BlockList-item--noAction js-layer ui-state-disabled',\n\n  initialize: function (opts) {\n    this.listenTo(this.model, 'change', this.render);\n  },\n\n  render: function () {\n    var desc = _t('editor.layers.labels.title-label');\n    var title = this.model.getName() || desc;\n\n    this.$el.html(template({\n      title: title,\n      desc: title === desc ? '' : desc,\n      imgURL: this._getImageURL()\n    }));\n\n    return this;\n  },\n\n  _getImageURL: function () {\n    return this.model.get('urlTemplate')\n      .replace('{s}', 'a')\n      .replace('{z}', 6)\n      .replace('{x}', 30)\n      .replace('{y}', 24);\n  }\n});\n\n",
    "var BaseLayerViewBase = require('./base-layer-view-base');\nvar template = require('./plain-color-layer.tpl');\n\nmodule.exports = BaseLayerViewBase.extend({\n  _getCompiledTemplate: function () {\n    var desc = _t('editor.layers.color.title-label');\n    var title = this.model.get('color') || desc;\n\n    return template({\n      title: title,\n      desc: title === desc ? '' : desc,\n      color: this.model.get('color')\n    });\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"BlockList-media u-rSpace--xl js-thumbnail\" style=\"background-color: '+\n((__t=( color ))==null?'':_.escape(__t))+\n'\">\\n</div>\\n<div class=\"BlockList-inner\">\\n  <div class=\"BlockList-title u-bSpace\">\\n    <h2 class=\"BlockList-titleText CDB-Text CDB-Size-large u-ellipsis js-title\">'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</h2>\\n  </div>\\n  <p class=\"CDB-Text CDB-Size-medium u-secondaryTextColor\">'+\n((__t=( desc ))==null?'':_.escape(__t))+\n'</p>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "require('jquery-ui');\nvar _ = require('underscore');\nvar $ = require('jquery');\nvar CoreView = require('backbone/core-view');\nvar Notifier = require('../../components/notifier/notifier');\nvar template = require('./layers.tpl');\nvar LayerViewFactory = require('./layer-view-factory');\nvar checkAndBuildOpts = require('../../helpers/required-opts');\n\nvar SORTABLE_SELECTOR = '.js-layers';\nvar SORTABLE_ITEMS_SELECTOR = '.js-layer.js-sortable-item';\n\nvar REQUIRED_OPTS = [\n  'stackLayoutModel',\n  'analysisDefinitionNodesCollection',\n  'layerDefinitionsCollection',\n  'modals',\n  'userModel',\n  'configModel',\n  'editorModel',\n  'userActions',\n  'stateDefinitionModel',\n  'visDefinitionModel',\n  'widgetDefinitionsCollection'\n];\n\n/**\n * View to render layer definitions list\n */\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    this._layerViewFactory = new LayerViewFactory({\n      stackLayoutModel: this._stackLayoutModel,\n      userActions: this._userActions,\n      layerDefinitionsCollection: this._layerDefinitionsCollection,\n      analysisDefinitionNodesCollection: opts.analysisDefinitionNodesCollection,\n      modals: opts.modals,\n      configModel: opts.configModel,\n      sortableSelector: SORTABLE_SELECTOR,\n      stateDefinitionModel: this._stateDefinitionModel,\n      visDefinitionModel: this._visDefinitionModel,\n      widgetDefinitionsCollection: this._widgetDefinitionsCollection\n    });\n\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this.listenTo(this._layerDefinitionsCollection, 'add remove change:id', this.render);\n    this.listenTo(this._layerDefinitionsCollection, 'add', this._createNotification);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template);\n\n    _.each(this._layerDefinitionsCollection.toArray().reverse(), this._addLayerView, this);\n    this._initSortable();\n\n    return this;\n  },\n\n  _createNotification: function (m) {\n    Notifier.addNotification({\n      status: 'success',\n      info: _t('notifications.layer.added', {\n        name: m.getName()\n      }),\n      closable: true,\n      delay: Notifier.DEFAULT_DELAY\n    });\n  },\n\n  _addLayerView: function (m) {\n    var view = this._layerViewFactory.createLayerView(m);\n    view.$el.data('layerId', m.id);\n    this.addView(view);\n    this.$(SORTABLE_SELECTOR).append(view.render().el);\n  },\n\n  _initSortable: function () {\n    this.$(SORTABLE_SELECTOR).sortable({\n      axis: 'y',\n      items: SORTABLE_ITEMS_SELECTOR,\n      placeholder: 'Editor-ListLayer-item Editor-ListLayer-item--placeholder',\n      containment: SORTABLE_SELECTOR,\n      forceHelperSize: true,\n      forcePlaceholderSize: true,\n      start: this._preventPlaceholderAfterBasemap.bind(this),\n      beforeStop: this._dontAllowToMoveItemAfterBasemap.bind(this),\n      update: this._onSortableUpdate.bind(this)\n    });\n  },\n\n  _preventPlaceholderAfterBasemap: function (evt, ui) {\n    var $placeholder = $(ui.placeholder);\n    if ($placeholder.is(':last-child')) {\n      $placeholder.remove();\n      return;\n    }\n  },\n\n  _dontAllowToMoveItemAfterBasemap: function (evt, ui) {\n    this._stopUpdate = $(ui.placeholder).is(':last-child');\n  },\n\n  _onSortableUpdate: function (event, ui) {\n    if (this._stopUpdate) {\n      this.$(SORTABLE_SELECTOR).sortable('cancel');\n      this._stopUpdate = false;\n      return;\n    }\n\n    var $draggedLayerElement = ui.item;\n    var numberOfLayers = $draggedLayerElement.parent().children('.js-layer').length;\n    var newPosition = numberOfLayers - $draggedLayerElement.index();\n\n    var layerId = $draggedLayerElement.data('layerId');\n    if (layerId) {\n      var layerDefinitionModel = this._layerDefinitionsCollection.get(layerId);\n      this._userActions.moveLayer({\n        from: layerDefinitionModel.get('order'),\n        to: newPosition - 1 // -1 to compensate for the move of dragged-element\n      });\n      return;\n    }\n\n    var analysisNodeId = $draggedLayerElement.data('analysis-node-id');\n    if (analysisNodeId) {\n      try {\n        this._userActions.createLayerForAnalysisNode(analysisNodeId, {at: newPosition});\n      } catch (err) {\n        if (/max/.test(err.message)) {\n          $draggedLayerElement.remove();\n          Notifier.addNotification({\n            status: 'warning',\n            info: _t('editor.layers.drag-n-drop-analysis.upgrade-max-layers-err', {\n              a_start: '<a href=\"https://carto.com/pricing/\">',\n              a_end: '</a>',\n              userMaxLayers: err.userMaxLayers\n            }),\n            closable: true,\n            delay: Notifier.DEFAULT_DELAY\n          });\n        } else {\n          throw err; // unknown err, let it bubble up\n        }\n      }\n    }\n  },\n\n  _destroySortable: function () {\n    if (this.$(SORTABLE_SELECTOR).data('ui-sortable')) {\n      this.$(SORTABLE_SELECTOR).sortable('destroy');\n    }\n  },\n\n  clean: function () {\n    this._destroySortable();\n    CoreView.prototype.clean.apply(this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<ul class=\"Editor-ListLayer js-layers\"></ul>\\n<div class=\"Editor-dropArea js-drop\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar Messages = require('./notification-error-messages.json');\nvar Utils = require('../../../../javascripts/cartodb3/helpers/utils');\n\nvar CONTACT_LINK_TEMPLATE;\nvar SAMPLE_LINK_TEMPLATE;\n\nvar getBodyAttributes = function (errorType, layerDefModel) {\n  var bodyAttrs = {};\n  if (errorType === 'timeout') {\n    // if layerDefModel is defined, hen use html code\n    // this happens for notification, but not for tooltip errors where we don't want html\n    if (layerDefModel != null) {\n      CONTACT_LINK_TEMPLATE = _.template(\"<a href='mailto:<%- mail %>'><%- contact %></a>\")({\n        contact: _t('notifications.analysis.contact.label'),\n        mail: _t('notifications.analysis.contact.mail')\n      });\n\n      SAMPLE_LINK_TEMPLATE = _.template(\"<button class='js-add-analysis u-actionTextColor' data-layer-id='<%- layerId %>'><%- sample %></button>\")({\n        sample: _t('notifications.analysis.sample'),\n        layerId: layerDefModel && layerDefModel.get('id') || ''\n      });\n    } else {\n      CONTACT_LINK_TEMPLATE = _t('notifications.analysis.contact.label');\n      SAMPLE_LINK_TEMPLATE = _t('notifications.analysis.sample');\n    }\n\n    bodyAttrs = {\n      sample: SAMPLE_LINK_TEMPLATE,\n      contact: CONTACT_LINK_TEMPLATE\n    };\n  }\n\n  return bodyAttrs;\n};\n\nmodule.exports = {\n  extractErrorFromAnalysisNode: function (analysisNode, layerDefModel) {\n    var errorType = 'error';\n    var message = _t('notifications.analysis.failed', {\n      nodeId: analysisNode.get('id').toUpperCase()\n    });\n\n    var error = analysisNode.get('error');\n\n    if ((error && error.message) || analysisNode.get('error_message')) {\n      var errorMessage = (error && error.message) || analysisNode.get('error_message');\n      var extractedError = this.extractError(errorMessage, layerDefModel);\n      message += ': ' + extractedError.message;\n      errorType = extractedError.type;\n    }\n\n    return { message: message, type: errorType };\n  },\n\n  extractError: function (errorMessage, layerDefModel) {\n    var errorType;\n    var matched = false;\n    var message;\n    var i = 0;\n\n    while (!matched && i < Messages.messages.length) {\n      var m = Messages.messages[i];\n      var errorMessageType = m.replaceWith;\n      var regExp = new RegExp(m.match);\n      var match = errorMessage.match(regExp);\n      var body;\n\n      errorMessage = Utils.removeNewLines(errorMessage);\n\n      if (match) {\n        if (errorMessageType) {\n          body = _t('notifications.analysis.errors.' + errorMessageType, getBodyAttributes(errorMessageType, layerDefModel));\n          message = errorMessage.replace(regExp, body);\n        } else {\n          message = match[1];\n        }\n        matched = true;\n        errorType = m.errorType;\n      }\n      i++;\n    }\n\n    return { message: message || errorMessage, type: errorType || 'error' };\n  }\n};\n",
    "module.exports={\n  \"messages\": [\n    {\n      \"match\": \"Exception: (.*)$\"\n    },\n    {\n      \"match\": \"REMOTE ERROR: .*Error: (.*?)$\"\n    },\n    {\n      \"match\": \"ERROR: transform: (couldn't project point .*?)in executeQuery\"\n    },\n    {\n      \"match\": \"RuntimeError: Execution of function interrupted by signal\",\n      \"replaceWith\": \"timeout\"\n    },\n    {\n      \"match\": \"canceling statement due to statement timeout.*\",\n      \"replaceWith\": \"timeout\"\n    },\n    {\n      \"match\": \"^.*?PQconnectPoll: FATAL: no pg_hba.conf entry for host.*\",\n      \"replaceWith\": \"connect-poll\"\n    },\n    {\n      \"match\": \"^.*?column \\\"the_geom_webmercator\\\" does not exist.*\",\n      \"replaceWith\": \"without-geom-webmercator\",\n      \"errorType\": \"warning\"\n    },\n    {\n      \"match\": \"ERROR: (column .*? does not exist)\"\n    }\n  ]\n}\n",
    "var Notifier = require('../../../components/notifier/notifier');\nvar errorParser = require('../../../helpers/error-parser');\n\nmodule.exports = function (opts) {\n  if (!opts.layerDefinitionModel) throw new Error('layerDefinitionModel is required');\n  if (!opts.userActions) throw new Error('userActions is required');\n\n  var layerDefinitionModel = opts.layerDefinitionModel;\n\n  var name = layerDefinitionModel.getName();\n  var notification = Notifier.addNotification({\n    status: 'loading',\n    info: _t('editor.layers.delete.loading', {name: name}),\n    closable: false\n  });\n\n  opts.userActions.deleteLayer(layerDefinitionModel.id)\n    .done(function () {\n      notification.set({\n        status: 'success',\n        info: _t('editor.layers.delete.success', {name: name}),\n        closable: true\n      });\n    })\n    .fail(function (e) {\n      notification.set({\n        status: 'error',\n        info: _t('editor.layers.delete.error', {name: name, error: errorParser(e)}),\n        closable: true\n      });\n    });\n};\n",
    "var Notifier = require('../../../components/notifier/notifier');\nvar errorParser = require('../../../helpers/error-parser');\n\nmodule.exports = function (opts) {\n  if (!opts.userActions) throw new Error('userActions is required');\n  if (!opts.layerDefinitionModel) throw new Error('layerDefinitionModel is required');\n  if (!opts.layerDefinitionsCollection) throw new Error('layerDefinitionsCollection is required');\n  if (!opts.newName) throw new Error('newName is required');\n\n  var layerDefinitionModel = opts.layerDefinitionModel;\n  var successCallback = opts.onSuccess;\n  var errorCallback = opts.onError;\n  var newName = opts.newName;\n  var oldName = layerDefinitionModel.getName();\n\n  var notification = Notifier.addNotification({\n    status: 'loading',\n    info: _t('editor.layers.rename.loading'),\n    closable: false\n  });\n\n  layerDefinitionModel.set('table_name_alias', newName);\n\n  opts.userActions.saveLayer(layerDefinitionModel)\n    .done(function () {\n      successCallback && successCallback(newName);\n      notification.set({\n        status: 'success',\n        info: _t('editor.layers.rename.success', {name: newName}),\n        closable: true\n      });\n    })\n    .fail(function (e) {\n      errorCallback && errorCallback(oldName);\n      notification.set({\n        status: 'error',\n        info: _t('editor.layers.rename.error', {name: oldName, error: errorParser(e)}),\n        closable: true\n      });\n    });\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"FormPlaceholder-paragraph u-tSpace-m u-flex\">\\n  <div class=\"FormPlaceholder-paragraphLoader\">\\n    <div class=\"CDB-Loader is-visible\"></div>\\n  </div>\\n</div>\\n\\n<div class=\"FormPlaceholder-paragraph u-tSpace-m u-flex\">\\n  <div class=\"FormPlaceholder-step u-rSpace--m\"></div>\\n  <div class=\"FormPlaceholder-inner\">\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med u-tSpace--m\"></span>\\n  </div>\\n</div>\\n<div class=\"FormPlaceholder-paragraph u-flex\">\\n  <div class=\"FormPlaceholder-step u-rSpace--m\"></div>\\n  <div class=\"FormPlaceholder-inner\">\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med u-tSpace--m\"></span>\\n    <span class=\"FormPlaceholder-label FormPlaceholder-size--short u-tSpace-xl\"></span>\\n    <ul class=\"FormPlaceholder-carousel u-flex FormPlaceholder-size--long\">\\n      <li class=\"FormPlaceholder-carouselItem\"></li>\\n      <li class=\"FormPlaceholder-carouselItem\"></li>\\n      <li class=\"FormPlaceholder-carouselItem\"></li>\\n    </ul>\\n  </div>\\n</div>\\n<div class=\"FormPlaceholder-paragraph u-flex\">\\n  <div class=\"FormPlaceholder-step u-rSpace--m\"></div>\\n  <div class=\"FormPlaceholder-inner\">\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--short u-tSpace--m\"></span>\\n    <span class=\"FormPlaceholder-label FormPlaceholder-size--med u-tSpace-xl\"></span>\\n    <ul class=\"FormPlaceholder-fields\">\\n      <li class=\"FormPlaceholder-fieldsItem u-flex u-justifySpace\">\\n        <span class=\"FormPlaceholder-label FormPlaceholder-size--short\"></span>\\n        <span class=\"FormPlaceholder-input FormPlaceholder-size--med\"></span>\\n      </li>\\n      <li class=\"FormPlaceholder-fieldsItem u-flex u-justifySpace\">\\n        <span class=\"FormPlaceholder-label FormPlaceholder-size--shorter\"></span>\\n        <span class=\"FormPlaceholder-input FormPlaceholder-size--med\"></span>\\n      </li>\\n    </ul>\\n  </div>\\n</div>\\n<div class=\"FormPlaceholder-paragraph u-flex\">\\n  <div class=\"FormPlaceholder-step u-rSpace--m\"></div>\\n  <div class=\"FormPlaceholder-inner\">\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--short u-tSpace--m\"></span>\\n    <span class=\"FormPlaceholder-label FormPlaceholder-size--med u-tSpace-xl\"></span>\\n    <ul class=\"FormPlaceholder-fields\">\\n      <li class=\"FormPlaceholder-fieldsItem u-flex u-justifySpace\">\\n        <span class=\"FormPlaceholder-label FormPlaceholder-size--short\"></span>\\n        <span class=\"FormPlaceholder-input FormPlaceholder-size--med\"></span>\\n      </li>\\n      <li class=\"FormPlaceholder-fieldsItem u-flex u-justifySpace\">\\n        <span class=\"FormPlaceholder-label FormPlaceholder-size--shorter\"></span>\\n        <span class=\"FormPlaceholder-input FormPlaceholder-size--med\"></span>\\n      </li>\\n      <li class=\"FormPlaceholder-fieldsItem u-flex u-justifySpace\">\\n        <span class=\"FormPlaceholder-label FormPlaceholder-size--shorter\"></span>\\n        <span class=\"FormPlaceholder-input FormPlaceholder-size--med\"></span>\\n      </li>\\n      <li class=\"FormPlaceholder-fieldsItem u-flex u-justifySpace\">\\n        <span class=\"FormPlaceholder-label FormPlaceholder-size--short\"></span>\\n        <span class=\"FormPlaceholder-input FormPlaceholder-size--med\"></span>\\n      </li>\\n      <li class=\"FormPlaceholder-fieldsItem u-flex u-justifySpace\">\\n        <span class=\"FormPlaceholder-label FormPlaceholder-size--short\"></span>\\n        <span class=\"FormPlaceholder-input FormPlaceholder-size--med\"></span>\\n      </li>\\n    </ul>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var STATES = {\n  ready: 'ready',\n  loading: 'loading',\n  fetched: 'fetched',\n  error: 'error'\n};\n\nmodule.exports = {\n  track: function (view, callback) {\n    if (view.modelView === undefined) throw new Error('modelView is required');\n    if (view._querySchemaModel === undefined) throw new Error('querySchemaModel is required');\n\n    this.modelView = view.modelView;\n    this.querySchemaModel = view._querySchemaModel;\n\n    this.querySchemaModel.on('change:query_errors change:status', this._setState, this);\n    view.add_related_model(this.querySchemaModel);\n\n    this.modelView.on('change:state', callback);\n    view.add_related_model(this.modelView);\n\n    if (this.querySchemaModel.shouldFetch() && !this._hasErrors()) {\n      this.querySchemaModel.fetch();\n    }\n\n    this._setState();\n  },\n\n  _setState: function () {\n    if (this._hasErrors()) {\n      this.modelView.set({state: STATES.error});\n    } else {\n      if (this.querySchemaModel.isFetched()) {\n        this.modelView.set({state: STATES.ready});\n      } else {\n        this.modelView.set({state: STATES.loading});\n      }\n    }\n  },\n\n  _hasErrors: function () {\n    var errors = this.querySchemaModel.get('query_errors');\n    return (errors && errors.length > 0);\n  }\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./share-button.tpl');\nvar _ = require('underscore');\n\nvar REQUIRED_OPTS = [\n  'onClickAction',\n  'visDefinitionModel'\n];\n\nmodule.exports = CoreView.extend({\n\n  events: {\n    'click .js-button': '_clickHandler'\n  },\n\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (!opts[item]) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(template({\n      hasChanges: this._visDefinitionModel.get('visChanges') > 0\n    }));\n    return this;\n  },\n\n  _initBinds: function () {\n    this._visDefinitionModel.on('change:visChanges', this.render, this);\n    this.add_related_model(this._visDefinitionModel);\n  },\n\n  _clickHandler: function () {\n    this._onClickAction && this._onClickAction();\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='';\n if (hasChanges) { \n__p+='\\n<span class=\"CDB-Text CDB-Size-small u-rSpace--m u-altTextColor\">'+\n((__t=( _t('editor.unpublished-changes') ))==null?'':_.escape(__t))+\n'</span>\\n';\n } \n__p+='\\n<button class=\"CDB-Button CDB-Button--primary js-button\">\\n  <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-small\">'+\n((__t=( _t('editor.button_share') ))==null?'':_.escape(__t))+\n'</span>\\n</button>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<button class=\\'CDB-Text u-actionTextColor js-fix-sql\\'>'+\n((__t=( label ))==null?'':_.escape(__t))+\n'</button>';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./sync-info.tpl');\nvar moment = require('moment');\nvar TipsyTooltipView = require('../../../components/tipsy-tooltip-view');\nvar SyncOptionsModalView = require('../../../components/modals/sync-options/sync-options-modal-view');\nvar checkAndBuildOpts = require('../../../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'modals',\n  'syncModel',\n  'tableModel',\n  'userModel'\n];\n\nmodule.exports = CoreView.extend({\n\n  className: 'SyncInfo SyncInfo--separator',\n\n  events: {\n    'click .js-options': '_openSyncOptions'\n  },\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n  },\n\n  render: function () {\n    var runAt = this._syncModel.get('run_at');\n\n    var d = {\n      canSyncNow: this._syncModel.canSyncNow(),\n      fromExternalSource: this._syncModel.get('from_external_source'),\n      ranAt: moment(this._syncModel.get('ran_at') || new Date()).fromNow(),\n      runAt: moment(runAt).fromNow(),\n      state: this._syncModel.get('state'),\n      errorCode: this._syncModel.get('error_code'),\n      errorMessage: this._syncModel.get('error_message'),\n      isOwner: this._tableModel.isOwner(this._userModel)\n    };\n\n    // Due to the time we need to polling, we have to display to the user\n    // that the sync will be in a moment\n    if (!runAt || (new Date(runAt) <= new Date())) {\n      d.runAt = _t('dataset.sync.in-a-moment');\n    }\n\n    this.$el.html(template(d));\n\n    if (d.errorCode || d.errorMessage) {\n      var tooltip = new TipsyTooltipView({\n        el: this.$('.js-tooltip'),\n        title: function () {\n          return _t('dataset.sync.error-code', { errorCode: d.errorCode }) + ':' + d.errorMessage;\n        }\n      });\n      this.addView(tooltip);\n    }\n\n    return this;\n  },\n\n  _openSyncOptions: function () {\n    var self = this;\n    this._modals.create(function (modalModel) {\n      return new SyncOptionsModalView({\n        syncModel: self._syncModel,\n        modalModel: modalModel,\n        tableName: self._tableModel.getUnquotedName()\n      });\n    });\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-alignCenter u-justifySpace\">\\n  <div class=\"u-flex u-alignCenter CDB-Text CDB-Size-small u-altTextColor SyncInfo-message--'+\n((__t=( state ))==null?'':_.escape(__t))+\n' js-state\">\\n    <i class=\"CDB-IconFont CDB-IconFont-wifi\"></i>\\n    <p class=\"u-upperCase is-semibold u-lSpace\">\\n      ';\n if (errorCode || errorMessage) { \n__p+='\\n        '+\n((__t=( _t('dataset.sync.sync-failed') ))==null?'':_.escape(__t))+\n'\\n      ';\n } else { \n__p+='\\n        '+\n((__t=( ranAt ))==null?'':_.escape(__t))+\n'\\n      ';\n } \n__p+='\\n    </p>\\n  </div>\\n  ';\n if (isOwner) { \n__p+='\\n    <button class=\"CDB-Text CDB-Size-small u-upperCase js-options SyncInfo-viewOptions\">'+\n((__t=( _t('dataset.sync.view-options') ))==null?'':_.escape(__t))+\n'</button>\\n  ';\n } \n__p+='\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var Notifier = require('../../components/notifier/notifier');\nvar errorParser = require('../../helpers/error-parser');\n\nmodule.exports = function (opts) {\n  if (!opts.visDefinitionModel) throw new Error('visDefinitionModel is required');\n\n  var visDefinitionModel = opts.visDefinitionModel;\n  var successCallback = opts.onSuccess;\n  var errorCallback = opts.onError;\n  var name = visDefinitionModel.get('name');\n\n  visDefinitionModel.destroy({\n    wait: true,\n    success: function (mdl, attrs) {\n      successCallback && successCallback(mdl, attrs);\n    },\n    error: function (mdl, e) {\n      errorCallback && errorCallback(mdl, e);\n      Notifier.addNotification({\n        status: 'error',\n        info: _t('editor.maps.delete.error', {name: name, error: errorParser(e)}),\n        closable: true\n      });\n    }\n  });\n};\n",
    "var Notifier = require('../../components/notifier/notifier');\nvar errorParser = require('../../helpers/error-parser');\nvar TITLE_SUFIX = require('../../components/modals/visualization-title-suffix-metadata');\n\nmodule.exports = function (opts) {\n  if (!opts.visDefinitionModel) throw new Error('visDefinitionModel is required');\n  if (!opts.newName) throw new Error('newName is required');\n\n  var visDefinitionModel = opts.visDefinitionModel;\n  var successCallback = opts.onSuccess;\n  var errorCallback = opts.onError;\n  var newName = opts.newName;\n  var oldName = visDefinitionModel.get('name');\n\n  var notification = Notifier.addNotification({\n    status: 'loading',\n    info: _t('editor.maps.rename.loading'),\n    closable: false\n  });\n\n  visDefinitionModel.save({\n    name: newName\n  }, {\n    wait: true,\n    success: function (mdl, e) {\n      successCallback && successCallback(newName);\n      document.title = newName + TITLE_SUFIX;\n      notification.set({\n        status: 'success',\n        info: _t('editor.maps.rename.success', {name: newName}),\n        closable: true\n      });\n    },\n    error: function (mdl, e) {\n      errorCallback && errorCallback(oldName);\n      notification.set({\n        status: 'error',\n        info: _t('editor.maps.rename.error', {name: oldName, error: errorParser(e)}),\n        closable: true\n      });\n    }\n  });\n};\n",
    "var cdb = require('cartodb.js');\nvar Notifier = require('../../components/notifier/notifier');\n\nvar ongoingQuery = false;\n\nmodule.exports = function zoomToData (configModel, stateModel, query) {\n  if (!configModel) throw new Error('configModel is required');\n  if (!stateModel) throw new Error('stateModel is required');\n  if (!query) throw new Error('query is required');\n\n  var queryLauncher = new cdb.SQL({\n    user: configModel.get('user_name'),\n    sql_api_template: configModel.get('sql_api_template'),\n    api_key: configModel.get('api_key')\n  });\n  var notification = null;\n\n  if (!ongoingQuery) {\n    ongoingQuery = true;\n\n    notification = Notifier.addNotification({\n      status: 'loading',\n      info: _t('editor.layers.notifier.center-map.loading'),\n      closable: false\n    });\n\n    queryLauncher.getBounds(query)\n      .done(function (bounds) {\n        ongoingQuery = false;\n        stateModel.setBounds(bounds);\n        notification.set({\n          status: 'success',\n          info: _t('editor.layers.notifier.center-map.success'),\n          closable: true\n        });\n      })\n      .error(function () {\n        ongoingQuery = false;\n        notification.set({\n          status: 'error',\n          info: _t('editor.layers.notifier.center-map.error'),\n          closable: true\n        });\n      });\n  }\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-formInner CDB-Text CDB-Size-small u-upperCase ';\n if (disabled) { \n__p+='u-altTextColor';\n } \n__p+=' u-upperCase\">\\n  <div class=\"u-flex u-alignCenter\">\\n    <div class=\"u-iBlock u-rSpace--m\">\\n      <input class=\"CDB-Checkbox js-input\" type=\"checkbox\" name=\"\" value=\"\" ';\n if (checked) { \n__p+='checked';\n } \n__p+=' ';\n if (disabled) { \n__p+='disabled';\n } \n__p+='>\\n      <span class=\"u-iBlock CDB-Checkbox-face\"></span>\\n    </div>\\n    <span class=\"';\n if (help) { \n__p+=' js-help is-underlined';\n } \n__p+='\" ';\n if (help) { \n__p+=' data-tooltip=\"'+\n((__t=( help ))==null?'':_.escape(__t))+\n'\"';\n } \n__p+=' >'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</span>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"FormPlaceholder-paragraph u-tSpace-m u-flex\">\\n  <div class=\"FormPlaceholder-step u-rSpace--m\"></div>\\n  <div class=\"FormPlaceholder-inner\">\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--long u-bSpace\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med u-bSpace--xl\"></span>\\n\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med u-bSpace--m\"></span>\\n\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med u-bSpace--m\"></span>\\n\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med u-bSpace--m\"></span>\\n\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med u-bSpace--m\"></span>\\n\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med u-bSpace--m\"></span>\\n\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med u-bSpace--m\"></span>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar enablerTemplate = require('./enabler.tpl');\nrequire('../../../components/form-components/index');\n\nvar REQUIRED_OPTS = [\n  'model'\n];\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (!opts[item]) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n\n    // For enabler compatibility\n    this.model.set(this.model.get('setting'), this.model.get('active'), {silent: true});\n  },\n\n  render: function () {\n    this.$el.empty();\n    this._initViews();\n    return this;\n  },\n\n  _initViews: function () {\n    this._enablerView = new Backbone.Form.editors.Enabler({\n      template: enablerTemplate,\n      model: this.model,\n      title: this.model.get('label'),\n      disabled: this.model.get('disabled'),\n      help: '',\n      key: this.model.get('setting')\n    });\n\n    this.$el.append(this._enablerView.render().$el);\n  }\n});\n",
    "var _ = require('underscore');\nvar CoreView = require('backbone/core-view');\nvar OptionsItemView = require('./preview-options-item-view');\nvar template = require('./preview-options.tpl');\nvar templateNotReady = require('./options-not-ready.tpl');\n\nvar REQUIRED_OPTS = [\n  'mapDefinitionModel',\n  'settingsCollection',\n  'overlaysCollection'\n];\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (!opts[item]) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    if (!this._overlaysCollection.hasFetched()) {\n      this.$el.html(templateNotReady());\n    } else {\n      this.$el.html(template());\n      this._initViews();\n    }\n\n    return this;\n  },\n\n  _initBinds: function () {\n    this._settingsCollection.on('change', this._onChangeOptions, this);\n    this.add_related_model(this._settingsCollection);\n  },\n\n  _onChangeOptions: function (m) {\n    var handler = m.get('related');\n    var property = m.get('setting');\n    var value = m.get('enabler');\n\n    if (handler === 'overlays') {\n      this._overlayHandler(property, value);\n    }\n\n    if (handler === 'map') {\n      this._mapHandler(property, value);\n    }\n  },\n\n  _initViews: function () {\n    this._settingsCollection.each(this._renderSetting, this);\n  },\n\n  _renderSetting: function (model) {\n    var view = new OptionsItemView({\n      model: model\n    });\n\n    this.$('.js-settings').append(view.render().$el);\n    this.addView(view);\n  },\n\n  _overlayHandler: function (property, value) {\n    if (value === false) {\n      this._overlaysCollection.removeOverlay(property);\n    } else {\n      this._overlaysCollection.createOverlay(property);\n    }\n  },\n\n  _mapHandler: function (property, value) {\n    var payload = {};\n    payload[property] = value;\n    this._mapDefinitionModel.set(payload);\n    this._mapDefinitionModel.save();\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-HeaderInfo\">\\n  <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">1</div>\\n  <div class=\"Editor-HeaderInfo-inner CDB-Text\">\\n    <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n      <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.settings.preview.options.title') ))==null?'':_.escape(__t))+\n'</h2>\\n    </div>\\n    <p class=\"CDB-Text u-upperCase CDB-Size-small u-altTextColor u-bSpace--xl\">'+\n((__t=( _t('editor.settings.preview.options.subtitle') ))==null?'':_.escape(__t))+\n'</p>\\n    <div class=\"u-flex u-justifySpace\">\\n      <div class=\"js-settings Options-form\"></div>\\n    </div>\\n\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar OptionsView = require('./preview-options-view');\n\nvar REQUIRED_OPTS = [\n  'mapDefinitionModel',\n  'settingsCollection',\n  'overlaysCollection'\n];\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    _.each(REQUIRED_OPTS, function (item) {\n      if (!opts[item]) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this._renderOptions();\n    return this;\n  },\n\n  _renderOptions: function () {\n    var view = new OptionsView({\n      mapDefinitionModel: this._mapDefinitionModel,\n      settingsCollection: this._settingsCollection,\n      overlaysCollection: this._overlaysCollection\n    });\n\n    this.$el.append(view.render().el);\n    this.addView(view);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<h2 class=\"CDB-Text CDB-Size-huge is-light u-secondaryTextColor\">'+\n((__t=( _t('editor.style.style-form.properties.placeholder-text') ))==null?'':_.escape(__t))+\n' '+\n((__t=( _t('editor.layers.georeference.manually-add') ))==null?'':_.escape(__t))+\n'</h2>\\n<div class=\"BlockList-item is-dashed no-hover is-space u-tSpace-xl\">\\n  <ul class=\"HorizontalBlockList\">\\n    <li class=\"HorizontalBlockList-item\"></li>\\n    <li class=\"HorizontalBlockList-item\"></li>\\n  </ul>\\n\\n  <button class=\"CDB-Button CDB-Button--primary js-georeference\">\\n    <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">'+\n((__t=( _t('editor.layers.georeference.georeference-button') ))==null?'':_.escape(__t))+\n'</span>\\n  </button>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar UndoManager = require('../../data/undo-manager.js');\nvar _ = require('underscore');\n\n/**\n *  CartoCSS Undo-redo model\n */\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    content: ''\n  },\n\n  initialize: function (attrs, opts) {\n    this._history = this._generateHistory(opts && opts.history);\n\n    UndoManager.init(this, {\n      track: true,\n      history: this._history\n    });\n  },\n\n  _generateHistory: function (history) {\n    if (history && history.length) {\n      var data = _.reduce(history, function (memo, cartocss) {\n        memo.push({\n          content: cartocss\n        });\n        return memo;\n      }, [], this);\n      return data;\n    }\n\n    return false;\n  },\n\n  getHistory: function () {\n    return _.pluck(\n      this.getUndoHistory(),\n      'content'\n    );\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar CodeMirrorView = require('../../components/code-mirror/code-mirror-view');\nvar FactoryHints = require('../editor-hints/factory-hints');\nvar CSSHints = require('../editor-hints/css-hints');\n\nmodule.exports = CoreView.extend({\n\n  className: 'Editor-styleContentCartoCSS Editor-content',\n\n  initialize: function (opts) {\n    if (!opts.layerDefinitionModel) throw new Error('layerDefinitionModel is required');\n    if (!opts.styleModel) throw new Error('styleModel is required');\n    if (!opts.codemirrorModel) throw new Error('codemirrorModel is required');\n    if (!opts.editorModel) throw new Error('editorModel is required');\n    if (!opts.querySchemaModel) throw new Error('querySchemaModel is required');\n    if (!opts.onApplyEvent) throw new Error('onApplyEvent');\n\n    this._layerDefinitionModel = opts.layerDefinitionModel;\n    this._styleModel = this._layerDefinitionModel.styleModel;\n    this._codemirrorModel = opts.codemirrorModel;\n    this._editorModel = opts.editorModel;\n    this._querySchemaModel = opts.querySchemaModel;\n\n    this._initBinds();\n\n    FactoryHints.init({\n      querySchemaModel: this._querySchemaModel,\n      layerDefinitionModel: this._layerDefinitionModel,\n      tokens: CSSHints\n    });\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this._initViews();\n    return this;\n  },\n\n  _initBinds: function () {\n    this._layerDefinitionModel.bind('change:cartocss', this._updateEditorContent, this);\n    this.add_related_model(this._layerDefinitionModel);\n  },\n\n  _initViews: function () {\n    var hints = FactoryHints.reset().hints;\n    this.codeMirrorView = new CodeMirrorView({\n      model: this._codemirrorModel,\n      addons: ['color-picker'],\n      hints: hints,\n      tip: _t('editor.style.code-mirror.save')\n    });\n    this.codeMirrorView.bind('codeSaved', this._triggerCodeSaved, this);\n    this.addView(this.codeMirrorView);\n    this.$el.append(this.codeMirrorView.render().el);\n  },\n\n  _updateEditorContent: function () {\n    if (this._editorModel.get('edition') === false) {\n      this.codeMirrorView.setContent(this._layerDefinitionModel.get('cartocss'));\n    }\n  },\n\n  _triggerCodeSaved: function (code, view) {\n    this.options.onApplyEvent && this.options.onApplyEvent();\n  }\n\n});\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar StyleFormView = require('./style-form/style-form-view');\nvar StylesFactory = require('./styles-factory');\nvar CarouselFormView = require('../../components/carousel-form-view');\nvar CarouselCollection = require('../../components/custom-carousel/custom-carousel-collection');\nvar styleFormNotReadyTemplate = require('../layers/panel-loading-template.tpl');\nvar styleFormPlaceholderTemplate = require('./style-form-placeholder.tpl');\nvar georeferencePlaceholderTemplate = require('./georeference-placeholder.tpl');\nvar styleSQLErrorTemplate = require('./style-content-sql-error.tpl');\nvar OverlayView = require('../components/overlay/overlay-view');\nvar Notifier = require('../../components/notifier/notifier');\nvar QuerySanity = require('../layers/query-sanity-check');\nvar actionErrorTemplate = require('../layers/sql-error-action.tpl');\nvar MetricsTracker = require('../../components/metrics/metrics-tracker');\nvar checkAndBuildOpts = require('../../helpers/required-opts');\nvar fetchAllQueryObjectsIfNecessary = require('../../helpers/fetch-all-query-objects');\n\nvar STATES = {\n  ready: 'ready',\n  loading: 'loading',\n  fetched: 'fetched',\n  error: 'error'\n};\n\nvar REQUIRED_OPTS = [\n  'configModel',\n  'layerDefinitionsCollection',\n  'userModel',\n  'layerDefinitionModel',\n  'userActions',\n  'styleModel',\n  'overlayModel',\n  'queryGeometryModel',\n  'querySchemaModel',\n  'queryRowsCollection',\n  'freezeTorgeAggregation',\n  'editorModel',\n  'modals'\n];\n\nmodule.exports = CoreView.extend({\n\n  className: 'Editor-styleContent',\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n    this.render = this.render.bind(this);\n\n    this._initModels();\n    this._initBinds();\n    this._fetchAllQueryObjectsIfNecessary();\n\n    QuerySanity.track(this, this.render);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    if (this._hasError()) {\n      this._renderError();\n    } else if (this._isLoading()) {\n      this._renderStateless();\n    } else if (this._isReady()) {\n      if (this._queryGeometryModel.hasValue()) {\n        if (this._queryGeometryModel.get('simple_geom') === 'point') {\n          this._renderCarousel();\n        }\n\n        this._renderForm();\n        this._renderOverlay();\n      } else {\n        if (this._layerDefinitionModel.canBeGeoreferenced()) {\n          this.$el.html(georeferencePlaceholderTemplate());\n          this._renderOverlay();\n        } else {\n          this.$el.html(styleFormPlaceholderTemplate());\n        }\n      }\n    }\n\n    return this;\n  },\n\n  _hasError: function () {\n    return this.modelView.get('state') === STATES.error;\n  },\n\n  _isLoading: function () {\n    return this.modelView.get('state') === STATES.loading ||\n      !this._querySchemaModel.isFetched() ||\n      !this._queryGeometryModel.isFetched() ||\n      !this._queryRowsCollection.isFetched();\n  },\n\n  _isReady: function () {\n    return this.modelView.get('state') === STATES.ready &&\n      this._querySchemaModel.isFetched() &&\n      this._queryGeometryModel.isFetched() &&\n      this._queryRowsCollection.isFetched();\n  },\n\n  _getInitialState: function () {\n    return STATES.loading;\n  },\n\n  _initModels: function () {\n    this.modelView = new Backbone.Model({\n      state: STATES.loading\n    });\n\n    this._carouselCollection = new CarouselCollection(\n      _.map(StylesFactory.getStyleTypes(this._styleModel.get('type'), this._queryGeometryModel.get('simple_geom')), function (type) {\n        return {\n          selected: this._styleModel.get('type') === type.value,\n          val: type.value,\n          label: type.label,\n          template: function () {\n            return (type.iconTemplate && type.iconTemplate()) || type.value;\n          }\n        };\n      }, this)\n    );\n  },\n\n  _initBinds: function () {\n    this.listenTo(this._layerDefinitionModel, 'change:autoStyle', this._onAutoStyleChanged);\n    this.listenTo(this.modelView, 'change:state', this._checkEditorModel);\n    this.listenTo(this._carouselCollection, 'change:selected', this._onSelectAggregation);\n\n    // Render everything when there is an undo/redo action\n    this.listenTo(this._styleModel, 'undo redo', this.render);\n    this.listenTo(this._styleModel, 'change', this._onStyleChanged);\n\n    this.listenTo(this._querySchemaModel, 'change:status', this._onStatusChanged);\n    this.listenTo(this._queryGeometryModel, 'change:status', this._onStatusChanged);\n    this.listenTo(this._queryRowsCollection.statusModel, 'change:status', this._onStatusChanged);\n  },\n\n  _fetchAllQueryObjectsIfNecessary: function () {\n    fetchAllQueryObjectsIfNecessary({\n      queryRowsCollection: this._queryRowsCollection,\n      queryGeometryModel: this._queryGeometryModel,\n      querySchemaModel: this._querySchemaModel\n    });\n  },\n\n  _onAutoStyleChanged: function (layerDefModel) {\n    var isAutoStyleApplied = layerDefModel.get('autoStyle');\n    if (!isAutoStyleApplied) {\n      this.render();\n    } else {\n      this._styleModel.unbind('change', this._onStyleChanged, this);\n      this._styleModel.once('change', function () {\n        this.render();\n        this._styleModel.bind('change', this._onStyleChanged, this);\n      }, this);\n    }\n  },\n\n  _onStatusChanged: function () {\n    fetchAllQueryObjectsIfNecessary({\n      queryRowsCollection: this._queryRowsCollection,\n      queryGeometryModel: this._queryGeometryModel,\n      querySchemaModel: this._querySchemaModel\n    }, this.render);\n\n    this._checkEditorModel();\n  },\n\n  _checkEditorModel: function () {\n    var hasGeometry = this._queryGeometryModel.hasValue();\n    this._editorModel.set({ disabled: this._hasError() || !hasGeometry });\n  },\n\n  _renderError: function () {\n    this.$el.append(\n      styleSQLErrorTemplate({\n        body: _t('editor.error-query.body', {\n          action: actionErrorTemplate({\n            label: _t('editor.error-query.label')\n          })\n        })\n      })\n    );\n  },\n\n  _renderStateless: function () {\n    this.$el.append(\n      styleFormNotReadyTemplate()\n    );\n  },\n\n  _renderOverlay: function () {\n    var view = new OverlayView({\n      overlayModel: this._overlayModel\n    });\n    this.addView(view);\n    this.$el.append(view.render().el);\n  },\n\n  _renderCarousel: function () {\n    var view = new CarouselFormView({\n      collection: this._carouselCollection,\n      template: require('./style-form-types.tpl')\n    });\n    view.$el.addClass('js-aggregationTypes');\n    this.addView(view);\n    this.$el.append(view.render().el);\n  },\n\n  _onSelectAggregation: function (mdl) {\n    var alreadyTorqueLayer = this._layerDefinitionsCollection.isThereAnyTorqueLayer();\n    var isTorqueLayer = this._layerDefinitionModel.get('type') === 'torque';\n\n    var styleType;\n    var isTorqueType;\n    var currentGeometryType;\n\n    if (mdl.get('selected')) {\n      styleType = mdl.getValue();\n      currentGeometryType = this._queryGeometryModel.get('simple_geom');\n\n      isTorqueType = (styleType === 'heatmap' || styleType === 'animation');\n\n      if (alreadyTorqueLayer && !isTorqueLayer && isTorqueType) {\n        this._freezeTorgeAggregation(styleType, currentGeometryType);\n      } else {\n        var setDefaultProperties = function () {\n          this._styleModel.setDefaultPropertiesByType(styleType, currentGeometryType);\n        }.bind(this);\n\n        // If an animated or a heatmap style is selected, we should move the layer to the\n        // top, but if it is in the most high position, we shouldn't do anything\n        if (isTorqueType && !this._layerDefinitionsCollection.isDataLayerOnTop(this._layerDefinitionModel)) {\n          this._moveTorqueLayerToTop(setDefaultProperties);\n        } else {\n          setDefaultProperties();\n        }\n      }\n    }\n  },\n\n  _moveTorqueLayerToTop: function (callback) {\n    var notification = Notifier.addNotification({\n      status: 'loading',\n      info: _t('editor.layers.moveTorqueLayer.loading'),\n      closable: true\n    });\n\n    this._layerDefinitionsCollection.once('layerMoved', function () {\n      callback && callback();\n      notification.set({\n        status: 'success',\n        info: _t('editor.layers.moveTorqueLayer.success'),\n        delay: Notifier.DEFAULT_DELAY\n      });\n    }, this);\n\n    this._userActions.moveLayer({\n      from: this._layerDefinitionModel.get('order'),\n      to: this._layerDefinitionsCollection.getTopDataLayerIndex()\n    });\n  },\n\n  _renderForm: function () {\n    this._styleForm = new StyleFormView({\n      layerDefinitionsCollection: this._layerDefinitionsCollection,\n      layerDefinitionModel: this._layerDefinitionModel,\n      styleModel: this._styleModel,\n      configModel: this._configModel,\n      userModel: this._userModel,\n      queryGeometryModel: this._queryGeometryModel,\n      querySchemaModel: this._querySchemaModel,\n      modals: this._modals\n    });\n    this.$el.append(this._styleForm.render().el);\n    this.addView(this._styleForm);\n  },\n\n  _onStyleChanged: function () {\n    this._styleModel.attributes.autogenerated = false;\n    this._layerDefinitionModel.save();\n\n    MetricsTracker.track('Modified Style Form', {\n      layer_id: this._layerDefinitionModel.get('id'),\n      cartocss: this._layerDefinitionModel.get('cartocss'),\n      style_properties: this._layerDefinitionModel.get('style_properties')\n    });\n  }\n});\n",
    "var _ = require('underscore');\nvar camshaftReference = require('../../data/camshaft-reference');\nvar Utils = require('../../helpers/utils');\nvar InputColorCategories = require('../../components/form-components/editors/fill/input-color/input-categories/input-color-categories.js');\n\nvar CONFIG = {\n  GENERIC_STYLE: camshaftReference.getDefaultCartoCSSForType(),\n  DEFAULT_HEATMAP_COLORS: ['blue', 'cyan', 'lightgreen', 'yellow', 'orange', 'red']\n};\n\n// utilities\nfunction _null () { return ''; }\n\nfunction makeCartoCSS (obj, prefix) {\n  var css = '';\n  prefix = prefix || '';\n  for (var k in obj) {\n    css += prefix + k + ': ' + obj[k] + ';\\n';\n  }\n  return css;\n}\n\nfunction makeColorRamp (props, isTorqueCategory) {\n  var attribute = isTorqueCategory ? 'value' : props.attribute;\n  var c = ['ramp([' + attribute + ']'];\n\n  if (props.range) {\n    if (_.isArray(props.range)) {\n      c.push('(' + props.range.join(', ') + ')');\n    } else {\n      // colorramp name\n      c.push(props.range);\n      if (props.bins) {\n        c.push(props.bins);\n      }\n    }\n  }\n  if (props.domain) {\n    if (isTorqueCategory) {\n      c.push('(' + _.map(props.domain, function (val, i) {\n        return i + 1;\n      }).join(', ') + ')');\n    } else if (props.static) {\n      // It comes from an autostyle, so we have to set the categories explicitly\n      var parsedDomain = _.filter(props.domain, function (name) {\n        return name !== '\"Other\"';\n      });\n      c.push('(' + parsedDomain.join(', ') + ')');\n    } else {\n      c.push('(' +\n        _.filter(\n          _.map(props.domain, function (val, i) {\n            return val;\n          }), function (val) {\n          return !_.isUndefined(val);\n        }).join(', ') +\n        ')'\n      );\n      c.push('\"=\"');\n    }\n  }\n  if (props.quantification) {\n    c.push(props.quantification.toLowerCase());\n  }\n\n  if (isTorqueCategory) {\n    c.push('\"=\"');\n  }\n\n  return c.join(', ') + ')';\n}\n\nfunction makeWidthRamp (props) {\n  var c = ['ramp([' + props.attribute + ']'];\n\n  if (props.range) {\n    var min = props.range[0];\n    var max = props.range[1];\n\n    c.push('range(' + min + ', ' + max + ')');\n  }\n\n  if (props.quantification) {\n    var quantification = props.quantification.toLowerCase();\n\n    if (props.bins) {\n      c.push(quantification + '(' + props.bins + ')');\n    } else {\n      c.push(quantification);\n    }\n  }\n\n  return c.join(', ') + ')';\n}\n\n// size\nfunction pointSize (props) {\n  var css = {};\n  if (props.fixed !== undefined) {\n    css['marker-width'] = props.fixed;\n  } else if (props.attribute) {\n    css['marker-width'] = makeWidthRamp(props);\n  } else {\n    // throw new Error('size should contain a fixed value or an attribute')\n  }\n  return css;\n}\n\nfunction blending (b, geometryType, animatedType) {\n  var css = {};\n  var property = geometryType + '-comp-op';\n  if (b !== 'none' && b !== undefined && animatedType !== 'heatmap') {\n    if (animatedType === 'simple') {\n      property = 'comp-op';\n    }\n    css[property] = b;\n  }\n  return css;\n}\n\n// fill\nfunction pointFill (props, animationType) {\n  var css = {};\n  var color = (props && props.color) || {};\n  var isTorqueCategory = animationType && !color.fixed;\n  var markerFillOpacity = color.opacity;\n\n  if (props.size) {\n    css = pointSize(props.size);\n  }\n  if (color) {\n    if (color.fixed !== undefined) {\n      css['marker-fill'] = color.fixed;\n    } else if (color.attribute) {\n      css['marker-fill'] = makeColorRamp(color, isTorqueCategory);\n    }\n    if (color.operation) {\n      css['marker-comp-op'] = color.operation;\n    }\n\n    css['marker-fill-opacity'] = markerFillOpacity != null ? markerFillOpacity : 1;\n\n    if (hasImagesSelected(props.images) || hasImagesSelected(color.images)) {\n      css['marker-file'] = markerFill(props.images || color.images, color);\n    } else if (props.image || color.image) {\n      var url = props.image;\n\n      if (color.image) {\n        url = 'url(\\'' + color.image + '\\')';\n      }\n\n      css['marker-file'] = url;\n    }\n  }\n  if (!animationType) {\n    css['marker-allow-overlap'] = true;\n  }\n  return css;\n}\n\nfunction hasImagesSelected (images) {\n  if (!images) return false;\n  if (!_.isArray(images)) return false;\n\n  return _.some(images, function (image) {\n    return image !== '';\n  });\n}\n\nfunction getFalsyCategory (category) {\n  return category === 0 ? '0' : \"''\";\n}\n\nfunction markerFill (images, color) {\n  if (!_.isArray(images) || !color || !color.attribute) {\n    return;\n  }\n\n  var columnName = '[' + color.attribute + ']';\n  var filesUrls = [];\n  var categoryNames = [];\n\n  _.each(images, function (image, index) {\n    if (image !== '') {\n      var urlFormat = 'url(\\'' + image + '\\')';\n      filesUrls.push(urlFormat);\n      if (!_.isUndefined(color.domain[index])) {\n        var category = color.domain[index] || getFalsyCategory(color.domain[index]);\n        categoryNames.push(category);\n      }\n    }\n  });\n\n  return 'ramp(' + columnName + ', (' + filesUrls.join(', ') + '), (' + categoryNames.join(', ') + '), \"=\"' + ')';\n}\n\nfunction polygonFill (props) {\n  var css = {};\n  if (props.color) {\n    if (props.color.fixed !== undefined) {\n      css['polygon-fill'] = props.color.fixed;\n    } else if (props.color.attribute) {\n      css['polygon-fill'] = makeColorRamp(props.color);\n    }\n    if (props.color.operation) {\n      css['polygon-comp-op'] = props.color.operation;\n    }\n    if (_.isNumber(props.color.opacity)) {\n      css['polygon-opacity'] = props.color.opacity;\n    }\n  }\n\n  return css;\n}\n\n// stroke\nfunction pointStroke (props, animationType) {\n  var css = {};\n\n  if (animationType === 'heatmap') {\n    return css;\n  }\n\n  if (props.size) {\n    css['marker-line-width'] = props.size.fixed;\n  }\n  if (props.color) {\n    if (props.color.fixed !== undefined) {\n      css['marker-line-color'] = props.color.fixed;\n    } else if (props.color.attribute) {\n      css['marker-line-color'] = makeColorRamp(props.color);\n    }\n    if (_.isNumber(props.color.opacity)) {\n      css['marker-line-opacity'] = props.color.opacity;\n    }\n  }\n  return css;\n}\n\nfunction polygonStroke (props) {\n  var css = {};\n  if (props.size) {\n    if (props.size.fixed !== undefined) {\n      css['line-width'] = props.size.fixed;\n    } else if (props.size.attribute) {\n      css['line-width'] = makeWidthRamp(props.size);\n    }\n  }\n  if (props.color) {\n    if (props.color.fixed) {\n      css['line-color'] = props.color.fixed;\n    } else if (props.color.attribute) {\n      css['line-color'] = makeColorRamp(props.color);\n    }\n    if (_.isNumber(props.color.opacity)) {\n      css['line-opacity'] = props.color.opacity;\n    }\n  }\n  return css;\n}\n\nfunction isValidAttribute (attr) {\n  return attr && attr !== '';\n}\n\nfunction pointAnimated (props) {\n  var css = {};\n  if (isValidAttribute(props.attribute)) {\n    css['-torque-frame-count'] = props.steps;\n    css['-torque-animation-duration'] = props.duration;\n    css['-torque-time-attribute'] = '\"' + props.attribute + '\"';\n    if (props.isCategory) {\n      css['-torque-aggregation-function'] = '\"CDB_Math_Mode(value)\"';\n    } else {\n      css['-torque-aggregation-function'] = '\"count(1)\"';\n    }\n    css['-torque-resolution'] = props.resolution;\n    css['-torque-data-aggregation'] = props.overlap ? 'cumulative' : 'linear';\n  }\n  return css;\n}\n\nfunction _labels (props) {\n  var css = {};\n  if (isValidAttribute(props.attribute)) {\n    css['text-name'] = '[' + props.attribute + ']';\n    css['text-face-name'] = \"'\" + props.font + \"'\";\n    if (props.fill) {\n      css['text-size'] = props.fill.size.fixed;\n\n      if (props.fill.color.opacity != null && props.fill.color.opacity < 1) {\n        css['text-fill'] = Utils.hexToRGBA(props.fill.color.fixed, props.fill.color.opacity);\n      } else {\n        css['text-fill'] = props.fill.color.fixed;\n      }\n    }\n    css['text-label-position-tolerance'] = 0;\n    if (props.halo) {\n      css['text-halo-radius'] = props.halo.size.fixed;\n\n      if (props.halo.color.opacity != null && props.halo.color.opacity < 1) {\n        css['text-halo-fill'] = Utils.hexToRGBA(props.halo.color.fixed, props.halo.color.opacity);\n      } else {\n        css['text-halo-fill'] = props.halo.color.fixed;\n      }\n    }\n    css['text-dy'] = props.offset === undefined ? -10 : props.offset;\n    css['text-allow-overlap'] = props.overlap === undefined ? true : props.overlap;\n    css['text-placement'] = 'point';\n    css['text-placement-type'] = 'dummy';\n  }\n  return css;\n}\n\nfunction imageFilters (props) {\n  var css = {};\n  if (props.ramp) {\n    css['image-filters'] = 'colorize-alpha(' + props.ramp.join(',') + ')';\n  }\n  return css;\n}\n\nvar cartocssFactory = {\n  animated: {\n    point: pointAnimated,\n    line: _null,\n    polygon: _null\n  },\n\n  trails: {\n    point: trails,\n    line: _null,\n    polygon: _null\n  },\n\n  fill: {\n    point: pointFill,\n    line: _null,\n    polygon: polygonFill\n  },\n\n  stroke: {\n    point: pointStroke,\n    line: polygonStroke,\n    polygon: polygonStroke\n  },\n\n  labels: {\n    point: _labels,\n    line: _labels,\n    polygon: _labels\n  },\n\n  imageFilters: {\n    point: imageFilters,\n    line: imageFilters,\n    polygon: imageFilters\n  },\n\n  blending: {\n    point: function (attrs, animationType) { return blending(attrs, 'marker', animationType); },\n    line: function (attrs) { return blending(attrs, 'line'); },\n    polygon: function (attrs) { return blending(attrs, 'polygon'); }\n  }\n};\n\nvar heatmapConversion = function (style, animated, configModel) {\n  // modify the size\n  style.fill = _.clone(style.fill);\n  var ramp = style.fill.color.range;\n  style.fill.size = style.fill.size || { fixed: 35 };\n\n  style.fill.image = 'url(' + configModel.get('app_assets_base_url') + '/unversioned/images/alphamarker.png)';\n\n  style.fill.color = {\n    fixed: style.fill.color.fixed || 'white',\n    opacity: style.fill.color.opacity\n  };\n\n  // switch to torque\n  // add image filters\n  if (ramp !== undefined) {\n    style.imageFilters = {\n      ramp: _.isArray(ramp) ? ramp : CONFIG.DEFAULT_HEATMAP_COLORS\n    };\n  }\n  return style;\n};\n\nvar styleConversion = {\n  animation: function (style, configModel) {\n    if (style.style === 'heatmap') {\n      return heatmapConversion(style, true, configModel);\n    }\n  },\n\n  heatmap: function (style, configModel) {\n    return heatmapConversion(style, false, configModel);\n  }\n};\n\nfunction renderBlock (block, geometryType, animationType) {\n  var css = {};\n  for (var k in block) {\n    var f = cartocssFactory[k];\n    if (f) {\n      css = _.extend(css, f[geometryType](block[k], animationType));\n    }\n  }\n  return makeCartoCSS(css, '  ');\n}\n\nfunction isTypeTorque (type) {\n  return type === 'animation' || type === 'heatmap';\n}\n\nfunction isCategoryType (styleDef, geometryType) {\n  if (geometryType === 'line') {\n    var stroke = styleDef.stroke;\n    return stroke && stroke.color && stroke.color.fixed == null;\n  } else {\n    var fill = styleDef.fill;\n    return fill && fill.color && fill.color.fixed == null;\n  }\n}\n\nfunction generateCartoCSS (style, geometryType, configModel) {\n  var css = '';\n  var styleDef = style.properties;\n  var isAnimatable = isTypeTorque(style.type);\n  var isCategory = isCategoryType(styleDef, geometryType);\n  var animationType = style.type === 'animation' && styleDef.style;\n\n  if (geometryType === 'point' && isAnimatable) {\n    css += 'Map {\\n';\n    css += renderBlock({\n      animated: _.extend({}, styleDef.animated, { isCategory: isCategory })\n    }, geometryType);\n    css += '}\\n';\n  }\n\n  css += '#layer {\\n';\n  css += renderBlock(_.omit(styleDef, 'animated', 'labels'), geometryType, animationType);\n  css += '}';\n\n  // labels\n  if (styleDef.labels && styleDef.labels.enabled && styleDef.labels.enabled !== 'false') {\n    css += '\\n#layer::labels {\\n';\n    css += renderBlock({ labels: styleDef.labels }, geometryType);\n    css += '}';\n  }\n\n  if (isAnimatable && styleDef.animated.trails && styleDef.animated.trails > 0) {\n    css += cartocssFactory.trails[geometryType](styleDef);\n  }\n\n  return css;\n}\n\nfunction trails (def) {\n  var baseWidth = def.fill.size && parseInt(def.fill.size.fixed, 10);\n  var baseOpacity = def.fill.color.opacity != null ? def.fill.color.opacity : 1;\n  if (!baseWidth) return '';\n  return '\\n' +\n    _.range(1, parseInt(def.animated.trails, 10) + 1)\n      .map(function (t) {\n        return '#layer[frame-offset=' + t + '] {\\n' +\n          makeCartoCSS({ 'marker-width': baseWidth + 2 * t }, '  ') +\n          makeCartoCSS({ 'marker-fill-opacity': baseOpacity / (2 * t) }, '  ') +\n          '}';\n      }\n    ).join('\\n');\n}\n\nfunction aggToSQL (agg) {\n  if (agg.operator.toLowerCase() === 'count') {\n    return 'count(1)';\n  }\n  return agg.operator + '(' + agg.attribute + ')';\n}\n\nfunction regionTableMap (level) {\n  var map = {\n    'countries': 'aggregation.agg_admin0',\n    'provinces': 'aggregation.agg_admin1'\n  };\n  return map[level];\n}\n\nfunction hexabins (style, mapContext) {\n  var aggregation = style.properties.aggregation;\n  var sql = 'WITH hgrid AS (SELECT CDB_HexagonGrid(ST_Expand(!bbox!, CDB_XYZ_Resolution(<%= z %>) * <%= size %>), CDB_XYZ_Resolution(<%= z %>) * <%= size %>) as cell) SELECT hgrid.cell as the_geom_webmercator, <%= agg %> as agg_value, count(1)/power( <%= size %> * CDB_XYZ_Resolution(<%= z %>), 2 ) as agg_value_density, row_number() over () as cartodb_id FROM hgrid, <%= table %> i where ST_Intersects(i.the_geom_webmercator, hgrid.cell) GROUP BY hgrid.cell';\n  return _.template(sql)({\n    table: '(<%= sql %>)',\n    size: aggregation.size,\n    agg: aggToSQL(aggregation.value),\n    z: mapContext.zoom\n  });\n}\n\nfunction squares (style, mapContext) {\n  var aggregation = style.properties.aggregation;\n  var sql = 'WITH hgrid AS (SELECT CDB_RectangleGrid ( ST_Expand(!bbox!, CDB_XYZ_Resolution(<%= z %>) * <%= size %>), CDB_XYZ_Resolution(<%= z %>) * <%= size %>, CDB_XYZ_Resolution(<%= z %>) * <%= size %>) as cell) SELECT hgrid.cell as the_geom_webmercator, <%= agg %> as agg_value, <%= agg %> /power( <%= size %> * CDB_XYZ_Resolution(<%= z %>), 2 ) as agg_value_density, row_number() over () as cartodb_id FROM hgrid, <%= table %> i where ST_Intersects(i.the_geom_webmercator, hgrid.cell) GROUP BY hgrid.cell';\n  return _.template(sql)({\n    table: '(<%= sql %>)',\n    size: aggregation.size,\n    agg: aggToSQL(aggregation.value),\n    z: mapContext.zoom\n  });\n}\n\nfunction regions (style) {\n  var aggregation = style.properties.aggregation;\n  // TODO: add !bbox! tokens to help postgres with FDW join\n  // I tested this on postgres 9.6, the planner seems to be doing weird, it takes\n  // 7 seconds to query a simple tile with no join, I hope 9.5 works much better\n  // Maybe using a CTE with the FDW table improves the thing\n  // Normalize also by area using the real area (not projected one). Using the_geom_webmercator for that instead of the_geom\n  // to avoid extra data going through the network in the FDW\n  // use 2.6e-06 as minimum area (tile size at zoom level 31)\n  var sql = [\n    'SELECT _poly.*, _merge.points_agg/GREATEST(0.0000026, ST_Area((ST_Transform(the_geom, 4326))::geography)) as agg_value_density, _merge.points_agg as agg_value FROM <%= aggr_dataset %> _poly, lateral (',\n    'SELECT <%= agg %> points_agg FROM (<%= table %>) _point where ST_Contains(_poly.the_geom_webmercator, _point.the_geom_webmercator) ) _merge'].join('\\n');\n  return _.template(sql)({\n    table: '<%= sql %>',\n    aggr_dataset: regionTableMap(aggregation.dataset),\n    agg: aggToSQL(aggregation.value)\n  });\n}\n\nfunction animation (style, mapContext) {\n  var color = style.properties.fill.color;\n  var columnType = color.attribute_type;\n  var columnName = color.attribute;\n  var hasOthers = color.range && color.range.length > InputColorCategories.MAX_VALUES;\n  var categoryCount = color.domain && color.domain.length;\n\n  var s = ['select *, (CASE'];\n\n  if (color.fixed != null || color.domain == null) {\n    return null;\n  }\n\n  function _normalizeValue (v) {\n    return v.replace(/\\n/g, '\\\\n').replace(/\\\"/g, '\\\\\"').replace();\n  }\n\n  for (var i = 0, l = categoryCount; i < l; i++) {\n    var categoryName = color.domain[i];\n    var categoryPos = i + 1;\n    var value;\n\n    if (columnType !== 'string' || categoryName === null) {\n      value = categoryName;\n    } else {\n      value = \"'\" + _normalizeValue(categoryName.replace(/(^\")|(\"$)/g, '')) + \"'\";\n    }\n\n    if (value != null) {\n      s.push('WHEN \"' + columnName + '\" = ' + value + ' THEN ' + categoryPos);\n    } else {\n      s.push('WHEN \"' + columnName + '\" is NULL THEN ' + categoryPos);\n    }\n  }\n\n  if (hasOthers) {\n    s.push(' ELSE ' + (categoryCount + 1));\n  }\n\n  s.push(' END) as value FROM (<%= sql %>) __wrapped');\n  return s.join(' ');\n}\n\nvar SQLFactory = {\n  hexabins: hexabins,\n  squares: squares,\n  regions: regions,\n  animation: animation\n};\n\nfunction generateSQL (style, geometryType, mapContext) {\n  if (SQLFactory[style.type] === undefined) {\n    return null;\n  }\n\n  if (style.type !== 'animation' && style.properties.aggregation === undefined) {\n    throw new Error('aggregation properties not available');\n  }\n\n  var fn = SQLFactory[style.type];\n  if (fn === undefined) {\n    throw new Error(\"can't generate SQL for aggregation \" + style.type);\n  }\n  return fn(style, mapContext);\n}\n\nvar AggregatedFactory = {\n  simple: {\n    geometryType: {\n      point: 'point',\n      line: 'line',\n      polygon: 'polygon'\n    }\n  },\n  hexabins: {\n    geometryType: {\n      point: 'polygon',\n      line: null,\n      polygon: null\n    }\n  },\n  squares: {\n    geometryType: {\n      point: 'polygon',\n      line: null,\n      polygon: null\n    }\n  },\n  regions: {\n    geometryType: {\n      point: 'polygon',\n      line: null,\n      polygon: null\n    }\n  }\n};\n\n/**\n * given a styleDefinition object and the geometry type generates the query wrapper and the\n */\nfunction generateStyle (style, geometryType, mapContext, configModel) {\n  if (style.type === 'none') {\n    return {\n      cartoCSS: CONFIG.GENERIC_STYLE,\n      sql: null,\n      layerType: 'CartoDB'\n    };\n  }\n\n  if (style.type !== 'simple' && geometryType !== 'point') {\n    throw new Error('aggregated styling does not work with ' + geometryType);\n  }\n\n  // pre style conversion\n  // some styles need some conversion, for example aggregated based on\n  // torque need to move from aggregation to animated properties\n  var conversion = styleConversion[style.type];\n  var properties;\n  if (conversion) {\n    properties = conversion(style.properties, configModel);\n    if (properties) {\n      style.properties = properties;\n    }\n  }\n\n  // override geometryType for aggregated styles\n  var geometryMapping = AggregatedFactory[style.type];\n  if (geometryMapping) {\n    geometryType = geometryMapping.geometryType[geometryType];\n  }\n\n  if (!geometryType) {\n    throw new Error('geometry type not supported for ' + style.type);\n  }\n\n  var layerType = style.type === 'heatmap' || style.type === 'animation' ? 'torque' : 'CartoDB';\n\n  return {\n    cartoCSS: generateCartoCSS(style, geometryType, configModel),\n    sql: generateSQL(style, geometryType, mapContext),\n    layerType: layerType\n  };\n}\n\nmodule.exports = {\n  configure: function (cfg) {\n    _.extend(CONFIG, cfg);\n  },\n  generateStyle: generateStyle,\n  GENERIC_STYLE: CONFIG.GENERIC_STYLE\n};\n",
    "var _ = require('underscore');\nvar SimpleStyleDefaults = require('./simple-style-defaults');\n\nmodule.exports = _.defaults({\n\n  generateAttributes: function (geometryType) {\n    return _.extend(\n      this._getStyleTypeAttrs(),\n      this._getFillAttrs(geometryType),\n      this._getStrokeAttrs(geometryType),\n      {\n        blending: 'lighter'\n      },\n      this._getAggrAttrs(geometryType),\n      this._getAnimatedAttrs(geometryType)\n    );\n  },\n\n  _getStyleTypeAttrs: function () {\n    return {\n      style: 'simple'\n    };\n  },\n\n  _getAnimatedAttrs: function (geometryType) {\n    return {\n      animated: {\n        attribute: null,\n        overlap: false,\n        duration: 30,\n        steps: 256,\n        trails: 2,\n        resolution: 4\n      }\n    };\n  },\n\n  _getAggrAttrs: function (geometryType) {\n    return {\n      aggregation: {}\n    };\n  }\n}, SimpleStyleDefaults);\n",
    "var _ = require('underscore');\nvar SimpleStyleDefaults = require('./simple-style-defaults');\nvar rampList = require('cartocolor');\n\nmodule.exports = _.defaults({\n\n  generateAttributes: function (geometryType) {\n    return _.extend(\n      this._getFillAttrs(geometryType),\n      this._getAggrAttrs(),\n      this._getAnimatedAttrs(),\n      this._getLabelsAttrs()\n    );\n  },\n\n  _getFillAttrs: function (geometryType) {\n    var attrs = {\n      fill: {\n        'size': {\n          fixed: 45\n        },\n        'color': {\n          attribute: 'cartodb_id',\n          range: rampList.ag_Sunset[7],\n          bins: 6\n        }\n      }\n    };\n\n    return attrs;\n  },\n\n  _getAggrAttrs: function () {\n    return {\n      aggregation: {}\n    };\n  },\n\n  _getAnimatedAttrs: function (geometryType) {\n    return {\n      animated: {\n        attribute: 'cartodb_id',\n        overlap: false,\n        duration: 30,\n        steps: 1,\n        trails: 0,\n        resolution: 4\n      }\n    };\n  },\n\n  _getLabelsAttrs: function () {\n    return {\n      labels: {}\n    };\n  }\n\n}, SimpleStyleDefaults);\n",
    "var _ = require('underscore');\nvar SimpleStyleDefaults = require('./simple-style-defaults');\nvar DefaultFormValues = require('../../../data/default-form-styles.json');\nvar Utils = require('../../../helpers/utils');\nvar rampList = require('cartocolor');\n\nmodule.exports = _.defaults({\n\n  _getAggrAttrs: function (geometryType) {\n    return {\n      aggregation: {\n        size: 10,\n        value: {\n          operator: 'count',\n          attribute: ''\n        }\n      }\n    };\n  },\n\n  _getStrokeAttrs: function (geometryType) {\n    var strokeAttrs = DefaultFormValues['stroke'];\n    return {\n      stroke: Utils.cloneObject(strokeAttrs)\n    };\n  },\n\n  _getFillAttrs: function (geometryType) {\n    var colors = rampList['ag_GrnYl'][5];\n    return {\n      fill: {\n        'color': {\n          attribute: 'agg_value',\n          bins: '5',\n          quantification: 'quantiles',\n          // TODO: flip the ramp when basemap is black\n          // range: rampList.ag_GrnYl[5].reverse()\n          range: Utils.cloneObject(colors)\n        }\n      }\n    };\n  }\n\n}, SimpleStyleDefaults);\n",
    "var _ = require('underscore');\nvar SimpleStyleDefaults = require('./simple-style-defaults');\nvar rampList = require('cartocolor');\n\nmodule.exports = _.defaults({\n  _getAggrAttrs: function (geometryType) {\n    return {\n      aggregation: {\n        dataset: 'countries',\n        change: 'manual',\n        value: {\n          operator: 'count',\n          attribute: ''\n        }\n      }\n    };\n  },\n\n  _getFillAttrs: function (geometryType) {\n    return {\n      fill: {\n        'color': {\n          attribute: 'agg_value_density',\n          bins: '5',\n          quantification: 'quantiles',\n          range: _.clone(rampList.Emrld[5])\n        }\n      }\n    };\n  }\n\n}, SimpleStyleDefaults);\n",
    "var _ = require('underscore');\nvar StyleDefaults = require('./style-defaults');\nvar DefaultCartography = require('../../../data/default-cartography.json');\nvar DefaultFormValues = require('../../../data/default-form-styles.json');\nvar Utils = require('../../../helpers/utils');\n\nmodule.exports = _.defaults({\n\n  generateAttributes: function (geometryType) {\n    return _.extend(\n      {},\n      this._getFillAttrs(geometryType),\n      this._getStrokeAttrs(geometryType),\n      {\n        blending: DefaultFormValues['blending']\n      },\n      this._getAggrAttrs(geometryType),\n      this._getLabelsAttrs()\n    );\n  },\n\n  _getFillAttrs: function (geometryType) {\n    var fillAttrs = DefaultCartography['simple'][geometryType]['fill'];\n    return {\n      fill: Utils.cloneObject(fillAttrs)\n    };\n  },\n\n  _getStrokeAttrs: function (geometryType) {\n    var strokeAttrs = DefaultCartography['simple'][geometryType]['stroke'];\n    return {\n      stroke: Utils.cloneObject(strokeAttrs)\n    };\n  },\n\n  _getAggrAttrs: function () {\n    var aggrAttrs = DefaultFormValues['aggregation'];\n    return {\n      aggregation: Utils.cloneObject(aggrAttrs)\n    };\n  },\n\n  _getLabelsAttrs: function () {\n    var labelsAttrs = DefaultFormValues['labels'];\n    return {\n      labels: Utils.cloneObject(labelsAttrs)\n    };\n  }\n}, StyleDefaults);\n",
    "var _ = require('underscore');\nvar HexabinsAggregationDefaults = require('./hexabins-aggregation-style-defaults');\n\nmodule.exports = _.defaults({\n\n  _getAggrAttrs: function (geometryType) {\n    return {\n      aggregation: {\n        size: 12,\n        value: {\n          operator: 'count',\n          attribute: ''\n        }\n      }\n    };\n  }\n\n}, HexabinsAggregationDefaults);\n",
    "module.exports = {\n  generateAttributes: function (geometryType) {\n    return {\n      fill: null,\n      stroke: null,\n      blending: null,\n      aggregation: {},\n      labels: {}\n    };\n  }\n};\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar StylesFactory = require('./styles-factory');\nvar UndoManager = require('../../data/undo-manager');\n\nmodule.exports = Backbone.Model.extend({\n\n  parse: function (r) {\n    r = r || {};\n    return _.extend(\n      {\n        type: r.type,\n        autogenerated: r && r.autogenerated\n      },\n      r.properties\n    );\n  },\n\n  initialize: function (attrs, opts) {\n    if (!this.get('type')) {\n      this.setDefaultPropertiesByType('simple', 'point');\n    }\n\n    UndoManager.init(this, { track: true });\n  },\n\n  resetPropertiesFromAutoStyle: function () {\n    if (this._stylesPreAutoStyle) {\n      delete this.attributes.autoStyle;\n      this.set(this._stylesPreAutoStyle);\n      this.removeStylesPreAutoStyle();\n    }\n  },\n\n  removeStylesPreAutoStyle: function () {\n    delete this._stylesPreAutoStyle;\n  },\n\n  setPropertiesFromAutoStyle: function (params) {\n    if (!params.definition) throw new Error('definition is required');\n    if (!params.geometryType) throw new Error('geometryType is required');\n    if (!params.widgetId) throw new Error('widgetId is required');\n\n    if (!this._stylesPreAutoStyle) {\n      this._stylesPreAutoStyle = JSON.parse(JSON.stringify(this.attributes));\n    }\n\n    // In order to trigger a proper change at the end of this function, we have\n    // to make a clear change in the attributes, like delete the autoStyle property.\n    delete this.attributes.autoStyle;\n\n    var extendAutoStyleProperties = function (attribute, newProperties) {\n      var properties = this.get(attribute);\n      // Check domain quotes\n      if (newProperties.color && newProperties.color.domain) {\n        var quotedDomain = _.compact(\n          _.map(newProperties.color.domain, function (name) {\n            if (name && name !== true) {\n              return '\"' + name.toString().replace(/\"/g, '\\\\\"').replace(/\\n/g, '\\\\n') + '\"';\n            } else {\n              return name;\n            }\n          })\n        );\n        newProperties.color.static = true;\n        newProperties.color.domain = quotedDomain;\n        newProperties.color.quantification = 'category';\n        newProperties.color.attribute_type = 'string';\n      } else {\n        newProperties.color.bins = newProperties.color.range.length;\n        newProperties.color.quantification = 'quantiles';\n        newProperties.color.attribute_type = 'number';\n      }\n\n      properties = _.extend(\n        properties,\n        newProperties\n      );\n\n      return properties;\n    }.bind(this);\n\n    var currentAttrs = JSON.parse(JSON.stringify(this.attributes));\n    if (params.geometryType === 'line') {\n      currentAttrs.stroke = extendAutoStyleProperties('stroke', params.definition[params.geometryType]);\n    } else {\n      currentAttrs.fill = extendAutoStyleProperties('fill', params.definition[params.geometryType]);\n    }\n\n    this.set(\n      _.extend(\n        {\n          type: 'simple',\n          autoStyle: params.widgetId\n        },\n        currentAttrs\n      )\n    );\n  },\n\n  setDefaultPropertiesByType: function (styleType, geometryType, silently) {\n    // Get default aggregation and properties from factory and apply them\n    this.set(\n      _.extend(\n        {\n          type: styleType\n        },\n        StylesFactory.getDefaultStyleAttrsByType(styleType, geometryType)\n      ), {\n        silently: !!silently\n      }\n    );\n\n    // Although we want to make the change silently, we have several places listening\n    // for style changes, so we trigger this custom event\n    if (silently) {\n      this.trigger('style:update');\n    }\n  },\n\n  setFill: function (type) {\n    var simpleFill = StylesFactory.getDefaultStyleAttrsByType(type, 'point');\n    this.set('fill', simpleFill.fill);\n  },\n\n  applyLastState: function () {\n    this._undoManager.stopTracking();\n    this.trigger('change');\n    this._undoManager.startTracking();\n  },\n\n  resetStyles: function () {\n    this.setDefaultPropertiesByType('none', '');\n  },\n\n  // Backend will migrate current wizard properties to style properties,\n  // providing a flag which indicates if it is generated by them\n  isAutogenerated: function () {\n    return this.get('autogenerated');\n  },\n\n  isAggregatedType: function () {\n    return _.contains(StylesFactory.getAggregationTypes(), this.get('type'));\n  },\n\n  isAnimation: function () {\n    return this.get('type') === 'animation';\n  },\n\n  hasNoneStyles: function () {\n    return this.get('type') === 'none';\n  },\n\n  canApplyAutoStyle: function () {\n    return this.get('type') === 'simple';\n  },\n\n  getColumnsUsedForStyle: function () {\n    var columns = [];\n    // Fill (size and color)\n    var fill = this.get('fill');\n    if (fill && fill.color && fill.color.attribute) {\n      columns.push({\n        name: fill.color.attribute,\n        type: fill.color.attribute_type || 'string'\n      });\n    }\n    if (fill && fill.size && fill.size.attribute) {\n      columns.push({\n        name: fill.size.attribute,\n        type: 'number'\n      });\n    }\n\n    // Stroke (size and color)\n    var stroke = this.get('stroke');\n    if (stroke && stroke.color && stroke.color.attribute) {\n      columns.push({\n        name: stroke.color.attribute,\n        type: stroke.color.attribute_type || 'string'\n      });\n    }\n    if (stroke && stroke.size && stroke.size.attribute) {\n      columns.push({\n        name: stroke.size.attribute,\n        type: 'number'\n      });\n    }\n\n    // Labels\n    var labels = this.get('labels');\n    if (labels && labels.attribute && labels.enabled) {\n      columns.push({\n        name: labels.attribute\n      });\n    }\n\n    // Aggregation\n    var aggregation = this.get('aggregation');\n    if (aggregation && aggregation.value && aggregation.value.attribute) {\n      columns.push({\n        name: aggregation.value.attribute,\n        type: aggregation.value.attribute_type || 'string'\n      });\n    }\n\n    return columns;\n  },\n\n  // Unflatten attributes\n  toJSON: function () {\n    return {\n      type: this.get('type'),\n      properties: _.omit(this.attributes, 'type', 'autogenerated')\n    };\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<h2 class=\"CDB-Text CDB-Size-huge is-light u-secondaryTextColor js-styleNoGeom\">'+\n((__t=( _t('editor.style.style-form.properties.placeholder-text') ))==null?'':_.escape(__t))+\n'</h2>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-HeaderInfo\">\\n  <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">1</div>\\n  <div class=\"Editor-HeaderInfo-inner CDB-Text js-selector\">\\n    <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n      <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.style.style-form.type.title-label') ))==null?'':_.escape(__t))+\n'</h2>\\n    </div>\\n    <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m js-highlight\">'+\n((__t=( name ))==null?'':_.escape(__t))+\n'</p>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<h2 class=\"CDB-Text CDB-Size-huge is-light u-secondaryTextColor\">\\n  '+\n((__t=( _t('editor.style.messages.none') ))==null?'':_.escape(__t))+\n'\\n</h2>\\n';\n}\nreturn __p;\n};\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nrequire('../../../../components/form-components/index');\nvar StyleShapeFormModel = require('./style-aggregation-properties-form-model');\nvar template = require('./style-aggregation-form.tpl');\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    if (!opts.querySchemaModel) throw new Error('querySchemaModel is required');\n    if (!opts.queryGeometryModel) throw new Error('queryGeometryModel is required');\n    if (!opts.styleModel) throw new Error('styleModel is required');\n    if (!opts.modals) throw new Error('modals is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.userModel) throw new Error('userModel is required');\n\n    this._queryGeometryModel = opts.queryGeometryModel;\n    this._querySchemaModel = opts.querySchemaModel;\n    this._styleModel = opts.styleModel;\n    this._configModel = opts.configModel;\n    this._userModel = opts.userModel;\n    this._modals = opts.modals;\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this._removeFormView();\n    this.$el.html(template());\n    this._initViews();\n    return this;\n  },\n\n  _initViews: function () {\n    this._aggrFormModel = new StyleShapeFormModel(\n      this._styleModel.get('aggregation'),\n      {\n        queryGeometryModel: this._queryGeometryModel,\n        querySchemaModel: this._querySchemaModel,\n        styleModel: this._styleModel,\n        configModel: this._configModel,\n        userModel: this._userModel,\n        modals: this._modals\n      }\n    );\n\n    this._aggrFormView = new Backbone.Form({\n      model: this._aggrFormModel\n    });\n\n    this._aggrFormView.bind('change', function () {\n      this.commit();\n    });\n\n    this.$('.js-aggregationForm').append(this._aggrFormView.render().el);\n  },\n\n  _removeFormView: function () {\n    if (this._aggrFormView) {\n      this._aggrFormView.remove();\n    }\n  },\n\n  clean: function () {\n    this._removeFormView();\n    CoreView.prototype.clean.call(this);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-HeaderInfo js-aggregationOptions\">\\n  <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">2</div>\\n  <div class=\"Editor-HeaderInfo-inner CDB-Text js-selector\">\\n    <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n      <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.style.style-form.aggregation.title-label') ))==null?'':_.escape(__t))+\n'</h2>\\n    </div>\\n    <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m js-highlight\">'+\n((__t=( _t('editor.style.style-form.aggregation.desc') ))==null?'':_.escape(__t))+\n'</p>\\n    <div class=\"js-aggregationForm\"></div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar StyleFormDefaultModel = require('../style-form-default-model');\n\nmodule.exports = StyleFormDefaultModel.extend({\n\n  _FORM_NAME: 'aggregation',\n\n  _onChange: function () {\n    this._styleModel.set('aggregation', _.clone(this.attributes));\n  }\n\n});\n",
    "var _ = require('underscore');\nvar FONTS_LIST = [\n  'DejaVu Sans Book',\n  'unifont Medium',\n  'Open Sans Regular',\n  'Lato Regular',\n  'Lato Bold',\n  'Lato Bold Italic',\n  'Graduate Regular',\n  'Gravitas One Regular',\n  'Old Standard TT Regular',\n  'Old Standard TT Italic',\n  'Old Standard TT Bold'\n];\n\n// Depending the type of the style, if could provide different schema values\nfunction getOptionsByStyleType (params) {\n  if (!params.querySchemaModel) throw new Error('querySchemaModel is required');\n  var optionsArray = getSchemaColumns(params.querySchemaModel, params.filterFunction);\n\n  switch (params.styleType) {\n    case 'heatmap':\n      optionsArray = [{\n        val: 'cartodb_id',\n        label: 'cartodb_id',\n        type: 'number'\n      }];\n      break;\n    case 'regions':\n      optionsArray = [{\n        val: 'agg_value',\n        label: 'agg_value',\n        type: 'number'\n      }, {\n        val: 'agg_value_density',\n        label: 'agg_value_density',\n        type: 'number'\n      }];\n      break;\n    case 'hexabins':\n    case 'squares':\n      optionsArray = [{\n        val: 'agg_value',\n        label: 'agg_value',\n        type: 'number'\n      }];\n      break;\n    case 'animation':\n      if (params.animationType === 'heatmap') {\n        optionsArray = [{\n          val: 'cartodb_id',\n          label: 'cartodb_id',\n          type: 'number'\n        }];\n      }\n      break;\n    default:\n      // Nothing\n  }\n\n  return optionsArray;\n}\n\n// Provide an array of columns from the current schema\nfunction getSchemaColumns (querySchemaModel, filterFunction) {\n  if (!querySchemaModel) throw new Error('querySchemaModel is required');\n\n  var columnsCollection = querySchemaModel.columnsCollection;\n  if (filterFunction) {\n    columnsCollection = columnsCollection.filter(filterFunction);\n  }\n  return columnsCollection\n    .map(function (m) {\n      var columnName = m.get('name');\n      return {\n        val: columnName,\n        label: columnName,\n        type: m.get('type')\n      };\n    });\n}\n\nfunction generateSelectByStyleType (params) {\n  if (!params.componentName) throw new Error('componentName is required');\n  if (!params.querySchemaModel) throw new Error('querySchemaModel is required');\n  if (!params.styleType) throw new Error('styleType is required');\n\n  var queryStatus = params.querySchemaModel.get('status');\n  var isDisabled = queryStatus !== 'fetched';\n  var helpMessage = _t('editor.style.components.' + params.componentName + '.' + queryStatus);\n\n  return {\n    type: 'Select',\n    title: _t('editor.style.components.' + params.componentName + '.label'),\n    help: isDisabled ? helpMessage : '',\n    options: getOptionsByStyleType({\n      querySchemaModel: params.querySchemaModel,\n      filterFunction: params.filterFunction,\n      styleType: params.styleType\n    }),\n    dialogMode: 'float',\n    editorAttrs: { disabled: isDisabled },\n    validators: ['required']\n  };\n}\n\nfunction generateSelectWithSchemaColumns (componentName, querySchemaModel, filterFunction) {\n  var queryStatus = querySchemaModel.get('status');\n  var isDisabled = queryStatus !== 'fetched';\n  var helpMessage = _t('editor.style.components.' + componentName + '.' + queryStatus);\n\n  return {\n    type: 'Select',\n    title: _t('editor.style.components.' + componentName + '.label'),\n    help: isDisabled ? helpMessage : '',\n    options: getSchemaColumns(querySchemaModel, filterFunction),\n    editorAttrs: { disabled: isDisabled },\n    dialogMode: 'float',\n    validators: ['required']\n  };\n}\n\nfunction generateSimpleStroke (params) {\n  if (!params.querySchemaModel) throw new Error('querySchemaModel is required');\n  if (!params.configModel) throw new Error('configModel is required');\n  if (!params.userModel) throw new Error('userModel is required');\n  if (!params.modals) throw new Error('modals is required');\n\n  return {\n    type: 'Fill',\n    title: _t('editor.style.components.stroke.label'),\n    options: [],\n    query: params.querySchemaModel.get('query'),\n    configModel: params.configModel,\n    userModel: params.userModel,\n    modals: params.modals,\n    dialogMode: 'float',\n    editorAttrs: {\n      size: {\n        min: 0,\n        max: 10,\n        step: 0.5,\n        hidePanes: ['value']\n      },\n      color: {\n        hidePanes: ['value']\n      }\n    },\n    validators: ['required']\n  };\n}\n\nfunction generateLineStroke (params) {\n  if (!params.querySchemaModel) throw new Error('querySchemaModel is required');\n  if (!params.configModel) throw new Error('configModel is required');\n  if (!params.styleType) throw new Error('styleType is required');\n  if (!params.userModel) throw new Error('userModel is required');\n  if (!params.modals) throw new Error('modals is required');\n\n  var queryStatus = params.querySchemaModel.get('status');\n  var isDisabled = queryStatus !== 'fetched';\n  var helpMessage = _t('editor.style.components.stroke.' + queryStatus);\n\n  return {\n    type: 'Fill',\n    title: _t('editor.style.components.stroke.label'),\n    help: isDisabled ? helpMessage : '',\n    options: getOptionsByStyleType({\n      querySchemaModel: params.querySchemaModel,\n      styleType: params.styleType\n    }),\n    query: params.querySchemaModel.get('query'),\n    configModel: params.configModel,\n    userModel: params.userModel,\n    modals: params.modals,\n    dialogMode: 'float',\n    editorAttrs: {\n      min: 0,\n      max: 50,\n      disabled: isDisabled\n    },\n    validators: ['required']\n  };\n}\n\n/*\n *  Dictionary that contains all the necessary components\n *  for the styles form\n */\n\nmodule.exports = {\n  'fill': function (params) {\n    var editorAttrs = {\n      size: {\n        min: 1,\n        max: 45,\n        step: 0.5\n      }\n    };\n    var options = getOptionsByStyleType({\n      querySchemaModel: params.querySchemaModel,\n      styleType: params.styleType,\n      animationType: params.animationType\n    });\n    var isPointGeometry = params.queryGeometryModel && params.queryGeometryModel.get('simple_geom') === 'point';\n\n    if (params.styleType === 'heatmap') {\n      editorAttrs.size.hidePanes = ['value'];\n      editorAttrs.color = {\n        hidePanes: ['fixed']\n      };\n    } else if (params.styleType === 'simple' && isPointGeometry && !params.isAutoStyleApplied) {\n      editorAttrs.color = {\n        imageEnabled: true\n      };\n    }\n\n    if (params.styleType === 'animation') {\n      editorAttrs.size.hidePanes = ['value'];\n\n      if (params.animationType === 'simple') {\n        editorAttrs.color = {\n          categorizeColumns: true\n        };\n      } else {\n        editorAttrs.color = {\n          hidePanes: ['fixed']\n        };\n      }\n    }\n\n    return {\n      type: 'Fill',\n      title: _t('editor.style.components.fill'),\n      options: options,\n      query: params.querySchemaModel.get('query'),\n      configModel: params.configModel,\n      userModel: params.userModel,\n      validators: ['required'],\n      editorAttrs: editorAttrs,\n      modals: params.modals,\n      dialogMode: 'float'\n    };\n  },\n\n  'stroke': function (params) {\n    if (params.queryGeometryModel.get('simple_geom') === 'line') {\n      return generateLineStroke({\n        querySchemaModel: params.querySchemaModel,\n        styleType: params.styleType,\n        configModel: params.configModel,\n        userModel: params.userModel,\n        modals: params.modals\n      });\n    } else {\n      return generateSimpleStroke({\n        querySchemaModel: params.querySchemaModel,\n        configModel: params.configModel,\n        userModel: params.userModel,\n        modals: params.modals\n      });\n    }\n  },\n\n  'blending': function (params) {\n    var animationOptions = ['lighter', 'multiply', 'source-over', 'xor'];\n    var simpleOptions = ['none', 'multiply', 'screen', 'overlay', 'darken', 'lighten',\n      'color-dodge', 'color-burn', 'xor', 'src-over'];\n    var labelTranslate = 'editor.style.components.blending.options';\n\n    var generateBlendingOptions = function (options) {\n      return _.reduce(options, function (memo, option) {\n        memo.push({\n          val: option,\n          label: _t(labelTranslate + '.' + option)\n        });\n        return memo;\n      }, []);\n    };\n\n    return {\n      type: 'Select',\n      title: _t('editor.style.components.blending.label'),\n      options: generateBlendingOptions(params.styleType === 'animation' ? animationOptions : simpleOptions),\n      dialogMode: 'float'\n    };\n  },\n\n  'style': function () {\n    return {\n      type: 'Radio',\n      title: _t('editor.style.components.type.label'),\n      options: [\n        {\n          val: 'simple',\n          label: _t('editor.style.components.type.options.points')\n        }, {\n          val: 'heatmap',\n          label: _t('editor.style.components.type.options.heatmap')\n        }\n      ]\n    };\n  },\n\n  'aggregation-size': function () {\n    return {\n      type: 'Number',\n      title: _t('editor.style.components.aggregation-size.label'),\n      help: _t('editor.style.components.aggregation-size.help'),\n      validators: ['required', {\n        type: 'interval',\n        min: 10,\n        max: 100\n      }]\n    };\n  },\n\n  'aggregation-dataset': function () {\n    return {\n      type: 'Select',\n      title: _t('editor.style.components.aggregation-dataset'),\n      dialogMode: 'float',\n      options: [\n        {\n          val: 'countries'\n        }, {\n          val: 'provinces'\n        }\n      ]\n    };\n  },\n\n  'aggregation-value': function (params) {\n    return {\n      type: 'Operators',\n      title: _t('editor.style.components.aggregation-value'),\n      options: getSchemaColumns(params.querySchemaModel),\n      dialogMode: 'float'\n    };\n  },\n\n  'labels-enabled': function () {\n    return {\n      type: 'Hidden'\n    };\n  },\n\n  'labels-attribute': function (params) {\n    var filterFunction = function (item) {\n      var columnName = item.get('name');\n      var columnType = item.get('type');\n      return (columnName !== 'the_geom' && columnName !== 'the_geom_webmercator' && columnType !== 'date');\n    };\n    return generateSelectByStyleType({\n      componentName: 'labels-attribute',\n      querySchemaModel: params.querySchemaModel,\n      styleType: params.styleType,\n      filterFunction: filterFunction\n    });\n  },\n\n  'labels-fill': function () {\n    return {\n      type: 'Fill',\n      title: _t('editor.style.components.labels-fill'),\n      options: [],\n      dialogMode: 'float',\n      editorAttrs: {\n        size: {\n          min: 6,\n          max: 24,\n          hidePanes: ['value']\n        },\n        color: {\n          hidePanes: ['value']\n        }\n      },\n      validators: ['required']\n    };\n  },\n\n  'labels-halo': function () {\n    return {\n      type: 'Fill',\n      title: _t('editor.style.components.labels-halo'),\n      options: [],\n      dialogMode: 'float',\n      editorAttrs: {\n        size: {\n          hidePanes: ['value']\n        },\n        color: {\n          hidePanes: ['value']\n        }\n      },\n      validators: ['required']\n    };\n  },\n\n  'labels-font': function () {\n    return {\n      type: 'Select',\n      dialogMode: 'float',\n      options: FONTS_LIST\n    };\n  },\n\n  'labels-offset': function () {\n    return {\n      type: 'Number',\n      title: _t('editor.style.components.labels-offset'),\n      validators: ['required', {\n        type: 'interval',\n        min: -15,\n        max: 15\n      }]\n    };\n  },\n\n  'labels-overlap': function () {\n    return {\n      type: 'Radio',\n      title: _t('editor.style.components.labels-overlap.label'),\n      options: [\n        {\n          val: 'true',\n          label: _t('editor.style.components.labels-overlap.options.true')\n        }, {\n          val: 'false',\n          label: _t('editor.style.components.labels-overlap.options.false')\n        }\n      ]\n    };\n  },\n\n  'labels-placement': function () {\n    var placements = ['point', 'line', 'vertex', 'interior'];\n    var translateLabel = 'editor.style.components.labels-placement.options';\n\n    return {\n      type: 'Select',\n      title: _t('editor.style.components.labels-placement.label'),\n      dialogMode: 'float',\n      options: _.reduce(placements, function (memo, type) {\n        memo.push({\n          val: type,\n          label: _t(translateLabel + '.' + type)\n        });\n        return memo;\n      }, []),\n      editorAttrs: {\n        showSearch: false\n      }\n    };\n  },\n\n  'animated-enabled': function () {\n    return {\n      type: 'Hidden'\n    };\n  },\n\n  'animated-attribute': function (params) {\n    var filterFunction = function (item) {\n      var columnType = item.get('type');\n      if (columnType && (columnType === 'number' || columnType === 'date')) {\n        return true;\n      }\n      return false;\n    };\n\n    if (params.styleType === 'heatmap') {\n      return generateSelectWithSchemaColumns({\n        componentName: 'animated-attribute',\n        querySchemaModel: params.querySchemaModel,\n        filterFunction: filterFunction\n      });\n    } else {\n      return generateSelectByStyleType({\n        componentName: 'animated-attribute',\n        querySchemaModel: params.querySchemaModel,\n        filterFunction: filterFunction,\n        styleType: params.styleType\n      });\n    }\n  },\n\n  'animated-overlap': function () {\n    return {\n      type: 'Radio',\n      title: _t('editor.style.components.animated-overlap.label'),\n      options: [\n        {\n          val: 'false',\n          label: _t('editor.style.components.animated-overlap.options.false')\n        }, {\n          val: 'true',\n          label: _t('editor.style.components.animated-overlap.options.true')\n        }\n      ]\n    };\n  },\n\n  'animated-duration': function () {\n    return {\n      type: 'Number',\n      title: _t('editor.style.components.animated-duration'),\n      validators: ['required', {\n        type: 'interval',\n        min: 0,\n        max: 60\n      }]\n    };\n  },\n\n  'animated-steps': function () {\n    return {\n      type: 'Number',\n      title: _t('editor.style.components.animated-steps'),\n      validators: ['required', {\n        type: 'interval',\n        min: 1,\n        max: 1024,\n        step: 4\n      }]\n    };\n  },\n\n  'animated-trails': function () {\n    return {\n      type: 'Number',\n      title: _t('editor.style.components.animated-trails'),\n      validators: ['required', {\n        type: 'interval',\n        min: 0,\n        max: 30\n      }]\n    };\n  },\n\n  'animated-resolution': function () {\n    return {\n      type: 'Number',\n      title: _t('editor.style.components.animated-resolution'),\n      validators: ['required', {\n        type: 'interval',\n        min: 1,\n        max: 16\n      }]\n    };\n  }\n};\n",
    "var Backbone = require('backbone');\nvar _ = require('underscore');\nvar StyleFormComponents = require('./style-form-components-dictionary');\nvar DEBOUNCE_TIME = 350;\n\nmodule.exports = Backbone.Model.extend({\n\n  _FORM_NAME: '',\n\n  initialize: function (attrs, opts) {\n    if (!opts.styleModel) throw new Error('Style model is required');\n    if (!opts.modals) throw new Error('modals is required');\n    this._styleModel = opts.styleModel;\n    this._querySchemaModel = opts.querySchemaModel;\n    this._queryGeometryModel = opts.queryGeometryModel;\n    this._configModel = opts.configModel;\n    this._userModel = opts.userModel;\n    this._modals = opts.modals;\n    this.schema = this._generateSchema();\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this.bind('change', _.debounce(this._onChange.bind(this), DEBOUNCE_TIME), this);\n  },\n\n  _onChange: function () {\n    throw new Error('_onChange should be defined');\n  },\n\n  _generateSchema: function () {\n    var querySchemaModel = this._querySchemaModel;\n    var queryGeometryModel = this._queryGeometryModel;\n    var configModel = this._configModel;\n    var userModel = this._userModel;\n    var modals = this._modals;\n    var styleType = this._styleModel.get('type');\n    var isAutoStyleApplied = this._styleModel.has('autoStyle');\n    var animationType = this._styleModel.get('style');\n    var formName = this._FORM_NAME ? (this._FORM_NAME + '-') : '';\n\n    return _.reduce(this.attributes, function (memo, value, key) {\n      var d = StyleFormComponents[formName + key];\n      if (d) {\n        memo[key] = d({\n          styleType: styleType,\n          isAutoStyleApplied: isAutoStyleApplied,\n          animationType: animationType,\n          querySchemaModel: querySchemaModel,\n          queryGeometryModel: queryGeometryModel,\n          modals: modals,\n          userModel: userModel,\n          configModel: configModel\n        });\n      }\n      return memo;\n    }, {});\n  }\n\n});\n",
    "var CoreView = require('backbone/core-view');\nvar StylePropertiesFormView = require('./style-properties-form/style-properties-form-view');\nvar StyleAggregationFormView = require('./style-aggregation-form/style-aggregation-form-view');\nvar noneFormMessage = require('./none-form-message.tpl');\n\nmodule.exports = CoreView.extend({\n\n  className: 'Editor-formView',\n\n  initialize: function (opts) {\n    if (!opts.layerDefinitionsCollection) throw new Error('layerDefinitionsCollection is required');\n    if (!opts.layerDefinitionModel) throw new Error('layerDefinitionModel is required');\n    if (!opts.querySchemaModel) throw new Error('querySchemaModel is required');\n    if (!opts.queryGeometryModel) throw new Error('queryGeometryModel is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.styleModel) throw new Error('styleModel is required');\n    if (!opts.modals) throw new Error('modals is required');\n\n    this._querySchemaModel = opts.querySchemaModel;\n    this._queryGeometryModel = opts.queryGeometryModel;\n    this._configModel = opts.configModel;\n    this._userModel = opts.userModel;\n    this._layerDefinitionsCollection = opts.layerDefinitionsCollection;\n    this._layerDefinitionModel = opts.layerDefinitionModel;\n    this._styleModel = opts.styleModel;\n    this._modals = opts.modals;\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    if (this._styleModel.get('type') === 'none') {\n      this._renderNoneMessage();\n    } else {\n      this._initFormViews();\n    }\n    return this;\n  },\n\n  _initBinds: function () {\n    this._styleModel.bind('change:type', this.render, this);\n    this.add_related_model(this._styleModel);\n  },\n\n  _renderNoneMessage: function () {\n    this.$el.append(noneFormMessage());\n  },\n\n  _initFormViews: function () {\n    if (this._styleModel.isAggregatedType()) {\n      var aggregationFormView = new StyleAggregationFormView({\n        styleModel: this._styleModel,\n        queryGeometryModel: this._queryGeometryModel,\n        querySchemaModel: this._querySchemaModel,\n        configModel: this._configModel,\n        userModel: this._userModel,\n        modals: this._modals\n      });\n\n      this.addView(aggregationFormView);\n      this.$el.append(aggregationFormView.render().el);\n    }\n\n    var propertiesFormView = new StylePropertiesFormView({\n      styleModel: this._styleModel,\n      layerDefinitionsCollection: this._layerDefinitionsCollection,\n      configModel: this._configModel,\n      userModel: this._userModel,\n      layerDefinitionModel: this._layerDefinitionModel,\n      queryGeometryModel: this._queryGeometryModel,\n      querySchemaModel: this._querySchemaModel,\n      modals: this._modals\n    });\n\n    this.addView(propertiesFormView);\n    this.$el.append(propertiesFormView.render().el);\n  }\n});\n",
    "var _ = require('underscore');\nvar StyleFormDefaultModel = require('../style-form-default-model');\nvar StyleFormComponents = require('../style-form-components-dictionary');\n\nmodule.exports = StyleFormDefaultModel.extend({\n\n  _FORM_NAME: 'animated',\n\n  parse: function (r, opts) {\n    var querySchema = opts.querySchemaModel;\n    var columnAnimatable = querySchema.columnsCollection.findWhere(function (colModel) {\n      return colModel.get('type') === 'number' || colModel.get('type') === 'date';\n    });\n\n    return _.extend(\n      r,\n      {\n        attribute: r.attribute || (columnAnimatable && columnAnimatable.get('name')),\n        overlap: r.overlap && r.overlap.toString()\n      }\n    );\n  },\n\n  _onChange: function () {\n    var animatedData = _.extend(\n      {},\n      this.attributes,\n      {\n        overlap: this.get('overlap') === 'true'\n      }\n    );\n\n    // Don't update style model if there is no attribute selected\n    if (!animatedData.attribute) {\n      return false;\n    }\n\n    this._styleModel.set('animated', animatedData);\n  },\n\n  _generateSchema: function () {\n    var styleType = this._styleModel.get('type');\n\n    if (styleType === 'heatmap') {\n      return {\n        resolution: StyleFormComponents['animated-resolution']()\n      };\n    } else {\n      return StyleFormDefaultModel.prototype._generateSchema.call(this);\n    }\n  }\n});\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nrequire('../../../../components/form-components/index');\nvar StyleAnimatedFormModel = require('./style-animated-properties-form-model');\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    if (!opts.layerDefinitionsCollection) throw new Error('layerDefinitionsCollection is required');\n    if (!opts.layerDefinitionModel) throw new Error('layerDefinitionModel is required');\n    if (!opts.querySchemaModel) throw new Error('querySchemaModel is required');\n    if (!opts.queryGeometryModel) throw new Error('queryGeometryModel is required');\n    if (!opts.styleModel) throw new Error('styleModel is required');\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.modals) throw new Error('modals is required');\n\n    this._userModel = opts.userModel;\n    this._modals = opts.modals;\n\n    this._querySchemaModel = opts.querySchemaModel;\n    this._queryGeometryModel = opts.queryGeometryModel;\n    this._layerDefinitionsCollection = opts.layerDefinitionsCollection;\n    this._layerDefinitionModel = opts.layerDefinitionModel;\n    this._styleModel = opts.styleModel;\n\n    this._animatedFormModel = new StyleAnimatedFormModel(\n      this._styleModel.get('animated'),\n      {\n        parse: true,\n        querySchemaModel: this._querySchemaModel,\n        queryGeometryModel: this._queryGeometryModel,\n        styleModel: this._styleModel,\n        userModel: this._userModel,\n        modals: this._modals\n      }\n    );\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this._genAnimatedFormView();\n    return this;\n  },\n\n  _genAnimatedFormView: function () {\n    this._animatedFormView = new Backbone.Form({\n      model: this._animatedFormModel\n    });\n\n    this._animatedFormView.bind('change', function () {\n      this.commit();\n    });\n\n    this.$el.append(this._animatedFormView.render().el);\n  },\n\n  _removeAnimatedFormView: function () {\n    if (this._animatedFormView) {\n      this._animatedFormView.remove();\n      this._animatedFormView.$el.empty();\n    }\n  },\n\n  clean: function () {\n    this._removeAnimatedFormView();\n    CoreView.prototype.clean.call(this);\n  }\n});\n",
    "var _ = require('underscore');\nvar StyleFormDefaultModel = require('../style-form-default-model');\n\nmodule.exports = StyleFormDefaultModel.extend({\n\n  _FORM_NAME: 'labels',\n\n  _onChange: function () {\n    var labelsData = _.extend(\n      {},\n      this.attributes\n    );\n\n    // Don't update style model if there is no attribute selected\n    if (labelsData.enabled && !labelsData.attribute) {\n      return false;\n    }\n\n    this._styleModel.set('labels', labelsData);\n  }\n});\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nrequire('../../../../components/form-components/index');\nvar StyleLabelsFormModel = require('./style-labels-properties-form-model');\n\nmodule.exports = CoreView.extend({\n\n  className: 'u-tSpace-xl',\n\n  initialize: function (opts) {\n    if (!opts.queryGeometryModel) throw new Error('queryGeometryModel is required');\n    if (!opts.querySchemaModel) throw new Error('querySchemaModel is required');\n    if (!opts.styleModel) throw new Error('styleModel is required');\n    if (!opts.modals) throw new Error('modals is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.userModel) throw new Error('userModel is required');\n\n    this._queryGeometryModel = opts.queryGeometryModel;\n    this._querySchemaModel = opts.querySchemaModel;\n    this._styleModel = opts.styleModel;\n    this._configModel = opts.configModel;\n    this._userModel = opts.userModel;\n    this._modals = opts.modals;\n\n    this._labelsFormModel = new StyleLabelsFormModel(\n      this._styleModel.get('labels'),\n      {\n        parse: true,\n        queryGeometryModel: this._queryGeometryModel,\n        querySchemaModel: this._querySchemaModel,\n        styleModel: this._styleModel,\n        configModel: this._configModel,\n        userModel: this._userModel,\n        modals: this._modals\n      }\n    );\n\n    this._enablerModel = new Backbone.Model({\n      enabler: this._styleModel.get('labels').enabled\n    });\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.$el.empty();\n    this._initLabelsEnablerView();\n    return this;\n  },\n\n  _initBinds: function () {\n    this._styleModel.bind('change:type', function () {\n      var isAnimatedEnabled = this._styleModel.get('type') === 'animation';\n      if (isAnimatedEnabled) {\n        this._enablerView.setValue(false);\n      }\n    }, this);\n    this.add_related_model(this._styleModel);\n  },\n\n  _initLabelsEnablerView: function () {\n    var helpMessage = _t('editor.style.components.labels-enabled.not-with-animated');\n    var isAnimatedVisible = this._queryGeometryModel.get('simple_geom') === 'point';\n\n    this._enablerView = new Backbone.Form.editors.Enabler({\n      model: this._enablerModel,\n      title: _t('editor.style.components.labels-enabled.label'),\n      help: isAnimatedVisible ? helpMessage : '',\n      key: 'enabler'\n    });\n\n    this._enablerModel.bind('change', this._setLabelsFormView, this);\n    this.add_related_model(this._enablerModel);\n    this.$el.append(this._enablerView.render().el);\n\n    this._setLabelsFormView();\n  },\n\n  _setLabelsFormView: function () {\n    var isEnabled = this._enablerModel.get('enabler');\n    this._updateFormModel();\n    if (isEnabled) {\n      this._genLabelsFormView();\n    } else {\n      this._removeLabelsFormView();\n    }\n  },\n\n  _updateFormModel: function () {\n    this._labelsFormModel.set('enabled', this._enablerModel.get('enabler'));\n  },\n\n  _genLabelsFormView: function () {\n    this._labelsFormView = new Backbone.Form({\n      className: 'Editor-formInner--nested',\n      model: this._labelsFormModel\n    });\n\n    this._labelsFormView.bind('change', function () {\n      this.commit();\n    });\n\n    this.$el.append(this._labelsFormView.render().el);\n  },\n\n  _removeLabelsFormView: function () {\n    if (this._labelsFormView) {\n      this._labelsFormView.remove();\n      this._labelsFormView.$el.empty();\n    }\n  },\n\n  clean: function () {\n    this._removeLabelsFormView();\n    CoreView.prototype.clean.call(this);\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar StyleLabelsPropertiesFormView = require('./style-labels-properties-form-view');\nvar StyleAnimatedPropertiesFormView = require('./style-animated-properties-form-view');\nvar StyleShapePropertiesFormView = require('./style-shape-properties-form-view');\nvar StyleNotAnimatableView = require('./style-unanimatable-view');\nvar template = require('./style-properties-form.tpl');\n\nvar TYPES = {\n  HEATMAP: 'heatmap',\n  ANIMATION: 'animation'\n};\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    if (!opts.layerDefinitionsCollection) throw new Error('layerDefinitionsCollection is required');\n    if (!opts.querySchemaModel) throw new Error('querySchemaModel is required');\n    if (!opts.queryGeometryModel) throw new Error('queryGeometryModel is required');\n    if (!opts.styleModel) throw new Error('styleModel is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.layerDefinitionModel) throw new Error('layerDefinitionModel is required');\n    if (!opts.modals) throw new Error('modals is required');\n\n    this._layerDefinitionsCollection = opts.layerDefinitionsCollection;\n    this._layerDefinitionModel = opts.layerDefinitionModel;\n    this._querySchemaModel = opts.querySchemaModel;\n    this._queryGeometryModel = opts.queryGeometryModel;\n    this._styleModel = opts.styleModel;\n    this._configModel = opts.configModel;\n    this._userModel = opts.userModel;\n    this._modals = opts.modals;\n  },\n\n  render: function () {\n    this.clearSubViews();\n    var stepNumber = this._styleModel.isAggregatedType() ? 3 : 2;\n    var simpleGeometry = this._queryGeometryModel.get('simple_geom');\n\n    if (simpleGeometry !== 'point') {\n      stepNumber--;\n    }\n\n    this.$el.html(\n      template({\n        stepNumber: stepNumber,\n        simpleGeometry: simpleGeometry\n      })\n    );\n    this._initViews();\n    return this;\n  },\n\n  _initViews: function () {\n    var styleType = this._styleModel.get('type');\n    var animatedFormView;\n    var shapeFormView;\n    var labelsFormView;\n\n    if (this._isUnanimatable()) {\n      shapeFormView = new StyleNotAnimatableView({\n        layerDefinitionModel: this._layerDefinitionModel,\n        userModel: this._userModel,\n        configModel: this._configModel,\n        modals: this._modals\n      });\n      this.addView(shapeFormView);\n      this.$('.js-propertiesForm').append(shapeFormView.render().el);\n    } else {\n      shapeFormView = new StyleShapePropertiesFormView({\n        styleModel: this._styleModel,\n        queryGeometryModel: this._queryGeometryModel,\n        querySchemaModel: this._querySchemaModel,\n        configModel: this._configModel,\n        userModel: this._userModel,\n        modals: this._modals\n      });\n      this.addView(shapeFormView);\n      this.$('.js-propertiesForm').append(shapeFormView.render().el);\n\n      if (styleType !== TYPES.HEATMAP && styleType !== TYPES.ANIMATION) {\n        labelsFormView = new StyleLabelsPropertiesFormView({\n          styleModel: this._styleModel,\n          queryGeometryModel: this._queryGeometryModel,\n          querySchemaModel: this._querySchemaModel,\n          configModel: this._configModel,\n          userModel: this._userModel,\n          modals: this._modals\n        });\n        this.addView(labelsFormView);\n        this.$('.js-propertiesForm').append(labelsFormView.render().el);\n      }\n\n      if (this._queryGeometryModel.get('simple_geom') === 'point' && (styleType === TYPES.ANIMATION || styleType === TYPES.HEATMAP)) {\n        animatedFormView = new StyleAnimatedPropertiesFormView({\n          layerDefinitionsCollection: this._layerDefinitionsCollection,\n          layerDefinitionModel: this._layerDefinitionModel,\n          styleModel: this._styleModel,\n          queryGeometryModel: this._queryGeometryModel,\n          querySchemaModel: this._querySchemaModel,\n          userModel: this._userModel,\n          configModel: this._configModel,\n          modals: this._modals\n        });\n\n        this.addView(animatedFormView);\n        this.$('.js-propertiesForm').append(animatedFormView.render().el);\n      }\n    }\n  },\n\n  _isUnanimatable: function () {\n    return this._querySchemaModel.columnsCollection.filter(function (colModel) {\n      return colModel.get('type') === 'number' || colModel.get('type') === 'date';\n    }).length === 0 && this._styleModel.get('type') === 'animated';\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-HeaderInfo js-styleProperties\">\\n  <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">'+\n((__t=( stepNumber ))==null?'':_.escape(__t))+\n'</div>\\n  <div class=\"Editor-HeaderInfo-inner CDB-Text js-selector\">\\n    <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n      <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">\\n        '+\n((__t=( _t('editor.style.style-form.properties.title-label-' + simpleGeometry) ))==null?'':_.escape(__t))+\n'\\n      </h2>\\n    </div>\\n    <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m js-highlight\">'+\n((__t=( _t('editor.style.style-form.properties.desc') ))==null?'':_.escape(__t))+\n'</p>\\n    <div class=\"js-propertiesForm\"></div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar StylesFactory = require('../../styles-factory');\nvar StyleFormDefaultModel = require('../style-form-default-model');\n\nvar TYPES = {\n  HEATMAP: 'heatmap',\n  ANIMATION: 'animation'\n};\n\nmodule.exports = StyleFormDefaultModel.extend({\n\n  parse: function (r) {\n    var geom = r.geom;\n    var attrs = {\n      style: r.style,\n      fill: r.fill,\n      stroke: r.stroke,\n      blending: r.blending\n    };\n    var isAggregatedType = _.contains(StylesFactory.getAggregationTypes(), r.type);\n\n    if (isAggregatedType || geom === 'polygon') {\n      if (attrs.fill.size) {\n        attrs.fill = _.omit(attrs.fill, 'size');\n      }\n    }\n\n    if (geom === 'line') {\n      attrs = _.omit(attrs, 'fill');\n    }\n\n    if (r.type === TYPES.HEATMAP || (r.type === TYPES.ANIMATION && r.style === 'heatmap')) {\n      attrs = _.omit(attrs, 'stroke', 'blending');\n    }\n\n    if (r.type !== TYPES.ANIMATION) {\n      attrs = _.omit(attrs, 'style');\n    }\n\n    return attrs;\n  },\n\n  _onChange: function () {\n    this._styleModel.set(_.clone(this.attributes));\n  }\n\n});\n",
    "var Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nrequire('../../../../components/form-components/index');\nvar StyleShapeFormModel = require('./style-shape-properties-form-model');\n\nmodule.exports = CoreView.extend({\n\n  className: 'u-tSpace--m',\n\n  initialize: function (opts) {\n    if (!opts.queryGeometryModel) throw new Error('queryGeometryModel is required');\n    if (!opts.querySchemaModel) throw new Error('querySchemaModel is required');\n    if (!opts.styleModel) throw new Error('styleModel is required');\n    if (!opts.configModel) throw new Error('configModel is required');\n    if (!opts.userModel) throw new Error('userModel is required');\n    if (!opts.modals) throw new Error('modals is required');\n\n    this._queryGeometryModel = opts.queryGeometryModel;\n    this._querySchemaModel = opts.querySchemaModel;\n    this._styleModel = opts.styleModel;\n    this._configModel = opts.configModel;\n    this._userModel = opts.userModel;\n    this._modals = opts.modals;\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this._removeFormView();\n    this.$el.empty();\n    this._initViews();\n    return this;\n  },\n\n  _initBinds: function () {\n    this._styleModel.bind('change:style', function () {\n      var style = this._styleModel.get('style');\n      this._styleModel.setFill(style);\n      this.render();\n    }, this);\n    this.add_related_model(this._styleModel);\n  },\n\n  _initViews: function () {\n    this._shapeFormModel = new StyleShapeFormModel(\n      {\n        type: this._styleModel.get('type'),\n        geom: this._queryGeometryModel.get('simple_geom'),\n        style: this._styleModel.get('style'),\n        fill: this._styleModel.get('fill'),\n        stroke: this._styleModel.get('stroke'),\n        blending: this._styleModel.get('blending')\n      },\n      {\n        parse: true,\n        queryGeometryModel: this._queryGeometryModel,\n        querySchemaModel: this._querySchemaModel,\n        configModel: this._configModel,\n        userModel: this._userModel,\n        modals: this._modals,\n        styleModel: this._styleModel\n      }\n    );\n\n    this._shapeFormView = new Backbone.Form({\n      model: this._shapeFormModel\n    });\n\n    this._shapeFormView.bind('change', function () {\n      this.commit();\n    });\n\n    this.$el.append(this._shapeFormView.render().el);\n  },\n\n  _removeFormView: function () {\n    if (this._shapeFormView) {\n      this._shapeFormView.remove();\n    }\n  },\n\n  clean: function () {\n    this._removeFormView();\n    CoreView.prototype.clean.call(this);\n  }\n});\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar template = require('./style-unanimatable.tpl');\nvar VisTableModel = require('../../../../data/visualization-table-model');\nvar linkTemplate = _.template('<a href=\"<%- url %>\" target=\"_blank\" title=\"<%- tableName %>\"><%- label %></a>');\n\nvar REQUIRED_OPTS = [\n  'layerDefinitionModel',\n  'configModel'\n];\n\nmodule.exports = CoreView.extend({\n  initialize: function (opts) {\n    var tableName;\n\n    _.each(REQUIRED_OPTS, function (item) {\n      if (!opts[item]) throw new Error(item + ' is required');\n      this['_' + item] = opts[item];\n    }, this);\n\n    this._sourceNode = this._getSourceNode();\n\n    if (this._sourceNode) {\n      tableName = this._sourceNode.get('table_name');\n      this._visTableModel = new VisTableModel({\n        id: tableName,\n        table: {\n          name: tableName\n        }\n      }, {\n        configModel: this._configModel\n      });\n    }\n  },\n\n  render: function () {\n    var desc = this._getDescTemplate();\n\n    this.clearSubViews();\n    this.$el.html(template({\n      title: _t('editor.style.style-form.unanimatable.desc'),\n      desc: desc\n    }));\n    return this;\n  },\n\n  _getDescTemplate: function () {\n    var tableName = '';\n    var url = '';\n    var tableModel;\n\n    if (this._visTableModel) {\n      tableModel = this._visTableModel.getTableModel();\n      tableName = tableModel.getUnquotedName();\n      url = this._visTableModel && this._visTableModel.datasetURL();\n    }\n\n    var linkHTML = linkTemplate({\n      url: url,\n      tableName: tableName,\n      label: _t('editor.style.style-form.unanimatable.label')\n    });\n\n    return _t('editor.style.style-form.unanimatable.body', {\n      link: linkHTML\n    });\n  },\n\n  _getSourceNode: function () {\n    var node = this._layerDefinitionModel.getAnalysisDefinitionNodeModel();\n    var source;\n    var primarySource;\n    if (node.get('type') === 'source') {\n      source = node;\n    } else {\n      primarySource = node.getPrimarySource();\n      if (primarySource && primarySource.get('type') === 'source') {\n        source = primarySource;\n      }\n    }\n\n    return source;\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<h2 class=\"CDB-Text CDB-Size-huge is-light u-secondaryTextColor\">'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</h2>\\n<p class=\"CDB-Text u-tSpace--m CDB-Size-medium u-altTextColor\">'+\n((__t=( desc ))==null?'':__t)+\n'</p>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"56px\" height=\"16px\" viewBox=\"718 455 56 16\">\\n    <g id=\"animated\" transform=\"translate(718.000000, 455.000000)\" class=\"Style-fill\">\\n        <rect id=\"Rectangle-649\" x=\"40\" y=\"0\" width=\"16\" height=\"16\" rx=\"8\"></rect>\\n        <rect id=\"Rectangle-649\" opacity=\"0.8\" x=\"30\" y=\"0\" width=\"16\" height=\"16\" rx=\"8\"></rect>\\n        <rect id=\"Rectangle-649\" opacity=\"0.6\" x=\"20\" y=\"0\" width=\"16\" height=\"16\" rx=\"8\"></rect>\\n        <rect id=\"Rectangle-649\" opacity=\"0.4\" x=\"10\" y=\"0\" width=\"16\" height=\"16\" rx=\"8\"></rect>\\n        <rect id=\"Rectangle-649\" opacity=\"0.2\" x=\"0\" y=\"0\" width=\"16\" height=\"16\" rx=\"8\"></rect>\\n    </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"56px\" height=\"25px\" viewBox=\"0 0 56 25\">\\n    <g id=\"Symbols\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\\n        <g id=\"Aggregation-/-Heatmap\" transform=\"translate(-15.000000, -16.000000)\">\\n            <g id=\"Group-7\">\\n                <g transform=\"translate(15.000000, 16.000000)\">\\n                    <g id=\"Group-2\" style=\"mix-blend-mode: luminosity;\" transform=\"translate(28.000000, 12.500000) rotate(-90.000000) translate(-28.000000, -12.500000) translate(15.500000, -15.500000)\" class=\"Style-fill\">\\n                        <g id=\"heat-copy-2\" transform=\"translate(0.000000, 36.000000)\">\\n                            <circle id=\"Oval-120\" opacity=\"0.4\" cx=\"6\" cy=\"6\" r=\"6\"></circle>\\n                            <circle id=\"Oval-120-Copy\" opacity=\"0.6\" cx=\"6.5\" cy=\"5.5\" r=\"4.03333333\"></circle>\\n                            <path d=\"M6.5,8.06666667 C7.91753086,8.06666667 9.06666667,6.91753086 9.06666667,5.5 C9.06666667,4.08246914 7.91753086,2.93333333 6.5,2.93333333 C5.08246914,2.93333333 3.93333333,4.08246914 3.93333333,5.5 C3.93333333,6.91753086 5.08246914,8.06666667 6.5,8.06666667 Z\" id=\"Oval-120-Copy-2\" opacity=\"0.8\"></path>\\n                            <circle id=\"Oval-120-Copy-3\" cx=\"6.5\" cy=\"5.5\" r=\"1.1\"></circle>\\n                        </g>\\n                        <g id=\"heat-copy-2\" transform=\"translate(13.000000, 48.000000)\">\\n                            <circle id=\"Oval-120\" opacity=\"0.4\" cx=\"4\" cy=\"4\" r=\"4\"></circle>\\n                            <circle id=\"Oval-120-Copy\" opacity=\"0.6\" cx=\"4\" cy=\"4\" r=\"2.93333333\"></circle>\\n                            <path d=\"M4,5.86666667 C5.03093153,5.86666667 5.86666667,5.03093153 5.86666667,4 C5.86666667,2.96906847 5.03093153,2.13333333 4,2.13333333 C2.96906847,2.13333333 2.13333333,2.96906847 2.13333333,4 C2.13333333,5.03093153 2.96906847,5.86666667 4,5.86666667 Z\" id=\"Oval-120-Copy-2\" opacity=\"0.8\"></path>\\n                            <circle id=\"Oval-120-Copy-3\" cx=\"4\" cy=\"4\" r=\"0.8\"></circle>\\n                        </g>\\n                        <g id=\"heat-copy-3\" transform=\"translate(0.500000, 0.500000)\">\\n                            <circle id=\"Oval-120\" opacity=\"0.4\" cx=\"12\" cy=\"12\" r=\"12\"></circle>\\n                            <ellipse id=\"Oval-120-Copy\" opacity=\"0.6\" cx=\"12\" cy=\"12\" rx=\"8.8\" ry=\"8.8\"></ellipse>\\n                            <path d=\"M12,17.6 C15.0927946,17.6 17.6,15.0927946 17.6,12 C17.6,8.9072054 15.0927946,6.4 12,6.4 C8.9072054,6.4 6.4,8.9072054 6.4,12 C6.4,15.0927946 8.9072054,17.6 12,17.6 Z\" id=\"Oval-120-Copy-2\" opacity=\"0.8\"></path>\\n                            <circle id=\"Oval-120-Copy-3\" cx=\"12\" cy=\"12\" r=\"2.4\"></circle>\\n                        </g>\\n                        <g id=\"heat\" transform=\"translate(8.000000, 25.000000)\">\\n                            <path d=\"M0.0682602115,8.5161863 C0.564222232,12.1776805 3.7025171,15 7.5,15 C11.6421356,15 15,11.6421356 15,7.5 C15,3.35786438 11.6421356,0 7.5,0 C3.35786438,0 0,3.35786438 0,7.5 C0,7.84465272 0.0232475903,8.18387567 0.0682602115,8.5161863 Z\" id=\"Oval-120\" opacity=\"0.4\"></path>\\n                            <circle id=\"Oval-120-Copy\" opacity=\"0.6\" cx=\"7.5\" cy=\"7.5\" r=\"5.5\"></circle>\\n                            <path d=\"M7.5,11 C9.43299662,11 11,9.43299662 11,7.5 C11,5.56700338 9.43299662,4 7.5,4 C5.56700338,4 4,5.56700338 4,7.5 C4,9.43299662 5.56700338,11 7.5,11 Z\" id=\"Oval-120-Copy-2\" opacity=\"0.8\"></path>\\n                            <circle id=\"Oval-120-Copy-3\" cx=\"7.5\" cy=\"7.5\" r=\"1.5\"></circle>\\n                        </g>\\n                    </g>\\n                    <g id=\"Group-8\" style=\"mix-blend-mode: luminosity;\" transform=\"translate(15.000000, 4.000000)\">\\n                        <path opacity=\"0.4\" d=\"M6,0.5 C6,0.5 10,4 13,0 C12,2.5 11.5,4.5 11.5,4.5 L10.5,6.5 L7,3.5 L6,0.5 Z\" id=\"Path-494\" class=\"Style-fill\"></path>\\n                        <path opacity=\"0.4\" d=\"M21.2158501,6.00893743 C21.2158501,6.00893743 25.2158501,9.50893743 28.2158501,5.50893743 C27.2158501,8.00893743 26.7158501,10.0089374 26.7158501,10.0089374 L25.7158501,12.0089374 L22.2158501,9.00893743 L21.2158501,6.00893743 Z\" id=\"Path-494\" class=\"Style-fill\" transform=\"translate(24.715850, 8.758937) rotate(52.000000) translate(-24.715850, -8.758937) \"></path>\\n                        <path opacity=\"0.4\" d=\"M16.9683476,9.30864826 C16.9683476,9.30864826 22.1000758,13.6622016 25.1000758,9.66220164 C24.1000758,12.1622016 23.8307892,14.1229281 23.8307892,14.1229281 L22.8307892,16.1229281 L17.6754544,11.4299685 L16.9683476,9.30864826 Z\" id=\"Path-494\" class=\"Style-fill\" transform=\"translate(21.034212, 12.715788) rotate(-135.000000) translate(-21.034212, -12.715788) \"></path>\\n                        <path opacity=\"0.4\" d=\"M6.01244045,6.22463473 C6.01244045,6.22463473 9.69418934,8.6717337 12.6941893,4.6717337 C11.6941893,7.1717337 11.1941893,9.1717337 11.1941893,9.1717337 L10.8665273,11.557349 L9.7765744,13.8621271 L6.01244045,6.22463473 Z\" id=\"Path-494\" class=\"Style-fill\" transform=\"translate(9.353315, 9.266930) rotate(-194.000000) translate(-9.353315, -9.266930) \"></path>\\n                        <path opacity=\"0.6\" d=\"M6,7.5 C5.85295664,5.882523 3.5,2.5 3.5,2.5 C3.5,2.5 6.5,5 9,5 C11.5,5 14.5,1 14.5,1 C14.5,1 12.5,4.25504557 12.5,6 C12.5,7.25504557 14.5,10 14.5,10 C14.5,10 12,8 9.5,8 C7,8 4.5,13.5 4.5,13.5 C4.5,13.5 6.18628997,9.54918967 6,7.5 Z\" id=\"Path-497\" class=\"Style-fill\"></path>\\n                        <path opacity=\"0.6\" d=\"M19.7830175,9.69012543 C19.6894445,8.07264843 16.7664559,5.429802 16.7664559,5.429802 C16.7664559,5.429802 20.2086087,8.27970692 21.7995178,8.27970692 C23.3904269,8.27970692 26.4566805,5.77970692 26.4566805,5.77970692 C26.4566805,5.77970692 24.4742142,8.43779004 24.4742142,10.1827445 C24.4742142,11.43779 25.8285796,12.5099091 25.8285796,12.5099091 C25.8285796,12.5099091 23.7086087,11.2797069 22.1176996,11.2797069 C20.5267905,11.2797069 17.9729009,15.2555074 17.9729009,15.2555074 C17.9729009,15.2555074 19.9015657,11.7393151 19.7830175,9.69012543 Z\" id=\"Path-497\" class=\"Style-fill\" transform=\"translate(21.611568, 10.342655) rotate(52.000000) translate(-21.611568, -10.342655) \"></path>\\n                        <path id=\"Path-499\" stroke=\"#979797\"></path>\\n                        <polygon id=\"Path-500\" class=\"Style-fill\" points=\"0.5 12.5 5 7.5 1 4\"></polygon>\\n                    </g>\\n                </g>\\n            </g>\\n        </g>\\n    </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"52px\" height=\"23px\" viewBox=\"0 0 52 23\">\\n    <g id=\"Symbols\">\\n        <g id=\"Aggregation-/-Hexabins\" transform=\"translate(-15.000000, -17.000000)\" class=\"Style-fill\">\\n            <g id=\"Hexabins\">\\n                <g transform=\"translate(15.000000, 17.000000)\">\\n                    <polygon id=\"Polygon-1-Copy-4\" points=\"23 11 28 14 28 20 23 23 18 20 18 14\"></polygon>\\n                    <polygon id=\"Polygon-1-Copy-8\" points=\"17 0 22 3 22 9 17 12 12 9 12 3\"></polygon>\\n                    <polygon id=\"Polygon-1-Copy-8\" points=\"5 0 10 3 10 9 5 12 -1.15463195e-13 9 3.85466323e-09 3\"></polygon>\\n                    <polygon id=\"Polygon-1-Copy-13\" points=\"29 0 34 3 34 9 29 12 24 9 24 3\"></polygon>\\n                    <polygon id=\"Polygon-1-Copy-15\" points=\"41 0 46 3 46 9 41 12 36 9 36 3\"></polygon>\\n                    <polygon id=\"Polygon-1-Copy-14\" points=\"35 11 40 14 40 20 35 23 30 20 30 14\"></polygon>\\n                    <polygon id=\"Polygon-1-Copy-14\" points=\"47 11 52 14 52 20 47 23 42 20 42 14\"></polygon>\\n                </g>\\n            </g>\\n        </g>\\n    </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"56px\" height=\"24px\" viewBox=\"16 16 56 24\">\\n    <g id=\"points\" transform=\"translate(16.000000, 16.000000)\"  class=\"Style-fill\">\\n        <path d=\"M6,10 C8.209139,10 10,8.209139 10,6 C10,3.790861 8.209139,2 6,2 C3.790861,2 2,3.790861 2,6 C2,8.209139 3.790861,10 6,10 Z\" id=\"Oval-59\"></path>\\n        <path d=\"M52,8 C54.209139,8 56,6.209139 56,4 C56,1.790861 54.209139,0 52,0 C49.790861,0 48,1.790861 48,4 C48,6.209139 49.790861,8 52,8 Z\" id=\"Oval-59-Copy-2\"></path>\\n        <path d=\"M52,22 C54.209139,22 56,20.209139 56,18 C56,15.790861 54.209139,14 52,14 C49.790861,14 48,15.790861 48,18 C48,20.209139 49.790861,22 52,22 Z\" id=\"Oval-59-Copy-3\"></path>\\n        <path d=\"M4,24 C6.209139,24 8,22.209139 8,20 C8,17.790861 6.209139,16 4,16 C1.790861,16 0,17.790861 0,20 C0,22.209139 1.790861,24 4,24 Z\" id=\"Oval-59-Copy\"></path>\\n        <path d=\"M28,8 C30.209139,8 32,6.209139 32,4 C32,1.790861 30.209139,0 28,0 C25.790861,0 24,1.790861 24,4 C24,6.209139 25.790861,8 28,8 Z\" id=\"Oval-59-Copy-4\"></path>\\n        <path d=\"M24,20 C26.209139,20 28,18.209139 28,16 C28,13.790861 26.209139,12 24,12 C21.790861,12 20,13.790861 20,16 C20,18.209139 21.790861,20 24,20 Z\" id=\"Oval-59-Copy-4\"></path>\\n        <path d=\"M16,16 C18.209139,16 20,14.209139 20,12 C20,9.790861 18.209139,8 16,8 C13.790861,8 12,9.790861 12,12 C12,14.209139 13.790861,16 16,16 Z\" id=\"Oval-59-Copy-4\"></path>\\n        <path d=\"M44,12 C46.209139,12 48,10.209139 48,8 C48,5.790861 46.209139,4 44,4 C41.790861,4 40,5.790861 40,8 C40,10.209139 41.790861,12 44,12 Z\" id=\"Oval-59-Copy-4\"></path>\\n    </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"56px\" height=\"24px\" viewBox=\"0 0 56 24\">\\n    <g id=\"Symbols\">\\n        <g id=\"Aggregation-/-Admin-Regions\" transform=\"translate(-16.000000, -16.000000)\" class=\"Style-fill\">\\n            <g id=\"regions\">\\n                <g transform=\"translate(16.000000, 16.000000)\">\\n                    <polygon id=\"Rectangle-649\" points=\"9 8 1 0 27 0 27 17 36 17 36.0065918 23.9934082 25 24 9 16\"></polygon>\\n                    <polygon id=\"Rectangle-649\" points=\"0 2 7 9 7 17 21 24 0 24 0 15\"></polygon>\\n                    <polygon id=\"Rectangle-649\" points=\"29 0 50 0 50 6 56 6 56 24 48 24 38 24 38 15 29 15\"></polygon>\\n                    <rect id=\"Rectangle-1933\" x=\"52\" y=\"0\" width=\"4\" height=\"4\"></rect>\\n                </g>\\n            </g>\\n        </g>\\n    </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"58px\" height=\"28px\" viewBox=\"0 0 58 28\">\\n    <g id=\"Symbols\">\\n        <g id=\"Aggregation-/-Squares\" transform=\"translate(-15.000000, -14.000000)\" class=\"Style-fill\">\\n            <g id=\"squares\">\\n                <g transform=\"translate(15.000000, 14.000000)\">\\n                    <rect id=\"Rectangle-847-Copy-2\" x=\"10\" y=\"0\" width=\"8\" height=\"8\" rx=\"1\"></rect>\\n                    <rect id=\"Rectangle-847-Copy-5\" x=\"30\" y=\"20\" width=\"8\" height=\"8\" rx=\"1\"></rect>\\n                    <rect id=\"Rectangle-847-Copy-12\" x=\"40\" y=\"20\" width=\"8\" height=\"8\" rx=\"1\"></rect>\\n                    <rect id=\"Rectangle-847-Copy-13\" x=\"40\" y=\"10\" width=\"8\" height=\"8\" rx=\"1\"></rect>\\n                    <rect id=\"Rectangle-847-Copy-8\" x=\"20\" y=\"10\" width=\"8\" height=\"8\" rx=\"1\"></rect>\\n                    <rect id=\"Rectangle-847-Copy-6\" x=\"30\" y=\"10\" width=\"8\" height=\"8\" rx=\"1\"></rect>\\n                    <rect id=\"Rectangle-847-Copy-9\" x=\"20\" y=\"20\" width=\"8\" height=\"8\" rx=\"1\"></rect>\\n                    <rect id=\"Rectangle-847-Copy-10\" x=\"10\" y=\"10\" width=\"8\" height=\"8\" rx=\"1\"></rect>\\n                    <rect id=\"Rectangle-847-Copy-10\" x=\"0\" y=\"10\" width=\"8\" height=\"8\" rx=\"1\"></rect>\\n                    <rect id=\"Rectangle-847-Copy-10\" x=\"50\" y=\"20\" width=\"8\" height=\"8\" rx=\"1\"></rect>\\n                    <rect id=\"Rectangle-847-Copy-11\" x=\"20\" y=\"0\" width=\"8\" height=\"8\" rx=\"1\"></rect>\\n                </g>\\n            </g>\\n        </g>\\n    </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var StyleGenerator = require('./style-converter');\nvar _ = require('underscore');\n\n/**\n * this class manages the changes in layerdef styles and generate the proper cartocss and sql\n */\nfunction StyleManager (layerDefinitionsCollection, map, configModel) {\n  this.layerDefinitionsCollection = layerDefinitionsCollection;\n  this.map = map;\n  this._configModel = configModel;\n  this._initBinds();\n}\n\nStyleManager.prototype = {\n  _initBinds: function () {\n    var self = this;\n\n    function _generate (layerDef) {\n      return function () {\n        self.generate(layerDef);\n      };\n    }\n\n    function _bind (layerDef) {\n      if (layerDef && layerDef.styleModel) {\n        layerDef.styleModel.bind('change', _generate(layerDef), this);\n        layerDef.bind('change:autoStyle', _generate(layerDef), this);\n      }\n    }\n\n    function _unbind (layerDef) {\n      if (layerDef.styleModel) {\n        layerDef.styleModel.unbind('change', _generate(layerDef), this);\n        layerDef.unbind('change:autoStyle', _generate(layerDef), this);\n      }\n    }\n\n    function _bindAll () {\n      this.layerDefinitionsCollection.each(_bind, this);\n    }\n\n    this.layerDefinitionsCollection.bind('reset', _bindAll, this);\n    this.layerDefinitionsCollection.bind('add', _bind, this);\n    this.layerDefinitionsCollection.bind('remove', _unbind, this);\n\n    _bindAll.call(this);\n  },\n\n  generate: function (layerDef) {\n    var isAutoStyleApplied = layerDef.get('autoStyle');\n    var stylesChanged = layerDef.styleModel.changed;\n\n    if (isAutoStyleApplied) {\n      return;\n    }\n\n    if (stylesChanged.type && _.size(stylesChanged) === 1) {\n      return;\n    }\n\n    var simpleGeometryType = layerDef.getAnalysisDefinitionNodeModel().queryGeometryModel.get('simple_geom') || 'point';\n    var generated = StyleGenerator.generateStyle(\n      layerDef.styleModel.toJSON(),\n      simpleGeometryType,\n      {\n        zoom: this.map.get('zoom')\n      },\n      this._configModel\n    );\n\n    var properties = {\n      cartocss: generated.cartoCSS,\n      sql_wrap: generated.sql,\n      type: generated.layerType\n    };\n\n    if (layerDef.get('previousCartoCSSCustom')) {\n      properties = _.extend(properties, {\n        cartocss: layerDef.get('previousCartoCSS'),\n        cartocss_custom: layerDef.get('previousCartoCSSCustom'),\n        previousCartoCSSCustom: false\n      });\n    }\n\n    layerDef.set(properties);\n  }\n};\n\nmodule.exports = StyleManager;\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar PanelWithOptionsView = require('../../components/view-options/panel-with-options-view');\nvar StyleContentView = require('./style-content-view');\nvar StyleCartoCSSView = require('./style-cartocss-view');\nvar ScrollView = require('../../components/scroll/scroll-view');\nvar TabPaneView = require('../../components/tab-pane/tab-pane-view');\nvar TabPaneCollection = require('../../components/tab-pane/tab-pane-collection');\nvar Toggler = require('../../components/toggler/toggler-view');\nvar UndoButtons = require('../../components/undo-redo/undo-redo-view');\nvar ParserCSS = require('../../helpers/parser-css');\nvar Infobox = require('../../components/infobox/infobox-factory');\nvar InfoboxModel = require('../../components/infobox/infobox-model');\nvar InfoboxCollection = require('../../components/infobox/infobox-collection');\nvar Notifier = require('../../components/notifier/notifier');\nvar CartoCSSNotifications = require('../../cartocss-notifications');\nvar MetricsTracker = require('../../components/metrics/metrics-tracker');\nvar OnboardingLauncher = require('../../components/onboardings/generic/generic-onboarding-launcher');\nvar OnboardingView = require('../../components/onboardings/layers/style-onboarding/style-onboarding-view');\nvar layerOnboardingKey = require('../../components/onboardings/layers/layer-onboarding-key');\nvar checkAndBuildOpts = require('../../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'layerDefinitionsCollection',\n  'layerDefinitionModel',\n  'userActions',\n  'queryGeometryModel',\n  'querySchemaModel',\n  'queryRowsCollection',\n  'modals',\n  'editorModel',\n  'configModel',\n  'userModel',\n  'onboardings',\n  'onboardingNotification'\n];\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n    this._styleModel = this._layerDefinitionModel.styleModel;\n    this._cartocssModel = this._layerDefinitionModel.cartocssModel;\n    this._codemirrorModel = new Backbone.Model({\n      content: this._layerDefinitionModel.get('cartocss')\n    });\n\n    // Set edition attribute in case custom cartocss is applied\n    this._editorModel.set({\n      edition: !!this._layerDefinitionModel.get('cartocss_custom'),\n      disabled: false\n    });\n\n    this._infoboxModel = new InfoboxModel({\n      state: this._isLayerHidden() ? 'layer-hidden' : ''\n    });\n\n    this._overlayModel = new Backbone.Model({\n      visible: this._isLayerHidden()\n    });\n\n    this._appendMapsAPIError();\n\n    CartoCSSNotifications.track(this);\n\n    this._onboardingLauncher = new OnboardingLauncher({\n      view: OnboardingView,\n      onboardingNotification: this._onboardingNotification,\n      notificationKey: layerOnboardingKey,\n      onboardings: this._onboardings\n    }, {\n      editorModel: this._editorModel,\n      selector: 'LayerOnboarding'\n    });\n\n    this._configPanes();\n    this._initBinds();\n  },\n\n  render: function () {\n    this._launchOnboarding();\n    this.clearSubViews();\n    this.$el.empty();\n    this._initViews();\n    return this;\n  },\n\n  _launchOnboarding: function () {\n    if (this._onboardingNotification.getKey(layerOnboardingKey)) {\n      return;\n    }\n\n    var launchOnboarding = function () {\n      if (!this._editorModel.isEditing() && !this._layerDefinitionModel.canBeGeoreferenced() && this._queryGeometryModel.hasValue()) {\n        this._onboardingLauncher.launch({\n          geom: this._queryGeometryModel.get('simple_geom'),\n          type: this._styleModel.get('type')\n        });\n      }\n    }.bind(this);\n\n    if (!this._queryRowsCollection.isFetched()) {\n      // It will be fetched by style-content view\n      this._queryRowsCollection.statusModel.bind('change:status', function () {\n        if (this._queryRowsCollection.isFetched()) {\n          launchOnboarding();\n          this._queryRowsCollection.statusModel.unbind(null, null, this);\n        }\n      }, this);\n    } else {\n      launchOnboarding();\n    }\n  },\n\n  _initBinds: function () {\n    this.listenTo(this._layerDefinitionModel, 'change:error', this._appendMapsAPIError);\n    this.listenTo(this._layerDefinitionModel, 'change:cartocss', function () {\n      this._codemirrorModel.set('content', this._layerDefinitionModel.get('cartocss'));\n    }, this);\n    this.listenTo(this._layerDefinitionModel, 'change:visible', this._infoboxState);\n    this.listenTo(this._layerDefinitionModel, 'change:autoStyle', this._infoboxState);\n    this.listenTo(this._editorModel, 'change:edition', this._onChangeEdition);\n    this.listenTo(this._querySchemaModel, 'change:query_errors', this._updateEditor);\n    this.listenTo(this._styleModel, 'change', function () {\n      this._codemirrorModel.set('content', this._layerDefinitionModel.get('cartocss'));\n    }.bind(this));\n    this.listenTo(this._cartocssModel, 'undo redo', function () {\n      this._codemirrorModel.set('content', this._cartocssModel.get('content'));\n    }.bind(this));\n  },\n\n  _appendMapsAPIError: function () {\n    var error = this._layerDefinitionModel.get('error');\n    if (error) {\n      if (error.type === 'turbo-carto') {\n        var newErrors = _.clone(this._codemirrorModel.get('errors')) || [];\n        newErrors.push({ line: error.line, message: error.message });\n        this._codemirrorModel.set('errors', newErrors);\n      }\n    }\n  },\n\n  _updateEditor: function (model) {\n    var errors = this._querySchemaModel.get('query_errors');\n    var hasErrors = errors && errors.length > 0;\n    this._editorModel.set('disabled', hasErrors);\n  },\n\n  _saveCartoCSS: function () {\n    var content = this._codemirrorModel.get('content');\n    var parser = new ParserCSS(content);\n    var errors = parser.errors();\n\n    if (!content) {\n      return false;\n    }\n\n    this._codemirrorModel.set('errors', parser.parseError(errors));\n\n    if (errors.length === 0) {\n      this._cartocssModel.set('content', content);\n\n      // Disable auto-style before saving, in order to not reset styles\n      this._layerDefinitionModel.set('autoStyle', false);\n\n      this._layerDefinitionModel.save({\n        cartocss_custom: true,\n        cartocss: content\n      });\n\n      CartoCSSNotifications.showSuccessNotification();\n\n      MetricsTracker.track('Applied Cartocss', {\n        layer_id: this._layerDefinitionModel.get('id'),\n        cartocss: this._layerDefinitionModel.get('cartocss')\n      });\n    } else {\n      this._editorModel.get('edition') === false && CartoCSSNotifications.showErrorNotification(parser.parseError(errors));\n    }\n  },\n\n  _cancelClearStyles: function () {\n    this._infoboxModel.set({state: ''});\n    this._overlayModel.set({visible: false});\n\n    this._editorModel.set({\n      edition: true\n    });\n  },\n\n  _clearCustomStyles: function () {\n    this._layerDefinitionModel.set('cartocss_custom', false);\n    this._styleModel.applyLastState();\n    this._infoboxModel.set({state: ''});\n    this._overlayModel.set({visible: false});\n    this.render();\n  },\n\n  _cancelTorqueAggregation: function () {\n    this._styleModel.applyLastState();\n    this._infoboxModel.set({state: ''});\n    this._overlayModel.set({visible: false});\n    this.render();\n  },\n\n  _applyTorqueAggregation: function () {\n    if (this._layerDefinitionsCollection.isThereAnyTorqueLayer()) {\n      var torqueLayer = this._layerDefinitionsCollection.findWhere({ type: 'torque' });\n      torqueLayer.styleModel.setDefaultPropertiesByType('simple', 'point');\n    }\n\n    this._infoboxModel.set({state: 'unfreeze'});\n  },\n\n  _onChangeEdition: function () {\n    this._infoboxState();\n\n    var edition = this._editorModel.get('edition');\n    var index = edition ? 1 : 0;\n    this._collectionPane.at(index).set({ selected: true });\n  },\n\n  _freezeTorgeAggregation: function (styleType, currentGeometryType) {\n    this._infoboxModel.set({state: 'torque-exists'});\n    this._overlayModel.set({visible: true});\n\n    // Apply the previously selected style\n    this._infoboxModel.once('change:state', function (mdl, state) {\n      if (state === 'unfreeze') {\n        this._moveTorqueLayerToTop(function () {\n          this._overlayModel.set({visible: false});\n          this._styleModel.setDefaultPropertiesByType(styleType, currentGeometryType);\n        }.bind(this));\n        this._infoboxModel.set({state: ''});\n      }\n    }, this);\n  },\n\n  _moveTorqueLayerToTop: function (callback) {\n    var notification = Notifier.addNotification({\n      status: 'loading',\n      info: _t('editor.layers.moveTorqueLayer.loading'),\n      closable: true\n    });\n\n    this._layerDefinitionsCollection.once('layerMoved', function () {\n      callback && callback();\n      notification.set({\n        status: 'success',\n        info: _t('editor.layers.moveTorqueLayer.success'),\n        delay: Notifier.DEFAULT_DELAY\n      });\n    }, this);\n\n    this._userActions.moveLayer({\n      from: this._layerDefinitionModel.get('order'),\n      to: this._layerDefinitionsCollection.getTopDataLayerIndex()\n    });\n  },\n\n  _configPanes: function () {\n    var self = this;\n    var tabPaneTabs = [{\n      selected: !this._layerDefinitionModel.get('cartocss_custom'),\n      createContentView: function () {\n        return new ScrollView({\n          createContentView: function () {\n            return new StyleContentView({\n              className: 'Editor-content',\n              userActions: self._userActions,\n              layerDefinitionsCollection: self._layerDefinitionsCollection,\n              layerDefinitionModel: self._layerDefinitionModel,\n              styleModel: self._styleModel,\n              modals: self._modals,\n              configModel: self._configModel,\n              userModel: self._userModel,\n              queryGeometryModel: self._queryGeometryModel,\n              querySchemaModel: self._querySchemaModel,\n              queryRowsCollection: self._queryRowsCollection,\n              editorModel: self._editorModel,\n              overlayModel: self._overlayModel,\n              freezeTorgeAggregation: self._freezeTorgeAggregation.bind(self)\n            });\n          }\n        });\n      },\n      createActionView: function () {\n        return new UndoButtons({\n          trackModel: self._styleModel,\n          editorModel: self._editorModel,\n          applyButton: false\n        });\n      }\n    }, {\n      selected: this._layerDefinitionModel.get('cartocss_custom'),\n      createContentView: function () {\n        return new StyleCartoCSSView({\n          layerDefinitionModel: self._layerDefinitionModel,\n          querySchemaModel: self._querySchemaModel,\n          styleModel: self._styleModel,\n          editorModel: self._editorModel,\n          codemirrorModel: self._codemirrorModel,\n          onApplyEvent: self._saveCartoCSS.bind(self)\n        });\n      },\n      createActionView: function () {\n        return new UndoButtons({\n          trackModel: self._cartocssModel,\n          editorModel: self._editorModel,\n          applyButton: true,\n          onApplyClick: self._saveCartoCSS.bind(self)\n        });\n      }\n    }];\n\n    this._collectionPane = new TabPaneCollection(tabPaneTabs);\n  },\n\n  _isLayerHidden: function () {\n    return this._layerDefinitionModel.get('visible') === false;\n  },\n\n  _infoboxState: function () {\n    var edition = this._editorModel.get('edition');\n    var cartocss_custom = this._layerDefinitionModel.get('cartocss_custom');\n    var isAutoStyleApplied = this._layerDefinitionModel.get('autoStyle');\n\n    if (!edition && cartocss_custom && !isAutoStyleApplied) {\n      this._infoboxModel.set({state: 'confirm'});\n      this._overlayModel.set({visible: true});\n    } else if (!edition && this._isLayerHidden()) {\n      this._infoboxModel.set({state: 'layer-hidden'});\n      this._overlayModel.set({visible: true});\n    } else {\n      this._infoboxModel.set({state: ''});\n      this._overlayModel.set({visible: false});\n    }\n  },\n\n  _showHiddenLayer: function () {\n    var savingOptions = {\n      shouldPreserveAutoStyle: true\n    };\n    this._layerDefinitionModel.toggleVisible();\n    this._userActions.saveLayer(this._layerDefinitionModel, savingOptions);\n  },\n\n  _initViews: function () {\n    var self = this;\n\n    var infoboxSstates = [\n      {\n        state: 'confirm',\n        createContentView: function () {\n          return Infobox.createWithAction({\n            type: 'alert',\n            closable: false,\n            title: _t('editor.style.messages.cartocss-applied.title'),\n            body: _t('editor.style.messages.cartocss-applied.body'),\n            mainAction: {\n              label: _t('editor.style.messages.cartocss-applied.clear')\n            },\n            secondAction: {\n              label: _t('editor.style.messages.cartocss-applied.continue')\n            }\n          });\n        },\n        mainAction: self._clearCustomStyles.bind(self),\n        secondAction: self._cancelClearStyles.bind(self)\n      }, {\n        state: 'layer-hidden',\n        createContentView: function () {\n          return Infobox.createWithAction({\n            type: 'alert',\n            title: _t('editor.style.messages.layer-hidden.title'),\n            body: _t('editor.style.messages.layer-hidden.body'),\n            mainAction: {\n              label: _t('editor.style.messages.layer-hidden.show')\n            }\n          });\n        },\n        mainAction: self._showHiddenLayer.bind(self)\n      }, {\n        state: 'torque-exists',\n        createContentView: function () {\n          return Infobox.createWithAction({\n            type: 'alert',\n            closable: false,\n            title: _t('editor.style.messages.torque-exists.title'),\n            body: _t('editor.style.messages.torque-exists.body'),\n            mainAction: {\n              label: _t('editor.style.messages.torque-exists.continue')\n            }\n          });\n        },\n        closeAction: self._cancelTorqueAggregation.bind(self),\n        mainAction: self._applyTorqueAggregation.bind(self)\n      }\n    ];\n\n    var infoboxCollection = new InfoboxCollection(infoboxSstates);\n\n    var panelWithOptionsView = new PanelWithOptionsView({\n      className: 'Editor-content',\n      editorModel: self._editorModel,\n      infoboxModel: self._infoboxModel,\n      infoboxCollection: infoboxCollection,\n      createContentView: function () {\n        return new TabPaneView({\n          collection: self._collectionPane\n        });\n      },\n      createControlView: function () {\n        return new Toggler({\n          editorModel: self._editorModel,\n          labels: [_t('editor.style.style-toggle.values'), _t('editor.style.style-toggle.cartocss')],\n          isDisableable: true\n        });\n      },\n      createActionView: function () {\n        return new TabPaneView({\n          collection: self._collectionPane,\n          createContentKey: 'createActionView'\n        });\n      }\n    });\n\n    this.$el.append(panelWithOptionsView.render().el);\n    this.addView(panelWithOptionsView);\n  }\n});\n",
    "var _ = require('underscore');\nvar StyleDefaults = require('./style-defaults/style-defaults');\nvar SimpleStyleDefaults = require('./style-defaults/simple-style-defaults');\nvar HeatmapDefaults = require('./style-defaults/heatmap-style-defaults');\nvar AnimationDefaults = require('./style-defaults/animation-style-defaults');\nvar SquareAggregationDefaults = require('./style-defaults/squares-aggregation-style-defaults');\nvar HexabinsAggregationDefaults = require('./style-defaults/hexabins-aggregation-style-defaults');\nvar RegionsAggregationDefaults = require('./style-defaults/regions-aggregation-style-defaults');\n\nvar STYLE_MAP = {\n  'none': {\n    labelTranslationKey: 'editor.style.types.none',\n    checkIfValid: function (geometryType) {\n      return !geometryType;\n    },\n    defaultStyles: StyleDefaults\n  },\n  'simple': {\n    labelTranslationKey: 'editor.style.types.simple',\n    iconTemplate: require('./style-icons/points.tpl'),\n    checkIfValid: function (geometryType) {\n      return !!geometryType;\n    },\n    defaultStyles: SimpleStyleDefaults\n  },\n  'squares': {\n    labelTranslationKey: 'editor.style.types.squares',\n    iconTemplate: require('./style-icons/squares.tpl'),\n    checkIfValid: function (geometryType) {\n      return geometryType === 'point';\n    },\n    defaultStyles: SquareAggregationDefaults\n  },\n  'hexabins': {\n    labelTranslationKey: 'editor.style.types.hexabins',\n    iconTemplate: require('./style-icons/hexabins.tpl'),\n    checkIfValid: function (geometryType) {\n      return geometryType === 'point';\n    },\n    defaultStyles: HexabinsAggregationDefaults\n  },\n  'regions': {\n    labelTranslationKey: 'editor.style.types.regions',\n    iconTemplate: require('./style-icons/regions.tpl'),\n    checkIfValid: function (geometryType) {\n      return geometryType === 'point';\n    },\n    defaultStyles: RegionsAggregationDefaults\n  },\n  'animation': {\n    labelTranslationKey: 'editor.style.types.animation',\n    iconTemplate: require('./style-icons/animated.tpl'),\n    checkIfValid: function (geometryType) {\n      return geometryType === 'point';\n    },\n    defaultStyles: AnimationDefaults\n  },\n  'heatmap': {\n    labelTranslationKey: 'editor.style.types.heatmap',\n    iconTemplate: require('./style-icons/heatmap.tpl'),\n    checkIfValid: function (geometryType) {\n      return geometryType === 'point';\n    },\n    defaultStyles: HeatmapDefaults\n  }\n};\n\nmodule.exports = {\n  getDefaultStyleAttrsByType: function (styleType, geometryType) {\n    var StyleDefaultsKlass = STYLE_MAP[styleType].defaultStyles;\n    return StyleDefaultsKlass.generateAttributes(geometryType);\n  },\n\n  getStyleTypes: function (currentType, geometryType) {\n    return _.reduce(STYLE_MAP, function (memo, val, key) {\n      if (currentType === key || (val.checkIfValid ? val.checkIfValid(geometryType) : true)) {\n        memo.push({\n          value: key,\n          label: _t(val.labelTranslationKey),\n          iconTemplate: val.iconTemplate\n        });\n      }\n      return memo;\n    }, []);\n  },\n\n  getFormTemplateByType: function (styleType) {\n    return STYLE_MAP[styleType].formTemplate;\n  },\n\n  getAggregationTypes: function () {\n    return ['squares', 'hexabins', 'regions'];\n  }\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<nav class=\"CDB-NavMenu js-theme\">\\n  <ul class=\"CDB-NavSubmenu CDB-NavSubmenu--outside CDB-Size-small CDB-Text is-semibold js-menu\"></ul>\\n</nav>\\n<div class=\"Editor-content js-content\"></div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"u-flex u-justifyCenter\">\\n  <div class=\"Modal-inner Modal-inner--grid u-flex u-justifyCenter\">\\n    <div class=\"Modal-icon\">\\n      <svg width=\"24px\" height=\"25px\" viewbox=\"521 436 24 25\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n            <path d=\"M524.5,440 L540.5,440 L540.5,460 L524.5,460 L524.5,440 Z M528.5,437 L536.5,437 L536.5,440 L528.5,440 L528.5,437 Z M522,440 L544,440 L522,440 Z M528.5,443.5 L528.5,455.5 L528.5,443.5 Z M532.5,443.5 L532.5,455.5 L532.5,443.5 Z M536.5,443.5 L536.5,455.5 L536.5,443.5 Z\" id=\"Shape\" stroke=\"#F19243\" stroke-width=\"1\" fill=\"none\"/>\\n      </svg>\\n    </div>\\n    <div>\\n      <h2 class=\" CDB-Text CDB-Size-huge is-light u-bSpace--xl\">\\n        '+\n((__t=( _t('editor.widgets.delete.title', { name: name }) ))==null?'':_.escape(__t))+\n'\\n      </h2>\\n      <p class=\"CDB-Text CDB-Size-large u-altTextColor\">'+\n((__t=( _t('editor.widgets.delete.desc') ))==null?'':_.escape(__t))+\n'</p>\\n      <ul class=\"Modal-listActions u-flex u-alignCenter\">\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--secondary CDB-Button--big js-cancel\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">\\n              '+\n((__t=( _t('editor.widgets.delete.cancel') ))==null?'':_.escape(__t))+\n'\\n            </span>\\n          </button>\\n        </li>\\n        <li class=\"Modal-listActionsitem\">\\n          <button class=\"CDB-Button CDB-Button--primary CDB-Button--big js-confirm\">\\n            <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-medium u-upperCase\">\\n              '+\n((__t=( _t('editor.widgets.delete.confirm') ))==null?'':_.escape(__t))+\n'\\n            </span>\\n          </button>\\n        </li>\\n      </ul>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"56px\" height=\"32px\" viewBox=\"498 425 56 32\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n    <g id=\"Bolean\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(498.000000, 425.000000)\">\\n        <rect id=\"Rectangle-17\" fill=\"#FFFFFF\" x=\"0\" y=\"0\" width=\"56\" height=\"32\" rx=\"4\"></rect>\\n        <path d=\"M1,2.00174332 L1,2.00174332 L1,29.9982567 C1,30.5564876 1.4426521,31 1.99306965,31 L54.0069304,31 C54.5486548,31 55,30.5482532 55,29.9982567 L55,2.00174332 C55,1.44351239 54.5573479,1 54.0069304,1 L1.99306965,1 C1.45134516,1 1,1.4517468 1,2.00174332 L1,2.00174332 Z M0,2.00174332 C0,0.89621101 0.902308181,0 1.99306965,0 L54.0069304,0 C55.1076723,0 56,0.889261723 56,2.00174332 L56,29.9982567 C56,31.103789 55.0976918,32 54.0069304,32 L1.99306965,32 C0.892327676,32 0,31.1107383 0,29.9982567 L0,2.00174332 L0,2.00174332 Z\" id=\"Rectangle-774\" fill=\"#EEEEEE\"></path>\\n        <rect id=\"Rectangle-1876\" fill=\"#EEEEEE\" x=\"8\" y=\"6\" width=\"16\" height=\"3\"></rect>\\n        <rect id=\"Rectangle-1876\" fill=\"#EEEEEE\" x=\"8\" y=\"15\" width=\"40\" height=\"2\" rx=\"1\"></rect>\\n        <rect id=\"Rectangle-1876-Copy\" fill=\"#9DE0AD\" x=\"8\" y=\"15\" width=\"31\" height=\"2\" rx=\"1\"></rect>\\n        <rect id=\"Rectangle-1876\" fill=\"#EEEEEE\" x=\"8\" y=\"22\" width=\"40\" height=\"2\" rx=\"1\"></rect>\\n        <rect id=\"Rectangle-1876-Copy\" fill=\"#9DE0AD\" x=\"8\" y=\"22\" width=\"11\" height=\"2\" rx=\"1\"></rect>\\n    </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"56px\" height=\"32px\" viewBox=\"0 0 56 32\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n    <g id=\"Graf\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\\n        <rect id=\"Rectangle-17\" fill=\"#FFFFFF\" x=\"0\" y=\"0\" width=\"56\" height=\"32\" rx=\"4\"></rect>\\n        <path d=\"M1,2.00174332 L1,2.00174332 L1,29.9982567 C1,30.5564876 1.4426521,31 1.99306965,31 L54.0069304,31 C54.5486548,31 55,30.5482532 55,29.9982567 L55,2.00174332 C55,1.44351239 54.5573479,1 54.0069304,1 L1.99306965,1 C1.45134516,1 1,1.4517468 1,2.00174332 L1,2.00174332 Z M0,2.00174332 C0,0.89621101 0.902308181,0 1.99306965,0 L54.0069304,0 C55.1076723,0 56,0.889261723 56,2.00174332 L56,29.9982567 C56,31.103789 55.0976918,32 54.0069304,32 L1.99306965,32 C0.892327676,32 0,31.1107383 0,29.9982567 L0,2.00174332 L0,2.00174332 Z\" id=\"Rectangle-774\" fill=\"#EEEEEE\"></path>\\n        <rect id=\"Rectangle-1876\" fill=\"#EEEEEE\" x=\"8\" y=\"6\" width=\"16\" height=\"3\"></rect>\\n        <rect id=\"Rectangle-53\" fill=\"#9DE0AD\" x=\"8\" y=\"19\" width=\"40\" height=\"7\"></rect>\\n        <rect id=\"Rectangle-1876\" fill=\"#EEEEEE\" x=\"8\" y=\"14\" width=\"16\" height=\"2\"></rect>\\n    </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"56px\" height=\"32px\" viewBox=\"498 425 56 32\" version=\"1.1\" mlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n    <g id=\"Bars\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(498.000000, 425.000000)\">\\n        <rect id=\"Rectangle-17\" fill=\"#FFFFFF\" x=\"0\" y=\"0\" width=\"56\" height=\"32\" rx=\"4\"></rect>\\n        <path d=\"M1,2.00174332 L1,2.00174332 L1,29.9982567 C1,30.5564876 1.4426521,31 1.99306965,31 L54.0069304,31 C54.5486548,31 55,30.5482532 55,29.9982567 L55,2.00174332 C55,1.44351239 54.5573479,1 54.0069304,1 L1.99306965,1 C1.45134516,1 1,1.4517468 1,2.00174332 L1,2.00174332 Z M0,2.00174332 C0,0.89621101 0.902308181,0 1.99306965,0 L54.0069304,0 C55.1076723,0 56,0.889261723 56,2.00174332 L56,29.9982567 C56,31.103789 55.0976918,32 54.0069304,32 L1.99306965,32 C0.892327676,32 0,31.1107383 0,29.9982567 L0,2.00174332 L0,2.00174332 Z\" id=\"Rectangle-774\" fill=\"#EEEEEE\"></path>\\n        <rect id=\"Bar\" fill=\"#9DE0AD\" transform=\"translate(36.000000, 23.000000) scale(-1, 1) translate(-36.000000, -23.000000) \" x=\"35\" y=\"22\" width=\"2\" height=\"2\"></rect>\\n        <rect id=\"Bar-Copy-6\" fill=\"#9DE0AD\" transform=\"translate(39.000000, 22.000000) scale(-1, 1) translate(-39.000000, -22.000000) \" x=\"38\" y=\"20\" width=\"2\" height=\"4\"></rect>\\n        <rect id=\"Bar-Copy-7\" fill=\"#9DE0AD\" transform=\"translate(42.000000, 21.500000) scale(-1, 1) translate(-42.000000, -21.500000) \" x=\"41\" y=\"19\" width=\"2\" height=\"5\"></rect>\\n        <rect id=\"Bar-Copy-8\" fill=\"#9DE0AD\" transform=\"translate(45.000000, 20.000000) scale(-1, 1) translate(-45.000000, -20.000000) \" x=\"44\" y=\"16\" width=\"2\" height=\"8\"></rect>\\n        <rect id=\"Bar-Copy-9\" fill=\"#9DE0AD\" transform=\"translate(48.000000, 21.500000) scale(-1, 1) translate(-48.000000, -21.500000) \" x=\"47\" y=\"19\" width=\"2\" height=\"5\"></rect>\\n        <rect id=\"Bar-Copy-2\" fill=\"#9DE0AD\" transform=\"translate(33.000000, 21.000000) scale(-1, 1) translate(-33.000000, -21.000000) \" x=\"32\" y=\"18\" width=\"2\" height=\"6\"></rect>\\n        <rect id=\"Bar-Copy-3\" fill=\"#9DE0AD\" transform=\"translate(30.000000, 22.500000) scale(-1, 1) translate(-30.000000, -22.500000) \" x=\"29\" y=\"21\" width=\"2\" height=\"3\"></rect>\\n        <rect id=\"Bar-Copy-4\" fill=\"#9DE0AD\" transform=\"translate(27.000000, 22.000000) scale(-1, 1) translate(-27.000000, -22.000000) \" x=\"26\" y=\"20\" width=\"2\" height=\"4\"></rect>\\n        <polygon id=\"Bar-Copy-5\" fill=\"#9DE0AD\" transform=\"translate(24.000000, 20.500000) scale(-1, 1) translate(-24.000000, -20.500000) \" points=\"23 17 25 17 25 24 23 24\"></polygon>\\n        <rect id=\"Bar\" fill=\"#9DE0AD\" x=\"8\" y=\"21\" width=\"2\" height=\"3\"></rect>\\n        <rect id=\"Bar-Copy-2\" fill=\"#9DE0AD\" x=\"11\" y=\"15\" width=\"2\" height=\"9\"></rect>\\n        <rect id=\"Bar-Copy-3\" fill=\"#9DE0AD\" x=\"14\" y=\"16\" width=\"2\" height=\"8\"></rect>\\n        <rect id=\"Bar-Copy-4\" fill=\"#9DE0AD\" x=\"17\" y=\"19\" width=\"2\" height=\"5\"></rect>\\n        <polygon id=\"Bar-Copy-5\" fill=\"#9DE0AD\" points=\"20 16 22 16 22 24 20 24\"></polygon>\\n        <rect id=\"Rectangle-1876\" fill=\"#EEEEEE\" x=\"7\" y=\"7\" width=\"16\" height=\"3\"></rect>\\n    </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"20px\" height=\"18px\" viewBox=\"10 11 20 18\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n    <g id=\"Group\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(10.000000, 11.000000)\">\\n        <rect id=\"Bar\" fill=\"#A4DAB1\" x=\"0\" y=\"2\" width=\"13\" height=\"2\"></rect>\\n        <rect id=\"Bar\" fill=\"#A4DAB1\" x=\"0\" y=\"9\" width=\"10\" height=\"2\"></rect>\\n        <rect id=\"Bar\" fill=\"#A4DAB1\" x=\"0\" y=\"16\" width=\"12\" height=\"2\"></rect>\\n        <rect id=\"Bar\" fill=\"#DDDDDD\" x=\"0\" y=\"7\" width=\"7\" height=\"1\"></rect>\\n        <rect id=\"Bar\" fill=\"#DDDDDD\" x=\"0\" y=\"14\" width=\"5\" height=\"1\"></rect>\\n        <rect id=\"Bar\" fill=\"#EEEEEE\" x=\"13\" y=\"2\" width=\"7\" height=\"2\"></rect>\\n        <rect id=\"Bar\" fill=\"#EEEEEE\" x=\"10\" y=\"9\" width=\"10\" height=\"2\"></rect>\\n        <rect id=\"Bar\" fill=\"#EEEEEE\" x=\"12\" y=\"16\" width=\"8\" height=\"2\"></rect>\\n        <rect id=\"Bar\" fill=\"#DDDDDD\" x=\"0\" y=\"0\" width=\"5\" height=\"1\"></rect>\\n    </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"20px\" height=\"8px\" viewBox=\"0 0 20 8\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n    <g id=\"Group\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\\n        <rect id=\"Bar-Copy-2\" fill=\"#9DE0AD\" x=\"0\" y=\"4\" width=\"20\" height=\"4\"></rect>\\n        <rect id=\"Bar-Copy-3\" fill=\"#DDDDDD\" x=\"0\" y=\"0\" width=\"9\" height=\"2\"></rect>\\n    </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"20px\" height=\"18px\" viewBox=\"10 11 20 18\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n    <g id=\"Bars\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(10.000000, 11.000000)\">\\n        <rect id=\"Bar\" fill=\"#A4DAB1\" x=\"0\" y=\"10\" width=\"2\" height=\"8\"></rect>\\n        <rect id=\"Bar\" fill=\"#A4DAB1\" x=\"3\" y=\"6\" width=\"2\" height=\"12\"></rect>\\n        <rect id=\"Bar\" fill=\"#A4DAB1\" x=\"6\" y=\"2\" width=\"2\" height=\"16\"></rect>\\n        <rect id=\"Bar\" fill=\"#A4DAB1\" x=\"9\" y=\"0\" width=\"2\" height=\"18\"></rect>\\n        <rect id=\"Bar\" fill=\"#A4DAB1\" x=\"12\" y=\"2\" width=\"2\" height=\"16\"></rect>\\n        <rect id=\"Bar\" fill=\"#A4DAB1\" x=\"15\" y=\"5\" width=\"2\" height=\"13\"></rect>\\n        <rect id=\"Bar\" fill=\"#A4DAB1\" x=\"18\" y=\"8\" width=\"2\" height=\"10\"></rect>\\n    </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"21px\" height=\"18px\" viewBox=\"10 11 21 18\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n    <g id=\"Group-2\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(10.000000, 11.000000)\">\\n        <g id=\"Bars\" transform=\"translate(0.000000, 8.000000)\">\\n            <rect id=\"Bar\" fill=\"#F2CC8F\" x=\"4\" y=\"0\" width=\"1\" height=\"10\"></rect>\\n            <rect id=\"Bar\" fill=\"#F2CC8F\" x=\"6\" y=\"1\" width=\"1\" height=\"9\"></rect>\\n            <rect id=\"Bar-Copy\" fill=\"#F2CC8F\" x=\"0\" y=\"5\" width=\"1\" height=\"5\"></rect>\\n            <rect id=\"Bar\" fill=\"#F2CC8F\" x=\"8\" y=\"2\" width=\"1\" height=\"8\"></rect>\\n            <rect id=\"Bar\" fill=\"#F2CC8F\" x=\"10\" y=\"3\" width=\"1\" height=\"7\"></rect>\\n            <rect id=\"Bar\" fill=\"#EEEEEE\" x=\"12\" y=\"4\" width=\"1\" height=\"6\"></rect>\\n            <rect id=\"Bar\" fill=\"#EEEEEE\" x=\"14\" y=\"5\" width=\"1\" height=\"5\"></rect>\\n            <rect id=\"Bar\" fill=\"#EEEEEE\" x=\"16\" y=\"6\" width=\"1\" height=\"4\"></rect>\\n            <rect id=\"Bar-Copy\" fill=\"#F2CC8F\" x=\"2\" y=\"3\" width=\"1\" height=\"7\"></rect>\\n            <rect id=\"Bar\" fill=\"#EEEEEE\" x=\"18\" y=\"7\" width=\"1\" height=\"3\"></rect>\\n            <rect id=\"Bar\" fill=\"#EEEEEE\" x=\"20\" y=\"7\" width=\"1\" height=\"3\"></rect>\\n        </g>\\n        <polygon id=\"Rectangle-316\" fill=\"#979EA1\" points=\"0 5 0 0 4 2.5\"></polygon>\\n        <rect id=\"Rectangle-1876\" fill=\"#DDDDDD\" x=\"8\" y=\"1\" width=\"12\" height=\"3\"></rect>\\n    </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<svg width=\"56px\" height=\"32px\" viewBox=\"539 370 56 32\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\\n    <g id=\"Time-Series\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\" transform=\"translate(539.000000, 370.000000)\">\\n        <rect id=\"Rectangle-17\" fill=\"#FFFFFF\" x=\"0\" y=\"0\" width=\"56\" height=\"32\" rx=\"4\"></rect>\\n        <path d=\"M1,2.00174332 L1,2.00174332 L1,29.9982567 C1,30.5564876 1.4426521,31 1.99306965,31 L54.0069304,31 C54.5486548,31 55,30.5482532 55,29.9982567 L55,2.00174332 C55,1.44351239 54.5573479,1 54.0069304,1 L1.99306965,1 C1.45134516,1 1,1.4517468 1,2.00174332 L1,2.00174332 Z M0,2.00174332 C0,0.89621101 0.902308181,0 1.99306965,0 L54.0069304,0 C55.1076723,0 56,0.889261723 56,2.00174332 L56,29.9982567 C56,31.103789 55.0976918,32 54.0069304,32 L1.99306965,32 C0.892327676,32 0,31.1107383 0,29.9982567 L0,2.00174332 L0,2.00174332 Z\" id=\"Rectangle-774\" fill=\"#EEEEEE\"></path>\\n        <rect id=\"Bar\" fill=\"#DDDDDD\" opacity=\"0.5\" transform=\"translate(34.000000, 23.500000) scale(-1, 1) translate(-34.000000, -23.500000) \" x=\"33\" y=\"22\" width=\"2\" height=\"3\"></rect>\\n        <rect id=\"Bar-Copy-6\" fill=\"#DDDDDD\" opacity=\"0.5\" transform=\"translate(37.000000, 24.000000) scale(-1, 1) translate(-37.000000, -24.000000) \" x=\"36\" y=\"23\" width=\"2\" height=\"2\"></rect>\\n        <rect id=\"Bar-Copy-7\" fill=\"#DDDDDD\" opacity=\"0.5\" transform=\"translate(40.000000, 24.000000) scale(-1, 1) translate(-40.000000, -24.000000) \" x=\"39\" y=\"23\" width=\"2\" height=\"2\"></rect>\\n        <rect id=\"Bar-Copy-8\" fill=\"#DDDDDD\" opacity=\"0.5\" transform=\"translate(43.000000, 24.500000) scale(-1, 1) translate(-43.000000, -24.500000) \" x=\"42\" y=\"24\" width=\"2\" height=\"1\"></rect>\\n        <rect id=\"Bar-Copy-9\" fill=\"#DDDDDD\" opacity=\"0.5\" transform=\"translate(46.000000, 24.500000) scale(-1, 1) translate(-46.000000, -24.500000) \" x=\"45\" y=\"24\" width=\"2\" height=\"1\"></rect>\\n        <rect id=\"Bar-Copy-2\" fill=\"#DDDDDD\" opacity=\"0.5\" transform=\"translate(31.000000, 23.500000) scale(-1, 1) translate(-31.000000, -23.500000) \" x=\"30\" y=\"22\" width=\"2\" height=\"3\"></rect>\\n        <rect id=\"Bar-Copy-3\" fill=\"#DDDDDD\" opacity=\"0.5\" transform=\"translate(28.000000, 23.000000) scale(-1, 1) translate(-28.000000, -23.000000) \" x=\"27\" y=\"21\" width=\"2\" height=\"4\"></rect>\\n        <rect id=\"Bar-Copy-4\" fill=\"#F2CC8F\" transform=\"translate(25.000000, 23.000000) scale(-1, 1) translate(-25.000000, -23.000000) \" x=\"24\" y=\"21\" width=\"2\" height=\"4\"></rect>\\n        <polygon id=\"Bar-Copy-5\" fill=\"#F2CC8F\" transform=\"translate(22.000000, 22.500000) scale(-1, 1) translate(-22.000000, -22.500000) \" points=\"21 20 23 20 23 25 21 25\"></polygon>\\n        <rect id=\"Bar-Copy-2\" fill=\"#F2CC8F\" x=\"9\" y=\"24\" width=\"2\" height=\"1\"></rect>\\n        <rect id=\"Bar-Copy-3\" fill=\"#F2CC8F\" x=\"12\" y=\"21\" width=\"2\" height=\"4\"></rect>\\n        <rect id=\"Bar-Copy-4\" fill=\"#F2CC8F\" x=\"15\" y=\"18\" width=\"2\" height=\"7\"></rect>\\n        <polygon id=\"Bar-Copy-5\" fill=\"#F2CC8F\" points=\"18 19 20 19 20 25 18 25\"></polygon>\\n        <polygon id=\"Rectangle-316\" fill=\"#979EA1\" points=\"9 10 9 5 13 7.5\"></polygon>\\n        <rect id=\"Rectangle-1876\" fill=\"#EEEEEE\" x=\"16\" y=\"6\" width=\"16\" height=\"3\"></rect>\\n    </g>\\n</svg>';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./widget-view.tpl');\nvar ContextMenuFactory = require('../../components/context-menu-factory-view');\nvar InlineEditorView = require('../../components/inline-editor/inline-editor-view');\nvar templateInlineEditor = require('./inline-editor.tpl');\nvar WidgetsService = require('./widgets-service');\n\nvar widgetIconTemplateMap = {\n  category: require('./widget-icon-layer-category.tpl'),\n  histogram: require('./widget-icon-layer-histogram.tpl'),\n  formula: require('./widget-icon-layer-formula.tpl'),\n  'time-series': require('./widget-icon-layer-timeSeries.tpl')\n};\n\n/**\n * View for an individual widget definition model.\n */\nmodule.exports = CoreView.extend({\n\n  tagName: 'li',\n\n  className: 'BlockList-item js-widgetItem',\n\n  initialize: function (opts) {\n    if (!opts.layer) throw new Error('layer is required');\n    if (!opts.userActions) throw new Error('userActions is required');\n\n    this.layer = opts.layer;\n    this._userActions = opts.userActions;\n    this.stackLayoutModel = opts.stackLayoutModel;\n\n    this.listenTo(this.model, 'change', this.render);\n    this.listenToOnce(this.model, 'destroy', this._onDestroy);\n  },\n\n  render: function () {\n    var widgetType = this.model.get('type');\n    var source = this.model.get('source');\n    var sourceColor = this.layer.get('color');\n\n    this.$el.html(template({\n      widgetType: widgetType,\n      layerName: this.layer.getName(),\n      source: source,\n      sourceColor: sourceColor\n    }));\n    this.$el.attr('data-model-cid', this.model.cid);\n\n    this._initViews();\n\n    return this;\n  },\n\n  _initViews: function () {\n    var widgetType = this.model.get('type');\n\n    this._inlineEditor = new InlineEditorView({\n      template: templateInlineEditor,\n      renderOptions: {\n        title: this.model.get('title')\n      },\n      onClick: this._onEditWidget.bind(this),\n      onEdit: this._renameWidget.bind(this)\n    });\n\n    this.$('.js-header').append(this._inlineEditor.render().el);\n    this.addView(this._inlineEditor);\n\n    var iconTemplate = widgetIconTemplateMap[widgetType];\n\n    if (!iconTemplate) {\n      console.log(widgetType + ' widget template not defined');\n    } else {\n      this.$('.js-widgetIcon').append(iconTemplate());\n    }\n\n    var menuItems = [{\n      label: _t('editor.widgets.options.rename'),\n      val: 'rename-widget',\n      action: this._onRenameWidget.bind(this)\n    }, {\n      label: _t('editor.widgets.options.edit'),\n      val: 'edit-widget',\n      action: this._onEditWidget.bind(this)\n    }, {\n      label: _t('editor.widgets.options.remove'),\n      val: 'delete-widget',\n      destructive: true,\n      action: this._confirmDeleteWidget.bind(this)\n    }];\n\n    this._contextMenuFactory = new ContextMenuFactory({\n      menuItems: menuItems\n    });\n\n    this.$('.js-context-menu').append(this._contextMenuFactory.render().el);\n    this.addView(this._contextMenuFactory);\n  },\n\n  _onRenameWidget: function () {\n    this._inlineEditor.edit();\n  },\n\n  _renameWidget: function () {\n    var newName = this._inlineEditor.getValue();\n\n    if (newName !== '' && newName !== this.model.get('title')) {\n      this.$('.js-title').text(newName).show();\n      this._inlineEditor.hide();\n      this.model.set({title: newName});\n      this._userActions.saveWidget(this.model);\n    }\n  },\n\n  _confirmDeleteWidget: function () {\n    WidgetsService.removeWidget(this.model);\n  },\n\n  _onEditWidget: function () {\n    WidgetsService.editWidget(this.model);\n  },\n\n  _onDestroy: function () {\n    this.clean();\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"BlockList-media u-rSpace--m js-widgetIcon\">\\n</div>\\n<div class=\"BlockList-inner u-ellipsis\">\\n  <div class=\"BlockList-title u-bSpace js-context-menu\">\\n    <div class=\"BlockList-titleText js-header\"></div>\\n  </div>\\n  <div class=\"u-flex\">\\n    <span\\n      class=\"SelectorLayer-letter CDB-Text CDB-Size-small u-whiteTextColor u-rSpace u-upperCase\"\\n      style=\"background-color: '+\n((__t=( sourceColor ))==null?'':_.escape(__t))+\n';\">'+\n((__t=( source ))==null?'':_.escape(__t))+\n'</span>\\n    <p class=\"CDB-Text CDB-Size-medium u-altTextColor u-ellipsis\">'+\n((__t=( layerName ))==null?'':_.escape(__t))+\n'</p>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"FormPlaceholder-widget u-tSpace-m u-flex\">\\n  <div class=\"FormPlaceholder-widgetIcon u-rSpace--m\"></div>\\n  <div class=\"FormPlaceholder-widgetInner\">\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--long\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--long\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med u-tSpace-xl\"></span>\\n  </div>\\n</div>\\n\\n<div class=\"FormPlaceholder-widget u-tSpace-m u-flex\">\\n  <div class=\"FormPlaceholder-widgetIcon u-rSpace--m\"></div>\\n  <div class=\"FormPlaceholder-widgetInner\">\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--long u-tSpace-xl\"></span>\\n  </div>\\n</div>\\n\\n<div class=\"FormPlaceholder-widget u-tSpace-m u-flex\">\\n  <div class=\"FormPlaceholder-widgetIcon u-rSpace--m\"></div>\\n  <div class=\"FormPlaceholder-widgetInner\">\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--med\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--short u-tSpace-xl\"></span>\\n  </div>\\n</div>\\n\\n<div class=\"FormPlaceholder-widget u-tSpace-m u-flex\">\\n  <div class=\"FormPlaceholder-widgetIcon u-rSpace--m\"></div>\\n  <div class=\"FormPlaceholder-widgetInner\">\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--long\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--long\"></span>\\n    <span class=\"FormPlaceholder-title FormPlaceholder-size--short u-tSpace-xl\"></span>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<h2 class=\"Inline-editor\">\\n  <div class=\"CDB-Text CDB-Size-huge is-light u-ellipsis js-title Inline-editor-text\">'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</div>\\n  <input type=\"text\" name=\"text\" class=\"Inline-editor-input Inline-editor-input--small CDB-Text CDB-InputText js-input\" value=\"'+\n((__t=( title ))==null?'':_.escape(__t))+\n'\" readonly>\\n</h2>';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar WidgetDefinitionModel = require('../../../../data/widget-definition-model');\n\nmodule.exports = Backbone.Model.extend({\n\n  initialize: function (attrs, options) {\n    var o = [\n      {\n        val: true,\n        label: _t('editor.widgets.widgets-form.style.yes')\n      }, {\n        val: false,\n        label: _t('editor.widgets.widgets-form.style.no')\n      }\n    ];\n    this.schema = {\n      sync_on_bbox_change: {\n        type: 'Radio',\n        title: _t('editor.widgets.widgets-form.style.sync_on_bbox_change'),\n        options: o\n      }\n    };\n  },\n\n  _addAllStyleSchemaAttributes: function () {\n    var customType = this.get('type') === 'category' ? 'categories' : 'ramp';\n    var styleAttrs = {\n      widget_style_definition: {\n        type: 'Fill',\n        title: _t('editor.widgets.widgets-form.style.fill'),\n        options: [],\n        configModel: this._configModel,\n        modals: this._modals,\n        userModel: this._userModel,\n        dialogMode: 'float',\n        editorAttrs: {\n          color: {\n            hidePanes: ['value'],\n            disableOpacity: true\n          }\n        }\n      }\n    };\n\n    if (this.get('auto_style_allowed')) {\n      var editorAttrs = {\n        color: {\n          hidePanes: ['fixed']\n        }\n      };\n\n      if (customType === 'categories') {\n        editorAttrs.color.hideTabs = ['bins', 'quantification'];\n      }\n\n      styleAttrs = _.extend(styleAttrs, {\n        auto_style_definition: {\n          type: 'EnablerEditor',\n          title: '',\n          label: _t('editor.widgets.widgets-form.style.custom-' + customType),\n          help: _t('editor.widgets.widgets-form.style.custom-help'),\n          editor: {\n            type: 'Fill',\n            title: '',\n            options: [this.get('column')],\n            dialogMode: 'float',\n            query: 'query',\n            configModel: this._configModel,\n            modals: this._modals,\n            userModel: this._userModel,\n            editorAttrs: editorAttrs\n          }\n        }\n      });\n    } else {\n      styleAttrs = _.extend(styleAttrs, {\n        auto_style_definition: {\n          type: 'Text',\n          title: _t('editor.widgets.widgets-form.style.custom-' + customType),\n          help: _t('editor.widgets.widgets-form.style.custom-disabled'),\n          disabled: true\n        }\n      });\n    }\n\n    this.schema = _.extend(this.schema, styleAttrs);\n  },\n\n  parse: function (r) {\n    var attrs = _.defaults(\n      {\n        sync_on_bbox_change: r.sync_on_bbox_change ? 'true' : ''\n      },\n      r\n    );\n    return attrs;\n  },\n\n  changeWidgetDefinitionModel: function (widgetDefinitionModel) {\n    var attrs = _.defaults(\n      {\n        sync_on_bbox_change: this.get('sync_on_bbox_change') === 'true'\n      },\n      this.attributes\n    );\n\n    if (attrs.auto_style_definition !== '' && _.isEmpty(attrs.auto_style_definition)) {\n      attrs.auto_style_definition = WidgetDefinitionModel.getDefaultAutoStyle(widgetDefinitionModel.get('type'), widgetDefinitionModel.get('column'));\n    }\n\n    widgetDefinitionModel.set(attrs);\n  }\n\n});\n",
    "var _ = require('underscore');\nvar WidgetsFormBaseSchema = require('./widgets-form-base-schema-model');\nvar checkAndBuildOpts = require('../../../../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'columnOptionsFactory',\n  'modals',\n  'configModel',\n  'userModel'\n];\n\nmodule.exports = WidgetsFormBaseSchema.extend({\n\n  defaults: {\n    schema: {},\n    aggregate: {\n      attribute: '',\n      operator: 'count'\n    }\n  },\n\n  initialize: function (attrs, opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    this.on('change:aggregate', this._updateAggregation, this);\n    this.on('change:column', this.updateSchema, this);\n\n    this._updateAggregation();\n\n    WidgetsFormBaseSchema.prototype.initialize.apply(this, arguments);\n  },\n\n  getFields: function () {\n    var fields = ['column', 'aggregate', 'prefix', 'suffix'];\n\n    return {\n      data: fields.join(','),\n      style: ['sync_on_bbox_change', 'widget_style_definition', 'auto_style_definition']\n    };\n  },\n\n  _updateAggregation: function () {\n    var aggregate = this.get('aggregate');\n    if (aggregate === undefined) {\n      this.set({\n        aggregation: 'count',\n        aggregation_column: ''\n      });\n    } else {\n      this.set({\n        aggregation_column: aggregate.attribute,\n        aggregation: aggregate.operator\n      });\n    }\n\n    this.updateSchema();\n  },\n\n  updateSchema: function () {\n    var columnOptions = this._columnOptionsFactory.create(this.get('column'));\n    var helpMsg = this._columnOptionsFactory.unavailableColumnsHelpMessage();\n    var aggregationOptions = _.filter(columnOptions, function (column) {\n      return column.type === 'number';\n    });\n\n    this.schema = _.extend(this.schema, {\n      column: {\n        type: 'Select',\n        title: _t('editor.widgets.widgets-form.data.aggregate-by'),\n        options: columnOptions,\n        help: helpMsg,\n        dialogMode: 'float',\n        editorAttrs: {\n          disabled: this._columnOptionsFactory.areColumnsUnavailable()\n        }\n      },\n      aggregate: {\n        type: 'Operators',\n        title: _t('editor.widgets.widgets-form.data.operation'),\n        options: aggregationOptions,\n        dialogMode: 'float',\n        editorAttrs: {\n          showSearch: false\n        }\n      },\n      suffix: {\n        type: 'EnablerEditor',\n        title: '',\n        label: _t('editor.widgets.widgets-form.data.suffix'),\n        editor: {\n          type: 'Text'\n        }\n      },\n      prefix: {\n        type: 'EnablerEditor',\n        title: '',\n        label: _t('editor.widgets.widgets-form.data.prefix'),\n        editor: {\n          type: 'Text'\n        }\n      }\n    });\n\n    this._addAllStyleSchemaAttributes();\n  },\n\n  canSave: function () {\n    var aggregation = this.get('aggregation');\n    var aggregationColumn = this.get('aggregation_column');\n    var canSave = false;\n\n    if (aggregation === 'count') {\n      canSave = true;\n    } else {\n      canSave = !!(aggregation && aggregationColumn);\n    }\n\n    return canSave;\n  }\n\n});\n",
    "var _ = require('underscore');\nvar WidgetsFormBaseSchema = require('./widgets-form-base-schema-model');\n\nmodule.exports = WidgetsFormBaseSchema.extend({\n\n  defaults: {\n    schema: {}\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.columnOptionsFactory) throw new Error('columnOptionsFactory is required');\n    this._columnOptionsFactory = opts.columnOptionsFactory;\n\n    WidgetsFormBaseSchema.prototype.initialize.apply(this, arguments);\n  },\n\n  getFields: function () {\n    return {\n      data: 'column,operation,prefix,suffix,description',\n      style: 'sync_on_bbox_change'\n    };\n  },\n\n  updateSchema: function () {\n    var columnOptions = this._columnOptionsFactory.create(this.get('column'), this._isNumberType);\n\n    this.schema = _.extend(this.schema, {\n      column: {\n        type: 'Select',\n        title: _t('editor.widgets.widgets-form.data.column'),\n        help: this._columnOptionsFactory.unavailableColumnsHelpMessage(),\n        options: columnOptions,\n        dialogMode: 'float',\n        editorAttrs: {\n          disabled: this._columnOptionsFactory.areColumnsUnavailable()\n        }\n      },\n      operation: {\n        type: 'Select',\n        title: _t('editor.widgets.widgets-form.data.operation'),\n        dialogMode: 'float',\n        options: ['min', 'max', 'count', 'avg', 'sum']\n      },\n      suffix: {\n        type: 'EnablerEditor',\n        title: '',\n        label: _t('editor.widgets.widgets-form.data.suffix'),\n        editor: {\n          type: 'Text'\n        }\n      },\n      prefix: {\n        type: 'EnablerEditor',\n        title: '',\n        label: _t('editor.widgets.widgets-form.data.prefix'),\n        editor: {\n          type: 'Text'\n        }\n      },\n      description: {\n        type: 'EnablerEditor',\n        title: '',\n        label: _t('editor.widgets.widgets-form.style.description'),\n        editor: {\n          type: 'TextArea'\n        }\n      }\n    });\n  },\n\n  canSave: function () {\n    return !!this.get('column');\n  },\n\n  _isNumberType: function (m) {\n    return m.get('type') === 'number';\n  }\n\n});\n",
    "var _ = require('underscore');\nvar WidgetsFormBaseSchema = require('./widgets-form-base-schema-model');\nvar checkAndBuildOpts = require('../../../../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'columnOptionsFactory',\n  'modals',\n  'configModel',\n  'userModel'\n];\n\nmodule.exports = WidgetsFormBaseSchema.extend({\n\n  initialize: function (attrs, opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n\n    WidgetsFormBaseSchema.prototype.initialize.apply(this, arguments);\n  },\n\n  getFields: function () {\n    return {\n      data: ['column', 'bins'],\n      style: ['sync_on_bbox_change', 'widget_style_definition', 'auto_style_definition']\n    };\n  },\n\n  updateSchema: function () {\n    var columnOptions = this._columnOptionsFactory.create(this.get('column'), this._isNumberType);\n    var helpMsg = this._columnOptionsFactory.unavailableColumnsHelpMessage();\n\n    this.schema = _.extend(this.schema, {\n      column: {\n        title: _t('editor.widgets.widgets-form.data.column'),\n        type: 'Select',\n        help: helpMsg,\n        options: columnOptions,\n        dialogMode: 'float',\n        editorAttrs: {\n          disabled: this._columnOptionsFactory.areColumnsUnavailable()\n        }\n      },\n      bins: {\n        title: _t('editor.widgets.widgets-form.data.bins'),\n        type: 'Number',\n        validators: ['required', {\n          type: 'interval',\n          min: 2,\n          max: 30\n        }]\n      }\n    });\n\n    this._addAllStyleSchemaAttributes();\n  },\n\n  canSave: function () {\n    return !!this.get('column');\n  },\n\n  _isNumberType: function (m) {\n    return m.get('type') === 'number';\n  }\n\n});\n",
    "var _ = require('underscore');\nvar WidgetsFormBaseSchema = require('./widgets-form-base-schema-model');\nvar checkAndBuildOpts = require('../../../../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'columnOptionsFactory'\n];\n\nmodule.exports = WidgetsFormBaseSchema.extend({\n\n  initialize: function (attrs, opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n    WidgetsFormBaseSchema.prototype.initialize.apply(this, arguments);\n  },\n\n  getFields: function () {\n    return {\n      data: ['column', 'bins'],\n      style: ['sync_on_bbox_change', 'widget_style_definition']\n    };\n  },\n\n  updateSchema: function () {\n    var columnOptions = this._columnOptionsFactory.create(this.get('column'), this._isDateType);\n    var helpMsg = this._columnOptionsFactory.unavailableColumnsHelpMessage();\n\n    this.schema = _.extend(this.schema, {\n      column: {\n        title: _t('editor.widgets.widgets-form.data.column'),\n        type: 'Select',\n        help: helpMsg,\n        options: columnOptions,\n        dialogMode: 'float',\n        editorAttrs: {\n          disabled: this._columnOptionsFactory.areColumnsUnavailable()\n        }\n      },\n      bins: {\n        title: _t('editor.widgets.widgets-form.data.bins'),\n        type: 'Number',\n        validators: ['required', {\n          type: 'interval',\n          min: 0,\n          max: 256\n        }]\n      },\n      widget_style_definition: {\n        type: 'Fill',\n        title: _t('editor.widgets.widgets-form.style.fill'),\n        options: [],\n        dialogMode: 'float',\n        editorAttrs: {\n          color: {\n            hidePanes: ['value'],\n            disableOpacity: true\n          }\n        }\n      }\n    });\n  },\n\n  canSave: function () {\n    return this.get('column');\n  },\n\n  _isDateType: function (m) {\n    return m.get('type') === 'date' || m.get('type') === 'number';\n  }\n\n});\n",
    "var CoreView = require('backbone/core-view');\nvar template = require('./widget-header.tpl');\nvar InlineEditorView = require('../../../components/inline-editor/inline-editor-view');\nvar templateInlineEditor = require('./inline-editor.tpl');\nvar ContextMenuFactory = require('../../../components/context-menu-factory-view');\nvar WidgetsService = require('../widgets-service');\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-toggle-menu': '_onToggleContextMenuClicked'\n  },\n\n  initialize: function (opts) {\n    if (!this.model) throw new Error('model is required');\n    if (!opts.layerDefinitionModel) throw new Error('layerDefinitionModel is required');\n    if (!opts.userActions) throw new Error('userActions is required');\n    if (!opts.stackLayoutModel) throw new Error('stackLayoutModel is required');\n\n    this._layerDefinitionModel = opts.layerDefinitionModel;\n    this._userActions = opts.userActions;\n    this._stackLayoutModel = opts.stackLayoutModel;\n  },\n\n  render: function () {\n    var widgetTitle = this.model.get('title');\n\n    this.$el.html(\n      template({\n        title: widgetTitle,\n        source: this.model.get('source'),\n        sourceColor: this._layerDefinitionModel.get('color'),\n        layerName: this._layerDefinitionModel.getName()\n      })\n    );\n\n    this._initViews();\n    return this;\n  },\n\n  _initViews: function () {\n    var widgetTitle = this.model.get('title');\n\n    this._inlineEditor = new InlineEditorView({\n      template: templateInlineEditor,\n      renderOptions: {\n        title: widgetTitle\n      },\n      onEdit: this._renameWidget.bind(this)\n    });\n\n    this.$('.js-header').append(this._inlineEditor.render().el);\n    this.addView(this._inlineEditor);\n\n    var menuItems = [{\n      label: _t('editor.widgets.options.rename'),\n      val: 'rename-widget',\n      action: this._onRenameWidget.bind(this)\n    }, {\n      label: _t('editor.widgets.options.remove'),\n      val: 'delete-widget',\n      destructive: true,\n      action: this._confirmDeleteWidget.bind(this)\n    }];\n\n    this._contextMenuFactory = new ContextMenuFactory({\n      menuItems: menuItems\n    });\n\n    this.$('.js-context-menu').append(this._contextMenuFactory.render().el);\n    this.addView(this._contextMenuFactory);\n  },\n\n  _onRenameWidget: function () {\n    this._inlineEditor.edit();\n  },\n\n  _renameWidget: function () {\n    var newName = this._inlineEditor.getValue();\n\n    if (newName !== '' && newName !== this.model.get('title')) {\n      this.model.set({title: newName});\n      this._userActions.saveWidget(this.model);\n      this.$('.js-title').text(newName).show();\n      this._inlineEditor.hide();\n    }\n  },\n\n  _confirmDeleteWidget: function () {\n    WidgetsService.removeWidget(this.model);\n  },\n\n  _onDeleteWidget: function (modal) {\n    modal.destroy();\n    this._stackLayoutModel.prevStep('widgets');\n    this.model.destroy();\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-HeaderInfoEditor\">\\n  <div class=\"u-rSpace--xl u-actionTextColor js-back Editor-HeaderInfoEditorShape\">\\n    <button>\\n      <i class=\"CDB-IconFont CDB-IconFont-arrowPrev Size-large\"></i>\\n    </button>\\n  </div>\\n  <div class=\"Editor-HeaderInfo-inner\">\\n    <div class=\"Editor-HeaderInfo-title js-context-menu\">\\n      <div class=\"Editor-HeaderInfo-titleText js-header\"></div>\\n    </div>\\n\\n    <div class=\"u-flex\">\\n      <span class=\"SelectorLayer-letter CDB-Text CDB-Size-small u-whiteTextColor u-rSpace u-upperCase\"\\n        style=\"background-color: '+\n((__t=( sourceColor ))==null?'':_.escape(__t))+\n';\">'+\n((__t=( source ))==null?'':_.escape(__t))+\n'</span>\\n      <p class=\"CDB-Text CDB-Size-medium u-altTextColor u-ellipsis\">'+\n((__t=( layerName ))==null?'':_.escape(__t))+\n'</p>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "/**\n * Object to generate column options for a current state of a query schema model\n */\nvar F = function (querySchemaModel) {\n  this._querySchemaModel = querySchemaModel;\n};\n\nF.prototype.areColumnsUnavailable = function () {\n  var status = this._querySchemaModel.get('status');\n  return status === 'fetching' || status === 'unavailable';\n};\n\nF.prototype.unavailableColumnsHelpMessage = function () {\n  if (this._querySchemaModel.get('status') === 'unavailable') {\n    return _t('editor.widgets.widgets-form.data.columns-unavailable');\n  }\n};\n\nF.prototype.create = function (currentVal, columnFilter) {\n  columnFilter = columnFilter || function () {\n    return true;\n  };\n\n  switch (this._querySchemaModel.get('status')) {\n    case 'fetching':\n      return [{val: _t('editor.widgets.widgets-form.data.loading')}];\n    case 'unavailable':\n      return [{val: currentVal}];\n    default:\n      return this._querySchemaModel\n        .columnsCollection\n        .filter(columnFilter)\n        .map(function (m) {\n          var columnName = m.get('name');\n          return {\n            val: columnName,\n            label: columnName,\n            type: m.get('type')\n          };\n        });\n  }\n};\n\nmodule.exports = F;\n",
    "var CoreView = require('backbone/core-view');\nvar WidgetsFormView = require('./widgets-form-view');\nvar WidgetHeaderView = require('./widget-header.js');\nvar ScrollView = require('../../../components/scroll/scroll-view');\nvar checkAndBuildOpts = require('../../../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'userActions',\n  'widgetDefinitionModel',\n  'modals',\n  'analysisDefinitionNodesCollection',\n  'layerDefinitionsCollection',\n  'stackLayoutModel',\n  'configModel',\n  'userModel'\n];\n\n/**\n * View to render all necessary for the widget form\n */\n\nmodule.exports = CoreView.extend({\n  events: {\n    'click .js-back': '_goBack'\n  },\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this._initViews();\n    return this;\n  },\n\n  _initBinds: function () {\n    this._widgetDefinitionModel.bind('destroy', this._goBack, this);\n    this.add_related_model(this._widgetDefinitionModel);\n  },\n\n  _initViews: function () {\n    var self = this;\n    var nodeId = self._widgetDefinitionModel.get('source');\n    var analysisDefinitionNodeModel = self._analysisDefinitionNodesCollection.get(nodeId);\n\n    var header = new WidgetHeaderView({\n      layerDefinitionModel: this._layerDefinitionsCollection.get(this._widgetDefinitionModel.get('layer_id')),\n      model: this._widgetDefinitionModel,\n      modals: this._modals,\n      userActions: this._userActions,\n      stackLayoutModel: this._stackLayoutModel\n    });\n    this.$el.append(header.render().$el);\n    this.addView(header);\n\n    var view = new ScrollView({\n      createContentView: function () {\n        return new WidgetsFormView({\n          userActions: self._userActions,\n          widgetDefinitionModel: self._widgetDefinitionModel,\n          querySchemaModel: analysisDefinitionNodeModel.querySchemaModel,\n          modals: self._modals,\n          configModel: self._configModel,\n          userModel: self._userModel\n        });\n      }\n    });\n\n    this.$el.append(view.render().$el);\n    this.addView(view);\n  },\n\n  _goBack: function () {\n    if (this._stackLayoutPrevStep) {\n      this._stackLayoutPrevStep();\n    } else {\n      this._stackLayoutModel.prevStep('widgets');\n    }\n  }\n\n});\n",
    "var _ = require('underscore');\nvar WidgetsFormColumnOptionsFactory = require('./widgets-form-column-options-factory');\n\nvar dataMap = {\n  category: {\n    labelTranslationKey: 'editor.widgets.widgets-form.type.category',\n    iconTemplate: require('../widget-icon-category.tpl'),\n    Class: require('./schema/widgets-form-category-schema-model')\n  },\n  formula: {\n    labelTranslationKey: 'editor.widgets.widgets-form.type.formula',\n    iconTemplate: require('../widget-icon-formula.tpl'),\n    Class: require('./schema/widgets-form-formula-schema-model'),\n    checkIfValid: function (querySchemaModel) {\n      return querySchemaModel.columnsCollection.any(function (m) {\n        return m.get('type') === 'number';\n      });\n    }\n  },\n  histogram: {\n    labelTranslationKey: 'editor.widgets.widgets-form.type.histogram',\n    iconTemplate: require('../widget-icon-histogram.tpl'),\n    Class: require('./schema/widgets-form-histogram-schema-model'),\n    checkIfValid: function (querySchemaModel) {\n      return querySchemaModel.columnsCollection.any(function (m) {\n        return m.get('type') === 'number';\n      });\n    }\n  },\n  'time-series': {\n    labelTranslationKey: 'editor.widgets.widgets-form.type.time_series',\n    iconTemplate: require('../widget-icon-timeSeries.tpl'),\n    Class: require('./schema/widgets-form-time-series-schema-model'),\n    checkIfValid: function (querySchemaModel) {\n      return querySchemaModel.columnsCollection.any(function (m) {\n        return m.get('type') === 'date' || m.get('type') === 'number';\n      });\n    }\n  }\n};\n\nmodule.exports = {\n\n  createWidgetFormModel: function (options) {\n    var widgetDefinitionModel = options.widgetDefinitionModel;\n    var widgetType = widgetDefinitionModel.get('type');\n    var Klass = dataMap[widgetType].Class;\n    return new Klass(widgetDefinitionModel.attributes, {\n      parse: true, // in case the raw attributes needs to be adapted to the expected form types, e.g. timestamp => Date\n      widgetDefinitionModel: widgetDefinitionModel,\n      columnOptionsFactory: new WidgetsFormColumnOptionsFactory(options.querySchemaModel),\n      userModel: options.userModel,\n      modals: options.modals,\n      configModel: options.configModel\n    });\n  },\n\n  getDataTypes: function (querySchemaModel) {\n    return _.reduce(dataMap, function (memo, val, key) {\n      if (val.checkIfValid ? val.checkIfValid(querySchemaModel) : true) {\n        memo.push({\n          iconTemplate: val.iconTemplate,\n          value: key,\n          label: _t(val.labelTranslationKey)\n        });\n      }\n      return memo;\n    }, []);\n  }\n\n};\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar WidgetFormFactory = require('./widgets-form-factory');\nvar template = require('./widgets-form-fields.tpl');\nrequire('../../../components/form-components/index');\nvar checkAndBuildOpts = require('../../../helpers/required-opts');\n\nvar REQUIRED_OPTS = [\n  'userActions',\n  'widgetDefinitionModel',\n  'querySchemaModel',\n  'modals',\n  'configModel',\n  'userModel'\n];\n\n/**\n *  View of form to edit a widget definition's data\n *\n */\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n    var widgetOptions = {\n      widgetDefinitionModel: this._widgetDefinitionModel,\n      querySchemaModel: this._querySchemaModel,\n      modals: this._modals,\n      userModel: this._userModel,\n      configModel: this._configModel\n    };\n\n    this._widgetFormModel = WidgetFormFactory.createWidgetFormModel(widgetOptions);\n    this._widgetFormModel.updateSchema();\n\n    this._debounceSaveWidget = _.debounce(this._saveWidget.bind(this), 500);\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this._removeForm();\n    this.$el.empty();\n    this._initViews();\n    return this;\n  },\n\n  _initBinds: function () {\n    this._widgetFormModel.bind('change:aggregation', this.render, this);\n    this._widgetFormModel.bind('change:column', this.render, this);\n    this._widgetFormModel.bind('change', this._onFormChange, this);\n    this.add_related_model(this._widgetFormModel);\n\n    this._widgetDefinitionModel.on('change:title', function (model, title) {\n      this._widgetFormModel.set({title: title}, {silent: true}); // silent to avoid sending the form\n    }, this);\n    this._widgetDefinitionModel.bind('change:auto_style_definition', this._onAutoStyleChanged, this);\n    this.add_related_model(this._widgetDefinitionModel);\n  },\n\n  _initViews: function () {\n    var model = this._widgetFormModel;\n    var fields = model.getFields();\n\n    this._widgetFormView = new Backbone.Form({\n      template: template,\n      templateData: {\n        dataFields: fields.data,\n        styleFields: fields.style\n      },\n      model: model\n    });\n\n    this._widgetFormView.bind('change', function () {\n      this.commit();\n    });\n\n    this.$el.append(this._widgetFormView.render().$el);\n\n    return this;\n  },\n\n  _removeForm: function () {\n    // Backbone.Form removes the view with the following method\n    this._widgetFormView && this._widgetFormView.remove();\n  },\n\n  _onFormChange: function () {\n    if (this._widgetFormModel.canSave()) {\n      this._widgetFormModel.changeWidgetDefinitionModel(this._widgetDefinitionModel);\n      this._debounceSaveWidget();\n    }\n  },\n\n  _onAutoStyleChanged: function (widgetDefModel, changedAttrs) {\n    var previousAutoStyleDefinition = widgetDefModel.previous('auto_style_definition');\n    if (previousAutoStyleDefinition === '' && _.isEmpty(previousAutoStyleDefinition)) {\n      this._widgetFormModel.set({\n        auto_style_definition: widgetDefModel.get('auto_style_definition')\n      }, {\n        silent: true\n      });\n\n      if (!_.isEmpty(changedAttrs)) {\n        this.render();\n      }\n    }\n  },\n\n  _saveWidget: function () {\n    this._userActions.saveWidget(this._widgetDefinitionModel);\n  },\n\n  clean: function () {\n    this._removeForm();\n    CoreView.prototype.clean.call(this);\n  }\n\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-HeaderInfo\">\\n  <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">2</div>\\n\\n  <div class=\"Editor-HeaderInfo-inner CDB-Text\">\\n    <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n      <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.widgets.widgets-form.data.title-label') ))==null?'':_.escape(__t))+\n'</h2>\\n    </div>\\n    <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.widgets.widgets-form.data.description') ))==null?'':_.escape(__t))+\n'</p>\\n\\n    <div data-fields=\"'+\n((__t=( dataFields ))==null?'':_.escape(__t))+\n'\"></div>\\n\\n  </div>\\n</div>\\n\\n<div class=\"CDB-HeaderInfo\">\\n  <div class=\"CDB-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">3</div>\\n\\n  <div class=\"Editor-HeaderInfo-inner CDB-Text\">\\n    <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n      <h2 class=\"CDB-Text CDB-HeaderInfo-TitleText CDB-Size-large\">'+\n((__t=( _t('editor.widgets.widgets-form.style.title-label') ))==null?'':_.escape(__t))+\n'</h2>\\n    </div>\\n    <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m\">'+\n((__t=( _t('editor.widgets.widgets-form.style.define') ))==null?'':_.escape(__t))+\n'</p>\\n\\n    <div data-fields=\"'+\n((__t=( styleFields ))==null?'':_.escape(__t))+\n'\"></div>\\n\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"Editor-HeaderInfo\">\\n  <div class=\"Editor-HeaderNumeration CDB-Text is-semibold u-rSpace--m\">1</div>\\n  <div class=\"Editor-HeaderInfo-inner CDB-Text js-selector\">\\n    <div class=\"Editor-HeaderInfo-title u-bSpace--m\">\\n      <h2 class=\"CDB-Text CDB-HeaderInfo-titleText CDB-Size-large\">'+\n((__t=( _t('editor.widgets.widgets-form.type.title-label') ))==null?'':_.escape(__t))+\n'</h2>\\n    </div>\\n    <p class=\"CDB-Text u-upperCase CDB-FontSize-small u-altTextColor u-bSpace--m js-highlight\">'+\n((__t=( _t('editor.widgets.widgets-form.type.description') ))==null?'':_.escape(__t))+\n'</p>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var CoreView = require('backbone/core-view');\nvar _ = require('underscore');\nvar CarouselFormView = require('../../../components/carousel-form-view');\nvar CarouselCollection = require('../../../components/custom-carousel/custom-carousel-collection');\nvar WidgetFormFactory = require('./widgets-form-factory');\nvar WidgetsFormFieldsView = require('./widgets-form-fields-view');\nvar checkAndBuildOpts = require('../../../helpers/required-opts');\nvar loadingTemplate = require('../../layers/panel-loading-template.tpl');\n\nvar REQUIRED_OPTS = [\n  'userActions',\n  'widgetDefinitionModel',\n  'modals',\n  'querySchemaModel',\n  'configModel',\n  'userModel'\n];\n\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    checkAndBuildOpts(opts, REQUIRED_OPTS, this);\n    this._initBinds();\n\n    if (this._querySchemaModel.shouldFetch()) {\n      this._querySchemaModel.fetch();\n    }\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n\n    if (!this._querySchemaModel.isFetched()) {\n      this.$el.html(loadingTemplate());\n    } else {\n      this._renderCarousel();\n      this._renderForm();\n    }\n\n    return this;\n  },\n\n  _initBinds: function () {\n    this.listenTo(this._widgetDefinitionModel, 'change:type', this._renderForm);\n    this.listenTo(this._querySchemaModel, 'change:status', this.render);\n  },\n\n  _renderCarousel: function () {\n    var carouselCollection = new CarouselCollection(\n      _.map(WidgetFormFactory.getDataTypes(this._querySchemaModel), function (type) {\n        return {\n          selected: this._widgetDefinitionModel.get('type') === type.value,\n          val: type.value,\n          label: type.label,\n          template: function () {\n            return (type.iconTemplate && type.iconTemplate({ makeItBig: true })) || type.value;\n          }\n        };\n      }, this)\n    );\n\n    carouselCollection.bind('change:selected', function (mdl) {\n      if (mdl.get('selected')) {\n        this._widgetDefinitionModel.changeType(mdl.getValue());\n        this._userActions.saveWidget(this._widgetDefinitionModel);\n      }\n    }, this);\n\n    var view = new CarouselFormView({\n      collection: carouselCollection,\n      template: require('./widgets-form-types.tpl')\n    });\n    this.addView(view);\n    this.$el.append(view.render().el);\n  },\n\n  _renderForm: function () {\n    if (this._formView) {\n      this.removeView(this._formView);\n      this._formView.clean();\n    }\n    this._formView = new WidgetsFormFieldsView({\n      userActions: this._userActions,\n      widgetDefinitionModel: this._widgetDefinitionModel,\n      querySchemaModel: this._querySchemaModel,\n      modals: this._modals,\n      userModel: this._userModel,\n      configModel: this._configModel\n    });\n    this.addView(this._formView);\n    this.$el.append(this._formView.render().el);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<h2 class=\"CDB-Text CDB-Size-huge is-light u-secondaryTextColor\">'+\n((__t=( _t('editor.widgets.widgets-form.placeholder-text') ))==null?'':_.escape(__t))+\n'</h2>\\n<div class=\"BlockList-item is-dashed no-hover is-space u-tSpace-xl\">\\n  <div class=\"WidgetPlaceHolder\">\\n    <div class=\"WidgetPlaceHolder-media\"></div>\\n    <div class=\"WidgetPlaceHolder-txt\">\\n        <h2 class=\"WidgetPlaceHolder-title\"></h2>\\n        <p class=\"WidgetPlaceHolder-text\"></p>\\n    </div>\\n  </div>\\n  <button class=\"CDB-Button CDB-Button--primary js-add\">\\n    <span class=\"CDB-Button-Text CDB-Text is-semibold CDB-Size-small u-upperCase\">'+\n((__t=( _t('editor.widgets.widgets-view.add_widget') ))==null?'':_.escape(__t))+\n'</span>\\n  </button>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "var removeWidgetConfirmationTemplate = require('./delete-widget-confirmation.tpl');\nvar ConfirmationView = require('../../components/modals/confirmation/modal-confirmation-view');\n\nvar service = (function () {\n  return {\n    init: function (opts) {\n      if (!opts.widgetDefinitionsCollection) throw new Error('widgetDefinitionsCollection is required');\n      if (!opts.analysisDefinitionNodesCollection) throw new Error('analysisDefinitionNodesCollection');\n      if (!opts.layerDefinitionsCollection) throw new Error('layerDefinitionsCollection is required');\n      if (!opts.userActions) throw new Error('userActions is required');\n      if (!opts.modals) throw new Error('modals is required');\n\n      this._modals = opts.modals;\n      this._userActions = opts.userActions;\n      this._layerDefinitionsCollection = opts.layerDefinitionsCollection;\n      this._widgetDefinitionsCollection = opts.widgetDefinitionsCollection;\n      this._analysisDefinitionNodesCollection = opts.analysisDefinitionNodesCollection;\n    },\n\n    setStackLayoutBehaviour: function (stackLayoutModel, nextStepProps, backStepProps) {\n      this._stackLayoutModel = stackLayoutModel;\n      this._nextStepProps = nextStepProps;\n      this._backStepProps = backStepProps;\n    },\n\n    removeWidget: function (widgetDefModel, callback) {\n      var widgetName = widgetDefModel.get('title');\n\n      if (widgetDefModel) {\n        this._modals.create(function (modalModel) {\n          return new ConfirmationView({\n            modalModel: modalModel,\n            template: removeWidgetConfirmationTemplate,\n            loadingTitle: _t('editor.widgets.delete.loading', {name: widgetName}),\n            renderOpts: {\n              name: widgetName\n            },\n            runAction: function () {\n              modalModel.destroy();\n              widgetDefModel.destroy();\n              callback && callback();\n            }\n          });\n        });\n      }\n    },\n\n    editWidget: function (widgetDefModel) {\n      if (!this._stackLayoutModel) {\n        return;\n      }\n\n      this._stackLayoutModel.goToStep(\n        this._nextStepProps.position,\n        widgetDefModel,\n        this._nextStepProps.arguments,\n        function () {\n          this._stackLayoutModel.goToStep(\n            this._backStepProps.position,\n            this._backStepProps.arguments\n          );\n        }.bind(this)\n      );\n    }\n  };\n})();\n\nmodule.exports = service;\n",
    "var _ = require('underscore');\nvar $ = require('jquery');\nvar Backbone = require('backbone');\nvar CoreView = require('backbone/core-view');\nvar EditorWidgetView = require('./widget-view');\nvar template = require('./widgets-view.tpl');\nvar widgetPlaceholderTemplate = require('./widgets-placeholder.tpl');\nvar widgetsErrorTemplate = require('./widgets-content-error.tpl');\nvar widgetsNotReadyTemplate = require('./widgets-content-not-ready.tpl');\n\nrequire('jquery-ui');\n\n/**\n * View to render widgets definitions overview\n */\nmodule.exports = CoreView.extend({\n\n  initialize: function (opts) {\n    if (!opts.userActions) throw new Error('userActions is required');\n    if (!opts.layerDefinitionsCollection) throw new Error('layerDefinitionsCollection is required');\n    if (!opts.widgetDefinitionsCollection) throw new Error('widgetDefinitionsCollection is required');\n    if (!opts.stackLayoutModel) throw new Error('stackLayoutModel is required');\n    if (!opts.modals) throw new Error('modals is required');\n\n    this._userActions = opts.userActions;\n    this._modals = opts.modals;\n    this._layerDefinitionsCollection = opts.layerDefinitionsCollection;\n    this._widgetDefinitionsCollection = opts.widgetDefinitionsCollection;\n    this.stackLayoutModel = opts.stackLayoutModel;\n\n    this._widgetDefinitionsCollection.on('add', this._goToWidget, this);\n    this._widgetDefinitionsCollection.on('destroy', this.render, this);\n    this.add_related_model(this._widgetDefinitionsCollection);\n\n    this.viewModel = new Backbone.Model({\n      state: 'loading'\n    });\n\n    this.viewModel.on('change:state', this.render, this);\n    this.add_related_model(this.viewModel);\n\n    var callback = this._onAllQueryGeometryLoaded.bind(this);\n    this._layerDefinitionsCollection.loadAllQueryGeometryModels(callback);\n  },\n\n  render: function () {\n    this._destroySortable();\n    this.clearSubViews();\n    this.$el.empty();\n\n    if (this._isLoading()) {\n      this.$el.append(widgetsNotReadyTemplate());\n    } else {\n      if (!this._anyGeometryData()) {\n        this._showNoGeometryData();\n      } else {\n        if (this._widgetDefinitionsCollection.size() > 0) {\n          this.$el.append(template);\n          _.each(this._widgetDefinitionsCollection.sortBy('order'), this._addWidgetItem, this);\n          this._initSortable();\n        } else {\n          this.$el.append(widgetPlaceholderTemplate());\n        }\n      }\n    }\n\n    return this;\n  },\n\n  _showNoGeometryData: function () {\n    this.$el.append(\n      widgetsErrorTemplate({\n        body: _t('editor.widgets.no-geometry-data')\n      })\n    );\n  },\n\n  _onAllQueryGeometryLoaded: function () {\n    this.viewModel.set({state: 'ready'});\n  },\n\n  _isLoading: function () {\n    return this.viewModel.get('state') === 'loading';\n  },\n\n  _isReady: function () {\n    return this.viewModel.get('state') === 'ready';\n  },\n\n  _anyGeometryData: function () {\n    return this._layerDefinitionsCollection.isThereAnyGeometryData();\n  },\n\n  _initSortable: function () {\n    this.$('.js-widgets').sortable({\n      axis: 'y',\n      items: '> li.BlockList-item',\n      opacity: 0.8,\n      update: this._onSortableFinish.bind(this),\n      forcePlaceholderSize: false\n    }).disableSelection();\n  },\n\n  _destroySortable: function () {\n    if (this.$('.js-widgets').data('ui-sortable')) {\n      this.$('.js-widgets').sortable('destroy');\n    }\n  },\n\n  _onSortableFinish: function () {\n    var self = this;\n    this.$('.js-widgets > .js-widgetItem').each(function (index, item) {\n      var modelCid = $(item).data('model-cid');\n      var widgetDefModel = self._widgetDefinitionsCollection.get(modelCid);\n      widgetDefModel.set('order', index);\n      self._userActions.saveWidget(widgetDefModel);\n    });\n  },\n\n  _goToWidget: function (widgetModel) {\n    this.stackLayoutModel.nextStep(widgetModel, 'widget-content');\n  },\n\n  _addWidgetItem: function (m) {\n    var view = new EditorWidgetView({\n      model: m,\n      layer: this._layerDefinitionsCollection.get(m.get('layer_id')),\n      modals: this._modals,\n      userActions: this._userActions,\n      stackLayoutModel: this.stackLayoutModel\n    });\n    this.addView(view);\n    this.$('.js-widgets').append(view.render().el);\n  },\n\n  clean: function () {\n    this._destroySortable();\n    CoreView.prototype.clean.apply(this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<ul class=\"BlockList js-widgets\"></ul>\\n';\n}\nreturn __p;\n};\n",
    "/**\n * Just provide info about the current browser\n */\n\nmodule.exports = function () {\n  var ua = navigator.userAgent;\n  var tem;\n  var M = ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\\/))\\/?\\s*(\\d+)/i) || [];\n  if (/trident/i.test(M[1])) {\n    tem = /\\brv[ :]+(\\d+)/g.exec(ua) || [];\n    return {\n      name: 'IE ',\n      version: (tem[1] || '')\n    };\n  }\n  if (M[1] === 'Chrome') {\n    tem = ua.match(/\\bOPR\\/(\\d+)/);\n    if (tem != null) {\n      return {\n        name: 'Opera',\n        version: tem[1]\n      };\n    }\n  }\n  M = M[2] ? [M[1], M[2]] : [navigator.appName, navigator.appVersion, '-?'];\n  if ((tem = ua.match(/version\\/(\\d+)/i)) != null) {\n    M.splice(1, 1, tem[1]);\n  }\n\n  return {\n    name: M[0],\n    version: M[1]\n  };\n};\n",
    "module.exports = [\n  'aliceblue', 'antiquewhite', 'aqua', 'aquamarine', 'azure', 'beige',\n  'bisque', 'black', 'blanchedalmond', 'blue', 'blueviolet', 'brown',\n  'burlywood', 'cadetblue', 'chartreuse', 'chocolate', 'coral', 'cornflowerblue',\n  'cornsilk', 'crimson', 'cyan', 'darkblue', 'darkcyan', 'darkgoldenrod',\n  'darkgray', 'darkgreen', 'darkkhaki', 'darkmagenta', 'darkolivegreen',\n  'darkorange', 'darkorchid', 'darkred', 'darksalmon', 'darkseagreen',\n  'darkslateblue', 'darkslategray', 'darkturquoise', 'darkviolet',\n  'deeppink', 'deepskyblue', 'dimgray', 'dodgerblue', 'firebrick',\n  'floralwhite', 'forestgreen', 'fuchsia', 'gainsboro', 'ghostwhite',\n  'gold', 'goldenrod', 'gray', 'grey', 'green', 'greenyellow', 'honeydew',\n  'hotpink', 'indianred', 'indigo', 'ivory', 'khaki', 'lavender',\n  'lavenderblush', 'lawngreen', 'lemonchiffon', 'lightblue', 'lightcoral',\n  'lightcyan', 'lightgoldenrodyellow', 'lightgray', 'lightgreen', 'lightpink',\n  'lightsalmon', 'lightseagreen', 'lightskyblue', 'lightslategray',\n  'lightsteelblue', 'lightyellow', 'lime', 'limegreen', 'linen', 'magenta',\n  'maroon', 'mediumaquamarine', 'mediumblue', 'mediumorchid', 'mediumpurple',\n  'mediumseagreen', 'mediumslateblue', 'mediumspringgreen', 'mediumturquoise',\n  'mediumvioletred', 'midnightblue', 'mintcream', 'mistyrose', 'moccasin',\n  'navajowhite', 'navy', 'oldlace', 'olive', 'olivedrab', 'orange', 'orangered',\n  'orchid', 'palegoldenrod', 'palegreen', 'paleturquoise', 'palevioletred',\n  'papayawhip', 'peachpuff', 'peru', 'pink', 'plum', 'powderblue',\n  'purple', 'red', 'rosybrown', 'royalblue', 'saddlebrown', 'salmon',\n  'sandybrown', 'seagreen', 'seashell', 'sienna', 'silver', 'skyblue',\n  'slateblue', 'slategray', 'snow', 'springgreen', 'steelblue', 'tan',\n  'teal', 'thistle', 'tomato', 'turquoise', 'violet', 'wheat', 'white',\n  'whitesmoke', 'yellow', 'yellowgreen'\n];\n",
    "var _ = require('underscore');\nvar DEFAULT_ERROR_MSG = '';\n\n/**\n *  Return error message when backend request fails\n *  It tries to get responseText > errors and error arrays, if not gets `statusText`.\n */\n\nmodule.exports = function (e) {\n  if (!e) { throw new Error('error is required'); }\n\n  try {\n    var responseText = e.responseText && e.responseText.trim() && JSON.parse(e.responseText);\n    var errorMessage = e.statusText || DEFAULT_ERROR_MSG;\n\n    if (responseText) {\n      var errors = _.compact(\n        _.map(['errors', 'error'], function (type) {\n          return responseText[type] && responseText[type].join(', ');\n        })\n      );\n      errorMessage = errors.join(', ');\n    }\n\n    return errorMessage;\n  } catch (err) {\n    return DEFAULT_ERROR_MSG;\n  }\n};\n",
    "var track = function (error) {\n  if (window.trackJs) {\n    window.trackJs.track(error);\n  }\n};\n\nmodule.exports = track;\n",
    "/**\n *  Fetch all query objects (querySchemaModel, queryGeometryModel, queryRowsCollection)\n *  if necessary\n */\n\nmodule.exports = function (params, callback) {\n  if (!params) throw new Error('all query objects are required');\n  if (!params.querySchemaModel) throw new Error('querySchemaModel is required');\n  if (!params.queryGeometryModel) throw new Error('queryGeometryModel is required');\n  if (!params.queryRowsCollection) throw new Error('queryRowsCollection is required');\n\n  var allFetched = function () {\n    return params.querySchemaModel.isFetched() &&\n           params.queryGeometryModel.isFetched() &&\n           params.queryRowsCollection.isFetched();\n  };\n\n  var checkQueryRowsCollectionFetch = function () {\n    if (params.queryRowsCollection.shouldFetch()) {\n      var opts = {};\n      if (callback) {\n        opts.success = callback;\n      }\n      params.queryRowsCollection.fetch(opts);\n    } else {\n      // we need to check if all are fetched because shouldFetch include the fetching state\n      allFetched() && callback && callback();\n    }\n  };\n\n  var rows = params.queryRowsCollection.size();\n\n  // we need to check if besides queryGeometryModel, there is any row, because the user could have deleted them\n  if (params.queryGeometryModel.shouldFetch() || (rows === 0 && params.queryRowsCollection.shouldFetch())) {\n    params.queryGeometryModel.fetch();\n  }\n\n  if (params.querySchemaModel.shouldFetch()) {\n    params.querySchemaModel.fetch({\n      success: checkQueryRowsCollectionFetch\n    });\n  } else {\n    checkQueryRowsCollectionFetch();\n  }\n};\n",
    "var _ = require('underscore');\nvar DEFAULT_VALUES = {\n  top: 0,\n  left: 0\n};\nvar MIN_GAP = 10;\nvar MIN_HEIGHT = 205;\nvar MIN_WIDTH = 244;\n\n/**\n * Would you like to know where to open a context menu?\n * Just provide:\n * @param {Object} options.parentView               Parent element view\n * @param {Number} options.posX                     Position X of the context menu\n * @param {Number} options.posY                     Position Y of the context menu\n * @param {Number} options.elementWidth (optional)  Context menu width\n * @param {Number} options.elementHeight (optional) Context menu height\n * @param {Number} options.offsetX (optional)       Context menu offsetX\n * @param {Number} options.offsetY (optional)       Context menu offsetY\n *\n * By default, it will try to positionate to the right (inside) and to\n * the top (below).\n */\n\nvar MagicPositioner = function (params) {\n  if (!params.parentView) throw new Error('parentView within params is required');\n  if (!_.isNumber(params.posX)) throw new Error('posX within params is required');\n  if (!_.isNumber(params.posY)) throw new Error('posY within params is required');\n\n  var $parentView = params.parentView;\n  var parentViewHeight = $parentView.outerHeight();\n  var parentViewWidth = $parentView.outerWidth();\n  var posX = params.posX;\n  var posY = params.posY;\n  var offsetX = params.offsetX || 0;\n  var offsetY = params.offsetY || 0;\n  var elementWidth = params.elementWidth || MIN_WIDTH;\n  var elementHeight = params.elementHeight || MIN_HEIGHT;\n  var cssProps = DEFAULT_VALUES;\n\n  if ((posX - elementWidth) > MIN_GAP) {\n    cssProps.left = 'auto';\n    cssProps.right = (parentViewWidth - posX + offsetX) + 'px';\n  } else if ((posX + elementWidth) > elementWidth) {\n    cssProps.right = 'auto';\n    cssProps.left = (posX + offsetX) + 'px';\n  }\n\n  if ((posY + elementHeight) < parentViewHeight) {\n    cssProps.bottom = 'auto';\n    cssProps.top = (posY + offsetY) + 'px';\n  } else if ((posY + elementHeight) > parentViewHeight) {\n    cssProps.top = 'auto';\n    cssProps.bottom = (parentViewHeight - posY + offsetY) + 'px';\n  }\n\n  return cssProps;\n};\n\nmodule.exports = MagicPositioner;\n",
    "var $ = require('jquery');\n\n/**\n * Check if Linux user used right/middle click at the time of the event\n *\n * @param ev {Event}\n * @returns {boolean}\n */\nfunction isLinuxMiddleOrRightClick (ev) {\n  return ev.which === 2 || ev.which === 3;\n}\n\n/**\n * Check if Mac user used CMD key at the time of the event Mac user used CMD key at the time of the event.\n *\n * @param ev {Event}\n * @returns {boolean}\n */\nfunction isMacCmdKeyPressed (ev) {\n  return ev.metaKey;\n}\n\nfunction isCtrlKeyPressed (ev) {\n  return ev.ctrlKey;\n}\n\n/**\n * Click handler for a cartodb.js view, to navigate event target's href URL through the view's router.navigate method.\n *\n * The default behavior is:\n * Unless cmd/ctrl keys are pressed it will cancel the default link behavior and instead navigate to the URL set in the\n * target's href attribute.\n *\n * Prerequisities:\n *  - view has a this.router instance.\n *\n * Example of how to use:\n *   - In a template:\n *     <a href=\"/some/uri\" id=\"#my-link\" ...\n *     <a href=\"/special/uri\" id=\"#my-special-link\" ...\n *\n *   - In the view file:\n *     var navigateThroughRouter = require('--/--/common/view_helpers/navigateThroughRouter');\n *     module.exports = new CoreView.extend({\n *       events: {\n *         'click a#my-link': navigateThroughRouter\n *         'click a#my-special-link': this._myCustomRoute\n *       }\n *\n *       _myCustomRoute: function(ev) {\n *         // Here you can do you custom logic before/after the routing, e.g.:\n *         console.log('before changing route');\n *         navigateThroughRouter.apply(this, arguments);\n *         console.log('after changing route');\n *       }\n *\n * @param ev {Event}\n */\nmodule.exports = function (ev) {\n  // We always kill the default behaviour of the event, since container around view might have other click behavior.\n  // In case of a cmd/ctrl click by an user.\n  this.killEvent(ev);\n  var url = $(ev.target).closest('a').attr('href');\n\n  if (!url) {\n    return false;\n  }\n\n  if (!isLinuxMiddleOrRightClick(ev) && !isMacCmdKeyPressed(ev)) {\n    var routerModel = (this.routerModel || this.options.routerModel);\n    if (!routerModel) {\n      throw new Error('routerModel is required');\n    }\n\n    routerModel.navigate(url, { trigger: true });\n  } else if (isCtrlKeyPressed(ev) || isMacCmdKeyPressed(ev)) {\n    window.open(url, '_blank');\n  }\n};\n",
    "var cdb = require('cartodb.js');\nvar carto = require('carto');\nvar torque = require('torque.js');\nvar _ = require('underscore');\n\nvar CartoParser = function (cartocss) {\n  this.parse_env = null;\n  this.ruleset = null;\n  if (cartocss) {\n    this.parse(cartocss);\n  }\n};\n\nCartoParser.prototype = {\n  // value due to torque\n  RESERVED_VARIABLES: ['mapnik-geometry-type', 'points_density', 'points_count', 'src', 'value', 'agg_value', 'agg_value_density'],\n\n  parse: function (cartocss) {\n    this.parse_env = {\n      validation_data: false,\n      frames: [],\n      errors: [],\n      error: function (obj) {\n        obj.line = carto.Parser().extractErrorLine(cartocss, obj.index);\n        this.errors.push(obj);\n      }\n    };\n\n    var self = this;\n    var ruleset = null;\n    var defs = null;\n\n    try {\n      // set default reference\n      carto.tree.Reference.setData(carto.default_reference.version.latest);\n      ruleset = (new carto.Parser(this.parse_env)).parse(cartocss);\n    } catch (e) {\n      // add the style.mss string to match the response from the server\n      this.parse_env.errors = this.parseError(['style\\.mss' + e.message]);\n      return;\n    }\n\n    if (ruleset) {\n      var existing = {};\n      var mapDef;\n      var symbolizers;\n      var i;\n      var j;\n      var r;\n\n      this.definitions = defs = ruleset.toList(this.parse_env);\n\n      for (i in defs) {\n        if (defs[i].elements.length > 0) {\n          if (defs[i].elements[0].value === 'Map') {\n            mapDef = defs.splice(i, 1)[0];\n          }\n        }\n      }\n\n      symbolizers = torque.cartocss_reference.version.latest.layer;\n\n      if (mapDef) {\n        mapDef.rules.forEach(function (r) {\n          var key = r.name;\n          var type;\n          var element;\n\n          if (!(key in symbolizers)) {\n            self.parse_env.error({\n              message: 'Rule ' + key + ' not allowed for Map.',\n              index: r.index\n            });\n          } else {\n            type = symbolizers[r.name].type;\n            element = r.value.value[0].value[0];\n            if (!self._checkValidType(element, type)) {\n              self.parse_env.error({\n                message: 'Expected type ' + type + '.',\n                index: r.index\n              });\n            }\n          }\n        });\n      }\n\n      defs = carto.inheritDefinitions(defs, this.parse_env);\n      defs = carto.sortStyles(defs, this.parse_env);\n\n      for (i in defs) {\n        for (j in defs[i]) {\n          r = defs[i][j];\n          if (r && r.toXML) {\n            r.toXML(this.parse_env, existing);\n          }\n        }\n      }\n\n      // toList uses parse_env.errors.message to put messages\n      if (this.parse_env.errors.message) {\n        _(this.parse_env.errors.message.split('\\n')).each(function (m) {\n          self.parse_env.errors.push(m);\n        });\n      }\n    }\n\n    this.ruleset = ruleset;\n    return this;\n  },\n\n  _checkValidType: function (e, type) {\n    if (['number', 'float'].indexOf(type) > -1) {\n      return typeof e.value === 'number';\n    } else if (type === 'string') {\n      return e.value !== 'undefined' && typeof e.value === 'string';\n    } else if (type.constructor === Array) {\n      return type.indexOf(e.value) > -1 || e.value === 'linear';\n    } else if (type === 'color') {\n      return this._checkValidColor(e);\n    }\n    return true;\n  },\n\n  _checkValidColor: function (e) {\n    var expectedArguments = {rgb: 3, hsl: 3, rgba: 4, hsla: 4};\n    return typeof e.rgb !== 'undefined' || expectedArguments[e.name] === e.args;\n  },\n\n  /**\n   * gets an array of parse errors from windshaft\n   * and returns an array of {line:1, error: 'string'] with user friendly\n   * strings. Parses errors in format:\n   *\n   *  'style.mss:7:2 Invalid code: asdasdasda'\n   */\n  parseError: function (errors) {\n    var parsedErrors = [];\n    var i;\n    var g;\n    var err;\n\n    for (i in errors) {\n      err = errors[i];\n      if (err && err.length > 0) {\n        g = err.match(/.*:(\\d+):(\\d+)\\s*(.*)/);\n        if (g) {\n          parsedErrors.push({\n            line: parseInt(g[1], 10),\n            message: g[3]\n          });\n        } else {\n          parsedErrors.push({\n            line: null,\n            message: err\n          });\n        }\n      }\n    }\n\n    // sort by line\n    parsedErrors.sort(function (a, b) { return a.line - b.line; });\n    parsedErrors = _.uniq(parsedErrors, true, function (a) { return a.line + a.message; });\n    return parsedErrors;\n  },\n\n  /**\n   * return the error list, empty if there were no errors\n   */\n  errors: function () {\n    return this.parse_env ? this.parse_env.errors : [];\n  },\n\n  _colorsFromRule: function (rule) {\n    function searchRecursiveByType (v, t) {\n      var res = [];\n      var i;\n      var r;\n      for (i in v) {\n        if (v[i] instanceof t) {\n          res.push(v[i]);\n        } else if (typeof v[i] === 'object') {\n          r = searchRecursiveByType(v[i], t);\n          if (r.length) {\n            res = res.concat(r);\n          }\n        }\n      }\n      return res;\n    }\n    return searchRecursiveByType(rule.ev(this.parse_env), carto.tree.Color);\n  },\n\n  _varsFromRule: function (rule) {\n    function searchRecursiveByType (v, t) {\n      var res = [];\n      var i;\n      var r;\n\n      for (i in v) {\n        if (v[i] instanceof t) {\n          res.push(v[i]);\n        } else if (typeof v[i] === 'object') {\n          r = searchRecursiveByType(v[i], t);\n          if (r.length) {\n            res = res.concat(r);\n          }\n        }\n      }\n      return res;\n    }\n    return searchRecursiveByType(rule, carto.tree.Field);\n  },\n\n  /**\n   * Extract information from the carto using the provided method.\n   * */\n  _extract: function (method, extractVariables) {\n    var self = this;\n    var columns = [];\n    var definitions;\n    var def;\n    var d;\n    var r;\n    var f;\n    var k;\n    var rule;\n    var columnList;\n    var filter;\n    var filter_key;\n\n    if (this.ruleset) {\n      definitions = this.ruleset.toList(this.parse_env);\n      for (d in definitions) {\n        def = definitions[d];\n\n        if (def.filters) {\n          // extract from rules\n          for (r in def.rules) {\n            rule = def.rules[r];\n            columnList = method(this, rule);\n            columns = columns.concat(columnList);\n          }\n\n          if (extractVariables) {\n            for (f in def.filters) {\n              filter = def.filters[f];\n              for (k in filter) {\n                filter_key = filter[k];\n                if (filter_key.key && filter_key.key.value) {\n                  columns.push(filter_key.key.value);\n                }\n              }\n            }\n          }\n        }\n      }\n\n      return _.reject(_.uniq(columns), function (v) {\n        return _.contains(self.RESERVED_VARIABLES, v);\n      });\n    }\n  },\n\n  /**\n   * return a list of colors used in cartocss\n   */\n  colorsUsed: function (opt) {\n    // extraction method\n    var method = function (self, rule) {\n      return _.map(self._colorsFromRule(rule), function (f) {\n        return f.rgb;\n      });\n    };\n\n    var colors = this._extract(method, false);\n\n    if (opt && opt.mode === 'hex') {\n      colors = _.map(colors, function (color) {\n        return cdb.Utils.rgbToHex(color[0], color[1], color[2]);\n      });\n    }\n\n    return colors;\n  },\n\n  /**\n   * return a list of variables used in cartocss\n   */\n  variablesUsed: function () {\n    // extraction method\n    var method = function (self, rule) {\n      return _.map(self._varsFromRule(rule), function (f) {\n        return f.value;\n      });\n    };\n\n    return this._extract(method, true);\n  },\n\n  /**\n   * returns the default layer\n   */\n  getDefaultRules: function () {\n    var rules = [];\n    var i;\n    var def;\n    var rulesMap = {};\n\n    for (i = 0; i < this.definitions.length; ++i) {\n      def = this.definitions[i];\n      // all zooms and default attachment so we don't get conditional variables\n      if (def.zoom === 8388607 && _.size(def.filters.filters) === 0 && def.attachment === '__default__') {\n        rules = rules.concat(def.rules);\n      }\n    }\n\n    for (i in rules) {\n      var rule = rules[i];\n      rulesMap[rule.name] = rule;\n    }\n    return rulesMap;\n  },\n\n  getRuleByName: function (definition, ruleName) {\n    if (!definition._rulesByName) {\n      var rulesMap = definition._rulesByName = {};\n      for (var r in definition.rules) {\n        var rule = definition.rules[r];\n        rulesMap[rule.name] = rule;\n      }\n    }\n    return definition._rulesByName[ruleName];\n  }\n};\n\nmodule.exports = CartoParser;\n",
    "// Get coordinates from a GeoJSON\n\nmodule.exports = function (geometry) {\n  try {\n    var geojson = JSON.parse(geometry);\n    return geojson.coordinates.join(', ');\n  } catch (e) {\n    return false;\n  }\n};\n",
    "var _ = require('underscore');\n\nmodule.exports = function checkAndBuildRequiredOpts (actualOpts, requiredOpts, context) {\n  if (requiredOpts === void 0) {\n    throw new Error('Opts are required');\n  }\n\n  _.each(requiredOpts, function (item) {\n    if (actualOpts[item] === void 0) throw new Error(item + ' is required');\n    context['_' + item] = actualOpts[item];\n  }, context);\n};\n",
    "/*  Check and perform a reset of the styles due to a change over a node definition model (if possible).\n *\n *  In order to use and test this function in any view, we have removed this code\n *  from user-actions Class.\n *\n *  forceStyleUpdate: it will reset the styles in any case, no matter the schema or the geometry.\n *  resetQueryReady:  set as false ready property for query-schema-model and query-geometry-model\n *                    in order to wait for a node change before checking if reset styles is necessary.\n *\n */\n\nmodule.exports = function (nodeDefModel, layerDefModel, forceStyleUpdate, resetQueryReady) {\n  if (!nodeDefModel) throw new Error('nodeDefModel is required');\n  if (!layerDefModel) throw new Error('layerDefModel is required');\n\n  var CHANGE_READY = 'change:ready';\n  var onQueryGeometryAndSchemaReady;\n  var styleModel = layerDefModel.styleModel;\n  var queryGeometryModel = nodeDefModel.queryGeometryModel;\n  var querySchemaModel = nodeDefModel.querySchemaModel;\n\n  onQueryGeometryAndSchemaReady = function () {\n    if (queryGeometryModel.get('ready') && querySchemaModel.get('ready')) {\n      queryGeometryModel.unbind(CHANGE_READY, onQueryGeometryAndSchemaReady);\n      querySchemaModel.unbind(CHANGE_READY, onQueryGeometryAndSchemaReady);\n    } else {\n      return; // wait until ready\n    }\n\n    var CHANGE_STATUS = 'change:status';\n    var saveDefaultStylesIfStillRelevant;\n\n    saveDefaultStylesIfStillRelevant = function () {\n      var unbindNodeChangeStatus = function () {\n        queryGeometryModel.unbind(CHANGE_STATUS, saveDefaultStylesIfStillRelevant);\n        querySchemaModel.unbind(CHANGE_STATUS, saveDefaultStylesIfStillRelevant);\n      };\n\n      var applyStylesAndSave = function () {\n        var simpleGeometryType = queryGeometryModel.get('simple_geom');\n        if (simpleGeometryType) {\n          styleModel.setDefaultPropertiesByType('simple', simpleGeometryType);\n        } else {\n          styleModel.setDefaultPropertiesByType('none'); // fallback if there is no known geometry\n        }\n        layerDefModel.save();\n      };\n\n      var styleTypeApplied = styleModel.get('type');\n\n      if (queryGeometryModel.isFetching() || querySchemaModel.isFetching()) { // Wait until fetched\n        return;\n      } else if (!queryGeometryModel.isFetching() && !queryGeometryModel.isFetched() &&\n        !querySchemaModel.isFetching() && !querySchemaModel.isFetched()) { // Node status has been resetted\n        unbindNodeChangeStatus();\n        return;\n      } else { // Fetched!\n        unbindNodeChangeStatus();\n      }\n\n      // If the geometry doesn't change and all columns used for style-def-model are still present + the styles are not custom\n      // we can reset the style form with the geometry provided\n      var haveDifferentSchema = querySchemaModel.hasDifferentSchemaThan(styleModel.getColumnsUsedForStyle());\n      if (\n          styleTypeApplied !== 'none' &&\n          !forceStyleUpdate && (\n            (!queryGeometryModel.hasChanged('simple_geom') && !haveDifferentSchema) ||\n            layerDefModel.get('cartocss_custom')\n          )\n        ) {\n        return;\n      }\n\n      if ( // Only apply changes if:\n        (\n          layerDefModel.collection.contains(layerDefModel) && // layer still exist\n          layerDefModel.get('source') === nodeDefModel.id // node is still the head of layer\n        ) || forceStyleUpdate // we force the style update\n      ) {\n        applyStylesAndSave();\n      }\n    };\n\n    saveDefaultStylesIfStillRelevant();\n\n    if (!queryGeometryModel.isFetched()) {\n      queryGeometryModel.bind(CHANGE_STATUS, saveDefaultStylesIfStillRelevant);\n    }\n\n    if (!querySchemaModel.isFetched()) {\n      querySchemaModel.bind(CHANGE_STATUS, saveDefaultStylesIfStillRelevant);\n    }\n  };\n\n  if (resetQueryReady) {\n    queryGeometryModel.set('ready', false);\n    querySchemaModel.set('ready', false);\n  }\n\n  queryGeometryModel.bind(CHANGE_READY, onQueryGeometryAndSchemaReady);\n  querySchemaModel.bind(CHANGE_READY, onQueryGeometryAndSchemaReady);\n  onQueryGeometryAndSchemaReady();\n};\n",
    "/**\n *  Checks properties from a SQL\n */\n\nvar TableNameUtils = require('./table-name-utils');\n\nmodule.exports = {\n  isSameQuery: function (originalQuery, customQuery) {\n    if (originalQuery == null || customQuery == null) { // eslint-disable-line\n      throw new Error('Needed parameters not provided');\n    }\n\n    var parseQuery = function (query) {\n      return query\n        .toLowerCase()\n        .replace(/\\\"/g, '') // Remove quoted things like \"pepe\".tableName\n        .replace(/;/g, '');\n    };\n\n    return parseQuery(originalQuery) === parseQuery(customQuery);\n  },\n\n  // return true if the sql query alters table schema in some way\n  altersSchema: function (sql) {\n    if (!sql) {\n      return false;\n    }\n\n    // Remove all line breaks in order to prevent\n    // search pattern problems\n    sql = this._removeLineBreaks(sql.trim());\n\n    return sql.search(/alter\\s+[\\w\\.\"]+\\s+/i) !== -1 ||\n      sql.search(/drop\\s+[\\w\\.\\\"]+/i) !== -1 ||\n      sql.search(/^vacuum\\s+[\\w\\.\\\"]+/i) !== -1 ||\n      sql.search(/^create\\s+[\\w\\.\\\"]+/i) !== -1 ||\n      sql.search(/^reindex\\s+[\\w\\.\\\"]+/i) !== -1 ||\n      sql.search(/^grant\\s+[\\w\\.\\\"]+/i) !== -1 ||\n      sql.search(/^revoke\\s+[\\w\\.\\\"]+/i) !== -1 ||\n      sql.search(/^cluster\\s+[\\w\\.\\\"]+/i) !== -1 ||\n      sql.search(/^comment\\s+on\\s+[\\w\\.\\\"]+/i) !== -1 ||\n      sql.search(/^explain\\s+[\\w\\.\\\"]+/i) !== -1;\n  },\n\n  // return true if the sql query alters table data\n  altersData: function (sql) {\n    if (!sql) {\n      return false;\n    }\n\n    // Remove all line breaks in order to prevent\n    // search pattern problems\n    sql = this._removeLineBreaks(sql.trim());\n\n    return this.altersSchema(sql) ||\n      sql.search(/^refresh\\s+materialized\\s+view\\s+[\\w\\.\\\"]+/i) !== -1 ||\n      sql.search(/^truncate\\s+[\\w\\.\\\"]+/i) !== -1 ||\n      sql.search(/insert\\s+into/i) !== -1 ||\n      sql.search(/update\\s+[\\w\\.\\-\"]+\\s+.*set/i) !== -1 ||\n      sql.search(/delete\\s+from/i) !== -1;\n  },\n\n  _removeLineBreaks: function (sql) {\n    return sql.replace(/\\r?\\n|\\r/g, ' ');\n  },\n\n  getDefaultSQL: function (tableName, userName, inOrganization) {\n    return this.getDefaultSQLFromTableName(TableNameUtils.getQualifiedTableName(tableName, userName, inOrganization));\n  },\n\n  getDefaultSQLFromTableName: function (tableName) {\n    return 'SELECT * FROM ' + tableName;\n  }\n};\n",
    "module.exports = function () {\n  var stylesWithoutAutostyles;\n\n  return function (layerDefModel) {\n    var isAutoStyleActive = !!layerDefModel.get('autoStyle');\n\n    if (!isAutoStyleActive) {\n      stylesWithoutAutostyles = {\n        previousCartoCSS: layerDefModel.get('cartocss'),\n        previousCartoCSSCustom: layerDefModel.attributes.cartocss_custom\n      };\n    }\n\n    return stylesWithoutAutostyles;\n  };\n};\n",
    "/**\n *  Functions to work with SQL table names\n */\n\nmodule.exports = {\n  getUnqualifiedName: function (tablename) {\n    if (!tablename) return null;\n    var tk = tablename.split('.');\n    if (tk.length === 2) {\n      return this._getUnquotedName(tk[1]);\n    }\n    return this._getUnquotedName(tablename);\n  },\n\n  getUsername: function (tablename) {\n    if (!tablename) return null;\n    var tk = tablename.split('.');\n    if (tk.length === 2) {\n      return this._getUnquotedName(tk[0]);\n    }\n    return '';\n  },\n\n  _getUnquotedName: function (tablename) {\n    return tablename && tablename.replace(/\"/g, '');\n  },\n\n  _quoteIfNeeded: function (name) {\n    var VALID_IDENTIFIER = /^[a-zA-Z_][a-zA-Z0-9_$]*$/;\n    name = this._getUnquotedName(name);\n    if (!VALID_IDENTIFIER.test(name)) {\n      name = '\"' + name + '\"';\n    }\n    return name;\n  },\n\n  getQualifiedTableName: function (tableName, userName, inOrganization) {\n    var schemaPrefix = (inOrganization && userName) ? this._quoteIfNeeded(userName) + '.' : '';\n    return schemaPrefix + this._quoteIfNeeded(this.getUnqualifiedName(tableName));\n  },\n\n  isSameTableName: function (firstTableName, secondTableName, ownerUsername) {\n    var firstParts = this._getTableNameParts(firstTableName, ownerUsername);\n    var secondParts = this._getTableNameParts(secondTableName, ownerUsername);\n\n    return firstParts[0] === secondParts[0] && firstParts[1] === secondParts[1];\n  },\n\n  _getTableNameParts: function (tableName, ownerUsername) {\n    var table = this.getUnqualifiedName(tableName);\n    var username = this.getUsername(tableName) || ownerUsername;\n\n    return [username, table];\n  }\n};\n",
    "var _ = require('underscore');\nvar cdb = require('cartodb.js');\n\n/*\n *  Util functions\n */\n\nmodule.exports = {\n  /*\n   *  Simple regex to check if string is an url/ftp\n   *  input ->  string with input text (example: 'https://carto.com')\n   *\n   *  return -> true\n   */\n  isURL: function (input) {\n    var urlregex = /^((http|https|ftp)\\:\\/\\/)/g;\n    if (input) {\n      return urlregex.test(input);\n    } else {\n      return false;\n    }\n  },\n\n  /*\n   *  check if string is blank (i.e.: str === \"\")\n   *  input ->  string with input text\n   *\n   * @return a boolean\n   */\n  isBlank: function (str) {\n    return (!str || /^\\s*$/.test(str));\n  },\n  /*\n   *  Transform bytes to a readable format, like MB, GB\n   *  input ->  34234244\n   *\n   *  return -> 3 MB\n   */\n  readablizeBytes: function (bytes, round) {\n    if (!bytes || isNaN(bytes)) {\n      return 0;\n    }\n    var s = ['bytes', 'kB', 'MB', 'GB', 'TB', 'PB'];\n    var e = Math.floor(Math.log(bytes) / Math.log(1024));\n    var value = (bytes / Math.pow(1024, Math.floor(e))).toFixed(2);\n\n    if (round) {\n      value = parseInt(value, 10);\n    }\n\n    return value + ' ' + s[e];\n  },\n\n  /**\n   *  Convert long numbers to\n   *  readizable numbers.\n   *\n   */\n  readizableNumber: function (num) {\n    if (num >= 1000000000) return (num / 1000000000).toFixed(1) + 'G';\n    if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';\n    if (num >= 1000) return (num / 1000).toFixed(1) + 'K';\n    return num;\n  },\n\n  /*\n   * formatNumber: adds thousands separators\n   * @return a string\n   *\n   */\n  formatNumber: function (x) {\n    if (!x) return '0';\n    var parts = x.toString().split('.');\n    parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',');\n    return parts.join('.');\n  },\n\n  /**\n   * Similar to _.result, but also allows passing arbitrary arguments to the property if it's function.\n   * This makes code more terse  when one just wants to use a value if it's available, no if-checks required.\n   *\n   * @example Expected output\n   *   model.set('something', 'yay');\n   *   cdb.Utils.result(model, 'get', 'something') // => 'yay'\n   *   cdb.Utils.result(model, 'nonexisting', 'else') // => undefined\n   *   cdb.Utils.result(undefinedVar, 'get') // => null\n   *\n   * @example Of usage\n   *  return cdb.Utils.result(model, 'get', 'mightNotExist') === 'OK'\n   *\n   * @param {*} maybeFn\n   * @return {*} Result from called maybeFn if a function, null otherwise\n   */\n  result: function (object, property) {\n    if (object == null) return null;\n    var value = object[property];\n    return _.isFunction(value) ? value.apply(object, Array.prototype.slice.call(arguments, 2)) : value;\n  },\n\n  /**\n   *  Get the extension of a string\n   *\n   */\n  getFileExtension: function (str) {\n    if (!str) return '';\n    return str.substr(str.lastIndexOf('.') + 1);\n  },\n\n  /**\n   *  Add leading zeros to numbers\n   *\n   */\n  pad: function (num, size) {\n    var s = num + '';\n    while (s.length < size) s = '0' + s;\n    return s;\n  },\n\n  formatDate: function (opts) {\n    if (!opts.time) throw new Error();\n    if (opts.month === undefined) throw new Error();\n    if (opts.year === undefined) throw new Error();\n    if (!opts.day) throw new Error();\n\n    // Month in Date format should be specified as an index\n    var month = parseInt(opts.month + 1, 10);\n    var padZero = function (digit) {\n      digit = String(digit);\n      if (digit < 10 && digit.length === 1) {\n        return '0' + digit;\n      }\n      return digit;\n    };\n\n    return '' +\n      opts.year + '-' +\n      padZero(month) + '-' +\n      padZero(opts.day) + 'T' +\n      opts.time + 'Z';\n      // Not adding any info about timezone\n  },\n\n  /*\n   * rgbToHex\n   *\n   */\n  rgbToHex: function (r, g, b) {\n    function componentToHex (c) {\n      var hex = c.toString(16);\n      return hex.length === 1 ? '0' + hex : hex;\n    }\n\n    return '#' + componentToHex(r) + componentToHex(g) + componentToHex(b);\n  },\n\n  /*\n   *  Returns true if the hex color passed as an input is valid\n   *  input -> hex (#FF00FF)\n   *  output -> true\n   *\n   * @return a boolean\n   */\n  isValidHex: function (hex) {\n    return !!hex.match(/(^#?[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i);\n  },\n\n  /*\n   *  Transforms an hex color into its RGB representation\n   *  input ->  hex (#FF00FF)\n   *  output ->  { r: 255, g: 0, b: 255 }\n   *\n   * @return a hash\n   */\n  hexToRGB: function (hex) {\n    if (!hex) {\n      hex = '#FFFFFF';\n    }\n\n    var shortRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n\n    hex = hex.replace(shortRegex, function (m, r, g, b) {\n      return r + r + g + g + b + b;\n    });\n\n    var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n\n    return result ? {\n      r: parseInt(result[1], 16),\n      g: parseInt(result[2], 16),\n      b: parseInt(result[3], 16)\n    } : null;\n  },\n  /*\n   *  Transforms an hex color an a opacity value to a rgba string\n   *  input ->  hex (#FF00FF) and opacity (0.4)\n   *  output -> 'rgba(255,0,255,0.4)'\n   *\n   * @return a string\n   */\n  hexToRGBA: function (hex, opacity) {\n    function roundToTwo (num) {\n      return +(Math.round(num + 'e+2') + 'e-2');\n    }\n\n    var rgb = this.hexToRGB(hex);\n    opacity = opacity != null ? roundToTwo(opacity) : 1;\n    if (rgb) {\n      return 'rgba(' + [rgb.r, rgb.g, rgb.b, opacity].join(', ') + ')';\n    } else {\n      return hex;\n    }\n  },\n\n  /*\n   *  Strip html tags from a value.\n   *  input ->  string with input text (example: '<a href=\"#whoknows\">Jamon</a> </br> <p>Vamos</p>')\n   *  allowed -> allowed html tags in the result (example: '<a>')\n   *\n   *  return -> '<a href=\"#whoknows\">Jamon</a> Vamos'\n   */\n  stripHTML: function (input, allowed) {\n    allowed = (((allowed || '') + '').toLowerCase().match(/<[a-z][a-z0-9]*>/g) || []).join('');\n    var tags = /<\\/?([a-z][a-z0-9]*)\\b[^>]*>/gi;\n    if (!input || (typeof input !== 'string')) return '';\n    return input.replace(tags, function ($0, $1) {\n      return allowed.indexOf('<' + $1.toLowerCase() + '>') > -1 ? $0 : '';\n    });\n  },\n\n  /**\n   *  Remove all non-common characters like spaces, quotes, accents, etc. and\n   *  joins strings with underscore symbols\n   *\n   */\n  sanitizeString: function (str) {\n    return str.replace(/[^a-z0-9\\s]/gi, '').replace(/[_\\s]/g, '_');\n  },\n\n  /**\n   *  Returns true is value is a valid number. Based on jQuery isNumeric\n   */\n  isNumeric: function (value) {\n    return !isNaN(parseFloat(value)) && isFinite(value);\n  },\n\n  /**\n   * Formats a number that to include up to 2 decimal positions if less than 10\n   * and up to 1 if greater than 10.\n   */\n  formatDecimalPositions: function (value) {\n    // we are using here the unary operator because parseInt fails to handle exponential number\n    var converted = +value;\n    var p = 0;\n    var abs_v;\n\n    if (isNaN(converted) || converted === 0) {\n      return value;\n    }\n\n    abs_v = Math.abs(converted);\n\n    if (abs_v > 10) {\n      p = 1;\n    } else if (abs_v > 0.01) {\n      p = Math.min(Math.ceil(Math.abs(Math.log(abs_v) / Math.log(10))) + 2, 2);\n    }\n\n    value = value.toFixed(p);\n    var m = value.match(/(\\.0+)$/);\n    if (m) {\n      value = value.replace(m[0], '');\n    }\n\n    return value;\n  },\n\n  /**\n   *  Remove new lines from string\n   *\n   */\n  removeNewLines: function (str) {\n    return str.replace(/(\\r\\n|\\n|\\r)/gm, '');\n  },\n\n  /**\n   * Returns true if the string ends with provided suffix\n   */\n  endsWith: function (str, suffix) {\n    return str.indexOf(suffix, str.length - suffix.length) !== -1;\n  },\n\n  cloneObject: function (obj) {\n    if (!obj) {\n      return obj;\n    }\n    return JSON.parse(JSON.stringify(obj));\n  },\n\n  /**\n   *  Capitalize first letter of string\n   *\n   */\n  capitalize: function (str) {\n    if (!str) {\n      return str;\n    }\n    return str.charAt(0).toUpperCase() + str.slice(1);\n  },\n\n  sanitizeHtml: function (text) {\n    return cdb.core.sanitize.sanitize(text || '');\n  }\n};\n",
    "var Backbone = require('backbone');\n\nvar VIEWING_MODE = 'viewing';\nvar DRAWING_FEATURE_MODE = 'drawing';\nvar EDITING_FEATURE_MODE = 'editing';\n\nvar MapMode = Backbone.Model.extend({\n  defaults: {\n    mode: VIEWING_MODE\n  },\n\n  enterViewingMode: function () {\n    delete this._featureDefinition;\n    this.set('mode', VIEWING_MODE);\n  },\n\n  enterDrawingFeatureMode: function (feature) {\n    this._featureDefinition = feature;\n    this.set('mode', DRAWING_FEATURE_MODE);\n  },\n\n  enterEditingFeatureMode: function (feature) {\n    this._featureDefinition = feature;\n    this.set('mode', EDITING_FEATURE_MODE);\n  },\n\n  getFeatureDefinition: function () {\n    return this._featureDefinition;\n  },\n\n  isViewingMode: function () {\n    return this._isMode(VIEWING_MODE);\n  },\n\n  isDrawingFeatureMode: function () {\n    return this._isMode(DRAWING_FEATURE_MODE);\n  },\n\n  isEditingFeatureMode: function () {\n    return this._isMode(EDITING_FEATURE_MODE);\n  },\n\n  _isMode: function (mode) {\n    return this.get('mode') === mode;\n  }\n});\n\nmodule.exports = MapMode;\n",
    "module.exports = \"<div class=\\\"CDB-infowindow CDB-infowindow--light js-infowindow\\\">\\n  <div class=\\\"CDB-infowindow-close js-close\\\"></div>\\n  <div class=\\\"CDB-infowindow-container\\\">\\n    <div class=\\\"CDB-infowindow-header CDB-infowindow-headerBg CDB-infowindow-headerBg--light js-header\\\" style=\\\"background: #35AAE5;\\\">\\n      {{#loading}}{{/loading}}\\n      <ul class=\\\"CDB-infowindow-list\\\">\\n        {{#content.fields}}\\n          {{^index}}\\n            <li class=\\\"CDB-infowindow-listItem\\\">\\n              {{#title}}<h5 class=\\\"CDB-infowindow-subtitle\\\">{{title}}</h5>{{/title}}\\n              {{#value}}<h4 class=\\\"CDB-infowindow-title {{#type}}{{ type }}{{/type}}\\\">{{{ value }}}</h4>{{/value}}\\n            </li>\\n            {{^value}}{{/value}}\\n          {{/index}}\\n        {{/content.fields}}\\n      </ul>\\n    </div>\\n    <div class=\\\"CDB-infowindow-inner js-inner\\\">\\n      {{#loading}}\\n        <div class=\\\"CDB-Loader js-loader is-visible\\\"></div>\\n      {{/loading}}\\n      <ul class=\\\"CDB-infowindow-list js-content\\\">\\n        {{#content.fields}}\\n          {{#index}}\\n            <li class=\\\"CDB-infowindow-listItem\\\">\\n              {{#title}}\\n                <h5 class=\\\"CDB-infowindow-subtitle\\\">{{title}}</h5>\\n              {{/title}}\\n              {{#value}}\\n                <h4 class=\\\"CDB-infowindow-title\\\">{{{ value }}}</h4>\\n              {{/value}}\\n              {{^value}}\\n                <h4 class=\\\"CDB-infowindow-title\\\">NULL</h4>\\n              {{/value}}\\n            </li>\\n          {{/index}}\\n        {{/content.fields}}\\n      </ul>\\n    </div>\\n    <div class=\\\"CDB-hook\\\">\\n      <div class=\\\"CDB-hook-inner\\\"></div>\\n    </div>\\n  </div>\\n</div>\\n\";\n",
    "module.exports = \"<div class=\\\"CDB-infowindow CDB-infowindow--dark js-infowindow\\\" style=\\\"background:#2E3C43\\\">\\n  <div class=\\\"CDB-infowindow-close js-close\\\"></div>\\n  <div class=\\\"CDB-infowindow-container\\\">\\n    <div class=\\\"CDB-infowindow-bg\\\">\\n      <div class=\\\"CDB-infowindow-inner\\\">\\n        {{#loading}}\\n          <div class=\\\"CDB-Loader js-loader is-visible\\\"></div>\\n        {{/loading}}\\n        <ul class=\\\"CDB-infowindow-list js-content\\\">\\n          {{#content.fields}}\\n          <li class=\\\"CDB-infowindow-listItem\\\">\\n            {{#title}}<h5 class=\\\"CDB-infowindow-subtitle\\\">{{title}}</h5>{{/title}}\\n            {{#value}}<h4 class=\\\"CDB-infowindow-title\\\">{{{ value }}}</h4>{{/value}}\\n            {{^value}}<h4 class=\\\"CDB-infowindow-title\\\">null</h4>{{/value}}\\n          </li>\\n          {{/content.fields}}\\n        </ul>\\n      </div>\\n    </div>\\n    <div class=\\\"CDB-hook\\\">\\n      <div class=\\\"CDB-hook-inner\\\"></div>\\n    </div>\\n  </div>\\n</div>\\n\";\n",
    "module.exports = \"<div class=\\\"CDB-infowindow CDB-infowindow--light js-infowindow\\\" data-cover=\\\"true\\\">\\n  <div class=\\\"CDB-infowindow-close js-close\\\"></div>\\n  <div class=\\\"CDB-infowindow-container\\\">\\n    <div class=\\\"CDB-infowindow-header CDB-infowindow-headerMedia js-header js-cover\\\">\\n      {{#loading}}<div class=\\\"CDB-Loader js-loader\\\"></div>{{/loading}}\\n      <div class=\\\"CDB-infowindow-mediaTitle\\\">\\n        {{#content.fields.1}}\\n          {{#value}}\\n            <h4 class=\\\"CDB-infowindow-title\\\">\\n              <span>{{{ value }}}</span>\\n            </h4>\\n          {{/value}}\\n        {{/content.fields.1}}\\n      </div>\\n    </div>\\n    <div class=\\\"CDB-infowindow-inner js-inner\\\">\\n      {{#loading}}<div class=\\\"CDB-Loader js-loader\\\"></div>{{/loading}}\\n      <div class=\\\"CDB-infowindow-list js-content\\\">\\n        {{#content.fields}}\\n          {{#index}}\\n            <div class=\\\"CDB-infowindow-listItem CDB-infowindow-listItem--order{{index}}\\\">\\n              {{#title}}<h5 class=\\\"CDB-infowindow-subtitle\\\">{{title}}</h5>{{/title}}\\n              {{#value}}<h4 class=\\\"CDB-infowindow-title\\\">{{{ value }}}</h4>{{/value}}\\n              {{^value}}<h4 class=\\\"CDB-infowindow-title\\\">null</h4>{{/value}}\\n            </div>\\n          {{/index}}\\n        {{/content.fields}}\\n      </div>\\n    </div>\\n    <div class=\\\"CDB-hook\\\">\\n      <div class=\\\"CDB-hook-inner\\\"></div>\\n    </div>\\n  </div>\\n</div>\\n\";\n",
    "module.exports = \"<div class=\\\"CDB-infowindow CDB-infowindow--light js-infowindow\\\">\\n  <div class=\\\"CDB-infowindow-close js-close\\\"></div>\\n  <div class=\\\"CDB-infowindow-container\\\">\\n    <div class=\\\"CDB-infowindow-bg\\\">\\n      <div class=\\\"CDB-infowindow-inner\\\">\\n        {{#loading}}\\n          <div class=\\\"CDB-Loader js-loader is-visible\\\"></div>\\n        {{/loading}}\\n        <ul class=\\\"CDB-infowindow-list js-content\\\">\\n          {{#content.fields}}\\n          <li class=\\\"CDB-infowindow-listItem\\\">\\n            {{#title}}<h5 class=\\\"CDB-infowindow-subtitle\\\">{{title}}</h5>{{/title}}\\n            {{#value}}<h4 class=\\\"CDB-infowindow-title\\\">{{{ value }}}</h4>{{/value}}\\n            {{^value}}<h4 class=\\\"CDB-infowindow-title\\\">null</h4>{{/value}}\\n          </li>\\n          {{/content.fields}}\\n        </ul>\\n      </div>\\n    </div>\\n    <div class=\\\"CDB-hook\\\">\\n      <div class=\\\"CDB-hook-inner\\\"></div>\\n    </div>\\n  </div>\\n</div>\\n\";\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"CDB-infowindow Infowindow-none js-infowindow\">\\n  <div class=\"CDB-infowindow-close js-close\"></div>\\n  <div class=\"CDB-infowindow-container\">\\n    <div class=\"CDB-infowindow-bg\">\\n      <div class=\"CDB-infowindow-inner\">\\n        <ul class=\"CDB-infowindow-list\">\\n          <li class=\"CDB-infowindow-listItem\">\\n            <h5 class=\"CDB-infowindow-subtitle\">'+\n((__t=( subtitle ))==null?'':_.escape(__t))+\n'</h5>\\n            <h4 class=\"CDB-infowindow-title\">'+\n((__t=( title ))==null?'':_.escape(__t))+\n'</h4>\\n          </li>\\n        </ul>\\n      </div>\\n    </div>\\n    <div class=\"CDB-hook\">\\n      <div class=\"CDB-hook-inner\"></div>\\n    </div>\\n  </div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "module.exports = \"<div class=\\\"CDB-infowindow CDB-infowindow--light js-infowindow\\\">\\n  <div class=\\\"CDB-infowindow-close js-close\\\"></div>\\n  <div class=\\\"CDB-infowindow-container\\\">\\n    <div class=\\\"CDB-infowindow-header CDB-infowindow-headerBg CDB-infowindow-headerBg--light js-header\\\" style=\\\"background: #35AAE5;\\\">\\n      {{#loading}}{{/loading}}\\n      <ul class=\\\"CDB-infowindow-list\\\">\\n        {{#content.fields}}\\n          {{^position}}\\n        <li class=\\\"CDB-infowindow-listItem\\\">\\n          {{#title}}\\n            {{#alternative_name}}\\n          <h5 class=\\\"CDB-infowindow-subtitle\\\">{{{alternative_name}}}</h5>\\n            {{/alternative_name}}\\n            {{^alternative_name}}\\n          <h5 class=\\\"CDB-infowindow-subtitle\\\">{{{name}}}</h5>\\n            {{/alternative_name}}\\n          {{/title}}\\n          {{#name}}\\n          <h4 class=\\\"CDB-infowindow-title {{#type}}{{=<% %>=}}{{<%={{ }}=%>{{{ type }}}{{=<% %>=}}}}<%={{ }}=%>{{/type}}\\\">\\n            {{=<% %>=}}{{<%={{ }}=%>{{{ name }}}{{=<% %>=}}}}<%={{ }}=%>\\n          </h4>\\n          {{/name}}\\n        </li>\\n          {{/position}}\\n        {{/content.fields}}\\n      </ul>\\n    </div>\\n    <div class=\\\"CDB-infowindow-inner js-inner\\\">\\n      {{#loading}}\\n        <div class=\\\"CDB-Loader js-loader is-visible\\\"></div>\\n      {{/loading}}\\n      <ul class=\\\"CDB-infowindow-list js-content\\\">\\n        {{#content.fields}}\\n          {{#position}}\\n        <li class=\\\"CDB-infowindow-listItem\\\">\\n          {{#title}}\\n            {{#alternative_name}}\\n          <h5 class=\\\"CDB-infowindow-subtitle\\\">{{{alternative_name}}}</h5>\\n            {{/alternative_name}}\\n            {{^alternative_name}}\\n          <h5 class=\\\"CDB-infowindow-subtitle\\\">{{{name}}}</h5>\\n            {{/alternative_name}}\\n          {{/title}}\\n          <h4 class=\\\"CDB-infowindow-title\\\">{{=<% %>=}}{{<%={{ }}=%>{{{ name }}}{{=<% %>=}}}}<%={{ }}=%></h4>\\n        </li>\\n          {{/position}}\\n        {{/content.fields}}\\n      </ul>\\n    </div>\\n    <div class=\\\"CDB-hook\\\">\\n      <div class=\\\"CDB-hook-inner\\\"></div>\\n    </div>\\n  </div>\\n</div>\\n\";\n",
    "module.exports = \"<div class=\\\"CDB-infowindow CDB-infowindow--dark js-infowindow\\\" style=\\\"background:#2E3C43\\\">\\n  <div class=\\\"CDB-infowindow-close js-close\\\"></div>\\n  <div class=\\\"CDB-infowindow-container\\\">\\n    <div class=\\\"CDB-infowindow-bg\\\">\\n      <div class=\\\"CDB-infowindow-inner\\\">\\n        {{#loading}}\\n          <div class=\\\"CDB-Loader js-loader is-visible\\\"></div>\\n        {{/loading}}\\n        <ul class=\\\"CDB-infowindow-list js-content\\\">\\n          {{#content.fields}}\\n          <li class=\\\"CDB-infowindow-listItem\\\">\\n            {{#title}}\\n              {{#alternative_name}}\\n              <h5 class=\\\"CDB-infowindow-subtitle\\\">{{alternative_name}}</h5>\\n              {{/alternative_name}}\\n              {{^alternative_name}}\\n              <h5 class=\\\"CDB-infowindow-subtitle\\\">{{name}}</h5>\\n              {{/alternative_name}}\\n            {{/title}}\\n            <h4 class=\\\"CDB-infowindow-title\\\">{{=<% %>=}}{{<%={{ }}=%>{{{ name }}}{{=<% %>=}}}}<%={{ }}=%></h4>\\n          </li>\\n          {{/content.fields}}\\n        </ul>\\n      </div>\\n    </div>\\n    <div class=\\\"CDB-hook\\\">\\n      <div class=\\\"CDB-hook-inner\\\"></div>\\n    </div>\\n  </div>\\n</div>\\n\";\n",
    "module.exports = \"<div class=\\\"CDB-infowindow CDB-infowindow--light js-infowindow\\\" data-cover=\\\"true\\\">\\n  <div class=\\\"CDB-infowindow-close js-close\\\"></div>\\n  <div class=\\\"CDB-infowindow-container\\\">\\n    <div class=\\\"CDB-infowindow-header CDB-infowindow-headerMedia js-header js-cover\\\">\\n      {{#loading}}<div class=\\\"CDB-Loader js-loader\\\"></div>{{/loading}}\\n      <div class=\\\"CDB-infowindow-mediaTitle\\\">\\n        {{#content.fields.1}}\\n        <h4 class=\\\"CDB-infowindow-title\\\">\\n          <span>{{=<% %>=}}{{<%={{ }}=%>{{{ name }}}{{=<% %>=}}}}<%={{ }}=%></span>\\n        </h4>\\n        {{/content.fields.1}}\\n      </div>\\n    </div>\\n    <div class=\\\"CDB-infowindow-inner js-inner\\\">\\n      {{#loading}}<div class=\\\"CDB-Loader js-loader\\\"></div>{{/loading}}\\n      <div class=\\\"CDB-infowindow-list js-content\\\">\\n        {{#content.fields}}\\n          {{#position}}\\n        <div class=\\\"CDB-infowindow-listItem CDB-infowindow-listItem--order{{position}}\\\">\\n            {{#title}}\\n              {{#alternative_name}}\\n          <h5 class=\\\"CDB-infowindow-subtitle\\\">{{{alternative_name}}}</h5>\\n              {{/alternative_name}}\\n              {{^alternative_name}}\\n          <h5 class=\\\"CDB-infowindow-subtitle\\\">{{{name}}}</h5>\\n              {{/alternative_name}}\\n            {{/title}}\\n          <h4 class=\\\"CDB-infowindow-title\\\">{{=<% %>=}}{{<%={{ }}=%>{{{ name }}}{{=<% %>=}}}}<%={{ }}=%></h4>\\n        </div>\\n          {{/position}}\\n        {{/content.fields}}\\n      </div>\\n    </div>\\n    <div class=\\\"CDB-hook\\\">\\n      <div class=\\\"CDB-hook-inner\\\"></div>\\n    </div>\\n  </div>\\n</div>\\n\";\n",
    "module.exports = \"<div class=\\\"CDB-infowindow CDB-infowindow--light js-infowindow\\\">\\n  <div class=\\\"CDB-infowindow-close js-close\\\"></div>\\n  <div class=\\\"CDB-infowindow-container\\\">\\n    <div class=\\\"CDB-infowindow-bg\\\">\\n      <div class=\\\"CDB-infowindow-inner\\\">\\n        {{#loading}}\\n          <div class=\\\"CDB-Loader js-loader is-visible\\\"></div>\\n        {{/loading}}\\n        <ul class=\\\"CDB-infowindow-list js-content\\\">\\n          {{#content.fields}}\\n          <li class=\\\"CDB-infowindow-listItem\\\">\\n            {{#title}}\\n              {{#alternative_name}}\\n              <h5 class=\\\"CDB-infowindow-subtitle\\\">{{alternative_name}}</h5>\\n              {{/alternative_name}}\\n              {{^alternative_name}}\\n              <h5 class=\\\"CDB-infowindow-subtitle\\\">{{name}}</h5>\\n              {{/alternative_name}}\\n            {{/title}}\\n            <h4 class=\\\"CDB-infowindow-title\\\">{{=<% %>=}}{{<%={{ }}=%>{{{ name }}}{{=<% %>=}}}}<%={{ }}=%></h4>\\n          </li>\\n          {{/content.fields}}\\n        </ul>\\n      </div>\\n    </div>\\n    <div class=\\\"CDB-hook\\\">\\n      <div class=\\\"CDB-hook-inner\\\"></div>\\n    </div>\\n  </div>\\n</div>\\n\";\n",
    "module.exports = \"<div class=\\\"CDB-Tooltip CDB-Tooltip--isDark\\\">\\n  <ul class=\\\"CDB-Tooltip-list\\\">\\n    {{#fields}}\\n      <li class=\\\"CDB-Tooltip-listItem\\\">\\n        {{#title}}\\n          <h3 class=\\\"CDB-Tooltip-listTitle\\\">{{{ title }}}</h3>\\n        {{/title}}\\n        <h4 class=\\\"CDB-Tooltip-listText\\\">{{{ value }}}</h4>\\n      </li>\\n    {{/fields}}\\n  </ul>\\n</div>\\n\";\n",
    "module.exports = \"<div class=\\\"CDB-Tooltip CDB-Tooltip--isLight\\\">\\n  <ul class=\\\"CDB-Tooltip-list\\\">\\n    {{#fields}}\\n      <li class=\\\"CDB-Tooltip-listItem\\\">\\n        {{#title}}\\n          <h3 class=\\\"CDB-Tooltip-listTitle\\\">{{{ title }}}</h3>\\n        {{/title}}\\n        <h4 class=\\\"CDB-Tooltip-listText\\\">{{{ value }}}</h4>\\n      </li>\\n    {{/fields}}\\n  </ul>\\n</div>\\n\";\n",
    "module.exports = \"<div class=\\\"CDB-Tooltip CDB-Tooltip--isDark\\\">\\n  <ul class=\\\"CDB-Tooltip-list\\\">\\n    {{#content.fields}}\\n      <li class=\\\"CDB-Tooltip-listItem\\\">\\n        {{#title}}\\n          <h3 class=\\\"CDB-Tooltip-listTitle\\\">{{{ name }}}</h3>\\n        {{/title}}\\n        <h4 class=\\\"CDB-Tooltip-listText\\\">{{=<% %>=}}{{<%={{ }}=%>{{{ name }}}{{=<% %>=}}}}<%={{ }}=%></h4>\\n      </li>\\n    {{/content.fields}}\\n  </ul>\\n</div>\\n\";\n",
    "module.exports = \"<div class=\\\"CDB-Tooltip CDB-Tooltip--isLight\\\">\\n  <ul class=\\\"CDB-Tooltip-list\\\">\\n    {{#content.fields}}\\n      <li class=\\\"CDB-Tooltip-listItem\\\">\\n        {{#title}}\\n          <h3 class=\\\"CDB-Tooltip-listTitle\\\">{{{ name }}}</h3>\\n        {{/title}}\\n        <h4 class=\\\"CDB-Tooltip-listText\\\">{{=<% %>=}}{{<%={{ }}=%>{{{ name }}}{{=<% %>=}}}}<%={{ }}=%></h4>\\n      </li>\\n    {{/content.fields}}\\n  </ul>\\n</div>\\n\";\n",
    "/*\n *  Track geometry changes that happens in any Node definition model\n */\n\nmodule.exports = {\n  track: function (params) {\n    if (!params) throw new Error('several parameters required');\n    if (!params.layerDefinitionsCollection) throw new Error('layerDefinitionsCollection is required');\n    if (!params.analysisDefinitionNodesCollection) throw new Error('analysisDefinitionNodesCollection is required');\n    if (!params.analysisDefinitionsCollection) throw new Error('analysisDefinitionsCollection is required');\n\n    this._layerDefinitionsCollection = params.layerDefinitionsCollection;\n    this._analysisDefinitionsCollection = params.analysisDefinitionsCollection;\n\n    params.analysisDefinitionNodesCollection.bind('change:simple_geom', this._onNodeGeometryChange, this);\n  },\n\n  _onNodeGeometryChange: function (nodeDefModel) {\n    if (nodeDefModel.get('table_name')) { // If it is a source node, no save\n      return;\n    }\n    var layerDefModel = this._layerDefinitionsCollection.findWhere({ source: nodeDefModel.get('id') });\n    if (layerDefModel) {\n      this._analysisDefinitionsCollection.saveAnalysisForLayer(layerDefModel);\n    }\n  }\n};\n",
    "var _ = require('underscore');\nvar Notifier = require('./components/notifier/notifier');\n\nvar NOTIFICATION_ERROR_TEMPLATE = _.template(\"<span class='CDB-Text u-errorTextColor'><%- title %></span>\");\nvar NOTIFICATION_PREFIX = 'sql-notifications';\n\nvar SQLNotifications = {\n  track: function (view) {\n    // In order to not bloat the notification center we will create\n    // only one notification, and update it along the way\n    this._notificationId = NOTIFICATION_PREFIX;\n  },\n\n  removeNotification: function () {\n    Notifier.removeNotification(this._notificationId);\n  },\n\n  showNotification: function (attrs) {\n    this._addOrUpdateNotification(this._notificationId, attrs);\n  },\n\n  showErrorNotification: function (errors) {\n    var notificationAttrs = {\n      status: 'error',\n      info: _t('notifications.sql.error.body', {\n        body: NOTIFICATION_ERROR_TEMPLATE({\n          title: _t('notifications.sql.error.title')\n        }),\n        error: this._transformErrors(errors)\n      }),\n      closable: false\n    };\n\n    this._addOrUpdateNotification(this._notificationId, notificationAttrs);\n  },\n\n  _transformErrors: function (errors) {\n    return _.map(errors, function (err) {\n      return err.message;\n    }, this).join('. ');\n  },\n\n  _addOrUpdateNotification: function (notificationId, notificationAttrs) {\n    var notification = this._getNotification(notificationId);\n    if (notification) {\n      notification.set(notificationAttrs);\n    } else {\n      this._addNotification(notificationId, notificationAttrs);\n    }\n  },\n\n  _addNotification: function (notificationId, notificationAttrs) {\n    notificationAttrs = _.extend({\n      id: notificationId\n    }, notificationAttrs);\n    Notifier.addNotification(notificationAttrs);\n  },\n\n  _getNotification: function (notificationId) {\n    return Notifier.getNotification(notificationId);\n  }\n};\n\nmodule.exports = SQLNotifications;\n",
    "var _ = require('underscore');\n\nvar SOURCE_ID_REGEX = /^([a-z]+)(\\d*)$/; // matches a string with one or more letters + numbers, e.g. 'b2'\n\nvar newId = function (id, seqChange) {\n  if (!id || !id.match) throw new Error('invalid id');\n\n  var matches = id.match(SOURCE_ID_REGEX);\n  matches[2] = matches[2] || -1;\n\n  if (matches && matches.length === 3) {\n    // letter + next number\n    var letter = matches[1];\n    var seq = parseInt(matches[2], 10) + seqChange;\n    return letter + Math.max(seq, 0);\n  } else {\n    throw new Error('invalid id');\n  }\n};\n\n/**\n * Encapsulates logic related to the nodes' IDs.\n */\nmodule.exports = {\n\n  /**\n   * Get next id in sequence of given source id.\n   * @param {String} id, e.g. 'c2'\n   * @return {String} e.g. 'c3'\n   */\n  next: function (id) {\n    return newId(id, 1);\n  },\n\n  prev: function (id) {\n    return newId(id, -1);\n  },\n\n  /**\n   * Get the letter representation.\n   * @param {String, Object} sourceId or backbone model that have id. e.g. 'c2'\n   * @return {String} e.g. 'c' or an empty string if there is no letter in the given id\n   */\n  letter: function (sourceId) {\n    if (!sourceId || !_.isString(sourceId)) return '';\n    var match = sourceId.match(/^([a-z]+)/);\n    return _.isArray(match) && match[0] || '';\n  },\n\n  /**\n   * Get the sequence representation.\n   * @param {String, Object} sourceId or backbone model that have id. e.g. 'c2'\n   * @return {Number} e.g. 2 or undefined if there is no sequence\n   */\n  sequence: function (sourceId) {\n    if (!sourceId || !_.isString(sourceId)) return;\n    var match = sourceId.match(/(\\d+$)/);\n    return _.isArray(match) && match[0] || undefined;\n  },\n\n  changeLetter: function (id, newLetter) {\n    var seq = id.match(/(\\d+)$/)[0];\n    return newLetter + seq;\n  }\n\n};\n",
    "var _ = require('underscore');\n\n/**\n * Value object to calcualte distances\n */\nmodule.exports = {\n  OPTIONS: [\n    {\n      distance: 'meters',\n      metersPerDistance: 1\n    }, {\n      distance: 'kilometers',\n      metersPerDistance: 1000\n    }, {\n      distance: 'miles',\n      metersPerDistance: 1609.34\n    }\n  ],\n\n  /**\n   * @param {Number} val - e.g. 3\n   * @param {String} distance - e.g. 'kilometers'\n   * @param {Float} e.g. 3000\n   */\n  toMeters: function (val, distance) {\n    val = parseFloat(val);\n    if (isNaN(val)) throw new Error('val (1st arg) is required, expected a parseable number or float');\n\n    var option = _.find(this.OPTIONS, function (d) {\n      return d.distance === distance;\n    });\n    if (!option) throw new Error(distance + ' (2nd arg) is not a valid distance value, expects one of ' + _.pluck(this.OPTIONS, 'distance').join(', '));\n\n    return val * option.metersPerDistance;\n  },\n\n  toDistance: function (meters, distance) {\n    meters = parseFloat(meters);\n    if (isNaN(meters)) throw new Error('meters (1st arg) is required');\n\n    var option = _.find(this.OPTIONS, function (d) {\n      return d.distance === distance;\n    });\n    if (!option) throw new Error(distance + ' (2nd arg) is not a valid distance value, expects one of ' + _.pluck(this.OPTIONS, 'distance').join(', '));\n\n    return meters / option.metersPerDistance;\n  }\n};\n",
    "var _ = require('underscore');\nvar Notifier = require('./components/notifier/notifier');\n\nvar NOTIFICATION_ID = 'visNotification';\nvar NOTIFICATION_TEMPLATE = _.template(\"<span class='CDB-Text is-semibold u-errorTextColor'><%= title %></span>&nbsp;<%= body %>\");\nvar ERROR_NOTIFICATION_TEMPLATE = _.template('<%- message %> <%- body %>');\n\nvar VisNotifications = {\n\n  track: function (vis) {\n    vis.on('change:error', this._toggleVisErrorNotification, this);\n    this._toggleVisErrorNotification(vis);\n  },\n\n  _toggleVisErrorNotification: function (vis) {\n    var error = vis.get('error');\n    if (error) {\n      this._showVisErrorNotification(error.message);\n    } else {\n      this._hideVisErrorNotification();\n    }\n  },\n\n  _showVisErrorNotification: function (message) {\n    Notifier.addNotification(this._getNotificationAttrs(message));\n  },\n\n  _hideVisErrorNotification: function () {\n    if (Notifier.getNotification(NOTIFICATION_ID)) {\n      Notifier.removeNotification(NOTIFICATION_ID);\n    }\n  },\n\n  _getNotificationAttrs: function (message) {\n    var body = _t('notifications.vis.failed.body');\n    if (message) {\n      body = ERROR_NOTIFICATION_TEMPLATE({\n        message: this._period(message),\n        body: body\n      });\n    }\n\n    return {\n      id: NOTIFICATION_ID,\n      status: 'error',\n      info: NOTIFICATION_TEMPLATE({\n        title: _t('notifications.vis.failed.title'),\n        body: body\n      }),\n      closable: false\n    };\n  },\n\n  _period: function (text) {\n    if (text && !/\\.$/.test(text)) {\n      return text + '.';\n    }\n    return text;\n  }\n};\n\nmodule.exports = VisNotifications;\n",
    "var _ = require('underscore');\nvar Notifier = require('./components/notifier/notifier');\nvar errorParser = require('./helpers/error-parser');\n\nvar NOTIFICATION_ERROR_TEMPLATE = _.template(\"<span class='u-errorTextColor'><%- title %></span>\");\n\nvar WidgetsNotifications = {\n\n  track: function (widgetsCollection) {\n    this._widgetDefinitionsCollection = widgetsCollection;\n    this._widgetDefinitionsCollection.on('success', this._showAddNotification, this);\n    this._widgetDefinitionsCollection.on('destroy', this._showRemoveNotification, this);\n    this._widgetDefinitionsCollection.on('error', this._showErrorNotification, this);\n    this._widgetDefinitionsCollection.on('loading', this._showLoadingNotification, this);\n    this._widgetDefinitionsCollection.on('updating', this._showUpdatingNotification, this);\n  },\n\n  _showLoadingNotification: function (widgetOptionModel) {\n    var notificationId = widgetOptionModel.cid;\n    var notificationAttrs = {\n      status: 'loading',\n      info: _t('notifications.widgets.loading'),\n      closable: false\n    };\n\n    this._addNotification(notificationId, notificationAttrs);\n  },\n\n  _showUpdatingNotification: function (widgetOptionModel) {\n    var notificationId = widgetOptionModel.cid;\n    var notificationAttrs = {\n      status: 'loading',\n      info: _t('notifications.widgets.updating'),\n      closable: false\n    };\n\n    this._addNotification(notificationId, notificationAttrs);\n  },\n\n  _showRemoveNotification: function (widgetModel) {\n    if (widgetModel.get('avoidNotification') === true) {\n      return;\n    }\n\n    var notificationAttrs = {\n      status: 'success',\n      info: _t('notifications.widgets.delete'),\n      closable: true,\n      delay: Notifier.DEFAULT_DELAY\n    };\n    this._addNotification(widgetModel.cid, notificationAttrs);\n  },\n\n  _showAddNotification: function (widgetOptionModel) {\n    var notificationId = widgetOptionModel.cid;\n    var notificationAttrs = {\n      status: 'success',\n      info: _t('notifications.widgets.success'),\n      closable: true\n    };\n    this._addOrUpdateNotification(notificationId, notificationAttrs);\n  },\n\n  _showErrorNotification: function (widgetOptionModel, error) {\n    var notificationId = widgetOptionModel.cid;\n    var notificationAttrs = {\n      status: 'error',\n      info: _t('notifications.widgets.error.body', {\n        body: NOTIFICATION_ERROR_TEMPLATE({\n          title: _t('notifications.widgets.error.title')\n        }),\n        error: errorParser(error)\n      }),\n      closable: true\n    };\n    this._addOrUpdateNotification(notificationId, notificationAttrs);\n  },\n\n  _addOrUpdateNotification: function (notificationId, notificationAttrs) {\n    var notification = this._getNotification(notificationId);\n    if (notification) {\n      notification.set(notificationAttrs);\n    } else {\n      this._addNotification(notificationId, notificationAttrs);\n    }\n  },\n\n  _addNotification: function (notificationId, notificationAttrs) {\n    notificationAttrs = _.extend({\n      id: notificationId\n    }, notificationAttrs);\n    Notifier.addNotification(notificationAttrs);\n  },\n\n  _getNotification: function (notificationId) {\n    return Notifier.getNotification(notificationId);\n  }\n};\n\nmodule.exports = WidgetsNotifications;\n",
    "module.exports={\n  \"feedback\": \"Give us feedback!\",\n  \"user\": {\n    \"you\": \"You\"\n  },\n  \"months\": {\n    \"january\": \"January\",\n    \"february\": \"February\",\n    \"march\": \"March\",\n    \"april\": \"April\",\n    \"may\": \"May\",\n    \"june\": \"June\",\n    \"july\": \"July\",\n    \"august\": \"August\",\n    \"september\": \"September\",\n    \"october\": \"October\",\n    \"november\": \"November\",\n    \"december\": \"December\"\n  },\n  \"assets\": {\n    \"maki-icons\": {\n      \"disclaimer\": \"<a href='https://github.com/mapbox/maki' target='_blank'>Maki Icons</a>, an open source project by <a href='http://mapbox.com' target='_blank'>Mapbox</a>\"\n    }\n  },\n  \"operators\": {\n    \"count\": \"COUNT\",\n    \"sum\": \"SUM\",\n    \"avg\": \"AVG\",\n    \"min\": \"MIN\",\n    \"max\": \"MAX\"\n  },\n  \"builder-activated-notification\": {\n    \"message\": \"CARTO Builder has been activated in your account. <a href='https://carto.com/learn/guides' class='onboardingNotification-link'>Learn more</a> about it and let us know what you think or <a href='mailto:builder-support@carto.com' class='onboardingNotification-link'>contact us</a>. Happy mapping!\"\n  },\n  \"builder-onboarding\": {\n    \"title\": \"Welcome to Builder,\",\n    \"description\": \"Discover the new and exciting analyses you can perform with location intelligence.\",\n    \"take-tour\": \"Take a tour\",\n    \"edit-map\": \"Edit your map\",\n    \"toolbar\": {\n      \"title\": \"Toolbar\",\n      \"description\": \"The toolbar provides options to access your dashboard, edit your map, and configure its settings.\"\n    },\n    \"configurator\": {\n      \"title\": \"Edit pane\",\n      \"description\": \"Manage all the components of your map: add layers and widgets, import datasets, customize analyses, and change styles.\"\n    },\n    \"map\": {\n      \"title\": \"Map\",\n      \"description\": \"Your map reflects changes instantly.\"\n    },\n    \"widgets\": {\n      \"title\": \"Widgets pane\",\n      \"description\": \"The widgets you add to your map appear directly on your visualization.\"\n    },\n    \"skip\": \"skip\",\n    \"next\": \"next\"\n  },\n  \"data-onboarding\": {\n    \"title\": \"Welcome to the layer pane\",\n    \"description\": \"Analyze, style, and enhance your data with pop-ups and&nbsp;legends.\",\n    \"take-tour\": \"Take the tour\",\n    \"edit-layer\": \"Edit layer\",\n    \"layer-options\": {\n      \"title\": \"Layer options\",\n      \"description\": \"Layers can be renamed by double-clicking on the layer name, centered by clicking in the crosshair, and exported through their contextual menu.\"\n    },\n    \"data-tab\": {\n      \"title\": \"Data tab\",\n      \"description\": \"Style, add analysis, pop-ups, and legends to layers. To further explore your data, add widgets.\"\n    },\n    \"sql-editor\": {\n      \"title\": \"SQL View\",\n      \"description\": \"Data layers can be edited and processed by using the SQL view at the bottom of the screen.\"\n    },\n    \"add-geometry\": {\n      \"title\": \"Add geometries and switch to dataset view\",\n      \"description\": \"You can switch between map or data view. In map view, you can add points, lines, and polygons.\",\n      \"edit-layer\": \"Edit layer\"\n    },\n    \"exit\": \"Exit tour\",\n    \"next\": \"Next\"\n  },\n  \"analysis-onboarding\": {\n    \"title\": \"The Art of Analysis\",\n    \"description\": \"Build reproducible workflows for analyzing and explaining your data. Analyses turn your maps into Location Intelligence apps.\",\n    \"description-list\": {\n      \"item1\": \"Different analyses can be chained\",\n      \"item2\": \"Analyses are dynamic. When the data changes, the analysis is&nbsp;refreshed.\",\n      \"item3\": \"The original data is not modified by the analysis workflow.\",\n      \"item4\": \"Some analysis queries add calculated results to columns in your dataset.\"\n    },\n    \"done\": \"Done\",\n    \"add-analysis\": \"Add analysis\",\n    \"never-show-message\": \"Don't show me this again.\"\n  },\n  \"style-onboarding\": {\n    \"title\": \"Style this map!\",\n    \"description\": \"Apply aggregation styling to maps and define options by geometry attributes or by a column value.\",\n    \"aggregation\": {\n      \"title\": \"How would you like to aggregate your data?\",\n      \"description\": \"Map types are called \\\"Aggregation\\\". Add Torque, Heatmap, and other aggregation styles to data.\"\n    },\n    \"style\": {\n      \"title\": \"Make it beautiful!\",\n      \"description\": \"Use these options to style your data in beautiful ways. For example, you can create thematic maps by altering the FILL option by value.\",\n      \"short-description\": \"Use these options to style your data in beautiful ways.\"\n    },\n    \"cartocss\": {\n      \"title\": \"Dress it up with CartoCSS\",\n      \"description\": \"Further style data by using the CartoCSS view at the bottom of the screen.\"\n    },\n    \"take-tour\": \"Take the tour\",\n    \"style-layer\": \"Style layer\",\n    \"never-show-message\": \"Don't show me this again.\",\n    \"exit\": \"Exit tour\",\n    \"next\": \"Next\"\n  },\n  \"analyses-onboarding\": {\n    \"placeholders\": {\n      \"layer-name\": \"NAME OF THE LAYER\",\n      \"clusters\": \"CLUSTERS\",\n      \"method\": \"METHOD\",\n      \"percentage\": \"PERCENTAGE\"\n    },\n    \"done\": \"Done\",\n    \"finished\": \"has finished\",\n    \"style-analysis\": \"Style this analysis\",\n    \"read-more\": \"Read more in documentation\",\n    \"learn-more\": \"Learn more\",\n    \"never-show-message\": \"Don't show me this again.\",\n    \"no-new-columns\": \"No new columns were created.\",\n    \"geometries-updated\": \"The geometries in your table were updated\",\n    \"new-column-added\": \"A new column has been added to your dataset.\",\n    \"new-columns-created\": \"New columns have been created as a new dataset.\",\n    \"new-column-included\": \"A new column has been included with your original data.\",\n    \"new-columns-included\": \"New columns has been included with your original data.\",\n    \"new-columns-included-based-on-input\": \"New columns have been included with your original data based on the columns chosen for the input.\",\n    \"sampling\": {\n      \"title\": \"Subsample of rows\",\n      \"description\": \"A sample of your original table was randomly selected to give approximately a percentage of the rows from your input dataset.\"\n    },\n    \"merge\": {\n      \"title\": \"Join columns from 2nd layer\",\n      \"description\": \"This analysis performed a columnar JOIN in order to get columns from two different tables.\"\n    },\n    \"intersection\": {\n      \"title\": \"Filter points in polygons\",\n      \"description\": \"This analysis performs a spatial intersection, returning only the rows from the target layer which intersect with geometries in the source layer.\",\n      \"source-cartodb-id\": \"This number represents the cartodb_id of the source geometry\"\n    },\n    \"area-of-influence\": {\n      \"title\": \"Create areas of influence\",\n      \"description\": \"Area of influence creates polygons according to the parameters set by the user.\",\n      \"the-geom\": \"This column was updated to show the area of influence requested.\"\n    },\n    \"aggregate-intersection\": {\n      \"title\": \"Intersect second layer\",\n      \"description\": \"This operation performs a spatial intersection and aggregates the geometry values from the target layer that intersect with the geometry of the source layer.\",\n      \"count-vals-density\": \"This column is added if COUNT was chosen as the aggregation operation\",\n      \"extra-column\": \"This column is added if {operation_type} is chosen with column {column_name}\"\n    },\n    \"filter\": {\n      \"title\": \"Row filtering\",\n      \"description\": \"Row filtering allows you to quickly narrow down the total data you display on a map or input into an analysis node.\"\n    },\n    \"filter-by-node-column\": {\n      \"title\": \"Filter by layer\",\n      \"description\": \"Filter by layer allows you to filter the data in your layer by propagating the filters in the attached layer. Now if you filter on widgets added to the first node, the results in the second node would be also filtered.\"\n    },\n    \"spatial-markov-trend\": {\n      \"trend\": \"The normalized trend for each geometry\",\n      \"trend_up\": \"The probability that a geometry's value will move to a higher class\",\n      \"trend_down\": \"The probability that a geometry's value will move to a lower class\",\n      \"volatility\": \"A measure of the potential for a geometry to possess values in other classes\",\n      \"description\": \"Trends and volatility are calculated based on the time series data input. Trends calculated from inputs with a longer history are more precise. Inputs for the time column should equally spaced (e.g., all one week/month/year apart).\"\n    },\n    \"moran\": {\n      \"title\": \"Detect outliers and clusters\",\n      \"description\": \"Detect outliers and clusters finds areas in your data where clusters of high values or low values exist, as well as areas which are dissimilar from their neighbors.\",\n      \"quads\": \"Classification of the geometry from the analysis\",\n      \"significance\": \"The statistical significance of the geometry's classification of one of four quadrant types.\",\n      \"moran\": \"The local statistic calculated from the Moran's I analysis for each geometry/value in the dataset.\",\n      \"rowid\": \"The original row id of the geometry (cartodb_id).\"\n    },\n    \"kmeans\": {\n      \"title\": \"Calculating point clusters\",\n      \"cluster-no\": \"A numeric identifier for each cluster in your dataset. Values start at 1 and go up to the %{clusters} clusters you requested (or max rows if less).\",\n      \"description\": \"Point clustering is uses k-means to calculate a predefined number of clusters from your data.\"\n    },\n    \"data-observatory-measure\": {\n      \"title\": \"Enrich from the Data Observatory\",\n      \"custom-column\": \"This column contains the data requested from the Data Observatory\",\n      \"description\": \"The Data Observatory enrichment is the result of the geometry location and the measure requested.\"\n    },\n    \"connect-with-lines\": {\n      \"title\": \"Connect with lines\",\n      \"description\": \"Create lines from point datasets using a variety of methods\",\n      \"the-geom\": \"This column was updated to be lines according to the method chosen.\",\n      \"line-sequential\": \"This analysis creates a line by connecting all points in the dataset in a specified order\",\n      \"line-source-to-target\": \"Link a source point to a target point based on a shared attribute\",\n      \"line-to-column\": \"Create lines from a point to to a geometry stored in another column\",\n      \"line-to-single-point\": \"Connect the coordinate from latitude and longitude columns to the point geometry (`the_geom`) in your dataset.\"\n    },\n    \"group-points\": {\n      \"title\": \"Group points into polygons\",\n      \"the-geom\": \"This column was updated to polygons encompassing the input points.\",\n      \"category\": \"This will be the category over which the polygons were calculated\",\n      \"description\": \"Group points into polygons to create new polygons.\"\n    },\n    \"georeference\": {\n      \"title\": \"Georeference\",\n      \"the-geom\": \"This column, which stores the geographic information in your dataset, has been updated to reflect the boundaries or locations from the inputs specified.\",\n      \"description\": \"Georeferencing data is a service that uses information from many sources to get the geographical information associated with latitude/longitude columns, city names, postal codes, administrative boundaries, IP addresses, or street addresses.\"\n    },\n    \"centroid\": {\n      \"title\": \"Calculating centroids from geometries\",\n      \"description\": \"Centroids are calculated from all, groups, or singular geometries. Using the optional parameters of Category, Aggregate, and Weight you can change how they are calculated and what information the result will contain. \",\n      \"the-geom\": \"Point geometries representing the centroid(s) of your input data.\",\n      \"aggregated-value\": \"Stores the aggregate value for each centroid.\",\n      \"non-aggregated-value\": \"Contains the count of features considered for each centroid\",\n      \"category\": \"Stores the category value for each centroid from the source dataset\"\n    },\n    \"closest\": {\n      \"description\": \"Find nearest analysis locates the closest points between two tables.\",\n      \"source_cdb_id\": \"This column has been created with the related points id from the source table.\",\n      \"the-geom\": \"This column has been updated with the target table geometries.\",\n      \"title\": \"Find nearest\"\n    }\n  },\n  \"analyses\": {\n    \"connect-with-lines\": {\n      \"title\": \"Connect with lines\",\n      \"short-title\": \"Connect with lines\"\n    },\n    \"georeference\": {\n      \"title\": \"Georeference\",\n      \"short-title\": \"Georeference\"\n    },\n    \"data-observatory-measure\": {\n      \"title\": \"Enrich from Data Observatory\",\n      \"short-title\": \"Data observatory\",\n      \"age-and-gender\": \"Age and Gender\",\n      \"boundaries\": \"Boundaries\",\n      \"education\": \"Education\",\n      \"employment\": \"Employment\",\n      \"families\": \"Families\",\n      \"housing\": \"Housing\",\n      \"income\": \"Income\",\n      \"language\": \"Language\",\n      \"migration\": \"Migration\",\n      \"nationality\": \"Nationality\",\n      \"population-segments\": \"Population segments\",\n      \"race-and-ethnicity\": \"Race and Ethnicity\",\n      \"religion\": \"Religion\",\n      \"transportation\": \"Transportation\",\n      \"filters\": \"Filters\"\n    },\n    \"merge\": {\n      \"title\": \"Join columns from 2nd layer\",\n      \"short-title\": \"Join columns\"\n    },\n    \"filter-by-node-column\": {\n      \"title\": \"Filter by layer\",\n      \"short-title\": \"Filter by layer\"\n    },\n    \"centroid\": {\n      \"title\": \"Centroid from geometries\",\n      \"short-title\": \"Centroid\"\n    },\n    \"group-points\": {\n      \"title\": \"Group points into polygons\",\n      \"short-title\": \"Group points\"\n    },\n    \"convex-hull\": {\n      \"title\": \"Convex Hull\",\n      \"short-title\": \"Convex Hull\"\n    },\n    \"concave-hull\": {\n      \"title\": \"Concave Hull\",\n      \"short-title\": \"Concave Hull\"\n    },\n    \"bounding-box\": {\n      \"title\": \"Bounding Box\",\n      \"short-title\": \"Bounding Box\"\n    },\n    \"bounding-circle\": {\n      \"title\": \"Bounding Circle\",\n      \"short-title\": \"Bounding Circle\"\n    },\n    \"area-of-influence\": {\n      \"title\": \"Create areas of influence\",\n      \"short-title\": \"AOI\"\n    },\n    \"filter-intersection\": {\n      \"title\": \"Filter points in polygons\",\n      \"short-title\": \"Filter points in polygons\"\n    },\n    \"aggregate-intersection\": {\n      \"title\": \"Aggregate intersection\",\n      \"short-title\": \"Aggregate intersection\"\n    },\n    \"filter\": {\n      \"title\": \"Filter by column value\",\n      \"short-title\": \"Filter\"\n    },\n    \"sampling\": {\n      \"title\": \"Subsample percent of rows\",\n      \"short-title\": \"Sampling\"\n    },\n    \"kmeans\": {\n      \"title\": \"Calculate clusters of points\",\n      \"short-title\": \"Clusters\"\n    },\n    \"moran-cluster\": {\n      \"title\": \"Detect outliers and clusters\",\n      \"short-title\": \"Outliers & clusters\"\n    },\n    \"spatial-markov-trend\": {\n      \"title\": \"Predict trends and volatility\",\n      \"short-title\": \"Trends\"\n    },\n    \"source\": \"Source\",\n    \"routing\": {\n      \"short-title\": \"Routing\"\n    }\n  },\n  \"analysis-category\": {\n    \"all\": \"All\",\n    \"analyze-predict\": \"Analyze and predict\",\n    \"create-clean\": \"Create and clean\",\n    \"data-transformation\": \"Transform\"\n  },\n  \"form-components\": {\n    \"editors\": {\n      \"radio\": {\n        \"true\": \"True\",\n        \"false\": \"False\",\n        \"null\": \"Null\"\n      },\n      \"fill\": {\n        \"customize\": \"Custom color set\",\n        \"quantification\": {\n          \"title\": \"Quantification\",\n          \"methods\": {\n            \"jenks\": \"Jenks\",\n            \"equal\": \"Equal Interval\",\n            \"headtails\": \"Heads/Tails\",\n            \"quantiles\": \"Quantiles\",\n            \"category\": \"Category\"\n          }\n        },\n        \"bins\": \"Buckets\",\n        \"input-color\": {\n          \"solid\": \"Solid\",\n          \"value\": \"By value\",\n          \"img\": \"Img\"\n        },\n        \"input-number\": {\n          \"fixed\": \"Fixed\",\n          \"value\": \"By value\"\n        },\n        \"input-ramp\": {\n          \"buckets\": \"bucket |||| buckets\"\n        },\n        \"input-categories\": {\n          \"null\": \"null\",\n          \"others\": \"Others\"\n        },\n        \"image\": {\n          \"recently-title\": \"Most used\",\n          \"none\": \"None\",\n          \"show-all\": \"Show full collections\"\n        }\n      }\n    }\n  },\n  \"data\": {\n    \"import-model\": {\n      \"error-title\": \"There was an error\",\n      \"error-starting-import\": \"Unfortunately, there was an error starting the import\"\n    },\n    \"upload-model\": {\n      \"invalid-import\": \"Invalid import\",\n      \"one-file\": \"Unfortunately, only one file is allowed per upload\",\n      \"file-defined\": \"File name should be defined\",\n      \"file-extension\": \"Unfortunately, this file extension is not allowed\",\n      \"file-size\": \"Unfortunately, the size of the file is bigger than your remaining quota\",\n      \"visualization-id\": \"The remote visualization id was not specified\",\n      \"remote-file-size\": \"Unfortunately, the size of the remote dataset is bigger than your remaining quota\",\n      \"url-invalid\": \"Unfortunately, the URL provided is not valid\",\n      \"error-happened\": \"There was an error\",\n      \"connection-error\": \"Unfortunately, there was a connection error\",\n      \"twitter-dates-invalid\": \"Twitter dates are not valid\",\n      \"twitter-dates-empty\": \"Twitter dates are empty\",\n      \"twitter-categories-invalid\": \"Twitter categories are not valid\",\n      \"twitter-data\": \"Twitter data is empty\",\n      \"dataset-copy-undefined\": \"Dataset copy is not defined\",\n      \"query-undefined\": \"Query is not provided\"\n    },\n    \"analysis-definition-node-model\": {\n      \"validation\": {\n        \"missing-required\": \"Required\",\n        \"invalid-source\": \"Invalid source\",\n        \"invalid-value\": \"Invalid value\",\n        \"invalid-enum\": \"Invalid value, must be any of %{expectedValues}\"\n      }\n    }\n  },\n  \"components\": {\n    \"geocoding\": {\n      \"geocoding-error-details\": {\n        \"close\": \"close\",\n        \"description\": \"There was a problem georeferencing your data\",\n        \"title\": \"Geocoding Error\",\n        \"try-again\": \"Please try again and if the problem persists, <a href='mailto:support@carto.com?subject=Geocoding error with id:%{id}'>contact us</a> with the following code:\",\n        \"view-dataset\": \"view dataset\"\n      },\n      \"geocoding-success-detail\": {\n        \"amount-charged\": \"<strong>$%{price}</strong> will be charged to your account\",\n        \"credits-consumed\": \"You have consumed all your credits during this billing cycle, price is $%{price} / 1,000 extra credits.\",\n        \"description\": \"We've successfully geocoded <%- realRowsFormatted %> <%- geometryType %> of <%- processableRowsFormatted %>. |||| We've successfully geocoded <%- realRowsFormatted %> <%- geometryType %>s of <%- processableRowsFormatted %>.\",\n        \"explanation\": \"Rows that are not geocoded could have errors in their column values, or dont exist in our data. Try geocoding again and check the 'override all values' to try again.\",\n        \"no-extra-charge\": \"No extra charges have been done\",\n        \"remainingQuotaFormatted\": \"You still have %{remainingQuotaFormatted} credits left for this month.\",\n        \"title\": \"Data geocoded\",\n        \"try-again\": \"Unsuccessful rows don't count against your quota, so we encourage you to take a look and try again.\",\n        \"view-dataset\": \"view dataset\"\n      },\n      \"geocoding-no-result-details\": {\n        \"close\": \"close\",\n        \"description\": \"These rows contained empty values or perhaps we just didn't know what the values meant. We encourage you to take a look and try again.\",\n        \"title\": \"No rows were georeferenced\",\n        \"view-dataset\": \"view dataset\"\n      }\n    },\n    \"background-importer\": {\n      \"background-importer-item\": {\n        \"completed\": \"completed\",\n        \"error-connecting\": \"<span class='u-errorTextColor'>Error connecting</span> %{name}\",\n        \"from\": \"from\",\n        \"show\": \"show\"\n      },\n      \"warnings-details\": {\n        \"continue-btn\": \"Continue\",\n        \"find-connected-datasets\": \"You can find all the connected datasets under the datasets section.\",\n        \"no-more-datasets\": \"No more than %{maxTablesPerImport} datasets can be imported from a single file.\",\n        \"unable-to-import-datasets\": \"Unable to import all datasets in file\"\n      },\n      \"partial-import-details\": {\n        \"find-connected-datasets\": \"You can find all the connected datasets under the datasets section.\",\n        \"continue-btn\": \"Continue\",\n        \"too-many-datasets\": \"NOTE: The file you uploaded contained too many datasets. No more than %{maxTablesPerImport} datasets can be imported from a single file.\",\n        \"unable-to-import-as-layers\": \"Unable to add all imported datasets as layers\",\n        \"upgrade-your-account\": \"<a href='https://carto.com/pricing/'>Upgrade your account</a> to add more than %{userMaxLayers} layers to your maps.\"\n      },\n      \"connector-warning-details\": {\n        \"continue-btn\": \"Continue\",\n        \"too-many-rows\": \"You may have reached the maximum limit.\",\n        \"unable-to-import-all-rows\": \"For a database connector import, the number of rows allowed is %{maxRowsPerConnectorImport}. Some of your data may not be imported.\"\n      },\n      \"error-details\": {\n        \"check-errors\": \"Check errors\",\n        \"check-url\": \"Check that the URL you provided is OK\",\n        \"close\": \"close\",\n        \"dont-panic\": \"Dont panic, here's some info that might help\",\n        \"remote-server-code\": \"The remote server returned a <span class='ErrorDetails-itemTextStrong'>%{httpResponseCode}</span> code.\",\n        \"send-us-the-error-code\": \"Persisting error? Please <a href='mailto:support@carto.com'>send us</a> the following code\",\n        \"unknown-error\": \"An unknown error has happened\"\n      },\n      \"upgrade-errors\": {\n        \"8001\": {\n          \"description\": \"Remove some of your datasets to gain available space or upgrade your account\",\n          \"info\": \"Keep your data and get a larger quota by upgrading your plan\",\n          \"title\": \"Your quota has run out\"\n        },\n        \"8005\": {\n          \"description\": \"Remove any layer or upgrade your account\",\n          \"info\": \"Keep your maps and get more layer count quota by upgrading your plan\",\n          \"title\": \"You have reached your layer count limit\"\n        },\n        \"upgrade\": \"upgrade\"\n      },\n      \"twitter-import-details\": {\n        \"new-type-created\": \"We've created a new dataset containing a total of %{datasetTotalRowsFormatted}<br/>tweet%{tweetPlural} with your search terms\",\n        \"credit-left\": \"You still have %{availableTweetsFormatted} credit left for this billing cycle.\",\n        \"credits-left\": \"You still have %{availableTweetsFormatted} credits left for this billing cycle.\",\n        \"no-more-credits\": \"You have consumed all your credits during this billing cycle (price is $%{blockPriceFormatted}/%{blockSizeFormatted} extra credits).\",\n        \"twitter-import-title\": \"Your Twitter dataset is created\",\n        \"tweet-cost\": {\n          \"free\": \"No extra charges have been applied\",\n          \"paid\": \"$%{tweetsCostFormatted} will be charged to your account\"\n        },\n        \"errors\": {\n          \"no-results\": \"Your search query was correct but returned no results, \\n please try with a different set of parameters before running it again\"\n        }\n      },\n      \"background-geocoding-item\": {\n        \"geocoded\": \"%{realRowsFormatted}/%{processableRowsFormatted} row geocoded |||| %{realRowsFormatted}/%{processableRowsFormatted} rows geocoded\",\n        \"geocoded-by-lat-lng\": \"Geocoded by latitude and longitude\",\n        \"geocoding\": \"Geocoding %{tableName} dataset\",\n        \"show\": \"show\",\n        \"rows-geocoded\": {\n          \"without-dataset\": \"%{realRowsFormatted} row geocoded |||| %{realRowsFormatted} rows geocoded\",\n          \"in-dataset\": \"%{realRowsFormatted} row geocoded in %{tableName} dataset|||| %{realRowsFormatted} rows geocoded in %{tableName} dataset\"\n        },\n        \"errors\": {\n          \"no-rows-geocoded\": {\n            \"without-dataset\": \"No rows geocoded\",\n            \"in-dataset\": \"No rows geocoded in %{tableName} dataset\"\n          },\n          \"geocoding-layer\": \"Ouch! There was an error geocoding %{tableName} layer\"\n        }\n      },\n      \"background-import-limit\": {\n        \"hurry\": \"In a hurry? <a href='%{upgradeUrl}'>Upgrade your account</a> to import several files at a time\",\n        \"one-file\": \"Unfortunately, you can only import up to %{importQuota} files at the same time\"\n      },\n      \"free-trial\": \"Get a %{days} day free trial\",\n      \"connecting\": \"Connecting\",\n      \"dataset\": \"dataset\",\n      \"geocoding\": \"Geocoding\",\n      \"working\": \"Working\"\n    },\n    \"likes-pluralize\": \"like |||| likes\",\n    \"custom-list\": {\n      \"placeholder\": \"Search by %{typeLabel}\",\n      \"no-items\": \"There are no %{typeLabel} items\",\n      \"no-results\": \"No %{typeLabel} results found with '%{query}'\",\n      \"add-custom-result\": \"Add custom value\"\n    },\n    \"datepicker\": {\n      \"dates-placeholder\": \"Choose your dates\",\n      \"get-last\": \"Get last\",\n      \"hour\": \"hour\",\n      \"min\": \"min\",\n      \"from\": \"from\",\n      \"to\": \"to\",\n      \"or\": \"or\",\n      \"days-pluralize\": \"1 day |||| %{smart_count} days\",\n      \"weeks-pluralize\": \"1 week |||| %{smart_count} weeks\",\n      \"hours-pluralize\": \"hour week |||| %{smart_count} hours\",\n      \"gmt-convertion\": \"Date will be converted to GMT +0\",\n      \"invalid-date\": \"Invalid date\"\n    },\n    \"taglist\": {\n      \"none\": \"No tags\",\n      \"placeholder\": \"Add tags\"\n    },\n    \"pagination-search\": {\n      \"filter\": {\n        \"search\": \"Search\",\n        \"placeholder\": \"Search by username or email\"\n      },\n      \"loading\": {\n        \"title\": \"Loading...\"\n      },\n      \"error\": {\n        \"title\": \"Error\",\n        \"desc\": \"Oops there was an error.\"\n      },\n      \"no-results\": {\n        \"title\": \"Oh! No results\",\n        \"desc\": \"Unfortunately we could not find anything with these parameters\"\n      }\n    },\n    \"modals\": {\n      \"editor-vis-warning\": {\n        \"title\": \"You are about to open an Editor map with the new Builder\",\n        \"explanation\": \"Builder offers an easy-to-use and intuitive drag and drop functionality to analyze and visualize your data. However, some of the old Editor features, such as overlays, are not currently available in Builder.\",\n        \"question\": \"Opening your map in Builder may cause the loss of any feature not supported yet. Are you sure you want to continue?\",\n        \"go-back\": \"No, go back to dashboard\",\n        \"open\": \"Yes, open with Builder\",\n        \"duplicate\": \"duplicate and open with Builder\",\n        \"opening-title\": \"Opening %{name} with Builder\"\n      },\n      \"add-basemap\": {\n        \"modal-title\": \"Add a custom basemap\",\n        \"modal-desc\": \"Select from these great resources\",\n        \"adding-basemap\": \"Adding new basemap\",\n        \"add-basemap-error\": \"Could not add basemap\",\n        \"add-btn\": \"Add basemap\",\n        \"cancel-btn\": \"Cancel\",\n        \"validating\": \"Validating\",\n        \"saving\": \"Saving layer\",\n        \"fetching\": \"Fetching layers\",\n        \"get-layers\": \"Get layers\",\n        \"xyz\": {\n          \"insert\": \"Insert your XYZ URL\",\n          \"enter\": \"Enter a URL\",\n          \"not-valid\": \"Insert a valid XYZ URL\",\n          \"eg\": \"E.g.\",\n          \"tms\": \"TMS\",\n          \"couldnt-validate\": \"We couldn't validate this. If you're sure it contains data click \\\"add basemap\\\"\"\n        },\n        \"mapbox\": {\n          \"insert\": \"Insert your Mapbox URL\",\n          \"enter\": \"Enter your map ID/URL\",\n          \"enter-token\": \"Enter your access token\",\n          \"error\": \"Error retrieving your basemap. Please check your access token.\",\n          \"invalid\": \"This URL is not valid.\"\n        },\n        \"wms\": {\n          \"insert\": \"Insert your WMS/WMTS URL\",\n          \"invalid\": \"The URL is either invalid or contains unsupported projections\",\n          \"see-docs\": \"see docs\",\n          \"oh-no\": \"Oh! No results\",\n          \"unfortunately\": \"Unfortunately, we couldn't find a layer that matched your search term\",\n          \"tables-pluralize\": \"table |||| tables\",\n          \"placeholder\": \"%{layersFoundCount} %{layersFoundCountPluralize} found, %{layersAvailableCount} %{layersAvailableCountPluralize} available\"\n        },\n        \"tilejson\": {\n          \"insert\": \"Insert your TileJSON URL\",\n          \"invalid\": \"Invalid URL, please make sure it is correct\"\n        },\n        \"nasa\": {\n          \"select\": \"Select a date from which you want a NASA Worldview basemap\",\n          \"day\": \"Day\",\n          \"night\": \"Night\",\n          \"cant-select\": \"You can't select a date in night mode\"\n        }\n      },\n      \"export-data\": {\n        \"title\": \"Export data\",\n        \"desc\": \"Select the preferred file format\",\n        \"no-geometry\": \"To download any geospatial format like SHP, KML or GeoJSON don't forget to select the_geom on your query.\",\n        \"loading\": {\n          \"geometry\": \"Checking geometries...\",\n          \"preparing\": \"Preparing content...\"\n        },\n        \"errors\": {\n          \"title\": \"There was an error\",\n          \"geometry-error\": \"We can't read data geometries\",\n          \"unknown\": \"An error occurred\"\n        },\n        \"cancel\": \"Cancel\",\n        \"download\": \"Download\"\n      },\n      \"maps-metadata\": {\n        \"modal-title\": \"Map metadata\",\n        \"modal-desc\": \"Edit the attributes of your map\",\n        \"back-btn\": \"GO BACK\",\n        \"save-btn\": \"Save\",\n        \"cancel-btn\": \"Cancel\",\n        \"form\": {\n          \"name\": \"Map Name\",\n          \"name-placeholder\": \"Type your name here\",\n          \"description\": \"Description\",\n          \"description-placeholder\": \"Type your description here\",\n          \"tags\": \"Tags\",\n          \"markdown\": \"Markdown supported\"\n        },\n        \"validation\": {\n          \"error\": {\n            \"name\": \"Name can't be blank\"\n          }\n        },\n        \"error\": {\n          \"title\": \"We couldn't save your data\",\n          \"subtitle\": \"We had an error trying to save your data: <span class='CDB-Text is-semibold'>%{error}</span>\"\n        },\n        \"loading\": \"Saving your data...\",\n        \"success\": \"<span class='CDB-Text is-semibold'>Metadata</span> for %{name} map <span class='CDB-Text is-semibold'>was saved</span>.\"\n      },\n      \"dataset-metadata\": {\n        \"modal-title\": \"Dataset metadata\",\n        \"modal-desc\": \"Edit the attributes of your dataset\",\n        \"back-btn\": \"GO BACK\",\n        \"save-btn\": \"Save\",\n        \"cancel-btn\": \"Cancel\",\n        \"form\": {\n          \"name\": \"Dataset Name\",\n          \"name-placeholder\": \"Type your name here\",\n          \"description\": \"Description\",\n          \"description-placeholder\": \"Type your description here\",\n          \"attributions\": \"Attributions\",\n          \"attributions-placeholder\": \"Type your attributions here\",\n          \"tags\": \"Tags\",\n          \"source\": \"Source\",\n          \"source-placeholder\": \"Enter the source of the data\",\n          \"license\": \"License\",\n          \"markdown\": \"Markdown supported\"\n        },\n        \"validation\": {\n          \"error\": {\n            \"name\": \"Name can't be blank\"\n          }\n        },\n        \"error\": {\n          \"title\": \"We couldn't save your data\",\n          \"subtitle\": \"We had an error trying to save your data: <span class='CDB-Text is-semibold'>%{error}</span>\"\n        },\n        \"loading\": \"Saving your data...\",\n        \"success\": \"<span class='CDB-Text is-semibold'>Metadata</span> for %{name} dataset <span class='CDB-Text is-semibold'>was saved</span>.\"\n      },\n      \"publish\": {\n        \"done-btn\": \"Done\",\n        \"update-btn\": \"Update\",\n        \"publish-btn\": \"Publish\",\n        \"publishing-btn\": \"Publishing\",\n        \"updating-btn\": \"Updating\",\n        \"menu\": {\n          \"share\": \"Share with colleagues\",\n          \"publish\": \"publish\"\n        },\n        \"privacy\": {\n          \"privacy\": \"privacy\",\n          \"cta\": {\n            \"title\": \"Want some privacy?\",\n            \"desc-trial\": \"Check our plans with 14 days trial\",\n            \"desc-notrial\": \"Upgrade your account!\"\n          },\n          \"public\": {\n            \"type\": \"PUBLIC\",\n            \"title\": \"Public\",\n            \"body\": \"Everyone can view your table and download it\"\n          },\n          \"link\": {\n            \"type\": \"LINK\",\n            \"title\": \"Only accessible with link\",\n            \"body\": \"Only the people with a shared link can view the data\"\n          },\n          \"password\": {\n            \"type\": \"PASSWORD\",\n            \"title\": \"Password\",\n            \"body\": \"Set a password and share only with specific people\",\n            \"placeholder\": \"Type your password\"\n          },\n          \"private\": {\n            \"type\": \"PRIVATE\",\n            \"title\": \"Private\",\n            \"body\": \"Nobody can access this dataset\"\n          },\n          \"error\": {\n            \"title\": \"We couldn't save your data\",\n            \"subtitle\": \"We had an internal error trying to save your data. We recommend you try again.\"\n          },\n          \"upgrade\": {\n            \"title\": \"Interested in sharing within your organization?\",\n            \"desc\": \"%{contact} to try one of our Enterprise plans\",\n            \"contact\": \"Contact us\",\n            \"mail\": \"sales@carto.com\"\n          },\n          \"loading\": \"Saving your data...\"\n        },\n        \"share\": {\n          \"published\": \"Published %{when}\",\n          \"unpublished\": \"Never published.\",\n          \"last-published\": \"Last updated %{date}\",\n          \"unpublished-header\": \"Click on Publish to start sharing your map on the web\",\n          \"unpublished-subheader\": \"From the moment you click on publish, you will need to use this window to update your changes on the public version.\",\n          \"upgradeLabel\": \"Upgrade\",\n          \"upgradeLink\": \"https://carto.com/pricing/#pricing-standard\",\n          \"upgrade\": \"%{upgradeLink} to share with your colleagues?\",\n          \"private\": \"PRIVATE\",\n          \"get-link\": {\n            \"title\": \"Get the link\",\n            \"body\": \"Send to your friends, coworkers, or post it in your social networks.\",\n            \"link\": \"\",\n            \"copy\": \"COPY\",\n            \"select\": \"SELECT\",\n            \"private\": {\n              \"body\": \"Your map is %{private} Change privacy to get the link\"\n            }\n          },\n          \"embed\": {\n            \"title\": \"Embed it\",\n            \"body\": \"Insert your map into your blog, website, or simple application.\",\n            \"link\": \"Get a simple URL.\",\n            \"copy\": \"COPY\",\n            \"select\": \"SELECT\",\n            \"private\": {\n              \"body\": \"Your map is %{private} Change privacy to embed map\"\n            }\n          },\n          \"cartodbjs\": {\n            \"title\": \"CARTO.js\",\n            \"body\": \"Add your map to your applications using this URL.\",\n            \"link\": \"Read more.\",\n            \"copy\": \"COPY\",\n            \"select\": \"SELECT\"\n          },\n          \"mobile-sdk\": {\n            \"title\": \"CARTO Mobile SDK\",\n            \"body\": \"Add your map to your native mobile applications using this line of code.\",\n            \"link\": \"Read more.\",\n            \"copy\": \"COPY\",\n            \"select\": \"SELECT\"\n          },\n          \"error\": {\n            \"title\": \"We couldn't save your data\",\n            \"subtitle\": \"We had an internal error trying to save your data. We recommend you try again.\"\n          },\n          \"loading\": \"Saving your data...\",\n          \"organization\": {\n            \"title\": \"Default settings for your Organization\",\n            \"desc\": \"New users will have this permission\"\n          },\n          \"role\": {\n            \"viewer\": \"Viewer\",\n            \"builder\": \"Builder\"\n          },\n          \"tooltip\": {\n            \"group\": \"Access is inherited from group %{name}\",\n            \"org\": \"Access is inherited from organization\"\n          },\n          \"toggle\": {\n            \"read\": \"Read\",\n            \"write\": \"Write\"\n          },\n          \"add-people\": \"Add people\"\n        }\n      },\n      \"assets-picker\": {\n        \"browse\": \"Browse\",\n        \"delete-image\": \"Delete image\",\n        \"delete-images\": \"Delete images\",\n        \"deselect-all\": \"Deselect all\",\n        \"drag-and-drop\": \"Drag & drop your file\",\n        \"error-desc\": \"Please, go back and try again. If the problem persists contact us at <a href='mailto:support@carto.com'>support@carto.com</a>\",\n        \"go-back\": \"Go back\",\n        \"incorrect-url\": \"Error. Your URL doesnt look correct.\",\n        \"loading\": \"Loading\",\n        \"or\": \"or\",\n        \"select-all\": \"Select all\",\n        \"submit\": \"submit\",\n        \"upload-desc\": \"Paste a URL or select a file like JPG, GIF, PNG, SVG\",\n        \"upload-file-url\": \"Upload a file or a URL\"\n      },\n      \"add-asset\": {\n        \"icons\": \"Icons\",\n        \"modal-desc\": \"or just use our nice selection\",\n        \"modal-title\": \"Select marker image\",\n        \"set-image\": \"Set image\",\n        \"upload-file\": \"Upload file\",\n        \"upload-asset\": \"Upload asset\",\n        \"upload-image\": \"Upload your image\",\n        \"your-uploads\": \"Your uploads\",\n        \"organization-uploads\": \"Organization uploads\"\n      },\n      \"add-analysis\": {\n        \"modal-title\": \"Add a new analysis\",\n        \"modal-desc\": \"Select the analysis you want to add\",\n        \"loading-title\": \"Loading options\",\n        \"add-btn\": \"Add analysis\",\n        \"disabled-option-desc\": \"Your layer's geometries are %{simpleGeometryType} and this analysis needs %{requiredInputGeometries}\",\n        \"unknown-geometry-type\": \"unknown\",\n        \"info-analysis\": \"Info about analysis\",\n        \"option-types\": {\n          \"connect-with-lines\": {\n            \"title\": \"Connect with lines\",\n            \"desc\": \"Create lines from point datasets using a variety of methods\"\n          },\n          \"group-points\": {\n            \"title\": \"Group points into polygons\",\n            \"desc\": \"Aggregate points into polygons such as convex hulls or bounding boxes.\"\n          },\n          \"aggregate-intersection\": {\n            \"title\": \"Intersect second layer\",\n            \"desc\": \"Intersect with a second layer and calculate aggregations on the fly.\"\n          },\n          \"area-of-influence\": {\n            \"title\": \"Create areas of influence\",\n            \"desc\": \"Use travel time (e.g. walking or driving) or distance to calculate areas of influence from points.\"\n          },\n          \"georeference\": {\n            \"title\": \"Georeference\",\n            \"desc\": \"Use street addresses, city names, or other location text to generate point geometries.\"\n          },\n          \"filter-intersection\": {\n            \"title\": \"Filter points in polygons\",\n            \"desc\": \"Filter points intersecting your polygons layer, and augment those with your polygons columns.\"\n          },\n          \"filter\": {\n            \"title\": \"Filter by column value\",\n            \"desc\": \"Keep or discard rows according to a custom criteria.\"\n          },\n          \"merge\": {\n            \"title\": \"Join columns from 2nd layer\",\n            \"desc\": \"Join columns from a second layer by linking a shared value found in both datasets.\"\n          },\n          \"moran-cluster\": {\n            \"title\": \"Detect outliers and clusters\",\n            \"desc\": \"Use Moran's I to find high (HL) and low (LH) outliers and high (HH) and low (LL) clusters.\",\n            \"high-low\": \"High-Low (HL)\",\n            \"high-high\": \"High-High (HH)\",\n            \"low-high\": \"Low-High (LH)\",\n            \"low-low\": \"Low-Low (LL)\"\n          },\n          \"kmeans\": {\n            \"title\": \"Calculate clusters of points\",\n            \"desc\": \"Spatially separate a layer of points into a specified number (N) of groups.\"\n          },\n          \"centroid\": {\n            \"title\": \"Find centroid of geometries\",\n            \"desc\": \"Calculate a direct or weighted centroid based on all rows of a layer or by categories.\"\n          },\n          \"filter-by-node-column\": {\n            \"title\": \"Filter by layer\",\n            \"desc\": \"Filter your layer depending on a second layer such that widgets will effect both.\"\n          },\n          \"sampling\": {\n            \"title\": \"Subsample percent of rows\",\n            \"desc\": \"Subsample the rows in a dataset based on a specified percent.\"\n          },\n          \"spatial-markov-trend\": {\n            \"title\": \"Predict trends and volatility\",\n            \"desc\": \"Predict probability of upward and downward trends using spatial Markov chains.\"\n          },\n          \"data-observatory-measure\": {\n            \"title\": \"Enrich from Data Observatory\",\n            \"desc\": \"Add a new column with contextual demographic and economic measures.\"\n          },\n          \"deprecated-sql-function\": {\n            \"title\": \"SQL Function\",\n            \"desc\": \"Run your custom SQL function\"\n          }\n        }\n      },\n      \"add-widgets\": {\n        \"modal-title\": \"Add new widgets\",\n        \"modal-desc\": \"Select the widgets you want to add\",\n        \"continue-btn\": \"Continue\",\n        \"loading-title\": \"Loading columns\",\n        \"tab-pane\": {\n          \"histogram-label\": \"Histogram\",\n          \"category-label\": \"Category\",\n          \"formula-label\": \"Formula\",\n          \"time-series-label\": \"Time-series\"\n        },\n        \"percentage-in-top-cats\": \"% in top 10 cat\",\n        \"time-series-no-option-title\": \"None\",\n        \"time-series-no-option-desc\": \"This option won't show your time-series widget\"\n      },\n      \"add-layer\": {\n        \"modal-title\": \"Add a new layer\",\n        \"modal-desc\": \"Select an existing dataset or connect a new one\",\n        \"navigation\": {\n          \"search\": \"Search\",\n          \"search-placeholder\": \"by name, description, or :tag\",\n          \"connect-dataset\": \"Connect dataset\",\n          \"shared-with-you\": \"Shared with you\",\n          \"data-library\": \"Data library\",\n          \"create-empty-map\": \"Create empty map\",\n          \"create-empty-dataset\": \"Create empty dataset\",\n          \"create-empty-addLayer\": \"Add an empty layer\",\n          \"dataset-pluralize\": \"Dataset |||| Datasets\"\n        },\n        \"create-loading-title\": \"Creating an empty dataset\",\n        \"adding-new-layer\": \"Adding new layer\",\n        \"add-layer-error\": \"Could not add layer\",\n        \"imports\": {\n          \"ask-for-demo\": \"ask for demo\",\n          \"connector\": \"connector\",\n          \"demo-email-title\": \"I am interested in the %{name} connector\",\n          \"demo-email-desc\": \"Hi, I am interested in testing the %{name} connector. Please contact me to schedule a demo of this feature.\",\n          \"tab-options-error\": {\n            \"no-key\": \"%{name} key is not specified and the panel can't be enabled\",\n            \"not-allowed\": \"%{name} data source is not available for your plan. Please upgrade.\",\n            \"limits-reached\": \"You've reached the limits for your account. Please upgrade.\",\n            \"no-credits\": \"You've reached the available %{name} credits for your account this month.\"\n          },\n          \"member-pluralize\": \"member |||| members\",\n          \"item-pluralize\": \"item |||| items\",\n          \"form-import\": {\n            \"browse\": \"Browse\",\n            \"drag-and-drop\": \"Drag & drop your file\",\n            \"error-desc\": \"Error. Your URL doesnt look correct.\",\n            \"format\": \"Format\",\n            \"or\": \"or\",\n            \"title\": \"Enter a URL\",\n            \"desc\": \"Paste a URL and start the import\",\n            \"submit\": \"submit\"\n          },\n          \"header-import\": {\n            \"import-url\": \"Import your data from a %{brand} URL\",\n            \"file-selected\": \"File selected\",\n            \"paste-url\": \"Paste a URL %{fileEnabled} \",\n            \"select-a-file\": \"or select a file like CSV, XLS, ZIP, KML, GPX,\",\n            \"see-all-formats\": \"see all formats\",\n            \"sync-enabled\": \"Keep it synchronized with the source\",\n            \"sync-disabled\": \"Sync options are not available\",\n            \"type-selected\": \"%{brand} selected\",\n            \"type-import\": \"%{brand} import\",\n            \"upload-file-url\": \"Upload a file or a URL |||| Upload a URL\"\n          },\n          \"service-import\": {\n            \"and\": \"and\",\n            \"account-connected\": \"Account connected\",\n            \"connect-with\": \"Connect with %{title}\",\n            \"choose\": \"Choose\",\n            \"connect\": \"Connect\",\n            \"found-in\": \"%{size} %{pluralize} found in %{title}\",\n            \"item-selected\": \"Item selected\",\n            \"many-more-formats\": \"many more formats\",\n            \"no-results-title\": \"Oouch! There are no results\",\n            \"no-results-desc\": \"We haven't found any valid file from your account\",\n            \"state-idle-login\": \"Login to your account and select any item.\",\n            \"state-error\": \"We are sorry that you cant connect to your %{title} account. Be sure you have any pop-up blockers deactivated for this website.\",\n            \"state-token\": \"Checking Token.\",\n            \"state-oauth\": \"Requesting oAuth.\",\n            \"state-retrieving\": \"A list of your %{title} files will be displayed in a moment.\",\n            \"state-selected-sync\": \"You can choose when to sync the file.\",\n            \"state-selected-instagram\": \"A map containing all your georeferenced photos will be created\",\n            \"state-selected-no-sync\": \"Sync options are not available.\",\n            \"supported\": \"supported\",\n            \"try-again\": \"Try again\"\n          },\n          \"selected-state\": {\n            \"sync-my-data\": \"Sync my data\",\n            \"never\": \"Never\",\n            \"every-hour\": \"Every hour\",\n            \"every-day\": \"Every day\",\n            \"every-week\": \"Every week\",\n            \"every-month\": \"Every month\",\n            \"free-trial\": \"%{days} day free trial\",\n            \"more-features\": \"more features\",\n            \"upgrade-desc\": \"Upgrade your account to get sync options and %{features}\",\n            \"upgrade\": \"upgrade\"\n          },\n          \"twitter\": {\n            \"category\": \"Category\",\n            \"credits-consumed\": \"Twitter credits for this period consumed - %{extraTweets} will be charged\",\n            \"credits-left\": \"%{per}% of your %{remainingFormatted} Twitter credits left\",\n            \"credits-no-limit\": \"No limits - %{extraTweets} will be charged\",\n            \"extra-tweets\": \"extra tweets\",\n            \"fallback-title\": \"Enable the %{brand} connector\",\n            \"fallback-desc\": \"The %{brand} connector allows you to map %{brand} data activity related to your brand, event, or any term you may be interested in.\",\n            \"from-to\": \"From / to\",\n            \"terms-desc\": \"Enter up to four search terms using the category fields.\",\n            \"terms-placeholder\": \"Insert your terms separated by commas\",\n            \"title\": \"Twitter trends\",\n            \"twitter-gmt\": \"Time is in GMT+0\",\n            \"use\": \"Use\",\n            \"your-gmt\": \"You are in GMT\"\n          },\n          \"arcgis\": {\n            \"fallback-desc\": \"Enable the %{brand} connector in your account to connect your %{brand} data to CARTO and mantain it in sync with the source.\",\n            \"input-placeholder\": \"Paste your %{brand} table URL here\",\n            \"url-desc\": \"To retrieve a particular layer, add the layer index at the end of the URL\",\n            \"import-data\": \"Import your data from a %{brand} instance\",\n            \"sync-options\": \"Sync options only available for a layer\"\n          },\n          \"instagram\": {\n            \"fallback-desc\": \"Enable the %{brand} connector to map your photos or videos from your account in CARTO.\"\n          },\n          \"box\": {\n            \"fallback-desc\": \"Enable the %{brand} connector in your account to map your %{brand} files in CARTO or mantain your CARTO maps in sync with your Box data.\"\n          },\n          \"mailchimp\": {\n            \"campaign-selected\": \"%{brand} campaign selected\",\n            \"fallback-desc\": \"Enable the %{brand} connector in your account to map your user lists from %{brand} in CARTO or mantain your CARTO maps in sync with your %{brand} data.\",\n            \"map-campaign\": \"Map your %{brand} campaigns\",\n            \"state-idle\": \"Connect your %{brand} account to select any of your campaigns.\",\n            \"state-error\": \"We are sorry, there has been an error while connecting to your %{brand} account. Just in case it helps, be sure you have the pop-up blocker deactivated for this website.\",\n            \"state-token\": \"Checking %{brand} token.\",\n            \"state-oauth\": \"Requesting oAuth.\",\n            \"state-retrieving\": \"A list of your %{brand} campaigns will be displayed in a moment.\",\n            \"state-selected\": \"Campaign selected.\"\n          },\n          \"salesforce\": {\n            \"fallback-desc\": \"Enable the %{brand} connector in your account to map your user lists from %{brand} in CARTO or mantain your CARTO maps in sync with your %{brand} data.\",\n            \"input-placeholder\": \"Paste your %{brand} URL here\"\n          }\n        },\n        \"datasets\": {\n          \"item\": {\n            \"sync-failed\": \"Sync failed, the last attempt was\",\n            \"syncing\": \"Syncing\",\n            \"synced\": \"Synced\",\n            \"read\": \"read\",\n            \"from\": \"from\",\n            \"by\": \"by\",\n            \"no-description\": \"No description\",\n            \"rows-pluralize\": \"row |||| rows\",\n            \"tags-more\": \"and %{tagsCount} more\",\n            \"no-tags\": \"No tags\"\n          },\n          \"loading\": \"Loading\",\n          \"searching\": \"Searching\",\n          \"error\": {\n            \"title\": \"Ouch! There has been an error loading your datasets\",\n            \"desc\": \"If the problem persists contact us at\"\n          },\n          \"no-datasets\": {\n            \"title\": \"You have not connected any datasets yet\",\n            \"desc\": \"You can %{connectDataset} or %{search} in all our data library\",\n            \"connect-datasets\": \"connect datasets\",\n            \"search\": \"search\"\n          },\n          \"no-results\": {\n            \"desc\": \"There are no results in this page\",\n            \"found\": \"found\",\n            \"there-are-no\": \"There are no\",\n            \"no-fun\": \"No %{type}, no fun\"\n          }\n        },\n        \"footer\": {\n          \"guessing-desc\": \"Let CARTO automatically guess data types and content on import.\",\n          \"twitter-desc\": \"To get access to historical data (older than 30 days) you need to\",\n          \"contact-team\": \"contact our team\",\n          \"privacy-upgrade\": \"You cannot change the privacy of your new datasets. Click here to upgrade your account.\",\n          \"privacy-change\": \"Your new dataset will be %{privacy}\",\n          \"privacy-click\": \"Click to change it to %{nextPrivacy}\",\n          \"privacy-change-banned\": \"You cannot change the privacy of your new datasets.\",\n          \"add-layer\": \"Add layer\"\n        }\n      },\n      \"edit-feature\": {\n        \"confirmation\": {\n          \"title\": \"This geometry is too big to edit from the web\",\n          \"desc\": \"Editing this geometry could freeze or crash your browser, and you could lose your work. We encourage you to edit this feature through the API.\",\n          \"cancel\": \"Cancel\",\n          \"continue\": \"Ok, continue\"\n        },\n        \"delete\": {\n          \"title\": \"You are about to delete a feature\",\n          \"desc\": \"Are you sure you want to delete it?\",\n          \"cancel\": \"Cancel\",\n          \"confirm\": \"Ok, delete it\"\n        }\n      }\n    },\n    \"error\": {\n      \"default-title\": \"Oops, there was a problem\",\n      \"default-desc\": \"Reload the page again. If the problem persists contact us at <a href='mailto:support@carto.com'>support@carto.com</a>\"\n    },\n    \"backbone-forms\": {\n      \"select\": {\n        \"placeholder\": \"Select a %{keyAttr}\",\n        \"loading\": \"loading\",\n        \"empty\": \"No values\",\n        \"selected\": \"%{count} selected\"\n      },\n      \"operators\": {\n        \"count-message\": \"If you select 'COUNT' all columns are selected\"\n      },\n      \"interval-error\": \"Value must be between %{minValue} and %{maxValue}\",\n      \"copy-button\": \"COPY\",\n      \"data-observatory\": {\n        \"dropdown\": {\n          \"measurement\": {\n            \"search\": \"Search...\",\n            \"type\": \"measurements\"\n          },\n          \"filter\": {\n            \"header\": \"Filter measurements by\",\n            \"type\": \"filters\"\n          }\n        }\n      }\n    },\n    \"codemirror\": {\n      \"no-errors\": \"No errors\",\n      \"docs\": \"DOCS\",\n      \"syntax-error\": \"Syntax error\",\n      \"line\": \"Line\"\n    },\n    \"undo-redo\": {\n      \"clear\": \"CLEAR\",\n      \"apply\": \"APPLY\"\n    },\n    \"table\": {\n      \"columns\": {\n        \"change-type\": {\n          \"confirm\": \"ok, change it\",\n          \"cancel\": \"Cancel\",\n          \"desc\": \"Maps using this column will be affected and unconvertible data will be lost. Are you sure?\",\n          \"error\": \"There was an error changing %{columnName} column: %{error}\",\n          \"loading\": \"Changing %{columnName} column...\",\n          \"title\": \"%{columnName} column will change to %{newType}\",\n          \"success\": \"Column %{columnName} changed to %{newType}\"\n        },\n        \"create\": {\n          \"loading\": \"Adding new column...\",\n          \"error\": \"Error adding new column: %{error}\",\n          \"success\": \"%{columnName} column added\"\n        },\n        \"destroy\": {\n          \"cancel\": \"Cancel\",\n          \"confirm\": \"Ok, delete it\",\n          \"desc\": \"Maps using this column will be affected, are you sure you want to delete it?\",\n          \"error\": \"Error deleting %{columnName} column: %{error}\",\n          \"loading\": \"Removing your column %{columnName}...\",\n          \"success\": \"%{columnName} column deleted\",\n          \"title\": \"You are about to delete %{columnName} column \"\n        },\n        \"rename\": {\n          \"cancel\": \"Cancel\",\n          \"confirm\": \"ok, rename it\",\n          \"desc\": \"Maps using this column will be affected, are you sure you want to rename it?\",\n          \"error\": \"Error renaming column %{columnName} to %{newName}: %{error}\",\n          \"loading\": \"Renaming your column %{columnName} to %{newName}...\",\n          \"success\": \"Column %{columnName} renamed to %{newName}\",\n          \"title\": \"You are about to rename column %{columnName} to %{newName}\"\n        },\n        \"options\": {\n          \"order\": \"Order\",\n          \"rename\": \"Rename column\",\n          \"change\": \"Change data type\",\n          \"create\": \"Add new column\",\n          \"delete\": \"Delete this column...\"\n        },\n        \"types\": {\n          \"boolean\": \"Boolean\",\n          \"date\": \"Date\",\n          \"number\": \"Number\",\n          \"string\": \"String\"\n        }\n      },\n      \"rows\": {\n        \"loading\": {\n          \"title\": \"Loading rows...\"\n        },\n        \"error\": {\n          \"title\": \"There was an error...\",\n          \"desc\": \"It was not possible to obtain any results, check the query applied\"\n        },\n        \"result\": {\n          \"no-page-title\": \"Ouch! Sorry\",\n          \"no-page-desc\": \"This page %{page} doesn't contain any results...\",\n          \"no-results-title\": \"There is no data\",\n          \"no-results-desc\": \"\",\n          \"no-results-button\": \"\"\n        },\n        \"options\": {\n          \"copy\": \"Copy cell value\",\n          \"create\": \"Add new row\",\n          \"edit\": \"Edit this cell\",\n          \"delete\": \"Delete this row...\"\n        },\n        \"create\": {\n          \"loading\": \"Adding new row...\",\n          \"error\": \"Error adding new row: %{error}\",\n          \"success\": \"New row added\"\n        },\n        \"edit\": {\n          \"loading\": \"Editing %{attribute} with cartodb_id %{cartodbId}...\",\n          \"error\": \"Error editing %{attribute} with cartodb_id %{cartodbId}: %{error}\",\n          \"success\": \"Edited %{attribute} with cartodb_id %{cartodbId}\"\n        },\n        \"destroy\": {\n          \"cancel\": \"Cancel\",\n          \"confirm\": \"ok, delete\",\n          \"desc\": \"Are you sure you want to delete it?\",\n          \"error\": \"Error deleting row with cartodb_id %{cartodb_id}: %{error}\",\n          \"loading\": \"Removing your row with cartodb_id %{cartodb_id}...\",\n          \"success\": \"Row with cartodb_id %{cartodb_id} deleted\",\n          \"title\": \"You are about to delete row with cartodb_id %{cartodb_id}\"\n        },\n        \"paginator\": {\n          \"error\": \"There was an error with pagination: %{error}\",\n          \"to\": \"to\"\n        }\n      }\n    }\n  },\n  \"dataset\": {\n    \"sql\": \"SQL\",\n    \"data\": \"Metadata\",\n    \"updated\": \"Updated %{ago}\",\n    \"read\": \"Read\",\n    \"options\": {\n      \"add-row\": \"Add row\",\n      \"add-column\": \"Add column\",\n      \"export\": \"Export\"\n    },\n    \"preview-map\": {\n      \"preview\": \"preview\",\n      \"back\": \"back\"\n    },\n    \"create-map\": {\n      \"title\": \"Create map\",\n      \"loading\": \"Creating a map from %{tableName}\",\n      \"error\": \"There was an error creating the map\"\n    },\n    \"delete\": {\n      \"option\": \"Delete dataset...\",\n      \"cancel\": \"Cancel\",\n      \"confirm\": \"Ok, delete it\",\n      \"desc\": \"The deleted dataset cannot be recovered, be sure before proceeding. We recommend you to export your dataset before deleting it.\",\n      \"error\": \"Error deleting %{tableName}: %{error}\",\n      \"loading\": \"Deleting your dataset %{tableName}...\",\n      \"title\": \"You are about to delete the %{tableName} dataset\",\n      \"affected-vis-count\": \"%{smart_count} map affected |||| %{smart_count} maps affected\",\n      \"affected-vis-count-extended\": \"%{affectedVisCount} maps affected, some of them are\",\n      \"affected-entities-count\": \"%{smart_count} user will lose access |||| %{smart_count} users will lose access\",\n      \"affected-entities-count-extended\": \"%{affectedEntitiesCount} users will lose access, some of them are\",\n      \"whole-organization-affected\": \"All users from your organization will be affected\"\n    },\n    \"metadata\": {\n      \"option\": \"Edit metadata\",\n      \"error\": \"There was an error edititng metadata of your dataset %{name}\",\n      \"loading\": \"Editing metadata of your dataset %{name}...\"\n    },\n    \"duplicate\": {\n      \"option\": \"Duplicate dataset\",\n      \"query\": \"applied query\",\n      \"customOption\": \"Create Dataset from query\",\n      \"error\": \"There was an error duplicating %{name}\",\n      \"loading\": \"Duplicating your dataset %{name}...\"\n    },\n    \"lock\": {\n      \"option\": \"Lock dataset\",\n      \"error\": \"There was an error locking %{tableName}\",\n      \"loading\": \"Locking your dataset %{tableName}...\"\n    },\n    \"rename\": {\n      \"option\": \"Rename dataset\",\n      \"cancel\": \"Cancel\",\n      \"confirm\": \"ok, rename it\",\n      \"desc\": \"If you are accessing this dataset via API, don't forget to use the new name in your API calls afterwards.\",\n      \"error\": \"Error renaming %{tableName}: %{error}\",\n      \"loading\": \"Renaming your dataset %{tableName}...\",\n      \"success\": \"Dataset %{tableName} renamed\",\n      \"title\": \"Renaming %{tableName} will affect your API calls, maps, analyses, ...\"\n    },\n    \"sync\": {\n      \"in-a-moment\": \"in a few moments\",\n      \"synced\": \"Synced %{ranAt}\",\n      \"syncing\": \"Syncing\",\n      \"loading\": \"Syncing dataset %{tableName}\",\n      \"sync-failed\": \"Sync failed\",\n      \"next\": \"Next will be %{runAt}\",\n      \"error-code\": \"Error code %{errorCode}\",\n      \"sync-now\": \"Sync now\",\n      \"view-options\": \"View options\",\n      \"disabled\": \"You will be able to sync manually %{gap} minutes after your last synchronization\",\n      \"title\": \"Sync dataset options\",\n      \"desc\": \"Your dataset is in sync with a %{service} file: <br/>%{url}\",\n      \"label\": \"Sync my data\",\n      \"error\": \"There was an error setting the interval\",\n      \"confirm\": \"Save\",\n      \"cancel\": \"Cancel\"\n    },\n    \"unlock\": {\n      \"cancel\": \"back to dashboard\",\n      \"confirm\": \"ok, unlock it\",\n      \"desc\": \"That means you need to unlock it before doing anything. Are you sure?\",\n      \"error\": \"Error unlocking %{tableName}: %{error}\",\n      \"loading\": \"Unlocking your dataset %{tableName}...\",\n      \"success\": \"Dataset %{tableName} unlocked\",\n      \"title\": \"Your dataset %{tableName} is locked.\"\n    }\n  },\n  \"editor\": {\n    \"map\": \"map\",\n    \"map_name\": \"%{name} map\",\n    \"published\": \"Published %{when}\",\n    \"unpublished\": \"Map not published yet\",\n    \"map_pluralize\": \"%{smart_count} map |||| %{smart_count} maps\",\n    \"button_add\": \"Add\",\n    \"button_share\": \"SHARE\",\n    \"unpublished-changes\": \"Unpublished changes\",\n    \"error-query\": {\n      \"body\": \"Errors found in your SQL query. %{action} before continuing.\",\n      \"label\": \"Fix them\"\n    },\n    \"settings\": {\n      \"menu-tab-pane-labels\": {\n        \"preview\": \"Preview\",\n        \"snapshots\": \"Snapshots\"\n      },\n      \"preview\": {\n        \"mode\": {\n          \"title\": \"Mode\"\n        },\n        \"options\": {\n          \"title\": \"Map Options\",\n          \"subtitle\": \"Components that are shown in the map\",\n          \"description\": {\n            \"title\": \"Components\",\n            \"subtitle\": \"Change map elements\"\n          },\n          \"elements\": {\n            \"search\": \"Search box\",\n            \"zoom\": \"Zoom controls\",\n            \"fullscreen\": \"Fullscreen\",\n            \"scrollwheel\": \"Scroll wheel zoom\",\n            \"layer_selector\": \"Layer selector\",\n            \"logo\": \"CARTO Logo\",\n            \"widgets\": \"Widgets column\",\n            \"legends\": \"Legends\",\n            \"dashboard_menu\": \"Show toolbar\"\n          }\n        }\n      }\n    },\n    \"maps\": {\n      \"options\": {\n        \"duplicate\": \"Duplicate\",\n        \"edit-metadata\": \"Edit metadata\",\n        \"export-image\": \"Export image\",\n        \"export-map\": \"Download map\",\n        \"remove\": \"Delete map\",\n        \"rename\": \"Rename\"\n      },\n      \"duplicate\": {\n        \"error\": \"There was an error duplicating %{name}\",\n        \"loading\": \"Duplicating your map %{name}...\"\n      },\n      \"delete\": {\n        \"confirm\": \"Ok, delete it\",\n        \"cancel\": \"Cancel\",\n        \"desc\": \"The deleted map cannot be recovered, be sure before proceeding.\",\n        \"title\": \"You are about to delete map %{name}\",\n        \"error\": \"Error deleting map %{name}: %{error}\",\n        \"loading\": \"Removing the map %{name}...\",\n        \"success\": \"Map %{name} deleted\"\n      },\n      \"export-image\": {\n        \"title\": \"Export as image\",\n        \"export\": \"Export\",\n        \"generating\": \"Generating\",\n        \"disclaimer\": {\n          \"title\": \"Disclaimer\",\n          \"body\": \"Legends and widgets won't be exported as part of the image\"\n        },\n        \"download\": \"Download\",\n        \"errors\": {\n          \"try-again\": \"Please, try again. If the problem persists, contact support\",\n          \"error-attribution\": \"Error generating attribution.\",\n          \"error-basemap\": \"Error loading basemap.\",\n          \"error-image\": \"Error generating image.\"\n        }\n      },\n      \"export\": {\n        \"confirmation\": {\n          \"confirm\": \"Download\",\n          \"cancel\": \"Cancel\",\n          \"desc\": \"This map, and the connected data, will be downloaded as a .carto file\",\n          \"title\": \"Download \\\"%{name}\\\"\"\n        },\n        \"download\": {\n          \"confirm\": \"Download\",\n          \"tip\": \"Tip: Allow pop-ups from CARTO in your web browser.\",\n          \"desc\": \"Click Download to begin the .carto file download.\",\n          \"title\": \"Ready to Download\"\n        },\n        \"error\": {\n          \"title\": \"An error occured while exporting your map\",\n          \"desc\": \"Please try again. If the problem persists, please contact support\"\n        }\n      },\n      \"rename\": {\n        \"loading\": \"Renaming map...\",\n        \"success\": \"Map renamed to %{name}\",\n        \"error\": \"Error renaming map %{name}: %{error}\"\n      }\n    },\n    \"tab-pane\": {\n      \"layers\": {\n        \"title-label\": \"Layers\",\n        \"georeference\": {\n          \"title\": \"Layer not georeferenced\",\n          \"body\": \"The layer <span class='CDB-Text is-semibold'>%{name}</span> include non-georeferenced data.\"\n        }\n      },\n      \"elements\": {\n        \"title-label\": \"Elements\"\n      },\n      \"widgets\": {\n        \"title-label\": \"Widgets\"\n      }\n    },\n    \"elements\": {\n      \"message\": \"Unfortunately, map overlays are not available yet, but they will be very soon. Stay tuned!\"\n    },\n    \"layers\": {\n      \"options\": {\n        \"rename\": \"Rename\",\n        \"delete\": \"Delete layer\",\n        \"collapse\": \"Collapse\",\n        \"expand\": \"Expand\",\n        \"export\": \"Export data\",\n        \"hide\": \"Hide layer\",\n        \"show\": \"Show layer\",\n        \"edit\": \"Edit layer\",\n        \"center-map\": \"Center map on layer\"\n      },\n      \"drag-n-drop-analysis\": {\n        \"upgrade-max-layers-err\": \"%{a_start}Upgrade your account%{a_end} to add more than %{userMaxLayers} layers to your maps.\"\n      },\n      \"rename\": {\n        \"loading\": \"Renaming layer\",\n        \"success\": \"Layer renamed to %{name}\",\n        \"error\": \"<span class='u-errorTextColor'>Error renaming layer</span> %{name}: %{error}\"\n      },\n      \"moveTorqueLayer\": {\n        \"loading\": \"Moving torque layer to first position...\",\n        \"success\": \"Layer moved\",\n        \"error\": \"Error moving the layer...\"\n      },\n      \"delete\": {\n        \"confirm\": \"Ok, delete it\",\n        \"cancel\": \"Cancel\",\n        \"desc\": \"<span class='CDB-Text u-mainTextColor is-semibold'>%{layerVisName}</span> will be affected, are you sure you want to delete it?\",\n        \"title\": \"You are about to delete the layer %{layerName}\",\n        \"error\": \"<span class='u-errorTextColor'>Error deleting layer</span>: %{error}\",\n        \"loading\": \"Removing layer\",\n        \"success\": \"Layer deleted correctly.\",\n        \"widgets\": \"one widget |||| %{smart_count} widgets\",\n        \"analyses\": \"one analysis |||| %{smart_count} analyses\",\n        \"layers\": \"one layer |||| %{smart_count} layers\",\n        \"affected-items\": \"Deleting this layer affects\",\n        \"and\": \"and\",\n        \"link-to-export\": \"Before deleting the layer, you can <a href='#' data-event='exportMapAction'>export as .CARTO file</a>\"\n      },\n      \"layer\": {\n        \"animated\": \"Animated\",\n        \"heatmap\": \"Pixel\",\n        \"analysis\": \"Analysis\",\n        \"add-analysis\": \"Add analysis\",\n        \"analyses-count\": \"%{smart_count} Analysis |||| %{smart_count} Analyses\",\n        \"widgets-count\": \"%{smart_count} Widget |||| %{smart_count} Widgets\",\n        \"add-layer\": \"Add layer\",\n        \"delete\": \"Delete\",\n        \"cancel-delete-analysis\": \"Cancel\"\n      },\n      \"basemap\": {\n        \"remove-baselayer\": \"Remove baselayer\",\n        \"custom-basemap\": \"Custom basemap\",\n        \"title-label\": \"Basemap\",\n        \"by\": \"by\",\n        \"category\": {\n          \"title-label\": \"Source\",\n          \"select-category\": \"Select source\"\n        },\n        \"style\": {\n          \"title-label\": \"Style\",\n          \"select-style\": \"Select style\",\n          \"color\": \"Color\"\n        },\n        \"saving\": {\n          \"loading\": \"Saving new basemap...\",\n          \"error\": \"Error saving new basemap.\",\n          \"success\": \"Basemap saved successfully.\"\n        }\n      },\n      \"labels\": {\n        \"title-label\": \"Labels\"\n      },\n      \"color\": {\n        \"title-label\": \"Color\"\n      },\n      \"image\": {\n        \"title-label\": \"Image\"\n      },\n      \"gmaps\": {\n        \"title-label\": \"Google Maps\"\n      },\n      \"menu-tab-pane-labels\": {\n        \"data\": \"Data\",\n        \"analyses\": \"Analysis\",\n        \"style\": \"Style\",\n        \"infowindow\": \"Pop-up\",\n        \"legends\": \"Legend\"\n      },\n      \"infowindow-menu-tab-pane-labels\": {\n        \"click\": \"Click\",\n        \"hover\": \"Hover\"\n      },\n      \"analysis-form\": {\n        \"merge-type\": {\n          \"left\": \"Returns all rows from #1, with the matching rows in #2 or NULL when there is no match.\",\n          \"inner\": \"Returns the result of #1 intersecting #2 (i.e. the inner part of a Venn diagram intersection)\"\n        },\n        \"admin-region\": \"Admin. Region\",\n        \"aggregate\": \"Aggregate\",\n        \"aggregate-by\": \"Aggregate by\",\n        \"aggregate-by-help\": \"Will calculate aggregate values for each centroid\",\n        \"aggregate-column\": \"Aggregate column\",\n        \"all-to-all\": \"All to all\",\n        \"allow-holes\": \"Allow holes\",\n        \"apply-btn\": \"Apply\",\n        \"asc\": \"ASC\",\n        \"bicycle\": \"Bicycle\",\n        \"boundaries\": \"Boundaries\",\n        \"bounding-box\": \"Bounding Box\",\n        \"bounding-circle\": \"Bounding Circle\",\n        \"by\": \"By\",\n        \"by-bike\": \"bike\",\n        \"by-car\": \"car\",\n        \"by-walk\": \"walk\",\n        \"car\": \"Car\",\n        \"categorize-by\": \"Categorize by\",\n        \"categorize-by-help\": \"If selected a centroid will be found for each category\",\n        \"category-column\": \"Category column\",\n        \"city\": \"City\",\n        \"clusters-num\": \"# of clusters\",\n        \"column\": \"Column\",\n        \"columns\": \"Columns\",\n        \"concave-hull\": \"Concave Hull\",\n        \"confirm-analysis\": \"Confirm\",\n        \"convex-hull\": \"Convex Hull\",\n        \"country\": \"Country\",\n        \"create-btn\": \"Apply\",\n        \"data-observatory-measurement-area\": \"Country\",\n        \"data-observatory-measurement-column\": \"New col. name\",\n        \"data-observatory-measurement-column-help\": \"Adds a new column to your layer to store result\",\n        \"data-observatory-measurement-desc\": \"enrich your data\",\n        \"data-observatory-measurement-measurement\": \"Measurement\",\n        \"data-observatory-measurement-refine\": \"Choose a measure\",\n        \"data-observatory-measurement-segments\": \"Segments\",\n        \"define-columns\": \"Define column to find similarities with\",\n        \"define-reference-and-target\": \"Define reference and target layers\",\n        \"define-two-layers\": \"Define two layers\",\n        \"denominator\": \"Denominator\",\n        \"denominator-help\": \"A column to normalize the target column\",\n        \"deprecated-sql-function\": {\n          \"choose-function\": \"Choose the function to run on this node\",\n          \"choose-function-small\": \"Choose function\",\n          \"define-params\": \"define your parameters below\",\n          \"function\": \"function\",\n          \"input\": \"input\",\n          \"params\": \"Your Function's Parameters\",\n          \"target\": \"target node\",\n          \"title\": \"SQL Function\"\n        },\n        \"desc\": \"DESC\",\n        \"direction\": \"Direction\",\n        \"disabled-by-config\": \"This analysis type is disabled\",\n        \"dissolved\": \"Dissolved\",\n        \"dissolved-help\": \"Combine polygons tracts which have equal ranges\",\n        \"distance\": \"Distance\",\n        \"enter-latitude\": \"Enter latitude\",\n        \"enter-longitude\": \"Enter longitude\",\n        \"filter\": \"Filter\",\n        \"filter-aggregate\": \"Aggregate your results\",\n        \"filter-column\": \"Filter column\",\n        \"foreign-keys\": \"Foreign Keys\",\n        \"geometry-from\": \"Geometry from\",\n        \"georeference\": {\n          \"postal-code-help\": \"Select a column with postal codes\",\n          \"admin-region-help\": \"Select a column with region names\",\n          \"admin-region-extended-help\": \"Specify an admin. region or select a column with region names\",\n          \"admin-region\": \"Admin. Regions\",\n          \"city-help\": \"Select a column with city names\",\n          \"city-extended-help\": \"Specify a city or select a column with city names\",\n          \"city\": \"Cities\",\n          \"country-help\": \"Select a column with country names\",\n          \"country-extended-help\": \"Specify a country or select a column with country names\",\n          \"country\": \"Countries\",\n          \"enter-city-name\": \"Or enter city name\",\n          \"enter-country-name\": \"Or enter country name\",\n          \"enter-region-name\": \"Or enter region name\",\n          \"enter-state-name\": \"Or enter state name\",\n          \"ip-address-column\": \"IP Address\",\n          \"ip-address-help\": \"Select a column with IP addresses\",\n          \"ip-address\": \"IP Addresses\",\n          \"long-lat\": \"Longitude and Latitude\",\n          \"postal-code\": \"Postal Codes\",\n          \"select-a-country\": \"Select a country column\",\n          \"select-admin\": \"Select a region column\",\n          \"select-city\": \"Select a city column\",\n          \"select-country\": \"Select country column\",\n          \"select-ip\": \"Select an IP column\",\n          \"select-latitude\": \"Select a latitude column\",\n          \"select-longitude\": \"Select a longitude column\",\n          \"select-postal-code\": \"Select a postal code column\",\n          \"select-state\": \"Select state column\",\n          \"select-street-address\": \"Select an address column\",\n          \"state-help\": \"Specify a state or select a column with state names\",\n          \"street-address-column\": \"Street Address\",\n          \"street-address-column-help\": \"Select a column with street addresses\",\n          \"street-address-help\": \"Use columns or free text to compose your address schema. <a href='https://carto.com/learn/guides/analysis/geocode-street-addresses-into-point-geometries' target='_blank'>More info.</a>\",\n          \"street-address\": \"Street Addresses\",\n          \"advance\": \"Advanced mode\",\n          \"normal\": \"Normal mode\"\n        },\n        \"group-by\": \"Group by\",\n        \"hide\": \"Hide\",\n        \"inner\": \"Inner\",\n        \"input\": \"Input\",\n        \"input-layer\": \"Define your input layer\",\n        \"input-num\": \"Input #%{num}\",\n        \"intact\": \"Intact\",\n        \"intact-help\": \"Keep all polygon tracts as individual polygons\",\n        \"join-type\": \"Join Type\",\n        \"keep-columns\": \"Select the columns you want to keep\",\n        \"key-columns\": \"Key columns\",\n        \"key-columns-desc\": \"Choose similar columns to relate them\",\n        \"kilometers\": \"km\",\n        \"latitude\": \"Latitude\",\n        \"left\": \"Left\",\n        \"line-sequential\": \"Sequential\",\n        \"line-source-to-target\": \"To Source\",\n        \"line-to-column\": \"To Column\",\n        \"line-to-single-point\": \"To Single Point\",\n        \"link-layer\": \"Link to col.\",\n        \"link-layer-desc\": \"Specify a second layer to filter by\",\n        \"linked-layer\": \"Filter by layer\",\n        \"loading\": \"loading\",\n        \"longitude\": \"Longitude\",\n        \"max\": \"Max\",\n        \"measure-by\": \"Measure by\",\n        \"meters\": \"m\",\n        \"method\": \"Method\",\n        \"miles\": \"mi\",\n        \"min\": \"Min\",\n        \"mode\": \"Mode\",\n        \"find-nearest\": {\n          \"categorized\": \"Per group\",\n          \"categorized-help\": \"Calculate results per each category of the chosen column\",\n          \"criteria\": \"Select the target point layer\",\n          \"define-params\": \"Define your parameters\",\n          \"define-params-desc\": \"Define and categorize the number of results\",\n          \"input\": \"input\",\n          \"max-results\": \"max results\",\n          \"modal-desc\": \"Find nearest analysis locates the closest points between two tables.\",\n          \"modal-title\": \"Find nearest\",\n          \"target\": \"target\",\n          \"title\": \"Find nearest\"\n        },\n        \"neighbors\": \"Neighbors\",\n        \"neighbors-help\": \"Define the local neighborhood as this many nearest-neighbors\",\n        \"no\": \"No\",\n        \"no-coincidence\": \"When no coincidence no row will be added\",\n        \"should-match\": \"Column types should match\",\n        \"numerator\": \"Target column\",\n        \"numerator-help\": \"Measure spatial autocorrelation of this column\",\n        \"operation\": \"Operation\",\n        \"order\": \"Order\",\n        \"order-by\": \"Order by\",\n        \"order-results\": \"Order your results\",\n        \"parameters\": \"Parameters\",\n        \"parameters-description\": \"Tune your analysis\",\n        \"permutations\": \"Permutations\",\n        \"placeholder-text\": \"You have not added any analysis yet. Add an analysis to discover new things.\",\n        \"points_source\": \"Point source\",\n        \"polygons_source\": \"Polygon source\",\n        \"postal-code\": \"Postal Code\",\n        \"quota\": {\n          \"title\": \"confirm your analysis\",\n          \"loading\": \"Obtaining your quotas...\",\n          \"credits-left-body\": \"This might incur into an extra cost. Extra credits will be charged at $%{blockPrice}/%{blockSize}.\",\n          \"credits-left-message\": \"%{smart_count} credit left |||| %{smart_count} credits left\",\n          \"enough-quota\": \"You need to use approximately %{credits} of your credits.\",\n          \"hard-limit-not-enough-quota\": \"We're sorry the current quota is insufficient to enrich your data. Rows will be set to null and analysis may not complete. Please %{contact} us to extend your quota for this function.\",\n          \"soft-limit-enough-quota\": \"We're sorry the current quota is insufficient to enrich your data. This might need about %{credits} extra credits. Extra credits will be charged at $%{blockPrice}/%{blockSize}.\",\n          \"no-quota-assigned-body\": \"To get access to the %{analysis} function, %{contact}.\",\n          \"no-credits-body\": \"You have consumed all your credits during this billing cycle. %{contact} to get some more.\",\n          \"no-credits-message\": \"No credits available\",\n          \"contact-message\": {\n            \"no-credits\": {\n              \"regular\": \"Contact us\",\n              \"organization\": \"Contact your organization admin\"\n            },\n            \"no-quota-assigned\": {\n              \"regular\": \"contact our team\",\n              \"organization\": \"contact your organization admin\"\n            }\n          },\n          \"emails\": {\n            \"support\": \"support@carto.com\",\n            \"saas\": \"sales@carto.com\"\n          },\n          \"quota-error-title\": \"Error\",\n          \"quota-fetch-error\": \"There was an error obtaining your quota: %{error}.\",\n          \"quota-dataservice-down\": \"Dataservices API unreacheable.\",\n          \"cancel\": \"Cancel\",\n          \"confirm\": \"confirm\",\n          \"analysis-type\": {\n            \"routing\": \"Routing\",\n            \"trade-area\": \"Trade area\",\n            \"georeference-street-address\": \"Georeference street address\",\n            \"data-observatory-measure\": \"Data Observatory\"\n          }\n        },\n        \"public_transport\": \"Public transport\",\n        \"radius\": \"Distance\",\n        \"reference-layer-pluralize\": \"Define your reference layer |||| Define your reference layers\",\n        \"result\": \"Result\",\n        \"right\": \"Right\",\n        \"sampling\": \"Sampling\",\n        \"sampling-desc\": \"Select a sample of the data\",\n        \"sampling-rate\": \"% of data \",\n        \"search-by-column-name\": \"Search by column name\",\n        \"second-geom-required\": \"This analysis requires a second geometry column\",\n        \"select-column\": \"Select a column\",\n        \"select-type\": \"Select data type\",\n        \"setup-analysis\": \"Setup analysis\",\n        \"show\": \"Show\",\n        \"significance\": \"Significance\",\n        \"significance-help\": \"Filter outliers and clusters to this significance. Smaller numbers are more significant.\",\n        \"source\": \"Source\",\n        \"source-col\": \"Source col.\",\n        \"source-column\": \"Source column\",\n        \"spatial-markov-trend-desc\": \"select a column for each time period\",\n        \"spatial-markov-trend-time-columns\": \"Input columns\",\n        \"spatial-markov-trend-time-columns-help\": \"Each column should contain values for a time period\",\n        \"state\": \"State\",\n        \"target\": \"Target\",\n        \"target-layer\": \"Target layer\",\n        \"intersection-layer\": \"Intersect layer\",\n        \"filtering-layer\": \"Filtering layer\",\n        \"base-layer\": \"Base layer\",\n        \"target-col\": \"Target col.\",\n        \"target-column\": \"Target column\",\n        \"target-percent\": \"Target percent\",\n        \"target-percent-help\": \"Convex hull lookalike\",\n        \"time\": \"Time\",\n        \"time-seconds\": \"Time (Seconds)\",\n        \"to-closest\": \"To closest\",\n        \"top-range\": \"Top range\",\n        \"tracts\": \"Tracts\",\n        \"tracts-help\": \"Number of AOIs evenly spaced between 0 and RADIUS\",\n        \"tune-analysis\": \"Tune your analysis\",\n        \"tune-centroid\": \"Tune your centroid\",\n        \"tune-clusters\": \"Tune your clusters\",\n        \"units\": \"Units\",\n        \"type\": \"Type\",\n        \"value\": \"Value\",\n        \"value-aggregation\": \"Value aggregation\",\n        \"value-aggregation-desc\": \"Aggregate the desired value in your polygon(s)\",\n        \"value-aggregation-centroids\": \"Aggregate the desired value in your centroid(s)\",\n        \"valid-type\": \"This kind of data is not valid for this type\",\n        \"walk\": \"Walk\",\n        \"weight\": \"Weight\",\n        \"weight-column\": \"Weight column\",\n        \"weight-type\": \"Weight type\",\n        \"weighted-by\": \"Weighted by\",\n        \"weighted-by-help\": \"Weights contribution by a value for each point\",\n        \"workflow\": \"Your workflow\",\n        \"write-max-value\": \"Write max value\",\n        \"write-min-value\": \"Write min value\",\n        \"yes\": \"Yes\"\n      },\n      \"infowindow\": {\n        \"select-fields\": \"Select fields\",\n        \"no-fields\": \"You havent selected any fields to be shown in the popup.\",\n        \"placeholder-interactivity-text\": \"Popups are disabled because interactivity is not available for this layer.\",\n        \"placeholder-columns-text\": \"Popups are disabled because there are no columns available for this layer.\",\n        \"placeholder-geometry\": \"There's no geometry in your data to add a popup.\",\n        \"style\": {\n          \"title-label\": \"Style\",\n          \"select-style\": \"Select style\",\n          \"window-size\": \"Window size\",\n          \"header-color\": \"Header color\",\n          \"none\": \"None\",\n          \"custom\": \"Custom\",\n          \"infowindow_light\": \"Light\",\n          \"infowindow_dark\": \"Dark\",\n          \"infowindow_color\": \"Color\",\n          \"infowindow_header_with_image\": \"Image\"\n        },\n        \"items\": {\n          \"title-label\": \"Show items\",\n          \"description\": \"Add items\"\n        }\n      },\n      \"tooltip\": {\n        \"style\": {\n          \"none\": \"None\",\n          \"custom\": \"Custom\",\n          \"tooltip_light\": \"Light\",\n          \"tooltip_dark\": \"Dark\"\n        },\n        \"items\": {\n          \"title-label\": \"Show items\",\n          \"description\": \"Add items\"\n        }\n      },\n      \"filter-options\": {\n        \"top\": \"Top\",\n        \"bottom\": \"Bottom\",\n        \"between\": \"Between\",\n        \"is-equal-to\": \"Is equal to\",\n        \"is-greater-than\": \"Is greater than\",\n        \"is-less-than\": \"Is less than\"\n      },\n      \"notifier\": {\n        \"center-map\": {\n          \"loading\": \"Calculating coordinates...\",\n          \"success\": \"Map centered\",\n          \"error\": \"Error centering map\"\n        }\n      },\n      \"georeference\": {\n        \"manually-add\": \"Please georeference or manually add data to visualize.\",\n        \"georeference-button\": \"Georeference\",\n        \"visualize\": \"Layer doesn't have geometry\"\n      }\n    },\n    \"data\": {\n      \"no-geometry-data\": \"Your dataset doesn't contain any geometry data.\",\n      \"stats\": {\n        \"add-widget\": \"Add as a widget\",\n        \"edit\": \"EDIT\",\n        \"top-cat\": \"% in top 10 cat.\",\n        \"trues\": \"% true\",\n        \"null\": \"% null\",\n        \"number-of\": \"%{geometry} count\",\n        \"geometry-fallback\": \"features\"\n      },\n      \"data-toggle\": {\n        \"values\": \"VALUES\",\n        \"cartocss\": \"SQL\"\n      },\n      \"code-mirror\": {\n        \"tip\": \"CMD + S to apply your query. CTRL + Space to autocomplete.\"\n      },\n      \"notifier\": {\n        \"sql-alter-loading\": \"Modifying table\",\n        \"sql-alter-error\": \"Error in SQL query.\",\n        \"sql-alter-success\": \"Modification applied.\",\n        \"sql-applying\": \"Applying query\",\n        \"sql-error\": \"Error in SQL query.\",\n        \"sql-success\": \"SQL query applied.\"\n      },\n      \"messages\": {\n        \"sql-readonly\": {\n          \"title\": \"SQL READ-ONLY\",\n          \"body\": \"You just applied an analysis to this layer. The SQL is now read- only.\",\n          \"accept\": \"CLOSE\"\n        },\n        \"empty-data\": {\n          \"title\": \"NO DATA AVAILABLE\",\n          \"body\": \"There is no data available to be displayed.\"\n        }\n      }\n    },\n    \"infowindow\": {\n      \"apply\": \"APPLY\",\n      \"html-toggle\": {\n        \"values\": \"VALUES\",\n        \"html\": \"HTML\"\n      },\n      \"code-mirror\": {\n        \"save\": \"CMD + S to apply your html.\",\n        \"errors\": {\n          \"empty\": \"Template can't be empty.\"\n        }\n      },\n      \"messages\": {\n        \"custom-html-applied\": {\n          \"title\": \"CUSTOM HTML APPLIED\",\n          \"body\": \"You just applied custom html with HTML editor. You can continue and clean all html.\",\n          \"accept\": \"CONTINUE\"\n        },\n        \"layer-hidden\": {\n          \"title\": \"LAYER HIDDEN\",\n          \"body\": \"This layer is hidden, changes will not be shown until you make it visible.\",\n          \"show\": \"SHOW\"\n        }\n      }\n    },\n    \"export-image\": {\n      \"invalid-dimension\": \"Invalid dimension (%{limit}x%{limit}px)\",\n      \"properties\": {\n        \"width\": \"width\",\n        \"height\": \"height\",\n        \"size\": \"Size\",\n        \"size-subtitle\": \"Manually enter the image size\",\n        \"format\": \"Format\",\n        \"format-subtitle\": \"Choose a lossless (PNG) or lossy (JPG) format\",\n        \"options\": \"Options\",\n        \"options-subtitle\": \"Configure display options\"\n      }\n    },\n    \"legend\": {\n      \"no-geometry-data\": \"There's no geometry in your data to add a legend.\",\n      \"data-toggle\": {\n        \"values\": \"VALUES\",\n        \"html\": \"HTML\"\n      },\n      \"code-mirror\": {\n        \"save\": \"CMD + S to apply your html.\",\n        \"errors\": {\n          \"empty\": \"Template can't be empty.\"\n        },\n        \"pre-html\": \"<!-- insert your custom html code above this line -->\",\n        \"post-html\": \"<!-- insert your custom html code below this line -->\"\n      },\n      \"menu-tab-pane-labels\": {\n        \"color\": \"color\",\n        \"size\": \"size\"\n      },\n      \"messages\": {\n        \"custom-legend\": {\n          \"title\": \"CUSTOM LEGEND APPLIED\",\n          \"body\": \"You just applied custom html with HTML editor. You can continue and clean all html.\",\n          \"accept\": \"Delete custom html\"\n        },\n        \"layer-hidden\": {\n          \"title\": \"LAYER HIDDEN\",\n          \"body\": \"This layer is hidden. Changes won't be shown until you make it visible.\",\n          \"show\": \"SHOW\"\n        },\n        \"legends-disabled\": {\n          \"title\": \"LEGENDS DISABLED\",\n          \"body\": \"The legends setting is disabled. Changes made will not be shown until you enable legends.\",\n          \"show\": \"ENABLE\"\n        }\n      },\n      \"types\": {\n        \"none\": \"none\",\n        \"category\": \"category\",\n        \"gradient\": \"gradient\",\n        \"bubble\": \"bubble\",\n        \"custom\": \"custom\"\n      },\n      \"legend-form\": {\n        \"type\": {\n          \"title\": \"Select Style\"\n        },\n        \"properties\": {\n          \"title\": \"Creating your legend\",\n          \"subtitle\": \"Add items\"\n        },\n        \"add\": \"Add item\",\n        \"title\": \"Title\",\n        \"fill\": \"Fill\",\n        \"by-size\": \"By Size\",\n        \"by-color\": \"By Color\",\n        \"untitled\": \"Untitled\",\n        \"prefix\": \"Prefix\",\n        \"suffix\": \"Suffix\",\n        \"left-label\": \"Left Label\",\n        \"right-label\": \"Right Label\",\n        \"top-label\": \"Top Label\",\n        \"bottom-label\": \"Bottom Label\",\n        \"custom-label-placeholder\": \"Override dynamic value\"\n      },\n      \"pixel-title\": \"Amount\"\n    },\n    \"style\": {\n      \"types\": {\n        \"none\": \"-\",\n        \"simple\": \"none\",\n        \"hexabins\": \"hexbins\",\n        \"squares\": \"squares\",\n        \"regions\": \"Adm. Regions\",\n        \"heatmap\": \"pixel\",\n        \"animation\": \"animated\"\n      },\n      \"style-form\": {\n        \"type\": {\n          \"title-label\": \"Aggregation\"\n        },\n        \"aggregation\": {\n          \"title-label\": \"Aggregation Options\",\n          \"desc\": \"Configure how the aggregation works\"\n        },\n        \"properties\": {\n          \"title-label-point\": \"Style\",\n          \"title-label-line\": \"Lines style\",\n          \"title-label-polygon\": \"Polygons style\",\n          \"placeholder-text\": \"There's no geometry in your data that could be styled.\",\n          \"georeference\": \"Georeference\",\n          \"desc\": \"Change the visualization\"\n        },\n        \"unanimatable\": {\n          \"desc\": \"Not any numeric or date column found in your data.\",\n          \"body\": \"You can change your column's type in the %{link}.\",\n          \"label\": \"table view\"\n        }\n      },\n      \"code-mirror\": {\n        \"save\": \"CMD + S to apply your styles.\"\n      },\n      \"style-toggle\": {\n        \"values\": \"VALUES\",\n        \"cartocss\": \"CARTOCSS\"\n      },\n      \"messages\": {\n        \"fetched\": \"Schema fetched, select a style\",\n        \"fetching\": \"Schema is being fetched, when it is done, different styles will be avaiable\",\n        \"unavailable\": \"There was a problem getting schema, try to reload\",\n        \"none\": \"Your styles were reset, choose new styles for your layer, or go back to your previous style.\",\n        \"cartocss-applied\": {\n          \"title\": \"CARTOCSS APPLIED\",\n          \"body\": \"You just applied styles with CartoCSS. You can continue or clear all styles.\",\n          \"continue\": \"CONTINUE\",\n          \"clear\": \"CLEAR\"\n        },\n        \"layer-hidden\": {\n          \"title\": \"LAYER HIDDEN\",\n          \"body\": \"This layer is hidden, changes won't be shown until you make it visible.\",\n          \"show\": \"SHOW\"\n        },\n        \"torque-exists\": {\n          \"title\": \"TORQUE LAYER\",\n          \"body\": \"There is already a torque layer in the layers collection. If you continue, this layer will use the default style.\",\n          \"continue\": \"CONTINUE\",\n          \"cancel\": \"CANCEL\"\n        }\n      },\n      \"components\": {\n        \"fill\": \"Fill\",\n        \"stroke\": {\n          \"label\": \"Stroke\",\n          \"fetching\": \"Loading node schema...\",\n          \"unavailable\": \"Error getting node schema\",\n          \"error\": \"There was an error fetching node schema...\"\n        },\n        \"blending\": {\n          \"label\": \"Blending\",\n          \"options\": {\n            \"none\": \"none\",\n            \"darken\": \"darken\",\n            \"lighten\": \"lighten\",\n            \"lighter\": \"lighter\",\n            \"color-dodge\": \"color-dodge\",\n            \"color-burn\": \"color-burn\",\n            \"multiply\": \"multiply\",\n            \"screen\": \"screen\",\n            \"overlay\": \"overlay\",\n            \"src-over\": \"src-over\",\n            \"source-over\": \"source-over\",\n            \"xor\": \"xor\"\n          }\n        },\n        \"type\": {\n          \"label\": \"Type\",\n          \"options\": {\n            \"heatmap\": \"Heatmap\",\n            \"points\": \"Points\"\n          }\n        },\n        \"aggregation-value\": \"Operation\",\n        \"aggregation-size\": {\n          \"label\": \"Size\",\n          \"help\": \"In pixels\"\n        },\n        \"aggregation-dataset\": \"Admin. level\",\n        \"labels-enabled\": {\n          \"label\": \"labels\",\n          \"not-with-animated\": \"It won't be available with animations\"\n        },\n        \"labels-attribute\": {\n          \"label\": \"column\",\n          \"fetching\": \"Loading node schema...\",\n          \"unavailable\": \"Error getting node schema\",\n          \"error\": \"There was an error fetching node schema...\"\n        },\n        \"labels-font\": \"font\",\n        \"labels-offset\": \"offset\",\n        \"labels-fill\": \"size/color\",\n        \"labels-overlap\": {\n          \"label\": \"overlap\",\n          \"options\": {\n            \"true\": \"True\",\n            \"false\": \"False\"\n          }\n        },\n        \"labels-halo\": \"halo\",\n        \"labels-placement\": {\n          \"label\": \"placement\",\n          \"options\": {\n            \"point\": \"point\",\n            \"line\": \"line\",\n            \"vertex\": \"vertex\",\n            \"interior\": \"interior\"\n          }\n        },\n        \"animated-enabled\": {\n          \"label\": \"animated\",\n          \"already-one-torque\": \"There is already a torque layer in your map\",\n          \"not-with-labels\": \"It won't be available with labels\"\n        },\n        \"animated-attribute\": {\n          \"label\": \"column\",\n          \"fetching\": \"Loading node schema...\",\n          \"unavailable\": \"Error getting node schema\",\n          \"error\": \"There was an error fetching node schema...\"\n        },\n        \"animated-overlap\": {\n          \"label\": \"overlap\",\n          \"options\": {\n            \"true\": \"Accum.\",\n            \"false\": \"None\"\n          }\n        },\n        \"animated-trails\": \"trails\",\n        \"animated-resolution\": \"resolution\",\n        \"animated-steps\": \"steps\",\n        \"animated-duration\": \"duration\"\n      }\n    },\n    \"widgets\": {\n      \"no-geometry-data\": \"Your dataset lacks geometry data, it is not possible to add a widget.\",\n      \"options\": {\n        \"remove\": \"Delete...\",\n        \"rename\": \"Rename\",\n        \"edit\": \"Edit\"\n      },\n      \"delete\": {\n        \"confirm\": \"Ok, delete it\",\n        \"cancel\": \"Cancel\",\n        \"desc\": \"The widget cannot be recovered, be sure before proceeding.\",\n        \"title\": \"You are about to delete the widget %{name}\",\n        \"error\": \"Error deleting widget %{name}: %{error}\",\n        \"loading\": \"Removing the widget %{name}...\",\n        \"success\": \"Widget %{name} deleted\"\n      },\n      \"widgets-view\": {\n        \"add_widget\": \"Add widget\"\n      },\n      \"widgets-types\": {\n        \"histogram\": \"Histogram\",\n        \"category\": \"Category\",\n        \"formula\": \"Formula\",\n        \"time-series\": \"Time series\"\n      },\n      \"widgets-form\": {\n        \"placeholder-text\": \"You have not added any widgets yet. Add widgets to discover new things.\",\n        \"type\": {\n          \"title-label\": \"Type\",\n          \"description\": \"Choose the widget type\",\n          \"category\": \"Category\",\n          \"formula\": \"Formula\",\n          \"histogram\": \"Histogram\",\n          \"time_series\": \"Time Series\"\n        },\n        \"data\": {\n          \"columns-unavailable\": \"No columns available\",\n          \"aggregation\": \"Aggregation\",\n          \"aggregation_column\": \"Aggregation Column\",\n          \"bins\": \"Buckets\",\n          \"column\": \"Column\",\n          \"description\": \"Configure your values\",\n          \"end\": \"End\",\n          \"loading\": \"loading\",\n          \"operation\": \"Operation\",\n          \"prefix\": \"Prefix\",\n          \"start\": \"Start\",\n          \"suffix\": \"Suffix\",\n          \"title\": \"Title\",\n          \"title-label\": \"Data\",\n          \"value\": \"Value\",\n          \"aggregate-by\": \"aggregate by\",\n          \"operation-column\": \"operation column\"\n        },\n        \"style\": {\n          \"custom-categories\": \"Custom categ.\",\n          \"custom-disabled\": \"If an aggregated style is applied, auto style is disabled\",\n          \"custom-help\": \"Represent the widget's values with custom colors in the map\",\n          \"custom-ramp\": \"Custom ramp\",\n          \"define\": \"Define how your widget interacts with the data\",\n          \"description\": \"Description\",\n          \"fill\": \"Fill\",\n          \"no\": \"No\",\n          \"sync_on_bbox_change\": \"Dynamic\",\n          \"sync_on_data_change\": \"Unfiltered\",\n          \"title-label\": \"Behavior\",\n          \"yes\": \"Yes\"\n        }\n      }\n    },\n    \"edit-feature\": {\n      \"features\": {\n        \"point\": \"point\",\n        \"line\": \"line\",\n        \"polygon\": \"polygon\"\n      },\n      \"loading-state\": \"Requesting feature data...\",\n      \"error-state\": \"There was an error requesting feature data\",\n      \"overlay-text\": \"Start clicking on the map to draw your %{featureType}\",\n      \"add\": \"Add\",\n      \"save\": \"Save\",\n      \"attributes\": \"Attributes\",\n      \"attributes-columns\": \"Change column names and type in table mode\",\n      \"cancel\": \"Cancel\",\n      \"geometry\": \"Geometry\",\n      \"geometry-edit\": \"You can also edit it on the map\",\n      \"geometry-disabled\": \"Not available for hidden or read only layers\",\n      \"out-of-bounds-lng\": \"Longitude is out of bounds [-180, 180]\",\n      \"out-of-bounds-lat\": \"Latitude is out of bounds [-90, 90]\",\n      \"valid-lng\": \"Must be a valid longitude\",\n      \"valid-lat\": \"Must be a valid latitude\",\n      \"valid\": \"Only numbers allowed\",\n      \"delete\": \"Delete %{featureType}\",\n      \"edit\": \"Edit %{featureType}\",\n      \"analysis\": \"layers with analysis nodes\",\n      \"custom-sql\": \"layers with custom SQL applied\",\n      \"sync\": \"read only layers\",\n      \"disabled\": \"Feature editing is disabled in %{disabledLayerType}. To edit the data, export this layer and import it as a new layer.\"\n    }\n  },\n  \"notifications\": {\n    \"vis\": {\n      \"failed\": {\n        \"title\": \"This map couldn't be rendered\",\n        \"body\": \"Please refresh the page and contact us if the error persists\"\n      }\n    },\n    \"analysis\": {\n      \"waiting\": \"Analysis %{nodeId} enqueued...\",\n      \"running\": \"Analysis %{nodeId} running...\",\n      \"completed\": \"Analysis %{nodeId} completed\",\n      \"failed\": \"Analysis %{nodeId} failed\",\n      \"removed\": \"Analysis %{nodeId} deleted\",\n      \"contact\": {\n        \"label\": \"contact us\",\n        \"mail\": \"support@carto.com\"\n      },\n      \"sample\": \"sample\",\n      \"errors\": {\n        \"timeout\": \"Your analysis has taken too long. Try to %{sample} your data or %{contact} for further assistance\",\n        \"without-geom-webmercator\": \"The column \\\"the_geom_webmercator\\\" does not exist\"\n      }\n    },\n    \"widgets\": {\n      \"delete\": \"Widget deleted correctly.\",\n      \"success\": \"Widget successfully added\",\n      \"error\": {\n        \"title\": \"Error adding widget:\",\n        \"body\": \"%{body} %{error}\"\n      },\n      \"loading\": \"Adding widget\",\n      \"updating\": \"Updating widget\",\n      \"restoring\": \"Restoring widgets\",\n      \"restored\": \"Widgets restored\"\n    },\n    \"layer\": {\n      \"error\": \"Layer error: %{error}\",\n      \"added\": \"Layer added successfully\"\n    },\n    \"cartocss\": {\n      \"error\": {\n        \"body\": \"%{body} %{error}\",\n        \"title\": \"Error in CartoCSS styles:\"\n      },\n      \"success\": \"CartoCSS applied\"\n    },\n    \"sql\": {\n      \"alter-loading\": \"Modifying table\",\n      \"alter-success\": \"Modification applied\",\n      \"applying\": \"Applying query\",\n      \"error\": {\n        \"body\": \"%{body} %{error}\",\n        \"title\": \"Error in SQL query:\"\n      },\n      \"success\": \"SQL query applied\"\n    },\n    \"edit-feature\": {\n      \"edit\": {\n        \"loading\": \"Requesting geometry data...\",\n        \"error\": \"There was an error requesting geometry data\"\n      },\n      \"error\": {\n        \"body\": \"%{body} %{error}\"\n      },\n      \"destroy\": {\n        \"loading\": \"Deleting geometry\",\n        \"error\": \"Error deleting geometry\",\n        \"success\": \"Geometry deleted correctly\"\n      },\n      \"save\": {\n        \"loading\": \"Saving geometry\",\n        \"error\": \"Error saving geometry\",\n        \"success\": \"Geometry successfully saved\"\n      },\n      \"adding\": \"Adding geometry\"\n    }\n  }\n}\n",
    "module.exports={\n  \"editor\": {\n    \"map\": \"mapa\",\n    \"map_name\": \"%{name} mapa\",\n    \"map_pluralize\": \"%{smart_count} mapa |||| %{smart_count} mapas\"\n  }\n}\n",
    "module.exports = {\n  en: require('./en.json'),\n  sw: require('./sw.json'),\n  es: require('./es.json')\n};\n",
    "module.exports={\n  \"editor\": {\n    \"map\": \"karta\",\n    \"map_name\": \"%{name} karta\",\n    \"map_pluralize\": \"%{smart_count} karta |||| %{smart_count} kartor\"\n  }\n}\n",
    "var _ = require('underscore');\nvar Backbone = require('backbone');\n\n/**\n * NOTE! Migrated as-is from https://github.com/CartoDB/cartodb.js/blob/470399abb12b40d5476ab6bbfd792d95aa819f50/src/core/view.js 2016-06-03\n * Base View for all CartoDB views.\n * DO NOT USE Backbone.View directly\n */\nvar View = Backbone.View.extend({\n  classLabel: 'cdb.core.View',\n\n  constructor: function (options) {\n    this.options = _.defaults(options, this.options);\n    this._models = [];\n    this._subviews = {};\n    Backbone.View.call(this, options);\n    View.viewCount++;\n    View.views[this.cid] = this;\n    this._created_at = new Date();\n  },\n\n  add_related_model: function (m) {\n    if (!m) throw new Error('added non valid model');\n    this._models.push(m);\n  },\n\n  addView: function (v) {\n    this._subviews[v.cid] = v;\n    v._parent = this;\n  },\n\n  removeView: function (v) {\n    delete this._subviews[v.cid];\n  },\n\n  clearSubViews: function () {\n    _(this._subviews).each(function (v) {\n      v.clean();\n    });\n    this._subviews = {};\n  },\n\n  /**\n   * this methid clean removes the view\n   * and clean and events associated. call it when\n   * the view is not going to be used anymore\n   */\n  clean: function () {\n    this.trigger('clean');\n    this.clearSubViews();\n    // remove from parent\n    if (this._parent) {\n      this._parent.removeView(this);\n      this._parent = null;\n    }\n    this.remove();\n    this.allOff();\n    View.viewCount--;\n    delete View.views[this.cid];\n    return this;\n  },\n\n  /**\n   * Remove all event listeners on related models\n   */\n  allOff: function () {\n    this.off();\n\n    if (this.model && this.model.off) this.model.off(null, null, this);\n\n    var self = this;\n    _(this._models).each(function (m) {\n      m.off(null, null, self);\n    });\n    this._models = [];\n  },\n\n  show: function () {\n    this.$el.show();\n  },\n\n  hide: function () {\n    this.$el.hide();\n  },\n\n  /**\n  * Listen for an event on another object and triggers on itself, with the same name or a new one\n  * @method retrigger\n  * @param ev {String} event who triggers the action\n  * @param obj {Object} object where the event happens\n  * @param obj {Object} [optional] name of the retriggered event\n  */\n  retrigger: function (ev, obj, retrigEvent) {\n    if (!retrigEvent) {\n      retrigEvent = ev;\n    }\n    var self = this;\n    obj.bind && obj.bind(ev, function () {\n      self.trigger(retrigEvent);\n    }, self);\n    // add it as related model//object\n    this.add_related_model(obj);\n  },\n  /**\n  * Captures an event and prevents the default behaviour and stops it from bubbling\n  * @method killEvent\n  * @param event {Event}\n  */\n  killEvent: function (ev) {\n    if (ev && ev.preventDefault) {\n      ev.preventDefault();\n    }\n    if (ev && ev.stopPropagation) {\n      ev.stopPropagation();\n    }\n  },\n\n  /**\n  * Remove all the tipsy tooltips from the document\n  * @method cleanTooltips\n  */\n  cleanTooltips: function () {\n    this.$('.tipsy').remove();\n  }\n\n}, {\n  viewCount: 0,\n  views: {},\n\n  /**\n   * when a view with events is inherit and you want to add more events\n   * this helper can be used:\n   * var MyView = new core.View({\n   *  events: View.extendEvents({\n   *      'click': 'fn'\n   *  })\n   * })\n   */\n  extendEvents: function (newEvents) {\n    return function () {\n      return _.extend(newEvents, this.constructor.__super__.events);\n    };\n  },\n\n  /**\n   * search for views in a view and check if they are added as subviews\n   */\n  runChecker: function () {\n    _.each(View.views, function (view) {\n      _.each(view, function (prop, k) {\n        if (k !== '_parent' &&\n          view.hasOwnProperty(k) &&\n          prop instanceof View &&\n          view._subviews[prop.cid] === undefined) {\n          console.log('=========');\n          console.log('untracked view: ');\n          console.log(prop.el);\n          console.log('parent');\n          console.log(view.el);\n          console.log(' ');\n        }\n      });\n    });\n  }\n});\n\nmodule.exports = View;\n",
    "/*! jQuery UI - v1.11.4 - 2015-03-11\n* http://jqueryui.com\n* Includes: core.js, widget.js, mouse.js, position.js, accordion.js, autocomplete.js, button.js, datepicker.js, dialog.js, draggable.js, droppable.js, effect.js, effect-blind.js, effect-bounce.js, effect-clip.js, effect-drop.js, effect-explode.js, effect-fade.js, effect-fold.js, effect-highlight.js, effect-puff.js, effect-pulsate.js, effect-scale.js, effect-shake.js, effect-size.js, effect-slide.js, effect-transfer.js, menu.js, progressbar.js, resizable.js, selectable.js, selectmenu.js, slider.js, sortable.js, spinner.js, tabs.js, tooltip.js\n* Copyright 2015 jQuery Foundation and other contributors; Licensed MIT */\n\n(function( factory ) {\n\tif ( typeof define === \"function\" && define.amd ) {\n\n\t\t// AMD. Register as an anonymous module.\n\t\tdefine([ \"jquery\" ], factory );\n\t} else {\n\n\t\t// Browser globals\n\t\tfactory( jQuery );\n\t}\n}(function( $ ) {\n/*!\n * jQuery UI Core 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/category/ui-core/\n */\n\n\n// $.ui might exist from components with no dependencies, e.g., $.ui.position\n$.ui = $.ui || {};\n\n$.extend( $.ui, {\n\tversion: \"1.11.4\",\n\n\tkeyCode: {\n\t\tBACKSPACE: 8,\n\t\tCOMMA: 188,\n\t\tDELETE: 46,\n\t\tDOWN: 40,\n\t\tEND: 35,\n\t\tENTER: 13,\n\t\tESCAPE: 27,\n\t\tHOME: 36,\n\t\tLEFT: 37,\n\t\tPAGE_DOWN: 34,\n\t\tPAGE_UP: 33,\n\t\tPERIOD: 190,\n\t\tRIGHT: 39,\n\t\tSPACE: 32,\n\t\tTAB: 9,\n\t\tUP: 38\n\t}\n});\n\n// plugins\n$.fn.extend({\n\tscrollParent: function( includeHidden ) {\n\t\tvar position = this.css( \"position\" ),\n\t\t\texcludeStaticParent = position === \"absolute\",\n\t\t\toverflowRegex = includeHidden ? /(auto|scroll|hidden)/ : /(auto|scroll)/,\n\t\t\tscrollParent = this.parents().filter( function() {\n\t\t\t\tvar parent = $( this );\n\t\t\t\tif ( excludeStaticParent && parent.css( \"position\" ) === \"static\" ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn overflowRegex.test( parent.css( \"overflow\" ) + parent.css( \"overflow-y\" ) + parent.css( \"overflow-x\" ) );\n\t\t\t}).eq( 0 );\n\n\t\treturn position === \"fixed\" || !scrollParent.length ? $( this[ 0 ].ownerDocument || document ) : scrollParent;\n\t},\n\n\tuniqueId: (function() {\n\t\tvar uuid = 0;\n\n\t\treturn function() {\n\t\t\treturn this.each(function() {\n\t\t\t\tif ( !this.id ) {\n\t\t\t\t\tthis.id = \"ui-id-\" + ( ++uuid );\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t})(),\n\n\tremoveUniqueId: function() {\n\t\treturn this.each(function() {\n\t\t\tif ( /^ui-id-\\d+$/.test( this.id ) ) {\n\t\t\t\t$( this ).removeAttr( \"id\" );\n\t\t\t}\n\t\t});\n\t}\n});\n\n// selectors\nfunction focusable( element, isTabIndexNotNaN ) {\n\tvar map, mapName, img,\n\t\tnodeName = element.nodeName.toLowerCase();\n\tif ( \"area\" === nodeName ) {\n\t\tmap = element.parentNode;\n\t\tmapName = map.name;\n\t\tif ( !element.href || !mapName || map.nodeName.toLowerCase() !== \"map\" ) {\n\t\t\treturn false;\n\t\t}\n\t\timg = $( \"img[usemap='#\" + mapName + \"']\" )[ 0 ];\n\t\treturn !!img && visible( img );\n\t}\n\treturn ( /^(input|select|textarea|button|object)$/.test( nodeName ) ?\n\t\t!element.disabled :\n\t\t\"a\" === nodeName ?\n\t\t\telement.href || isTabIndexNotNaN :\n\t\t\tisTabIndexNotNaN) &&\n\t\t// the element and all of its ancestors must be visible\n\t\tvisible( element );\n}\n\nfunction visible( element ) {\n\treturn $.expr.filters.visible( element ) &&\n\t\t!$( element ).parents().addBack().filter(function() {\n\t\t\treturn $.css( this, \"visibility\" ) === \"hidden\";\n\t\t}).length;\n}\n\n$.extend( $.expr[ \":\" ], {\n\tdata: $.expr.createPseudo ?\n\t\t$.expr.createPseudo(function( dataName ) {\n\t\t\treturn function( elem ) {\n\t\t\t\treturn !!$.data( elem, dataName );\n\t\t\t};\n\t\t}) :\n\t\t// support: jQuery <1.8\n\t\tfunction( elem, i, match ) {\n\t\t\treturn !!$.data( elem, match[ 3 ] );\n\t\t},\n\n\tfocusable: function( element ) {\n\t\treturn focusable( element, !isNaN( $.attr( element, \"tabindex\" ) ) );\n\t},\n\n\ttabbable: function( element ) {\n\t\tvar tabIndex = $.attr( element, \"tabindex\" ),\n\t\t\tisTabIndexNaN = isNaN( tabIndex );\n\t\treturn ( isTabIndexNaN || tabIndex >= 0 ) && focusable( element, !isTabIndexNaN );\n\t}\n});\n\n// support: jQuery <1.8\nif ( !$( \"<a>\" ).outerWidth( 1 ).jquery ) {\n\t$.each( [ \"Width\", \"Height\" ], function( i, name ) {\n\t\tvar side = name === \"Width\" ? [ \"Left\", \"Right\" ] : [ \"Top\", \"Bottom\" ],\n\t\t\ttype = name.toLowerCase(),\n\t\t\torig = {\n\t\t\t\tinnerWidth: $.fn.innerWidth,\n\t\t\t\tinnerHeight: $.fn.innerHeight,\n\t\t\t\touterWidth: $.fn.outerWidth,\n\t\t\t\touterHeight: $.fn.outerHeight\n\t\t\t};\n\n\t\tfunction reduce( elem, size, border, margin ) {\n\t\t\t$.each( side, function() {\n\t\t\t\tsize -= parseFloat( $.css( elem, \"padding\" + this ) ) || 0;\n\t\t\t\tif ( border ) {\n\t\t\t\t\tsize -= parseFloat( $.css( elem, \"border\" + this + \"Width\" ) ) || 0;\n\t\t\t\t}\n\t\t\t\tif ( margin ) {\n\t\t\t\t\tsize -= parseFloat( $.css( elem, \"margin\" + this ) ) || 0;\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn size;\n\t\t}\n\n\t\t$.fn[ \"inner\" + name ] = function( size ) {\n\t\t\tif ( size === undefined ) {\n\t\t\t\treturn orig[ \"inner\" + name ].call( this );\n\t\t\t}\n\n\t\t\treturn this.each(function() {\n\t\t\t\t$( this ).css( type, reduce( this, size ) + \"px\" );\n\t\t\t});\n\t\t};\n\n\t\t$.fn[ \"outer\" + name] = function( size, margin ) {\n\t\t\tif ( typeof size !== \"number\" ) {\n\t\t\t\treturn orig[ \"outer\" + name ].call( this, size );\n\t\t\t}\n\n\t\t\treturn this.each(function() {\n\t\t\t\t$( this).css( type, reduce( this, size, true, margin ) + \"px\" );\n\t\t\t});\n\t\t};\n\t});\n}\n\n// support: jQuery <1.8\nif ( !$.fn.addBack ) {\n\t$.fn.addBack = function( selector ) {\n\t\treturn this.add( selector == null ?\n\t\t\tthis.prevObject : this.prevObject.filter( selector )\n\t\t);\n\t};\n}\n\n// support: jQuery 1.6.1, 1.6.2 (http://bugs.jquery.com/ticket/9413)\nif ( $( \"<a>\" ).data( \"a-b\", \"a\" ).removeData( \"a-b\" ).data( \"a-b\" ) ) {\n\t$.fn.removeData = (function( removeData ) {\n\t\treturn function( key ) {\n\t\t\tif ( arguments.length ) {\n\t\t\t\treturn removeData.call( this, $.camelCase( key ) );\n\t\t\t} else {\n\t\t\t\treturn removeData.call( this );\n\t\t\t}\n\t\t};\n\t})( $.fn.removeData );\n}\n\n// deprecated\n$.ui.ie = !!/msie [\\w.]+/.exec( navigator.userAgent.toLowerCase() );\n\n$.fn.extend({\n\tfocus: (function( orig ) {\n\t\treturn function( delay, fn ) {\n\t\t\treturn typeof delay === \"number\" ?\n\t\t\t\tthis.each(function() {\n\t\t\t\t\tvar elem = this;\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t$( elem ).focus();\n\t\t\t\t\t\tif ( fn ) {\n\t\t\t\t\t\t\tfn.call( elem );\n\t\t\t\t\t\t}\n\t\t\t\t\t}, delay );\n\t\t\t\t}) :\n\t\t\t\torig.apply( this, arguments );\n\t\t};\n\t})( $.fn.focus ),\n\n\tdisableSelection: (function() {\n\t\tvar eventType = \"onselectstart\" in document.createElement( \"div\" ) ?\n\t\t\t\"selectstart\" :\n\t\t\t\"mousedown\";\n\n\t\treturn function() {\n\t\t\treturn this.bind( eventType + \".ui-disableSelection\", function( event ) {\n\t\t\t\tevent.preventDefault();\n\t\t\t});\n\t\t};\n\t})(),\n\n\tenableSelection: function() {\n\t\treturn this.unbind( \".ui-disableSelection\" );\n\t},\n\n\tzIndex: function( zIndex ) {\n\t\tif ( zIndex !== undefined ) {\n\t\t\treturn this.css( \"zIndex\", zIndex );\n\t\t}\n\n\t\tif ( this.length ) {\n\t\t\tvar elem = $( this[ 0 ] ), position, value;\n\t\t\twhile ( elem.length && elem[ 0 ] !== document ) {\n\t\t\t\t// Ignore z-index if position is set to a value where z-index is ignored by the browser\n\t\t\t\t// This makes behavior of this function consistent across browsers\n\t\t\t\t// WebKit always returns auto if the element is positioned\n\t\t\t\tposition = elem.css( \"position\" );\n\t\t\t\tif ( position === \"absolute\" || position === \"relative\" || position === \"fixed\" ) {\n\t\t\t\t\t// IE returns 0 when zIndex is not specified\n\t\t\t\t\t// other browsers return a string\n\t\t\t\t\t// we ignore the case of nested elements with an explicit value of 0\n\t\t\t\t\t// <div style=\"z-index: -10;\"><div style=\"z-index: 0;\"></div></div>\n\t\t\t\t\tvalue = parseInt( elem.css( \"zIndex\" ), 10 );\n\t\t\t\t\tif ( !isNaN( value ) && value !== 0 ) {\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telem = elem.parent();\n\t\t\t}\n\t\t}\n\n\t\treturn 0;\n\t}\n});\n\n// $.ui.plugin is deprecated. Use $.widget() extensions instead.\n$.ui.plugin = {\n\tadd: function( module, option, set ) {\n\t\tvar i,\n\t\t\tproto = $.ui[ module ].prototype;\n\t\tfor ( i in set ) {\n\t\t\tproto.plugins[ i ] = proto.plugins[ i ] || [];\n\t\t\tproto.plugins[ i ].push( [ option, set[ i ] ] );\n\t\t}\n\t},\n\tcall: function( instance, name, args, allowDisconnected ) {\n\t\tvar i,\n\t\t\tset = instance.plugins[ name ];\n\n\t\tif ( !set ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !allowDisconnected && ( !instance.element[ 0 ].parentNode || instance.element[ 0 ].parentNode.nodeType === 11 ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor ( i = 0; i < set.length; i++ ) {\n\t\t\tif ( instance.options[ set[ i ][ 0 ] ] ) {\n\t\t\t\tset[ i ][ 1 ].apply( instance.element, args );\n\t\t\t}\n\t\t}\n\t}\n};\n\n\n/*!\n * jQuery UI Widget 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/jQuery.widget/\n */\n\n\nvar widget_uuid = 0,\n\twidget_slice = Array.prototype.slice;\n\n$.cleanData = (function( orig ) {\n\treturn function( elems ) {\n\t\tvar events, elem, i;\n\t\tfor ( i = 0; (elem = elems[i]) != null; i++ ) {\n\t\t\ttry {\n\n\t\t\t\t// Only trigger remove when necessary to save time\n\t\t\t\tevents = $._data( elem, \"events\" );\n\t\t\t\tif ( events && events.remove ) {\n\t\t\t\t\t$( elem ).triggerHandler( \"remove\" );\n\t\t\t\t}\n\n\t\t\t// http://bugs.jquery.com/ticket/8235\n\t\t\t} catch ( e ) {}\n\t\t}\n\t\torig( elems );\n\t};\n})( $.cleanData );\n\n$.widget = function( name, base, prototype ) {\n\tvar fullName, existingConstructor, constructor, basePrototype,\n\t\t// proxiedPrototype allows the provided prototype to remain unmodified\n\t\t// so that it can be used as a mixin for multiple widgets (#8876)\n\t\tproxiedPrototype = {},\n\t\tnamespace = name.split( \".\" )[ 0 ];\n\n\tname = name.split( \".\" )[ 1 ];\n\tfullName = namespace + \"-\" + name;\n\n\tif ( !prototype ) {\n\t\tprototype = base;\n\t\tbase = $.Widget;\n\t}\n\n\t// create selector for plugin\n\t$.expr[ \":\" ][ fullName.toLowerCase() ] = function( elem ) {\n\t\treturn !!$.data( elem, fullName );\n\t};\n\n\t$[ namespace ] = $[ namespace ] || {};\n\texistingConstructor = $[ namespace ][ name ];\n\tconstructor = $[ namespace ][ name ] = function( options, element ) {\n\t\t// allow instantiation without \"new\" keyword\n\t\tif ( !this._createWidget ) {\n\t\t\treturn new constructor( options, element );\n\t\t}\n\n\t\t// allow instantiation without initializing for simple inheritance\n\t\t// must use \"new\" keyword (the code above always passes args)\n\t\tif ( arguments.length ) {\n\t\t\tthis._createWidget( options, element );\n\t\t}\n\t};\n\t// extend with the existing constructor to carry over any static properties\n\t$.extend( constructor, existingConstructor, {\n\t\tversion: prototype.version,\n\t\t// copy the object used to create the prototype in case we need to\n\t\t// redefine the widget later\n\t\t_proto: $.extend( {}, prototype ),\n\t\t// track widgets that inherit from this widget in case this widget is\n\t\t// redefined after a widget inherits from it\n\t\t_childConstructors: []\n\t});\n\n\tbasePrototype = new base();\n\t// we need to make the options hash a property directly on the new instance\n\t// otherwise we'll modify the options hash on the prototype that we're\n\t// inheriting from\n\tbasePrototype.options = $.widget.extend( {}, basePrototype.options );\n\t$.each( prototype, function( prop, value ) {\n\t\tif ( !$.isFunction( value ) ) {\n\t\t\tproxiedPrototype[ prop ] = value;\n\t\t\treturn;\n\t\t}\n\t\tproxiedPrototype[ prop ] = (function() {\n\t\t\tvar _super = function() {\n\t\t\t\t\treturn base.prototype[ prop ].apply( this, arguments );\n\t\t\t\t},\n\t\t\t\t_superApply = function( args ) {\n\t\t\t\t\treturn base.prototype[ prop ].apply( this, args );\n\t\t\t\t};\n\t\t\treturn function() {\n\t\t\t\tvar __super = this._super,\n\t\t\t\t\t__superApply = this._superApply,\n\t\t\t\t\treturnValue;\n\n\t\t\t\tthis._super = _super;\n\t\t\t\tthis._superApply = _superApply;\n\n\t\t\t\treturnValue = value.apply( this, arguments );\n\n\t\t\t\tthis._super = __super;\n\t\t\t\tthis._superApply = __superApply;\n\n\t\t\t\treturn returnValue;\n\t\t\t};\n\t\t})();\n\t});\n\tconstructor.prototype = $.widget.extend( basePrototype, {\n\t\t// TODO: remove support for widgetEventPrefix\n\t\t// always use the name + a colon as the prefix, e.g., draggable:start\n\t\t// don't prefix for widgets that aren't DOM-based\n\t\twidgetEventPrefix: existingConstructor ? (basePrototype.widgetEventPrefix || name) : name\n\t}, proxiedPrototype, {\n\t\tconstructor: constructor,\n\t\tnamespace: namespace,\n\t\twidgetName: name,\n\t\twidgetFullName: fullName\n\t});\n\n\t// If this widget is being redefined then we need to find all widgets that\n\t// are inheriting from it and redefine all of them so that they inherit from\n\t// the new version of this widget. We're essentially trying to replace one\n\t// level in the prototype chain.\n\tif ( existingConstructor ) {\n\t\t$.each( existingConstructor._childConstructors, function( i, child ) {\n\t\t\tvar childPrototype = child.prototype;\n\n\t\t\t// redefine the child widget using the same prototype that was\n\t\t\t// originally used, but inherit from the new version of the base\n\t\t\t$.widget( childPrototype.namespace + \".\" + childPrototype.widgetName, constructor, child._proto );\n\t\t});\n\t\t// remove the list of existing child constructors from the old constructor\n\t\t// so the old child constructors can be garbage collected\n\t\tdelete existingConstructor._childConstructors;\n\t} else {\n\t\tbase._childConstructors.push( constructor );\n\t}\n\n\t$.widget.bridge( name, constructor );\n\n\treturn constructor;\n};\n\n$.widget.extend = function( target ) {\n\tvar input = widget_slice.call( arguments, 1 ),\n\t\tinputIndex = 0,\n\t\tinputLength = input.length,\n\t\tkey,\n\t\tvalue;\n\tfor ( ; inputIndex < inputLength; inputIndex++ ) {\n\t\tfor ( key in input[ inputIndex ] ) {\n\t\t\tvalue = input[ inputIndex ][ key ];\n\t\t\tif ( input[ inputIndex ].hasOwnProperty( key ) && value !== undefined ) {\n\t\t\t\t// Clone objects\n\t\t\t\tif ( $.isPlainObject( value ) ) {\n\t\t\t\t\ttarget[ key ] = $.isPlainObject( target[ key ] ) ?\n\t\t\t\t\t\t$.widget.extend( {}, target[ key ], value ) :\n\t\t\t\t\t\t// Don't extend strings, arrays, etc. with objects\n\t\t\t\t\t\t$.widget.extend( {}, value );\n\t\t\t\t// Copy everything else by reference\n\t\t\t\t} else {\n\t\t\t\t\ttarget[ key ] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn target;\n};\n\n$.widget.bridge = function( name, object ) {\n\tvar fullName = object.prototype.widgetFullName || name;\n\t$.fn[ name ] = function( options ) {\n\t\tvar isMethodCall = typeof options === \"string\",\n\t\t\targs = widget_slice.call( arguments, 1 ),\n\t\t\treturnValue = this;\n\n\t\tif ( isMethodCall ) {\n\t\t\tthis.each(function() {\n\t\t\t\tvar methodValue,\n\t\t\t\t\tinstance = $.data( this, fullName );\n\t\t\t\tif ( options === \"instance\" ) {\n\t\t\t\t\treturnValue = instance;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif ( !instance ) {\n\t\t\t\t\treturn $.error( \"cannot call methods on \" + name + \" prior to initialization; \" +\n\t\t\t\t\t\t\"attempted to call method '\" + options + \"'\" );\n\t\t\t\t}\n\t\t\t\tif ( !$.isFunction( instance[options] ) || options.charAt( 0 ) === \"_\" ) {\n\t\t\t\t\treturn $.error( \"no such method '\" + options + \"' for \" + name + \" widget instance\" );\n\t\t\t\t}\n\t\t\t\tmethodValue = instance[ options ].apply( instance, args );\n\t\t\t\tif ( methodValue !== instance && methodValue !== undefined ) {\n\t\t\t\t\treturnValue = methodValue && methodValue.jquery ?\n\t\t\t\t\t\treturnValue.pushStack( methodValue.get() ) :\n\t\t\t\t\t\tmethodValue;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\n\t\t\t// Allow multiple hashes to be passed on init\n\t\t\tif ( args.length ) {\n\t\t\t\toptions = $.widget.extend.apply( null, [ options ].concat(args) );\n\t\t\t}\n\n\t\t\tthis.each(function() {\n\t\t\t\tvar instance = $.data( this, fullName );\n\t\t\t\tif ( instance ) {\n\t\t\t\t\tinstance.option( options || {} );\n\t\t\t\t\tif ( instance._init ) {\n\t\t\t\t\t\tinstance._init();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t$.data( this, fullName, new object( options, this ) );\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn returnValue;\n\t};\n};\n\n$.Widget = function( /* options, element */ ) {};\n$.Widget._childConstructors = [];\n\n$.Widget.prototype = {\n\twidgetName: \"widget\",\n\twidgetEventPrefix: \"\",\n\tdefaultElement: \"<div>\",\n\toptions: {\n\t\tdisabled: false,\n\n\t\t// callbacks\n\t\tcreate: null\n\t},\n\t_createWidget: function( options, element ) {\n\t\telement = $( element || this.defaultElement || this )[ 0 ];\n\t\tthis.element = $( element );\n\t\tthis.uuid = widget_uuid++;\n\t\tthis.eventNamespace = \".\" + this.widgetName + this.uuid;\n\n\t\tthis.bindings = $();\n\t\tthis.hoverable = $();\n\t\tthis.focusable = $();\n\n\t\tif ( element !== this ) {\n\t\t\t$.data( element, this.widgetFullName, this );\n\t\t\tthis._on( true, this.element, {\n\t\t\t\tremove: function( event ) {\n\t\t\t\t\tif ( event.target === element ) {\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.document = $( element.style ?\n\t\t\t\t// element within the document\n\t\t\t\telement.ownerDocument :\n\t\t\t\t// element is window or document\n\t\t\t\telement.document || element );\n\t\t\tthis.window = $( this.document[0].defaultView || this.document[0].parentWindow );\n\t\t}\n\n\t\tthis.options = $.widget.extend( {},\n\t\t\tthis.options,\n\t\t\tthis._getCreateOptions(),\n\t\t\toptions );\n\n\t\tthis._create();\n\t\tthis._trigger( \"create\", null, this._getCreateEventData() );\n\t\tthis._init();\n\t},\n\t_getCreateOptions: $.noop,\n\t_getCreateEventData: $.noop,\n\t_create: $.noop,\n\t_init: $.noop,\n\n\tdestroy: function() {\n\t\tthis._destroy();\n\t\t// we can probably remove the unbind calls in 2.0\n\t\t// all event bindings should go through this._on()\n\t\tthis.element\n\t\t\t.unbind( this.eventNamespace )\n\t\t\t.removeData( this.widgetFullName )\n\t\t\t// support: jquery <1.6.3\n\t\t\t// http://bugs.jquery.com/ticket/9413\n\t\t\t.removeData( $.camelCase( this.widgetFullName ) );\n\t\tthis.widget()\n\t\t\t.unbind( this.eventNamespace )\n\t\t\t.removeAttr( \"aria-disabled\" )\n\t\t\t.removeClass(\n\t\t\t\tthis.widgetFullName + \"-disabled \" +\n\t\t\t\t\"ui-state-disabled\" );\n\n\t\t// clean up events and states\n\t\tthis.bindings.unbind( this.eventNamespace );\n\t\tthis.hoverable.removeClass( \"ui-state-hover\" );\n\t\tthis.focusable.removeClass( \"ui-state-focus\" );\n\t},\n\t_destroy: $.noop,\n\n\twidget: function() {\n\t\treturn this.element;\n\t},\n\n\toption: function( key, value ) {\n\t\tvar options = key,\n\t\t\tparts,\n\t\t\tcurOption,\n\t\t\ti;\n\n\t\tif ( arguments.length === 0 ) {\n\t\t\t// don't return a reference to the internal hash\n\t\t\treturn $.widget.extend( {}, this.options );\n\t\t}\n\n\t\tif ( typeof key === \"string\" ) {\n\t\t\t// handle nested keys, e.g., \"foo.bar\" => { foo: { bar: ___ } }\n\t\t\toptions = {};\n\t\t\tparts = key.split( \".\" );\n\t\t\tkey = parts.shift();\n\t\t\tif ( parts.length ) {\n\t\t\t\tcurOption = options[ key ] = $.widget.extend( {}, this.options[ key ] );\n\t\t\t\tfor ( i = 0; i < parts.length - 1; i++ ) {\n\t\t\t\t\tcurOption[ parts[ i ] ] = curOption[ parts[ i ] ] || {};\n\t\t\t\t\tcurOption = curOption[ parts[ i ] ];\n\t\t\t\t}\n\t\t\t\tkey = parts.pop();\n\t\t\t\tif ( arguments.length === 1 ) {\n\t\t\t\t\treturn curOption[ key ] === undefined ? null : curOption[ key ];\n\t\t\t\t}\n\t\t\t\tcurOption[ key ] = value;\n\t\t\t} else {\n\t\t\t\tif ( arguments.length === 1 ) {\n\t\t\t\t\treturn this.options[ key ] === undefined ? null : this.options[ key ];\n\t\t\t\t}\n\t\t\t\toptions[ key ] = value;\n\t\t\t}\n\t\t}\n\n\t\tthis._setOptions( options );\n\n\t\treturn this;\n\t},\n\t_setOptions: function( options ) {\n\t\tvar key;\n\n\t\tfor ( key in options ) {\n\t\t\tthis._setOption( key, options[ key ] );\n\t\t}\n\n\t\treturn this;\n\t},\n\t_setOption: function( key, value ) {\n\t\tthis.options[ key ] = value;\n\n\t\tif ( key === \"disabled\" ) {\n\t\t\tthis.widget()\n\t\t\t\t.toggleClass( this.widgetFullName + \"-disabled\", !!value );\n\n\t\t\t// If the widget is becoming disabled, then nothing is interactive\n\t\t\tif ( value ) {\n\t\t\t\tthis.hoverable.removeClass( \"ui-state-hover\" );\n\t\t\t\tthis.focusable.removeClass( \"ui-state-focus\" );\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tenable: function() {\n\t\treturn this._setOptions({ disabled: false });\n\t},\n\tdisable: function() {\n\t\treturn this._setOptions({ disabled: true });\n\t},\n\n\t_on: function( suppressDisabledCheck, element, handlers ) {\n\t\tvar delegateElement,\n\t\t\tinstance = this;\n\n\t\t// no suppressDisabledCheck flag, shuffle arguments\n\t\tif ( typeof suppressDisabledCheck !== \"boolean\" ) {\n\t\t\thandlers = element;\n\t\t\telement = suppressDisabledCheck;\n\t\t\tsuppressDisabledCheck = false;\n\t\t}\n\n\t\t// no element argument, shuffle and use this.element\n\t\tif ( !handlers ) {\n\t\t\thandlers = element;\n\t\t\telement = this.element;\n\t\t\tdelegateElement = this.widget();\n\t\t} else {\n\t\t\telement = delegateElement = $( element );\n\t\t\tthis.bindings = this.bindings.add( element );\n\t\t}\n\n\t\t$.each( handlers, function( event, handler ) {\n\t\t\tfunction handlerProxy() {\n\t\t\t\t// allow widgets to customize the disabled handling\n\t\t\t\t// - disabled as an array instead of boolean\n\t\t\t\t// - disabled class as method for disabling individual parts\n\t\t\t\tif ( !suppressDisabledCheck &&\n\t\t\t\t\t\t( instance.options.disabled === true ||\n\t\t\t\t\t\t\t$( this ).hasClass( \"ui-state-disabled\" ) ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\treturn ( typeof handler === \"string\" ? instance[ handler ] : handler )\n\t\t\t\t\t.apply( instance, arguments );\n\t\t\t}\n\n\t\t\t// copy the guid so direct unbinding works\n\t\t\tif ( typeof handler !== \"string\" ) {\n\t\t\t\thandlerProxy.guid = handler.guid =\n\t\t\t\t\thandler.guid || handlerProxy.guid || $.guid++;\n\t\t\t}\n\n\t\t\tvar match = event.match( /^([\\w:-]*)\\s*(.*)$/ ),\n\t\t\t\teventName = match[1] + instance.eventNamespace,\n\t\t\t\tselector = match[2];\n\t\t\tif ( selector ) {\n\t\t\t\tdelegateElement.delegate( selector, eventName, handlerProxy );\n\t\t\t} else {\n\t\t\t\telement.bind( eventName, handlerProxy );\n\t\t\t}\n\t\t});\n\t},\n\n\t_off: function( element, eventName ) {\n\t\teventName = (eventName || \"\").split( \" \" ).join( this.eventNamespace + \" \" ) +\n\t\t\tthis.eventNamespace;\n\t\telement.unbind( eventName ).undelegate( eventName );\n\n\t\t// Clear the stack to avoid memory leaks (#10056)\n\t\tthis.bindings = $( this.bindings.not( element ).get() );\n\t\tthis.focusable = $( this.focusable.not( element ).get() );\n\t\tthis.hoverable = $( this.hoverable.not( element ).get() );\n\t},\n\n\t_delay: function( handler, delay ) {\n\t\tfunction handlerProxy() {\n\t\t\treturn ( typeof handler === \"string\" ? instance[ handler ] : handler )\n\t\t\t\t.apply( instance, arguments );\n\t\t}\n\t\tvar instance = this;\n\t\treturn setTimeout( handlerProxy, delay || 0 );\n\t},\n\n\t_hoverable: function( element ) {\n\t\tthis.hoverable = this.hoverable.add( element );\n\t\tthis._on( element, {\n\t\t\tmouseenter: function( event ) {\n\t\t\t\t$( event.currentTarget ).addClass( \"ui-state-hover\" );\n\t\t\t},\n\t\t\tmouseleave: function( event ) {\n\t\t\t\t$( event.currentTarget ).removeClass( \"ui-state-hover\" );\n\t\t\t}\n\t\t});\n\t},\n\n\t_focusable: function( element ) {\n\t\tthis.focusable = this.focusable.add( element );\n\t\tthis._on( element, {\n\t\t\tfocusin: function( event ) {\n\t\t\t\t$( event.currentTarget ).addClass( \"ui-state-focus\" );\n\t\t\t},\n\t\t\tfocusout: function( event ) {\n\t\t\t\t$( event.currentTarget ).removeClass( \"ui-state-focus\" );\n\t\t\t}\n\t\t});\n\t},\n\n\t_trigger: function( type, event, data ) {\n\t\tvar prop, orig,\n\t\t\tcallback = this.options[ type ];\n\n\t\tdata = data || {};\n\t\tevent = $.Event( event );\n\t\tevent.type = ( type === this.widgetEventPrefix ?\n\t\t\ttype :\n\t\t\tthis.widgetEventPrefix + type ).toLowerCase();\n\t\t// the original event may come from any element\n\t\t// so we need to reset the target on the new event\n\t\tevent.target = this.element[ 0 ];\n\n\t\t// copy original event properties over to the new event\n\t\torig = event.originalEvent;\n\t\tif ( orig ) {\n\t\t\tfor ( prop in orig ) {\n\t\t\t\tif ( !( prop in event ) ) {\n\t\t\t\t\tevent[ prop ] = orig[ prop ];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.element.trigger( event, data );\n\t\treturn !( $.isFunction( callback ) &&\n\t\t\tcallback.apply( this.element[0], [ event ].concat( data ) ) === false ||\n\t\t\tevent.isDefaultPrevented() );\n\t}\n};\n\n$.each( { show: \"fadeIn\", hide: \"fadeOut\" }, function( method, defaultEffect ) {\n\t$.Widget.prototype[ \"_\" + method ] = function( element, options, callback ) {\n\t\tif ( typeof options === \"string\" ) {\n\t\t\toptions = { effect: options };\n\t\t}\n\t\tvar hasOptions,\n\t\t\teffectName = !options ?\n\t\t\t\tmethod :\n\t\t\t\toptions === true || typeof options === \"number\" ?\n\t\t\t\t\tdefaultEffect :\n\t\t\t\t\toptions.effect || defaultEffect;\n\t\toptions = options || {};\n\t\tif ( typeof options === \"number\" ) {\n\t\t\toptions = { duration: options };\n\t\t}\n\t\thasOptions = !$.isEmptyObject( options );\n\t\toptions.complete = callback;\n\t\tif ( options.delay ) {\n\t\t\telement.delay( options.delay );\n\t\t}\n\t\tif ( hasOptions && $.effects && $.effects.effect[ effectName ] ) {\n\t\t\telement[ method ]( options );\n\t\t} else if ( effectName !== method && element[ effectName ] ) {\n\t\t\telement[ effectName ]( options.duration, options.easing, callback );\n\t\t} else {\n\t\t\telement.queue(function( next ) {\n\t\t\t\t$( this )[ method ]();\n\t\t\t\tif ( callback ) {\n\t\t\t\t\tcallback.call( element[ 0 ] );\n\t\t\t\t}\n\t\t\t\tnext();\n\t\t\t});\n\t\t}\n\t};\n});\n\nvar widget = $.widget;\n\n\n/*!\n * jQuery UI Mouse 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/mouse/\n */\n\n\nvar mouseHandled = false;\n$( document ).mouseup( function() {\n\tmouseHandled = false;\n});\n\nvar mouse = $.widget(\"ui.mouse\", {\n\tversion: \"1.11.4\",\n\toptions: {\n\t\tcancel: \"input,textarea,button,select,option\",\n\t\tdistance: 1,\n\t\tdelay: 0\n\t},\n\t_mouseInit: function() {\n\t\tvar that = this;\n\n\t\tthis.element\n\t\t\t.bind(\"mousedown.\" + this.widgetName, function(event) {\n\t\t\t\treturn that._mouseDown(event);\n\t\t\t})\n\t\t\t.bind(\"click.\" + this.widgetName, function(event) {\n\t\t\t\tif (true === $.data(event.target, that.widgetName + \".preventClickEvent\")) {\n\t\t\t\t\t$.removeData(event.target, that.widgetName + \".preventClickEvent\");\n\t\t\t\t\tevent.stopImmediatePropagation();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\n\t\tthis.started = false;\n\t},\n\n\t// TODO: make sure destroying one instance of mouse doesn't mess with\n\t// other instances of mouse\n\t_mouseDestroy: function() {\n\t\tthis.element.unbind(\".\" + this.widgetName);\n\t\tif ( this._mouseMoveDelegate ) {\n\t\t\tthis.document\n\t\t\t\t.unbind(\"mousemove.\" + this.widgetName, this._mouseMoveDelegate)\n\t\t\t\t.unbind(\"mouseup.\" + this.widgetName, this._mouseUpDelegate);\n\t\t}\n\t},\n\n\t_mouseDown: function(event) {\n\t\t// don't let more than one widget handle mouseStart\n\t\tif ( mouseHandled ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._mouseMoved = false;\n\n\t\t// we may have missed mouseup (out of window)\n\t\t(this._mouseStarted && this._mouseUp(event));\n\n\t\tthis._mouseDownEvent = event;\n\n\t\tvar that = this,\n\t\t\tbtnIsLeft = (event.which === 1),\n\t\t\t// event.target.nodeName works around a bug in IE 8 with\n\t\t\t// disabled inputs (#7620)\n\t\t\telIsCancel = (typeof this.options.cancel === \"string\" && event.target.nodeName ? $(event.target).closest(this.options.cancel).length : false);\n\t\tif (!btnIsLeft || elIsCancel || !this._mouseCapture(event)) {\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.mouseDelayMet = !this.options.delay;\n\t\tif (!this.mouseDelayMet) {\n\t\t\tthis._mouseDelayTimer = setTimeout(function() {\n\t\t\t\tthat.mouseDelayMet = true;\n\t\t\t}, this.options.delay);\n\t\t}\n\n\t\tif (this._mouseDistanceMet(event) && this._mouseDelayMet(event)) {\n\t\t\tthis._mouseStarted = (this._mouseStart(event) !== false);\n\t\t\tif (!this._mouseStarted) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\t// Click event may never have fired (Gecko & Opera)\n\t\tif (true === $.data(event.target, this.widgetName + \".preventClickEvent\")) {\n\t\t\t$.removeData(event.target, this.widgetName + \".preventClickEvent\");\n\t\t}\n\n\t\t// these delegates are required to keep context\n\t\tthis._mouseMoveDelegate = function(event) {\n\t\t\treturn that._mouseMove(event);\n\t\t};\n\t\tthis._mouseUpDelegate = function(event) {\n\t\t\treturn that._mouseUp(event);\n\t\t};\n\n\t\tthis.document\n\t\t\t.bind( \"mousemove.\" + this.widgetName, this._mouseMoveDelegate )\n\t\t\t.bind( \"mouseup.\" + this.widgetName, this._mouseUpDelegate );\n\n\t\tevent.preventDefault();\n\n\t\tmouseHandled = true;\n\t\treturn true;\n\t},\n\n\t_mouseMove: function(event) {\n\t\t// Only check for mouseups outside the document if you've moved inside the document\n\t\t// at least once. This prevents the firing of mouseup in the case of IE<9, which will\n\t\t// fire a mousemove event if content is placed under the cursor. See #7778\n\t\t// Support: IE <9\n\t\tif ( this._mouseMoved ) {\n\t\t\t// IE mouseup check - mouseup happened when mouse was out of window\n\t\t\tif ($.ui.ie && ( !document.documentMode || document.documentMode < 9 ) && !event.button) {\n\t\t\t\treturn this._mouseUp(event);\n\n\t\t\t// Iframe mouseup check - mouseup occurred in another document\n\t\t\t} else if ( !event.which ) {\n\t\t\t\treturn this._mouseUp( event );\n\t\t\t}\n\t\t}\n\n\t\tif ( event.which || event.button ) {\n\t\t\tthis._mouseMoved = true;\n\t\t}\n\n\t\tif (this._mouseStarted) {\n\t\t\tthis._mouseDrag(event);\n\t\t\treturn event.preventDefault();\n\t\t}\n\n\t\tif (this._mouseDistanceMet(event) && this._mouseDelayMet(event)) {\n\t\t\tthis._mouseStarted =\n\t\t\t\t(this._mouseStart(this._mouseDownEvent, event) !== false);\n\t\t\t(this._mouseStarted ? this._mouseDrag(event) : this._mouseUp(event));\n\t\t}\n\n\t\treturn !this._mouseStarted;\n\t},\n\n\t_mouseUp: function(event) {\n\t\tthis.document\n\t\t\t.unbind( \"mousemove.\" + this.widgetName, this._mouseMoveDelegate )\n\t\t\t.unbind( \"mouseup.\" + this.widgetName, this._mouseUpDelegate );\n\n\t\tif (this._mouseStarted) {\n\t\t\tthis._mouseStarted = false;\n\n\t\t\tif (event.target === this._mouseDownEvent.target) {\n\t\t\t\t$.data(event.target, this.widgetName + \".preventClickEvent\", true);\n\t\t\t}\n\n\t\t\tthis._mouseStop(event);\n\t\t}\n\n\t\tmouseHandled = false;\n\t\treturn false;\n\t},\n\n\t_mouseDistanceMet: function(event) {\n\t\treturn (Math.max(\n\t\t\t\tMath.abs(this._mouseDownEvent.pageX - event.pageX),\n\t\t\t\tMath.abs(this._mouseDownEvent.pageY - event.pageY)\n\t\t\t) >= this.options.distance\n\t\t);\n\t},\n\n\t_mouseDelayMet: function(/* event */) {\n\t\treturn this.mouseDelayMet;\n\t},\n\n\t// These are placeholder methods, to be overriden by extending plugin\n\t_mouseStart: function(/* event */) {},\n\t_mouseDrag: function(/* event */) {},\n\t_mouseStop: function(/* event */) {},\n\t_mouseCapture: function(/* event */) { return true; }\n});\n\n\n/*!\n * jQuery UI Position 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/position/\n */\n\n(function() {\n\n$.ui = $.ui || {};\n\nvar cachedScrollbarWidth, supportsOffsetFractions,\n\tmax = Math.max,\n\tabs = Math.abs,\n\tround = Math.round,\n\trhorizontal = /left|center|right/,\n\trvertical = /top|center|bottom/,\n\troffset = /[\\+\\-]\\d+(\\.[\\d]+)?%?/,\n\trposition = /^\\w+/,\n\trpercent = /%$/,\n\t_position = $.fn.position;\n\nfunction getOffsets( offsets, width, height ) {\n\treturn [\n\t\tparseFloat( offsets[ 0 ] ) * ( rpercent.test( offsets[ 0 ] ) ? width / 100 : 1 ),\n\t\tparseFloat( offsets[ 1 ] ) * ( rpercent.test( offsets[ 1 ] ) ? height / 100 : 1 )\n\t];\n}\n\nfunction parseCss( element, property ) {\n\treturn parseInt( $.css( element, property ), 10 ) || 0;\n}\n\nfunction getDimensions( elem ) {\n\tvar raw = elem[0];\n\tif ( raw.nodeType === 9 ) {\n\t\treturn {\n\t\t\twidth: elem.width(),\n\t\t\theight: elem.height(),\n\t\t\toffset: { top: 0, left: 0 }\n\t\t};\n\t}\n\tif ( $.isWindow( raw ) ) {\n\t\treturn {\n\t\t\twidth: elem.width(),\n\t\t\theight: elem.height(),\n\t\t\toffset: { top: elem.scrollTop(), left: elem.scrollLeft() }\n\t\t};\n\t}\n\tif ( raw.preventDefault ) {\n\t\treturn {\n\t\t\twidth: 0,\n\t\t\theight: 0,\n\t\t\toffset: { top: raw.pageY, left: raw.pageX }\n\t\t};\n\t}\n\treturn {\n\t\twidth: elem.outerWidth(),\n\t\theight: elem.outerHeight(),\n\t\toffset: elem.offset()\n\t};\n}\n\n$.position = {\n\tscrollbarWidth: function() {\n\t\tif ( cachedScrollbarWidth !== undefined ) {\n\t\t\treturn cachedScrollbarWidth;\n\t\t}\n\t\tvar w1, w2,\n\t\t\tdiv = $( \"<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>\" ),\n\t\t\tinnerDiv = div.children()[0];\n\n\t\t$( \"body\" ).append( div );\n\t\tw1 = innerDiv.offsetWidth;\n\t\tdiv.css( \"overflow\", \"scroll\" );\n\n\t\tw2 = innerDiv.offsetWidth;\n\n\t\tif ( w1 === w2 ) {\n\t\t\tw2 = div[0].clientWidth;\n\t\t}\n\n\t\tdiv.remove();\n\n\t\treturn (cachedScrollbarWidth = w1 - w2);\n\t},\n\tgetScrollInfo: function( within ) {\n\t\tvar overflowX = within.isWindow || within.isDocument ? \"\" :\n\t\t\t\twithin.element.css( \"overflow-x\" ),\n\t\t\toverflowY = within.isWindow || within.isDocument ? \"\" :\n\t\t\t\twithin.element.css( \"overflow-y\" ),\n\t\t\thasOverflowX = overflowX === \"scroll\" ||\n\t\t\t\t( overflowX === \"auto\" && within.width < within.element[0].scrollWidth ),\n\t\t\thasOverflowY = overflowY === \"scroll\" ||\n\t\t\t\t( overflowY === \"auto\" && within.height < within.element[0].scrollHeight );\n\t\treturn {\n\t\t\twidth: hasOverflowY ? $.position.scrollbarWidth() : 0,\n\t\t\theight: hasOverflowX ? $.position.scrollbarWidth() : 0\n\t\t};\n\t},\n\tgetWithinInfo: function( element ) {\n\t\tvar withinElement = $( element || window ),\n\t\t\tisWindow = $.isWindow( withinElement[0] ),\n\t\t\tisDocument = !!withinElement[ 0 ] && withinElement[ 0 ].nodeType === 9;\n\t\treturn {\n\t\t\telement: withinElement,\n\t\t\tisWindow: isWindow,\n\t\t\tisDocument: isDocument,\n\t\t\toffset: withinElement.offset() || { left: 0, top: 0 },\n\t\t\tscrollLeft: withinElement.scrollLeft(),\n\t\t\tscrollTop: withinElement.scrollTop(),\n\n\t\t\t// support: jQuery 1.6.x\n\t\t\t// jQuery 1.6 doesn't support .outerWidth/Height() on documents or windows\n\t\t\twidth: isWindow || isDocument ? withinElement.width() : withinElement.outerWidth(),\n\t\t\theight: isWindow || isDocument ? withinElement.height() : withinElement.outerHeight()\n\t\t};\n\t}\n};\n\n$.fn.position = function( options ) {\n\tif ( !options || !options.of ) {\n\t\treturn _position.apply( this, arguments );\n\t}\n\n\t// make a copy, we don't want to modify arguments\n\toptions = $.extend( {}, options );\n\n\tvar atOffset, targetWidth, targetHeight, targetOffset, basePosition, dimensions,\n\t\ttarget = $( options.of ),\n\t\twithin = $.position.getWithinInfo( options.within ),\n\t\tscrollInfo = $.position.getScrollInfo( within ),\n\t\tcollision = ( options.collision || \"flip\" ).split( \" \" ),\n\t\toffsets = {};\n\n\tdimensions = getDimensions( target );\n\tif ( target[0].preventDefault ) {\n\t\t// force left top to allow flipping\n\t\toptions.at = \"left top\";\n\t}\n\ttargetWidth = dimensions.width;\n\ttargetHeight = dimensions.height;\n\ttargetOffset = dimensions.offset;\n\t// clone to reuse original targetOffset later\n\tbasePosition = $.extend( {}, targetOffset );\n\n\t// force my and at to have valid horizontal and vertical positions\n\t// if a value is missing or invalid, it will be converted to center\n\t$.each( [ \"my\", \"at\" ], function() {\n\t\tvar pos = ( options[ this ] || \"\" ).split( \" \" ),\n\t\t\thorizontalOffset,\n\t\t\tverticalOffset;\n\n\t\tif ( pos.length === 1) {\n\t\t\tpos = rhorizontal.test( pos[ 0 ] ) ?\n\t\t\t\tpos.concat( [ \"center\" ] ) :\n\t\t\t\trvertical.test( pos[ 0 ] ) ?\n\t\t\t\t\t[ \"center\" ].concat( pos ) :\n\t\t\t\t\t[ \"center\", \"center\" ];\n\t\t}\n\t\tpos[ 0 ] = rhorizontal.test( pos[ 0 ] ) ? pos[ 0 ] : \"center\";\n\t\tpos[ 1 ] = rvertical.test( pos[ 1 ] ) ? pos[ 1 ] : \"center\";\n\n\t\t// calculate offsets\n\t\thorizontalOffset = roffset.exec( pos[ 0 ] );\n\t\tverticalOffset = roffset.exec( pos[ 1 ] );\n\t\toffsets[ this ] = [\n\t\t\thorizontalOffset ? horizontalOffset[ 0 ] : 0,\n\t\t\tverticalOffset ? verticalOffset[ 0 ] : 0\n\t\t];\n\n\t\t// reduce to just the positions without the offsets\n\t\toptions[ this ] = [\n\t\t\trposition.exec( pos[ 0 ] )[ 0 ],\n\t\t\trposition.exec( pos[ 1 ] )[ 0 ]\n\t\t];\n\t});\n\n\t// normalize collision option\n\tif ( collision.length === 1 ) {\n\t\tcollision[ 1 ] = collision[ 0 ];\n\t}\n\n\tif ( options.at[ 0 ] === \"right\" ) {\n\t\tbasePosition.left += targetWidth;\n\t} else if ( options.at[ 0 ] === \"center\" ) {\n\t\tbasePosition.left += targetWidth / 2;\n\t}\n\n\tif ( options.at[ 1 ] === \"bottom\" ) {\n\t\tbasePosition.top += targetHeight;\n\t} else if ( options.at[ 1 ] === \"center\" ) {\n\t\tbasePosition.top += targetHeight / 2;\n\t}\n\n\tatOffset = getOffsets( offsets.at, targetWidth, targetHeight );\n\tbasePosition.left += atOffset[ 0 ];\n\tbasePosition.top += atOffset[ 1 ];\n\n\treturn this.each(function() {\n\t\tvar collisionPosition, using,\n\t\t\telem = $( this ),\n\t\t\telemWidth = elem.outerWidth(),\n\t\t\telemHeight = elem.outerHeight(),\n\t\t\tmarginLeft = parseCss( this, \"marginLeft\" ),\n\t\t\tmarginTop = parseCss( this, \"marginTop\" ),\n\t\t\tcollisionWidth = elemWidth + marginLeft + parseCss( this, \"marginRight\" ) + scrollInfo.width,\n\t\t\tcollisionHeight = elemHeight + marginTop + parseCss( this, \"marginBottom\" ) + scrollInfo.height,\n\t\t\tposition = $.extend( {}, basePosition ),\n\t\t\tmyOffset = getOffsets( offsets.my, elem.outerWidth(), elem.outerHeight() );\n\n\t\tif ( options.my[ 0 ] === \"right\" ) {\n\t\t\tposition.left -= elemWidth;\n\t\t} else if ( options.my[ 0 ] === \"center\" ) {\n\t\t\tposition.left -= elemWidth / 2;\n\t\t}\n\n\t\tif ( options.my[ 1 ] === \"bottom\" ) {\n\t\t\tposition.top -= elemHeight;\n\t\t} else if ( options.my[ 1 ] === \"center\" ) {\n\t\t\tposition.top -= elemHeight / 2;\n\t\t}\n\n\t\tposition.left += myOffset[ 0 ];\n\t\tposition.top += myOffset[ 1 ];\n\n\t\t// if the browser doesn't support fractions, then round for consistent results\n\t\tif ( !supportsOffsetFractions ) {\n\t\t\tposition.left = round( position.left );\n\t\t\tposition.top = round( position.top );\n\t\t}\n\n\t\tcollisionPosition = {\n\t\t\tmarginLeft: marginLeft,\n\t\t\tmarginTop: marginTop\n\t\t};\n\n\t\t$.each( [ \"left\", \"top\" ], function( i, dir ) {\n\t\t\tif ( $.ui.position[ collision[ i ] ] ) {\n\t\t\t\t$.ui.position[ collision[ i ] ][ dir ]( position, {\n\t\t\t\t\ttargetWidth: targetWidth,\n\t\t\t\t\ttargetHeight: targetHeight,\n\t\t\t\t\telemWidth: elemWidth,\n\t\t\t\t\telemHeight: elemHeight,\n\t\t\t\t\tcollisionPosition: collisionPosition,\n\t\t\t\t\tcollisionWidth: collisionWidth,\n\t\t\t\t\tcollisionHeight: collisionHeight,\n\t\t\t\t\toffset: [ atOffset[ 0 ] + myOffset[ 0 ], atOffset [ 1 ] + myOffset[ 1 ] ],\n\t\t\t\t\tmy: options.my,\n\t\t\t\t\tat: options.at,\n\t\t\t\t\twithin: within,\n\t\t\t\t\telem: elem\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tif ( options.using ) {\n\t\t\t// adds feedback as second argument to using callback, if present\n\t\t\tusing = function( props ) {\n\t\t\t\tvar left = targetOffset.left - position.left,\n\t\t\t\t\tright = left + targetWidth - elemWidth,\n\t\t\t\t\ttop = targetOffset.top - position.top,\n\t\t\t\t\tbottom = top + targetHeight - elemHeight,\n\t\t\t\t\tfeedback = {\n\t\t\t\t\t\ttarget: {\n\t\t\t\t\t\t\telement: target,\n\t\t\t\t\t\t\tleft: targetOffset.left,\n\t\t\t\t\t\t\ttop: targetOffset.top,\n\t\t\t\t\t\t\twidth: targetWidth,\n\t\t\t\t\t\t\theight: targetHeight\n\t\t\t\t\t\t},\n\t\t\t\t\t\telement: {\n\t\t\t\t\t\t\telement: elem,\n\t\t\t\t\t\t\tleft: position.left,\n\t\t\t\t\t\t\ttop: position.top,\n\t\t\t\t\t\t\twidth: elemWidth,\n\t\t\t\t\t\t\theight: elemHeight\n\t\t\t\t\t\t},\n\t\t\t\t\t\thorizontal: right < 0 ? \"left\" : left > 0 ? \"right\" : \"center\",\n\t\t\t\t\t\tvertical: bottom < 0 ? \"top\" : top > 0 ? \"bottom\" : \"middle\"\n\t\t\t\t\t};\n\t\t\t\tif ( targetWidth < elemWidth && abs( left + right ) < targetWidth ) {\n\t\t\t\t\tfeedback.horizontal = \"center\";\n\t\t\t\t}\n\t\t\t\tif ( targetHeight < elemHeight && abs( top + bottom ) < targetHeight ) {\n\t\t\t\t\tfeedback.vertical = \"middle\";\n\t\t\t\t}\n\t\t\t\tif ( max( abs( left ), abs( right ) ) > max( abs( top ), abs( bottom ) ) ) {\n\t\t\t\t\tfeedback.important = \"horizontal\";\n\t\t\t\t} else {\n\t\t\t\t\tfeedback.important = \"vertical\";\n\t\t\t\t}\n\t\t\t\toptions.using.call( this, props, feedback );\n\t\t\t};\n\t\t}\n\n\t\telem.offset( $.extend( position, { using: using } ) );\n\t});\n};\n\n$.ui.position = {\n\tfit: {\n\t\tleft: function( position, data ) {\n\t\t\tvar within = data.within,\n\t\t\t\twithinOffset = within.isWindow ? within.scrollLeft : within.offset.left,\n\t\t\t\touterWidth = within.width,\n\t\t\t\tcollisionPosLeft = position.left - data.collisionPosition.marginLeft,\n\t\t\t\toverLeft = withinOffset - collisionPosLeft,\n\t\t\t\toverRight = collisionPosLeft + data.collisionWidth - outerWidth - withinOffset,\n\t\t\t\tnewOverRight;\n\n\t\t\t// element is wider than within\n\t\t\tif ( data.collisionWidth > outerWidth ) {\n\t\t\t\t// element is initially over the left side of within\n\t\t\t\tif ( overLeft > 0 && overRight <= 0 ) {\n\t\t\t\t\tnewOverRight = position.left + overLeft + data.collisionWidth - outerWidth - withinOffset;\n\t\t\t\t\tposition.left += overLeft - newOverRight;\n\t\t\t\t// element is initially over right side of within\n\t\t\t\t} else if ( overRight > 0 && overLeft <= 0 ) {\n\t\t\t\t\tposition.left = withinOffset;\n\t\t\t\t// element is initially over both left and right sides of within\n\t\t\t\t} else {\n\t\t\t\t\tif ( overLeft > overRight ) {\n\t\t\t\t\t\tposition.left = withinOffset + outerWidth - data.collisionWidth;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tposition.left = withinOffset;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t// too far left -> align with left edge\n\t\t\t} else if ( overLeft > 0 ) {\n\t\t\t\tposition.left += overLeft;\n\t\t\t// too far right -> align with right edge\n\t\t\t} else if ( overRight > 0 ) {\n\t\t\t\tposition.left -= overRight;\n\t\t\t// adjust based on position and margin\n\t\t\t} else {\n\t\t\t\tposition.left = max( position.left - collisionPosLeft, position.left );\n\t\t\t}\n\t\t},\n\t\ttop: function( position, data ) {\n\t\t\tvar within = data.within,\n\t\t\t\twithinOffset = within.isWindow ? within.scrollTop : within.offset.top,\n\t\t\t\touterHeight = data.within.height,\n\t\t\t\tcollisionPosTop = position.top - data.collisionPosition.marginTop,\n\t\t\t\toverTop = withinOffset - collisionPosTop,\n\t\t\t\toverBottom = collisionPosTop + data.collisionHeight - outerHeight - withinOffset,\n\t\t\t\tnewOverBottom;\n\n\t\t\t// element is taller than within\n\t\t\tif ( data.collisionHeight > outerHeight ) {\n\t\t\t\t// element is initially over the top of within\n\t\t\t\tif ( overTop > 0 && overBottom <= 0 ) {\n\t\t\t\t\tnewOverBottom = position.top + overTop + data.collisionHeight - outerHeight - withinOffset;\n\t\t\t\t\tposition.top += overTop - newOverBottom;\n\t\t\t\t// element is initially over bottom of within\n\t\t\t\t} else if ( overBottom > 0 && overTop <= 0 ) {\n\t\t\t\t\tposition.top = withinOffset;\n\t\t\t\t// element is initially over both top and bottom of within\n\t\t\t\t} else {\n\t\t\t\t\tif ( overTop > overBottom ) {\n\t\t\t\t\t\tposition.top = withinOffset + outerHeight - data.collisionHeight;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tposition.top = withinOffset;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t// too far up -> align with top\n\t\t\t} else if ( overTop > 0 ) {\n\t\t\t\tposition.top += overTop;\n\t\t\t// too far down -> align with bottom edge\n\t\t\t} else if ( overBottom > 0 ) {\n\t\t\t\tposition.top -= overBottom;\n\t\t\t// adjust based on position and margin\n\t\t\t} else {\n\t\t\t\tposition.top = max( position.top - collisionPosTop, position.top );\n\t\t\t}\n\t\t}\n\t},\n\tflip: {\n\t\tleft: function( position, data ) {\n\t\t\tvar within = data.within,\n\t\t\t\twithinOffset = within.offset.left + within.scrollLeft,\n\t\t\t\touterWidth = within.width,\n\t\t\t\toffsetLeft = within.isWindow ? within.scrollLeft : within.offset.left,\n\t\t\t\tcollisionPosLeft = position.left - data.collisionPosition.marginLeft,\n\t\t\t\toverLeft = collisionPosLeft - offsetLeft,\n\t\t\t\toverRight = collisionPosLeft + data.collisionWidth - outerWidth - offsetLeft,\n\t\t\t\tmyOffset = data.my[ 0 ] === \"left\" ?\n\t\t\t\t\t-data.elemWidth :\n\t\t\t\t\tdata.my[ 0 ] === \"right\" ?\n\t\t\t\t\t\tdata.elemWidth :\n\t\t\t\t\t\t0,\n\t\t\t\tatOffset = data.at[ 0 ] === \"left\" ?\n\t\t\t\t\tdata.targetWidth :\n\t\t\t\t\tdata.at[ 0 ] === \"right\" ?\n\t\t\t\t\t\t-data.targetWidth :\n\t\t\t\t\t\t0,\n\t\t\t\toffset = -2 * data.offset[ 0 ],\n\t\t\t\tnewOverRight,\n\t\t\t\tnewOverLeft;\n\n\t\t\tif ( overLeft < 0 ) {\n\t\t\t\tnewOverRight = position.left + myOffset + atOffset + offset + data.collisionWidth - outerWidth - withinOffset;\n\t\t\t\tif ( newOverRight < 0 || newOverRight < abs( overLeft ) ) {\n\t\t\t\t\tposition.left += myOffset + atOffset + offset;\n\t\t\t\t}\n\t\t\t} else if ( overRight > 0 ) {\n\t\t\t\tnewOverLeft = position.left - data.collisionPosition.marginLeft + myOffset + atOffset + offset - offsetLeft;\n\t\t\t\tif ( newOverLeft > 0 || abs( newOverLeft ) < overRight ) {\n\t\t\t\t\tposition.left += myOffset + atOffset + offset;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\ttop: function( position, data ) {\n\t\t\tvar within = data.within,\n\t\t\t\twithinOffset = within.offset.top + within.scrollTop,\n\t\t\t\touterHeight = within.height,\n\t\t\t\toffsetTop = within.isWindow ? within.scrollTop : within.offset.top,\n\t\t\t\tcollisionPosTop = position.top - data.collisionPosition.marginTop,\n\t\t\t\toverTop = collisionPosTop - offsetTop,\n\t\t\t\toverBottom = collisionPosTop + data.collisionHeight - outerHeight - offsetTop,\n\t\t\t\ttop = data.my[ 1 ] === \"top\",\n\t\t\t\tmyOffset = top ?\n\t\t\t\t\t-data.elemHeight :\n\t\t\t\t\tdata.my[ 1 ] === \"bottom\" ?\n\t\t\t\t\t\tdata.elemHeight :\n\t\t\t\t\t\t0,\n\t\t\t\tatOffset = data.at[ 1 ] === \"top\" ?\n\t\t\t\t\tdata.targetHeight :\n\t\t\t\t\tdata.at[ 1 ] === \"bottom\" ?\n\t\t\t\t\t\t-data.targetHeight :\n\t\t\t\t\t\t0,\n\t\t\t\toffset = -2 * data.offset[ 1 ],\n\t\t\t\tnewOverTop,\n\t\t\t\tnewOverBottom;\n\t\t\tif ( overTop < 0 ) {\n\t\t\t\tnewOverBottom = position.top + myOffset + atOffset + offset + data.collisionHeight - outerHeight - withinOffset;\n\t\t\t\tif ( newOverBottom < 0 || newOverBottom < abs( overTop ) ) {\n\t\t\t\t\tposition.top += myOffset + atOffset + offset;\n\t\t\t\t}\n\t\t\t} else if ( overBottom > 0 ) {\n\t\t\t\tnewOverTop = position.top - data.collisionPosition.marginTop + myOffset + atOffset + offset - offsetTop;\n\t\t\t\tif ( newOverTop > 0 || abs( newOverTop ) < overBottom ) {\n\t\t\t\t\tposition.top += myOffset + atOffset + offset;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\tflipfit: {\n\t\tleft: function() {\n\t\t\t$.ui.position.flip.left.apply( this, arguments );\n\t\t\t$.ui.position.fit.left.apply( this, arguments );\n\t\t},\n\t\ttop: function() {\n\t\t\t$.ui.position.flip.top.apply( this, arguments );\n\t\t\t$.ui.position.fit.top.apply( this, arguments );\n\t\t}\n\t}\n};\n\n// fraction support test\n(function() {\n\tvar testElement, testElementParent, testElementStyle, offsetLeft, i,\n\t\tbody = document.getElementsByTagName( \"body\" )[ 0 ],\n\t\tdiv = document.createElement( \"div\" );\n\n\t//Create a \"fake body\" for testing based on method used in jQuery.support\n\ttestElement = document.createElement( body ? \"div\" : \"body\" );\n\ttestElementStyle = {\n\t\tvisibility: \"hidden\",\n\t\twidth: 0,\n\t\theight: 0,\n\t\tborder: 0,\n\t\tmargin: 0,\n\t\tbackground: \"none\"\n\t};\n\tif ( body ) {\n\t\t$.extend( testElementStyle, {\n\t\t\tposition: \"absolute\",\n\t\t\tleft: \"-1000px\",\n\t\t\ttop: \"-1000px\"\n\t\t});\n\t}\n\tfor ( i in testElementStyle ) {\n\t\ttestElement.style[ i ] = testElementStyle[ i ];\n\t}\n\ttestElement.appendChild( div );\n\ttestElementParent = body || document.documentElement;\n\ttestElementParent.insertBefore( testElement, testElementParent.firstChild );\n\n\tdiv.style.cssText = \"position: absolute; left: 10.7432222px;\";\n\n\toffsetLeft = $( div ).offset().left;\n\tsupportsOffsetFractions = offsetLeft > 10 && offsetLeft < 11;\n\n\ttestElement.innerHTML = \"\";\n\ttestElementParent.removeChild( testElement );\n})();\n\n})();\n\nvar position = $.ui.position;\n\n\n/*!\n * jQuery UI Accordion 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/accordion/\n */\n\n\nvar accordion = $.widget( \"ui.accordion\", {\n\tversion: \"1.11.4\",\n\toptions: {\n\t\tactive: 0,\n\t\tanimate: {},\n\t\tcollapsible: false,\n\t\tevent: \"click\",\n\t\theader: \"> li > :first-child,> :not(li):even\",\n\t\theightStyle: \"auto\",\n\t\ticons: {\n\t\t\tactiveHeader: \"ui-icon-triangle-1-s\",\n\t\t\theader: \"ui-icon-triangle-1-e\"\n\t\t},\n\n\t\t// callbacks\n\t\tactivate: null,\n\t\tbeforeActivate: null\n\t},\n\n\thideProps: {\n\t\tborderTopWidth: \"hide\",\n\t\tborderBottomWidth: \"hide\",\n\t\tpaddingTop: \"hide\",\n\t\tpaddingBottom: \"hide\",\n\t\theight: \"hide\"\n\t},\n\n\tshowProps: {\n\t\tborderTopWidth: \"show\",\n\t\tborderBottomWidth: \"show\",\n\t\tpaddingTop: \"show\",\n\t\tpaddingBottom: \"show\",\n\t\theight: \"show\"\n\t},\n\n\t_create: function() {\n\t\tvar options = this.options;\n\t\tthis.prevShow = this.prevHide = $();\n\t\tthis.element.addClass( \"ui-accordion ui-widget ui-helper-reset\" )\n\t\t\t// ARIA\n\t\t\t.attr( \"role\", \"tablist\" );\n\n\t\t// don't allow collapsible: false and active: false / null\n\t\tif ( !options.collapsible && (options.active === false || options.active == null) ) {\n\t\t\toptions.active = 0;\n\t\t}\n\n\t\tthis._processPanels();\n\t\t// handle negative values\n\t\tif ( options.active < 0 ) {\n\t\t\toptions.active += this.headers.length;\n\t\t}\n\t\tthis._refresh();\n\t},\n\n\t_getCreateEventData: function() {\n\t\treturn {\n\t\t\theader: this.active,\n\t\t\tpanel: !this.active.length ? $() : this.active.next()\n\t\t};\n\t},\n\n\t_createIcons: function() {\n\t\tvar icons = this.options.icons;\n\t\tif ( icons ) {\n\t\t\t$( \"<span>\" )\n\t\t\t\t.addClass( \"ui-accordion-header-icon ui-icon \" + icons.header )\n\t\t\t\t.prependTo( this.headers );\n\t\t\tthis.active.children( \".ui-accordion-header-icon\" )\n\t\t\t\t.removeClass( icons.header )\n\t\t\t\t.addClass( icons.activeHeader );\n\t\t\tthis.headers.addClass( \"ui-accordion-icons\" );\n\t\t}\n\t},\n\n\t_destroyIcons: function() {\n\t\tthis.headers\n\t\t\t.removeClass( \"ui-accordion-icons\" )\n\t\t\t.children( \".ui-accordion-header-icon\" )\n\t\t\t\t.remove();\n\t},\n\n\t_destroy: function() {\n\t\tvar contents;\n\n\t\t// clean up main element\n\t\tthis.element\n\t\t\t.removeClass( \"ui-accordion ui-widget ui-helper-reset\" )\n\t\t\t.removeAttr( \"role\" );\n\n\t\t// clean up headers\n\t\tthis.headers\n\t\t\t.removeClass( \"ui-accordion-header ui-accordion-header-active ui-state-default \" +\n\t\t\t\t\"ui-corner-all ui-state-active ui-state-disabled ui-corner-top\" )\n\t\t\t.removeAttr( \"role\" )\n\t\t\t.removeAttr( \"aria-expanded\" )\n\t\t\t.removeAttr( \"aria-selected\" )\n\t\t\t.removeAttr( \"aria-controls\" )\n\t\t\t.removeAttr( \"tabIndex\" )\n\t\t\t.removeUniqueId();\n\n\t\tthis._destroyIcons();\n\n\t\t// clean up content panels\n\t\tcontents = this.headers.next()\n\t\t\t.removeClass( \"ui-helper-reset ui-widget-content ui-corner-bottom \" +\n\t\t\t\t\"ui-accordion-content ui-accordion-content-active ui-state-disabled\" )\n\t\t\t.css( \"display\", \"\" )\n\t\t\t.removeAttr( \"role\" )\n\t\t\t.removeAttr( \"aria-hidden\" )\n\t\t\t.removeAttr( \"aria-labelledby\" )\n\t\t\t.removeUniqueId();\n\n\t\tif ( this.options.heightStyle !== \"content\" ) {\n\t\t\tcontents.css( \"height\", \"\" );\n\t\t}\n\t},\n\n\t_setOption: function( key, value ) {\n\t\tif ( key === \"active\" ) {\n\t\t\t// _activate() will handle invalid values and update this.options\n\t\t\tthis._activate( value );\n\t\t\treturn;\n\t\t}\n\n\t\tif ( key === \"event\" ) {\n\t\t\tif ( this.options.event ) {\n\t\t\t\tthis._off( this.headers, this.options.event );\n\t\t\t}\n\t\t\tthis._setupEvents( value );\n\t\t}\n\n\t\tthis._super( key, value );\n\n\t\t// setting collapsible: false while collapsed; open first panel\n\t\tif ( key === \"collapsible\" && !value && this.options.active === false ) {\n\t\t\tthis._activate( 0 );\n\t\t}\n\n\t\tif ( key === \"icons\" ) {\n\t\t\tthis._destroyIcons();\n\t\t\tif ( value ) {\n\t\t\t\tthis._createIcons();\n\t\t\t}\n\t\t}\n\n\t\t// #5332 - opacity doesn't cascade to positioned elements in IE\n\t\t// so we need to add the disabled class to the headers and panels\n\t\tif ( key === \"disabled\" ) {\n\t\t\tthis.element\n\t\t\t\t.toggleClass( \"ui-state-disabled\", !!value )\n\t\t\t\t.attr( \"aria-disabled\", value );\n\t\t\tthis.headers.add( this.headers.next() )\n\t\t\t\t.toggleClass( \"ui-state-disabled\", !!value );\n\t\t}\n\t},\n\n\t_keydown: function( event ) {\n\t\tif ( event.altKey || event.ctrlKey ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar keyCode = $.ui.keyCode,\n\t\t\tlength = this.headers.length,\n\t\t\tcurrentIndex = this.headers.index( event.target ),\n\t\t\ttoFocus = false;\n\n\t\tswitch ( event.keyCode ) {\n\t\t\tcase keyCode.RIGHT:\n\t\t\tcase keyCode.DOWN:\n\t\t\t\ttoFocus = this.headers[ ( currentIndex + 1 ) % length ];\n\t\t\t\tbreak;\n\t\t\tcase keyCode.LEFT:\n\t\t\tcase keyCode.UP:\n\t\t\t\ttoFocus = this.headers[ ( currentIndex - 1 + length ) % length ];\n\t\t\t\tbreak;\n\t\t\tcase keyCode.SPACE:\n\t\t\tcase keyCode.ENTER:\n\t\t\t\tthis._eventHandler( event );\n\t\t\t\tbreak;\n\t\t\tcase keyCode.HOME:\n\t\t\t\ttoFocus = this.headers[ 0 ];\n\t\t\t\tbreak;\n\t\t\tcase keyCode.END:\n\t\t\t\ttoFocus = this.headers[ length - 1 ];\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif ( toFocus ) {\n\t\t\t$( event.target ).attr( \"tabIndex\", -1 );\n\t\t\t$( toFocus ).attr( \"tabIndex\", 0 );\n\t\t\ttoFocus.focus();\n\t\t\tevent.preventDefault();\n\t\t}\n\t},\n\n\t_panelKeyDown: function( event ) {\n\t\tif ( event.keyCode === $.ui.keyCode.UP && event.ctrlKey ) {\n\t\t\t$( event.currentTarget ).prev().focus();\n\t\t}\n\t},\n\n\trefresh: function() {\n\t\tvar options = this.options;\n\t\tthis._processPanels();\n\n\t\t// was collapsed or no panel\n\t\tif ( ( options.active === false && options.collapsible === true ) || !this.headers.length ) {\n\t\t\toptions.active = false;\n\t\t\tthis.active = $();\n\t\t// active false only when collapsible is true\n\t\t} else if ( options.active === false ) {\n\t\t\tthis._activate( 0 );\n\t\t// was active, but active panel is gone\n\t\t} else if ( this.active.length && !$.contains( this.element[ 0 ], this.active[ 0 ] ) ) {\n\t\t\t// all remaining panel are disabled\n\t\t\tif ( this.headers.length === this.headers.find(\".ui-state-disabled\").length ) {\n\t\t\t\toptions.active = false;\n\t\t\t\tthis.active = $();\n\t\t\t// activate previous panel\n\t\t\t} else {\n\t\t\t\tthis._activate( Math.max( 0, options.active - 1 ) );\n\t\t\t}\n\t\t// was active, active panel still exists\n\t\t} else {\n\t\t\t// make sure active index is correct\n\t\t\toptions.active = this.headers.index( this.active );\n\t\t}\n\n\t\tthis._destroyIcons();\n\n\t\tthis._refresh();\n\t},\n\n\t_processPanels: function() {\n\t\tvar prevHeaders = this.headers,\n\t\t\tprevPanels = this.panels;\n\n\t\tthis.headers = this.element.find( this.options.header )\n\t\t\t.addClass( \"ui-accordion-header ui-state-default ui-corner-all\" );\n\n\t\tthis.panels = this.headers.next()\n\t\t\t.addClass( \"ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom\" )\n\t\t\t.filter( \":not(.ui-accordion-content-active)\" )\n\t\t\t.hide();\n\n\t\t// Avoid memory leaks (#10056)\n\t\tif ( prevPanels ) {\n\t\t\tthis._off( prevHeaders.not( this.headers ) );\n\t\t\tthis._off( prevPanels.not( this.panels ) );\n\t\t}\n\t},\n\n\t_refresh: function() {\n\t\tvar maxHeight,\n\t\t\toptions = this.options,\n\t\t\theightStyle = options.heightStyle,\n\t\t\tparent = this.element.parent();\n\n\t\tthis.active = this._findActive( options.active )\n\t\t\t.addClass( \"ui-accordion-header-active ui-state-active ui-corner-top\" )\n\t\t\t.removeClass( \"ui-corner-all\" );\n\t\tthis.active.next()\n\t\t\t.addClass( \"ui-accordion-content-active\" )\n\t\t\t.show();\n\n\t\tthis.headers\n\t\t\t.attr( \"role\", \"tab\" )\n\t\t\t.each(function() {\n\t\t\t\tvar header = $( this ),\n\t\t\t\t\theaderId = header.uniqueId().attr( \"id\" ),\n\t\t\t\t\tpanel = header.next(),\n\t\t\t\t\tpanelId = panel.uniqueId().attr( \"id\" );\n\t\t\t\theader.attr( \"aria-controls\", panelId );\n\t\t\t\tpanel.attr( \"aria-labelledby\", headerId );\n\t\t\t})\n\t\t\t.next()\n\t\t\t\t.attr( \"role\", \"tabpanel\" );\n\n\t\tthis.headers\n\t\t\t.not( this.active )\n\t\t\t.attr({\n\t\t\t\t\"aria-selected\": \"false\",\n\t\t\t\t\"aria-expanded\": \"false\",\n\t\t\t\ttabIndex: -1\n\t\t\t})\n\t\t\t.next()\n\t\t\t\t.attr({\n\t\t\t\t\t\"aria-hidden\": \"true\"\n\t\t\t\t})\n\t\t\t\t.hide();\n\n\t\t// make sure at least one header is in the tab order\n\t\tif ( !this.active.length ) {\n\t\t\tthis.headers.eq( 0 ).attr( \"tabIndex\", 0 );\n\t\t} else {\n\t\t\tthis.active.attr({\n\t\t\t\t\"aria-selected\": \"true\",\n\t\t\t\t\"aria-expanded\": \"true\",\n\t\t\t\ttabIndex: 0\n\t\t\t})\n\t\t\t.next()\n\t\t\t\t.attr({\n\t\t\t\t\t\"aria-hidden\": \"false\"\n\t\t\t\t});\n\t\t}\n\n\t\tthis._createIcons();\n\n\t\tthis._setupEvents( options.event );\n\n\t\tif ( heightStyle === \"fill\" ) {\n\t\t\tmaxHeight = parent.height();\n\t\t\tthis.element.siblings( \":visible\" ).each(function() {\n\t\t\t\tvar elem = $( this ),\n\t\t\t\t\tposition = elem.css( \"position\" );\n\n\t\t\t\tif ( position === \"absolute\" || position === \"fixed\" ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tmaxHeight -= elem.outerHeight( true );\n\t\t\t});\n\n\t\t\tthis.headers.each(function() {\n\t\t\t\tmaxHeight -= $( this ).outerHeight( true );\n\t\t\t});\n\n\t\t\tthis.headers.next()\n\t\t\t\t.each(function() {\n\t\t\t\t\t$( this ).height( Math.max( 0, maxHeight -\n\t\t\t\t\t\t$( this ).innerHeight() + $( this ).height() ) );\n\t\t\t\t})\n\t\t\t\t.css( \"overflow\", \"auto\" );\n\t\t} else if ( heightStyle === \"auto\" ) {\n\t\t\tmaxHeight = 0;\n\t\t\tthis.headers.next()\n\t\t\t\t.each(function() {\n\t\t\t\t\tmaxHeight = Math.max( maxHeight, $( this ).css( \"height\", \"\" ).height() );\n\t\t\t\t})\n\t\t\t\t.height( maxHeight );\n\t\t}\n\t},\n\n\t_activate: function( index ) {\n\t\tvar active = this._findActive( index )[ 0 ];\n\n\t\t// trying to activate the already active panel\n\t\tif ( active === this.active[ 0 ] ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// trying to collapse, simulate a click on the currently active header\n\t\tactive = active || this.active[ 0 ];\n\n\t\tthis._eventHandler({\n\t\t\ttarget: active,\n\t\t\tcurrentTarget: active,\n\t\t\tpreventDefault: $.noop\n\t\t});\n\t},\n\n\t_findActive: function( selector ) {\n\t\treturn typeof selector === \"number\" ? this.headers.eq( selector ) : $();\n\t},\n\n\t_setupEvents: function( event ) {\n\t\tvar events = {\n\t\t\tkeydown: \"_keydown\"\n\t\t};\n\t\tif ( event ) {\n\t\t\t$.each( event.split( \" \" ), function( index, eventName ) {\n\t\t\t\tevents[ eventName ] = \"_eventHandler\";\n\t\t\t});\n\t\t}\n\n\t\tthis._off( this.headers.add( this.headers.next() ) );\n\t\tthis._on( this.headers, events );\n\t\tthis._on( this.headers.next(), { keydown: \"_panelKeyDown\" });\n\t\tthis._hoverable( this.headers );\n\t\tthis._focusable( this.headers );\n\t},\n\n\t_eventHandler: function( event ) {\n\t\tvar options = this.options,\n\t\t\tactive = this.active,\n\t\t\tclicked = $( event.currentTarget ),\n\t\t\tclickedIsActive = clicked[ 0 ] === active[ 0 ],\n\t\t\tcollapsing = clickedIsActive && options.collapsible,\n\t\t\ttoShow = collapsing ? $() : clicked.next(),\n\t\t\ttoHide = active.next(),\n\t\t\teventData = {\n\t\t\t\toldHeader: active,\n\t\t\t\toldPanel: toHide,\n\t\t\t\tnewHeader: collapsing ? $() : clicked,\n\t\t\t\tnewPanel: toShow\n\t\t\t};\n\n\t\tevent.preventDefault();\n\n\t\tif (\n\t\t\t\t// click on active header, but not collapsible\n\t\t\t\t( clickedIsActive && !options.collapsible ) ||\n\t\t\t\t// allow canceling activation\n\t\t\t\t( this._trigger( \"beforeActivate\", event, eventData ) === false ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\toptions.active = collapsing ? false : this.headers.index( clicked );\n\n\t\t// when the call to ._toggle() comes after the class changes\n\t\t// it causes a very odd bug in IE 8 (see #6720)\n\t\tthis.active = clickedIsActive ? $() : clicked;\n\t\tthis._toggle( eventData );\n\n\t\t// switch classes\n\t\t// corner classes on the previously active header stay after the animation\n\t\tactive.removeClass( \"ui-accordion-header-active ui-state-active\" );\n\t\tif ( options.icons ) {\n\t\t\tactive.children( \".ui-accordion-header-icon\" )\n\t\t\t\t.removeClass( options.icons.activeHeader )\n\t\t\t\t.addClass( options.icons.header );\n\t\t}\n\n\t\tif ( !clickedIsActive ) {\n\t\t\tclicked\n\t\t\t\t.removeClass( \"ui-corner-all\" )\n\t\t\t\t.addClass( \"ui-accordion-header-active ui-state-active ui-corner-top\" );\n\t\t\tif ( options.icons ) {\n\t\t\t\tclicked.children( \".ui-accordion-header-icon\" )\n\t\t\t\t\t.removeClass( options.icons.header )\n\t\t\t\t\t.addClass( options.icons.activeHeader );\n\t\t\t}\n\n\t\t\tclicked\n\t\t\t\t.next()\n\t\t\t\t.addClass( \"ui-accordion-content-active\" );\n\t\t}\n\t},\n\n\t_toggle: function( data ) {\n\t\tvar toShow = data.newPanel,\n\t\t\ttoHide = this.prevShow.length ? this.prevShow : data.oldPanel;\n\n\t\t// handle activating a panel during the animation for another activation\n\t\tthis.prevShow.add( this.prevHide ).stop( true, true );\n\t\tthis.prevShow = toShow;\n\t\tthis.prevHide = toHide;\n\n\t\tif ( this.options.animate ) {\n\t\t\tthis._animate( toShow, toHide, data );\n\t\t} else {\n\t\t\ttoHide.hide();\n\t\t\ttoShow.show();\n\t\t\tthis._toggleComplete( data );\n\t\t}\n\n\t\ttoHide.attr({\n\t\t\t\"aria-hidden\": \"true\"\n\t\t});\n\t\ttoHide.prev().attr({\n\t\t\t\"aria-selected\": \"false\",\n\t\t\t\"aria-expanded\": \"false\"\n\t\t});\n\t\t// if we're switching panels, remove the old header from the tab order\n\t\t// if we're opening from collapsed state, remove the previous header from the tab order\n\t\t// if we're collapsing, then keep the collapsing header in the tab order\n\t\tif ( toShow.length && toHide.length ) {\n\t\t\ttoHide.prev().attr({\n\t\t\t\t\"tabIndex\": -1,\n\t\t\t\t\"aria-expanded\": \"false\"\n\t\t\t});\n\t\t} else if ( toShow.length ) {\n\t\t\tthis.headers.filter(function() {\n\t\t\t\treturn parseInt( $( this ).attr( \"tabIndex\" ), 10 ) === 0;\n\t\t\t})\n\t\t\t.attr( \"tabIndex\", -1 );\n\t\t}\n\n\t\ttoShow\n\t\t\t.attr( \"aria-hidden\", \"false\" )\n\t\t\t.prev()\n\t\t\t\t.attr({\n\t\t\t\t\t\"aria-selected\": \"true\",\n\t\t\t\t\t\"aria-expanded\": \"true\",\n\t\t\t\t\ttabIndex: 0\n\t\t\t\t});\n\t},\n\n\t_animate: function( toShow, toHide, data ) {\n\t\tvar total, easing, duration,\n\t\t\tthat = this,\n\t\t\tadjust = 0,\n\t\t\tboxSizing = toShow.css( \"box-sizing\" ),\n\t\t\tdown = toShow.length &&\n\t\t\t\t( !toHide.length || ( toShow.index() < toHide.index() ) ),\n\t\t\tanimate = this.options.animate || {},\n\t\t\toptions = down && animate.down || animate,\n\t\t\tcomplete = function() {\n\t\t\t\tthat._toggleComplete( data );\n\t\t\t};\n\n\t\tif ( typeof options === \"number\" ) {\n\t\t\tduration = options;\n\t\t}\n\t\tif ( typeof options === \"string\" ) {\n\t\t\teasing = options;\n\t\t}\n\t\t// fall back from options to animation in case of partial down settings\n\t\teasing = easing || options.easing || animate.easing;\n\t\tduration = duration || options.duration || animate.duration;\n\n\t\tif ( !toHide.length ) {\n\t\t\treturn toShow.animate( this.showProps, duration, easing, complete );\n\t\t}\n\t\tif ( !toShow.length ) {\n\t\t\treturn toHide.animate( this.hideProps, duration, easing, complete );\n\t\t}\n\n\t\ttotal = toShow.show().outerHeight();\n\t\ttoHide.animate( this.hideProps, {\n\t\t\tduration: duration,\n\t\t\teasing: easing,\n\t\t\tstep: function( now, fx ) {\n\t\t\t\tfx.now = Math.round( now );\n\t\t\t}\n\t\t});\n\t\ttoShow\n\t\t\t.hide()\n\t\t\t.animate( this.showProps, {\n\t\t\t\tduration: duration,\n\t\t\t\teasing: easing,\n\t\t\t\tcomplete: complete,\n\t\t\t\tstep: function( now, fx ) {\n\t\t\t\t\tfx.now = Math.round( now );\n\t\t\t\t\tif ( fx.prop !== \"height\" ) {\n\t\t\t\t\t\tif ( boxSizing === \"content-box\" ) {\n\t\t\t\t\t\t\tadjust += fx.now;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if ( that.options.heightStyle !== \"content\" ) {\n\t\t\t\t\t\tfx.now = Math.round( total - toHide.outerHeight() - adjust );\n\t\t\t\t\t\tadjust = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t},\n\n\t_toggleComplete: function( data ) {\n\t\tvar toHide = data.oldPanel;\n\n\t\ttoHide\n\t\t\t.removeClass( \"ui-accordion-content-active\" )\n\t\t\t.prev()\n\t\t\t\t.removeClass( \"ui-corner-top\" )\n\t\t\t\t.addClass( \"ui-corner-all\" );\n\n\t\t// Work around for rendering bug in IE (#5421)\n\t\tif ( toHide.length ) {\n\t\t\ttoHide.parent()[ 0 ].className = toHide.parent()[ 0 ].className;\n\t\t}\n\t\tthis._trigger( \"activate\", null, data );\n\t}\n});\n\n\n/*!\n * jQuery UI Menu 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/menu/\n */\n\n\nvar menu = $.widget( \"ui.menu\", {\n\tversion: \"1.11.4\",\n\tdefaultElement: \"<ul>\",\n\tdelay: 300,\n\toptions: {\n\t\ticons: {\n\t\t\tsubmenu: \"ui-icon-carat-1-e\"\n\t\t},\n\t\titems: \"> *\",\n\t\tmenus: \"ul\",\n\t\tposition: {\n\t\t\tmy: \"left-1 top\",\n\t\t\tat: \"right top\"\n\t\t},\n\t\trole: \"menu\",\n\n\t\t// callbacks\n\t\tblur: null,\n\t\tfocus: null,\n\t\tselect: null\n\t},\n\n\t_create: function() {\n\t\tthis.activeMenu = this.element;\n\n\t\t// Flag used to prevent firing of the click handler\n\t\t// as the event bubbles up through nested menus\n\t\tthis.mouseHandled = false;\n\t\tthis.element\n\t\t\t.uniqueId()\n\t\t\t.addClass( \"ui-menu ui-widget ui-widget-content\" )\n\t\t\t.toggleClass( \"ui-menu-icons\", !!this.element.find( \".ui-icon\" ).length )\n\t\t\t.attr({\n\t\t\t\trole: this.options.role,\n\t\t\t\ttabIndex: 0\n\t\t\t});\n\n\t\tif ( this.options.disabled ) {\n\t\t\tthis.element\n\t\t\t\t.addClass( \"ui-state-disabled\" )\n\t\t\t\t.attr( \"aria-disabled\", \"true\" );\n\t\t}\n\n\t\tthis._on({\n\t\t\t// Prevent focus from sticking to links inside menu after clicking\n\t\t\t// them (focus should always stay on UL during navigation).\n\t\t\t\"mousedown .ui-menu-item\": function( event ) {\n\t\t\t\tevent.preventDefault();\n\t\t\t},\n\t\t\t\"click .ui-menu-item\": function( event ) {\n\t\t\t\tvar target = $( event.target );\n\t\t\t\tif ( !this.mouseHandled && target.not( \".ui-state-disabled\" ).length ) {\n\t\t\t\t\tthis.select( event );\n\n\t\t\t\t\t// Only set the mouseHandled flag if the event will bubble, see #9469.\n\t\t\t\t\tif ( !event.isPropagationStopped() ) {\n\t\t\t\t\t\tthis.mouseHandled = true;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Open submenu on click\n\t\t\t\t\tif ( target.has( \".ui-menu\" ).length ) {\n\t\t\t\t\t\tthis.expand( event );\n\t\t\t\t\t} else if ( !this.element.is( \":focus\" ) && $( this.document[ 0 ].activeElement ).closest( \".ui-menu\" ).length ) {\n\n\t\t\t\t\t\t// Redirect focus to the menu\n\t\t\t\t\t\tthis.element.trigger( \"focus\", [ true ] );\n\n\t\t\t\t\t\t// If the active item is on the top level, let it stay active.\n\t\t\t\t\t\t// Otherwise, blur the active item since it is no longer visible.\n\t\t\t\t\t\tif ( this.active && this.active.parents( \".ui-menu\" ).length === 1 ) {\n\t\t\t\t\t\t\tclearTimeout( this.timer );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"mouseenter .ui-menu-item\": function( event ) {\n\t\t\t\t// Ignore mouse events while typeahead is active, see #10458.\n\t\t\t\t// Prevents focusing the wrong item when typeahead causes a scroll while the mouse\n\t\t\t\t// is over an item in the menu\n\t\t\t\tif ( this.previousFilter ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar target = $( event.currentTarget );\n\t\t\t\t// Remove ui-state-active class from siblings of the newly focused menu item\n\t\t\t\t// to avoid a jump caused by adjacent elements both having a class with a border\n\t\t\t\ttarget.siblings( \".ui-state-active\" ).removeClass( \"ui-state-active\" );\n\t\t\t\tthis.focus( event, target );\n\t\t\t},\n\t\t\tmouseleave: \"collapseAll\",\n\t\t\t\"mouseleave .ui-menu\": \"collapseAll\",\n\t\t\tfocus: function( event, keepActiveItem ) {\n\t\t\t\t// If there's already an active item, keep it active\n\t\t\t\t// If not, activate the first item\n\t\t\t\tvar item = this.active || this.element.find( this.options.items ).eq( 0 );\n\n\t\t\t\tif ( !keepActiveItem ) {\n\t\t\t\t\tthis.focus( event, item );\n\t\t\t\t}\n\t\t\t},\n\t\t\tblur: function( event ) {\n\t\t\t\tthis._delay(function() {\n\t\t\t\t\tif ( !$.contains( this.element[0], this.document[0].activeElement ) ) {\n\t\t\t\t\t\tthis.collapseAll( event );\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tkeydown: \"_keydown\"\n\t\t});\n\n\t\tthis.refresh();\n\n\t\t// Clicks outside of a menu collapse any open menus\n\t\tthis._on( this.document, {\n\t\t\tclick: function( event ) {\n\t\t\t\tif ( this._closeOnDocumentClick( event ) ) {\n\t\t\t\t\tthis.collapseAll( event );\n\t\t\t\t}\n\n\t\t\t\t// Reset the mouseHandled flag\n\t\t\t\tthis.mouseHandled = false;\n\t\t\t}\n\t\t});\n\t},\n\n\t_destroy: function() {\n\t\t// Destroy (sub)menus\n\t\tthis.element\n\t\t\t.removeAttr( \"aria-activedescendant\" )\n\t\t\t.find( \".ui-menu\" ).addBack()\n\t\t\t\t.removeClass( \"ui-menu ui-widget ui-widget-content ui-menu-icons ui-front\" )\n\t\t\t\t.removeAttr( \"role\" )\n\t\t\t\t.removeAttr( \"tabIndex\" )\n\t\t\t\t.removeAttr( \"aria-labelledby\" )\n\t\t\t\t.removeAttr( \"aria-expanded\" )\n\t\t\t\t.removeAttr( \"aria-hidden\" )\n\t\t\t\t.removeAttr( \"aria-disabled\" )\n\t\t\t\t.removeUniqueId()\n\t\t\t\t.show();\n\n\t\t// Destroy menu items\n\t\tthis.element.find( \".ui-menu-item\" )\n\t\t\t.removeClass( \"ui-menu-item\" )\n\t\t\t.removeAttr( \"role\" )\n\t\t\t.removeAttr( \"aria-disabled\" )\n\t\t\t.removeUniqueId()\n\t\t\t.removeClass( \"ui-state-hover\" )\n\t\t\t.removeAttr( \"tabIndex\" )\n\t\t\t.removeAttr( \"role\" )\n\t\t\t.removeAttr( \"aria-haspopup\" )\n\t\t\t.children().each( function() {\n\t\t\t\tvar elem = $( this );\n\t\t\t\tif ( elem.data( \"ui-menu-submenu-carat\" ) ) {\n\t\t\t\t\telem.remove();\n\t\t\t\t}\n\t\t\t});\n\n\t\t// Destroy menu dividers\n\t\tthis.element.find( \".ui-menu-divider\" ).removeClass( \"ui-menu-divider ui-widget-content\" );\n\t},\n\n\t_keydown: function( event ) {\n\t\tvar match, prev, character, skip,\n\t\t\tpreventDefault = true;\n\n\t\tswitch ( event.keyCode ) {\n\t\tcase $.ui.keyCode.PAGE_UP:\n\t\t\tthis.previousPage( event );\n\t\t\tbreak;\n\t\tcase $.ui.keyCode.PAGE_DOWN:\n\t\t\tthis.nextPage( event );\n\t\t\tbreak;\n\t\tcase $.ui.keyCode.HOME:\n\t\t\tthis._move( \"first\", \"first\", event );\n\t\t\tbreak;\n\t\tcase $.ui.keyCode.END:\n\t\t\tthis._move( \"last\", \"last\", event );\n\t\t\tbreak;\n\t\tcase $.ui.keyCode.UP:\n\t\t\tthis.previous( event );\n\t\t\tbreak;\n\t\tcase $.ui.keyCode.DOWN:\n\t\t\tthis.next( event );\n\t\t\tbreak;\n\t\tcase $.ui.keyCode.LEFT:\n\t\t\tthis.collapse( event );\n\t\t\tbreak;\n\t\tcase $.ui.keyCode.RIGHT:\n\t\t\tif ( this.active && !this.active.is( \".ui-state-disabled\" ) ) {\n\t\t\t\tthis.expand( event );\n\t\t\t}\n\t\t\tbreak;\n\t\tcase $.ui.keyCode.ENTER:\n\t\tcase $.ui.keyCode.SPACE:\n\t\t\tthis._activate( event );\n\t\t\tbreak;\n\t\tcase $.ui.keyCode.ESCAPE:\n\t\t\tthis.collapse( event );\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tpreventDefault = false;\n\t\t\tprev = this.previousFilter || \"\";\n\t\t\tcharacter = String.fromCharCode( event.keyCode );\n\t\t\tskip = false;\n\n\t\t\tclearTimeout( this.filterTimer );\n\n\t\t\tif ( character === prev ) {\n\t\t\t\tskip = true;\n\t\t\t} else {\n\t\t\t\tcharacter = prev + character;\n\t\t\t}\n\n\t\t\tmatch = this._filterMenuItems( character );\n\t\t\tmatch = skip && match.index( this.active.next() ) !== -1 ?\n\t\t\t\tthis.active.nextAll( \".ui-menu-item\" ) :\n\t\t\t\tmatch;\n\n\t\t\t// If no matches on the current filter, reset to the last character pressed\n\t\t\t// to move down the menu to the first item that starts with that character\n\t\t\tif ( !match.length ) {\n\t\t\t\tcharacter = String.fromCharCode( event.keyCode );\n\t\t\t\tmatch = this._filterMenuItems( character );\n\t\t\t}\n\n\t\t\tif ( match.length ) {\n\t\t\t\tthis.focus( event, match );\n\t\t\t\tthis.previousFilter = character;\n\t\t\t\tthis.filterTimer = this._delay(function() {\n\t\t\t\t\tdelete this.previousFilter;\n\t\t\t\t}, 1000 );\n\t\t\t} else {\n\t\t\t\tdelete this.previousFilter;\n\t\t\t}\n\t\t}\n\n\t\tif ( preventDefault ) {\n\t\t\tevent.preventDefault();\n\t\t}\n\t},\n\n\t_activate: function( event ) {\n\t\tif ( !this.active.is( \".ui-state-disabled\" ) ) {\n\t\t\tif ( this.active.is( \"[aria-haspopup='true']\" ) ) {\n\t\t\t\tthis.expand( event );\n\t\t\t} else {\n\t\t\t\tthis.select( event );\n\t\t\t}\n\t\t}\n\t},\n\n\trefresh: function() {\n\t\tvar menus, items,\n\t\t\tthat = this,\n\t\t\ticon = this.options.icons.submenu,\n\t\t\tsubmenus = this.element.find( this.options.menus );\n\n\t\tthis.element.toggleClass( \"ui-menu-icons\", !!this.element.find( \".ui-icon\" ).length );\n\n\t\t// Initialize nested menus\n\t\tsubmenus.filter( \":not(.ui-menu)\" )\n\t\t\t.addClass( \"ui-menu ui-widget ui-widget-content ui-front\" )\n\t\t\t.hide()\n\t\t\t.attr({\n\t\t\t\trole: this.options.role,\n\t\t\t\t\"aria-hidden\": \"true\",\n\t\t\t\t\"aria-expanded\": \"false\"\n\t\t\t})\n\t\t\t.each(function() {\n\t\t\t\tvar menu = $( this ),\n\t\t\t\t\titem = menu.parent(),\n\t\t\t\t\tsubmenuCarat = $( \"<span>\" )\n\t\t\t\t\t\t.addClass( \"ui-menu-icon ui-icon \" + icon )\n\t\t\t\t\t\t.data( \"ui-menu-submenu-carat\", true );\n\n\t\t\t\titem\n\t\t\t\t\t.attr( \"aria-haspopup\", \"true\" )\n\t\t\t\t\t.prepend( submenuCarat );\n\t\t\t\tmenu.attr( \"aria-labelledby\", item.attr( \"id\" ) );\n\t\t\t});\n\n\t\tmenus = submenus.add( this.element );\n\t\titems = menus.find( this.options.items );\n\n\t\t// Initialize menu-items containing spaces and/or dashes only as dividers\n\t\titems.not( \".ui-menu-item\" ).each(function() {\n\t\t\tvar item = $( this );\n\t\t\tif ( that._isDivider( item ) ) {\n\t\t\t\titem.addClass( \"ui-widget-content ui-menu-divider\" );\n\t\t\t}\n\t\t});\n\n\t\t// Don't refresh list items that are already adapted\n\t\titems.not( \".ui-menu-item, .ui-menu-divider\" )\n\t\t\t.addClass( \"ui-menu-item\" )\n\t\t\t.uniqueId()\n\t\t\t.attr({\n\t\t\t\ttabIndex: -1,\n\t\t\t\trole: this._itemRole()\n\t\t\t});\n\n\t\t// Add aria-disabled attribute to any disabled menu item\n\t\titems.filter( \".ui-state-disabled\" ).attr( \"aria-disabled\", \"true\" );\n\n\t\t// If the active item has been removed, blur the menu\n\t\tif ( this.active && !$.contains( this.element[ 0 ], this.active[ 0 ] ) ) {\n\t\t\tthis.blur();\n\t\t}\n\t},\n\n\t_itemRole: function() {\n\t\treturn {\n\t\t\tmenu: \"menuitem\",\n\t\t\tlistbox: \"option\"\n\t\t}[ this.options.role ];\n\t},\n\n\t_setOption: function( key, value ) {\n\t\tif ( key === \"icons\" ) {\n\t\t\tthis.element.find( \".ui-menu-icon\" )\n\t\t\t\t.removeClass( this.options.icons.submenu )\n\t\t\t\t.addClass( value.submenu );\n\t\t}\n\t\tif ( key === \"disabled\" ) {\n\t\t\tthis.element\n\t\t\t\t.toggleClass( \"ui-state-disabled\", !!value )\n\t\t\t\t.attr( \"aria-disabled\", value );\n\t\t}\n\t\tthis._super( key, value );\n\t},\n\n\tfocus: function( event, item ) {\n\t\tvar nested, focused;\n\t\tthis.blur( event, event && event.type === \"focus\" );\n\n\t\tthis._scrollIntoView( item );\n\n\t\tthis.active = item.first();\n\t\tfocused = this.active.addClass( \"ui-state-focus\" ).removeClass( \"ui-state-active\" );\n\t\t// Only update aria-activedescendant if there's a role\n\t\t// otherwise we assume focus is managed elsewhere\n\t\tif ( this.options.role ) {\n\t\t\tthis.element.attr( \"aria-activedescendant\", focused.attr( \"id\" ) );\n\t\t}\n\n\t\t// Highlight active parent menu item, if any\n\t\tthis.active\n\t\t\t.parent()\n\t\t\t.closest( \".ui-menu-item\" )\n\t\t\t.addClass( \"ui-state-active\" );\n\n\t\tif ( event && event.type === \"keydown\" ) {\n\t\t\tthis._close();\n\t\t} else {\n\t\t\tthis.timer = this._delay(function() {\n\t\t\t\tthis._close();\n\t\t\t}, this.delay );\n\t\t}\n\n\t\tnested = item.children( \".ui-menu\" );\n\t\tif ( nested.length && event && ( /^mouse/.test( event.type ) ) ) {\n\t\t\tthis._startOpening(nested);\n\t\t}\n\t\tthis.activeMenu = item.parent();\n\n\t\tthis._trigger( \"focus\", event, { item: item } );\n\t},\n\n\t_scrollIntoView: function( item ) {\n\t\tvar borderTop, paddingTop, offset, scroll, elementHeight, itemHeight;\n\t\tif ( this._hasScroll() ) {\n\t\t\tborderTop = parseFloat( $.css( this.activeMenu[0], \"borderTopWidth\" ) ) || 0;\n\t\t\tpaddingTop = parseFloat( $.css( this.activeMenu[0], \"paddingTop\" ) ) || 0;\n\t\t\toffset = item.offset().top - this.activeMenu.offset().top - borderTop - paddingTop;\n\t\t\tscroll = this.activeMenu.scrollTop();\n\t\t\telementHeight = this.activeMenu.height();\n\t\t\titemHeight = item.outerHeight();\n\n\t\t\tif ( offset < 0 ) {\n\t\t\t\tthis.activeMenu.scrollTop( scroll + offset );\n\t\t\t} else if ( offset + itemHeight > elementHeight ) {\n\t\t\t\tthis.activeMenu.scrollTop( scroll + offset - elementHeight + itemHeight );\n\t\t\t}\n\t\t}\n\t},\n\n\tblur: function( event, fromFocus ) {\n\t\tif ( !fromFocus ) {\n\t\t\tclearTimeout( this.timer );\n\t\t}\n\n\t\tif ( !this.active ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.active.removeClass( \"ui-state-focus\" );\n\t\tthis.active = null;\n\n\t\tthis._trigger( \"blur\", event, { item: this.active } );\n\t},\n\n\t_startOpening: function( submenu ) {\n\t\tclearTimeout( this.timer );\n\n\t\t// Don't open if already open fixes a Firefox bug that caused a .5 pixel\n\t\t// shift in the submenu position when mousing over the carat icon\n\t\tif ( submenu.attr( \"aria-hidden\" ) !== \"true\" ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.timer = this._delay(function() {\n\t\t\tthis._close();\n\t\t\tthis._open( submenu );\n\t\t}, this.delay );\n\t},\n\n\t_open: function( submenu ) {\n\t\tvar position = $.extend({\n\t\t\tof: this.active\n\t\t}, this.options.position );\n\n\t\tclearTimeout( this.timer );\n\t\tthis.element.find( \".ui-menu\" ).not( submenu.parents( \".ui-menu\" ) )\n\t\t\t.hide()\n\t\t\t.attr( \"aria-hidden\", \"true\" );\n\n\t\tsubmenu\n\t\t\t.show()\n\t\t\t.removeAttr( \"aria-hidden\" )\n\t\t\t.attr( \"aria-expanded\", \"true\" )\n\t\t\t.position( position );\n\t},\n\n\tcollapseAll: function( event, all ) {\n\t\tclearTimeout( this.timer );\n\t\tthis.timer = this._delay(function() {\n\t\t\t// If we were passed an event, look for the submenu that contains the event\n\t\t\tvar currentMenu = all ? this.element :\n\t\t\t\t$( event && event.target ).closest( this.element.find( \".ui-menu\" ) );\n\n\t\t\t// If we found no valid submenu ancestor, use the main menu to close all sub menus anyway\n\t\t\tif ( !currentMenu.length ) {\n\t\t\t\tcurrentMenu = this.element;\n\t\t\t}\n\n\t\t\tthis._close( currentMenu );\n\n\t\t\tthis.blur( event );\n\t\t\tthis.activeMenu = currentMenu;\n\t\t}, this.delay );\n\t},\n\n\t// With no arguments, closes the currently active menu - if nothing is active\n\t// it closes all menus.  If passed an argument, it will search for menus BELOW\n\t_close: function( startMenu ) {\n\t\tif ( !startMenu ) {\n\t\t\tstartMenu = this.active ? this.active.parent() : this.element;\n\t\t}\n\n\t\tstartMenu\n\t\t\t.find( \".ui-menu\" )\n\t\t\t\t.hide()\n\t\t\t\t.attr( \"aria-hidden\", \"true\" )\n\t\t\t\t.attr( \"aria-expanded\", \"false\" )\n\t\t\t.end()\n\t\t\t.find( \".ui-state-active\" ).not( \".ui-state-focus\" )\n\t\t\t\t.removeClass( \"ui-state-active\" );\n\t},\n\n\t_closeOnDocumentClick: function( event ) {\n\t\treturn !$( event.target ).closest( \".ui-menu\" ).length;\n\t},\n\n\t_isDivider: function( item ) {\n\n\t\t// Match hyphen, em dash, en dash\n\t\treturn !/[^\\-\\u2014\\u2013\\s]/.test( item.text() );\n\t},\n\n\tcollapse: function( event ) {\n\t\tvar newItem = this.active &&\n\t\t\tthis.active.parent().closest( \".ui-menu-item\", this.element );\n\t\tif ( newItem && newItem.length ) {\n\t\t\tthis._close();\n\t\t\tthis.focus( event, newItem );\n\t\t}\n\t},\n\n\texpand: function( event ) {\n\t\tvar newItem = this.active &&\n\t\t\tthis.active\n\t\t\t\t.children( \".ui-menu \" )\n\t\t\t\t.find( this.options.items )\n\t\t\t\t.first();\n\n\t\tif ( newItem && newItem.length ) {\n\t\t\tthis._open( newItem.parent() );\n\n\t\t\t// Delay so Firefox will not hide activedescendant change in expanding submenu from AT\n\t\t\tthis._delay(function() {\n\t\t\t\tthis.focus( event, newItem );\n\t\t\t});\n\t\t}\n\t},\n\n\tnext: function( event ) {\n\t\tthis._move( \"next\", \"first\", event );\n\t},\n\n\tprevious: function( event ) {\n\t\tthis._move( \"prev\", \"last\", event );\n\t},\n\n\tisFirstItem: function() {\n\t\treturn this.active && !this.active.prevAll( \".ui-menu-item\" ).length;\n\t},\n\n\tisLastItem: function() {\n\t\treturn this.active && !this.active.nextAll( \".ui-menu-item\" ).length;\n\t},\n\n\t_move: function( direction, filter, event ) {\n\t\tvar next;\n\t\tif ( this.active ) {\n\t\t\tif ( direction === \"first\" || direction === \"last\" ) {\n\t\t\t\tnext = this.active\n\t\t\t\t\t[ direction === \"first\" ? \"prevAll\" : \"nextAll\" ]( \".ui-menu-item\" )\n\t\t\t\t\t.eq( -1 );\n\t\t\t} else {\n\t\t\t\tnext = this.active\n\t\t\t\t\t[ direction + \"All\" ]( \".ui-menu-item\" )\n\t\t\t\t\t.eq( 0 );\n\t\t\t}\n\t\t}\n\t\tif ( !next || !next.length || !this.active ) {\n\t\t\tnext = this.activeMenu.find( this.options.items )[ filter ]();\n\t\t}\n\n\t\tthis.focus( event, next );\n\t},\n\n\tnextPage: function( event ) {\n\t\tvar item, base, height;\n\n\t\tif ( !this.active ) {\n\t\t\tthis.next( event );\n\t\t\treturn;\n\t\t}\n\t\tif ( this.isLastItem() ) {\n\t\t\treturn;\n\t\t}\n\t\tif ( this._hasScroll() ) {\n\t\t\tbase = this.active.offset().top;\n\t\t\theight = this.element.height();\n\t\t\tthis.active.nextAll( \".ui-menu-item\" ).each(function() {\n\t\t\t\titem = $( this );\n\t\t\t\treturn item.offset().top - base - height < 0;\n\t\t\t});\n\n\t\t\tthis.focus( event, item );\n\t\t} else {\n\t\t\tthis.focus( event, this.activeMenu.find( this.options.items )\n\t\t\t\t[ !this.active ? \"first\" : \"last\" ]() );\n\t\t}\n\t},\n\n\tpreviousPage: function( event ) {\n\t\tvar item, base, height;\n\t\tif ( !this.active ) {\n\t\t\tthis.next( event );\n\t\t\treturn;\n\t\t}\n\t\tif ( this.isFirstItem() ) {\n\t\t\treturn;\n\t\t}\n\t\tif ( this._hasScroll() ) {\n\t\t\tbase = this.active.offset().top;\n\t\t\theight = this.element.height();\n\t\t\tthis.active.prevAll( \".ui-menu-item\" ).each(function() {\n\t\t\t\titem = $( this );\n\t\t\t\treturn item.offset().top - base + height > 0;\n\t\t\t});\n\n\t\t\tthis.focus( event, item );\n\t\t} else {\n\t\t\tthis.focus( event, this.activeMenu.find( this.options.items ).first() );\n\t\t}\n\t},\n\n\t_hasScroll: function() {\n\t\treturn this.element.outerHeight() < this.element.prop( \"scrollHeight\" );\n\t},\n\n\tselect: function( event ) {\n\t\t// TODO: It should never be possible to not have an active item at this\n\t\t// point, but the tests don't trigger mouseenter before click.\n\t\tthis.active = this.active || $( event.target ).closest( \".ui-menu-item\" );\n\t\tvar ui = { item: this.active };\n\t\tif ( !this.active.has( \".ui-menu\" ).length ) {\n\t\t\tthis.collapseAll( event, true );\n\t\t}\n\t\tthis._trigger( \"select\", event, ui );\n\t},\n\n\t_filterMenuItems: function(character) {\n\t\tvar escapedCharacter = character.replace( /[\\-\\[\\]{}()*+?.,\\\\\\^$|#\\s]/g, \"\\\\$&\" ),\n\t\t\tregex = new RegExp( \"^\" + escapedCharacter, \"i\" );\n\n\t\treturn this.activeMenu\n\t\t\t.find( this.options.items )\n\n\t\t\t// Only match on items, not dividers or other content (#10571)\n\t\t\t.filter( \".ui-menu-item\" )\n\t\t\t.filter(function() {\n\t\t\t\treturn regex.test( $.trim( $( this ).text() ) );\n\t\t\t});\n\t}\n});\n\n\n/*!\n * jQuery UI Autocomplete 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/autocomplete/\n */\n\n\n$.widget( \"ui.autocomplete\", {\n\tversion: \"1.11.4\",\n\tdefaultElement: \"<input>\",\n\toptions: {\n\t\tappendTo: null,\n\t\tautoFocus: false,\n\t\tdelay: 300,\n\t\tminLength: 1,\n\t\tposition: {\n\t\t\tmy: \"left top\",\n\t\t\tat: \"left bottom\",\n\t\t\tcollision: \"none\"\n\t\t},\n\t\tsource: null,\n\n\t\t// callbacks\n\t\tchange: null,\n\t\tclose: null,\n\t\tfocus: null,\n\t\topen: null,\n\t\tresponse: null,\n\t\tsearch: null,\n\t\tselect: null\n\t},\n\n\trequestIndex: 0,\n\tpending: 0,\n\n\t_create: function() {\n\t\t// Some browsers only repeat keydown events, not keypress events,\n\t\t// so we use the suppressKeyPress flag to determine if we've already\n\t\t// handled the keydown event. #7269\n\t\t// Unfortunately the code for & in keypress is the same as the up arrow,\n\t\t// so we use the suppressKeyPressRepeat flag to avoid handling keypress\n\t\t// events when we know the keydown event was used to modify the\n\t\t// search term. #7799\n\t\tvar suppressKeyPress, suppressKeyPressRepeat, suppressInput,\n\t\t\tnodeName = this.element[ 0 ].nodeName.toLowerCase(),\n\t\t\tisTextarea = nodeName === \"textarea\",\n\t\t\tisInput = nodeName === \"input\";\n\n\t\tthis.isMultiLine =\n\t\t\t// Textareas are always multi-line\n\t\t\tisTextarea ? true :\n\t\t\t// Inputs are always single-line, even if inside a contentEditable element\n\t\t\t// IE also treats inputs as contentEditable\n\t\t\tisInput ? false :\n\t\t\t// All other element types are determined by whether or not they're contentEditable\n\t\t\tthis.element.prop( \"isContentEditable\" );\n\n\t\tthis.valueMethod = this.element[ isTextarea || isInput ? \"val\" : \"text\" ];\n\t\tthis.isNewMenu = true;\n\n\t\tthis.element\n\t\t\t.addClass( \"ui-autocomplete-input\" )\n\t\t\t.attr( \"autocomplete\", \"off\" );\n\n\t\tthis._on( this.element, {\n\t\t\tkeydown: function( event ) {\n\t\t\t\tif ( this.element.prop( \"readOnly\" ) ) {\n\t\t\t\t\tsuppressKeyPress = true;\n\t\t\t\t\tsuppressInput = true;\n\t\t\t\t\tsuppressKeyPressRepeat = true;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tsuppressKeyPress = false;\n\t\t\t\tsuppressInput = false;\n\t\t\t\tsuppressKeyPressRepeat = false;\n\t\t\t\tvar keyCode = $.ui.keyCode;\n\t\t\t\tswitch ( event.keyCode ) {\n\t\t\t\tcase keyCode.PAGE_UP:\n\t\t\t\t\tsuppressKeyPress = true;\n\t\t\t\t\tthis._move( \"previousPage\", event );\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyCode.PAGE_DOWN:\n\t\t\t\t\tsuppressKeyPress = true;\n\t\t\t\t\tthis._move( \"nextPage\", event );\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyCode.UP:\n\t\t\t\t\tsuppressKeyPress = true;\n\t\t\t\t\tthis._keyEvent( \"previous\", event );\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyCode.DOWN:\n\t\t\t\t\tsuppressKeyPress = true;\n\t\t\t\t\tthis._keyEvent( \"next\", event );\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyCode.ENTER:\n\t\t\t\t\t// when menu is open and has focus\n\t\t\t\t\tif ( this.menu.active ) {\n\t\t\t\t\t\t// #6055 - Opera still allows the keypress to occur\n\t\t\t\t\t\t// which causes forms to submit\n\t\t\t\t\t\tsuppressKeyPress = true;\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tthis.menu.select( event );\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyCode.TAB:\n\t\t\t\t\tif ( this.menu.active ) {\n\t\t\t\t\t\tthis.menu.select( event );\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyCode.ESCAPE:\n\t\t\t\t\tif ( this.menu.element.is( \":visible\" ) ) {\n\t\t\t\t\t\tif ( !this.isMultiLine ) {\n\t\t\t\t\t\t\tthis._value( this.term );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.close( event );\n\t\t\t\t\t\t// Different browsers have different default behavior for escape\n\t\t\t\t\t\t// Single press can mean undo or clear\n\t\t\t\t\t\t// Double press in IE means clear the whole form\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tsuppressKeyPressRepeat = true;\n\t\t\t\t\t// search timeout should be triggered before the input value is changed\n\t\t\t\t\tthis._searchTimeout( event );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t},\n\t\t\tkeypress: function( event ) {\n\t\t\t\tif ( suppressKeyPress ) {\n\t\t\t\t\tsuppressKeyPress = false;\n\t\t\t\t\tif ( !this.isMultiLine || this.menu.element.is( \":visible\" ) ) {\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif ( suppressKeyPressRepeat ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// replicate some key handlers to allow them to repeat in Firefox and Opera\n\t\t\t\tvar keyCode = $.ui.keyCode;\n\t\t\t\tswitch ( event.keyCode ) {\n\t\t\t\tcase keyCode.PAGE_UP:\n\t\t\t\t\tthis._move( \"previousPage\", event );\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyCode.PAGE_DOWN:\n\t\t\t\t\tthis._move( \"nextPage\", event );\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyCode.UP:\n\t\t\t\t\tthis._keyEvent( \"previous\", event );\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyCode.DOWN:\n\t\t\t\t\tthis._keyEvent( \"next\", event );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t},\n\t\t\tinput: function( event ) {\n\t\t\t\tif ( suppressInput ) {\n\t\t\t\t\tsuppressInput = false;\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis._searchTimeout( event );\n\t\t\t},\n\t\t\tfocus: function() {\n\t\t\t\tthis.selectedItem = null;\n\t\t\t\tthis.previous = this._value();\n\t\t\t},\n\t\t\tblur: function( event ) {\n\t\t\t\tif ( this.cancelBlur ) {\n\t\t\t\t\tdelete this.cancelBlur;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tclearTimeout( this.searching );\n\t\t\t\tthis.close( event );\n\t\t\t\tthis._change( event );\n\t\t\t}\n\t\t});\n\n\t\tthis._initSource();\n\t\tthis.menu = $( \"<ul>\" )\n\t\t\t.addClass( \"ui-autocomplete ui-front\" )\n\t\t\t.appendTo( this._appendTo() )\n\t\t\t.menu({\n\t\t\t\t// disable ARIA support, the live region takes care of that\n\t\t\t\trole: null\n\t\t\t})\n\t\t\t.hide()\n\t\t\t.menu( \"instance\" );\n\n\t\tthis._on( this.menu.element, {\n\t\t\tmousedown: function( event ) {\n\t\t\t\t// prevent moving focus out of the text field\n\t\t\t\tevent.preventDefault();\n\n\t\t\t\t// IE doesn't prevent moving focus even with event.preventDefault()\n\t\t\t\t// so we set a flag to know when we should ignore the blur event\n\t\t\t\tthis.cancelBlur = true;\n\t\t\t\tthis._delay(function() {\n\t\t\t\t\tdelete this.cancelBlur;\n\t\t\t\t});\n\n\t\t\t\t// clicking on the scrollbar causes focus to shift to the body\n\t\t\t\t// but we can't detect a mouseup or a click immediately afterward\n\t\t\t\t// so we have to track the next mousedown and close the menu if\n\t\t\t\t// the user clicks somewhere outside of the autocomplete\n\t\t\t\tvar menuElement = this.menu.element[ 0 ];\n\t\t\t\tif ( !$( event.target ).closest( \".ui-menu-item\" ).length ) {\n\t\t\t\t\tthis._delay(function() {\n\t\t\t\t\t\tvar that = this;\n\t\t\t\t\t\tthis.document.one( \"mousedown\", function( event ) {\n\t\t\t\t\t\t\tif ( event.target !== that.element[ 0 ] &&\n\t\t\t\t\t\t\t\t\tevent.target !== menuElement &&\n\t\t\t\t\t\t\t\t\t!$.contains( menuElement, event.target ) ) {\n\t\t\t\t\t\t\t\tthat.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tmenufocus: function( event, ui ) {\n\t\t\t\tvar label, item;\n\t\t\t\t// support: Firefox\n\t\t\t\t// Prevent accidental activation of menu items in Firefox (#7024 #9118)\n\t\t\t\tif ( this.isNewMenu ) {\n\t\t\t\t\tthis.isNewMenu = false;\n\t\t\t\t\tif ( event.originalEvent && /^mouse/.test( event.originalEvent.type ) ) {\n\t\t\t\t\t\tthis.menu.blur();\n\n\t\t\t\t\t\tthis.document.one( \"mousemove\", function() {\n\t\t\t\t\t\t\t$( event.target ).trigger( event.originalEvent );\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\titem = ui.item.data( \"ui-autocomplete-item\" );\n\t\t\t\tif ( false !== this._trigger( \"focus\", event, { item: item } ) ) {\n\t\t\t\t\t// use value to match what will end up in the input, if it was a key event\n\t\t\t\t\tif ( event.originalEvent && /^key/.test( event.originalEvent.type ) ) {\n\t\t\t\t\t\tthis._value( item.value );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Announce the value in the liveRegion\n\t\t\t\tlabel = ui.item.attr( \"aria-label\" ) || item.value;\n\t\t\t\tif ( label && $.trim( label ).length ) {\n\t\t\t\t\tthis.liveRegion.children().hide();\n\t\t\t\t\t$( \"<div>\" ).text( label ).appendTo( this.liveRegion );\n\t\t\t\t}\n\t\t\t},\n\t\t\tmenuselect: function( event, ui ) {\n\t\t\t\tvar item = ui.item.data( \"ui-autocomplete-item\" ),\n\t\t\t\t\tprevious = this.previous;\n\n\t\t\t\t// only trigger when focus was lost (click on menu)\n\t\t\t\tif ( this.element[ 0 ] !== this.document[ 0 ].activeElement ) {\n\t\t\t\t\tthis.element.focus();\n\t\t\t\t\tthis.previous = previous;\n\t\t\t\t\t// #6109 - IE triggers two focus events and the second\n\t\t\t\t\t// is asynchronous, so we need to reset the previous\n\t\t\t\t\t// term synchronously and asynchronously :-(\n\t\t\t\t\tthis._delay(function() {\n\t\t\t\t\t\tthis.previous = previous;\n\t\t\t\t\t\tthis.selectedItem = item;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif ( false !== this._trigger( \"select\", event, { item: item } ) ) {\n\t\t\t\t\tthis._value( item.value );\n\t\t\t\t}\n\t\t\t\t// reset the term after the select event\n\t\t\t\t// this allows custom select handling to work properly\n\t\t\t\tthis.term = this._value();\n\n\t\t\t\tthis.close( event );\n\t\t\t\tthis.selectedItem = item;\n\t\t\t}\n\t\t});\n\n\t\tthis.liveRegion = $( \"<span>\", {\n\t\t\t\trole: \"status\",\n\t\t\t\t\"aria-live\": \"assertive\",\n\t\t\t\t\"aria-relevant\": \"additions\"\n\t\t\t})\n\t\t\t.addClass( \"ui-helper-hidden-accessible\" )\n\t\t\t.appendTo( this.document[ 0 ].body );\n\n\t\t// turning off autocomplete prevents the browser from remembering the\n\t\t// value when navigating through history, so we re-enable autocomplete\n\t\t// if the page is unloaded before the widget is destroyed. #7790\n\t\tthis._on( this.window, {\n\t\t\tbeforeunload: function() {\n\t\t\t\tthis.element.removeAttr( \"autocomplete\" );\n\t\t\t}\n\t\t});\n\t},\n\n\t_destroy: function() {\n\t\tclearTimeout( this.searching );\n\t\tthis.element\n\t\t\t.removeClass( \"ui-autocomplete-input\" )\n\t\t\t.removeAttr( \"autocomplete\" );\n\t\tthis.menu.element.remove();\n\t\tthis.liveRegion.remove();\n\t},\n\n\t_setOption: function( key, value ) {\n\t\tthis._super( key, value );\n\t\tif ( key === \"source\" ) {\n\t\t\tthis._initSource();\n\t\t}\n\t\tif ( key === \"appendTo\" ) {\n\t\t\tthis.menu.element.appendTo( this._appendTo() );\n\t\t}\n\t\tif ( key === \"disabled\" && value && this.xhr ) {\n\t\t\tthis.xhr.abort();\n\t\t}\n\t},\n\n\t_appendTo: function() {\n\t\tvar element = this.options.appendTo;\n\n\t\tif ( element ) {\n\t\t\telement = element.jquery || element.nodeType ?\n\t\t\t\t$( element ) :\n\t\t\t\tthis.document.find( element ).eq( 0 );\n\t\t}\n\n\t\tif ( !element || !element[ 0 ] ) {\n\t\t\telement = this.element.closest( \".ui-front\" );\n\t\t}\n\n\t\tif ( !element.length ) {\n\t\t\telement = this.document[ 0 ].body;\n\t\t}\n\n\t\treturn element;\n\t},\n\n\t_initSource: function() {\n\t\tvar array, url,\n\t\t\tthat = this;\n\t\tif ( $.isArray( this.options.source ) ) {\n\t\t\tarray = this.options.source;\n\t\t\tthis.source = function( request, response ) {\n\t\t\t\tresponse( $.ui.autocomplete.filter( array, request.term ) );\n\t\t\t};\n\t\t} else if ( typeof this.options.source === \"string\" ) {\n\t\t\turl = this.options.source;\n\t\t\tthis.source = function( request, response ) {\n\t\t\t\tif ( that.xhr ) {\n\t\t\t\t\tthat.xhr.abort();\n\t\t\t\t}\n\t\t\t\tthat.xhr = $.ajax({\n\t\t\t\t\turl: url,\n\t\t\t\t\tdata: request,\n\t\t\t\t\tdataType: \"json\",\n\t\t\t\t\tsuccess: function( data ) {\n\t\t\t\t\t\tresponse( data );\n\t\t\t\t\t},\n\t\t\t\t\terror: function() {\n\t\t\t\t\t\tresponse([]);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\t\t} else {\n\t\t\tthis.source = this.options.source;\n\t\t}\n\t},\n\n\t_searchTimeout: function( event ) {\n\t\tclearTimeout( this.searching );\n\t\tthis.searching = this._delay(function() {\n\n\t\t\t// Search if the value has changed, or if the user retypes the same value (see #7434)\n\t\t\tvar equalValues = this.term === this._value(),\n\t\t\t\tmenuVisible = this.menu.element.is( \":visible\" ),\n\t\t\t\tmodifierKey = event.altKey || event.ctrlKey || event.metaKey || event.shiftKey;\n\n\t\t\tif ( !equalValues || ( equalValues && !menuVisible && !modifierKey ) ) {\n\t\t\t\tthis.selectedItem = null;\n\t\t\t\tthis.search( null, event );\n\t\t\t}\n\t\t}, this.options.delay );\n\t},\n\n\tsearch: function( value, event ) {\n\t\tvalue = value != null ? value : this._value();\n\n\t\t// always save the actual value, not the one passed as an argument\n\t\tthis.term = this._value();\n\n\t\tif ( value.length < this.options.minLength ) {\n\t\t\treturn this.close( event );\n\t\t}\n\n\t\tif ( this._trigger( \"search\", event ) === false ) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn this._search( value );\n\t},\n\n\t_search: function( value ) {\n\t\tthis.pending++;\n\t\tthis.element.addClass( \"ui-autocomplete-loading\" );\n\t\tthis.cancelSearch = false;\n\n\t\tthis.source( { term: value }, this._response() );\n\t},\n\n\t_response: function() {\n\t\tvar index = ++this.requestIndex;\n\n\t\treturn $.proxy(function( content ) {\n\t\t\tif ( index === this.requestIndex ) {\n\t\t\t\tthis.__response( content );\n\t\t\t}\n\n\t\t\tthis.pending--;\n\t\t\tif ( !this.pending ) {\n\t\t\t\tthis.element.removeClass( \"ui-autocomplete-loading\" );\n\t\t\t}\n\t\t}, this );\n\t},\n\n\t__response: function( content ) {\n\t\tif ( content ) {\n\t\t\tcontent = this._normalize( content );\n\t\t}\n\t\tthis._trigger( \"response\", null, { content: content } );\n\t\tif ( !this.options.disabled && content && content.length && !this.cancelSearch ) {\n\t\t\tthis._suggest( content );\n\t\t\tthis._trigger( \"open\" );\n\t\t} else {\n\t\t\t// use ._close() instead of .close() so we don't cancel future searches\n\t\t\tthis._close();\n\t\t}\n\t},\n\n\tclose: function( event ) {\n\t\tthis.cancelSearch = true;\n\t\tthis._close( event );\n\t},\n\n\t_close: function( event ) {\n\t\tif ( this.menu.element.is( \":visible\" ) ) {\n\t\t\tthis.menu.element.hide();\n\t\t\tthis.menu.blur();\n\t\t\tthis.isNewMenu = true;\n\t\t\tthis._trigger( \"close\", event );\n\t\t}\n\t},\n\n\t_change: function( event ) {\n\t\tif ( this.previous !== this._value() ) {\n\t\t\tthis._trigger( \"change\", event, { item: this.selectedItem } );\n\t\t}\n\t},\n\n\t_normalize: function( items ) {\n\t\t// assume all items have the right format when the first item is complete\n\t\tif ( items.length && items[ 0 ].label && items[ 0 ].value ) {\n\t\t\treturn items;\n\t\t}\n\t\treturn $.map( items, function( item ) {\n\t\t\tif ( typeof item === \"string\" ) {\n\t\t\t\treturn {\n\t\t\t\t\tlabel: item,\n\t\t\t\t\tvalue: item\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn $.extend( {}, item, {\n\t\t\t\tlabel: item.label || item.value,\n\t\t\t\tvalue: item.value || item.label\n\t\t\t});\n\t\t});\n\t},\n\n\t_suggest: function( items ) {\n\t\tvar ul = this.menu.element.empty();\n\t\tthis._renderMenu( ul, items );\n\t\tthis.isNewMenu = true;\n\t\tthis.menu.refresh();\n\n\t\t// size and position menu\n\t\tul.show();\n\t\tthis._resizeMenu();\n\t\tul.position( $.extend({\n\t\t\tof: this.element\n\t\t}, this.options.position ) );\n\n\t\tif ( this.options.autoFocus ) {\n\t\t\tthis.menu.next();\n\t\t}\n\t},\n\n\t_resizeMenu: function() {\n\t\tvar ul = this.menu.element;\n\t\tul.outerWidth( Math.max(\n\t\t\t// Firefox wraps long text (possibly a rounding bug)\n\t\t\t// so we add 1px to avoid the wrapping (#7513)\n\t\t\tul.width( \"\" ).outerWidth() + 1,\n\t\t\tthis.element.outerWidth()\n\t\t) );\n\t},\n\n\t_renderMenu: function( ul, items ) {\n\t\tvar that = this;\n\t\t$.each( items, function( index, item ) {\n\t\t\tthat._renderItemData( ul, item );\n\t\t});\n\t},\n\n\t_renderItemData: function( ul, item ) {\n\t\treturn this._renderItem( ul, item ).data( \"ui-autocomplete-item\", item );\n\t},\n\n\t_renderItem: function( ul, item ) {\n\t\treturn $( \"<li>\" ).text( item.label ).appendTo( ul );\n\t},\n\n\t_move: function( direction, event ) {\n\t\tif ( !this.menu.element.is( \":visible\" ) ) {\n\t\t\tthis.search( null, event );\n\t\t\treturn;\n\t\t}\n\t\tif ( this.menu.isFirstItem() && /^previous/.test( direction ) ||\n\t\t\t\tthis.menu.isLastItem() && /^next/.test( direction ) ) {\n\n\t\t\tif ( !this.isMultiLine ) {\n\t\t\t\tthis._value( this.term );\n\t\t\t}\n\n\t\t\tthis.menu.blur();\n\t\t\treturn;\n\t\t}\n\t\tthis.menu[ direction ]( event );\n\t},\n\n\twidget: function() {\n\t\treturn this.menu.element;\n\t},\n\n\t_value: function() {\n\t\treturn this.valueMethod.apply( this.element, arguments );\n\t},\n\n\t_keyEvent: function( keyEvent, event ) {\n\t\tif ( !this.isMultiLine || this.menu.element.is( \":visible\" ) ) {\n\t\t\tthis._move( keyEvent, event );\n\n\t\t\t// prevents moving cursor to beginning/end of the text field in some browsers\n\t\t\tevent.preventDefault();\n\t\t}\n\t}\n});\n\n$.extend( $.ui.autocomplete, {\n\tescapeRegex: function( value ) {\n\t\treturn value.replace( /[\\-\\[\\]{}()*+?.,\\\\\\^$|#\\s]/g, \"\\\\$&\" );\n\t},\n\tfilter: function( array, term ) {\n\t\tvar matcher = new RegExp( $.ui.autocomplete.escapeRegex( term ), \"i\" );\n\t\treturn $.grep( array, function( value ) {\n\t\t\treturn matcher.test( value.label || value.value || value );\n\t\t});\n\t}\n});\n\n// live region extension, adding a `messages` option\n// NOTE: This is an experimental API. We are still investigating\n// a full solution for string manipulation and internationalization.\n$.widget( \"ui.autocomplete\", $.ui.autocomplete, {\n\toptions: {\n\t\tmessages: {\n\t\t\tnoResults: \"No search results.\",\n\t\t\tresults: function( amount ) {\n\t\t\t\treturn amount + ( amount > 1 ? \" results are\" : \" result is\" ) +\n\t\t\t\t\t\" available, use up and down arrow keys to navigate.\";\n\t\t\t}\n\t\t}\n\t},\n\n\t__response: function( content ) {\n\t\tvar message;\n\t\tthis._superApply( arguments );\n\t\tif ( this.options.disabled || this.cancelSearch ) {\n\t\t\treturn;\n\t\t}\n\t\tif ( content && content.length ) {\n\t\t\tmessage = this.options.messages.results( content.length );\n\t\t} else {\n\t\t\tmessage = this.options.messages.noResults;\n\t\t}\n\t\tthis.liveRegion.children().hide();\n\t\t$( \"<div>\" ).text( message ).appendTo( this.liveRegion );\n\t}\n});\n\nvar autocomplete = $.ui.autocomplete;\n\n\n/*!\n * jQuery UI Button 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/button/\n */\n\n\nvar lastActive,\n\tbaseClasses = \"ui-button ui-widget ui-state-default ui-corner-all\",\n\ttypeClasses = \"ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only\",\n\tformResetHandler = function() {\n\t\tvar form = $( this );\n\t\tsetTimeout(function() {\n\t\t\tform.find( \":ui-button\" ).button( \"refresh\" );\n\t\t}, 1 );\n\t},\n\tradioGroup = function( radio ) {\n\t\tvar name = radio.name,\n\t\t\tform = radio.form,\n\t\t\tradios = $( [] );\n\t\tif ( name ) {\n\t\t\tname = name.replace( /'/g, \"\\\\'\" );\n\t\t\tif ( form ) {\n\t\t\t\tradios = $( form ).find( \"[name='\" + name + \"'][type=radio]\" );\n\t\t\t} else {\n\t\t\t\tradios = $( \"[name='\" + name + \"'][type=radio]\", radio.ownerDocument )\n\t\t\t\t\t.filter(function() {\n\t\t\t\t\t\treturn !this.form;\n\t\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn radios;\n\t};\n\n$.widget( \"ui.button\", {\n\tversion: \"1.11.4\",\n\tdefaultElement: \"<button>\",\n\toptions: {\n\t\tdisabled: null,\n\t\ttext: true,\n\t\tlabel: null,\n\t\ticons: {\n\t\t\tprimary: null,\n\t\t\tsecondary: null\n\t\t}\n\t},\n\t_create: function() {\n\t\tthis.element.closest( \"form\" )\n\t\t\t.unbind( \"reset\" + this.eventNamespace )\n\t\t\t.bind( \"reset\" + this.eventNamespace, formResetHandler );\n\n\t\tif ( typeof this.options.disabled !== \"boolean\" ) {\n\t\t\tthis.options.disabled = !!this.element.prop( \"disabled\" );\n\t\t} else {\n\t\t\tthis.element.prop( \"disabled\", this.options.disabled );\n\t\t}\n\n\t\tthis._determineButtonType();\n\t\tthis.hasTitle = !!this.buttonElement.attr( \"title\" );\n\n\t\tvar that = this,\n\t\t\toptions = this.options,\n\t\t\ttoggleButton = this.type === \"checkbox\" || this.type === \"radio\",\n\t\t\tactiveClass = !toggleButton ? \"ui-state-active\" : \"\";\n\n\t\tif ( options.label === null ) {\n\t\t\toptions.label = (this.type === \"input\" ? this.buttonElement.val() : this.buttonElement.html());\n\t\t}\n\n\t\tthis._hoverable( this.buttonElement );\n\n\t\tthis.buttonElement\n\t\t\t.addClass( baseClasses )\n\t\t\t.attr( \"role\", \"button\" )\n\t\t\t.bind( \"mouseenter\" + this.eventNamespace, function() {\n\t\t\t\tif ( options.disabled ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif ( this === lastActive ) {\n\t\t\t\t\t$( this ).addClass( \"ui-state-active\" );\n\t\t\t\t}\n\t\t\t})\n\t\t\t.bind( \"mouseleave\" + this.eventNamespace, function() {\n\t\t\t\tif ( options.disabled ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t$( this ).removeClass( activeClass );\n\t\t\t})\n\t\t\t.bind( \"click\" + this.eventNamespace, function( event ) {\n\t\t\t\tif ( options.disabled ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopImmediatePropagation();\n\t\t\t\t}\n\t\t\t});\n\n\t\t// Can't use _focusable() because the element that receives focus\n\t\t// and the element that gets the ui-state-focus class are different\n\t\tthis._on({\n\t\t\tfocus: function() {\n\t\t\t\tthis.buttonElement.addClass( \"ui-state-focus\" );\n\t\t\t},\n\t\t\tblur: function() {\n\t\t\t\tthis.buttonElement.removeClass( \"ui-state-focus\" );\n\t\t\t}\n\t\t});\n\n\t\tif ( toggleButton ) {\n\t\t\tthis.element.bind( \"change\" + this.eventNamespace, function() {\n\t\t\t\tthat.refresh();\n\t\t\t});\n\t\t}\n\n\t\tif ( this.type === \"checkbox\" ) {\n\t\t\tthis.buttonElement.bind( \"click\" + this.eventNamespace, function() {\n\t\t\t\tif ( options.disabled ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t} else if ( this.type === \"radio\" ) {\n\t\t\tthis.buttonElement.bind( \"click\" + this.eventNamespace, function() {\n\t\t\t\tif ( options.disabled ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t$( this ).addClass( \"ui-state-active\" );\n\t\t\t\tthat.buttonElement.attr( \"aria-pressed\", \"true\" );\n\n\t\t\t\tvar radio = that.element[ 0 ];\n\t\t\t\tradioGroup( radio )\n\t\t\t\t\t.not( radio )\n\t\t\t\t\t.map(function() {\n\t\t\t\t\t\treturn $( this ).button( \"widget\" )[ 0 ];\n\t\t\t\t\t})\n\t\t\t\t\t.removeClass( \"ui-state-active\" )\n\t\t\t\t\t.attr( \"aria-pressed\", \"false\" );\n\t\t\t});\n\t\t} else {\n\t\t\tthis.buttonElement\n\t\t\t\t.bind( \"mousedown\" + this.eventNamespace, function() {\n\t\t\t\t\tif ( options.disabled ) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\t$( this ).addClass( \"ui-state-active\" );\n\t\t\t\t\tlastActive = this;\n\t\t\t\t\tthat.document.one( \"mouseup\", function() {\n\t\t\t\t\t\tlastActive = null;\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.bind( \"mouseup\" + this.eventNamespace, function() {\n\t\t\t\t\tif ( options.disabled ) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\t$( this ).removeClass( \"ui-state-active\" );\n\t\t\t\t})\n\t\t\t\t.bind( \"keydown\" + this.eventNamespace, function(event) {\n\t\t\t\t\tif ( options.disabled ) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tif ( event.keyCode === $.ui.keyCode.SPACE || event.keyCode === $.ui.keyCode.ENTER ) {\n\t\t\t\t\t\t$( this ).addClass( \"ui-state-active\" );\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t// see #8559, we bind to blur here in case the button element loses\n\t\t\t\t// focus between keydown and keyup, it would be left in an \"active\" state\n\t\t\t\t.bind( \"keyup\" + this.eventNamespace + \" blur\" + this.eventNamespace, function() {\n\t\t\t\t\t$( this ).removeClass( \"ui-state-active\" );\n\t\t\t\t});\n\n\t\t\tif ( this.buttonElement.is(\"a\") ) {\n\t\t\t\tthis.buttonElement.keyup(function(event) {\n\t\t\t\t\tif ( event.keyCode === $.ui.keyCode.SPACE ) {\n\t\t\t\t\t\t// TODO pass through original event correctly (just as 2nd argument doesn't work)\n\t\t\t\t\t\t$( this ).click();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis._setOption( \"disabled\", options.disabled );\n\t\tthis._resetButton();\n\t},\n\n\t_determineButtonType: function() {\n\t\tvar ancestor, labelSelector, checked;\n\n\t\tif ( this.element.is(\"[type=checkbox]\") ) {\n\t\t\tthis.type = \"checkbox\";\n\t\t} else if ( this.element.is(\"[type=radio]\") ) {\n\t\t\tthis.type = \"radio\";\n\t\t} else if ( this.element.is(\"input\") ) {\n\t\t\tthis.type = \"input\";\n\t\t} else {\n\t\t\tthis.type = \"button\";\n\t\t}\n\n\t\tif ( this.type === \"checkbox\" || this.type === \"radio\" ) {\n\t\t\t// we don't search against the document in case the element\n\t\t\t// is disconnected from the DOM\n\t\t\tancestor = this.element.parents().last();\n\t\t\tlabelSelector = \"label[for='\" + this.element.attr(\"id\") + \"']\";\n\t\t\tthis.buttonElement = ancestor.find( labelSelector );\n\t\t\tif ( !this.buttonElement.length ) {\n\t\t\t\tancestor = ancestor.length ? ancestor.siblings() : this.element.siblings();\n\t\t\t\tthis.buttonElement = ancestor.filter( labelSelector );\n\t\t\t\tif ( !this.buttonElement.length ) {\n\t\t\t\t\tthis.buttonElement = ancestor.find( labelSelector );\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.element.addClass( \"ui-helper-hidden-accessible\" );\n\n\t\t\tchecked = this.element.is( \":checked\" );\n\t\t\tif ( checked ) {\n\t\t\t\tthis.buttonElement.addClass( \"ui-state-active\" );\n\t\t\t}\n\t\t\tthis.buttonElement.prop( \"aria-pressed\", checked );\n\t\t} else {\n\t\t\tthis.buttonElement = this.element;\n\t\t}\n\t},\n\n\twidget: function() {\n\t\treturn this.buttonElement;\n\t},\n\n\t_destroy: function() {\n\t\tthis.element\n\t\t\t.removeClass( \"ui-helper-hidden-accessible\" );\n\t\tthis.buttonElement\n\t\t\t.removeClass( baseClasses + \" ui-state-active \" + typeClasses )\n\t\t\t.removeAttr( \"role\" )\n\t\t\t.removeAttr( \"aria-pressed\" )\n\t\t\t.html( this.buttonElement.find(\".ui-button-text\").html() );\n\n\t\tif ( !this.hasTitle ) {\n\t\t\tthis.buttonElement.removeAttr( \"title\" );\n\t\t}\n\t},\n\n\t_setOption: function( key, value ) {\n\t\tthis._super( key, value );\n\t\tif ( key === \"disabled\" ) {\n\t\t\tthis.widget().toggleClass( \"ui-state-disabled\", !!value );\n\t\t\tthis.element.prop( \"disabled\", !!value );\n\t\t\tif ( value ) {\n\t\t\t\tif ( this.type === \"checkbox\" || this.type === \"radio\" ) {\n\t\t\t\t\tthis.buttonElement.removeClass( \"ui-state-focus\" );\n\t\t\t\t} else {\n\t\t\t\t\tthis.buttonElement.removeClass( \"ui-state-focus ui-state-active\" );\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tthis._resetButton();\n\t},\n\n\trefresh: function() {\n\t\t//See #8237 & #8828\n\t\tvar isDisabled = this.element.is( \"input, button\" ) ? this.element.is( \":disabled\" ) : this.element.hasClass( \"ui-button-disabled\" );\n\n\t\tif ( isDisabled !== this.options.disabled ) {\n\t\t\tthis._setOption( \"disabled\", isDisabled );\n\t\t}\n\t\tif ( this.type === \"radio\" ) {\n\t\t\tradioGroup( this.element[0] ).each(function() {\n\t\t\t\tif ( $( this ).is( \":checked\" ) ) {\n\t\t\t\t\t$( this ).button( \"widget\" )\n\t\t\t\t\t\t.addClass( \"ui-state-active\" )\n\t\t\t\t\t\t.attr( \"aria-pressed\", \"true\" );\n\t\t\t\t} else {\n\t\t\t\t\t$( this ).button( \"widget\" )\n\t\t\t\t\t\t.removeClass( \"ui-state-active\" )\n\t\t\t\t\t\t.attr( \"aria-pressed\", \"false\" );\n\t\t\t\t}\n\t\t\t});\n\t\t} else if ( this.type === \"checkbox\" ) {\n\t\t\tif ( this.element.is( \":checked\" ) ) {\n\t\t\t\tthis.buttonElement\n\t\t\t\t\t.addClass( \"ui-state-active\" )\n\t\t\t\t\t.attr( \"aria-pressed\", \"true\" );\n\t\t\t} else {\n\t\t\t\tthis.buttonElement\n\t\t\t\t\t.removeClass( \"ui-state-active\" )\n\t\t\t\t\t.attr( \"aria-pressed\", \"false\" );\n\t\t\t}\n\t\t}\n\t},\n\n\t_resetButton: function() {\n\t\tif ( this.type === \"input\" ) {\n\t\t\tif ( this.options.label ) {\n\t\t\t\tthis.element.val( this.options.label );\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tvar buttonElement = this.buttonElement.removeClass( typeClasses ),\n\t\t\tbuttonText = $( \"<span></span>\", this.document[0] )\n\t\t\t\t.addClass( \"ui-button-text\" )\n\t\t\t\t.html( this.options.label )\n\t\t\t\t.appendTo( buttonElement.empty() )\n\t\t\t\t.text(),\n\t\t\ticons = this.options.icons,\n\t\t\tmultipleIcons = icons.primary && icons.secondary,\n\t\t\tbuttonClasses = [];\n\n\t\tif ( icons.primary || icons.secondary ) {\n\t\t\tif ( this.options.text ) {\n\t\t\t\tbuttonClasses.push( \"ui-button-text-icon\" + ( multipleIcons ? \"s\" : ( icons.primary ? \"-primary\" : \"-secondary\" ) ) );\n\t\t\t}\n\n\t\t\tif ( icons.primary ) {\n\t\t\t\tbuttonElement.prepend( \"<span class='ui-button-icon-primary ui-icon \" + icons.primary + \"'></span>\" );\n\t\t\t}\n\n\t\t\tif ( icons.secondary ) {\n\t\t\t\tbuttonElement.append( \"<span class='ui-button-icon-secondary ui-icon \" + icons.secondary + \"'></span>\" );\n\t\t\t}\n\n\t\t\tif ( !this.options.text ) {\n\t\t\t\tbuttonClasses.push( multipleIcons ? \"ui-button-icons-only\" : \"ui-button-icon-only\" );\n\n\t\t\t\tif ( !this.hasTitle ) {\n\t\t\t\t\tbuttonElement.attr( \"title\", $.trim( buttonText ) );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tbuttonClasses.push( \"ui-button-text-only\" );\n\t\t}\n\t\tbuttonElement.addClass( buttonClasses.join( \" \" ) );\n\t}\n});\n\n$.widget( \"ui.buttonset\", {\n\tversion: \"1.11.4\",\n\toptions: {\n\t\titems: \"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)\"\n\t},\n\n\t_create: function() {\n\t\tthis.element.addClass( \"ui-buttonset\" );\n\t},\n\n\t_init: function() {\n\t\tthis.refresh();\n\t},\n\n\t_setOption: function( key, value ) {\n\t\tif ( key === \"disabled\" ) {\n\t\t\tthis.buttons.button( \"option\", key, value );\n\t\t}\n\n\t\tthis._super( key, value );\n\t},\n\n\trefresh: function() {\n\t\tvar rtl = this.element.css( \"direction\" ) === \"rtl\",\n\t\t\tallButtons = this.element.find( this.options.items ),\n\t\t\texistingButtons = allButtons.filter( \":ui-button\" );\n\n\t\t// Initialize new buttons\n\t\tallButtons.not( \":ui-button\" ).button();\n\n\t\t// Refresh existing buttons\n\t\texistingButtons.button( \"refresh\" );\n\n\t\tthis.buttons = allButtons\n\t\t\t.map(function() {\n\t\t\t\treturn $( this ).button( \"widget\" )[ 0 ];\n\t\t\t})\n\t\t\t\t.removeClass( \"ui-corner-all ui-corner-left ui-corner-right\" )\n\t\t\t\t.filter( \":first\" )\n\t\t\t\t\t.addClass( rtl ? \"ui-corner-right\" : \"ui-corner-left\" )\n\t\t\t\t.end()\n\t\t\t\t.filter( \":last\" )\n\t\t\t\t\t.addClass( rtl ? \"ui-corner-left\" : \"ui-corner-right\" )\n\t\t\t\t.end()\n\t\t\t.end();\n\t},\n\n\t_destroy: function() {\n\t\tthis.element.removeClass( \"ui-buttonset\" );\n\t\tthis.buttons\n\t\t\t.map(function() {\n\t\t\t\treturn $( this ).button( \"widget\" )[ 0 ];\n\t\t\t})\n\t\t\t\t.removeClass( \"ui-corner-left ui-corner-right\" )\n\t\t\t.end()\n\t\t\t.button( \"destroy\" );\n\t}\n});\n\nvar button = $.ui.button;\n\n\n/*!\n * jQuery UI Datepicker 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/datepicker/\n */\n\n\n$.extend($.ui, { datepicker: { version: \"1.11.4\" } });\n\nvar datepicker_instActive;\n\nfunction datepicker_getZindex( elem ) {\n\tvar position, value;\n\twhile ( elem.length && elem[ 0 ] !== document ) {\n\t\t// Ignore z-index if position is set to a value where z-index is ignored by the browser\n\t\t// This makes behavior of this function consistent across browsers\n\t\t// WebKit always returns auto if the element is positioned\n\t\tposition = elem.css( \"position\" );\n\t\tif ( position === \"absolute\" || position === \"relative\" || position === \"fixed\" ) {\n\t\t\t// IE returns 0 when zIndex is not specified\n\t\t\t// other browsers return a string\n\t\t\t// we ignore the case of nested elements with an explicit value of 0\n\t\t\t// <div style=\"z-index: -10;\"><div style=\"z-index: 0;\"></div></div>\n\t\t\tvalue = parseInt( elem.css( \"zIndex\" ), 10 );\n\t\t\tif ( !isNaN( value ) && value !== 0 ) {\n\t\t\t\treturn value;\n\t\t\t}\n\t\t}\n\t\telem = elem.parent();\n\t}\n\n\treturn 0;\n}\n/* Date picker manager.\n   Use the singleton instance of this class, $.datepicker, to interact with the date picker.\n   Settings for (groups of) date pickers are maintained in an instance object,\n   allowing multiple different settings on the same page. */\n\nfunction Datepicker() {\n\tthis._curInst = null; // The current instance in use\n\tthis._keyEvent = false; // If the last event was a key event\n\tthis._disabledInputs = []; // List of date picker inputs that have been disabled\n\tthis._datepickerShowing = false; // True if the popup picker is showing , false if not\n\tthis._inDialog = false; // True if showing within a \"dialog\", false if not\n\tthis._mainDivId = \"ui-datepicker-div\"; // The ID of the main datepicker division\n\tthis._inlineClass = \"ui-datepicker-inline\"; // The name of the inline marker class\n\tthis._appendClass = \"ui-datepicker-append\"; // The name of the append marker class\n\tthis._triggerClass = \"ui-datepicker-trigger\"; // The name of the trigger marker class\n\tthis._dialogClass = \"ui-datepicker-dialog\"; // The name of the dialog marker class\n\tthis._disableClass = \"ui-datepicker-disabled\"; // The name of the disabled covering marker class\n\tthis._unselectableClass = \"ui-datepicker-unselectable\"; // The name of the unselectable cell marker class\n\tthis._currentClass = \"ui-datepicker-current-day\"; // The name of the current day marker class\n\tthis._dayOverClass = \"ui-datepicker-days-cell-over\"; // The name of the day hover marker class\n\tthis.regional = []; // Available regional settings, indexed by language code\n\tthis.regional[\"\"] = { // Default regional settings\n\t\tcloseText: \"Done\", // Display text for close link\n\t\tprevText: \"Prev\", // Display text for previous month link\n\t\tnextText: \"Next\", // Display text for next month link\n\t\tcurrentText: \"Today\", // Display text for current month link\n\t\tmonthNames: [\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\n\t\t\t\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"], // Names of months for drop-down and formatting\n\t\tmonthNamesShort: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"], // For formatting\n\t\tdayNames: [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"], // For formatting\n\t\tdayNamesShort: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"], // For formatting\n\t\tdayNamesMin: [\"Su\",\"Mo\",\"Tu\",\"We\",\"Th\",\"Fr\",\"Sa\"], // Column headings for days starting at Sunday\n\t\tweekHeader: \"Wk\", // Column header for week of the year\n\t\tdateFormat: \"mm/dd/yy\", // See format options on parseDate\n\t\tfirstDay: 0, // The first day of the week, Sun = 0, Mon = 1, ...\n\t\tisRTL: false, // True if right-to-left language, false if left-to-right\n\t\tshowMonthAfterYear: false, // True if the year select precedes month, false for month then year\n\t\tyearSuffix: \"\" // Additional text to append to the year in the month headers\n\t};\n\tthis._defaults = { // Global defaults for all the date picker instances\n\t\tshowOn: \"focus\", // \"focus\" for popup on focus,\n\t\t\t// \"button\" for trigger button, or \"both\" for either\n\t\tshowAnim: \"fadeIn\", // Name of jQuery animation for popup\n\t\tshowOptions: {}, // Options for enhanced animations\n\t\tdefaultDate: null, // Used when field is blank: actual date,\n\t\t\t// +/-number for offset from today, null for today\n\t\tappendText: \"\", // Display text following the input box, e.g. showing the format\n\t\tbuttonText: \"...\", // Text for trigger button\n\t\tbuttonImage: \"\", // URL for trigger button image\n\t\tbuttonImageOnly: false, // True if the image appears alone, false if it appears on a button\n\t\thideIfNoPrevNext: false, // True to hide next/previous month links\n\t\t\t// if not applicable, false to just disable them\n\t\tnavigationAsDateFormat: false, // True if date formatting applied to prev/today/next links\n\t\tgotoCurrent: false, // True if today link goes back to current selection instead\n\t\tchangeMonth: false, // True if month can be selected directly, false if only prev/next\n\t\tchangeYear: false, // True if year can be selected directly, false if only prev/next\n\t\tyearRange: \"c-10:c+10\", // Range of years to display in drop-down,\n\t\t\t// either relative to today's year (-nn:+nn), relative to currently displayed year\n\t\t\t// (c-nn:c+nn), absolute (nnnn:nnnn), or a combination of the above (nnnn:-n)\n\t\tshowOtherMonths: false, // True to show dates in other months, false to leave blank\n\t\tselectOtherMonths: false, // True to allow selection of dates in other months, false for unselectable\n\t\tshowWeek: false, // True to show week of the year, false to not show it\n\t\tcalculateWeek: this.iso8601Week, // How to calculate the week of the year,\n\t\t\t// takes a Date and returns the number of the week for it\n\t\tshortYearCutoff: \"+10\", // Short year values < this are in the current century,\n\t\t\t// > this are in the previous century,\n\t\t\t// string value starting with \"+\" for current year + value\n\t\tminDate: null, // The earliest selectable date, or null for no limit\n\t\tmaxDate: null, // The latest selectable date, or null for no limit\n\t\tduration: \"fast\", // Duration of display/closure\n\t\tbeforeShowDay: null, // Function that takes a date and returns an array with\n\t\t\t// [0] = true if selectable, false if not, [1] = custom CSS class name(s) or \"\",\n\t\t\t// [2] = cell title (optional), e.g. $.datepicker.noWeekends\n\t\tbeforeShow: null, // Function that takes an input field and\n\t\t\t// returns a set of custom settings for the date picker\n\t\tonSelect: null, // Define a callback function when a date is selected\n\t\tonChangeMonthYear: null, // Define a callback function when the month or year is changed\n\t\tonClose: null, // Define a callback function when the datepicker is closed\n\t\tnumberOfMonths: 1, // Number of months to show at a time\n\t\tshowCurrentAtPos: 0, // The position in multipe months at which to show the current month (starting at 0)\n\t\tstepMonths: 1, // Number of months to step back/forward\n\t\tstepBigMonths: 12, // Number of months to step back/forward for the big links\n\t\taltField: \"\", // Selector for an alternate field to store selected dates into\n\t\taltFormat: \"\", // The date format to use for the alternate field\n\t\tconstrainInput: true, // The input is constrained by the current date format\n\t\tshowButtonPanel: false, // True to show button panel, false to not show it\n\t\tautoSize: false, // True to size the input for the date format, false to leave as is\n\t\tdisabled: false // The initial disabled state\n\t};\n\t$.extend(this._defaults, this.regional[\"\"]);\n\tthis.regional.en = $.extend( true, {}, this.regional[ \"\" ]);\n\tthis.regional[ \"en-US\" ] = $.extend( true, {}, this.regional.en );\n\tthis.dpDiv = datepicker_bindHover($(\"<div id='\" + this._mainDivId + \"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>\"));\n}\n\n$.extend(Datepicker.prototype, {\n\t/* Class name added to elements to indicate already configured with a date picker. */\n\tmarkerClassName: \"hasDatepicker\",\n\n\t//Keep track of the maximum number of rows displayed (see #7043)\n\tmaxRows: 4,\n\n\t// TODO rename to \"widget\" when switching to widget factory\n\t_widgetDatepicker: function() {\n\t\treturn this.dpDiv;\n\t},\n\n\t/* Override the default settings for all instances of the date picker.\n\t * @param  settings  object - the new settings to use as defaults (anonymous object)\n\t * @return the manager object\n\t */\n\tsetDefaults: function(settings) {\n\t\tdatepicker_extendRemove(this._defaults, settings || {});\n\t\treturn this;\n\t},\n\n\t/* Attach the date picker to a jQuery selection.\n\t * @param  target\telement - the target input field or division or span\n\t * @param  settings  object - the new settings to use for this date picker instance (anonymous)\n\t */\n\t_attachDatepicker: function(target, settings) {\n\t\tvar nodeName, inline, inst;\n\t\tnodeName = target.nodeName.toLowerCase();\n\t\tinline = (nodeName === \"div\" || nodeName === \"span\");\n\t\tif (!target.id) {\n\t\t\tthis.uuid += 1;\n\t\t\ttarget.id = \"dp\" + this.uuid;\n\t\t}\n\t\tinst = this._newInst($(target), inline);\n\t\tinst.settings = $.extend({}, settings || {});\n\t\tif (nodeName === \"input\") {\n\t\t\tthis._connectDatepicker(target, inst);\n\t\t} else if (inline) {\n\t\t\tthis._inlineDatepicker(target, inst);\n\t\t}\n\t},\n\n\t/* Create a new instance object. */\n\t_newInst: function(target, inline) {\n\t\tvar id = target[0].id.replace(/([^A-Za-z0-9_\\-])/g, \"\\\\\\\\$1\"); // escape jQuery meta chars\n\t\treturn {id: id, input: target, // associated target\n\t\t\tselectedDay: 0, selectedMonth: 0, selectedYear: 0, // current selection\n\t\t\tdrawMonth: 0, drawYear: 0, // month being drawn\n\t\t\tinline: inline, // is datepicker inline or not\n\t\t\tdpDiv: (!inline ? this.dpDiv : // presentation div\n\t\t\tdatepicker_bindHover($(\"<div class='\" + this._inlineClass + \" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>\")))};\n\t},\n\n\t/* Attach the date picker to an input field. */\n\t_connectDatepicker: function(target, inst) {\n\t\tvar input = $(target);\n\t\tinst.append = $([]);\n\t\tinst.trigger = $([]);\n\t\tif (input.hasClass(this.markerClassName)) {\n\t\t\treturn;\n\t\t}\n\t\tthis._attachments(input, inst);\n\t\tinput.addClass(this.markerClassName).keydown(this._doKeyDown).\n\t\t\tkeypress(this._doKeyPress).keyup(this._doKeyUp);\n\t\tthis._autoSize(inst);\n\t\t$.data(target, \"datepicker\", inst);\n\t\t//If disabled option is true, disable the datepicker once it has been attached to the input (see ticket #5665)\n\t\tif( inst.settings.disabled ) {\n\t\t\tthis._disableDatepicker( target );\n\t\t}\n\t},\n\n\t/* Make attachments based on settings. */\n\t_attachments: function(input, inst) {\n\t\tvar showOn, buttonText, buttonImage,\n\t\t\tappendText = this._get(inst, \"appendText\"),\n\t\t\tisRTL = this._get(inst, \"isRTL\");\n\n\t\tif (inst.append) {\n\t\t\tinst.append.remove();\n\t\t}\n\t\tif (appendText) {\n\t\t\tinst.append = $(\"<span class='\" + this._appendClass + \"'>\" + appendText + \"</span>\");\n\t\t\tinput[isRTL ? \"before\" : \"after\"](inst.append);\n\t\t}\n\n\t\tinput.unbind(\"focus\", this._showDatepicker);\n\n\t\tif (inst.trigger) {\n\t\t\tinst.trigger.remove();\n\t\t}\n\n\t\tshowOn = this._get(inst, \"showOn\");\n\t\tif (showOn === \"focus\" || showOn === \"both\") { // pop-up date picker when in the marked field\n\t\t\tinput.focus(this._showDatepicker);\n\t\t}\n\t\tif (showOn === \"button\" || showOn === \"both\") { // pop-up date picker when button clicked\n\t\t\tbuttonText = this._get(inst, \"buttonText\");\n\t\t\tbuttonImage = this._get(inst, \"buttonImage\");\n\t\t\tinst.trigger = $(this._get(inst, \"buttonImageOnly\") ?\n\t\t\t\t$(\"<img/>\").addClass(this._triggerClass).\n\t\t\t\t\tattr({ src: buttonImage, alt: buttonText, title: buttonText }) :\n\t\t\t\t$(\"<button type='button'></button>\").addClass(this._triggerClass).\n\t\t\t\t\thtml(!buttonImage ? buttonText : $(\"<img/>\").attr(\n\t\t\t\t\t{ src:buttonImage, alt:buttonText, title:buttonText })));\n\t\t\tinput[isRTL ? \"before\" : \"after\"](inst.trigger);\n\t\t\tinst.trigger.click(function() {\n\t\t\t\tif ($.datepicker._datepickerShowing && $.datepicker._lastInput === input[0]) {\n\t\t\t\t\t$.datepicker._hideDatepicker();\n\t\t\t\t} else if ($.datepicker._datepickerShowing && $.datepicker._lastInput !== input[0]) {\n\t\t\t\t\t$.datepicker._hideDatepicker();\n\t\t\t\t\t$.datepicker._showDatepicker(input[0]);\n\t\t\t\t} else {\n\t\t\t\t\t$.datepicker._showDatepicker(input[0]);\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t});\n\t\t}\n\t},\n\n\t/* Apply the maximum length for the date format. */\n\t_autoSize: function(inst) {\n\t\tif (this._get(inst, \"autoSize\") && !inst.inline) {\n\t\t\tvar findMax, max, maxI, i,\n\t\t\t\tdate = new Date(2009, 12 - 1, 20), // Ensure double digits\n\t\t\t\tdateFormat = this._get(inst, \"dateFormat\");\n\n\t\t\tif (dateFormat.match(/[DM]/)) {\n\t\t\t\tfindMax = function(names) {\n\t\t\t\t\tmax = 0;\n\t\t\t\t\tmaxI = 0;\n\t\t\t\t\tfor (i = 0; i < names.length; i++) {\n\t\t\t\t\t\tif (names[i].length > max) {\n\t\t\t\t\t\t\tmax = names[i].length;\n\t\t\t\t\t\t\tmaxI = i;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn maxI;\n\t\t\t\t};\n\t\t\t\tdate.setMonth(findMax(this._get(inst, (dateFormat.match(/MM/) ?\n\t\t\t\t\t\"monthNames\" : \"monthNamesShort\"))));\n\t\t\t\tdate.setDate(findMax(this._get(inst, (dateFormat.match(/DD/) ?\n\t\t\t\t\t\"dayNames\" : \"dayNamesShort\"))) + 20 - date.getDay());\n\t\t\t}\n\t\t\tinst.input.attr(\"size\", this._formatDate(inst, date).length);\n\t\t}\n\t},\n\n\t/* Attach an inline date picker to a div. */\n\t_inlineDatepicker: function(target, inst) {\n\t\tvar divSpan = $(target);\n\t\tif (divSpan.hasClass(this.markerClassName)) {\n\t\t\treturn;\n\t\t}\n\t\tdivSpan.addClass(this.markerClassName).append(inst.dpDiv);\n\t\t$.data(target, \"datepicker\", inst);\n\t\tthis._setDate(inst, this._getDefaultDate(inst), true);\n\t\tthis._updateDatepicker(inst);\n\t\tthis._updateAlternate(inst);\n\t\t//If disabled option is true, disable the datepicker before showing it (see ticket #5665)\n\t\tif( inst.settings.disabled ) {\n\t\t\tthis._disableDatepicker( target );\n\t\t}\n\t\t// Set display:block in place of inst.dpDiv.show() which won't work on disconnected elements\n\t\t// http://bugs.jqueryui.com/ticket/7552 - A Datepicker created on a detached div has zero height\n\t\tinst.dpDiv.css( \"display\", \"block\" );\n\t},\n\n\t/* Pop-up the date picker in a \"dialog\" box.\n\t * @param  input element - ignored\n\t * @param  date\tstring or Date - the initial date to display\n\t * @param  onSelect  function - the function to call when a date is selected\n\t * @param  settings  object - update the dialog date picker instance's settings (anonymous object)\n\t * @param  pos int[2] - coordinates for the dialog's position within the screen or\n\t *\t\t\t\t\tevent - with x/y coordinates or\n\t *\t\t\t\t\tleave empty for default (screen centre)\n\t * @return the manager object\n\t */\n\t_dialogDatepicker: function(input, date, onSelect, settings, pos) {\n\t\tvar id, browserWidth, browserHeight, scrollX, scrollY,\n\t\t\tinst = this._dialogInst; // internal instance\n\n\t\tif (!inst) {\n\t\t\tthis.uuid += 1;\n\t\t\tid = \"dp\" + this.uuid;\n\t\t\tthis._dialogInput = $(\"<input type='text' id='\" + id +\n\t\t\t\t\"' style='position: absolute; top: -100px; width: 0px;'/>\");\n\t\t\tthis._dialogInput.keydown(this._doKeyDown);\n\t\t\t$(\"body\").append(this._dialogInput);\n\t\t\tinst = this._dialogInst = this._newInst(this._dialogInput, false);\n\t\t\tinst.settings = {};\n\t\t\t$.data(this._dialogInput[0], \"datepicker\", inst);\n\t\t}\n\t\tdatepicker_extendRemove(inst.settings, settings || {});\n\t\tdate = (date && date.constructor === Date ? this._formatDate(inst, date) : date);\n\t\tthis._dialogInput.val(date);\n\n\t\tthis._pos = (pos ? (pos.length ? pos : [pos.pageX, pos.pageY]) : null);\n\t\tif (!this._pos) {\n\t\t\tbrowserWidth = document.documentElement.clientWidth;\n\t\t\tbrowserHeight = document.documentElement.clientHeight;\n\t\t\tscrollX = document.documentElement.scrollLeft || document.body.scrollLeft;\n\t\t\tscrollY = document.documentElement.scrollTop || document.body.scrollTop;\n\t\t\tthis._pos = // should use actual width/height below\n\t\t\t\t[(browserWidth / 2) - 100 + scrollX, (browserHeight / 2) - 150 + scrollY];\n\t\t}\n\n\t\t// move input on screen for focus, but hidden behind dialog\n\t\tthis._dialogInput.css(\"left\", (this._pos[0] + 20) + \"px\").css(\"top\", this._pos[1] + \"px\");\n\t\tinst.settings.onSelect = onSelect;\n\t\tthis._inDialog = true;\n\t\tthis.dpDiv.addClass(this._dialogClass);\n\t\tthis._showDatepicker(this._dialogInput[0]);\n\t\tif ($.blockUI) {\n\t\t\t$.blockUI(this.dpDiv);\n\t\t}\n\t\t$.data(this._dialogInput[0], \"datepicker\", inst);\n\t\treturn this;\n\t},\n\n\t/* Detach a datepicker from its control.\n\t * @param  target\telement - the target input field or division or span\n\t */\n\t_destroyDatepicker: function(target) {\n\t\tvar nodeName,\n\t\t\t$target = $(target),\n\t\t\tinst = $.data(target, \"datepicker\");\n\n\t\tif (!$target.hasClass(this.markerClassName)) {\n\t\t\treturn;\n\t\t}\n\n\t\tnodeName = target.nodeName.toLowerCase();\n\t\t$.removeData(target, \"datepicker\");\n\t\tif (nodeName === \"input\") {\n\t\t\tinst.append.remove();\n\t\t\tinst.trigger.remove();\n\t\t\t$target.removeClass(this.markerClassName).\n\t\t\t\tunbind(\"focus\", this._showDatepicker).\n\t\t\t\tunbind(\"keydown\", this._doKeyDown).\n\t\t\t\tunbind(\"keypress\", this._doKeyPress).\n\t\t\t\tunbind(\"keyup\", this._doKeyUp);\n\t\t} else if (nodeName === \"div\" || nodeName === \"span\") {\n\t\t\t$target.removeClass(this.markerClassName).empty();\n\t\t}\n\n\t\tif ( datepicker_instActive === inst ) {\n\t\t\tdatepicker_instActive = null;\n\t\t}\n\t},\n\n\t/* Enable the date picker to a jQuery selection.\n\t * @param  target\telement - the target input field or division or span\n\t */\n\t_enableDatepicker: function(target) {\n\t\tvar nodeName, inline,\n\t\t\t$target = $(target),\n\t\t\tinst = $.data(target, \"datepicker\");\n\n\t\tif (!$target.hasClass(this.markerClassName)) {\n\t\t\treturn;\n\t\t}\n\n\t\tnodeName = target.nodeName.toLowerCase();\n\t\tif (nodeName === \"input\") {\n\t\t\ttarget.disabled = false;\n\t\t\tinst.trigger.filter(\"button\").\n\t\t\t\teach(function() { this.disabled = false; }).end().\n\t\t\t\tfilter(\"img\").css({opacity: \"1.0\", cursor: \"\"});\n\t\t} else if (nodeName === \"div\" || nodeName === \"span\") {\n\t\t\tinline = $target.children(\".\" + this._inlineClass);\n\t\t\tinline.children().removeClass(\"ui-state-disabled\");\n\t\t\tinline.find(\"select.ui-datepicker-month, select.ui-datepicker-year\").\n\t\t\t\tprop(\"disabled\", false);\n\t\t}\n\t\tthis._disabledInputs = $.map(this._disabledInputs,\n\t\t\tfunction(value) { return (value === target ? null : value); }); // delete entry\n\t},\n\n\t/* Disable the date picker to a jQuery selection.\n\t * @param  target\telement - the target input field or division or span\n\t */\n\t_disableDatepicker: function(target) {\n\t\tvar nodeName, inline,\n\t\t\t$target = $(target),\n\t\t\tinst = $.data(target, \"datepicker\");\n\n\t\tif (!$target.hasClass(this.markerClassName)) {\n\t\t\treturn;\n\t\t}\n\n\t\tnodeName = target.nodeName.toLowerCase();\n\t\tif (nodeName === \"input\") {\n\t\t\ttarget.disabled = true;\n\t\t\tinst.trigger.filter(\"button\").\n\t\t\t\teach(function() { this.disabled = true; }).end().\n\t\t\t\tfilter(\"img\").css({opacity: \"0.5\", cursor: \"default\"});\n\t\t} else if (nodeName === \"div\" || nodeName === \"span\") {\n\t\t\tinline = $target.children(\".\" + this._inlineClass);\n\t\t\tinline.children().addClass(\"ui-state-disabled\");\n\t\t\tinline.find(\"select.ui-datepicker-month, select.ui-datepicker-year\").\n\t\t\t\tprop(\"disabled\", true);\n\t\t}\n\t\tthis._disabledInputs = $.map(this._disabledInputs,\n\t\t\tfunction(value) { return (value === target ? null : value); }); // delete entry\n\t\tthis._disabledInputs[this._disabledInputs.length] = target;\n\t},\n\n\t/* Is the first field in a jQuery collection disabled as a datepicker?\n\t * @param  target\telement - the target input field or division or span\n\t * @return boolean - true if disabled, false if enabled\n\t */\n\t_isDisabledDatepicker: function(target) {\n\t\tif (!target) {\n\t\t\treturn false;\n\t\t}\n\t\tfor (var i = 0; i < this._disabledInputs.length; i++) {\n\t\t\tif (this._disabledInputs[i] === target) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\n\t/* Retrieve the instance data for the target control.\n\t * @param  target  element - the target input field or division or span\n\t * @return  object - the associated instance data\n\t * @throws  error if a jQuery problem getting data\n\t */\n\t_getInst: function(target) {\n\t\ttry {\n\t\t\treturn $.data(target, \"datepicker\");\n\t\t}\n\t\tcatch (err) {\n\t\t\tthrow \"Missing instance data for this datepicker\";\n\t\t}\n\t},\n\n\t/* Update or retrieve the settings for a date picker attached to an input field or division.\n\t * @param  target  element - the target input field or division or span\n\t * @param  name\tobject - the new settings to update or\n\t *\t\t\t\tstring - the name of the setting to change or retrieve,\n\t *\t\t\t\twhen retrieving also \"all\" for all instance settings or\n\t *\t\t\t\t\"defaults\" for all global defaults\n\t * @param  value   any - the new value for the setting\n\t *\t\t\t\t(omit if above is an object or to retrieve a value)\n\t */\n\t_optionDatepicker: function(target, name, value) {\n\t\tvar settings, date, minDate, maxDate,\n\t\t\tinst = this._getInst(target);\n\n\t\tif (arguments.length === 2 && typeof name === \"string\") {\n\t\t\treturn (name === \"defaults\" ? $.extend({}, $.datepicker._defaults) :\n\t\t\t\t(inst ? (name === \"all\" ? $.extend({}, inst.settings) :\n\t\t\t\tthis._get(inst, name)) : null));\n\t\t}\n\n\t\tsettings = name || {};\n\t\tif (typeof name === \"string\") {\n\t\t\tsettings = {};\n\t\t\tsettings[name] = value;\n\t\t}\n\n\t\tif (inst) {\n\t\t\tif (this._curInst === inst) {\n\t\t\t\tthis._hideDatepicker();\n\t\t\t}\n\n\t\t\tdate = this._getDateDatepicker(target, true);\n\t\t\tminDate = this._getMinMaxDate(inst, \"min\");\n\t\t\tmaxDate = this._getMinMaxDate(inst, \"max\");\n\t\t\tdatepicker_extendRemove(inst.settings, settings);\n\t\t\t// reformat the old minDate/maxDate values if dateFormat changes and a new minDate/maxDate isn't provided\n\t\t\tif (minDate !== null && settings.dateFormat !== undefined && settings.minDate === undefined) {\n\t\t\t\tinst.settings.minDate = this._formatDate(inst, minDate);\n\t\t\t}\n\t\t\tif (maxDate !== null && settings.dateFormat !== undefined && settings.maxDate === undefined) {\n\t\t\t\tinst.settings.maxDate = this._formatDate(inst, maxDate);\n\t\t\t}\n\t\t\tif ( \"disabled\" in settings ) {\n\t\t\t\tif ( settings.disabled ) {\n\t\t\t\t\tthis._disableDatepicker(target);\n\t\t\t\t} else {\n\t\t\t\t\tthis._enableDatepicker(target);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._attachments($(target), inst);\n\t\t\tthis._autoSize(inst);\n\t\t\tthis._setDate(inst, date);\n\t\t\tthis._updateAlternate(inst);\n\t\t\tthis._updateDatepicker(inst);\n\t\t}\n\t},\n\n\t// change method deprecated\n\t_changeDatepicker: function(target, name, value) {\n\t\tthis._optionDatepicker(target, name, value);\n\t},\n\n\t/* Redraw the date picker attached to an input field or division.\n\t * @param  target  element - the target input field or division or span\n\t */\n\t_refreshDatepicker: function(target) {\n\t\tvar inst = this._getInst(target);\n\t\tif (inst) {\n\t\t\tthis._updateDatepicker(inst);\n\t\t}\n\t},\n\n\t/* Set the dates for a jQuery selection.\n\t * @param  target element - the target input field or division or span\n\t * @param  date\tDate - the new date\n\t */\n\t_setDateDatepicker: function(target, date) {\n\t\tvar inst = this._getInst(target);\n\t\tif (inst) {\n\t\t\tthis._setDate(inst, date);\n\t\t\tthis._updateDatepicker(inst);\n\t\t\tthis._updateAlternate(inst);\n\t\t}\n\t},\n\n\t/* Get the date(s) for the first entry in a jQuery selection.\n\t * @param  target element - the target input field or division or span\n\t * @param  noDefault boolean - true if no default date is to be used\n\t * @return Date - the current date\n\t */\n\t_getDateDatepicker: function(target, noDefault) {\n\t\tvar inst = this._getInst(target);\n\t\tif (inst && !inst.inline) {\n\t\t\tthis._setDateFromField(inst, noDefault);\n\t\t}\n\t\treturn (inst ? this._getDate(inst) : null);\n\t},\n\n\t/* Handle keystrokes. */\n\t_doKeyDown: function(event) {\n\t\tvar onSelect, dateStr, sel,\n\t\t\tinst = $.datepicker._getInst(event.target),\n\t\t\thandled = true,\n\t\t\tisRTL = inst.dpDiv.is(\".ui-datepicker-rtl\");\n\n\t\tinst._keyEvent = true;\n\t\tif ($.datepicker._datepickerShowing) {\n\t\t\tswitch (event.keyCode) {\n\t\t\t\tcase 9: $.datepicker._hideDatepicker();\n\t\t\t\t\t\thandled = false;\n\t\t\t\t\t\tbreak; // hide on tab out\n\t\t\t\tcase 13: sel = $(\"td.\" + $.datepicker._dayOverClass + \":not(.\" +\n\t\t\t\t\t\t\t\t\t$.datepicker._currentClass + \")\", inst.dpDiv);\n\t\t\t\t\t\tif (sel[0]) {\n\t\t\t\t\t\t\t$.datepicker._selectDay(event.target, inst.selectedMonth, inst.selectedYear, sel[0]);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tonSelect = $.datepicker._get(inst, \"onSelect\");\n\t\t\t\t\t\tif (onSelect) {\n\t\t\t\t\t\t\tdateStr = $.datepicker._formatDate(inst);\n\n\t\t\t\t\t\t\t// trigger custom callback\n\t\t\t\t\t\t\tonSelect.apply((inst.input ? inst.input[0] : null), [dateStr, inst]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$.datepicker._hideDatepicker();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn false; // don't submit the form\n\t\t\t\tcase 27: $.datepicker._hideDatepicker();\n\t\t\t\t\t\tbreak; // hide on escape\n\t\t\t\tcase 33: $.datepicker._adjustDate(event.target, (event.ctrlKey ?\n\t\t\t\t\t\t\t-$.datepicker._get(inst, \"stepBigMonths\") :\n\t\t\t\t\t\t\t-$.datepicker._get(inst, \"stepMonths\")), \"M\");\n\t\t\t\t\t\tbreak; // previous month/year on page up/+ ctrl\n\t\t\t\tcase 34: $.datepicker._adjustDate(event.target, (event.ctrlKey ?\n\t\t\t\t\t\t\t+$.datepicker._get(inst, \"stepBigMonths\") :\n\t\t\t\t\t\t\t+$.datepicker._get(inst, \"stepMonths\")), \"M\");\n\t\t\t\t\t\tbreak; // next month/year on page down/+ ctrl\n\t\t\t\tcase 35: if (event.ctrlKey || event.metaKey) {\n\t\t\t\t\t\t\t$.datepicker._clearDate(event.target);\n\t\t\t\t\t\t}\n\t\t\t\t\t\thandled = event.ctrlKey || event.metaKey;\n\t\t\t\t\t\tbreak; // clear on ctrl or command +end\n\t\t\t\tcase 36: if (event.ctrlKey || event.metaKey) {\n\t\t\t\t\t\t\t$.datepicker._gotoToday(event.target);\n\t\t\t\t\t\t}\n\t\t\t\t\t\thandled = event.ctrlKey || event.metaKey;\n\t\t\t\t\t\tbreak; // current on ctrl or command +home\n\t\t\t\tcase 37: if (event.ctrlKey || event.metaKey) {\n\t\t\t\t\t\t\t$.datepicker._adjustDate(event.target, (isRTL ? +1 : -1), \"D\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\thandled = event.ctrlKey || event.metaKey;\n\t\t\t\t\t\t// -1 day on ctrl or command +left\n\t\t\t\t\t\tif (event.originalEvent.altKey) {\n\t\t\t\t\t\t\t$.datepicker._adjustDate(event.target, (event.ctrlKey ?\n\t\t\t\t\t\t\t\t-$.datepicker._get(inst, \"stepBigMonths\") :\n\t\t\t\t\t\t\t\t-$.datepicker._get(inst, \"stepMonths\")), \"M\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// next month/year on alt +left on Mac\n\t\t\t\t\t\tbreak;\n\t\t\t\tcase 38: if (event.ctrlKey || event.metaKey) {\n\t\t\t\t\t\t\t$.datepicker._adjustDate(event.target, -7, \"D\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\thandled = event.ctrlKey || event.metaKey;\n\t\t\t\t\t\tbreak; // -1 week on ctrl or command +up\n\t\t\t\tcase 39: if (event.ctrlKey || event.metaKey) {\n\t\t\t\t\t\t\t$.datepicker._adjustDate(event.target, (isRTL ? -1 : +1), \"D\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\thandled = event.ctrlKey || event.metaKey;\n\t\t\t\t\t\t// +1 day on ctrl or command +right\n\t\t\t\t\t\tif (event.originalEvent.altKey) {\n\t\t\t\t\t\t\t$.datepicker._adjustDate(event.target, (event.ctrlKey ?\n\t\t\t\t\t\t\t\t+$.datepicker._get(inst, \"stepBigMonths\") :\n\t\t\t\t\t\t\t\t+$.datepicker._get(inst, \"stepMonths\")), \"M\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// next month/year on alt +right\n\t\t\t\t\t\tbreak;\n\t\t\t\tcase 40: if (event.ctrlKey || event.metaKey) {\n\t\t\t\t\t\t\t$.datepicker._adjustDate(event.target, +7, \"D\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\thandled = event.ctrlKey || event.metaKey;\n\t\t\t\t\t\tbreak; // +1 week on ctrl or command +down\n\t\t\t\tdefault: handled = false;\n\t\t\t}\n\t\t} else if (event.keyCode === 36 && event.ctrlKey) { // display the date picker on ctrl+home\n\t\t\t$.datepicker._showDatepicker(this);\n\t\t} else {\n\t\t\thandled = false;\n\t\t}\n\n\t\tif (handled) {\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\t}\n\t},\n\n\t/* Filter entered characters - based on date format. */\n\t_doKeyPress: function(event) {\n\t\tvar chars, chr,\n\t\t\tinst = $.datepicker._getInst(event.target);\n\n\t\tif ($.datepicker._get(inst, \"constrainInput\")) {\n\t\t\tchars = $.datepicker._possibleChars($.datepicker._get(inst, \"dateFormat\"));\n\t\t\tchr = String.fromCharCode(event.charCode == null ? event.keyCode : event.charCode);\n\t\t\treturn event.ctrlKey || event.metaKey || (chr < \" \" || !chars || chars.indexOf(chr) > -1);\n\t\t}\n\t},\n\n\t/* Synchronise manual entry and field/alternate field. */\n\t_doKeyUp: function(event) {\n\t\tvar date,\n\t\t\tinst = $.datepicker._getInst(event.target);\n\n\t\tif (inst.input.val() !== inst.lastVal) {\n\t\t\ttry {\n\t\t\t\tdate = $.datepicker.parseDate($.datepicker._get(inst, \"dateFormat\"),\n\t\t\t\t\t(inst.input ? inst.input.val() : null),\n\t\t\t\t\t$.datepicker._getFormatConfig(inst));\n\n\t\t\t\tif (date) { // only if valid\n\t\t\t\t\t$.datepicker._setDateFromField(inst);\n\t\t\t\t\t$.datepicker._updateAlternate(inst);\n\t\t\t\t\t$.datepicker._updateDatepicker(inst);\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch (err) {\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t},\n\n\t/* Pop-up the date picker for a given input field.\n\t * If false returned from beforeShow event handler do not show.\n\t * @param  input  element - the input field attached to the date picker or\n\t *\t\t\t\t\tevent - if triggered by focus\n\t */\n\t_showDatepicker: function(input) {\n\t\tinput = input.target || input;\n\t\tif (input.nodeName.toLowerCase() !== \"input\") { // find from button/image trigger\n\t\t\tinput = $(\"input\", input.parentNode)[0];\n\t\t}\n\n\t\tif ($.datepicker._isDisabledDatepicker(input) || $.datepicker._lastInput === input) { // already here\n\t\t\treturn;\n\t\t}\n\n\t\tvar inst, beforeShow, beforeShowSettings, isFixed,\n\t\t\toffset, showAnim, duration;\n\n\t\tinst = $.datepicker._getInst(input);\n\t\tif ($.datepicker._curInst && $.datepicker._curInst !== inst) {\n\t\t\t$.datepicker._curInst.dpDiv.stop(true, true);\n\t\t\tif ( inst && $.datepicker._datepickerShowing ) {\n\t\t\t\t$.datepicker._hideDatepicker( $.datepicker._curInst.input[0] );\n\t\t\t}\n\t\t}\n\n\t\tbeforeShow = $.datepicker._get(inst, \"beforeShow\");\n\t\tbeforeShowSettings = beforeShow ? beforeShow.apply(input, [input, inst]) : {};\n\t\tif(beforeShowSettings === false){\n\t\t\treturn;\n\t\t}\n\t\tdatepicker_extendRemove(inst.settings, beforeShowSettings);\n\n\t\tinst.lastVal = null;\n\t\t$.datepicker._lastInput = input;\n\t\t$.datepicker._setDateFromField(inst);\n\n\t\tif ($.datepicker._inDialog) { // hide cursor\n\t\t\tinput.value = \"\";\n\t\t}\n\t\tif (!$.datepicker._pos) { // position below input\n\t\t\t$.datepicker._pos = $.datepicker._findPos(input);\n\t\t\t$.datepicker._pos[1] += input.offsetHeight; // add the height\n\t\t}\n\n\t\tisFixed = false;\n\t\t$(input).parents().each(function() {\n\t\t\tisFixed |= $(this).css(\"position\") === \"fixed\";\n\t\t\treturn !isFixed;\n\t\t});\n\n\t\toffset = {left: $.datepicker._pos[0], top: $.datepicker._pos[1]};\n\t\t$.datepicker._pos = null;\n\t\t//to avoid flashes on Firefox\n\t\tinst.dpDiv.empty();\n\t\t// determine sizing offscreen\n\t\tinst.dpDiv.css({position: \"absolute\", display: \"block\", top: \"-1000px\"});\n\t\t$.datepicker._updateDatepicker(inst);\n\t\t// fix width for dynamic number of date pickers\n\t\t// and adjust position before showing\n\t\toffset = $.datepicker._checkOffset(inst, offset, isFixed);\n\t\tinst.dpDiv.css({position: ($.datepicker._inDialog && $.blockUI ?\n\t\t\t\"static\" : (isFixed ? \"fixed\" : \"absolute\")), display: \"none\",\n\t\t\tleft: offset.left + \"px\", top: offset.top + \"px\"});\n\n\t\tif (!inst.inline) {\n\t\t\tshowAnim = $.datepicker._get(inst, \"showAnim\");\n\t\t\tduration = $.datepicker._get(inst, \"duration\");\n\t\t\tinst.dpDiv.css( \"z-index\", datepicker_getZindex( $( input ) ) + 1 );\n\t\t\t$.datepicker._datepickerShowing = true;\n\n\t\t\tif ( $.effects && $.effects.effect[ showAnim ] ) {\n\t\t\t\tinst.dpDiv.show(showAnim, $.datepicker._get(inst, \"showOptions\"), duration);\n\t\t\t} else {\n\t\t\t\tinst.dpDiv[showAnim || \"show\"](showAnim ? duration : null);\n\t\t\t}\n\n\t\t\tif ( $.datepicker._shouldFocusInput( inst ) ) {\n\t\t\t\tinst.input.focus();\n\t\t\t}\n\n\t\t\t$.datepicker._curInst = inst;\n\t\t}\n\t},\n\n\t/* Generate the date picker content. */\n\t_updateDatepicker: function(inst) {\n\t\tthis.maxRows = 4; //Reset the max number of rows being displayed (see #7043)\n\t\tdatepicker_instActive = inst; // for delegate hover events\n\t\tinst.dpDiv.empty().append(this._generateHTML(inst));\n\t\tthis._attachHandlers(inst);\n\n\t\tvar origyearshtml,\n\t\t\tnumMonths = this._getNumberOfMonths(inst),\n\t\t\tcols = numMonths[1],\n\t\t\twidth = 17,\n\t\t\tactiveCell = inst.dpDiv.find( \".\" + this._dayOverClass + \" a\" );\n\n\t\tif ( activeCell.length > 0 ) {\n\t\t\tdatepicker_handleMouseover.apply( activeCell.get( 0 ) );\n\t\t}\n\n\t\tinst.dpDiv.removeClass(\"ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4\").width(\"\");\n\t\tif (cols > 1) {\n\t\t\tinst.dpDiv.addClass(\"ui-datepicker-multi-\" + cols).css(\"width\", (width * cols) + \"em\");\n\t\t}\n\t\tinst.dpDiv[(numMonths[0] !== 1 || numMonths[1] !== 1 ? \"add\" : \"remove\") +\n\t\t\t\"Class\"](\"ui-datepicker-multi\");\n\t\tinst.dpDiv[(this._get(inst, \"isRTL\") ? \"add\" : \"remove\") +\n\t\t\t\"Class\"](\"ui-datepicker-rtl\");\n\n\t\tif (inst === $.datepicker._curInst && $.datepicker._datepickerShowing && $.datepicker._shouldFocusInput( inst ) ) {\n\t\t\tinst.input.focus();\n\t\t}\n\n\t\t// deffered render of the years select (to avoid flashes on Firefox)\n\t\tif( inst.yearshtml ){\n\t\t\torigyearshtml = inst.yearshtml;\n\t\t\tsetTimeout(function(){\n\t\t\t\t//assure that inst.yearshtml didn't change.\n\t\t\t\tif( origyearshtml === inst.yearshtml && inst.yearshtml ){\n\t\t\t\t\tinst.dpDiv.find(\"select.ui-datepicker-year:first\").replaceWith(inst.yearshtml);\n\t\t\t\t}\n\t\t\t\torigyearshtml = inst.yearshtml = null;\n\t\t\t}, 0);\n\t\t}\n\t},\n\n\t// #6694 - don't focus the input if it's already focused\n\t// this breaks the change event in IE\n\t// Support: IE and jQuery <1.9\n\t_shouldFocusInput: function( inst ) {\n\t\treturn inst.input && inst.input.is( \":visible\" ) && !inst.input.is( \":disabled\" ) && !inst.input.is( \":focus\" );\n\t},\n\n\t/* Check positioning to remain on screen. */\n\t_checkOffset: function(inst, offset, isFixed) {\n\t\tvar dpWidth = inst.dpDiv.outerWidth(),\n\t\t\tdpHeight = inst.dpDiv.outerHeight(),\n\t\t\tinputWidth = inst.input ? inst.input.outerWidth() : 0,\n\t\t\tinputHeight = inst.input ? inst.input.outerHeight() : 0,\n\t\t\tviewWidth = document.documentElement.clientWidth + (isFixed ? 0 : $(document).scrollLeft()),\n\t\t\tviewHeight = document.documentElement.clientHeight + (isFixed ? 0 : $(document).scrollTop());\n\n\t\toffset.left -= (this._get(inst, \"isRTL\") ? (dpWidth - inputWidth) : 0);\n\t\toffset.left -= (isFixed && offset.left === inst.input.offset().left) ? $(document).scrollLeft() : 0;\n\t\toffset.top -= (isFixed && offset.top === (inst.input.offset().top + inputHeight)) ? $(document).scrollTop() : 0;\n\n\t\t// now check if datepicker is showing outside window viewport - move to a better place if so.\n\t\toffset.left -= Math.min(offset.left, (offset.left + dpWidth > viewWidth && viewWidth > dpWidth) ?\n\t\t\tMath.abs(offset.left + dpWidth - viewWidth) : 0);\n\t\toffset.top -= Math.min(offset.top, (offset.top + dpHeight > viewHeight && viewHeight > dpHeight) ?\n\t\t\tMath.abs(dpHeight + inputHeight) : 0);\n\n\t\treturn offset;\n\t},\n\n\t/* Find an object's position on the screen. */\n\t_findPos: function(obj) {\n\t\tvar position,\n\t\t\tinst = this._getInst(obj),\n\t\t\tisRTL = this._get(inst, \"isRTL\");\n\n\t\twhile (obj && (obj.type === \"hidden\" || obj.nodeType !== 1 || $.expr.filters.hidden(obj))) {\n\t\t\tobj = obj[isRTL ? \"previousSibling\" : \"nextSibling\"];\n\t\t}\n\n\t\tposition = $(obj).offset();\n\t\treturn [position.left, position.top];\n\t},\n\n\t/* Hide the date picker from view.\n\t * @param  input  element - the input field attached to the date picker\n\t */\n\t_hideDatepicker: function(input) {\n\t\tvar showAnim, duration, postProcess, onClose,\n\t\t\tinst = this._curInst;\n\n\t\tif (!inst || (input && inst !== $.data(input, \"datepicker\"))) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._datepickerShowing) {\n\t\t\tshowAnim = this._get(inst, \"showAnim\");\n\t\t\tduration = this._get(inst, \"duration\");\n\t\t\tpostProcess = function() {\n\t\t\t\t$.datepicker._tidyDialog(inst);\n\t\t\t};\n\n\t\t\t// DEPRECATED: after BC for 1.8.x $.effects[ showAnim ] is not needed\n\t\t\tif ( $.effects && ( $.effects.effect[ showAnim ] || $.effects[ showAnim ] ) ) {\n\t\t\t\tinst.dpDiv.hide(showAnim, $.datepicker._get(inst, \"showOptions\"), duration, postProcess);\n\t\t\t} else {\n\t\t\t\tinst.dpDiv[(showAnim === \"slideDown\" ? \"slideUp\" :\n\t\t\t\t\t(showAnim === \"fadeIn\" ? \"fadeOut\" : \"hide\"))]((showAnim ? duration : null), postProcess);\n\t\t\t}\n\n\t\t\tif (!showAnim) {\n\t\t\t\tpostProcess();\n\t\t\t}\n\t\t\tthis._datepickerShowing = false;\n\n\t\t\tonClose = this._get(inst, \"onClose\");\n\t\t\tif (onClose) {\n\t\t\t\tonClose.apply((inst.input ? inst.input[0] : null), [(inst.input ? inst.input.val() : \"\"), inst]);\n\t\t\t}\n\n\t\t\tthis._lastInput = null;\n\t\t\tif (this._inDialog) {\n\t\t\t\tthis._dialogInput.css({ position: \"absolute\", left: \"0\", top: \"-100px\" });\n\t\t\t\tif ($.blockUI) {\n\t\t\t\t\t$.unblockUI();\n\t\t\t\t\t$(\"body\").append(this.dpDiv);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._inDialog = false;\n\t\t}\n\t},\n\n\t/* Tidy up after a dialog display. */\n\t_tidyDialog: function(inst) {\n\t\tinst.dpDiv.removeClass(this._dialogClass).unbind(\".ui-datepicker-calendar\");\n\t},\n\n\t/* Close date picker if clicked elsewhere. */\n\t_checkExternalClick: function(event) {\n\t\tif (!$.datepicker._curInst) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar $target = $(event.target),\n\t\t\tinst = $.datepicker._getInst($target[0]);\n\n\t\tif ( ( ( $target[0].id !== $.datepicker._mainDivId &&\n\t\t\t\t$target.parents(\"#\" + $.datepicker._mainDivId).length === 0 &&\n\t\t\t\t!$target.hasClass($.datepicker.markerClassName) &&\n\t\t\t\t!$target.closest(\".\" + $.datepicker._triggerClass).length &&\n\t\t\t\t$.datepicker._datepickerShowing && !($.datepicker._inDialog && $.blockUI) ) ) ||\n\t\t\t( $target.hasClass($.datepicker.markerClassName) && $.datepicker._curInst !== inst ) ) {\n\t\t\t\t$.datepicker._hideDatepicker();\n\t\t}\n\t},\n\n\t/* Adjust one of the date sub-fields. */\n\t_adjustDate: function(id, offset, period) {\n\t\tvar target = $(id),\n\t\t\tinst = this._getInst(target[0]);\n\n\t\tif (this._isDisabledDatepicker(target[0])) {\n\t\t\treturn;\n\t\t}\n\t\tthis._adjustInstDate(inst, offset +\n\t\t\t(period === \"M\" ? this._get(inst, \"showCurrentAtPos\") : 0), // undo positioning\n\t\t\tperiod);\n\t\tthis._updateDatepicker(inst);\n\t},\n\n\t/* Action for current link. */\n\t_gotoToday: function(id) {\n\t\tvar date,\n\t\t\ttarget = $(id),\n\t\t\tinst = this._getInst(target[0]);\n\n\t\tif (this._get(inst, \"gotoCurrent\") && inst.currentDay) {\n\t\t\tinst.selectedDay = inst.currentDay;\n\t\t\tinst.drawMonth = inst.selectedMonth = inst.currentMonth;\n\t\t\tinst.drawYear = inst.selectedYear = inst.currentYear;\n\t\t} else {\n\t\t\tdate = new Date();\n\t\t\tinst.selectedDay = date.getDate();\n\t\t\tinst.drawMonth = inst.selectedMonth = date.getMonth();\n\t\t\tinst.drawYear = inst.selectedYear = date.getFullYear();\n\t\t}\n\t\tthis._notifyChange(inst);\n\t\tthis._adjustDate(target);\n\t},\n\n\t/* Action for selecting a new month/year. */\n\t_selectMonthYear: function(id, select, period) {\n\t\tvar target = $(id),\n\t\t\tinst = this._getInst(target[0]);\n\n\t\tinst[\"selected\" + (period === \"M\" ? \"Month\" : \"Year\")] =\n\t\tinst[\"draw\" + (period === \"M\" ? \"Month\" : \"Year\")] =\n\t\t\tparseInt(select.options[select.selectedIndex].value,10);\n\n\t\tthis._notifyChange(inst);\n\t\tthis._adjustDate(target);\n\t},\n\n\t/* Action for selecting a day. */\n\t_selectDay: function(id, month, year, td) {\n\t\tvar inst,\n\t\t\ttarget = $(id);\n\n\t\tif ($(td).hasClass(this._unselectableClass) || this._isDisabledDatepicker(target[0])) {\n\t\t\treturn;\n\t\t}\n\n\t\tinst = this._getInst(target[0]);\n\t\tinst.selectedDay = inst.currentDay = $(\"a\", td).html();\n\t\tinst.selectedMonth = inst.currentMonth = month;\n\t\tinst.selectedYear = inst.currentYear = year;\n\t\tthis._selectDate(id, this._formatDate(inst,\n\t\t\tinst.currentDay, inst.currentMonth, inst.currentYear));\n\t},\n\n\t/* Erase the input field and hide the date picker. */\n\t_clearDate: function(id) {\n\t\tvar target = $(id);\n\t\tthis._selectDate(target, \"\");\n\t},\n\n\t/* Update the input field with the selected date. */\n\t_selectDate: function(id, dateStr) {\n\t\tvar onSelect,\n\t\t\ttarget = $(id),\n\t\t\tinst = this._getInst(target[0]);\n\n\t\tdateStr = (dateStr != null ? dateStr : this._formatDate(inst));\n\t\tif (inst.input) {\n\t\t\tinst.input.val(dateStr);\n\t\t}\n\t\tthis._updateAlternate(inst);\n\n\t\tonSelect = this._get(inst, \"onSelect\");\n\t\tif (onSelect) {\n\t\t\tonSelect.apply((inst.input ? inst.input[0] : null), [dateStr, inst]);  // trigger custom callback\n\t\t} else if (inst.input) {\n\t\t\tinst.input.trigger(\"change\"); // fire the change event\n\t\t}\n\n\t\tif (inst.inline){\n\t\t\tthis._updateDatepicker(inst);\n\t\t} else {\n\t\t\tthis._hideDatepicker();\n\t\t\tthis._lastInput = inst.input[0];\n\t\t\tif (typeof(inst.input[0]) !== \"object\") {\n\t\t\t\tinst.input.focus(); // restore focus\n\t\t\t}\n\t\t\tthis._lastInput = null;\n\t\t}\n\t},\n\n\t/* Update any alternate field to synchronise with the main field. */\n\t_updateAlternate: function(inst) {\n\t\tvar altFormat, date, dateStr,\n\t\t\taltField = this._get(inst, \"altField\");\n\n\t\tif (altField) { // update alternate field too\n\t\t\taltFormat = this._get(inst, \"altFormat\") || this._get(inst, \"dateFormat\");\n\t\t\tdate = this._getDate(inst);\n\t\t\tdateStr = this.formatDate(altFormat, date, this._getFormatConfig(inst));\n\t\t\t$(altField).each(function() { $(this).val(dateStr); });\n\t\t}\n\t},\n\n\t/* Set as beforeShowDay function to prevent selection of weekends.\n\t * @param  date  Date - the date to customise\n\t * @return [boolean, string] - is this date selectable?, what is its CSS class?\n\t */\n\tnoWeekends: function(date) {\n\t\tvar day = date.getDay();\n\t\treturn [(day > 0 && day < 6), \"\"];\n\t},\n\n\t/* Set as calculateWeek to determine the week of the year based on the ISO 8601 definition.\n\t * @param  date  Date - the date to get the week for\n\t * @return  number - the number of the week within the year that contains this date\n\t */\n\tiso8601Week: function(date) {\n\t\tvar time,\n\t\t\tcheckDate = new Date(date.getTime());\n\n\t\t// Find Thursday of this week starting on Monday\n\t\tcheckDate.setDate(checkDate.getDate() + 4 - (checkDate.getDay() || 7));\n\n\t\ttime = checkDate.getTime();\n\t\tcheckDate.setMonth(0); // Compare with Jan 1\n\t\tcheckDate.setDate(1);\n\t\treturn Math.floor(Math.round((time - checkDate) / 86400000) / 7) + 1;\n\t},\n\n\t/* Parse a string value into a date object.\n\t * See formatDate below for the possible formats.\n\t *\n\t * @param  format string - the expected format of the date\n\t * @param  value string - the date in the above format\n\t * @param  settings Object - attributes include:\n\t *\t\t\t\t\tshortYearCutoff  number - the cutoff year for determining the century (optional)\n\t *\t\t\t\t\tdayNamesShort\tstring[7] - abbreviated names of the days from Sunday (optional)\n\t *\t\t\t\t\tdayNames\t\tstring[7] - names of the days from Sunday (optional)\n\t *\t\t\t\t\tmonthNamesShort string[12] - abbreviated names of the months (optional)\n\t *\t\t\t\t\tmonthNames\t\tstring[12] - names of the months (optional)\n\t * @return  Date - the extracted date value or null if value is blank\n\t */\n\tparseDate: function (format, value, settings) {\n\t\tif (format == null || value == null) {\n\t\t\tthrow \"Invalid arguments\";\n\t\t}\n\n\t\tvalue = (typeof value === \"object\" ? value.toString() : value + \"\");\n\t\tif (value === \"\") {\n\t\t\treturn null;\n\t\t}\n\n\t\tvar iFormat, dim, extra,\n\t\t\tiValue = 0,\n\t\t\tshortYearCutoffTemp = (settings ? settings.shortYearCutoff : null) || this._defaults.shortYearCutoff,\n\t\t\tshortYearCutoff = (typeof shortYearCutoffTemp !== \"string\" ? shortYearCutoffTemp :\n\t\t\t\tnew Date().getFullYear() % 100 + parseInt(shortYearCutoffTemp, 10)),\n\t\t\tdayNamesShort = (settings ? settings.dayNamesShort : null) || this._defaults.dayNamesShort,\n\t\t\tdayNames = (settings ? settings.dayNames : null) || this._defaults.dayNames,\n\t\t\tmonthNamesShort = (settings ? settings.monthNamesShort : null) || this._defaults.monthNamesShort,\n\t\t\tmonthNames = (settings ? settings.monthNames : null) || this._defaults.monthNames,\n\t\t\tyear = -1,\n\t\t\tmonth = -1,\n\t\t\tday = -1,\n\t\t\tdoy = -1,\n\t\t\tliteral = false,\n\t\t\tdate,\n\t\t\t// Check whether a format character is doubled\n\t\t\tlookAhead = function(match) {\n\t\t\t\tvar matches = (iFormat + 1 < format.length && format.charAt(iFormat + 1) === match);\n\t\t\t\tif (matches) {\n\t\t\t\t\tiFormat++;\n\t\t\t\t}\n\t\t\t\treturn matches;\n\t\t\t},\n\t\t\t// Extract a number from the string value\n\t\t\tgetNumber = function(match) {\n\t\t\t\tvar isDoubled = lookAhead(match),\n\t\t\t\t\tsize = (match === \"@\" ? 14 : (match === \"!\" ? 20 :\n\t\t\t\t\t(match === \"y\" && isDoubled ? 4 : (match === \"o\" ? 3 : 2)))),\n\t\t\t\t\tminSize = (match === \"y\" ? size : 1),\n\t\t\t\t\tdigits = new RegExp(\"^\\\\d{\" + minSize + \",\" + size + \"}\"),\n\t\t\t\t\tnum = value.substring(iValue).match(digits);\n\t\t\t\tif (!num) {\n\t\t\t\t\tthrow \"Missing number at position \" + iValue;\n\t\t\t\t}\n\t\t\t\tiValue += num[0].length;\n\t\t\t\treturn parseInt(num[0], 10);\n\t\t\t},\n\t\t\t// Extract a name from the string value and convert to an index\n\t\t\tgetName = function(match, shortNames, longNames) {\n\t\t\t\tvar index = -1,\n\t\t\t\t\tnames = $.map(lookAhead(match) ? longNames : shortNames, function (v, k) {\n\t\t\t\t\t\treturn [ [k, v] ];\n\t\t\t\t\t}).sort(function (a, b) {\n\t\t\t\t\t\treturn -(a[1].length - b[1].length);\n\t\t\t\t\t});\n\n\t\t\t\t$.each(names, function (i, pair) {\n\t\t\t\t\tvar name = pair[1];\n\t\t\t\t\tif (value.substr(iValue, name.length).toLowerCase() === name.toLowerCase()) {\n\t\t\t\t\t\tindex = pair[0];\n\t\t\t\t\t\tiValue += name.length;\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (index !== -1) {\n\t\t\t\t\treturn index + 1;\n\t\t\t\t} else {\n\t\t\t\t\tthrow \"Unknown name at position \" + iValue;\n\t\t\t\t}\n\t\t\t},\n\t\t\t// Confirm that a literal character matches the string value\n\t\t\tcheckLiteral = function() {\n\t\t\t\tif (value.charAt(iValue) !== format.charAt(iFormat)) {\n\t\t\t\t\tthrow \"Unexpected literal at position \" + iValue;\n\t\t\t\t}\n\t\t\t\tiValue++;\n\t\t\t};\n\n\t\tfor (iFormat = 0; iFormat < format.length; iFormat++) {\n\t\t\tif (literal) {\n\t\t\t\tif (format.charAt(iFormat) === \"'\" && !lookAhead(\"'\")) {\n\t\t\t\t\tliteral = false;\n\t\t\t\t} else {\n\t\t\t\t\tcheckLiteral();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tswitch (format.charAt(iFormat)) {\n\t\t\t\t\tcase \"d\":\n\t\t\t\t\t\tday = getNumber(\"d\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"D\":\n\t\t\t\t\t\tgetName(\"D\", dayNamesShort, dayNames);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"o\":\n\t\t\t\t\t\tdoy = getNumber(\"o\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"m\":\n\t\t\t\t\t\tmonth = getNumber(\"m\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"M\":\n\t\t\t\t\t\tmonth = getName(\"M\", monthNamesShort, monthNames);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"y\":\n\t\t\t\t\t\tyear = getNumber(\"y\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"@\":\n\t\t\t\t\t\tdate = new Date(getNumber(\"@\"));\n\t\t\t\t\t\tyear = date.getFullYear();\n\t\t\t\t\t\tmonth = date.getMonth() + 1;\n\t\t\t\t\t\tday = date.getDate();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"!\":\n\t\t\t\t\t\tdate = new Date((getNumber(\"!\") - this._ticksTo1970) / 10000);\n\t\t\t\t\t\tyear = date.getFullYear();\n\t\t\t\t\t\tmonth = date.getMonth() + 1;\n\t\t\t\t\t\tday = date.getDate();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"'\":\n\t\t\t\t\t\tif (lookAhead(\"'\")){\n\t\t\t\t\t\t\tcheckLiteral();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tliteral = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tcheckLiteral();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (iValue < value.length){\n\t\t\textra = value.substr(iValue);\n\t\t\tif (!/^\\s+/.test(extra)) {\n\t\t\t\tthrow \"Extra/unparsed characters found in date: \" + extra;\n\t\t\t}\n\t\t}\n\n\t\tif (year === -1) {\n\t\t\tyear = new Date().getFullYear();\n\t\t} else if (year < 100) {\n\t\t\tyear += new Date().getFullYear() - new Date().getFullYear() % 100 +\n\t\t\t\t(year <= shortYearCutoff ? 0 : -100);\n\t\t}\n\n\t\tif (doy > -1) {\n\t\t\tmonth = 1;\n\t\t\tday = doy;\n\t\t\tdo {\n\t\t\t\tdim = this._getDaysInMonth(year, month - 1);\n\t\t\t\tif (day <= dim) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tmonth++;\n\t\t\t\tday -= dim;\n\t\t\t} while (true);\n\t\t}\n\n\t\tdate = this._daylightSavingAdjust(new Date(year, month - 1, day));\n\t\tif (date.getFullYear() !== year || date.getMonth() + 1 !== month || date.getDate() !== day) {\n\t\t\tthrow \"Invalid date\"; // E.g. 31/02/00\n\t\t}\n\t\treturn date;\n\t},\n\n\t/* Standard date formats. */\n\tATOM: \"yy-mm-dd\", // RFC 3339 (ISO 8601)\n\tCOOKIE: \"D, dd M yy\",\n\tISO_8601: \"yy-mm-dd\",\n\tRFC_822: \"D, d M y\",\n\tRFC_850: \"DD, dd-M-y\",\n\tRFC_1036: \"D, d M y\",\n\tRFC_1123: \"D, d M yy\",\n\tRFC_2822: \"D, d M yy\",\n\tRSS: \"D, d M y\", // RFC 822\n\tTICKS: \"!\",\n\tTIMESTAMP: \"@\",\n\tW3C: \"yy-mm-dd\", // ISO 8601\n\n\t_ticksTo1970: (((1970 - 1) * 365 + Math.floor(1970 / 4) - Math.floor(1970 / 100) +\n\t\tMath.floor(1970 / 400)) * 24 * 60 * 60 * 10000000),\n\n\t/* Format a date object into a string value.\n\t * The format can be combinations of the following:\n\t * d  - day of month (no leading zero)\n\t * dd - day of month (two digit)\n\t * o  - day of year (no leading zeros)\n\t * oo - day of year (three digit)\n\t * D  - day name short\n\t * DD - day name long\n\t * m  - month of year (no leading zero)\n\t * mm - month of year (two digit)\n\t * M  - month name short\n\t * MM - month name long\n\t * y  - year (two digit)\n\t * yy - year (four digit)\n\t * @ - Unix timestamp (ms since 01/01/1970)\n\t * ! - Windows ticks (100ns since 01/01/0001)\n\t * \"...\" - literal text\n\t * '' - single quote\n\t *\n\t * @param  format string - the desired format of the date\n\t * @param  date Date - the date value to format\n\t * @param  settings Object - attributes include:\n\t *\t\t\t\t\tdayNamesShort\tstring[7] - abbreviated names of the days from Sunday (optional)\n\t *\t\t\t\t\tdayNames\t\tstring[7] - names of the days from Sunday (optional)\n\t *\t\t\t\t\tmonthNamesShort string[12] - abbreviated names of the months (optional)\n\t *\t\t\t\t\tmonthNames\t\tstring[12] - names of the months (optional)\n\t * @return  string - the date in the above format\n\t */\n\tformatDate: function (format, date, settings) {\n\t\tif (!date) {\n\t\t\treturn \"\";\n\t\t}\n\n\t\tvar iFormat,\n\t\t\tdayNamesShort = (settings ? settings.dayNamesShort : null) || this._defaults.dayNamesShort,\n\t\t\tdayNames = (settings ? settings.dayNames : null) || this._defaults.dayNames,\n\t\t\tmonthNamesShort = (settings ? settings.monthNamesShort : null) || this._defaults.monthNamesShort,\n\t\t\tmonthNames = (settings ? settings.monthNames : null) || this._defaults.monthNames,\n\t\t\t// Check whether a format character is doubled\n\t\t\tlookAhead = function(match) {\n\t\t\t\tvar matches = (iFormat + 1 < format.length && format.charAt(iFormat + 1) === match);\n\t\t\t\tif (matches) {\n\t\t\t\t\tiFormat++;\n\t\t\t\t}\n\t\t\t\treturn matches;\n\t\t\t},\n\t\t\t// Format a number, with leading zero if necessary\n\t\t\tformatNumber = function(match, value, len) {\n\t\t\t\tvar num = \"\" + value;\n\t\t\t\tif (lookAhead(match)) {\n\t\t\t\t\twhile (num.length < len) {\n\t\t\t\t\t\tnum = \"0\" + num;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn num;\n\t\t\t},\n\t\t\t// Format a name, short or long as requested\n\t\t\tformatName = function(match, value, shortNames, longNames) {\n\t\t\t\treturn (lookAhead(match) ? longNames[value] : shortNames[value]);\n\t\t\t},\n\t\t\toutput = \"\",\n\t\t\tliteral = false;\n\n\t\tif (date) {\n\t\t\tfor (iFormat = 0; iFormat < format.length; iFormat++) {\n\t\t\t\tif (literal) {\n\t\t\t\t\tif (format.charAt(iFormat) === \"'\" && !lookAhead(\"'\")) {\n\t\t\t\t\t\tliteral = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\toutput += format.charAt(iFormat);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tswitch (format.charAt(iFormat)) {\n\t\t\t\t\t\tcase \"d\":\n\t\t\t\t\t\t\toutput += formatNumber(\"d\", date.getDate(), 2);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"D\":\n\t\t\t\t\t\t\toutput += formatName(\"D\", date.getDay(), dayNamesShort, dayNames);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"o\":\n\t\t\t\t\t\t\toutput += formatNumber(\"o\",\n\t\t\t\t\t\t\t\tMath.round((new Date(date.getFullYear(), date.getMonth(), date.getDate()).getTime() - new Date(date.getFullYear(), 0, 0).getTime()) / 86400000), 3);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"m\":\n\t\t\t\t\t\t\toutput += formatNumber(\"m\", date.getMonth() + 1, 2);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"M\":\n\t\t\t\t\t\t\toutput += formatName(\"M\", date.getMonth(), monthNamesShort, monthNames);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"y\":\n\t\t\t\t\t\t\toutput += (lookAhead(\"y\") ? date.getFullYear() :\n\t\t\t\t\t\t\t\t(date.getYear() % 100 < 10 ? \"0\" : \"\") + date.getYear() % 100);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"@\":\n\t\t\t\t\t\t\toutput += date.getTime();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"!\":\n\t\t\t\t\t\t\toutput += date.getTime() * 10000 + this._ticksTo1970;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"'\":\n\t\t\t\t\t\t\tif (lookAhead(\"'\")) {\n\t\t\t\t\t\t\t\toutput += \"'\";\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tliteral = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\toutput += format.charAt(iFormat);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t},\n\n\t/* Extract all possible characters from the date format. */\n\t_possibleChars: function (format) {\n\t\tvar iFormat,\n\t\t\tchars = \"\",\n\t\t\tliteral = false,\n\t\t\t// Check whether a format character is doubled\n\t\t\tlookAhead = function(match) {\n\t\t\t\tvar matches = (iFormat + 1 < format.length && format.charAt(iFormat + 1) === match);\n\t\t\t\tif (matches) {\n\t\t\t\t\tiFormat++;\n\t\t\t\t}\n\t\t\t\treturn matches;\n\t\t\t};\n\n\t\tfor (iFormat = 0; iFormat < format.length; iFormat++) {\n\t\t\tif (literal) {\n\t\t\t\tif (format.charAt(iFormat) === \"'\" && !lookAhead(\"'\")) {\n\t\t\t\t\tliteral = false;\n\t\t\t\t} else {\n\t\t\t\t\tchars += format.charAt(iFormat);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tswitch (format.charAt(iFormat)) {\n\t\t\t\t\tcase \"d\": case \"m\": case \"y\": case \"@\":\n\t\t\t\t\t\tchars += \"0123456789\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"D\": case \"M\":\n\t\t\t\t\t\treturn null; // Accept anything\n\t\t\t\t\tcase \"'\":\n\t\t\t\t\t\tif (lookAhead(\"'\")) {\n\t\t\t\t\t\t\tchars += \"'\";\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tliteral = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tchars += format.charAt(iFormat);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn chars;\n\t},\n\n\t/* Get a setting value, defaulting if necessary. */\n\t_get: function(inst, name) {\n\t\treturn inst.settings[name] !== undefined ?\n\t\t\tinst.settings[name] : this._defaults[name];\n\t},\n\n\t/* Parse existing date and initialise date picker. */\n\t_setDateFromField: function(inst, noDefault) {\n\t\tif (inst.input.val() === inst.lastVal) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar dateFormat = this._get(inst, \"dateFormat\"),\n\t\t\tdates = inst.lastVal = inst.input ? inst.input.val() : null,\n\t\t\tdefaultDate = this._getDefaultDate(inst),\n\t\t\tdate = defaultDate,\n\t\t\tsettings = this._getFormatConfig(inst);\n\n\t\ttry {\n\t\t\tdate = this.parseDate(dateFormat, dates, settings) || defaultDate;\n\t\t} catch (event) {\n\t\t\tdates = (noDefault ? \"\" : dates);\n\t\t}\n\t\tinst.selectedDay = date.getDate();\n\t\tinst.drawMonth = inst.selectedMonth = date.getMonth();\n\t\tinst.drawYear = inst.selectedYear = date.getFullYear();\n\t\tinst.currentDay = (dates ? date.getDate() : 0);\n\t\tinst.currentMonth = (dates ? date.getMonth() : 0);\n\t\tinst.currentYear = (dates ? date.getFullYear() : 0);\n\t\tthis._adjustInstDate(inst);\n\t},\n\n\t/* Retrieve the default date shown on opening. */\n\t_getDefaultDate: function(inst) {\n\t\treturn this._restrictMinMax(inst,\n\t\t\tthis._determineDate(inst, this._get(inst, \"defaultDate\"), new Date()));\n\t},\n\n\t/* A date may be specified as an exact value or a relative one. */\n\t_determineDate: function(inst, date, defaultDate) {\n\t\tvar offsetNumeric = function(offset) {\n\t\t\t\tvar date = new Date();\n\t\t\t\tdate.setDate(date.getDate() + offset);\n\t\t\t\treturn date;\n\t\t\t},\n\t\t\toffsetString = function(offset) {\n\t\t\t\ttry {\n\t\t\t\t\treturn $.datepicker.parseDate($.datepicker._get(inst, \"dateFormat\"),\n\t\t\t\t\t\toffset, $.datepicker._getFormatConfig(inst));\n\t\t\t\t}\n\t\t\t\tcatch (e) {\n\t\t\t\t\t// Ignore\n\t\t\t\t}\n\n\t\t\t\tvar date = (offset.toLowerCase().match(/^c/) ?\n\t\t\t\t\t$.datepicker._getDate(inst) : null) || new Date(),\n\t\t\t\t\tyear = date.getFullYear(),\n\t\t\t\t\tmonth = date.getMonth(),\n\t\t\t\t\tday = date.getDate(),\n\t\t\t\t\tpattern = /([+\\-]?[0-9]+)\\s*(d|D|w|W|m|M|y|Y)?/g,\n\t\t\t\t\tmatches = pattern.exec(offset);\n\n\t\t\t\twhile (matches) {\n\t\t\t\t\tswitch (matches[2] || \"d\") {\n\t\t\t\t\t\tcase \"d\" : case \"D\" :\n\t\t\t\t\t\t\tday += parseInt(matches[1],10); break;\n\t\t\t\t\t\tcase \"w\" : case \"W\" :\n\t\t\t\t\t\t\tday += parseInt(matches[1],10) * 7; break;\n\t\t\t\t\t\tcase \"m\" : case \"M\" :\n\t\t\t\t\t\t\tmonth += parseInt(matches[1],10);\n\t\t\t\t\t\t\tday = Math.min(day, $.datepicker._getDaysInMonth(year, month));\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"y\": case \"Y\" :\n\t\t\t\t\t\t\tyear += parseInt(matches[1],10);\n\t\t\t\t\t\t\tday = Math.min(day, $.datepicker._getDaysInMonth(year, month));\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tmatches = pattern.exec(offset);\n\t\t\t\t}\n\t\t\t\treturn new Date(year, month, day);\n\t\t\t},\n\t\t\tnewDate = (date == null || date === \"\" ? defaultDate : (typeof date === \"string\" ? offsetString(date) :\n\t\t\t\t(typeof date === \"number\" ? (isNaN(date) ? defaultDate : offsetNumeric(date)) : new Date(date.getTime()))));\n\n\t\tnewDate = (newDate && newDate.toString() === \"Invalid Date\" ? defaultDate : newDate);\n\t\tif (newDate) {\n\t\t\tnewDate.setHours(0);\n\t\t\tnewDate.setMinutes(0);\n\t\t\tnewDate.setSeconds(0);\n\t\t\tnewDate.setMilliseconds(0);\n\t\t}\n\t\treturn this._daylightSavingAdjust(newDate);\n\t},\n\n\t/* Handle switch to/from daylight saving.\n\t * Hours may be non-zero on daylight saving cut-over:\n\t * > 12 when midnight changeover, but then cannot generate\n\t * midnight datetime, so jump to 1AM, otherwise reset.\n\t * @param  date  (Date) the date to check\n\t * @return  (Date) the corrected date\n\t */\n\t_daylightSavingAdjust: function(date) {\n\t\tif (!date) {\n\t\t\treturn null;\n\t\t}\n\t\tdate.setHours(date.getHours() > 12 ? date.getHours() + 2 : 0);\n\t\treturn date;\n\t},\n\n\t/* Set the date(s) directly. */\n\t_setDate: function(inst, date, noChange) {\n\t\tvar clear = !date,\n\t\t\torigMonth = inst.selectedMonth,\n\t\t\torigYear = inst.selectedYear,\n\t\t\tnewDate = this._restrictMinMax(inst, this._determineDate(inst, date, new Date()));\n\n\t\tinst.selectedDay = inst.currentDay = newDate.getDate();\n\t\tinst.drawMonth = inst.selectedMonth = inst.currentMonth = newDate.getMonth();\n\t\tinst.drawYear = inst.selectedYear = inst.currentYear = newDate.getFullYear();\n\t\tif ((origMonth !== inst.selectedMonth || origYear !== inst.selectedYear) && !noChange) {\n\t\t\tthis._notifyChange(inst);\n\t\t}\n\t\tthis._adjustInstDate(inst);\n\t\tif (inst.input) {\n\t\t\tinst.input.val(clear ? \"\" : this._formatDate(inst));\n\t\t}\n\t},\n\n\t/* Retrieve the date(s) directly. */\n\t_getDate: function(inst) {\n\t\tvar startDate = (!inst.currentYear || (inst.input && inst.input.val() === \"\") ? null :\n\t\t\tthis._daylightSavingAdjust(new Date(\n\t\t\tinst.currentYear, inst.currentMonth, inst.currentDay)));\n\t\t\treturn startDate;\n\t},\n\n\t/* Attach the onxxx handlers.  These are declared statically so\n\t * they work with static code transformers like Caja.\n\t */\n\t_attachHandlers: function(inst) {\n\t\tvar stepMonths = this._get(inst, \"stepMonths\"),\n\t\t\tid = \"#\" + inst.id.replace( /\\\\\\\\/g, \"\\\\\" );\n\t\tinst.dpDiv.find(\"[data-handler]\").map(function () {\n\t\t\tvar handler = {\n\t\t\t\tprev: function () {\n\t\t\t\t\t$.datepicker._adjustDate(id, -stepMonths, \"M\");\n\t\t\t\t},\n\t\t\t\tnext: function () {\n\t\t\t\t\t$.datepicker._adjustDate(id, +stepMonths, \"M\");\n\t\t\t\t},\n\t\t\t\thide: function () {\n\t\t\t\t\t$.datepicker._hideDatepicker();\n\t\t\t\t},\n\t\t\t\ttoday: function () {\n\t\t\t\t\t$.datepicker._gotoToday(id);\n\t\t\t\t},\n\t\t\t\tselectDay: function () {\n\t\t\t\t\t$.datepicker._selectDay(id, +this.getAttribute(\"data-month\"), +this.getAttribute(\"data-year\"), this);\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t\tselectMonth: function () {\n\t\t\t\t\t$.datepicker._selectMonthYear(id, this, \"M\");\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t\tselectYear: function () {\n\t\t\t\t\t$.datepicker._selectMonthYear(id, this, \"Y\");\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t};\n\t\t\t$(this).bind(this.getAttribute(\"data-event\"), handler[this.getAttribute(\"data-handler\")]);\n\t\t});\n\t},\n\n\t/* Generate the HTML for the current state of the date picker. */\n\t_generateHTML: function(inst) {\n\t\tvar maxDraw, prevText, prev, nextText, next, currentText, gotoDate,\n\t\t\tcontrols, buttonPanel, firstDay, showWeek, dayNames, dayNamesMin,\n\t\t\tmonthNames, monthNamesShort, beforeShowDay, showOtherMonths,\n\t\t\tselectOtherMonths, defaultDate, html, dow, row, group, col, selectedDate,\n\t\t\tcornerClass, calender, thead, day, daysInMonth, leadDays, curRows, numRows,\n\t\t\tprintDate, dRow, tbody, daySettings, otherMonth, unselectable,\n\t\t\ttempDate = new Date(),\n\t\t\ttoday = this._daylightSavingAdjust(\n\t\t\t\tnew Date(tempDate.getFullYear(), tempDate.getMonth(), tempDate.getDate())), // clear time\n\t\t\tisRTL = this._get(inst, \"isRTL\"),\n\t\t\tshowButtonPanel = this._get(inst, \"showButtonPanel\"),\n\t\t\thideIfNoPrevNext = this._get(inst, \"hideIfNoPrevNext\"),\n\t\t\tnavigationAsDateFormat = this._get(inst, \"navigationAsDateFormat\"),\n\t\t\tnumMonths = this._getNumberOfMonths(inst),\n\t\t\tshowCurrentAtPos = this._get(inst, \"showCurrentAtPos\"),\n\t\t\tstepMonths = this._get(inst, \"stepMonths\"),\n\t\t\tisMultiMonth = (numMonths[0] !== 1 || numMonths[1] !== 1),\n\t\t\tcurrentDate = this._daylightSavingAdjust((!inst.currentDay ? new Date(9999, 9, 9) :\n\t\t\t\tnew Date(inst.currentYear, inst.currentMonth, inst.currentDay))),\n\t\t\tminDate = this._getMinMaxDate(inst, \"min\"),\n\t\t\tmaxDate = this._getMinMaxDate(inst, \"max\"),\n\t\t\tdrawMonth = inst.drawMonth - showCurrentAtPos,\n\t\t\tdrawYear = inst.drawYear;\n\n\t\tif (drawMonth < 0) {\n\t\t\tdrawMonth += 12;\n\t\t\tdrawYear--;\n\t\t}\n\t\tif (maxDate) {\n\t\t\tmaxDraw = this._daylightSavingAdjust(new Date(maxDate.getFullYear(),\n\t\t\t\tmaxDate.getMonth() - (numMonths[0] * numMonths[1]) + 1, maxDate.getDate()));\n\t\t\tmaxDraw = (minDate && maxDraw < minDate ? minDate : maxDraw);\n\t\t\twhile (this._daylightSavingAdjust(new Date(drawYear, drawMonth, 1)) > maxDraw) {\n\t\t\t\tdrawMonth--;\n\t\t\t\tif (drawMonth < 0) {\n\t\t\t\t\tdrawMonth = 11;\n\t\t\t\t\tdrawYear--;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tinst.drawMonth = drawMonth;\n\t\tinst.drawYear = drawYear;\n\n\t\tprevText = this._get(inst, \"prevText\");\n\t\tprevText = (!navigationAsDateFormat ? prevText : this.formatDate(prevText,\n\t\t\tthis._daylightSavingAdjust(new Date(drawYear, drawMonth - stepMonths, 1)),\n\t\t\tthis._getFormatConfig(inst)));\n\n\t\tprev = (this._canAdjustMonth(inst, -1, drawYear, drawMonth) ?\n\t\t\t\"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click'\" +\n\t\t\t\" title='\" + prevText + \"'><span class='ui-icon ui-icon-circle-triangle-\" + ( isRTL ? \"e\" : \"w\") + \"'>\" + prevText + \"</span></a>\" :\n\t\t\t(hideIfNoPrevNext ? \"\" : \"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='\"+ prevText +\"'><span class='ui-icon ui-icon-circle-triangle-\" + ( isRTL ? \"e\" : \"w\") + \"'>\" + prevText + \"</span></a>\"));\n\n\t\tnextText = this._get(inst, \"nextText\");\n\t\tnextText = (!navigationAsDateFormat ? nextText : this.formatDate(nextText,\n\t\t\tthis._daylightSavingAdjust(new Date(drawYear, drawMonth + stepMonths, 1)),\n\t\t\tthis._getFormatConfig(inst)));\n\n\t\tnext = (this._canAdjustMonth(inst, +1, drawYear, drawMonth) ?\n\t\t\t\"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click'\" +\n\t\t\t\" title='\" + nextText + \"'><span class='ui-icon ui-icon-circle-triangle-\" + ( isRTL ? \"w\" : \"e\") + \"'>\" + nextText + \"</span></a>\" :\n\t\t\t(hideIfNoPrevNext ? \"\" : \"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='\"+ nextText + \"'><span class='ui-icon ui-icon-circle-triangle-\" + ( isRTL ? \"w\" : \"e\") + \"'>\" + nextText + \"</span></a>\"));\n\n\t\tcurrentText = this._get(inst, \"currentText\");\n\t\tgotoDate = (this._get(inst, \"gotoCurrent\") && inst.currentDay ? currentDate : today);\n\t\tcurrentText = (!navigationAsDateFormat ? currentText :\n\t\t\tthis.formatDate(currentText, gotoDate, this._getFormatConfig(inst)));\n\n\t\tcontrols = (!inst.inline ? \"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>\" +\n\t\t\tthis._get(inst, \"closeText\") + \"</button>\" : \"\");\n\n\t\tbuttonPanel = (showButtonPanel) ? \"<div class='ui-datepicker-buttonpane ui-widget-content'>\" + (isRTL ? controls : \"\") +\n\t\t\t(this._isInRange(inst, gotoDate) ? \"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'\" +\n\t\t\t\">\" + currentText + \"</button>\" : \"\") + (isRTL ? \"\" : controls) + \"</div>\" : \"\";\n\n\t\tfirstDay = parseInt(this._get(inst, \"firstDay\"),10);\n\t\tfirstDay = (isNaN(firstDay) ? 0 : firstDay);\n\n\t\tshowWeek = this._get(inst, \"showWeek\");\n\t\tdayNames = this._get(inst, \"dayNames\");\n\t\tdayNamesMin = this._get(inst, \"dayNamesMin\");\n\t\tmonthNames = this._get(inst, \"monthNames\");\n\t\tmonthNamesShort = this._get(inst, \"monthNamesShort\");\n\t\tbeforeShowDay = this._get(inst, \"beforeShowDay\");\n\t\tshowOtherMonths = this._get(inst, \"showOtherMonths\");\n\t\tselectOtherMonths = this._get(inst, \"selectOtherMonths\");\n\t\tdefaultDate = this._getDefaultDate(inst);\n\t\thtml = \"\";\n\t\tdow;\n\t\tfor (row = 0; row < numMonths[0]; row++) {\n\t\t\tgroup = \"\";\n\t\t\tthis.maxRows = 4;\n\t\t\tfor (col = 0; col < numMonths[1]; col++) {\n\t\t\t\tselectedDate = this._daylightSavingAdjust(new Date(drawYear, drawMonth, inst.selectedDay));\n\t\t\t\tcornerClass = \" ui-corner-all\";\n\t\t\t\tcalender = \"\";\n\t\t\t\tif (isMultiMonth) {\n\t\t\t\t\tcalender += \"<div class='ui-datepicker-group\";\n\t\t\t\t\tif (numMonths[1] > 1) {\n\t\t\t\t\t\tswitch (col) {\n\t\t\t\t\t\t\tcase 0: calender += \" ui-datepicker-group-first\";\n\t\t\t\t\t\t\t\tcornerClass = \" ui-corner-\" + (isRTL ? \"right\" : \"left\"); break;\n\t\t\t\t\t\t\tcase numMonths[1]-1: calender += \" ui-datepicker-group-last\";\n\t\t\t\t\t\t\t\tcornerClass = \" ui-corner-\" + (isRTL ? \"left\" : \"right\"); break;\n\t\t\t\t\t\t\tdefault: calender += \" ui-datepicker-group-middle\"; cornerClass = \"\"; break;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcalender += \"'>\";\n\t\t\t\t}\n\t\t\t\tcalender += \"<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix\" + cornerClass + \"'>\" +\n\t\t\t\t\t(/all|left/.test(cornerClass) && row === 0 ? (isRTL ? next : prev) : \"\") +\n\t\t\t\t\t(/all|right/.test(cornerClass) && row === 0 ? (isRTL ? prev : next) : \"\") +\n\t\t\t\t\tthis._generateMonthYearHeader(inst, drawMonth, drawYear, minDate, maxDate,\n\t\t\t\t\trow > 0 || col > 0, monthNames, monthNamesShort) + // draw month headers\n\t\t\t\t\t\"</div><table class='ui-datepicker-calendar'><thead>\" +\n\t\t\t\t\t\"<tr>\";\n\t\t\t\tthead = (showWeek ? \"<th class='ui-datepicker-week-col'>\" + this._get(inst, \"weekHeader\") + \"</th>\" : \"\");\n\t\t\t\tfor (dow = 0; dow < 7; dow++) { // days of the week\n\t\t\t\t\tday = (dow + firstDay) % 7;\n\t\t\t\t\tthead += \"<th scope='col'\" + ((dow + firstDay + 6) % 7 >= 5 ? \" class='ui-datepicker-week-end'\" : \"\") + \">\" +\n\t\t\t\t\t\t\"<span title='\" + dayNames[day] + \"'>\" + dayNamesMin[day] + \"</span></th>\";\n\t\t\t\t}\n\t\t\t\tcalender += thead + \"</tr></thead><tbody>\";\n\t\t\t\tdaysInMonth = this._getDaysInMonth(drawYear, drawMonth);\n\t\t\t\tif (drawYear === inst.selectedYear && drawMonth === inst.selectedMonth) {\n\t\t\t\t\tinst.selectedDay = Math.min(inst.selectedDay, daysInMonth);\n\t\t\t\t}\n\t\t\t\tleadDays = (this._getFirstDayOfMonth(drawYear, drawMonth) - firstDay + 7) % 7;\n\t\t\t\tcurRows = Math.ceil((leadDays + daysInMonth) / 7); // calculate the number of rows to generate\n\t\t\t\tnumRows = (isMultiMonth ? this.maxRows > curRows ? this.maxRows : curRows : curRows); //If multiple months, use the higher number of rows (see #7043)\n\t\t\t\tthis.maxRows = numRows;\n\t\t\t\tprintDate = this._daylightSavingAdjust(new Date(drawYear, drawMonth, 1 - leadDays));\n\t\t\t\tfor (dRow = 0; dRow < numRows; dRow++) { // create date picker rows\n\t\t\t\t\tcalender += \"<tr>\";\n\t\t\t\t\ttbody = (!showWeek ? \"\" : \"<td class='ui-datepicker-week-col'>\" +\n\t\t\t\t\t\tthis._get(inst, \"calculateWeek\")(printDate) + \"</td>\");\n\t\t\t\t\tfor (dow = 0; dow < 7; dow++) { // create date picker days\n\t\t\t\t\t\tdaySettings = (beforeShowDay ?\n\t\t\t\t\t\t\tbeforeShowDay.apply((inst.input ? inst.input[0] : null), [printDate]) : [true, \"\"]);\n\t\t\t\t\t\totherMonth = (printDate.getMonth() !== drawMonth);\n\t\t\t\t\t\tunselectable = (otherMonth && !selectOtherMonths) || !daySettings[0] ||\n\t\t\t\t\t\t\t(minDate && printDate < minDate) || (maxDate && printDate > maxDate);\n\t\t\t\t\t\ttbody += \"<td class='\" +\n\t\t\t\t\t\t\t((dow + firstDay + 6) % 7 >= 5 ? \" ui-datepicker-week-end\" : \"\") + // highlight weekends\n\t\t\t\t\t\t\t(otherMonth ? \" ui-datepicker-other-month\" : \"\") + // highlight days from other months\n\t\t\t\t\t\t\t((printDate.getTime() === selectedDate.getTime() && drawMonth === inst.selectedMonth && inst._keyEvent) || // user pressed key\n\t\t\t\t\t\t\t(defaultDate.getTime() === printDate.getTime() && defaultDate.getTime() === selectedDate.getTime()) ?\n\t\t\t\t\t\t\t// or defaultDate is current printedDate and defaultDate is selectedDate\n\t\t\t\t\t\t\t\" \" + this._dayOverClass : \"\") + // highlight selected day\n\t\t\t\t\t\t\t(unselectable ? \" \" + this._unselectableClass + \" ui-state-disabled\": \"\") +  // highlight unselectable days\n\t\t\t\t\t\t\t(otherMonth && !showOtherMonths ? \"\" : \" \" + daySettings[1] + // highlight custom dates\n\t\t\t\t\t\t\t(printDate.getTime() === currentDate.getTime() ? \" \" + this._currentClass : \"\") + // highlight selected day\n\t\t\t\t\t\t\t(printDate.getTime() === today.getTime() ? \" ui-datepicker-today\" : \"\")) + \"'\" + // highlight today (if different)\n\t\t\t\t\t\t\t((!otherMonth || showOtherMonths) && daySettings[2] ? \" title='\" + daySettings[2].replace(/'/g, \"&#39;\") + \"'\" : \"\") + // cell title\n\t\t\t\t\t\t\t(unselectable ? \"\" : \" data-handler='selectDay' data-event='click' data-month='\" + printDate.getMonth() + \"' data-year='\" + printDate.getFullYear() + \"'\") + \">\" + // actions\n\t\t\t\t\t\t\t(otherMonth && !showOtherMonths ? \"&#xa0;\" : // display for other months\n\t\t\t\t\t\t\t(unselectable ? \"<span class='ui-state-default'>\" + printDate.getDate() + \"</span>\" : \"<a class='ui-state-default\" +\n\t\t\t\t\t\t\t(printDate.getTime() === today.getTime() ? \" ui-state-highlight\" : \"\") +\n\t\t\t\t\t\t\t(printDate.getTime() === currentDate.getTime() ? \" ui-state-active\" : \"\") + // highlight selected day\n\t\t\t\t\t\t\t(otherMonth ? \" ui-priority-secondary\" : \"\") + // distinguish dates from other months\n\t\t\t\t\t\t\t\"' href='#'>\" + printDate.getDate() + \"</a>\")) + \"</td>\"; // display selectable date\n\t\t\t\t\t\tprintDate.setDate(printDate.getDate() + 1);\n\t\t\t\t\t\tprintDate = this._daylightSavingAdjust(printDate);\n\t\t\t\t\t}\n\t\t\t\t\tcalender += tbody + \"</tr>\";\n\t\t\t\t}\n\t\t\t\tdrawMonth++;\n\t\t\t\tif (drawMonth > 11) {\n\t\t\t\t\tdrawMonth = 0;\n\t\t\t\t\tdrawYear++;\n\t\t\t\t}\n\t\t\t\tcalender += \"</tbody></table>\" + (isMultiMonth ? \"</div>\" +\n\t\t\t\t\t\t\t((numMonths[0] > 0 && col === numMonths[1]-1) ? \"<div class='ui-datepicker-row-break'></div>\" : \"\") : \"\");\n\t\t\t\tgroup += calender;\n\t\t\t}\n\t\t\thtml += group;\n\t\t}\n\t\thtml += buttonPanel;\n\t\tinst._keyEvent = false;\n\t\treturn html;\n\t},\n\n\t/* Generate the month and year header. */\n\t_generateMonthYearHeader: function(inst, drawMonth, drawYear, minDate, maxDate,\n\t\t\tsecondary, monthNames, monthNamesShort) {\n\n\t\tvar inMinYear, inMaxYear, month, years, thisYear, determineYear, year, endYear,\n\t\t\tchangeMonth = this._get(inst, \"changeMonth\"),\n\t\t\tchangeYear = this._get(inst, \"changeYear\"),\n\t\t\tshowMonthAfterYear = this._get(inst, \"showMonthAfterYear\"),\n\t\t\thtml = \"<div class='ui-datepicker-title'>\",\n\t\t\tmonthHtml = \"\";\n\n\t\t// month selection\n\t\tif (secondary || !changeMonth) {\n\t\t\tmonthHtml += \"<span class='ui-datepicker-month'>\" + monthNames[drawMonth] + \"</span>\";\n\t\t} else {\n\t\t\tinMinYear = (minDate && minDate.getFullYear() === drawYear);\n\t\t\tinMaxYear = (maxDate && maxDate.getFullYear() === drawYear);\n\t\t\tmonthHtml += \"<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>\";\n\t\t\tfor ( month = 0; month < 12; month++) {\n\t\t\t\tif ((!inMinYear || month >= minDate.getMonth()) && (!inMaxYear || month <= maxDate.getMonth())) {\n\t\t\t\t\tmonthHtml += \"<option value='\" + month + \"'\" +\n\t\t\t\t\t\t(month === drawMonth ? \" selected='selected'\" : \"\") +\n\t\t\t\t\t\t\">\" + monthNamesShort[month] + \"</option>\";\n\t\t\t\t}\n\t\t\t}\n\t\t\tmonthHtml += \"</select>\";\n\t\t}\n\n\t\tif (!showMonthAfterYear) {\n\t\t\thtml += monthHtml + (secondary || !(changeMonth && changeYear) ? \"&#xa0;\" : \"\");\n\t\t}\n\n\t\t// year selection\n\t\tif ( !inst.yearshtml ) {\n\t\t\tinst.yearshtml = \"\";\n\t\t\tif (secondary || !changeYear) {\n\t\t\t\thtml += \"<span class='ui-datepicker-year'>\" + drawYear + \"</span>\";\n\t\t\t} else {\n\t\t\t\t// determine range of years to display\n\t\t\t\tyears = this._get(inst, \"yearRange\").split(\":\");\n\t\t\t\tthisYear = new Date().getFullYear();\n\t\t\t\tdetermineYear = function(value) {\n\t\t\t\t\tvar year = (value.match(/c[+\\-].*/) ? drawYear + parseInt(value.substring(1), 10) :\n\t\t\t\t\t\t(value.match(/[+\\-].*/) ? thisYear + parseInt(value, 10) :\n\t\t\t\t\t\tparseInt(value, 10)));\n\t\t\t\t\treturn (isNaN(year) ? thisYear : year);\n\t\t\t\t};\n\t\t\t\tyear = determineYear(years[0]);\n\t\t\t\tendYear = Math.max(year, determineYear(years[1] || \"\"));\n\t\t\t\tyear = (minDate ? Math.max(year, minDate.getFullYear()) : year);\n\t\t\t\tendYear = (maxDate ? Math.min(endYear, maxDate.getFullYear()) : endYear);\n\t\t\t\tinst.yearshtml += \"<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>\";\n\t\t\t\tfor (; year <= endYear; year++) {\n\t\t\t\t\tinst.yearshtml += \"<option value='\" + year + \"'\" +\n\t\t\t\t\t\t(year === drawYear ? \" selected='selected'\" : \"\") +\n\t\t\t\t\t\t\">\" + year + \"</option>\";\n\t\t\t\t}\n\t\t\t\tinst.yearshtml += \"</select>\";\n\n\t\t\t\thtml += inst.yearshtml;\n\t\t\t\tinst.yearshtml = null;\n\t\t\t}\n\t\t}\n\n\t\thtml += this._get(inst, \"yearSuffix\");\n\t\tif (showMonthAfterYear) {\n\t\t\thtml += (secondary || !(changeMonth && changeYear) ? \"&#xa0;\" : \"\") + monthHtml;\n\t\t}\n\t\thtml += \"</div>\"; // Close datepicker_header\n\t\treturn html;\n\t},\n\n\t/* Adjust one of the date sub-fields. */\n\t_adjustInstDate: function(inst, offset, period) {\n\t\tvar year = inst.drawYear + (period === \"Y\" ? offset : 0),\n\t\t\tmonth = inst.drawMonth + (period === \"M\" ? offset : 0),\n\t\t\tday = Math.min(inst.selectedDay, this._getDaysInMonth(year, month)) + (period === \"D\" ? offset : 0),\n\t\t\tdate = this._restrictMinMax(inst, this._daylightSavingAdjust(new Date(year, month, day)));\n\n\t\tinst.selectedDay = date.getDate();\n\t\tinst.drawMonth = inst.selectedMonth = date.getMonth();\n\t\tinst.drawYear = inst.selectedYear = date.getFullYear();\n\t\tif (period === \"M\" || period === \"Y\") {\n\t\t\tthis._notifyChange(inst);\n\t\t}\n\t},\n\n\t/* Ensure a date is within any min/max bounds. */\n\t_restrictMinMax: function(inst, date) {\n\t\tvar minDate = this._getMinMaxDate(inst, \"min\"),\n\t\t\tmaxDate = this._getMinMaxDate(inst, \"max\"),\n\t\t\tnewDate = (minDate && date < minDate ? minDate : date);\n\t\treturn (maxDate && newDate > maxDate ? maxDate : newDate);\n\t},\n\n\t/* Notify change of month/year. */\n\t_notifyChange: function(inst) {\n\t\tvar onChange = this._get(inst, \"onChangeMonthYear\");\n\t\tif (onChange) {\n\t\t\tonChange.apply((inst.input ? inst.input[0] : null),\n\t\t\t\t[inst.selectedYear, inst.selectedMonth + 1, inst]);\n\t\t}\n\t},\n\n\t/* Determine the number of months to show. */\n\t_getNumberOfMonths: function(inst) {\n\t\tvar numMonths = this._get(inst, \"numberOfMonths\");\n\t\treturn (numMonths == null ? [1, 1] : (typeof numMonths === \"number\" ? [1, numMonths] : numMonths));\n\t},\n\n\t/* Determine the current maximum date - ensure no time components are set. */\n\t_getMinMaxDate: function(inst, minMax) {\n\t\treturn this._determineDate(inst, this._get(inst, minMax + \"Date\"), null);\n\t},\n\n\t/* Find the number of days in a given month. */\n\t_getDaysInMonth: function(year, month) {\n\t\treturn 32 - this._daylightSavingAdjust(new Date(year, month, 32)).getDate();\n\t},\n\n\t/* Find the day of the week of the first of a month. */\n\t_getFirstDayOfMonth: function(year, month) {\n\t\treturn new Date(year, month, 1).getDay();\n\t},\n\n\t/* Determines if we should allow a \"next/prev\" month display change. */\n\t_canAdjustMonth: function(inst, offset, curYear, curMonth) {\n\t\tvar numMonths = this._getNumberOfMonths(inst),\n\t\t\tdate = this._daylightSavingAdjust(new Date(curYear,\n\t\t\tcurMonth + (offset < 0 ? offset : numMonths[0] * numMonths[1]), 1));\n\n\t\tif (offset < 0) {\n\t\t\tdate.setDate(this._getDaysInMonth(date.getFullYear(), date.getMonth()));\n\t\t}\n\t\treturn this._isInRange(inst, date);\n\t},\n\n\t/* Is the given date in the accepted range? */\n\t_isInRange: function(inst, date) {\n\t\tvar yearSplit, currentYear,\n\t\t\tminDate = this._getMinMaxDate(inst, \"min\"),\n\t\t\tmaxDate = this._getMinMaxDate(inst, \"max\"),\n\t\t\tminYear = null,\n\t\t\tmaxYear = null,\n\t\t\tyears = this._get(inst, \"yearRange\");\n\t\t\tif (years){\n\t\t\t\tyearSplit = years.split(\":\");\n\t\t\t\tcurrentYear = new Date().getFullYear();\n\t\t\t\tminYear = parseInt(yearSplit[0], 10);\n\t\t\t\tmaxYear = parseInt(yearSplit[1], 10);\n\t\t\t\tif ( yearSplit[0].match(/[+\\-].*/) ) {\n\t\t\t\t\tminYear += currentYear;\n\t\t\t\t}\n\t\t\t\tif ( yearSplit[1].match(/[+\\-].*/) ) {\n\t\t\t\t\tmaxYear += currentYear;\n\t\t\t\t}\n\t\t\t}\n\n\t\treturn ((!minDate || date.getTime() >= minDate.getTime()) &&\n\t\t\t(!maxDate || date.getTime() <= maxDate.getTime()) &&\n\t\t\t(!minYear || date.getFullYear() >= minYear) &&\n\t\t\t(!maxYear || date.getFullYear() <= maxYear));\n\t},\n\n\t/* Provide the configuration settings for formatting/parsing. */\n\t_getFormatConfig: function(inst) {\n\t\tvar shortYearCutoff = this._get(inst, \"shortYearCutoff\");\n\t\tshortYearCutoff = (typeof shortYearCutoff !== \"string\" ? shortYearCutoff :\n\t\t\tnew Date().getFullYear() % 100 + parseInt(shortYearCutoff, 10));\n\t\treturn {shortYearCutoff: shortYearCutoff,\n\t\t\tdayNamesShort: this._get(inst, \"dayNamesShort\"), dayNames: this._get(inst, \"dayNames\"),\n\t\t\tmonthNamesShort: this._get(inst, \"monthNamesShort\"), monthNames: this._get(inst, \"monthNames\")};\n\t},\n\n\t/* Format the given date for display. */\n\t_formatDate: function(inst, day, month, year) {\n\t\tif (!day) {\n\t\t\tinst.currentDay = inst.selectedDay;\n\t\t\tinst.currentMonth = inst.selectedMonth;\n\t\t\tinst.currentYear = inst.selectedYear;\n\t\t}\n\t\tvar date = (day ? (typeof day === \"object\" ? day :\n\t\t\tthis._daylightSavingAdjust(new Date(year, month, day))) :\n\t\t\tthis._daylightSavingAdjust(new Date(inst.currentYear, inst.currentMonth, inst.currentDay)));\n\t\treturn this.formatDate(this._get(inst, \"dateFormat\"), date, this._getFormatConfig(inst));\n\t}\n});\n\n/*\n * Bind hover events for datepicker elements.\n * Done via delegate so the binding only occurs once in the lifetime of the parent div.\n * Global datepicker_instActive, set by _updateDatepicker allows the handlers to find their way back to the active picker.\n */\nfunction datepicker_bindHover(dpDiv) {\n\tvar selector = \"button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a\";\n\treturn dpDiv.delegate(selector, \"mouseout\", function() {\n\t\t\t$(this).removeClass(\"ui-state-hover\");\n\t\t\tif (this.className.indexOf(\"ui-datepicker-prev\") !== -1) {\n\t\t\t\t$(this).removeClass(\"ui-datepicker-prev-hover\");\n\t\t\t}\n\t\t\tif (this.className.indexOf(\"ui-datepicker-next\") !== -1) {\n\t\t\t\t$(this).removeClass(\"ui-datepicker-next-hover\");\n\t\t\t}\n\t\t})\n\t\t.delegate( selector, \"mouseover\", datepicker_handleMouseover );\n}\n\nfunction datepicker_handleMouseover() {\n\tif (!$.datepicker._isDisabledDatepicker( datepicker_instActive.inline? datepicker_instActive.dpDiv.parent()[0] : datepicker_instActive.input[0])) {\n\t\t$(this).parents(\".ui-datepicker-calendar\").find(\"a\").removeClass(\"ui-state-hover\");\n\t\t$(this).addClass(\"ui-state-hover\");\n\t\tif (this.className.indexOf(\"ui-datepicker-prev\") !== -1) {\n\t\t\t$(this).addClass(\"ui-datepicker-prev-hover\");\n\t\t}\n\t\tif (this.className.indexOf(\"ui-datepicker-next\") !== -1) {\n\t\t\t$(this).addClass(\"ui-datepicker-next-hover\");\n\t\t}\n\t}\n}\n\n/* jQuery extend now ignores nulls! */\nfunction datepicker_extendRemove(target, props) {\n\t$.extend(target, props);\n\tfor (var name in props) {\n\t\tif (props[name] == null) {\n\t\t\ttarget[name] = props[name];\n\t\t}\n\t}\n\treturn target;\n}\n\n/* Invoke the datepicker functionality.\n   @param  options  string - a command, optionally followed by additional parameters or\n\t\t\t\t\tObject - settings for attaching new datepicker functionality\n   @return  jQuery object */\n$.fn.datepicker = function(options){\n\n\t/* Verify an empty collection wasn't passed - Fixes #6976 */\n\tif ( !this.length ) {\n\t\treturn this;\n\t}\n\n\t/* Initialise the date picker. */\n\tif (!$.datepicker.initialized) {\n\t\t$(document).mousedown($.datepicker._checkExternalClick);\n\t\t$.datepicker.initialized = true;\n\t}\n\n\t/* Append datepicker main container to body if not exist. */\n\tif ($(\"#\"+$.datepicker._mainDivId).length === 0) {\n\t\t$(\"body\").append($.datepicker.dpDiv);\n\t}\n\n\tvar otherArgs = Array.prototype.slice.call(arguments, 1);\n\tif (typeof options === \"string\" && (options === \"isDisabled\" || options === \"getDate\" || options === \"widget\")) {\n\t\treturn $.datepicker[\"_\" + options + \"Datepicker\"].\n\t\t\tapply($.datepicker, [this[0]].concat(otherArgs));\n\t}\n\tif (options === \"option\" && arguments.length === 2 && typeof arguments[1] === \"string\") {\n\t\treturn $.datepicker[\"_\" + options + \"Datepicker\"].\n\t\t\tapply($.datepicker, [this[0]].concat(otherArgs));\n\t}\n\treturn this.each(function() {\n\t\ttypeof options === \"string\" ?\n\t\t\t$.datepicker[\"_\" + options + \"Datepicker\"].\n\t\t\t\tapply($.datepicker, [this].concat(otherArgs)) :\n\t\t\t$.datepicker._attachDatepicker(this, options);\n\t});\n};\n\n$.datepicker = new Datepicker(); // singleton instance\n$.datepicker.initialized = false;\n$.datepicker.uuid = new Date().getTime();\n$.datepicker.version = \"1.11.4\";\n\nvar datepicker = $.datepicker;\n\n\n/*!\n * jQuery UI Draggable 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/draggable/\n */\n\n\n$.widget(\"ui.draggable\", $.ui.mouse, {\n\tversion: \"1.11.4\",\n\twidgetEventPrefix: \"drag\",\n\toptions: {\n\t\taddClasses: true,\n\t\tappendTo: \"parent\",\n\t\taxis: false,\n\t\tconnectToSortable: false,\n\t\tcontainment: false,\n\t\tcursor: \"auto\",\n\t\tcursorAt: false,\n\t\tgrid: false,\n\t\thandle: false,\n\t\thelper: \"original\",\n\t\tiframeFix: false,\n\t\topacity: false,\n\t\trefreshPositions: false,\n\t\trevert: false,\n\t\trevertDuration: 500,\n\t\tscope: \"default\",\n\t\tscroll: true,\n\t\tscrollSensitivity: 20,\n\t\tscrollSpeed: 20,\n\t\tsnap: false,\n\t\tsnapMode: \"both\",\n\t\tsnapTolerance: 20,\n\t\tstack: false,\n\t\tzIndex: false,\n\n\t\t// callbacks\n\t\tdrag: null,\n\t\tstart: null,\n\t\tstop: null\n\t},\n\t_create: function() {\n\n\t\tif ( this.options.helper === \"original\" ) {\n\t\t\tthis._setPositionRelative();\n\t\t}\n\t\tif (this.options.addClasses){\n\t\t\tthis.element.addClass(\"ui-draggable\");\n\t\t}\n\t\tif (this.options.disabled){\n\t\t\tthis.element.addClass(\"ui-draggable-disabled\");\n\t\t}\n\t\tthis._setHandleClassName();\n\n\t\tthis._mouseInit();\n\t},\n\n\t_setOption: function( key, value ) {\n\t\tthis._super( key, value );\n\t\tif ( key === \"handle\" ) {\n\t\t\tthis._removeHandleClassName();\n\t\t\tthis._setHandleClassName();\n\t\t}\n\t},\n\n\t_destroy: function() {\n\t\tif ( ( this.helper || this.element ).is( \".ui-draggable-dragging\" ) ) {\n\t\t\tthis.destroyOnClear = true;\n\t\t\treturn;\n\t\t}\n\t\tthis.element.removeClass( \"ui-draggable ui-draggable-dragging ui-draggable-disabled\" );\n\t\tthis._removeHandleClassName();\n\t\tthis._mouseDestroy();\n\t},\n\n\t_mouseCapture: function(event) {\n\t\tvar o = this.options;\n\n\t\tthis._blurActiveElement( event );\n\n\t\t// among others, prevent a drag on a resizable-handle\n\t\tif (this.helper || o.disabled || $(event.target).closest(\".ui-resizable-handle\").length > 0) {\n\t\t\treturn false;\n\t\t}\n\n\t\t//Quit if we're not on a valid handle\n\t\tthis.handle = this._getHandle(event);\n\t\tif (!this.handle) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis._blockFrames( o.iframeFix === true ? \"iframe\" : o.iframeFix );\n\n\t\treturn true;\n\n\t},\n\n\t_blockFrames: function( selector ) {\n\t\tthis.iframeBlocks = this.document.find( selector ).map(function() {\n\t\t\tvar iframe = $( this );\n\n\t\t\treturn $( \"<div>\" )\n\t\t\t\t.css( \"position\", \"absolute\" )\n\t\t\t\t.appendTo( iframe.parent() )\n\t\t\t\t.outerWidth( iframe.outerWidth() )\n\t\t\t\t.outerHeight( iframe.outerHeight() )\n\t\t\t\t.offset( iframe.offset() )[ 0 ];\n\t\t});\n\t},\n\n\t_unblockFrames: function() {\n\t\tif ( this.iframeBlocks ) {\n\t\t\tthis.iframeBlocks.remove();\n\t\t\tdelete this.iframeBlocks;\n\t\t}\n\t},\n\n\t_blurActiveElement: function( event ) {\n\t\tvar document = this.document[ 0 ];\n\n\t\t// Only need to blur if the event occurred on the draggable itself, see #10527\n\t\tif ( !this.handleElement.is( event.target ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// support: IE9\n\t\t// IE9 throws an \"Unspecified error\" accessing document.activeElement from an <iframe>\n\t\ttry {\n\n\t\t\t// Support: IE9, IE10\n\t\t\t// If the <body> is blurred, IE will switch windows, see #9520\n\t\t\tif ( document.activeElement && document.activeElement.nodeName.toLowerCase() !== \"body\" ) {\n\n\t\t\t\t// Blur any element that currently has focus, see #4261\n\t\t\t\t$( document.activeElement ).blur();\n\t\t\t}\n\t\t} catch ( error ) {}\n\t},\n\n\t_mouseStart: function(event) {\n\n\t\tvar o = this.options;\n\n\t\t//Create and append the visible helper\n\t\tthis.helper = this._createHelper(event);\n\n\t\tthis.helper.addClass(\"ui-draggable-dragging\");\n\n\t\t//Cache the helper size\n\t\tthis._cacheHelperProportions();\n\n\t\t//If ddmanager is used for droppables, set the global draggable\n\t\tif ($.ui.ddmanager) {\n\t\t\t$.ui.ddmanager.current = this;\n\t\t}\n\n\t\t/*\n\t\t * - Position generation -\n\t\t * This block generates everything position related - it's the core of draggables.\n\t\t */\n\n\t\t//Cache the margins of the original element\n\t\tthis._cacheMargins();\n\n\t\t//Store the helper's css position\n\t\tthis.cssPosition = this.helper.css( \"position\" );\n\t\tthis.scrollParent = this.helper.scrollParent( true );\n\t\tthis.offsetParent = this.helper.offsetParent();\n\t\tthis.hasFixedAncestor = this.helper.parents().filter(function() {\n\t\t\t\treturn $( this ).css( \"position\" ) === \"fixed\";\n\t\t\t}).length > 0;\n\n\t\t//The element's absolute position on the page minus margins\n\t\tthis.positionAbs = this.element.offset();\n\t\tthis._refreshOffsets( event );\n\n\t\t//Generate the original position\n\t\tthis.originalPosition = this.position = this._generatePosition( event, false );\n\t\tthis.originalPageX = event.pageX;\n\t\tthis.originalPageY = event.pageY;\n\n\t\t//Adjust the mouse offset relative to the helper if \"cursorAt\" is supplied\n\t\t(o.cursorAt && this._adjustOffsetFromHelper(o.cursorAt));\n\n\t\t//Set a containment if given in the options\n\t\tthis._setContainment();\n\n\t\t//Trigger event + callbacks\n\t\tif (this._trigger(\"start\", event) === false) {\n\t\t\tthis._clear();\n\t\t\treturn false;\n\t\t}\n\n\t\t//Recache the helper size\n\t\tthis._cacheHelperProportions();\n\n\t\t//Prepare the droppable offsets\n\t\tif ($.ui.ddmanager && !o.dropBehaviour) {\n\t\t\t$.ui.ddmanager.prepareOffsets(this, event);\n\t\t}\n\n\t\t// Reset helper's right/bottom css if they're set and set explicit width/height instead\n\t\t// as this prevents resizing of elements with right/bottom set (see #7772)\n\t\tthis._normalizeRightBottom();\n\n\t\tthis._mouseDrag(event, true); //Execute the drag once - this causes the helper not to be visible before getting its correct position\n\n\t\t//If the ddmanager is used for droppables, inform the manager that dragging has started (see #5003)\n\t\tif ( $.ui.ddmanager ) {\n\t\t\t$.ui.ddmanager.dragStart(this, event);\n\t\t}\n\n\t\treturn true;\n\t},\n\n\t_refreshOffsets: function( event ) {\n\t\tthis.offset = {\n\t\t\ttop: this.positionAbs.top - this.margins.top,\n\t\t\tleft: this.positionAbs.left - this.margins.left,\n\t\t\tscroll: false,\n\t\t\tparent: this._getParentOffset(),\n\t\t\trelative: this._getRelativeOffset()\n\t\t};\n\n\t\tthis.offset.click = {\n\t\t\tleft: event.pageX - this.offset.left,\n\t\t\ttop: event.pageY - this.offset.top\n\t\t};\n\t},\n\n\t_mouseDrag: function(event, noPropagation) {\n\t\t// reset any necessary cached properties (see #5009)\n\t\tif ( this.hasFixedAncestor ) {\n\t\t\tthis.offset.parent = this._getParentOffset();\n\t\t}\n\n\t\t//Compute the helpers position\n\t\tthis.position = this._generatePosition( event, true );\n\t\tthis.positionAbs = this._convertPositionTo(\"absolute\");\n\n\t\t//Call plugins and callbacks and use the resulting position if something is returned\n\t\tif (!noPropagation) {\n\t\t\tvar ui = this._uiHash();\n\t\t\tif (this._trigger(\"drag\", event, ui) === false) {\n\t\t\t\tthis._mouseUp({});\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.position = ui.position;\n\t\t}\n\n\t\tthis.helper[ 0 ].style.left = this.position.left + \"px\";\n\t\tthis.helper[ 0 ].style.top = this.position.top + \"px\";\n\n\t\tif ($.ui.ddmanager) {\n\t\t\t$.ui.ddmanager.drag(this, event);\n\t\t}\n\n\t\treturn false;\n\t},\n\n\t_mouseStop: function(event) {\n\n\t\t//If we are using droppables, inform the manager about the drop\n\t\tvar that = this,\n\t\t\tdropped = false;\n\t\tif ($.ui.ddmanager && !this.options.dropBehaviour) {\n\t\t\tdropped = $.ui.ddmanager.drop(this, event);\n\t\t}\n\n\t\t//if a drop comes from outside (a sortable)\n\t\tif (this.dropped) {\n\t\t\tdropped = this.dropped;\n\t\t\tthis.dropped = false;\n\t\t}\n\n\t\tif ((this.options.revert === \"invalid\" && !dropped) || (this.options.revert === \"valid\" && dropped) || this.options.revert === true || ($.isFunction(this.options.revert) && this.options.revert.call(this.element, dropped))) {\n\t\t\t$(this.helper).animate(this.originalPosition, parseInt(this.options.revertDuration, 10), function() {\n\t\t\t\tif (that._trigger(\"stop\", event) !== false) {\n\t\t\t\t\tthat._clear();\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tif (this._trigger(\"stop\", event) !== false) {\n\t\t\t\tthis._clear();\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t},\n\n\t_mouseUp: function( event ) {\n\t\tthis._unblockFrames();\n\n\t\t//If the ddmanager is used for droppables, inform the manager that dragging has stopped (see #5003)\n\t\tif ( $.ui.ddmanager ) {\n\t\t\t$.ui.ddmanager.dragStop(this, event);\n\t\t}\n\n\t\t// Only need to focus if the event occurred on the draggable itself, see #10527\n\t\tif ( this.handleElement.is( event.target ) ) {\n\t\t\t// The interaction is over; whether or not the click resulted in a drag, focus the element\n\t\t\tthis.element.focus();\n\t\t}\n\n\t\treturn $.ui.mouse.prototype._mouseUp.call(this, event);\n\t},\n\n\tcancel: function() {\n\n\t\tif (this.helper.is(\".ui-draggable-dragging\")) {\n\t\t\tthis._mouseUp({});\n\t\t} else {\n\t\t\tthis._clear();\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\t_getHandle: function(event) {\n\t\treturn this.options.handle ?\n\t\t\t!!$( event.target ).closest( this.element.find( this.options.handle ) ).length :\n\t\t\ttrue;\n\t},\n\n\t_setHandleClassName: function() {\n\t\tthis.handleElement = this.options.handle ?\n\t\t\tthis.element.find( this.options.handle ) : this.element;\n\t\tthis.handleElement.addClass( \"ui-draggable-handle\" );\n\t},\n\n\t_removeHandleClassName: function() {\n\t\tthis.handleElement.removeClass( \"ui-draggable-handle\" );\n\t},\n\n\t_createHelper: function(event) {\n\n\t\tvar o = this.options,\n\t\t\thelperIsFunction = $.isFunction( o.helper ),\n\t\t\thelper = helperIsFunction ?\n\t\t\t\t$( o.helper.apply( this.element[ 0 ], [ event ] ) ) :\n\t\t\t\t( o.helper === \"clone\" ?\n\t\t\t\t\tthis.element.clone().removeAttr( \"id\" ) :\n\t\t\t\t\tthis.element );\n\n\t\tif (!helper.parents(\"body\").length) {\n\t\t\thelper.appendTo((o.appendTo === \"parent\" ? this.element[0].parentNode : o.appendTo));\n\t\t}\n\n\t\t// http://bugs.jqueryui.com/ticket/9446\n\t\t// a helper function can return the original element\n\t\t// which wouldn't have been set to relative in _create\n\t\tif ( helperIsFunction && helper[ 0 ] === this.element[ 0 ] ) {\n\t\t\tthis._setPositionRelative();\n\t\t}\n\n\t\tif (helper[0] !== this.element[0] && !(/(fixed|absolute)/).test(helper.css(\"position\"))) {\n\t\t\thelper.css(\"position\", \"absolute\");\n\t\t}\n\n\t\treturn helper;\n\n\t},\n\n\t_setPositionRelative: function() {\n\t\tif ( !( /^(?:r|a|f)/ ).test( this.element.css( \"position\" ) ) ) {\n\t\t\tthis.element[ 0 ].style.position = \"relative\";\n\t\t}\n\t},\n\n\t_adjustOffsetFromHelper: function(obj) {\n\t\tif (typeof obj === \"string\") {\n\t\t\tobj = obj.split(\" \");\n\t\t}\n\t\tif ($.isArray(obj)) {\n\t\t\tobj = { left: +obj[0], top: +obj[1] || 0 };\n\t\t}\n\t\tif (\"left\" in obj) {\n\t\t\tthis.offset.click.left = obj.left + this.margins.left;\n\t\t}\n\t\tif (\"right\" in obj) {\n\t\t\tthis.offset.click.left = this.helperProportions.width - obj.right + this.margins.left;\n\t\t}\n\t\tif (\"top\" in obj) {\n\t\t\tthis.offset.click.top = obj.top + this.margins.top;\n\t\t}\n\t\tif (\"bottom\" in obj) {\n\t\t\tthis.offset.click.top = this.helperProportions.height - obj.bottom + this.margins.top;\n\t\t}\n\t},\n\n\t_isRootNode: function( element ) {\n\t\treturn ( /(html|body)/i ).test( element.tagName ) || element === this.document[ 0 ];\n\t},\n\n\t_getParentOffset: function() {\n\n\t\t//Get the offsetParent and cache its position\n\t\tvar po = this.offsetParent.offset(),\n\t\t\tdocument = this.document[ 0 ];\n\n\t\t// This is a special case where we need to modify a offset calculated on start, since the following happened:\n\t\t// 1. The position of the helper is absolute, so it's position is calculated based on the next positioned parent\n\t\t// 2. The actual offset parent is a child of the scroll parent, and the scroll parent isn't the document, which means that\n\t\t//    the scroll is included in the initial calculation of the offset of the parent, and never recalculated upon drag\n\t\tif (this.cssPosition === \"absolute\" && this.scrollParent[0] !== document && $.contains(this.scrollParent[0], this.offsetParent[0])) {\n\t\t\tpo.left += this.scrollParent.scrollLeft();\n\t\t\tpo.top += this.scrollParent.scrollTop();\n\t\t}\n\n\t\tif ( this._isRootNode( this.offsetParent[ 0 ] ) ) {\n\t\t\tpo = { top: 0, left: 0 };\n\t\t}\n\n\t\treturn {\n\t\t\ttop: po.top + (parseInt(this.offsetParent.css(\"borderTopWidth\"), 10) || 0),\n\t\t\tleft: po.left + (parseInt(this.offsetParent.css(\"borderLeftWidth\"), 10) || 0)\n\t\t};\n\n\t},\n\n\t_getRelativeOffset: function() {\n\t\tif ( this.cssPosition !== \"relative\" ) {\n\t\t\treturn { top: 0, left: 0 };\n\t\t}\n\n\t\tvar p = this.element.position(),\n\t\t\tscrollIsRootNode = this._isRootNode( this.scrollParent[ 0 ] );\n\n\t\treturn {\n\t\t\ttop: p.top - ( parseInt(this.helper.css( \"top\" ), 10) || 0 ) + ( !scrollIsRootNode ? this.scrollParent.scrollTop() : 0 ),\n\t\t\tleft: p.left - ( parseInt(this.helper.css( \"left\" ), 10) || 0 ) + ( !scrollIsRootNode ? this.scrollParent.scrollLeft() : 0 )\n\t\t};\n\n\t},\n\n\t_cacheMargins: function() {\n\t\tthis.margins = {\n\t\t\tleft: (parseInt(this.element.css(\"marginLeft\"), 10) || 0),\n\t\t\ttop: (parseInt(this.element.css(\"marginTop\"), 10) || 0),\n\t\t\tright: (parseInt(this.element.css(\"marginRight\"), 10) || 0),\n\t\t\tbottom: (parseInt(this.element.css(\"marginBottom\"), 10) || 0)\n\t\t};\n\t},\n\n\t_cacheHelperProportions: function() {\n\t\tthis.helperProportions = {\n\t\t\twidth: this.helper.outerWidth(),\n\t\t\theight: this.helper.outerHeight()\n\t\t};\n\t},\n\n\t_setContainment: function() {\n\n\t\tvar isUserScrollable, c, ce,\n\t\t\to = this.options,\n\t\t\tdocument = this.document[ 0 ];\n\n\t\tthis.relativeContainer = null;\n\n\t\tif ( !o.containment ) {\n\t\t\tthis.containment = null;\n\t\t\treturn;\n\t\t}\n\n\t\tif ( o.containment === \"window\" ) {\n\t\t\tthis.containment = [\n\t\t\t\t$( window ).scrollLeft() - this.offset.relative.left - this.offset.parent.left,\n\t\t\t\t$( window ).scrollTop() - this.offset.relative.top - this.offset.parent.top,\n\t\t\t\t$( window ).scrollLeft() + $( window ).width() - this.helperProportions.width - this.margins.left,\n\t\t\t\t$( window ).scrollTop() + ( $( window ).height() || document.body.parentNode.scrollHeight ) - this.helperProportions.height - this.margins.top\n\t\t\t];\n\t\t\treturn;\n\t\t}\n\n\t\tif ( o.containment === \"document\") {\n\t\t\tthis.containment = [\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\t$( document ).width() - this.helperProportions.width - this.margins.left,\n\t\t\t\t( $( document ).height() || document.body.parentNode.scrollHeight ) - this.helperProportions.height - this.margins.top\n\t\t\t];\n\t\t\treturn;\n\t\t}\n\n\t\tif ( o.containment.constructor === Array ) {\n\t\t\tthis.containment = o.containment;\n\t\t\treturn;\n\t\t}\n\n\t\tif ( o.containment === \"parent\" ) {\n\t\t\to.containment = this.helper[ 0 ].parentNode;\n\t\t}\n\n\t\tc = $( o.containment );\n\t\tce = c[ 0 ];\n\n\t\tif ( !ce ) {\n\t\t\treturn;\n\t\t}\n\n\t\tisUserScrollable = /(scroll|auto)/.test( c.css( \"overflow\" ) );\n\n\t\tthis.containment = [\n\t\t\t( parseInt( c.css( \"borderLeftWidth\" ), 10 ) || 0 ) + ( parseInt( c.css( \"paddingLeft\" ), 10 ) || 0 ),\n\t\t\t( parseInt( c.css( \"borderTopWidth\" ), 10 ) || 0 ) + ( parseInt( c.css( \"paddingTop\" ), 10 ) || 0 ),\n\t\t\t( isUserScrollable ? Math.max( ce.scrollWidth, ce.offsetWidth ) : ce.offsetWidth ) -\n\t\t\t\t( parseInt( c.css( \"borderRightWidth\" ), 10 ) || 0 ) -\n\t\t\t\t( parseInt( c.css( \"paddingRight\" ), 10 ) || 0 ) -\n\t\t\t\tthis.helperProportions.width -\n\t\t\t\tthis.margins.left -\n\t\t\t\tthis.margins.right,\n\t\t\t( isUserScrollable ? Math.max( ce.scrollHeight, ce.offsetHeight ) : ce.offsetHeight ) -\n\t\t\t\t( parseInt( c.css( \"borderBottomWidth\" ), 10 ) || 0 ) -\n\t\t\t\t( parseInt( c.css( \"paddingBottom\" ), 10 ) || 0 ) -\n\t\t\t\tthis.helperProportions.height -\n\t\t\t\tthis.margins.top -\n\t\t\t\tthis.margins.bottom\n\t\t];\n\t\tthis.relativeContainer = c;\n\t},\n\n\t_convertPositionTo: function(d, pos) {\n\n\t\tif (!pos) {\n\t\t\tpos = this.position;\n\t\t}\n\n\t\tvar mod = d === \"absolute\" ? 1 : -1,\n\t\t\tscrollIsRootNode = this._isRootNode( this.scrollParent[ 0 ] );\n\n\t\treturn {\n\t\t\ttop: (\n\t\t\t\tpos.top\t+\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// The absolute mouse position\n\t\t\t\tthis.offset.relative.top * mod +\t\t\t\t\t\t\t\t\t\t// Only for relative positioned nodes: Relative offset from element to offset parent\n\t\t\t\tthis.offset.parent.top * mod -\t\t\t\t\t\t\t\t\t\t// The offsetParent's offset without borders (offset + border)\n\t\t\t\t( ( this.cssPosition === \"fixed\" ? -this.offset.scroll.top : ( scrollIsRootNode ? 0 : this.offset.scroll.top ) ) * mod)\n\t\t\t),\n\t\t\tleft: (\n\t\t\t\tpos.left +\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// The absolute mouse position\n\t\t\t\tthis.offset.relative.left * mod +\t\t\t\t\t\t\t\t\t\t// Only for relative positioned nodes: Relative offset from element to offset parent\n\t\t\t\tthis.offset.parent.left * mod\t-\t\t\t\t\t\t\t\t\t\t// The offsetParent's offset without borders (offset + border)\n\t\t\t\t( ( this.cssPosition === \"fixed\" ? -this.offset.scroll.left : ( scrollIsRootNode ? 0 : this.offset.scroll.left ) ) * mod)\n\t\t\t)\n\t\t};\n\n\t},\n\n\t_generatePosition: function( event, constrainPosition ) {\n\n\t\tvar containment, co, top, left,\n\t\t\to = this.options,\n\t\t\tscrollIsRootNode = this._isRootNode( this.scrollParent[ 0 ] ),\n\t\t\tpageX = event.pageX,\n\t\t\tpageY = event.pageY;\n\n\t\t// Cache the scroll\n\t\tif ( !scrollIsRootNode || !this.offset.scroll ) {\n\t\t\tthis.offset.scroll = {\n\t\t\t\ttop: this.scrollParent.scrollTop(),\n\t\t\t\tleft: this.scrollParent.scrollLeft()\n\t\t\t};\n\t\t}\n\n\t\t/*\n\t\t * - Position constraining -\n\t\t * Constrain the position to a mix of grid, containment.\n\t\t */\n\n\t\t// If we are not dragging yet, we won't check for options\n\t\tif ( constrainPosition ) {\n\t\t\tif ( this.containment ) {\n\t\t\t\tif ( this.relativeContainer ){\n\t\t\t\t\tco = this.relativeContainer.offset();\n\t\t\t\t\tcontainment = [\n\t\t\t\t\t\tthis.containment[ 0 ] + co.left,\n\t\t\t\t\t\tthis.containment[ 1 ] + co.top,\n\t\t\t\t\t\tthis.containment[ 2 ] + co.left,\n\t\t\t\t\t\tthis.containment[ 3 ] + co.top\n\t\t\t\t\t];\n\t\t\t\t} else {\n\t\t\t\t\tcontainment = this.containment;\n\t\t\t\t}\n\n\t\t\t\tif (event.pageX - this.offset.click.left < containment[0]) {\n\t\t\t\t\tpageX = containment[0] + this.offset.click.left;\n\t\t\t\t}\n\t\t\t\tif (event.pageY - this.offset.click.top < containment[1]) {\n\t\t\t\t\tpageY = containment[1] + this.offset.click.top;\n\t\t\t\t}\n\t\t\t\tif (event.pageX - this.offset.click.left > containment[2]) {\n\t\t\t\t\tpageX = containment[2] + this.offset.click.left;\n\t\t\t\t}\n\t\t\t\tif (event.pageY - this.offset.click.top > containment[3]) {\n\t\t\t\t\tpageY = containment[3] + this.offset.click.top;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (o.grid) {\n\t\t\t\t//Check for grid elements set to 0 to prevent divide by 0 error causing invalid argument errors in IE (see ticket #6950)\n\t\t\t\ttop = o.grid[1] ? this.originalPageY + Math.round((pageY - this.originalPageY) / o.grid[1]) * o.grid[1] : this.originalPageY;\n\t\t\t\tpageY = containment ? ((top - this.offset.click.top >= containment[1] || top - this.offset.click.top > containment[3]) ? top : ((top - this.offset.click.top >= containment[1]) ? top - o.grid[1] : top + o.grid[1])) : top;\n\n\t\t\t\tleft = o.grid[0] ? this.originalPageX + Math.round((pageX - this.originalPageX) / o.grid[0]) * o.grid[0] : this.originalPageX;\n\t\t\t\tpageX = containment ? ((left - this.offset.click.left >= containment[0] || left - this.offset.click.left > containment[2]) ? left : ((left - this.offset.click.left >= containment[0]) ? left - o.grid[0] : left + o.grid[0])) : left;\n\t\t\t}\n\n\t\t\tif ( o.axis === \"y\" ) {\n\t\t\t\tpageX = this.originalPageX;\n\t\t\t}\n\n\t\t\tif ( o.axis === \"x\" ) {\n\t\t\t\tpageY = this.originalPageY;\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\ttop: (\n\t\t\t\tpageY -\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// The absolute mouse position\n\t\t\t\tthis.offset.click.top\t-\t\t\t\t\t\t\t\t\t\t\t\t// Click offset (relative to the element)\n\t\t\t\tthis.offset.relative.top -\t\t\t\t\t\t\t\t\t\t\t\t// Only for relative positioned nodes: Relative offset from element to offset parent\n\t\t\t\tthis.offset.parent.top +\t\t\t\t\t\t\t\t\t\t\t\t// The offsetParent's offset without borders (offset + border)\n\t\t\t\t( this.cssPosition === \"fixed\" ? -this.offset.scroll.top : ( scrollIsRootNode ? 0 : this.offset.scroll.top ) )\n\t\t\t),\n\t\t\tleft: (\n\t\t\t\tpageX -\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// The absolute mouse position\n\t\t\t\tthis.offset.click.left -\t\t\t\t\t\t\t\t\t\t\t\t// Click offset (relative to the element)\n\t\t\t\tthis.offset.relative.left -\t\t\t\t\t\t\t\t\t\t\t\t// Only for relative positioned nodes: Relative offset from element to offset parent\n\t\t\t\tthis.offset.parent.left +\t\t\t\t\t\t\t\t\t\t\t\t// The offsetParent's offset without borders (offset + border)\n\t\t\t\t( this.cssPosition === \"fixed\" ? -this.offset.scroll.left : ( scrollIsRootNode ? 0 : this.offset.scroll.left ) )\n\t\t\t)\n\t\t};\n\n\t},\n\n\t_clear: function() {\n\t\tthis.helper.removeClass(\"ui-draggable-dragging\");\n\t\tif (this.helper[0] !== this.element[0] && !this.cancelHelperRemoval) {\n\t\t\tthis.helper.remove();\n\t\t}\n\t\tthis.helper = null;\n\t\tthis.cancelHelperRemoval = false;\n\t\tif ( this.destroyOnClear ) {\n\t\t\tthis.destroy();\n\t\t}\n\t},\n\n\t_normalizeRightBottom: function() {\n\t\tif ( this.options.axis !== \"y\" && this.helper.css( \"right\" ) !== \"auto\" ) {\n\t\t\tthis.helper.width( this.helper.width() );\n\t\t\tthis.helper.css( \"right\", \"auto\" );\n\t\t}\n\t\tif ( this.options.axis !== \"x\" && this.helper.css( \"bottom\" ) !== \"auto\" ) {\n\t\t\tthis.helper.height( this.helper.height() );\n\t\t\tthis.helper.css( \"bottom\", \"auto\" );\n\t\t}\n\t},\n\n\t// From now on bulk stuff - mainly helpers\n\n\t_trigger: function( type, event, ui ) {\n\t\tui = ui || this._uiHash();\n\t\t$.ui.plugin.call( this, type, [ event, ui, this ], true );\n\n\t\t// Absolute position and offset (see #6884 ) have to be recalculated after plugins\n\t\tif ( /^(drag|start|stop)/.test( type ) ) {\n\t\t\tthis.positionAbs = this._convertPositionTo( \"absolute\" );\n\t\t\tui.offset = this.positionAbs;\n\t\t}\n\t\treturn $.Widget.prototype._trigger.call( this, type, event, ui );\n\t},\n\n\tplugins: {},\n\n\t_uiHash: function() {\n\t\treturn {\n\t\t\thelper: this.helper,\n\t\t\tposition: this.position,\n\t\t\toriginalPosition: this.originalPosition,\n\t\t\toffset: this.positionAbs\n\t\t};\n\t}\n\n});\n\n$.ui.plugin.add( \"draggable\", \"connectToSortable\", {\n\tstart: function( event, ui, draggable ) {\n\t\tvar uiSortable = $.extend( {}, ui, {\n\t\t\titem: draggable.element\n\t\t});\n\n\t\tdraggable.sortables = [];\n\t\t$( draggable.options.connectToSortable ).each(function() {\n\t\t\tvar sortable = $( this ).sortable( \"instance\" );\n\n\t\t\tif ( sortable && !sortable.options.disabled ) {\n\t\t\t\tdraggable.sortables.push( sortable );\n\n\t\t\t\t// refreshPositions is called at drag start to refresh the containerCache\n\t\t\t\t// which is used in drag. This ensures it's initialized and synchronized\n\t\t\t\t// with any changes that might have happened on the page since initialization.\n\t\t\t\tsortable.refreshPositions();\n\t\t\t\tsortable._trigger(\"activate\", event, uiSortable);\n\t\t\t}\n\t\t});\n\t},\n\tstop: function( event, ui, draggable ) {\n\t\tvar uiSortable = $.extend( {}, ui, {\n\t\t\titem: draggable.element\n\t\t});\n\n\t\tdraggable.cancelHelperRemoval = false;\n\n\t\t$.each( draggable.sortables, function() {\n\t\t\tvar sortable = this;\n\n\t\t\tif ( sortable.isOver ) {\n\t\t\t\tsortable.isOver = 0;\n\n\t\t\t\t// Allow this sortable to handle removing the helper\n\t\t\t\tdraggable.cancelHelperRemoval = true;\n\t\t\t\tsortable.cancelHelperRemoval = false;\n\n\t\t\t\t// Use _storedCSS To restore properties in the sortable,\n\t\t\t\t// as this also handles revert (#9675) since the draggable\n\t\t\t\t// may have modified them in unexpected ways (#8809)\n\t\t\t\tsortable._storedCSS = {\n\t\t\t\t\tposition: sortable.placeholder.css( \"position\" ),\n\t\t\t\t\ttop: sortable.placeholder.css( \"top\" ),\n\t\t\t\t\tleft: sortable.placeholder.css( \"left\" )\n\t\t\t\t};\n\n\t\t\t\tsortable._mouseStop(event);\n\n\t\t\t\t// Once drag has ended, the sortable should return to using\n\t\t\t\t// its original helper, not the shared helper from draggable\n\t\t\t\tsortable.options.helper = sortable.options._helper;\n\t\t\t} else {\n\t\t\t\t// Prevent this Sortable from removing the helper.\n\t\t\t\t// However, don't set the draggable to remove the helper\n\t\t\t\t// either as another connected Sortable may yet handle the removal.\n\t\t\t\tsortable.cancelHelperRemoval = true;\n\n\t\t\t\tsortable._trigger( \"deactivate\", event, uiSortable );\n\t\t\t}\n\t\t});\n\t},\n\tdrag: function( event, ui, draggable ) {\n\t\t$.each( draggable.sortables, function() {\n\t\t\tvar innermostIntersecting = false,\n\t\t\t\tsortable = this;\n\n\t\t\t// Copy over variables that sortable's _intersectsWith uses\n\t\t\tsortable.positionAbs = draggable.positionAbs;\n\t\t\tsortable.helperProportions = draggable.helperProportions;\n\t\t\tsortable.offset.click = draggable.offset.click;\n\n\t\t\tif ( sortable._intersectsWith( sortable.containerCache ) ) {\n\t\t\t\tinnermostIntersecting = true;\n\n\t\t\t\t$.each( draggable.sortables, function() {\n\t\t\t\t\t// Copy over variables that sortable's _intersectsWith uses\n\t\t\t\t\tthis.positionAbs = draggable.positionAbs;\n\t\t\t\t\tthis.helperProportions = draggable.helperProportions;\n\t\t\t\t\tthis.offset.click = draggable.offset.click;\n\n\t\t\t\t\tif ( this !== sortable &&\n\t\t\t\t\t\t\tthis._intersectsWith( this.containerCache ) &&\n\t\t\t\t\t\t\t$.contains( sortable.element[ 0 ], this.element[ 0 ] ) ) {\n\t\t\t\t\t\tinnermostIntersecting = false;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn innermostIntersecting;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif ( innermostIntersecting ) {\n\t\t\t\t// If it intersects, we use a little isOver variable and set it once,\n\t\t\t\t// so that the move-in stuff gets fired only once.\n\t\t\t\tif ( !sortable.isOver ) {\n\t\t\t\t\tsortable.isOver = 1;\n\n\t\t\t\t\t// Store draggable's parent in case we need to reappend to it later.\n\t\t\t\t\tdraggable._parent = ui.helper.parent();\n\n\t\t\t\t\tsortable.currentItem = ui.helper\n\t\t\t\t\t\t.appendTo( sortable.element )\n\t\t\t\t\t\t.data( \"ui-sortable-item\", true );\n\n\t\t\t\t\t// Store helper option to later restore it\n\t\t\t\t\tsortable.options._helper = sortable.options.helper;\n\n\t\t\t\t\tsortable.options.helper = function() {\n\t\t\t\t\t\treturn ui.helper[ 0 ];\n\t\t\t\t\t};\n\n\t\t\t\t\t// Fire the start events of the sortable with our passed browser event,\n\t\t\t\t\t// and our own helper (so it doesn't create a new one)\n\t\t\t\t\tevent.target = sortable.currentItem[ 0 ];\n\t\t\t\t\tsortable._mouseCapture( event, true );\n\t\t\t\t\tsortable._mouseStart( event, true, true );\n\n\t\t\t\t\t// Because the browser event is way off the new appended portlet,\n\t\t\t\t\t// modify necessary variables to reflect the changes\n\t\t\t\t\tsortable.offset.click.top = draggable.offset.click.top;\n\t\t\t\t\tsortable.offset.click.left = draggable.offset.click.left;\n\t\t\t\t\tsortable.offset.parent.left -= draggable.offset.parent.left -\n\t\t\t\t\t\tsortable.offset.parent.left;\n\t\t\t\t\tsortable.offset.parent.top -= draggable.offset.parent.top -\n\t\t\t\t\t\tsortable.offset.parent.top;\n\n\t\t\t\t\tdraggable._trigger( \"toSortable\", event );\n\n\t\t\t\t\t// Inform draggable that the helper is in a valid drop zone,\n\t\t\t\t\t// used solely in the revert option to handle \"valid/invalid\".\n\t\t\t\t\tdraggable.dropped = sortable.element;\n\n\t\t\t\t\t// Need to refreshPositions of all sortables in the case that\n\t\t\t\t\t// adding to one sortable changes the location of the other sortables (#9675)\n\t\t\t\t\t$.each( draggable.sortables, function() {\n\t\t\t\t\t\tthis.refreshPositions();\n\t\t\t\t\t});\n\n\t\t\t\t\t// hack so receive/update callbacks work (mostly)\n\t\t\t\t\tdraggable.currentItem = draggable.element;\n\t\t\t\t\tsortable.fromOutside = draggable;\n\t\t\t\t}\n\n\t\t\t\tif ( sortable.currentItem ) {\n\t\t\t\t\tsortable._mouseDrag( event );\n\t\t\t\t\t// Copy the sortable's position because the draggable's can potentially reflect\n\t\t\t\t\t// a relative position, while sortable is always absolute, which the dragged\n\t\t\t\t\t// element has now become. (#8809)\n\t\t\t\t\tui.position = sortable.position;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// If it doesn't intersect with the sortable, and it intersected before,\n\t\t\t\t// we fake the drag stop of the sortable, but make sure it doesn't remove\n\t\t\t\t// the helper by using cancelHelperRemoval.\n\t\t\t\tif ( sortable.isOver ) {\n\n\t\t\t\t\tsortable.isOver = 0;\n\t\t\t\t\tsortable.cancelHelperRemoval = true;\n\n\t\t\t\t\t// Calling sortable's mouseStop would trigger a revert,\n\t\t\t\t\t// so revert must be temporarily false until after mouseStop is called.\n\t\t\t\t\tsortable.options._revert = sortable.options.revert;\n\t\t\t\t\tsortable.options.revert = false;\n\n\t\t\t\t\tsortable._trigger( \"out\", event, sortable._uiHash( sortable ) );\n\t\t\t\t\tsortable._mouseStop( event, true );\n\n\t\t\t\t\t// restore sortable behaviors that were modfied\n\t\t\t\t\t// when the draggable entered the sortable area (#9481)\n\t\t\t\t\tsortable.options.revert = sortable.options._revert;\n\t\t\t\t\tsortable.options.helper = sortable.options._helper;\n\n\t\t\t\t\tif ( sortable.placeholder ) {\n\t\t\t\t\t\tsortable.placeholder.remove();\n\t\t\t\t\t}\n\n\t\t\t\t\t// Restore and recalculate the draggable's offset considering the sortable\n\t\t\t\t\t// may have modified them in unexpected ways. (#8809, #10669)\n\t\t\t\t\tui.helper.appendTo( draggable._parent );\n\t\t\t\t\tdraggable._refreshOffsets( event );\n\t\t\t\t\tui.position = draggable._generatePosition( event, true );\n\n\t\t\t\t\tdraggable._trigger( \"fromSortable\", event );\n\n\t\t\t\t\t// Inform draggable that the helper is no longer in a valid drop zone\n\t\t\t\t\tdraggable.dropped = false;\n\n\t\t\t\t\t// Need to refreshPositions of all sortables just in case removing\n\t\t\t\t\t// from one sortable changes the location of other sortables (#9675)\n\t\t\t\t\t$.each( draggable.sortables, function() {\n\t\t\t\t\t\tthis.refreshPositions();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n});\n\n$.ui.plugin.add(\"draggable\", \"cursor\", {\n\tstart: function( event, ui, instance ) {\n\t\tvar t = $( \"body\" ),\n\t\t\to = instance.options;\n\n\t\tif (t.css(\"cursor\")) {\n\t\t\to._cursor = t.css(\"cursor\");\n\t\t}\n\t\tt.css(\"cursor\", o.cursor);\n\t},\n\tstop: function( event, ui, instance ) {\n\t\tvar o = instance.options;\n\t\tif (o._cursor) {\n\t\t\t$(\"body\").css(\"cursor\", o._cursor);\n\t\t}\n\t}\n});\n\n$.ui.plugin.add(\"draggable\", \"opacity\", {\n\tstart: function( event, ui, instance ) {\n\t\tvar t = $( ui.helper ),\n\t\t\to = instance.options;\n\t\tif (t.css(\"opacity\")) {\n\t\t\to._opacity = t.css(\"opacity\");\n\t\t}\n\t\tt.css(\"opacity\", o.opacity);\n\t},\n\tstop: function( event, ui, instance ) {\n\t\tvar o = instance.options;\n\t\tif (o._opacity) {\n\t\t\t$(ui.helper).css(\"opacity\", o._opacity);\n\t\t}\n\t}\n});\n\n$.ui.plugin.add(\"draggable\", \"scroll\", {\n\tstart: function( event, ui, i ) {\n\t\tif ( !i.scrollParentNotHidden ) {\n\t\t\ti.scrollParentNotHidden = i.helper.scrollParent( false );\n\t\t}\n\n\t\tif ( i.scrollParentNotHidden[ 0 ] !== i.document[ 0 ] && i.scrollParentNotHidden[ 0 ].tagName !== \"HTML\" ) {\n\t\t\ti.overflowOffset = i.scrollParentNotHidden.offset();\n\t\t}\n\t},\n\tdrag: function( event, ui, i  ) {\n\n\t\tvar o = i.options,\n\t\t\tscrolled = false,\n\t\t\tscrollParent = i.scrollParentNotHidden[ 0 ],\n\t\t\tdocument = i.document[ 0 ];\n\n\t\tif ( scrollParent !== document && scrollParent.tagName !== \"HTML\" ) {\n\t\t\tif ( !o.axis || o.axis !== \"x\" ) {\n\t\t\t\tif ( ( i.overflowOffset.top + scrollParent.offsetHeight ) - event.pageY < o.scrollSensitivity ) {\n\t\t\t\t\tscrollParent.scrollTop = scrolled = scrollParent.scrollTop + o.scrollSpeed;\n\t\t\t\t} else if ( event.pageY - i.overflowOffset.top < o.scrollSensitivity ) {\n\t\t\t\t\tscrollParent.scrollTop = scrolled = scrollParent.scrollTop - o.scrollSpeed;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( !o.axis || o.axis !== \"y\" ) {\n\t\t\t\tif ( ( i.overflowOffset.left + scrollParent.offsetWidth ) - event.pageX < o.scrollSensitivity ) {\n\t\t\t\t\tscrollParent.scrollLeft = scrolled = scrollParent.scrollLeft + o.scrollSpeed;\n\t\t\t\t} else if ( event.pageX - i.overflowOffset.left < o.scrollSensitivity ) {\n\t\t\t\t\tscrollParent.scrollLeft = scrolled = scrollParent.scrollLeft - o.scrollSpeed;\n\t\t\t\t}\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif (!o.axis || o.axis !== \"x\") {\n\t\t\t\tif (event.pageY - $(document).scrollTop() < o.scrollSensitivity) {\n\t\t\t\t\tscrolled = $(document).scrollTop($(document).scrollTop() - o.scrollSpeed);\n\t\t\t\t} else if ($(window).height() - (event.pageY - $(document).scrollTop()) < o.scrollSensitivity) {\n\t\t\t\t\tscrolled = $(document).scrollTop($(document).scrollTop() + o.scrollSpeed);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!o.axis || o.axis !== \"y\") {\n\t\t\t\tif (event.pageX - $(document).scrollLeft() < o.scrollSensitivity) {\n\t\t\t\t\tscrolled = $(document).scrollLeft($(document).scrollLeft() - o.scrollSpeed);\n\t\t\t\t} else if ($(window).width() - (event.pageX - $(document).scrollLeft()) < o.scrollSensitivity) {\n\t\t\t\t\tscrolled = $(document).scrollLeft($(document).scrollLeft() + o.scrollSpeed);\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\tif (scrolled !== false && $.ui.ddmanager && !o.dropBehaviour) {\n\t\t\t$.ui.ddmanager.prepareOffsets(i, event);\n\t\t}\n\n\t}\n});\n\n$.ui.plugin.add(\"draggable\", \"snap\", {\n\tstart: function( event, ui, i ) {\n\n\t\tvar o = i.options;\n\n\t\ti.snapElements = [];\n\n\t\t$(o.snap.constructor !== String ? ( o.snap.items || \":data(ui-draggable)\" ) : o.snap).each(function() {\n\t\t\tvar $t = $(this),\n\t\t\t\t$o = $t.offset();\n\t\t\tif (this !== i.element[0]) {\n\t\t\t\ti.snapElements.push({\n\t\t\t\t\titem: this,\n\t\t\t\t\twidth: $t.outerWidth(), height: $t.outerHeight(),\n\t\t\t\t\ttop: $o.top, left: $o.left\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t},\n\tdrag: function( event, ui, inst ) {\n\n\t\tvar ts, bs, ls, rs, l, r, t, b, i, first,\n\t\t\to = inst.options,\n\t\t\td = o.snapTolerance,\n\t\t\tx1 = ui.offset.left, x2 = x1 + inst.helperProportions.width,\n\t\t\ty1 = ui.offset.top, y2 = y1 + inst.helperProportions.height;\n\n\t\tfor (i = inst.snapElements.length - 1; i >= 0; i--){\n\n\t\t\tl = inst.snapElements[i].left - inst.margins.left;\n\t\t\tr = l + inst.snapElements[i].width;\n\t\t\tt = inst.snapElements[i].top - inst.margins.top;\n\t\t\tb = t + inst.snapElements[i].height;\n\n\t\t\tif ( x2 < l - d || x1 > r + d || y2 < t - d || y1 > b + d || !$.contains( inst.snapElements[ i ].item.ownerDocument, inst.snapElements[ i ].item ) ) {\n\t\t\t\tif (inst.snapElements[i].snapping) {\n\t\t\t\t\t(inst.options.snap.release && inst.options.snap.release.call(inst.element, event, $.extend(inst._uiHash(), { snapItem: inst.snapElements[i].item })));\n\t\t\t\t}\n\t\t\t\tinst.snapElements[i].snapping = false;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (o.snapMode !== \"inner\") {\n\t\t\t\tts = Math.abs(t - y2) <= d;\n\t\t\t\tbs = Math.abs(b - y1) <= d;\n\t\t\t\tls = Math.abs(l - x2) <= d;\n\t\t\t\trs = Math.abs(r - x1) <= d;\n\t\t\t\tif (ts) {\n\t\t\t\t\tui.position.top = inst._convertPositionTo(\"relative\", { top: t - inst.helperProportions.height, left: 0 }).top;\n\t\t\t\t}\n\t\t\t\tif (bs) {\n\t\t\t\t\tui.position.top = inst._convertPositionTo(\"relative\", { top: b, left: 0 }).top;\n\t\t\t\t}\n\t\t\t\tif (ls) {\n\t\t\t\t\tui.position.left = inst._convertPositionTo(\"relative\", { top: 0, left: l - inst.helperProportions.width }).left;\n\t\t\t\t}\n\t\t\t\tif (rs) {\n\t\t\t\t\tui.position.left = inst._convertPositionTo(\"relative\", { top: 0, left: r }).left;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfirst = (ts || bs || ls || rs);\n\n\t\t\tif (o.snapMode !== \"outer\") {\n\t\t\t\tts = Math.abs(t - y1) <= d;\n\t\t\t\tbs = Math.abs(b - y2) <= d;\n\t\t\t\tls = Math.abs(l - x1) <= d;\n\t\t\t\trs = Math.abs(r - x2) <= d;\n\t\t\t\tif (ts) {\n\t\t\t\t\tui.position.top = inst._convertPositionTo(\"relative\", { top: t, left: 0 }).top;\n\t\t\t\t}\n\t\t\t\tif (bs) {\n\t\t\t\t\tui.position.top = inst._convertPositionTo(\"relative\", { top: b - inst.helperProportions.height, left: 0 }).top;\n\t\t\t\t}\n\t\t\t\tif (ls) {\n\t\t\t\t\tui.position.left = inst._convertPositionTo(\"relative\", { top: 0, left: l }).left;\n\t\t\t\t}\n\t\t\t\tif (rs) {\n\t\t\t\t\tui.position.left = inst._convertPositionTo(\"relative\", { top: 0, left: r - inst.helperProportions.width }).left;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!inst.snapElements[i].snapping && (ts || bs || ls || rs || first)) {\n\t\t\t\t(inst.options.snap.snap && inst.options.snap.snap.call(inst.element, event, $.extend(inst._uiHash(), { snapItem: inst.snapElements[i].item })));\n\t\t\t}\n\t\t\tinst.snapElements[i].snapping = (ts || bs || ls || rs || first);\n\n\t\t}\n\n\t}\n});\n\n$.ui.plugin.add(\"draggable\", \"stack\", {\n\tstart: function( event, ui, instance ) {\n\t\tvar min,\n\t\t\to = instance.options,\n\t\t\tgroup = $.makeArray($(o.stack)).sort(function(a, b) {\n\t\t\t\treturn (parseInt($(a).css(\"zIndex\"), 10) || 0) - (parseInt($(b).css(\"zIndex\"), 10) || 0);\n\t\t\t});\n\n\t\tif (!group.length) { return; }\n\n\t\tmin = parseInt($(group[0]).css(\"zIndex\"), 10) || 0;\n\t\t$(group).each(function(i) {\n\t\t\t$(this).css(\"zIndex\", min + i);\n\t\t});\n\t\tthis.css(\"zIndex\", (min + group.length));\n\t}\n});\n\n$.ui.plugin.add(\"draggable\", \"zIndex\", {\n\tstart: function( event, ui, instance ) {\n\t\tvar t = $( ui.helper ),\n\t\t\to = instance.options;\n\n\t\tif (t.css(\"zIndex\")) {\n\t\t\to._zIndex = t.css(\"zIndex\");\n\t\t}\n\t\tt.css(\"zIndex\", o.zIndex);\n\t},\n\tstop: function( event, ui, instance ) {\n\t\tvar o = instance.options;\n\n\t\tif (o._zIndex) {\n\t\t\t$(ui.helper).css(\"zIndex\", o._zIndex);\n\t\t}\n\t}\n});\n\nvar draggable = $.ui.draggable;\n\n\n/*!\n * jQuery UI Resizable 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/resizable/\n */\n\n\n$.widget(\"ui.resizable\", $.ui.mouse, {\n\tversion: \"1.11.4\",\n\twidgetEventPrefix: \"resize\",\n\toptions: {\n\t\talsoResize: false,\n\t\tanimate: false,\n\t\tanimateDuration: \"slow\",\n\t\tanimateEasing: \"swing\",\n\t\taspectRatio: false,\n\t\tautoHide: false,\n\t\tcontainment: false,\n\t\tghost: false,\n\t\tgrid: false,\n\t\thandles: \"e,s,se\",\n\t\thelper: false,\n\t\tmaxHeight: null,\n\t\tmaxWidth: null,\n\t\tminHeight: 10,\n\t\tminWidth: 10,\n\t\t// See #7960\n\t\tzIndex: 90,\n\n\t\t// callbacks\n\t\tresize: null,\n\t\tstart: null,\n\t\tstop: null\n\t},\n\n\t_num: function( value ) {\n\t\treturn parseInt( value, 10 ) || 0;\n\t},\n\n\t_isNumber: function( value ) {\n\t\treturn !isNaN( parseInt( value, 10 ) );\n\t},\n\n\t_hasScroll: function( el, a ) {\n\n\t\tif ( $( el ).css( \"overflow\" ) === \"hidden\") {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar scroll = ( a && a === \"left\" ) ? \"scrollLeft\" : \"scrollTop\",\n\t\t\thas = false;\n\n\t\tif ( el[ scroll ] > 0 ) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// TODO: determine which cases actually cause this to happen\n\t\t// if the element doesn't have the scroll set, see if it's possible to\n\t\t// set the scroll\n\t\tel[ scroll ] = 1;\n\t\thas = ( el[ scroll ] > 0 );\n\t\tel[ scroll ] = 0;\n\t\treturn has;\n\t},\n\n\t_create: function() {\n\n\t\tvar n, i, handle, axis, hname,\n\t\t\tthat = this,\n\t\t\to = this.options;\n\t\tthis.element.addClass(\"ui-resizable\");\n\n\t\t$.extend(this, {\n\t\t\t_aspectRatio: !!(o.aspectRatio),\n\t\t\taspectRatio: o.aspectRatio,\n\t\t\toriginalElement: this.element,\n\t\t\t_proportionallyResizeElements: [],\n\t\t\t_helper: o.helper || o.ghost || o.animate ? o.helper || \"ui-resizable-helper\" : null\n\t\t});\n\n\t\t// Wrap the element if it cannot hold child nodes\n\t\tif (this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)) {\n\n\t\t\tthis.element.wrap(\n\t\t\t\t$(\"<div class='ui-wrapper' style='overflow: hidden;'></div>\").css({\n\t\t\t\t\tposition: this.element.css(\"position\"),\n\t\t\t\t\twidth: this.element.outerWidth(),\n\t\t\t\t\theight: this.element.outerHeight(),\n\t\t\t\t\ttop: this.element.css(\"top\"),\n\t\t\t\t\tleft: this.element.css(\"left\")\n\t\t\t\t})\n\t\t\t);\n\n\t\t\tthis.element = this.element.parent().data(\n\t\t\t\t\"ui-resizable\", this.element.resizable( \"instance\" )\n\t\t\t);\n\n\t\t\tthis.elementIsWrapper = true;\n\n\t\t\tthis.element.css({\n\t\t\t\tmarginLeft: this.originalElement.css(\"marginLeft\"),\n\t\t\t\tmarginTop: this.originalElement.css(\"marginTop\"),\n\t\t\t\tmarginRight: this.originalElement.css(\"marginRight\"),\n\t\t\t\tmarginBottom: this.originalElement.css(\"marginBottom\")\n\t\t\t});\n\t\t\tthis.originalElement.css({\n\t\t\t\tmarginLeft: 0,\n\t\t\t\tmarginTop: 0,\n\t\t\t\tmarginRight: 0,\n\t\t\t\tmarginBottom: 0\n\t\t\t});\n\t\t\t// support: Safari\n\t\t\t// Prevent Safari textarea resize\n\t\t\tthis.originalResizeStyle = this.originalElement.css(\"resize\");\n\t\t\tthis.originalElement.css(\"resize\", \"none\");\n\n\t\t\tthis._proportionallyResizeElements.push( this.originalElement.css({\n\t\t\t\tposition: \"static\",\n\t\t\t\tzoom: 1,\n\t\t\t\tdisplay: \"block\"\n\t\t\t}) );\n\n\t\t\t// support: IE9\n\t\t\t// avoid IE jump (hard set the margin)\n\t\t\tthis.originalElement.css({ margin: this.originalElement.css(\"margin\") });\n\n\t\t\tthis._proportionallyResize();\n\t\t}\n\n\t\tthis.handles = o.handles ||\n\t\t\t( !$(\".ui-resizable-handle\", this.element).length ?\n\t\t\t\t\"e,s,se\" : {\n\t\t\t\t\tn: \".ui-resizable-n\",\n\t\t\t\t\te: \".ui-resizable-e\",\n\t\t\t\t\ts: \".ui-resizable-s\",\n\t\t\t\t\tw: \".ui-resizable-w\",\n\t\t\t\t\tse: \".ui-resizable-se\",\n\t\t\t\t\tsw: \".ui-resizable-sw\",\n\t\t\t\t\tne: \".ui-resizable-ne\",\n\t\t\t\t\tnw: \".ui-resizable-nw\"\n\t\t\t\t} );\n\n\t\tthis._handles = $();\n\t\tif ( this.handles.constructor === String ) {\n\n\t\t\tif ( this.handles === \"all\") {\n\t\t\t\tthis.handles = \"n,e,s,w,se,sw,ne,nw\";\n\t\t\t}\n\n\t\t\tn = this.handles.split(\",\");\n\t\t\tthis.handles = {};\n\n\t\t\tfor (i = 0; i < n.length; i++) {\n\n\t\t\t\thandle = $.trim(n[i]);\n\t\t\t\thname = \"ui-resizable-\" + handle;\n\t\t\t\taxis = $(\"<div class='ui-resizable-handle \" + hname + \"'></div>\");\n\n\t\t\t\taxis.css({ zIndex: o.zIndex });\n\n\t\t\t\t// TODO : What's going on here?\n\t\t\t\tif (\"se\" === handle) {\n\t\t\t\t\taxis.addClass(\"ui-icon ui-icon-gripsmall-diagonal-se\");\n\t\t\t\t}\n\n\t\t\t\tthis.handles[handle] = \".ui-resizable-\" + handle;\n\t\t\t\tthis.element.append(axis);\n\t\t\t}\n\n\t\t}\n\n\t\tthis._renderAxis = function(target) {\n\n\t\t\tvar i, axis, padPos, padWrapper;\n\n\t\t\ttarget = target || this.element;\n\n\t\t\tfor (i in this.handles) {\n\n\t\t\t\tif (this.handles[i].constructor === String) {\n\t\t\t\t\tthis.handles[i] = this.element.children( this.handles[ i ] ).first().show();\n\t\t\t\t} else if ( this.handles[ i ].jquery || this.handles[ i ].nodeType ) {\n\t\t\t\t\tthis.handles[ i ] = $( this.handles[ i ] );\n\t\t\t\t\tthis._on( this.handles[ i ], { \"mousedown\": that._mouseDown });\n\t\t\t\t}\n\n\t\t\t\tif (this.elementIsWrapper && this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)) {\n\n\t\t\t\t\taxis = $(this.handles[i], this.element);\n\n\t\t\t\t\tpadWrapper = /sw|ne|nw|se|n|s/.test(i) ? axis.outerHeight() : axis.outerWidth();\n\n\t\t\t\t\tpadPos = [ \"padding\",\n\t\t\t\t\t\t/ne|nw|n/.test(i) ? \"Top\" :\n\t\t\t\t\t\t/se|sw|s/.test(i) ? \"Bottom\" :\n\t\t\t\t\t\t/^e$/.test(i) ? \"Right\" : \"Left\" ].join(\"\");\n\n\t\t\t\t\ttarget.css(padPos, padWrapper);\n\n\t\t\t\t\tthis._proportionallyResize();\n\t\t\t\t}\n\n\t\t\t\tthis._handles = this._handles.add( this.handles[ i ] );\n\t\t\t}\n\t\t};\n\n\t\t// TODO: make renderAxis a prototype function\n\t\tthis._renderAxis(this.element);\n\n\t\tthis._handles = this._handles.add( this.element.find( \".ui-resizable-handle\" ) );\n\t\tthis._handles.disableSelection();\n\n\t\tthis._handles.mouseover(function() {\n\t\t\tif (!that.resizing) {\n\t\t\t\tif (this.className) {\n\t\t\t\t\taxis = this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);\n\t\t\t\t}\n\t\t\t\tthat.axis = axis && axis[1] ? axis[1] : \"se\";\n\t\t\t}\n\t\t});\n\n\t\tif (o.autoHide) {\n\t\t\tthis._handles.hide();\n\t\t\t$(this.element)\n\t\t\t\t.addClass(\"ui-resizable-autohide\")\n\t\t\t\t.mouseenter(function() {\n\t\t\t\t\tif (o.disabled) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t$(this).removeClass(\"ui-resizable-autohide\");\n\t\t\t\t\tthat._handles.show();\n\t\t\t\t})\n\t\t\t\t.mouseleave(function() {\n\t\t\t\t\tif (o.disabled) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (!that.resizing) {\n\t\t\t\t\t\t$(this).addClass(\"ui-resizable-autohide\");\n\t\t\t\t\t\tthat._handles.hide();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n\n\t\tthis._mouseInit();\n\t},\n\n\t_destroy: function() {\n\n\t\tthis._mouseDestroy();\n\n\t\tvar wrapper,\n\t\t\t_destroy = function(exp) {\n\t\t\t\t$(exp)\n\t\t\t\t\t.removeClass(\"ui-resizable ui-resizable-disabled ui-resizable-resizing\")\n\t\t\t\t\t.removeData(\"resizable\")\n\t\t\t\t\t.removeData(\"ui-resizable\")\n\t\t\t\t\t.unbind(\".resizable\")\n\t\t\t\t\t.find(\".ui-resizable-handle\")\n\t\t\t\t\t\t.remove();\n\t\t\t};\n\n\t\t// TODO: Unwrap at same DOM position\n\t\tif (this.elementIsWrapper) {\n\t\t\t_destroy(this.element);\n\t\t\twrapper = this.element;\n\t\t\tthis.originalElement.css({\n\t\t\t\tposition: wrapper.css(\"position\"),\n\t\t\t\twidth: wrapper.outerWidth(),\n\t\t\t\theight: wrapper.outerHeight(),\n\t\t\t\ttop: wrapper.css(\"top\"),\n\t\t\t\tleft: wrapper.css(\"left\")\n\t\t\t}).insertAfter( wrapper );\n\t\t\twrapper.remove();\n\t\t}\n\n\t\tthis.originalElement.css(\"resize\", this.originalResizeStyle);\n\t\t_destroy(this.originalElement);\n\n\t\treturn this;\n\t},\n\n\t_mouseCapture: function(event) {\n\t\tvar i, handle,\n\t\t\tcapture = false;\n\n\t\tfor (i in this.handles) {\n\t\t\thandle = $(this.handles[i])[0];\n\t\t\tif (handle === event.target || $.contains(handle, event.target)) {\n\t\t\t\tcapture = true;\n\t\t\t}\n\t\t}\n\n\t\treturn !this.options.disabled && capture;\n\t},\n\n\t_mouseStart: function(event) {\n\n\t\tvar curleft, curtop, cursor,\n\t\t\to = this.options,\n\t\t\tel = this.element;\n\n\t\tthis.resizing = true;\n\n\t\tthis._renderProxy();\n\n\t\tcurleft = this._num(this.helper.css(\"left\"));\n\t\tcurtop = this._num(this.helper.css(\"top\"));\n\n\t\tif (o.containment) {\n\t\t\tcurleft += $(o.containment).scrollLeft() || 0;\n\t\t\tcurtop += $(o.containment).scrollTop() || 0;\n\t\t}\n\n\t\tthis.offset = this.helper.offset();\n\t\tthis.position = { left: curleft, top: curtop };\n\n\t\tthis.size = this._helper ? {\n\t\t\t\twidth: this.helper.width(),\n\t\t\t\theight: this.helper.height()\n\t\t\t} : {\n\t\t\t\twidth: el.width(),\n\t\t\t\theight: el.height()\n\t\t\t};\n\n\t\tthis.originalSize = this._helper ? {\n\t\t\t\twidth: el.outerWidth(),\n\t\t\t\theight: el.outerHeight()\n\t\t\t} : {\n\t\t\t\twidth: el.width(),\n\t\t\t\theight: el.height()\n\t\t\t};\n\n\t\tthis.sizeDiff = {\n\t\t\twidth: el.outerWidth() - el.width(),\n\t\t\theight: el.outerHeight() - el.height()\n\t\t};\n\n\t\tthis.originalPosition = { left: curleft, top: curtop };\n\t\tthis.originalMousePosition = { left: event.pageX, top: event.pageY };\n\n\t\tthis.aspectRatio = (typeof o.aspectRatio === \"number\") ?\n\t\t\to.aspectRatio :\n\t\t\t((this.originalSize.width / this.originalSize.height) || 1);\n\n\t\tcursor = $(\".ui-resizable-\" + this.axis).css(\"cursor\");\n\t\t$(\"body\").css(\"cursor\", cursor === \"auto\" ? this.axis + \"-resize\" : cursor);\n\n\t\tel.addClass(\"ui-resizable-resizing\");\n\t\tthis._propagate(\"start\", event);\n\t\treturn true;\n\t},\n\n\t_mouseDrag: function(event) {\n\n\t\tvar data, props,\n\t\t\tsmp = this.originalMousePosition,\n\t\t\ta = this.axis,\n\t\t\tdx = (event.pageX - smp.left) || 0,\n\t\t\tdy = (event.pageY - smp.top) || 0,\n\t\t\ttrigger = this._change[a];\n\n\t\tthis._updatePrevProperties();\n\n\t\tif (!trigger) {\n\t\t\treturn false;\n\t\t}\n\n\t\tdata = trigger.apply(this, [ event, dx, dy ]);\n\n\t\tthis._updateVirtualBoundaries(event.shiftKey);\n\t\tif (this._aspectRatio || event.shiftKey) {\n\t\t\tdata = this._updateRatio(data, event);\n\t\t}\n\n\t\tdata = this._respectSize(data, event);\n\n\t\tthis._updateCache(data);\n\n\t\tthis._propagate(\"resize\", event);\n\n\t\tprops = this._applyChanges();\n\n\t\tif ( !this._helper && this._proportionallyResizeElements.length ) {\n\t\t\tthis._proportionallyResize();\n\t\t}\n\n\t\tif ( !$.isEmptyObject( props ) ) {\n\t\t\tthis._updatePrevProperties();\n\t\t\tthis._trigger( \"resize\", event, this.ui() );\n\t\t\tthis._applyChanges();\n\t\t}\n\n\t\treturn false;\n\t},\n\n\t_mouseStop: function(event) {\n\n\t\tthis.resizing = false;\n\t\tvar pr, ista, soffseth, soffsetw, s, left, top,\n\t\t\to = this.options, that = this;\n\n\t\tif (this._helper) {\n\n\t\t\tpr = this._proportionallyResizeElements;\n\t\t\tista = pr.length && (/textarea/i).test(pr[0].nodeName);\n\t\t\tsoffseth = ista && this._hasScroll(pr[0], \"left\") ? 0 : that.sizeDiff.height;\n\t\t\tsoffsetw = ista ? 0 : that.sizeDiff.width;\n\n\t\t\ts = {\n\t\t\t\twidth: (that.helper.width()  - soffsetw),\n\t\t\t\theight: (that.helper.height() - soffseth)\n\t\t\t};\n\t\t\tleft = (parseInt(that.element.css(\"left\"), 10) +\n\t\t\t\t(that.position.left - that.originalPosition.left)) || null;\n\t\t\ttop = (parseInt(that.element.css(\"top\"), 10) +\n\t\t\t\t(that.position.top - that.originalPosition.top)) || null;\n\n\t\t\tif (!o.animate) {\n\t\t\t\tthis.element.css($.extend(s, { top: top, left: left }));\n\t\t\t}\n\n\t\t\tthat.helper.height(that.size.height);\n\t\t\tthat.helper.width(that.size.width);\n\n\t\t\tif (this._helper && !o.animate) {\n\t\t\t\tthis._proportionallyResize();\n\t\t\t}\n\t\t}\n\n\t\t$(\"body\").css(\"cursor\", \"auto\");\n\n\t\tthis.element.removeClass(\"ui-resizable-resizing\");\n\n\t\tthis._propagate(\"stop\", event);\n\n\t\tif (this._helper) {\n\t\t\tthis.helper.remove();\n\t\t}\n\n\t\treturn false;\n\n\t},\n\n\t_updatePrevProperties: function() {\n\t\tthis.prevPosition = {\n\t\t\ttop: this.position.top,\n\t\t\tleft: this.position.left\n\t\t};\n\t\tthis.prevSize = {\n\t\t\twidth: this.size.width,\n\t\t\theight: this.size.height\n\t\t};\n\t},\n\n\t_applyChanges: function() {\n\t\tvar props = {};\n\n\t\tif ( this.position.top !== this.prevPosition.top ) {\n\t\t\tprops.top = this.position.top + \"px\";\n\t\t}\n\t\tif ( this.position.left !== this.prevPosition.left ) {\n\t\t\tprops.left = this.position.left + \"px\";\n\t\t}\n\t\tif ( this.size.width !== this.prevSize.width ) {\n\t\t\tprops.width = this.size.width + \"px\";\n\t\t}\n\t\tif ( this.size.height !== this.prevSize.height ) {\n\t\t\tprops.height = this.size.height + \"px\";\n\t\t}\n\n\t\tthis.helper.css( props );\n\n\t\treturn props;\n\t},\n\n\t_updateVirtualBoundaries: function(forceAspectRatio) {\n\t\tvar pMinWidth, pMaxWidth, pMinHeight, pMaxHeight, b,\n\t\t\to = this.options;\n\n\t\tb = {\n\t\t\tminWidth: this._isNumber(o.minWidth) ? o.minWidth : 0,\n\t\t\tmaxWidth: this._isNumber(o.maxWidth) ? o.maxWidth : Infinity,\n\t\t\tminHeight: this._isNumber(o.minHeight) ? o.minHeight : 0,\n\t\t\tmaxHeight: this._isNumber(o.maxHeight) ? o.maxHeight : Infinity\n\t\t};\n\n\t\tif (this._aspectRatio || forceAspectRatio) {\n\t\t\tpMinWidth = b.minHeight * this.aspectRatio;\n\t\t\tpMinHeight = b.minWidth / this.aspectRatio;\n\t\t\tpMaxWidth = b.maxHeight * this.aspectRatio;\n\t\t\tpMaxHeight = b.maxWidth / this.aspectRatio;\n\n\t\t\tif (pMinWidth > b.minWidth) {\n\t\t\t\tb.minWidth = pMinWidth;\n\t\t\t}\n\t\t\tif (pMinHeight > b.minHeight) {\n\t\t\t\tb.minHeight = pMinHeight;\n\t\t\t}\n\t\t\tif (pMaxWidth < b.maxWidth) {\n\t\t\t\tb.maxWidth = pMaxWidth;\n\t\t\t}\n\t\t\tif (pMaxHeight < b.maxHeight) {\n\t\t\t\tb.maxHeight = pMaxHeight;\n\t\t\t}\n\t\t}\n\t\tthis._vBoundaries = b;\n\t},\n\n\t_updateCache: function(data) {\n\t\tthis.offset = this.helper.offset();\n\t\tif (this._isNumber(data.left)) {\n\t\t\tthis.position.left = data.left;\n\t\t}\n\t\tif (this._isNumber(data.top)) {\n\t\t\tthis.position.top = data.top;\n\t\t}\n\t\tif (this._isNumber(data.height)) {\n\t\t\tthis.size.height = data.height;\n\t\t}\n\t\tif (this._isNumber(data.width)) {\n\t\t\tthis.size.width = data.width;\n\t\t}\n\t},\n\n\t_updateRatio: function( data ) {\n\n\t\tvar cpos = this.position,\n\t\t\tcsize = this.size,\n\t\t\ta = this.axis;\n\n\t\tif (this._isNumber(data.height)) {\n\t\t\tdata.width = (data.height * this.aspectRatio);\n\t\t} else if (this._isNumber(data.width)) {\n\t\t\tdata.height = (data.width / this.aspectRatio);\n\t\t}\n\n\t\tif (a === \"sw\") {\n\t\t\tdata.left = cpos.left + (csize.width - data.width);\n\t\t\tdata.top = null;\n\t\t}\n\t\tif (a === \"nw\") {\n\t\t\tdata.top = cpos.top + (csize.height - data.height);\n\t\t\tdata.left = cpos.left + (csize.width - data.width);\n\t\t}\n\n\t\treturn data;\n\t},\n\n\t_respectSize: function( data ) {\n\n\t\tvar o = this._vBoundaries,\n\t\t\ta = this.axis,\n\t\t\tismaxw = this._isNumber(data.width) && o.maxWidth && (o.maxWidth < data.width),\n\t\t\tismaxh = this._isNumber(data.height) && o.maxHeight && (o.maxHeight < data.height),\n\t\t\tisminw = this._isNumber(data.width) && o.minWidth && (o.minWidth > data.width),\n\t\t\tisminh = this._isNumber(data.height) && o.minHeight && (o.minHeight > data.height),\n\t\t\tdw = this.originalPosition.left + this.originalSize.width,\n\t\t\tdh = this.position.top + this.size.height,\n\t\t\tcw = /sw|nw|w/.test(a), ch = /nw|ne|n/.test(a);\n\t\tif (isminw) {\n\t\t\tdata.width = o.minWidth;\n\t\t}\n\t\tif (isminh) {\n\t\t\tdata.height = o.minHeight;\n\t\t}\n\t\tif (ismaxw) {\n\t\t\tdata.width = o.maxWidth;\n\t\t}\n\t\tif (ismaxh) {\n\t\t\tdata.height = o.maxHeight;\n\t\t}\n\n\t\tif (isminw && cw) {\n\t\t\tdata.left = dw - o.minWidth;\n\t\t}\n\t\tif (ismaxw && cw) {\n\t\t\tdata.left = dw - o.maxWidth;\n\t\t}\n\t\tif (isminh && ch) {\n\t\t\tdata.top = dh - o.minHeight;\n\t\t}\n\t\tif (ismaxh && ch) {\n\t\t\tdata.top = dh - o.maxHeight;\n\t\t}\n\n\t\t// Fixing jump error on top/left - bug #2330\n\t\tif (!data.width && !data.height && !data.left && data.top) {\n\t\t\tdata.top = null;\n\t\t} else if (!data.width && !data.height && !data.top && data.left) {\n\t\t\tdata.left = null;\n\t\t}\n\n\t\treturn data;\n\t},\n\n\t_getPaddingPlusBorderDimensions: function( element ) {\n\t\tvar i = 0,\n\t\t\twidths = [],\n\t\t\tborders = [\n\t\t\t\telement.css( \"borderTopWidth\" ),\n\t\t\t\telement.css( \"borderRightWidth\" ),\n\t\t\t\telement.css( \"borderBottomWidth\" ),\n\t\t\t\telement.css( \"borderLeftWidth\" )\n\t\t\t],\n\t\t\tpaddings = [\n\t\t\t\telement.css( \"paddingTop\" ),\n\t\t\t\telement.css( \"paddingRight\" ),\n\t\t\t\telement.css( \"paddingBottom\" ),\n\t\t\t\telement.css( \"paddingLeft\" )\n\t\t\t];\n\n\t\tfor ( ; i < 4; i++ ) {\n\t\t\twidths[ i ] = ( parseInt( borders[ i ], 10 ) || 0 );\n\t\t\twidths[ i ] += ( parseInt( paddings[ i ], 10 ) || 0 );\n\t\t}\n\n\t\treturn {\n\t\t\theight: widths[ 0 ] + widths[ 2 ],\n\t\t\twidth: widths[ 1 ] + widths[ 3 ]\n\t\t};\n\t},\n\n\t_proportionallyResize: function() {\n\n\t\tif (!this._proportionallyResizeElements.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar prel,\n\t\t\ti = 0,\n\t\t\telement = this.helper || this.element;\n\n\t\tfor ( ; i < this._proportionallyResizeElements.length; i++) {\n\n\t\t\tprel = this._proportionallyResizeElements[i];\n\n\t\t\t// TODO: Seems like a bug to cache this.outerDimensions\n\t\t\t// considering that we are in a loop.\n\t\t\tif (!this.outerDimensions) {\n\t\t\t\tthis.outerDimensions = this._getPaddingPlusBorderDimensions( prel );\n\t\t\t}\n\n\t\t\tprel.css({\n\t\t\t\theight: (element.height() - this.outerDimensions.height) || 0,\n\t\t\t\twidth: (element.width() - this.outerDimensions.width) || 0\n\t\t\t});\n\n\t\t}\n\n\t},\n\n\t_renderProxy: function() {\n\n\t\tvar el = this.element, o = this.options;\n\t\tthis.elementOffset = el.offset();\n\n\t\tif (this._helper) {\n\n\t\t\tthis.helper = this.helper || $(\"<div style='overflow:hidden;'></div>\");\n\n\t\t\tthis.helper.addClass(this._helper).css({\n\t\t\t\twidth: this.element.outerWidth() - 1,\n\t\t\t\theight: this.element.outerHeight() - 1,\n\t\t\t\tposition: \"absolute\",\n\t\t\t\tleft: this.elementOffset.left + \"px\",\n\t\t\t\ttop: this.elementOffset.top + \"px\",\n\t\t\t\tzIndex: ++o.zIndex //TODO: Don't modify option\n\t\t\t});\n\n\t\t\tthis.helper\n\t\t\t\t.appendTo(\"body\")\n\t\t\t\t.disableSelection();\n\n\t\t} else {\n\t\t\tthis.helper = this.element;\n\t\t}\n\n\t},\n\n\t_change: {\n\t\te: function(event, dx) {\n\t\t\treturn { width: this.originalSize.width + dx };\n\t\t},\n\t\tw: function(event, dx) {\n\t\t\tvar cs = this.originalSize, sp = this.originalPosition;\n\t\t\treturn { left: sp.left + dx, width: cs.width - dx };\n\t\t},\n\t\tn: function(event, dx, dy) {\n\t\t\tvar cs = this.originalSize, sp = this.originalPosition;\n\t\t\treturn { top: sp.top + dy, height: cs.height - dy };\n\t\t},\n\t\ts: function(event, dx, dy) {\n\t\t\treturn { height: this.originalSize.height + dy };\n\t\t},\n\t\tse: function(event, dx, dy) {\n\t\t\treturn $.extend(this._change.s.apply(this, arguments),\n\t\t\t\tthis._change.e.apply(this, [ event, dx, dy ]));\n\t\t},\n\t\tsw: function(event, dx, dy) {\n\t\t\treturn $.extend(this._change.s.apply(this, arguments),\n\t\t\t\tthis._change.w.apply(this, [ event, dx, dy ]));\n\t\t},\n\t\tne: function(event, dx, dy) {\n\t\t\treturn $.extend(this._change.n.apply(this, arguments),\n\t\t\t\tthis._change.e.apply(this, [ event, dx, dy ]));\n\t\t},\n\t\tnw: function(event, dx, dy) {\n\t\t\treturn $.extend(this._change.n.apply(this, arguments),\n\t\t\t\tthis._change.w.apply(this, [ event, dx, dy ]));\n\t\t}\n\t},\n\n\t_propagate: function(n, event) {\n\t\t$.ui.plugin.call(this, n, [ event, this.ui() ]);\n\t\t(n !== \"resize\" && this._trigger(n, event, this.ui()));\n\t},\n\n\tplugins: {},\n\n\tui: function() {\n\t\treturn {\n\t\t\toriginalElement: this.originalElement,\n\t\t\telement: this.element,\n\t\t\thelper: this.helper,\n\t\t\tposition: this.position,\n\t\t\tsize: this.size,\n\t\t\toriginalSize: this.originalSize,\n\t\t\toriginalPosition: this.originalPosition\n\t\t};\n\t}\n\n});\n\n/*\n * Resizable Extensions\n */\n\n$.ui.plugin.add(\"resizable\", \"animate\", {\n\n\tstop: function( event ) {\n\t\tvar that = $(this).resizable( \"instance\" ),\n\t\t\to = that.options,\n\t\t\tpr = that._proportionallyResizeElements,\n\t\t\tista = pr.length && (/textarea/i).test(pr[0].nodeName),\n\t\t\tsoffseth = ista && that._hasScroll(pr[0], \"left\") ? 0 : that.sizeDiff.height,\n\t\t\tsoffsetw = ista ? 0 : that.sizeDiff.width,\n\t\t\tstyle = { width: (that.size.width - soffsetw), height: (that.size.height - soffseth) },\n\t\t\tleft = (parseInt(that.element.css(\"left\"), 10) +\n\t\t\t\t(that.position.left - that.originalPosition.left)) || null,\n\t\t\ttop = (parseInt(that.element.css(\"top\"), 10) +\n\t\t\t\t(that.position.top - that.originalPosition.top)) || null;\n\n\t\tthat.element.animate(\n\t\t\t$.extend(style, top && left ? { top: top, left: left } : {}), {\n\t\t\t\tduration: o.animateDuration,\n\t\t\t\teasing: o.animateEasing,\n\t\t\t\tstep: function() {\n\n\t\t\t\t\tvar data = {\n\t\t\t\t\t\twidth: parseInt(that.element.css(\"width\"), 10),\n\t\t\t\t\t\theight: parseInt(that.element.css(\"height\"), 10),\n\t\t\t\t\t\ttop: parseInt(that.element.css(\"top\"), 10),\n\t\t\t\t\t\tleft: parseInt(that.element.css(\"left\"), 10)\n\t\t\t\t\t};\n\n\t\t\t\t\tif (pr && pr.length) {\n\t\t\t\t\t\t$(pr[0]).css({ width: data.width, height: data.height });\n\t\t\t\t\t}\n\n\t\t\t\t\t// propagating resize, and updating values for each animation step\n\t\t\t\t\tthat._updateCache(data);\n\t\t\t\t\tthat._propagate(\"resize\", event);\n\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n});\n\n$.ui.plugin.add( \"resizable\", \"containment\", {\n\n\tstart: function() {\n\t\tvar element, p, co, ch, cw, width, height,\n\t\t\tthat = $( this ).resizable( \"instance\" ),\n\t\t\to = that.options,\n\t\t\tel = that.element,\n\t\t\toc = o.containment,\n\t\t\tce = ( oc instanceof $ ) ? oc.get( 0 ) : ( /parent/.test( oc ) ) ? el.parent().get( 0 ) : oc;\n\n\t\tif ( !ce ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthat.containerElement = $( ce );\n\n\t\tif ( /document/.test( oc ) || oc === document ) {\n\t\t\tthat.containerOffset = {\n\t\t\t\tleft: 0,\n\t\t\t\ttop: 0\n\t\t\t};\n\t\t\tthat.containerPosition = {\n\t\t\t\tleft: 0,\n\t\t\t\ttop: 0\n\t\t\t};\n\n\t\t\tthat.parentData = {\n\t\t\t\telement: $( document ),\n\t\t\t\tleft: 0,\n\t\t\t\ttop: 0,\n\t\t\t\twidth: $( document ).width(),\n\t\t\t\theight: $( document ).height() || document.body.parentNode.scrollHeight\n\t\t\t};\n\t\t} else {\n\t\t\telement = $( ce );\n\t\t\tp = [];\n\t\t\t$([ \"Top\", \"Right\", \"Left\", \"Bottom\" ]).each(function( i, name ) {\n\t\t\t\tp[ i ] = that._num( element.css( \"padding\" + name ) );\n\t\t\t});\n\n\t\t\tthat.containerOffset = element.offset();\n\t\t\tthat.containerPosition = element.position();\n\t\t\tthat.containerSize = {\n\t\t\t\theight: ( element.innerHeight() - p[ 3 ] ),\n\t\t\t\twidth: ( element.innerWidth() - p[ 1 ] )\n\t\t\t};\n\n\t\t\tco = that.containerOffset;\n\t\t\tch = that.containerSize.height;\n\t\t\tcw = that.containerSize.width;\n\t\t\twidth = ( that._hasScroll ( ce, \"left\" ) ? ce.scrollWidth : cw );\n\t\t\theight = ( that._hasScroll ( ce ) ? ce.scrollHeight : ch ) ;\n\n\t\t\tthat.parentData = {\n\t\t\t\telement: ce,\n\t\t\t\tleft: co.left,\n\t\t\t\ttop: co.top,\n\t\t\t\twidth: width,\n\t\t\t\theight: height\n\t\t\t};\n\t\t}\n\t},\n\n\tresize: function( event ) {\n\t\tvar woset, hoset, isParent, isOffsetRelative,\n\t\t\tthat = $( this ).resizable( \"instance\" ),\n\t\t\to = that.options,\n\t\t\tco = that.containerOffset,\n\t\t\tcp = that.position,\n\t\t\tpRatio = that._aspectRatio || event.shiftKey,\n\t\t\tcop = {\n\t\t\t\ttop: 0,\n\t\t\t\tleft: 0\n\t\t\t},\n\t\t\tce = that.containerElement,\n\t\t\tcontinueResize = true;\n\n\t\tif ( ce[ 0 ] !== document && ( /static/ ).test( ce.css( \"position\" ) ) ) {\n\t\t\tcop = co;\n\t\t}\n\n\t\tif ( cp.left < ( that._helper ? co.left : 0 ) ) {\n\t\t\tthat.size.width = that.size.width +\n\t\t\t\t( that._helper ?\n\t\t\t\t\t( that.position.left - co.left ) :\n\t\t\t\t\t( that.position.left - cop.left ) );\n\n\t\t\tif ( pRatio ) {\n\t\t\t\tthat.size.height = that.size.width / that.aspectRatio;\n\t\t\t\tcontinueResize = false;\n\t\t\t}\n\t\t\tthat.position.left = o.helper ? co.left : 0;\n\t\t}\n\n\t\tif ( cp.top < ( that._helper ? co.top : 0 ) ) {\n\t\t\tthat.size.height = that.size.height +\n\t\t\t\t( that._helper ?\n\t\t\t\t\t( that.position.top - co.top ) :\n\t\t\t\t\tthat.position.top );\n\n\t\t\tif ( pRatio ) {\n\t\t\t\tthat.size.width = that.size.height * that.aspectRatio;\n\t\t\t\tcontinueResize = false;\n\t\t\t}\n\t\t\tthat.position.top = that._helper ? co.top : 0;\n\t\t}\n\n\t\tisParent = that.containerElement.get( 0 ) === that.element.parent().get( 0 );\n\t\tisOffsetRelative = /relative|absolute/.test( that.containerElement.css( \"position\" ) );\n\n\t\tif ( isParent && isOffsetRelative ) {\n\t\t\tthat.offset.left = that.parentData.left + that.position.left;\n\t\t\tthat.offset.top = that.parentData.top + that.position.top;\n\t\t} else {\n\t\t\tthat.offset.left = that.element.offset().left;\n\t\t\tthat.offset.top = that.element.offset().top;\n\t\t}\n\n\t\twoset = Math.abs( that.sizeDiff.width +\n\t\t\t(that._helper ?\n\t\t\t\tthat.offset.left - cop.left :\n\t\t\t\t(that.offset.left - co.left)) );\n\n\t\thoset = Math.abs( that.sizeDiff.height +\n\t\t\t(that._helper ?\n\t\t\t\tthat.offset.top - cop.top :\n\t\t\t\t(that.offset.top - co.top)) );\n\n\t\tif ( woset + that.size.width >= that.parentData.width ) {\n\t\t\tthat.size.width = that.parentData.width - woset;\n\t\t\tif ( pRatio ) {\n\t\t\t\tthat.size.height = that.size.width / that.aspectRatio;\n\t\t\t\tcontinueResize = false;\n\t\t\t}\n\t\t}\n\n\t\tif ( hoset + that.size.height >= that.parentData.height ) {\n\t\t\tthat.size.height = that.parentData.height - hoset;\n\t\t\tif ( pRatio ) {\n\t\t\t\tthat.size.width = that.size.height * that.aspectRatio;\n\t\t\t\tcontinueResize = false;\n\t\t\t}\n\t\t}\n\n\t\tif ( !continueResize ) {\n\t\t\tthat.position.left = that.prevPosition.left;\n\t\t\tthat.position.top = that.prevPosition.top;\n\t\t\tthat.size.width = that.prevSize.width;\n\t\t\tthat.size.height = that.prevSize.height;\n\t\t}\n\t},\n\n\tstop: function() {\n\t\tvar that = $( this ).resizable( \"instance\" ),\n\t\t\to = that.options,\n\t\t\tco = that.containerOffset,\n\t\t\tcop = that.containerPosition,\n\t\t\tce = that.containerElement,\n\t\t\thelper = $( that.helper ),\n\t\t\tho = helper.offset(),\n\t\t\tw = helper.outerWidth() - that.sizeDiff.width,\n\t\t\th = helper.outerHeight() - that.sizeDiff.height;\n\n\t\tif ( that._helper && !o.animate && ( /relative/ ).test( ce.css( \"position\" ) ) ) {\n\t\t\t$( this ).css({\n\t\t\t\tleft: ho.left - cop.left - co.left,\n\t\t\t\twidth: w,\n\t\t\t\theight: h\n\t\t\t});\n\t\t}\n\n\t\tif ( that._helper && !o.animate && ( /static/ ).test( ce.css( \"position\" ) ) ) {\n\t\t\t$( this ).css({\n\t\t\t\tleft: ho.left - cop.left - co.left,\n\t\t\t\twidth: w,\n\t\t\t\theight: h\n\t\t\t});\n\t\t}\n\t}\n});\n\n$.ui.plugin.add(\"resizable\", \"alsoResize\", {\n\n\tstart: function() {\n\t\tvar that = $(this).resizable( \"instance\" ),\n\t\t\to = that.options;\n\n\t\t$(o.alsoResize).each(function() {\n\t\t\tvar el = $(this);\n\t\t\tel.data(\"ui-resizable-alsoresize\", {\n\t\t\t\twidth: parseInt(el.width(), 10), height: parseInt(el.height(), 10),\n\t\t\t\tleft: parseInt(el.css(\"left\"), 10), top: parseInt(el.css(\"top\"), 10)\n\t\t\t});\n\t\t});\n\t},\n\n\tresize: function(event, ui) {\n\t\tvar that = $(this).resizable( \"instance\" ),\n\t\t\to = that.options,\n\t\t\tos = that.originalSize,\n\t\t\top = that.originalPosition,\n\t\t\tdelta = {\n\t\t\t\theight: (that.size.height - os.height) || 0,\n\t\t\t\twidth: (that.size.width - os.width) || 0,\n\t\t\t\ttop: (that.position.top - op.top) || 0,\n\t\t\t\tleft: (that.position.left - op.left) || 0\n\t\t\t};\n\n\t\t\t$(o.alsoResize).each(function() {\n\t\t\t\tvar el = $(this), start = $(this).data(\"ui-resizable-alsoresize\"), style = {},\n\t\t\t\t\tcss = el.parents(ui.originalElement[0]).length ?\n\t\t\t\t\t\t\t[ \"width\", \"height\" ] :\n\t\t\t\t\t\t\t[ \"width\", \"height\", \"top\", \"left\" ];\n\n\t\t\t\t$.each(css, function(i, prop) {\n\t\t\t\t\tvar sum = (start[prop] || 0) + (delta[prop] || 0);\n\t\t\t\t\tif (sum && sum >= 0) {\n\t\t\t\t\t\tstyle[prop] = sum || null;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tel.css(style);\n\t\t\t});\n\t},\n\n\tstop: function() {\n\t\t$(this).removeData(\"resizable-alsoresize\");\n\t}\n});\n\n$.ui.plugin.add(\"resizable\", \"ghost\", {\n\n\tstart: function() {\n\n\t\tvar that = $(this).resizable( \"instance\" ), o = that.options, cs = that.size;\n\n\t\tthat.ghost = that.originalElement.clone();\n\t\tthat.ghost\n\t\t\t.css({\n\t\t\t\topacity: 0.25,\n\t\t\t\tdisplay: \"block\",\n\t\t\t\tposition: \"relative\",\n\t\t\t\theight: cs.height,\n\t\t\t\twidth: cs.width,\n\t\t\t\tmargin: 0,\n\t\t\t\tleft: 0,\n\t\t\t\ttop: 0\n\t\t\t})\n\t\t\t.addClass(\"ui-resizable-ghost\")\n\t\t\t.addClass(typeof o.ghost === \"string\" ? o.ghost : \"\");\n\n\t\tthat.ghost.appendTo(that.helper);\n\n\t},\n\n\tresize: function() {\n\t\tvar that = $(this).resizable( \"instance\" );\n\t\tif (that.ghost) {\n\t\t\tthat.ghost.css({\n\t\t\t\tposition: \"relative\",\n\t\t\t\theight: that.size.height,\n\t\t\t\twidth: that.size.width\n\t\t\t});\n\t\t}\n\t},\n\n\tstop: function() {\n\t\tvar that = $(this).resizable( \"instance\" );\n\t\tif (that.ghost && that.helper) {\n\t\t\tthat.helper.get(0).removeChild(that.ghost.get(0));\n\t\t}\n\t}\n\n});\n\n$.ui.plugin.add(\"resizable\", \"grid\", {\n\n\tresize: function() {\n\t\tvar outerDimensions,\n\t\t\tthat = $(this).resizable( \"instance\" ),\n\t\t\to = that.options,\n\t\t\tcs = that.size,\n\t\t\tos = that.originalSize,\n\t\t\top = that.originalPosition,\n\t\t\ta = that.axis,\n\t\t\tgrid = typeof o.grid === \"number\" ? [ o.grid, o.grid ] : o.grid,\n\t\t\tgridX = (grid[0] || 1),\n\t\t\tgridY = (grid[1] || 1),\n\t\t\tox = Math.round((cs.width - os.width) / gridX) * gridX,\n\t\t\toy = Math.round((cs.height - os.height) / gridY) * gridY,\n\t\t\tnewWidth = os.width + ox,\n\t\t\tnewHeight = os.height + oy,\n\t\t\tisMaxWidth = o.maxWidth && (o.maxWidth < newWidth),\n\t\t\tisMaxHeight = o.maxHeight && (o.maxHeight < newHeight),\n\t\t\tisMinWidth = o.minWidth && (o.minWidth > newWidth),\n\t\t\tisMinHeight = o.minHeight && (o.minHeight > newHeight);\n\n\t\to.grid = grid;\n\n\t\tif (isMinWidth) {\n\t\t\tnewWidth += gridX;\n\t\t}\n\t\tif (isMinHeight) {\n\t\t\tnewHeight += gridY;\n\t\t}\n\t\tif (isMaxWidth) {\n\t\t\tnewWidth -= gridX;\n\t\t}\n\t\tif (isMaxHeight) {\n\t\t\tnewHeight -= gridY;\n\t\t}\n\n\t\tif (/^(se|s|e)$/.test(a)) {\n\t\t\tthat.size.width = newWidth;\n\t\t\tthat.size.height = newHeight;\n\t\t} else if (/^(ne)$/.test(a)) {\n\t\t\tthat.size.width = newWidth;\n\t\t\tthat.size.height = newHeight;\n\t\t\tthat.position.top = op.top - oy;\n\t\t} else if (/^(sw)$/.test(a)) {\n\t\t\tthat.size.width = newWidth;\n\t\t\tthat.size.height = newHeight;\n\t\t\tthat.position.left = op.left - ox;\n\t\t} else {\n\t\t\tif ( newHeight - gridY <= 0 || newWidth - gridX <= 0) {\n\t\t\t\touterDimensions = that._getPaddingPlusBorderDimensions( this );\n\t\t\t}\n\n\t\t\tif ( newHeight - gridY > 0 ) {\n\t\t\t\tthat.size.height = newHeight;\n\t\t\t\tthat.position.top = op.top - oy;\n\t\t\t} else {\n\t\t\t\tnewHeight = gridY - outerDimensions.height;\n\t\t\t\tthat.size.height = newHeight;\n\t\t\t\tthat.position.top = op.top + os.height - newHeight;\n\t\t\t}\n\t\t\tif ( newWidth - gridX > 0 ) {\n\t\t\t\tthat.size.width = newWidth;\n\t\t\t\tthat.position.left = op.left - ox;\n\t\t\t} else {\n\t\t\t\tnewWidth = gridX - outerDimensions.width;\n\t\t\t\tthat.size.width = newWidth;\n\t\t\t\tthat.position.left = op.left + os.width - newWidth;\n\t\t\t}\n\t\t}\n\t}\n\n});\n\nvar resizable = $.ui.resizable;\n\n\n/*!\n * jQuery UI Dialog 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/dialog/\n */\n\n\nvar dialog = $.widget( \"ui.dialog\", {\n\tversion: \"1.11.4\",\n\toptions: {\n\t\tappendTo: \"body\",\n\t\tautoOpen: true,\n\t\tbuttons: [],\n\t\tcloseOnEscape: true,\n\t\tcloseText: \"Close\",\n\t\tdialogClass: \"\",\n\t\tdraggable: true,\n\t\thide: null,\n\t\theight: \"auto\",\n\t\tmaxHeight: null,\n\t\tmaxWidth: null,\n\t\tminHeight: 150,\n\t\tminWidth: 150,\n\t\tmodal: false,\n\t\tposition: {\n\t\t\tmy: \"center\",\n\t\t\tat: \"center\",\n\t\t\tof: window,\n\t\t\tcollision: \"fit\",\n\t\t\t// Ensure the titlebar is always visible\n\t\t\tusing: function( pos ) {\n\t\t\t\tvar topOffset = $( this ).css( pos ).offset().top;\n\t\t\t\tif ( topOffset < 0 ) {\n\t\t\t\t\t$( this ).css( \"top\", pos.top - topOffset );\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tresizable: true,\n\t\tshow: null,\n\t\ttitle: null,\n\t\twidth: 300,\n\n\t\t// callbacks\n\t\tbeforeClose: null,\n\t\tclose: null,\n\t\tdrag: null,\n\t\tdragStart: null,\n\t\tdragStop: null,\n\t\tfocus: null,\n\t\topen: null,\n\t\tresize: null,\n\t\tresizeStart: null,\n\t\tresizeStop: null\n\t},\n\n\tsizeRelatedOptions: {\n\t\tbuttons: true,\n\t\theight: true,\n\t\tmaxHeight: true,\n\t\tmaxWidth: true,\n\t\tminHeight: true,\n\t\tminWidth: true,\n\t\twidth: true\n\t},\n\n\tresizableRelatedOptions: {\n\t\tmaxHeight: true,\n\t\tmaxWidth: true,\n\t\tminHeight: true,\n\t\tminWidth: true\n\t},\n\n\t_create: function() {\n\t\tthis.originalCss = {\n\t\t\tdisplay: this.element[ 0 ].style.display,\n\t\t\twidth: this.element[ 0 ].style.width,\n\t\t\tminHeight: this.element[ 0 ].style.minHeight,\n\t\t\tmaxHeight: this.element[ 0 ].style.maxHeight,\n\t\t\theight: this.element[ 0 ].style.height\n\t\t};\n\t\tthis.originalPosition = {\n\t\t\tparent: this.element.parent(),\n\t\t\tindex: this.element.parent().children().index( this.element )\n\t\t};\n\t\tthis.originalTitle = this.element.attr( \"title\" );\n\t\tthis.options.title = this.options.title || this.originalTitle;\n\n\t\tthis._createWrapper();\n\n\t\tthis.element\n\t\t\t.show()\n\t\t\t.removeAttr( \"title\" )\n\t\t\t.addClass( \"ui-dialog-content ui-widget-content\" )\n\t\t\t.appendTo( this.uiDialog );\n\n\t\tthis._createTitlebar();\n\t\tthis._createButtonPane();\n\n\t\tif ( this.options.draggable && $.fn.draggable ) {\n\t\t\tthis._makeDraggable();\n\t\t}\n\t\tif ( this.options.resizable && $.fn.resizable ) {\n\t\t\tthis._makeResizable();\n\t\t}\n\n\t\tthis._isOpen = false;\n\n\t\tthis._trackFocus();\n\t},\n\n\t_init: function() {\n\t\tif ( this.options.autoOpen ) {\n\t\t\tthis.open();\n\t\t}\n\t},\n\n\t_appendTo: function() {\n\t\tvar element = this.options.appendTo;\n\t\tif ( element && (element.jquery || element.nodeType) ) {\n\t\t\treturn $( element );\n\t\t}\n\t\treturn this.document.find( element || \"body\" ).eq( 0 );\n\t},\n\n\t_destroy: function() {\n\t\tvar next,\n\t\t\toriginalPosition = this.originalPosition;\n\n\t\tthis._untrackInstance();\n\t\tthis._destroyOverlay();\n\n\t\tthis.element\n\t\t\t.removeUniqueId()\n\t\t\t.removeClass( \"ui-dialog-content ui-widget-content\" )\n\t\t\t.css( this.originalCss )\n\t\t\t// Without detaching first, the following becomes really slow\n\t\t\t.detach();\n\n\t\tthis.uiDialog.stop( true, true ).remove();\n\n\t\tif ( this.originalTitle ) {\n\t\t\tthis.element.attr( \"title\", this.originalTitle );\n\t\t}\n\n\t\tnext = originalPosition.parent.children().eq( originalPosition.index );\n\t\t// Don't try to place the dialog next to itself (#8613)\n\t\tif ( next.length && next[ 0 ] !== this.element[ 0 ] ) {\n\t\t\tnext.before( this.element );\n\t\t} else {\n\t\t\toriginalPosition.parent.append( this.element );\n\t\t}\n\t},\n\n\twidget: function() {\n\t\treturn this.uiDialog;\n\t},\n\n\tdisable: $.noop,\n\tenable: $.noop,\n\n\tclose: function( event ) {\n\t\tvar activeElement,\n\t\t\tthat = this;\n\n\t\tif ( !this._isOpen || this._trigger( \"beforeClose\", event ) === false ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._isOpen = false;\n\t\tthis._focusedElement = null;\n\t\tthis._destroyOverlay();\n\t\tthis._untrackInstance();\n\n\t\tif ( !this.opener.filter( \":focusable\" ).focus().length ) {\n\n\t\t\t// support: IE9\n\t\t\t// IE9 throws an \"Unspecified error\" accessing document.activeElement from an <iframe>\n\t\t\ttry {\n\t\t\t\tactiveElement = this.document[ 0 ].activeElement;\n\n\t\t\t\t// Support: IE9, IE10\n\t\t\t\t// If the <body> is blurred, IE will switch windows, see #4520\n\t\t\t\tif ( activeElement && activeElement.nodeName.toLowerCase() !== \"body\" ) {\n\n\t\t\t\t\t// Hiding a focused element doesn't trigger blur in WebKit\n\t\t\t\t\t// so in case we have nothing to focus on, explicitly blur the active element\n\t\t\t\t\t// https://bugs.webkit.org/show_bug.cgi?id=47182\n\t\t\t\t\t$( activeElement ).blur();\n\t\t\t\t}\n\t\t\t} catch ( error ) {}\n\t\t}\n\n\t\tthis._hide( this.uiDialog, this.options.hide, function() {\n\t\t\tthat._trigger( \"close\", event );\n\t\t});\n\t},\n\n\tisOpen: function() {\n\t\treturn this._isOpen;\n\t},\n\n\tmoveToTop: function() {\n\t\tthis._moveToTop();\n\t},\n\n\t_moveToTop: function( event, silent ) {\n\t\tvar moved = false,\n\t\t\tzIndices = this.uiDialog.siblings( \".ui-front:visible\" ).map(function() {\n\t\t\t\treturn +$( this ).css( \"z-index\" );\n\t\t\t}).get(),\n\t\t\tzIndexMax = Math.max.apply( null, zIndices );\n\n\t\tif ( zIndexMax >= +this.uiDialog.css( \"z-index\" ) ) {\n\t\t\tthis.uiDialog.css( \"z-index\", zIndexMax + 1 );\n\t\t\tmoved = true;\n\t\t}\n\n\t\tif ( moved && !silent ) {\n\t\t\tthis._trigger( \"focus\", event );\n\t\t}\n\t\treturn moved;\n\t},\n\n\topen: function() {\n\t\tvar that = this;\n\t\tif ( this._isOpen ) {\n\t\t\tif ( this._moveToTop() ) {\n\t\t\t\tthis._focusTabbable();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tthis._isOpen = true;\n\t\tthis.opener = $( this.document[ 0 ].activeElement );\n\n\t\tthis._size();\n\t\tthis._position();\n\t\tthis._createOverlay();\n\t\tthis._moveToTop( null, true );\n\n\t\t// Ensure the overlay is moved to the top with the dialog, but only when\n\t\t// opening. The overlay shouldn't move after the dialog is open so that\n\t\t// modeless dialogs opened after the modal dialog stack properly.\n\t\tif ( this.overlay ) {\n\t\t\tthis.overlay.css( \"z-index\", this.uiDialog.css( \"z-index\" ) - 1 );\n\t\t}\n\n\t\tthis._show( this.uiDialog, this.options.show, function() {\n\t\t\tthat._focusTabbable();\n\t\t\tthat._trigger( \"focus\" );\n\t\t});\n\n\t\t// Track the dialog immediately upon openening in case a focus event\n\t\t// somehow occurs outside of the dialog before an element inside the\n\t\t// dialog is focused (#10152)\n\t\tthis._makeFocusTarget();\n\n\t\tthis._trigger( \"open\" );\n\t},\n\n\t_focusTabbable: function() {\n\t\t// Set focus to the first match:\n\t\t// 1. An element that was focused previously\n\t\t// 2. First element inside the dialog matching [autofocus]\n\t\t// 3. Tabbable element inside the content element\n\t\t// 4. Tabbable element inside the buttonpane\n\t\t// 5. The close button\n\t\t// 6. The dialog itself\n\t\tvar hasFocus = this._focusedElement;\n\t\tif ( !hasFocus ) {\n\t\t\thasFocus = this.element.find( \"[autofocus]\" );\n\t\t}\n\t\tif ( !hasFocus.length ) {\n\t\t\thasFocus = this.element.find( \":tabbable\" );\n\t\t}\n\t\tif ( !hasFocus.length ) {\n\t\t\thasFocus = this.uiDialogButtonPane.find( \":tabbable\" );\n\t\t}\n\t\tif ( !hasFocus.length ) {\n\t\t\thasFocus = this.uiDialogTitlebarClose.filter( \":tabbable\" );\n\t\t}\n\t\tif ( !hasFocus.length ) {\n\t\t\thasFocus = this.uiDialog;\n\t\t}\n\t\thasFocus.eq( 0 ).focus();\n\t},\n\n\t_keepFocus: function( event ) {\n\t\tfunction checkFocus() {\n\t\t\tvar activeElement = this.document[0].activeElement,\n\t\t\t\tisActive = this.uiDialog[0] === activeElement ||\n\t\t\t\t\t$.contains( this.uiDialog[0], activeElement );\n\t\t\tif ( !isActive ) {\n\t\t\t\tthis._focusTabbable();\n\t\t\t}\n\t\t}\n\t\tevent.preventDefault();\n\t\tcheckFocus.call( this );\n\t\t// support: IE\n\t\t// IE <= 8 doesn't prevent moving focus even with event.preventDefault()\n\t\t// so we check again later\n\t\tthis._delay( checkFocus );\n\t},\n\n\t_createWrapper: function() {\n\t\tthis.uiDialog = $(\"<div>\")\n\t\t\t.addClass( \"ui-dialog ui-widget ui-widget-content ui-corner-all ui-front \" +\n\t\t\t\tthis.options.dialogClass )\n\t\t\t.hide()\n\t\t\t.attr({\n\t\t\t\t// Setting tabIndex makes the div focusable\n\t\t\t\ttabIndex: -1,\n\t\t\t\trole: \"dialog\"\n\t\t\t})\n\t\t\t.appendTo( this._appendTo() );\n\n\t\tthis._on( this.uiDialog, {\n\t\t\tkeydown: function( event ) {\n\t\t\t\tif ( this.options.closeOnEscape && !event.isDefaultPrevented() && event.keyCode &&\n\t\t\t\t\t\tevent.keyCode === $.ui.keyCode.ESCAPE ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tthis.close( event );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// prevent tabbing out of dialogs\n\t\t\t\tif ( event.keyCode !== $.ui.keyCode.TAB || event.isDefaultPrevented() ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar tabbables = this.uiDialog.find( \":tabbable\" ),\n\t\t\t\t\tfirst = tabbables.filter( \":first\" ),\n\t\t\t\t\tlast = tabbables.filter( \":last\" );\n\n\t\t\t\tif ( ( event.target === last[0] || event.target === this.uiDialog[0] ) && !event.shiftKey ) {\n\t\t\t\t\tthis._delay(function() {\n\t\t\t\t\t\tfirst.focus();\n\t\t\t\t\t});\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t} else if ( ( event.target === first[0] || event.target === this.uiDialog[0] ) && event.shiftKey ) {\n\t\t\t\t\tthis._delay(function() {\n\t\t\t\t\t\tlast.focus();\n\t\t\t\t\t});\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t},\n\t\t\tmousedown: function( event ) {\n\t\t\t\tif ( this._moveToTop( event ) ) {\n\t\t\t\t\tthis._focusTabbable();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// We assume that any existing aria-describedby attribute means\n\t\t// that the dialog content is marked up properly\n\t\t// otherwise we brute force the content as the description\n\t\tif ( !this.element.find( \"[aria-describedby]\" ).length ) {\n\t\t\tthis.uiDialog.attr({\n\t\t\t\t\"aria-describedby\": this.element.uniqueId().attr( \"id\" )\n\t\t\t});\n\t\t}\n\t},\n\n\t_createTitlebar: function() {\n\t\tvar uiDialogTitle;\n\n\t\tthis.uiDialogTitlebar = $( \"<div>\" )\n\t\t\t.addClass( \"ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix\" )\n\t\t\t.prependTo( this.uiDialog );\n\t\tthis._on( this.uiDialogTitlebar, {\n\t\t\tmousedown: function( event ) {\n\t\t\t\t// Don't prevent click on close button (#8838)\n\t\t\t\t// Focusing a dialog that is partially scrolled out of view\n\t\t\t\t// causes the browser to scroll it into view, preventing the click event\n\t\t\t\tif ( !$( event.target ).closest( \".ui-dialog-titlebar-close\" ) ) {\n\t\t\t\t\t// Dialog isn't getting focus when dragging (#8063)\n\t\t\t\t\tthis.uiDialog.focus();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// support: IE\n\t\t// Use type=\"button\" to prevent enter keypresses in textboxes from closing the\n\t\t// dialog in IE (#9312)\n\t\tthis.uiDialogTitlebarClose = $( \"<button type='button'></button>\" )\n\t\t\t.button({\n\t\t\t\tlabel: this.options.closeText,\n\t\t\t\ticons: {\n\t\t\t\t\tprimary: \"ui-icon-closethick\"\n\t\t\t\t},\n\t\t\t\ttext: false\n\t\t\t})\n\t\t\t.addClass( \"ui-dialog-titlebar-close\" )\n\t\t\t.appendTo( this.uiDialogTitlebar );\n\t\tthis._on( this.uiDialogTitlebarClose, {\n\t\t\tclick: function( event ) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tthis.close( event );\n\t\t\t}\n\t\t});\n\n\t\tuiDialogTitle = $( \"<span>\" )\n\t\t\t.uniqueId()\n\t\t\t.addClass( \"ui-dialog-title\" )\n\t\t\t.prependTo( this.uiDialogTitlebar );\n\t\tthis._title( uiDialogTitle );\n\n\t\tthis.uiDialog.attr({\n\t\t\t\"aria-labelledby\": uiDialogTitle.attr( \"id\" )\n\t\t});\n\t},\n\n\t_title: function( title ) {\n\t\tif ( !this.options.title ) {\n\t\t\ttitle.html( \"&#160;\" );\n\t\t}\n\t\ttitle.text( this.options.title );\n\t},\n\n\t_createButtonPane: function() {\n\t\tthis.uiDialogButtonPane = $( \"<div>\" )\n\t\t\t.addClass( \"ui-dialog-buttonpane ui-widget-content ui-helper-clearfix\" );\n\n\t\tthis.uiButtonSet = $( \"<div>\" )\n\t\t\t.addClass( \"ui-dialog-buttonset\" )\n\t\t\t.appendTo( this.uiDialogButtonPane );\n\n\t\tthis._createButtons();\n\t},\n\n\t_createButtons: function() {\n\t\tvar that = this,\n\t\t\tbuttons = this.options.buttons;\n\n\t\t// if we already have a button pane, remove it\n\t\tthis.uiDialogButtonPane.remove();\n\t\tthis.uiButtonSet.empty();\n\n\t\tif ( $.isEmptyObject( buttons ) || ($.isArray( buttons ) && !buttons.length) ) {\n\t\t\tthis.uiDialog.removeClass( \"ui-dialog-buttons\" );\n\t\t\treturn;\n\t\t}\n\n\t\t$.each( buttons, function( name, props ) {\n\t\t\tvar click, buttonOptions;\n\t\t\tprops = $.isFunction( props ) ?\n\t\t\t\t{ click: props, text: name } :\n\t\t\t\tprops;\n\t\t\t// Default to a non-submitting button\n\t\t\tprops = $.extend( { type: \"button\" }, props );\n\t\t\t// Change the context for the click callback to be the main element\n\t\t\tclick = props.click;\n\t\t\tprops.click = function() {\n\t\t\t\tclick.apply( that.element[ 0 ], arguments );\n\t\t\t};\n\t\t\tbuttonOptions = {\n\t\t\t\ticons: props.icons,\n\t\t\t\ttext: props.showText\n\t\t\t};\n\t\t\tdelete props.icons;\n\t\t\tdelete props.showText;\n\t\t\t$( \"<button></button>\", props )\n\t\t\t\t.button( buttonOptions )\n\t\t\t\t.appendTo( that.uiButtonSet );\n\t\t});\n\t\tthis.uiDialog.addClass( \"ui-dialog-buttons\" );\n\t\tthis.uiDialogButtonPane.appendTo( this.uiDialog );\n\t},\n\n\t_makeDraggable: function() {\n\t\tvar that = this,\n\t\t\toptions = this.options;\n\n\t\tfunction filteredUi( ui ) {\n\t\t\treturn {\n\t\t\t\tposition: ui.position,\n\t\t\t\toffset: ui.offset\n\t\t\t};\n\t\t}\n\n\t\tthis.uiDialog.draggable({\n\t\t\tcancel: \".ui-dialog-content, .ui-dialog-titlebar-close\",\n\t\t\thandle: \".ui-dialog-titlebar\",\n\t\t\tcontainment: \"document\",\n\t\t\tstart: function( event, ui ) {\n\t\t\t\t$( this ).addClass( \"ui-dialog-dragging\" );\n\t\t\t\tthat._blockFrames();\n\t\t\t\tthat._trigger( \"dragStart\", event, filteredUi( ui ) );\n\t\t\t},\n\t\t\tdrag: function( event, ui ) {\n\t\t\t\tthat._trigger( \"drag\", event, filteredUi( ui ) );\n\t\t\t},\n\t\t\tstop: function( event, ui ) {\n\t\t\t\tvar left = ui.offset.left - that.document.scrollLeft(),\n\t\t\t\t\ttop = ui.offset.top - that.document.scrollTop();\n\n\t\t\t\toptions.position = {\n\t\t\t\t\tmy: \"left top\",\n\t\t\t\t\tat: \"left\" + (left >= 0 ? \"+\" : \"\") + left + \" \" +\n\t\t\t\t\t\t\"top\" + (top >= 0 ? \"+\" : \"\") + top,\n\t\t\t\t\tof: that.window\n\t\t\t\t};\n\t\t\t\t$( this ).removeClass( \"ui-dialog-dragging\" );\n\t\t\t\tthat._unblockFrames();\n\t\t\t\tthat._trigger( \"dragStop\", event, filteredUi( ui ) );\n\t\t\t}\n\t\t});\n\t},\n\n\t_makeResizable: function() {\n\t\tvar that = this,\n\t\t\toptions = this.options,\n\t\t\thandles = options.resizable,\n\t\t\t// .ui-resizable has position: relative defined in the stylesheet\n\t\t\t// but dialogs have to use absolute or fixed positioning\n\t\t\tposition = this.uiDialog.css(\"position\"),\n\t\t\tresizeHandles = typeof handles === \"string\" ?\n\t\t\t\thandles\t:\n\t\t\t\t\"n,e,s,w,se,sw,ne,nw\";\n\n\t\tfunction filteredUi( ui ) {\n\t\t\treturn {\n\t\t\t\toriginalPosition: ui.originalPosition,\n\t\t\t\toriginalSize: ui.originalSize,\n\t\t\t\tposition: ui.position,\n\t\t\t\tsize: ui.size\n\t\t\t};\n\t\t}\n\n\t\tthis.uiDialog.resizable({\n\t\t\tcancel: \".ui-dialog-content\",\n\t\t\tcontainment: \"document\",\n\t\t\talsoResize: this.element,\n\t\t\tmaxWidth: options.maxWidth,\n\t\t\tmaxHeight: options.maxHeight,\n\t\t\tminWidth: options.minWidth,\n\t\t\tminHeight: this._minHeight(),\n\t\t\thandles: resizeHandles,\n\t\t\tstart: function( event, ui ) {\n\t\t\t\t$( this ).addClass( \"ui-dialog-resizing\" );\n\t\t\t\tthat._blockFrames();\n\t\t\t\tthat._trigger( \"resizeStart\", event, filteredUi( ui ) );\n\t\t\t},\n\t\t\tresize: function( event, ui ) {\n\t\t\t\tthat._trigger( \"resize\", event, filteredUi( ui ) );\n\t\t\t},\n\t\t\tstop: function( event, ui ) {\n\t\t\t\tvar offset = that.uiDialog.offset(),\n\t\t\t\t\tleft = offset.left - that.document.scrollLeft(),\n\t\t\t\t\ttop = offset.top - that.document.scrollTop();\n\n\t\t\t\toptions.height = that.uiDialog.height();\n\t\t\t\toptions.width = that.uiDialog.width();\n\t\t\t\toptions.position = {\n\t\t\t\t\tmy: \"left top\",\n\t\t\t\t\tat: \"left\" + (left >= 0 ? \"+\" : \"\") + left + \" \" +\n\t\t\t\t\t\t\"top\" + (top >= 0 ? \"+\" : \"\") + top,\n\t\t\t\t\tof: that.window\n\t\t\t\t};\n\t\t\t\t$( this ).removeClass( \"ui-dialog-resizing\" );\n\t\t\t\tthat._unblockFrames();\n\t\t\t\tthat._trigger( \"resizeStop\", event, filteredUi( ui ) );\n\t\t\t}\n\t\t})\n\t\t.css( \"position\", position );\n\t},\n\n\t_trackFocus: function() {\n\t\tthis._on( this.widget(), {\n\t\t\tfocusin: function( event ) {\n\t\t\t\tthis._makeFocusTarget();\n\t\t\t\tthis._focusedElement = $( event.target );\n\t\t\t}\n\t\t});\n\t},\n\n\t_makeFocusTarget: function() {\n\t\tthis._untrackInstance();\n\t\tthis._trackingInstances().unshift( this );\n\t},\n\n\t_untrackInstance: function() {\n\t\tvar instances = this._trackingInstances(),\n\t\t\texists = $.inArray( this, instances );\n\t\tif ( exists !== -1 ) {\n\t\t\tinstances.splice( exists, 1 );\n\t\t}\n\t},\n\n\t_trackingInstances: function() {\n\t\tvar instances = this.document.data( \"ui-dialog-instances\" );\n\t\tif ( !instances ) {\n\t\t\tinstances = [];\n\t\t\tthis.document.data( \"ui-dialog-instances\", instances );\n\t\t}\n\t\treturn instances;\n\t},\n\n\t_minHeight: function() {\n\t\tvar options = this.options;\n\n\t\treturn options.height === \"auto\" ?\n\t\t\toptions.minHeight :\n\t\t\tMath.min( options.minHeight, options.height );\n\t},\n\n\t_position: function() {\n\t\t// Need to show the dialog to get the actual offset in the position plugin\n\t\tvar isVisible = this.uiDialog.is( \":visible\" );\n\t\tif ( !isVisible ) {\n\t\t\tthis.uiDialog.show();\n\t\t}\n\t\tthis.uiDialog.position( this.options.position );\n\t\tif ( !isVisible ) {\n\t\t\tthis.uiDialog.hide();\n\t\t}\n\t},\n\n\t_setOptions: function( options ) {\n\t\tvar that = this,\n\t\t\tresize = false,\n\t\t\tresizableOptions = {};\n\n\t\t$.each( options, function( key, value ) {\n\t\t\tthat._setOption( key, value );\n\n\t\t\tif ( key in that.sizeRelatedOptions ) {\n\t\t\t\tresize = true;\n\t\t\t}\n\t\t\tif ( key in that.resizableRelatedOptions ) {\n\t\t\t\tresizableOptions[ key ] = value;\n\t\t\t}\n\t\t});\n\n\t\tif ( resize ) {\n\t\t\tthis._size();\n\t\t\tthis._position();\n\t\t}\n\t\tif ( this.uiDialog.is( \":data(ui-resizable)\" ) ) {\n\t\t\tthis.uiDialog.resizable( \"option\", resizableOptions );\n\t\t}\n\t},\n\n\t_setOption: function( key, value ) {\n\t\tvar isDraggable, isResizable,\n\t\t\tuiDialog = this.uiDialog;\n\n\t\tif ( key === \"dialogClass\" ) {\n\t\t\tuiDialog\n\t\t\t\t.removeClass( this.options.dialogClass )\n\t\t\t\t.addClass( value );\n\t\t}\n\n\t\tif ( key === \"disabled\" ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._super( key, value );\n\n\t\tif ( key === \"appendTo\" ) {\n\t\t\tthis.uiDialog.appendTo( this._appendTo() );\n\t\t}\n\n\t\tif ( key === \"buttons\" ) {\n\t\t\tthis._createButtons();\n\t\t}\n\n\t\tif ( key === \"closeText\" ) {\n\t\t\tthis.uiDialogTitlebarClose.button({\n\t\t\t\t// Ensure that we always pass a string\n\t\t\t\tlabel: \"\" + value\n\t\t\t});\n\t\t}\n\n\t\tif ( key === \"draggable\" ) {\n\t\t\tisDraggable = uiDialog.is( \":data(ui-draggable)\" );\n\t\t\tif ( isDraggable && !value ) {\n\t\t\t\tuiDialog.draggable( \"destroy\" );\n\t\t\t}\n\n\t\t\tif ( !isDraggable && value ) {\n\t\t\t\tthis._makeDraggable();\n\t\t\t}\n\t\t}\n\n\t\tif ( key === \"position\" ) {\n\t\t\tthis._position();\n\t\t}\n\n\t\tif ( key === \"resizable\" ) {\n\t\t\t// currently resizable, becoming non-resizable\n\t\t\tisResizable = uiDialog.is( \":data(ui-resizable)\" );\n\t\t\tif ( isResizable && !value ) {\n\t\t\t\tuiDialog.resizable( \"destroy\" );\n\t\t\t}\n\n\t\t\t// currently resizable, changing handles\n\t\t\tif ( isResizable && typeof value === \"string\" ) {\n\t\t\t\tuiDialog.resizable( \"option\", \"handles\", value );\n\t\t\t}\n\n\t\t\t// currently non-resizable, becoming resizable\n\t\t\tif ( !isResizable && value !== false ) {\n\t\t\t\tthis._makeResizable();\n\t\t\t}\n\t\t}\n\n\t\tif ( key === \"title\" ) {\n\t\t\tthis._title( this.uiDialogTitlebar.find( \".ui-dialog-title\" ) );\n\t\t}\n\t},\n\n\t_size: function() {\n\t\t// If the user has resized the dialog, the .ui-dialog and .ui-dialog-content\n\t\t// divs will both have width and height set, so we need to reset them\n\t\tvar nonContentHeight, minContentHeight, maxContentHeight,\n\t\t\toptions = this.options;\n\n\t\t// Reset content sizing\n\t\tthis.element.show().css({\n\t\t\twidth: \"auto\",\n\t\t\tminHeight: 0,\n\t\t\tmaxHeight: \"none\",\n\t\t\theight: 0\n\t\t});\n\n\t\tif ( options.minWidth > options.width ) {\n\t\t\toptions.width = options.minWidth;\n\t\t}\n\n\t\t// reset wrapper sizing\n\t\t// determine the height of all the non-content elements\n\t\tnonContentHeight = this.uiDialog.css({\n\t\t\t\theight: \"auto\",\n\t\t\t\twidth: options.width\n\t\t\t})\n\t\t\t.outerHeight();\n\t\tminContentHeight = Math.max( 0, options.minHeight - nonContentHeight );\n\t\tmaxContentHeight = typeof options.maxHeight === \"number\" ?\n\t\t\tMath.max( 0, options.maxHeight - nonContentHeight ) :\n\t\t\t\"none\";\n\n\t\tif ( options.height === \"auto\" ) {\n\t\t\tthis.element.css({\n\t\t\t\tminHeight: minContentHeight,\n\t\t\t\tmaxHeight: maxContentHeight,\n\t\t\t\theight: \"auto\"\n\t\t\t});\n\t\t} else {\n\t\t\tthis.element.height( Math.max( 0, options.height - nonContentHeight ) );\n\t\t}\n\n\t\tif ( this.uiDialog.is( \":data(ui-resizable)\" ) ) {\n\t\t\tthis.uiDialog.resizable( \"option\", \"minHeight\", this._minHeight() );\n\t\t}\n\t},\n\n\t_blockFrames: function() {\n\t\tthis.iframeBlocks = this.document.find( \"iframe\" ).map(function() {\n\t\t\tvar iframe = $( this );\n\n\t\t\treturn $( \"<div>\" )\n\t\t\t\t.css({\n\t\t\t\t\tposition: \"absolute\",\n\t\t\t\t\twidth: iframe.outerWidth(),\n\t\t\t\t\theight: iframe.outerHeight()\n\t\t\t\t})\n\t\t\t\t.appendTo( iframe.parent() )\n\t\t\t\t.offset( iframe.offset() )[0];\n\t\t});\n\t},\n\n\t_unblockFrames: function() {\n\t\tif ( this.iframeBlocks ) {\n\t\t\tthis.iframeBlocks.remove();\n\t\t\tdelete this.iframeBlocks;\n\t\t}\n\t},\n\n\t_allowInteraction: function( event ) {\n\t\tif ( $( event.target ).closest( \".ui-dialog\" ).length ) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// TODO: Remove hack when datepicker implements\n\t\t// the .ui-front logic (#8989)\n\t\treturn !!$( event.target ).closest( \".ui-datepicker\" ).length;\n\t},\n\n\t_createOverlay: function() {\n\t\tif ( !this.options.modal ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// We use a delay in case the overlay is created from an\n\t\t// event that we're going to be cancelling (#2804)\n\t\tvar isOpening = true;\n\t\tthis._delay(function() {\n\t\t\tisOpening = false;\n\t\t});\n\n\t\tif ( !this.document.data( \"ui-dialog-overlays\" ) ) {\n\n\t\t\t// Prevent use of anchors and inputs\n\t\t\t// Using _on() for an event handler shared across many instances is\n\t\t\t// safe because the dialogs stack and must be closed in reverse order\n\t\t\tthis._on( this.document, {\n\t\t\t\tfocusin: function( event ) {\n\t\t\t\t\tif ( isOpening ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( !this._allowInteraction( event ) ) {\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tthis._trackingInstances()[ 0 ]._focusTabbable();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.overlay = $( \"<div>\" )\n\t\t\t.addClass( \"ui-widget-overlay ui-front\" )\n\t\t\t.appendTo( this._appendTo() );\n\t\tthis._on( this.overlay, {\n\t\t\tmousedown: \"_keepFocus\"\n\t\t});\n\t\tthis.document.data( \"ui-dialog-overlays\",\n\t\t\t(this.document.data( \"ui-dialog-overlays\" ) || 0) + 1 );\n\t},\n\n\t_destroyOverlay: function() {\n\t\tif ( !this.options.modal ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( this.overlay ) {\n\t\t\tvar overlays = this.document.data( \"ui-dialog-overlays\" ) - 1;\n\n\t\t\tif ( !overlays ) {\n\t\t\t\tthis.document\n\t\t\t\t\t.unbind( \"focusin\" )\n\t\t\t\t\t.removeData( \"ui-dialog-overlays\" );\n\t\t\t} else {\n\t\t\t\tthis.document.data( \"ui-dialog-overlays\", overlays );\n\t\t\t}\n\n\t\t\tthis.overlay.remove();\n\t\t\tthis.overlay = null;\n\t\t}\n\t}\n});\n\n\n/*!\n * jQuery UI Droppable 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/droppable/\n */\n\n\n$.widget( \"ui.droppable\", {\n\tversion: \"1.11.4\",\n\twidgetEventPrefix: \"drop\",\n\toptions: {\n\t\taccept: \"*\",\n\t\tactiveClass: false,\n\t\taddClasses: true,\n\t\tgreedy: false,\n\t\thoverClass: false,\n\t\tscope: \"default\",\n\t\ttolerance: \"intersect\",\n\n\t\t// callbacks\n\t\tactivate: null,\n\t\tdeactivate: null,\n\t\tdrop: null,\n\t\tout: null,\n\t\tover: null\n\t},\n\t_create: function() {\n\n\t\tvar proportions,\n\t\t\to = this.options,\n\t\t\taccept = o.accept;\n\n\t\tthis.isover = false;\n\t\tthis.isout = true;\n\n\t\tthis.accept = $.isFunction( accept ) ? accept : function( d ) {\n\t\t\treturn d.is( accept );\n\t\t};\n\n\t\tthis.proportions = function( /* valueToWrite */ ) {\n\t\t\tif ( arguments.length ) {\n\t\t\t\t// Store the droppable's proportions\n\t\t\t\tproportions = arguments[ 0 ];\n\t\t\t} else {\n\t\t\t\t// Retrieve or derive the droppable's proportions\n\t\t\t\treturn proportions ?\n\t\t\t\t\tproportions :\n\t\t\t\t\tproportions = {\n\t\t\t\t\t\twidth: this.element[ 0 ].offsetWidth,\n\t\t\t\t\t\theight: this.element[ 0 ].offsetHeight\n\t\t\t\t\t};\n\t\t\t}\n\t\t};\n\n\t\tthis._addToManager( o.scope );\n\n\t\to.addClasses && this.element.addClass( \"ui-droppable\" );\n\n\t},\n\n\t_addToManager: function( scope ) {\n\t\t// Add the reference and positions to the manager\n\t\t$.ui.ddmanager.droppables[ scope ] = $.ui.ddmanager.droppables[ scope ] || [];\n\t\t$.ui.ddmanager.droppables[ scope ].push( this );\n\t},\n\n\t_splice: function( drop ) {\n\t\tvar i = 0;\n\t\tfor ( ; i < drop.length; i++ ) {\n\t\t\tif ( drop[ i ] === this ) {\n\t\t\t\tdrop.splice( i, 1 );\n\t\t\t}\n\t\t}\n\t},\n\n\t_destroy: function() {\n\t\tvar drop = $.ui.ddmanager.droppables[ this.options.scope ];\n\n\t\tthis._splice( drop );\n\n\t\tthis.element.removeClass( \"ui-droppable ui-droppable-disabled\" );\n\t},\n\n\t_setOption: function( key, value ) {\n\n\t\tif ( key === \"accept\" ) {\n\t\t\tthis.accept = $.isFunction( value ) ? value : function( d ) {\n\t\t\t\treturn d.is( value );\n\t\t\t};\n\t\t} else if ( key === \"scope\" ) {\n\t\t\tvar drop = $.ui.ddmanager.droppables[ this.options.scope ];\n\n\t\t\tthis._splice( drop );\n\t\t\tthis._addToManager( value );\n\t\t}\n\n\t\tthis._super( key, value );\n\t},\n\n\t_activate: function( event ) {\n\t\tvar draggable = $.ui.ddmanager.current;\n\t\tif ( this.options.activeClass ) {\n\t\t\tthis.element.addClass( this.options.activeClass );\n\t\t}\n\t\tif ( draggable ){\n\t\t\tthis._trigger( \"activate\", event, this.ui( draggable ) );\n\t\t}\n\t},\n\n\t_deactivate: function( event ) {\n\t\tvar draggable = $.ui.ddmanager.current;\n\t\tif ( this.options.activeClass ) {\n\t\t\tthis.element.removeClass( this.options.activeClass );\n\t\t}\n\t\tif ( draggable ){\n\t\t\tthis._trigger( \"deactivate\", event, this.ui( draggable ) );\n\t\t}\n\t},\n\n\t_over: function( event ) {\n\n\t\tvar draggable = $.ui.ddmanager.current;\n\n\t\t// Bail if draggable and droppable are same element\n\t\tif ( !draggable || ( draggable.currentItem || draggable.element )[ 0 ] === this.element[ 0 ] ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( this.accept.call( this.element[ 0 ], ( draggable.currentItem || draggable.element ) ) ) {\n\t\t\tif ( this.options.hoverClass ) {\n\t\t\t\tthis.element.addClass( this.options.hoverClass );\n\t\t\t}\n\t\t\tthis._trigger( \"over\", event, this.ui( draggable ) );\n\t\t}\n\n\t},\n\n\t_out: function( event ) {\n\n\t\tvar draggable = $.ui.ddmanager.current;\n\n\t\t// Bail if draggable and droppable are same element\n\t\tif ( !draggable || ( draggable.currentItem || draggable.element )[ 0 ] === this.element[ 0 ] ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( this.accept.call( this.element[ 0 ], ( draggable.currentItem || draggable.element ) ) ) {\n\t\t\tif ( this.options.hoverClass ) {\n\t\t\t\tthis.element.removeClass( this.options.hoverClass );\n\t\t\t}\n\t\t\tthis._trigger( \"out\", event, this.ui( draggable ) );\n\t\t}\n\n\t},\n\n\t_drop: function( event, custom ) {\n\n\t\tvar draggable = custom || $.ui.ddmanager.current,\n\t\t\tchildrenIntersection = false;\n\n\t\t// Bail if draggable and droppable are same element\n\t\tif ( !draggable || ( draggable.currentItem || draggable.element )[ 0 ] === this.element[ 0 ] ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.element.find( \":data(ui-droppable)\" ).not( \".ui-draggable-dragging\" ).each(function() {\n\t\t\tvar inst = $( this ).droppable( \"instance\" );\n\t\t\tif (\n\t\t\t\tinst.options.greedy &&\n\t\t\t\t!inst.options.disabled &&\n\t\t\t\tinst.options.scope === draggable.options.scope &&\n\t\t\t\tinst.accept.call( inst.element[ 0 ], ( draggable.currentItem || draggable.element ) ) &&\n\t\t\t\t$.ui.intersect( draggable, $.extend( inst, { offset: inst.element.offset() } ), inst.options.tolerance, event )\n\t\t\t) { childrenIntersection = true; return false; }\n\t\t});\n\t\tif ( childrenIntersection ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif ( this.accept.call( this.element[ 0 ], ( draggable.currentItem || draggable.element ) ) ) {\n\t\t\tif ( this.options.activeClass ) {\n\t\t\t\tthis.element.removeClass( this.options.activeClass );\n\t\t\t}\n\t\t\tif ( this.options.hoverClass ) {\n\t\t\t\tthis.element.removeClass( this.options.hoverClass );\n\t\t\t}\n\t\t\tthis._trigger( \"drop\", event, this.ui( draggable ) );\n\t\t\treturn this.element;\n\t\t}\n\n\t\treturn false;\n\n\t},\n\n\tui: function( c ) {\n\t\treturn {\n\t\t\tdraggable: ( c.currentItem || c.element ),\n\t\t\thelper: c.helper,\n\t\t\tposition: c.position,\n\t\t\toffset: c.positionAbs\n\t\t};\n\t}\n\n});\n\n$.ui.intersect = (function() {\n\tfunction isOverAxis( x, reference, size ) {\n\t\treturn ( x >= reference ) && ( x < ( reference + size ) );\n\t}\n\n\treturn function( draggable, droppable, toleranceMode, event ) {\n\n\t\tif ( !droppable.offset ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar x1 = ( draggable.positionAbs || draggable.position.absolute ).left + draggable.margins.left,\n\t\t\ty1 = ( draggable.positionAbs || draggable.position.absolute ).top + draggable.margins.top,\n\t\t\tx2 = x1 + draggable.helperProportions.width,\n\t\t\ty2 = y1 + draggable.helperProportions.height,\n\t\t\tl = droppable.offset.left,\n\t\t\tt = droppable.offset.top,\n\t\t\tr = l + droppable.proportions().width,\n\t\t\tb = t + droppable.proportions().height;\n\n\t\tswitch ( toleranceMode ) {\n\t\tcase \"fit\":\n\t\t\treturn ( l <= x1 && x2 <= r && t <= y1 && y2 <= b );\n\t\tcase \"intersect\":\n\t\t\treturn ( l < x1 + ( draggable.helperProportions.width / 2 ) && // Right Half\n\t\t\t\tx2 - ( draggable.helperProportions.width / 2 ) < r && // Left Half\n\t\t\t\tt < y1 + ( draggable.helperProportions.height / 2 ) && // Bottom Half\n\t\t\t\ty2 - ( draggable.helperProportions.height / 2 ) < b ); // Top Half\n\t\tcase \"pointer\":\n\t\t\treturn isOverAxis( event.pageY, t, droppable.proportions().height ) && isOverAxis( event.pageX, l, droppable.proportions().width );\n\t\tcase \"touch\":\n\t\t\treturn (\n\t\t\t\t( y1 >= t && y1 <= b ) || // Top edge touching\n\t\t\t\t( y2 >= t && y2 <= b ) || // Bottom edge touching\n\t\t\t\t( y1 < t && y2 > b ) // Surrounded vertically\n\t\t\t) && (\n\t\t\t\t( x1 >= l && x1 <= r ) || // Left edge touching\n\t\t\t\t( x2 >= l && x2 <= r ) || // Right edge touching\n\t\t\t\t( x1 < l && x2 > r ) // Surrounded horizontally\n\t\t\t);\n\t\tdefault:\n\t\t\treturn false;\n\t\t}\n\t};\n})();\n\n/*\n\tThis manager tracks offsets of draggables and droppables\n*/\n$.ui.ddmanager = {\n\tcurrent: null,\n\tdroppables: { \"default\": [] },\n\tprepareOffsets: function( t, event ) {\n\n\t\tvar i, j,\n\t\t\tm = $.ui.ddmanager.droppables[ t.options.scope ] || [],\n\t\t\ttype = event ? event.type : null, // workaround for #2317\n\t\t\tlist = ( t.currentItem || t.element ).find( \":data(ui-droppable)\" ).addBack();\n\n\t\tdroppablesLoop: for ( i = 0; i < m.length; i++ ) {\n\n\t\t\t// No disabled and non-accepted\n\t\t\tif ( m[ i ].options.disabled || ( t && !m[ i ].accept.call( m[ i ].element[ 0 ], ( t.currentItem || t.element ) ) ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Filter out elements in the current dragged item\n\t\t\tfor ( j = 0; j < list.length; j++ ) {\n\t\t\t\tif ( list[ j ] === m[ i ].element[ 0 ] ) {\n\t\t\t\t\tm[ i ].proportions().height = 0;\n\t\t\t\t\tcontinue droppablesLoop;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tm[ i ].visible = m[ i ].element.css( \"display\" ) !== \"none\";\n\t\t\tif ( !m[ i ].visible ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Activate the droppable if used directly from draggables\n\t\t\tif ( type === \"mousedown\" ) {\n\t\t\t\tm[ i ]._activate.call( m[ i ], event );\n\t\t\t}\n\n\t\t\tm[ i ].offset = m[ i ].element.offset();\n\t\t\tm[ i ].proportions({ width: m[ i ].element[ 0 ].offsetWidth, height: m[ i ].element[ 0 ].offsetHeight });\n\n\t\t}\n\n\t},\n\tdrop: function( draggable, event ) {\n\n\t\tvar dropped = false;\n\t\t// Create a copy of the droppables in case the list changes during the drop (#9116)\n\t\t$.each( ( $.ui.ddmanager.droppables[ draggable.options.scope ] || [] ).slice(), function() {\n\n\t\t\tif ( !this.options ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif ( !this.options.disabled && this.visible && $.ui.intersect( draggable, this, this.options.tolerance, event ) ) {\n\t\t\t\tdropped = this._drop.call( this, event ) || dropped;\n\t\t\t}\n\n\t\t\tif ( !this.options.disabled && this.visible && this.accept.call( this.element[ 0 ], ( draggable.currentItem || draggable.element ) ) ) {\n\t\t\t\tthis.isout = true;\n\t\t\t\tthis.isover = false;\n\t\t\t\tthis._deactivate.call( this, event );\n\t\t\t}\n\n\t\t});\n\t\treturn dropped;\n\n\t},\n\tdragStart: function( draggable, event ) {\n\t\t// Listen for scrolling so that if the dragging causes scrolling the position of the droppables can be recalculated (see #5003)\n\t\tdraggable.element.parentsUntil( \"body\" ).bind( \"scroll.droppable\", function() {\n\t\t\tif ( !draggable.options.refreshPositions ) {\n\t\t\t\t$.ui.ddmanager.prepareOffsets( draggable, event );\n\t\t\t}\n\t\t});\n\t},\n\tdrag: function( draggable, event ) {\n\n\t\t// If you have a highly dynamic page, you might try this option. It renders positions every time you move the mouse.\n\t\tif ( draggable.options.refreshPositions ) {\n\t\t\t$.ui.ddmanager.prepareOffsets( draggable, event );\n\t\t}\n\n\t\t// Run through all droppables and check their positions based on specific tolerance options\n\t\t$.each( $.ui.ddmanager.droppables[ draggable.options.scope ] || [], function() {\n\n\t\t\tif ( this.options.disabled || this.greedyChild || !this.visible ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar parentInstance, scope, parent,\n\t\t\t\tintersects = $.ui.intersect( draggable, this, this.options.tolerance, event ),\n\t\t\t\tc = !intersects && this.isover ? \"isout\" : ( intersects && !this.isover ? \"isover\" : null );\n\t\t\tif ( !c ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( this.options.greedy ) {\n\t\t\t\t// find droppable parents with same scope\n\t\t\t\tscope = this.options.scope;\n\t\t\t\tparent = this.element.parents( \":data(ui-droppable)\" ).filter(function() {\n\t\t\t\t\treturn $( this ).droppable( \"instance\" ).options.scope === scope;\n\t\t\t\t});\n\n\t\t\t\tif ( parent.length ) {\n\t\t\t\t\tparentInstance = $( parent[ 0 ] ).droppable( \"instance\" );\n\t\t\t\t\tparentInstance.greedyChild = ( c === \"isover\" );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// we just moved into a greedy child\n\t\t\tif ( parentInstance && c === \"isover\" ) {\n\t\t\t\tparentInstance.isover = false;\n\t\t\t\tparentInstance.isout = true;\n\t\t\t\tparentInstance._out.call( parentInstance, event );\n\t\t\t}\n\n\t\t\tthis[ c ] = true;\n\t\t\tthis[c === \"isout\" ? \"isover\" : \"isout\"] = false;\n\t\t\tthis[c === \"isover\" ? \"_over\" : \"_out\"].call( this, event );\n\n\t\t\t// we just moved out of a greedy child\n\t\t\tif ( parentInstance && c === \"isout\" ) {\n\t\t\t\tparentInstance.isout = false;\n\t\t\t\tparentInstance.isover = true;\n\t\t\t\tparentInstance._over.call( parentInstance, event );\n\t\t\t}\n\t\t});\n\n\t},\n\tdragStop: function( draggable, event ) {\n\t\tdraggable.element.parentsUntil( \"body\" ).unbind( \"scroll.droppable\" );\n\t\t// Call prepareOffsets one final time since IE does not fire return scroll events when overflow was caused by drag (see #5003)\n\t\tif ( !draggable.options.refreshPositions ) {\n\t\t\t$.ui.ddmanager.prepareOffsets( draggable, event );\n\t\t}\n\t}\n};\n\nvar droppable = $.ui.droppable;\n\n\n/*!\n * jQuery UI Effects 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/category/effects-core/\n */\n\n\nvar dataSpace = \"ui-effects-\",\n\n\t// Create a local jQuery because jQuery Color relies on it and the\n\t// global may not exist with AMD and a custom build (#10199)\n\tjQuery = $;\n\n$.effects = {\n\teffect: {}\n};\n\n/*!\n * jQuery Color Animations v2.1.2\n * https://github.com/jquery/jquery-color\n *\n * Copyright 2014 jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * Date: Wed Jan 16 08:47:09 2013 -0600\n */\n(function( jQuery, undefined ) {\n\n\tvar stepHooks = \"backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor\",\n\n\t// plusequals test for += 100 -= 100\n\trplusequals = /^([\\-+])=\\s*(\\d+\\.?\\d*)/,\n\t// a set of RE's that can match strings and generate color tuples.\n\tstringParsers = [ {\n\t\t\tre: /rgba?\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*(?:,\\s*(\\d?(?:\\.\\d+)?)\\s*)?\\)/,\n\t\t\tparse: function( execResult ) {\n\t\t\t\treturn [\n\t\t\t\t\texecResult[ 1 ],\n\t\t\t\t\texecResult[ 2 ],\n\t\t\t\t\texecResult[ 3 ],\n\t\t\t\t\texecResult[ 4 ]\n\t\t\t\t];\n\t\t\t}\n\t\t}, {\n\t\t\tre: /rgba?\\(\\s*(\\d+(?:\\.\\d+)?)\\%\\s*,\\s*(\\d+(?:\\.\\d+)?)\\%\\s*,\\s*(\\d+(?:\\.\\d+)?)\\%\\s*(?:,\\s*(\\d?(?:\\.\\d+)?)\\s*)?\\)/,\n\t\t\tparse: function( execResult ) {\n\t\t\t\treturn [\n\t\t\t\t\texecResult[ 1 ] * 2.55,\n\t\t\t\t\texecResult[ 2 ] * 2.55,\n\t\t\t\t\texecResult[ 3 ] * 2.55,\n\t\t\t\t\texecResult[ 4 ]\n\t\t\t\t];\n\t\t\t}\n\t\t}, {\n\t\t\t// this regex ignores A-F because it's compared against an already lowercased string\n\t\t\tre: /#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,\n\t\t\tparse: function( execResult ) {\n\t\t\t\treturn [\n\t\t\t\t\tparseInt( execResult[ 1 ], 16 ),\n\t\t\t\t\tparseInt( execResult[ 2 ], 16 ),\n\t\t\t\t\tparseInt( execResult[ 3 ], 16 )\n\t\t\t\t];\n\t\t\t}\n\t\t}, {\n\t\t\t// this regex ignores A-F because it's compared against an already lowercased string\n\t\t\tre: /#([a-f0-9])([a-f0-9])([a-f0-9])/,\n\t\t\tparse: function( execResult ) {\n\t\t\t\treturn [\n\t\t\t\t\tparseInt( execResult[ 1 ] + execResult[ 1 ], 16 ),\n\t\t\t\t\tparseInt( execResult[ 2 ] + execResult[ 2 ], 16 ),\n\t\t\t\t\tparseInt( execResult[ 3 ] + execResult[ 3 ], 16 )\n\t\t\t\t];\n\t\t\t}\n\t\t}, {\n\t\t\tre: /hsla?\\(\\s*(\\d+(?:\\.\\d+)?)\\s*,\\s*(\\d+(?:\\.\\d+)?)\\%\\s*,\\s*(\\d+(?:\\.\\d+)?)\\%\\s*(?:,\\s*(\\d?(?:\\.\\d+)?)\\s*)?\\)/,\n\t\t\tspace: \"hsla\",\n\t\t\tparse: function( execResult ) {\n\t\t\t\treturn [\n\t\t\t\t\texecResult[ 1 ],\n\t\t\t\t\texecResult[ 2 ] / 100,\n\t\t\t\t\texecResult[ 3 ] / 100,\n\t\t\t\t\texecResult[ 4 ]\n\t\t\t\t];\n\t\t\t}\n\t\t} ],\n\n\t// jQuery.Color( )\n\tcolor = jQuery.Color = function( color, green, blue, alpha ) {\n\t\treturn new jQuery.Color.fn.parse( color, green, blue, alpha );\n\t},\n\tspaces = {\n\t\trgba: {\n\t\t\tprops: {\n\t\t\t\tred: {\n\t\t\t\t\tidx: 0,\n\t\t\t\t\ttype: \"byte\"\n\t\t\t\t},\n\t\t\t\tgreen: {\n\t\t\t\t\tidx: 1,\n\t\t\t\t\ttype: \"byte\"\n\t\t\t\t},\n\t\t\t\tblue: {\n\t\t\t\t\tidx: 2,\n\t\t\t\t\ttype: \"byte\"\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\thsla: {\n\t\t\tprops: {\n\t\t\t\thue: {\n\t\t\t\t\tidx: 0,\n\t\t\t\t\ttype: \"degrees\"\n\t\t\t\t},\n\t\t\t\tsaturation: {\n\t\t\t\t\tidx: 1,\n\t\t\t\t\ttype: \"percent\"\n\t\t\t\t},\n\t\t\t\tlightness: {\n\t\t\t\t\tidx: 2,\n\t\t\t\t\ttype: \"percent\"\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\tpropTypes = {\n\t\t\"byte\": {\n\t\t\tfloor: true,\n\t\t\tmax: 255\n\t\t},\n\t\t\"percent\": {\n\t\t\tmax: 1\n\t\t},\n\t\t\"degrees\": {\n\t\t\tmod: 360,\n\t\t\tfloor: true\n\t\t}\n\t},\n\tsupport = color.support = {},\n\n\t// element for support tests\n\tsupportElem = jQuery( \"<p>\" )[ 0 ],\n\n\t// colors = jQuery.Color.names\n\tcolors,\n\n\t// local aliases of functions called often\n\teach = jQuery.each;\n\n// determine rgba support immediately\nsupportElem.style.cssText = \"background-color:rgba(1,1,1,.5)\";\nsupport.rgba = supportElem.style.backgroundColor.indexOf( \"rgba\" ) > -1;\n\n// define cache name and alpha properties\n// for rgba and hsla spaces\neach( spaces, function( spaceName, space ) {\n\tspace.cache = \"_\" + spaceName;\n\tspace.props.alpha = {\n\t\tidx: 3,\n\t\ttype: \"percent\",\n\t\tdef: 1\n\t};\n});\n\nfunction clamp( value, prop, allowEmpty ) {\n\tvar type = propTypes[ prop.type ] || {};\n\n\tif ( value == null ) {\n\t\treturn (allowEmpty || !prop.def) ? null : prop.def;\n\t}\n\n\t// ~~ is an short way of doing floor for positive numbers\n\tvalue = type.floor ? ~~value : parseFloat( value );\n\n\t// IE will pass in empty strings as value for alpha,\n\t// which will hit this case\n\tif ( isNaN( value ) ) {\n\t\treturn prop.def;\n\t}\n\n\tif ( type.mod ) {\n\t\t// we add mod before modding to make sure that negatives values\n\t\t// get converted properly: -10 -> 350\n\t\treturn (value + type.mod) % type.mod;\n\t}\n\n\t// for now all property types without mod have min and max\n\treturn 0 > value ? 0 : type.max < value ? type.max : value;\n}\n\nfunction stringParse( string ) {\n\tvar inst = color(),\n\t\trgba = inst._rgba = [];\n\n\tstring = string.toLowerCase();\n\n\teach( stringParsers, function( i, parser ) {\n\t\tvar parsed,\n\t\t\tmatch = parser.re.exec( string ),\n\t\t\tvalues = match && parser.parse( match ),\n\t\t\tspaceName = parser.space || \"rgba\";\n\n\t\tif ( values ) {\n\t\t\tparsed = inst[ spaceName ]( values );\n\n\t\t\t// if this was an rgba parse the assignment might happen twice\n\t\t\t// oh well....\n\t\t\tinst[ spaces[ spaceName ].cache ] = parsed[ spaces[ spaceName ].cache ];\n\t\t\trgba = inst._rgba = parsed._rgba;\n\n\t\t\t// exit each( stringParsers ) here because we matched\n\t\t\treturn false;\n\t\t}\n\t});\n\n\t// Found a stringParser that handled it\n\tif ( rgba.length ) {\n\n\t\t// if this came from a parsed string, force \"transparent\" when alpha is 0\n\t\t// chrome, (and maybe others) return \"transparent\" as rgba(0,0,0,0)\n\t\tif ( rgba.join() === \"0,0,0,0\" ) {\n\t\t\tjQuery.extend( rgba, colors.transparent );\n\t\t}\n\t\treturn inst;\n\t}\n\n\t// named colors\n\treturn colors[ string ];\n}\n\ncolor.fn = jQuery.extend( color.prototype, {\n\tparse: function( red, green, blue, alpha ) {\n\t\tif ( red === undefined ) {\n\t\t\tthis._rgba = [ null, null, null, null ];\n\t\t\treturn this;\n\t\t}\n\t\tif ( red.jquery || red.nodeType ) {\n\t\t\tred = jQuery( red ).css( green );\n\t\t\tgreen = undefined;\n\t\t}\n\n\t\tvar inst = this,\n\t\t\ttype = jQuery.type( red ),\n\t\t\trgba = this._rgba = [];\n\n\t\t// more than 1 argument specified - assume ( red, green, blue, alpha )\n\t\tif ( green !== undefined ) {\n\t\t\tred = [ red, green, blue, alpha ];\n\t\t\ttype = \"array\";\n\t\t}\n\n\t\tif ( type === \"string\" ) {\n\t\t\treturn this.parse( stringParse( red ) || colors._default );\n\t\t}\n\n\t\tif ( type === \"array\" ) {\n\t\t\teach( spaces.rgba.props, function( key, prop ) {\n\t\t\t\trgba[ prop.idx ] = clamp( red[ prop.idx ], prop );\n\t\t\t});\n\t\t\treturn this;\n\t\t}\n\n\t\tif ( type === \"object\" ) {\n\t\t\tif ( red instanceof color ) {\n\t\t\t\teach( spaces, function( spaceName, space ) {\n\t\t\t\t\tif ( red[ space.cache ] ) {\n\t\t\t\t\t\tinst[ space.cache ] = red[ space.cache ].slice();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\teach( spaces, function( spaceName, space ) {\n\t\t\t\t\tvar cache = space.cache;\n\t\t\t\t\teach( space.props, function( key, prop ) {\n\n\t\t\t\t\t\t// if the cache doesn't exist, and we know how to convert\n\t\t\t\t\t\tif ( !inst[ cache ] && space.to ) {\n\n\t\t\t\t\t\t\t// if the value was null, we don't need to copy it\n\t\t\t\t\t\t\t// if the key was alpha, we don't need to copy it either\n\t\t\t\t\t\t\tif ( key === \"alpha\" || red[ key ] == null ) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tinst[ cache ] = space.to( inst._rgba );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// this is the only case where we allow nulls for ALL properties.\n\t\t\t\t\t\t// call clamp with alwaysAllowEmpty\n\t\t\t\t\t\tinst[ cache ][ prop.idx ] = clamp( red[ key ], prop, true );\n\t\t\t\t\t});\n\n\t\t\t\t\t// everything defined but alpha?\n\t\t\t\t\tif ( inst[ cache ] && jQuery.inArray( null, inst[ cache ].slice( 0, 3 ) ) < 0 ) {\n\t\t\t\t\t\t// use the default of 1\n\t\t\t\t\t\tinst[ cache ][ 3 ] = 1;\n\t\t\t\t\t\tif ( space.from ) {\n\t\t\t\t\t\t\tinst._rgba = space.from( inst[ cache ] );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn this;\n\t\t}\n\t},\n\tis: function( compare ) {\n\t\tvar is = color( compare ),\n\t\t\tsame = true,\n\t\t\tinst = this;\n\n\t\teach( spaces, function( _, space ) {\n\t\t\tvar localCache,\n\t\t\t\tisCache = is[ space.cache ];\n\t\t\tif (isCache) {\n\t\t\t\tlocalCache = inst[ space.cache ] || space.to && space.to( inst._rgba ) || [];\n\t\t\t\teach( space.props, function( _, prop ) {\n\t\t\t\t\tif ( isCache[ prop.idx ] != null ) {\n\t\t\t\t\t\tsame = ( isCache[ prop.idx ] === localCache[ prop.idx ] );\n\t\t\t\t\t\treturn same;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn same;\n\t\t});\n\t\treturn same;\n\t},\n\t_space: function() {\n\t\tvar used = [],\n\t\t\tinst = this;\n\t\teach( spaces, function( spaceName, space ) {\n\t\t\tif ( inst[ space.cache ] ) {\n\t\t\t\tused.push( spaceName );\n\t\t\t}\n\t\t});\n\t\treturn used.pop();\n\t},\n\ttransition: function( other, distance ) {\n\t\tvar end = color( other ),\n\t\t\tspaceName = end._space(),\n\t\t\tspace = spaces[ spaceName ],\n\t\t\tstartColor = this.alpha() === 0 ? color( \"transparent\" ) : this,\n\t\t\tstart = startColor[ space.cache ] || space.to( startColor._rgba ),\n\t\t\tresult = start.slice();\n\n\t\tend = end[ space.cache ];\n\t\teach( space.props, function( key, prop ) {\n\t\t\tvar index = prop.idx,\n\t\t\t\tstartValue = start[ index ],\n\t\t\t\tendValue = end[ index ],\n\t\t\t\ttype = propTypes[ prop.type ] || {};\n\n\t\t\t// if null, don't override start value\n\t\t\tif ( endValue === null ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// if null - use end\n\t\t\tif ( startValue === null ) {\n\t\t\t\tresult[ index ] = endValue;\n\t\t\t} else {\n\t\t\t\tif ( type.mod ) {\n\t\t\t\t\tif ( endValue - startValue > type.mod / 2 ) {\n\t\t\t\t\t\tstartValue += type.mod;\n\t\t\t\t\t} else if ( startValue - endValue > type.mod / 2 ) {\n\t\t\t\t\t\tstartValue -= type.mod;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tresult[ index ] = clamp( ( endValue - startValue ) * distance + startValue, prop );\n\t\t\t}\n\t\t});\n\t\treturn this[ spaceName ]( result );\n\t},\n\tblend: function( opaque ) {\n\t\t// if we are already opaque - return ourself\n\t\tif ( this._rgba[ 3 ] === 1 ) {\n\t\t\treturn this;\n\t\t}\n\n\t\tvar rgb = this._rgba.slice(),\n\t\t\ta = rgb.pop(),\n\t\t\tblend = color( opaque )._rgba;\n\n\t\treturn color( jQuery.map( rgb, function( v, i ) {\n\t\t\treturn ( 1 - a ) * blend[ i ] + a * v;\n\t\t}));\n\t},\n\ttoRgbaString: function() {\n\t\tvar prefix = \"rgba(\",\n\t\t\trgba = jQuery.map( this._rgba, function( v, i ) {\n\t\t\t\treturn v == null ? ( i > 2 ? 1 : 0 ) : v;\n\t\t\t});\n\n\t\tif ( rgba[ 3 ] === 1 ) {\n\t\t\trgba.pop();\n\t\t\tprefix = \"rgb(\";\n\t\t}\n\n\t\treturn prefix + rgba.join() + \")\";\n\t},\n\ttoHslaString: function() {\n\t\tvar prefix = \"hsla(\",\n\t\t\thsla = jQuery.map( this.hsla(), function( v, i ) {\n\t\t\t\tif ( v == null ) {\n\t\t\t\t\tv = i > 2 ? 1 : 0;\n\t\t\t\t}\n\n\t\t\t\t// catch 1 and 2\n\t\t\t\tif ( i && i < 3 ) {\n\t\t\t\t\tv = Math.round( v * 100 ) + \"%\";\n\t\t\t\t}\n\t\t\t\treturn v;\n\t\t\t});\n\n\t\tif ( hsla[ 3 ] === 1 ) {\n\t\t\thsla.pop();\n\t\t\tprefix = \"hsl(\";\n\t\t}\n\t\treturn prefix + hsla.join() + \")\";\n\t},\n\ttoHexString: function( includeAlpha ) {\n\t\tvar rgba = this._rgba.slice(),\n\t\t\talpha = rgba.pop();\n\n\t\tif ( includeAlpha ) {\n\t\t\trgba.push( ~~( alpha * 255 ) );\n\t\t}\n\n\t\treturn \"#\" + jQuery.map( rgba, function( v ) {\n\n\t\t\t// default to 0 when nulls exist\n\t\t\tv = ( v || 0 ).toString( 16 );\n\t\t\treturn v.length === 1 ? \"0\" + v : v;\n\t\t}).join(\"\");\n\t},\n\ttoString: function() {\n\t\treturn this._rgba[ 3 ] === 0 ? \"transparent\" : this.toRgbaString();\n\t}\n});\ncolor.fn.parse.prototype = color.fn;\n\n// hsla conversions adapted from:\n// https://code.google.com/p/maashaack/source/browse/packages/graphics/trunk/src/graphics/colors/HUE2RGB.as?r=5021\n\nfunction hue2rgb( p, q, h ) {\n\th = ( h + 1 ) % 1;\n\tif ( h * 6 < 1 ) {\n\t\treturn p + ( q - p ) * h * 6;\n\t}\n\tif ( h * 2 < 1) {\n\t\treturn q;\n\t}\n\tif ( h * 3 < 2 ) {\n\t\treturn p + ( q - p ) * ( ( 2 / 3 ) - h ) * 6;\n\t}\n\treturn p;\n}\n\nspaces.hsla.to = function( rgba ) {\n\tif ( rgba[ 0 ] == null || rgba[ 1 ] == null || rgba[ 2 ] == null ) {\n\t\treturn [ null, null, null, rgba[ 3 ] ];\n\t}\n\tvar r = rgba[ 0 ] / 255,\n\t\tg = rgba[ 1 ] / 255,\n\t\tb = rgba[ 2 ] / 255,\n\t\ta = rgba[ 3 ],\n\t\tmax = Math.max( r, g, b ),\n\t\tmin = Math.min( r, g, b ),\n\t\tdiff = max - min,\n\t\tadd = max + min,\n\t\tl = add * 0.5,\n\t\th, s;\n\n\tif ( min === max ) {\n\t\th = 0;\n\t} else if ( r === max ) {\n\t\th = ( 60 * ( g - b ) / diff ) + 360;\n\t} else if ( g === max ) {\n\t\th = ( 60 * ( b - r ) / diff ) + 120;\n\t} else {\n\t\th = ( 60 * ( r - g ) / diff ) + 240;\n\t}\n\n\t// chroma (diff) == 0 means greyscale which, by definition, saturation = 0%\n\t// otherwise, saturation is based on the ratio of chroma (diff) to lightness (add)\n\tif ( diff === 0 ) {\n\t\ts = 0;\n\t} else if ( l <= 0.5 ) {\n\t\ts = diff / add;\n\t} else {\n\t\ts = diff / ( 2 - add );\n\t}\n\treturn [ Math.round(h) % 360, s, l, a == null ? 1 : a ];\n};\n\nspaces.hsla.from = function( hsla ) {\n\tif ( hsla[ 0 ] == null || hsla[ 1 ] == null || hsla[ 2 ] == null ) {\n\t\treturn [ null, null, null, hsla[ 3 ] ];\n\t}\n\tvar h = hsla[ 0 ] / 360,\n\t\ts = hsla[ 1 ],\n\t\tl = hsla[ 2 ],\n\t\ta = hsla[ 3 ],\n\t\tq = l <= 0.5 ? l * ( 1 + s ) : l + s - l * s,\n\t\tp = 2 * l - q;\n\n\treturn [\n\t\tMath.round( hue2rgb( p, q, h + ( 1 / 3 ) ) * 255 ),\n\t\tMath.round( hue2rgb( p, q, h ) * 255 ),\n\t\tMath.round( hue2rgb( p, q, h - ( 1 / 3 ) ) * 255 ),\n\t\ta\n\t];\n};\n\neach( spaces, function( spaceName, space ) {\n\tvar props = space.props,\n\t\tcache = space.cache,\n\t\tto = space.to,\n\t\tfrom = space.from;\n\n\t// makes rgba() and hsla()\n\tcolor.fn[ spaceName ] = function( value ) {\n\n\t\t// generate a cache for this space if it doesn't exist\n\t\tif ( to && !this[ cache ] ) {\n\t\t\tthis[ cache ] = to( this._rgba );\n\t\t}\n\t\tif ( value === undefined ) {\n\t\t\treturn this[ cache ].slice();\n\t\t}\n\n\t\tvar ret,\n\t\t\ttype = jQuery.type( value ),\n\t\t\tarr = ( type === \"array\" || type === \"object\" ) ? value : arguments,\n\t\t\tlocal = this[ cache ].slice();\n\n\t\teach( props, function( key, prop ) {\n\t\t\tvar val = arr[ type === \"object\" ? key : prop.idx ];\n\t\t\tif ( val == null ) {\n\t\t\t\tval = local[ prop.idx ];\n\t\t\t}\n\t\t\tlocal[ prop.idx ] = clamp( val, prop );\n\t\t});\n\n\t\tif ( from ) {\n\t\t\tret = color( from( local ) );\n\t\t\tret[ cache ] = local;\n\t\t\treturn ret;\n\t\t} else {\n\t\t\treturn color( local );\n\t\t}\n\t};\n\n\t// makes red() green() blue() alpha() hue() saturation() lightness()\n\teach( props, function( key, prop ) {\n\t\t// alpha is included in more than one space\n\t\tif ( color.fn[ key ] ) {\n\t\t\treturn;\n\t\t}\n\t\tcolor.fn[ key ] = function( value ) {\n\t\t\tvar vtype = jQuery.type( value ),\n\t\t\t\tfn = ( key === \"alpha\" ? ( this._hsla ? \"hsla\" : \"rgba\" ) : spaceName ),\n\t\t\t\tlocal = this[ fn ](),\n\t\t\t\tcur = local[ prop.idx ],\n\t\t\t\tmatch;\n\n\t\t\tif ( vtype === \"undefined\" ) {\n\t\t\t\treturn cur;\n\t\t\t}\n\n\t\t\tif ( vtype === \"function\" ) {\n\t\t\t\tvalue = value.call( this, cur );\n\t\t\t\tvtype = jQuery.type( value );\n\t\t\t}\n\t\t\tif ( value == null && prop.empty ) {\n\t\t\t\treturn this;\n\t\t\t}\n\t\t\tif ( vtype === \"string\" ) {\n\t\t\t\tmatch = rplusequals.exec( value );\n\t\t\t\tif ( match ) {\n\t\t\t\t\tvalue = cur + parseFloat( match[ 2 ] ) * ( match[ 1 ] === \"+\" ? 1 : -1 );\n\t\t\t\t}\n\t\t\t}\n\t\t\tlocal[ prop.idx ] = value;\n\t\t\treturn this[ fn ]( local );\n\t\t};\n\t});\n});\n\n// add cssHook and .fx.step function for each named hook.\n// accept a space separated string of properties\ncolor.hook = function( hook ) {\n\tvar hooks = hook.split( \" \" );\n\teach( hooks, function( i, hook ) {\n\t\tjQuery.cssHooks[ hook ] = {\n\t\t\tset: function( elem, value ) {\n\t\t\t\tvar parsed, curElem,\n\t\t\t\t\tbackgroundColor = \"\";\n\n\t\t\t\tif ( value !== \"transparent\" && ( jQuery.type( value ) !== \"string\" || ( parsed = stringParse( value ) ) ) ) {\n\t\t\t\t\tvalue = color( parsed || value );\n\t\t\t\t\tif ( !support.rgba && value._rgba[ 3 ] !== 1 ) {\n\t\t\t\t\t\tcurElem = hook === \"backgroundColor\" ? elem.parentNode : elem;\n\t\t\t\t\t\twhile (\n\t\t\t\t\t\t\t(backgroundColor === \"\" || backgroundColor === \"transparent\") &&\n\t\t\t\t\t\t\tcurElem && curElem.style\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tbackgroundColor = jQuery.css( curElem, \"backgroundColor\" );\n\t\t\t\t\t\t\t\tcurElem = curElem.parentNode;\n\t\t\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvalue = value.blend( backgroundColor && backgroundColor !== \"transparent\" ?\n\t\t\t\t\t\t\tbackgroundColor :\n\t\t\t\t\t\t\t\"_default\" );\n\t\t\t\t\t}\n\n\t\t\t\t\tvalue = value.toRgbaString();\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\telem.style[ hook ] = value;\n\t\t\t\t} catch ( e ) {\n\t\t\t\t\t// wrapped to prevent IE from throwing errors on \"invalid\" values like 'auto' or 'inherit'\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tjQuery.fx.step[ hook ] = function( fx ) {\n\t\t\tif ( !fx.colorInit ) {\n\t\t\t\tfx.start = color( fx.elem, hook );\n\t\t\t\tfx.end = color( fx.end );\n\t\t\t\tfx.colorInit = true;\n\t\t\t}\n\t\t\tjQuery.cssHooks[ hook ].set( fx.elem, fx.start.transition( fx.end, fx.pos ) );\n\t\t};\n\t});\n\n};\n\ncolor.hook( stepHooks );\n\njQuery.cssHooks.borderColor = {\n\texpand: function( value ) {\n\t\tvar expanded = {};\n\n\t\teach( [ \"Top\", \"Right\", \"Bottom\", \"Left\" ], function( i, part ) {\n\t\t\texpanded[ \"border\" + part + \"Color\" ] = value;\n\t\t});\n\t\treturn expanded;\n\t}\n};\n\n// Basic color names only.\n// Usage of any of the other color names requires adding yourself or including\n// jquery.color.svg-names.js.\ncolors = jQuery.Color.names = {\n\t// 4.1. Basic color keywords\n\taqua: \"#00ffff\",\n\tblack: \"#000000\",\n\tblue: \"#0000ff\",\n\tfuchsia: \"#ff00ff\",\n\tgray: \"#808080\",\n\tgreen: \"#008000\",\n\tlime: \"#00ff00\",\n\tmaroon: \"#800000\",\n\tnavy: \"#000080\",\n\tolive: \"#808000\",\n\tpurple: \"#800080\",\n\tred: \"#ff0000\",\n\tsilver: \"#c0c0c0\",\n\tteal: \"#008080\",\n\twhite: \"#ffffff\",\n\tyellow: \"#ffff00\",\n\n\t// 4.2.3. \"transparent\" color keyword\n\ttransparent: [ null, null, null, 0 ],\n\n\t_default: \"#ffffff\"\n};\n\n})( jQuery );\n\n/******************************************************************************/\n/****************************** CLASS ANIMATIONS ******************************/\n/******************************************************************************/\n(function() {\n\nvar classAnimationActions = [ \"add\", \"remove\", \"toggle\" ],\n\tshorthandStyles = {\n\t\tborder: 1,\n\t\tborderBottom: 1,\n\t\tborderColor: 1,\n\t\tborderLeft: 1,\n\t\tborderRight: 1,\n\t\tborderTop: 1,\n\t\tborderWidth: 1,\n\t\tmargin: 1,\n\t\tpadding: 1\n\t};\n\n$.each([ \"borderLeftStyle\", \"borderRightStyle\", \"borderBottomStyle\", \"borderTopStyle\" ], function( _, prop ) {\n\t$.fx.step[ prop ] = function( fx ) {\n\t\tif ( fx.end !== \"none\" && !fx.setAttr || fx.pos === 1 && !fx.setAttr ) {\n\t\t\tjQuery.style( fx.elem, prop, fx.end );\n\t\t\tfx.setAttr = true;\n\t\t}\n\t};\n});\n\nfunction getElementStyles( elem ) {\n\tvar key, len,\n\t\tstyle = elem.ownerDocument.defaultView ?\n\t\t\telem.ownerDocument.defaultView.getComputedStyle( elem, null ) :\n\t\t\telem.currentStyle,\n\t\tstyles = {};\n\n\tif ( style && style.length && style[ 0 ] && style[ style[ 0 ] ] ) {\n\t\tlen = style.length;\n\t\twhile ( len-- ) {\n\t\t\tkey = style[ len ];\n\t\t\tif ( typeof style[ key ] === \"string\" ) {\n\t\t\t\tstyles[ $.camelCase( key ) ] = style[ key ];\n\t\t\t}\n\t\t}\n\t// support: Opera, IE <9\n\t} else {\n\t\tfor ( key in style ) {\n\t\t\tif ( typeof style[ key ] === \"string\" ) {\n\t\t\t\tstyles[ key ] = style[ key ];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn styles;\n}\n\nfunction styleDifference( oldStyle, newStyle ) {\n\tvar diff = {},\n\t\tname, value;\n\n\tfor ( name in newStyle ) {\n\t\tvalue = newStyle[ name ];\n\t\tif ( oldStyle[ name ] !== value ) {\n\t\t\tif ( !shorthandStyles[ name ] ) {\n\t\t\t\tif ( $.fx.step[ name ] || !isNaN( parseFloat( value ) ) ) {\n\t\t\t\t\tdiff[ name ] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn diff;\n}\n\n// support: jQuery <1.8\nif ( !$.fn.addBack ) {\n\t$.fn.addBack = function( selector ) {\n\t\treturn this.add( selector == null ?\n\t\t\tthis.prevObject : this.prevObject.filter( selector )\n\t\t);\n\t};\n}\n\n$.effects.animateClass = function( value, duration, easing, callback ) {\n\tvar o = $.speed( duration, easing, callback );\n\n\treturn this.queue( function() {\n\t\tvar animated = $( this ),\n\t\t\tbaseClass = animated.attr( \"class\" ) || \"\",\n\t\t\tapplyClassChange,\n\t\t\tallAnimations = o.children ? animated.find( \"*\" ).addBack() : animated;\n\n\t\t// map the animated objects to store the original styles.\n\t\tallAnimations = allAnimations.map(function() {\n\t\t\tvar el = $( this );\n\t\t\treturn {\n\t\t\t\tel: el,\n\t\t\t\tstart: getElementStyles( this )\n\t\t\t};\n\t\t});\n\n\t\t// apply class change\n\t\tapplyClassChange = function() {\n\t\t\t$.each( classAnimationActions, function(i, action) {\n\t\t\t\tif ( value[ action ] ) {\n\t\t\t\t\tanimated[ action + \"Class\" ]( value[ action ] );\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t\tapplyClassChange();\n\n\t\t// map all animated objects again - calculate new styles and diff\n\t\tallAnimations = allAnimations.map(function() {\n\t\t\tthis.end = getElementStyles( this.el[ 0 ] );\n\t\t\tthis.diff = styleDifference( this.start, this.end );\n\t\t\treturn this;\n\t\t});\n\n\t\t// apply original class\n\t\tanimated.attr( \"class\", baseClass );\n\n\t\t// map all animated objects again - this time collecting a promise\n\t\tallAnimations = allAnimations.map(function() {\n\t\t\tvar styleInfo = this,\n\t\t\t\tdfd = $.Deferred(),\n\t\t\t\topts = $.extend({}, o, {\n\t\t\t\t\tqueue: false,\n\t\t\t\t\tcomplete: function() {\n\t\t\t\t\t\tdfd.resolve( styleInfo );\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\tthis.el.animate( this.diff, opts );\n\t\t\treturn dfd.promise();\n\t\t});\n\n\t\t// once all animations have completed:\n\t\t$.when.apply( $, allAnimations.get() ).done(function() {\n\n\t\t\t// set the final class\n\t\t\tapplyClassChange();\n\n\t\t\t// for each animated element,\n\t\t\t// clear all css properties that were animated\n\t\t\t$.each( arguments, function() {\n\t\t\t\tvar el = this.el;\n\t\t\t\t$.each( this.diff, function(key) {\n\t\t\t\t\tel.css( key, \"\" );\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// this is guarnteed to be there if you use jQuery.speed()\n\t\t\t// it also handles dequeuing the next anim...\n\t\t\to.complete.call( animated[ 0 ] );\n\t\t});\n\t});\n};\n\n$.fn.extend({\n\taddClass: (function( orig ) {\n\t\treturn function( classNames, speed, easing, callback ) {\n\t\t\treturn speed ?\n\t\t\t\t$.effects.animateClass.call( this,\n\t\t\t\t\t{ add: classNames }, speed, easing, callback ) :\n\t\t\t\torig.apply( this, arguments );\n\t\t};\n\t})( $.fn.addClass ),\n\n\tremoveClass: (function( orig ) {\n\t\treturn function( classNames, speed, easing, callback ) {\n\t\t\treturn arguments.length > 1 ?\n\t\t\t\t$.effects.animateClass.call( this,\n\t\t\t\t\t{ remove: classNames }, speed, easing, callback ) :\n\t\t\t\torig.apply( this, arguments );\n\t\t};\n\t})( $.fn.removeClass ),\n\n\ttoggleClass: (function( orig ) {\n\t\treturn function( classNames, force, speed, easing, callback ) {\n\t\t\tif ( typeof force === \"boolean\" || force === undefined ) {\n\t\t\t\tif ( !speed ) {\n\t\t\t\t\t// without speed parameter\n\t\t\t\t\treturn orig.apply( this, arguments );\n\t\t\t\t} else {\n\t\t\t\t\treturn $.effects.animateClass.call( this,\n\t\t\t\t\t\t(force ? { add: classNames } : { remove: classNames }),\n\t\t\t\t\t\tspeed, easing, callback );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// without force parameter\n\t\t\t\treturn $.effects.animateClass.call( this,\n\t\t\t\t\t{ toggle: classNames }, force, speed, easing );\n\t\t\t}\n\t\t};\n\t})( $.fn.toggleClass ),\n\n\tswitchClass: function( remove, add, speed, easing, callback) {\n\t\treturn $.effects.animateClass.call( this, {\n\t\t\tadd: add,\n\t\t\tremove: remove\n\t\t}, speed, easing, callback );\n\t}\n});\n\n})();\n\n/******************************************************************************/\n/*********************************** EFFECTS **********************************/\n/******************************************************************************/\n\n(function() {\n\n$.extend( $.effects, {\n\tversion: \"1.11.4\",\n\n\t// Saves a set of properties in a data storage\n\tsave: function( element, set ) {\n\t\tfor ( var i = 0; i < set.length; i++ ) {\n\t\t\tif ( set[ i ] !== null ) {\n\t\t\t\telement.data( dataSpace + set[ i ], element[ 0 ].style[ set[ i ] ] );\n\t\t\t}\n\t\t}\n\t},\n\n\t// Restores a set of previously saved properties from a data storage\n\trestore: function( element, set ) {\n\t\tvar val, i;\n\t\tfor ( i = 0; i < set.length; i++ ) {\n\t\t\tif ( set[ i ] !== null ) {\n\t\t\t\tval = element.data( dataSpace + set[ i ] );\n\t\t\t\t// support: jQuery 1.6.2\n\t\t\t\t// http://bugs.jquery.com/ticket/9917\n\t\t\t\t// jQuery 1.6.2 incorrectly returns undefined for any falsy value.\n\t\t\t\t// We can't differentiate between \"\" and 0 here, so we just assume\n\t\t\t\t// empty string since it's likely to be a more common value...\n\t\t\t\tif ( val === undefined ) {\n\t\t\t\t\tval = \"\";\n\t\t\t\t}\n\t\t\t\telement.css( set[ i ], val );\n\t\t\t}\n\t\t}\n\t},\n\n\tsetMode: function( el, mode ) {\n\t\tif (mode === \"toggle\") {\n\t\t\tmode = el.is( \":hidden\" ) ? \"show\" : \"hide\";\n\t\t}\n\t\treturn mode;\n\t},\n\n\t// Translates a [top,left] array into a baseline value\n\t// this should be a little more flexible in the future to handle a string & hash\n\tgetBaseline: function( origin, original ) {\n\t\tvar y, x;\n\t\tswitch ( origin[ 0 ] ) {\n\t\t\tcase \"top\": y = 0; break;\n\t\t\tcase \"middle\": y = 0.5; break;\n\t\t\tcase \"bottom\": y = 1; break;\n\t\t\tdefault: y = origin[ 0 ] / original.height;\n\t\t}\n\t\tswitch ( origin[ 1 ] ) {\n\t\t\tcase \"left\": x = 0; break;\n\t\t\tcase \"center\": x = 0.5; break;\n\t\t\tcase \"right\": x = 1; break;\n\t\t\tdefault: x = origin[ 1 ] / original.width;\n\t\t}\n\t\treturn {\n\t\t\tx: x,\n\t\t\ty: y\n\t\t};\n\t},\n\n\t// Wraps the element around a wrapper that copies position properties\n\tcreateWrapper: function( element ) {\n\n\t\t// if the element is already wrapped, return it\n\t\tif ( element.parent().is( \".ui-effects-wrapper\" )) {\n\t\t\treturn element.parent();\n\t\t}\n\n\t\t// wrap the element\n\t\tvar props = {\n\t\t\t\twidth: element.outerWidth(true),\n\t\t\t\theight: element.outerHeight(true),\n\t\t\t\t\"float\": element.css( \"float\" )\n\t\t\t},\n\t\t\twrapper = $( \"<div></div>\" )\n\t\t\t\t.addClass( \"ui-effects-wrapper\" )\n\t\t\t\t.css({\n\t\t\t\t\tfontSize: \"100%\",\n\t\t\t\t\tbackground: \"transparent\",\n\t\t\t\t\tborder: \"none\",\n\t\t\t\t\tmargin: 0,\n\t\t\t\t\tpadding: 0\n\t\t\t\t}),\n\t\t\t// Store the size in case width/height are defined in % - Fixes #5245\n\t\t\tsize = {\n\t\t\t\twidth: element.width(),\n\t\t\t\theight: element.height()\n\t\t\t},\n\t\t\tactive = document.activeElement;\n\n\t\t// support: Firefox\n\t\t// Firefox incorrectly exposes anonymous content\n\t\t// https://bugzilla.mozilla.org/show_bug.cgi?id=561664\n\t\ttry {\n\t\t\tactive.id;\n\t\t} catch ( e ) {\n\t\t\tactive = document.body;\n\t\t}\n\n\t\telement.wrap( wrapper );\n\n\t\t// Fixes #7595 - Elements lose focus when wrapped.\n\t\tif ( element[ 0 ] === active || $.contains( element[ 0 ], active ) ) {\n\t\t\t$( active ).focus();\n\t\t}\n\n\t\twrapper = element.parent(); //Hotfix for jQuery 1.4 since some change in wrap() seems to actually lose the reference to the wrapped element\n\n\t\t// transfer positioning properties to the wrapper\n\t\tif ( element.css( \"position\" ) === \"static\" ) {\n\t\t\twrapper.css({ position: \"relative\" });\n\t\t\telement.css({ position: \"relative\" });\n\t\t} else {\n\t\t\t$.extend( props, {\n\t\t\t\tposition: element.css( \"position\" ),\n\t\t\t\tzIndex: element.css( \"z-index\" )\n\t\t\t});\n\t\t\t$.each([ \"top\", \"left\", \"bottom\", \"right\" ], function(i, pos) {\n\t\t\t\tprops[ pos ] = element.css( pos );\n\t\t\t\tif ( isNaN( parseInt( props[ pos ], 10 ) ) ) {\n\t\t\t\t\tprops[ pos ] = \"auto\";\n\t\t\t\t}\n\t\t\t});\n\t\t\telement.css({\n\t\t\t\tposition: \"relative\",\n\t\t\t\ttop: 0,\n\t\t\t\tleft: 0,\n\t\t\t\tright: \"auto\",\n\t\t\t\tbottom: \"auto\"\n\t\t\t});\n\t\t}\n\t\telement.css(size);\n\n\t\treturn wrapper.css( props ).show();\n\t},\n\n\tremoveWrapper: function( element ) {\n\t\tvar active = document.activeElement;\n\n\t\tif ( element.parent().is( \".ui-effects-wrapper\" ) ) {\n\t\t\telement.parent().replaceWith( element );\n\n\t\t\t// Fixes #7595 - Elements lose focus when wrapped.\n\t\t\tif ( element[ 0 ] === active || $.contains( element[ 0 ], active ) ) {\n\t\t\t\t$( active ).focus();\n\t\t\t}\n\t\t}\n\n\t\treturn element;\n\t},\n\n\tsetTransition: function( element, list, factor, value ) {\n\t\tvalue = value || {};\n\t\t$.each( list, function( i, x ) {\n\t\t\tvar unit = element.cssUnit( x );\n\t\t\tif ( unit[ 0 ] > 0 ) {\n\t\t\t\tvalue[ x ] = unit[ 0 ] * factor + unit[ 1 ];\n\t\t\t}\n\t\t});\n\t\treturn value;\n\t}\n});\n\n// return an effect options object for the given parameters:\nfunction _normalizeArguments( effect, options, speed, callback ) {\n\n\t// allow passing all options as the first parameter\n\tif ( $.isPlainObject( effect ) ) {\n\t\toptions = effect;\n\t\teffect = effect.effect;\n\t}\n\n\t// convert to an object\n\teffect = { effect: effect };\n\n\t// catch (effect, null, ...)\n\tif ( options == null ) {\n\t\toptions = {};\n\t}\n\n\t// catch (effect, callback)\n\tif ( $.isFunction( options ) ) {\n\t\tcallback = options;\n\t\tspeed = null;\n\t\toptions = {};\n\t}\n\n\t// catch (effect, speed, ?)\n\tif ( typeof options === \"number\" || $.fx.speeds[ options ] ) {\n\t\tcallback = speed;\n\t\tspeed = options;\n\t\toptions = {};\n\t}\n\n\t// catch (effect, options, callback)\n\tif ( $.isFunction( speed ) ) {\n\t\tcallback = speed;\n\t\tspeed = null;\n\t}\n\n\t// add options to effect\n\tif ( options ) {\n\t\t$.extend( effect, options );\n\t}\n\n\tspeed = speed || options.duration;\n\teffect.duration = $.fx.off ? 0 :\n\t\ttypeof speed === \"number\" ? speed :\n\t\tspeed in $.fx.speeds ? $.fx.speeds[ speed ] :\n\t\t$.fx.speeds._default;\n\n\teffect.complete = callback || options.complete;\n\n\treturn effect;\n}\n\nfunction standardAnimationOption( option ) {\n\t// Valid standard speeds (nothing, number, named speed)\n\tif ( !option || typeof option === \"number\" || $.fx.speeds[ option ] ) {\n\t\treturn true;\n\t}\n\n\t// Invalid strings - treat as \"normal\" speed\n\tif ( typeof option === \"string\" && !$.effects.effect[ option ] ) {\n\t\treturn true;\n\t}\n\n\t// Complete callback\n\tif ( $.isFunction( option ) ) {\n\t\treturn true;\n\t}\n\n\t// Options hash (but not naming an effect)\n\tif ( typeof option === \"object\" && !option.effect ) {\n\t\treturn true;\n\t}\n\n\t// Didn't match any standard API\n\treturn false;\n}\n\n$.fn.extend({\n\teffect: function( /* effect, options, speed, callback */ ) {\n\t\tvar args = _normalizeArguments.apply( this, arguments ),\n\t\t\tmode = args.mode,\n\t\t\tqueue = args.queue,\n\t\t\teffectMethod = $.effects.effect[ args.effect ];\n\n\t\tif ( $.fx.off || !effectMethod ) {\n\t\t\t// delegate to the original method (e.g., .show()) if possible\n\t\t\tif ( mode ) {\n\t\t\t\treturn this[ mode ]( args.duration, args.complete );\n\t\t\t} else {\n\t\t\t\treturn this.each( function() {\n\t\t\t\t\tif ( args.complete ) {\n\t\t\t\t\t\targs.complete.call( this );\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tfunction run( next ) {\n\t\t\tvar elem = $( this ),\n\t\t\t\tcomplete = args.complete,\n\t\t\t\tmode = args.mode;\n\n\t\t\tfunction done() {\n\t\t\t\tif ( $.isFunction( complete ) ) {\n\t\t\t\t\tcomplete.call( elem[0] );\n\t\t\t\t}\n\t\t\t\tif ( $.isFunction( next ) ) {\n\t\t\t\t\tnext();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// If the element already has the correct final state, delegate to\n\t\t\t// the core methods so the internal tracking of \"olddisplay\" works.\n\t\t\tif ( elem.is( \":hidden\" ) ? mode === \"hide\" : mode === \"show\" ) {\n\t\t\t\telem[ mode ]();\n\t\t\t\tdone();\n\t\t\t} else {\n\t\t\t\teffectMethod.call( elem[0], args, done );\n\t\t\t}\n\t\t}\n\n\t\treturn queue === false ? this.each( run ) : this.queue( queue || \"fx\", run );\n\t},\n\n\tshow: (function( orig ) {\n\t\treturn function( option ) {\n\t\t\tif ( standardAnimationOption( option ) ) {\n\t\t\t\treturn orig.apply( this, arguments );\n\t\t\t} else {\n\t\t\t\tvar args = _normalizeArguments.apply( this, arguments );\n\t\t\t\targs.mode = \"show\";\n\t\t\t\treturn this.effect.call( this, args );\n\t\t\t}\n\t\t};\n\t})( $.fn.show ),\n\n\thide: (function( orig ) {\n\t\treturn function( option ) {\n\t\t\tif ( standardAnimationOption( option ) ) {\n\t\t\t\treturn orig.apply( this, arguments );\n\t\t\t} else {\n\t\t\t\tvar args = _normalizeArguments.apply( this, arguments );\n\t\t\t\targs.mode = \"hide\";\n\t\t\t\treturn this.effect.call( this, args );\n\t\t\t}\n\t\t};\n\t})( $.fn.hide ),\n\n\ttoggle: (function( orig ) {\n\t\treturn function( option ) {\n\t\t\tif ( standardAnimationOption( option ) || typeof option === \"boolean\" ) {\n\t\t\t\treturn orig.apply( this, arguments );\n\t\t\t} else {\n\t\t\t\tvar args = _normalizeArguments.apply( this, arguments );\n\t\t\t\targs.mode = \"toggle\";\n\t\t\t\treturn this.effect.call( this, args );\n\t\t\t}\n\t\t};\n\t})( $.fn.toggle ),\n\n\t// helper functions\n\tcssUnit: function(key) {\n\t\tvar style = this.css( key ),\n\t\t\tval = [];\n\n\t\t$.each( [ \"em\", \"px\", \"%\", \"pt\" ], function( i, unit ) {\n\t\t\tif ( style.indexOf( unit ) > 0 ) {\n\t\t\t\tval = [ parseFloat( style ), unit ];\n\t\t\t}\n\t\t});\n\t\treturn val;\n\t}\n});\n\n})();\n\n/******************************************************************************/\n/*********************************** EASING ***********************************/\n/******************************************************************************/\n\n(function() {\n\n// based on easing equations from Robert Penner (http://www.robertpenner.com/easing)\n\nvar baseEasings = {};\n\n$.each( [ \"Quad\", \"Cubic\", \"Quart\", \"Quint\", \"Expo\" ], function( i, name ) {\n\tbaseEasings[ name ] = function( p ) {\n\t\treturn Math.pow( p, i + 2 );\n\t};\n});\n\n$.extend( baseEasings, {\n\tSine: function( p ) {\n\t\treturn 1 - Math.cos( p * Math.PI / 2 );\n\t},\n\tCirc: function( p ) {\n\t\treturn 1 - Math.sqrt( 1 - p * p );\n\t},\n\tElastic: function( p ) {\n\t\treturn p === 0 || p === 1 ? p :\n\t\t\t-Math.pow( 2, 8 * (p - 1) ) * Math.sin( ( (p - 1) * 80 - 7.5 ) * Math.PI / 15 );\n\t},\n\tBack: function( p ) {\n\t\treturn p * p * ( 3 * p - 2 );\n\t},\n\tBounce: function( p ) {\n\t\tvar pow2,\n\t\t\tbounce = 4;\n\n\t\twhile ( p < ( ( pow2 = Math.pow( 2, --bounce ) ) - 1 ) / 11 ) {}\n\t\treturn 1 / Math.pow( 4, 3 - bounce ) - 7.5625 * Math.pow( ( pow2 * 3 - 2 ) / 22 - p, 2 );\n\t}\n});\n\n$.each( baseEasings, function( name, easeIn ) {\n\t$.easing[ \"easeIn\" + name ] = easeIn;\n\t$.easing[ \"easeOut\" + name ] = function( p ) {\n\t\treturn 1 - easeIn( 1 - p );\n\t};\n\t$.easing[ \"easeInOut\" + name ] = function( p ) {\n\t\treturn p < 0.5 ?\n\t\t\teaseIn( p * 2 ) / 2 :\n\t\t\t1 - easeIn( p * -2 + 2 ) / 2;\n\t};\n});\n\n})();\n\nvar effect = $.effects;\n\n\n/*!\n * jQuery UI Effects Blind 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/blind-effect/\n */\n\n\nvar effectBlind = $.effects.effect.blind = function( o, done ) {\n\t// Create element\n\tvar el = $( this ),\n\t\trvertical = /up|down|vertical/,\n\t\trpositivemotion = /up|left|vertical|horizontal/,\n\t\tprops = [ \"position\", \"top\", \"bottom\", \"left\", \"right\", \"height\", \"width\" ],\n\t\tmode = $.effects.setMode( el, o.mode || \"hide\" ),\n\t\tdirection = o.direction || \"up\",\n\t\tvertical = rvertical.test( direction ),\n\t\tref = vertical ? \"height\" : \"width\",\n\t\tref2 = vertical ? \"top\" : \"left\",\n\t\tmotion = rpositivemotion.test( direction ),\n\t\tanimation = {},\n\t\tshow = mode === \"show\",\n\t\twrapper, distance, margin;\n\n\t// if already wrapped, the wrapper's properties are my property. #6245\n\tif ( el.parent().is( \".ui-effects-wrapper\" ) ) {\n\t\t$.effects.save( el.parent(), props );\n\t} else {\n\t\t$.effects.save( el, props );\n\t}\n\tel.show();\n\twrapper = $.effects.createWrapper( el ).css({\n\t\toverflow: \"hidden\"\n\t});\n\n\tdistance = wrapper[ ref ]();\n\tmargin = parseFloat( wrapper.css( ref2 ) ) || 0;\n\n\tanimation[ ref ] = show ? distance : 0;\n\tif ( !motion ) {\n\t\tel\n\t\t\t.css( vertical ? \"bottom\" : \"right\", 0 )\n\t\t\t.css( vertical ? \"top\" : \"left\", \"auto\" )\n\t\t\t.css({ position: \"absolute\" });\n\n\t\tanimation[ ref2 ] = show ? margin : distance + margin;\n\t}\n\n\t// start at 0 if we are showing\n\tif ( show ) {\n\t\twrapper.css( ref, 0 );\n\t\tif ( !motion ) {\n\t\t\twrapper.css( ref2, margin + distance );\n\t\t}\n\t}\n\n\t// Animate\n\twrapper.animate( animation, {\n\t\tduration: o.duration,\n\t\teasing: o.easing,\n\t\tqueue: false,\n\t\tcomplete: function() {\n\t\t\tif ( mode === \"hide\" ) {\n\t\t\t\tel.hide();\n\t\t\t}\n\t\t\t$.effects.restore( el, props );\n\t\t\t$.effects.removeWrapper( el );\n\t\t\tdone();\n\t\t}\n\t});\n};\n\n\n/*!\n * jQuery UI Effects Bounce 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/bounce-effect/\n */\n\n\nvar effectBounce = $.effects.effect.bounce = function( o, done ) {\n\tvar el = $( this ),\n\t\tprops = [ \"position\", \"top\", \"bottom\", \"left\", \"right\", \"height\", \"width\" ],\n\n\t\t// defaults:\n\t\tmode = $.effects.setMode( el, o.mode || \"effect\" ),\n\t\thide = mode === \"hide\",\n\t\tshow = mode === \"show\",\n\t\tdirection = o.direction || \"up\",\n\t\tdistance = o.distance,\n\t\ttimes = o.times || 5,\n\n\t\t// number of internal animations\n\t\tanims = times * 2 + ( show || hide ? 1 : 0 ),\n\t\tspeed = o.duration / anims,\n\t\teasing = o.easing,\n\n\t\t// utility:\n\t\tref = ( direction === \"up\" || direction === \"down\" ) ? \"top\" : \"left\",\n\t\tmotion = ( direction === \"up\" || direction === \"left\" ),\n\t\ti,\n\t\tupAnim,\n\t\tdownAnim,\n\n\t\t// we will need to re-assemble the queue to stack our animations in place\n\t\tqueue = el.queue(),\n\t\tqueuelen = queue.length;\n\n\t// Avoid touching opacity to prevent clearType and PNG issues in IE\n\tif ( show || hide ) {\n\t\tprops.push( \"opacity\" );\n\t}\n\n\t$.effects.save( el, props );\n\tel.show();\n\t$.effects.createWrapper( el ); // Create Wrapper\n\n\t// default distance for the BIGGEST bounce is the outer Distance / 3\n\tif ( !distance ) {\n\t\tdistance = el[ ref === \"top\" ? \"outerHeight\" : \"outerWidth\" ]() / 3;\n\t}\n\n\tif ( show ) {\n\t\tdownAnim = { opacity: 1 };\n\t\tdownAnim[ ref ] = 0;\n\n\t\t// if we are showing, force opacity 0 and set the initial position\n\t\t// then do the \"first\" animation\n\t\tel.css( \"opacity\", 0 )\n\t\t\t.css( ref, motion ? -distance * 2 : distance * 2 )\n\t\t\t.animate( downAnim, speed, easing );\n\t}\n\n\t// start at the smallest distance if we are hiding\n\tif ( hide ) {\n\t\tdistance = distance / Math.pow( 2, times - 1 );\n\t}\n\n\tdownAnim = {};\n\tdownAnim[ ref ] = 0;\n\t// Bounces up/down/left/right then back to 0 -- times * 2 animations happen here\n\tfor ( i = 0; i < times; i++ ) {\n\t\tupAnim = {};\n\t\tupAnim[ ref ] = ( motion ? \"-=\" : \"+=\" ) + distance;\n\n\t\tel.animate( upAnim, speed, easing )\n\t\t\t.animate( downAnim, speed, easing );\n\n\t\tdistance = hide ? distance * 2 : distance / 2;\n\t}\n\n\t// Last Bounce when Hiding\n\tif ( hide ) {\n\t\tupAnim = { opacity: 0 };\n\t\tupAnim[ ref ] = ( motion ? \"-=\" : \"+=\" ) + distance;\n\n\t\tel.animate( upAnim, speed, easing );\n\t}\n\n\tel.queue(function() {\n\t\tif ( hide ) {\n\t\t\tel.hide();\n\t\t}\n\t\t$.effects.restore( el, props );\n\t\t$.effects.removeWrapper( el );\n\t\tdone();\n\t});\n\n\t// inject all the animations we just queued to be first in line (after \"inprogress\")\n\tif ( queuelen > 1) {\n\t\tqueue.splice.apply( queue,\n\t\t\t[ 1, 0 ].concat( queue.splice( queuelen, anims + 1 ) ) );\n\t}\n\tel.dequeue();\n\n};\n\n\n/*!\n * jQuery UI Effects Clip 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/clip-effect/\n */\n\n\nvar effectClip = $.effects.effect.clip = function( o, done ) {\n\t// Create element\n\tvar el = $( this ),\n\t\tprops = [ \"position\", \"top\", \"bottom\", \"left\", \"right\", \"height\", \"width\" ],\n\t\tmode = $.effects.setMode( el, o.mode || \"hide\" ),\n\t\tshow = mode === \"show\",\n\t\tdirection = o.direction || \"vertical\",\n\t\tvert = direction === \"vertical\",\n\t\tsize = vert ? \"height\" : \"width\",\n\t\tposition = vert ? \"top\" : \"left\",\n\t\tanimation = {},\n\t\twrapper, animate, distance;\n\n\t// Save & Show\n\t$.effects.save( el, props );\n\tel.show();\n\n\t// Create Wrapper\n\twrapper = $.effects.createWrapper( el ).css({\n\t\toverflow: \"hidden\"\n\t});\n\tanimate = ( el[0].tagName === \"IMG\" ) ? wrapper : el;\n\tdistance = animate[ size ]();\n\n\t// Shift\n\tif ( show ) {\n\t\tanimate.css( size, 0 );\n\t\tanimate.css( position, distance / 2 );\n\t}\n\n\t// Create Animation Object:\n\tanimation[ size ] = show ? distance : 0;\n\tanimation[ position ] = show ? 0 : distance / 2;\n\n\t// Animate\n\tanimate.animate( animation, {\n\t\tqueue: false,\n\t\tduration: o.duration,\n\t\teasing: o.easing,\n\t\tcomplete: function() {\n\t\t\tif ( !show ) {\n\t\t\t\tel.hide();\n\t\t\t}\n\t\t\t$.effects.restore( el, props );\n\t\t\t$.effects.removeWrapper( el );\n\t\t\tdone();\n\t\t}\n\t});\n\n};\n\n\n/*!\n * jQuery UI Effects Drop 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/drop-effect/\n */\n\n\nvar effectDrop = $.effects.effect.drop = function( o, done ) {\n\n\tvar el = $( this ),\n\t\tprops = [ \"position\", \"top\", \"bottom\", \"left\", \"right\", \"opacity\", \"height\", \"width\" ],\n\t\tmode = $.effects.setMode( el, o.mode || \"hide\" ),\n\t\tshow = mode === \"show\",\n\t\tdirection = o.direction || \"left\",\n\t\tref = ( direction === \"up\" || direction === \"down\" ) ? \"top\" : \"left\",\n\t\tmotion = ( direction === \"up\" || direction === \"left\" ) ? \"pos\" : \"neg\",\n\t\tanimation = {\n\t\t\topacity: show ? 1 : 0\n\t\t},\n\t\tdistance;\n\n\t// Adjust\n\t$.effects.save( el, props );\n\tel.show();\n\t$.effects.createWrapper( el );\n\n\tdistance = o.distance || el[ ref === \"top\" ? \"outerHeight\" : \"outerWidth\" ]( true ) / 2;\n\n\tif ( show ) {\n\t\tel\n\t\t\t.css( \"opacity\", 0 )\n\t\t\t.css( ref, motion === \"pos\" ? -distance : distance );\n\t}\n\n\t// Animation\n\tanimation[ ref ] = ( show ?\n\t\t( motion === \"pos\" ? \"+=\" : \"-=\" ) :\n\t\t( motion === \"pos\" ? \"-=\" : \"+=\" ) ) +\n\t\tdistance;\n\n\t// Animate\n\tel.animate( animation, {\n\t\tqueue: false,\n\t\tduration: o.duration,\n\t\teasing: o.easing,\n\t\tcomplete: function() {\n\t\t\tif ( mode === \"hide\" ) {\n\t\t\t\tel.hide();\n\t\t\t}\n\t\t\t$.effects.restore( el, props );\n\t\t\t$.effects.removeWrapper( el );\n\t\t\tdone();\n\t\t}\n\t});\n};\n\n\n/*!\n * jQuery UI Effects Explode 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/explode-effect/\n */\n\n\nvar effectExplode = $.effects.effect.explode = function( o, done ) {\n\n\tvar rows = o.pieces ? Math.round( Math.sqrt( o.pieces ) ) : 3,\n\t\tcells = rows,\n\t\tel = $( this ),\n\t\tmode = $.effects.setMode( el, o.mode || \"hide\" ),\n\t\tshow = mode === \"show\",\n\n\t\t// show and then visibility:hidden the element before calculating offset\n\t\toffset = el.show().css( \"visibility\", \"hidden\" ).offset(),\n\n\t\t// width and height of a piece\n\t\twidth = Math.ceil( el.outerWidth() / cells ),\n\t\theight = Math.ceil( el.outerHeight() / rows ),\n\t\tpieces = [],\n\n\t\t// loop\n\t\ti, j, left, top, mx, my;\n\n\t// children animate complete:\n\tfunction childComplete() {\n\t\tpieces.push( this );\n\t\tif ( pieces.length === rows * cells ) {\n\t\t\tanimComplete();\n\t\t}\n\t}\n\n\t// clone the element for each row and cell.\n\tfor ( i = 0; i < rows ; i++ ) { // ===>\n\t\ttop = offset.top + i * height;\n\t\tmy = i - ( rows - 1 ) / 2 ;\n\n\t\tfor ( j = 0; j < cells ; j++ ) { // |||\n\t\t\tleft = offset.left + j * width;\n\t\t\tmx = j - ( cells - 1 ) / 2 ;\n\n\t\t\t// Create a clone of the now hidden main element that will be absolute positioned\n\t\t\t// within a wrapper div off the -left and -top equal to size of our pieces\n\t\t\tel\n\t\t\t\t.clone()\n\t\t\t\t.appendTo( \"body\" )\n\t\t\t\t.wrap( \"<div></div>\" )\n\t\t\t\t.css({\n\t\t\t\t\tposition: \"absolute\",\n\t\t\t\t\tvisibility: \"visible\",\n\t\t\t\t\tleft: -j * width,\n\t\t\t\t\ttop: -i * height\n\t\t\t\t})\n\n\t\t\t// select the wrapper - make it overflow: hidden and absolute positioned based on\n\t\t\t// where the original was located +left and +top equal to the size of pieces\n\t\t\t\t.parent()\n\t\t\t\t.addClass( \"ui-effects-explode\" )\n\t\t\t\t.css({\n\t\t\t\t\tposition: \"absolute\",\n\t\t\t\t\toverflow: \"hidden\",\n\t\t\t\t\twidth: width,\n\t\t\t\t\theight: height,\n\t\t\t\t\tleft: left + ( show ? mx * width : 0 ),\n\t\t\t\t\ttop: top + ( show ? my * height : 0 ),\n\t\t\t\t\topacity: show ? 0 : 1\n\t\t\t\t}).animate({\n\t\t\t\t\tleft: left + ( show ? 0 : mx * width ),\n\t\t\t\t\ttop: top + ( show ? 0 : my * height ),\n\t\t\t\t\topacity: show ? 1 : 0\n\t\t\t\t}, o.duration || 500, o.easing, childComplete );\n\t\t}\n\t}\n\n\tfunction animComplete() {\n\t\tel.css({\n\t\t\tvisibility: \"visible\"\n\t\t});\n\t\t$( pieces ).remove();\n\t\tif ( !show ) {\n\t\t\tel.hide();\n\t\t}\n\t\tdone();\n\t}\n};\n\n\n/*!\n * jQuery UI Effects Fade 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/fade-effect/\n */\n\n\nvar effectFade = $.effects.effect.fade = function( o, done ) {\n\tvar el = $( this ),\n\t\tmode = $.effects.setMode( el, o.mode || \"toggle\" );\n\n\tel.animate({\n\t\topacity: mode\n\t}, {\n\t\tqueue: false,\n\t\tduration: o.duration,\n\t\teasing: o.easing,\n\t\tcomplete: done\n\t});\n};\n\n\n/*!\n * jQuery UI Effects Fold 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/fold-effect/\n */\n\n\nvar effectFold = $.effects.effect.fold = function( o, done ) {\n\n\t// Create element\n\tvar el = $( this ),\n\t\tprops = [ \"position\", \"top\", \"bottom\", \"left\", \"right\", \"height\", \"width\" ],\n\t\tmode = $.effects.setMode( el, o.mode || \"hide\" ),\n\t\tshow = mode === \"show\",\n\t\thide = mode === \"hide\",\n\t\tsize = o.size || 15,\n\t\tpercent = /([0-9]+)%/.exec( size ),\n\t\thorizFirst = !!o.horizFirst,\n\t\twidthFirst = show !== horizFirst,\n\t\tref = widthFirst ? [ \"width\", \"height\" ] : [ \"height\", \"width\" ],\n\t\tduration = o.duration / 2,\n\t\twrapper, distance,\n\t\tanimation1 = {},\n\t\tanimation2 = {};\n\n\t$.effects.save( el, props );\n\tel.show();\n\n\t// Create Wrapper\n\twrapper = $.effects.createWrapper( el ).css({\n\t\toverflow: \"hidden\"\n\t});\n\tdistance = widthFirst ?\n\t\t[ wrapper.width(), wrapper.height() ] :\n\t\t[ wrapper.height(), wrapper.width() ];\n\n\tif ( percent ) {\n\t\tsize = parseInt( percent[ 1 ], 10 ) / 100 * distance[ hide ? 0 : 1 ];\n\t}\n\tif ( show ) {\n\t\twrapper.css( horizFirst ? {\n\t\t\theight: 0,\n\t\t\twidth: size\n\t\t} : {\n\t\t\theight: size,\n\t\t\twidth: 0\n\t\t});\n\t}\n\n\t// Animation\n\tanimation1[ ref[ 0 ] ] = show ? distance[ 0 ] : size;\n\tanimation2[ ref[ 1 ] ] = show ? distance[ 1 ] : 0;\n\n\t// Animate\n\twrapper\n\t\t.animate( animation1, duration, o.easing )\n\t\t.animate( animation2, duration, o.easing, function() {\n\t\t\tif ( hide ) {\n\t\t\t\tel.hide();\n\t\t\t}\n\t\t\t$.effects.restore( el, props );\n\t\t\t$.effects.removeWrapper( el );\n\t\t\tdone();\n\t\t});\n\n};\n\n\n/*!\n * jQuery UI Effects Highlight 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/highlight-effect/\n */\n\n\nvar effectHighlight = $.effects.effect.highlight = function( o, done ) {\n\tvar elem = $( this ),\n\t\tprops = [ \"backgroundImage\", \"backgroundColor\", \"opacity\" ],\n\t\tmode = $.effects.setMode( elem, o.mode || \"show\" ),\n\t\tanimation = {\n\t\t\tbackgroundColor: elem.css( \"backgroundColor\" )\n\t\t};\n\n\tif (mode === \"hide\") {\n\t\tanimation.opacity = 0;\n\t}\n\n\t$.effects.save( elem, props );\n\n\telem\n\t\t.show()\n\t\t.css({\n\t\t\tbackgroundImage: \"none\",\n\t\t\tbackgroundColor: o.color || \"#ffff99\"\n\t\t})\n\t\t.animate( animation, {\n\t\t\tqueue: false,\n\t\t\tduration: o.duration,\n\t\t\teasing: o.easing,\n\t\t\tcomplete: function() {\n\t\t\t\tif ( mode === \"hide\" ) {\n\t\t\t\t\telem.hide();\n\t\t\t\t}\n\t\t\t\t$.effects.restore( elem, props );\n\t\t\t\tdone();\n\t\t\t}\n\t\t});\n};\n\n\n/*!\n * jQuery UI Effects Size 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/size-effect/\n */\n\n\nvar effectSize = $.effects.effect.size = function( o, done ) {\n\n\t// Create element\n\tvar original, baseline, factor,\n\t\tel = $( this ),\n\t\tprops0 = [ \"position\", \"top\", \"bottom\", \"left\", \"right\", \"width\", \"height\", \"overflow\", \"opacity\" ],\n\n\t\t// Always restore\n\t\tprops1 = [ \"position\", \"top\", \"bottom\", \"left\", \"right\", \"overflow\", \"opacity\" ],\n\n\t\t// Copy for children\n\t\tprops2 = [ \"width\", \"height\", \"overflow\" ],\n\t\tcProps = [ \"fontSize\" ],\n\t\tvProps = [ \"borderTopWidth\", \"borderBottomWidth\", \"paddingTop\", \"paddingBottom\" ],\n\t\thProps = [ \"borderLeftWidth\", \"borderRightWidth\", \"paddingLeft\", \"paddingRight\" ],\n\n\t\t// Set options\n\t\tmode = $.effects.setMode( el, o.mode || \"effect\" ),\n\t\trestore = o.restore || mode !== \"effect\",\n\t\tscale = o.scale || \"both\",\n\t\torigin = o.origin || [ \"middle\", \"center\" ],\n\t\tposition = el.css( \"position\" ),\n\t\tprops = restore ? props0 : props1,\n\t\tzero = {\n\t\t\theight: 0,\n\t\t\twidth: 0,\n\t\t\touterHeight: 0,\n\t\t\touterWidth: 0\n\t\t};\n\n\tif ( mode === \"show\" ) {\n\t\tel.show();\n\t}\n\toriginal = {\n\t\theight: el.height(),\n\t\twidth: el.width(),\n\t\touterHeight: el.outerHeight(),\n\t\touterWidth: el.outerWidth()\n\t};\n\n\tif ( o.mode === \"toggle\" && mode === \"show\" ) {\n\t\tel.from = o.to || zero;\n\t\tel.to = o.from || original;\n\t} else {\n\t\tel.from = o.from || ( mode === \"show\" ? zero : original );\n\t\tel.to = o.to || ( mode === \"hide\" ? zero : original );\n\t}\n\n\t// Set scaling factor\n\tfactor = {\n\t\tfrom: {\n\t\t\ty: el.from.height / original.height,\n\t\t\tx: el.from.width / original.width\n\t\t},\n\t\tto: {\n\t\t\ty: el.to.height / original.height,\n\t\t\tx: el.to.width / original.width\n\t\t}\n\t};\n\n\t// Scale the css box\n\tif ( scale === \"box\" || scale === \"both\" ) {\n\n\t\t// Vertical props scaling\n\t\tif ( factor.from.y !== factor.to.y ) {\n\t\t\tprops = props.concat( vProps );\n\t\t\tel.from = $.effects.setTransition( el, vProps, factor.from.y, el.from );\n\t\t\tel.to = $.effects.setTransition( el, vProps, factor.to.y, el.to );\n\t\t}\n\n\t\t// Horizontal props scaling\n\t\tif ( factor.from.x !== factor.to.x ) {\n\t\t\tprops = props.concat( hProps );\n\t\t\tel.from = $.effects.setTransition( el, hProps, factor.from.x, el.from );\n\t\t\tel.to = $.effects.setTransition( el, hProps, factor.to.x, el.to );\n\t\t}\n\t}\n\n\t// Scale the content\n\tif ( scale === \"content\" || scale === \"both\" ) {\n\n\t\t// Vertical props scaling\n\t\tif ( factor.from.y !== factor.to.y ) {\n\t\t\tprops = props.concat( cProps ).concat( props2 );\n\t\t\tel.from = $.effects.setTransition( el, cProps, factor.from.y, el.from );\n\t\t\tel.to = $.effects.setTransition( el, cProps, factor.to.y, el.to );\n\t\t}\n\t}\n\n\t$.effects.save( el, props );\n\tel.show();\n\t$.effects.createWrapper( el );\n\tel.css( \"overflow\", \"hidden\" ).css( el.from );\n\n\t// Adjust\n\tif (origin) { // Calculate baseline shifts\n\t\tbaseline = $.effects.getBaseline( origin, original );\n\t\tel.from.top = ( original.outerHeight - el.outerHeight() ) * baseline.y;\n\t\tel.from.left = ( original.outerWidth - el.outerWidth() ) * baseline.x;\n\t\tel.to.top = ( original.outerHeight - el.to.outerHeight ) * baseline.y;\n\t\tel.to.left = ( original.outerWidth - el.to.outerWidth ) * baseline.x;\n\t}\n\tel.css( el.from ); // set top & left\n\n\t// Animate\n\tif ( scale === \"content\" || scale === \"both\" ) { // Scale the children\n\n\t\t// Add margins/font-size\n\t\tvProps = vProps.concat([ \"marginTop\", \"marginBottom\" ]).concat(cProps);\n\t\thProps = hProps.concat([ \"marginLeft\", \"marginRight\" ]);\n\t\tprops2 = props0.concat(vProps).concat(hProps);\n\n\t\tel.find( \"*[width]\" ).each( function() {\n\t\t\tvar child = $( this ),\n\t\t\t\tc_original = {\n\t\t\t\t\theight: child.height(),\n\t\t\t\t\twidth: child.width(),\n\t\t\t\t\touterHeight: child.outerHeight(),\n\t\t\t\t\touterWidth: child.outerWidth()\n\t\t\t\t};\n\t\t\tif (restore) {\n\t\t\t\t$.effects.save(child, props2);\n\t\t\t}\n\n\t\t\tchild.from = {\n\t\t\t\theight: c_original.height * factor.from.y,\n\t\t\t\twidth: c_original.width * factor.from.x,\n\t\t\t\touterHeight: c_original.outerHeight * factor.from.y,\n\t\t\t\touterWidth: c_original.outerWidth * factor.from.x\n\t\t\t};\n\t\t\tchild.to = {\n\t\t\t\theight: c_original.height * factor.to.y,\n\t\t\t\twidth: c_original.width * factor.to.x,\n\t\t\t\touterHeight: c_original.height * factor.to.y,\n\t\t\t\touterWidth: c_original.width * factor.to.x\n\t\t\t};\n\n\t\t\t// Vertical props scaling\n\t\t\tif ( factor.from.y !== factor.to.y ) {\n\t\t\t\tchild.from = $.effects.setTransition( child, vProps, factor.from.y, child.from );\n\t\t\t\tchild.to = $.effects.setTransition( child, vProps, factor.to.y, child.to );\n\t\t\t}\n\n\t\t\t// Horizontal props scaling\n\t\t\tif ( factor.from.x !== factor.to.x ) {\n\t\t\t\tchild.from = $.effects.setTransition( child, hProps, factor.from.x, child.from );\n\t\t\t\tchild.to = $.effects.setTransition( child, hProps, factor.to.x, child.to );\n\t\t\t}\n\n\t\t\t// Animate children\n\t\t\tchild.css( child.from );\n\t\t\tchild.animate( child.to, o.duration, o.easing, function() {\n\n\t\t\t\t// Restore children\n\t\t\t\tif ( restore ) {\n\t\t\t\t\t$.effects.restore( child, props2 );\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\t// Animate\n\tel.animate( el.to, {\n\t\tqueue: false,\n\t\tduration: o.duration,\n\t\teasing: o.easing,\n\t\tcomplete: function() {\n\t\t\tif ( el.to.opacity === 0 ) {\n\t\t\t\tel.css( \"opacity\", el.from.opacity );\n\t\t\t}\n\t\t\tif ( mode === \"hide\" ) {\n\t\t\t\tel.hide();\n\t\t\t}\n\t\t\t$.effects.restore( el, props );\n\t\t\tif ( !restore ) {\n\n\t\t\t\t// we need to calculate our new positioning based on the scaling\n\t\t\t\tif ( position === \"static\" ) {\n\t\t\t\t\tel.css({\n\t\t\t\t\t\tposition: \"relative\",\n\t\t\t\t\t\ttop: el.to.top,\n\t\t\t\t\t\tleft: el.to.left\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t$.each([ \"top\", \"left\" ], function( idx, pos ) {\n\t\t\t\t\t\tel.css( pos, function( _, str ) {\n\t\t\t\t\t\t\tvar val = parseInt( str, 10 ),\n\t\t\t\t\t\t\t\ttoRef = idx ? el.to.left : el.to.top;\n\n\t\t\t\t\t\t\t// if original was \"auto\", recalculate the new value from wrapper\n\t\t\t\t\t\t\tif ( str === \"auto\" ) {\n\t\t\t\t\t\t\t\treturn toRef + \"px\";\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn val + toRef + \"px\";\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t$.effects.removeWrapper( el );\n\t\t\tdone();\n\t\t}\n\t});\n\n};\n\n\n/*!\n * jQuery UI Effects Scale 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/scale-effect/\n */\n\n\nvar effectScale = $.effects.effect.scale = function( o, done ) {\n\n\t// Create element\n\tvar el = $( this ),\n\t\toptions = $.extend( true, {}, o ),\n\t\tmode = $.effects.setMode( el, o.mode || \"effect\" ),\n\t\tpercent = parseInt( o.percent, 10 ) ||\n\t\t\t( parseInt( o.percent, 10 ) === 0 ? 0 : ( mode === \"hide\" ? 0 : 100 ) ),\n\t\tdirection = o.direction || \"both\",\n\t\torigin = o.origin,\n\t\toriginal = {\n\t\t\theight: el.height(),\n\t\t\twidth: el.width(),\n\t\t\touterHeight: el.outerHeight(),\n\t\t\touterWidth: el.outerWidth()\n\t\t},\n\t\tfactor = {\n\t\t\ty: direction !== \"horizontal\" ? (percent / 100) : 1,\n\t\t\tx: direction !== \"vertical\" ? (percent / 100) : 1\n\t\t};\n\n\t// We are going to pass this effect to the size effect:\n\toptions.effect = \"size\";\n\toptions.queue = false;\n\toptions.complete = done;\n\n\t// Set default origin and restore for show/hide\n\tif ( mode !== \"effect\" ) {\n\t\toptions.origin = origin || [ \"middle\", \"center\" ];\n\t\toptions.restore = true;\n\t}\n\n\toptions.from = o.from || ( mode === \"show\" ? {\n\t\theight: 0,\n\t\twidth: 0,\n\t\touterHeight: 0,\n\t\touterWidth: 0\n\t} : original );\n\toptions.to = {\n\t\theight: original.height * factor.y,\n\t\twidth: original.width * factor.x,\n\t\touterHeight: original.outerHeight * factor.y,\n\t\touterWidth: original.outerWidth * factor.x\n\t};\n\n\t// Fade option to support puff\n\tif ( options.fade ) {\n\t\tif ( mode === \"show\" ) {\n\t\t\toptions.from.opacity = 0;\n\t\t\toptions.to.opacity = 1;\n\t\t}\n\t\tif ( mode === \"hide\" ) {\n\t\t\toptions.from.opacity = 1;\n\t\t\toptions.to.opacity = 0;\n\t\t}\n\t}\n\n\t// Animate\n\tel.effect( options );\n\n};\n\n\n/*!\n * jQuery UI Effects Puff 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/puff-effect/\n */\n\n\nvar effectPuff = $.effects.effect.puff = function( o, done ) {\n\tvar elem = $( this ),\n\t\tmode = $.effects.setMode( elem, o.mode || \"hide\" ),\n\t\thide = mode === \"hide\",\n\t\tpercent = parseInt( o.percent, 10 ) || 150,\n\t\tfactor = percent / 100,\n\t\toriginal = {\n\t\t\theight: elem.height(),\n\t\t\twidth: elem.width(),\n\t\t\touterHeight: elem.outerHeight(),\n\t\t\touterWidth: elem.outerWidth()\n\t\t};\n\n\t$.extend( o, {\n\t\teffect: \"scale\",\n\t\tqueue: false,\n\t\tfade: true,\n\t\tmode: mode,\n\t\tcomplete: done,\n\t\tpercent: hide ? percent : 100,\n\t\tfrom: hide ?\n\t\t\toriginal :\n\t\t\t{\n\t\t\t\theight: original.height * factor,\n\t\t\t\twidth: original.width * factor,\n\t\t\t\touterHeight: original.outerHeight * factor,\n\t\t\t\touterWidth: original.outerWidth * factor\n\t\t\t}\n\t});\n\n\telem.effect( o );\n};\n\n\n/*!\n * jQuery UI Effects Pulsate 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/pulsate-effect/\n */\n\n\nvar effectPulsate = $.effects.effect.pulsate = function( o, done ) {\n\tvar elem = $( this ),\n\t\tmode = $.effects.setMode( elem, o.mode || \"show\" ),\n\t\tshow = mode === \"show\",\n\t\thide = mode === \"hide\",\n\t\tshowhide = ( show || mode === \"hide\" ),\n\n\t\t// showing or hiding leaves of the \"last\" animation\n\t\tanims = ( ( o.times || 5 ) * 2 ) + ( showhide ? 1 : 0 ),\n\t\tduration = o.duration / anims,\n\t\tanimateTo = 0,\n\t\tqueue = elem.queue(),\n\t\tqueuelen = queue.length,\n\t\ti;\n\n\tif ( show || !elem.is(\":visible\")) {\n\t\telem.css( \"opacity\", 0 ).show();\n\t\tanimateTo = 1;\n\t}\n\n\t// anims - 1 opacity \"toggles\"\n\tfor ( i = 1; i < anims; i++ ) {\n\t\telem.animate({\n\t\t\topacity: animateTo\n\t\t}, duration, o.easing );\n\t\tanimateTo = 1 - animateTo;\n\t}\n\n\telem.animate({\n\t\topacity: animateTo\n\t}, duration, o.easing);\n\n\telem.queue(function() {\n\t\tif ( hide ) {\n\t\t\telem.hide();\n\t\t}\n\t\tdone();\n\t});\n\n\t// We just queued up \"anims\" animations, we need to put them next in the queue\n\tif ( queuelen > 1 ) {\n\t\tqueue.splice.apply( queue,\n\t\t\t[ 1, 0 ].concat( queue.splice( queuelen, anims + 1 ) ) );\n\t}\n\telem.dequeue();\n};\n\n\n/*!\n * jQuery UI Effects Shake 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/shake-effect/\n */\n\n\nvar effectShake = $.effects.effect.shake = function( o, done ) {\n\n\tvar el = $( this ),\n\t\tprops = [ \"position\", \"top\", \"bottom\", \"left\", \"right\", \"height\", \"width\" ],\n\t\tmode = $.effects.setMode( el, o.mode || \"effect\" ),\n\t\tdirection = o.direction || \"left\",\n\t\tdistance = o.distance || 20,\n\t\ttimes = o.times || 3,\n\t\tanims = times * 2 + 1,\n\t\tspeed = Math.round( o.duration / anims ),\n\t\tref = (direction === \"up\" || direction === \"down\") ? \"top\" : \"left\",\n\t\tpositiveMotion = (direction === \"up\" || direction === \"left\"),\n\t\tanimation = {},\n\t\tanimation1 = {},\n\t\tanimation2 = {},\n\t\ti,\n\n\t\t// we will need to re-assemble the queue to stack our animations in place\n\t\tqueue = el.queue(),\n\t\tqueuelen = queue.length;\n\n\t$.effects.save( el, props );\n\tel.show();\n\t$.effects.createWrapper( el );\n\n\t// Animation\n\tanimation[ ref ] = ( positiveMotion ? \"-=\" : \"+=\" ) + distance;\n\tanimation1[ ref ] = ( positiveMotion ? \"+=\" : \"-=\" ) + distance * 2;\n\tanimation2[ ref ] = ( positiveMotion ? \"-=\" : \"+=\" ) + distance * 2;\n\n\t// Animate\n\tel.animate( animation, speed, o.easing );\n\n\t// Shakes\n\tfor ( i = 1; i < times; i++ ) {\n\t\tel.animate( animation1, speed, o.easing ).animate( animation2, speed, o.easing );\n\t}\n\tel\n\t\t.animate( animation1, speed, o.easing )\n\t\t.animate( animation, speed / 2, o.easing )\n\t\t.queue(function() {\n\t\t\tif ( mode === \"hide\" ) {\n\t\t\t\tel.hide();\n\t\t\t}\n\t\t\t$.effects.restore( el, props );\n\t\t\t$.effects.removeWrapper( el );\n\t\t\tdone();\n\t\t});\n\n\t// inject all the animations we just queued to be first in line (after \"inprogress\")\n\tif ( queuelen > 1) {\n\t\tqueue.splice.apply( queue,\n\t\t\t[ 1, 0 ].concat( queue.splice( queuelen, anims + 1 ) ) );\n\t}\n\tel.dequeue();\n\n};\n\n\n/*!\n * jQuery UI Effects Slide 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/slide-effect/\n */\n\n\nvar effectSlide = $.effects.effect.slide = function( o, done ) {\n\n\t// Create element\n\tvar el = $( this ),\n\t\tprops = [ \"position\", \"top\", \"bottom\", \"left\", \"right\", \"width\", \"height\" ],\n\t\tmode = $.effects.setMode( el, o.mode || \"show\" ),\n\t\tshow = mode === \"show\",\n\t\tdirection = o.direction || \"left\",\n\t\tref = (direction === \"up\" || direction === \"down\") ? \"top\" : \"left\",\n\t\tpositiveMotion = (direction === \"up\" || direction === \"left\"),\n\t\tdistance,\n\t\tanimation = {};\n\n\t// Adjust\n\t$.effects.save( el, props );\n\tel.show();\n\tdistance = o.distance || el[ ref === \"top\" ? \"outerHeight\" : \"outerWidth\" ]( true );\n\n\t$.effects.createWrapper( el ).css({\n\t\toverflow: \"hidden\"\n\t});\n\n\tif ( show ) {\n\t\tel.css( ref, positiveMotion ? (isNaN(distance) ? \"-\" + distance : -distance) : distance );\n\t}\n\n\t// Animation\n\tanimation[ ref ] = ( show ?\n\t\t( positiveMotion ? \"+=\" : \"-=\") :\n\t\t( positiveMotion ? \"-=\" : \"+=\")) +\n\t\tdistance;\n\n\t// Animate\n\tel.animate( animation, {\n\t\tqueue: false,\n\t\tduration: o.duration,\n\t\teasing: o.easing,\n\t\tcomplete: function() {\n\t\t\tif ( mode === \"hide\" ) {\n\t\t\t\tel.hide();\n\t\t\t}\n\t\t\t$.effects.restore( el, props );\n\t\t\t$.effects.removeWrapper( el );\n\t\t\tdone();\n\t\t}\n\t});\n};\n\n\n/*!\n * jQuery UI Effects Transfer 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/transfer-effect/\n */\n\n\nvar effectTransfer = $.effects.effect.transfer = function( o, done ) {\n\tvar elem = $( this ),\n\t\ttarget = $( o.to ),\n\t\ttargetFixed = target.css( \"position\" ) === \"fixed\",\n\t\tbody = $(\"body\"),\n\t\tfixTop = targetFixed ? body.scrollTop() : 0,\n\t\tfixLeft = targetFixed ? body.scrollLeft() : 0,\n\t\tendPosition = target.offset(),\n\t\tanimation = {\n\t\t\ttop: endPosition.top - fixTop,\n\t\t\tleft: endPosition.left - fixLeft,\n\t\t\theight: target.innerHeight(),\n\t\t\twidth: target.innerWidth()\n\t\t},\n\t\tstartPosition = elem.offset(),\n\t\ttransfer = $( \"<div class='ui-effects-transfer'></div>\" )\n\t\t\t.appendTo( document.body )\n\t\t\t.addClass( o.className )\n\t\t\t.css({\n\t\t\t\ttop: startPosition.top - fixTop,\n\t\t\t\tleft: startPosition.left - fixLeft,\n\t\t\t\theight: elem.innerHeight(),\n\t\t\t\twidth: elem.innerWidth(),\n\t\t\t\tposition: targetFixed ? \"fixed\" : \"absolute\"\n\t\t\t})\n\t\t\t.animate( animation, o.duration, o.easing, function() {\n\t\t\t\ttransfer.remove();\n\t\t\t\tdone();\n\t\t\t});\n};\n\n\n/*!\n * jQuery UI Progressbar 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/progressbar/\n */\n\n\nvar progressbar = $.widget( \"ui.progressbar\", {\n\tversion: \"1.11.4\",\n\toptions: {\n\t\tmax: 100,\n\t\tvalue: 0,\n\n\t\tchange: null,\n\t\tcomplete: null\n\t},\n\n\tmin: 0,\n\n\t_create: function() {\n\t\t// Constrain initial value\n\t\tthis.oldValue = this.options.value = this._constrainedValue();\n\n\t\tthis.element\n\t\t\t.addClass( \"ui-progressbar ui-widget ui-widget-content ui-corner-all\" )\n\t\t\t.attr({\n\t\t\t\t// Only set static values, aria-valuenow and aria-valuemax are\n\t\t\t\t// set inside _refreshValue()\n\t\t\t\trole: \"progressbar\",\n\t\t\t\t\"aria-valuemin\": this.min\n\t\t\t});\n\n\t\tthis.valueDiv = $( \"<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>\" )\n\t\t\t.appendTo( this.element );\n\n\t\tthis._refreshValue();\n\t},\n\n\t_destroy: function() {\n\t\tthis.element\n\t\t\t.removeClass( \"ui-progressbar ui-widget ui-widget-content ui-corner-all\" )\n\t\t\t.removeAttr( \"role\" )\n\t\t\t.removeAttr( \"aria-valuemin\" )\n\t\t\t.removeAttr( \"aria-valuemax\" )\n\t\t\t.removeAttr( \"aria-valuenow\" );\n\n\t\tthis.valueDiv.remove();\n\t},\n\n\tvalue: function( newValue ) {\n\t\tif ( newValue === undefined ) {\n\t\t\treturn this.options.value;\n\t\t}\n\n\t\tthis.options.value = this._constrainedValue( newValue );\n\t\tthis._refreshValue();\n\t},\n\n\t_constrainedValue: function( newValue ) {\n\t\tif ( newValue === undefined ) {\n\t\t\tnewValue = this.options.value;\n\t\t}\n\n\t\tthis.indeterminate = newValue === false;\n\n\t\t// sanitize value\n\t\tif ( typeof newValue !== \"number\" ) {\n\t\t\tnewValue = 0;\n\t\t}\n\n\t\treturn this.indeterminate ? false :\n\t\t\tMath.min( this.options.max, Math.max( this.min, newValue ) );\n\t},\n\n\t_setOptions: function( options ) {\n\t\t// Ensure \"value\" option is set after other values (like max)\n\t\tvar value = options.value;\n\t\tdelete options.value;\n\n\t\tthis._super( options );\n\n\t\tthis.options.value = this._constrainedValue( value );\n\t\tthis._refreshValue();\n\t},\n\n\t_setOption: function( key, value ) {\n\t\tif ( key === \"max\" ) {\n\t\t\t// Don't allow a max less than min\n\t\t\tvalue = Math.max( this.min, value );\n\t\t}\n\t\tif ( key === \"disabled\" ) {\n\t\t\tthis.element\n\t\t\t\t.toggleClass( \"ui-state-disabled\", !!value )\n\t\t\t\t.attr( \"aria-disabled\", value );\n\t\t}\n\t\tthis._super( key, value );\n\t},\n\n\t_percentage: function() {\n\t\treturn this.indeterminate ? 100 : 100 * ( this.options.value - this.min ) / ( this.options.max - this.min );\n\t},\n\n\t_refreshValue: function() {\n\t\tvar value = this.options.value,\n\t\t\tpercentage = this._percentage();\n\n\t\tthis.valueDiv\n\t\t\t.toggle( this.indeterminate || value > this.min )\n\t\t\t.toggleClass( \"ui-corner-right\", value === this.options.max )\n\t\t\t.width( percentage.toFixed(0) + \"%\" );\n\n\t\tthis.element.toggleClass( \"ui-progressbar-indeterminate\", this.indeterminate );\n\n\t\tif ( this.indeterminate ) {\n\t\t\tthis.element.removeAttr( \"aria-valuenow\" );\n\t\t\tif ( !this.overlayDiv ) {\n\t\t\t\tthis.overlayDiv = $( \"<div class='ui-progressbar-overlay'></div>\" ).appendTo( this.valueDiv );\n\t\t\t}\n\t\t} else {\n\t\t\tthis.element.attr({\n\t\t\t\t\"aria-valuemax\": this.options.max,\n\t\t\t\t\"aria-valuenow\": value\n\t\t\t});\n\t\t\tif ( this.overlayDiv ) {\n\t\t\t\tthis.overlayDiv.remove();\n\t\t\t\tthis.overlayDiv = null;\n\t\t\t}\n\t\t}\n\n\t\tif ( this.oldValue !== value ) {\n\t\t\tthis.oldValue = value;\n\t\t\tthis._trigger( \"change\" );\n\t\t}\n\t\tif ( value === this.options.max ) {\n\t\t\tthis._trigger( \"complete\" );\n\t\t}\n\t}\n});\n\n\n/*!\n * jQuery UI Selectable 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/selectable/\n */\n\n\nvar selectable = $.widget(\"ui.selectable\", $.ui.mouse, {\n\tversion: \"1.11.4\",\n\toptions: {\n\t\tappendTo: \"body\",\n\t\tautoRefresh: true,\n\t\tdistance: 0,\n\t\tfilter: \"*\",\n\t\ttolerance: \"touch\",\n\n\t\t// callbacks\n\t\tselected: null,\n\t\tselecting: null,\n\t\tstart: null,\n\t\tstop: null,\n\t\tunselected: null,\n\t\tunselecting: null\n\t},\n\t_create: function() {\n\t\tvar selectees,\n\t\t\tthat = this;\n\n\t\tthis.element.addClass(\"ui-selectable\");\n\n\t\tthis.dragged = false;\n\n\t\t// cache selectee children based on filter\n\t\tthis.refresh = function() {\n\t\t\tselectees = $(that.options.filter, that.element[0]);\n\t\t\tselectees.addClass(\"ui-selectee\");\n\t\t\tselectees.each(function() {\n\t\t\t\tvar $this = $(this),\n\t\t\t\t\tpos = $this.offset();\n\t\t\t\t$.data(this, \"selectable-item\", {\n\t\t\t\t\telement: this,\n\t\t\t\t\t$element: $this,\n\t\t\t\t\tleft: pos.left,\n\t\t\t\t\ttop: pos.top,\n\t\t\t\t\tright: pos.left + $this.outerWidth(),\n\t\t\t\t\tbottom: pos.top + $this.outerHeight(),\n\t\t\t\t\tstartselected: false,\n\t\t\t\t\tselected: $this.hasClass(\"ui-selected\"),\n\t\t\t\t\tselecting: $this.hasClass(\"ui-selecting\"),\n\t\t\t\t\tunselecting: $this.hasClass(\"ui-unselecting\")\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\t\tthis.refresh();\n\n\t\tthis.selectees = selectees.addClass(\"ui-selectee\");\n\n\t\tthis._mouseInit();\n\n\t\tthis.helper = $(\"<div class='ui-selectable-helper'></div>\");\n\t},\n\n\t_destroy: function() {\n\t\tthis.selectees\n\t\t\t.removeClass(\"ui-selectee\")\n\t\t\t.removeData(\"selectable-item\");\n\t\tthis.element\n\t\t\t.removeClass(\"ui-selectable ui-selectable-disabled\");\n\t\tthis._mouseDestroy();\n\t},\n\n\t_mouseStart: function(event) {\n\t\tvar that = this,\n\t\t\toptions = this.options;\n\n\t\tthis.opos = [ event.pageX, event.pageY ];\n\n\t\tif (this.options.disabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.selectees = $(options.filter, this.element[0]);\n\n\t\tthis._trigger(\"start\", event);\n\n\t\t$(options.appendTo).append(this.helper);\n\t\t// position helper (lasso)\n\t\tthis.helper.css({\n\t\t\t\"left\": event.pageX,\n\t\t\t\"top\": event.pageY,\n\t\t\t\"width\": 0,\n\t\t\t\"height\": 0\n\t\t});\n\n\t\tif (options.autoRefresh) {\n\t\t\tthis.refresh();\n\t\t}\n\n\t\tthis.selectees.filter(\".ui-selected\").each(function() {\n\t\t\tvar selectee = $.data(this, \"selectable-item\");\n\t\t\tselectee.startselected = true;\n\t\t\tif (!event.metaKey && !event.ctrlKey) {\n\t\t\t\tselectee.$element.removeClass(\"ui-selected\");\n\t\t\t\tselectee.selected = false;\n\t\t\t\tselectee.$element.addClass(\"ui-unselecting\");\n\t\t\t\tselectee.unselecting = true;\n\t\t\t\t// selectable UNSELECTING callback\n\t\t\t\tthat._trigger(\"unselecting\", event, {\n\t\t\t\t\tunselecting: selectee.element\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t$(event.target).parents().addBack().each(function() {\n\t\t\tvar doSelect,\n\t\t\t\tselectee = $.data(this, \"selectable-item\");\n\t\t\tif (selectee) {\n\t\t\t\tdoSelect = (!event.metaKey && !event.ctrlKey) || !selectee.$element.hasClass(\"ui-selected\");\n\t\t\t\tselectee.$element\n\t\t\t\t\t.removeClass(doSelect ? \"ui-unselecting\" : \"ui-selected\")\n\t\t\t\t\t.addClass(doSelect ? \"ui-selecting\" : \"ui-unselecting\");\n\t\t\t\tselectee.unselecting = !doSelect;\n\t\t\t\tselectee.selecting = doSelect;\n\t\t\t\tselectee.selected = doSelect;\n\t\t\t\t// selectable (UN)SELECTING callback\n\t\t\t\tif (doSelect) {\n\t\t\t\t\tthat._trigger(\"selecting\", event, {\n\t\t\t\t\t\tselecting: selectee.element\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthat._trigger(\"unselecting\", event, {\n\t\t\t\t\t\tunselecting: selectee.element\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\n\t},\n\n\t_mouseDrag: function(event) {\n\n\t\tthis.dragged = true;\n\n\t\tif (this.options.disabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar tmp,\n\t\t\tthat = this,\n\t\t\toptions = this.options,\n\t\t\tx1 = this.opos[0],\n\t\t\ty1 = this.opos[1],\n\t\t\tx2 = event.pageX,\n\t\t\ty2 = event.pageY;\n\n\t\tif (x1 > x2) { tmp = x2; x2 = x1; x1 = tmp; }\n\t\tif (y1 > y2) { tmp = y2; y2 = y1; y1 = tmp; }\n\t\tthis.helper.css({ left: x1, top: y1, width: x2 - x1, height: y2 - y1 });\n\n\t\tthis.selectees.each(function() {\n\t\t\tvar selectee = $.data(this, \"selectable-item\"),\n\t\t\t\thit = false;\n\n\t\t\t//prevent helper from being selected if appendTo: selectable\n\t\t\tif (!selectee || selectee.element === that.element[0]) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (options.tolerance === \"touch\") {\n\t\t\t\thit = ( !(selectee.left > x2 || selectee.right < x1 || selectee.top > y2 || selectee.bottom < y1) );\n\t\t\t} else if (options.tolerance === \"fit\") {\n\t\t\t\thit = (selectee.left > x1 && selectee.right < x2 && selectee.top > y1 && selectee.bottom < y2);\n\t\t\t}\n\n\t\t\tif (hit) {\n\t\t\t\t// SELECT\n\t\t\t\tif (selectee.selected) {\n\t\t\t\t\tselectee.$element.removeClass(\"ui-selected\");\n\t\t\t\t\tselectee.selected = false;\n\t\t\t\t}\n\t\t\t\tif (selectee.unselecting) {\n\t\t\t\t\tselectee.$element.removeClass(\"ui-unselecting\");\n\t\t\t\t\tselectee.unselecting = false;\n\t\t\t\t}\n\t\t\t\tif (!selectee.selecting) {\n\t\t\t\t\tselectee.$element.addClass(\"ui-selecting\");\n\t\t\t\t\tselectee.selecting = true;\n\t\t\t\t\t// selectable SELECTING callback\n\t\t\t\t\tthat._trigger(\"selecting\", event, {\n\t\t\t\t\t\tselecting: selectee.element\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// UNSELECT\n\t\t\t\tif (selectee.selecting) {\n\t\t\t\t\tif ((event.metaKey || event.ctrlKey) && selectee.startselected) {\n\t\t\t\t\t\tselectee.$element.removeClass(\"ui-selecting\");\n\t\t\t\t\t\tselectee.selecting = false;\n\t\t\t\t\t\tselectee.$element.addClass(\"ui-selected\");\n\t\t\t\t\t\tselectee.selected = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tselectee.$element.removeClass(\"ui-selecting\");\n\t\t\t\t\t\tselectee.selecting = false;\n\t\t\t\t\t\tif (selectee.startselected) {\n\t\t\t\t\t\t\tselectee.$element.addClass(\"ui-unselecting\");\n\t\t\t\t\t\t\tselectee.unselecting = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// selectable UNSELECTING callback\n\t\t\t\t\t\tthat._trigger(\"unselecting\", event, {\n\t\t\t\t\t\t\tunselecting: selectee.element\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (selectee.selected) {\n\t\t\t\t\tif (!event.metaKey && !event.ctrlKey && !selectee.startselected) {\n\t\t\t\t\t\tselectee.$element.removeClass(\"ui-selected\");\n\t\t\t\t\t\tselectee.selected = false;\n\n\t\t\t\t\t\tselectee.$element.addClass(\"ui-unselecting\");\n\t\t\t\t\t\tselectee.unselecting = true;\n\t\t\t\t\t\t// selectable UNSELECTING callback\n\t\t\t\t\t\tthat._trigger(\"unselecting\", event, {\n\t\t\t\t\t\t\tunselecting: selectee.element\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn false;\n\t},\n\n\t_mouseStop: function(event) {\n\t\tvar that = this;\n\n\t\tthis.dragged = false;\n\n\t\t$(\".ui-unselecting\", this.element[0]).each(function() {\n\t\t\tvar selectee = $.data(this, \"selectable-item\");\n\t\t\tselectee.$element.removeClass(\"ui-unselecting\");\n\t\t\tselectee.unselecting = false;\n\t\t\tselectee.startselected = false;\n\t\t\tthat._trigger(\"unselected\", event, {\n\t\t\t\tunselected: selectee.element\n\t\t\t});\n\t\t});\n\t\t$(\".ui-selecting\", this.element[0]).each(function() {\n\t\t\tvar selectee = $.data(this, \"selectable-item\");\n\t\t\tselectee.$element.removeClass(\"ui-selecting\").addClass(\"ui-selected\");\n\t\t\tselectee.selecting = false;\n\t\t\tselectee.selected = true;\n\t\t\tselectee.startselected = true;\n\t\t\tthat._trigger(\"selected\", event, {\n\t\t\t\tselected: selectee.element\n\t\t\t});\n\t\t});\n\t\tthis._trigger(\"stop\", event);\n\n\t\tthis.helper.remove();\n\n\t\treturn false;\n\t}\n\n});\n\n\n/*!\n * jQuery UI Selectmenu 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/selectmenu\n */\n\n\nvar selectmenu = $.widget( \"ui.selectmenu\", {\n\tversion: \"1.11.4\",\n\tdefaultElement: \"<select>\",\n\toptions: {\n\t\tappendTo: null,\n\t\tdisabled: null,\n\t\ticons: {\n\t\t\tbutton: \"ui-icon-triangle-1-s\"\n\t\t},\n\t\tposition: {\n\t\t\tmy: \"left top\",\n\t\t\tat: \"left bottom\",\n\t\t\tcollision: \"none\"\n\t\t},\n\t\twidth: null,\n\n\t\t// callbacks\n\t\tchange: null,\n\t\tclose: null,\n\t\tfocus: null,\n\t\topen: null,\n\t\tselect: null\n\t},\n\n\t_create: function() {\n\t\tvar selectmenuId = this.element.uniqueId().attr( \"id\" );\n\t\tthis.ids = {\n\t\t\telement: selectmenuId,\n\t\t\tbutton: selectmenuId + \"-button\",\n\t\t\tmenu: selectmenuId + \"-menu\"\n\t\t};\n\n\t\tthis._drawButton();\n\t\tthis._drawMenu();\n\n\t\tif ( this.options.disabled ) {\n\t\t\tthis.disable();\n\t\t}\n\t},\n\n\t_drawButton: function() {\n\t\tvar that = this;\n\n\t\t// Associate existing label with the new button\n\t\tthis.label = $( \"label[for='\" + this.ids.element + \"']\" ).attr( \"for\", this.ids.button );\n\t\tthis._on( this.label, {\n\t\t\tclick: function( event ) {\n\t\t\t\tthis.button.focus();\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t});\n\n\t\t// Hide original select element\n\t\tthis.element.hide();\n\n\t\t// Create button\n\t\tthis.button = $( \"<span>\", {\n\t\t\t\"class\": \"ui-selectmenu-button ui-widget ui-state-default ui-corner-all\",\n\t\t\ttabindex: this.options.disabled ? -1 : 0,\n\t\t\tid: this.ids.button,\n\t\t\trole: \"combobox\",\n\t\t\t\"aria-expanded\": \"false\",\n\t\t\t\"aria-autocomplete\": \"list\",\n\t\t\t\"aria-owns\": this.ids.menu,\n\t\t\t\"aria-haspopup\": \"true\"\n\t\t})\n\t\t\t.insertAfter( this.element );\n\n\t\t$( \"<span>\", {\n\t\t\t\"class\": \"ui-icon \" + this.options.icons.button\n\t\t})\n\t\t\t.prependTo( this.button );\n\n\t\tthis.buttonText = $( \"<span>\", {\n\t\t\t\"class\": \"ui-selectmenu-text\"\n\t\t})\n\t\t\t.appendTo( this.button );\n\n\t\tthis._setText( this.buttonText, this.element.find( \"option:selected\" ).text() );\n\t\tthis._resizeButton();\n\n\t\tthis._on( this.button, this._buttonEvents );\n\t\tthis.button.one( \"focusin\", function() {\n\n\t\t\t// Delay rendering the menu items until the button receives focus.\n\t\t\t// The menu may have already been rendered via a programmatic open.\n\t\t\tif ( !that.menuItems ) {\n\t\t\t\tthat._refreshMenu();\n\t\t\t}\n\t\t});\n\t\tthis._hoverable( this.button );\n\t\tthis._focusable( this.button );\n\t},\n\n\t_drawMenu: function() {\n\t\tvar that = this;\n\n\t\t// Create menu\n\t\tthis.menu = $( \"<ul>\", {\n\t\t\t\"aria-hidden\": \"true\",\n\t\t\t\"aria-labelledby\": this.ids.button,\n\t\t\tid: this.ids.menu\n\t\t});\n\n\t\t// Wrap menu\n\t\tthis.menuWrap = $( \"<div>\", {\n\t\t\t\"class\": \"ui-selectmenu-menu ui-front\"\n\t\t})\n\t\t\t.append( this.menu )\n\t\t\t.appendTo( this._appendTo() );\n\n\t\t// Initialize menu widget\n\t\tthis.menuInstance = this.menu\n\t\t\t.menu({\n\t\t\t\trole: \"listbox\",\n\t\t\t\tselect: function( event, ui ) {\n\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\t// support: IE8\n\t\t\t\t\t// If the item was selected via a click, the text selection\n\t\t\t\t\t// will be destroyed in IE\n\t\t\t\t\tthat._setSelection();\n\n\t\t\t\t\tthat._select( ui.item.data( \"ui-selectmenu-item\" ), event );\n\t\t\t\t},\n\t\t\t\tfocus: function( event, ui ) {\n\t\t\t\t\tvar item = ui.item.data( \"ui-selectmenu-item\" );\n\n\t\t\t\t\t// Prevent inital focus from firing and check if its a newly focused item\n\t\t\t\t\tif ( that.focusIndex != null && item.index !== that.focusIndex ) {\n\t\t\t\t\t\tthat._trigger( \"focus\", event, { item: item } );\n\t\t\t\t\t\tif ( !that.isOpen ) {\n\t\t\t\t\t\t\tthat._select( item, event );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthat.focusIndex = item.index;\n\n\t\t\t\t\tthat.button.attr( \"aria-activedescendant\",\n\t\t\t\t\t\tthat.menuItems.eq( item.index ).attr( \"id\" ) );\n\t\t\t\t}\n\t\t\t})\n\t\t\t.menu( \"instance\" );\n\n\t\t// Adjust menu styles to dropdown\n\t\tthis.menu\n\t\t\t.addClass( \"ui-corner-bottom\" )\n\t\t\t.removeClass( \"ui-corner-all\" );\n\n\t\t// Don't close the menu on mouseleave\n\t\tthis.menuInstance._off( this.menu, \"mouseleave\" );\n\n\t\t// Cancel the menu's collapseAll on document click\n\t\tthis.menuInstance._closeOnDocumentClick = function() {\n\t\t\treturn false;\n\t\t};\n\n\t\t// Selects often contain empty items, but never contain dividers\n\t\tthis.menuInstance._isDivider = function() {\n\t\t\treturn false;\n\t\t};\n\t},\n\n\trefresh: function() {\n\t\tthis._refreshMenu();\n\t\tthis._setText( this.buttonText, this._getSelectedItem().text() );\n\t\tif ( !this.options.width ) {\n\t\t\tthis._resizeButton();\n\t\t}\n\t},\n\n\t_refreshMenu: function() {\n\t\tthis.menu.empty();\n\n\t\tvar item,\n\t\t\toptions = this.element.find( \"option\" );\n\n\t\tif ( !options.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._parseOptions( options );\n\t\tthis._renderMenu( this.menu, this.items );\n\n\t\tthis.menuInstance.refresh();\n\t\tthis.menuItems = this.menu.find( \"li\" ).not( \".ui-selectmenu-optgroup\" );\n\n\t\titem = this._getSelectedItem();\n\n\t\t// Update the menu to have the correct item focused\n\t\tthis.menuInstance.focus( null, item );\n\t\tthis._setAria( item.data( \"ui-selectmenu-item\" ) );\n\n\t\t// Set disabled state\n\t\tthis._setOption( \"disabled\", this.element.prop( \"disabled\" ) );\n\t},\n\n\topen: function( event ) {\n\t\tif ( this.options.disabled ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// If this is the first time the menu is being opened, render the items\n\t\tif ( !this.menuItems ) {\n\t\t\tthis._refreshMenu();\n\t\t} else {\n\n\t\t\t// Menu clears focus on close, reset focus to selected item\n\t\t\tthis.menu.find( \".ui-state-focus\" ).removeClass( \"ui-state-focus\" );\n\t\t\tthis.menuInstance.focus( null, this._getSelectedItem() );\n\t\t}\n\n\t\tthis.isOpen = true;\n\t\tthis._toggleAttr();\n\t\tthis._resizeMenu();\n\t\tthis._position();\n\n\t\tthis._on( this.document, this._documentClick );\n\n\t\tthis._trigger( \"open\", event );\n\t},\n\n\t_position: function() {\n\t\tthis.menuWrap.position( $.extend( { of: this.button }, this.options.position ) );\n\t},\n\n\tclose: function( event ) {\n\t\tif ( !this.isOpen ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.isOpen = false;\n\t\tthis._toggleAttr();\n\n\t\tthis.range = null;\n\t\tthis._off( this.document );\n\n\t\tthis._trigger( \"close\", event );\n\t},\n\n\twidget: function() {\n\t\treturn this.button;\n\t},\n\n\tmenuWidget: function() {\n\t\treturn this.menu;\n\t},\n\n\t_renderMenu: function( ul, items ) {\n\t\tvar that = this,\n\t\t\tcurrentOptgroup = \"\";\n\n\t\t$.each( items, function( index, item ) {\n\t\t\tif ( item.optgroup !== currentOptgroup ) {\n\t\t\t\t$( \"<li>\", {\n\t\t\t\t\t\"class\": \"ui-selectmenu-optgroup ui-menu-divider\" +\n\t\t\t\t\t\t( item.element.parent( \"optgroup\" ).prop( \"disabled\" ) ?\n\t\t\t\t\t\t\t\" ui-state-disabled\" :\n\t\t\t\t\t\t\t\"\" ),\n\t\t\t\t\ttext: item.optgroup\n\t\t\t\t})\n\t\t\t\t\t.appendTo( ul );\n\n\t\t\t\tcurrentOptgroup = item.optgroup;\n\t\t\t}\n\n\t\t\tthat._renderItemData( ul, item );\n\t\t});\n\t},\n\n\t_renderItemData: function( ul, item ) {\n\t\treturn this._renderItem( ul, item ).data( \"ui-selectmenu-item\", item );\n\t},\n\n\t_renderItem: function( ul, item ) {\n\t\tvar li = $( \"<li>\" );\n\n\t\tif ( item.disabled ) {\n\t\t\tli.addClass( \"ui-state-disabled\" );\n\t\t}\n\t\tthis._setText( li, item.label );\n\n\t\treturn li.appendTo( ul );\n\t},\n\n\t_setText: function( element, value ) {\n\t\tif ( value ) {\n\t\t\telement.text( value );\n\t\t} else {\n\t\t\telement.html( \"&#160;\" );\n\t\t}\n\t},\n\n\t_move: function( direction, event ) {\n\t\tvar item, next,\n\t\t\tfilter = \".ui-menu-item\";\n\n\t\tif ( this.isOpen ) {\n\t\t\titem = this.menuItems.eq( this.focusIndex );\n\t\t} else {\n\t\t\titem = this.menuItems.eq( this.element[ 0 ].selectedIndex );\n\t\t\tfilter += \":not(.ui-state-disabled)\";\n\t\t}\n\n\t\tif ( direction === \"first\" || direction === \"last\" ) {\n\t\t\tnext = item[ direction === \"first\" ? \"prevAll\" : \"nextAll\" ]( filter ).eq( -1 );\n\t\t} else {\n\t\t\tnext = item[ direction + \"All\" ]( filter ).eq( 0 );\n\t\t}\n\n\t\tif ( next.length ) {\n\t\t\tthis.menuInstance.focus( event, next );\n\t\t}\n\t},\n\n\t_getSelectedItem: function() {\n\t\treturn this.menuItems.eq( this.element[ 0 ].selectedIndex );\n\t},\n\n\t_toggle: function( event ) {\n\t\tthis[ this.isOpen ? \"close\" : \"open\" ]( event );\n\t},\n\n\t_setSelection: function() {\n\t\tvar selection;\n\n\t\tif ( !this.range ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( window.getSelection ) {\n\t\t\tselection = window.getSelection();\n\t\t\tselection.removeAllRanges();\n\t\t\tselection.addRange( this.range );\n\n\t\t// support: IE8\n\t\t} else {\n\t\t\tthis.range.select();\n\t\t}\n\n\t\t// support: IE\n\t\t// Setting the text selection kills the button focus in IE, but\n\t\t// restoring the focus doesn't kill the selection.\n\t\tthis.button.focus();\n\t},\n\n\t_documentClick: {\n\t\tmousedown: function( event ) {\n\t\t\tif ( !this.isOpen ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( !$( event.target ).closest( \".ui-selectmenu-menu, #\" + this.ids.button ).length ) {\n\t\t\t\tthis.close( event );\n\t\t\t}\n\t\t}\n\t},\n\n\t_buttonEvents: {\n\n\t\t// Prevent text selection from being reset when interacting with the selectmenu (#10144)\n\t\tmousedown: function() {\n\t\t\tvar selection;\n\n\t\t\tif ( window.getSelection ) {\n\t\t\t\tselection = window.getSelection();\n\t\t\t\tif ( selection.rangeCount ) {\n\t\t\t\t\tthis.range = selection.getRangeAt( 0 );\n\t\t\t\t}\n\n\t\t\t// support: IE8\n\t\t\t} else {\n\t\t\t\tthis.range = document.selection.createRange();\n\t\t\t}\n\t\t},\n\n\t\tclick: function( event ) {\n\t\t\tthis._setSelection();\n\t\t\tthis._toggle( event );\n\t\t},\n\n\t\tkeydown: function( event ) {\n\t\t\tvar preventDefault = true;\n\t\t\tswitch ( event.keyCode ) {\n\t\t\t\tcase $.ui.keyCode.TAB:\n\t\t\t\tcase $.ui.keyCode.ESCAPE:\n\t\t\t\t\tthis.close( event );\n\t\t\t\t\tpreventDefault = false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase $.ui.keyCode.ENTER:\n\t\t\t\t\tif ( this.isOpen ) {\n\t\t\t\t\t\tthis._selectFocusedItem( event );\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase $.ui.keyCode.UP:\n\t\t\t\t\tif ( event.altKey ) {\n\t\t\t\t\t\tthis._toggle( event );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._move( \"prev\", event );\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase $.ui.keyCode.DOWN:\n\t\t\t\t\tif ( event.altKey ) {\n\t\t\t\t\t\tthis._toggle( event );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._move( \"next\", event );\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase $.ui.keyCode.SPACE:\n\t\t\t\t\tif ( this.isOpen ) {\n\t\t\t\t\t\tthis._selectFocusedItem( event );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._toggle( event );\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase $.ui.keyCode.LEFT:\n\t\t\t\t\tthis._move( \"prev\", event );\n\t\t\t\t\tbreak;\n\t\t\t\tcase $.ui.keyCode.RIGHT:\n\t\t\t\t\tthis._move( \"next\", event );\n\t\t\t\t\tbreak;\n\t\t\t\tcase $.ui.keyCode.HOME:\n\t\t\t\tcase $.ui.keyCode.PAGE_UP:\n\t\t\t\t\tthis._move( \"first\", event );\n\t\t\t\t\tbreak;\n\t\t\t\tcase $.ui.keyCode.END:\n\t\t\t\tcase $.ui.keyCode.PAGE_DOWN:\n\t\t\t\t\tthis._move( \"last\", event );\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthis.menu.trigger( event );\n\t\t\t\t\tpreventDefault = false;\n\t\t\t}\n\n\t\t\tif ( preventDefault ) {\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t}\n\t},\n\n\t_selectFocusedItem: function( event ) {\n\t\tvar item = this.menuItems.eq( this.focusIndex );\n\t\tif ( !item.hasClass( \"ui-state-disabled\" ) ) {\n\t\t\tthis._select( item.data( \"ui-selectmenu-item\" ), event );\n\t\t}\n\t},\n\n\t_select: function( item, event ) {\n\t\tvar oldIndex = this.element[ 0 ].selectedIndex;\n\n\t\t// Change native select element\n\t\tthis.element[ 0 ].selectedIndex = item.index;\n\t\tthis._setText( this.buttonText, item.label );\n\t\tthis._setAria( item );\n\t\tthis._trigger( \"select\", event, { item: item } );\n\n\t\tif ( item.index !== oldIndex ) {\n\t\t\tthis._trigger( \"change\", event, { item: item } );\n\t\t}\n\n\t\tthis.close( event );\n\t},\n\n\t_setAria: function( item ) {\n\t\tvar id = this.menuItems.eq( item.index ).attr( \"id\" );\n\n\t\tthis.button.attr({\n\t\t\t\"aria-labelledby\": id,\n\t\t\t\"aria-activedescendant\": id\n\t\t});\n\t\tthis.menu.attr( \"aria-activedescendant\", id );\n\t},\n\n\t_setOption: function( key, value ) {\n\t\tif ( key === \"icons\" ) {\n\t\t\tthis.button.find( \"span.ui-icon\" )\n\t\t\t\t.removeClass( this.options.icons.button )\n\t\t\t\t.addClass( value.button );\n\t\t}\n\n\t\tthis._super( key, value );\n\n\t\tif ( key === \"appendTo\" ) {\n\t\t\tthis.menuWrap.appendTo( this._appendTo() );\n\t\t}\n\n\t\tif ( key === \"disabled\" ) {\n\t\t\tthis.menuInstance.option( \"disabled\", value );\n\t\t\tthis.button\n\t\t\t\t.toggleClass( \"ui-state-disabled\", value )\n\t\t\t\t.attr( \"aria-disabled\", value );\n\n\t\t\tthis.element.prop( \"disabled\", value );\n\t\t\tif ( value ) {\n\t\t\t\tthis.button.attr( \"tabindex\", -1 );\n\t\t\t\tthis.close();\n\t\t\t} else {\n\t\t\t\tthis.button.attr( \"tabindex\", 0 );\n\t\t\t}\n\t\t}\n\n\t\tif ( key === \"width\" ) {\n\t\t\tthis._resizeButton();\n\t\t}\n\t},\n\n\t_appendTo: function() {\n\t\tvar element = this.options.appendTo;\n\n\t\tif ( element ) {\n\t\t\telement = element.jquery || element.nodeType ?\n\t\t\t\t$( element ) :\n\t\t\t\tthis.document.find( element ).eq( 0 );\n\t\t}\n\n\t\tif ( !element || !element[ 0 ] ) {\n\t\t\telement = this.element.closest( \".ui-front\" );\n\t\t}\n\n\t\tif ( !element.length ) {\n\t\t\telement = this.document[ 0 ].body;\n\t\t}\n\n\t\treturn element;\n\t},\n\n\t_toggleAttr: function() {\n\t\tthis.button\n\t\t\t.toggleClass( \"ui-corner-top\", this.isOpen )\n\t\t\t.toggleClass( \"ui-corner-all\", !this.isOpen )\n\t\t\t.attr( \"aria-expanded\", this.isOpen );\n\t\tthis.menuWrap.toggleClass( \"ui-selectmenu-open\", this.isOpen );\n\t\tthis.menu.attr( \"aria-hidden\", !this.isOpen );\n\t},\n\n\t_resizeButton: function() {\n\t\tvar width = this.options.width;\n\n\t\tif ( !width ) {\n\t\t\twidth = this.element.show().outerWidth();\n\t\t\tthis.element.hide();\n\t\t}\n\n\t\tthis.button.outerWidth( width );\n\t},\n\n\t_resizeMenu: function() {\n\t\tthis.menu.outerWidth( Math.max(\n\t\t\tthis.button.outerWidth(),\n\n\t\t\t// support: IE10\n\t\t\t// IE10 wraps long text (possibly a rounding bug)\n\t\t\t// so we add 1px to avoid the wrapping\n\t\t\tthis.menu.width( \"\" ).outerWidth() + 1\n\t\t) );\n\t},\n\n\t_getCreateOptions: function() {\n\t\treturn { disabled: this.element.prop( \"disabled\" ) };\n\t},\n\n\t_parseOptions: function( options ) {\n\t\tvar data = [];\n\t\toptions.each(function( index, item ) {\n\t\t\tvar option = $( item ),\n\t\t\t\toptgroup = option.parent( \"optgroup\" );\n\t\t\tdata.push({\n\t\t\t\telement: option,\n\t\t\t\tindex: index,\n\t\t\t\tvalue: option.val(),\n\t\t\t\tlabel: option.text(),\n\t\t\t\toptgroup: optgroup.attr( \"label\" ) || \"\",\n\t\t\t\tdisabled: optgroup.prop( \"disabled\" ) || option.prop( \"disabled\" )\n\t\t\t});\n\t\t});\n\t\tthis.items = data;\n\t},\n\n\t_destroy: function() {\n\t\tthis.menuWrap.remove();\n\t\tthis.button.remove();\n\t\tthis.element.show();\n\t\tthis.element.removeUniqueId();\n\t\tthis.label.attr( \"for\", this.ids.element );\n\t}\n});\n\n\n/*!\n * jQuery UI Slider 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/slider/\n */\n\n\nvar slider = $.widget( \"ui.slider\", $.ui.mouse, {\n\tversion: \"1.11.4\",\n\twidgetEventPrefix: \"slide\",\n\n\toptions: {\n\t\tanimate: false,\n\t\tdistance: 0,\n\t\tmax: 100,\n\t\tmin: 0,\n\t\torientation: \"horizontal\",\n\t\trange: false,\n\t\tstep: 1,\n\t\tvalue: 0,\n\t\tvalues: null,\n\n\t\t// callbacks\n\t\tchange: null,\n\t\tslide: null,\n\t\tstart: null,\n\t\tstop: null\n\t},\n\n\t// number of pages in a slider\n\t// (how many times can you page up/down to go through the whole range)\n\tnumPages: 5,\n\n\t_create: function() {\n\t\tthis._keySliding = false;\n\t\tthis._mouseSliding = false;\n\t\tthis._animateOff = true;\n\t\tthis._handleIndex = null;\n\t\tthis._detectOrientation();\n\t\tthis._mouseInit();\n\t\tthis._calculateNewMax();\n\n\t\tthis.element\n\t\t\t.addClass( \"ui-slider\" +\n\t\t\t\t\" ui-slider-\" + this.orientation +\n\t\t\t\t\" ui-widget\" +\n\t\t\t\t\" ui-widget-content\" +\n\t\t\t\t\" ui-corner-all\");\n\n\t\tthis._refresh();\n\t\tthis._setOption( \"disabled\", this.options.disabled );\n\n\t\tthis._animateOff = false;\n\t},\n\n\t_refresh: function() {\n\t\tthis._createRange();\n\t\tthis._createHandles();\n\t\tthis._setupEvents();\n\t\tthis._refreshValue();\n\t},\n\n\t_createHandles: function() {\n\t\tvar i, handleCount,\n\t\t\toptions = this.options,\n\t\t\texistingHandles = this.element.find( \".ui-slider-handle\" ).addClass( \"ui-state-default ui-corner-all\" ),\n\t\t\thandle = \"<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>\",\n\t\t\thandles = [];\n\n\t\thandleCount = ( options.values && options.values.length ) || 1;\n\n\t\tif ( existingHandles.length > handleCount ) {\n\t\t\texistingHandles.slice( handleCount ).remove();\n\t\t\texistingHandles = existingHandles.slice( 0, handleCount );\n\t\t}\n\n\t\tfor ( i = existingHandles.length; i < handleCount; i++ ) {\n\t\t\thandles.push( handle );\n\t\t}\n\n\t\tthis.handles = existingHandles.add( $( handles.join( \"\" ) ).appendTo( this.element ) );\n\n\t\tthis.handle = this.handles.eq( 0 );\n\n\t\tthis.handles.each(function( i ) {\n\t\t\t$( this ).data( \"ui-slider-handle-index\", i );\n\t\t});\n\t},\n\n\t_createRange: function() {\n\t\tvar options = this.options,\n\t\t\tclasses = \"\";\n\n\t\tif ( options.range ) {\n\t\t\tif ( options.range === true ) {\n\t\t\t\tif ( !options.values ) {\n\t\t\t\t\toptions.values = [ this._valueMin(), this._valueMin() ];\n\t\t\t\t} else if ( options.values.length && options.values.length !== 2 ) {\n\t\t\t\t\toptions.values = [ options.values[0], options.values[0] ];\n\t\t\t\t} else if ( $.isArray( options.values ) ) {\n\t\t\t\t\toptions.values = options.values.slice(0);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( !this.range || !this.range.length ) {\n\t\t\t\tthis.range = $( \"<div></div>\" )\n\t\t\t\t\t.appendTo( this.element );\n\n\t\t\t\tclasses = \"ui-slider-range\" +\n\t\t\t\t// note: this isn't the most fittingly semantic framework class for this element,\n\t\t\t\t// but worked best visually with a variety of themes\n\t\t\t\t\" ui-widget-header ui-corner-all\";\n\t\t\t} else {\n\t\t\t\tthis.range.removeClass( \"ui-slider-range-min ui-slider-range-max\" )\n\t\t\t\t\t// Handle range switching from true to min/max\n\t\t\t\t\t.css({\n\t\t\t\t\t\t\"left\": \"\",\n\t\t\t\t\t\t\"bottom\": \"\"\n\t\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.range.addClass( classes +\n\t\t\t\t( ( options.range === \"min\" || options.range === \"max\" ) ? \" ui-slider-range-\" + options.range : \"\" ) );\n\t\t} else {\n\t\t\tif ( this.range ) {\n\t\t\t\tthis.range.remove();\n\t\t\t}\n\t\t\tthis.range = null;\n\t\t}\n\t},\n\n\t_setupEvents: function() {\n\t\tthis._off( this.handles );\n\t\tthis._on( this.handles, this._handleEvents );\n\t\tthis._hoverable( this.handles );\n\t\tthis._focusable( this.handles );\n\t},\n\n\t_destroy: function() {\n\t\tthis.handles.remove();\n\t\tif ( this.range ) {\n\t\t\tthis.range.remove();\n\t\t}\n\n\t\tthis.element\n\t\t\t.removeClass( \"ui-slider\" +\n\t\t\t\t\" ui-slider-horizontal\" +\n\t\t\t\t\" ui-slider-vertical\" +\n\t\t\t\t\" ui-widget\" +\n\t\t\t\t\" ui-widget-content\" +\n\t\t\t\t\" ui-corner-all\" );\n\n\t\tthis._mouseDestroy();\n\t},\n\n\t_mouseCapture: function( event ) {\n\t\tvar position, normValue, distance, closestHandle, index, allowed, offset, mouseOverHandle,\n\t\t\tthat = this,\n\t\t\to = this.options;\n\n\t\tif ( o.disabled ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.elementSize = {\n\t\t\twidth: this.element.outerWidth(),\n\t\t\theight: this.element.outerHeight()\n\t\t};\n\t\tthis.elementOffset = this.element.offset();\n\n\t\tposition = { x: event.pageX, y: event.pageY };\n\t\tnormValue = this._normValueFromMouse( position );\n\t\tdistance = this._valueMax() - this._valueMin() + 1;\n\t\tthis.handles.each(function( i ) {\n\t\t\tvar thisDistance = Math.abs( normValue - that.values(i) );\n\t\t\tif (( distance > thisDistance ) ||\n\t\t\t\t( distance === thisDistance &&\n\t\t\t\t\t(i === that._lastChangedValue || that.values(i) === o.min ))) {\n\t\t\t\tdistance = thisDistance;\n\t\t\t\tclosestHandle = $( this );\n\t\t\t\tindex = i;\n\t\t\t}\n\t\t});\n\n\t\tallowed = this._start( event, index );\n\t\tif ( allowed === false ) {\n\t\t\treturn false;\n\t\t}\n\t\tthis._mouseSliding = true;\n\n\t\tthis._handleIndex = index;\n\n\t\tclosestHandle\n\t\t\t.addClass( \"ui-state-active\" )\n\t\t\t.focus();\n\n\t\toffset = closestHandle.offset();\n\t\tmouseOverHandle = !$( event.target ).parents().addBack().is( \".ui-slider-handle\" );\n\t\tthis._clickOffset = mouseOverHandle ? { left: 0, top: 0 } : {\n\t\t\tleft: event.pageX - offset.left - ( closestHandle.width() / 2 ),\n\t\t\ttop: event.pageY - offset.top -\n\t\t\t\t( closestHandle.height() / 2 ) -\n\t\t\t\t( parseInt( closestHandle.css(\"borderTopWidth\"), 10 ) || 0 ) -\n\t\t\t\t( parseInt( closestHandle.css(\"borderBottomWidth\"), 10 ) || 0) +\n\t\t\t\t( parseInt( closestHandle.css(\"marginTop\"), 10 ) || 0)\n\t\t};\n\n\t\tif ( !this.handles.hasClass( \"ui-state-hover\" ) ) {\n\t\t\tthis._slide( event, index, normValue );\n\t\t}\n\t\tthis._animateOff = true;\n\t\treturn true;\n\t},\n\n\t_mouseStart: function() {\n\t\treturn true;\n\t},\n\n\t_mouseDrag: function( event ) {\n\t\tvar position = { x: event.pageX, y: event.pageY },\n\t\t\tnormValue = this._normValueFromMouse( position );\n\n\t\tthis._slide( event, this._handleIndex, normValue );\n\n\t\treturn false;\n\t},\n\n\t_mouseStop: function( event ) {\n\t\tthis.handles.removeClass( \"ui-state-active\" );\n\t\tthis._mouseSliding = false;\n\n\t\tthis._stop( event, this._handleIndex );\n\t\tthis._change( event, this._handleIndex );\n\n\t\tthis._handleIndex = null;\n\t\tthis._clickOffset = null;\n\t\tthis._animateOff = false;\n\n\t\treturn false;\n\t},\n\n\t_detectOrientation: function() {\n\t\tthis.orientation = ( this.options.orientation === \"vertical\" ) ? \"vertical\" : \"horizontal\";\n\t},\n\n\t_normValueFromMouse: function( position ) {\n\t\tvar pixelTotal,\n\t\t\tpixelMouse,\n\t\t\tpercentMouse,\n\t\t\tvalueTotal,\n\t\t\tvalueMouse;\n\n\t\tif ( this.orientation === \"horizontal\" ) {\n\t\t\tpixelTotal = this.elementSize.width;\n\t\t\tpixelMouse = position.x - this.elementOffset.left - ( this._clickOffset ? this._clickOffset.left : 0 );\n\t\t} else {\n\t\t\tpixelTotal = this.elementSize.height;\n\t\t\tpixelMouse = position.y - this.elementOffset.top - ( this._clickOffset ? this._clickOffset.top : 0 );\n\t\t}\n\n\t\tpercentMouse = ( pixelMouse / pixelTotal );\n\t\tif ( percentMouse > 1 ) {\n\t\t\tpercentMouse = 1;\n\t\t}\n\t\tif ( percentMouse < 0 ) {\n\t\t\tpercentMouse = 0;\n\t\t}\n\t\tif ( this.orientation === \"vertical\" ) {\n\t\t\tpercentMouse = 1 - percentMouse;\n\t\t}\n\n\t\tvalueTotal = this._valueMax() - this._valueMin();\n\t\tvalueMouse = this._valueMin() + percentMouse * valueTotal;\n\n\t\treturn this._trimAlignValue( valueMouse );\n\t},\n\n\t_start: function( event, index ) {\n\t\tvar uiHash = {\n\t\t\thandle: this.handles[ index ],\n\t\t\tvalue: this.value()\n\t\t};\n\t\tif ( this.options.values && this.options.values.length ) {\n\t\t\tuiHash.value = this.values( index );\n\t\t\tuiHash.values = this.values();\n\t\t}\n\t\treturn this._trigger( \"start\", event, uiHash );\n\t},\n\n\t_slide: function( event, index, newVal ) {\n\t\tvar otherVal,\n\t\t\tnewValues,\n\t\t\tallowed;\n\n\t\tif ( this.options.values && this.options.values.length ) {\n\t\t\totherVal = this.values( index ? 0 : 1 );\n\n\t\t\tif ( ( this.options.values.length === 2 && this.options.range === true ) &&\n\t\t\t\t\t( ( index === 0 && newVal > otherVal) || ( index === 1 && newVal < otherVal ) )\n\t\t\t\t) {\n\t\t\t\tnewVal = otherVal;\n\t\t\t}\n\n\t\t\tif ( newVal !== this.values( index ) ) {\n\t\t\t\tnewValues = this.values();\n\t\t\t\tnewValues[ index ] = newVal;\n\t\t\t\t// A slide can be canceled by returning false from the slide callback\n\t\t\t\tallowed = this._trigger( \"slide\", event, {\n\t\t\t\t\thandle: this.handles[ index ],\n\t\t\t\t\tvalue: newVal,\n\t\t\t\t\tvalues: newValues\n\t\t\t\t} );\n\t\t\t\totherVal = this.values( index ? 0 : 1 );\n\t\t\t\tif ( allowed !== false ) {\n\t\t\t\t\tthis.values( index, newVal );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif ( newVal !== this.value() ) {\n\t\t\t\t// A slide can be canceled by returning false from the slide callback\n\t\t\t\tallowed = this._trigger( \"slide\", event, {\n\t\t\t\t\thandle: this.handles[ index ],\n\t\t\t\t\tvalue: newVal\n\t\t\t\t} );\n\t\t\t\tif ( allowed !== false ) {\n\t\t\t\t\tthis.value( newVal );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t_stop: function( event, index ) {\n\t\tvar uiHash = {\n\t\t\thandle: this.handles[ index ],\n\t\t\tvalue: this.value()\n\t\t};\n\t\tif ( this.options.values && this.options.values.length ) {\n\t\t\tuiHash.value = this.values( index );\n\t\t\tuiHash.values = this.values();\n\t\t}\n\n\t\tthis._trigger( \"stop\", event, uiHash );\n\t},\n\n\t_change: function( event, index ) {\n\t\tif ( !this._keySliding && !this._mouseSliding ) {\n\t\t\tvar uiHash = {\n\t\t\t\thandle: this.handles[ index ],\n\t\t\t\tvalue: this.value()\n\t\t\t};\n\t\t\tif ( this.options.values && this.options.values.length ) {\n\t\t\t\tuiHash.value = this.values( index );\n\t\t\t\tuiHash.values = this.values();\n\t\t\t}\n\n\t\t\t//store the last changed value index for reference when handles overlap\n\t\t\tthis._lastChangedValue = index;\n\n\t\t\tthis._trigger( \"change\", event, uiHash );\n\t\t}\n\t},\n\n\tvalue: function( newValue ) {\n\t\tif ( arguments.length ) {\n\t\t\tthis.options.value = this._trimAlignValue( newValue );\n\t\t\tthis._refreshValue();\n\t\t\tthis._change( null, 0 );\n\t\t\treturn;\n\t\t}\n\n\t\treturn this._value();\n\t},\n\n\tvalues: function( index, newValue ) {\n\t\tvar vals,\n\t\t\tnewValues,\n\t\t\ti;\n\n\t\tif ( arguments.length > 1 ) {\n\t\t\tthis.options.values[ index ] = this._trimAlignValue( newValue );\n\t\t\tthis._refreshValue();\n\t\t\tthis._change( null, index );\n\t\t\treturn;\n\t\t}\n\n\t\tif ( arguments.length ) {\n\t\t\tif ( $.isArray( arguments[ 0 ] ) ) {\n\t\t\t\tvals = this.options.values;\n\t\t\t\tnewValues = arguments[ 0 ];\n\t\t\t\tfor ( i = 0; i < vals.length; i += 1 ) {\n\t\t\t\t\tvals[ i ] = this._trimAlignValue( newValues[ i ] );\n\t\t\t\t\tthis._change( null, i );\n\t\t\t\t}\n\t\t\t\tthis._refreshValue();\n\t\t\t} else {\n\t\t\t\tif ( this.options.values && this.options.values.length ) {\n\t\t\t\t\treturn this._values( index );\n\t\t\t\t} else {\n\t\t\t\t\treturn this.value();\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\treturn this._values();\n\t\t}\n\t},\n\n\t_setOption: function( key, value ) {\n\t\tvar i,\n\t\t\tvalsLength = 0;\n\n\t\tif ( key === \"range\" && this.options.range === true ) {\n\t\t\tif ( value === \"min\" ) {\n\t\t\t\tthis.options.value = this._values( 0 );\n\t\t\t\tthis.options.values = null;\n\t\t\t} else if ( value === \"max\" ) {\n\t\t\t\tthis.options.value = this._values( this.options.values.length - 1 );\n\t\t\t\tthis.options.values = null;\n\t\t\t}\n\t\t}\n\n\t\tif ( $.isArray( this.options.values ) ) {\n\t\t\tvalsLength = this.options.values.length;\n\t\t}\n\n\t\tif ( key === \"disabled\" ) {\n\t\t\tthis.element.toggleClass( \"ui-state-disabled\", !!value );\n\t\t}\n\n\t\tthis._super( key, value );\n\n\t\tswitch ( key ) {\n\t\t\tcase \"orientation\":\n\t\t\t\tthis._detectOrientation();\n\t\t\t\tthis.element\n\t\t\t\t\t.removeClass( \"ui-slider-horizontal ui-slider-vertical\" )\n\t\t\t\t\t.addClass( \"ui-slider-\" + this.orientation );\n\t\t\t\tthis._refreshValue();\n\n\t\t\t\t// Reset positioning from previous orientation\n\t\t\t\tthis.handles.css( value === \"horizontal\" ? \"bottom\" : \"left\", \"\" );\n\t\t\t\tbreak;\n\t\t\tcase \"value\":\n\t\t\t\tthis._animateOff = true;\n\t\t\t\tthis._refreshValue();\n\t\t\t\tthis._change( null, 0 );\n\t\t\t\tthis._animateOff = false;\n\t\t\t\tbreak;\n\t\t\tcase \"values\":\n\t\t\t\tthis._animateOff = true;\n\t\t\t\tthis._refreshValue();\n\t\t\t\tfor ( i = 0; i < valsLength; i += 1 ) {\n\t\t\t\t\tthis._change( null, i );\n\t\t\t\t}\n\t\t\t\tthis._animateOff = false;\n\t\t\t\tbreak;\n\t\t\tcase \"step\":\n\t\t\tcase \"min\":\n\t\t\tcase \"max\":\n\t\t\t\tthis._animateOff = true;\n\t\t\t\tthis._calculateNewMax();\n\t\t\t\tthis._refreshValue();\n\t\t\t\tthis._animateOff = false;\n\t\t\t\tbreak;\n\t\t\tcase \"range\":\n\t\t\t\tthis._animateOff = true;\n\t\t\t\tthis._refresh();\n\t\t\t\tthis._animateOff = false;\n\t\t\t\tbreak;\n\t\t}\n\t},\n\n\t//internal value getter\n\t// _value() returns value trimmed by min and max, aligned by step\n\t_value: function() {\n\t\tvar val = this.options.value;\n\t\tval = this._trimAlignValue( val );\n\n\t\treturn val;\n\t},\n\n\t//internal values getter\n\t// _values() returns array of values trimmed by min and max, aligned by step\n\t// _values( index ) returns single value trimmed by min and max, aligned by step\n\t_values: function( index ) {\n\t\tvar val,\n\t\t\tvals,\n\t\t\ti;\n\n\t\tif ( arguments.length ) {\n\t\t\tval = this.options.values[ index ];\n\t\t\tval = this._trimAlignValue( val );\n\n\t\t\treturn val;\n\t\t} else if ( this.options.values && this.options.values.length ) {\n\t\t\t// .slice() creates a copy of the array\n\t\t\t// this copy gets trimmed by min and max and then returned\n\t\t\tvals = this.options.values.slice();\n\t\t\tfor ( i = 0; i < vals.length; i += 1) {\n\t\t\t\tvals[ i ] = this._trimAlignValue( vals[ i ] );\n\t\t\t}\n\n\t\t\treturn vals;\n\t\t} else {\n\t\t\treturn [];\n\t\t}\n\t},\n\n\t// returns the step-aligned value that val is closest to, between (inclusive) min and max\n\t_trimAlignValue: function( val ) {\n\t\tif ( val <= this._valueMin() ) {\n\t\t\treturn this._valueMin();\n\t\t}\n\t\tif ( val >= this._valueMax() ) {\n\t\t\treturn this._valueMax();\n\t\t}\n\t\tvar step = ( this.options.step > 0 ) ? this.options.step : 1,\n\t\t\tvalModStep = (val - this._valueMin()) % step,\n\t\t\talignValue = val - valModStep;\n\n\t\tif ( Math.abs(valModStep) * 2 >= step ) {\n\t\t\talignValue += ( valModStep > 0 ) ? step : ( -step );\n\t\t}\n\n\t\t// Since JavaScript has problems with large floats, round\n\t\t// the final value to 5 digits after the decimal point (see #4124)\n\t\treturn parseFloat( alignValue.toFixed(5) );\n\t},\n\n\t_calculateNewMax: function() {\n\t\tvar max = this.options.max,\n\t\t\tmin = this._valueMin(),\n\t\t\tstep = this.options.step,\n\t\t\taboveMin = Math.floor( ( +( max - min ).toFixed( this._precision() ) ) / step ) * step;\n\t\tmax = aboveMin + min;\n\t\tthis.max = parseFloat( max.toFixed( this._precision() ) );\n\t},\n\n\t_precision: function() {\n\t\tvar precision = this._precisionOf( this.options.step );\n\t\tif ( this.options.min !== null ) {\n\t\t\tprecision = Math.max( precision, this._precisionOf( this.options.min ) );\n\t\t}\n\t\treturn precision;\n\t},\n\n\t_precisionOf: function( num ) {\n\t\tvar str = num.toString(),\n\t\t\tdecimal = str.indexOf( \".\" );\n\t\treturn decimal === -1 ? 0 : str.length - decimal - 1;\n\t},\n\n\t_valueMin: function() {\n\t\treturn this.options.min;\n\t},\n\n\t_valueMax: function() {\n\t\treturn this.max;\n\t},\n\n\t_refreshValue: function() {\n\t\tvar lastValPercent, valPercent, value, valueMin, valueMax,\n\t\t\toRange = this.options.range,\n\t\t\to = this.options,\n\t\t\tthat = this,\n\t\t\tanimate = ( !this._animateOff ) ? o.animate : false,\n\t\t\t_set = {};\n\n\t\tif ( this.options.values && this.options.values.length ) {\n\t\t\tthis.handles.each(function( i ) {\n\t\t\t\tvalPercent = ( that.values(i) - that._valueMin() ) / ( that._valueMax() - that._valueMin() ) * 100;\n\t\t\t\t_set[ that.orientation === \"horizontal\" ? \"left\" : \"bottom\" ] = valPercent + \"%\";\n\t\t\t\t$( this ).stop( 1, 1 )[ animate ? \"animate\" : \"css\" ]( _set, o.animate );\n\t\t\t\tif ( that.options.range === true ) {\n\t\t\t\t\tif ( that.orientation === \"horizontal\" ) {\n\t\t\t\t\t\tif ( i === 0 ) {\n\t\t\t\t\t\t\tthat.range.stop( 1, 1 )[ animate ? \"animate\" : \"css\" ]( { left: valPercent + \"%\" }, o.animate );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( i === 1 ) {\n\t\t\t\t\t\t\tthat.range[ animate ? \"animate\" : \"css\" ]( { width: ( valPercent - lastValPercent ) + \"%\" }, { queue: false, duration: o.animate } );\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif ( i === 0 ) {\n\t\t\t\t\t\t\tthat.range.stop( 1, 1 )[ animate ? \"animate\" : \"css\" ]( { bottom: ( valPercent ) + \"%\" }, o.animate );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( i === 1 ) {\n\t\t\t\t\t\t\tthat.range[ animate ? \"animate\" : \"css\" ]( { height: ( valPercent - lastValPercent ) + \"%\" }, { queue: false, duration: o.animate } );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tlastValPercent = valPercent;\n\t\t\t});\n\t\t} else {\n\t\t\tvalue = this.value();\n\t\t\tvalueMin = this._valueMin();\n\t\t\tvalueMax = this._valueMax();\n\t\t\tvalPercent = ( valueMax !== valueMin ) ?\n\t\t\t\t\t( value - valueMin ) / ( valueMax - valueMin ) * 100 :\n\t\t\t\t\t0;\n\t\t\t_set[ this.orientation === \"horizontal\" ? \"left\" : \"bottom\" ] = valPercent + \"%\";\n\t\t\tthis.handle.stop( 1, 1 )[ animate ? \"animate\" : \"css\" ]( _set, o.animate );\n\n\t\t\tif ( oRange === \"min\" && this.orientation === \"horizontal\" ) {\n\t\t\t\tthis.range.stop( 1, 1 )[ animate ? \"animate\" : \"css\" ]( { width: valPercent + \"%\" }, o.animate );\n\t\t\t}\n\t\t\tif ( oRange === \"max\" && this.orientation === \"horizontal\" ) {\n\t\t\t\tthis.range[ animate ? \"animate\" : \"css\" ]( { width: ( 100 - valPercent ) + \"%\" }, { queue: false, duration: o.animate } );\n\t\t\t}\n\t\t\tif ( oRange === \"min\" && this.orientation === \"vertical\" ) {\n\t\t\t\tthis.range.stop( 1, 1 )[ animate ? \"animate\" : \"css\" ]( { height: valPercent + \"%\" }, o.animate );\n\t\t\t}\n\t\t\tif ( oRange === \"max\" && this.orientation === \"vertical\" ) {\n\t\t\t\tthis.range[ animate ? \"animate\" : \"css\" ]( { height: ( 100 - valPercent ) + \"%\" }, { queue: false, duration: o.animate } );\n\t\t\t}\n\t\t}\n\t},\n\n\t_handleEvents: {\n\t\tkeydown: function( event ) {\n\t\t\tvar allowed, curVal, newVal, step,\n\t\t\t\tindex = $( event.target ).data( \"ui-slider-handle-index\" );\n\n\t\t\tswitch ( event.keyCode ) {\n\t\t\t\tcase $.ui.keyCode.HOME:\n\t\t\t\tcase $.ui.keyCode.END:\n\t\t\t\tcase $.ui.keyCode.PAGE_UP:\n\t\t\t\tcase $.ui.keyCode.PAGE_DOWN:\n\t\t\t\tcase $.ui.keyCode.UP:\n\t\t\t\tcase $.ui.keyCode.RIGHT:\n\t\t\t\tcase $.ui.keyCode.DOWN:\n\t\t\t\tcase $.ui.keyCode.LEFT:\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tif ( !this._keySliding ) {\n\t\t\t\t\t\tthis._keySliding = true;\n\t\t\t\t\t\t$( event.target ).addClass( \"ui-state-active\" );\n\t\t\t\t\t\tallowed = this._start( event, index );\n\t\t\t\t\t\tif ( allowed === false ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tstep = this.options.step;\n\t\t\tif ( this.options.values && this.options.values.length ) {\n\t\t\t\tcurVal = newVal = this.values( index );\n\t\t\t} else {\n\t\t\t\tcurVal = newVal = this.value();\n\t\t\t}\n\n\t\t\tswitch ( event.keyCode ) {\n\t\t\t\tcase $.ui.keyCode.HOME:\n\t\t\t\t\tnewVal = this._valueMin();\n\t\t\t\t\tbreak;\n\t\t\t\tcase $.ui.keyCode.END:\n\t\t\t\t\tnewVal = this._valueMax();\n\t\t\t\t\tbreak;\n\t\t\t\tcase $.ui.keyCode.PAGE_UP:\n\t\t\t\t\tnewVal = this._trimAlignValue(\n\t\t\t\t\t\tcurVal + ( ( this._valueMax() - this._valueMin() ) / this.numPages )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase $.ui.keyCode.PAGE_DOWN:\n\t\t\t\t\tnewVal = this._trimAlignValue(\n\t\t\t\t\t\tcurVal - ( (this._valueMax() - this._valueMin()) / this.numPages ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase $.ui.keyCode.UP:\n\t\t\t\tcase $.ui.keyCode.RIGHT:\n\t\t\t\t\tif ( curVal === this._valueMax() ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tnewVal = this._trimAlignValue( curVal + step );\n\t\t\t\t\tbreak;\n\t\t\t\tcase $.ui.keyCode.DOWN:\n\t\t\t\tcase $.ui.keyCode.LEFT:\n\t\t\t\t\tif ( curVal === this._valueMin() ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tnewVal = this._trimAlignValue( curVal - step );\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tthis._slide( event, index, newVal );\n\t\t},\n\t\tkeyup: function( event ) {\n\t\t\tvar index = $( event.target ).data( \"ui-slider-handle-index\" );\n\n\t\t\tif ( this._keySliding ) {\n\t\t\t\tthis._keySliding = false;\n\t\t\t\tthis._stop( event, index );\n\t\t\t\tthis._change( event, index );\n\t\t\t\t$( event.target ).removeClass( \"ui-state-active\" );\n\t\t\t}\n\t\t}\n\t}\n});\n\n\n/*!\n * jQuery UI Sortable 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/sortable/\n */\n\n\nvar sortable = $.widget(\"ui.sortable\", $.ui.mouse, {\n\tversion: \"1.11.4\",\n\twidgetEventPrefix: \"sort\",\n\tready: false,\n\toptions: {\n\t\tappendTo: \"parent\",\n\t\taxis: false,\n\t\tconnectWith: false,\n\t\tcontainment: false,\n\t\tcursor: \"auto\",\n\t\tcursorAt: false,\n\t\tdropOnEmpty: true,\n\t\tforcePlaceholderSize: false,\n\t\tforceHelperSize: false,\n\t\tgrid: false,\n\t\thandle: false,\n\t\thelper: \"original\",\n\t\titems: \"> *\",\n\t\topacity: false,\n\t\tplaceholder: false,\n\t\trevert: false,\n\t\tscroll: true,\n\t\tscrollSensitivity: 20,\n\t\tscrollSpeed: 20,\n\t\tscope: \"default\",\n\t\ttolerance: \"intersect\",\n\t\tzIndex: 1000,\n\n\t\t// callbacks\n\t\tactivate: null,\n\t\tbeforeStop: null,\n\t\tchange: null,\n\t\tdeactivate: null,\n\t\tout: null,\n\t\tover: null,\n\t\treceive: null,\n\t\tremove: null,\n\t\tsort: null,\n\t\tstart: null,\n\t\tstop: null,\n\t\tupdate: null\n\t},\n\n\t_isOverAxis: function( x, reference, size ) {\n\t\treturn ( x >= reference ) && ( x < ( reference + size ) );\n\t},\n\n\t_isFloating: function( item ) {\n\t\treturn (/left|right/).test(item.css(\"float\")) || (/inline|table-cell/).test(item.css(\"display\"));\n\t},\n\n\t_create: function() {\n\t\tthis.containerCache = {};\n\t\tthis.element.addClass(\"ui-sortable\");\n\n\t\t//Get the items\n\t\tthis.refresh();\n\n\t\t//Let's determine the parent's offset\n\t\tthis.offset = this.element.offset();\n\n\t\t//Initialize mouse events for interaction\n\t\tthis._mouseInit();\n\n\t\tthis._setHandleClassName();\n\n\t\t//We're ready to go\n\t\tthis.ready = true;\n\n\t},\n\n\t_setOption: function( key, value ) {\n\t\tthis._super( key, value );\n\n\t\tif ( key === \"handle\" ) {\n\t\t\tthis._setHandleClassName();\n\t\t}\n\t},\n\n\t_setHandleClassName: function() {\n\t\tthis.element.find( \".ui-sortable-handle\" ).removeClass( \"ui-sortable-handle\" );\n\t\t$.each( this.items, function() {\n\t\t\t( this.instance.options.handle ?\n\t\t\t\tthis.item.find( this.instance.options.handle ) : this.item )\n\t\t\t\t.addClass( \"ui-sortable-handle\" );\n\t\t});\n\t},\n\n\t_destroy: function() {\n\t\tthis.element\n\t\t\t.removeClass( \"ui-sortable ui-sortable-disabled\" )\n\t\t\t.find( \".ui-sortable-handle\" )\n\t\t\t\t.removeClass( \"ui-sortable-handle\" );\n\t\tthis._mouseDestroy();\n\n\t\tfor ( var i = this.items.length - 1; i >= 0; i-- ) {\n\t\t\tthis.items[i].item.removeData(this.widgetName + \"-item\");\n\t\t}\n\n\t\treturn this;\n\t},\n\n\t_mouseCapture: function(event, overrideHandle) {\n\t\tvar currentItem = null,\n\t\t\tvalidHandle = false,\n\t\t\tthat = this;\n\n\t\tif (this.reverting) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif(this.options.disabled || this.options.type === \"static\") {\n\t\t\treturn false;\n\t\t}\n\n\t\t//We have to refresh the items data once first\n\t\tthis._refreshItems(event);\n\n\t\t//Find out if the clicked node (or one of its parents) is a actual item in this.items\n\t\t$(event.target).parents().each(function() {\n\t\t\tif($.data(this, that.widgetName + \"-item\") === that) {\n\t\t\t\tcurrentItem = $(this);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t\tif($.data(event.target, that.widgetName + \"-item\") === that) {\n\t\t\tcurrentItem = $(event.target);\n\t\t}\n\n\t\tif(!currentItem) {\n\t\t\treturn false;\n\t\t}\n\t\tif(this.options.handle && !overrideHandle) {\n\t\t\t$(this.options.handle, currentItem).find(\"*\").addBack().each(function() {\n\t\t\t\tif(this === event.target) {\n\t\t\t\t\tvalidHandle = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif(!validHandle) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tthis.currentItem = currentItem;\n\t\tthis._removeCurrentsFromItems();\n\t\treturn true;\n\n\t},\n\n\t_mouseStart: function(event, overrideHandle, noActivation) {\n\n\t\tvar i, body,\n\t\t\to = this.options;\n\n\t\tthis.currentContainer = this;\n\n\t\t//We only need to call refreshPositions, because the refreshItems call has been moved to mouseCapture\n\t\tthis.refreshPositions();\n\n\t\t//Create and append the visible helper\n\t\tthis.helper = this._createHelper(event);\n\n\t\t//Cache the helper size\n\t\tthis._cacheHelperProportions();\n\n\t\t/*\n\t\t * - Position generation -\n\t\t * This block generates everything position related - it's the core of draggables.\n\t\t */\n\n\t\t//Cache the margins of the original element\n\t\tthis._cacheMargins();\n\n\t\t//Get the next scrolling parent\n\t\tthis.scrollParent = this.helper.scrollParent();\n\n\t\t//The element's absolute position on the page minus margins\n\t\tthis.offset = this.currentItem.offset();\n\t\tthis.offset = {\n\t\t\ttop: this.offset.top - this.margins.top,\n\t\t\tleft: this.offset.left - this.margins.left\n\t\t};\n\n\t\t$.extend(this.offset, {\n\t\t\tclick: { //Where the click happened, relative to the element\n\t\t\t\tleft: event.pageX - this.offset.left,\n\t\t\t\ttop: event.pageY - this.offset.top\n\t\t\t},\n\t\t\tparent: this._getParentOffset(),\n\t\t\trelative: this._getRelativeOffset() //This is a relative to absolute position minus the actual position calculation - only used for relative positioned helper\n\t\t});\n\n\t\t// Only after we got the offset, we can change the helper's position to absolute\n\t\t// TODO: Still need to figure out a way to make relative sorting possible\n\t\tthis.helper.css(\"position\", \"absolute\");\n\t\tthis.cssPosition = this.helper.css(\"position\");\n\n\t\t//Generate the original position\n\t\tthis.originalPosition = this._generatePosition(event);\n\t\tthis.originalPageX = event.pageX;\n\t\tthis.originalPageY = event.pageY;\n\n\t\t//Adjust the mouse offset relative to the helper if \"cursorAt\" is supplied\n\t\t(o.cursorAt && this._adjustOffsetFromHelper(o.cursorAt));\n\n\t\t//Cache the former DOM position\n\t\tthis.domPosition = { prev: this.currentItem.prev()[0], parent: this.currentItem.parent()[0] };\n\n\t\t//If the helper is not the original, hide the original so it's not playing any role during the drag, won't cause anything bad this way\n\t\tif(this.helper[0] !== this.currentItem[0]) {\n\t\t\tthis.currentItem.hide();\n\t\t}\n\n\t\t//Create the placeholder\n\t\tthis._createPlaceholder();\n\n\t\t//Set a containment if given in the options\n\t\tif(o.containment) {\n\t\t\tthis._setContainment();\n\t\t}\n\n\t\tif( o.cursor && o.cursor !== \"auto\" ) { // cursor option\n\t\t\tbody = this.document.find( \"body\" );\n\n\t\t\t// support: IE\n\t\t\tthis.storedCursor = body.css( \"cursor\" );\n\t\t\tbody.css( \"cursor\", o.cursor );\n\n\t\t\tthis.storedStylesheet = $( \"<style>*{ cursor: \"+o.cursor+\" !important; }</style>\" ).appendTo( body );\n\t\t}\n\n\t\tif(o.opacity) { // opacity option\n\t\t\tif (this.helper.css(\"opacity\")) {\n\t\t\t\tthis._storedOpacity = this.helper.css(\"opacity\");\n\t\t\t}\n\t\t\tthis.helper.css(\"opacity\", o.opacity);\n\t\t}\n\n\t\tif(o.zIndex) { // zIndex option\n\t\t\tif (this.helper.css(\"zIndex\")) {\n\t\t\t\tthis._storedZIndex = this.helper.css(\"zIndex\");\n\t\t\t}\n\t\t\tthis.helper.css(\"zIndex\", o.zIndex);\n\t\t}\n\n\t\t//Prepare scrolling\n\t\tif(this.scrollParent[0] !== this.document[0] && this.scrollParent[0].tagName !== \"HTML\") {\n\t\t\tthis.overflowOffset = this.scrollParent.offset();\n\t\t}\n\n\t\t//Call callbacks\n\t\tthis._trigger(\"start\", event, this._uiHash());\n\n\t\t//Recache the helper size\n\t\tif(!this._preserveHelperProportions) {\n\t\t\tthis._cacheHelperProportions();\n\t\t}\n\n\n\t\t//Post \"activate\" events to possible containers\n\t\tif( !noActivation ) {\n\t\t\tfor ( i = this.containers.length - 1; i >= 0; i-- ) {\n\t\t\t\tthis.containers[ i ]._trigger( \"activate\", event, this._uiHash( this ) );\n\t\t\t}\n\t\t}\n\n\t\t//Prepare possible droppables\n\t\tif($.ui.ddmanager) {\n\t\t\t$.ui.ddmanager.current = this;\n\t\t}\n\n\t\tif ($.ui.ddmanager && !o.dropBehaviour) {\n\t\t\t$.ui.ddmanager.prepareOffsets(this, event);\n\t\t}\n\n\t\tthis.dragging = true;\n\n\t\tthis.helper.addClass(\"ui-sortable-helper\");\n\t\tthis._mouseDrag(event); //Execute the drag once - this causes the helper not to be visible before getting its correct position\n\t\treturn true;\n\n\t},\n\n\t_mouseDrag: function(event) {\n\t\tvar i, item, itemElement, intersection,\n\t\t\to = this.options,\n\t\t\tscrolled = false;\n\n\t\t//Compute the helpers position\n\t\tthis.position = this._generatePosition(event);\n\t\tthis.positionAbs = this._convertPositionTo(\"absolute\");\n\n\t\tif (!this.lastPositionAbs) {\n\t\t\tthis.lastPositionAbs = this.positionAbs;\n\t\t}\n\n\t\t//Do scrolling\n\t\tif(this.options.scroll) {\n\t\t\tif(this.scrollParent[0] !== this.document[0] && this.scrollParent[0].tagName !== \"HTML\") {\n\n\t\t\t\tif((this.overflowOffset.top + this.scrollParent[0].offsetHeight) - event.pageY < o.scrollSensitivity) {\n\t\t\t\t\tthis.scrollParent[0].scrollTop = scrolled = this.scrollParent[0].scrollTop + o.scrollSpeed;\n\t\t\t\t} else if(event.pageY - this.overflowOffset.top < o.scrollSensitivity) {\n\t\t\t\t\tthis.scrollParent[0].scrollTop = scrolled = this.scrollParent[0].scrollTop - o.scrollSpeed;\n\t\t\t\t}\n\n\t\t\t\tif((this.overflowOffset.left + this.scrollParent[0].offsetWidth) - event.pageX < o.scrollSensitivity) {\n\t\t\t\t\tthis.scrollParent[0].scrollLeft = scrolled = this.scrollParent[0].scrollLeft + o.scrollSpeed;\n\t\t\t\t} else if(event.pageX - this.overflowOffset.left < o.scrollSensitivity) {\n\t\t\t\t\tthis.scrollParent[0].scrollLeft = scrolled = this.scrollParent[0].scrollLeft - o.scrollSpeed;\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif(event.pageY - this.document.scrollTop() < o.scrollSensitivity) {\n\t\t\t\t\tscrolled = this.document.scrollTop(this.document.scrollTop() - o.scrollSpeed);\n\t\t\t\t} else if(this.window.height() - (event.pageY - this.document.scrollTop()) < o.scrollSensitivity) {\n\t\t\t\t\tscrolled = this.document.scrollTop(this.document.scrollTop() + o.scrollSpeed);\n\t\t\t\t}\n\n\t\t\t\tif(event.pageX - this.document.scrollLeft() < o.scrollSensitivity) {\n\t\t\t\t\tscrolled = this.document.scrollLeft(this.document.scrollLeft() - o.scrollSpeed);\n\t\t\t\t} else if(this.window.width() - (event.pageX - this.document.scrollLeft()) < o.scrollSensitivity) {\n\t\t\t\t\tscrolled = this.document.scrollLeft(this.document.scrollLeft() + o.scrollSpeed);\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif(scrolled !== false && $.ui.ddmanager && !o.dropBehaviour) {\n\t\t\t\t$.ui.ddmanager.prepareOffsets(this, event);\n\t\t\t}\n\t\t}\n\n\t\t//Regenerate the absolute position used for position checks\n\t\tthis.positionAbs = this._convertPositionTo(\"absolute\");\n\n\t\t//Set the helper position\n\t\tif(!this.options.axis || this.options.axis !== \"y\") {\n\t\t\tthis.helper[0].style.left = this.position.left+\"px\";\n\t\t}\n\t\tif(!this.options.axis || this.options.axis !== \"x\") {\n\t\t\tthis.helper[0].style.top = this.position.top+\"px\";\n\t\t}\n\n\t\t//Rearrange\n\t\tfor (i = this.items.length - 1; i >= 0; i--) {\n\n\t\t\t//Cache variables and intersection, continue if no intersection\n\t\t\titem = this.items[i];\n\t\t\titemElement = item.item[0];\n\t\t\tintersection = this._intersectsWithPointer(item);\n\t\t\tif (!intersection) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Only put the placeholder inside the current Container, skip all\n\t\t\t// items from other containers. This works because when moving\n\t\t\t// an item from one container to another the\n\t\t\t// currentContainer is switched before the placeholder is moved.\n\t\t\t//\n\t\t\t// Without this, moving items in \"sub-sortables\" can cause\n\t\t\t// the placeholder to jitter between the outer and inner container.\n\t\t\tif (item.instance !== this.currentContainer) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// cannot intersect with itself\n\t\t\t// no useless actions that have been done before\n\t\t\t// no action if the item moved is the parent of the item checked\n\t\t\tif (itemElement !== this.currentItem[0] &&\n\t\t\t\tthis.placeholder[intersection === 1 ? \"next\" : \"prev\"]()[0] !== itemElement &&\n\t\t\t\t!$.contains(this.placeholder[0], itemElement) &&\n\t\t\t\t(this.options.type === \"semi-dynamic\" ? !$.contains(this.element[0], itemElement) : true)\n\t\t\t) {\n\n\t\t\t\tthis.direction = intersection === 1 ? \"down\" : \"up\";\n\n\t\t\t\tif (this.options.tolerance === \"pointer\" || this._intersectsWithSides(item)) {\n\t\t\t\t\tthis._rearrange(event, item);\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tthis._trigger(\"change\", event, this._uiHash());\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\t//Post events to containers\n\t\tthis._contactContainers(event);\n\n\t\t//Interconnect with droppables\n\t\tif($.ui.ddmanager) {\n\t\t\t$.ui.ddmanager.drag(this, event);\n\t\t}\n\n\t\t//Call callbacks\n\t\tthis._trigger(\"sort\", event, this._uiHash());\n\n\t\tthis.lastPositionAbs = this.positionAbs;\n\t\treturn false;\n\n\t},\n\n\t_mouseStop: function(event, noPropagation) {\n\n\t\tif(!event) {\n\t\t\treturn;\n\t\t}\n\n\t\t//If we are using droppables, inform the manager about the drop\n\t\tif ($.ui.ddmanager && !this.options.dropBehaviour) {\n\t\t\t$.ui.ddmanager.drop(this, event);\n\t\t}\n\n\t\tif(this.options.revert) {\n\t\t\tvar that = this,\n\t\t\t\tcur = this.placeholder.offset(),\n\t\t\t\taxis = this.options.axis,\n\t\t\t\tanimation = {};\n\n\t\t\tif ( !axis || axis === \"x\" ) {\n\t\t\t\tanimation.left = cur.left - this.offset.parent.left - this.margins.left + (this.offsetParent[0] === this.document[0].body ? 0 : this.offsetParent[0].scrollLeft);\n\t\t\t}\n\t\t\tif ( !axis || axis === \"y\" ) {\n\t\t\t\tanimation.top = cur.top - this.offset.parent.top - this.margins.top + (this.offsetParent[0] === this.document[0].body ? 0 : this.offsetParent[0].scrollTop);\n\t\t\t}\n\t\t\tthis.reverting = true;\n\t\t\t$(this.helper).animate( animation, parseInt(this.options.revert, 10) || 500, function() {\n\t\t\t\tthat._clear(event);\n\t\t\t});\n\t\t} else {\n\t\t\tthis._clear(event, noPropagation);\n\t\t}\n\n\t\treturn false;\n\n\t},\n\n\tcancel: function() {\n\n\t\tif(this.dragging) {\n\n\t\t\tthis._mouseUp({ target: null });\n\n\t\t\tif(this.options.helper === \"original\") {\n\t\t\t\tthis.currentItem.css(this._storedCSS).removeClass(\"ui-sortable-helper\");\n\t\t\t} else {\n\t\t\t\tthis.currentItem.show();\n\t\t\t}\n\n\t\t\t//Post deactivating events to containers\n\t\t\tfor (var i = this.containers.length - 1; i >= 0; i--){\n\t\t\t\tthis.containers[i]._trigger(\"deactivate\", null, this._uiHash(this));\n\t\t\t\tif(this.containers[i].containerCache.over) {\n\t\t\t\t\tthis.containers[i]._trigger(\"out\", null, this._uiHash(this));\n\t\t\t\t\tthis.containers[i].containerCache.over = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\tif (this.placeholder) {\n\t\t\t//$(this.placeholder[0]).remove(); would have been the jQuery way - unfortunately, it unbinds ALL events from the original node!\n\t\t\tif(this.placeholder[0].parentNode) {\n\t\t\t\tthis.placeholder[0].parentNode.removeChild(this.placeholder[0]);\n\t\t\t}\n\t\t\tif(this.options.helper !== \"original\" && this.helper && this.helper[0].parentNode) {\n\t\t\t\tthis.helper.remove();\n\t\t\t}\n\n\t\t\t$.extend(this, {\n\t\t\t\thelper: null,\n\t\t\t\tdragging: false,\n\t\t\t\treverting: false,\n\t\t\t\t_noFinalSort: null\n\t\t\t});\n\n\t\t\tif(this.domPosition.prev) {\n\t\t\t\t$(this.domPosition.prev).after(this.currentItem);\n\t\t\t} else {\n\t\t\t\t$(this.domPosition.parent).prepend(this.currentItem);\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tserialize: function(o) {\n\n\t\tvar items = this._getItemsAsjQuery(o && o.connected),\n\t\t\tstr = [];\n\t\to = o || {};\n\n\t\t$(items).each(function() {\n\t\t\tvar res = ($(o.item || this).attr(o.attribute || \"id\") || \"\").match(o.expression || (/(.+)[\\-=_](.+)/));\n\t\t\tif (res) {\n\t\t\t\tstr.push((o.key || res[1]+\"[]\")+\"=\"+(o.key && o.expression ? res[1] : res[2]));\n\t\t\t}\n\t\t});\n\n\t\tif(!str.length && o.key) {\n\t\t\tstr.push(o.key + \"=\");\n\t\t}\n\n\t\treturn str.join(\"&\");\n\n\t},\n\n\ttoArray: function(o) {\n\n\t\tvar items = this._getItemsAsjQuery(o && o.connected),\n\t\t\tret = [];\n\n\t\to = o || {};\n\n\t\titems.each(function() { ret.push($(o.item || this).attr(o.attribute || \"id\") || \"\"); });\n\t\treturn ret;\n\n\t},\n\n\t/* Be careful with the following core functions */\n\t_intersectsWith: function(item) {\n\n\t\tvar x1 = this.positionAbs.left,\n\t\t\tx2 = x1 + this.helperProportions.width,\n\t\t\ty1 = this.positionAbs.top,\n\t\t\ty2 = y1 + this.helperProportions.height,\n\t\t\tl = item.left,\n\t\t\tr = l + item.width,\n\t\t\tt = item.top,\n\t\t\tb = t + item.height,\n\t\t\tdyClick = this.offset.click.top,\n\t\t\tdxClick = this.offset.click.left,\n\t\t\tisOverElementHeight = ( this.options.axis === \"x\" ) || ( ( y1 + dyClick ) > t && ( y1 + dyClick ) < b ),\n\t\t\tisOverElementWidth = ( this.options.axis === \"y\" ) || ( ( x1 + dxClick ) > l && ( x1 + dxClick ) < r ),\n\t\t\tisOverElement = isOverElementHeight && isOverElementWidth;\n\n\t\tif ( this.options.tolerance === \"pointer\" ||\n\t\t\tthis.options.forcePointerForContainers ||\n\t\t\t(this.options.tolerance !== \"pointer\" && this.helperProportions[this.floating ? \"width\" : \"height\"] > item[this.floating ? \"width\" : \"height\"])\n\t\t) {\n\t\t\treturn isOverElement;\n\t\t} else {\n\n\t\t\treturn (l < x1 + (this.helperProportions.width / 2) && // Right Half\n\t\t\t\tx2 - (this.helperProportions.width / 2) < r && // Left Half\n\t\t\t\tt < y1 + (this.helperProportions.height / 2) && // Bottom Half\n\t\t\t\ty2 - (this.helperProportions.height / 2) < b ); // Top Half\n\n\t\t}\n\t},\n\n\t_intersectsWithPointer: function(item) {\n\n\t\tvar isOverElementHeight = (this.options.axis === \"x\") || this._isOverAxis(this.positionAbs.top + this.offset.click.top, item.top, item.height),\n\t\t\tisOverElementWidth = (this.options.axis === \"y\") || this._isOverAxis(this.positionAbs.left + this.offset.click.left, item.left, item.width),\n\t\t\tisOverElement = isOverElementHeight && isOverElementWidth,\n\t\t\tverticalDirection = this._getDragVerticalDirection(),\n\t\t\thorizontalDirection = this._getDragHorizontalDirection();\n\n\t\tif (!isOverElement) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.floating ?\n\t\t\t( ((horizontalDirection && horizontalDirection === \"right\") || verticalDirection === \"down\") ? 2 : 1 )\n\t\t\t: ( verticalDirection && (verticalDirection === \"down\" ? 2 : 1) );\n\n\t},\n\n\t_intersectsWithSides: function(item) {\n\n\t\tvar isOverBottomHalf = this._isOverAxis(this.positionAbs.top + this.offset.click.top, item.top + (item.height/2), item.height),\n\t\t\tisOverRightHalf = this._isOverAxis(this.positionAbs.left + this.offset.click.left, item.left + (item.width/2), item.width),\n\t\t\tverticalDirection = this._getDragVerticalDirection(),\n\t\t\thorizontalDirection = this._getDragHorizontalDirection();\n\n\t\tif (this.floating && horizontalDirection) {\n\t\t\treturn ((horizontalDirection === \"right\" && isOverRightHalf) || (horizontalDirection === \"left\" && !isOverRightHalf));\n\t\t} else {\n\t\t\treturn verticalDirection && ((verticalDirection === \"down\" && isOverBottomHalf) || (verticalDirection === \"up\" && !isOverBottomHalf));\n\t\t}\n\n\t},\n\n\t_getDragVerticalDirection: function() {\n\t\tvar delta = this.positionAbs.top - this.lastPositionAbs.top;\n\t\treturn delta !== 0 && (delta > 0 ? \"down\" : \"up\");\n\t},\n\n\t_getDragHorizontalDirection: function() {\n\t\tvar delta = this.positionAbs.left - this.lastPositionAbs.left;\n\t\treturn delta !== 0 && (delta > 0 ? \"right\" : \"left\");\n\t},\n\n\trefresh: function(event) {\n\t\tthis._refreshItems(event);\n\t\tthis._setHandleClassName();\n\t\tthis.refreshPositions();\n\t\treturn this;\n\t},\n\n\t_connectWith: function() {\n\t\tvar options = this.options;\n\t\treturn options.connectWith.constructor === String ? [options.connectWith] : options.connectWith;\n\t},\n\n\t_getItemsAsjQuery: function(connected) {\n\n\t\tvar i, j, cur, inst,\n\t\t\titems = [],\n\t\t\tqueries = [],\n\t\t\tconnectWith = this._connectWith();\n\n\t\tif(connectWith && connected) {\n\t\t\tfor (i = connectWith.length - 1; i >= 0; i--){\n\t\t\t\tcur = $(connectWith[i], this.document[0]);\n\t\t\t\tfor ( j = cur.length - 1; j >= 0; j--){\n\t\t\t\t\tinst = $.data(cur[j], this.widgetFullName);\n\t\t\t\t\tif(inst && inst !== this && !inst.options.disabled) {\n\t\t\t\t\t\tqueries.push([$.isFunction(inst.options.items) ? inst.options.items.call(inst.element) : $(inst.options.items, inst.element).not(\".ui-sortable-helper\").not(\".ui-sortable-placeholder\"), inst]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tqueries.push([$.isFunction(this.options.items) ? this.options.items.call(this.element, null, { options: this.options, item: this.currentItem }) : $(this.options.items, this.element).not(\".ui-sortable-helper\").not(\".ui-sortable-placeholder\"), this]);\n\n\t\tfunction addItems() {\n\t\t\titems.push( this );\n\t\t}\n\t\tfor (i = queries.length - 1; i >= 0; i--){\n\t\t\tqueries[i][0].each( addItems );\n\t\t}\n\n\t\treturn $(items);\n\n\t},\n\n\t_removeCurrentsFromItems: function() {\n\n\t\tvar list = this.currentItem.find(\":data(\" + this.widgetName + \"-item)\");\n\n\t\tthis.items = $.grep(this.items, function (item) {\n\t\t\tfor (var j=0; j < list.length; j++) {\n\t\t\t\tif(list[j] === item.item[0]) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t},\n\n\t_refreshItems: function(event) {\n\n\t\tthis.items = [];\n\t\tthis.containers = [this];\n\n\t\tvar i, j, cur, inst, targetData, _queries, item, queriesLength,\n\t\t\titems = this.items,\n\t\t\tqueries = [[$.isFunction(this.options.items) ? this.options.items.call(this.element[0], event, { item: this.currentItem }) : $(this.options.items, this.element), this]],\n\t\t\tconnectWith = this._connectWith();\n\n\t\tif(connectWith && this.ready) { //Shouldn't be run the first time through due to massive slow-down\n\t\t\tfor (i = connectWith.length - 1; i >= 0; i--){\n\t\t\t\tcur = $(connectWith[i], this.document[0]);\n\t\t\t\tfor (j = cur.length - 1; j >= 0; j--){\n\t\t\t\t\tinst = $.data(cur[j], this.widgetFullName);\n\t\t\t\t\tif(inst && inst !== this && !inst.options.disabled) {\n\t\t\t\t\t\tqueries.push([$.isFunction(inst.options.items) ? inst.options.items.call(inst.element[0], event, { item: this.currentItem }) : $(inst.options.items, inst.element), inst]);\n\t\t\t\t\t\tthis.containers.push(inst);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (i = queries.length - 1; i >= 0; i--) {\n\t\t\ttargetData = queries[i][1];\n\t\t\t_queries = queries[i][0];\n\n\t\t\tfor (j=0, queriesLength = _queries.length; j < queriesLength; j++) {\n\t\t\t\titem = $(_queries[j]);\n\n\t\t\t\titem.data(this.widgetName + \"-item\", targetData); // Data for target checking (mouse manager)\n\n\t\t\t\titems.push({\n\t\t\t\t\titem: item,\n\t\t\t\t\tinstance: targetData,\n\t\t\t\t\twidth: 0, height: 0,\n\t\t\t\t\tleft: 0, top: 0\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t},\n\n\trefreshPositions: function(fast) {\n\n\t\t// Determine whether items are being displayed horizontally\n\t\tthis.floating = this.items.length ?\n\t\t\tthis.options.axis === \"x\" || this._isFloating( this.items[ 0 ].item ) :\n\t\t\tfalse;\n\n\t\t//This has to be redone because due to the item being moved out/into the offsetParent, the offsetParent's position will change\n\t\tif(this.offsetParent && this.helper) {\n\t\t\tthis.offset.parent = this._getParentOffset();\n\t\t}\n\n\t\tvar i, item, t, p;\n\n\t\tfor (i = this.items.length - 1; i >= 0; i--){\n\t\t\titem = this.items[i];\n\n\t\t\t//We ignore calculating positions of all connected containers when we're not over them\n\t\t\tif(item.instance !== this.currentContainer && this.currentContainer && item.item[0] !== this.currentItem[0]) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tt = this.options.toleranceElement ? $(this.options.toleranceElement, item.item) : item.item;\n\n\t\t\tif (!fast) {\n\t\t\t\titem.width = t.outerWidth();\n\t\t\t\titem.height = t.outerHeight();\n\t\t\t}\n\n\t\t\tp = t.offset();\n\t\t\titem.left = p.left;\n\t\t\titem.top = p.top;\n\t\t}\n\n\t\tif(this.options.custom && this.options.custom.refreshContainers) {\n\t\t\tthis.options.custom.refreshContainers.call(this);\n\t\t} else {\n\t\t\tfor (i = this.containers.length - 1; i >= 0; i--){\n\t\t\t\tp = this.containers[i].element.offset();\n\t\t\t\tthis.containers[i].containerCache.left = p.left;\n\t\t\t\tthis.containers[i].containerCache.top = p.top;\n\t\t\t\tthis.containers[i].containerCache.width = this.containers[i].element.outerWidth();\n\t\t\t\tthis.containers[i].containerCache.height = this.containers[i].element.outerHeight();\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\t_createPlaceholder: function(that) {\n\t\tthat = that || this;\n\t\tvar className,\n\t\t\to = that.options;\n\n\t\tif(!o.placeholder || o.placeholder.constructor === String) {\n\t\t\tclassName = o.placeholder;\n\t\t\to.placeholder = {\n\t\t\t\telement: function() {\n\n\t\t\t\t\tvar nodeName = that.currentItem[0].nodeName.toLowerCase(),\n\t\t\t\t\t\telement = $( \"<\" + nodeName + \">\", that.document[0] )\n\t\t\t\t\t\t\t.addClass(className || that.currentItem[0].className+\" ui-sortable-placeholder\")\n\t\t\t\t\t\t\t.removeClass(\"ui-sortable-helper\");\n\n\t\t\t\t\tif ( nodeName === \"tbody\" ) {\n\t\t\t\t\t\tthat._createTrPlaceholder(\n\t\t\t\t\t\t\tthat.currentItem.find( \"tr\" ).eq( 0 ),\n\t\t\t\t\t\t\t$( \"<tr>\", that.document[ 0 ] ).appendTo( element )\n\t\t\t\t\t\t);\n\t\t\t\t\t} else if ( nodeName === \"tr\" ) {\n\t\t\t\t\t\tthat._createTrPlaceholder( that.currentItem, element );\n\t\t\t\t\t} else if ( nodeName === \"img\" ) {\n\t\t\t\t\t\telement.attr( \"src\", that.currentItem.attr( \"src\" ) );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( !className ) {\n\t\t\t\t\t\telement.css( \"visibility\", \"hidden\" );\n\t\t\t\t\t}\n\n\t\t\t\t\treturn element;\n\t\t\t\t},\n\t\t\t\tupdate: function(container, p) {\n\n\t\t\t\t\t// 1. If a className is set as 'placeholder option, we don't force sizes - the class is responsible for that\n\t\t\t\t\t// 2. The option 'forcePlaceholderSize can be enabled to force it even if a class name is specified\n\t\t\t\t\tif(className && !o.forcePlaceholderSize) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t//If the element doesn't have a actual height by itself (without styles coming from a stylesheet), it receives the inline height from the dragged item\n\t\t\t\t\tif(!p.height()) { p.height(that.currentItem.innerHeight() - parseInt(that.currentItem.css(\"paddingTop\")||0, 10) - parseInt(that.currentItem.css(\"paddingBottom\")||0, 10)); }\n\t\t\t\t\tif(!p.width()) { p.width(that.currentItem.innerWidth() - parseInt(that.currentItem.css(\"paddingLeft\")||0, 10) - parseInt(that.currentItem.css(\"paddingRight\")||0, 10)); }\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t//Create the placeholder\n\t\tthat.placeholder = $(o.placeholder.element.call(that.element, that.currentItem));\n\n\t\t//Append it after the actual current item\n\t\tthat.currentItem.after(that.placeholder);\n\n\t\t//Update the size of the placeholder (TODO: Logic to fuzzy, see line 316/317)\n\t\to.placeholder.update(that, that.placeholder);\n\n\t},\n\n\t_createTrPlaceholder: function( sourceTr, targetTr ) {\n\t\tvar that = this;\n\n\t\tsourceTr.children().each(function() {\n\t\t\t$( \"<td>&#160;</td>\", that.document[ 0 ] )\n\t\t\t\t.attr( \"colspan\", $( this ).attr( \"colspan\" ) || 1 )\n\t\t\t\t.appendTo( targetTr );\n\t\t});\n\t},\n\n\t_contactContainers: function(event) {\n\t\tvar i, j, dist, itemWithLeastDistance, posProperty, sizeProperty, cur, nearBottom, floating, axis,\n\t\t\tinnermostContainer = null,\n\t\t\tinnermostIndex = null;\n\n\t\t// get innermost container that intersects with item\n\t\tfor (i = this.containers.length - 1; i >= 0; i--) {\n\n\t\t\t// never consider a container that's located within the item itself\n\t\t\tif($.contains(this.currentItem[0], this.containers[i].element[0])) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(this._intersectsWith(this.containers[i].containerCache)) {\n\n\t\t\t\t// if we've already found a container and it's more \"inner\" than this, then continue\n\t\t\t\tif(innermostContainer && $.contains(this.containers[i].element[0], innermostContainer.element[0])) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tinnermostContainer = this.containers[i];\n\t\t\t\tinnermostIndex = i;\n\n\t\t\t} else {\n\t\t\t\t// container doesn't intersect. trigger \"out\" event if necessary\n\t\t\t\tif(this.containers[i].containerCache.over) {\n\t\t\t\t\tthis.containers[i]._trigger(\"out\", event, this._uiHash(this));\n\t\t\t\t\tthis.containers[i].containerCache.over = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\t// if no intersecting containers found, return\n\t\tif(!innermostContainer) {\n\t\t\treturn;\n\t\t}\n\n\t\t// move the item into the container if it's not there already\n\t\tif(this.containers.length === 1) {\n\t\t\tif (!this.containers[innermostIndex].containerCache.over) {\n\t\t\t\tthis.containers[innermostIndex]._trigger(\"over\", event, this._uiHash(this));\n\t\t\t\tthis.containers[innermostIndex].containerCache.over = 1;\n\t\t\t}\n\t\t} else {\n\n\t\t\t//When entering a new container, we will find the item with the least distance and append our item near it\n\t\t\tdist = 10000;\n\t\t\titemWithLeastDistance = null;\n\t\t\tfloating = innermostContainer.floating || this._isFloating(this.currentItem);\n\t\t\tposProperty = floating ? \"left\" : \"top\";\n\t\t\tsizeProperty = floating ? \"width\" : \"height\";\n\t\t\taxis = floating ? \"clientX\" : \"clientY\";\n\n\t\t\tfor (j = this.items.length - 1; j >= 0; j--) {\n\t\t\t\tif(!$.contains(this.containers[innermostIndex].element[0], this.items[j].item[0])) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif(this.items[j].item[0] === this.currentItem[0]) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tcur = this.items[j].item.offset()[posProperty];\n\t\t\t\tnearBottom = false;\n\t\t\t\tif ( event[ axis ] - cur > this.items[ j ][ sizeProperty ] / 2 ) {\n\t\t\t\t\tnearBottom = true;\n\t\t\t\t}\n\n\t\t\t\tif ( Math.abs( event[ axis ] - cur ) < dist ) {\n\t\t\t\t\tdist = Math.abs( event[ axis ] - cur );\n\t\t\t\t\titemWithLeastDistance = this.items[ j ];\n\t\t\t\t\tthis.direction = nearBottom ? \"up\": \"down\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//Check if dropOnEmpty is enabled\n\t\t\tif(!itemWithLeastDistance && !this.options.dropOnEmpty) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(this.currentContainer === this.containers[innermostIndex]) {\n\t\t\t\tif ( !this.currentContainer.containerCache.over ) {\n\t\t\t\t\tthis.containers[ innermostIndex ]._trigger( \"over\", event, this._uiHash() );\n\t\t\t\t\tthis.currentContainer.containerCache.over = 1;\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\titemWithLeastDistance ? this._rearrange(event, itemWithLeastDistance, null, true) : this._rearrange(event, null, this.containers[innermostIndex].element, true);\n\t\t\tthis._trigger(\"change\", event, this._uiHash());\n\t\t\tthis.containers[innermostIndex]._trigger(\"change\", event, this._uiHash(this));\n\t\t\tthis.currentContainer = this.containers[innermostIndex];\n\n\t\t\t//Update the placeholder\n\t\t\tthis.options.placeholder.update(this.currentContainer, this.placeholder);\n\n\t\t\tthis.containers[innermostIndex]._trigger(\"over\", event, this._uiHash(this));\n\t\t\tthis.containers[innermostIndex].containerCache.over = 1;\n\t\t}\n\n\n\t},\n\n\t_createHelper: function(event) {\n\n\t\tvar o = this.options,\n\t\t\thelper = $.isFunction(o.helper) ? $(o.helper.apply(this.element[0], [event, this.currentItem])) : (o.helper === \"clone\" ? this.currentItem.clone() : this.currentItem);\n\n\t\t//Add the helper to the DOM if that didn't happen already\n\t\tif(!helper.parents(\"body\").length) {\n\t\t\t$(o.appendTo !== \"parent\" ? o.appendTo : this.currentItem[0].parentNode)[0].appendChild(helper[0]);\n\t\t}\n\n\t\tif(helper[0] === this.currentItem[0]) {\n\t\t\tthis._storedCSS = { width: this.currentItem[0].style.width, height: this.currentItem[0].style.height, position: this.currentItem.css(\"position\"), top: this.currentItem.css(\"top\"), left: this.currentItem.css(\"left\") };\n\t\t}\n\n\t\tif(!helper[0].style.width || o.forceHelperSize) {\n\t\t\thelper.width(this.currentItem.width());\n\t\t}\n\t\tif(!helper[0].style.height || o.forceHelperSize) {\n\t\t\thelper.height(this.currentItem.height());\n\t\t}\n\n\t\treturn helper;\n\n\t},\n\n\t_adjustOffsetFromHelper: function(obj) {\n\t\tif (typeof obj === \"string\") {\n\t\t\tobj = obj.split(\" \");\n\t\t}\n\t\tif ($.isArray(obj)) {\n\t\t\tobj = {left: +obj[0], top: +obj[1] || 0};\n\t\t}\n\t\tif (\"left\" in obj) {\n\t\t\tthis.offset.click.left = obj.left + this.margins.left;\n\t\t}\n\t\tif (\"right\" in obj) {\n\t\t\tthis.offset.click.left = this.helperProportions.width - obj.right + this.margins.left;\n\t\t}\n\t\tif (\"top\" in obj) {\n\t\t\tthis.offset.click.top = obj.top + this.margins.top;\n\t\t}\n\t\tif (\"bottom\" in obj) {\n\t\t\tthis.offset.click.top = this.helperProportions.height - obj.bottom + this.margins.top;\n\t\t}\n\t},\n\n\t_getParentOffset: function() {\n\n\n\t\t//Get the offsetParent and cache its position\n\t\tthis.offsetParent = this.helper.offsetParent();\n\t\tvar po = this.offsetParent.offset();\n\n\t\t// This is a special case where we need to modify a offset calculated on start, since the following happened:\n\t\t// 1. The position of the helper is absolute, so it's position is calculated based on the next positioned parent\n\t\t// 2. The actual offset parent is a child of the scroll parent, and the scroll parent isn't the document, which means that\n\t\t//    the scroll is included in the initial calculation of the offset of the parent, and never recalculated upon drag\n\t\tif(this.cssPosition === \"absolute\" && this.scrollParent[0] !== this.document[0] && $.contains(this.scrollParent[0], this.offsetParent[0])) {\n\t\t\tpo.left += this.scrollParent.scrollLeft();\n\t\t\tpo.top += this.scrollParent.scrollTop();\n\t\t}\n\n\t\t// This needs to be actually done for all browsers, since pageX/pageY includes this information\n\t\t// with an ugly IE fix\n\t\tif( this.offsetParent[0] === this.document[0].body || (this.offsetParent[0].tagName && this.offsetParent[0].tagName.toLowerCase() === \"html\" && $.ui.ie)) {\n\t\t\tpo = { top: 0, left: 0 };\n\t\t}\n\n\t\treturn {\n\t\t\ttop: po.top + (parseInt(this.offsetParent.css(\"borderTopWidth\"),10) || 0),\n\t\t\tleft: po.left + (parseInt(this.offsetParent.css(\"borderLeftWidth\"),10) || 0)\n\t\t};\n\n\t},\n\n\t_getRelativeOffset: function() {\n\n\t\tif(this.cssPosition === \"relative\") {\n\t\t\tvar p = this.currentItem.position();\n\t\t\treturn {\n\t\t\t\ttop: p.top - (parseInt(this.helper.css(\"top\"),10) || 0) + this.scrollParent.scrollTop(),\n\t\t\t\tleft: p.left - (parseInt(this.helper.css(\"left\"),10) || 0) + this.scrollParent.scrollLeft()\n\t\t\t};\n\t\t} else {\n\t\t\treturn { top: 0, left: 0 };\n\t\t}\n\n\t},\n\n\t_cacheMargins: function() {\n\t\tthis.margins = {\n\t\t\tleft: (parseInt(this.currentItem.css(\"marginLeft\"),10) || 0),\n\t\t\ttop: (parseInt(this.currentItem.css(\"marginTop\"),10) || 0)\n\t\t};\n\t},\n\n\t_cacheHelperProportions: function() {\n\t\tthis.helperProportions = {\n\t\t\twidth: this.helper.outerWidth(),\n\t\t\theight: this.helper.outerHeight()\n\t\t};\n\t},\n\n\t_setContainment: function() {\n\n\t\tvar ce, co, over,\n\t\t\to = this.options;\n\t\tif(o.containment === \"parent\") {\n\t\t\to.containment = this.helper[0].parentNode;\n\t\t}\n\t\tif(o.containment === \"document\" || o.containment === \"window\") {\n\t\t\tthis.containment = [\n\t\t\t\t0 - this.offset.relative.left - this.offset.parent.left,\n\t\t\t\t0 - this.offset.relative.top - this.offset.parent.top,\n\t\t\t\to.containment === \"document\" ? this.document.width() : this.window.width() - this.helperProportions.width - this.margins.left,\n\t\t\t\t(o.containment === \"document\" ? this.document.width() : this.window.height() || this.document[0].body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top\n\t\t\t];\n\t\t}\n\n\t\tif(!(/^(document|window|parent)$/).test(o.containment)) {\n\t\t\tce = $(o.containment)[0];\n\t\t\tco = $(o.containment).offset();\n\t\t\tover = ($(ce).css(\"overflow\") !== \"hidden\");\n\n\t\t\tthis.containment = [\n\t\t\t\tco.left + (parseInt($(ce).css(\"borderLeftWidth\"),10) || 0) + (parseInt($(ce).css(\"paddingLeft\"),10) || 0) - this.margins.left,\n\t\t\t\tco.top + (parseInt($(ce).css(\"borderTopWidth\"),10) || 0) + (parseInt($(ce).css(\"paddingTop\"),10) || 0) - this.margins.top,\n\t\t\t\tco.left+(over ? Math.max(ce.scrollWidth,ce.offsetWidth) : ce.offsetWidth) - (parseInt($(ce).css(\"borderLeftWidth\"),10) || 0) - (parseInt($(ce).css(\"paddingRight\"),10) || 0) - this.helperProportions.width - this.margins.left,\n\t\t\t\tco.top+(over ? Math.max(ce.scrollHeight,ce.offsetHeight) : ce.offsetHeight) - (parseInt($(ce).css(\"borderTopWidth\"),10) || 0) - (parseInt($(ce).css(\"paddingBottom\"),10) || 0) - this.helperProportions.height - this.margins.top\n\t\t\t];\n\t\t}\n\n\t},\n\n\t_convertPositionTo: function(d, pos) {\n\n\t\tif(!pos) {\n\t\t\tpos = this.position;\n\t\t}\n\t\tvar mod = d === \"absolute\" ? 1 : -1,\n\t\t\tscroll = this.cssPosition === \"absolute\" && !(this.scrollParent[0] !== this.document[0] && $.contains(this.scrollParent[0], this.offsetParent[0])) ? this.offsetParent : this.scrollParent,\n\t\t\tscrollIsRootNode = (/(html|body)/i).test(scroll[0].tagName);\n\n\t\treturn {\n\t\t\ttop: (\n\t\t\t\tpos.top\t+\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// The absolute mouse position\n\t\t\t\tthis.offset.relative.top * mod +\t\t\t\t\t\t\t\t\t\t// Only for relative positioned nodes: Relative offset from element to offset parent\n\t\t\t\tthis.offset.parent.top * mod -\t\t\t\t\t\t\t\t\t\t\t// The offsetParent's offset without borders (offset + border)\n\t\t\t\t( ( this.cssPosition === \"fixed\" ? -this.scrollParent.scrollTop() : ( scrollIsRootNode ? 0 : scroll.scrollTop() ) ) * mod)\n\t\t\t),\n\t\t\tleft: (\n\t\t\t\tpos.left +\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// The absolute mouse position\n\t\t\t\tthis.offset.relative.left * mod +\t\t\t\t\t\t\t\t\t\t// Only for relative positioned nodes: Relative offset from element to offset parent\n\t\t\t\tthis.offset.parent.left * mod\t-\t\t\t\t\t\t\t\t\t\t// The offsetParent's offset without borders (offset + border)\n\t\t\t\t( ( this.cssPosition === \"fixed\" ? -this.scrollParent.scrollLeft() : scrollIsRootNode ? 0 : scroll.scrollLeft() ) * mod)\n\t\t\t)\n\t\t};\n\n\t},\n\n\t_generatePosition: function(event) {\n\n\t\tvar top, left,\n\t\t\to = this.options,\n\t\t\tpageX = event.pageX,\n\t\t\tpageY = event.pageY,\n\t\t\tscroll = this.cssPosition === \"absolute\" && !(this.scrollParent[0] !== this.document[0] && $.contains(this.scrollParent[0], this.offsetParent[0])) ? this.offsetParent : this.scrollParent, scrollIsRootNode = (/(html|body)/i).test(scroll[0].tagName);\n\n\t\t// This is another very weird special case that only happens for relative elements:\n\t\t// 1. If the css position is relative\n\t\t// 2. and the scroll parent is the document or similar to the offset parent\n\t\t// we have to refresh the relative offset during the scroll so there are no jumps\n\t\tif(this.cssPosition === \"relative\" && !(this.scrollParent[0] !== this.document[0] && this.scrollParent[0] !== this.offsetParent[0])) {\n\t\t\tthis.offset.relative = this._getRelativeOffset();\n\t\t}\n\n\t\t/*\n\t\t * - Position constraining -\n\t\t * Constrain the position to a mix of grid, containment.\n\t\t */\n\n\t\tif(this.originalPosition) { //If we are not dragging yet, we won't check for options\n\n\t\t\tif(this.containment) {\n\t\t\t\tif(event.pageX - this.offset.click.left < this.containment[0]) {\n\t\t\t\t\tpageX = this.containment[0] + this.offset.click.left;\n\t\t\t\t}\n\t\t\t\tif(event.pageY - this.offset.click.top < this.containment[1]) {\n\t\t\t\t\tpageY = this.containment[1] + this.offset.click.top;\n\t\t\t\t}\n\t\t\t\tif(event.pageX - this.offset.click.left > this.containment[2]) {\n\t\t\t\t\tpageX = this.containment[2] + this.offset.click.left;\n\t\t\t\t}\n\t\t\t\tif(event.pageY - this.offset.click.top > this.containment[3]) {\n\t\t\t\t\tpageY = this.containment[3] + this.offset.click.top;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(o.grid) {\n\t\t\t\ttop = this.originalPageY + Math.round((pageY - this.originalPageY) / o.grid[1]) * o.grid[1];\n\t\t\t\tpageY = this.containment ? ( (top - this.offset.click.top >= this.containment[1] && top - this.offset.click.top <= this.containment[3]) ? top : ((top - this.offset.click.top >= this.containment[1]) ? top - o.grid[1] : top + o.grid[1])) : top;\n\n\t\t\t\tleft = this.originalPageX + Math.round((pageX - this.originalPageX) / o.grid[0]) * o.grid[0];\n\t\t\t\tpageX = this.containment ? ( (left - this.offset.click.left >= this.containment[0] && left - this.offset.click.left <= this.containment[2]) ? left : ((left - this.offset.click.left >= this.containment[0]) ? left - o.grid[0] : left + o.grid[0])) : left;\n\t\t\t}\n\n\t\t}\n\n\t\treturn {\n\t\t\ttop: (\n\t\t\t\tpageY -\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// The absolute mouse position\n\t\t\t\tthis.offset.click.top -\t\t\t\t\t\t\t\t\t\t\t\t\t// Click offset (relative to the element)\n\t\t\t\tthis.offset.relative.top\t-\t\t\t\t\t\t\t\t\t\t\t// Only for relative positioned nodes: Relative offset from element to offset parent\n\t\t\t\tthis.offset.parent.top +\t\t\t\t\t\t\t\t\t\t\t\t// The offsetParent's offset without borders (offset + border)\n\t\t\t\t( ( this.cssPosition === \"fixed\" ? -this.scrollParent.scrollTop() : ( scrollIsRootNode ? 0 : scroll.scrollTop() ) ))\n\t\t\t),\n\t\t\tleft: (\n\t\t\t\tpageX -\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// The absolute mouse position\n\t\t\t\tthis.offset.click.left -\t\t\t\t\t\t\t\t\t\t\t\t// Click offset (relative to the element)\n\t\t\t\tthis.offset.relative.left\t-\t\t\t\t\t\t\t\t\t\t\t// Only for relative positioned nodes: Relative offset from element to offset parent\n\t\t\t\tthis.offset.parent.left +\t\t\t\t\t\t\t\t\t\t\t\t// The offsetParent's offset without borders (offset + border)\n\t\t\t\t( ( this.cssPosition === \"fixed\" ? -this.scrollParent.scrollLeft() : scrollIsRootNode ? 0 : scroll.scrollLeft() ))\n\t\t\t)\n\t\t};\n\n\t},\n\n\t_rearrange: function(event, i, a, hardRefresh) {\n\n\t\ta ? a[0].appendChild(this.placeholder[0]) : i.item[0].parentNode.insertBefore(this.placeholder[0], (this.direction === \"down\" ? i.item[0] : i.item[0].nextSibling));\n\n\t\t//Various things done here to improve the performance:\n\t\t// 1. we create a setTimeout, that calls refreshPositions\n\t\t// 2. on the instance, we have a counter variable, that get's higher after every append\n\t\t// 3. on the local scope, we copy the counter variable, and check in the timeout, if it's still the same\n\t\t// 4. this lets only the last addition to the timeout stack through\n\t\tthis.counter = this.counter ? ++this.counter : 1;\n\t\tvar counter = this.counter;\n\n\t\tthis._delay(function() {\n\t\t\tif(counter === this.counter) {\n\t\t\t\tthis.refreshPositions(!hardRefresh); //Precompute after each DOM insertion, NOT on mousemove\n\t\t\t}\n\t\t});\n\n\t},\n\n\t_clear: function(event, noPropagation) {\n\n\t\tthis.reverting = false;\n\t\t// We delay all events that have to be triggered to after the point where the placeholder has been removed and\n\t\t// everything else normalized again\n\t\tvar i,\n\t\t\tdelayedTriggers = [];\n\n\t\t// We first have to update the dom position of the actual currentItem\n\t\t// Note: don't do it if the current item is already removed (by a user), or it gets reappended (see #4088)\n\t\tif(!this._noFinalSort && this.currentItem.parent().length) {\n\t\t\tthis.placeholder.before(this.currentItem);\n\t\t}\n\t\tthis._noFinalSort = null;\n\n\t\tif(this.helper[0] === this.currentItem[0]) {\n\t\t\tfor(i in this._storedCSS) {\n\t\t\t\tif(this._storedCSS[i] === \"auto\" || this._storedCSS[i] === \"static\") {\n\t\t\t\t\tthis._storedCSS[i] = \"\";\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.currentItem.css(this._storedCSS).removeClass(\"ui-sortable-helper\");\n\t\t} else {\n\t\t\tthis.currentItem.show();\n\t\t}\n\n\t\tif(this.fromOutside && !noPropagation) {\n\t\t\tdelayedTriggers.push(function(event) { this._trigger(\"receive\", event, this._uiHash(this.fromOutside)); });\n\t\t}\n\t\tif((this.fromOutside || this.domPosition.prev !== this.currentItem.prev().not(\".ui-sortable-helper\")[0] || this.domPosition.parent !== this.currentItem.parent()[0]) && !noPropagation) {\n\t\t\tdelayedTriggers.push(function(event) { this._trigger(\"update\", event, this._uiHash()); }); //Trigger update callback if the DOM position has changed\n\t\t}\n\n\t\t// Check if the items Container has Changed and trigger appropriate\n\t\t// events.\n\t\tif (this !== this.currentContainer) {\n\t\t\tif(!noPropagation) {\n\t\t\t\tdelayedTriggers.push(function(event) { this._trigger(\"remove\", event, this._uiHash()); });\n\t\t\t\tdelayedTriggers.push((function(c) { return function(event) { c._trigger(\"receive\", event, this._uiHash(this)); };  }).call(this, this.currentContainer));\n\t\t\t\tdelayedTriggers.push((function(c) { return function(event) { c._trigger(\"update\", event, this._uiHash(this));  }; }).call(this, this.currentContainer));\n\t\t\t}\n\t\t}\n\n\n\t\t//Post events to containers\n\t\tfunction delayEvent( type, instance, container ) {\n\t\t\treturn function( event ) {\n\t\t\t\tcontainer._trigger( type, event, instance._uiHash( instance ) );\n\t\t\t};\n\t\t}\n\t\tfor (i = this.containers.length - 1; i >= 0; i--){\n\t\t\tif (!noPropagation) {\n\t\t\t\tdelayedTriggers.push( delayEvent( \"deactivate\", this, this.containers[ i ] ) );\n\t\t\t}\n\t\t\tif(this.containers[i].containerCache.over) {\n\t\t\t\tdelayedTriggers.push( delayEvent( \"out\", this, this.containers[ i ] ) );\n\t\t\t\tthis.containers[i].containerCache.over = 0;\n\t\t\t}\n\t\t}\n\n\t\t//Do what was originally in plugins\n\t\tif ( this.storedCursor ) {\n\t\t\tthis.document.find( \"body\" ).css( \"cursor\", this.storedCursor );\n\t\t\tthis.storedStylesheet.remove();\n\t\t}\n\t\tif(this._storedOpacity) {\n\t\t\tthis.helper.css(\"opacity\", this._storedOpacity);\n\t\t}\n\t\tif(this._storedZIndex) {\n\t\t\tthis.helper.css(\"zIndex\", this._storedZIndex === \"auto\" ? \"\" : this._storedZIndex);\n\t\t}\n\n\t\tthis.dragging = false;\n\n\t\tif(!noPropagation) {\n\t\t\tthis._trigger(\"beforeStop\", event, this._uiHash());\n\t\t}\n\n\t\t//$(this.placeholder[0]).remove(); would have been the jQuery way - unfortunately, it unbinds ALL events from the original node!\n\t\tthis.placeholder[0].parentNode.removeChild(this.placeholder[0]);\n\n\t\tif ( !this.cancelHelperRemoval ) {\n\t\t\tif ( this.helper[ 0 ] !== this.currentItem[ 0 ] ) {\n\t\t\t\tthis.helper.remove();\n\t\t\t}\n\t\t\tthis.helper = null;\n\t\t}\n\n\t\tif(!noPropagation) {\n\t\t\tfor (i=0; i < delayedTriggers.length; i++) {\n\t\t\t\tdelayedTriggers[i].call(this, event);\n\t\t\t} //Trigger all delayed events\n\t\t\tthis._trigger(\"stop\", event, this._uiHash());\n\t\t}\n\n\t\tthis.fromOutside = false;\n\t\treturn !this.cancelHelperRemoval;\n\n\t},\n\n\t_trigger: function() {\n\t\tif ($.Widget.prototype._trigger.apply(this, arguments) === false) {\n\t\t\tthis.cancel();\n\t\t}\n\t},\n\n\t_uiHash: function(_inst) {\n\t\tvar inst = _inst || this;\n\t\treturn {\n\t\t\thelper: inst.helper,\n\t\t\tplaceholder: inst.placeholder || $([]),\n\t\t\tposition: inst.position,\n\t\t\toriginalPosition: inst.originalPosition,\n\t\t\toffset: inst.positionAbs,\n\t\t\titem: inst.currentItem,\n\t\t\tsender: _inst ? _inst.element : null\n\t\t};\n\t}\n\n});\n\n\n/*!\n * jQuery UI Spinner 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/spinner/\n */\n\n\nfunction spinner_modifier( fn ) {\n\treturn function() {\n\t\tvar previous = this.element.val();\n\t\tfn.apply( this, arguments );\n\t\tthis._refresh();\n\t\tif ( previous !== this.element.val() ) {\n\t\t\tthis._trigger( \"change\" );\n\t\t}\n\t};\n}\n\nvar spinner = $.widget( \"ui.spinner\", {\n\tversion: \"1.11.4\",\n\tdefaultElement: \"<input>\",\n\twidgetEventPrefix: \"spin\",\n\toptions: {\n\t\tculture: null,\n\t\ticons: {\n\t\t\tdown: \"ui-icon-triangle-1-s\",\n\t\t\tup: \"ui-icon-triangle-1-n\"\n\t\t},\n\t\tincremental: true,\n\t\tmax: null,\n\t\tmin: null,\n\t\tnumberFormat: null,\n\t\tpage: 10,\n\t\tstep: 1,\n\n\t\tchange: null,\n\t\tspin: null,\n\t\tstart: null,\n\t\tstop: null\n\t},\n\n\t_create: function() {\n\t\t// handle string values that need to be parsed\n\t\tthis._setOption( \"max\", this.options.max );\n\t\tthis._setOption( \"min\", this.options.min );\n\t\tthis._setOption( \"step\", this.options.step );\n\n\t\t// Only format if there is a value, prevents the field from being marked\n\t\t// as invalid in Firefox, see #9573.\n\t\tif ( this.value() !== \"\" ) {\n\t\t\t// Format the value, but don't constrain.\n\t\t\tthis._value( this.element.val(), true );\n\t\t}\n\n\t\tthis._draw();\n\t\tthis._on( this._events );\n\t\tthis._refresh();\n\n\t\t// turning off autocomplete prevents the browser from remembering the\n\t\t// value when navigating through history, so we re-enable autocomplete\n\t\t// if the page is unloaded before the widget is destroyed. #7790\n\t\tthis._on( this.window, {\n\t\t\tbeforeunload: function() {\n\t\t\t\tthis.element.removeAttr( \"autocomplete\" );\n\t\t\t}\n\t\t});\n\t},\n\n\t_getCreateOptions: function() {\n\t\tvar options = {},\n\t\t\telement = this.element;\n\n\t\t$.each( [ \"min\", \"max\", \"step\" ], function( i, option ) {\n\t\t\tvar value = element.attr( option );\n\t\t\tif ( value !== undefined && value.length ) {\n\t\t\t\toptions[ option ] = value;\n\t\t\t}\n\t\t});\n\n\t\treturn options;\n\t},\n\n\t_events: {\n\t\tkeydown: function( event ) {\n\t\t\tif ( this._start( event ) && this._keydown( event ) ) {\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t},\n\t\tkeyup: \"_stop\",\n\t\tfocus: function() {\n\t\t\tthis.previous = this.element.val();\n\t\t},\n\t\tblur: function( event ) {\n\t\t\tif ( this.cancelBlur ) {\n\t\t\t\tdelete this.cancelBlur;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._stop();\n\t\t\tthis._refresh();\n\t\t\tif ( this.previous !== this.element.val() ) {\n\t\t\t\tthis._trigger( \"change\", event );\n\t\t\t}\n\t\t},\n\t\tmousewheel: function( event, delta ) {\n\t\t\tif ( !delta ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif ( !this.spinning && !this._start( event ) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis._spin( (delta > 0 ? 1 : -1) * this.options.step, event );\n\t\t\tclearTimeout( this.mousewheelTimer );\n\t\t\tthis.mousewheelTimer = this._delay(function() {\n\t\t\t\tif ( this.spinning ) {\n\t\t\t\t\tthis._stop( event );\n\t\t\t\t}\n\t\t\t}, 100 );\n\t\t\tevent.preventDefault();\n\t\t},\n\t\t\"mousedown .ui-spinner-button\": function( event ) {\n\t\t\tvar previous;\n\n\t\t\t// We never want the buttons to have focus; whenever the user is\n\t\t\t// interacting with the spinner, the focus should be on the input.\n\t\t\t// If the input is focused then this.previous is properly set from\n\t\t\t// when the input first received focus. If the input is not focused\n\t\t\t// then we need to set this.previous based on the value before spinning.\n\t\t\tprevious = this.element[0] === this.document[0].activeElement ?\n\t\t\t\tthis.previous : this.element.val();\n\t\t\tfunction checkFocus() {\n\t\t\t\tvar isActive = this.element[0] === this.document[0].activeElement;\n\t\t\t\tif ( !isActive ) {\n\t\t\t\t\tthis.element.focus();\n\t\t\t\t\tthis.previous = previous;\n\t\t\t\t\t// support: IE\n\t\t\t\t\t// IE sets focus asynchronously, so we need to check if focus\n\t\t\t\t\t// moved off of the input because the user clicked on the button.\n\t\t\t\t\tthis._delay(function() {\n\t\t\t\t\t\tthis.previous = previous;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// ensure focus is on (or stays on) the text field\n\t\t\tevent.preventDefault();\n\t\t\tcheckFocus.call( this );\n\n\t\t\t// support: IE\n\t\t\t// IE doesn't prevent moving focus even with event.preventDefault()\n\t\t\t// so we set a flag to know when we should ignore the blur event\n\t\t\t// and check (again) if focus moved off of the input.\n\t\t\tthis.cancelBlur = true;\n\t\t\tthis._delay(function() {\n\t\t\t\tdelete this.cancelBlur;\n\t\t\t\tcheckFocus.call( this );\n\t\t\t});\n\n\t\t\tif ( this._start( event ) === false ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._repeat( null, $( event.currentTarget ).hasClass( \"ui-spinner-up\" ) ? 1 : -1, event );\n\t\t},\n\t\t\"mouseup .ui-spinner-button\": \"_stop\",\n\t\t\"mouseenter .ui-spinner-button\": function( event ) {\n\t\t\t// button will add ui-state-active if mouse was down while mouseleave and kept down\n\t\t\tif ( !$( event.currentTarget ).hasClass( \"ui-state-active\" ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( this._start( event ) === false ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis._repeat( null, $( event.currentTarget ).hasClass( \"ui-spinner-up\" ) ? 1 : -1, event );\n\t\t},\n\t\t// TODO: do we really want to consider this a stop?\n\t\t// shouldn't we just stop the repeater and wait until mouseup before\n\t\t// we trigger the stop event?\n\t\t\"mouseleave .ui-spinner-button\": \"_stop\"\n\t},\n\n\t_draw: function() {\n\t\tvar uiSpinner = this.uiSpinner = this.element\n\t\t\t.addClass( \"ui-spinner-input\" )\n\t\t\t.attr( \"autocomplete\", \"off\" )\n\t\t\t.wrap( this._uiSpinnerHtml() )\n\t\t\t.parent()\n\t\t\t\t// add buttons\n\t\t\t\t.append( this._buttonHtml() );\n\n\t\tthis.element.attr( \"role\", \"spinbutton\" );\n\n\t\t// button bindings\n\t\tthis.buttons = uiSpinner.find( \".ui-spinner-button\" )\n\t\t\t.attr( \"tabIndex\", -1 )\n\t\t\t.button()\n\t\t\t.removeClass( \"ui-corner-all\" );\n\n\t\t// IE 6 doesn't understand height: 50% for the buttons\n\t\t// unless the wrapper has an explicit height\n\t\tif ( this.buttons.height() > Math.ceil( uiSpinner.height() * 0.5 ) &&\n\t\t\t\tuiSpinner.height() > 0 ) {\n\t\t\tuiSpinner.height( uiSpinner.height() );\n\t\t}\n\n\t\t// disable spinner if element was already disabled\n\t\tif ( this.options.disabled ) {\n\t\t\tthis.disable();\n\t\t}\n\t},\n\n\t_keydown: function( event ) {\n\t\tvar options = this.options,\n\t\t\tkeyCode = $.ui.keyCode;\n\n\t\tswitch ( event.keyCode ) {\n\t\tcase keyCode.UP:\n\t\t\tthis._repeat( null, 1, event );\n\t\t\treturn true;\n\t\tcase keyCode.DOWN:\n\t\t\tthis._repeat( null, -1, event );\n\t\t\treturn true;\n\t\tcase keyCode.PAGE_UP:\n\t\t\tthis._repeat( null, options.page, event );\n\t\t\treturn true;\n\t\tcase keyCode.PAGE_DOWN:\n\t\t\tthis._repeat( null, -options.page, event );\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t},\n\n\t_uiSpinnerHtml: function() {\n\t\treturn \"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>\";\n\t},\n\n\t_buttonHtml: function() {\n\t\treturn \"\" +\n\t\t\t\"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'>\" +\n\t\t\t\t\"<span class='ui-icon \" + this.options.icons.up + \"'>&#9650;</span>\" +\n\t\t\t\"</a>\" +\n\t\t\t\"<a class='ui-spinner-button ui-spinner-down ui-corner-br'>\" +\n\t\t\t\t\"<span class='ui-icon \" + this.options.icons.down + \"'>&#9660;</span>\" +\n\t\t\t\"</a>\";\n\t},\n\n\t_start: function( event ) {\n\t\tif ( !this.spinning && this._trigger( \"start\", event ) === false ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif ( !this.counter ) {\n\t\t\tthis.counter = 1;\n\t\t}\n\t\tthis.spinning = true;\n\t\treturn true;\n\t},\n\n\t_repeat: function( i, steps, event ) {\n\t\ti = i || 500;\n\n\t\tclearTimeout( this.timer );\n\t\tthis.timer = this._delay(function() {\n\t\t\tthis._repeat( 40, steps, event );\n\t\t}, i );\n\n\t\tthis._spin( steps * this.options.step, event );\n\t},\n\n\t_spin: function( step, event ) {\n\t\tvar value = this.value() || 0;\n\n\t\tif ( !this.counter ) {\n\t\t\tthis.counter = 1;\n\t\t}\n\n\t\tvalue = this._adjustValue( value + step * this._increment( this.counter ) );\n\n\t\tif ( !this.spinning || this._trigger( \"spin\", event, { value: value } ) !== false) {\n\t\t\tthis._value( value );\n\t\t\tthis.counter++;\n\t\t}\n\t},\n\n\t_increment: function( i ) {\n\t\tvar incremental = this.options.incremental;\n\n\t\tif ( incremental ) {\n\t\t\treturn $.isFunction( incremental ) ?\n\t\t\t\tincremental( i ) :\n\t\t\t\tMath.floor( i * i * i / 50000 - i * i / 500 + 17 * i / 200 + 1 );\n\t\t}\n\n\t\treturn 1;\n\t},\n\n\t_precision: function() {\n\t\tvar precision = this._precisionOf( this.options.step );\n\t\tif ( this.options.min !== null ) {\n\t\t\tprecision = Math.max( precision, this._precisionOf( this.options.min ) );\n\t\t}\n\t\treturn precision;\n\t},\n\n\t_precisionOf: function( num ) {\n\t\tvar str = num.toString(),\n\t\t\tdecimal = str.indexOf( \".\" );\n\t\treturn decimal === -1 ? 0 : str.length - decimal - 1;\n\t},\n\n\t_adjustValue: function( value ) {\n\t\tvar base, aboveMin,\n\t\t\toptions = this.options;\n\n\t\t// make sure we're at a valid step\n\t\t// - find out where we are relative to the base (min or 0)\n\t\tbase = options.min !== null ? options.min : 0;\n\t\taboveMin = value - base;\n\t\t// - round to the nearest step\n\t\taboveMin = Math.round(aboveMin / options.step) * options.step;\n\t\t// - rounding is based on 0, so adjust back to our base\n\t\tvalue = base + aboveMin;\n\n\t\t// fix precision from bad JS floating point math\n\t\tvalue = parseFloat( value.toFixed( this._precision() ) );\n\n\t\t// clamp the value\n\t\tif ( options.max !== null && value > options.max) {\n\t\t\treturn options.max;\n\t\t}\n\t\tif ( options.min !== null && value < options.min ) {\n\t\t\treturn options.min;\n\t\t}\n\n\t\treturn value;\n\t},\n\n\t_stop: function( event ) {\n\t\tif ( !this.spinning ) {\n\t\t\treturn;\n\t\t}\n\n\t\tclearTimeout( this.timer );\n\t\tclearTimeout( this.mousewheelTimer );\n\t\tthis.counter = 0;\n\t\tthis.spinning = false;\n\t\tthis._trigger( \"stop\", event );\n\t},\n\n\t_setOption: function( key, value ) {\n\t\tif ( key === \"culture\" || key === \"numberFormat\" ) {\n\t\t\tvar prevValue = this._parse( this.element.val() );\n\t\t\tthis.options[ key ] = value;\n\t\t\tthis.element.val( this._format( prevValue ) );\n\t\t\treturn;\n\t\t}\n\n\t\tif ( key === \"max\" || key === \"min\" || key === \"step\" ) {\n\t\t\tif ( typeof value === \"string\" ) {\n\t\t\t\tvalue = this._parse( value );\n\t\t\t}\n\t\t}\n\t\tif ( key === \"icons\" ) {\n\t\t\tthis.buttons.first().find( \".ui-icon\" )\n\t\t\t\t.removeClass( this.options.icons.up )\n\t\t\t\t.addClass( value.up );\n\t\t\tthis.buttons.last().find( \".ui-icon\" )\n\t\t\t\t.removeClass( this.options.icons.down )\n\t\t\t\t.addClass( value.down );\n\t\t}\n\n\t\tthis._super( key, value );\n\n\t\tif ( key === \"disabled\" ) {\n\t\t\tthis.widget().toggleClass( \"ui-state-disabled\", !!value );\n\t\t\tthis.element.prop( \"disabled\", !!value );\n\t\t\tthis.buttons.button( value ? \"disable\" : \"enable\" );\n\t\t}\n\t},\n\n\t_setOptions: spinner_modifier(function( options ) {\n\t\tthis._super( options );\n\t}),\n\n\t_parse: function( val ) {\n\t\tif ( typeof val === \"string\" && val !== \"\" ) {\n\t\t\tval = window.Globalize && this.options.numberFormat ?\n\t\t\t\tGlobalize.parseFloat( val, 10, this.options.culture ) : +val;\n\t\t}\n\t\treturn val === \"\" || isNaN( val ) ? null : val;\n\t},\n\n\t_format: function( value ) {\n\t\tif ( value === \"\" ) {\n\t\t\treturn \"\";\n\t\t}\n\t\treturn window.Globalize && this.options.numberFormat ?\n\t\t\tGlobalize.format( value, this.options.numberFormat, this.options.culture ) :\n\t\t\tvalue;\n\t},\n\n\t_refresh: function() {\n\t\tthis.element.attr({\n\t\t\t\"aria-valuemin\": this.options.min,\n\t\t\t\"aria-valuemax\": this.options.max,\n\t\t\t// TODO: what should we do with values that can't be parsed?\n\t\t\t\"aria-valuenow\": this._parse( this.element.val() )\n\t\t});\n\t},\n\n\tisValid: function() {\n\t\tvar value = this.value();\n\n\t\t// null is invalid\n\t\tif ( value === null ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// if value gets adjusted, it's invalid\n\t\treturn value === this._adjustValue( value );\n\t},\n\n\t// update the value without triggering change\n\t_value: function( value, allowAny ) {\n\t\tvar parsed;\n\t\tif ( value !== \"\" ) {\n\t\t\tparsed = this._parse( value );\n\t\t\tif ( parsed !== null ) {\n\t\t\t\tif ( !allowAny ) {\n\t\t\t\t\tparsed = this._adjustValue( parsed );\n\t\t\t\t}\n\t\t\t\tvalue = this._format( parsed );\n\t\t\t}\n\t\t}\n\t\tthis.element.val( value );\n\t\tthis._refresh();\n\t},\n\n\t_destroy: function() {\n\t\tthis.element\n\t\t\t.removeClass( \"ui-spinner-input\" )\n\t\t\t.prop( \"disabled\", false )\n\t\t\t.removeAttr( \"autocomplete\" )\n\t\t\t.removeAttr( \"role\" )\n\t\t\t.removeAttr( \"aria-valuemin\" )\n\t\t\t.removeAttr( \"aria-valuemax\" )\n\t\t\t.removeAttr( \"aria-valuenow\" );\n\t\tthis.uiSpinner.replaceWith( this.element );\n\t},\n\n\tstepUp: spinner_modifier(function( steps ) {\n\t\tthis._stepUp( steps );\n\t}),\n\t_stepUp: function( steps ) {\n\t\tif ( this._start() ) {\n\t\t\tthis._spin( (steps || 1) * this.options.step );\n\t\t\tthis._stop();\n\t\t}\n\t},\n\n\tstepDown: spinner_modifier(function( steps ) {\n\t\tthis._stepDown( steps );\n\t}),\n\t_stepDown: function( steps ) {\n\t\tif ( this._start() ) {\n\t\t\tthis._spin( (steps || 1) * -this.options.step );\n\t\t\tthis._stop();\n\t\t}\n\t},\n\n\tpageUp: spinner_modifier(function( pages ) {\n\t\tthis._stepUp( (pages || 1) * this.options.page );\n\t}),\n\n\tpageDown: spinner_modifier(function( pages ) {\n\t\tthis._stepDown( (pages || 1) * this.options.page );\n\t}),\n\n\tvalue: function( newVal ) {\n\t\tif ( !arguments.length ) {\n\t\t\treturn this._parse( this.element.val() );\n\t\t}\n\t\tspinner_modifier( this._value ).call( this, newVal );\n\t},\n\n\twidget: function() {\n\t\treturn this.uiSpinner;\n\t}\n});\n\n\n/*!\n * jQuery UI Tabs 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/tabs/\n */\n\n\nvar tabs = $.widget( \"ui.tabs\", {\n\tversion: \"1.11.4\",\n\tdelay: 300,\n\toptions: {\n\t\tactive: null,\n\t\tcollapsible: false,\n\t\tevent: \"click\",\n\t\theightStyle: \"content\",\n\t\thide: null,\n\t\tshow: null,\n\n\t\t// callbacks\n\t\tactivate: null,\n\t\tbeforeActivate: null,\n\t\tbeforeLoad: null,\n\t\tload: null\n\t},\n\n\t_isLocal: (function() {\n\t\tvar rhash = /#.*$/;\n\n\t\treturn function( anchor ) {\n\t\t\tvar anchorUrl, locationUrl;\n\n\t\t\t// support: IE7\n\t\t\t// IE7 doesn't normalize the href property when set via script (#9317)\n\t\t\tanchor = anchor.cloneNode( false );\n\n\t\t\tanchorUrl = anchor.href.replace( rhash, \"\" );\n\t\t\tlocationUrl = location.href.replace( rhash, \"\" );\n\n\t\t\t// decoding may throw an error if the URL isn't UTF-8 (#9518)\n\t\t\ttry {\n\t\t\t\tanchorUrl = decodeURIComponent( anchorUrl );\n\t\t\t} catch ( error ) {}\n\t\t\ttry {\n\t\t\t\tlocationUrl = decodeURIComponent( locationUrl );\n\t\t\t} catch ( error ) {}\n\n\t\t\treturn anchor.hash.length > 1 && anchorUrl === locationUrl;\n\t\t};\n\t})(),\n\n\t_create: function() {\n\t\tvar that = this,\n\t\t\toptions = this.options;\n\n\t\tthis.running = false;\n\n\t\tthis.element\n\t\t\t.addClass( \"ui-tabs ui-widget ui-widget-content ui-corner-all\" )\n\t\t\t.toggleClass( \"ui-tabs-collapsible\", options.collapsible );\n\n\t\tthis._processTabs();\n\t\toptions.active = this._initialActive();\n\n\t\t// Take disabling tabs via class attribute from HTML\n\t\t// into account and update option properly.\n\t\tif ( $.isArray( options.disabled ) ) {\n\t\t\toptions.disabled = $.unique( options.disabled.concat(\n\t\t\t\t$.map( this.tabs.filter( \".ui-state-disabled\" ), function( li ) {\n\t\t\t\t\treturn that.tabs.index( li );\n\t\t\t\t})\n\t\t\t) ).sort();\n\t\t}\n\n\t\t// check for length avoids error when initializing empty list\n\t\tif ( this.options.active !== false && this.anchors.length ) {\n\t\t\tthis.active = this._findActive( options.active );\n\t\t} else {\n\t\t\tthis.active = $();\n\t\t}\n\n\t\tthis._refresh();\n\n\t\tif ( this.active.length ) {\n\t\t\tthis.load( options.active );\n\t\t}\n\t},\n\n\t_initialActive: function() {\n\t\tvar active = this.options.active,\n\t\t\tcollapsible = this.options.collapsible,\n\t\t\tlocationHash = location.hash.substring( 1 );\n\n\t\tif ( active === null ) {\n\t\t\t// check the fragment identifier in the URL\n\t\t\tif ( locationHash ) {\n\t\t\t\tthis.tabs.each(function( i, tab ) {\n\t\t\t\t\tif ( $( tab ).attr( \"aria-controls\" ) === locationHash ) {\n\t\t\t\t\t\tactive = i;\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// check for a tab marked active via a class\n\t\t\tif ( active === null ) {\n\t\t\t\tactive = this.tabs.index( this.tabs.filter( \".ui-tabs-active\" ) );\n\t\t\t}\n\n\t\t\t// no active tab, set to false\n\t\t\tif ( active === null || active === -1 ) {\n\t\t\t\tactive = this.tabs.length ? 0 : false;\n\t\t\t}\n\t\t}\n\n\t\t// handle numbers: negative, out of range\n\t\tif ( active !== false ) {\n\t\t\tactive = this.tabs.index( this.tabs.eq( active ) );\n\t\t\tif ( active === -1 ) {\n\t\t\t\tactive = collapsible ? false : 0;\n\t\t\t}\n\t\t}\n\n\t\t// don't allow collapsible: false and active: false\n\t\tif ( !collapsible && active === false && this.anchors.length ) {\n\t\t\tactive = 0;\n\t\t}\n\n\t\treturn active;\n\t},\n\n\t_getCreateEventData: function() {\n\t\treturn {\n\t\t\ttab: this.active,\n\t\t\tpanel: !this.active.length ? $() : this._getPanelForTab( this.active )\n\t\t};\n\t},\n\n\t_tabKeydown: function( event ) {\n\t\tvar focusedTab = $( this.document[0].activeElement ).closest( \"li\" ),\n\t\t\tselectedIndex = this.tabs.index( focusedTab ),\n\t\t\tgoingForward = true;\n\n\t\tif ( this._handlePageNav( event ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tswitch ( event.keyCode ) {\n\t\t\tcase $.ui.keyCode.RIGHT:\n\t\t\tcase $.ui.keyCode.DOWN:\n\t\t\t\tselectedIndex++;\n\t\t\t\tbreak;\n\t\t\tcase $.ui.keyCode.UP:\n\t\t\tcase $.ui.keyCode.LEFT:\n\t\t\t\tgoingForward = false;\n\t\t\t\tselectedIndex--;\n\t\t\t\tbreak;\n\t\t\tcase $.ui.keyCode.END:\n\t\t\t\tselectedIndex = this.anchors.length - 1;\n\t\t\t\tbreak;\n\t\t\tcase $.ui.keyCode.HOME:\n\t\t\t\tselectedIndex = 0;\n\t\t\t\tbreak;\n\t\t\tcase $.ui.keyCode.SPACE:\n\t\t\t\t// Activate only, no collapsing\n\t\t\t\tevent.preventDefault();\n\t\t\t\tclearTimeout( this.activating );\n\t\t\t\tthis._activate( selectedIndex );\n\t\t\t\treturn;\n\t\t\tcase $.ui.keyCode.ENTER:\n\t\t\t\t// Toggle (cancel delayed activation, allow collapsing)\n\t\t\t\tevent.preventDefault();\n\t\t\t\tclearTimeout( this.activating );\n\t\t\t\t// Determine if we should collapse or activate\n\t\t\t\tthis._activate( selectedIndex === this.options.active ? false : selectedIndex );\n\t\t\t\treturn;\n\t\t\tdefault:\n\t\t\t\treturn;\n\t\t}\n\n\t\t// Focus the appropriate tab, based on which key was pressed\n\t\tevent.preventDefault();\n\t\tclearTimeout( this.activating );\n\t\tselectedIndex = this._focusNextTab( selectedIndex, goingForward );\n\n\t\t// Navigating with control/command key will prevent automatic activation\n\t\tif ( !event.ctrlKey && !event.metaKey ) {\n\n\t\t\t// Update aria-selected immediately so that AT think the tab is already selected.\n\t\t\t// Otherwise AT may confuse the user by stating that they need to activate the tab,\n\t\t\t// but the tab will already be activated by the time the announcement finishes.\n\t\t\tfocusedTab.attr( \"aria-selected\", \"false\" );\n\t\t\tthis.tabs.eq( selectedIndex ).attr( \"aria-selected\", \"true\" );\n\n\t\t\tthis.activating = this._delay(function() {\n\t\t\t\tthis.option( \"active\", selectedIndex );\n\t\t\t}, this.delay );\n\t\t}\n\t},\n\n\t_panelKeydown: function( event ) {\n\t\tif ( this._handlePageNav( event ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Ctrl+up moves focus to the current tab\n\t\tif ( event.ctrlKey && event.keyCode === $.ui.keyCode.UP ) {\n\t\t\tevent.preventDefault();\n\t\t\tthis.active.focus();\n\t\t}\n\t},\n\n\t// Alt+page up/down moves focus to the previous/next tab (and activates)\n\t_handlePageNav: function( event ) {\n\t\tif ( event.altKey && event.keyCode === $.ui.keyCode.PAGE_UP ) {\n\t\t\tthis._activate( this._focusNextTab( this.options.active - 1, false ) );\n\t\t\treturn true;\n\t\t}\n\t\tif ( event.altKey && event.keyCode === $.ui.keyCode.PAGE_DOWN ) {\n\t\t\tthis._activate( this._focusNextTab( this.options.active + 1, true ) );\n\t\t\treturn true;\n\t\t}\n\t},\n\n\t_findNextTab: function( index, goingForward ) {\n\t\tvar lastTabIndex = this.tabs.length - 1;\n\n\t\tfunction constrain() {\n\t\t\tif ( index > lastTabIndex ) {\n\t\t\t\tindex = 0;\n\t\t\t}\n\t\t\tif ( index < 0 ) {\n\t\t\t\tindex = lastTabIndex;\n\t\t\t}\n\t\t\treturn index;\n\t\t}\n\n\t\twhile ( $.inArray( constrain(), this.options.disabled ) !== -1 ) {\n\t\t\tindex = goingForward ? index + 1 : index - 1;\n\t\t}\n\n\t\treturn index;\n\t},\n\n\t_focusNextTab: function( index, goingForward ) {\n\t\tindex = this._findNextTab( index, goingForward );\n\t\tthis.tabs.eq( index ).focus();\n\t\treturn index;\n\t},\n\n\t_setOption: function( key, value ) {\n\t\tif ( key === \"active\" ) {\n\t\t\t// _activate() will handle invalid values and update this.options\n\t\t\tthis._activate( value );\n\t\t\treturn;\n\t\t}\n\n\t\tif ( key === \"disabled\" ) {\n\t\t\t// don't use the widget factory's disabled handling\n\t\t\tthis._setupDisabled( value );\n\t\t\treturn;\n\t\t}\n\n\t\tthis._super( key, value);\n\n\t\tif ( key === \"collapsible\" ) {\n\t\t\tthis.element.toggleClass( \"ui-tabs-collapsible\", value );\n\t\t\t// Setting collapsible: false while collapsed; open first panel\n\t\t\tif ( !value && this.options.active === false ) {\n\t\t\t\tthis._activate( 0 );\n\t\t\t}\n\t\t}\n\n\t\tif ( key === \"event\" ) {\n\t\t\tthis._setupEvents( value );\n\t\t}\n\n\t\tif ( key === \"heightStyle\" ) {\n\t\t\tthis._setupHeightStyle( value );\n\t\t}\n\t},\n\n\t_sanitizeSelector: function( hash ) {\n\t\treturn hash ? hash.replace( /[!\"$%&'()*+,.\\/:;<=>?@\\[\\]\\^`{|}~]/g, \"\\\\$&\" ) : \"\";\n\t},\n\n\trefresh: function() {\n\t\tvar options = this.options,\n\t\t\tlis = this.tablist.children( \":has(a[href])\" );\n\n\t\t// get disabled tabs from class attribute from HTML\n\t\t// this will get converted to a boolean if needed in _refresh()\n\t\toptions.disabled = $.map( lis.filter( \".ui-state-disabled\" ), function( tab ) {\n\t\t\treturn lis.index( tab );\n\t\t});\n\n\t\tthis._processTabs();\n\n\t\t// was collapsed or no tabs\n\t\tif ( options.active === false || !this.anchors.length ) {\n\t\t\toptions.active = false;\n\t\t\tthis.active = $();\n\t\t// was active, but active tab is gone\n\t\t} else if ( this.active.length && !$.contains( this.tablist[ 0 ], this.active[ 0 ] ) ) {\n\t\t\t// all remaining tabs are disabled\n\t\t\tif ( this.tabs.length === options.disabled.length ) {\n\t\t\t\toptions.active = false;\n\t\t\t\tthis.active = $();\n\t\t\t// activate previous tab\n\t\t\t} else {\n\t\t\t\tthis._activate( this._findNextTab( Math.max( 0, options.active - 1 ), false ) );\n\t\t\t}\n\t\t// was active, active tab still exists\n\t\t} else {\n\t\t\t// make sure active index is correct\n\t\t\toptions.active = this.tabs.index( this.active );\n\t\t}\n\n\t\tthis._refresh();\n\t},\n\n\t_refresh: function() {\n\t\tthis._setupDisabled( this.options.disabled );\n\t\tthis._setupEvents( this.options.event );\n\t\tthis._setupHeightStyle( this.options.heightStyle );\n\n\t\tthis.tabs.not( this.active ).attr({\n\t\t\t\"aria-selected\": \"false\",\n\t\t\t\"aria-expanded\": \"false\",\n\t\t\ttabIndex: -1\n\t\t});\n\t\tthis.panels.not( this._getPanelForTab( this.active ) )\n\t\t\t.hide()\n\t\t\t.attr({\n\t\t\t\t\"aria-hidden\": \"true\"\n\t\t\t});\n\n\t\t// Make sure one tab is in the tab order\n\t\tif ( !this.active.length ) {\n\t\t\tthis.tabs.eq( 0 ).attr( \"tabIndex\", 0 );\n\t\t} else {\n\t\t\tthis.active\n\t\t\t\t.addClass( \"ui-tabs-active ui-state-active\" )\n\t\t\t\t.attr({\n\t\t\t\t\t\"aria-selected\": \"true\",\n\t\t\t\t\t\"aria-expanded\": \"true\",\n\t\t\t\t\ttabIndex: 0\n\t\t\t\t});\n\t\t\tthis._getPanelForTab( this.active )\n\t\t\t\t.show()\n\t\t\t\t.attr({\n\t\t\t\t\t\"aria-hidden\": \"false\"\n\t\t\t\t});\n\t\t}\n\t},\n\n\t_processTabs: function() {\n\t\tvar that = this,\n\t\t\tprevTabs = this.tabs,\n\t\t\tprevAnchors = this.anchors,\n\t\t\tprevPanels = this.panels;\n\n\t\tthis.tablist = this._getList()\n\t\t\t.addClass( \"ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all\" )\n\t\t\t.attr( \"role\", \"tablist\" )\n\n\t\t\t// Prevent users from focusing disabled tabs via click\n\t\t\t.delegate( \"> li\", \"mousedown\" + this.eventNamespace, function( event ) {\n\t\t\t\tif ( $( this ).is( \".ui-state-disabled\" ) ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t})\n\n\t\t\t// support: IE <9\n\t\t\t// Preventing the default action in mousedown doesn't prevent IE\n\t\t\t// from focusing the element, so if the anchor gets focused, blur.\n\t\t\t// We don't have to worry about focusing the previously focused\n\t\t\t// element since clicking on a non-focusable element should focus\n\t\t\t// the body anyway.\n\t\t\t.delegate( \".ui-tabs-anchor\", \"focus\" + this.eventNamespace, function() {\n\t\t\t\tif ( $( this ).closest( \"li\" ).is( \".ui-state-disabled\" ) ) {\n\t\t\t\t\tthis.blur();\n\t\t\t\t}\n\t\t\t});\n\n\t\tthis.tabs = this.tablist.find( \"> li:has(a[href])\" )\n\t\t\t.addClass( \"ui-state-default ui-corner-top\" )\n\t\t\t.attr({\n\t\t\t\trole: \"tab\",\n\t\t\t\ttabIndex: -1\n\t\t\t});\n\n\t\tthis.anchors = this.tabs.map(function() {\n\t\t\t\treturn $( \"a\", this )[ 0 ];\n\t\t\t})\n\t\t\t.addClass( \"ui-tabs-anchor\" )\n\t\t\t.attr({\n\t\t\t\trole: \"presentation\",\n\t\t\t\ttabIndex: -1\n\t\t\t});\n\n\t\tthis.panels = $();\n\n\t\tthis.anchors.each(function( i, anchor ) {\n\t\t\tvar selector, panel, panelId,\n\t\t\t\tanchorId = $( anchor ).uniqueId().attr( \"id\" ),\n\t\t\t\ttab = $( anchor ).closest( \"li\" ),\n\t\t\t\toriginalAriaControls = tab.attr( \"aria-controls\" );\n\n\t\t\t// inline tab\n\t\t\tif ( that._isLocal( anchor ) ) {\n\t\t\t\tselector = anchor.hash;\n\t\t\t\tpanelId = selector.substring( 1 );\n\t\t\t\tpanel = that.element.find( that._sanitizeSelector( selector ) );\n\t\t\t// remote tab\n\t\t\t} else {\n\t\t\t\t// If the tab doesn't already have aria-controls,\n\t\t\t\t// generate an id by using a throw-away element\n\t\t\t\tpanelId = tab.attr( \"aria-controls\" ) || $( {} ).uniqueId()[ 0 ].id;\n\t\t\t\tselector = \"#\" + panelId;\n\t\t\t\tpanel = that.element.find( selector );\n\t\t\t\tif ( !panel.length ) {\n\t\t\t\t\tpanel = that._createPanel( panelId );\n\t\t\t\t\tpanel.insertAfter( that.panels[ i - 1 ] || that.tablist );\n\t\t\t\t}\n\t\t\t\tpanel.attr( \"aria-live\", \"polite\" );\n\t\t\t}\n\n\t\t\tif ( panel.length) {\n\t\t\t\tthat.panels = that.panels.add( panel );\n\t\t\t}\n\t\t\tif ( originalAriaControls ) {\n\t\t\t\ttab.data( \"ui-tabs-aria-controls\", originalAriaControls );\n\t\t\t}\n\t\t\ttab.attr({\n\t\t\t\t\"aria-controls\": panelId,\n\t\t\t\t\"aria-labelledby\": anchorId\n\t\t\t});\n\t\t\tpanel.attr( \"aria-labelledby\", anchorId );\n\t\t});\n\n\t\tthis.panels\n\t\t\t.addClass( \"ui-tabs-panel ui-widget-content ui-corner-bottom\" )\n\t\t\t.attr( \"role\", \"tabpanel\" );\n\n\t\t// Avoid memory leaks (#10056)\n\t\tif ( prevTabs ) {\n\t\t\tthis._off( prevTabs.not( this.tabs ) );\n\t\t\tthis._off( prevAnchors.not( this.anchors ) );\n\t\t\tthis._off( prevPanels.not( this.panels ) );\n\t\t}\n\t},\n\n\t// allow overriding how to find the list for rare usage scenarios (#7715)\n\t_getList: function() {\n\t\treturn this.tablist || this.element.find( \"ol,ul\" ).eq( 0 );\n\t},\n\n\t_createPanel: function( id ) {\n\t\treturn $( \"<div>\" )\n\t\t\t.attr( \"id\", id )\n\t\t\t.addClass( \"ui-tabs-panel ui-widget-content ui-corner-bottom\" )\n\t\t\t.data( \"ui-tabs-destroy\", true );\n\t},\n\n\t_setupDisabled: function( disabled ) {\n\t\tif ( $.isArray( disabled ) ) {\n\t\t\tif ( !disabled.length ) {\n\t\t\t\tdisabled = false;\n\t\t\t} else if ( disabled.length === this.anchors.length ) {\n\t\t\t\tdisabled = true;\n\t\t\t}\n\t\t}\n\n\t\t// disable tabs\n\t\tfor ( var i = 0, li; ( li = this.tabs[ i ] ); i++ ) {\n\t\t\tif ( disabled === true || $.inArray( i, disabled ) !== -1 ) {\n\t\t\t\t$( li )\n\t\t\t\t\t.addClass( \"ui-state-disabled\" )\n\t\t\t\t\t.attr( \"aria-disabled\", \"true\" );\n\t\t\t} else {\n\t\t\t\t$( li )\n\t\t\t\t\t.removeClass( \"ui-state-disabled\" )\n\t\t\t\t\t.removeAttr( \"aria-disabled\" );\n\t\t\t}\n\t\t}\n\n\t\tthis.options.disabled = disabled;\n\t},\n\n\t_setupEvents: function( event ) {\n\t\tvar events = {};\n\t\tif ( event ) {\n\t\t\t$.each( event.split(\" \"), function( index, eventName ) {\n\t\t\t\tevents[ eventName ] = \"_eventHandler\";\n\t\t\t});\n\t\t}\n\n\t\tthis._off( this.anchors.add( this.tabs ).add( this.panels ) );\n\t\t// Always prevent the default action, even when disabled\n\t\tthis._on( true, this.anchors, {\n\t\t\tclick: function( event ) {\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t});\n\t\tthis._on( this.anchors, events );\n\t\tthis._on( this.tabs, { keydown: \"_tabKeydown\" } );\n\t\tthis._on( this.panels, { keydown: \"_panelKeydown\" } );\n\n\t\tthis._focusable( this.tabs );\n\t\tthis._hoverable( this.tabs );\n\t},\n\n\t_setupHeightStyle: function( heightStyle ) {\n\t\tvar maxHeight,\n\t\t\tparent = this.element.parent();\n\n\t\tif ( heightStyle === \"fill\" ) {\n\t\t\tmaxHeight = parent.height();\n\t\t\tmaxHeight -= this.element.outerHeight() - this.element.height();\n\n\t\t\tthis.element.siblings( \":visible\" ).each(function() {\n\t\t\t\tvar elem = $( this ),\n\t\t\t\t\tposition = elem.css( \"position\" );\n\n\t\t\t\tif ( position === \"absolute\" || position === \"fixed\" ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tmaxHeight -= elem.outerHeight( true );\n\t\t\t});\n\n\t\t\tthis.element.children().not( this.panels ).each(function() {\n\t\t\t\tmaxHeight -= $( this ).outerHeight( true );\n\t\t\t});\n\n\t\t\tthis.panels.each(function() {\n\t\t\t\t$( this ).height( Math.max( 0, maxHeight -\n\t\t\t\t\t$( this ).innerHeight() + $( this ).height() ) );\n\t\t\t})\n\t\t\t.css( \"overflow\", \"auto\" );\n\t\t} else if ( heightStyle === \"auto\" ) {\n\t\t\tmaxHeight = 0;\n\t\t\tthis.panels.each(function() {\n\t\t\t\tmaxHeight = Math.max( maxHeight, $( this ).height( \"\" ).height() );\n\t\t\t}).height( maxHeight );\n\t\t}\n\t},\n\n\t_eventHandler: function( event ) {\n\t\tvar options = this.options,\n\t\t\tactive = this.active,\n\t\t\tanchor = $( event.currentTarget ),\n\t\t\ttab = anchor.closest( \"li\" ),\n\t\t\tclickedIsActive = tab[ 0 ] === active[ 0 ],\n\t\t\tcollapsing = clickedIsActive && options.collapsible,\n\t\t\ttoShow = collapsing ? $() : this._getPanelForTab( tab ),\n\t\t\ttoHide = !active.length ? $() : this._getPanelForTab( active ),\n\t\t\teventData = {\n\t\t\t\toldTab: active,\n\t\t\t\toldPanel: toHide,\n\t\t\t\tnewTab: collapsing ? $() : tab,\n\t\t\t\tnewPanel: toShow\n\t\t\t};\n\n\t\tevent.preventDefault();\n\n\t\tif ( tab.hasClass( \"ui-state-disabled\" ) ||\n\t\t\t\t// tab is already loading\n\t\t\t\ttab.hasClass( \"ui-tabs-loading\" ) ||\n\t\t\t\t// can't switch durning an animation\n\t\t\t\tthis.running ||\n\t\t\t\t// click on active header, but not collapsible\n\t\t\t\t( clickedIsActive && !options.collapsible ) ||\n\t\t\t\t// allow canceling activation\n\t\t\t\t( this._trigger( \"beforeActivate\", event, eventData ) === false ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\toptions.active = collapsing ? false : this.tabs.index( tab );\n\n\t\tthis.active = clickedIsActive ? $() : tab;\n\t\tif ( this.xhr ) {\n\t\t\tthis.xhr.abort();\n\t\t}\n\n\t\tif ( !toHide.length && !toShow.length ) {\n\t\t\t$.error( \"jQuery UI Tabs: Mismatching fragment identifier.\" );\n\t\t}\n\n\t\tif ( toShow.length ) {\n\t\t\tthis.load( this.tabs.index( tab ), event );\n\t\t}\n\t\tthis._toggle( event, eventData );\n\t},\n\n\t// handles show/hide for selecting tabs\n\t_toggle: function( event, eventData ) {\n\t\tvar that = this,\n\t\t\ttoShow = eventData.newPanel,\n\t\t\ttoHide = eventData.oldPanel;\n\n\t\tthis.running = true;\n\n\t\tfunction complete() {\n\t\t\tthat.running = false;\n\t\t\tthat._trigger( \"activate\", event, eventData );\n\t\t}\n\n\t\tfunction show() {\n\t\t\teventData.newTab.closest( \"li\" ).addClass( \"ui-tabs-active ui-state-active\" );\n\n\t\t\tif ( toShow.length && that.options.show ) {\n\t\t\t\tthat._show( toShow, that.options.show, complete );\n\t\t\t} else {\n\t\t\t\ttoShow.show();\n\t\t\t\tcomplete();\n\t\t\t}\n\t\t}\n\n\t\t// start out by hiding, then showing, then completing\n\t\tif ( toHide.length && this.options.hide ) {\n\t\t\tthis._hide( toHide, this.options.hide, function() {\n\t\t\t\teventData.oldTab.closest( \"li\" ).removeClass( \"ui-tabs-active ui-state-active\" );\n\t\t\t\tshow();\n\t\t\t});\n\t\t} else {\n\t\t\teventData.oldTab.closest( \"li\" ).removeClass( \"ui-tabs-active ui-state-active\" );\n\t\t\ttoHide.hide();\n\t\t\tshow();\n\t\t}\n\n\t\ttoHide.attr( \"aria-hidden\", \"true\" );\n\t\teventData.oldTab.attr({\n\t\t\t\"aria-selected\": \"false\",\n\t\t\t\"aria-expanded\": \"false\"\n\t\t});\n\t\t// If we're switching tabs, remove the old tab from the tab order.\n\t\t// If we're opening from collapsed state, remove the previous tab from the tab order.\n\t\t// If we're collapsing, then keep the collapsing tab in the tab order.\n\t\tif ( toShow.length && toHide.length ) {\n\t\t\teventData.oldTab.attr( \"tabIndex\", -1 );\n\t\t} else if ( toShow.length ) {\n\t\t\tthis.tabs.filter(function() {\n\t\t\t\treturn $( this ).attr( \"tabIndex\" ) === 0;\n\t\t\t})\n\t\t\t.attr( \"tabIndex\", -1 );\n\t\t}\n\n\t\ttoShow.attr( \"aria-hidden\", \"false\" );\n\t\teventData.newTab.attr({\n\t\t\t\"aria-selected\": \"true\",\n\t\t\t\"aria-expanded\": \"true\",\n\t\t\ttabIndex: 0\n\t\t});\n\t},\n\n\t_activate: function( index ) {\n\t\tvar anchor,\n\t\t\tactive = this._findActive( index );\n\n\t\t// trying to activate the already active panel\n\t\tif ( active[ 0 ] === this.active[ 0 ] ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// trying to collapse, simulate a click on the current active header\n\t\tif ( !active.length ) {\n\t\t\tactive = this.active;\n\t\t}\n\n\t\tanchor = active.find( \".ui-tabs-anchor\" )[ 0 ];\n\t\tthis._eventHandler({\n\t\t\ttarget: anchor,\n\t\t\tcurrentTarget: anchor,\n\t\t\tpreventDefault: $.noop\n\t\t});\n\t},\n\n\t_findActive: function( index ) {\n\t\treturn index === false ? $() : this.tabs.eq( index );\n\t},\n\n\t_getIndex: function( index ) {\n\t\t// meta-function to give users option to provide a href string instead of a numerical index.\n\t\tif ( typeof index === \"string\" ) {\n\t\t\tindex = this.anchors.index( this.anchors.filter( \"[href$='\" + index + \"']\" ) );\n\t\t}\n\n\t\treturn index;\n\t},\n\n\t_destroy: function() {\n\t\tif ( this.xhr ) {\n\t\t\tthis.xhr.abort();\n\t\t}\n\n\t\tthis.element.removeClass( \"ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible\" );\n\n\t\tthis.tablist\n\t\t\t.removeClass( \"ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all\" )\n\t\t\t.removeAttr( \"role\" );\n\n\t\tthis.anchors\n\t\t\t.removeClass( \"ui-tabs-anchor\" )\n\t\t\t.removeAttr( \"role\" )\n\t\t\t.removeAttr( \"tabIndex\" )\n\t\t\t.removeUniqueId();\n\n\t\tthis.tablist.unbind( this.eventNamespace );\n\n\t\tthis.tabs.add( this.panels ).each(function() {\n\t\t\tif ( $.data( this, \"ui-tabs-destroy\" ) ) {\n\t\t\t\t$( this ).remove();\n\t\t\t} else {\n\t\t\t\t$( this )\n\t\t\t\t\t.removeClass( \"ui-state-default ui-state-active ui-state-disabled \" +\n\t\t\t\t\t\t\"ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel\" )\n\t\t\t\t\t.removeAttr( \"tabIndex\" )\n\t\t\t\t\t.removeAttr( \"aria-live\" )\n\t\t\t\t\t.removeAttr( \"aria-busy\" )\n\t\t\t\t\t.removeAttr( \"aria-selected\" )\n\t\t\t\t\t.removeAttr( \"aria-labelledby\" )\n\t\t\t\t\t.removeAttr( \"aria-hidden\" )\n\t\t\t\t\t.removeAttr( \"aria-expanded\" )\n\t\t\t\t\t.removeAttr( \"role\" );\n\t\t\t}\n\t\t});\n\n\t\tthis.tabs.each(function() {\n\t\t\tvar li = $( this ),\n\t\t\t\tprev = li.data( \"ui-tabs-aria-controls\" );\n\t\t\tif ( prev ) {\n\t\t\t\tli\n\t\t\t\t\t.attr( \"aria-controls\", prev )\n\t\t\t\t\t.removeData( \"ui-tabs-aria-controls\" );\n\t\t\t} else {\n\t\t\t\tli.removeAttr( \"aria-controls\" );\n\t\t\t}\n\t\t});\n\n\t\tthis.panels.show();\n\n\t\tif ( this.options.heightStyle !== \"content\" ) {\n\t\t\tthis.panels.css( \"height\", \"\" );\n\t\t}\n\t},\n\n\tenable: function( index ) {\n\t\tvar disabled = this.options.disabled;\n\t\tif ( disabled === false ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( index === undefined ) {\n\t\t\tdisabled = false;\n\t\t} else {\n\t\t\tindex = this._getIndex( index );\n\t\t\tif ( $.isArray( disabled ) ) {\n\t\t\t\tdisabled = $.map( disabled, function( num ) {\n\t\t\t\t\treturn num !== index ? num : null;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tdisabled = $.map( this.tabs, function( li, num ) {\n\t\t\t\t\treturn num !== index ? num : null;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tthis._setupDisabled( disabled );\n\t},\n\n\tdisable: function( index ) {\n\t\tvar disabled = this.options.disabled;\n\t\tif ( disabled === true ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( index === undefined ) {\n\t\t\tdisabled = true;\n\t\t} else {\n\t\t\tindex = this._getIndex( index );\n\t\t\tif ( $.inArray( index, disabled ) !== -1 ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif ( $.isArray( disabled ) ) {\n\t\t\t\tdisabled = $.merge( [ index ], disabled ).sort();\n\t\t\t} else {\n\t\t\t\tdisabled = [ index ];\n\t\t\t}\n\t\t}\n\t\tthis._setupDisabled( disabled );\n\t},\n\n\tload: function( index, event ) {\n\t\tindex = this._getIndex( index );\n\t\tvar that = this,\n\t\t\ttab = this.tabs.eq( index ),\n\t\t\tanchor = tab.find( \".ui-tabs-anchor\" ),\n\t\t\tpanel = this._getPanelForTab( tab ),\n\t\t\teventData = {\n\t\t\t\ttab: tab,\n\t\t\t\tpanel: panel\n\t\t\t},\n\t\t\tcomplete = function( jqXHR, status ) {\n\t\t\t\tif ( status === \"abort\" ) {\n\t\t\t\t\tthat.panels.stop( false, true );\n\t\t\t\t}\n\n\t\t\t\ttab.removeClass( \"ui-tabs-loading\" );\n\t\t\t\tpanel.removeAttr( \"aria-busy\" );\n\n\t\t\t\tif ( jqXHR === that.xhr ) {\n\t\t\t\t\tdelete that.xhr;\n\t\t\t\t}\n\t\t\t};\n\n\t\t// not remote\n\t\tif ( this._isLocal( anchor[ 0 ] ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.xhr = $.ajax( this._ajaxSettings( anchor, event, eventData ) );\n\n\t\t// support: jQuery <1.8\n\t\t// jQuery <1.8 returns false if the request is canceled in beforeSend,\n\t\t// but as of 1.8, $.ajax() always returns a jqXHR object.\n\t\tif ( this.xhr && this.xhr.statusText !== \"canceled\" ) {\n\t\t\ttab.addClass( \"ui-tabs-loading\" );\n\t\t\tpanel.attr( \"aria-busy\", \"true\" );\n\n\t\t\tthis.xhr\n\t\t\t\t.done(function( response, status, jqXHR ) {\n\t\t\t\t\t// support: jQuery <1.8\n\t\t\t\t\t// http://bugs.jquery.com/ticket/11778\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tpanel.html( response );\n\t\t\t\t\t\tthat._trigger( \"load\", event, eventData );\n\n\t\t\t\t\t\tcomplete( jqXHR, status );\n\t\t\t\t\t}, 1 );\n\t\t\t\t})\n\t\t\t\t.fail(function( jqXHR, status ) {\n\t\t\t\t\t// support: jQuery <1.8\n\t\t\t\t\t// http://bugs.jquery.com/ticket/11778\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tcomplete( jqXHR, status );\n\t\t\t\t\t}, 1 );\n\t\t\t\t});\n\t\t}\n\t},\n\n\t_ajaxSettings: function( anchor, event, eventData ) {\n\t\tvar that = this;\n\t\treturn {\n\t\t\turl: anchor.attr( \"href\" ),\n\t\t\tbeforeSend: function( jqXHR, settings ) {\n\t\t\t\treturn that._trigger( \"beforeLoad\", event,\n\t\t\t\t\t$.extend( { jqXHR: jqXHR, ajaxSettings: settings }, eventData ) );\n\t\t\t}\n\t\t};\n\t},\n\n\t_getPanelForTab: function( tab ) {\n\t\tvar id = $( tab ).attr( \"aria-controls\" );\n\t\treturn this.element.find( this._sanitizeSelector( \"#\" + id ) );\n\t}\n});\n\n\n/*!\n * jQuery UI Tooltip 1.11.4\n * http://jqueryui.com\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/tooltip/\n */\n\n\nvar tooltip = $.widget( \"ui.tooltip\", {\n\tversion: \"1.11.4\",\n\toptions: {\n\t\tcontent: function() {\n\t\t\t// support: IE<9, Opera in jQuery <1.7\n\t\t\t// .text() can't accept undefined, so coerce to a string\n\t\t\tvar title = $( this ).attr( \"title\" ) || \"\";\n\t\t\t// Escape title, since we're going from an attribute to raw HTML\n\t\t\treturn $( \"<a>\" ).text( title ).html();\n\t\t},\n\t\thide: true,\n\t\t// Disabled elements have inconsistent behavior across browsers (#8661)\n\t\titems: \"[title]:not([disabled])\",\n\t\tposition: {\n\t\t\tmy: \"left top+15\",\n\t\t\tat: \"left bottom\",\n\t\t\tcollision: \"flipfit flip\"\n\t\t},\n\t\tshow: true,\n\t\ttooltipClass: null,\n\t\ttrack: false,\n\n\t\t// callbacks\n\t\tclose: null,\n\t\topen: null\n\t},\n\n\t_addDescribedBy: function( elem, id ) {\n\t\tvar describedby = (elem.attr( \"aria-describedby\" ) || \"\").split( /\\s+/ );\n\t\tdescribedby.push( id );\n\t\telem\n\t\t\t.data( \"ui-tooltip-id\", id )\n\t\t\t.attr( \"aria-describedby\", $.trim( describedby.join( \" \" ) ) );\n\t},\n\n\t_removeDescribedBy: function( elem ) {\n\t\tvar id = elem.data( \"ui-tooltip-id\" ),\n\t\t\tdescribedby = (elem.attr( \"aria-describedby\" ) || \"\").split( /\\s+/ ),\n\t\t\tindex = $.inArray( id, describedby );\n\n\t\tif ( index !== -1 ) {\n\t\t\tdescribedby.splice( index, 1 );\n\t\t}\n\n\t\telem.removeData( \"ui-tooltip-id\" );\n\t\tdescribedby = $.trim( describedby.join( \" \" ) );\n\t\tif ( describedby ) {\n\t\t\telem.attr( \"aria-describedby\", describedby );\n\t\t} else {\n\t\t\telem.removeAttr( \"aria-describedby\" );\n\t\t}\n\t},\n\n\t_create: function() {\n\t\tthis._on({\n\t\t\tmouseover: \"open\",\n\t\t\tfocusin: \"open\"\n\t\t});\n\n\t\t// IDs of generated tooltips, needed for destroy\n\t\tthis.tooltips = {};\n\n\t\t// IDs of parent tooltips where we removed the title attribute\n\t\tthis.parents = {};\n\n\t\tif ( this.options.disabled ) {\n\t\t\tthis._disable();\n\t\t}\n\n\t\t// Append the aria-live region so tooltips announce correctly\n\t\tthis.liveRegion = $( \"<div>\" )\n\t\t\t.attr({\n\t\t\t\trole: \"log\",\n\t\t\t\t\"aria-live\": \"assertive\",\n\t\t\t\t\"aria-relevant\": \"additions\"\n\t\t\t})\n\t\t\t.addClass( \"ui-helper-hidden-accessible\" )\n\t\t\t.appendTo( this.document[ 0 ].body );\n\t},\n\n\t_setOption: function( key, value ) {\n\t\tvar that = this;\n\n\t\tif ( key === \"disabled\" ) {\n\t\t\tthis[ value ? \"_disable\" : \"_enable\" ]();\n\t\t\tthis.options[ key ] = value;\n\t\t\t// disable element style changes\n\t\t\treturn;\n\t\t}\n\n\t\tthis._super( key, value );\n\n\t\tif ( key === \"content\" ) {\n\t\t\t$.each( this.tooltips, function( id, tooltipData ) {\n\t\t\t\tthat._updateContent( tooltipData.element );\n\t\t\t});\n\t\t}\n\t},\n\n\t_disable: function() {\n\t\tvar that = this;\n\n\t\t// close open tooltips\n\t\t$.each( this.tooltips, function( id, tooltipData ) {\n\t\t\tvar event = $.Event( \"blur\" );\n\t\t\tevent.target = event.currentTarget = tooltipData.element[ 0 ];\n\t\t\tthat.close( event, true );\n\t\t});\n\n\t\t// remove title attributes to prevent native tooltips\n\t\tthis.element.find( this.options.items ).addBack().each(function() {\n\t\t\tvar element = $( this );\n\t\t\tif ( element.is( \"[title]\" ) ) {\n\t\t\t\telement\n\t\t\t\t\t.data( \"ui-tooltip-title\", element.attr( \"title\" ) )\n\t\t\t\t\t.removeAttr( \"title\" );\n\t\t\t}\n\t\t});\n\t},\n\n\t_enable: function() {\n\t\t// restore title attributes\n\t\tthis.element.find( this.options.items ).addBack().each(function() {\n\t\t\tvar element = $( this );\n\t\t\tif ( element.data( \"ui-tooltip-title\" ) ) {\n\t\t\t\telement.attr( \"title\", element.data( \"ui-tooltip-title\" ) );\n\t\t\t}\n\t\t});\n\t},\n\n\topen: function( event ) {\n\t\tvar that = this,\n\t\t\ttarget = $( event ? event.target : this.element )\n\t\t\t\t// we need closest here due to mouseover bubbling,\n\t\t\t\t// but always pointing at the same event target\n\t\t\t\t.closest( this.options.items );\n\n\t\t// No element to show a tooltip for or the tooltip is already open\n\t\tif ( !target.length || target.data( \"ui-tooltip-id\" ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( target.attr( \"title\" ) ) {\n\t\t\ttarget.data( \"ui-tooltip-title\", target.attr( \"title\" ) );\n\t\t}\n\n\t\ttarget.data( \"ui-tooltip-open\", true );\n\n\t\t// kill parent tooltips, custom or native, for hover\n\t\tif ( event && event.type === \"mouseover\" ) {\n\t\t\ttarget.parents().each(function() {\n\t\t\t\tvar parent = $( this ),\n\t\t\t\t\tblurEvent;\n\t\t\t\tif ( parent.data( \"ui-tooltip-open\" ) ) {\n\t\t\t\t\tblurEvent = $.Event( \"blur\" );\n\t\t\t\t\tblurEvent.target = blurEvent.currentTarget = this;\n\t\t\t\t\tthat.close( blurEvent, true );\n\t\t\t\t}\n\t\t\t\tif ( parent.attr( \"title\" ) ) {\n\t\t\t\t\tparent.uniqueId();\n\t\t\t\t\tthat.parents[ this.id ] = {\n\t\t\t\t\t\telement: this,\n\t\t\t\t\t\ttitle: parent.attr( \"title\" )\n\t\t\t\t\t};\n\t\t\t\t\tparent.attr( \"title\", \"\" );\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis._registerCloseHandlers( event, target );\n\t\tthis._updateContent( target, event );\n\t},\n\n\t_updateContent: function( target, event ) {\n\t\tvar content,\n\t\t\tcontentOption = this.options.content,\n\t\t\tthat = this,\n\t\t\teventType = event ? event.type : null;\n\n\t\tif ( typeof contentOption === \"string\" ) {\n\t\t\treturn this._open( event, target, contentOption );\n\t\t}\n\n\t\tcontent = contentOption.call( target[0], function( response ) {\n\n\t\t\t// IE may instantly serve a cached response for ajax requests\n\t\t\t// delay this call to _open so the other call to _open runs first\n\t\t\tthat._delay(function() {\n\n\t\t\t\t// Ignore async response if tooltip was closed already\n\t\t\t\tif ( !target.data( \"ui-tooltip-open\" ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// jQuery creates a special event for focusin when it doesn't\n\t\t\t\t// exist natively. To improve performance, the native event\n\t\t\t\t// object is reused and the type is changed. Therefore, we can't\n\t\t\t\t// rely on the type being correct after the event finished\n\t\t\t\t// bubbling, so we set it back to the previous value. (#8740)\n\t\t\t\tif ( event ) {\n\t\t\t\t\tevent.type = eventType;\n\t\t\t\t}\n\t\t\t\tthis._open( event, target, response );\n\t\t\t});\n\t\t});\n\t\tif ( content ) {\n\t\t\tthis._open( event, target, content );\n\t\t}\n\t},\n\n\t_open: function( event, target, content ) {\n\t\tvar tooltipData, tooltip, delayedShow, a11yContent,\n\t\t\tpositionOption = $.extend( {}, this.options.position );\n\n\t\tif ( !content ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Content can be updated multiple times. If the tooltip already\n\t\t// exists, then just update the content and bail.\n\t\ttooltipData = this._find( target );\n\t\tif ( tooltipData ) {\n\t\t\ttooltipData.tooltip.find( \".ui-tooltip-content\" ).html( content );\n\t\t\treturn;\n\t\t}\n\n\t\t// if we have a title, clear it to prevent the native tooltip\n\t\t// we have to check first to avoid defining a title if none exists\n\t\t// (we don't want to cause an element to start matching [title])\n\t\t//\n\t\t// We use removeAttr only for key events, to allow IE to export the correct\n\t\t// accessible attributes. For mouse events, set to empty string to avoid\n\t\t// native tooltip showing up (happens only when removing inside mouseover).\n\t\tif ( target.is( \"[title]\" ) ) {\n\t\t\tif ( event && event.type === \"mouseover\" ) {\n\t\t\t\ttarget.attr( \"title\", \"\" );\n\t\t\t} else {\n\t\t\t\ttarget.removeAttr( \"title\" );\n\t\t\t}\n\t\t}\n\n\t\ttooltipData = this._tooltip( target );\n\t\ttooltip = tooltipData.tooltip;\n\t\tthis._addDescribedBy( target, tooltip.attr( \"id\" ) );\n\t\ttooltip.find( \".ui-tooltip-content\" ).html( content );\n\n\t\t// Support: Voiceover on OS X, JAWS on IE <= 9\n\t\t// JAWS announces deletions even when aria-relevant=\"additions\"\n\t\t// Voiceover will sometimes re-read the entire log region's contents from the beginning\n\t\tthis.liveRegion.children().hide();\n\t\tif ( content.clone ) {\n\t\t\ta11yContent = content.clone();\n\t\t\ta11yContent.removeAttr( \"id\" ).find( \"[id]\" ).removeAttr( \"id\" );\n\t\t} else {\n\t\t\ta11yContent = content;\n\t\t}\n\t\t$( \"<div>\" ).html( a11yContent ).appendTo( this.liveRegion );\n\n\t\tfunction position( event ) {\n\t\t\tpositionOption.of = event;\n\t\t\tif ( tooltip.is( \":hidden\" ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\ttooltip.position( positionOption );\n\t\t}\n\t\tif ( this.options.track && event && /^mouse/.test( event.type ) ) {\n\t\t\tthis._on( this.document, {\n\t\t\t\tmousemove: position\n\t\t\t});\n\t\t\t// trigger once to override element-relative positioning\n\t\t\tposition( event );\n\t\t} else {\n\t\t\ttooltip.position( $.extend({\n\t\t\t\tof: target\n\t\t\t}, this.options.position ) );\n\t\t}\n\n\t\ttooltip.hide();\n\n\t\tthis._show( tooltip, this.options.show );\n\t\t// Handle tracking tooltips that are shown with a delay (#8644). As soon\n\t\t// as the tooltip is visible, position the tooltip using the most recent\n\t\t// event.\n\t\tif ( this.options.show && this.options.show.delay ) {\n\t\t\tdelayedShow = this.delayedShow = setInterval(function() {\n\t\t\t\tif ( tooltip.is( \":visible\" ) ) {\n\t\t\t\t\tposition( positionOption.of );\n\t\t\t\t\tclearInterval( delayedShow );\n\t\t\t\t}\n\t\t\t}, $.fx.interval );\n\t\t}\n\n\t\tthis._trigger( \"open\", event, { tooltip: tooltip } );\n\t},\n\n\t_registerCloseHandlers: function( event, target ) {\n\t\tvar events = {\n\t\t\tkeyup: function( event ) {\n\t\t\t\tif ( event.keyCode === $.ui.keyCode.ESCAPE ) {\n\t\t\t\t\tvar fakeEvent = $.Event(event);\n\t\t\t\t\tfakeEvent.currentTarget = target[0];\n\t\t\t\t\tthis.close( fakeEvent, true );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t// Only bind remove handler for delegated targets. Non-delegated\n\t\t// tooltips will handle this in destroy.\n\t\tif ( target[ 0 ] !== this.element[ 0 ] ) {\n\t\t\tevents.remove = function() {\n\t\t\t\tthis._removeTooltip( this._find( target ).tooltip );\n\t\t\t};\n\t\t}\n\n\t\tif ( !event || event.type === \"mouseover\" ) {\n\t\t\tevents.mouseleave = \"close\";\n\t\t}\n\t\tif ( !event || event.type === \"focusin\" ) {\n\t\t\tevents.focusout = \"close\";\n\t\t}\n\t\tthis._on( true, target, events );\n\t},\n\n\tclose: function( event ) {\n\t\tvar tooltip,\n\t\t\tthat = this,\n\t\t\ttarget = $( event ? event.currentTarget : this.element ),\n\t\t\ttooltipData = this._find( target );\n\n\t\t// The tooltip may already be closed\n\t\tif ( !tooltipData ) {\n\n\t\t\t// We set ui-tooltip-open immediately upon open (in open()), but only set the\n\t\t\t// additional data once there's actually content to show (in _open()). So even if the\n\t\t\t// tooltip doesn't have full data, we always remove ui-tooltip-open in case we're in\n\t\t\t// the period between open() and _open().\n\t\t\ttarget.removeData( \"ui-tooltip-open\" );\n\t\t\treturn;\n\t\t}\n\n\t\ttooltip = tooltipData.tooltip;\n\n\t\t// disabling closes the tooltip, so we need to track when we're closing\n\t\t// to avoid an infinite loop in case the tooltip becomes disabled on close\n\t\tif ( tooltipData.closing ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Clear the interval for delayed tracking tooltips\n\t\tclearInterval( this.delayedShow );\n\n\t\t// only set title if we had one before (see comment in _open())\n\t\t// If the title attribute has changed since open(), don't restore\n\t\tif ( target.data( \"ui-tooltip-title\" ) && !target.attr( \"title\" ) ) {\n\t\t\ttarget.attr( \"title\", target.data( \"ui-tooltip-title\" ) );\n\t\t}\n\n\t\tthis._removeDescribedBy( target );\n\n\t\ttooltipData.hiding = true;\n\t\ttooltip.stop( true );\n\t\tthis._hide( tooltip, this.options.hide, function() {\n\t\t\tthat._removeTooltip( $( this ) );\n\t\t});\n\n\t\ttarget.removeData( \"ui-tooltip-open\" );\n\t\tthis._off( target, \"mouseleave focusout keyup\" );\n\n\t\t// Remove 'remove' binding only on delegated targets\n\t\tif ( target[ 0 ] !== this.element[ 0 ] ) {\n\t\t\tthis._off( target, \"remove\" );\n\t\t}\n\t\tthis._off( this.document, \"mousemove\" );\n\n\t\tif ( event && event.type === \"mouseleave\" ) {\n\t\t\t$.each( this.parents, function( id, parent ) {\n\t\t\t\t$( parent.element ).attr( \"title\", parent.title );\n\t\t\t\tdelete that.parents[ id ];\n\t\t\t});\n\t\t}\n\n\t\ttooltipData.closing = true;\n\t\tthis._trigger( \"close\", event, { tooltip: tooltip } );\n\t\tif ( !tooltipData.hiding ) {\n\t\t\ttooltipData.closing = false;\n\t\t}\n\t},\n\n\t_tooltip: function( element ) {\n\t\tvar tooltip = $( \"<div>\" )\n\t\t\t\t.attr( \"role\", \"tooltip\" )\n\t\t\t\t.addClass( \"ui-tooltip ui-widget ui-corner-all ui-widget-content \" +\n\t\t\t\t\t( this.options.tooltipClass || \"\" ) ),\n\t\t\tid = tooltip.uniqueId().attr( \"id\" );\n\n\t\t$( \"<div>\" )\n\t\t\t.addClass( \"ui-tooltip-content\" )\n\t\t\t.appendTo( tooltip );\n\n\t\ttooltip.appendTo( this.document[0].body );\n\n\t\treturn this.tooltips[ id ] = {\n\t\t\telement: element,\n\t\t\ttooltip: tooltip\n\t\t};\n\t},\n\n\t_find: function( target ) {\n\t\tvar id = target.data( \"ui-tooltip-id\" );\n\t\treturn id ? this.tooltips[ id ] : null;\n\t},\n\n\t_removeTooltip: function( tooltip ) {\n\t\ttooltip.remove();\n\t\tdelete this.tooltips[ tooltip.attr( \"id\" ) ];\n\t},\n\n\t_destroy: function() {\n\t\tvar that = this;\n\n\t\t// close open tooltips\n\t\t$.each( this.tooltips, function( id, tooltipData ) {\n\t\t\t// Delegate to close method to handle common cleanup\n\t\t\tvar event = $.Event( \"blur\" ),\n\t\t\t\telement = tooltipData.element;\n\t\t\tevent.target = event.currentTarget = element[ 0 ];\n\t\t\tthat.close( event, true );\n\n\t\t\t// Remove immediately; destroying an open tooltip doesn't use the\n\t\t\t// hide animation\n\t\t\t$( \"#\" + id ).remove();\n\n\t\t\t// Restore the title\n\t\t\tif ( element.data( \"ui-tooltip-title\" ) ) {\n\t\t\t\t// If the title attribute has changed since open(), don't restore\n\t\t\t\tif ( !element.attr( \"title\" ) ) {\n\t\t\t\t\telement.attr( \"title\", element.data( \"ui-tooltip-title\" ) );\n\t\t\t\t}\n\t\t\t\telement.removeData( \"ui-tooltip-title\" );\n\t\t\t}\n\t\t});\n\t\tthis.liveRegion.remove();\n\t}\n});\n\n\n\n}));",
    "// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n",
    "if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n",
    "module.exports = function isBuffer(arg) {\n  return arg && typeof arg === 'object'\n    && typeof arg.copy === 'function'\n    && typeof arg.fill === 'function'\n    && typeof arg.readUInt8 === 'function';\n}",
    "// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar formatRegExp = /%[sdj%]/g;\nexports.format = function(f) {\n  if (!isString(f)) {\n    var objects = [];\n    for (var i = 0; i < arguments.length; i++) {\n      objects.push(inspect(arguments[i]));\n    }\n    return objects.join(' ');\n  }\n\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  var str = String(f).replace(formatRegExp, function(x) {\n    if (x === '%%') return '%';\n    if (i >= len) return x;\n    switch (x) {\n      case '%s': return String(args[i++]);\n      case '%d': return Number(args[i++]);\n      case '%j':\n        try {\n          return JSON.stringify(args[i++]);\n        } catch (_) {\n          return '[Circular]';\n        }\n      default:\n        return x;\n    }\n  });\n  for (var x = args[i]; i < len; x = args[++i]) {\n    if (isNull(x) || !isObject(x)) {\n      str += ' ' + x;\n    } else {\n      str += ' ' + inspect(x);\n    }\n  }\n  return str;\n};\n\n\n// Mark that a method should not be used.\n// Returns a modified function which warns once by default.\n// If --no-deprecation is set, then it is a no-op.\nexports.deprecate = function(fn, msg) {\n  // Allow for deprecating things in the process of starting up.\n  if (isUndefined(global.process)) {\n    return function() {\n      return exports.deprecate(fn, msg).apply(this, arguments);\n    };\n  }\n\n  if (process.noDeprecation === true) {\n    return fn;\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (process.throwDeprecation) {\n        throw new Error(msg);\n      } else if (process.traceDeprecation) {\n        console.trace(msg);\n      } else {\n        console.error(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n};\n\n\nvar debugs = {};\nvar debugEnviron;\nexports.debuglog = function(set) {\n  if (isUndefined(debugEnviron))\n    debugEnviron = process.env.NODE_DEBUG || '';\n  set = set.toUpperCase();\n  if (!debugs[set]) {\n    if (new RegExp('\\\\b' + set + '\\\\b', 'i').test(debugEnviron)) {\n      var pid = process.pid;\n      debugs[set] = function() {\n        var msg = exports.format.apply(exports, arguments);\n        console.error('%s %d: %s', set, pid, msg);\n      };\n    } else {\n      debugs[set] = function() {};\n    }\n  }\n  return debugs[set];\n};\n\n\n/**\n * Echos the value of a value. Trys to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Object} opts Optional options object that alters the output.\n */\n/* legacy: obj, showHidden, depth, colors*/\nfunction inspect(obj, opts) {\n  // default options\n  var ctx = {\n    seen: [],\n    stylize: stylizeNoColor\n  };\n  // legacy...\n  if (arguments.length >= 3) ctx.depth = arguments[2];\n  if (arguments.length >= 4) ctx.colors = arguments[3];\n  if (isBoolean(opts)) {\n    // legacy...\n    ctx.showHidden = opts;\n  } else if (opts) {\n    // got an \"options\" object\n    exports._extend(ctx, opts);\n  }\n  // set default options\n  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n  if (isUndefined(ctx.depth)) ctx.depth = 2;\n  if (isUndefined(ctx.colors)) ctx.colors = false;\n  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n  if (ctx.colors) ctx.stylize = stylizeWithColor;\n  return formatValue(ctx, obj, ctx.depth);\n}\nexports.inspect = inspect;\n\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\ninspect.colors = {\n  'bold' : [1, 22],\n  'italic' : [3, 23],\n  'underline' : [4, 24],\n  'inverse' : [7, 27],\n  'white' : [37, 39],\n  'grey' : [90, 39],\n  'black' : [30, 39],\n  'blue' : [34, 39],\n  'cyan' : [36, 39],\n  'green' : [32, 39],\n  'magenta' : [35, 39],\n  'red' : [31, 39],\n  'yellow' : [33, 39]\n};\n\n// Don't use 'blue' not visible on cmd.exe\ninspect.styles = {\n  'special': 'cyan',\n  'number': 'yellow',\n  'boolean': 'yellow',\n  'undefined': 'grey',\n  'null': 'bold',\n  'string': 'green',\n  'date': 'magenta',\n  // \"name\": intentionally not styling\n  'regexp': 'red'\n};\n\n\nfunction stylizeWithColor(str, styleType) {\n  var style = inspect.styles[styleType];\n\n  if (style) {\n    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n           '\\u001b[' + inspect.colors[style][1] + 'm';\n  } else {\n    return str;\n  }\n}\n\n\nfunction stylizeNoColor(str, styleType) {\n  return str;\n}\n\n\nfunction arrayToHash(array) {\n  var hash = {};\n\n  array.forEach(function(val, idx) {\n    hash[val] = true;\n  });\n\n  return hash;\n}\n\n\nfunction formatValue(ctx, value, recurseTimes) {\n  // Provide a hook for user-specified inspect functions.\n  // Check that value is an object with an inspect function on it\n  if (ctx.customInspect &&\n      value &&\n      isFunction(value.inspect) &&\n      // Filter out the util module, it's inspect function is special\n      value.inspect !== exports.inspect &&\n      // Also filter out any prototype objects using the circular check.\n      !(value.constructor && value.constructor.prototype === value)) {\n    var ret = value.inspect(recurseTimes, ctx);\n    if (!isString(ret)) {\n      ret = formatValue(ctx, ret, recurseTimes);\n    }\n    return ret;\n  }\n\n  // Primitive types cannot have properties\n  var primitive = formatPrimitive(ctx, value);\n  if (primitive) {\n    return primitive;\n  }\n\n  // Look up the keys of the object.\n  var keys = Object.keys(value);\n  var visibleKeys = arrayToHash(keys);\n\n  if (ctx.showHidden) {\n    keys = Object.getOwnPropertyNames(value);\n  }\n\n  // IE doesn't make error fields non-enumerable\n  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n  if (isError(value)\n      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n    return formatError(value);\n  }\n\n  // Some type of object without properties can be shortcutted.\n  if (keys.length === 0) {\n    if (isFunction(value)) {\n      var name = value.name ? ': ' + value.name : '';\n      return ctx.stylize('[Function' + name + ']', 'special');\n    }\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    }\n    if (isDate(value)) {\n      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n    }\n    if (isError(value)) {\n      return formatError(value);\n    }\n  }\n\n  var base = '', array = false, braces = ['{', '}'];\n\n  // Make Array say that they are Array\n  if (isArray(value)) {\n    array = true;\n    braces = ['[', ']'];\n  }\n\n  // Make functions say that they are functions\n  if (isFunction(value)) {\n    var n = value.name ? ': ' + value.name : '';\n    base = ' [Function' + n + ']';\n  }\n\n  // Make RegExps say that they are RegExps\n  if (isRegExp(value)) {\n    base = ' ' + RegExp.prototype.toString.call(value);\n  }\n\n  // Make dates with properties first say the date\n  if (isDate(value)) {\n    base = ' ' + Date.prototype.toUTCString.call(value);\n  }\n\n  // Make error with message first say the error\n  if (isError(value)) {\n    base = ' ' + formatError(value);\n  }\n\n  if (keys.length === 0 && (!array || value.length == 0)) {\n    return braces[0] + base + braces[1];\n  }\n\n  if (recurseTimes < 0) {\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    } else {\n      return ctx.stylize('[Object]', 'special');\n    }\n  }\n\n  ctx.seen.push(value);\n\n  var output;\n  if (array) {\n    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n  } else {\n    output = keys.map(function(key) {\n      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n    });\n  }\n\n  ctx.seen.pop();\n\n  return reduceToSingleString(output, base, braces);\n}\n\n\nfunction formatPrimitive(ctx, value) {\n  if (isUndefined(value))\n    return ctx.stylize('undefined', 'undefined');\n  if (isString(value)) {\n    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n                                             .replace(/'/g, \"\\\\'\")\n                                             .replace(/\\\\\"/g, '\"') + '\\'';\n    return ctx.stylize(simple, 'string');\n  }\n  if (isNumber(value))\n    return ctx.stylize('' + value, 'number');\n  if (isBoolean(value))\n    return ctx.stylize('' + value, 'boolean');\n  // For some reason typeof null is \"object\", so special case here.\n  if (isNull(value))\n    return ctx.stylize('null', 'null');\n}\n\n\nfunction formatError(value) {\n  return '[' + Error.prototype.toString.call(value) + ']';\n}\n\n\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n  var output = [];\n  for (var i = 0, l = value.length; i < l; ++i) {\n    if (hasOwnProperty(value, String(i))) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          String(i), true));\n    } else {\n      output.push('');\n    }\n  }\n  keys.forEach(function(key) {\n    if (!key.match(/^\\d+$/)) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          key, true));\n    }\n  });\n  return output;\n}\n\n\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n  var name, str, desc;\n  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n  if (desc.get) {\n    if (desc.set) {\n      str = ctx.stylize('[Getter/Setter]', 'special');\n    } else {\n      str = ctx.stylize('[Getter]', 'special');\n    }\n  } else {\n    if (desc.set) {\n      str = ctx.stylize('[Setter]', 'special');\n    }\n  }\n  if (!hasOwnProperty(visibleKeys, key)) {\n    name = '[' + key + ']';\n  }\n  if (!str) {\n    if (ctx.seen.indexOf(desc.value) < 0) {\n      if (isNull(recurseTimes)) {\n        str = formatValue(ctx, desc.value, null);\n      } else {\n        str = formatValue(ctx, desc.value, recurseTimes - 1);\n      }\n      if (str.indexOf('\\n') > -1) {\n        if (array) {\n          str = str.split('\\n').map(function(line) {\n            return '  ' + line;\n          }).join('\\n').substr(2);\n        } else {\n          str = '\\n' + str.split('\\n').map(function(line) {\n            return '   ' + line;\n          }).join('\\n');\n        }\n      }\n    } else {\n      str = ctx.stylize('[Circular]', 'special');\n    }\n  }\n  if (isUndefined(name)) {\n    if (array && key.match(/^\\d+$/)) {\n      return str;\n    }\n    name = JSON.stringify('' + key);\n    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n      name = name.substr(1, name.length - 2);\n      name = ctx.stylize(name, 'name');\n    } else {\n      name = name.replace(/'/g, \"\\\\'\")\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/(^\"|\"$)/g, \"'\");\n      name = ctx.stylize(name, 'string');\n    }\n  }\n\n  return name + ': ' + str;\n}\n\n\nfunction reduceToSingleString(output, base, braces) {\n  var numLinesEst = 0;\n  var length = output.reduce(function(prev, cur) {\n    numLinesEst++;\n    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n  }, 0);\n\n  if (length > 60) {\n    return braces[0] +\n           (base === '' ? '' : base + '\\n ') +\n           ' ' +\n           output.join(',\\n  ') +\n           ' ' +\n           braces[1];\n  }\n\n  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n}\n\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = require('./support/isBuffer');\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n\n\nfunction pad(n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n}\n\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n              'Oct', 'Nov', 'Dec'];\n\n// 26 Feb 16:19:34\nfunction timestamp() {\n  var d = new Date();\n  var time = [pad(d.getHours()),\n              pad(d.getMinutes()),\n              pad(d.getSeconds())].join(':');\n  return [d.getDate(), months[d.getMonth()], time].join(' ');\n}\n\n\n// log is just a thin wrapper to console.log that prepends a timestamp\nexports.log = function() {\n  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * The Function.prototype.inherits from lang.js rewritten as a standalone\n * function (not on Function.prototype). NOTE: If this file is to be loaded\n * during bootstrapping this function needs to be rewritten using some native\n * functions as prototype setup using normal JavaScript does not work as\n * expected during bootstrapping (see mirror.js in r114903).\n *\n * @param {function} ctor Constructor function which needs to inherit the\n *     prototype.\n * @param {function} superCtor Constructor function to inherit prototype from.\n */\nexports.inherits = require('inherits');\n\nexports._extend = function(origin, add) {\n  // Don't do anything if add isn't an object\n  if (!add || !isObject(add)) return origin;\n\n  var keys = Object.keys(add);\n  var i = keys.length;\n  while (i--) {\n    origin[keys[i]] = add[keys[i]];\n  }\n  return origin;\n};\n\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n",
    "/**\r\n *\r\n * Date picker\r\n * Author: Stefan Petre www.eyecon.ro\r\n * \r\n * Dual licensed under the MIT and GPL licenses\r\n * \r\n */\r\n(function ($) {\r\n\tvar DatePicker = function () {\r\n\t\tvar\tids = {},\r\n\t\t\tviews = {\r\n\t\t\t\tyears: 'datepickerViewYears',\r\n\t\t\t\tmoths: 'datepickerViewMonths',\r\n\t\t\t\tdays: 'datepickerViewDays'\r\n\t\t\t},\r\n\t\t\ttpl = {\r\n\t\t\t\twrapper: '<div class=\"datepicker\"><div class=\"datepickerBorderT\" /><div class=\"datepickerBorderB\" /><div class=\"datepickerBorderL\" /><div class=\"datepickerBorderR\" /><div class=\"datepickerBorderTL\" /><div class=\"datepickerBorderTR\" /><div class=\"datepickerBorderBL\" /><div class=\"datepickerBorderBR\" /><div class=\"datepickerContainer\"><table cellspacing=\"0\" cellpadding=\"0\"><tbody><tr></tr></tbody></table></div></div>',\r\n\t\t\t\thead: [\r\n\t\t\t\t\t'<td>',\r\n\t\t\t\t\t'<table cellspacing=\"0\" cellpadding=\"0\">',\r\n\t\t\t\t\t\t'<thead>',\r\n\t\t\t\t\t\t\t'<tr>',\r\n\t\t\t\t\t\t\t\t'<th class=\"datepickerGoPrev\"><a href=\"#\"><span><%=prev%></span></a></th>',\r\n\t\t\t\t\t\t\t\t'<th colspan=\"5\" class=\"datepickerMonth\"><a href=\"#\"><span></span></a></th>',\r\n\t\t\t\t\t\t\t\t'<th class=\"datepickerGoNext\"><a href=\"#\"><span><%=next%></span></a></th>',\r\n\t\t\t\t\t\t\t'</tr>',\r\n\t\t\t\t\t\t\t'<tr class=\"datepickerDoW\">',\r\n\t\t\t\t\t\t\t\t'<th><span><%=week%></span></th>',\r\n\t\t\t\t\t\t\t\t'<th><span><%=day1%></span></th>',\r\n\t\t\t\t\t\t\t\t'<th><span><%=day2%></span></th>',\r\n\t\t\t\t\t\t\t\t'<th><span><%=day3%></span></th>',\r\n\t\t\t\t\t\t\t\t'<th><span><%=day4%></span></th>',\r\n\t\t\t\t\t\t\t\t'<th><span><%=day5%></span></th>',\r\n\t\t\t\t\t\t\t\t'<th><span><%=day6%></span></th>',\r\n\t\t\t\t\t\t\t\t'<th><span><%=day7%></span></th>',\r\n\t\t\t\t\t\t\t'</tr>',\r\n\t\t\t\t\t\t'</thead>',\r\n\t\t\t\t\t'</table></td>'\r\n\t\t\t\t],\r\n\t\t\t\tspace : '<td class=\"datepickerSpace\"><div></div></td>',\r\n\t\t\t\tdays: [\r\n\t\t\t\t\t'<tbody class=\"datepickerDays\">',\r\n\t\t\t\t\t\t'<tr>',\r\n\t\t\t\t\t\t\t'<th class=\"datepickerWeek\"><a href=\"#\"><span><%=weeks[0].week%></span></a></th>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[0].days[0].classname%>\"><a href=\"#\"><span><%=weeks[0].days[0].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[0].days[1].classname%>\"><a href=\"#\"><span><%=weeks[0].days[1].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[0].days[2].classname%>\"><a href=\"#\"><span><%=weeks[0].days[2].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[0].days[3].classname%>\"><a href=\"#\"><span><%=weeks[0].days[3].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[0].days[4].classname%>\"><a href=\"#\"><span><%=weeks[0].days[4].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[0].days[5].classname%>\"><a href=\"#\"><span><%=weeks[0].days[5].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[0].days[6].classname%>\"><a href=\"#\"><span><%=weeks[0].days[6].text%></span></a></td>',\r\n\t\t\t\t\t\t'</tr>',\r\n\t\t\t\t\t\t'<tr>',\r\n\t\t\t\t\t\t\t'<th class=\"datepickerWeek\"><a href=\"#\"><span><%=weeks[1].week%></span></a></th>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[1].days[0].classname%>\"><a href=\"#\"><span><%=weeks[1].days[0].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[1].days[1].classname%>\"><a href=\"#\"><span><%=weeks[1].days[1].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[1].days[2].classname%>\"><a href=\"#\"><span><%=weeks[1].days[2].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[1].days[3].classname%>\"><a href=\"#\"><span><%=weeks[1].days[3].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[1].days[4].classname%>\"><a href=\"#\"><span><%=weeks[1].days[4].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[1].days[5].classname%>\"><a href=\"#\"><span><%=weeks[1].days[5].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[1].days[6].classname%>\"><a href=\"#\"><span><%=weeks[1].days[6].text%></span></a></td>',\r\n\t\t\t\t\t\t'</tr>',\r\n\t\t\t\t\t\t'<tr>',\r\n\t\t\t\t\t\t\t'<th class=\"datepickerWeek\"><a href=\"#\"><span><%=weeks[2].week%></span></a></th>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[2].days[0].classname%>\"><a href=\"#\"><span><%=weeks[2].days[0].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[2].days[1].classname%>\"><a href=\"#\"><span><%=weeks[2].days[1].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[2].days[2].classname%>\"><a href=\"#\"><span><%=weeks[2].days[2].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[2].days[3].classname%>\"><a href=\"#\"><span><%=weeks[2].days[3].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[2].days[4].classname%>\"><a href=\"#\"><span><%=weeks[2].days[4].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[2].days[5].classname%>\"><a href=\"#\"><span><%=weeks[2].days[5].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[2].days[6].classname%>\"><a href=\"#\"><span><%=weeks[2].days[6].text%></span></a></td>',\r\n\t\t\t\t\t\t'</tr>',\r\n\t\t\t\t\t\t'<tr>',\r\n\t\t\t\t\t\t\t'<th class=\"datepickerWeek\"><a href=\"#\"><span><%=weeks[3].week%></span></a></th>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[3].days[0].classname%>\"><a href=\"#\"><span><%=weeks[3].days[0].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[3].days[1].classname%>\"><a href=\"#\"><span><%=weeks[3].days[1].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[3].days[2].classname%>\"><a href=\"#\"><span><%=weeks[3].days[2].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[3].days[3].classname%>\"><a href=\"#\"><span><%=weeks[3].days[3].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[3].days[4].classname%>\"><a href=\"#\"><span><%=weeks[3].days[4].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[3].days[5].classname%>\"><a href=\"#\"><span><%=weeks[3].days[5].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[3].days[6].classname%>\"><a href=\"#\"><span><%=weeks[3].days[6].text%></span></a></td>',\r\n\t\t\t\t\t\t'</tr>',\r\n\t\t\t\t\t\t'<tr>',\r\n\t\t\t\t\t\t\t'<th class=\"datepickerWeek\"><a href=\"#\"><span><%=weeks[4].week%></span></a></th>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[4].days[0].classname%>\"><a href=\"#\"><span><%=weeks[4].days[0].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[4].days[1].classname%>\"><a href=\"#\"><span><%=weeks[4].days[1].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[4].days[2].classname%>\"><a href=\"#\"><span><%=weeks[4].days[2].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[4].days[3].classname%>\"><a href=\"#\"><span><%=weeks[4].days[3].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[4].days[4].classname%>\"><a href=\"#\"><span><%=weeks[4].days[4].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[4].days[5].classname%>\"><a href=\"#\"><span><%=weeks[4].days[5].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[4].days[6].classname%>\"><a href=\"#\"><span><%=weeks[4].days[6].text%></span></a></td>',\r\n\t\t\t\t\t\t'</tr>',\r\n\t\t\t\t\t\t'<tr>',\r\n\t\t\t\t\t\t\t'<th class=\"datepickerWeek\"><a href=\"#\"><span><%=weeks[5].week%></span></a></th>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[5].days[0].classname%>\"><a href=\"#\"><span><%=weeks[5].days[0].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[5].days[1].classname%>\"><a href=\"#\"><span><%=weeks[5].days[1].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[5].days[2].classname%>\"><a href=\"#\"><span><%=weeks[5].days[2].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[5].days[3].classname%>\"><a href=\"#\"><span><%=weeks[5].days[3].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[5].days[4].classname%>\"><a href=\"#\"><span><%=weeks[5].days[4].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[5].days[5].classname%>\"><a href=\"#\"><span><%=weeks[5].days[5].text%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td class=\"<%=weeks[5].days[6].classname%>\"><a href=\"#\"><span><%=weeks[5].days[6].text%></span></a></td>',\r\n\t\t\t\t\t\t'</tr>',\r\n\t\t\t\t\t'</tbody>'\r\n\t\t\t\t],\r\n\t\t\t\tmonths: [\r\n\t\t\t\t\t'<tbody class=\"<%=className%>\">',\r\n\t\t\t\t\t\t'<tr>',\r\n\t\t\t\t\t\t\t'<td colspan=\"2\"><a href=\"#\"><span><%=data[0]%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td colspan=\"2\"><a href=\"#\"><span><%=data[1]%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td colspan=\"2\"><a href=\"#\"><span><%=data[2]%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td colspan=\"2\"><a href=\"#\"><span><%=data[3]%></span></a></td>',\r\n\t\t\t\t\t\t'</tr>',\r\n\t\t\t\t\t\t'<tr>',\r\n\t\t\t\t\t\t\t'<td colspan=\"2\"><a href=\"#\"><span><%=data[4]%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td colspan=\"2\"><a href=\"#\"><span><%=data[5]%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td colspan=\"2\"><a href=\"#\"><span><%=data[6]%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td colspan=\"2\"><a href=\"#\"><span><%=data[7]%></span></a></td>',\r\n\t\t\t\t\t\t'</tr>',\r\n\t\t\t\t\t\t'<tr>',\r\n\t\t\t\t\t\t\t'<td colspan=\"2\"><a href=\"#\"><span><%=data[8]%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td colspan=\"2\"><a href=\"#\"><span><%=data[9]%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td colspan=\"2\"><a href=\"#\"><span><%=data[10]%></span></a></td>',\r\n\t\t\t\t\t\t\t'<td colspan=\"2\"><a href=\"#\"><span><%=data[11]%></span></a></td>',\r\n\t\t\t\t\t\t'</tr>',\r\n\t\t\t\t\t'</tbody>'\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\tdefaults = {\r\n\t\t\t\tflat: false,\r\n\t\t\t\tstarts: 1,\r\n\t\t\t\tprev: '&#9664;',\r\n\t\t\t\tnext: '&#9654;',\r\n\t\t\t\tlastSel: false,\r\n\t\t\t\tmode: 'single',\r\n\t\t\t\tview: 'days',\r\n\t\t\t\tcalendars: 1,\r\n\t\t\t\tformat: 'Y-m-d',\r\n\t\t\t\tposition: 'bottom',\r\n\t\t\t\teventName: 'click',\r\n\t\t\t\tonRender: function(){return {};},\r\n\t\t\t\tonChange: function(){return true;},\r\n\t\t\t\tonShow: function(){return true;},\r\n\t\t\t\tonBeforeShow: function(){return true;},\r\n\t\t\t\tonHide: function(){return true;},\r\n\t\t\t\tlocale: {\r\n\t\t\t\t\tdays: [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\", \"Sunday\"],\r\n\t\t\t\t\tdaysShort: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\"],\r\n\t\t\t\t\tdaysMin: [\"Su\", \"Mo\", \"Tu\", \"We\", \"Th\", \"Fr\", \"Sa\", \"Su\"],\r\n\t\t\t\t\tmonths: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\r\n\t\t\t\t\tmonthsShort: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\r\n\t\t\t\t\tweekMin: 'wk'\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tfill = function(el) {\r\n\t\t\t\tvar options = $(el).data('datepicker');\r\n\t\t\t\tvar cal = $(el);\r\n\t\t\t\tvar currentCal = Math.floor(options.calendars/2), date, data, dow, month, cnt = 0, week, days, indic, indic2, html, tblCal;\r\n\t\t\t\tcal.find('td>table tbody').remove();\r\n\t\t\t\tfor (var i = 0; i < options.calendars; i++) {\r\n\t\t\t\t\tdate = new Date(options.current);\r\n\t\t\t\t\tdate.addMonths(-currentCal + i);\r\n\t\t\t\t\ttblCal = cal.find('table').eq(i+1);\r\n\t\t\t\t\tswitch (tblCal[0].className) {\r\n\t\t\t\t\t\tcase 'datepickerViewDays':\r\n\t\t\t\t\t\t\tdow = formatDate(date, 'B, Y');\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'datepickerViewMonths':\r\n\t\t\t\t\t\t\tdow = date.getFullYear();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'datepickerViewYears':\r\n\t\t\t\t\t\t\tdow = (date.getFullYear()-6) + ' - ' + (date.getFullYear()+5);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t} \r\n\t\t\t\t\ttblCal.find('thead tr:first th:eq(1) span').text(dow);\r\n\t\t\t\t\tdow = date.getFullYear()-6;\r\n\t\t\t\t\tdata = {\r\n\t\t\t\t\t\tdata: [],\r\n\t\t\t\t\t\tclassName: 'datepickerYears'\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor ( var j = 0; j < 12; j++) {\r\n\t\t\t\t\t\tdata.data.push(dow + j);\r\n\t\t\t\t\t}\r\n\t\t\t\t\thtml = tmpl(tpl.months.join(''), data);\r\n\t\t\t\t\tdate.setDate(1);\r\n\t\t\t\t\tdata = {weeks:[], test: 10};\r\n\t\t\t\t\tmonth = date.getMonth();\r\n\t\t\t\t\tvar dow = (date.getDay() - options.starts) % 7;\r\n\t\t\t\t\tdate.addDays(-(dow + (dow < 0 ? 7 : 0)));\r\n\t\t\t\t\tweek = -1;\r\n\t\t\t\t\tcnt = 0;\r\n\t\t\t\t\twhile (cnt < 42) {\r\n\t\t\t\t\t\tindic = parseInt(cnt/7,10);\r\n\t\t\t\t\t\tindic2 = cnt%7;\r\n\t\t\t\t\t\tif (!data.weeks[indic]) {\r\n\t\t\t\t\t\t\tweek = date.getWeekNumber();\r\n\t\t\t\t\t\t\tdata.weeks[indic] = {\r\n\t\t\t\t\t\t\t\tweek: week,\r\n\t\t\t\t\t\t\t\tdays: []\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdata.weeks[indic].days[indic2] = {\r\n\t\t\t\t\t\t\ttext: date.getDate(),\r\n\t\t\t\t\t\t\tclassname: []\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tif (month != date.getMonth()) {\r\n\t\t\t\t\t\t\tdata.weeks[indic].days[indic2].classname.push('datepickerNotInMonth');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (date.getDay() == 0) {\r\n\t\t\t\t\t\t\tdata.weeks[indic].days[indic2].classname.push('datepickerSunday');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (date.getDay() == 6) {\r\n\t\t\t\t\t\t\tdata.weeks[indic].days[indic2].classname.push('datepickerSaturday');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar fromUser = options.onRender(date);\r\n\t\t\t\t\t\tvar val = date.valueOf();\r\n\r\n\t\t\t\t\t\tif (val === options.date[0]) {\r\n\t\t\t\t\t\t\tdata.weeks[indic].days[indic2].classname.push('datepickerSelectedFirst');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ((val + 86399000) === options.date[1]) {\r\n\t\t\t\t\t\t\tdata.weeks[indic].days[indic2].classname.push('datepickerSelectedLast');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (fromUser.selected || options.date == val || $.inArray(val, options.date) > -1 || (options.mode == 'range' && val >= options.date[0] && val <= options.date[1])) {\r\n\t\t\t\t\t\t\tdata.weeks[indic].days[indic2].classname.push('datepickerSelected');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (fromUser.disabled) {\r\n\t\t\t\t\t\t\tdata.weeks[indic].days[indic2].classname.push('datepickerDisabled');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (fromUser.className) {\r\n\t\t\t\t\t\t\tdata.weeks[indic].days[indic2].classname.push(fromUser.className);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdata.weeks[indic].days[indic2].classname = data.weeks[indic].days[indic2].classname.join(' ');\r\n\t\t\t\t\t\tcnt++;\r\n\t\t\t\t\t\tdate.addDays(1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\thtml = tmpl(tpl.days.join(''), data) + html;\r\n\t\t\t\t\tdata = {\r\n\t\t\t\t\t\tdata: options.locale.monthsShort,\r\n\t\t\t\t\t\tclassName: 'datepickerMonths'\r\n\t\t\t\t\t};\r\n\t\t\t\t\thtml = tmpl(tpl.months.join(''), data) + html;\r\n\t\t\t\t\ttblCal.append(html);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tparseDate = function (date, format) {\r\n\t\t\t\tif (date.constructor == Date) {\r\n\t\t\t\t\treturn new Date(date);\r\n\t\t\t\t}\r\n\t\t\t\tvar parts = date.split(/\\W+/);\r\n\t\t\t\tvar against = format.split(/\\W+/), d, m, y, h, min, now = new Date();\r\n\t\t\t\tfor (var i = 0; i < parts.length; i++) {\r\n\t\t\t\t\tswitch (against[i]) {\r\n\t\t\t\t\t\tcase 'd':\r\n\t\t\t\t\t\tcase 'e':\r\n\t\t\t\t\t\t\td = parseInt(parts[i],10);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'm':\r\n\t\t\t\t\t\t\tm = parseInt(parts[i], 10)-1;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'Y':\r\n\t\t\t\t\t\tcase 'y':\r\n\t\t\t\t\t\t\ty = parseInt(parts[i], 10);\r\n\t\t\t\t\t\t\ty += y > 100 ? 0 : (y < 29 ? 2000 : 1900);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'H':\r\n\t\t\t\t\t\tcase 'I':\r\n\t\t\t\t\t\tcase 'k':\r\n\t\t\t\t\t\tcase 'l':\r\n\t\t\t\t\t\t\th = parseInt(parts[i], 10);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'P':\r\n\t\t\t\t\t\tcase 'p':\r\n\t\t\t\t\t\t\tif (/pm/i.test(parts[i]) && h < 12) {\r\n\t\t\t\t\t\t\t\th += 12;\r\n\t\t\t\t\t\t\t} else if (/am/i.test(parts[i]) && h >= 12) {\r\n\t\t\t\t\t\t\t\th -= 12;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'M':\r\n\t\t\t\t\t\t\tmin = parseInt(parts[i], 10);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn new Date(\r\n\t\t\t\t\ty === undefined ? now.getFullYear() : y,\r\n\t\t\t\t\tm === undefined ? now.getMonth() : m,\r\n\t\t\t\t\td === undefined ? now.getDate() : d,\r\n\t\t\t\t\th === undefined ? now.getHours() : h,\r\n\t\t\t\t\tmin === undefined ? now.getMinutes() : min,\r\n\t\t\t\t\t0\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tformatDate = function(date, format) {\r\n\t\t\t\tvar m = date.getMonth();\r\n\t\t\t\tvar d = date.getDate();\r\n\t\t\t\tvar y = date.getFullYear();\r\n\t\t\t\tvar wn = date.getWeekNumber();\r\n\t\t\t\tvar w = date.getDay();\r\n\t\t\t\tvar s = {};\r\n\t\t\t\tvar hr = date.getHours();\r\n\t\t\t\tvar pm = (hr >= 12);\r\n\t\t\t\tvar ir = (pm) ? (hr - 12) : hr;\r\n\t\t\t\tvar dy = date.getDayOfYear();\r\n\t\t\t\tif (ir == 0) {\r\n\t\t\t\t\tir = 12;\r\n\t\t\t\t}\r\n\t\t\t\tvar min = date.getMinutes();\r\n\t\t\t\tvar sec = date.getSeconds();\r\n\t\t\t\tvar parts = format.split(''), part;\r\n\t\t\t\tfor ( var i = 0; i < parts.length; i++ ) {\r\n\t\t\t\t\tpart = parts[i];\r\n\t\t\t\t\tswitch (parts[i]) {\r\n\t\t\t\t\t\tcase 'a':\r\n\t\t\t\t\t\t\tpart = date.getDayName();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'A':\r\n\t\t\t\t\t\t\tpart = date.getDayName(true);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'b':\r\n\t\t\t\t\t\t\tpart = date.getMonthName();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'B':\r\n\t\t\t\t\t\t\tpart = date.getMonthName(true);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'C':\r\n\t\t\t\t\t\t\tpart = 1 + Math.floor(y / 100);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'd':\r\n\t\t\t\t\t\t\tpart = (d < 10) ? (\"0\" + d) : d;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'e':\r\n\t\t\t\t\t\t\tpart = d;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'H':\r\n\t\t\t\t\t\t\tpart = (hr < 10) ? (\"0\" + hr) : hr;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'I':\r\n\t\t\t\t\t\t\tpart = (ir < 10) ? (\"0\" + ir) : ir;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'j':\r\n\t\t\t\t\t\t\tpart = (dy < 100) ? ((dy < 10) ? (\"00\" + dy) : (\"0\" + dy)) : dy;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'k':\r\n\t\t\t\t\t\t\tpart = hr;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'l':\r\n\t\t\t\t\t\t\tpart = ir;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'm':\r\n\t\t\t\t\t\t\tpart = (m < 9) ? (\"0\" + (1+m)) : (1+m);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'M':\r\n\t\t\t\t\t\t\tpart = (min < 10) ? (\"0\" + min) : min;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'p':\r\n\t\t\t\t\t\tcase 'P':\r\n\t\t\t\t\t\t\tpart = pm ? \"PM\" : \"AM\";\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 's':\r\n\t\t\t\t\t\t\tpart = Math.floor(date.getTime() / 1000);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'S':\r\n\t\t\t\t\t\t\tpart = (sec < 10) ? (\"0\" + sec) : sec;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'u':\r\n\t\t\t\t\t\t\tpart = w + 1;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'w':\r\n\t\t\t\t\t\t\tpart = w;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'y':\r\n\t\t\t\t\t\t\tpart = ('' + y).substr(2, 2);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'Y':\r\n\t\t\t\t\t\t\tpart = y;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tparts[i] = part;\r\n\t\t\t\t}\r\n\t\t\t\treturn parts.join('');\r\n\t\t\t},\r\n\t\t\textendDate = function(options) {\r\n\t\t\t\tif (Date.prototype.tempDate) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tDate.prototype.tempDate = null;\r\n\t\t\t\tDate.prototype.months = options.months;\r\n\t\t\t\tDate.prototype.monthsShort = options.monthsShort;\r\n\t\t\t\tDate.prototype.days = options.days;\r\n\t\t\t\tDate.prototype.daysShort = options.daysShort;\r\n\t\t\t\tDate.prototype.getMonthName = function(fullName) {\r\n\t\t\t\t\treturn this[fullName ? 'months' : 'monthsShort'][this.getMonth()];\r\n\t\t\t\t};\r\n\t\t\t\tDate.prototype.getDayName = function(fullName) {\r\n\t\t\t\t\treturn this[fullName ? 'days' : 'daysShort'][this.getDay()];\r\n\t\t\t\t};\r\n\t\t\t\tDate.prototype.addDays = function (n) {\r\n\t\t\t\t\tthis.setDate(this.getDate() + n);\r\n\t\t\t\t\tthis.tempDate = this.getDate();\r\n\t\t\t\t};\r\n\t\t\t\tDate.prototype.addMonths = function (n) {\r\n\t\t\t\t\tif (this.tempDate == null) {\r\n\t\t\t\t\t\tthis.tempDate = this.getDate();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.setDate(1);\r\n\t\t\t\t\tthis.setMonth(this.getMonth() + n);\r\n\t\t\t\t\tthis.setDate(Math.min(this.tempDate, this.getMaxDays()));\r\n\t\t\t\t};\r\n\t\t\t\tDate.prototype.addYears = function (n) {\r\n\t\t\t\t\tif (this.tempDate == null) {\r\n\t\t\t\t\t\tthis.tempDate = this.getDate();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.setDate(1);\r\n\t\t\t\t\tthis.setFullYear(this.getFullYear() + n);\r\n\t\t\t\t\tthis.setDate(Math.min(this.tempDate, this.getMaxDays()));\r\n\t\t\t\t};\r\n\t\t\t\tDate.prototype.getMaxDays = function() {\r\n\t\t\t\t\tvar tmpDate = new Date(Date.parse(this)),\r\n\t\t\t\t\t\td = 28, m;\r\n\t\t\t\t\tm = tmpDate.getMonth();\r\n\t\t\t\t\td = 28;\r\n\t\t\t\t\twhile (tmpDate.getMonth() == m) {\r\n\t\t\t\t\t\td ++;\r\n\t\t\t\t\t\ttmpDate.setDate(d);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn d - 1;\r\n\t\t\t\t};\r\n\t\t\t\tDate.prototype.getFirstDay = function() {\r\n\t\t\t\t\tvar tmpDate = new Date(Date.parse(this));\r\n\t\t\t\t\ttmpDate.setDate(1);\r\n\t\t\t\t\treturn tmpDate.getDay();\r\n\t\t\t\t};\r\n\t\t\t\tDate.prototype.getWeekNumber = function() {\r\n\t\t\t\t\tvar tempDate = new Date(this);\r\n\t\t\t\t\ttempDate.setDate(tempDate.getDate() - (tempDate.getDay() + 6) % 7 + 3);\r\n\t\t\t\t\tvar dms = tempDate.valueOf();\r\n\t\t\t\t\ttempDate.setMonth(0);\r\n\t\t\t\t\ttempDate.setDate(4);\r\n\t\t\t\t\treturn Math.round((dms - tempDate.valueOf()) / (604800000)) + 1;\r\n\t\t\t\t};\r\n\t\t\t\tDate.prototype.getDayOfYear = function() {\r\n\t\t\t\t\tvar now = new Date(this.getFullYear(), this.getMonth(), this.getDate(), 0, 0, 0);\r\n\t\t\t\t\tvar then = new Date(this.getFullYear(), 0, 0, 0, 0, 0);\r\n\t\t\t\t\tvar time = now - then;\r\n\t\t\t\t\treturn Math.floor(time / 24*60*60*1000);\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tlayout = function (el) {\r\n\t\t\t\tvar options = $(el).data('datepicker');\r\n\t\t\t\tvar cal = $('#' + options.id);\r\n\t\t\t\tif (!options.extraHeight) {\r\n\t\t\t\t\tvar divs = $(el).find('div');\r\n\t\t\t\t\toptions.extraHeight = divs.get(0).offsetHeight + divs.get(1).offsetHeight;\r\n\t\t\t\t\toptions.extraWidth = divs.get(2).offsetWidth + divs.get(3).offsetWidth;\r\n\t\t\t\t}\r\n\t\t\t\tvar tbl = cal.find('table:first').get(0);\r\n\t\t\t\tvar width = tbl.offsetWidth;\r\n\t\t\t\tvar height = tbl.offsetHeight;\r\n\t\t\t\tcal.css({\r\n\t\t\t\t\twidth: width + options.extraWidth + 'px',\r\n\t\t\t\t\theight: height + options.extraHeight + 'px'\r\n\t\t\t\t}).find('div.datepickerContainer').css({\r\n\t\t\t\t\twidth: width + 'px',\r\n\t\t\t\t\theight: height + 'px'\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tclick = function(ev) {\r\n\t\t\t\tif ($(ev.target).is('span')) {\r\n\t\t\t\t\tev.target = ev.target.parentNode;\r\n\t\t\t\t}\r\n\t\t\t\tvar el = $(ev.target);\r\n\t\t\t\tif (el.is('a')) {\r\n\t\t\t\t\tev.target.blur();\r\n\t\t\t\t\tif (el.hasClass('datepickerDisabled')) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar options = $(this).data('datepicker');\r\n\t\t\t\t\tvar parentEl = el.parent();\r\n\t\t\t\t\tvar tblEl = parentEl.parent().parent().parent();\r\n\t\t\t\t\tvar tblIndex = $('table', this).index(tblEl.get(0)) - 1;\r\n\t\t\t\t\tvar tmp = new Date(options.current);\r\n\t\t\t\t\tvar changed = false;\r\n\t\t\t\t\tvar fillIt = false;\r\n\t\t\t\t\tif (parentEl.is('th')) {\r\n\t\t\t\t\t\tif (parentEl.hasClass('datepickerWeek') && options.mode == 'range' && !parentEl.next().hasClass('datepickerDisabled')) {\r\n\t\t\t\t\t\t\tvar val = parseInt(parentEl.next().text(), 10);\r\n\t\t\t\t\t\t\ttmp.addMonths(tblIndex - Math.floor(options.calendars/2));\r\n\t\t\t\t\t\t\tif (parentEl.next().hasClass('datepickerNotInMonth')) {\r\n\t\t\t\t\t\t\t\ttmp.addMonths(val > 15 ? -1 : 1);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttmp.setDate(val);\r\n\t\t\t\t\t\t\toptions.date[0] = (tmp.setHours(0,0,0,0)).valueOf();\r\n\t\t\t\t\t\t\ttmp.setHours(23,59,59,0);\r\n\t\t\t\t\t\t\ttmp.addDays(6);\r\n\t\t\t\t\t\t\toptions.date[1] = tmp.valueOf();\r\n\t\t\t\t\t\t\tfillIt = true;\r\n\t\t\t\t\t\t\tchanged = true;\r\n\t\t\t\t\t\t\toptions.lastSel = false;\r\n\t\t\t\t\t\t} else if (parentEl.hasClass('datepickerMonth')) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t// tmp.addMonths(tblIndex - Math.floor(options.calendars/2));\r\n\t\t\t\t\t\t\t// switch (tblEl.get(0).className) {\r\n\t\t\t\t\t\t\t// \tcase 'datepickerViewDays':\r\n\t\t\t\t\t\t\t// \t\ttblEl.get(0).className = 'datepickerViewMonths';\r\n\t\t\t\t\t\t\t// \t\tel.find('span').text(tmp.getFullYear());\r\n\t\t\t\t\t\t\t// \t\tbreak;\r\n\t\t\t\t\t\t\t// \tcase 'datepickerViewMonths':\r\n\t\t\t\t\t\t\t// \t\ttblEl.get(0).className = 'datepickerViewYears';\r\n\t\t\t\t\t\t\t// \t\tel.find('span').text((tmp.getFullYear()-6) + ' - ' + (tmp.getFullYear()+5));\r\n\t\t\t\t\t\t\t// \t\tbreak;\r\n\t\t\t\t\t\t\t// \tcase 'datepickerViewYears':\r\n\t\t\t\t\t\t\t// \t\ttblEl.get(0).className = 'datepickerViewDays';\r\n\t\t\t\t\t\t\t// \t\tel.find('span').text(formatDate(tmp, 'B, Y'));\r\n\t\t\t\t\t\t\t// \t\tbreak;\r\n\t\t\t\t\t\t\t// }\r\n\t\t\t\t\t\t} else if (parentEl.parent().parent().is('thead')) {\r\n\t\t\t\t\t\t\tswitch (tblEl.get(0).className) {\r\n\t\t\t\t\t\t\t\tcase 'datepickerViewDays':\r\n\t\t\t\t\t\t\t\t\toptions.current.addMonths(parentEl.hasClass('datepickerGoPrev') ? -1 : 1);\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 'datepickerViewMonths':\r\n\t\t\t\t\t\t\t\t\toptions.current.addYears(parentEl.hasClass('datepickerGoPrev') ? -1 : 1);\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\tcase 'datepickerViewYears':\r\n\t\t\t\t\t\t\t\t\toptions.current.addYears(parentEl.hasClass('datepickerGoPrev') ? -12 : 12);\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfillIt = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (parentEl.is('td') && !parentEl.hasClass('datepickerDisabled')) {\r\n\t\t\t\t\t\tswitch (tblEl.get(0).className) {\r\n\t\t\t\t\t\t\tcase 'datepickerViewMonths':\r\n\t\t\t\t\t\t\t\toptions.current.setMonth(tblEl.find('tbody.datepickerMonths td').index(parentEl));\r\n\t\t\t\t\t\t\t\toptions.current.setFullYear(parseInt(tblEl.find('thead th.datepickerMonth span').text(), 10));\r\n\t\t\t\t\t\t\t\toptions.current.addMonths(Math.floor(options.calendars/2) - tblIndex);\r\n\t\t\t\t\t\t\t\ttblEl.get(0).className = 'datepickerViewDays';\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'datepickerViewYears':\r\n\t\t\t\t\t\t\t\toptions.current.setFullYear(parseInt(el.text(), 10));\r\n\t\t\t\t\t\t\t\ttblEl.get(0).className = 'datepickerViewMonths';\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\tvar val = parseInt(el.text(), 10);\r\n\t\t\t\t\t\t\t\ttmp.addMonths(tblIndex - Math.floor(options.calendars/2));\r\n\t\t\t\t\t\t\t\tif (parentEl.hasClass('datepickerNotInMonth')) {\r\n\t\t\t\t\t\t\t\t\ttmp.addMonths(val > 15 ? -1 : 1);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\ttmp.setDate(val);\r\n\t\t\t\t\t\t\t\tswitch (options.mode) {\r\n\t\t\t\t\t\t\t\t\tcase 'multiple':\r\n\t\t\t\t\t\t\t\t\t\tval = (tmp.setHours(0,0,0,0)).valueOf();\r\n\t\t\t\t\t\t\t\t\t\tif ($.inArray(val, options.date) > -1) {\r\n\t\t\t\t\t\t\t\t\t\t\t$.each(options.date, function(nr, dat){\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (dat == val) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\toptions.date.splice(nr,1);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\toptions.date.push(val);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\tcase 'range':\r\n\t\t\t\t\t\t\t\t\t\tif (!options.lastSel) {\r\n\t\t\t\t\t\t\t\t\t\t\toptions.date[0] = (tmp.setHours(0,0,0,0)).valueOf();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tval = (tmp.setHours(23,59,59,0)).valueOf();\r\n\t\t\t\t\t\t\t\t\t\tif (val < options.date[0]) {\r\n\t\t\t\t\t\t\t\t\t\t\toptions.date[1] = options.date[0] + 86399000;\r\n\t\t\t\t\t\t\t\t\t\t\toptions.date[0] = val - 86399000;\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\toptions.date[1] = val;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\toptions.lastSel = !options.lastSel;\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\t\t\toptions.date = tmp.valueOf();\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfillIt = true;\r\n\t\t\t\t\t\tchanged = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (fillIt) {\r\n\t\t\t\t\t\tfill(this);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (changed) {\r\n\t\t\t\t\t\toptions.onChange.apply(this, prepareDate(options));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tprepareDate = function (options) {\r\n\t\t\t\tvar tmp;\r\n\t\t\t\tif (options.mode == 'single') {\r\n\t\t\t\t\ttmp = new Date(options.date);\r\n\t\t\t\t\treturn [formatDate(tmp, options.format), tmp, options.el];\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttmp = [[],[], options.el];\r\n\t\t\t\t\t$.each(options.date, function(nr, val){\r\n\t\t\t\t\t\tvar date = new Date(val);\r\n\t\t\t\t\t\ttmp[0].push(formatDate(date, options.format));\r\n\t\t\t\t\t\ttmp[1].push(date);\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn tmp;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetViewport = function () {\r\n\t\t\t\tvar m = document.compatMode == 'CSS1Compat';\r\n\t\t\t\treturn {\r\n\t\t\t\t\tl : window.pageXOffset || (m ? document.documentElement.scrollLeft : document.body.scrollLeft),\r\n\t\t\t\t\tt : window.pageYOffset || (m ? document.documentElement.scrollTop : document.body.scrollTop),\r\n\t\t\t\t\tw : window.innerWidth || (m ? document.documentElement.clientWidth : document.body.clientWidth),\r\n\t\t\t\t\th : window.innerHeight || (m ? document.documentElement.clientHeight : document.body.clientHeight)\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tisChildOf = function(parentEl, el, container) {\r\n\t\t\t\tif (parentEl == el) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\tif (parentEl.contains) {\r\n\t\t\t\t\treturn parentEl.contains(el);\r\n\t\t\t\t}\r\n\t\t\t\tif ( parentEl.compareDocumentPosition ) {\r\n\t\t\t\t\treturn !!(parentEl.compareDocumentPosition(el) & 16);\r\n\t\t\t\t}\r\n\t\t\t\tvar prEl = el.parentNode;\r\n\t\t\t\twhile(prEl && prEl != container) {\r\n\t\t\t\t\tif (prEl == parentEl)\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\tprEl = prEl.parentNode;\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tshow = function (ev) {\r\n\t\t\t\tvar cal = $('#' + $(this).data('datepickerId'));\r\n\t\t\t\tif (!cal.is(':visible')) {\r\n\t\t\t\t\tvar calEl = cal.get(0);\r\n\t\t\t\t\tfill(calEl);\r\n\t\t\t\t\tvar options = cal.data('datepicker');\r\n\t\t\t\t\toptions.onBeforeShow.apply(this, [cal.get(0)]);\r\n\t\t\t\t\tvar pos = $(this).offset();\r\n\t\t\t\t\tvar viewPort = getViewport();\r\n\t\t\t\t\tvar top = pos.top;\r\n\t\t\t\t\tvar left = pos.left;\r\n\t\t\t\t\tvar oldDisplay = $.curCSS(calEl, 'display');\r\n\t\t\t\t\tcal.css({\r\n\t\t\t\t\t\tvisibility: 'hidden',\r\n\t\t\t\t\t\tdisplay: 'block'\r\n\t\t\t\t\t});\r\n\t\t\t\t\tlayout(calEl);\r\n\t\t\t\t\tswitch (options.position){\r\n\t\t\t\t\t\tcase 'top':\r\n\t\t\t\t\t\t\ttop -= calEl.offsetHeight;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'left':\r\n\t\t\t\t\t\t\tleft -= calEl.offsetWidth;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'right':\r\n\t\t\t\t\t\t\tleft += this.offsetWidth;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'bottom':\r\n\t\t\t\t\t\t\ttop += this.offsetHeight;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (top + calEl.offsetHeight > viewPort.t + viewPort.h) {\r\n\t\t\t\t\t\ttop = pos.top  - calEl.offsetHeight;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (top < viewPort.t) {\r\n\t\t\t\t\t\ttop = pos.top + this.offsetHeight + calEl.offsetHeight;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (left + calEl.offsetWidth > viewPort.l + viewPort.w) {\r\n\t\t\t\t\t\tleft = pos.left - calEl.offsetWidth;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (left < viewPort.l) {\r\n\t\t\t\t\t\tleft = pos.left + this.offsetWidth\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcal.css({\r\n\t\t\t\t\t\tvisibility: 'visible',\r\n\t\t\t\t\t\tdisplay: 'block',\r\n\t\t\t\t\t\ttop: top + 'px',\r\n\t\t\t\t\t\tleft: left + 'px'\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (options.onShow.apply(this, [cal.get(0)]) != false) {\r\n\t\t\t\t\t\tcal.show();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$(document).bind('mousedown', {cal: cal, trigger: this}, hide);\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\thide = function (ev) {\r\n\t\t\t\tif (ev.target != ev.data.trigger && !isChildOf(ev.data.cal.get(0), ev.target, ev.data.cal.get(0))) {\r\n\t\t\t\t\tif (ev.data.cal.data('datepicker').onHide.apply(this, [ev.data.cal.get(0)]) != false) {\r\n\t\t\t\t\t\tev.data.cal.hide();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$(document).unbind('mousedown', hide);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\treturn {\r\n\t\t\tinit: function(options){\r\n\t\t\t\toptions = $.extend({}, defaults, options||{});\r\n\t\t\t\textendDate(options.locale);\r\n\t\t\t\toptions.calendars = Math.max(1, parseInt(options.calendars,10)||1);\r\n\t\t\t\toptions.mode = /single|multiple|range/.test(options.mode) ? options.mode : 'single';\r\n\t\t\t\treturn this.each(function(){\r\n\t\t\t\t\tif (!$(this).data('datepicker')) {\r\n\t\t\t\t\t\toptions.el = this;\r\n\t\t\t\t\t\tif (options.date.constructor == String) {\r\n\t\t\t\t\t\t\toptions.date = parseDate(options.date, options.format);\r\n\t\t\t\t\t\t\toptions.date.setHours(0,0,0,0);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (options.mode != 'single') {\r\n\t\t\t\t\t\t\tif (options.date.constructor != Array) {\r\n\t\t\t\t\t\t\t\toptions.date = [options.date.valueOf()];\r\n\t\t\t\t\t\t\t\tif (options.mode == 'range') {\r\n\t\t\t\t\t\t\t\t\toptions.date.push(((new Date(options.date[0])).setHours(23,59,59,0)).valueOf());\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tfor (var i = 0; i < options.date.length; i++) {\r\n\t\t\t\t\t\t\t\t\toptions.date[i] = (parseDate(options.date[i], options.format).setHours(0,0,0,0)).valueOf();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (options.mode == 'range') {\r\n\t\t\t\t\t\t\t\t\toptions.date[1] = ((new Date(options.date[1])).setHours(23,59,59,0)).valueOf();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\toptions.date = options.date.valueOf();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!options.current) {\r\n\t\t\t\t\t\t\toptions.current = new Date();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\toptions.current = parseDate(options.current, options.format);\r\n\t\t\t\t\t\t} \r\n\t\t\t\t\t\toptions.current.setDate(1);\r\n\t\t\t\t\t\toptions.current.setHours(0,0,0,0);\r\n\t\t\t\t\t\tvar id = 'datepicker_' + parseInt(Math.random() * 1000), cnt;\r\n\t\t\t\t\t\toptions.id = id;\r\n\t\t\t\t\t\t$(this).data('datepickerId', options.id);\r\n\t\t\t\t\t\tvar cal = $(tpl.wrapper).attr('id', id).bind('click', click).data('datepicker', options);\r\n\t\t\t\t\t\tif (options.className) {\r\n\t\t\t\t\t\t\tcal.addClass(options.className);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar html = '';\r\n\t\t\t\t\t\tfor (var i = 0; i < options.calendars; i++) {\r\n\t\t\t\t\t\t\tcnt = options.starts;\r\n\t\t\t\t\t\t\tif (i > 0) {\r\n\t\t\t\t\t\t\t\thtml += tpl.space;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\thtml += tmpl(tpl.head.join(''), {\r\n\t\t\t\t\t\t\t\t\tweek: options.locale.weekMin,\r\n\t\t\t\t\t\t\t\t\tprev: options.prev,\r\n\t\t\t\t\t\t\t\t\tnext: options.next,\r\n\t\t\t\t\t\t\t\t\tday1: options.locale.daysMin[(cnt++)%7],\r\n\t\t\t\t\t\t\t\t\tday2: options.locale.daysMin[(cnt++)%7],\r\n\t\t\t\t\t\t\t\t\tday3: options.locale.daysMin[(cnt++)%7],\r\n\t\t\t\t\t\t\t\t\tday4: options.locale.daysMin[(cnt++)%7],\r\n\t\t\t\t\t\t\t\t\tday5: options.locale.daysMin[(cnt++)%7],\r\n\t\t\t\t\t\t\t\t\tday6: options.locale.daysMin[(cnt++)%7],\r\n\t\t\t\t\t\t\t\t\tday7: options.locale.daysMin[(cnt++)%7]\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcal\r\n\t\t\t\t\t\t\t.find('tr:first').append(html)\r\n\t\t\t\t\t\t\t\t.find('table').addClass(views[options.view]);\r\n\t\t\t\t\t\tfill(cal.get(0));\r\n\t\t\t\t\t\tif (options.flat) {\r\n\t\t\t\t\t\t\tcal.appendTo(this).show().css('position', 'relative');\r\n\t\t\t\t\t\t\tlayout(cal.get(0));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcal.appendTo(document.body);\r\n\t\t\t\t\t\t\t$(this).bind(options.eventName, show);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tshowPicker: function() {\r\n\t\t\t\treturn this.each( function () {\r\n\t\t\t\t\tif ($(this).data('datepickerId')) {\r\n\t\t\t\t\t\tshow.apply(this);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\thidePicker: function() {\r\n\t\t\t\treturn this.each( function () {\r\n\t\t\t\t\tif ($(this).data('datepickerId')) {\r\n\t\t\t\t\t\t$('#' + $(this).data('datepickerId')).hide();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tsetDate: function(date, shiftTo){\r\n\t\t\t\treturn this.each(function(){\r\n\t\t\t\t\tif ($(this).data('datepickerId')) {\r\n\t\t\t\t\t\tvar cal = $('#' + $(this).data('datepickerId'));\r\n\t\t\t\t\t\tvar options = cal.data('datepicker');\r\n\t\t\t\t\t\toptions.date = date;\r\n\t\t\t\t\t\tif (options.date.constructor == String) {\r\n\t\t\t\t\t\t\toptions.date = parseDate(options.date, options.format);\r\n\t\t\t\t\t\t\toptions.date.setHours(0,0,0,0);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (options.mode != 'single') {\r\n\t\t\t\t\t\t\tif (options.date.constructor != Array) {\r\n\t\t\t\t\t\t\t\toptions.date = [options.date.valueOf()];\r\n\t\t\t\t\t\t\t\tif (options.mode == 'range') {\r\n\t\t\t\t\t\t\t\t\toptions.date.push(((new Date(options.date[0])).setHours(23,59,59,0)).valueOf());\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tfor (var i = 0; i < options.date.length; i++) {\r\n\t\t\t\t\t\t\t\t\toptions.date[i] = (parseDate(options.date[i], options.format).setHours(0,0,0,0)).valueOf();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (options.mode == 'range') {\r\n\t\t\t\t\t\t\t\t\toptions.date[1] = ((new Date(options.date[1])).setHours(23,59,59,0)).valueOf();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\toptions.date = options.date.valueOf();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (shiftTo) {\r\n\t\t\t\t\t\t\toptions.current = new Date (options.mode != 'single' ? options.date[0] : options.date);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfill(cal.get(0));\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tgetDate: function(formated) {\r\n\t\t\t\tif (this.size() > 0) {\r\n\t\t\t\t\treturn prepareDate($('#' + $(this).data('datepickerId')).data('datepicker'))[formated ? 0 : 1];\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tclear: function(){\r\n\t\t\t\treturn this.each(function(){\r\n\t\t\t\t\tif ($(this).data('datepickerId')) {\r\n\t\t\t\t\t\tvar cal = $('#' + $(this).data('datepickerId'));\r\n\t\t\t\t\t\tvar options = cal.data('datepicker');\r\n\t\t\t\t\t\tif (options.mode != 'single') {\r\n\t\t\t\t\t\t\toptions.date = [];\r\n\t\t\t\t\t\t\tfill(cal.get(0));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tfixLayout: function(){\r\n\t\t\t\treturn this.each(function(){\r\n\t\t\t\t\tif ($(this).data('datepickerId')) {\r\n\t\t\t\t\t\tvar cal = $('#' + $(this).data('datepickerId'));\r\n\t\t\t\t\t\tvar options = cal.data('datepicker');\r\n\t\t\t\t\t\tif (options.flat) {\r\n\t\t\t\t\t\t\tlayout(cal.get(0));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\t}();\r\n\t$.fn.extend({\r\n\t\tDatePicker: DatePicker.init,\r\n\t\tDatePickerHide: DatePicker.hidePicker,\r\n\t\tDatePickerShow: DatePicker.showPicker,\r\n\t\tDatePickerSetDate: DatePicker.setDate,\r\n\t\tDatePickerGetDate: DatePicker.getDate,\r\n\t\tDatePickerClear: DatePicker.clear,\r\n\t\tDatePickerLayout: DatePicker.fixLayout\r\n\t});\r\n})(jQuery);\r\n\r\n(function(){\r\n  var cache = {};\r\n \r\n  this.tmpl = function tmpl(str, data){\r\n    // Figure out if we're getting a template, or if we need to\r\n    // load the template - and be sure to cache the result.\r\n    var fn = !/\\W/.test(str) ?\r\n      cache[str] = cache[str] ||\r\n        tmpl(document.getElementById(str).innerHTML) :\r\n     \r\n      // Generate a reusable function that will serve as a template\r\n      // generator (and which will be cached).\r\n      new Function(\"obj\",\r\n        \"var p=[],print=function(){p.push.apply(p,arguments);};\" +\r\n       \r\n        // Introduce the data as local variables using with(){}\r\n        \"with(obj){p.push('\" +\r\n       \r\n        // Convert the template into pure JavaScript\r\n        str\r\n          .replace(/[\\r\\t\\n]/g, \" \")\r\n          .split(\"<%\").join(\"\\t\")\r\n          .replace(/((^|%>)[^\\t]*)'/g, \"$1\\r\")\r\n          .replace(/\\t=(.*?)%>/g, \"',$1,'\")\r\n          .split(\"\\t\").join(\"');\")\r\n          .split(\"%>\").join(\"p.push('\")\r\n          .split(\"\\r\").join(\"\\\\'\")\r\n      + \"');}return p.join('');\");\r\n   \r\n    // Provide some basic currying to the user\r\n    return data ? fn( data ) : fn;\r\n  };\r\n})();",
    "\n(function() {\n  var Dragster,\n    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };\n\n  Dragster = (function() {\n    function Dragster(el) {\n      this.el = el;\n      this.dragleave = __bind(this.dragleave, this);\n      this.dragenter = __bind(this.dragenter, this);\n      if (this.supportsEventConstructors()) {\n        this.first = false;\n        this.second = false;\n        this.el.addEventListener(\"dragenter\", this.dragenter, false);\n        this.el.addEventListener(\"dragleave\", this.dragleave, false);\n      }\n    }\n\n    Dragster.prototype.dragenter = function(event) {\n      if (this.first) {\n        return this.second = true;\n      } else {\n        this.first = true;\n        return this.el.dispatchEvent(new CustomEvent(\"dragster:enter\", {\n          bubbles: true,\n          cancelable: true,\n          detail: {\n            dataTransfer: event.dataTransfer\n          }\n        }));\n      }\n    };\n\n    Dragster.prototype.dragleave = function(event) {\n      if (this.second) {\n        this.second = false;\n      } else if (this.first) {\n        this.first = false;\n      }\n      if (!this.first && !this.second) {\n        return this.el.dispatchEvent(new CustomEvent(\"dragster:leave\", {\n          bubbles: true,\n          cancelable: true,\n          detail: {\n            dataTransfer: event.dataTransfer\n          }\n        }));\n      }\n    };\n\n    Dragster.prototype.removeListeners = function() {\n      this.el.removeEventListener(\"dragenter\", this.dragenter, false);\n      return this.el.removeEventListener(\"dragleave\", this.dragleave, false);\n    };\n\n    Dragster.prototype.supportsEventConstructors = function() {\n      try {\n        new CustomEvent(\"z\");\n      } catch (_error) {\n        return false;\n      }\n      return true;\n    };\n\n    Dragster.prototype.reset = function() {\n      this.first = false;\n      return this.second = false;\n    };\n\n    return Dragster;\n\n  })();\n\n  window.Dragster = Dragster;\n\n}).call(this);\n",
    "\n/*\n *\n * More info at [www.dropzonejs.com](http://www.dropzonejs.com)\n *\n * Copyright (c) 2012, Matias Meno\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n *\n */\n\n(function() {\n  var Dropzone, Emitter, camelize, contentLoaded, detectVerticalSquash, drawImageIOSFix, noop, without,\n    __slice = [].slice,\n    __hasProp = {}.hasOwnProperty,\n    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\n  noop = function() {};\n\n  Emitter = (function() {\n    function Emitter() {}\n\n    Emitter.prototype.addEventListener = Emitter.prototype.on;\n\n    Emitter.prototype.on = function(event, fn) {\n      this._callbacks = this._callbacks || {};\n      if (!this._callbacks[event]) {\n        this._callbacks[event] = [];\n      }\n      this._callbacks[event].push(fn);\n      return this;\n    };\n\n    Emitter.prototype.emit = function() {\n      var args, callback, callbacks, event, _i, _len;\n      event = arguments[0], args = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n      this._callbacks = this._callbacks || {};\n      callbacks = this._callbacks[event];\n      if (callbacks) {\n        for (_i = 0, _len = callbacks.length; _i < _len; _i++) {\n          callback = callbacks[_i];\n          callback.apply(this, args);\n        }\n      }\n      return this;\n    };\n\n    Emitter.prototype.removeListener = Emitter.prototype.off;\n\n    Emitter.prototype.removeAllListeners = Emitter.prototype.off;\n\n    Emitter.prototype.removeEventListener = Emitter.prototype.off;\n\n    Emitter.prototype.off = function(event, fn) {\n      var callback, callbacks, i, _i, _len;\n      if (!this._callbacks || arguments.length === 0) {\n        this._callbacks = {};\n        return this;\n      }\n      callbacks = this._callbacks[event];\n      if (!callbacks) {\n        return this;\n      }\n      if (arguments.length === 1) {\n        delete this._callbacks[event];\n        return this;\n      }\n      for (i = _i = 0, _len = callbacks.length; _i < _len; i = ++_i) {\n        callback = callbacks[i];\n        if (callback === fn) {\n          callbacks.splice(i, 1);\n          break;\n        }\n      }\n      return this;\n    };\n\n    return Emitter;\n\n  })();\n\n  Dropzone = (function(_super) {\n    var extend, resolveOption;\n\n    __extends(Dropzone, _super);\n\n    Dropzone.prototype.Emitter = Emitter;\n\n\n    /*\n    This is a list of all available events you can register on a dropzone object.\n    \n    You can register an event handler like this:\n    \n        dropzone.on(\"dragEnter\", function() { });\n     */\n\n    Dropzone.prototype.events = [\"drop\", \"dragstart\", \"dragend\", \"dragenter\", \"dragover\", \"dragleave\", \"addedfile\", \"removedfile\", \"thumbnail\", \"error\", \"errormultiple\", \"processing\", \"processingmultiple\", \"uploadprogress\", \"totaluploadprogress\", \"sending\", \"sendingmultiple\", \"success\", \"successmultiple\", \"canceled\", \"canceledmultiple\", \"complete\", \"completemultiple\", \"reset\", \"maxfilesexceeded\", \"maxfilesreached\", \"queuecomplete\"];\n\n    Dropzone.prototype.defaultOptions = {\n      url: null,\n      method: \"post\",\n      withCredentials: false,\n      parallelUploads: 2,\n      uploadMultiple: false,\n      maxFilesize: 256,\n      paramName: \"file\",\n      createImageThumbnails: true,\n      maxThumbnailFilesize: 10,\n      thumbnailWidth: 120,\n      thumbnailHeight: 120,\n      filesizeBase: 1000,\n      maxFiles: null,\n      filesizeBase: 1000,\n      params: {},\n      clickable: true,\n      ignoreHiddenFiles: true,\n      acceptedFiles: null,\n      acceptedMimeTypes: null,\n      autoProcessQueue: true,\n      autoQueue: true,\n      addRemoveLinks: false,\n      previewsContainer: null,\n      capture: null,\n      dictDefaultMessage: \"Drop files here to upload\",\n      dictFallbackMessage: \"Your browser does not support drag'n'drop file uploads.\",\n      dictFallbackText: \"Please use the fallback form below to upload your files like in the olden days.\",\n      dictFileTooBig: \"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.\",\n      dictInvalidFileType: \"You can't upload files of this type.\",\n      dictResponseError: \"Server responded with {{statusCode}} code.\",\n      dictCancelUpload: \"Cancel upload\",\n      dictCancelUploadConfirmation: \"Are you sure you want to cancel this upload?\",\n      dictRemoveFile: \"Remove file\",\n      dictRemoveFileConfirmation: null,\n      dictMaxFilesExceeded: \"You can not upload any more files.\",\n      accept: function(file, done) {\n        return done();\n      },\n      init: function() {\n        return noop;\n      },\n      forceFallback: false,\n      fallback: function() {\n        var child, messageElement, span, _i, _len, _ref;\n        this.element.className = \"\" + this.element.className + \" dz-browser-not-supported\";\n        _ref = this.element.getElementsByTagName(\"div\");\n        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n          child = _ref[_i];\n          if (/(^| )dz-message($| )/.test(child.className)) {\n            messageElement = child;\n            child.className = \"dz-message\";\n            continue;\n          }\n        }\n        if (!messageElement) {\n          messageElement = Dropzone.createElement(\"<div class=\\\"dz-message\\\"><span></span></div>\");\n          this.element.appendChild(messageElement);\n        }\n        span = messageElement.getElementsByTagName(\"span\")[0];\n        if (span) {\n          span.textContent = this.options.dictFallbackMessage;\n        }\n        return this.element.appendChild(this.getFallbackForm());\n      },\n      resize: function(file) {\n        var info, srcRatio, trgRatio;\n        info = {\n          srcX: 0,\n          srcY: 0,\n          srcWidth: file.width,\n          srcHeight: file.height\n        };\n        srcRatio = file.width / file.height;\n        info.optWidth = this.options.thumbnailWidth;\n        info.optHeight = this.options.thumbnailHeight;\n        if ((info.optWidth == null) && (info.optHeight == null)) {\n          info.optWidth = info.srcWidth;\n          info.optHeight = info.srcHeight;\n        } else if (info.optWidth == null) {\n          info.optWidth = srcRatio * info.optHeight;\n        } else if (info.optHeight == null) {\n          info.optHeight = (1 / srcRatio) * info.optWidth;\n        }\n        trgRatio = info.optWidth / info.optHeight;\n        if (file.height < info.optHeight || file.width < info.optWidth) {\n          info.trgHeight = info.srcHeight;\n          info.trgWidth = info.srcWidth;\n        } else {\n          if (srcRatio > trgRatio) {\n            info.srcHeight = file.height;\n            info.srcWidth = info.srcHeight * trgRatio;\n          } else {\n            info.srcWidth = file.width;\n            info.srcHeight = info.srcWidth / trgRatio;\n          }\n        }\n        info.srcX = (file.width - info.srcWidth) / 2;\n        info.srcY = (file.height - info.srcHeight) / 2;\n        return info;\n      },\n\n      /*\n      Those functions register themselves to the events on init and handle all\n      the user interface specific stuff. Overwriting them won't break the upload\n      but can break the way it's displayed.\n      You can overwrite them if you don't like the default behavior. If you just\n      want to add an additional event handler, register it on the dropzone object\n      and don't overwrite those options.\n       */\n      drop: function(e) {\n        return this.element.classList.remove(\"dz-drag-hover\");\n      },\n      dragstart: noop,\n      dragend: function(e) {\n        return this.element.classList.remove(\"dz-drag-hover\");\n      },\n      dragenter: function(e) {\n        return this.element.classList.add(\"dz-drag-hover\");\n      },\n      dragover: function(e) {\n        return this.element.classList.add(\"dz-drag-hover\");\n      },\n      dragleave: function(e) {\n        return this.element.classList.remove(\"dz-drag-hover\");\n      },\n      paste: noop,\n      reset: function() {\n        return this.element.classList.remove(\"dz-started\");\n      },\n      addedfile: function(file) {\n        var node, removeFileEvent, removeLink, _i, _j, _k, _len, _len1, _len2, _ref, _ref1, _ref2, _results;\n        if (this.element === this.previewsContainer) {\n          this.element.classList.add(\"dz-started\");\n        }\n        if (this.previewsContainer) {\n          file.previewElement = Dropzone.createElement(this.options.previewTemplate.trim());\n          file.previewTemplate = file.previewElement;\n          this.previewsContainer.appendChild(file.previewElement);\n          _ref = file.previewElement.querySelectorAll(\"[data-dz-name]\");\n          for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n            node = _ref[_i];\n            node.textContent = file.name;\n          }\n          _ref1 = file.previewElement.querySelectorAll(\"[data-dz-size]\");\n          for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {\n            node = _ref1[_j];\n            node.innerHTML = this.filesize(file.size);\n          }\n          if (this.options.addRemoveLinks) {\n            file._removeLink = Dropzone.createElement(\"<a class=\\\"dz-remove\\\" href=\\\"javascript:undefined;\\\" data-dz-remove>\" + this.options.dictRemoveFile + \"</a>\");\n            file.previewElement.appendChild(file._removeLink);\n          }\n          removeFileEvent = (function(_this) {\n            return function(e) {\n              e.preventDefault();\n              e.stopPropagation();\n              if (file.status === Dropzone.UPLOADING) {\n                return Dropzone.confirm(_this.options.dictCancelUploadConfirmation, function() {\n                  return _this.removeFile(file);\n                });\n              } else {\n                if (_this.options.dictRemoveFileConfirmation) {\n                  return Dropzone.confirm(_this.options.dictRemoveFileConfirmation, function() {\n                    return _this.removeFile(file);\n                  });\n                } else {\n                  return _this.removeFile(file);\n                }\n              }\n            };\n          })(this);\n          _ref2 = file.previewElement.querySelectorAll(\"[data-dz-remove]\");\n          _results = [];\n          for (_k = 0, _len2 = _ref2.length; _k < _len2; _k++) {\n            removeLink = _ref2[_k];\n            _results.push(removeLink.addEventListener(\"click\", removeFileEvent));\n          }\n          return _results;\n        }\n      },\n      removedfile: function(file) {\n        var _ref;\n        if (file.previewElement) {\n          if ((_ref = file.previewElement) != null) {\n            _ref.parentNode.removeChild(file.previewElement);\n          }\n        }\n        return this._updateMaxFilesReachedClass();\n      },\n      thumbnail: function(file, dataUrl) {\n        var thumbnailElement, _i, _len, _ref;\n        if (file.previewElement) {\n          file.previewElement.classList.remove(\"dz-file-preview\");\n          _ref = file.previewElement.querySelectorAll(\"[data-dz-thumbnail]\");\n          for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n            thumbnailElement = _ref[_i];\n            thumbnailElement.alt = file.name;\n            thumbnailElement.src = dataUrl;\n          }\n          return setTimeout(((function(_this) {\n            return function() {\n              return file.previewElement.classList.add(\"dz-image-preview\");\n            };\n          })(this)), 1);\n        }\n      },\n      error: function(file, message) {\n        var node, _i, _len, _ref, _results;\n        if (file.previewElement) {\n          file.previewElement.classList.add(\"dz-error\");\n          if (typeof message !== \"String\" && message.error) {\n            message = message.error;\n          }\n          _ref = file.previewElement.querySelectorAll(\"[data-dz-errormessage]\");\n          _results = [];\n          for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n            node = _ref[_i];\n            _results.push(node.textContent = message);\n          }\n          return _results;\n        }\n      },\n      errormultiple: noop,\n      processing: function(file) {\n        if (file.previewElement) {\n          file.previewElement.classList.add(\"dz-processing\");\n          if (file._removeLink) {\n            return file._removeLink.textContent = this.options.dictCancelUpload;\n          }\n        }\n      },\n      processingmultiple: noop,\n      uploadprogress: function(file, progress, bytesSent) {\n        var node, _i, _len, _ref, _results;\n        if (file.previewElement) {\n          _ref = file.previewElement.querySelectorAll(\"[data-dz-uploadprogress]\");\n          _results = [];\n          for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n            node = _ref[_i];\n            if (node.nodeName === 'PROGRESS') {\n              _results.push(node.value = progress);\n            } else {\n              _results.push(node.style.width = \"\" + progress + \"%\");\n            }\n          }\n          return _results;\n        }\n      },\n      totaluploadprogress: noop,\n      sending: noop,\n      sendingmultiple: noop,\n      success: function(file) {\n        if (file.previewElement) {\n          return file.previewElement.classList.add(\"dz-success\");\n        }\n      },\n      successmultiple: noop,\n      canceled: function(file) {\n        return this.emit(\"error\", file, \"Upload canceled.\");\n      },\n      canceledmultiple: noop,\n      complete: function(file) {\n        if (file._removeLink) {\n          file._removeLink.textContent = this.options.dictRemoveFile;\n        }\n        if (file.previewElement) {\n          return file.previewElement.classList.add(\"dz-complete\");\n        }\n      },\n      completemultiple: noop,\n      maxfilesexceeded: noop,\n      maxfilesreached: noop,\n      queuecomplete: noop,\n      previewTemplate: \"<div class=\\\"dz-preview dz-file-preview\\\">\\n  <div class=\\\"dz-image\\\"><img data-dz-thumbnail /></div>\\n  <div class=\\\"dz-details\\\">\\n    <div class=\\\"dz-size\\\"><span data-dz-size></span></div>\\n    <div class=\\\"dz-filename\\\"><span data-dz-name></span></div>\\n  </div>\\n  <div class=\\\"dz-progress\\\"><span class=\\\"dz-upload\\\" data-dz-uploadprogress></span></div>\\n  <div class=\\\"dz-error-message\\\"><span data-dz-errormessage></span></div>\\n  <div class=\\\"dz-success-mark\\\">\\n    <svg width=\\\"54px\\\" height=\\\"54px\\\" viewBox=\\\"0 0 54 54\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" xmlns:sketch=\\\"http://www.bohemiancoding.com/sketch/ns\\\">\\n      <title>Check</title>\\n      <defs></defs>\\n      <g id=\\\"Page-1\\\" stroke=\\\"none\\\" stroke-width=\\\"1\\\" fill=\\\"none\\\" fill-rule=\\\"evenodd\\\" sketch:type=\\\"MSPage\\\">\\n        <path d=\\\"M23.5,31.8431458 L17.5852419,25.9283877 C16.0248253,24.3679711 13.4910294,24.366835 11.9289322,25.9289322 C10.3700136,27.4878508 10.3665912,30.0234455 11.9283877,31.5852419 L20.4147581,40.0716123 C20.5133999,40.1702541 20.6159315,40.2626649 20.7218615,40.3488435 C22.2835669,41.8725651 24.794234,41.8626202 26.3461564,40.3106978 L43.3106978,23.3461564 C44.8771021,21.7797521 44.8758057,19.2483887 43.3137085,17.6862915 C41.7547899,16.1273729 39.2176035,16.1255422 37.6538436,17.6893022 L23.5,31.8431458 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z\\\" id=\\\"Oval-2\\\" stroke-opacity=\\\"0.198794158\\\" stroke=\\\"#747474\\\" fill-opacity=\\\"0.816519475\\\" fill=\\\"#FFFFFF\\\" sketch:type=\\\"MSShapeGroup\\\"></path>\\n      </g>\\n    </svg>\\n  </div>\\n  <div class=\\\"dz-error-mark\\\">\\n    <svg width=\\\"54px\\\" height=\\\"54px\\\" viewBox=\\\"0 0 54 54\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" xmlns:sketch=\\\"http://www.bohemiancoding.com/sketch/ns\\\">\\n      <title>Error</title>\\n      <defs></defs>\\n      <g id=\\\"Page-1\\\" stroke=\\\"none\\\" stroke-width=\\\"1\\\" fill=\\\"none\\\" fill-rule=\\\"evenodd\\\" sketch:type=\\\"MSPage\\\">\\n        <g id=\\\"Check-+-Oval-2\\\" sketch:type=\\\"MSLayerGroup\\\" stroke=\\\"#747474\\\" stroke-opacity=\\\"0.198794158\\\" fill=\\\"#FFFFFF\\\" fill-opacity=\\\"0.816519475\\\">\\n          <path d=\\\"M32.6568542,29 L38.3106978,23.3461564 C39.8771021,21.7797521 39.8758057,19.2483887 38.3137085,17.6862915 C36.7547899,16.1273729 34.2176035,16.1255422 32.6538436,17.6893022 L27,23.3431458 L21.3461564,17.6893022 C19.7823965,16.1255422 17.2452101,16.1273729 15.6862915,17.6862915 C14.1241943,19.2483887 14.1228979,21.7797521 15.6893022,23.3461564 L21.3431458,29 L15.6893022,34.6538436 C14.1228979,36.2202479 14.1241943,38.7516113 15.6862915,40.3137085 C17.2452101,41.8726271 19.7823965,41.8744578 21.3461564,40.3106978 L27,34.6568542 L32.6538436,40.3106978 C34.2176035,41.8744578 36.7547899,41.8726271 38.3137085,40.3137085 C39.8758057,38.7516113 39.8771021,36.2202479 38.3106978,34.6538436 L32.6568542,29 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z\\\" id=\\\"Oval-2\\\" sketch:type=\\\"MSShapeGroup\\\"></path>\\n        </g>\\n      </g>\\n    </svg>\\n  </div>\\n</div>\"\n    };\n\n    extend = function() {\n      var key, object, objects, target, val, _i, _len;\n      target = arguments[0], objects = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n      for (_i = 0, _len = objects.length; _i < _len; _i++) {\n        object = objects[_i];\n        for (key in object) {\n          val = object[key];\n          target[key] = val;\n        }\n      }\n      return target;\n    };\n\n    function Dropzone(element, options) {\n      var elementOptions, fallback, _ref;\n      this.element = element;\n      this.version = Dropzone.version;\n      this.defaultOptions.previewTemplate = this.defaultOptions.previewTemplate.replace(/\\n*/g, \"\");\n      this.clickableElements = [];\n      this.listeners = [];\n      this.files = [];\n      if (typeof this.element === \"string\") {\n        this.element = document.querySelector(this.element);\n      }\n      if (!(this.element && (this.element.nodeType != null))) {\n        throw new Error(\"Invalid dropzone element.\");\n      }\n      if (this.element.dropzone) {\n        throw new Error(\"Dropzone already attached.\");\n      }\n      Dropzone.instances.push(this);\n      this.element.dropzone = this;\n      elementOptions = (_ref = Dropzone.optionsForElement(this.element)) != null ? _ref : {};\n      this.options = extend({}, this.defaultOptions, elementOptions, options != null ? options : {});\n      if (this.options.forceFallback || !Dropzone.isBrowserSupported()) {\n        return this.options.fallback.call(this);\n      }\n      if (this.options.url == null) {\n        this.options.url = this.element.getAttribute(\"action\");\n      }\n      if (!this.options.url) {\n        throw new Error(\"No URL provided.\");\n      }\n      if (this.options.acceptedFiles && this.options.acceptedMimeTypes) {\n        throw new Error(\"You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.\");\n      }\n      if (this.options.acceptedMimeTypes) {\n        this.options.acceptedFiles = this.options.acceptedMimeTypes;\n        delete this.options.acceptedMimeTypes;\n      }\n      this.options.method = this.options.method.toUpperCase();\n      if ((fallback = this.getExistingFallback()) && fallback.parentNode) {\n        fallback.parentNode.removeChild(fallback);\n      }\n      if (this.options.previewsContainer !== false) {\n        if (this.options.previewsContainer) {\n          this.previewsContainer = Dropzone.getElement(this.options.previewsContainer, \"previewsContainer\");\n        } else {\n          this.previewsContainer = this.element;\n        }\n      }\n      if (this.options.clickable) {\n        if (this.options.clickable === true) {\n          this.clickableElements = [this.element];\n        } else {\n          this.clickableElements = Dropzone.getElements(this.options.clickable, \"clickable\");\n        }\n      }\n      this.init();\n    }\n\n    Dropzone.prototype.getAcceptedFiles = function() {\n      var file, _i, _len, _ref, _results;\n      _ref = this.files;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        file = _ref[_i];\n        if (file.accepted) {\n          _results.push(file);\n        }\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.getRejectedFiles = function() {\n      var file, _i, _len, _ref, _results;\n      _ref = this.files;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        file = _ref[_i];\n        if (!file.accepted) {\n          _results.push(file);\n        }\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.getFilesWithStatus = function(status) {\n      var file, _i, _len, _ref, _results;\n      _ref = this.files;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        file = _ref[_i];\n        if (file.status === status) {\n          _results.push(file);\n        }\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.getQueuedFiles = function() {\n      return this.getFilesWithStatus(Dropzone.QUEUED);\n    };\n\n    Dropzone.prototype.getUploadingFiles = function() {\n      return this.getFilesWithStatus(Dropzone.UPLOADING);\n    };\n\n    Dropzone.prototype.getActiveFiles = function() {\n      var file, _i, _len, _ref, _results;\n      _ref = this.files;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        file = _ref[_i];\n        if (file.status === Dropzone.UPLOADING || file.status === Dropzone.QUEUED) {\n          _results.push(file);\n        }\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.init = function() {\n      var eventName, noPropagation, setupHiddenFileInput, _i, _len, _ref, _ref1;\n      if (this.element.tagName === \"form\") {\n        this.element.setAttribute(\"enctype\", \"multipart/form-data\");\n      }\n      if (this.element.classList.contains(\"dropzone\") && !this.element.querySelector(\".dz-message\")) {\n        this.element.appendChild(Dropzone.createElement(\"<div class=\\\"dz-default dz-message\\\"><span>\" + this.options.dictDefaultMessage + \"</span></div>\"));\n      }\n      if (this.clickableElements.length) {\n        setupHiddenFileInput = (function(_this) {\n          return function() {\n            if (_this.hiddenFileInput) {\n              document.body.removeChild(_this.hiddenFileInput);\n            }\n            _this.hiddenFileInput = document.createElement(\"input\");\n            _this.hiddenFileInput.setAttribute(\"type\", \"file\");\n            if ((_this.options.maxFiles == null) || _this.options.maxFiles > 1) {\n              _this.hiddenFileInput.setAttribute(\"multiple\", \"multiple\");\n            }\n            _this.hiddenFileInput.className = \"dz-hidden-input\";\n            if (_this.options.acceptedFiles != null) {\n              _this.hiddenFileInput.setAttribute(\"accept\", _this.options.acceptedFiles);\n            }\n            if (_this.options.capture != null) {\n              _this.hiddenFileInput.setAttribute(\"capture\", _this.options.capture);\n            }\n            _this.hiddenFileInput.style.visibility = \"hidden\";\n            _this.hiddenFileInput.style.position = \"absolute\";\n            _this.hiddenFileInput.style.top = \"0\";\n            _this.hiddenFileInput.style.left = \"0\";\n            _this.hiddenFileInput.style.height = \"0\";\n            _this.hiddenFileInput.style.width = \"0\";\n            document.body.appendChild(_this.hiddenFileInput);\n            return _this.hiddenFileInput.addEventListener(\"change\", function() {\n              var file, files, _i, _len;\n              files = _this.hiddenFileInput.files;\n              if (files.length) {\n                for (_i = 0, _len = files.length; _i < _len; _i++) {\n                  file = files[_i];\n                  _this.addFile(file);\n                }\n              }\n              return setupHiddenFileInput();\n            });\n          };\n        })(this);\n        setupHiddenFileInput();\n      }\n      this.URL = (_ref = window.URL) != null ? _ref : window.webkitURL;\n      _ref1 = this.events;\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        eventName = _ref1[_i];\n        this.on(eventName, this.options[eventName]);\n      }\n      this.on(\"uploadprogress\", (function(_this) {\n        return function() {\n          return _this.updateTotalUploadProgress();\n        };\n      })(this));\n      this.on(\"removedfile\", (function(_this) {\n        return function() {\n          return _this.updateTotalUploadProgress();\n        };\n      })(this));\n      this.on(\"canceled\", (function(_this) {\n        return function(file) {\n          return _this.emit(\"complete\", file);\n        };\n      })(this));\n      this.on(\"complete\", (function(_this) {\n        return function(file) {\n          if (_this.getUploadingFiles().length === 0 && _this.getQueuedFiles().length === 0) {\n            return setTimeout((function() {\n              return _this.emit(\"queuecomplete\");\n            }), 0);\n          }\n        };\n      })(this));\n      noPropagation = function(e) {\n        e.stopPropagation();\n        if (e.preventDefault) {\n          return e.preventDefault();\n        } else {\n          return e.returnValue = false;\n        }\n      };\n      this.listeners = [\n        {\n          element: this.element,\n          events: {\n            \"dragstart\": (function(_this) {\n              return function(e) {\n                return _this.emit(\"dragstart\", e);\n              };\n            })(this),\n            \"dragenter\": (function(_this) {\n              return function(e) {\n                noPropagation(e);\n                return _this.emit(\"dragenter\", e);\n              };\n            })(this),\n            \"dragover\": (function(_this) {\n              return function(e) {\n                var efct;\n                try {\n                  efct = e.dataTransfer.effectAllowed;\n                } catch (_error) {}\n                e.dataTransfer.dropEffect = 'move' === efct || 'linkMove' === efct ? 'move' : 'copy';\n                noPropagation(e);\n                return _this.emit(\"dragover\", e);\n              };\n            })(this),\n            \"dragleave\": (function(_this) {\n              return function(e) {\n                return _this.emit(\"dragleave\", e);\n              };\n            })(this),\n            \"drop\": (function(_this) {\n              return function(e) {\n                noPropagation(e);\n                return _this.drop(e);\n              };\n            })(this),\n            \"dragend\": (function(_this) {\n              return function(e) {\n                return _this.emit(\"dragend\", e);\n              };\n            })(this)\n          }\n        }\n      ];\n      this.clickableElements.forEach((function(_this) {\n        return function(clickableElement) {\n          return _this.listeners.push({\n            element: clickableElement,\n            events: {\n              \"click\": function(evt) {\n                if ((clickableElement !== _this.element) || (evt.target === _this.element || Dropzone.elementInside(evt.target, _this.element.querySelector(\".dz-message\")))) {\n                  return _this.hiddenFileInput.click();\n                }\n              }\n            }\n          });\n        };\n      })(this));\n      this.enable();\n      return this.options.init.call(this);\n    };\n\n    Dropzone.prototype.destroy = function() {\n      var _ref;\n      this.disable();\n      this.removeAllFiles(true);\n      if ((_ref = this.hiddenFileInput) != null ? _ref.parentNode : void 0) {\n        this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput);\n        this.hiddenFileInput = null;\n      }\n      delete this.element.dropzone;\n      return Dropzone.instances.splice(Dropzone.instances.indexOf(this), 1);\n    };\n\n    Dropzone.prototype.updateTotalUploadProgress = function() {\n      var activeFiles, file, totalBytes, totalBytesSent, totalUploadProgress, _i, _len, _ref;\n      totalBytesSent = 0;\n      totalBytes = 0;\n      activeFiles = this.getActiveFiles();\n      if (activeFiles.length) {\n        _ref = this.getActiveFiles();\n        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n          file = _ref[_i];\n          totalBytesSent += file.upload.bytesSent;\n          totalBytes += file.upload.total;\n        }\n        totalUploadProgress = 100 * totalBytesSent / totalBytes;\n      } else {\n        totalUploadProgress = 100;\n      }\n      return this.emit(\"totaluploadprogress\", totalUploadProgress, totalBytes, totalBytesSent);\n    };\n\n    Dropzone.prototype._getParamName = function(n) {\n      if (typeof this.options.paramName === \"function\") {\n        return this.options.paramName(n);\n      } else {\n        return \"\" + this.options.paramName + (this.options.uploadMultiple ? \"[\" + n + \"]\" : \"\");\n      }\n    };\n\n    Dropzone.prototype.getFallbackForm = function() {\n      var existingFallback, fields, fieldsString, form;\n      if (existingFallback = this.getExistingFallback()) {\n        return existingFallback;\n      }\n      fieldsString = \"<div class=\\\"dz-fallback\\\">\";\n      if (this.options.dictFallbackText) {\n        fieldsString += \"<p>\" + this.options.dictFallbackText + \"</p>\";\n      }\n      fieldsString += \"<input type=\\\"file\\\" name=\\\"\" + (this._getParamName(0)) + \"\\\" \" + (this.options.uploadMultiple ? 'multiple=\"multiple\"' : void 0) + \" /><input type=\\\"submit\\\" value=\\\"Upload!\\\"></div>\";\n      fields = Dropzone.createElement(fieldsString);\n      if (this.element.tagName !== \"FORM\") {\n        form = Dropzone.createElement(\"<form action=\\\"\" + this.options.url + \"\\\" enctype=\\\"multipart/form-data\\\" method=\\\"\" + this.options.method + \"\\\"></form>\");\n        form.appendChild(fields);\n      } else {\n        this.element.setAttribute(\"enctype\", \"multipart/form-data\");\n        this.element.setAttribute(\"method\", this.options.method);\n      }\n      return form != null ? form : fields;\n    };\n\n    Dropzone.prototype.getExistingFallback = function() {\n      var fallback, getFallback, tagName, _i, _len, _ref;\n      getFallback = function(elements) {\n        var el, _i, _len;\n        for (_i = 0, _len = elements.length; _i < _len; _i++) {\n          el = elements[_i];\n          if (/(^| )fallback($| )/.test(el.className)) {\n            return el;\n          }\n        }\n      };\n      _ref = [\"div\", \"form\"];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        tagName = _ref[_i];\n        if (fallback = getFallback(this.element.getElementsByTagName(tagName))) {\n          return fallback;\n        }\n      }\n    };\n\n    Dropzone.prototype.setupEventListeners = function() {\n      var elementListeners, event, listener, _i, _len, _ref, _results;\n      _ref = this.listeners;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        elementListeners = _ref[_i];\n        _results.push((function() {\n          var _ref1, _results1;\n          _ref1 = elementListeners.events;\n          _results1 = [];\n          for (event in _ref1) {\n            listener = _ref1[event];\n            _results1.push(elementListeners.element.addEventListener(event, listener, false));\n          }\n          return _results1;\n        })());\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.removeEventListeners = function() {\n      var elementListeners, event, listener, _i, _len, _ref, _results;\n      _ref = this.listeners;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        elementListeners = _ref[_i];\n        _results.push((function() {\n          var _ref1, _results1;\n          _ref1 = elementListeners.events;\n          _results1 = [];\n          for (event in _ref1) {\n            listener = _ref1[event];\n            _results1.push(elementListeners.element.removeEventListener(event, listener, false));\n          }\n          return _results1;\n        })());\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.disable = function() {\n      var file, _i, _len, _ref, _results;\n      this.clickableElements.forEach(function(element) {\n        return element.classList.remove(\"dz-clickable\");\n      });\n      this.removeEventListeners();\n      _ref = this.files;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        file = _ref[_i];\n        _results.push(this.cancelUpload(file));\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.enable = function() {\n      this.clickableElements.forEach(function(element) {\n        return element.classList.add(\"dz-clickable\");\n      });\n      return this.setupEventListeners();\n    };\n\n    Dropzone.prototype.filesize = function(size) {\n      var cutoff, i, selectedSize, selectedUnit, unit, units, _i, _len;\n      units = ['TB', 'GB', 'MB', 'KB', 'b'];\n      selectedSize = selectedUnit = null;\n      for (i = _i = 0, _len = units.length; _i < _len; i = ++_i) {\n        unit = units[i];\n        cutoff = Math.pow(this.options.filesizeBase, 4 - i) / 10;\n        if (size >= cutoff) {\n          selectedSize = size / Math.pow(this.options.filesizeBase, 4 - i);\n          selectedUnit = unit;\n          break;\n        }\n      }\n      selectedSize = Math.round(10 * selectedSize) / 10;\n      return \"<strong>\" + selectedSize + \"</strong> \" + selectedUnit;\n    };\n\n    Dropzone.prototype._updateMaxFilesReachedClass = function() {\n      if ((this.options.maxFiles != null) && this.getAcceptedFiles().length >= this.options.maxFiles) {\n        if (this.getAcceptedFiles().length === this.options.maxFiles) {\n          this.emit('maxfilesreached', this.files);\n        }\n        return this.element.classList.add(\"dz-max-files-reached\");\n      } else {\n        return this.element.classList.remove(\"dz-max-files-reached\");\n      }\n    };\n\n    Dropzone.prototype.drop = function(e) {\n      var files, items;\n      if (!e.dataTransfer) {\n        return;\n      }\n      this.emit(\"drop\", e);\n      files = e.dataTransfer.files;\n      if (files.length) {\n        items = e.dataTransfer.items;\n        if (items && items.length && (items[0].webkitGetAsEntry != null)) {\n          this._addFilesFromItems(items);\n        } else {\n          this.handleFiles(files);\n        }\n      }\n    };\n\n    Dropzone.prototype.paste = function(e) {\n      var items, _ref;\n      if ((e != null ? (_ref = e.clipboardData) != null ? _ref.items : void 0 : void 0) == null) {\n        return;\n      }\n      this.emit(\"paste\", e);\n      items = e.clipboardData.items;\n      if (items.length) {\n        return this._addFilesFromItems(items);\n      }\n    };\n\n    Dropzone.prototype.handleFiles = function(files) {\n      var file, _i, _len, _results;\n      _results = [];\n      for (_i = 0, _len = files.length; _i < _len; _i++) {\n        file = files[_i];\n        _results.push(this.addFile(file));\n      }\n      return _results;\n    };\n\n    Dropzone.prototype._addFilesFromItems = function(items) {\n      var entry, item, _i, _len, _results;\n      _results = [];\n      for (_i = 0, _len = items.length; _i < _len; _i++) {\n        item = items[_i];\n        if ((item.webkitGetAsEntry != null) && (entry = item.webkitGetAsEntry())) {\n          if (entry.isFile) {\n            _results.push(this.addFile(item.getAsFile()));\n          } else if (entry.isDirectory) {\n            _results.push(this._addFilesFromDirectory(entry, entry.name));\n          } else {\n            _results.push(void 0);\n          }\n        } else if (item.getAsFile != null) {\n          if ((item.kind == null) || item.kind === \"file\") {\n            _results.push(this.addFile(item.getAsFile()));\n          } else {\n            _results.push(void 0);\n          }\n        } else {\n          _results.push(void 0);\n        }\n      }\n      return _results;\n    };\n\n    Dropzone.prototype._addFilesFromDirectory = function(directory, path) {\n      var dirReader, entriesReader;\n      dirReader = directory.createReader();\n      entriesReader = (function(_this) {\n        return function(entries) {\n          var entry, _i, _len;\n          for (_i = 0, _len = entries.length; _i < _len; _i++) {\n            entry = entries[_i];\n            if (entry.isFile) {\n              entry.file(function(file) {\n                if (_this.options.ignoreHiddenFiles && file.name.substring(0, 1) === '.') {\n                  return;\n                }\n                file.fullPath = \"\" + path + \"/\" + file.name;\n                return _this.addFile(file);\n              });\n            } else if (entry.isDirectory) {\n              _this._addFilesFromDirectory(entry, \"\" + path + \"/\" + entry.name);\n            }\n          }\n        };\n      })(this);\n      return dirReader.readEntries(entriesReader, function(error) {\n        return typeof console !== \"undefined\" && console !== null ? typeof console.log === \"function\" ? console.log(error) : void 0 : void 0;\n      });\n    };\n\n    Dropzone.prototype.accept = function(file, done) {\n      if (file.size > this.options.maxFilesize * 1024 * 1024) {\n        return done(this.options.dictFileTooBig.replace(\"{{filesize}}\", Math.round(file.size / 1024 / 10.24) / 100).replace(\"{{maxFilesize}}\", this.options.maxFilesize));\n      } else if (!Dropzone.isValidFile(file, this.options.acceptedFiles)) {\n        return done(this.options.dictInvalidFileType);\n      } else if ((this.options.maxFiles != null) && this.getAcceptedFiles().length >= this.options.maxFiles) {\n        done(this.options.dictMaxFilesExceeded.replace(\"{{maxFiles}}\", this.options.maxFiles));\n        return this.emit(\"maxfilesexceeded\", file);\n      } else {\n        return this.options.accept.call(this, file, done);\n      }\n    };\n\n    Dropzone.prototype.addFile = function(file) {\n      file.upload = {\n        progress: 0,\n        total: file.size,\n        bytesSent: 0\n      };\n      this.files.push(file);\n      file.status = Dropzone.ADDED;\n      this.emit(\"addedfile\", file);\n      this._enqueueThumbnail(file);\n      return this.accept(file, (function(_this) {\n        return function(error) {\n          if (error) {\n            file.accepted = false;\n            _this._errorProcessing([file], error);\n          } else {\n            file.accepted = true;\n            if (_this.options.autoQueue) {\n              _this.enqueueFile(file);\n            }\n          }\n          return _this._updateMaxFilesReachedClass();\n        };\n      })(this));\n    };\n\n    Dropzone.prototype.enqueueFiles = function(files) {\n      var file, _i, _len;\n      for (_i = 0, _len = files.length; _i < _len; _i++) {\n        file = files[_i];\n        this.enqueueFile(file);\n      }\n      return null;\n    };\n\n    Dropzone.prototype.enqueueFile = function(file) {\n      if (file.status === Dropzone.ADDED && file.accepted === true) {\n        file.status = Dropzone.QUEUED;\n        if (this.options.autoProcessQueue) {\n          return setTimeout(((function(_this) {\n            return function() {\n              return _this.processQueue();\n            };\n          })(this)), 0);\n        }\n      } else {\n        throw new Error(\"This file can't be queued because it has already been processed or was rejected.\");\n      }\n    };\n\n    Dropzone.prototype._thumbnailQueue = [];\n\n    Dropzone.prototype._processingThumbnail = false;\n\n    Dropzone.prototype._enqueueThumbnail = function(file) {\n      if (this.options.createImageThumbnails && file.type.match(/image.*/) && file.size <= this.options.maxThumbnailFilesize * 1024 * 1024) {\n        this._thumbnailQueue.push(file);\n        return setTimeout(((function(_this) {\n          return function() {\n            return _this._processThumbnailQueue();\n          };\n        })(this)), 0);\n      }\n    };\n\n    Dropzone.prototype._processThumbnailQueue = function() {\n      if (this._processingThumbnail || this._thumbnailQueue.length === 0) {\n        return;\n      }\n      this._processingThumbnail = true;\n      return this.createThumbnail(this._thumbnailQueue.shift(), (function(_this) {\n        return function() {\n          _this._processingThumbnail = false;\n          return _this._processThumbnailQueue();\n        };\n      })(this));\n    };\n\n    Dropzone.prototype.removeFile = function(file) {\n      if (file.status === Dropzone.UPLOADING) {\n        this.cancelUpload(file);\n      }\n      this.files = without(this.files, file);\n      this.emit(\"removedfile\", file);\n      if (this.files.length === 0) {\n        return this.emit(\"reset\");\n      }\n    };\n\n    Dropzone.prototype.removeAllFiles = function(cancelIfNecessary) {\n      var file, _i, _len, _ref;\n      if (cancelIfNecessary == null) {\n        cancelIfNecessary = false;\n      }\n      _ref = this.files.slice();\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        file = _ref[_i];\n        if (file.status !== Dropzone.UPLOADING || cancelIfNecessary) {\n          this.removeFile(file);\n        }\n      }\n      return null;\n    };\n\n    Dropzone.prototype.createThumbnail = function(file, callback) {\n      var fileReader;\n      fileReader = new FileReader;\n      fileReader.onload = (function(_this) {\n        return function() {\n          if (file.type === \"image/svg+xml\") {\n            _this.emit(\"thumbnail\", file, fileReader.result);\n            if (callback != null) {\n              callback();\n            }\n            return;\n          }\n          return _this.createThumbnailFromUrl(file, fileReader.result, callback);\n        };\n      })(this);\n      return fileReader.readAsDataURL(file);\n    };\n\n    Dropzone.prototype.createThumbnailFromUrl = function(file, imageUrl, callback) {\n      var img;\n      img = document.createElement(\"img\");\n      img.onload = (function(_this) {\n        return function() {\n          var canvas, ctx, resizeInfo, thumbnail, _ref, _ref1, _ref2, _ref3;\n          file.width = img.width;\n          file.height = img.height;\n          resizeInfo = _this.options.resize.call(_this, file);\n          if (resizeInfo.trgWidth == null) {\n            resizeInfo.trgWidth = resizeInfo.optWidth;\n          }\n          if (resizeInfo.trgHeight == null) {\n            resizeInfo.trgHeight = resizeInfo.optHeight;\n          }\n          canvas = document.createElement(\"canvas\");\n          ctx = canvas.getContext(\"2d\");\n          canvas.width = resizeInfo.trgWidth;\n          canvas.height = resizeInfo.trgHeight;\n          drawImageIOSFix(ctx, img, (_ref = resizeInfo.srcX) != null ? _ref : 0, (_ref1 = resizeInfo.srcY) != null ? _ref1 : 0, resizeInfo.srcWidth, resizeInfo.srcHeight, (_ref2 = resizeInfo.trgX) != null ? _ref2 : 0, (_ref3 = resizeInfo.trgY) != null ? _ref3 : 0, resizeInfo.trgWidth, resizeInfo.trgHeight);\n          thumbnail = canvas.toDataURL(\"image/png\");\n          _this.emit(\"thumbnail\", file, thumbnail);\n          if (callback != null) {\n            return callback();\n          }\n        };\n      })(this);\n      if (callback != null) {\n        img.onerror = callback;\n      }\n      return img.src = imageUrl;\n    };\n\n    Dropzone.prototype.processQueue = function() {\n      var i, parallelUploads, processingLength, queuedFiles;\n      parallelUploads = this.options.parallelUploads;\n      processingLength = this.getUploadingFiles().length;\n      i = processingLength;\n      if (processingLength >= parallelUploads) {\n        return;\n      }\n      queuedFiles = this.getQueuedFiles();\n      if (!(queuedFiles.length > 0)) {\n        return;\n      }\n      if (this.options.uploadMultiple) {\n        return this.processFiles(queuedFiles.slice(0, parallelUploads - processingLength));\n      } else {\n        while (i < parallelUploads) {\n          if (!queuedFiles.length) {\n            return;\n          }\n          this.processFile(queuedFiles.shift());\n          i++;\n        }\n      }\n    };\n\n    Dropzone.prototype.processFile = function(file) {\n      return this.processFiles([file]);\n    };\n\n    Dropzone.prototype.processFiles = function(files) {\n      var file, _i, _len;\n      for (_i = 0, _len = files.length; _i < _len; _i++) {\n        file = files[_i];\n        file.processing = true;\n        file.status = Dropzone.UPLOADING;\n        this.emit(\"processing\", file);\n      }\n      if (this.options.uploadMultiple) {\n        this.emit(\"processingmultiple\", files);\n      }\n      return this.uploadFiles(files);\n    };\n\n    Dropzone.prototype._getFilesWithXhr = function(xhr) {\n      var file, files;\n      return files = (function() {\n        var _i, _len, _ref, _results;\n        _ref = this.files;\n        _results = [];\n        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n          file = _ref[_i];\n          if (file.xhr === xhr) {\n            _results.push(file);\n          }\n        }\n        return _results;\n      }).call(this);\n    };\n\n    Dropzone.prototype.cancelUpload = function(file) {\n      var groupedFile, groupedFiles, _i, _j, _len, _len1, _ref;\n      if (file.status === Dropzone.UPLOADING) {\n        groupedFiles = this._getFilesWithXhr(file.xhr);\n        for (_i = 0, _len = groupedFiles.length; _i < _len; _i++) {\n          groupedFile = groupedFiles[_i];\n          groupedFile.status = Dropzone.CANCELED;\n        }\n        file.xhr.abort();\n        for (_j = 0, _len1 = groupedFiles.length; _j < _len1; _j++) {\n          groupedFile = groupedFiles[_j];\n          this.emit(\"canceled\", groupedFile);\n        }\n        if (this.options.uploadMultiple) {\n          this.emit(\"canceledmultiple\", groupedFiles);\n        }\n      } else if ((_ref = file.status) === Dropzone.ADDED || _ref === Dropzone.QUEUED) {\n        file.status = Dropzone.CANCELED;\n        this.emit(\"canceled\", file);\n        if (this.options.uploadMultiple) {\n          this.emit(\"canceledmultiple\", [file]);\n        }\n      }\n      if (this.options.autoProcessQueue) {\n        return this.processQueue();\n      }\n    };\n\n    resolveOption = function() {\n      var args, option;\n      option = arguments[0], args = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n      if (typeof option === 'function') {\n        return option.apply(this, args);\n      }\n      return option;\n    };\n\n    Dropzone.prototype.uploadFile = function(file) {\n      return this.uploadFiles([file]);\n    };\n\n    Dropzone.prototype.uploadFiles = function(files) {\n      var file, formData, handleError, headerName, headerValue, headers, i, input, inputName, inputType, key, method, option, progressObj, response, updateProgress, url, value, xhr, _i, _j, _k, _l, _len, _len1, _len2, _len3, _m, _ref, _ref1, _ref2, _ref3, _ref4, _ref5;\n      xhr = new XMLHttpRequest();\n      for (_i = 0, _len = files.length; _i < _len; _i++) {\n        file = files[_i];\n        file.xhr = xhr;\n      }\n      method = resolveOption(this.options.method, files);\n      url = resolveOption(this.options.url, files);\n      xhr.open(method, url, true);\n      xhr.withCredentials = !!this.options.withCredentials;\n      response = null;\n      handleError = (function(_this) {\n        return function() {\n          var _j, _len1, _results;\n          _results = [];\n          for (_j = 0, _len1 = files.length; _j < _len1; _j++) {\n            file = files[_j];\n            _results.push(_this._errorProcessing(files, response || _this.options.dictResponseError.replace(\"{{statusCode}}\", xhr.status), xhr));\n          }\n          return _results;\n        };\n      })(this);\n      updateProgress = (function(_this) {\n        return function(e) {\n          var allFilesFinished, progress, _j, _k, _l, _len1, _len2, _len3, _results;\n          if (e != null) {\n            progress = 100 * e.loaded / e.total;\n            for (_j = 0, _len1 = files.length; _j < _len1; _j++) {\n              file = files[_j];\n              file.upload = {\n                progress: progress,\n                total: e.total,\n                bytesSent: e.loaded\n              };\n            }\n          } else {\n            allFilesFinished = true;\n            progress = 100;\n            for (_k = 0, _len2 = files.length; _k < _len2; _k++) {\n              file = files[_k];\n              if (!(file.upload.progress === 100 && file.upload.bytesSent === file.upload.total)) {\n                allFilesFinished = false;\n              }\n              file.upload.progress = progress;\n              file.upload.bytesSent = file.upload.total;\n            }\n            if (allFilesFinished) {\n              return;\n            }\n          }\n          _results = [];\n          for (_l = 0, _len3 = files.length; _l < _len3; _l++) {\n            file = files[_l];\n            _results.push(_this.emit(\"uploadprogress\", file, progress, file.upload.bytesSent));\n          }\n          return _results;\n        };\n      })(this);\n      xhr.onload = (function(_this) {\n        return function(e) {\n          var _ref;\n          if (files[0].status === Dropzone.CANCELED) {\n            return;\n          }\n          if (xhr.readyState !== 4) {\n            return;\n          }\n          response = xhr.responseText;\n          if (xhr.getResponseHeader(\"content-type\") && ~xhr.getResponseHeader(\"content-type\").indexOf(\"application/json\")) {\n            try {\n              response = JSON.parse(response);\n            } catch (_error) {\n              e = _error;\n              response = \"Invalid JSON response from server.\";\n            }\n          }\n          updateProgress();\n          if (!((200 <= (_ref = xhr.status) && _ref < 300))) {\n            return handleError();\n          } else {\n            return _this._finished(files, response, e);\n          }\n        };\n      })(this);\n      xhr.onerror = (function(_this) {\n        return function() {\n          if (files[0].status === Dropzone.CANCELED) {\n            return;\n          }\n          return handleError();\n        };\n      })(this);\n      progressObj = (_ref = xhr.upload) != null ? _ref : xhr;\n      progressObj.onprogress = updateProgress;\n      headers = {\n        \"Accept\": \"application/json\",\n        \"Cache-Control\": \"no-cache\",\n        \"X-Requested-With\": \"XMLHttpRequest\"\n      };\n      if (this.options.headers) {\n        extend(headers, this.options.headers);\n      }\n      for (headerName in headers) {\n        headerValue = headers[headerName];\n        xhr.setRequestHeader(headerName, headerValue);\n      }\n      formData = new FormData();\n      if (this.options.params) {\n        _ref1 = this.options.params;\n        for (key in _ref1) {\n          value = _ref1[key];\n          formData.append(key, value);\n        }\n      }\n      for (_j = 0, _len1 = files.length; _j < _len1; _j++) {\n        file = files[_j];\n        this.emit(\"sending\", file, xhr, formData);\n      }\n      if (this.options.uploadMultiple) {\n        this.emit(\"sendingmultiple\", files, xhr, formData);\n      }\n      if (this.element.tagName === \"FORM\") {\n        _ref2 = this.element.querySelectorAll(\"input, textarea, select, button\");\n        for (_k = 0, _len2 = _ref2.length; _k < _len2; _k++) {\n          input = _ref2[_k];\n          inputName = input.getAttribute(\"name\");\n          inputType = input.getAttribute(\"type\");\n          if (input.tagName === \"SELECT\" && input.hasAttribute(\"multiple\")) {\n            _ref3 = input.options;\n            for (_l = 0, _len3 = _ref3.length; _l < _len3; _l++) {\n              option = _ref3[_l];\n              if (option.selected) {\n                formData.append(inputName, option.value);\n              }\n            }\n          } else if (!inputType || ((_ref4 = inputType.toLowerCase()) !== \"checkbox\" && _ref4 !== \"radio\") || input.checked) {\n            formData.append(inputName, input.value);\n          }\n        }\n      }\n      for (i = _m = 0, _ref5 = files.length - 1; 0 <= _ref5 ? _m <= _ref5 : _m >= _ref5; i = 0 <= _ref5 ? ++_m : --_m) {\n        formData.append(this._getParamName(i), files[i], files[i].name);\n      }\n      return xhr.send(formData);\n    };\n\n    Dropzone.prototype._finished = function(files, responseText, e) {\n      var file, _i, _len;\n      for (_i = 0, _len = files.length; _i < _len; _i++) {\n        file = files[_i];\n        file.status = Dropzone.SUCCESS;\n        this.emit(\"success\", file, responseText, e);\n        this.emit(\"complete\", file);\n      }\n      if (this.options.uploadMultiple) {\n        this.emit(\"successmultiple\", files, responseText, e);\n        this.emit(\"completemultiple\", files);\n      }\n      if (this.options.autoProcessQueue) {\n        return this.processQueue();\n      }\n    };\n\n    Dropzone.prototype._errorProcessing = function(files, message, xhr) {\n      var file, _i, _len;\n      for (_i = 0, _len = files.length; _i < _len; _i++) {\n        file = files[_i];\n        file.status = Dropzone.ERROR;\n        this.emit(\"error\", file, message, xhr);\n        this.emit(\"complete\", file);\n      }\n      if (this.options.uploadMultiple) {\n        this.emit(\"errormultiple\", files, message, xhr);\n        this.emit(\"completemultiple\", files);\n      }\n      if (this.options.autoProcessQueue) {\n        return this.processQueue();\n      }\n    };\n\n    return Dropzone;\n\n  })(Emitter);\n\n  Dropzone.version = \"4.0.1\";\n\n  Dropzone.options = {};\n\n  Dropzone.optionsForElement = function(element) {\n    if (element.getAttribute(\"id\")) {\n      return Dropzone.options[camelize(element.getAttribute(\"id\"))];\n    } else {\n      return void 0;\n    }\n  };\n\n  Dropzone.instances = [];\n\n  Dropzone.forElement = function(element) {\n    if (typeof element === \"string\") {\n      element = document.querySelector(element);\n    }\n    if ((element != null ? element.dropzone : void 0) == null) {\n      throw new Error(\"No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.\");\n    }\n    return element.dropzone;\n  };\n\n  Dropzone.autoDiscover = true;\n\n  Dropzone.discover = function() {\n    var checkElements, dropzone, dropzones, _i, _len, _results;\n    if (document.querySelectorAll) {\n      dropzones = document.querySelectorAll(\".dropzone\");\n    } else {\n      dropzones = [];\n      checkElements = function(elements) {\n        var el, _i, _len, _results;\n        _results = [];\n        for (_i = 0, _len = elements.length; _i < _len; _i++) {\n          el = elements[_i];\n          if (/(^| )dropzone($| )/.test(el.className)) {\n            _results.push(dropzones.push(el));\n          } else {\n            _results.push(void 0);\n          }\n        }\n        return _results;\n      };\n      checkElements(document.getElementsByTagName(\"div\"));\n      checkElements(document.getElementsByTagName(\"form\"));\n    }\n    _results = [];\n    for (_i = 0, _len = dropzones.length; _i < _len; _i++) {\n      dropzone = dropzones[_i];\n      if (Dropzone.optionsForElement(dropzone) !== false) {\n        _results.push(new Dropzone(dropzone));\n      } else {\n        _results.push(void 0);\n      }\n    }\n    return _results;\n  };\n\n  Dropzone.blacklistedBrowsers = [/opera.*Macintosh.*version\\/12/i];\n\n  Dropzone.isBrowserSupported = function() {\n    var capableBrowser, regex, _i, _len, _ref;\n    capableBrowser = true;\n    if (window.File && window.FileReader && window.FileList && window.Blob && window.FormData && document.querySelector) {\n      if (!(\"classList\" in document.createElement(\"a\"))) {\n        capableBrowser = false;\n      } else {\n        _ref = Dropzone.blacklistedBrowsers;\n        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n          regex = _ref[_i];\n          if (regex.test(navigator.userAgent)) {\n            capableBrowser = false;\n            continue;\n          }\n        }\n      }\n    } else {\n      capableBrowser = false;\n    }\n    return capableBrowser;\n  };\n\n  without = function(list, rejectedItem) {\n    var item, _i, _len, _results;\n    _results = [];\n    for (_i = 0, _len = list.length; _i < _len; _i++) {\n      item = list[_i];\n      if (item !== rejectedItem) {\n        _results.push(item);\n      }\n    }\n    return _results;\n  };\n\n  camelize = function(str) {\n    return str.replace(/[\\-_](\\w)/g, function(match) {\n      return match.charAt(1).toUpperCase();\n    });\n  };\n\n  Dropzone.createElement = function(string) {\n    var div;\n    div = document.createElement(\"div\");\n    div.innerHTML = string;\n    return div.childNodes[0];\n  };\n\n  Dropzone.elementInside = function(element, container) {\n    if (element === container) {\n      return true;\n    }\n    while (element = element.parentNode) {\n      if (element === container) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  Dropzone.getElement = function(el, name) {\n    var element;\n    if (typeof el === \"string\") {\n      element = document.querySelector(el);\n    } else if (el.nodeType != null) {\n      element = el;\n    }\n    if (element == null) {\n      throw new Error(\"Invalid `\" + name + \"` option provided. Please provide a CSS selector or a plain HTML element.\");\n    }\n    return element;\n  };\n\n  Dropzone.getElements = function(els, name) {\n    var e, el, elements, _i, _j, _len, _len1, _ref;\n    if (els instanceof Array) {\n      elements = [];\n      try {\n        for (_i = 0, _len = els.length; _i < _len; _i++) {\n          el = els[_i];\n          elements.push(this.getElement(el, name));\n        }\n      } catch (_error) {\n        e = _error;\n        elements = null;\n      }\n    } else if (typeof els === \"string\") {\n      elements = [];\n      _ref = document.querySelectorAll(els);\n      for (_j = 0, _len1 = _ref.length; _j < _len1; _j++) {\n        el = _ref[_j];\n        elements.push(el);\n      }\n    } else if (els.nodeType != null) {\n      elements = [els];\n    }\n    if (!((elements != null) && elements.length)) {\n      throw new Error(\"Invalid `\" + name + \"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.\");\n    }\n    return elements;\n  };\n\n  Dropzone.confirm = function(question, accepted, rejected) {\n    if (window.confirm(question)) {\n      return accepted();\n    } else if (rejected != null) {\n      return rejected();\n    }\n  };\n\n  Dropzone.isValidFile = function(file, acceptedFiles) {\n    var baseMimeType, mimeType, validType, _i, _len;\n    if (!acceptedFiles) {\n      return true;\n    }\n    acceptedFiles = acceptedFiles.split(\",\");\n    mimeType = file.type;\n    baseMimeType = mimeType.replace(/\\/.*$/, \"\");\n    for (_i = 0, _len = acceptedFiles.length; _i < _len; _i++) {\n      validType = acceptedFiles[_i];\n      validType = validType.trim();\n      if (validType.charAt(0) === \".\") {\n        if (file.name.toLowerCase().indexOf(validType.toLowerCase(), file.name.length - validType.length) !== -1) {\n          return true;\n        }\n      } else if (/\\/\\*$/.test(validType)) {\n        if (baseMimeType === validType.replace(/\\/.*$/, \"\")) {\n          return true;\n        }\n      } else {\n        if (mimeType === validType) {\n          return true;\n        }\n      }\n    }\n    return false;\n  };\n\n  if (typeof jQuery !== \"undefined\" && jQuery !== null) {\n    jQuery.fn.dropzone = function(options) {\n      return this.each(function() {\n        return new Dropzone(this, options);\n      });\n    };\n  }\n\n  if (typeof module !== \"undefined\" && module !== null) {\n    module.exports = Dropzone;\n  } else {\n    window.Dropzone = Dropzone;\n  }\n\n  Dropzone.ADDED = \"added\";\n\n  Dropzone.QUEUED = \"queued\";\n\n  Dropzone.ACCEPTED = Dropzone.QUEUED;\n\n  Dropzone.UPLOADING = \"uploading\";\n\n  Dropzone.PROCESSING = Dropzone.UPLOADING;\n\n  Dropzone.CANCELED = \"canceled\";\n\n  Dropzone.ERROR = \"error\";\n\n  Dropzone.SUCCESS = \"success\";\n\n\n  /*\n  \n  Bugfix for iOS 6 and 7\n  Source: http://stackoverflow.com/questions/11929099/html5-canvas-drawimage-ratio-bug-ios\n  based on the work of https://github.com/stomita/ios-imagefile-megapixel\n   */\n\n  detectVerticalSquash = function(img) {\n    var alpha, canvas, ctx, data, ey, ih, iw, py, ratio, sy;\n    iw = img.naturalWidth;\n    ih = img.naturalHeight;\n    canvas = document.createElement(\"canvas\");\n    canvas.width = 1;\n    canvas.height = ih;\n    ctx = canvas.getContext(\"2d\");\n    ctx.drawImage(img, 0, 0);\n    data = ctx.getImageData(0, 0, 1, ih).data;\n    sy = 0;\n    ey = ih;\n    py = ih;\n    while (py > sy) {\n      alpha = data[(py - 1) * 4 + 3];\n      if (alpha === 0) {\n        ey = py;\n      } else {\n        sy = py;\n      }\n      py = (ey + sy) >> 1;\n    }\n    ratio = py / ih;\n    if (ratio === 0) {\n      return 1;\n    } else {\n      return ratio;\n    }\n  };\n\n  drawImageIOSFix = function(ctx, img, sx, sy, sw, sh, dx, dy, dw, dh) {\n    var vertSquashRatio;\n    vertSquashRatio = detectVerticalSquash(img);\n    return ctx.drawImage(img, sx, sy, sw, sh, dx, dy, dw, dh / vertSquashRatio);\n  };\n\n\n  /*\n   * contentloaded.js\n   *\n   * Author: Diego Perini (diego.perini at gmail.com)\n   * Summary: cross-browser wrapper for DOMContentLoaded\n   * Updated: 20101020\n   * License: MIT\n   * Version: 1.2\n   *\n   * URL:\n   * http://javascript.nwbox.com/ContentLoaded/\n   * http://javascript.nwbox.com/ContentLoaded/MIT-LICENSE\n   */\n\n  contentLoaded = function(win, fn) {\n    var add, doc, done, init, poll, pre, rem, root, top;\n    done = false;\n    top = true;\n    doc = win.document;\n    root = doc.documentElement;\n    add = (doc.addEventListener ? \"addEventListener\" : \"attachEvent\");\n    rem = (doc.addEventListener ? \"removeEventListener\" : \"detachEvent\");\n    pre = (doc.addEventListener ? \"\" : \"on\");\n    init = function(e) {\n      if (e.type === \"readystatechange\" && doc.readyState !== \"complete\") {\n        return;\n      }\n      (e.type === \"load\" ? win : doc)[rem](pre + e.type, init, false);\n      if (!done && (done = true)) {\n        return fn.call(win, e.type || e);\n      }\n    };\n    poll = function() {\n      var e;\n      try {\n        root.doScroll(\"left\");\n      } catch (_error) {\n        e = _error;\n        setTimeout(poll, 50);\n        return;\n      }\n      return init(\"poll\");\n    };\n    if (doc.readyState !== \"complete\") {\n      if (doc.createEventObject && root.doScroll) {\n        try {\n          top = !win.frameElement;\n        } catch (_error) {}\n        if (top) {\n          poll();\n        }\n      }\n      doc[add](pre + \"DOMContentLoaded\", init, false);\n      doc[add](pre + \"readystatechange\", init, false);\n      return win[add](pre + \"load\", init, false);\n    }\n  };\n\n  Dropzone._autoDiscoverFunction = function() {\n    if (Dropzone.autoDiscover) {\n      return Dropzone.discover();\n    }\n  };\n\n  contentLoaded(window, Dropzone._autoDiscoverFunction);\n\n}).call(this);",
    "// tipsy, facebook style tooltips for jquery with fancy fading\n// version 1.0.0a\n// (c) 2008-2010 jason frame [jason@onehackoranother.com] and modificated by Sergio Alvarez @saleiva\n// released under the MIT license\n//\n//  Changes:\n//  April 27 2016: fixed problem with element size.\n//  June 3 2013: Added the custom class before the calc of the position.\n\n(function($) {\n\n  var MOVE_OFFSET = 6;\n\n  function maybeCall(thing, ctx) {\n    return (typeof thing == 'function') ? (thing.call(ctx)) : thing;\n  };\n\n  function isElementInDOM(ele) {\n    while (ele = ele.parentNode) {\n      if (ele == document) return true;\n    }\n    return false;\n  };\n\n  function Tipsy(element, options) {\n    this.$element = $(element);\n    this.options = options;\n    this.enabled = true;\n    this.fixTitle();\n  };\n\n  Tipsy.prototype = {\n    show: function() {\n      var title = this.getTitle();\n      if (title && this.enabled) {\n        var $tip = this.tip();\n\n        $tip.find('.tipsy-inner')[this.options.html ? 'html' : 'text'](title);\n            $tip[0].className = 'tipsy'; // reset classname in case of dynamic gravity\n            $tip.remove().css({top: 0, left: 0, visibility: 'hidden', display: 'block'}).prependTo(document.body);\n\n            // Modified so we can use custom class names\n            if (this.options.className) {\n              $tip.addClass(maybeCall(this.options.className, this.$element[0]));\n            }\n\n            // Modified\n            var pos = $.extend({}, this.$element.offset(), {\n              width: this.$element[0].getBoundingClientRect().width,\n              height: this.$element[0].getBoundingClientRect().height\n            });\n\n            var actualWidth = $tip[0].offsetWidth,\n            actualHeight = $tip[0].offsetHeight,\n            gravity = maybeCall(this.options.gravity, this.$element[0]);\n\n            var tp;\n            switch (gravity.charAt(0)) {\n              case 'n':\n              tp = {top: pos.top + pos.height + this.options.offset, left: pos.left + pos.width / 2 - actualWidth / 2};\n              mo = {top: parseInt(pos.top + pos.height + this.options.offset + MOVE_OFFSET), opacity: this.options.opacity};\n              break;\n              case 's':\n              tp = {top: pos.top - actualHeight - this.options.offset, left: pos.left + pos.width / 2 - actualWidth / 2};\n              mo = {top: parseInt(pos.top - actualHeight - this.options.offset - MOVE_OFFSET), opacity: this.options.opacity};\n              break;\n              case 'e':\n              tp = {top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left - actualWidth - this.options.offset};\n              mo = {left: parseInt(pos.left - actualWidth - this.options.offset - MOVE_OFFSET), opacity: this.options.opacity};\n              break;\n              case 'w':\n              tp = {top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left + pos.width + this.options.offset};\n              mo = {left: parseInt(pos.left + pos.width + this.options.offset + MOVE_OFFSET), opacity: this.options.opacity};\n              break;\n            }\n\n            if (gravity.length == 2) {\n              if (gravity.charAt(1) == 'w') {\n                tp.left = pos.left + pos.width / 2 - 15;\n              } else {\n                tp.left = pos.left + pos.width / 2 - actualWidth + 15;\n              }\n            }\n\n            $tip.css(tp).addClass('tipsy-' + gravity);\n            $tip.find('.tipsy-arrow')[0].className = 'tipsy-arrow tipsy-arrow-' + gravity.charAt(0);\n\n            if (this.options.fade) {\n              $tip.stop().css({opacity: 0, display: 'block', visibility: 'visible'}).animate(mo, 200);\n            } else {\n              $tip.css({visibility: 'visible', opacity: this.options.opacity});\n            }\n          }\n        },\n\n        hide: function() {\n\n          gravity = maybeCall(this.options.gravity, this.$element[0]);\n\n          switch (gravity.charAt(0)) {\n            case 'n':\n            mo = {top: parseInt(this.tip().css(\"top\")) + MOVE_OFFSET, opacity: 0};\n            break;\n            case 's':\n            mo = {top: parseInt(this.tip().css(\"top\")) - MOVE_OFFSET, opacity: 0};\n            break;\n            case 'e':\n            mo = {left: parseInt(this.tip().css(\"left\")) - MOVE_OFFSET, opacity: 0};\n            break;\n            case 'w':\n            mo = {left: parseInt(this.tip().css(\"left\")) + MOVE_OFFSET, opacity: 0};\n            break;\n          }\n\n          if (this.options.fade) {\n            this.tip().stop().animate(mo, 200, function(){$(this).remove();});\n          } else {\n            this.tip().remove();\n          }\n        },\n\n        fixTitle: function() {\n          var $e = this.$element;\n          if ($e.attr('title') || typeof($e.attr('original-title')) != 'string') {\n            $e.attr('original-title', $e.attr('title') || '').removeAttr('title');\n          }\n        },\n\n        getTitle: function() {\n          var title, $e = this.$element, o = this.options;\n          this.fixTitle();\n          var title, o = this.options;\n          if (typeof o.title == 'string') {\n            title = $e.attr(o.title == 'title' ? 'original-title' : o.title);\n          } else if (typeof o.title == 'function') {\n            title = o.title.call($e[0]);\n          }\n          title = ('' + title).replace(/(^\\s*|\\s*$)/, \"\");\n          return title || o.fallback;\n        },\n\n        tip: function() {\n          if (!this.$tip) {\n            this.$tip = $('<div class=\"tipsy\"></div>').html('<div class=\"tipsy-arrow\"></div><div class=\"tipsy-inner\"></div>');\n            this.$tip.data('tipsy-pointee', this.$element[0]);\n          }\n          return this.$tip;\n        },\n\n        validate: function() {\n          if (!this.$element[0].parentNode) {\n            this.hide();\n            this.$element = null;\n            this.options = null;\n          }\n        },\n\n        remove: function() { this.enabled = false; this.$tip && this.$tip.remove(); },\n        enable: function() { this.enabled = true; },\n        disable: function() { this.enabled = false; },\n        toggleEnabled: function() { this.enabled = !this.enabled; }\n      };\n\n      $.fn.tipsy = function(options) {\n\n        if (options === true) {\n          return this.data('tipsy');\n        } else if (typeof options == 'string') {\n          var tipsy = this.data('tipsy');\n          if (tipsy) tipsy[options]();\n          return this;\n        }\n\n        options = $.extend({}, $.fn.tipsy.defaults, options);\n\n        function get(ele) {\n          var tipsy = $.data(ele, 'tipsy');\n          if (!tipsy) {\n            tipsy = new Tipsy(ele, $.fn.tipsy.elementOptions(ele, options));\n            $.data(ele, 'tipsy', tipsy);\n          }\n          return tipsy;\n        }\n\n        function enter() {\n          var tipsy = get(this);\n          tipsy.hoverState = 'in';\n          if (options.delayIn == 0) {\n            tipsy.show();\n          } else {\n            tipsy.fixTitle();\n            setTimeout(function() { if (tipsy.hoverState == 'in') tipsy.show(); }, options.delayIn);\n          }\n        };\n\n        function leave() {\n          var tipsy = get(this);\n          tipsy.hoverState = 'out';\n          if (options.delayOut == 0) {\n            tipsy.hide();\n          } else {\n            setTimeout(function() { if (tipsy.hoverState == 'out') tipsy.hide(); }, options.delayOut);\n          }\n        };\n\n        if (!options.live) this.each(function() { get(this); });\n\n        if (options.trigger != 'manual') {\n          var binder   = options.live ? 'live' : 'bind',\n          eventIn  = options.trigger == 'hover' ? 'mouseenter' : 'focus',\n          eventOut = options.trigger == 'hover' ? 'mouseleave' : 'blur';\n          this[binder](eventIn, enter)[binder](eventOut, leave);\n        }\n\n        return this;\n\n      };\n\n      $.fn.tipsy.defaults = {\n        className: null,\n        delayIn: 0,\n        delayOut: 0,\n        fade: false,\n        fallback: '',\n        gravity: 'n',\n        html: false,\n        live: false,\n        offset: 0,\n        opacity: 0.8,\n        title: 'title',\n        trigger: 'hover'\n      };\n\n      $.fn.tipsy.revalidate = function() {\n        $('.tipsy').each(function() {\n          var pointee = $.data(this, 'tipsy-pointee');\n          if (!pointee || !isElementInDOM(pointee)) {\n            $(this).remove();\n          }\n        });\n      };\n\n    // Overwrite this method to provide options on a per-element basis.\n    // For example, you could store the gravity in a 'tipsy-gravity' attribute:\n    // return $.extend({}, options, {gravity: $(ele).attr('tipsy-gravity') || 'n' });\n    // (remember - do not modify 'options' in place!)\n    $.fn.tipsy.elementOptions = function(ele, options) {\n      return $.metadata ? $.extend({}, options, $(ele).metadata()) : options;\n    };\n\n    $.fn.tipsy.autoNS = function() {\n      return $(this).offset().top > ($(document).scrollTop() + $(window).height() / 2) ? 's' : 'n';\n    };\n\n    $.fn.tipsy.autoWE = function() {\n      return $(this).offset().left > ($(document).scrollLeft() + $(window).width() / 2) ? 'e' : 'w';\n    };\n\n    /**\n     * yields a closure of the supplied parameters, producing a function that takes\n     * no arguments and is suitable for use as an autogravity function like so:\n     *\n     * @param margin (int) - distance from the viewable region edge that an\n     *        element should be before setting its tooltip's gravity to be away\n     *        from that edge.\n     * @param prefer (string, e.g. 'n', 'sw', 'w') - the direction to prefer\n     *        if there are no viewable region edges effecting the tooltip's\n     *        gravity. It will try to vary from this minimally, for example,\n     *        if 'sw' is preferred and an element is near the right viewable\n     *        region edge, but not the top edge, it will set the gravity for\n     *        that element's tooltip to be 'se', preserving the southern\n     *        component.\n     */\n     $.fn.tipsy.autoBounds = function(margin, prefer) {\n      return function() {\n       var dir = {ns: prefer[0], ew: (prefer.length > 1 ? prefer[1] : false)},\n       boundTop = $(document).scrollTop() + margin,\n       boundLeft = $(document).scrollLeft() + margin,\n       $this = $(this);\n\n       if ($this.offset().top < boundTop) dir.ns = 'n';\n       if ($this.offset().left < boundLeft) dir.ew = 'w';\n       if ($(window).width() + $(document).scrollLeft() - $this.offset().left < margin) dir.ew = 'e';\n       if ($(window).height() + $(document).scrollTop() - $this.offset().top < margin) dir.ns = 's';\n\n       return dir.ns + (dir.ew ? dir.ew : '');\n     }\n   };\n\n })(jQuery);\n",
    "// Released under MIT license\n// Copyright (c) 2009-2010 Dominic Baggott\n// Copyright (c) 2009-2010 Ash Berlin\n// Copyright (c) 2011 Christoph Dorn <christoph@christophdorn.com> (http://www.christophdorn.com)\n\n/*jshint browser:true, devel:true */\n\n(function( expose ) {\n\n/**\n *  class Markdown\n *\n *  Markdown processing in Javascript done right. We have very particular views\n *  on what constitutes 'right' which include:\n *\n *  - produces well-formed HTML (this means that em and strong nesting is\n *    important)\n *\n *  - has an intermediate representation to allow processing of parsed data (We\n *    in fact have two, both as [JsonML]: a markdown tree and an HTML tree).\n *\n *  - is easily extensible to add new dialects without having to rewrite the\n *    entire parsing mechanics\n *\n *  - has a good test suite\n *\n *  This implementation fulfills all of these (except that the test suite could\n *  do with expanding to automatically run all the fixtures from other Markdown\n *  implementations.)\n *\n *  ##### Intermediate Representation\n *\n *  *TODO* Talk about this :) Its JsonML, but document the node names we use.\n *\n *  [JsonML]: http://jsonml.org/ \"JSON Markup Language\"\n **/\nvar Markdown = expose.Markdown = function(dialect) {\n  switch (typeof dialect) {\n    case \"undefined\":\n      this.dialect = Markdown.dialects.Gruber;\n      break;\n    case \"object\":\n      this.dialect = dialect;\n      break;\n    default:\n      if ( dialect in Markdown.dialects ) {\n        this.dialect = Markdown.dialects[dialect];\n      }\n      else {\n        throw new Error(\"Unknown Markdown dialect '\" + String(dialect) + \"'\");\n      }\n      break;\n  }\n  this.em_state = [];\n  this.strong_state = [];\n  this.debug_indent = \"\";\n};\n\n/**\n *  parse( markdown, [dialect] ) -> JsonML\n *  - markdown (String): markdown string to parse\n *  - dialect (String | Dialect): the dialect to use, defaults to gruber\n *\n *  Parse `markdown` and return a markdown document as a Markdown.JsonML tree.\n **/\nexpose.parse = function( source, dialect ) {\n  // dialect will default if undefined\n  var md = new Markdown( dialect );\n  return md.toTree( source );\n};\n\n/**\n *  toHTML( markdown, [dialect]  ) -> String\n *  toHTML( md_tree ) -> String\n *  - markdown (String): markdown string to parse\n *  - md_tree (Markdown.JsonML): parsed markdown tree\n *\n *  Take markdown (either as a string or as a JsonML tree) and run it through\n *  [[toHTMLTree]] then turn it into a well-formated HTML fragment.\n **/\nexpose.toHTML = function toHTML( source , dialect , options ) {\n  var input = expose.toHTMLTree( source , dialect , options );\n\n  return expose.renderJsonML( input );\n};\n\n/**\n *  toHTMLTree( markdown, [dialect] ) -> JsonML\n *  toHTMLTree( md_tree ) -> JsonML\n *  - markdown (String): markdown string to parse\n *  - dialect (String | Dialect): the dialect to use, defaults to gruber\n *  - md_tree (Markdown.JsonML): parsed markdown tree\n *\n *  Turn markdown into HTML, represented as a JsonML tree. If a string is given\n *  to this function, it is first parsed into a markdown tree by calling\n *  [[parse]].\n **/\nexpose.toHTMLTree = function toHTMLTree( input, dialect , options ) {\n  // convert string input to an MD tree\n  if ( typeof input ===\"string\" ) input = this.parse( input, dialect );\n\n  // Now convert the MD tree to an HTML tree\n\n  // remove references from the tree\n  var attrs = extract_attr( input ),\n      refs = {};\n\n  if ( attrs && attrs.references ) {\n    refs = attrs.references;\n  }\n\n  var html = convert_tree_to_html( input, refs , options );\n  merge_text_nodes( html );\n  return html;\n};\n\n// For Spidermonkey based engines\nfunction mk_block_toSource() {\n  return \"Markdown.mk_block( \" +\n          uneval(this.toString()) +\n          \", \" +\n          uneval(this.trailing) +\n          \", \" +\n          uneval(this.lineNumber) +\n          \" )\";\n}\n\n// node\nfunction mk_block_inspect() {\n  var util = require(\"util\");\n  return \"Markdown.mk_block( \" +\n          util.inspect(this.toString()) +\n          \", \" +\n          util.inspect(this.trailing) +\n          \", \" +\n          util.inspect(this.lineNumber) +\n          \" )\";\n\n}\n\nvar mk_block = Markdown.mk_block = function(block, trail, line) {\n  // Be helpful for default case in tests.\n  if ( arguments.length == 1 ) trail = \"\\n\\n\";\n\n  var s = new String(block);\n  s.trailing = trail;\n  // To make it clear its not just a string\n  s.inspect = mk_block_inspect;\n  s.toSource = mk_block_toSource;\n\n  if ( line != undefined )\n    s.lineNumber = line;\n\n  return s;\n};\n\nfunction count_lines( str ) {\n  var n = 0, i = -1;\n  while ( ( i = str.indexOf(\"\\n\", i + 1) ) !== -1 ) n++;\n  return n;\n}\n\n// Internal - split source into rough blocks\nMarkdown.prototype.split_blocks = function splitBlocks( input, startLine ) {\n  input = input.replace(/(\\r\\n|\\n|\\r)/g, \"\\n\");\n  // [\\s\\S] matches _anything_ (newline or space)\n  // [^] is equivalent but doesn't work in IEs.\n  var re = /([\\s\\S]+?)($|\\n#|\\n(?:\\s*\\n|$)+)/g,\n      blocks = [],\n      m;\n\n  var line_no = 1;\n\n  if ( ( m = /^(\\s*\\n)/.exec(input) ) != null ) {\n    // skip (but count) leading blank lines\n    line_no += count_lines( m[0] );\n    re.lastIndex = m[0].length;\n  }\n\n  while ( ( m = re.exec(input) ) !== null ) {\n    if (m[2] == \"\\n#\") {\n      m[2] = \"\\n\";\n      re.lastIndex--;\n    }\n    blocks.push( mk_block( m[1], m[2], line_no ) );\n    line_no += count_lines( m[0] );\n  }\n\n  return blocks;\n};\n\n/**\n *  Markdown#processBlock( block, next ) -> undefined | [ JsonML, ... ]\n *  - block (String): the block to process\n *  - next (Array): the following blocks\n *\n * Process `block` and return an array of JsonML nodes representing `block`.\n *\n * It does this by asking each block level function in the dialect to process\n * the block until one can. Succesful handling is indicated by returning an\n * array (with zero or more JsonML nodes), failure by a false value.\n *\n * Blocks handlers are responsible for calling [[Markdown#processInline]]\n * themselves as appropriate.\n *\n * If the blocks were split incorrectly or adjacent blocks need collapsing you\n * can adjust `next` in place using shift/splice etc.\n *\n * If any of this default behaviour is not right for the dialect, you can\n * define a `__call__` method on the dialect that will get invoked to handle\n * the block processing.\n */\nMarkdown.prototype.processBlock = function processBlock( block, next ) {\n  var cbs = this.dialect.block,\n      ord = cbs.__order__;\n\n  if ( \"__call__\" in cbs ) {\n    return cbs.__call__.call(this, block, next);\n  }\n\n  for ( var i = 0; i < ord.length; i++ ) {\n    //D:this.debug( \"Testing\", ord[i] );\n    var res = cbs[ ord[i] ].call( this, block, next );\n    if ( res ) {\n      //D:this.debug(\"  matched\");\n      if ( !isArray(res) || ( res.length > 0 && !( isArray(res[0]) ) ) )\n        this.debug(ord[i], \"didn't return a proper array\");\n      //D:this.debug( \"\" );\n      return res;\n    }\n  }\n\n  // Uhoh! no match! Should we throw an error?\n  return [];\n};\n\nMarkdown.prototype.processInline = function processInline( block ) {\n  return this.dialect.inline.__call__.call( this, String( block ) );\n};\n\n/**\n *  Markdown#toTree( source ) -> JsonML\n *  - source (String): markdown source to parse\n *\n *  Parse `source` into a JsonML tree representing the markdown document.\n **/\n// custom_tree means set this.tree to `custom_tree` and restore old value on return\nMarkdown.prototype.toTree = function toTree( source, custom_root ) {\n  var blocks = source instanceof Array ? source : this.split_blocks( source );\n\n  // Make tree a member variable so its easier to mess with in extensions\n  var old_tree = this.tree;\n  try {\n    this.tree = custom_root || this.tree || [ \"markdown\" ];\n\n    blocks:\n    while ( blocks.length ) {\n      var b = this.processBlock( blocks.shift(), blocks );\n\n      // Reference blocks and the like won't return any content\n      if ( !b.length ) continue blocks;\n\n      this.tree.push.apply( this.tree, b );\n    }\n    return this.tree;\n  }\n  finally {\n    if ( custom_root ) {\n      this.tree = old_tree;\n    }\n  }\n};\n\n// Noop by default\nMarkdown.prototype.debug = function () {\n  var args = Array.prototype.slice.call( arguments);\n  args.unshift(this.debug_indent);\n  if ( typeof print !== \"undefined\" )\n      print.apply( print, args );\n  if ( typeof console !== \"undefined\" && typeof console.log !== \"undefined\" )\n      console.log.apply( null, args );\n}\n\nMarkdown.prototype.loop_re_over_block = function( re, block, cb ) {\n  // Dont use /g regexps with this\n  var m,\n      b = block.valueOf();\n\n  while ( b.length && (m = re.exec(b) ) != null ) {\n    b = b.substr( m[0].length );\n    cb.call(this, m);\n  }\n  return b;\n};\n\n/**\n * Markdown.dialects\n *\n * Namespace of built-in dialects.\n **/\nMarkdown.dialects = {};\n\n/**\n * Markdown.dialects.Gruber\n *\n * The default dialect that follows the rules set out by John Gruber's\n * markdown.pl as closely as possible. Well actually we follow the behaviour of\n * that script which in some places is not exactly what the syntax web page\n * says.\n **/\nMarkdown.dialects.Gruber = {\n  block: {\n    atxHeader: function atxHeader( block, next ) {\n      var m = block.match( /^(#{1,6})\\s*(.*?)\\s*#*\\s*(?:\\n|$)/ );\n\n      if ( !m ) return undefined;\n\n      var header = [ \"header\", { level: m[ 1 ].length } ];\n      Array.prototype.push.apply(header, this.processInline(m[ 2 ]));\n\n      if ( m[0].length < block.length )\n        next.unshift( mk_block( block.substr( m[0].length ), block.trailing, block.lineNumber + 2 ) );\n\n      return [ header ];\n    },\n\n    setextHeader: function setextHeader( block, next ) {\n      var m = block.match( /^(.*)\\n([-=])\\2\\2+(?:\\n|$)/ );\n\n      if ( !m ) return undefined;\n\n      var level = ( m[ 2 ] === \"=\" ) ? 1 : 2;\n      var header = [ \"header\", { level : level }, m[ 1 ] ];\n\n      if ( m[0].length < block.length )\n        next.unshift( mk_block( block.substr( m[0].length ), block.trailing, block.lineNumber + 2 ) );\n\n      return [ header ];\n    },\n\n    code: function code( block, next ) {\n      // |    Foo\n      // |bar\n      // should be a code block followed by a paragraph. Fun\n      //\n      // There might also be adjacent code block to merge.\n\n      var ret = [],\n          re = /^(?: {0,3}\\t| {4})(.*)\\n?/,\n          lines;\n\n      // 4 spaces + content\n      if ( !block.match( re ) ) return undefined;\n\n      block_search:\n      do {\n        // Now pull out the rest of the lines\n        var b = this.loop_re_over_block(\n                  re, block.valueOf(), function( m ) { ret.push( m[1] ); } );\n\n        if ( b.length ) {\n          // Case alluded to in first comment. push it back on as a new block\n          next.unshift( mk_block(b, block.trailing) );\n          break block_search;\n        }\n        else if ( next.length ) {\n          // Check the next block - it might be code too\n          if ( !next[0].match( re ) ) break block_search;\n\n          // Pull how how many blanks lines follow - minus two to account for .join\n          ret.push ( block.trailing.replace(/[^\\n]/g, \"\").substring(2) );\n\n          block = next.shift();\n        }\n        else {\n          break block_search;\n        }\n      } while ( true );\n\n      return [ [ \"code_block\", ret.join(\"\\n\") ] ];\n    },\n\n    horizRule: function horizRule( block, next ) {\n      // this needs to find any hr in the block to handle abutting blocks\n      var m = block.match( /^(?:([\\s\\S]*?)\\n)?[ \\t]*([-_*])(?:[ \\t]*\\2){2,}[ \\t]*(?:\\n([\\s\\S]*))?$/ );\n\n      if ( !m ) {\n        return undefined;\n      }\n\n      var jsonml = [ [ \"hr\" ] ];\n\n      // if there's a leading abutting block, process it\n      if ( m[ 1 ] ) {\n        jsonml.unshift.apply( jsonml, this.processBlock( m[ 1 ], [] ) );\n      }\n\n      // if there's a trailing abutting block, stick it into next\n      if ( m[ 3 ] ) {\n        next.unshift( mk_block( m[ 3 ] ) );\n      }\n\n      return jsonml;\n    },\n\n    // There are two types of lists. Tight and loose. Tight lists have no whitespace\n    // between the items (and result in text just in the <li>) and loose lists,\n    // which have an empty line between list items, resulting in (one or more)\n    // paragraphs inside the <li>.\n    //\n    // There are all sorts weird edge cases about the original markdown.pl's\n    // handling of lists:\n    //\n    // * Nested lists are supposed to be indented by four chars per level. But\n    //   if they aren't, you can get a nested list by indenting by less than\n    //   four so long as the indent doesn't match an indent of an existing list\n    //   item in the 'nest stack'.\n    //\n    // * The type of the list (bullet or number) is controlled just by the\n    //    first item at the indent. Subsequent changes are ignored unless they\n    //    are for nested lists\n    //\n    lists: (function( ) {\n      // Use a closure to hide a few variables.\n      var any_list = \"[*+-]|\\\\d+\\\\.\",\n          bullet_list = /[*+-]/,\n          number_list = /\\d+\\./,\n          // Capture leading indent as it matters for determining nested lists.\n          is_list_re = new RegExp( \"^( {0,3})(\" + any_list + \")[ \\t]+\" ),\n          indent_re = \"(?: {0,3}\\\\t| {4})\";\n\n      // TODO: Cache this regexp for certain depths.\n      // Create a regexp suitable for matching an li for a given stack depth\n      function regex_for_depth( depth ) {\n\n        return new RegExp(\n          // m[1] = indent, m[2] = list_type\n          \"(?:^(\" + indent_re + \"{0,\" + depth + \"} {0,3})(\" + any_list + \")\\\\s+)|\" +\n          // m[3] = cont\n          \"(^\" + indent_re + \"{0,\" + (depth-1) + \"}[ ]{0,4})\"\n        );\n      }\n      function expand_tab( input ) {\n        return input.replace( / {0,3}\\t/g, \"    \" );\n      }\n\n      // Add inline content `inline` to `li`. inline comes from processInline\n      // so is an array of content\n      function add(li, loose, inline, nl) {\n        if ( loose ) {\n          li.push( [ \"para\" ].concat(inline) );\n          return;\n        }\n        // Hmmm, should this be any block level element or just paras?\n        var add_to = li[li.length -1] instanceof Array && li[li.length - 1][0] == \"para\"\n                   ? li[li.length -1]\n                   : li;\n\n        // If there is already some content in this list, add the new line in\n        if ( nl && li.length > 1 ) inline.unshift(nl);\n\n        for ( var i = 0; i < inline.length; i++ ) {\n          var what = inline[i],\n              is_str = typeof what == \"string\";\n          if ( is_str && add_to.length > 1 && typeof add_to[add_to.length-1] == \"string\" ) {\n            add_to[ add_to.length-1 ] += what;\n          }\n          else {\n            add_to.push( what );\n          }\n        }\n      }\n\n      // contained means have an indent greater than the current one. On\n      // *every* line in the block\n      function get_contained_blocks( depth, blocks ) {\n\n        var re = new RegExp( \"^(\" + indent_re + \"{\" + depth + \"}.*?\\\\n?)*$\" ),\n            replace = new RegExp(\"^\" + indent_re + \"{\" + depth + \"}\", \"gm\"),\n            ret = [];\n\n        while ( blocks.length > 0 ) {\n          if ( re.exec( blocks[0] ) ) {\n            var b = blocks.shift(),\n                // Now remove that indent\n                x = b.replace( replace, \"\");\n\n            ret.push( mk_block( x, b.trailing, b.lineNumber ) );\n          }\n          else {\n            break;\n          }\n        }\n        return ret;\n      }\n\n      // passed to stack.forEach to turn list items up the stack into paras\n      function paragraphify(s, i, stack) {\n        var list = s.list;\n        var last_li = list[list.length-1];\n\n        if ( last_li[1] instanceof Array && last_li[1][0] == \"para\" ) {\n          return;\n        }\n        if ( i + 1 == stack.length ) {\n          // Last stack frame\n          // Keep the same array, but replace the contents\n          last_li.push( [\"para\"].concat( last_li.splice(1, last_li.length - 1) ) );\n        }\n        else {\n          var sublist = last_li.pop();\n          last_li.push( [\"para\"].concat( last_li.splice(1, last_li.length - 1) ), sublist );\n        }\n      }\n\n      // The matcher function\n      return function( block, next ) {\n        var m = block.match( is_list_re );\n        if ( !m ) return undefined;\n\n        function make_list( m ) {\n          var list = bullet_list.exec( m[2] )\n                   ? [\"bulletlist\"]\n                   : [\"numberlist\"];\n\n          stack.push( { list: list, indent: m[1] } );\n          return list;\n        }\n\n\n        var stack = [], // Stack of lists for nesting.\n            list = make_list( m ),\n            last_li,\n            loose = false,\n            ret = [ stack[0].list ],\n            i;\n\n        // Loop to search over block looking for inner block elements and loose lists\n        loose_search:\n        while ( true ) {\n          // Split into lines preserving new lines at end of line\n          var lines = block.split( /(?=\\n)/ );\n\n          // We have to grab all lines for a li and call processInline on them\n          // once as there are some inline things that can span lines.\n          var li_accumulate = \"\";\n\n          // Loop over the lines in this block looking for tight lists.\n          tight_search:\n          for ( var line_no = 0; line_no < lines.length; line_no++ ) {\n            var nl = \"\",\n                l = lines[line_no].replace(/^\\n/, function(n) { nl = n; return \"\"; });\n\n            // TODO: really should cache this\n            var line_re = regex_for_depth( stack.length );\n\n            m = l.match( line_re );\n            //print( \"line:\", uneval(l), \"\\nline match:\", uneval(m) );\n\n            // We have a list item\n            if ( m[1] !== undefined ) {\n              // Process the previous list item, if any\n              if ( li_accumulate.length ) {\n                add( last_li, loose, this.processInline( li_accumulate ), nl );\n                // Loose mode will have been dealt with. Reset it\n                loose = false;\n                li_accumulate = \"\";\n              }\n\n              m[1] = expand_tab( m[1] );\n              var wanted_depth = Math.floor(m[1].length/4)+1;\n              //print( \"want:\", wanted_depth, \"stack:\", stack.length);\n              if ( wanted_depth > stack.length ) {\n                // Deep enough for a nested list outright\n                //print ( \"new nested list\" );\n                list = make_list( m );\n                last_li.push( list );\n                last_li = list[1] = [ \"listitem\" ];\n              }\n              else {\n                // We aren't deep enough to be strictly a new level. This is\n                // where Md.pl goes nuts. If the indent matches a level in the\n                // stack, put it there, else put it one deeper then the\n                // wanted_depth deserves.\n                var found = false;\n                for ( i = 0; i < stack.length; i++ ) {\n                  if ( stack[ i ].indent != m[1] ) continue;\n                  list = stack[ i ].list;\n                  stack.splice( i+1, stack.length - (i+1) );\n                  found = true;\n                  break;\n                }\n\n                if (!found) {\n                  //print(\"not found. l:\", uneval(l));\n                  wanted_depth++;\n                  if ( wanted_depth <= stack.length ) {\n                    stack.splice(wanted_depth, stack.length - wanted_depth);\n                    //print(\"Desired depth now\", wanted_depth, \"stack:\", stack.length);\n                    list = stack[wanted_depth-1].list;\n                    //print(\"list:\", uneval(list) );\n                  }\n                  else {\n                    //print (\"made new stack for messy indent\");\n                    list = make_list(m);\n                    last_li.push(list);\n                  }\n                }\n\n                //print( uneval(list), \"last\", list === stack[stack.length-1].list );\n                last_li = [ \"listitem\" ];\n                list.push(last_li);\n              } // end depth of shenegains\n              nl = \"\";\n            }\n\n            // Add content\n            if ( l.length > m[0].length ) {\n              li_accumulate += nl + l.substr( m[0].length );\n            }\n          } // tight_search\n\n          if ( li_accumulate.length ) {\n            add( last_li, loose, this.processInline( li_accumulate ), nl );\n            // Loose mode will have been dealt with. Reset it\n            loose = false;\n            li_accumulate = \"\";\n          }\n\n          // Look at the next block - we might have a loose list. Or an extra\n          // paragraph for the current li\n          var contained = get_contained_blocks( stack.length, next );\n\n          // Deal with code blocks or properly nested lists\n          if ( contained.length > 0 ) {\n            // Make sure all listitems up the stack are paragraphs\n            forEach( stack, paragraphify, this);\n\n            last_li.push.apply( last_li, this.toTree( contained, [] ) );\n          }\n\n          var next_block = next[0] && next[0].valueOf() || \"\";\n\n          if ( next_block.match(is_list_re) || next_block.match( /^ / ) ) {\n            block = next.shift();\n\n            // Check for an HR following a list: features/lists/hr_abutting\n            var hr = this.dialect.block.horizRule( block, next );\n\n            if ( hr ) {\n              ret.push.apply(ret, hr);\n              break;\n            }\n\n            // Make sure all listitems up the stack are paragraphs\n            forEach( stack, paragraphify, this);\n\n            loose = true;\n            continue loose_search;\n          }\n          break;\n        } // loose_search\n\n        return ret;\n      };\n    })(),\n\n    blockquote: function blockquote( block, next ) {\n      if ( !block.match( /^>/m ) )\n        return undefined;\n\n      var jsonml = [];\n\n      // separate out the leading abutting block, if any. I.e. in this case:\n      //\n      //  a\n      //  > b\n      //\n      if ( block[ 0 ] != \">\" ) {\n        var lines = block.split( /\\n/ ),\n            prev = [],\n            line_no = block.lineNumber;\n\n        // keep shifting lines until you find a crotchet\n        while ( lines.length && lines[ 0 ][ 0 ] != \">\" ) {\n            prev.push( lines.shift() );\n            line_no++;\n        }\n\n        var abutting = mk_block( prev.join( \"\\n\" ), \"\\n\", block.lineNumber );\n        jsonml.push.apply( jsonml, this.processBlock( abutting, [] ) );\n        // reassemble new block of just block quotes!\n        block = mk_block( lines.join( \"\\n\" ), block.trailing, line_no );\n      }\n\n\n      // if the next block is also a blockquote merge it in\n      while ( next.length && next[ 0 ][ 0 ] == \">\" ) {\n        var b = next.shift();\n        block = mk_block( block + block.trailing + b, b.trailing, block.lineNumber );\n      }\n\n      // Strip off the leading \"> \" and re-process as a block.\n      var input = block.replace( /^> ?/gm, \"\" ),\n          old_tree = this.tree,\n          processedBlock = this.toTree( input, [ \"blockquote\" ] ),\n          attr = extract_attr( processedBlock );\n\n      // If any link references were found get rid of them\n      if ( attr && attr.references ) {\n        delete attr.references;\n        // And then remove the attribute object if it's empty\n        if ( isEmpty( attr ) ) {\n          processedBlock.splice( 1, 1 );\n        }\n      }\n\n      jsonml.push( processedBlock );\n      return jsonml;\n    },\n\n    referenceDefn: function referenceDefn( block, next) {\n      var re = /^\\s*\\[(.*?)\\]:\\s*(\\S+)(?:\\s+(?:(['\"])(.*?)\\3|\\((.*?)\\)))?\\n?/;\n      // interesting matches are [ , ref_id, url, , title, title ]\n\n      if ( !block.match(re) )\n        return undefined;\n\n      // make an attribute node if it doesn't exist\n      if ( !extract_attr( this.tree ) ) {\n        this.tree.splice( 1, 0, {} );\n      }\n\n      var attrs = extract_attr( this.tree );\n\n      // make a references hash if it doesn't exist\n      if ( attrs.references === undefined ) {\n        attrs.references = {};\n      }\n\n      var b = this.loop_re_over_block(re, block, function( m ) {\n\n        if ( m[2] && m[2][0] == \"<\" && m[2][m[2].length-1] == \">\" )\n          m[2] = m[2].substring( 1, m[2].length - 1 );\n\n        var ref = attrs.references[ m[1].toLowerCase() ] = {\n          href: m[2]\n        };\n\n        if ( m[4] !== undefined )\n          ref.title = m[4];\n        else if ( m[5] !== undefined )\n          ref.title = m[5];\n\n      } );\n\n      if ( b.length )\n        next.unshift( mk_block( b, block.trailing ) );\n\n      return [];\n    },\n\n    para: function para( block, next ) {\n      // everything's a para!\n      return [ [\"para\"].concat( this.processInline( block ) ) ];\n    }\n  }\n};\n\nMarkdown.dialects.Gruber.inline = {\n\n    __oneElement__: function oneElement( text, patterns_or_re, previous_nodes ) {\n      var m,\n          res,\n          lastIndex = 0;\n\n      patterns_or_re = patterns_or_re || this.dialect.inline.__patterns__;\n      var re = new RegExp( \"([\\\\s\\\\S]*?)(\" + (patterns_or_re.source || patterns_or_re) + \")\" );\n\n      m = re.exec( text );\n      if (!m) {\n        // Just boring text\n        return [ text.length, text ];\n      }\n      else if ( m[1] ) {\n        // Some un-interesting text matched. Return that first\n        return [ m[1].length, m[1] ];\n      }\n\n      var res;\n      if ( m[2] in this.dialect.inline ) {\n        res = this.dialect.inline[ m[2] ].call(\n                  this,\n                  text.substr( m.index ), m, previous_nodes || [] );\n      }\n      // Default for now to make dev easier. just slurp special and output it.\n      res = res || [ m[2].length, m[2] ];\n      return res;\n    },\n\n    __call__: function inline( text, patterns ) {\n\n      var out = [],\n          res;\n\n      function add(x) {\n        //D:self.debug(\"  adding output\", uneval(x));\n        if ( typeof x == \"string\" && typeof out[out.length-1] == \"string\" )\n          out[ out.length-1 ] += x;\n        else\n          out.push(x);\n      }\n\n      while ( text.length > 0 ) {\n        res = this.dialect.inline.__oneElement__.call(this, text, patterns, out );\n        text = text.substr( res.shift() );\n        forEach(res, add )\n      }\n\n      return out;\n    },\n\n    // These characters are intersting elsewhere, so have rules for them so that\n    // chunks of plain text blocks don't include them\n    \"]\": function () {},\n    \"}\": function () {},\n\n    __escape__ : /^\\\\[\\\\`\\*_{}\\[\\]()#\\+.!\\-]/,\n\n    \"\\\\\": function escaped( text ) {\n      // [ length of input processed, node/children to add... ]\n      // Only esacape: \\ ` * _ { } [ ] ( ) # * + - . !\n      if ( this.dialect.inline.__escape__.exec( text ) )\n        return [ 2, text.charAt( 1 ) ];\n      else\n        // Not an esacpe\n        return [ 1, \"\\\\\" ];\n    },\n\n    \"![\": function image( text ) {\n\n      // Unlike images, alt text is plain text only. no other elements are\n      // allowed in there\n\n      // ![Alt text](/path/to/img.jpg \"Optional title\")\n      //      1          2            3       4         <--- captures\n      var m = text.match( /^!\\[(.*?)\\][ \\t]*\\([ \\t]*([^\")]*?)(?:[ \\t]+([\"'])(.*?)\\3)?[ \\t]*\\)/ );\n\n      if ( m ) {\n        if ( m[2] && m[2][0] == \"<\" && m[2][m[2].length-1] == \">\" )\n          m[2] = m[2].substring( 1, m[2].length - 1 );\n\n        m[2] = this.dialect.inline.__call__.call( this, m[2], /\\\\/ )[0];\n\n        var attrs = { alt: m[1], href: m[2] || \"\" };\n        if ( m[4] !== undefined)\n          attrs.title = m[4];\n\n        return [ m[0].length, [ \"img\", attrs ] ];\n      }\n\n      // ![Alt text][id]\n      m = text.match( /^!\\[(.*?)\\][ \\t]*\\[(.*?)\\]/ );\n\n      if ( m ) {\n        // We can't check if the reference is known here as it likely wont be\n        // found till after. Check it in md tree->hmtl tree conversion\n        return [ m[0].length, [ \"img_ref\", { alt: m[1], ref: m[2].toLowerCase(), original: m[0] } ] ];\n      }\n\n      // Just consume the '!['\n      return [ 2, \"![\" ];\n    },\n\n    \"[\": function link( text ) {\n\n      var orig = String(text);\n      // Inline content is possible inside `link text`\n      var res = Markdown.DialectHelpers.inline_until_char.call( this, text.substr(1), \"]\" );\n\n      // No closing ']' found. Just consume the [\n      if ( !res ) return [ 1, \"[\" ];\n\n      var consumed = 1 + res[ 0 ],\n          children = res[ 1 ],\n          link,\n          attrs;\n\n      // At this point the first [...] has been parsed. See what follows to find\n      // out which kind of link we are (reference or direct url)\n      text = text.substr( consumed );\n\n      // [link text](/path/to/img.jpg \"Optional title\")\n      //                 1            2       3         <--- captures\n      // This will capture up to the last paren in the block. We then pull\n      // back based on if there a matching ones in the url\n      //    ([here](/url/(test))\n      // The parens have to be balanced\n      var m = text.match( /^\\s*\\([ \\t]*([^\"']*)(?:[ \\t]+([\"'])(.*?)\\2)?[ \\t]*\\)/ );\n      if ( m ) {\n        var url = m[1];\n        consumed += m[0].length;\n\n        if ( url && url[0] == \"<\" && url[url.length-1] == \">\" )\n          url = url.substring( 1, url.length - 1 );\n\n        // If there is a title we don't have to worry about parens in the url\n        if ( !m[3] ) {\n          var open_parens = 1; // One open that isn't in the capture\n          for ( var len = 0; len < url.length; len++ ) {\n            switch ( url[len] ) {\n            case \"(\":\n              open_parens++;\n              break;\n            case \")\":\n              if ( --open_parens == 0) {\n                consumed -= url.length - len;\n                url = url.substring(0, len);\n              }\n              break;\n            }\n          }\n        }\n\n        // Process escapes only\n        url = this.dialect.inline.__call__.call( this, url, /\\\\/ )[0];\n\n        attrs = { href: url || \"\" };\n        if ( m[3] !== undefined)\n          attrs.title = m[3];\n\n        link = [ \"link\", attrs ].concat( children );\n        return [ consumed, link ];\n      }\n\n      // [Alt text][id]\n      // [Alt text] [id]\n      m = text.match( /^\\s*\\[(.*?)\\]/ );\n\n      if ( m ) {\n\n        consumed += m[ 0 ].length;\n\n        // [links][] uses links as its reference\n        attrs = { ref: ( m[ 1 ] || String(children) ).toLowerCase(),  original: orig.substr( 0, consumed ) };\n\n        link = [ \"link_ref\", attrs ].concat( children );\n\n        // We can't check if the reference is known here as it likely wont be\n        // found till after. Check it in md tree->hmtl tree conversion.\n        // Store the original so that conversion can revert if the ref isn't found.\n        return [ consumed, link ];\n      }\n\n      // [id]\n      // Only if id is plain (no formatting.)\n      if ( children.length == 1 && typeof children[0] == \"string\" ) {\n\n        attrs = { ref: children[0].toLowerCase(),  original: orig.substr( 0, consumed ) };\n        link = [ \"link_ref\", attrs, children[0] ];\n        return [ consumed, link ];\n      }\n\n      // Just consume the \"[\"\n      return [ 1, \"[\" ];\n    },\n\n\n    \"<\": function autoLink( text ) {\n      var m;\n\n      if ( ( m = text.match( /^<(?:((https?|ftp|mailto):[^>]+)|(.*?@.*?\\.[a-zA-Z]+))>/ ) ) != null ) {\n        if ( m[3] ) {\n          return [ m[0].length, [ \"link\", { href: \"mailto:\" + m[3] }, m[3] ] ];\n\n        }\n        else if ( m[2] == \"mailto\" ) {\n          return [ m[0].length, [ \"link\", { href: m[1] }, m[1].substr(\"mailto:\".length ) ] ];\n        }\n        else\n          return [ m[0].length, [ \"link\", { href: m[1] }, m[1] ] ];\n      }\n\n      return [ 1, \"<\" ];\n    },\n\n    \"`\": function inlineCode( text ) {\n      // Inline code block. as many backticks as you like to start it\n      // Always skip over the opening ticks.\n      var m = text.match( /(`+)(([\\s\\S]*?)\\1)/ );\n\n      if ( m && m[2] )\n        return [ m[1].length + m[2].length, [ \"inlinecode\", m[3] ] ];\n      else {\n        // TODO: No matching end code found - warn!\n        return [ 1, \"`\" ];\n      }\n    },\n\n    \"  \\n\": function lineBreak( text ) {\n      return [ 3, [ \"linebreak\" ] ];\n    }\n\n};\n\n// Meta Helper/generator method for em and strong handling\nfunction strong_em( tag, md ) {\n\n  var state_slot = tag + \"_state\",\n      other_slot = tag == \"strong\" ? \"em_state\" : \"strong_state\";\n\n  function CloseTag(len) {\n    this.len_after = len;\n    this.name = \"close_\" + md;\n  }\n\n  return function ( text, orig_match ) {\n\n    if ( this[state_slot][0] == md ) {\n      // Most recent em is of this type\n      //D:this.debug(\"closing\", md);\n      this[state_slot].shift();\n\n      // \"Consume\" everything to go back to the recrusion in the else-block below\n      return[ text.length, new CloseTag(text.length-md.length) ];\n    }\n    else {\n      // Store a clone of the em/strong states\n      var other = this[other_slot].slice(),\n          state = this[state_slot].slice();\n\n      this[state_slot].unshift(md);\n\n      //D:this.debug_indent += \"  \";\n\n      // Recurse\n      var res = this.processInline( text.substr( md.length ) );\n      //D:this.debug_indent = this.debug_indent.substr(2);\n\n      var last = res[res.length - 1];\n\n      //D:this.debug(\"processInline from\", tag + \": \", uneval( res ) );\n\n      var check = this[state_slot].shift();\n      if ( last instanceof CloseTag ) {\n        res.pop();\n        // We matched! Huzzah.\n        var consumed = text.length - last.len_after;\n        return [ consumed, [ tag ].concat(res) ];\n      }\n      else {\n        // Restore the state of the other kind. We might have mistakenly closed it.\n        this[other_slot] = other;\n        this[state_slot] = state;\n\n        // We can't reuse the processed result as it could have wrong parsing contexts in it.\n        return [ md.length, md ];\n      }\n    }\n  }; // End returned function\n}\n\nMarkdown.dialects.Gruber.inline[\"**\"] = strong_em(\"strong\", \"**\");\nMarkdown.dialects.Gruber.inline[\"__\"] = strong_em(\"strong\", \"__\");\nMarkdown.dialects.Gruber.inline[\"*\"]  = strong_em(\"em\", \"*\");\nMarkdown.dialects.Gruber.inline[\"_\"]  = strong_em(\"em\", \"_\");\n\n\n// Build default order from insertion order.\nMarkdown.buildBlockOrder = function(d) {\n  var ord = [];\n  for ( var i in d ) {\n    if ( i == \"__order__\" || i == \"__call__\" ) continue;\n    ord.push( i );\n  }\n  d.__order__ = ord;\n};\n\n// Build patterns for inline matcher\nMarkdown.buildInlinePatterns = function(d) {\n  var patterns = [];\n\n  for ( var i in d ) {\n    // __foo__ is reserved and not a pattern\n    if ( i.match( /^__.*__$/) ) continue;\n    var l = i.replace( /([\\\\.*+?|()\\[\\]{}])/g, \"\\\\$1\" )\n             .replace( /\\n/, \"\\\\n\" );\n    patterns.push( i.length == 1 ? l : \"(?:\" + l + \")\" );\n  }\n\n  patterns = patterns.join(\"|\");\n  d.__patterns__ = patterns;\n  //print(\"patterns:\", uneval( patterns ) );\n\n  var fn = d.__call__;\n  d.__call__ = function(text, pattern) {\n    if ( pattern != undefined ) {\n      return fn.call(this, text, pattern);\n    }\n    else\n    {\n      return fn.call(this, text, patterns);\n    }\n  };\n};\n\nMarkdown.DialectHelpers = {};\nMarkdown.DialectHelpers.inline_until_char = function( text, want ) {\n  var consumed = 0,\n      nodes = [];\n\n  while ( true ) {\n    if ( text.charAt( consumed ) == want ) {\n      // Found the character we were looking for\n      consumed++;\n      return [ consumed, nodes ];\n    }\n\n    if ( consumed >= text.length ) {\n      // No closing char found. Abort.\n      return null;\n    }\n\n    var res = this.dialect.inline.__oneElement__.call(this, text.substr( consumed ) );\n    consumed += res[ 0 ];\n    // Add any returned nodes.\n    nodes.push.apply( nodes, res.slice( 1 ) );\n  }\n}\n\n// Helper function to make sub-classing a dialect easier\nMarkdown.subclassDialect = function( d ) {\n  function Block() {}\n  Block.prototype = d.block;\n  function Inline() {}\n  Inline.prototype = d.inline;\n\n  return { block: new Block(), inline: new Inline() };\n};\n\nMarkdown.buildBlockOrder ( Markdown.dialects.Gruber.block );\nMarkdown.buildInlinePatterns( Markdown.dialects.Gruber.inline );\n\nMarkdown.dialects.Maruku = Markdown.subclassDialect( Markdown.dialects.Gruber );\n\nMarkdown.dialects.Maruku.processMetaHash = function processMetaHash( meta_string ) {\n  var meta = split_meta_hash( meta_string ),\n      attr = {};\n\n  for ( var i = 0; i < meta.length; ++i ) {\n    // id: #foo\n    if ( /^#/.test( meta[ i ] ) ) {\n      attr.id = meta[ i ].substring( 1 );\n    }\n    // class: .foo\n    else if ( /^\\./.test( meta[ i ] ) ) {\n      // if class already exists, append the new one\n      if ( attr[\"class\"] ) {\n        attr[\"class\"] = attr[\"class\"] + meta[ i ].replace( /./, \" \" );\n      }\n      else {\n        attr[\"class\"] = meta[ i ].substring( 1 );\n      }\n    }\n    // attribute: foo=bar\n    else if ( /\\=/.test( meta[ i ] ) ) {\n      var s = meta[ i ].split( /\\=/ );\n      attr[ s[ 0 ] ] = s[ 1 ];\n    }\n  }\n\n  return attr;\n}\n\nfunction split_meta_hash( meta_string ) {\n  var meta = meta_string.split( \"\" ),\n      parts = [ \"\" ],\n      in_quotes = false;\n\n  while ( meta.length ) {\n    var letter = meta.shift();\n    switch ( letter ) {\n      case \" \" :\n        // if we're in a quoted section, keep it\n        if ( in_quotes ) {\n          parts[ parts.length - 1 ] += letter;\n        }\n        // otherwise make a new part\n        else {\n          parts.push( \"\" );\n        }\n        break;\n      case \"'\" :\n      case '\"' :\n        // reverse the quotes and move straight on\n        in_quotes = !in_quotes;\n        break;\n      case \"\\\\\" :\n        // shift off the next letter to be used straight away.\n        // it was escaped so we'll keep it whatever it is\n        letter = meta.shift();\n      default :\n        parts[ parts.length - 1 ] += letter;\n        break;\n    }\n  }\n\n  return parts;\n}\n\nMarkdown.dialects.Maruku.block.document_meta = function document_meta( block, next ) {\n  // we're only interested in the first block\n  if ( block.lineNumber > 1 ) return undefined;\n\n  // document_meta blocks consist of one or more lines of `Key: Value\\n`\n  if ( ! block.match( /^(?:\\w+:.*\\n)*\\w+:.*$/ ) ) return undefined;\n\n  // make an attribute node if it doesn't exist\n  if ( !extract_attr( this.tree ) ) {\n    this.tree.splice( 1, 0, {} );\n  }\n\n  var pairs = block.split( /\\n/ );\n  for ( p in pairs ) {\n    var m = pairs[ p ].match( /(\\w+):\\s*(.*)$/ ),\n        key = m[ 1 ].toLowerCase(),\n        value = m[ 2 ];\n\n    this.tree[ 1 ][ key ] = value;\n  }\n\n  // document_meta produces no content!\n  return [];\n};\n\nMarkdown.dialects.Maruku.block.block_meta = function block_meta( block, next ) {\n  // check if the last line of the block is an meta hash\n  var m = block.match( /(^|\\n) {0,3}\\{:\\s*((?:\\\\\\}|[^\\}])*)\\s*\\}$/ );\n  if ( !m ) return undefined;\n\n  // process the meta hash\n  var attr = this.dialect.processMetaHash( m[ 2 ] );\n\n  var hash;\n\n  // if we matched ^ then we need to apply meta to the previous block\n  if ( m[ 1 ] === \"\" ) {\n    var node = this.tree[ this.tree.length - 1 ];\n    hash = extract_attr( node );\n\n    // if the node is a string (rather than JsonML), bail\n    if ( typeof node === \"string\" ) return undefined;\n\n    // create the attribute hash if it doesn't exist\n    if ( !hash ) {\n      hash = {};\n      node.splice( 1, 0, hash );\n    }\n\n    // add the attributes in\n    for ( a in attr ) {\n      hash[ a ] = attr[ a ];\n    }\n\n    // return nothing so the meta hash is removed\n    return [];\n  }\n\n  // pull the meta hash off the block and process what's left\n  var b = block.replace( /\\n.*$/, \"\" ),\n      result = this.processBlock( b, [] );\n\n  // get or make the attributes hash\n  hash = extract_attr( result[ 0 ] );\n  if ( !hash ) {\n    hash = {};\n    result[ 0 ].splice( 1, 0, hash );\n  }\n\n  // attach the attributes to the block\n  for ( a in attr ) {\n    hash[ a ] = attr[ a ];\n  }\n\n  return result;\n};\n\nMarkdown.dialects.Maruku.block.definition_list = function definition_list( block, next ) {\n  // one or more terms followed by one or more definitions, in a single block\n  var tight = /^((?:[^\\s:].*\\n)+):\\s+([\\s\\S]+)$/,\n      list = [ \"dl\" ],\n      i, m;\n\n  // see if we're dealing with a tight or loose block\n  if ( ( m = block.match( tight ) ) ) {\n    // pull subsequent tight DL blocks out of `next`\n    var blocks = [ block ];\n    while ( next.length && tight.exec( next[ 0 ] ) ) {\n      blocks.push( next.shift() );\n    }\n\n    for ( var b = 0; b < blocks.length; ++b ) {\n      var m = blocks[ b ].match( tight ),\n          terms = m[ 1 ].replace( /\\n$/, \"\" ).split( /\\n/ ),\n          defns = m[ 2 ].split( /\\n:\\s+/ );\n\n      // print( uneval( m ) );\n\n      for ( i = 0; i < terms.length; ++i ) {\n        list.push( [ \"dt\", terms[ i ] ] );\n      }\n\n      for ( i = 0; i < defns.length; ++i ) {\n        // run inline processing over the definition\n        list.push( [ \"dd\" ].concat( this.processInline( defns[ i ].replace( /(\\n)\\s+/, \"$1\" ) ) ) );\n      }\n    }\n  }\n  else {\n    return undefined;\n  }\n\n  return [ list ];\n};\n\n// splits on unescaped instances of @ch. If @ch is not a character the result\n// can be unpredictable\n\nMarkdown.dialects.Maruku.block.table = function table (block, next) {\n\n    var _split_on_unescaped = function(s, ch) {\n        ch = ch || '\\\\s';\n        if (ch.match(/^[\\\\|\\[\\]{}?*.+^$]$/)) { ch = '\\\\' + ch; }\n        var res = [ ],\n            r = new RegExp('^((?:\\\\\\\\.|[^\\\\\\\\' + ch + '])*)' + ch + '(.*)'),\n            m;\n        while(m = s.match(r)) {\n            res.push(m[1]);\n            s = m[2];\n        }\n        res.push(s);\n        return res;\n    }\n\n    var leading_pipe = /^ {0,3}\\|(.+)\\n {0,3}\\|\\s*([\\-:]+[\\-| :]*)\\n((?:\\s*\\|.*(?:\\n|$))*)(?=\\n|$)/,\n        // find at least an unescaped pipe in each line\n        no_leading_pipe = /^ {0,3}(\\S(?:\\\\.|[^\\\\|])*\\|.*)\\n {0,3}([\\-:]+\\s*\\|[\\-| :]*)\\n((?:(?:\\\\.|[^\\\\|])*\\|.*(?:\\n|$))*)(?=\\n|$)/,\n        i, m;\n    if (m = block.match(leading_pipe)) {\n        // remove leading pipes in contents\n        // (header and horizontal rule already have the leading pipe left out)\n        m[3] = m[3].replace(/^\\s*\\|/gm, '');\n    } else if (! ( m = block.match(no_leading_pipe))) {\n        return undefined;\n    }\n\n    var table = [ \"table\", [ \"thead\", [ \"tr\" ] ], [ \"tbody\" ] ];\n\n    // remove trailing pipes, then split on pipes\n    // (no escaped pipes are allowed in horizontal rule)\n    m[2] = m[2].replace(/\\|\\s*$/, '').split('|');\n\n    // process alignment\n    var html_attrs = [ ];\n    forEach (m[2], function (s) {\n        if (s.match(/^\\s*-+:\\s*$/))       html_attrs.push({align: \"right\"});\n        else if (s.match(/^\\s*:-+\\s*$/))  html_attrs.push({align: \"left\"});\n        else if (s.match(/^\\s*:-+:\\s*$/)) html_attrs.push({align: \"center\"});\n        else                              html_attrs.push({});\n    });\n\n    // now for the header, avoid escaped pipes\n    m[1] = _split_on_unescaped(m[1].replace(/\\|\\s*$/, ''), '|');\n    for (i = 0; i < m[1].length; i++) {\n        table[1][1].push(['th', html_attrs[i] || {}].concat(\n            this.processInline(m[1][i].trim())));\n    }\n\n    // now for body contents\n    forEach (m[3].replace(/\\|\\s*$/mg, '').split('\\n'), function (row) {\n        var html_row = ['tr'];\n        row = _split_on_unescaped(row, '|');\n        for (i = 0; i < row.length; i++) {\n            html_row.push(['td', html_attrs[i] || {}].concat(this.processInline(row[i].trim())));\n        }\n        table[2].push(html_row);\n    }, this);\n\n    return [table];\n}\n\nMarkdown.dialects.Maruku.inline[ \"{:\" ] = function inline_meta( text, matches, out ) {\n  if ( !out.length ) {\n    return [ 2, \"{:\" ];\n  }\n\n  // get the preceeding element\n  var before = out[ out.length - 1 ];\n\n  if ( typeof before === \"string\" ) {\n    return [ 2, \"{:\" ];\n  }\n\n  // match a meta hash\n  var m = text.match( /^\\{:\\s*((?:\\\\\\}|[^\\}])*)\\s*\\}/ );\n\n  // no match, false alarm\n  if ( !m ) {\n    return [ 2, \"{:\" ];\n  }\n\n  // attach the attributes to the preceeding element\n  var meta = this.dialect.processMetaHash( m[ 1 ] ),\n      attr = extract_attr( before );\n\n  if ( !attr ) {\n    attr = {};\n    before.splice( 1, 0, attr );\n  }\n\n  for ( var k in meta ) {\n    attr[ k ] = meta[ k ];\n  }\n\n  // cut out the string and replace it with nothing\n  return [ m[ 0 ].length, \"\" ];\n};\n\nMarkdown.dialects.Maruku.inline.__escape__ = /^\\\\[\\\\`\\*_{}\\[\\]()#\\+.!\\-|:]/;\n\nMarkdown.buildBlockOrder ( Markdown.dialects.Maruku.block );\nMarkdown.buildInlinePatterns( Markdown.dialects.Maruku.inline );\n\nvar isArray = Array.isArray || function(obj) {\n  return Object.prototype.toString.call(obj) == \"[object Array]\";\n};\n\nvar forEach;\n// Don't mess with Array.prototype. Its not friendly\nif ( Array.prototype.forEach ) {\n  forEach = function( arr, cb, thisp ) {\n    return arr.forEach( cb, thisp );\n  };\n}\nelse {\n  forEach = function(arr, cb, thisp) {\n    for (var i = 0; i < arr.length; i++) {\n      cb.call(thisp || arr, arr[i], i, arr);\n    }\n  }\n}\n\nvar isEmpty = function( obj ) {\n  for ( var key in obj ) {\n    if ( hasOwnProperty.call( obj, key ) ) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction extract_attr( jsonml ) {\n  return isArray(jsonml)\n      && jsonml.length > 1\n      && typeof jsonml[ 1 ] === \"object\"\n      && !( isArray(jsonml[ 1 ]) )\n      ? jsonml[ 1 ]\n      : undefined;\n}\n\n\n\n/**\n *  renderJsonML( jsonml[, options] ) -> String\n *  - jsonml (Array): JsonML array to render to XML\n *  - options (Object): options\n *\n *  Converts the given JsonML into well-formed XML.\n *\n *  The options currently understood are:\n *\n *  - root (Boolean): wether or not the root node should be included in the\n *    output, or just its children. The default `false` is to not include the\n *    root itself.\n */\nexpose.renderJsonML = function( jsonml, options ) {\n  options = options || {};\n  // include the root element in the rendered output?\n  options.root = options.root || false;\n\n  var content = [];\n\n  if ( options.root ) {\n    content.push( render_tree( jsonml ) );\n  }\n  else {\n    jsonml.shift(); // get rid of the tag\n    if ( jsonml.length && typeof jsonml[ 0 ] === \"object\" && !( jsonml[ 0 ] instanceof Array ) ) {\n      jsonml.shift(); // get rid of the attributes\n    }\n\n    while ( jsonml.length ) {\n      content.push( render_tree( jsonml.shift() ) );\n    }\n  }\n\n  return content.join( \"\\n\\n\" );\n};\n\nfunction escapeHTML( text ) {\n  return text.replace( /&/g, \"&amp;\" )\n             .replace( /</g, \"&lt;\" )\n             .replace( />/g, \"&gt;\" )\n             .replace( /\"/g, \"&quot;\" )\n             .replace( /'/g, \"&#39;\" );\n}\n\nfunction render_tree( jsonml ) {\n  // basic case\n  if ( typeof jsonml === \"string\" ) {\n    return escapeHTML( jsonml );\n  }\n\n  var tag = jsonml.shift(),\n      attributes = {},\n      content = [];\n\n  if ( jsonml.length && typeof jsonml[ 0 ] === \"object\" && !( jsonml[ 0 ] instanceof Array ) ) {\n    attributes = jsonml.shift();\n  }\n\n  while ( jsonml.length ) {\n    content.push( render_tree( jsonml.shift() ) );\n  }\n\n  var tag_attrs = \"\";\n  for ( var a in attributes ) {\n    tag_attrs += \" \" + a + '=\"' + escapeHTML( attributes[ a ] ) + '\"';\n  }\n\n  // be careful about adding whitespace here for inline elements\n  if ( tag == \"img\" || tag == \"br\" || tag == \"hr\" ) {\n    return \"<\"+ tag + tag_attrs + \"/>\";\n  }\n  else {\n    return \"<\"+ tag + tag_attrs + \">\" + content.join( \"\" ) + \"</\" + tag + \">\";\n  }\n}\n\nfunction convert_tree_to_html( tree, references, options ) {\n  var i;\n  options = options || {};\n\n  // shallow clone\n  var jsonml = tree.slice( 0 );\n\n  if ( typeof options.preprocessTreeNode === \"function\" ) {\n      jsonml = options.preprocessTreeNode(jsonml, references);\n  }\n\n  // Clone attributes if they exist\n  var attrs = extract_attr( jsonml );\n  if ( attrs ) {\n    jsonml[ 1 ] = {};\n    for ( i in attrs ) {\n      jsonml[ 1 ][ i ] = attrs[ i ];\n    }\n    attrs = jsonml[ 1 ];\n  }\n\n  // basic case\n  if ( typeof jsonml === \"string\" ) {\n    return jsonml;\n  }\n\n  // convert this node\n  switch ( jsonml[ 0 ] ) {\n    case \"header\":\n      jsonml[ 0 ] = \"h\" + jsonml[ 1 ].level;\n      delete jsonml[ 1 ].level;\n      break;\n    case \"bulletlist\":\n      jsonml[ 0 ] = \"ul\";\n      break;\n    case \"numberlist\":\n      jsonml[ 0 ] = \"ol\";\n      break;\n    case \"listitem\":\n      jsonml[ 0 ] = \"li\";\n      break;\n    case \"para\":\n      jsonml[ 0 ] = \"p\";\n      break;\n    case \"markdown\":\n      jsonml[ 0 ] = \"html\";\n      if ( attrs ) delete attrs.references;\n      break;\n    case \"code_block\":\n      jsonml[ 0 ] = \"pre\";\n      i = attrs ? 2 : 1;\n      var code = [ \"code\" ];\n      code.push.apply( code, jsonml.splice( i, jsonml.length - i ) );\n      jsonml[ i ] = code;\n      break;\n    case \"inlinecode\":\n      jsonml[ 0 ] = \"code\";\n      break;\n    case \"img\":\n      jsonml[ 1 ].src = jsonml[ 1 ].href;\n      delete jsonml[ 1 ].href;\n      break;\n    case \"linebreak\":\n      jsonml[ 0 ] = \"br\";\n    break;\n    case \"link\":\n      jsonml[ 0 ] = \"a\";\n      break;\n    case \"link_ref\":\n      jsonml[ 0 ] = \"a\";\n\n      // grab this ref and clean up the attribute node\n      var ref = references[ attrs.ref ];\n\n      // if the reference exists, make the link\n      if ( ref ) {\n        delete attrs.ref;\n\n        // add in the href and title, if present\n        attrs.href = ref.href;\n        if ( ref.title ) {\n          attrs.title = ref.title;\n        }\n\n        // get rid of the unneeded original text\n        delete attrs.original;\n      }\n      // the reference doesn't exist, so revert to plain text\n      else {\n        return attrs.original;\n      }\n      break;\n    case \"img_ref\":\n      jsonml[ 0 ] = \"img\";\n\n      // grab this ref and clean up the attribute node\n      var ref = references[ attrs.ref ];\n\n      // if the reference exists, make the link\n      if ( ref ) {\n        delete attrs.ref;\n\n        // add in the href and title, if present\n        attrs.src = ref.href;\n        if ( ref.title ) {\n          attrs.title = ref.title;\n        }\n\n        // get rid of the unneeded original text\n        delete attrs.original;\n      }\n      // the reference doesn't exist, so revert to plain text\n      else {\n        return attrs.original;\n      }\n      break;\n  }\n\n  // convert all the children\n  i = 1;\n\n  // deal with the attribute node, if it exists\n  if ( attrs ) {\n    // if there are keys, skip over it\n    for ( var key in jsonml[ 1 ] ) {\n        i = 2;\n        break;\n    }\n    // if there aren't, remove it\n    if ( i === 1 ) {\n      jsonml.splice( i, 1 );\n    }\n  }\n\n  for ( ; i < jsonml.length; ++i ) {\n    jsonml[ i ] = convert_tree_to_html( jsonml[ i ], references, options );\n  }\n\n  return jsonml;\n}\n\n\n// merges adjacent text nodes into a single node\nfunction merge_text_nodes( jsonml ) {\n  // skip the tag name and attribute hash\n  var i = extract_attr( jsonml ) ? 2 : 1;\n\n  while ( i < jsonml.length ) {\n    // if it's a string check the next item too\n    if ( typeof jsonml[ i ] === \"string\" ) {\n      if ( i + 1 < jsonml.length && typeof jsonml[ i + 1 ] === \"string\" ) {\n        // merge the second string into the first and remove it\n        jsonml[ i ] += jsonml.splice( i + 1, 1 )[ 0 ];\n      }\n      else {\n        ++i;\n      }\n    }\n    // if it's not a string recurse\n    else {\n      merge_text_nodes( jsonml[ i ] );\n      ++i;\n    }\n  }\n}\n\n} )( (function() {\n  if ( typeof exports === \"undefined\" ) {\n    window.markdown = {};\n    return window.markdown;\n  }\n  else {\n    return exports;\n  }\n} )() );\n",
    "/*\n* jQuery UI Tag-it!\n*\n* @version v2.0 (06/2011)\n*\n* Copyright 2011, Levy Carneiro Jr.\n* Released under the MIT license.\n* http://aehlke.github.com/tag-it/LICENSE\n*\n* Homepage:\n*   http://aehlke.github.com/tag-it/\n*\n* Authors:\n*   Levy Carneiro Jr.\n*   Martin Rehfeld\n*   Tobias Schmidt\n*   Skylar Challand\n*   Alex Ehlke\n*\n* Maintainer:\n*   Alex Ehlke - Twitter: @aehlke\n*\n* Dependencies:\n*   jQuery v1.4+\n*   jQuery UI v1.8+\n*/\n(function($) {\n\n    $.widget('ui.tagit', {\n        options: {\n            allowDuplicates   : false,\n            caseSensitive     : true,\n            fieldName         : 'tags',\n            placeholderText   : null,   // Sets `placeholder` attr on input field.\n            readOnly          : false,  // Disables editing.\n            removeConfirmation: false,  // Require confirmation to remove tags.\n            tagLimit          : null,   // Max number of tags allowed (null for unlimited).\n\n            // Used for autocomplete, unless you override `autocomplete.source`.\n            availableTags     : [],\n\n            // Use to override or add any options to the autocomplete widget.\n            //\n            // By default, autocomplete.source will map to availableTags,\n            // unless overridden.\n            autocomplete: {},\n\n            // Shows autocomplete before the user even types anything.\n            showAutocompleteOnFocus: false,\n\n            // When enabled, quotes are unneccesary for inputting multi-word tags.\n            allowSpaces: false,\n\n            // The below options are for using a single field instead of several\n            // for our form values.\n            //\n            // When enabled, will use a single hidden field for the form,\n            // rather than one per tag. It will delimit tags in the field\n            // with singleFieldDelimiter.\n            //\n            // The easiest way to use singleField is to just instantiate tag-it\n            // on an INPUT element, in which case singleField is automatically\n            // set to true, and singleFieldNode is set to that element. This\n            // way, you don't need to fiddle with these options.\n            singleField: false,\n\n            // This is just used when preloading data from the field, and for\n            // populating the field with delimited tags as the user adds them.\n            singleFieldDelimiter: ',',\n\n            // Set this to an input DOM node to use an existing form field.\n            // Any text in it will be erased on init. But it will be\n            // populated with the text of tags as they are created,\n            // delimited by singleFieldDelimiter.\n            //\n            // If this is not set, we create an input node for it,\n            // with the name given in settings.fieldName.\n            singleFieldNode: null,\n\n            // Whether to animate tag removals or not.\n            animate: true,\n\n            // Optionally set a tabindex attribute on the input that gets\n            // created for tag-it.\n            tabIndex: null,\n\n            // Event callbacks.\n            beforeTagAdded      : null,\n            afterTagAdded       : null,\n\n            beforeTagRemoved    : null,\n            afterTagRemoved     : null,\n\n            onTagClicked        : null,\n            onTagLimitExceeded  : null,\n\n\n            // DEPRECATED:\n            //\n            // /!\\ These event callbacks are deprecated and WILL BE REMOVED at some\n            // point in the future. They're here for backwards-compatibility.\n            // Use the above before/after event callbacks instead.\n            onTagAdded  : null,\n            onTagRemoved: null,\n            // `autocomplete.source` is the replacement for tagSource.\n            tagSource: null,\n            onSubmitTags: null,\n            onFocus: null,\n            onBlur: null\n            // Do not use the above deprecated options.\n        },\n\n        _create: function() {\n            // for handling static scoping inside callbacks\n            var that = this;\n\n            // There are 2 kinds of DOM nodes this widget can be instantiated on:\n            //     1. UL, OL, or some element containing either of these.\n            //     2. INPUT, in which case 'singleField' is overridden to true,\n            //        a UL is created and the INPUT is hidden.\n            if (this.element.is('input')) {\n                this.tagList = $('<ul></ul>').insertAfter(this.element);\n                this.options.singleField = true;\n                this.options.singleFieldNode = this.element;\n                this.element.addClass('tagit-hidden-field');\n            } else {\n                this.tagList = this.element.find('ul, ol').andSelf().last();\n            }\n\n            this.tagInput = $('<input type=\"text\" />').addClass('ui-widget-content');\n\n            if (this.options.readOnly) this.tagInput.attr('disabled', 'disabled');\n\n            if (this.options.tabIndex) {\n                this.tagInput.attr('tabindex', this.options.tabIndex);\n            }\n\n            if (this.options.placeholderText) {\n                this.tagInput.attr('placeholder', this.options.placeholderText);\n            }\n\n            if (!this.options.autocomplete.source) {\n                this.options.autocomplete.source = function(search, showChoices) {\n                    var filter = search.term.toLowerCase();\n                    var choices = $.grep(this.options.availableTags, function(element) {\n                        // Only match autocomplete options that begin with the search term.\n                        // (Case insensitive.)\n                        return (element.toLowerCase().indexOf(filter) === 0);\n                    });\n                    if (!this.options.allowDuplicates) {\n                        choices = this._subtractArray(choices, this.assignedTags());\n                    }\n                    showChoices(choices);\n                };\n            }\n\n            if (this.options.showAutocompleteOnFocus) {\n                this.tagInput.focus(function(event, ui) {\n                    that._showAutocomplete();\n                });\n\n                if (typeof this.options.autocomplete.minLength === 'undefined') {\n                    this.options.autocomplete.minLength = 0;\n                }\n            }\n\n            // Bind autocomplete.source callback functions to this context.\n            if ($.isFunction(this.options.autocomplete.source)) {\n                this.options.autocomplete.source = $.proxy(this.options.autocomplete.source, this);\n            }\n\n            // DEPRECATED.\n            if ($.isFunction(this.options.tagSource)) {\n                this.options.tagSource = $.proxy(this.options.tagSource, this);\n            }\n\n            this.tagList\n                .addClass('tagit')\n                .addClass('ui-widget ui-widget-content ui-corner-all')\n                // Create the input field.\n                .append($('<li class=\"tagit-new\"></li>').append(this.tagInput))\n                .click(function(e) {\n                    var target = $(e.target);\n                    if (target.hasClass('tagit-label')) {\n                        var tag = target.closest('.tagit-choice');\n                        if (!tag.hasClass('removed')) {\n                            that._trigger('onTagClicked', e, {tag: tag, tagLabel: that.tagLabel(tag)});\n                        }\n                    } else {\n                        // Sets the focus() to the input field, if the user\n                        // clicks anywhere inside the UL. This is needed\n                        // because the input field needs to be of a small size.\n                        that.tagInput.focus();\n                    }\n                });\n\n            // Single field support.\n            var addedExistingFromSingleFieldNode = false;\n            if (this.options.singleField) {\n                if (this.options.singleFieldNode) {\n                    // Add existing tags from the input field.\n                    var node = $(this.options.singleFieldNode);\n                    var tags = node.val().split(this.options.singleFieldDelimiter);\n                    node.val('');\n                    $.each(tags, function(index, tag) {\n                        that.createTag(tag, null, true);\n                        addedExistingFromSingleFieldNode = true;\n                    });\n                } else {\n                    // Create our single field input after our list.\n                    this.options.singleFieldNode = $('<input type=\"hidden\" style=\"display:none;\" value=\"\" name=\"' + this.options.fieldName + '\" />');\n                    this.tagList.after(this.options.singleFieldNode);\n                }\n            }\n\n            // Add existing tags from the list, if any.\n            if (!addedExistingFromSingleFieldNode) {\n                this.tagList.children('li').each(function() {\n                    if (!$(this).hasClass('tagit-new')) {\n                        that.createTag($(this).text(), $(this).attr('class'), true);\n                        $(this).remove();\n                    }\n                });\n            }\n\n            // Events.\n            this.tagInput\n                .keydown(function(event) {\n                    // Backspace is not detected within a keypress, so it must use keydown.\n                    if (event.which == $.ui.keyCode.BACKSPACE && that.tagInput.val() === '') {\n                        var tag = that._lastTag();\n                        if (!that.options.removeConfirmation || tag.hasClass('remove')) {\n                            // When backspace is pressed, the last tag is deleted.\n                            that.removeTag(tag);\n                        } else if (that.options.removeConfirmation) {\n                            tag.addClass('remove ui-state-highlight');\n                        }\n                    } else if (that.options.removeConfirmation) {\n                        that._lastTag().removeClass('remove ui-state-highlight');\n                    } else if (event.which == $.ui.keyCode.ENTER && that.tagInput.val() === \"\") {\n                        that._trigger('onSubmitTags', null, that.tagList);\n                    }\n\n                    // Comma/Space/Enter are all valid delimiters for new tags,\n                    // except when there is an open quote or if setting allowSpaces = true.\n                    // Tab will also create a tag, unless the tag input is empty,\n                    // in which case it isn't caught.\n                    if (\n                        (event.which === $.ui.keyCode.COMMA && event.shiftKey === false) ||\n                        event.which === $.ui.keyCode.ENTER ||\n                        (\n                            event.which == $.ui.keyCode.TAB &&\n                            that.tagInput.val() !== ''\n                        ) ||\n                        (\n                            event.which == $.ui.keyCode.SPACE &&\n                            that.options.allowSpaces !== true &&\n                            (\n                                $.trim(that.tagInput.val()).replace( /^s*/, '' ).charAt(0) != '\"' ||\n                                (\n                                    $.trim(that.tagInput.val()).charAt(0) == '\"' &&\n                                    $.trim(that.tagInput.val()).charAt($.trim(that.tagInput.val()).length - 1) == '\"' &&\n                                    $.trim(that.tagInput.val()).length - 1 !== 0\n                                )\n                            )\n                        )\n                    ) {\n                        // Enter submits the form if there's no text in the input.\n                        if (!(event.which === $.ui.keyCode.ENTER && that.tagInput.val() === '')) {\n                            event.preventDefault();\n                        }\n\n                        // Autocomplete will create its own tag from a selection and close automatically.\n                        if (!(that.options.autocomplete.autoFocus && that.tagInput.data('autocomplete-open'))) {\n                            that.tagInput.autocomplete('close');\n                            that.createTag(that._cleanedInput());\n                        }\n                    }\n                }).blur(function(e){\n                    that._trigger('onBlur', null, null);\n                    // Create a tag when the element loses focus.\n                    // If autocomplete is enabled and suggestion was clicked, don't add it.\n                    if (!that.tagInput.data('autocomplete-open')) {\n                        that.createTag(that._cleanedInput());\n                    }\n                }).focus(function(e) {\n                    that._trigger('onFocus', null, null);\n                })\n\n            // Autocomplete.\n            if (this.options.availableTags || this.options.tagSource || this.options.autocomplete.source) {\n                var autocompleteOptions = {\n                    select: function(event, ui) {\n                        that.createTag(ui.item.value);\n                        // Preventing the tag input to be updated with the chosen value.\n                        return false;\n                    }\n                };\n                $.extend(autocompleteOptions, this.options.autocomplete);\n\n                // tagSource is deprecated, but takes precedence here since autocomplete.source is set by default,\n                // while tagSource is left null by default.\n                autocompleteOptions.source = this.options.tagSource || autocompleteOptions.source;\n\n                this.tagInput.autocomplete(autocompleteOptions).bind('autocompleteopen.tagit', function(event, ui) {\n                    that.tagInput.data('autocomplete-open', true);\n                }).bind('autocompleteclose.tagit', function(event, ui) {\n                    that.tagInput.data('autocomplete-open', false);\n                });\n\n                this.tagInput.autocomplete('widget').addClass('tagit-autocomplete');\n            }\n        },\n\n        destroy: function() {\n            $.Widget.prototype.destroy.call(this);\n\n            this.element.unbind('.tagit');\n            this.tagList.unbind('.tagit');\n\n            this.tagInput.removeData('autocomplete-open');\n\n            this.tagList.removeClass([\n                'tagit',\n                'ui-widget',\n                'ui-widget-content',\n                'ui-corner-all',\n                'tagit-hidden-field'\n            ].join(' '));\n\n            if (this.element.is('input')) {\n                this.element.removeClass('tagit-hidden-field');\n                this.tagList.remove();\n            } else {\n                this.element.children('li').each(function() {\n                    if ($(this).hasClass('tagit-new')) {\n                        $(this).remove();\n                    } else {\n                        $(this).removeClass([\n                            'tagit-choice',\n                            'ui-widget-content',\n                            'ui-state-default',\n                            'ui-state-highlight',\n                            'ui-corner-all',\n                            'remove',\n                            'tagit-choice-editable',\n                            'tagit-choice-read-only'\n                        ].join(' '));\n\n                        $(this).text($(this).children('.tagit-label').text());\n                    }\n                });\n\n                if (this.singleFieldNode) {\n                    this.singleFieldNode.remove();\n                }\n            }\n\n            return this;\n        },\n\n        _cleanedInput: function() {\n            // Returns the contents of the tag input, cleaned and ready to be passed to createTag\n            return $.trim(this.tagInput.val().replace(/^\"(.*)\"$/, '$1'));\n        },\n\n        _lastTag: function() {\n            return this.tagList.find('.tagit-choice:last:not(.removed)');\n        },\n\n        _tags: function() {\n            return this.tagList.find('.tagit-choice:not(.removed)');\n        },\n\n        assignedTags: function() {\n            // Returns an array of tag string values\n            var that = this;\n            var tags = [];\n            if (this.options.singleField) {\n                tags = $(this.options.singleFieldNode).val().split(this.options.singleFieldDelimiter);\n                if (tags[0] === '') {\n                    tags = [];\n                }\n            } else {\n                this._tags().each(function() {\n                    tags.push(that.tagLabel(this));\n                });\n            }\n            return tags;\n        },\n\n        _updateSingleTagsField: function(tags) {\n            // Takes a list of tag string values, updates this.options.singleFieldNode.val to the tags delimited by this.options.singleFieldDelimiter\n            $(this.options.singleFieldNode).val(tags.join(this.options.singleFieldDelimiter)).trigger('change');\n        },\n\n        _subtractArray: function(a1, a2) {\n            var result = [];\n            for (var i = 0; i < a1.length; i++) {\n                if ($.inArray(a1[i], a2) == -1) {\n                    result.push(a1[i]);\n                }\n            }\n            return result;\n        },\n\n        tagLabel: function(tag) {\n            // Returns the tag's string label.\n            if (this.options.singleField) {\n                return $(tag).find('.tagit-label:first').text();\n            } else {\n                return $(tag).find('input:first').val();\n            }\n        },\n\n        _showAutocomplete: function() {\n            this.tagInput.autocomplete('search', '');\n        },\n\n        _findTagByLabel: function(name) {\n            var that = this;\n            var tag = null;\n            this._tags().each(function(i) {\n                if (that._formatStr(name) == that._formatStr(that.tagLabel(this))) {\n                    tag = $(this);\n                    return false;\n                }\n            });\n            return tag;\n        },\n\n        _isNew: function(name) {\n            return !this._findTagByLabel(name);\n        },\n\n        _formatStr: function(str) {\n            if (this.options.caseSensitive) {\n                return str;\n            }\n            return $.trim(str.toLowerCase());\n        },\n\n        _effectExists: function(name) {\n            return Boolean($.effects && ($.effects[name] || ($.effects.effect && $.effects.effect[name])));\n        },\n\n        createTag: function(value, additionalClass, duringInitialization) {\n            var that = this;\n\n            value = $.trim(value);\n\n            if(this.options.preprocessTag) {\n                value = this.options.preprocessTag(value);\n            }\n\n            if (value === '') {\n                return false;\n            }\n\n            if (!this.options.allowDuplicates && !this._isNew(value)) {\n                var existingTag = this._findTagByLabel(value);\n                if (this._trigger('onTagExists', null, {\n                    existingTag: existingTag,\n                    duringInitialization: duringInitialization\n                }) !== false) {\n                    if (this._effectExists('highlight')) {\n                        existingTag.effect('highlight');\n                    }\n                }\n                return false;\n            }\n\n            if (this.options.tagLimit && this._tags().length >= this.options.tagLimit) {\n                this._trigger('onTagLimitExceeded', null, {duringInitialization: duringInitialization});\n                return false;\n            }\n\n            var label = $(this.options.onTagClicked ? '<a class=\"tagit-label\"></a>' : '<span class=\"tagit-label\"></span>').text(value);\n\n            // Create tag.\n            var tag = $('<li></li>')\n                .addClass('tagit-choice ui-widget-content ui-state-default ui-corner-all')\n                .addClass(additionalClass)\n                .append(label);\n\n            if (this.options.readOnly){\n                tag.addClass('tagit-choice-read-only');\n            } else {\n                tag.addClass('tagit-choice-editable');\n                // Button for removing the tag.\n                var removeTagIcon = $('<span></span>')\n                    .addClass('ui-icon ui-icon-close');\n                var removeTag = $('<a><span class=\"text-icon\">\\xd7</span></a>') // \\xd7 is an X\n                    .addClass('tagit-close')\n                    .append(removeTagIcon)\n                    .click(function(e) {\n                        // Removes a tag when the little 'x' is clicked.\n                        that.removeTag(tag);\n                    });\n                tag.append(removeTag);\n            }\n\n            // Unless options.singleField is set, each tag has a hidden input field inline.\n            if (!this.options.singleField) {\n                var escapedValue = label.html();\n                tag.append('<input type=\"hidden\" value=\"' + escapedValue + '\" name=\"' + this.options.fieldName + '\" class=\"tagit-hidden-field\" />');\n            }\n\n            if (this._trigger('beforeTagAdded', null, {\n                tag: tag,\n                tagLabel: this.tagLabel(tag),\n                duringInitialization: duringInitialization\n            }) === false) {\n                return;\n            }\n\n            if (this.options.singleField) {\n                var tags = this.assignedTags();\n                tags.push(value);\n                this._updateSingleTagsField(tags);\n            }\n\n            // DEPRECATED.\n            this._trigger('onTagAdded', null, tag);\n\n            this.tagInput.val('');\n\n            // Insert tag.\n            this.tagInput.parent().before(tag);\n\n            this._trigger('afterTagAdded', null, {\n                tag: tag,\n                tagLabel: this.tagLabel(tag),\n                duringInitialization: duringInitialization\n            });\n\n            if (this.options.showAutocompleteOnFocus && !duringInitialization) {\n                setTimeout(function () { that._showAutocomplete(); }, 0);\n            }\n        },\n\n        removeTag: function(tag, animate) {\n            animate = typeof animate === 'undefined' ? this.options.animate : animate;\n\n            tag = $(tag);\n\n            // DEPRECATED.\n            this._trigger('onTagRemoved', null, tag);\n\n            if (this._trigger('beforeTagRemoved', null, {tag: tag, tagLabel: this.tagLabel(tag)}) === false) {\n                return;\n            }\n\n            if (this.options.singleField) {\n                var tags = this.assignedTags();\n                var removedTagLabel = this.tagLabel(tag);\n                tags = $.grep(tags, function(el){\n                    return el != removedTagLabel;\n                });\n                this._updateSingleTagsField(tags);\n            }\n\n            if (animate) {\n                tag.addClass('removed'); // Excludes this tag from _tags.\n                var hide_args = this._effectExists('blind') ? ['blind', {direction: 'horizontal'}, 'fast'] : ['fast'];\n\n                var thisTag = this;\n                hide_args.push(function() {\n                    tag.remove();\n                    thisTag._trigger('afterTagRemoved', null, {tag: tag, tagLabel: thisTag.tagLabel(tag)});\n                });\n\n                tag.fadeOut('fast').hide.apply(tag, hide_args).dequeue();\n            } else {\n                tag.remove();\n                this._trigger('afterTagRemoved', null, {tag: tag, tagLabel: this.tagLabel(tag)});\n            }\n\n        },\n\n        removeTagByLabel: function(tagLabel, animate) {\n            var toRemove = this._findTagByLabel(tagLabel);\n            if (!toRemove) {\n                throw \"No such tag exists with the name '\" + tagLabel + \"'\";\n            }\n            this.removeTag(toRemove, animate);\n        },\n\n        removeAll: function() {\n            // Removes all tags.\n            var that = this;\n            this._tags().each(function(index, tag) {\n                that.removeTag(tag, false);\n            });\n        }\n\n    });\n})(jQuery);\n"
  ]
}
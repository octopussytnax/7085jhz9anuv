{
  "version": 3,
  "sources": [
    "node_modules/browser-pack/_prelude.js",
    "lib/assets/javascripts/cartodb/common/asset_model.js",
    "lib/assets/javascripts/cartodb/common/avatar_selector_view.js",
    "lib/assets/javascripts/cartodb/common/delete_organization_view.js",
    "lib/assets/javascripts/cartodb/common/dialogs/add_group_users/add_group_users_view.js",
    "lib/assets/javascripts/cartodb/common/local_storage.js",
    "lib/assets/javascripts/cartodb/common/paged_search_model.js",
    "lib/assets/javascripts/cartodb/common/router.js",
    "lib/assets/javascripts/cartodb/common/scroll/scroll-view.js",
    "lib/assets/javascripts/cartodb/common/scroll/scroll.tpl",
    "lib/assets/javascripts/cartodb/common/support_view.js",
    "lib/assets/javascripts/cartodb/common/view_factory.js",
    "lib/assets/javascripts/cartodb/common/view_helpers/bytes_to_size.js",
    "lib/assets/javascripts/cartodb/common/view_helpers/navigate_through_router.js",
    "lib/assets/javascripts/cartodb/common/view_helpers/pluralize_string.js",
    "lib/assets/javascripts/cartodb/common/view_helpers/random_quote.js",
    "lib/assets/javascripts/cartodb/common/views/base_dialog/view.js",
    "lib/assets/javascripts/cartodb/common/views/dashboard_header/breadcrumbs/dropdown_view.js",
    "lib/assets/javascripts/cartodb/common/views/dashboard_header/notifications/collection.js",
    "lib/assets/javascripts/cartodb/common/views/dashboard_header/notifications/dropdown_view.js",
    "lib/assets/javascripts/cartodb/common/views/dashboard_header/notifications/model.js",
    "lib/assets/javascripts/cartodb/common/views/dashboard_header/notifications/organization-model.js",
    "lib/assets/javascripts/cartodb/common/views/dashboard_header/notifications/view.js",
    "lib/assets/javascripts/cartodb/common/views/dashboard_header/settings_dropdown_view.js",
    "lib/assets/javascripts/cartodb/common/views/dashboard_header/user_support_view.js",
    "lib/assets/javascripts/cartodb/common/views/dashboard_header_view.js",
    "lib/assets/javascripts/cartodb/common/views/paged_search/paged_search_view.js",
    "lib/assets/javascripts/cartodb/common/views/pagination/model.js",
    "lib/assets/javascripts/cartodb/common/views/pagination/view.js",
    "lib/assets/javascripts/cartodb/keys/regenerate_keys_dialog_view.js",
    "lib/assets/javascripts/cartodb/organization/color_picker_view.js",
    "lib/assets/javascripts/cartodb/organization/delete_org_user_view.js",
    "lib/assets/javascripts/cartodb/organization/entry.js",
    "lib/assets/javascripts/cartodb/organization/flash_message_model.js",
    "lib/assets/javascripts/cartodb/organization/flash_message_view.js",
    "lib/assets/javascripts/cartodb/organization/groups_admin/add_or_remove_group_users_filters_extra_view.js",
    "lib/assets/javascripts/cartodb/organization/groups_admin/create_group_view.js",
    "lib/assets/javascripts/cartodb/organization/groups_admin/edit_group_view.js",
    "lib/assets/javascripts/cartodb/organization/groups_admin/empty_group_filters_extra_view.js",
    "lib/assets/javascripts/cartodb/organization/groups_admin/group_header_view.js",
    "lib/assets/javascripts/cartodb/organization/groups_admin/group_user_view.js",
    "lib/assets/javascripts/cartodb/organization/groups_admin/group_users_list_view.js",
    "lib/assets/javascripts/cartodb/organization/groups_admin/group_users_view.js",
    "lib/assets/javascripts/cartodb/organization/groups_admin/group_view.js",
    "lib/assets/javascripts/cartodb/organization/groups_admin/groups_index_view.js",
    "lib/assets/javascripts/cartodb/organization/groups_admin/groups_list_view.js",
    "lib/assets/javascripts/cartodb/organization/groups_admin/groups_main_view.js",
    "lib/assets/javascripts/cartodb/organization/groups_admin/router.js",
    "lib/assets/javascripts/cartodb/organization/groups_admin/router_model.js",
    "lib/assets/javascripts/cartodb/organization/header_view_model.js",
    "lib/assets/javascripts/cartodb/organization/icon_picker/icon_picker_dialog/icon_picker_dialog_view.js",
    "lib/assets/javascripts/cartodb/organization/icon_picker/icons/delete_icons_dialog_view.js",
    "lib/assets/javascripts/cartodb/organization/icon_picker/icons/organization_icon_collection.js",
    "lib/assets/javascripts/cartodb/organization/icon_picker/icons/organization_icon_model.js",
    "lib/assets/javascripts/cartodb/organization/icon_picker/icons/organization_icon_view.js",
    "lib/assets/javascripts/cartodb/organization/icon_picker/icons/organization_icons_view.js",
    "lib/assets/javascripts/cartodb/organization/icon_picker/organization_icon_picker_view.js",
    "lib/assets/javascripts/cartodb/organization/invite_users/invite_users_dialog_view.js",
    "lib/assets/javascripts/cartodb/organization/invite_users/invite_users_form_view.js",
    "lib/assets/javascripts/cartodb/organization/organization_notification/delete_notification_dialog_view.js",
    "lib/assets/javascripts/cartodb/organization/organization_notification/organization_notification_view.js",
    "lib/assets/javascripts/cartodb/organization/organization_notification/send_button_view.js",
    "lib/assets/javascripts/cartodb/organization/organization_user_form.js",
    "lib/assets/javascripts/cartodb/organization/organization_user_quota.js",
    "lib/assets/javascripts/cartodb/organization/organization_user_quota_slider.js",
    "lib/assets/javascripts/cartodb/organization/organization_user_quota_slider_input.js",
    "lib/assets/javascripts/cartodb/organization/organization_users/organization_user_view.js",
    "lib/assets/javascripts/cartodb/organization/organization_users/organization_users_footer_view.js",
    "lib/assets/javascripts/cartodb/organization/organization_users/organization_users_list_view.js",
    "lib/assets/javascripts/cartodb/organization/organization_users/organization_users_view.js",
    "node_modules/perfect-scrollbar/index.js",
    "node_modules/perfect-scrollbar/src/js/lib/class.js",
    "node_modules/perfect-scrollbar/src/js/lib/dom.js",
    "node_modules/perfect-scrollbar/src/js/lib/event-manager.js",
    "node_modules/perfect-scrollbar/src/js/lib/guid.js",
    "node_modules/perfect-scrollbar/src/js/lib/helper.js",
    "node_modules/perfect-scrollbar/src/js/main.js",
    "node_modules/perfect-scrollbar/src/js/plugin/autoupdate.js",
    "node_modules/perfect-scrollbar/src/js/plugin/default-setting.js",
    "node_modules/perfect-scrollbar/src/js/plugin/destroy.js",
    "node_modules/perfect-scrollbar/src/js/plugin/handler/click-rail.js",
    "node_modules/perfect-scrollbar/src/js/plugin/handler/drag-scrollbar.js",
    "node_modules/perfect-scrollbar/src/js/plugin/handler/keyboard.js",
    "node_modules/perfect-scrollbar/src/js/plugin/handler/mouse-wheel.js",
    "node_modules/perfect-scrollbar/src/js/plugin/handler/native-scroll.js",
    "node_modules/perfect-scrollbar/src/js/plugin/handler/selection.js",
    "node_modules/perfect-scrollbar/src/js/plugin/handler/touch.js",
    "node_modules/perfect-scrollbar/src/js/plugin/initialize.js",
    "node_modules/perfect-scrollbar/src/js/plugin/instances.js",
    "node_modules/perfect-scrollbar/src/js/plugin/resizer.js",
    "node_modules/perfect-scrollbar/src/js/plugin/update-geometry.js",
    "node_modules/perfect-scrollbar/src/js/plugin/update-scroll.js",
    "node_modules/perfect-scrollbar/src/js/plugin/update.js",
    "node_modules/process/browser.js",
    "node_modules/underscore/underscore.js",
    "node_modules/util/node_modules/inherits/inherits_browser.js",
    "node_modules/util/support/isBufferBrowser.js",
    "node_modules/util/util.js",
    "vendor/assets/javascripts/markdown.js"
  ],
  "names": [],
  "mappings": "AAAA;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC5GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC7HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACvFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACjEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC3CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC1EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC7IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACxEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC/DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AClQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC9GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC3JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC7PA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AClHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AClEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC3FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC1TA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACrFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACrFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACxGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AClEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACnEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC1CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC3IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACvIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACvDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC5WA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACpJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACnGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACrJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC9CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACrGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACrEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AClDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AChEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC9QA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5gDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC1kBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA",
  "file": "generated.js",
  "sourceRoot": "",
  "sourcesContent": [
    "(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar Backbone = (typeof window !== \"undefined\" ? window['Backbone'] : typeof global !== \"undefined\" ? global['Backbone'] : null);\nvar _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\n\n/** \n *  Model that let user upload files\n *  to our endpoints\n *\n */\n\nmodule.exports = Backbone.Model.extend({\n\n  url: function(method) {\n    var version = cdb.config.urlVersion('asset', method);\n    return '/api/' + version + '/users/' + this.userId + '/assets'\n  },\n\n  fileAttribute: 'filename',\n\n  initialize: function(attrs, opts) {\n    if (!opts.userId) {\n      throw new Error('user id is required');\n    }\n    this.userId = opts.userId;\n  }\n\n});",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar AssetModel = require('./asset_model.js')\n\n/**\n *  Change and preview new user avatar\n *\n */\n\nmodule.exports = cdb.core.View.extend({\n  options: {\n    avatarAcceptedExtensions: ['jpeg', 'jpg', 'png', 'gif']\n  },\n\n  initialize: function() {\n    this.renderModel = this.options.renderModel;\n    this.model = new cdb.core.Model({ state: 'idle' });\n    this.template = cdb.templates.getTemplate('common/views/avatar_selector_view');\n    this._initBinds();\n  },\n\n  render: function() {\n    this._destroyFileInput();\n    this.clearSubViews();\n\n    this.$el.html(\n      this.template({\n        state: this.model.get('state'),\n        name: this.renderModel.get('name'),\n        inputName: this.renderModel.get('inputName'),\n        avatarURL: this.renderModel.get('avatar_url'),\n        avatarAcceptedExtensions: this._formatAvatarAcceptedExtensions(this.options.avatarAcceptedExtensions)\n      })\n    )\n    this._renderFileInput();\n    return this;\n  },\n\n  _initBinds: function() {\n    _.bindAll(this, '_onInputChange', '_onSuccess', '_onError');\n    this.model.bind('change', this.render, this);\n  },\n\n  _destroyFileInput: function() {\n    var $file = this.$(\":file\");\n    $file.unbind('change', this._onInputChange, this);\n    $file.filestyle('destroy');\n  },\n\n  _renderFileInput: function() {\n    var $file = this.$(\":file\");\n    var opts = { buttonText: 'Choose image' };\n    \n    // If we set disabled, no mather if it is true\n    // or false, it turns into disabled\n    if (this.model.get('state') === \"loading\") {\n      opts.disabled = true\n    }\n\n    $file.filestyle(opts);\n    $file.bind('change', this._onInputChange);\n  },\n\n  _onInputChange: function() {\n    var file = this.$(\":file\").prop('files');\n    var avatarUpload = new AssetModel(\n      null, {\n        userId: this.renderModel.get('id')\n      }\n    );\n\n    avatarUpload.save({\n      kind: 'orgavatar',\n      filename: file\n    }, {\n      success: this._onSuccess,\n      error: this._onError\n    });\n\n    // If we move \"loading\" state before starting the upload,\n    // it would trigger a new render and \"remove\" file value :S \n    this.model.set('state', 'loading');\n  },\n\n  _onSuccess: function(m, d) {\n    this.renderModel.set('avatar_url', d.public_url);\n    this.model.set('state', 'success');\n  },\n\n  _onError: function() {\n    this.model.set('state', 'error');\n  },\n\n  clean: function() {\n    this._destroyFileInput();\n    this.elder('clean');\n  },\n\n  _formatAvatarAcceptedExtensions: function(avatarAcceptedExtensions) {\n    var formattedExtensions = [];\n\n    for (var i = 0; i < avatarAcceptedExtensions.length; i++) {\n      formattedExtensions[i] = \"image/\" + avatarAcceptedExtensions[i];\n    }\n\n    return formattedExtensions.join(\",\");\n  }\n\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar BaseDialog = require('./views/base_dialog/view');\n\n/**\n *  When an organization owner wants to delete the full organization\n *\n */\n\nmodule.exports = BaseDialog.extend({\n  options: {\n    authenticityToken: ''\n  },\n\n  events: BaseDialog.extendEvents({\n    'submit .js-form': 'close'\n  }),\n\n  className: 'Dialog is-opening',\n\n  initialize: function () {\n    this.elder('initialize');\n    this.template = cdb.templates.getTemplate('common/views/delete_organization');\n    this._userModel = this.options.user;\n  },\n\n  render_content: function () {\n    return this.template({\n      formAction: cdb.config.prefixUrl() + '/organization',\n      authenticityToken: this.options.authenticityToken,\n      passwordNeeded: !!this._userModel.get('needs_password_confirmation')\n    });\n  }\n});\n",
    "var $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\nvar _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar BaseDialog = require('../../views/base_dialog/view.js');\nvar PagedSearchView = require('../../views/paged_search/paged_search_view');\nvar PagedSearchModel = require('../../paged_search_model');\nvar randomQuote = require('../../view_helpers/random_quote');\nvar GroupUsersListView = require('../../../organization/groups_admin/group_users_list_view');\n\n/**\n * Dialog to add custom basemap to current map.\n */\nmodule.exports = BaseDialog.extend({\n\n  initialize: function() {\n    _.each(['group', 'orgUsers'], function(name) {\n      if (!this.options[name]) throw new Error(name + ' is required');\n    }, this);\n\n    this.elder('initialize');\n    this.model = new cdb.core.Model();\n\n    // Include current user in fetch results\n    this.options.orgUsers.excludeCurrentUser(false);\n\n    this._initBinds();\n    this._initViews();\n  },\n\n  clean: function() {\n    // restore org users\n    this.options.orgUsers.restoreExcludeCurrentUser();\n    this.elder('clean');\n  },\n\n  /**\n   * @override cdb.ui.common.Dialog.prototype.render\n   */\n  render: function() {\n    BaseDialog.prototype.render.apply(this, arguments);\n    this._onChangeSelected();\n    this.$('.content').addClass('Dialog-contentWrapper');\n    return this;\n  },\n\n  /**\n   * @implements cdb.ui.common.Dialog.prototype.render_content\n   */\n  render_content: function() {\n    switch(this.model.get('state')) {\n      case 'saving':\n        return this.getTemplate('common/templates/loading')({\n          title: 'Adding users to group',\n          quote: randomQuote()\n        })\n        break;\n      case 'saveFail':\n        return this.getTemplate('common/templates/fail')({\n          msg: ''\n        })\n        break;\n      default:\n        var $content = $(\n          this.getTemplate('common/dialogs/add_group_users/add_group_users')({\n          })\n        );\n        $content.find('.js-dlg-body').replaceWith(this._PagedSearchView.render().el);\n        return $content;\n    }\n  },\n\n  ok: function() {\n    var selectedUsers = this._selectedUsers();\n    if (selectedUsers.length > 0 ) {\n      this.model.set('state', 'saving');\n\n      var ids = _.pluck(selectedUsers, 'id');\n\n      var self = this;\n      this.options.group.users.addInBatch(ids)\n        .done(function() {\n          self.options.group.users.add(selectedUsers);\n          self.close();\n        })\n        .fail(function() {\n          self.model.set('state', 'saveFail');\n        })\n    }\n  },\n\n  _initViews: function() {\n    this._PagedSearchView = new PagedSearchView({\n      isUsedInDialog: true,\n      pagedSearchModel: new PagedSearchModel({\n        per_page: 50,\n        order: 'username'\n      }),\n      collection: this.options.orgUsers,\n      createListView: this._createUsersListView.bind(this)\n    });\n    this.addView(this._PagedSearchView);\n  },\n\n  _createUsersListView: function() {\n    return new GroupUsersListView({\n      users: this.options.orgUsers\n    });\n  },\n\n  _initBinds: function() {\n    this.options.orgUsers.on('change:selected', this._onChangeSelected, this);\n    this.add_related_model(this.options.orgUsers);\n\n    this.model.on('change:state', this.render, this);\n  },\n\n  _onChangeSelected: function() {\n    this.$('.ok').toggleClass('is-disabled', this._selectedUsers().length === 0);\n  },\n\n  _selectedUsers: function() {\n    return this.options.orgUsers.where({ selected: true });\n  }\n\n});\n",
    "var _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\n\n/**\n *  Local storage wrapper\n *\n *  - It should be used within 'cartodb' key, for example:\n *\n *  var loc_sto = new cdb.common.LocalStorage();\n *  loc_sto.set({ 'dashboard.order': 'create_at' });\n *  loc_sto.get('dashboard.order');\n *\n */\n\n\nvar LocalStorageWrapper = function(name) {\n  this.name = name ||'cartodb';\n  if(!localStorage.getItem(this.name) && this.isEnabled()) {\n    localStorage.setItem(this.name, \"{}\");\n  }\n}\n\n// Some browsers with private mode don't allow to use\n// local storage\nLocalStorageWrapper.prototype.isEnabled = function() {\n  try {\n    localStorage.setItem('checking', 'test');\n    localStorage.removeItem('checking');\n    return true;\n  } catch(e) {\n    return false;\n  }\n}\n\nLocalStorageWrapper.prototype.get = function(n) {\n  if (!this.isEnabled()) return false;\n\n  if(n === undefined) {\n    return JSON.parse(localStorage.getItem(this.name));\n  } else {\n    var data = JSON.parse(localStorage.getItem(this.name));\n    return data[n];\n  }\n\n}\n\nLocalStorageWrapper.prototype.search = function(searchTerm) {\n  if (!this.isEnabled()) return null;\n\n  var wholeArray = JSON.parse(localStorage.getItem(this.name));\n  for(var i in wholeArray) {\n    if(wholeArray[i][searchTerm]) {\n      return wholeArray[i][searchTerm];\n    }\n  }\n  return null;\n}\n\nLocalStorageWrapper.prototype.set = function(data) {\n  if (!this.isEnabled()) return null;\n  var d = _.extend(this.get(), data);\n  return localStorage.setItem(this.name, JSON.stringify(d));\n}\n\nLocalStorageWrapper.prototype.add = function(obj) {\n  return this.set(obj);\n}\n\nLocalStorageWrapper.prototype.remove = function(n) {\n  if (!this.isEnabled()) return null;\n  var d = _.omit(this.get(), n);\n  return localStorage.setItem(this.name, JSON.stringify(d));\n}\n\nLocalStorageWrapper.prototype.destroy = function() {\n  delete localStorage.removeItem(this.name);\n}\n\nmodule.exports = LocalStorageWrapper;\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\n\n/**\n * Model representing the query string params for a \"paged search\" of a collection (matching the server-side APIs).\n *\n * @example usage\n *   var PagedSearch = require('common/paged_search_model');\n *   pagedSearch = new PagedSearch({  })\n *   pagedSearch.fetch(collection) // => jqXHR, GET /collection/123?page=1&per_page20\n *   pagedSearch.set({ page: 2, per_page: 10, q: 'test' });\n *   pagedSearch.fetch(collection) // => GET /collection/123?page=2&per_page10&q=test\n */\nmodule.exports = cdb.core.Model.extend({\n\n  defaults: {\n    per_page: 20,\n    page: 1\n    // order: 'name'\n    // q: '',\n  },\n\n  fetch: function(collection) {\n    collection.trigger('fetching');\n    return collection.fetch({\n      data: this.attributes\n    });\n  }\n\n});\n",
    "var _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\nvar Backbone = (typeof window !== \"undefined\" ? window['Backbone'] : typeof global !== \"undefined\" ? global['Backbone'] : null);\n\n/**\n * @extends http://backbonejs.org/#Router With some common functionality in the context of this app.\n */\nvar Router = Backbone.Router.extend({\n\n  /**\n   * Placeholder, is replaced by enableAfterMainView().\n   */\n  navigate: function() {\n    throw new Error('router.enableAfterMainView({ ... }) must be called before you can navigate');\n  },\n\n  /**\n   * Enable router to monitor and manage browser URL and history.\n   * Expected to be called after main view as the function name indicates,\n   */\n  enableAfterMainView: function() {\n    /**\n     * @override http://backbonejs.org/#Router-navigate Allow\n     * @param fragmentOrUrl {String} Either a fragment (e.g. '/dashboard/datasets') or a full URL\n     *  (e.g. http://user.carto.com/dashboard/datasets), the navigate method takes care to route correctly.\n     */\n    this.navigate = function(fragmentOrUrl, opts) {\n      Backbone.Router.prototype.navigate.call(this, this.normalizeFragmentOrUrl(fragmentOrUrl), opts);\n    };\n\n    Backbone.history.start({\n      pushState: true,\n      root: this.rootPath() + '/' //Yes, this trailing slash is necessary for the router to update the history state properly.\n    });\n  },\n\n  rootPath: function() {\n    throw new Error('implement rootPath in child router (no trailing slash)');\n  },\n\n  /**\n   * Normalise a given fragment or URL for navigation mechanisms to work.\n   * Typically, remove the leading base URL from the given fragment or URL.\n   *\n   * @param {String} fragmentOrUrl\n   * @return {String}\n   */\n  normalizeFragmentOrUrl: function(fragmentOrUrl) {\n    throw new Error('implement normalizeFragmentOrUrl in child router');\n  }\n});\n\nRouter.supportTrailingSlashes = function(obj) {\n  return _.reduce(obj, function(res, val, key) {\n    res[key] = val;\n    res[key + '/'] = val;\n    return res;\n  }, {});\n};\n\nmodule.exports = Router;\n",
    "var Ps = require('perfect-scrollbar');\nvar template = require('./scroll.tpl');\nvar MutationObserver = window.MutationObserver;\n\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\n\nmodule.exports = cdb.core.View.extend({\n  tagName: 'div',\n  className: 'ScrollView',\n\n  initialize: function (opts) {\n    if (!opts.createContentView) throw new Error('A factory createContentView function is required');\n    this.options = opts || {};\n    this._type = opts.type || 'vertical'; // vertical or horizontal\n    this._maxScroll = 0;\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this._html();\n\n    var view = this.options.createContentView.call(this);\n    this._contentContainer().append(view.render().el);\n    this.addView(view);\n    this._applyScroll();\n    this._updateScrollWhenExist();\n    return this;\n  },\n\n  _html: function () {\n    this.$el.html(template({\n      type: this._type\n    }));\n\n    (this._type === 'horizontal') && this.$el.addClass('ScrollView--horizontal');\n  },\n\n  _contentContainer: function () {\n    return this.$('.js-content');\n  },\n\n  _wrapperContainer: function () {\n    return this.$('.js-wrapper');\n  },\n\n  _updateScrollWhenExist: function () {\n    // Phantom doesn't provide this api for window.\n    if (!MutationObserver) return;\n\n    // even with the changes in PS, we need to check when this element is added to the dom\n    // in order to trigger manually an update.\n    var element = document.body;\n    var self = this._wrapperContainer().get(0);\n    var onMutationObserver = function () {\n      if (element.contains(self)) {\n        Ps.update(self);\n        observer.disconnect();\n      }\n    };\n\n    var observer = new MutationObserver(onMutationObserver);\n    onMutationObserver();\n\n    var config = { subtree: true, childList: true };\n    observer.observe(element, config);\n  },\n\n  _applyScroll: function () {\n    Ps.initialize(this._wrapperContainer().get(0), {\n      wheelSpeed: 2,\n      wheelPropagation: true,\n      stopPropagationOnClick: false,\n      minScrollbarLength: 20,\n      suppressScrollX: this._type === 'vertical',\n      suppressScrollY: this._type === 'horizontal'\n    });\n  },\n\n  destroyScroll: function () {\n    Ps.destroy(this._wrapperContainer().get(0));\n  },\n\n  clean: function () {\n    this.destroyScroll();\n    cdb.core.View.prototype.clean.call(this);\n  }\n});\n",
    "var _ = require('underscore');\nmodule.exports = function(obj){\nvar __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\nwith(obj||{}){\n__p+='<div class=\"ScrollView-wrapper js-wrapper js-perfect-scroll\">\\n  <div class=\"ScrollView-content js-content\"></div>\\n</div>\\n';\n}\nreturn __p;\n};\n",
    "/**\n *  Decide what support block app should show\n *\n */\n\nmodule.exports = cdb.core.View.extend({\n\n  initialize: function() {\n    this.user = this.options.user;\n    this.template = cdb.templates.getTemplate('common/views/support_banner');\n  },\n\n  render: function() {\n    this.$el.html(\n      this.template({\n        userType: this._getUserType(),\n        orgDisplayEmail: this._getOrgAdminEmail(),\n        isViewer: this.user.isViewer()\n      })\n    )\n    return this;\n  },\n\n  _getUserType: function() {\n    var accountType = this.user.get('account_type').toLowerCase();\n\n    // Get user type\n    if (this.user.isOrgOwner()) {\n      return 'org_admin';\n    } else if (this.user.isInsideOrg()) {\n      return 'org';\n    } else if (accountType === \"internal\" || accountType === \"partner\" || accountType === \"ambassador\") {\n      return 'internal';\n    } else if (accountType !== \"free\") {\n      return 'client';\n    } else {\n      return 'regular';\n    }\n  },\n\n  _getOrgAdminEmail: function() {\n    if(this.user.isInsideOrg()) {\n      return this.user.organization.display_email;\n    } else {\n      return null;\n    }\n  }\n\n});\n",
    "var _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar BaseDialog = require('./views/base_dialog/view');\n\n/**\n * Convenient factory to create views without having to create new files.\n */\nmodule.exports = {\n\n  createDialogByTemplate: function(templateOrStr, templateData, dialogOptions) {\n    return this.createDialogByView(this.createByTemplate(templateOrStr, templateData), dialogOptions);\n  },\n\n  /**\n   * @return {Object} instance of cdb.core.View, which takes two params of template and templateData\n   */\n  createByTemplate: function(templateOrStr, templateData, viewOpts) {\n    var template = _.isString(templateOrStr) ? cdb.templates.getTemplate(templateOrStr) : templateOrStr;\n\n    var view = new cdb.core.View(viewOpts);\n    view.render = function() {\n      this.$el.html(\n        template(templateData)\n      );\n      return this;\n    };\n\n    return view;\n  },\n\n  /**\n   * Creates a view that holds a list of views to be rendered.\n   * @param {Array} list of View object, i.e. have a render method, $el, and clean method.\n   * @param {Object,undefined} viewOpts view options, .e.g {className: 'Whatever'}\n   * @return {Object} A view\n   */\n  createByList: function(views, viewOpts) {\n    var listView = new cdb.core.View(viewOpts);\n    listView.render = function() {\n      this.clearSubViews();\n      _.each(views, function(view) {\n        this.addView(view);\n        this.$el.append(view.render().$el);\n      }, this);\n      return this;\n    };\n    return listView;\n  },\n\n  createDialogByView: function(contentView, dialogOptions) {\n\n    var options = _.extend({ clean_on_hide: true, enter_to_confirm: true }, dialogOptions);\n\n    return new (BaseDialog.extend({\n      initialize: function() {\n        this.elder('initialize');\n        this.addView(contentView);\n      },\n\n      render_content: function() {\n        return contentView.render().el;\n      }\n    }))(options);\n  }\n};\n",
    "/**\n * Object representing human-readable version of a given number of bytes.\n *\n * (Extracted logic from an old dashboard view)\n *\n * @param bytes {Number}\n * @returns {Object}\n */\nvar fn = function(bytes) {\n  if (!(this instanceof fn)) return new fn(bytes);\n\n  this.bytes = bytes;\n  if (bytes == 0) {\n    this.unit = 0;\n  } else {\n    this.unit = parseInt(Math.floor(Math.log(bytes) / Math.log(1024)));\n  }\n\n  return this;\n};\n\nfn.prototype.size = function() {\n  return (this.bytes / Math.pow(1024, this.unit));\n};\n\nfn.prototype.UNIT_SUFFIXES = ['B', 'kB', 'MB', 'GB', 'TB'];\nfn.prototype.suffix = function() {\n  return this.UNIT_SUFFIXES[this.unit];\n};\n\nfn.prototype.toString = function(decimals) {\n  var size = this.size();\n  if (decimals) {\n    // 1 decimal: 9.995 => 9.9\n    var round = Math.pow(10, decimals);\n    size = Math.floor(size * round) / round;\n  } else {\n    size = Math.floor(size);\n  }\n  return size + this.suffix();\n};\n\nmodule.exports = fn;\n",
    "var $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\n\n/**\n * Check if Linux user used right/middle click at the time of the event\n *\n * @param ev {Event}\n * @returns {boolean}\n */\nfunction isLinuxMiddleOrRightClick(ev) {\n  return ev.which === 2 || ev.which === 3;\n}\n\n/**\n * Check if Mac user used CMD key at the time of the event Mac user used CMD key at the time of the event.\n *\n * @param ev {Event}\n * @returns {boolean}\n */\nfunction isMacCmdKeyPressed(ev) {\n  return ev.metaKey;\n}\n\nfunction isCtrlKeyPressed(ev) {\n  return ev.ctrlKey;\n}\n\n/**\n * Click handler for a cartodb.js view, to navigate event target's href URL through the view's router.navigate method.\n *\n * The default behavior is:\n * Unless cmd/ctrl keys are pressed it will cancel the default link behavior and instead navigate to the URL set in the\n * target's href attribute.\n *\n * Prerequisities:\n *  - view has a this.router instance.\n *\n * Example of how to use:\n *   - In a template:\n *     <a href=\"/some/uri\" id=\"#my-link\" ...\n *     <a href=\"/special/uri\" id=\"#my-special-link\" ...\n *\n *   - In the view file:\n *     var navigateThroughRouter = require('../../common/view_helpers/navigateThroughRouter');\n *     module.exports = new cdb.core.View.extend({\n *       events: {\n *         'click a#my-link': navigateThroughRouter\n *         'click a#my-special-link': this._myCustomRoute\n *       }\n *\n *       _myCustomRoute: function(ev) {\n *         // Here you can do you custom logic before/after the routing, e.g.:\n *         console.log('before changing route');\n *         navigateThroughRouter.apply(this, arguments);\n *         console.log('after changing route');\n *       }\n *\n * @param ev {Event}\n */\nmodule.exports = function(ev) {\n  // We always kill the default behaviour of the event, since container around view might have other click behavior.\n  // In case of a cmd/ctrl click by an user.\n  this.killEvent(ev);\n  var url = $(ev.target).closest('a').attr('href');\n\n  if (!url) {\n    return false;\n  }\n\n  if (!isLinuxMiddleOrRightClick(ev) && !isMacCmdKeyPressed(ev)) {\n    (this.router || this.options.router).navigate(url, { trigger: true });\n  } else if (isCtrlKeyPressed(ev) || isMacCmdKeyPressed(ev)) {\n    window.open(url, '_blank');\n  }\n};\n",
    "var pluralizeStr = function(singular, plural, count) {\n  if (arguments.length === 2) {\n    // Backward compability with prev usages, retrofit to the new params signature\n    // pluralizeStr('foobar' , 3) // => foobars\n    return pluralizeStr.call(this, arguments[0], arguments[0] + 's', arguments[1]);\n  }\n\n  return count === 1 ? singular : plural;\n};\n\npluralizeStr.prefixWithCount = function(singular, plural, count) {\n  return pluralizeStr(\n    '1 ' + singular, // e.g. 1 item\n    count + ' ' + plural, // e.g. 123 items\n    count\n  );\n}\n\nmodule.exports = pluralizeStr;\n",
    "/**\n * Random quote\n */\nmodule.exports = function() {\n\n  var template  = _.template('<p class=\"CDB-Text CDB-Size-medium u-altTextColor\">\"<%= quote %>\"</p><% if (author) { %><p class=\"CDB-Text CDB-Size-medium u-altTextColor u-tSpace\"><em> <%- author %></em></p><% } %>');\n\n  var quotes = [\n    { quote: \"Geographers never get lost. They just do accidental field work.\", author: \"Nicholas Chrisman\" },\n    { quote: \"Geography is just physics slowed down, with a couple of trees stuck in it.\", author: \"Terry Pratchett\" },\n    { quote: \"Not all those who wander are lost.\", author: \"J. R. R. Tolkien\" },\n    { quote: \"In that Empire, the Art of Cartography attained such Perfection that the map of a single Province occupied the entirety of a City.\", author: \"Jorge Luis Borges\" },\n    { quote: \"X marks the spot\", author: \"Indiana Jones\" },\n    { quote: \"It's turtles all the way down.\", author: null },\n    { quote: \"Remember: no matter where you go, there you are.\", author: null },\n    { quote: \"Without geography, you're nowhere!\", author: \"Jimmy Buffett\" },\n    { quote: \"our earth is a globe / whose surface we probe /<br />no map can replace her / but just try to trace her\", author: \"Steve Waterman\" },\n    { quote: \"Everything happens somewhere.\", author: \"Doctor Who\" },\n    { quote: \"A map is the greatest of all epic poems. Its lines and colors show the realization of great dreams.\", author: \"Gilbert H. Grosvenor\" },\n    { quote: \"Everything is related to everything else,<br />but near things are more related than distant things.\", author: \"Tobler's first law of geography\" },\n    { quote: \"Hic Sunt Dracones\", author: null },\n    { quote: \"Here be dragons\", author: null },\n    { quote: \"Stand in the place where you live / Now face North /<br/>Think about direction / Wonder why you haven't before\", author: \"R.E.M\" },\n    { quote: \"The virtue of maps, they show what can be done with limited space, they foresee that everything can happen therein.\", author: \"Jos Saramago\" }\n  ];\n\n  var r = Math.round(Math.random() * (quotes.length - 1));\n\n  return template(quotes[r]);\n};\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\nvar $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\n\nvar BaseDialog = cdb.ui.common.Dialog;\n\n/**\n * Abstract view for a dialog, a kind of view that takes up the full screen overlaying any previous content.\n *\n * To be extended for a specific use-case.\n * It inherits from CartoDB.js' Dialog view so has some particular behavior/convention of how to be used, see example\n *\n * Example of how to use:\n *   // Extend this view\n *   var MyDialog = BaseDialog.extend({\n *     render_content: function() {\n *       return 'Hello world!';\n *     }\n *   });\n *\n *   // Create instance object.\n *   var dialog = new MyDialog();\n *\n *   // To render & show initially (only to be called once):\n *   dialog.appendToBody();\n */\nmodule.exports = BaseDialog.extend({\n\n  className: 'Dialog is-opening',\n\n  overrideDefaults: {\n    template_name: 'common/views/base_dialog/template',\n    triggerDialogEvents: true\n  },\n\n  initialize: function() {\n    // Override defaults of parent\n    _.defaults(this.options, this.overrideDefaults);\n    this.elder('initialize');\n    this.bind('show', this._setBodyForDialogMode.bind(this, 'add'));\n    this.bind('hide', this._setBodyForDialogMode.bind(this, 'remove'));\n  },\n\n  show: function() {\n    BaseDialog.prototype.show.apply(this, arguments);\n    this.trigger('show');\n    if (this.options.triggerDialogEvents) {\n      cdb.god.trigger('dialogOpened');\n    }\n    this.$el.removeClass('is-closing');\n\n    // Blur current element (e.g. a <a> tag that was clicked to open this window)\n    if (document.activeElement) {\n      document.activeElement.blur();\n    }\n  },\n\n  render: function() {\n    BaseDialog.prototype.render.apply(this, arguments);\n    this.$('.content').addClass('is-newContent');\n\n    if (this._isSticky()) {\n      this.$el.addClass('is-sticky');\n    }\n\n    this.show();\n    return this;\n  },\n\n  _isSticky: function() {\n    return this.options && this.options.sticky;\n  },\n\n  close: function() {\n    this._cancel(undefined, true);\n  },\n\n  /**\n   * @override cdb.ui.common.Dialog.prototype.open for animated opening\n   */\n  open: function() {\n    BaseDialog.prototype.open.apply(this, arguments);\n    this.show();\n  },\n\n  /**\n   * @override cdb.ui.common.Dialog.prototype.hide to implement animation\n   */\n  hide: function() {\n    BaseDialog.prototype.hide.apply(this, arguments);\n    this.trigger('hide');\n  },\n\n  /**\n   * @override cdb.ui.common.Dialog.prototype._cancel to implement animation upon closing the dialog and to handle hide event.\n   */\n  _cancel: function(ev, skipCancelCallback) {\n    if (ev) this.killEvent(ev);\n\n    if (this._isSticky()) {\n      return;\n    }\n\n    this.$el.removeClass('is-opening').addClass('is-closing');\n\n    // Use timeout instead of event listener on animation since the event triggered differs depending on browser\n    // Timing won't perhaps be 100% accurate but it's good enough\n    // The timeout should match the .Dialog.is-closing animation duration.\n    var self = this;\n    setTimeout(function() {\n      // from original _cancel\n      if (self.cancel && !skipCancelCallback) {\n        self.cancel();\n      }\n      BaseDialog.prototype.hide.call(self);\n    }, 80); //ms\n\n    // Trigger events immediately, don't wait for the timeout above\n    this.trigger('hide');\n    if (this.options.triggerDialogEvents) {\n      cdb.god.trigger('dialogClosed');\n    }\n  },\n\n  /**\n   * @override cdb.ui.common.Dialog.prototype._ok to not hide dialog by default if there's an ok method defined.\n   */\n  _ok: function(ev) {\n    this.killEvent(ev);\n    if (this.ok) {\n      this.ok();\n    } else {\n      this.close();\n    }\n  },\n\n  _setBodyForDialogMode: function(action) {\n    $('body')[action + 'Class']('is-inDialog');\n  }\n\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\ncdb.admin = (typeof window !== \"undefined\" ? window['cdb']['admin'] : typeof global !== \"undefined\" ? global['cdb']['admin'] : null);\nvar $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\nvar navigateThroughRouter = require('../../../view_helpers/navigate_through_router');\n\n/**\n * The content of the dropdown menu opened by the link at the end of the breadcrumbs menu, e.g.\n *   username > [Maps]\n *          ______/\\____\n *         |            |\n *         |    this    |\n *         |____________|\n */\nmodule.exports = cdb.admin.DropdownMenu.extend({\n  className: 'Dropdown BreadcrumbsDropdown',\n\n  events: {\n    'click a':  '_navigateToLinksHref'\n  },\n\n  initialize: function() {\n    this.elder('initialize');\n    if (!this.options.viewModel) {\n      throw new Error('viewModel must be provided');\n    }\n    this.viewModel = this.options.viewModel;\n    // Optional\n    this.router = this.options.router;\n  },\n\n  render: function() {\n    var dashboardUrl = this.model.viewUrl().dashboard();\n    var datasetsUrl = dashboardUrl.datasets();\n    var deepInsightsUrl = dashboardUrl.deepInsights();\n    var mapsUrl = dashboardUrl.maps();\n\n    this.$el.html(this.template_base({\n      avatarUrl: this.model.get('avatar_url'),\n      userName: this.model.get('username'),\n      mapsUrl: mapsUrl,\n      datasetsUrl: datasetsUrl,\n      deepInsightsUrl: deepInsightsUrl,\n      lockedDatasetsUrl: datasetsUrl.lockedItems(),\n      lockedMapsUrl: mapsUrl.lockedItems(),\n      isDeepInsights: this.viewModel.isDisplayingDeepInsights(),\n      isDatasets: this.viewModel.isDisplayingDatasets(),\n      isMaps: this.viewModel.isDisplayingMaps(),\n      isLocked: this.viewModel.isDisplayingLockedItems()\n    }));\n\n    // Necessary to hide dialog on click outside popup, for example.\n    cdb.god.bind('closeDialogs', this.hide, this);\n\n    // TODO: taken from existing code, how should dropdowns really be added to the DOM?\n    $('body').append(this.el);\n\n    return this;\n  },\n\n  _navigateToLinksHref: function() {\n    this.hide(); //hide must be called before routing for proper deconstruct of dropdown\n    if (this.options.router) {\n      navigateThroughRouter.apply(this, arguments);\n    }\n  },\n\n  clean: function() {\n    // Until https://github.com/CartoDB/cartodb.js/issues/238 is resolved:\n    $(this.options.target).unbind(\"click\", this._handleClick);\n    this.constructor.__super__.clean.apply(this);\n  }\n});\n",
    "\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\nvar Backbone = (typeof window !== \"undefined\" ? window['Backbone'] : typeof global !== \"undefined\" ? global['Backbone'] : null);\nvar UserNotificationModel = require('./model');\nvar UserOrganizationNotificationModel = require('./organization-model');\n\n/**\n *  User notification default collection, it will\n *  require the user notification model\n */\n\nmodule.exports = Backbone.Collection.extend({\n\n  model: function(attrs, options) {\n    if (attrs.type === 'org_notification') {\n      return new UserOrganizationNotificationModel(attrs, options);\n    } else {\n      return new UserNotificationModel(attrs);\n    }\n  }\n\n});",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\ncdb.admin = (typeof window !== \"undefined\" ? window['cdb']['admin'] : typeof global !== \"undefined\" ? global['cdb']['admin'] : null);\nvar ScrollView = require('../../../scroll/scroll-view');\nvar ViewFactory = require('../../../../common/view_factory');\n\n/**\n * User notifications dropdown, rendering notifications\n * from the collection\n */\n\nmodule.exports = cdb.admin.DropdownMenu.extend({\n  className: 'Dropdown',\n\n  initialize: function() {\n    cdb.admin.DropdownMenu.prototype.initialize.apply(this, arguments);\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(this.template_base());\n    this._renderDropdown();\n    this._checkScroll();\n\n    $('body').append(this.el);\n\n    return this;\n  },\n\n  _renderDropdown: function () {\n    this.dropdown_content = ViewFactory.createByTemplate('common/views/dashboard_header/notifications/templates/dropdown_content', {\n      items: this.collection.toJSON(),\n      unreadItems: this.collection.filter(function(item){ return !item.get('opened') }).length\n    });\n    this.addView(this.dropdown_content);\n\n    this.$('.js-content').html(this.dropdown_content.render().el);\n  },\n\n  _checkScroll: function() {\n    // we need to wait until dropdown has appeared,\n    // then if it is taller than 300px we wrap the content in a ScrollView,\n    // this is a fix for IE11, which needs a fixed height when using flex in a child element\n    setTimeout(function () {\n      if (this.$el.height() >= 300) {\n        var view = new ScrollView({\n          createContentView: function () {\n            return this.dropdown_content;\n          }.bind(this)\n        });\n        this.addView(view);\n\n        this.$el.addClass('Dropdown--withScroll');\n        this.$('.js-content').html(view.render().el);\n      }\n    }.bind(this), 301);\n  },\n\n  _initBinds: function() {\n    cdb.god.bind('closeDialogs', this.hide, this);\n    this.add_related_model(cdb.god);\n  }\n});\n",
    "\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\n\n/**\n *  User notification default model\n */\n\nmodule.exports = cdb.core.Model.extend({\n\n  defaults: {\n    type:     '',\n    message:  '',\n    opened:   false\n  }\n\n});",
    "var UserNotificationModel = require('./model');\n\n/**\n *  User notification default model\n */\n\nmodule.exports = UserNotificationModel.extend({\n  url: function (method) {\n    return '/api/v3/users/' + this._userId + '/notifications/' + this.id + '?api_key=' + this._apiKey;\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.userId) {\n      throw new Error('user Id is required');\n    }\n\n    if (!opts.apiKey) {\n      throw new Error('apiKey is required');\n    }\n\n    this._userId = opts.userId;\n    this._apiKey = opts.apiKey;\n  },\n\n  markAsRead: function () {\n    this.save({\n      notification: {\n        read_at: new Date()\n      }\n    });\n  }\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\nvar UserNotificationsCollection = require('./collection');\nvar NotificationsDropdown = require('./dropdown_view');\n\n\n/**\n *  User notifactions view used to show alerts from the application\n *\n *  In storage we will check these attributes, managed by a collection:\n *\n *  try_trial       -> trial_end_at is null && user is not paid user\n *  limits_exceeded -> check table quota size\n *  close_limits    -> check table quota size < 80%\n *  upgraded        -> check upgraded_at less than one week\n *  trial_ends_soon -> trial_end_at is not null and it is close to be finished\n *  new_dashboard   -> new dashboard\n *  notification    -> check notification\n *\n */\n\nmodule.exports = cdb.core.View.extend({\n\n  attributes: {\n    href: '#/notifications'\n  },\n\n  tagName: 'a',\n  className: 'UserNotifications',\n\n  events: {\n    'click': '_openNotifications'\n  },\n\n  initialize: function() {\n    this.user = this.options.user;\n    this.localStorage = this.options.localStorage;\n    this.template = cdb.templates.getTemplate('common/views/dashboard_header/notifications/templates/user_notifications');\n    this.collection = new UserNotificationsCollection();\n    this.collection.reset(this._generateCollection(), {\n      userId: this.user.get('id'),\n      apiKey: this.user.get('api_key'),\n      silent: true\n    });\n\n    this._initBinds();\n  },\n\n  render: function() {\n    var notificationsCount = this.collection.filter(function(item) { return !item.get('opened') }).length;\n\n    this.$el.html(\n      this.template({\n        notificationsCount: notificationsCount\n      })\n    );\n\n    // has alerts?\n    this.$el.toggleClass('has--alerts', notificationsCount > 0);\n\n    return this;\n  },\n\n  _initBinds: function() {\n    // Make it live\n    this.user.bind('change', this._onUserChange, this);\n    this.collection.bind('reset', this.render, this);\n    this.collection.bind('remove', this.render, this);\n    this.add_related_model(this.user);\n    this.add_related_model(this.collection);\n  },\n\n  _onUserChange: function() {\n    // When api is ready, we will make a valid fetch :)\n    this.collection.reset(this._generateCollection(), {\n      userId: this.user.get('id'),\n      apiKey: this.user.get('api_key')\n    });\n    this.render();\n  },\n\n  // This method will check notifications and create a collection with them\n  // Also it will check if those have been opened or not with Local Storage.\n  _generateCollection: function() {\n    var arr = [];\n    var d = {}; // data\n    var userUrl = this.user.viewUrl();\n\n    d.isInsideOrg = this.user.isInsideOrg();\n    d.isOrgOwner = this.user.isOrgOwner();\n    d.accountType = this.user.get(\"account_type\").toLowerCase();\n    d.remainingQuota = this.user.get('remaining_byte_quota');\n    d.publicProfileUrl = userUrl.publicProfile();\n    d.bytesQuota = this.user.get('quota_in_bytes');\n    d.userType = 'regular';\n    d.upgradeUrl = window.upgrade_url || '';\n    d.upgradeContactEmail = this.user.upgradeContactEmail();\n    d.trialEnd = this.user.get('trial_ends_at') && moment(this.user.get('trial_ends_at')).format(\"YYYY-MM-DD\");\n    d.userName = this.user.get('name') || this.user.get('username');\n\n\n    // Get user type\n    if (d.isInsideOrg && !d.isOrgOwner) {\n      d.userType = 'org';\n    } else if (d.isOrgOwner) {\n      d.userType = 'admin';\n    } else if (d.accountType === \"internal\" ||d.accountType === \"partner\" || d.accountType === \"ambassador\") {\n      d.userType = 'internal'\n    }\n\n    // try_trial -> trial_end_at is null && user is not paid user\n    if (!d.isInsideOrg && d.accountType === 'free' && this.user.get(\"table_count\") > 0) {\n      arr.push({\n        iconFont: 'CDB-IconFont-gift',\n        severity: 'NotificationsDropdown-itemIcon--positive',\n        type:   'try_trial',\n        msg:    cdb.templates.getTemplate('common/views/dashboard_header/notifications/templates/try_trial')(d),\n        opened: this.localStorage.get('notification.try_trial')\n      })\n    } else {\n      this.localStorage.remove('notification.try_trial')\n    }\n\n    // limits_exceeded -> check table quota size\n    if (d.remainingQuota <= 0) {\n      arr.push({\n        iconFont: 'CDB-IconFont-barometer',\n        severity: 'NotificationsDropdown-itemIcon--negative',\n        type:   'limits_exceeded',\n        msg:    cdb.templates.getTemplate('common/views/dashboard_header/notifications/templates/limits_exceeded')(d),\n        opened: this.localStorage.get('notification.limits_exceeded')\n      });\n    } else {\n      this.localStorage.remove('notification.limits_exceeded')\n    }\n\n    // close_limits -> check table quota size < 80%\n    if ((( d.remainingQuota * 100 ) / d.bytesQuota ) < 20) {\n      arr.push({\n        iconFont: 'CDB-IconFont-barometer',\n        severity: 'NotificationsDropdown-itemIcon--alert',\n        type:   'close_limits',\n        msg:    cdb.templates.getTemplate('common/views/dashboard_header/notifications/templates/close_limits')(d),\n        opened: this.localStorage.get('notification.close_limits')\n      });\n    } else {\n      this.localStorage.remove('notification.close_limits')\n    }\n\n    // upgraded -> check upgraded_at less than ... one week?\n    if (this.user.get(\"show_upgraded_message\")) {\n      arr.push({\n        iconFont: 'CDB-IconFont-heartFill',\n        severity: 'NotificationsDropdown-itemIcon--positive',\n        type:   'upgraded_message',\n        msg:    cdb.templates.getTemplate('common/views/dashboard_header/notifications/templates/upgraded_message')(d),\n        opened: this.localStorage.get('notification.upgraded_message')\n      });\n    } else {\n      this.localStorage.remove('notification.upgraded_message')\n    }\n\n    // trial_ends_soon -> show_trial_reminder flag\n    if (this.user.get(\"show_trial_reminder\")) {\n      arr.push({\n        iconFont: 'CDB-IconFont-clock',\n        severity: 'NotificationsDropdown-itemIcon--alert',\n        type:   'trial_ends_soon',\n        msg:    cdb.templates.getTemplate('common/views/dashboard_header/notifications/templates/trial_ends_soon')(d),\n        opened: this.localStorage.get('notification.trial_ends_soon')\n      });\n    } else {\n      this.localStorage.remove('notification.trial_ends_soon')\n    }\n\n    if (window.organization_notifications) {\n      for (var n = 0; n < window.organization_notifications.length; n++) {\n        var notification = window.organization_notifications[n];\n        var icon = notification.icon ? ('CDB-IconFont-' + notification.icon) :'CDB-IconFont-alert';\n\n        arr.push({\n          iconFont: icon,\n          severity: 'NotificationsDropdown-itemIcon--alert',\n          id: notification.id,\n          msg: notification.html_body,\n          read_at: notification.read_at,\n          type: 'org_notification'\n        });\n      }\n    }\n\n    return arr;\n  },\n\n  _openNotifications: function(e) {\n    if (e) this.killEvent(e);\n\n    if (this.notification) {\n      this.notification.hide();\n      delete this.notification;\n      return this;\n    }\n\n    var view = this.notification = new NotificationsDropdown({\n      target:             this.$el,\n      collection:         this.collection,\n      horizontal_offset:  5,\n      vertical_offset:    -5,\n      template_base:      'common/views/dashboard_header/notifications/templates/dropdown'\n    });\n\n    $(view.options.target).unbind('click', view._handleClick);\n    this._closeAnyOtherOpenDialogs();\n\n    view.on('onDropdownHidden', function() {\n      this._onDropdownHidden(view);\n    }, this);\n\n    view.render();\n    view.open();\n\n    this.addView(view);\n  },\n\n  _onDropdownHidden: function(view) {\n    var self = this;\n\n    // All notifications have been seen, opened -> true\n    this.collection.each(function(i){\n      if (i.get('type') === 'org_notification') {\n        i.markAsRead();\n      } else if (i.get('type')) {\n        i.set('opened', true);\n        var d = {};\n        d['notification.' + i.get('type')] = true;\n        self.localStorage.set(d);\n      }\n    });\n\n    // Clean collection because all notifications should\n    // removed from the collection\n    this.collection.reset();\n\n    // Clean dropdown\n    view.clean();\n    // Remove it from subviews\n    this.removeView(view);\n    // Remove count\n    this.$el.removeClass('has--alerts');\n    // No local notification set\n    delete this.notification;\n  },\n\n  _closeAnyOtherOpenDialogs: function() {\n    cdb.god.trigger(\"closeDialogs\");\n  }\n\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\ncdb.admin = (typeof window !== \"undefined\" ? window['cdb']['admin'] : typeof global !== \"undefined\" ? global['cdb']['admin'] : null);\nvar $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\nvar bytesToSize = require('../../view_helpers/bytes_to_size');\n\n/**\n * The content of the dropdown menu opened by the user avatar in the top-right of the header, e.g.:\n *   Explore, Learn, \n *             ______/\\____\n *            |            |\n *            |    this    |\n *            |____________|\n */\nmodule.exports = cdb.admin.DropdownMenu.extend({\n  className: 'Dropdown',\n\n  initialize: function() {\n    this.elder('initialize');\n    if (!this.model) {\n      throw new Error('model is required');\n    }\n    this.template_base = cdb.templates.getTemplate('common/views/dashboard_header/settings_dropdown');\n  },\n\n  shortDisplayName: function(user) {\n    // This changes should also be done in Central, ./app/assets/javascripts/dashboard/users/views/user_avatar.js\n    var accountTypeDisplayName = user.get('account_type_display_name');\n    var displayName = _.isUndefined(accountTypeDisplayName) ? user.get('account_type') : accountTypeDisplayName;\n\n    if(_.isUndefined(displayName)) {\n      return displayName;\n    }\n\n    displayName = displayName.toLowerCase();\n\n    if (displayName === 'organization user') {\n      return 'org. user';\n    } else {\n      return displayName.replace(/lump-sum/gi, '- A')\n                        .replace(/academic/gi, 'aca.')\n                        .replace(/ - Monthly/i, ' - M')\n                        .replace(/ - Annual/i, ' - A')\n                        .replace(/Non-Profit/i, 'NP')\n                        .replace(/On-premises/i, 'OP')\n                        .replace(/Internal use engine/i, 'engine')\n                        .replace(/Lite/i, 'L')\n                        .replace(/Cloud Engine &/i, 'C. Engine &')\n                        .replace(/& Enterprise Builder/i, '& E. Builder')\n                        .replace(/CARTO for /i, '')\n                        .replace(/CARTO /i, '');\n    }\n  },\n\n  render: function() {\n    var user = this.model;\n    var usedDataBytes = user.get('db_size_in_bytes');\n    var quotaInBytes = user.get('quota_in_bytes');\n    var usedDataPct = Math.round(usedDataBytes / quotaInBytes * 100);\n    var progressBarClass = '';\n\n    if (usedDataPct > 80 && usedDataPct < 90) {\n      progressBarClass = 'is--inAlert';\n    } else if (usedDataPct > 89) {\n      progressBarClass = 'is--inDanger';\n    }\n\n    var accountType = this.shortDisplayName(user);\n\n    var userUrl = this.model.viewUrl();\n    var upgradeUrl = window.upgrade_url || cdb.config.get('upgrade_url') ||'';\n\n    this.$el.html(this.template_base({\n      name:         user.get('name') || user.get('username'),\n      email:        user.get('email'),\n      accountType:  accountType,\n      isOrgAdmin:   user.isOrgAdmin(),\n      usedDataStr:      bytesToSize(usedDataBytes).toString(2),\n      usedDataPct:      usedDataPct,\n      progressBarClass: progressBarClass,\n      availableDataStr: bytesToSize(quotaInBytes).toString(2),\n      showUpgradeLink:    upgradeUrl && (user.isOrgOwner() || !user.isInsideOrg()) && !cdb.config.get('cartodb_com_hosted'),\n      upgradeUrl:         upgradeUrl,\n      publicProfileUrl:   userUrl.publicProfile(),\n      apiKeysUrl:         userUrl.apiKeys(),\n      organizationUrl:    userUrl.organization(),\n      accountSettingsUrl: userUrl.accountSettings(),\n      logoutUrl:          userUrl.logout(),\n      isViewer:           user.isViewer(),\n      isBuilder:          user.isBuilder(),\n      orgDisplayEmail:    user.isInsideOrg() ? user.organization.display_email : null,\n      engineEnabled:      user.get('actions').engine_enabled,\n      mobileAppsEnabled:  user.get('actions').mobile_sdk_enabled\n    }));\n\n    // Necessary to hide dialog on click outside popup, for example.\n    cdb.god.bind('closeDialogs', this.hide, this);\n\n    // TODO: taken from existing code, how should dropdowns really be added to the DOM?\n    $('body').append(this.el);\n\n    return this;\n  },\n\n  clean: function() {\n    // Until https://github.com/CartoDB/cartodb.js/issues/238 is resolved:\n    $(this.options.target).unbind('click', this._handleClick);\n    this.constructor.__super__.clean.apply(this);\n  }\n\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\n\n/**\n * View to render the user support link in the header.\n * Expected to be created from existing DOM element.\n */\nmodule.exports = cdb.core.View.extend({\n\n  initialize: function() {\n    this.user = this.model;\n    this.template_base = cdb.templates.getTemplate('common/views/dashboard_header/user_support_template');\n  },\n\n  render: function() {\n    this.$el.html(\n      this.template_base({\n        userType: this._getUserType()\n      })\n    )\n\n    return this;\n  },\n\n  _getUserType: function() {\n    var accountType = this.user.get('account_type').toLowerCase();\n\n    // Get user type\n    if (this.user.isInsideOrg()) {\n      return 'org';\n    } else if (accountType === \"internal\" || accountType === \"partner\" || accountType === \"ambassador\") {\n      return 'internal'\n    } else if (accountType !== \"free\") {\n      return 'client';\n    } else {\n      return 'regular'\n    }\n  }\n\n});\n",
    "var $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar SettingsDropdown = require('./dashboard_header/settings_dropdown_view');\nvar BreadcrumbsDropdown = require('./dashboard_header/breadcrumbs/dropdown_view');\nvar UserNotifications = require('./dashboard_header/notifications/view');\nvar UserSupportView = require('./dashboard_header/user_support_view');\n\n/**\n * Responsible for the header part of the layout.\n * It's currently pre-rendered server-side, why the header element is required to be given when instantiating the view.\n */\nmodule.exports = cdb.core.View.extend({\n  events: {\n    'click .js-breadcrumb-dropdown': '_createBreadcrumbsDropdown',\n    'click .js-settings-dropdown': '_createSettingsDropdown'\n  },\n\n  initialize: function() {\n    if (!this.options.el) {\n      throw new Error('el element is required');\n    }\n    if (!this.options.viewModel) {\n      throw new Error('viewModel is required');\n    }\n\n    this._viewModel = this.options.viewModel;\n    this.router = this.options.router;\n    this._initBinds();\n  },\n\n  render: function() {\n    this.clearSubViews();\n\n    this._renderBreadcrumbsDropdownLink();\n    this._renderSupportLink();\n    this._renderNotifications();\n    this._renderLogoLink();\n\n    return this;\n  },\n\n  _initBinds: function() {\n    this._viewModel.bind('change', this._renderBreadcrumbsDropdownLink, this);\n    if (this.router) {\n      this.router.model.bind('change', this._onRouterChange, this);\n      this.add_related_model(this.router.model);\n    }\n    if (this.collection) {\n      this.collection.bind('reset', this._stopLogoAnimation, this);\n      this.collection.bind('error', this._onCollectionError, this);\n      this.add_related_model(this.collection);\n    }\n    this.add_related_model(this._viewModel);\n  },\n\n  _onCollectionError: function(col, e, opts) {\n    // Old requests can be stopped, so aborted requests are not\n    // considered as an error\n    if (!e || (e && e.statusText !== \"abort\")) {\n      this._stopLogoAnimation()\n    }\n  },\n\n  _onRouterChange: function(m, c) {\n    if (c && c.changes && !c.changes.content_type && this.collection.total_user_entries > 0) {\n      this._startLogoAnimation(); \n    }\n  },\n\n  _startLogoAnimation: function() {\n    this.$('.Logo').addClass('is-loading');\n  },\n\n  _stopLogoAnimation: function() {\n    this.$('.Logo').removeClass('is-loading');\n  },\n\n  _renderBreadcrumbsDropdownLink: function() {\n    this.$('.js-breadcrumb-dropdown').html(\n      cdb.templates.getTemplate('common/views/dashboard_header/breadcrumbs/dropdown_link')({\n        title: this._viewModel.breadcrumbTitle(),\n        dropdownEnabled: this._viewModel.isBreadcrumbDropdownEnabled()\n      })\n    )\n  },\n\n  _renderNotifications: function() {\n    var userNotifications = new UserNotifications({\n      user: this.model,\n      localStorage: this.options.localStorage\n    });\n\n    this.$('.js-user-notifications').html(userNotifications.render().el);\n    this.addView(userNotifications);\n  },\n\n  _renderSupportLink: function() {\n    var userSupportView = new UserSupportView({\n      el: $('.js-user-support'),\n      model: this.model\n    });\n    userSupportView.render();\n  },\n\n  _renderLogoLink: function() {\n    var template = cdb.templates.getTemplate('common/views/dashboard_header/logo');\n    this.$('.js-logo').html(\n      template({\n        homeUrl: this.model.viewUrl().dashboard(),\n        googleEnabled: this.model.featureEnabled('google_maps')\n      })\n    );\n  },\n\n  _createSettingsDropdown: function(ev) {\n    this.killEvent(ev);\n\n    this._setupDropdown(new SettingsDropdown({\n      target: $(ev.target),\n      model: this.model, // a user model\n      horizontal_offset: 18\n    }));\n  },\n\n  _createBreadcrumbsDropdown: function(ev) {\n    if (this._viewModel.isBreadcrumbDropdownEnabled()) {\n      this.killEvent(ev);\n      this._setupDropdown(new BreadcrumbsDropdown({\n        target: $(ev.target),\n        model: this.model,\n        viewModel: this._viewModel,\n        router: this.router, // optional\n        horizontal_offset: -110,\n        tick: 'center',\n        template_base: 'common/views/dashboard_header/breadcrumbs/dropdown'\n      }));\n    }\n  },\n\n  _setupDropdown: function(dropdownView) {\n    this._closeAnyOtherOpenDialogs();\n    this.addView(dropdownView);\n\n    dropdownView.on('onDropdownHidden', function() {\n      dropdownView.clean();\n    }, this);\n\n    dropdownView.render();\n    dropdownView.open();\n  },\n\n  _closeAnyOtherOpenDialogs: function() {\n    cdb.god.trigger(\"closeDialogs\");\n  }\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\nvar $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\nvar Utils = (typeof window !== \"undefined\" ? window['cdb']['Utils'] : typeof global !== \"undefined\" ? global['cdb']['Utils'] : null);\nvar PaginationModel = require('../pagination/model');\nvar randomQuote = require('../../view_helpers/random_quote');\nvar ViewFactory = require('../../view_factory');\nvar PaginationView = require('../pagination/view');\n\n/**\n * View to render a searchable/pageable collection.\n * Also allows to filter/search list.\n * Set {isUsedInDialog: true} in view opts if intended to be used in a dialog, to have proper classes to position views\n * properly.\n *\n * - collection is a collection which has a PagedSearchModel.\n */\nmodule.exports = cdb.core.View.extend({\n\n  events: {\n    'click .js-search-link': '_onSearchClick',\n    'click .js-clean-search': '_onCleanSearchClick',\n    'keydown .js-search-input': '_onKeyDown',\n    'submit .js-search-form': 'killEvent'\n  },\n\n  initialize: function() {\n    _.each(['collection', 'pagedSearchModel', 'createListView'], function(name) {\n      if (!this.options[name]) throw new Error(name + ' is required');\n    }, this);\n    this.collection = this.options.collection;\n    this.options.noResults = this.options.noResults || {}\n\n    var params = this.options.pagedSearchModel;\n    this.paginationModel = new PaginationModel({\n      current_page: params.get('page'),\n      total_count: this.collection.totalCount() || 0,\n      per_page: params.get('per_page')\n    });\n\n    this.elder('initialize');\n    this._initBinds();\n    this.options.pagedSearchModel.fetch(this.collection);\n  },\n\n  render: function() {\n    this.clearSubViews();\n\n    this._renderContent(\n      this.getTemplate('common/views/paged_search/paged_search')({\n        thinFilters: this.options.thinFilters,\n        q: this.options.pagedSearchModel.get('q')\n      })\n    );\n\n    this._initViews();\n    this._$cleanSearchBtn().hide();\n    this._renderExtraFilters();\n\n    return this;\n  },\n\n  _renderExtraFilters: function() {\n    if (this.options.filtersExtrasView && this.options.filtersExtrasView) {\n      this.$('.js-filters').append(this.options.filtersExtrasView.render().el);\n    }\n  },\n\n  _renderContent: function(html) {\n    if (this.options.isUsedInDialog) {\n      html = this.getTemplate('common/views/paged_search/paged_search_dialog_wrapper')({\n        htmlToWrap: html\n      })\n    }\n    this.$el.html(html);\n\n    // Needs to be called after $el html changed:\n    if (this.options.isUsedInDialog) {\n      this.$el.addClass('Dialog-expandedSubContent');\n      this._$tabPane().addClass('Dialog-bodyInnerExpandedWithSubFooter');\n    }\n  },\n\n  _initBinds: function() {\n    this.collection.bind('fetching', function() {\n      this._toggleCleanSearchBtn();\n      this._activatePane('loading');\n    }, this);\n\n    this.collection.bind('error', function(e) {\n      // Old requests can be stopped, so aborted requests are not\n      // considered as an error\n      if (!e || (e && e.statusText !== \"abort\")) {\n        this._activatePane('error');\n      }\n      this._toggleCleanSearchBtn();\n    }, this);\n\n    this.collection.bind('reset', function(collection) {\n      this.paginationModel.set({\n        total_count: this.collection.totalCount(),\n        current_page: this.options.pagedSearchModel.get('page')\n      });\n      this._activatePane(this.collection.totalCount() > 0 ? 'list' : 'no_results');\n      this._toggleCleanSearchBtn();\n    }, this);\n\n    this.paginationModel.bind('change:current_page', function(mdl, newPage) {\n      this.options.pagedSearchModel.set('page', newPage);\n      this.options.pagedSearchModel.fetch(this.collection);\n    }, this);\n\n    this.add_related_model(this.options.pagedSearchModel);\n    this.add_related_model(this.collection);\n    this.add_related_model(this.paginationModel);\n  },\n\n  _toggleCleanSearchBtn: function() {\n    this._$cleanSearchBtn().toggle(!!this.options.pagedSearchModel.get('q'))\n  },\n\n  _initViews: function() {\n    this._panes = new cdb.ui.common.TabPane({\n      el: this._$tabPane()\n    });\n    this.addView(this._panes);\n\n    this._panes.addTab('list',\n      ViewFactory.createByList([\n        this._createListView(),\n        new PaginationView({\n          className: 'CDB-Text CDB-Size-medium Pagination Pagination--shareList',\n          model: this.paginationModel\n        })\n      ])\n    );\n\n    this._panes.addTab('error',\n      ViewFactory.createByTemplate('common/templates/fail', {\n        msg: ''\n      })\n    );\n\n    this._panes.addTab('no_results',\n      ViewFactory.createByTemplate('common/templates/no_results', {\n        icon: this.options.noResults.icon || 'CDB-IconFont-defaultUser',\n        title: this.options.noResults.title || 'Oh! No results',\n        msg: this.options.noResults.msg || 'Unfortunately we could not find anything with these parameters'\n      })\n    );\n\n    this._panes.addTab('loading',\n      ViewFactory.createByTemplate('common/templates/loading', {\n        title: 'Searching',\n        quote: randomQuote()\n      })\n    );\n\n    if (this.options.pagedSearchModel.get('q')) {\n      this._focusSearchInput();\n    }\n\n    this._activatePane(this._chooseActivePaneName(this.collection.totalCount()));\n  },\n\n  _createListView: function() {\n    var view = this.options.createListView();\n    if (view instanceof cdb.core.View) {\n      return view;\n    } else {\n      cdb.log.error('createListView function must return a view');\n      // fallback for view to not fail miserably\n      return new cdb.core.View();\n    }\n  },\n\n  _activatePane: function(name) {\n    // Only change active pane if the panes is actually initialized\n    if (this._panes && this._panes.size() > 0) {\n      // explicit render required, since tabpane doesn't do it\n      this._panes.active(name).render();\n    }\n  },\n\n  _chooseActivePaneName: function(totalCount) {\n    if (totalCount === 0) {\n      return 'no_results';\n    } else if (totalCount > 0) {\n      return 'list';\n    } else {\n      return 'loading';\n    }\n  },\n\n  _focusSearchInput: function() {\n    // also selects the current search str on the focus\n    this._$searchInput().focus().val(this._$searchInput().val());\n  },\n\n  _onSearchClick: function(ev) {\n    this.killEvent(ev);\n    this._$searchInput().focus();\n  },\n\n  _onCleanSearchClick: function(ev) {\n    this.killEvent(ev);\n    this._cleanSearch();\n  },\n\n  _onKeyDown: function(ev) {\n    var enterPressed = (ev.keyCode == $.ui.keyCode.ENTER);\n    var escapePressed = (ev.keyCode == $.ui.keyCode.ESCAPE);\n    if (enterPressed) {\n      this.killEvent(ev);\n      this._submitSearch();\n    } else if (escapePressed) {\n      this.killEvent(ev);\n      if (this.options.pagedSearchModel.get('q')) {\n        this._cleanSearch();\n      }\n    }\n  },\n\n  _submitSearch: function(e) {\n    this._makeNewSearch(Utils.stripHTML(this._$searchInput().val().trim()));\n  },\n\n  _cleanSearch: function() {\n    this._$searchInput().val('');\n    this._makeNewSearch();\n  },\n\n  _makeNewSearch: function(query) {\n    this.options.pagedSearchModel.set({\n      q: query,\n      page: 1\n    });\n    this.options.pagedSearchModel.fetch(this.collection);\n  },\n\n  _$searchInput: function() {\n    return this.$('.js-search-input');\n  },\n\n  _$cleanSearchBtn: function() {\n    return this.$('.js-clean-search');\n  },\n\n  _$tabPane: function() {\n    return this.$('.js-tab-pane');\n  }\n\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\n\n/**\n * View model intended to be responsible for pagination logic, and to be used in conjunction with a Pagination view.\n */\nmodule.exports = cdb.core.Model.extend({\n  defaults: {\n    total_count:          0,\n    per_page:             10,\n    current_page:         1,\n    display_count:        5,\n    extras_display_count: 1,\n    url_to:               undefined\n  },\n\n  pagesCount: function() {\n    return Math.max(\n        Math.ceil(\n          this.get('total_count') / this.get('per_page')\n        ), 1);\n  },\n\n  isCurrentPage: function(page) {\n    return this.get('current_page') === page;\n  },\n\n  shouldBeVisible: function() {\n    var pagesCount = this.pagesCount();\n    return this.get('total_count') > 0 && pagesCount > 1 && this.get('current_page') <= pagesCount;\n  },\n\n  urlTo: function(page) {\n    if (this.hasUrl()) {\n      return this.get('url_to')(page);\n    }\n  },\n\n  hasUrl: function() {\n    return typeof this.get('url_to') === 'function';\n  },\n\n  /**\n   * Get the pages that are expected to be displayed.\n   * The current page will be in the middle of the returned sequence.\n   *\n   * @returns {number[]} a sequence of Numbers\n   */\n  pagesToDisplay: function() {\n    var rangeStart;\n\n    if (this._inLowRange()) {\n      rangeStart = 1;\n    } else if (this._inHighRange()) {\n      rangeStart = this.get('current_page') - this._startOffset();\n    } else {\n      // Somewhere between the low and high boundary\n      rangeStart = this.pagesCount() - this.get('display_count') + 1;\n    }\n    rangeStart = Math.max(rangeStart, 1);\n\n    return this._withExtraPages(\n      _.range(rangeStart, this._rangeEnd(rangeStart))\n    );\n  },\n\n  _withExtraPages: function(pagesRelativeToCurrentPage) {\n    var lastPage = this.pagesCount();\n    var extraCount = this.get('extras_display_count');\n    var extraStartPages = _.range(1, extraCount + 1);\n    var extraEndPages = _.range(lastPage - extraCount + 1, lastPage + 1);\n\n    var startPagesDiff = pagesRelativeToCurrentPage[0] - extraStartPages.slice(-1)[0];\n    if (startPagesDiff === 2) {\n      // There is only one missing page in the gap, so add it\n      extraStartPages.push(pagesRelativeToCurrentPage[0] - 1);\n    } else if (startPagesDiff > 2) {\n      // There are more hidden pages at low range, add padding at end\n      extraStartPages.push(-1);\n    }\n\n    var endPagesDiff = extraEndPages[0] - pagesRelativeToCurrentPage.slice(-1);\n    if (endPagesDiff === 2) {\n      // There is only one missing page in the gap, so add it\n      extraEndPages.unshift(extraEndPages[0] - 1);\n    } if (endPagesDiff > 2) {\n      // There are more hidden pages at high range, add padding at beginning\n      extraEndPages.unshift(-2);\n    }\n\n    return _.union(extraStartPages, pagesRelativeToCurrentPage, extraEndPages);\n  },\n\n  _inLowRange: function() {\n    return this.get('current_page') < this._startOffset();\n  },\n\n  _inHighRange: function() {\n    return this.get('current_page') < this._highBoundary();\n  },\n\n  _highBoundary: function() {\n    return this.pagesCount() - this._startOffset();\n  },\n\n  _startOffset: function() {\n    return Math.floor(this.get('display_count') / 2);\n  },\n\n  _rangeEnd: function(rangeStart) {\n    // If we are too close to the range end then cap to the pages count.\n    return Math.min(rangeStart + this.get('display_count'), this.pagesCount() + 1);\n  }\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\nvar navigateThroughRouter = require('../../view_helpers/navigate_through_router');\n\n/**\n * Responsible for pagination.\n *\n * Expected to be created with a pagination model, see the model for available params, here we create w/ the minimum:\n *   new PaginationView({\n *     model: new PaginationModel({\n *       // Compulsory:\n *       urlTo:  function(page) { return '/?page='+ page },\n\n         // Optional, to router clicks on <a> tags through router.navigate by default\n *       router: new Router(...)\n *     })\n *   });\n */\nmodule.exports = cdb.core.View.extend({\n\n  className: 'Pagination CDB-Text CDB-Size-medium',\n\n  events: {\n    'click a': '_paginate'\n  },\n\n  initialize: function() {\n    this.template = cdb.templates.getTemplate('common/views/pagination/template');\n    this.router = this.options.router;\n\n    if (this.router && !this.model.hasUrl()) {\n      throw new Error('since router is set the model must have a url method set too');\n    }\n\n    this.model.bind('change', this.render, this);\n  },\n\n  render: function() {\n    if (this.model.shouldBeVisible()) {\n      this.$el.html(\n        this.template({\n          m: this.model,\n          pagesCount: this.model.pagesCount(),\n          currentPage: this.model.get('current_page')\n        })\n      );\n      this.$el.addClass(this.className);\n      this.delegateEvents();\n    } else {\n      this.$el.html('');\n    }\n\n    return this;\n  },\n\n  _paginate: function(ev) {\n    if (this.router) {\n      navigateThroughRouter.apply(this, arguments);\n    } else if (!this.model.hasUrl()) {\n      this.killEvent(ev);\n    }\n\n    var page = $(ev.target).data('page');\n    this.model.set('current_page', page);\n  }\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar BaseDialog = require('../common/views/base_dialog/view');\nvar _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\n\nmodule.exports = BaseDialog.extend({\n\n  events: function() {\n    return _.extend({}, BaseDialog.prototype.events, {\n      'click .js-ok' : '_regenerateKeys'\n    });\n  },\n\n  initialize: function() {\n    this.elder('initialize');\n    this.template = cdb.templates.getTemplate('keys/views/regenerate_keys_dialog');\n  },\n\n  render_content: function() {\n    return this.template({\n      type: this.options.type,\n      scope: this.options.scope,\n      form_action: this.options.form_action,\n      authenticity_token: this.options.authenticity_token,\n      method: this.options.method || 'post'\n    });\n  },\n\n  _regenerateKeys: function() {\n    this.trigger('done');\n    this.close();\n  }\n});\n",
    "var $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\n\n/**\n *  Color picker for organization brand color\n *\n */\n\nmodule.exports = cdb.core.View.extend({\n\n  events: {\n    'click': '_openPicker'\n  },\n\n  initialize: function () {\n    this.model = new cdb.core.Model({ color: this.options.color });\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:color', this._onChangeColor, this);\n  },\n\n  _onChangeColor: function () {\n    var color = this.model.get('color');\n    this.$el.css('background-color', color);\n    this.trigger('colorChosen', color, this);\n  },\n\n  _createPicker: function () {\n    this.colorPicker = new cdb.admin.ColorPicker({\n      className: 'dropdown color_picker border',\n      target: this.$el,\n      vertical_position: 'up',\n      horizontal_position: 'left',\n      vertical_offset: 5,\n      horizontal_offset: 17,\n      tick: 'left',\n      dragUpdate: true\n    }).bind('colorChosen', this._setColor, this);\n\n    this._bindPicker();\n    this.addView(this.colorPicker);\n  },\n\n  _openPicker: function (e) {\n    this.killEvent(e);\n\n    if (this.colorPicker) {\n      this._destroyPicker();\n      return false;\n    }\n\n    if (!this.colorPicker) {\n      this._createPicker();\n      $('body').append(this.colorPicker.render().el);\n      this.colorPicker.init(this.model.get('color'));\n    }\n  },\n\n  _destroyPicker: function () {\n    if (this.colorPicker) {\n      this._unbindPicker();\n      this.removeView(this.colorPicker);\n      this.colorPicker.hide();\n      delete this.colorPicker;\n    }\n  },\n\n  _bindPicker: function () {\n    cdb.god.bind('closeDialogs', this._destroyPicker, this);\n  },\n\n  _unbindPicker: function () {\n    cdb.god.unbind('closeDialogs', this._destroyPicker, this);\n  },\n\n  _setColor: function (color, close) {\n    if (color) {\n      this.model.set('color', color);\n    }\n    if (close) {\n      this._destroyPicker();\n    }\n  },\n\n  clean: function () {\n    this._destroyPicker();\n    this.elder('clean');\n  }\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar BaseDialog = require('../common/views/base_dialog/view');\n\nmodule.exports = BaseDialog.extend({\n\n  options: {\n    authenticityToken: '',\n    organizationUser: {}\n  },\n\n  className: 'Dialog is-opening',\n\n  initialize: function () {\n    this.elder('initialize');\n    this.template = cdb.templates.getTemplate('organization/views/delete_org_user');\n  },\n\n  render_content: function () {\n    return this.template({\n      username: this.options.organizationUser.get('username'),\n      formAction: cdb.config.prefixUrl() + '/organization/users/' + this.options.organizationUser.get('username'),\n      authenticityToken: this.options.authenticityToken\n    });\n  }\n});\n",
    "var $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar HeaderView = require('../common/views/dashboard_header_view');\nvar SupportView = require('../common/support_view');\nvar HeaderViewModel = require('./header_view_model');\nvar LocalStorage = require('../common/local_storage');\nvar OrganizationUserForm = require('./organization_user_form');\nvar OrganizationUserQuota = require('./organization_user_quota');\nvar DeleteOrganizationUser = require('./delete_org_user_view');\nvar DeleteOrganization = require('../common/delete_organization_view');\nvar AvatarSelector = require('../common/avatar_selector_view');\nvar ColorPickerView = require('./color_picker_view');\nvar OrganizationUsersView = require('./organization_users/organization_users_view');\nvar domainRegExp = /^[a-zA-Z0-9][a-zA-Z0-9-_]{0,61}[a-zA-Z0-9]{0,1}\\.([a-zA-Z]{1,6}|[a-zA-Z0-9-]{1,30}\\.[a-zA-Z]{2,3})$/;\nvar RegenerateKeysDialog = require('../keys/regenerate_keys_dialog_view');\nvar GroupsRouter = require('./groups_admin/router');\nvar GroupsMainView = require('./groups_admin/groups_main_view');\nvar FlashMessageModel = require('./flash_message_model');\nvar FlashMessageView = require('./flash_message_view');\nvar IconPickerView = require('./icon_picker/organization_icon_picker_view');\nvar OrganizationNotificationView = require('./organization_notification/organization_notification_view');\n\nif (window.trackJs) {\n  window.trackJs.configure({\n    userId: window.user_data.username\n  });\n}\n\n/**\n *  Entry point for the new organization, bootstraps all\n *  dependency models and application.\n */\n\n$(function () {\n  cdb.init(function () {\n    var self = this;\n    var user_data = window.user_data;\n    var organization_user_data = window.organization_user_data;\n    var organization_data = window.organization_data;\n\n    cdb.templates.namespace = 'cartodb/';\n    cdb.config.set('url_prefix', user_data.base_url);\n\n    cdb.config.set(window.config); // import config\n\n    $(document.body).bind('click', function () {\n      cdb.god.trigger('closeDialogs');\n    });\n\n    var currentUser = new cdb.admin.User(user_data);\n    var organizationUser;\n    var organization;\n    var organizationUsers;\n\n    if (organization_user_data) {\n      organizationUser = new cdb.admin.User(organization_user_data);\n    }\n\n    if (organization_data) {\n      organization = new cdb.admin.Organization(organization_data);\n      organizationUsers = organization.users;\n    }\n\n    var headerView = new HeaderView({\n      el: $('#header'), // pre-rendered in DOM by Rails app\n      model: currentUser,\n      currentUserUrl: currentUser.viewUrl(),\n      viewModel: new HeaderViewModel(),\n      localStorage: new LocalStorage()\n    });\n    headerView.render();\n\n    var flashMessageModel = new FlashMessageModel();\n    var flashMessageView = new FlashMessageView({\n      model: flashMessageModel\n    });\n    flashMessageView.render();\n    flashMessageView.$el.insertAfter(headerView.$el);\n\n    var supportView = new SupportView({\n      el: $('#support-banner'),\n      user: currentUser\n    });\n    supportView.render();\n\n    // Avatar\n    if (this.$('.js-avatarSelector').length > 0) {\n      var avatarSelector = new AvatarSelector({\n        el: this.$('.js-avatarSelector'),\n        renderModel: new cdb.core.Model({\n          inputName: this.$('.js-fileAvatar').attr('name'),\n          name: currentUser.organization.get('name'),\n          avatar_url: currentUser.organization.get('avatar_url'),\n          id: currentUser.get('id')\n        }),\n        avatarAcceptedExtensions: window.avatar_valid_extensions\n      });\n\n      avatarSelector.render();\n    }\n\n    // Tooltips\n    $('[data-title]').each(function (i, el) {\n      new cdb.common.TipsyTooltip({ // eslint-disable-line\n        el: el,\n        title: function () {\n          return $(this).attr('data-title');\n        }\n      });\n    });\n\n    // Color picker\n    if (this.$('.js-colorPicker').length > 0) {\n      new ColorPickerView({\n        el: this.$('.js-colorPicker'),\n        color: this.$('.js-colorPicker').data('color')\n      }).bind('colorChosen', function (color) {\n        this.$('.js-colorInput').val(color);\n      }, this);\n    }\n\n    // Icon picker\n    if (this.$('.js-iconPicker').length > 0) {\n      this.icon_picker_view = new IconPickerView({\n        el: this.$('.js-iconPicker'),\n        orgId: currentUser.organization.get('id')\n      });\n    }\n\n    // Domain whitelisting\n    if (this.$('.js-domains').length > 0) {\n      this.$('.js-domainsList').tagit({\n        allowSpaces: false,\n        singleField: true,\n        singleFieldNode: this.$('.js-whitelist'),\n        fieldName: this.$('.js-whitelist').attr('name'),\n        tagLimit: 10,\n        readOnly: false,\n        onBlur: function () {\n          self.$('.js-domains').removeClass('is-focus');\n\n          if ($('.tagit-choice').length > 0) {\n            $('.js-placeholder').hide();\n          } else {\n            $('.js-placeholder').show();\n          }\n\n          if ($('.tagit-new').length > 0) {\n            $('.tagit-new input').val('');\n          }\n        },\n        onFocus: function () {\n          self.$('.js-domains').addClass('is-focus');\n\n          $('.js-placeholder').hide();\n        },\n        beforeTagAdded: function (ev, ui) {\n          if (!domainRegExp.test(ui.tagLabel)) {\n            return false;\n          }\n\n          if ($('.tagit-choice').length > 0) {\n            $('.js-placeholder').hide();\n          } else { $('.js-placeholder').show(); }\n        },\n        afterTagAdded: function (ev, ui) {\n          if ($('.tagit-choice').length > 0) {\n            $('.js-placeholder').hide();\n          } else { $('.js-placeholder').show(); }\n        }\n      });\n    }\n\n    // Organization user form\n    if (organizationUser) {\n      this.organization_user_form = new OrganizationUserForm({\n        el: this.$('.js-organizationUserForm'),\n        model: organizationUser\n      });\n    }\n\n    // User quota main view\n    if (organizationUser) {\n      this.organization_user_quota = new OrganizationUserQuota({\n        el: this.$('.js-userQuota'),\n        model: organizationUser\n      });\n    }\n\n    // Organization users list\n    if (this.$('.js-orgUsersList').length === 1) {\n      this.organizationUsersView = new OrganizationUsersView({\n        el: this.$('.js-orgUsersList'),\n        organization: organization,\n        organizationUsers: organizationUsers,\n        currentUser: currentUser\n      });\n      this.organizationUsersView.render();\n    }\n\n    // User deletion\n    if (this.$('.js-deleteAccount').length > 0 && window.authenticity_token) {\n      this.$('.js-deleteAccount').click(function (ev) {\n        if (ev) {\n          ev.preventDefault();\n        }\n        new DeleteOrganizationUser({\n          organizationUser: organizationUser,\n          authenticityToken: window.authenticity_token,\n          clean_on_hide: false\n        }).appendToBody();\n      });\n    }\n\n    // Organization deletion\n    if (this.$('.js-deleteOrganization').length > 0 && window.authenticity_token) {\n      this.$('.js-deleteOrganization').click(function (ev) {\n        if (ev) {\n          ev.preventDefault();\n        }\n        new DeleteOrganization({\n          authenticityToken: window.authenticity_token,\n          clean_on_hide: true,\n          user: currentUser\n        }).appendToBody();\n      });\n    }\n\n    // Notifications\n    if (this.$('.js-OrganizationNotification').length > 0) {\n      var authenticityToken = $('[name=authenticity_token][value]').get(0).value;\n\n      this.organization_notification_view = new OrganizationNotificationView({\n        el: this.$('.js-OrganizationNotification'),\n        authenticityToken: authenticityToken\n      });\n      this.organization_notification_view.render();\n    }\n\n    // API keys\n    var regenerateApiKeyHandler = function (ev, scope, form_action) {\n      if (ev) ev.preventDefault();\n      var authenticity_token = $('[name=authenticity_token][value]').get(0).value;\n      var dlg = new RegenerateKeysDialog({\n        type: 'api',\n        scope: scope,\n        form_action: form_action,\n        authenticity_token: authenticity_token\n      });\n\n      dlg.appendToBody();\n    };\n\n    var toggleUserQuotas = function () {\n      var viewer = $('.js-userViewerOption:checked').val();\n      if (viewer === 'true') {\n        $('.user-quotas').hide();\n        $('.js-org-admin-row').hide();\n        $('#org_admin').prop('checked', false);\n      } else {\n        $('.user-quotas').show();\n        $('.js-org-admin-row').show();\n      }\n    };\n\n    toggleUserQuotas();\n\n    $('.js-userViewerOption').bind('change', function (ev) {\n      toggleUserQuotas();\n    });\n\n    $('.js-regenerateOrgUsersApiKey').bind('click', function (ev) {\n      var current_username = $(this).attr('data-current_username');\n\n      regenerateApiKeyHandler(ev, 'organization', '/u/' + current_username + '/organization/regenerate_api_keys');\n    });\n\n    $('.js-regenerateOrgUserApiKey').bind('click', function (ev) {\n      var username = $(this).attr('data-username');\n      var current_username = $(this).attr('data-current_username');\n\n      regenerateApiKeyHandler(ev, 'organization_user', '/u/' + current_username + '/organization/users/' + username + '/regenerate_api_key');\n    });\n\n    var $groups = $('.js-groups-content');\n    if ($groups) {\n      if (!currentUser.isOrgAdmin()) {\n        window.location = currentUser.viewUrl().accountSettings();\n        return false;\n      }\n\n      var groups = new cdb.admin.OrganizationGroups([], {\n        organization: currentUser.organization\n      });\n      var router = new GroupsRouter({\n        rootUrl: currentUser.viewUrl().organization().groups(),\n        flashMessageModel: flashMessageModel,\n        groups: groups,\n        user: currentUser\n      });\n\n      var groupsMainView = new GroupsMainView({\n        el: $groups,\n        groups: groups,\n        router: router,\n        user: currentUser\n      });\n      groupsMainView.render();\n      window.groups = groupsMainView;\n\n      router.enableAfterMainView();\n    }\n  });\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\n\nmodule.exports = cdb.core.Model.extend({\n\n  defaults: {\n    msg: '',\n    display: false\n  },\n\n  shouldDisplay: function () {\n    return this.get('display') && !!this.get('msg');\n  },\n\n  show: function (str) {\n    return this.set({\n      display: true,\n      msg: str\n    });\n  },\n\n  hide: function () {\n    this.set('display', false);\n  }\n\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\n\n/**\n * View for a flash message to be displayed at the header.\n */\nmodule.exports = cdb.core.View.extend({\n\n  className: 'FlashMessage FlashMessage--error CDB-Text',\n\n  initialize: function () {\n    if (!this.model) throw new Error('model is required');\n\n    this._template = cdb.templates.getTemplate('organization/flash_message');\n\n    this.model.on('change', this.render, this);\n  },\n\n  render: function () {\n    this.$el.toggle(this.model.shouldDisplay());\n    this.$el.html(this._html());\n\n    return this;\n  },\n\n  _html: function () {\n    return this._template({\n      str: this.model.get('msg')\n    });\n  }\n\n});\n",
    "var _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar AddGroupUsersView = require('../../common/dialogs/add_group_users/add_group_users_view');\nvar ViewFactory = require('../../common/view_factory');\nvar randomQuote = require('../../common/view_helpers/random_quote');\n\n/**\n * View for the add/remove button in the filters part.\n */\nmodule.exports = cdb.core.View.extend({\n\n  className: 'Filters-group',\n\n  events: {\n    'click .js-add-users': '_onClickAddUsers',\n    'click .js-rm-users': '_onClickRemoveUsers'\n  },\n\n  initialize: function () {\n    _.each(['group', 'orgUsers'], function (name) {\n      if (!this.options[name]) throw new Error(name + ' is required');\n    }, this);\n\n    this.options.group.users.on('change:selected', this._onChangeSelectedUser, this);\n    this.options.group.users.on('add remove reset', this.render, this);\n    this.add_related_model(this.options.group.users);\n  },\n\n  render: function () {\n    this.$el.html(\n      this.getTemplate('organization/groups_admin/add_or_remove_group_users_filters_extra')({\n      })\n    );\n    return this;\n  },\n\n  _onClickAddUsers: function (ev) {\n    this.killEvent(ev);\n    this._openAddGroupsUsersDialog();\n  },\n\n  _openAddGroupsUsersDialog: function () {\n    var addGroupUsersView = new AddGroupUsersView({\n      group: this.options.group,\n      orgUsers: this.options.orgUsers\n    });\n    addGroupUsersView.appendToBody();\n  },\n\n  _onChangeSelectedUser: function () {\n    var hasSelectedUsers = this._selectedUsers().length > 0;\n    this.$('.js-add-users').toggle(!hasSelectedUsers);\n    this.$('.js-rm-users').toggle(hasSelectedUsers);\n  },\n\n  _onClickRemoveUsers: function (ev) {\n    this.killEvent(ev);\n    var selectedUsers = this._selectedUsers();\n    if (selectedUsers.length > 0) {\n      var userIds = _.pluck(selectedUsers, 'id');\n\n      var loadingView = ViewFactory.createDialogByTemplate('common/templates/loading', {\n        title: 'Removing users',\n        quote: randomQuote()\n      });\n      loadingView.appendToBody();\n\n      this.options.group.users.removeInBatch(userIds)\n        .always(function () {\n          loadingView.close();\n        })\n        .fail(function () {\n          var errorView = ViewFactory.createDialogByTemplate('common/templates/fail', {\n            msg: ''\n          });\n          errorView.appendToBody();\n        });\n    }\n  },\n\n  _selectedUsers: function () {\n    return this.options.group.users.where({ selected: true });\n  }\n\n});\n",
    "var _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar randomQuote = require('../../common/view_helpers/random_quote');\n\n/**\n * View to create a new group for an organization.\n */\nmodule.exports = cdb.core.View.extend({\n\n  tagName: 'form',\n\n  events: {\n    'click .js-create': '_onClickCreate',\n    'submit form': '_onClickCreate',\n    'keyup .js-name': '_onChangeName'\n  },\n\n  initialize: function () {\n    _.each(['group', 'onCreated', 'flashMessageModel'], function (name) {\n      if (!this.options[name]) throw new Error(name + ' is required');\n    }, this);\n\n    this.model = new cdb.core.Model();\n    this._initBinds();\n  },\n\n  render: function () {\n    if (this.model.get('isLoading')) {\n      this.$el.html(\n        this.getTemplate('common/templates/loading')({\n          title: 'Creating group',\n          quote: randomQuote()\n        })\n      );\n    } else {\n      this.$el.html(\n        this.getTemplate('organization/groups_admin/create_group')({\n        })\n      );\n    }\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.on('change:isLoading', this.render, this);\n  },\n\n  _onClickCreate: function (ev) {\n    this.killEvent(ev);\n    var name = this._name();\n    if (name) {\n      this.model.set('isLoading', true);\n      this.options.group.save({\n        display_name: name\n      }, {\n        wait: true,\n        success: this.options.onCreated,\n        error: this._showErrors.bind(this)\n      });\n    }\n  },\n\n  _showErrors: function (m, res, req) {\n    this.model.set('isLoading', false);\n\n    var str;\n    try {\n      str = res && JSON.parse(res.responseText).errors.join('. ');\n    } catch (err) {\n      str = 'Could not create group for some unknown reason, please try again';\n    }\n\n    this.options.flashMessageModel.show(str);\n  },\n\n  _onChangeName: function () {\n    this.options.flashMessageModel.hide();\n    this.$('.js-create').toggleClass('is-disabled', this._name().length === 0);\n  },\n\n  _name: function () {\n    return this.$('.js-name').val();\n  }\n\n});\n",
    "var _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar randomQuote = require('../../common/view_helpers/random_quote');\n\n/**\n * View to edit an organization group.\n */\nmodule.exports = cdb.core.View.extend({\n\n  tagName: 'form',\n\n  events: {\n    'click .js-delete': '_onClickDelete',\n    'click .js-save': '_onClickSave',\n    'submit form': '_onClickSave',\n    'keyup .js-name': '_onChangeName'\n  },\n\n  initialize: function () {\n    _.each(['group', 'onSaved', 'onDeleted', 'flashMessageModel'], function (name) {\n      if (!this.options[name]) throw new Error(name + ' is required');\n    }, this);\n    this.model = new cdb.core.Model();\n    this._initBinds();\n  },\n\n  render: function () {\n    if (this.model.get('isLoading')) {\n      this.$el.html(\n        this.getTemplate('common/templates/loading')({\n          title: this.model.get('loadingText'),\n          quote: randomQuote()\n        })\n      );\n    } else {\n      this.$el.html(\n        this.getTemplate('organization/groups_admin/edit_group')({\n          displayName: this.options.group.get('display_name')\n        })\n      );\n    }\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.on('change:isLoading', this.render, this);\n  },\n\n  _onClickSave: function (ev) {\n    this.killEvent(ev);\n    var name = this._name();\n    if (name && name !== this.options.group.get('display_name')) {\n      this._setLoading('Saving changes');\n      this.options.group.save({\n        display_name: name\n      }, {\n        wait: true,\n        success: this.options.onSaved,\n        error: this._showErrors.bind(this)\n      });\n    }\n  },\n\n  _onClickDelete: function (ev) {\n    this.killEvent(ev);\n    this._setLoading('Deleting group');\n    this.options.group.destroy({\n      wait: true,\n      success: this.options.onDeleted,\n      error: this._showErrors.bind(this)\n    });\n  },\n\n  _setLoading: function (msg) {\n    this.options.flashMessageModel.hide();\n    this.model.set({\n      isLoading: !!msg,\n      loadingText: msg\n    });\n  },\n\n  _showErrors: function (m, res, req) {\n    this._setLoading('');\n\n    var str;\n    try {\n      str = res && JSON.parse(res.responseText).errors.join('. ');\n    } catch (err) {\n      str = 'Could not update group for some unknown reason, please try again';\n    }\n\n    this.options.flashMessageModel.show(str);\n  },\n\n  _onChangeName: function () {\n    this.$('.js-save').toggleClass('is-disabled', this._name().length === 0);\n    this.options.flashMessageModel.hide();\n  },\n\n  _name: function () {\n    return this.$('.js-name').val();\n  }\n\n});\n",
    "var _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar ViewFactory = require('../../common/view_factory');\nvar randomQuote = require('../../common/view_helpers/random_quote');\n\n/**\n * View for the add users button and state.\n */\nmodule.exports = cdb.core.View.extend({\n\n  className: 'Filters-group',\n\n  events: {\n    'click .js-add-users': '_onClickAddUsers'\n  },\n\n  initialize: function () {\n    _.each(['groupUsers', 'orgUsers'], function (name) {\n      if (!this.options[name]) throw new Error(name + ' is required');\n    }, this);\n\n    // Init binds\n    this.options.orgUsers.on('change:selected', this._onChangeSelectedUser, this);\n    this.add_related_model(this.options.orgUsers);\n  },\n\n  render: function () {\n    this.$el.html(\n      this.getTemplate('organization/groups_admin/empty_group_filters_extra')({\n      })\n    );\n    return this;\n  },\n\n  _onChangeSelectedUser: function () {\n    this.$('.js-add-users').toggleClass('is-disabled', this._selectedUsers().length === 0);\n  },\n\n  _onClickAddUsers: function (ev) {\n    this.killEvent(ev);\n    var selectedUsers = this._selectedUsers();\n    if (selectedUsers.length > 0) {\n      var userIds = _.pluck(selectedUsers, 'id');\n      var loadingView = this._createLoadingView();\n      loadingView.appendToBody();\n\n      this.options.groupUsers.addInBatch(userIds)\n        .always(function () { loadingView.close(); })\n        .fail(function () {\n          ViewFactory.createDialogByTemplate('common/templates/fail', { msg: '' }).appendToBody();\n        });\n    }\n  },\n\n  _createLoadingView: function () {\n    return ViewFactory.createDialogByTemplate('common/templates/loading', {\n      title: 'Adding users',\n      quote: randomQuote()\n    });\n  },\n\n  _selectedUsers: function () {\n    return this.options.orgUsers.where({ selected: true });\n  }\n\n});\n",
    "var $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\nvar _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar pluralizeString = require('../../common/view_helpers/pluralize_string');\n\n/**\n * Header view when looking at details of a specific group.\n */\nmodule.exports = cdb.core.View.extend({\n\n  initialize: function () {\n    _.each(['group', 'urls'], function (name) {\n      if (!this.options[name]) throw new Error(name + ' is required');\n    }, this);\n    this._initBinds();\n  },\n\n  render: function () {\n    this._$orgSubheader().hide();\n    var group = this.options.group;\n    var isNewGroup = group.isNew();\n    var d = {\n      backUrl: this.options.urls.root,\n      title: group.get('display_name') || 'Create new group',\n      isNewGroup: isNewGroup,\n      usersUrl: false\n    };\n\n    if (isNewGroup) {\n      d.editUrl = window.location;\n      d.editUrl.isCurrent = true;\n    } else {\n      d.editUrl = this.options.urls.edit;\n      d.usersUrl = this.options.urls.users;\n      var usersCount = group.users.length;\n      d.usersLabel = usersCount === 0 ? 'Users' : usersCount + ' ' + pluralizeString('User', 'Users', usersCount);\n\n      if (!this.options.urls.users.isCurrent) {\n        d.backUrl = this.options.urls.users;\n      }\n    }\n\n    this.$el.html(\n      this.getTemplate('organization/groups_admin/group_header')(d)\n    );\n    return this;\n  },\n\n  clean: function () {\n    this._$orgSubheader().show();\n    cdb.core.View.prototype.clean.call(this);\n  },\n\n  _$orgSubheader: function () {\n    return $('.js-org-subheader');\n  },\n\n  _initBinds: function () {\n    var group = this.options.group;\n    group.on('change:display_name', this.render, this);\n    this.add_related_model(group);\n\n    group.users.on('reset add remove', this.render, this);\n    this.add_related_model(group.users);\n  }\n\n});\n",
    "var _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar pluralizeStr = require('../../common/view_helpers/pluralize_string');\n\n/**\n * View of a single group user.\n */\nmodule.exports = cdb.core.View.extend({\n\n  tagName: 'li',\n  className: 'OrganizationList-user is-selectable',\n  events: {\n    'click': '_onClick'\n  },\n\n  initialize: function () {\n    _.each(['model'], function (name) {\n      if (!this.options[name]) throw new Error(name + ' is required');\n    }, this);\n    this._initBinds();\n  },\n\n  render: function () {\n    this.$el.html(\n      this.getTemplate('organization/groups_admin/group_user')({\n        avatarUrl: this.model.get('avatar_url'),\n        username: this.model.get('username'),\n        email: this.model.get('email'),\n        maps_count: pluralizeStr.prefixWithCount('map', 'maps', this.model.get('all_visualization_count')),\n        table_count: pluralizeStr.prefixWithCount('dataset', 'datasets', this.model.get('table_count'))\n      })\n    );\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.on('change:selected', this._onChangeSelected, this);\n  },\n\n  _onChangeSelected: function (m, isSelected) {\n    this.$el.toggleClass('is-selected', !!isSelected);\n  },\n\n  _onClick: function (ev) {\n    this.killEvent(ev);\n    this.model.set('selected', !this.model.get('selected'));\n  }\n\n});\n",
    "var _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar GroupUserView = require('./group_user_view');\n\n/**\n * View of group users.\n */\nmodule.exports = cdb.core.View.extend({\n\n  tagName: 'ul',\n  className: 'OrganizationList',\n\n  initialize: function () {\n    _.each(['users'], function (name) {\n      if (!this.options[name]) throw new Error(name + ' is required');\n    }, this);\n\n    // init binds\n    this.options.users.bind('reset add remove', this.render, this);\n    this.add_related_model(this.options.users);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this._renderUsers();\n    return this;\n  },\n\n  _renderUsers: function () {\n    this.options.users.each(this._createUserView, this);\n  },\n\n  _createUserView: function (user) {\n    var view = new GroupUserView({\n      model: user\n    });\n\n    this.addView(view);\n    this.$el.append(view.render().el);\n  }\n\n});\n",
    "var _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar PagedSearchView = require('../../common/views/paged_search/paged_search_view');\nvar PagedSearchModel = require('../../common/paged_search_model');\nvar ViewFactory = require('../../common/view_factory');\nvar randomQuote = require('../../common/view_helpers/random_quote');\nvar AddRemoveFiltersExtraView = require('./add_or_remove_group_users_filters_extra_view');\nvar EmptyGroupFiltersExtraView = require('./empty_group_filters_extra_view');\nvar GroupUsersListView = require('./group_users_list_view');\n\n/**\n * View to manage users of a group\n * It basically has two states, each which relies on its own collection:\n * - Empty group: i.e. no users, show organization users and allow to add users directly by selecting\n * - Group users: allow to add or remove users from group.\n */\nmodule.exports = cdb.core.View.extend({\n\n  initialize: function () {\n    _.each(['group', 'orgUsers'], function (name) {\n      if (!this.options[name]) throw new Error(name + ' is required');\n    }, this);\n\n    this._groupUsers = this.options.group.users;\n    this._orgUsers = this.options.orgUsers;\n    this._orgUsers.excludeCurrentUser(false);\n    this._hasPrefetchedGroupUsers = false;\n    this.model = new cdb.core.Model({\n      hasPrefetchedGroupUsers: false,\n      lastRendered: null //, 'groupUsers', 'empty'\n    });\n\n    // Init binds\n    this._groupUsers.bind('reset', this._onResetGroupUsers, this);\n    this.add_related_model(this._groupUsers);\n\n    // Pre-fetch to know what view to render\n    var self = this;\n    this._groupUsers.fetch({\n      success: function () {\n        self.model.set('hasPrefetchedGroupUsers', true);\n        self.render();\n      }\n    });\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n\n    var view;\n    if (this.model.get('hasPrefetchedGroupUsers')) {\n      view = this._groupUsers.totalCount() > 0\n        ? this._createViewForGroupUsers()\n        : this._createViewForEmptyGroup();\n    } else {\n      view = this._createInitialPreloadingView();\n    }\n\n    this.addView(view);\n    this.$el.append(view.render().el);\n\n    return this;\n  },\n\n  clean: function () {\n    this._orgUsers.restoreExcludeCurrentUser();\n    this.elder('clean');\n  },\n\n  _createInitialPreloadingView: function () {\n    return ViewFactory.createByTemplate('common/templates/loading', {\n      title: 'Getting users',\n      quote: randomQuote()\n    });\n  },\n\n  _createViewForGroupUsers: function () {\n    this.model.set('lastRendered', 'groupUsers');\n\n    var filtersExtrasView = new AddRemoveFiltersExtraView({\n      group: this.options.group,\n      orgUsers: this._orgUsers\n    });\n    this.addView(filtersExtrasView);\n\n    return new PagedSearchView({\n      pagedSearchModel: new PagedSearchModel(),\n      collection: this._groupUsers,\n      createListView: this._createGroupUsersListView.bind(this, this._groupUsers),\n      thinFilters: true,\n      filtersExtrasView: filtersExtrasView\n    });\n  },\n\n  _createViewForEmptyGroup: function () {\n    this.model.set('lastRendered', 'empty');\n\n    var filtersExtrasView = new EmptyGroupFiltersExtraView({\n      groupUsers: this._groupUsers,\n      orgUsers: this._orgUsers\n    });\n    this.addView(filtersExtrasView);\n\n    return new PagedSearchView({\n      pagedSearchModel: new PagedSearchModel(),\n      collection: this._orgUsers,\n      createListView: this._createGroupUsersListView.bind(this, this._orgUsers),\n      thinFilters: true,\n      filtersExtrasView: filtersExtrasView\n    });\n  },\n\n  _createGroupUsersListView: function (usersCollection) {\n    return new GroupUsersListView({\n      users: usersCollection\n    });\n  },\n\n  _onResetGroupUsers: function () {\n    // just this.render() is not enough, because each sub-view re-renders its view on state changes,\n    // Instead, only re-render when hitting the edge-cases after a rest\n    var lastRendered = this.model.get('lastRendered');\n    var totalGroupUsersCount = this._groupUsers.totalCount();\n\n    if (lastRendered === 'empty') {\n      // scenario: added at least one user, so group is no longer empty => change to group users view to add users\n      if (totalGroupUsersCount > 0) {\n        this.render();\n      }\n    } else if (lastRendered === 'groupUsers') {\n      // scenario: removed last group user(s), so the group is now \"empty\" => change to org users view to add users\n      if (totalGroupUsersCount === 0) {\n        this.render();\n      }\n    }\n  }\n\n});\n",
    "var _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar pluralizeStr = require('../../common/view_helpers/pluralize_string');\n\n/**\n * View for an individual group.\n */\nmodule.exports = cdb.core.View.extend({\n\n  tagName: 'li',\n  className: 'OrganizationList-user',\n  _PREVIEW_COUNT: 3,\n\n  initialize: function () {\n    _.each(['model', 'url'], function (name) {\n      if (!this.options[name]) throw new Error(name + ' is required');\n    }, this);\n  },\n\n  render: function () {\n    var sharedMapsCount = this.model.get('shared_maps_count');\n    var sharedDatasetsCount = this.model.get('shared_tables_count');\n    this.$el.html(\n      this.getTemplate('organization/groups_admin/group')({\n        displayName: this.model.get('display_name'),\n        sharedMapsCount: pluralizeStr('1 shared map', sharedMapsCount + ' shared maps', sharedMapsCount),\n        sharedDatasetsCount: pluralizeStr('1 shared dataset', sharedDatasetsCount + ' shared datasets', sharedDatasetsCount),\n        url: this.options.url,\n        previewUsers: this.model.users.toArray().slice(0, this._PREVIEW_COUNT),\n        usersCount: Math.max(this.model.users.length - this._PREVIEW_COUNT, 0)\n      })\n    );\n    return this;\n  }\n\n});\n",
    "var _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar GroupsListView = require('./groups_list_view');\nvar PagedSearchView = require('../../common/views/paged_search/paged_search_view');\nvar PagedSearchModel = require('../../common/paged_search_model');\nvar ViewFactory = require('../../common/view_factory');\n\n/**\n * Index view of groups to list groups of an organization\n */\nmodule.exports = cdb.core.View.extend({\n\n  initialize: function () {\n    _.each(['groups', 'router', 'newGroupUrl'], function (name) {\n      if (!this.options[name]) throw new Error(name + ' is required');\n    }, this);\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    var pagedSearchView = new PagedSearchView({\n      pagedSearchModel: new PagedSearchModel({\n        fetch_users: true,\n        fetch_shared_maps_count: true,\n        fetch_shared_tables_count: true\n      }),\n      collection: this.options.groups,\n      createListView: this._createGroupsView.bind(this),\n      thinFilters: true,\n      filtersExtrasView: this._createFiltersExtraView(),\n      noResults: {\n        icon: 'CDB-IconFont-group',\n        title: 'You have not created any groups yet',\n        msg: 'Creating groups enables you to visualize and search for user members assigned to a business group or team in your organization.'\n      }\n    });\n    this.addView(pagedSearchView);\n\n    this.$el.empty();\n    this.$el.append(pagedSearchView.render().el);\n    return this;\n  },\n\n  _createGroupsView: function () {\n    return new GroupsListView({\n      groups: this.options.groups,\n      newGroupUrl: this.options.newGroupUrl\n    });\n  },\n\n  _createFiltersExtraView: function () {\n    return ViewFactory.createByTemplate('organization/groups_admin/groups_index_filters_extra', {\n      createGroupUrl: this.options.router.rootUrl.urlToPath('new')\n    }, {\n      className: 'Filters-group'\n    });\n  }\n\n});\n",
    "var _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar GroupView = require('./group_view');\nvar ViewFactory = require('../../common/view_factory');\n\nmodule.exports = cdb.core.View.extend({\n\n  initialize: function () {\n    _.each(['groups'], function (name) {\n      if (_.isUndefined(this.options[name])) throw new Error(name + ' is required');\n    }, this);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.empty();\n    this._renderGroupsView();\n    return this;\n  },\n\n  _renderGroupsView: function () {\n    var view = ViewFactory.createByList(this._createGroupViews(), {\n      tagName: 'ul',\n      className: 'OrganizationList'\n    });\n    this.addView(view);\n    this.$el.append(view.render().el);\n  },\n\n  _createGroupViews: function () {\n    return this.options.groups.map(function (m) {\n      return new GroupView({\n        model: m,\n        url: this.options.newGroupUrl(m)\n      });\n    }, this);\n  }\n\n});\n",
    "var $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\nvar _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar navigateThroughRouter = require('../../common/view_helpers/navigate_through_router');\n\n/**\n * Controller view, managing view state of the groups entry point\n */\nmodule.exports = cdb.core.View.extend({\n\n  events: {\n    'click': '_onClick'\n  },\n\n  initialize: function () {\n    _.each(['router'], function (name) {\n      if (!this.options[name]) throw new Error(name + ' is required');\n    }, this);\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(this._contentView().render().el);\n    return this;\n  },\n\n  _initBinds: function () {\n    this.options.router.model.bind('change:view', this._onChangeView, this);\n    this.add_related_model(this.options.router.model);\n  },\n\n  _onChangeView: function (m) {\n    m.previous('view').clean();\n    this.render();\n  },\n\n  _contentView: function () {\n    return this.options.router.model.get('view');\n  },\n\n  _onClick: function (e) {\n    if (this._isEventTriggeredOutsideOf(e, '.Dialog')) {\n      // Clicks outside of any dialog \"body\" will fire a closeDialogs event\n      cdb.god.trigger('closeDialogs');\n    }\n\n    if (!this._isEventTriggeredOutsideOf(e, 'a')) {\n      var url = $(e.target).closest('a').attr('href');\n      if (this.options.router.isWithinCurrentRoutes(url)) {\n        navigateThroughRouter.apply(this, arguments);\n      }\n    }\n  },\n\n  _isEventTriggeredOutsideOf: function (ev, selector) {\n    return $(ev.target).closest(selector).length === 0;\n  }\n});\n",
    "var _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\nvar Router = require('../../common/router');\nvar RouterModel = require('./router_model');\nvar GroupHeaderView = require('./group_header_view');\nvar GroupsIndexView = require('./groups_index_view');\nvar CreateGroupView = require('./create_group_view');\nvar GroupUsersView = require('./group_users_view');\nvar EditGroupView = require('./edit_group_view');\nvar ViewFactory = require('../../common/view_factory');\n\n/**\n *  Backbone router for organization groups urls.\n */\nmodule.exports = Router.extend({\n\n  routes: Router.supportTrailingSlashes({\n    '': 'renderGroupsIndex',\n    'new': 'renderCreateGroup',\n    ':id': 'renderGroupUsers',\n    ':id/edit': 'renderEditGroup',\n\n    // If URL is lacking the trailing slash (e.g. 'http://username.carto.com/organization/groups'), treat it like index\n    '*prefix/groups': 'renderGroupsIndex'\n  }),\n\n  initialize: function (opts) {\n    _.each(['rootUrl', 'groups', 'user', 'flashMessageModel'], function (name) {\n      if (!opts[name]) throw new Error(name + ' is required');\n    }, this);\n\n    this.model = new RouterModel();\n    this.user = opts.user;\n    this.groups = opts.groups;\n    this.flashMessageModel = opts.flashMessageModel;\n    this.rootUrl = opts.rootUrl;\n    this.rootPath = this.rootUrl.pathname.bind(this.rootUrl);\n    this.model.createLoadingView('Loading view'); // Until router's history is started\n    this.model.on('change', this._onChange, this);\n  },\n\n  normalizeFragmentOrUrl: function (fragmentOrUrl) {\n    return fragmentOrUrl ? fragmentOrUrl.toString().replace(this.rootUrl.toString(), '') : '';\n  },\n\n  isWithinCurrentRoutes: function (url) {\n    return url.indexOf(this.rootUrl.pathname()) !== -1;\n  },\n\n  renderGroupsIndex: function () {\n    this.model.set('view',\n      new GroupsIndexView({\n        newGroupUrl: this._groupUrl.bind(this),\n        groups: this.groups,\n        router: this\n      })\n    );\n  },\n\n  renderCreateGroup: function () {\n    var group = this.groups.newGroupById();\n    var self = this;\n    this.model.set('view',\n      ViewFactory.createByList([\n        self._createGroupHeader(group),\n        new CreateGroupView({\n          flashMessageModel: self.flashMessageModel,\n          group: group,\n          onCreated: self._navigateToGroup.bind(self, group)\n        })\n      ])\n    );\n  },\n\n  renderGroupUsers: function (id) {\n    var self = this;\n    this.model.createGroupView(this.groups, id, function (group) {\n      return ViewFactory.createByList([\n        self._createGroupHeader(group, 'group_users'),\n        new GroupUsersView({\n          group: group,\n          orgUsers: self.user.organization.users\n        })\n      ]);\n    });\n  },\n\n  renderEditGroup: function (id) {\n    var self = this;\n    this.model.createGroupView(this.groups, id, function (group) {\n      return ViewFactory.createByList([\n        self._createGroupHeader(group, 'edit_group'),\n        new EditGroupView({\n          flashMessageModel: self.flashMessageModel,\n          group: group,\n          onSaved: self._navigateToGroup.bind(self, group),\n          onDeleted: self.navigate.bind(self, self.rootUrl, { trigger: true })\n        })\n      ]);\n    });\n  },\n\n  _navigateToGroup: function (group) {\n    this.navigate(this.rootUrl.urlToPath(group.id), { trigger: true });\n  },\n\n  _groupUrl: function (group, subpath) {\n    var path = group.id;\n\n    if (subpath) {\n      path += '/' + subpath;\n    }\n\n    return this.rootUrl.urlToPath(path);\n  },\n\n  _createGroupHeader: function (group, current) {\n    var urls = {\n      root: this.rootUrl,\n      users: this._groupUrl(group),\n      edit: this._groupUrl(group, 'edit')\n    };\n    urls.users.isCurrent = current === 'group_users';\n    urls.edit.isCurrent = current === 'edit_group';\n\n    return new GroupHeaderView({\n      group: group,\n      urls: urls\n    });\n  },\n\n  _onChange: function () {\n    this.flashMessageModel.hide();\n  }\n\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar ViewFactory = require('../../common/view_factory');\nvar randomQuote = require('../../common/view_helpers/random_quote');\n\n/**\n * Model representing the router state\n */\nmodule.exports = cdb.core.Model.extend({\n\n  defaults: {\n    view: ''\n  },\n\n  createGroupView: function (groups, id, fetchedCallback) {\n    var self = this;\n    var group = groups.newGroupById(id);\n    fetchedCallback = fetchedCallback.bind(this, group);\n\n    var setFetchedCallbackView = function () {\n      self.set('view', fetchedCallback());\n    };\n\n    if (group.get('display_name')) {\n      setFetchedCallbackView();\n    } else {\n      // No display name == model not fetched yet, so show loading msg meanwhile\n      this.createLoadingView('Loading group details');\n      group.fetch({\n        data: {\n          fetch_users: true\n        },\n        success: function () {\n          groups.add(group);\n          setFetchedCallbackView();\n        },\n        error: this.createErrorView.bind(this)\n      });\n    }\n  },\n\n  createLoadingView: function (msg) {\n    this.set('view', ViewFactory.createByTemplate('common/templates/loading', {\n      title: msg,\n      quote: randomQuote()\n    }));\n  },\n\n  createErrorView: function () {\n    // Generic error view for now\n    this.set('view', ViewFactory.createByTemplate('common/templates/fail', {\n      msg: ''\n    }));\n  }\n\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\n\n/**\n * Header view model to handle state for dashboard header view.\n */\nmodule.exports = cdb.core.Model.extend({\n\n  breadcrumbTitle: function () {\n    return 'Configuration';\n  },\n\n  isBreadcrumbDropdownEnabled: function () {\n    return false;\n  },\n\n  isDisplayingDatasets: function () {\n    return false;\n  },\n\n  isDisplayingMaps: function () {\n    return false;\n  },\n\n  isDisplayingLockedItems: function () {\n    return false;\n  }\n\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar BaseDialog = require('../../../../../javascripts/cartodb/common/views/base_dialog/view');\nvar DialogIconPickerView = require('../icons/organization_icons_view');\n\nmodule.exports = BaseDialog.extend({\n\n  className: 'Dialog Modal IconPickerDialog',\n\n  events: BaseDialog.extendEvents({\n    'click .js-addIcon': '_onAddIconClicked'\n  }),\n\n  initialize: function () {\n    if (!this.options.orgId) { throw new Error('Organization ID is required.'); }\n    this._orgId = this.options.orgId;\n\n    this.elder('initialize');\n\n    this._template = cdb.templates.getTemplate('organization/icon_picker/icon_picker_dialog/icon_picker_dialog_template');\n  },\n\n  render: function () {\n    this.clearSubViews();\n    BaseDialog.prototype.render.call(this);\n    this.$('.content').addClass('Dialog-content--expanded');\n    this._initViews();\n    return this;\n  },\n\n  _initViews: function () {\n    this.icon_picker = new DialogIconPickerView({\n      el: this.$('.js-dialogIconPicker'),\n      orgId: this._orgId\n    });\n    this.addView(this.icon_picker);\n\n    this.icon_picker.model.on('change:isProcessRunning', this._onIsProcessRunningChanged, this);\n  },\n\n  _onIsProcessRunningChanged: function () {\n    var running = this.icon_picker.model.get('isProcessRunning');\n    if (running) {\n      this.$el.css('pointer-events', 'none');\n    } else {\n      this.$el.css('pointer-events', 'auto');\n    }\n  },\n\n  // implements cdb.ui.common.Dialog.prototype.render\n  render_content: function () {\n    return this._template();\n  },\n\n  _onAddIconClicked: function (event) {\n    this.killEvent(event);\n\n    this._hideErrorMessage();\n    this.$('.js-inputFile').trigger('click');\n  },\n\n  _hideErrorMessage: function () {\n    this._hide('.js-errorMessage');\n  },\n\n  _hide: function (selector) {\n    this.$(selector).addClass('is-hidden');\n  }\n});\n",
    "var BaseDialog = require('../../../../../javascripts/cartodb/common/views/base_dialog/view');\n\nmodule.exports = BaseDialog.extend({\n\n  initialize: function () {\n    if (!this.options.okCallback) {\n      throw new Error('Callback for OK action is mandatory.');\n    }\n    this.elder('initialize');\n    this._numOfIcons = this.options.numOfIcons || 0;\n    this._okCallback = this.options.okCallback;\n  },\n\n  render_content: function () {\n    return this.getTemplate('organization/icon_picker/icons/delete_icons_modal')({\n      numOfIcons: this._numOfIcons\n    });\n  },\n\n  ok: function () {\n    this._okCallback();\n    this.close();\n  }\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar Backbone = (typeof window !== \"undefined\" ? window['Backbone'] : typeof global !== \"undefined\" ? global['Backbone'] : null);\nvar IconModel = require('./organization_icon_model');\n\nmodule.exports = Backbone.Collection.extend({\n\n  model: IconModel,\n\n  url: function (method) {\n    var version = cdb.config.urlVersion('organization-assets', method);\n    return '/api/' + version + '/organization/' + this._orgId + '/assets';\n  },\n\n  initialize: function (attrs, opts) {\n    if (!opts.orgId) {\n      throw new Error('Organization ID is required');\n    }\n    this._orgId = opts.orgId;\n  }\n});\n",
    "var Backbone = (typeof window !== \"undefined\" ? window['Backbone'] : typeof global !== \"undefined\" ? global['Backbone'] : null);\nvar _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\n\nmodule.exports = Backbone.Model.extend({\n\n  defaults: {\n    selected: false,\n    visible: false,\n    deleted: false\n  },\n\n  fileAttribute: 'resource',\n\n  save: function (attrs, options) {\n    options || (options = {});\n    attrs || (attrs = _.clone(this.attributes));\n\n    // Filter the data to send to the server\n    attrs = _.omit(attrs, ['selected', 'visible', 'deleted']);\n    options.data = JSON.stringify(attrs);\n\n    // Proxy the call to the original save function\n    return Backbone.Model.prototype.save.call(this, attrs, options);\n  }\n});\n",
    "var _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\n\nmodule.exports = cdb.core.View.extend({\n  tagName: 'li',\n\n  className: 'IconList-item IconList-item--small',\n\n  events: {\n    'click': '_onClick'\n  },\n\n  initialize: function (options) {\n    if (_.isUndefined(options.model)) {\n      throw new Error('An organization icon model is mandatory.');\n    }\n\n    this._template = cdb.templates.getTemplate('organization/icon_picker/icons/organization_icon');\n    this._initBinds();\n  },\n\n  render: function () {\n    this.$el.html(this._template({\n      url: this.model.get('public_url')\n    }));\n\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.on('change:selected', this._onSelectedChanged, this);\n    this.model.on('change:deleted', this._onDeletedChanged, this);\n  },\n\n  _onClick: function () {\n    this.model.set('selected', !this.model.get('selected'));\n  },\n\n  _onSelectedChanged: function () {\n    this.$el.toggleClass('is-selected', this.model.get('selected'));\n  },\n\n  _onDeletedChanged: function () {\n    if (this.model.get('deleted')) {\n      this.$el.remove();\n    }\n  }\n});\n",
    "var _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar IconCollection = require('./organization_icon_collection');\nvar IconView = require('./organization_icon_view');\nvar DeleteIconsDialog = require('./delete_icons_dialog_view');\n\nmodule.exports = cdb.core.View.extend({\n\n  events: {\n    'click .js-addIcon': '_onAddIconClicked',\n    'click .js-selectAllIcons': '_onSelectAllIconsClicked',\n    'click .js-deselectAllIcons': '_onDeselectAllIconsClicked',\n    'click .js-deleteIcons': '_onDeleteIconsClicked',\n    'change .js-inputFile': '_onFileSelected'\n  },\n\n  initialize: function () {\n    if (!this.options.orgId) { throw new Error('Organization ID is required.'); }\n    this._orgId = this.options.orgId;\n\n    this.template = cdb.templates.getTemplate('organization/icon_picker/icons/organization_icons_template');\n    this.model = new cdb.core.Model({\n      isProcessRunning: false\n    });\n    this._iconCollection = new IconCollection(null, {\n      orgId: this._orgId\n    });\n    this._numOfUploadingProcesses = 0;\n    this._numOfDeletingProcesses = 0;\n    this._fetchErrorMessage = 'Error fetching organization icons. Please refresh the page.';\n    this._runningMessage = '';\n    this.render();\n    this._fetchAllIcons();\n    this._initBinds();\n  },\n\n  render: function () {\n    this.$el.html(this.template());\n\n    return this;\n  },\n\n  _initBinds: function () {\n    this._iconCollection.on('change:selected', this._refreshActions, this);\n    this.model.on('change:isProcessRunning', this._onProcessRunningChanged, this);\n    this.add_related_model(this._iconCollection);\n  },\n\n  _fetchAllIcons: function () {\n    this._iconCollection.fetch({\n      success: this._renderAllIcons.bind(this),\n      error: this._onFetchIconsError.bind(this)\n    });\n  },\n\n  _renderAllIcons: function () {\n    _.each(this._iconCollection.models, function (icon) {\n      this._addIconElement(icon);\n    }, this);\n  },\n\n  _onFetchIconsError: function () {\n    this._showErrorMessage(this._fetchErrorMessage);\n  },\n\n  _renderIcon: function (iconModel) {\n    var iconView = new IconView({\n      model: iconModel\n    });\n    iconView.render();\n    iconModel.set('visible', true);\n    this.$('.js-items').append(iconView.$el);\n  },\n\n  _addIconElement: function (iconModel) {\n    this._renderIcon(iconModel);\n  },\n\n  _onAddIconClicked: function (event) {\n    this.killEvent(event);\n\n    this._hideErrorMessage();\n    this.$('.js-inputFile').trigger('click');\n  },\n\n  _parseResponseText: function (response) {\n    if (response && response.responseText) {\n      try {\n        var text = JSON.parse(response.responseText);\n        if (text && text.errors && typeof text.errors === 'string') {\n          return text.errors;\n        }\n      } catch (exc) {\n        // Swallow\n      }\n    }\n    return '';\n  },\n\n  _getSelectedFiles: function () {\n    return this.$('.js-inputFile').prop('files');\n  },\n\n  _onFileSelected: function () {\n    var files = this._getSelectedFiles();\n\n    _.each(files, function (file) {\n      this._iconCollection.create({\n        kind: 'organization_asset',\n        resource: file\n      }, {\n        beforeSend: this._beforeIconUpload.bind(this),\n        success: this._onIconUploaded.bind(this),\n        error: this._onIconUploadError.bind(this),\n        complete: this._onIconUploadComplete.bind(this)\n      });\n    }, this);\n  },\n\n  _beforeIconUpload: function () {\n    this._numOfUploadingProcesses++;\n    if (this._numOfUploadingProcesses > 0) {\n      this._runningMessage = 'Uploading icons...';\n      this.model.set('isProcessRunning', true);\n    }\n  },\n\n  _onIconUploaded: function (iconModel) {\n    this._resetFileSelection();\n    this._addIconElement(iconModel);\n  },\n\n  _onIconUploadError: function (model, response) {\n    var errorText = this._parseResponseText(response);\n    this._resetFileSelection();\n    this._showErrorMessage(this._uploadErrorMessage(errorText));\n  },\n\n  _onIconUploadComplete: function () {\n    this._numOfUploadingProcesses--;\n    if (this._numOfUploadingProcesses <= 0) {\n      this.model.set('isProcessRunning', false);\n    }\n  },\n\n  _resetFileSelection: function () {\n    this.$('.js-inputFile').val('');\n  },\n\n  _show: function (selector) {\n    this.$(selector).removeClass('is-hidden');\n  },\n\n  _hide: function (selector) {\n    this.$(selector).addClass('is-hidden');\n  },\n\n  _refreshActions: function () {\n    if (this.model.get('isProcessRunning')) {\n      return;\n    }\n    var limit = Math.min(this._iconCollection.length);\n    var numOfSelectedIcons = this._getNumberOfSelectedIcons();\n    var iconText = (numOfSelectedIcons === 1 ? '1 icon selected' : '' + numOfSelectedIcons + ' icons selected');\n    this.$('.js-iconMainLabel').text(iconText);\n\n    if (numOfSelectedIcons === 0) {\n      this.$('.js-iconMainLabel').text('');\n      this._hide('.js-iconMainLabel, .js-selectAllIcons, .js-deselectAllIcons, .js-deleteIcons');\n      this._show('.js-iconsInfo');\n    } else if (numOfSelectedIcons < limit) {\n      this._show('.js-iconMainLabel, .js-selectAllIcons, .js-deleteIcons');\n      this._hide('.js-deselectAllIcons, .js-iconsInfo');\n    } else {\n      this._show('.js-iconMainLabel, .js-deselectAllIcons, .js-deleteIcons');\n      this._hide('.js-selectAllIcons, .js-iconsInfo');\n    }\n\n    if (numOfSelectedIcons > 1) {\n      this.$('.js-deleteIcons a').text('Delete icons...');\n    } else if (numOfSelectedIcons === 1) {\n      this.$('.js-deleteIcons a').text('Delete icon...');\n    }\n  },\n\n  _hideActions: function () {\n    this._hide('.js-selectAllIcons, .js-deselectAllIcons, .js-deleteIcons, .js-iconsInfo');\n  },\n\n  _onDeselectAllIconsClicked: function (event) {\n    event.preventDefault();\n    this._iconCollection.each(function (icon) {\n      icon.set('selected', false);\n    });\n  },\n\n  _onSelectAllIconsClicked: function (event) {\n    event.preventDefault();\n    this._iconCollection.each(function (icon) {\n      if (icon.get('visible')) {\n        icon.set('selected', true);\n      }\n    });\n  },\n\n  _onDeleteIconsClicked: function (event) {\n    event.preventDefault();\n    this._openDeleteIconsDialog();\n  },\n\n  _bindDeleteIconsDialog: function () {\n    cdb.god.bind('closeDialogs:delete', this._destroyDeleteIconsDialog, this);\n  },\n\n  _unbindDeleteIconsDialog: function () {\n    cdb.god.unbind('closeDialogs:delete', this._destroyDeleteIconsDialog, this);\n  },\n\n  _openDeleteIconsDialog: function (e) {\n    this.killEvent(e);\n\n    cdb.god.trigger('closeDialogs:delete');\n\n    this.delete_icons_dialog = new DeleteIconsDialog({\n      numOfIcons: this._getNumberOfSelectedIcons(),\n      okCallback: this._deleteIcons.bind(this)\n    });\n\n    this.delete_icons_dialog.appendToBody();\n\n    this._bindDeleteIconsDialog();\n    this.addView(this.delete_icons_dialog);\n  },\n\n  _deleteIcons: function () {\n    this._hideErrorMessage();\n    var iconsToDelete = this._iconCollection.where({ selected: true });\n\n    _.each(iconsToDelete, function (icon) {\n      icon.destroy({\n        beforeSend: this._beforeIconDelete.bind(this),\n        success: this._onIconDeleted.bind(this),\n        error: this._onIconDeleteError.bind(this),\n        complete: this._onIconDeleteComplete.bind(this)\n      });\n    }, this);\n  },\n\n  _destroyDeleteIconsDialog: function () {\n    if (this.delete_icons_dialog) {\n      this._unbindDeleteIconsDialog();\n      this.delete_icons_dialog.remove();\n      this.removeView(this.delete_icons_dialog);\n      this.delete_icons_dialog.hide();\n      delete this.delete_icons_dialog;\n    }\n  },\n\n  _getNumberOfSelectedIcons: function () {\n    return this._iconCollection.where({ selected: true }).length;\n  },\n\n  _beforeIconDelete: function () {\n    this._numOfDeletingProcesses++;\n    if (this._numOfDeletingProcesses > 0) {\n      this._runningMessage = 'Deleting icons...';\n      this.model.set('isProcessRunning', true);\n    }\n  },\n\n  _onIconDeleted: function (icon) {\n    icon.set('deleted', true);\n    this._addExtraIcon();\n  },\n\n  _onIconDeleteError: function (icon, response) {\n    var errorText = this._parseResponseText(response);\n    // Even if API throws error the icon has been already removed from the collection.\n    // We must add it again\n    this._iconCollection.add(icon);\n    this._resetSelection();\n    this._showErrorMessage(this._deleteErrorMessage(errorText));\n  },\n\n  _onIconDeleteComplete: function () {\n    this._numOfDeletingProcesses--;\n    if (this._numOfDeletingProcesses <= 0) {\n      this.model.set('isProcessRunning', false);\n    }\n  },\n\n  _showSpinner: function (enable) {\n    if (enable) {\n      this._hide('.js-plusSign');\n      this._show('.js-spinner');\n    } else {\n      this._show('.js-plusSign');\n      this._hide('.js-spinner');\n    }\n  },\n\n  _showErrorMessage: function (message) {\n    this.$('.js-errorMessage label').text(message);\n    this._show('.js-errorMessage');\n  },\n\n  _hideErrorMessage: function () {\n    this._hide('.js-errorMessage');\n  },\n\n  _resetSelection: function () {\n    this._iconCollection.each(function (icon) {\n      icon.set('selected', false);\n    });\n    this._refreshActions();\n  },\n\n  _addExtraIcon: function () {\n    var iconAdded = false;\n    this._iconCollection.each(function (icon) {\n      if (!icon.get('visible') && !iconAdded) {\n        this._addIconElement(icon);\n        iconAdded = true;\n      }\n    }, this);\n  },\n\n  _onProcessRunningChanged: function () {\n    var running = this.model.get('isProcessRunning');\n    this._showSpinner(running);\n    if (running) {\n      this.$el.css('pointer-events', 'none');\n      this._hideActions();\n      this.$('.js-runningInfo').text(this._runningMessage);\n      this._show('.js-runningInfo');\n    } else {\n      this.$('.js-runningInfo').text('');\n      this._hide('.js-runningInfo');\n      this._refreshActions();\n      cdb.god.trigger('refreshCollection', { cid: this.cid });\n      this.$el.css('pointer-events', 'auto');\n    }\n  },\n\n  _uploadErrorMessage: function (errorText) {\n    var message = 'Error uploading your image. ';\n    if (errorText) {\n      message += '[ ' + errorText + ' ]. ';\n    }\n    message += 'Please try again.';\n\n    return message;\n  },\n\n  _deleteErrorMessage: function (errorText) {\n    var message = 'Error deleting your image. ';\n    if (errorText) {\n      message += '[ ' + errorText + ' ]. ';\n    }\n    message += 'Please try again.';\n\n    return message;\n  }\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar IconPickerView = require('./icons/organization_icons_view');\nvar IconCollection = require('./icons/organization_icon_collection');\nvar IconView = require('./icons/organization_icon_view');\nvar IconPickerDialog = require('./icon_picker_dialog/icon_picker_dialog_view');\n\nmodule.exports = IconPickerView.extend({\n\n  events: IconPickerView.extendEvents({\n    'click .js-viewAllIcons': '_onViewAllIconsClicked'\n  }),\n\n  initialize: function () {\n    if (!this.options.orgId) { throw new Error('Organization ID is required.'); }\n    this._orgId = this.options.orgId;\n\n    this._maxIcons = 23;\n    this.template = cdb.templates.getTemplate('organization/icon_picker/organization_icon_picker_template');\n    this.model = new cdb.core.Model({\n      isProcessRunning: false\n    });\n    this._iconCollection = new IconCollection(null, {\n      orgId: this._orgId\n    });\n    this._numOfUploadingProcesses = 0;\n    this._numOfDeletingProcesses = 0;\n    this._fetchErrorMessage = 'Error fetching organization icons. Please refresh the page.';\n    this._runningMessage = '';\n    this.render();\n    this._fetchAllIcons();\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this._iconCollection.on('change:selected', this._refreshActions, this);\n    this.model.on('change:isProcessRunning', this._onProcessRunningChanged, this);\n    cdb.god.bind('refreshCollection', this._refreshCollection, this);\n  },\n\n  _refreshCollection: function (data) {\n    if (data.cid && this.cid !== data.cid) {\n      this.render();\n      this._fetchAllIcons();\n    }\n  },\n\n  _renderIcon: function (iconModel) {\n    if (iconModel.get('index') < this._maxIcons) {\n      var iconView = new IconView({\n        model: iconModel\n      });\n      iconView.render();\n      iconModel.set('visible', true);\n      this.$('.js-items').append(iconView.$el);\n    }\n  },\n\n  _addIconElement: function (iconModel) {\n    iconModel.set('index', this._getIconIndex(iconModel));\n    this._renderIcon(iconModel);\n    this._refreshActions();\n  },\n\n  _refreshActions: function () {\n    if (this.model.get('isProcessRunning')) {\n      return;\n    }\n    var limit = Math.min(this._maxIcons, this._iconCollection.length);\n    var numOfSelectedIcons = this._getNumberOfSelectedIcons();\n    var iconText = (numOfSelectedIcons === 1 ? '1 icon selected' : '' + numOfSelectedIcons + ' icons selected');\n    this.$('.js-iconMainLabel').text(iconText);\n\n    if (numOfSelectedIcons === 0) {\n      this.$('.js-iconMainLabel').text('Icons');\n      this._hide('.js-selectAllIcons, .js-deselectAllIcons, .js-deleteIcons');\n      this._show('.js-iconsInfo');\n    } else if (numOfSelectedIcons < limit) {\n      this._show('.js-selectAllIcons, .js-deleteIcons');\n      this._hide('.js-deselectAllIcons, .js-iconsInfo');\n    } else {\n      this._hide('.js-selectAllIcons, .js-iconsInfo');\n      this._show('.js-deselectAllIcons, .js-deleteIcons');\n    }\n\n    if (numOfSelectedIcons > 1) {\n      this.$('.js-deleteIcons a').text('Delete icons...');\n    } else if (numOfSelectedIcons === 1) {\n      this.$('.js-deleteIcons a').text('Delete icon...');\n    }\n\n    if (this._iconCollection.length > this._maxIcons) {\n      this._show('.js-viewAllIcons');\n    } else {\n      this._hide('.js-viewAllIcons');\n    }\n  },\n\n  _hideActions: function () {\n    this._hide('.js-selectAllIcons, .js-deselectAllIcons, .js-deleteIcons, .js-iconsInfo, .js-viewAllIcons');\n  },\n\n  _getIconIndex: function (icon) {\n    return this._iconCollection.indexOf(icon);\n  },\n\n  _addExtraIcon: function () {\n    var iconAdded = false;\n    this._iconCollection.each(function (icon) {\n      var index = this._getIconIndex(icon);\n      if (index < this._maxIcons && !icon.get('visible') && !iconAdded) {\n        this._addIconElement(icon);\n        iconAdded = true;\n      }\n    }, this);\n  },\n\n  _bindIconsPicker: function () {\n    cdb.god.bind('closeDialogs:icons', this._destroyPicker, this);\n  },\n\n  _unbindIconsPicker: function () {\n    cdb.god.unbind('closeDialogs:icons', this._destroyPicker, this);\n  },\n\n  _destroyPicker: function () {\n    if (this.icon_picker_dialog) {\n      this._unbindIconsPicker();\n      this.icon_picker_dialog.remove();\n      this.removeView(this.icon_picker_dialog);\n      this.icon_picker_dialog.hide();\n      delete this.icon_picker_dialog;\n    }\n  },\n\n  _onViewAllIconsClicked: function (event) {\n    this.killEvent(event);\n\n    cdb.god.trigger('closeDialogs:icons');\n\n    this.icon_picker_dialog = new IconPickerDialog({\n      orgId: this._orgId\n    });\n    this.icon_picker_dialog.appendToBody();\n\n    this._bindIconsPicker();\n    this.addView(this.icon_picker_dialog);\n  }\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar BaseDialog = require('../../common/views/base_dialog/view');\nvar randomQuote = require('../../common/view_helpers/random_quote');\nvar ViewFactory = require('../../common/view_factory');\nvar InviteUsersFormView = require('./invite_users_form_view');\n\n/**\n *  Invite users dialog\n *\n *  - Send invites via email.\n *  - Shouldn't send emails to already enabled users.\n *\n */\n\nmodule.exports = BaseDialog.extend({\n\n  className: 'Dialog is-opening InviteUsers',\n\n  initialize: function () {\n    this.elder('initialize');\n    this.organization = this.options.organization;\n    this.organizationUsers = this.options.organizationUsers;\n    this.model = new cdb.admin.Organization.Invites(\n      {},\n      {\n        organizationId: this.organization.id,\n        enable_organization_signup: false\n      }\n    );\n    this.template = cdb.templates.getTemplate('organization/invite_users/invite_users_dialog_template');\n  },\n\n  render: function () {\n    this.clearSubViews();\n    BaseDialog.prototype.render.call(this);\n    this.$('.content').addClass('Dialog-content--expanded');\n    this._initViews();\n    return this;\n  },\n\n  render_content: function () {\n    return this.template();\n  },\n\n  _initViews: function () {\n    // Panes\n    this._panes = new cdb.ui.common.TabPane({\n      el: this.$('.js-content')\n    });\n\n    // Create form\n    this._form = new InviteUsersFormView({\n      model: this.model,\n      organization: this.organization,\n      organizationUsers: this.organizationUsers,\n      el: this.$('.js-form')\n    });\n\n    this._form.bind('onSubmit', this._sendInvites, this);\n    this._panes.addTab('form', this._form.render());\n\n    // Create loading\n    this._panes.addTab('loading',\n      ViewFactory.createByTemplate('common/templates/loading', {\n        title: 'Sending invites...',\n        quote: randomQuote()\n      }).render()\n    );\n\n    // Create error\n    this._panes.addTab('error',\n      ViewFactory.createByTemplate('common/templates/fail', {\n        msg: 'Sorry, something went wrong.'\n      }).render()\n    );\n\n    this._panes.active('form');\n  },\n\n  _sendInvites: function () {\n    var self = this;\n    this._panes.active('loading');\n    this.model.save(null, {\n      success: function () {\n        self.close();\n      },\n      error: function (mdl, err) {\n        try {\n          var msg = JSON.parse(err.responseText).errors.users_emails[0];\n          self._form.showSubmitError(msg);\n          self._panes.active('form');\n        } catch (e) {\n          self._panes.active('error');\n        }\n      }\n    });\n  }\n\n});\n",
    "var _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar Utils = (typeof window !== \"undefined\" ? window['cdb']['Utils'] : typeof global !== \"undefined\" ? global['cdb']['Utils'] : null);\n\n/**\n *  Form view for invite users dialog\n *\n */\n\nmodule.exports = cdb.core.View.extend({\n\n  events: {\n    'submit .js-invitesForm': '_onSubmit',\n    'keyup .js-welcomeText': '_onTextareaChange',\n    'click .js-enableSignInButton': '_signInEnabledMessage'\n  },\n\n  initialize: function () {\n    this.organizationUsers = this.options.organizationUsers;\n    this.organization = this.options.organization;\n    this.template = cdb.templates.getTemplate('organization/invite_users/invite_users_form_template');\n    this._initBinds();\n  },\n\n  render: function () {\n    this.$el.html(\n      this.template({\n        welcomeText: this.model.get('welcome_text'),\n        signupEnabled: this.organization.get('signup_enabled'),\n        viewerEnabled: this.organization.get('viewer_seats') > 0\n      })\n    );\n    this._toggleEmailError(false);\n    this._initViews();\n    return this;\n  },\n\n  _renderFlashMessage: function () {\n    var flashTemplate = cdb.templates.getTemplate('organization/invite_users/invite_users_flash_message_template');\n    this.$('.js-signInMessageContainer').html(flashTemplate());\n\n    this.$('.js-flashSuccess').hide();\n  },\n\n  _initBinds: function () {\n    this.model.bind('change', this._onChange, this);\n  },\n\n  _initViews: function () {\n    var self = this;\n    var organizationUsersEmail = this.organizationUsers.pluck('email');\n\n    this.$('.js-tagsList').tagit({\n      allowSpaces: true,\n      placeholderText: this.$('.js-tags').data('title'),\n      onBlur: function () {\n        self.$('.js-tags').removeClass('is-focus');\n      },\n      onFocus: function () {\n        self.$('.js-tags').addClass('is-focus');\n      },\n      beforeTagAdded: function (ev, ui) {\n        var value = ui.tagLabel;\n        self._removeSubmitError();\n\n        // It is an email\n        if (!Utils.isValidEmail(value)) {\n          return false;\n        }\n\n        // It is already in the organization\n        if (_.contains(organizationUsersEmail, value)) {\n          self._toggleEmailError(true);\n          return false;\n        } else {\n          self._toggleEmailError(false);\n        }\n      },\n      beforeTagRemoved: function () {\n        self._removeSubmitError();\n      },\n      afterTagRemoved: function (ev, ui) {\n        self._updateUsers();\n      },\n      afterTagAdded: function (ev, ui) {\n        self._updateUsers();\n      },\n      onSubmitTags: function (ev, tagList) {\n        ev.preventDefault();\n        self._onSubmit();\n        return false;\n      }\n    });\n\n    if (!this.organization.get('signup_enabled')) {\n      this._renderFlashMessage();\n    }\n  },\n\n  _onTextareaChange: function () {\n    this.model.set('welcome_text', this.$('.js-welcomeText').val());\n  },\n\n  _updateUsers: function () {\n    this.model.set('users_emails', this.$('.js-tagsList').tagit('assignedTags'));\n  },\n\n  _onSubmit: function (ev) {\n    if (ev) {\n      this.killEvent(ev);\n    }\n    var emails = this.model.get('users_emails');\n    if (emails.length > 0) {\n      this.model.set('welcome_text', this.$('.js-welcomeText').val());\n      this.model.set('viewer', this.$('[name=viewer]').get(0).checked);\n      this.trigger('onSubmit', this);\n    }\n  },\n\n  _signInEnabledMessage: function () {\n    this.$('.js-signInMessage').addClass('FlashMessage--success');\n    this.$('.js-flashNotice').hide();\n    this.$('.js-flashSuccess').show();\n\n    this.model.set('enable_organization_signup', true);\n  },\n\n  _toggleEmailError: function (visible) {\n    this.$('.js-emailError')[ visible ? 'show' : 'hide' ]();\n  },\n\n  showSubmitError: function (msg) {\n    var $serverError = this.$('.js-serverError');\n    if ($serverError.length === 0) {\n      this.$('.js-emailError').after('<p class=\"Form-rowInfoText Form-rowInfoText--error Form-rowInfoText--multipleLines js-serverError\">' + msg + '</p>');\n    }\n  },\n\n  _removeSubmitError: function () {\n    this.$('.js-serverError').remove();\n  },\n\n  _onChange: function () {\n    var users = this.model.get('users_emails');\n    var welcomeText = this.model.get('welcome_text');\n    this.$('.js-submit').toggleClass('is-disabled', users.length === 0 || !welcomeText);\n  }\n\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar BaseDialog = require('../../common/views/base_dialog/view');\nvar randomQuote = require('../../common/view_helpers/random_quote');\nvar ViewFactory = require('../../common/view_factory');\n\nmodule.exports = BaseDialog.extend({\n\n  options: {\n    authenticityToken: '',\n    organizationUser: {}\n  },\n\n  events: BaseDialog.extendEvents({\n    'click .js-ok': '_ok',\n    'click .js-cancel': '_cancel'\n  }),\n\n  className: 'Dialog is-opening',\n\n  initialize: function () {\n    this.elder('initialize');\n    this.template = cdb.templates.getTemplate('organization/organization_notification/delete_notification_dialog');\n  },\n\n  render_content: function () {\n    return this.template({\n      formAction: cdb.config.prefixUrl() + '/organization/notifications/' + this.options.notificationId,\n      authenticityToken: this.options.authenticityToken\n    });\n  },\n\n  ok: function () {\n    var loadingView = ViewFactory.createDialogByTemplate('common/templates/loading', {\n      title: 'Removing',\n      quote: randomQuote()\n    });\n    loadingView.appendToBody();\n\n    this.submit();\n    this.close();\n  },\n\n  submit: function () {\n    this.$('form').submit();\n  }\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\nvar RemoveNotificationDialog = require('./delete_notification_dialog_view');\nvar SendButton = require('./send_button_view');\nvar markdown = require('markdown');\n\nmodule.exports = cdb.core.View.extend({\n\n  events: {\n    'click .js-resend': '_onClickResend',\n    'click .js-remove': '_onClickRemove',\n    'keydown .js-textarea': '_onTextareaKeydown',\n    'input .js-textarea': '_updateCounter',\n    'propertychange .js-textarea': '_updateCounter'\n  },\n\n  render: function () {\n    this.$textarea = this.$('#carto_notification_body');\n\n    this._initViews();\n    this._updateCounter();\n\n    return this;\n  },\n\n  _initViews: function () {\n    this.sendButton = new SendButton();\n\n    this.$('.js-send').html(this.sendButton.render().el);\n    this.addView(this.sendButton);\n\n    this.sendButton.bind('submitForm', this._submitForm, this);\n  },\n\n  _submitForm: function () {\n    if (navigator.userAgent.toLowerCase().indexOf('firefox') !== -1) {\n      this.$('form').clone().appendTo('body').submit(); // FF only\n    } else {\n      this.$('form').submit();\n    }\n  },\n\n  _updateCounter: function () {\n    var strLen = $(markdown.toHTML(this.$textarea.val())).text().length;\n    this.sendButton.updateCounter(strLen);\n  },\n\n  _onClickResend: function (event) {\n    var $notificationItem = $(event.target).closest('.js-NotificationsList-item');\n    var title = $notificationItem.find('.js-html_body').data('body');\n    var recipients = $notificationItem.find('.js-recipients').data('recipients');\n\n    this.$textarea.val(title);\n    this.$('input[name=\"carto_notification[recipients]\"]').prop('checked', false);\n    this.$('input[name=\"carto_notification[recipients]\"][value=\"' + recipients + '\"]').prop('checked', true);\n\n    $('body').animate({\n      scrollTop: 0\n    });\n\n    this._updateCounter();\n  },\n\n  _onTextareaKeydown: function (event) {\n    if (event.keyCode === 13 && event.metaKey) {\n      this.sendButton.onUpdate();\n    }\n  },\n\n  _destroyRemoveNotificationDialog: function () {\n    if (this.remove_notification_dialog) {\n      this._unbindRemoveNotificationDialog();\n      this.remove_notification_dialog.remove();\n      this.removeView(this.remove_notification_dialog);\n      this.remove_notification_dialog.hide();\n      delete this.remove_notification_dialog;\n    }\n  },\n\n  _bindRemoveNotificationDialog: function () {\n    cdb.god.bind('closeDialogs:delete', this._destroyRemoveNotificationDialog, this);\n  },\n\n  _unbindRemoveNotificationDialog: function () {\n    cdb.god.unbind('closeDialogs:delete', this._destroyRemoveNotificationDialog, this);\n  },\n\n  _onClickRemove: function (event) {\n    cdb.god.trigger('closeDialogs:delete');\n\n    var $target = $(event.target);\n\n    this.remove_notification_dialog = new RemoveNotificationDialog({\n      authenticityToken: this.options.authenticityToken,\n      notificationId: $target.data('id')\n    });\n    this.remove_notification_dialog.appendToBody();\n    this._bindRemoveNotificationDialog();\n    this.addView(this.remove_notification_dialog);\n  }\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar Backbone = (typeof window !== \"undefined\" ? window['Backbone'] : typeof global !== \"undefined\" ? global['Backbone'] : null);\n\nvar MAXSTRLEN = 140;\n\nmodule.exports = cdb.core.View.extend({\n\n  className: 'FormAccount-rowData',\n\n  events: {\n    'click .js-button': 'onUpdate'\n  },\n\n  initialize: function (opts) {\n    this.template = cdb.templates.getTemplate('organization/organization_notification/send_button');\n\n    this.model = new Backbone.Model({\n      status: 'idle',\n      counter: 0\n    });\n\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    this.$el.html(this.template({\n      isLoading: this._isLoading(),\n      isDisabled: this._isDisabled(),\n      isNegative: this._isNegative(),\n      counter: MAXSTRLEN - this.model.get('counter')\n    }));\n\n    return this;\n  },\n\n  updateCounter: function (strLen) {\n    this.model.set('counter', strLen);\n  },\n\n  _initBinds: function () {\n    this.model.bind('change', this.render, this);\n  },\n\n  _isNegative: function () {\n    return this.model.get('counter') > MAXSTRLEN;\n  },\n\n  _isDisabled: function () {\n    return (this.model.get('counter') === 0) || this._isNegative() || this._isLoading();\n  },\n\n  _isLoading: function () {\n    return this.model.get('status') === 'loading';\n  },\n\n  _submit: function () {\n    this.trigger('submitForm');\n  },\n\n  onUpdate: function () {\n    if (this._isDisabled()) return false;\n\n    this._submit();\n\n    this.model.set({ status: 'loading' });\n  }\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\n\n/* Organization user form */\nmodule.exports = cdb.core.View.extend({\n  events: {\n    'submit': '_validateFormSubmit'\n  },\n\n  _validateFormSubmit: function (event) {\n    if (this.$('.js-userQuotaError').length > 0) {\n      return false;\n    }\n  }\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar UserQuotaSlider = require('./organization_user_quota_slider');\nvar UserQuotaSliderInput = require('./organization_user_quota_slider_input');\n\n/* Progress quota bar for organization users */\n\nmodule.exports = cdb.core.View.extend({\n\n  initialize: function () {\n    // Quota slider\n    this.userQuotaSlider = new UserQuotaSlider({\n      el: this.$('.js-userQuotaSlider'),\n      model: this.model\n    });\n\n    this.addView(this.userQuotaSlider);\n\n    // Quota slider input\n    this.userQuotaSliderInput = new UserQuotaSliderInput({\n      el: this.$('.js-userQuotaSliderInput'),\n      model: this.model\n    });\n\n    this.addView(this.userQuotaSliderInput);\n\n    this._initBinds();\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:quota_in_bytes', this._onQuotaChange, this);\n  },\n\n  _onQuotaChange: function (model, quota) {\n    this.$('#user_quota').val(quota);\n  }\n});\n",
    "var $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\n\n/* Progress quota bar for organization users */\n\nmodule.exports = cdb.core.View.extend({\n\n  events: {\n    'hover .js-quotaProgressSlider': '_showTooltip'\n  },\n\n  initialize: function () {\n    this._initBinds();\n    this._initViews();\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:quota_in_bytes', this._onQuotaChange, this);\n  },\n\n  _initViews: function () {\n    var userMinQuota = 104857600 / this.model.organization.get('available_quota_for_user');\n\n    // Init slider\n    this.$('.js-slider').slider({\n      max: 100,\n      min: userMinQuota,\n      step: 1,\n      value: this.model.assignedQuotaPercentage(),\n      range: 'min',\n      orientation: 'horizontal',\n      slide: this._onSlideChange.bind(this)\n    });\n\n    $('.ui-slider-handle').addClass('js-quotaProgressSlider');\n  },\n\n  _onSlideChange: function (ev, ui) {\n    var userQuota = Math.max(Math.floor((this.model.organization.get('available_quota_for_user') * ui.value) / 100), 1);\n    var assignedPer = (userQuota * 100) / this.model.organization.get('available_quota_for_user');\n\n    if (ui.value >= this.model.usedQuotaPercentage()) {\n      this.$('.ui-slider-range').css('width', assignedPer + '%');\n      this.$('.js-quotaProgressSlider').css('left', assignedPer + '%');\n\n      var tooltipLeft = $('.js-quotaProgressSlider').offset().left -\n        ($('.js-orgUserQuotaTooltip').outerWidth() / 2) +\n        ($('.js-quotaProgressSlider').outerWidth() / 2);\n\n      $('.js-orgUserQuotaTooltip').css('left', tooltipLeft);\n\n      this.model.set('quota_in_bytes', userQuota);\n    } else {\n      return false;\n    }\n  },\n\n  _onQuotaChange: function () {\n    if (this.model.assignedQuotaPercentage() >= this.model.usedQuotaPercentage()) {\n      $('.ui-slider-range').css('width', Math.min(this.model.assignedQuotaPercentage(), 100) + '%');\n      $('.js-quotaProgressSlider').css('left', Math.min(this.model.assignedQuotaPercentage(), 100) + '%');\n    }\n  },\n\n  _showTooltip: function () {\n    var viewModel = this.model;\n\n    this.addView(\n      new cdb.common.TipsyTooltip({\n        el: $('.js-quotaProgressSlider'),\n        className: 'js-orgUserQuotaTooltip',\n        title: function () {\n          return viewModel.assignedQuotaPercentage().toFixed(0) + '% of the available org quota';\n        }\n      })\n    );\n  }\n});\n",
    "var $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\n\n/* Progress quota bar for organization users input */\n\nmodule.exports = cdb.core.View.extend({\n\n  events: {\n    'keyup .js-assignedSize': '_onKeyup'\n  },\n\n  initialize: function () {\n    this._initBinds();\n    this._initViews();\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:quota_in_bytes', this._onQuotaChange, this);\n  },\n\n  _initViews: function () {\n    var quotaInMb = Math.max(Math.floor(this.model.get('quota_in_bytes') / 1024 / 1024).toFixed(0), 1);\n    this.$('.js-assignedSize').val(quotaInMb);\n  },\n\n  _onQuotaChange: function () {\n    this.$('.js-assignedSize').val(Math.max(this.model.assignedQuotaInRoundedMb(), 1));\n  },\n\n  _onKeyup: function () {\n    var modifiedQuotaInBytes = Math.max(Math.floor(this.$('.js-assignedSize').val() * 1048576), 1048576);\n    var assignedPer = (modifiedQuotaInBytes * 100) / this.model.organization.get('available_quota_for_user');\n    var errorMessage = '<p class=\"FormAccount-rowInfoText FormAccount-rowInfoText--error js-userQuotaError\">Invalid quota, insert a valid one.</p>';\n\n    if (!isNaN(assignedPer)) {\n      this.model.set('quota_in_bytes', modifiedQuotaInBytes);\n    }\n\n    if (isNaN(assignedPer) || (this.model.get('quota_in_bytes') > this.model.organization.get('available_quota_for_user')) || (this.model.get('quota_in_bytes') < this.model.get('db_size_in_bytes'))) {\n      this.$('.js-assignedSize').addClass('has-error');\n\n      if (this.$('.js-userQuotaError').length === 0) {\n        $('.js-userQuotaSliderInput').append(errorMessage);\n      }\n    } else {\n      this.$('.js-assignedSize').removeClass('has-error');\n      this.$('.js-userQuotaError').remove();\n    }\n  }\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar Utils = (typeof window !== \"undefined\" ? window['cdb']['Utils'] : typeof global !== \"undefined\" ? global['cdb']['Utils'] : null);\nvar pluralizeStr = require('../../common/view_helpers/pluralize_string');\n\nmodule.exports = cdb.core.View.extend({\n\n  className: 'OrganizationList-user',\n  tagName: 'li',\n\n  initialize: function () {\n    this.template = cdb.templates.getTemplate('organization/organization_users/organization_user');\n  },\n\n  render: function () {\n    this.$el.html(\n      this.template({\n        totalPer: this.options.totalPer,\n        userPer: this.options.userPer,\n        usedPer: this.options.usedPer,\n        isOwner: this.options.isOwner,\n        isAdmin: this.options.isAdmin,\n        isViewer: this.options.isViewer,\n        editable: this.options.editable,\n        url: this.options.url,\n        sizeOnBytes: Utils.readablizeBytes(this.model.get('db_size_in_bytes')),\n        quotaInBytes: Utils.readablizeBytes(this.model.get('quota_in_bytes')),\n        avatarUrl: this.model.get('avatar_url'),\n        username: this.model.get('username'),\n        user_email: this.model.get('email'),\n        table_count: pluralizeStr.prefixWithCount('Dataset', 'Datasets', this.model.get('table_count')),\n        maps_count: pluralizeStr.prefixWithCount('Map', 'Maps', this.model.get('all_visualization_count'))\n      })\n    );\n\n    return this;\n  }\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\n\nmodule.exports = cdb.core.View.extend({\n\n  className: 'Form-footer',\n\n  initialize: function () {\n    this.template = cdb.templates.getTemplate('organization/organization_users/organization_users_footer');\n    this._initBinds();\n  },\n\n  render: function () {\n    this.$el.html(\n      this.template({\n        seats: this.model.get('seats'),\n        users: this.options.organizationUsers.totalCount(),\n        newUserUrl: this.model.viewUrl().create(),\n        upgradeUrl: window.upgrade_url,\n        customHosted: cdb.config.get('cartodb_com_hosted')\n      })\n    );\n\n    return this;\n  },\n\n  _initBinds: function () {\n    this.model.bind('change:total_users', this.render, this);\n    this.options.organizationUsers.bind('reset', this.render, this);\n    this.add_related_model(this.options.organizationUsers);\n  }\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\nvar PaginationView = require('../../common/views/pagination/view');\nvar OrganizationUserView = require('./organization_user_view');\n\nmodule.exports = cdb.core.View.extend({\n\n  initialize: function () {\n    this.organization = this.options.organization;\n    this.paginationModel = this.options.paginationModel;\n    this.currentUser = this.options.currentUser;\n    this._initBinds();\n  },\n\n  render: function () {\n    this.clearSubViews();\n\n    this.$el.empty();\n\n    // Users list\n    var $ul = $('<ul>').addClass('OrganizationList');\n    this.$el.append($ul);\n    var totalPer = 0;\n    this.collection.each(function (user) {\n      // Calculations to create organization user bars\n      var userPer = (user.get('quota_in_bytes') * 100) / this.organization.get('quota_in_bytes');\n      var usedPer = (user.get('db_size_in_bytes') * 100) / this.organization.get('quota_in_bytes');\n      user.organization = this.organization;\n\n      var v = new OrganizationUserView({\n        model: user,\n        isOwner: user.isOrgOwner(),\n        isAdmin: user.isOrgAdmin(),\n        isViewer: user.get('viewer'),\n        editable: this.currentUser.isOrgOwner() || this.currentUser.id === user.id || !user.isOrgAdmin(),\n        userPer: userPer,\n        usedPer: usedPer,\n        totalPer: totalPer,\n        url: this.organization.viewUrl().edit(user)\n      });\n\n      $ul.append(v.render().el);\n      this.addView(v);\n\n      totalPer = totalPer + userPer;\n    }, this);\n\n    // Paginator\n    var $paginatorWrapper = $('<div>').addClass('OrganizationList-paginator');\n    this.$el.append($paginatorWrapper);\n    var paginationView = new PaginationView({\n      model: this.paginationModel\n    });\n    $paginatorWrapper.append(paginationView.render().el);\n    this.addView(paginationView);\n\n    return this;\n  },\n\n  _initBinds: function () {\n    this.collection.bind('reset', this.render, this);\n    this.add_related_model(this.collection);\n  }\n});\n",
    "var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\nvar Utils = (typeof window !== \"undefined\" ? window['cdb']['Utils'] : typeof global !== \"undefined\" ? global['cdb']['Utils'] : null);\nvar OrganizationUsersListView = require('./organization_users_list_view');\nvar OrganizationUsersFooterView = require('./organization_users_footer_view');\nvar PagedSearchModel = require('../../common/paged_search_model');\nvar PaginationModel = require('../../common/views/pagination/model');\nvar randomQuote = require('../../common/view_helpers/random_quote');\nvar ViewFactory = require('../../common/view_factory');\nvar InviteUsersDialogView = require('../invite_users/invite_users_dialog_view');\n\n/**\n *  Organization users content, list, pagination,\n *  form footer,...\n *\n */\n\nmodule.exports = cdb.core.View.extend({\n\n  events: {\n    'click .js-addUserOptions': '_openAddUserDropdown',\n    'click .js-search-link': '_onSearchClick',\n    'click .js-clean-search': '_onCleanSearchClick',\n    'keydown .js-search-input': '_onKeyDown',\n    'submit .js-search-form': 'killEvent'\n  },\n\n  initialize: function () {\n    this.organization = this.options.organization;\n    this.organizationUsers = this.options.organizationUsers;\n    this.currentUser = this.options.currentUser;\n    this.pagedSearchModel = new PagedSearchModel({\n      per_page: 50,\n      order: 'username'\n    });\n    this.paginationModel = new PaginationModel({\n      current_page: this.pagedSearchModel.get('page'),\n      total_count: this.organizationUsers.totalCount(),\n      per_page: this.pagedSearchModel.get('per_page')\n    });\n    this.template = cdb.templates.getTemplate('organization/organization_users/organization_users');\n    this._initBinds();\n    this.pagedSearchModel.fetch(this.organizationUsers);\n  },\n\n  render: function () {\n    this.clearSubViews();\n    this.$el.html(\n      this.template({\n        seats: this.organization.get('seats'),\n        assigned_seats: this.organization.get('assigned_seats'),\n        viewer_seats: this.organization.get('viewer_seats'),\n        assigned_viewer_seats: this.organization.get('assigned_viewer_seats'),\n        newUserUrl: this.organization.viewUrl().create()\n      })\n    );\n    this._initViews();\n    return this;\n  },\n\n  _initBinds: function () {\n    this.organizationUsers.bind('fetching', function () {\n      this._panes && this._panes.active('loading');\n    }, this);\n\n    this.organizationUsers.bind('error', function (e) {\n      // Old requests can be stopped, so aborted requests are not\n      // considered as an error\n      if (!e || (e && e.statusText !== 'abort')) {\n        this._panes.active('error');\n      }\n    }, this);\n\n    this.organizationUsers.bind('reset', function (coll) {\n      var total = coll.totalCount();\n      this.paginationModel.set({\n        total_count: total,\n        current_page: this.pagedSearchModel.get('page')\n      });\n      this._panes && this._panes.active(total > 0 ? 'users' : 'no_results');\n    }, this);\n\n    this.organizationUsers.bind('reset error loading', function (coll) {\n      this[ this.pagedSearchModel.get('q') ? '_showCleanSearchButton' : '_hideCleanSearchButton' ]();\n    }, this);\n\n    this.paginationModel.bind('change:current_page', function (mdl) {\n      var newPage = mdl.get('current_page');\n      this.pagedSearchModel.set('page', newPage);\n      this.pagedSearchModel.fetch(this.organizationUsers);\n    }, this);\n\n    this.add_related_model(this.organizationUsers);\n    this.add_related_model(this.paginationModel);\n  },\n\n  _initViews: function () {\n    this._panes = new cdb.ui.common.TabPane({\n      el: this.$('.js-organizationUsersPanes')\n    });\n    this.addView(this._panes);\n\n    this._panes.addTab('users',\n      new OrganizationUsersListView({\n        organization: this.organization,\n        collection: this.organizationUsers,\n        paginationModel: this.paginationModel,\n        currentUser: this.currentUser\n      }).render()\n    );\n\n    this._panes.addTab('error',\n      ViewFactory.createByTemplate('common/templates/fail', {\n        msg: ''\n      }).render()\n    );\n\n    this._panes.addTab('no_results',\n      ViewFactory.createByTemplate('common/templates/no_results', {\n        icon: 'CDB-IconFont-defaultUser',\n        title: 'Oh! No results',\n        msg: 'Unfortunately we haven\\'t found any user with these parameters'\n      }).render()\n    );\n\n    this._panes.addTab('loading',\n      ViewFactory.createByTemplate('common/templates/loading', {\n        title: 'Getting users',\n        quote: randomQuote()\n      }).render()\n    );\n\n    // Form footer\n    var footer = new OrganizationUsersFooterView({\n      model: this.organization,\n      organizationUsers: this.organizationUsers\n    });\n    this.addView(footer);\n    this.$el.append(footer.render().el);\n\n    var activePane = 'loading';\n    if (this.organizationUsers.totalCount() === 0) {\n      activePane = 'no_results';\n    } else if (this.organizationUsers.totalCount() > 0) {\n      activePane = 'users';\n    }\n\n    this._panes.active(activePane);\n  },\n\n  _openAddUserDropdown: function (e) {\n    var self = this;\n    this.killEvent(e);\n\n    if (this.dropdown) {\n      this._closeDropdown();\n      return;\n    }\n\n    this.dropdown = new cdb.admin.DropdownMenu({\n      className: 'Dropdown border',\n      target: $(e.target),\n      width: 120,\n      template_base: 'organization/organization_users/add_users_template',\n      vertical_position: 'down',\n      horizontal_position: 'right',\n      horizontal_offset: 0,\n      vertical_offset: -10,\n      createUrl: this.organization.viewUrl().create(),\n      tick: 'right'\n    });\n\n    this.dropdown.bind('optionClicked', function (ev) {\n      var $target = $(ev.target);\n      if ($target.hasClass('js-inviteUser')) {\n        ev.preventDefault();\n        this._onInviteClick();\n      }\n    }, this);\n\n    $('body').append(this.dropdown.render().el);\n    cdb.god.bind('closeDialogs', function () {\n      self._closeDropdown();\n    }, this.dropdown);\n\n    this.dropdown.open(e);\n  },\n\n  _closeDropdown: function () {\n    if (this.dropdown) {\n      var self = this;\n      cdb.god.unbind(null, null, this.dropdown);\n      this.dropdown.hide(function () {\n        self.dropdown.clean();\n        delete self.dropdown;\n      });\n    }\n  },\n\n  _showCleanSearchButton: function () {\n    this.$('.js-clean-search').show();\n  },\n\n  _hideCleanSearchButton: function () {\n    this.$('.js-clean-search').hide();\n  },\n\n  _focusSearchInput: function () {\n    var $searchInput = this._$searchInput();\n    $searchInput.focus().val($searchInput.val());\n  },\n\n  _onSearchClick: function (e) {\n    if (e) this.killEvent(e);\n    this._$searchInput().focus();\n  },\n\n  _onCleanSearchClick: function (ev) {\n    this.killEvent(ev);\n    this._cleanSearch();\n  },\n\n  _onKeyDown: function (ev) {\n    var enterPressed = (ev.keyCode === $.ui.keyCode.ENTER);\n    var escapePressed = (ev.keyCode === $.ui.keyCode.ESCAPE);\n    if (enterPressed) {\n      this.killEvent(ev);\n      this._submitSearch();\n    } else if (escapePressed) {\n      this.killEvent(ev);\n      if (this.pagedSearchModel.get('q')) {\n        this._cleanSearch();\n      }\n    }\n  },\n\n  _submitSearch: function (e) {\n    var search = this._$searchInput().val().trim();\n    this.pagedSearchModel.set({\n      q: Utils.stripHTML(search),\n      page: 1\n    });\n\n    this.pagedSearchModel.fetch(this.organizationUsers);\n  },\n\n  _$searchInput: function () {\n    return this.$('.js-search-input');\n  },\n\n  _cleanSearch: function () {\n    this._$searchInput().val('');\n    this.pagedSearchModel.set({\n      q: '',\n      page: 1\n    });\n\n    this.pagedSearchModel.fetch(this.organizationUsers);\n  },\n\n  _onInviteClick: function () {\n    this.dialog = new InviteUsersDialogView({\n      clean_on_hide: true,\n      enter_to_confirm: false,\n      organization: this.organization,\n      organizationUsers: this.organizationUsers\n    }).appendToBody();\n  }\n\n});\n",
    "'use strict';\n\nmodule.exports = require('./src/js/main');\n",
    "'use strict';\n\nfunction oldAdd(element, className) {\n  var classes = element.className.split(' ');\n  if (classes.indexOf(className) < 0) {\n    classes.push(className);\n  }\n  element.className = classes.join(' ');\n}\n\nfunction oldRemove(element, className) {\n  var classes = element.className.split(' ');\n  var idx = classes.indexOf(className);\n  if (idx >= 0) {\n    classes.splice(idx, 1);\n  }\n  element.className = classes.join(' ');\n}\n\nexports.add = function (element, className) {\n  if (element.classList) {\n    element.classList.add(className);\n  } else {\n    oldAdd(element, className);\n  }\n};\n\nexports.remove = function (element, className) {\n  if (element.classList) {\n    element.classList.remove(className);\n  } else {\n    oldRemove(element, className);\n  }\n};\n\nexports.list = function (element) {\n  if (element.classList) {\n    return Array.prototype.slice.apply(element.classList);\n  } else {\n    return element.className.split(' ');\n  }\n};\n",
    "'use strict';\n\nvar DOM = {};\n\nDOM.e = function (tagName, className) {\n  var element = document.createElement(tagName);\n  element.className = className;\n  return element;\n};\n\nDOM.appendTo = function (child, parent) {\n  parent.appendChild(child);\n  return child;\n};\n\nfunction cssGet(element, styleName) {\n  return window.getComputedStyle(element)[styleName];\n}\n\nfunction cssSet(element, styleName, styleValue) {\n  if (typeof styleValue === 'number') {\n    styleValue = styleValue.toString() + 'px';\n  }\n  element.style[styleName] = styleValue;\n  return element;\n}\n\nfunction cssMultiSet(element, obj) {\n  for (var key in obj) {\n    var val = obj[key];\n    if (typeof val === 'number') {\n      val = val.toString() + 'px';\n    }\n    element.style[key] = val;\n  }\n  return element;\n}\n\nDOM.css = function (element, styleNameOrObject, styleValue) {\n  if (typeof styleNameOrObject === 'object') {\n    // multiple set with object\n    return cssMultiSet(element, styleNameOrObject);\n  } else {\n    if (typeof styleValue === 'undefined') {\n      return cssGet(element, styleNameOrObject);\n    } else {\n      return cssSet(element, styleNameOrObject, styleValue);\n    }\n  }\n};\n\nDOM.matches = function (element, query) {\n  if (typeof element.matches !== 'undefined') {\n    return element.matches(query);\n  } else {\n    if (typeof element.matchesSelector !== 'undefined') {\n      return element.matchesSelector(query);\n    } else if (typeof element.webkitMatchesSelector !== 'undefined') {\n      return element.webkitMatchesSelector(query);\n    } else if (typeof element.mozMatchesSelector !== 'undefined') {\n      return element.mozMatchesSelector(query);\n    } else if (typeof element.msMatchesSelector !== 'undefined') {\n      return element.msMatchesSelector(query);\n    }\n  }\n};\n\nDOM.remove = function (element) {\n  if (typeof element.remove !== 'undefined') {\n    element.remove();\n  } else {\n    if (element.parentNode) {\n      element.parentNode.removeChild(element);\n    }\n  }\n};\n\nDOM.queryChildren = function (element, selector) {\n  return Array.prototype.filter.call(element.childNodes, function (child) {\n    return DOM.matches(child, selector);\n  });\n};\n\nmodule.exports = DOM;\n",
    "'use strict';\n\nvar EventElement = function (element) {\n  this.element = element;\n  this.events = {};\n};\n\nEventElement.prototype.bind = function (eventName, handler) {\n  if (typeof this.events[eventName] === 'undefined') {\n    this.events[eventName] = [];\n  }\n  this.events[eventName].push(handler);\n  this.element.addEventListener(eventName, handler, false);\n};\n\nEventElement.prototype.unbind = function (eventName, handler) {\n  var isHandlerProvided = (typeof handler !== 'undefined');\n  this.events[eventName] = this.events[eventName].filter(function (hdlr) {\n    if (isHandlerProvided && hdlr !== handler) {\n      return true;\n    }\n    this.element.removeEventListener(eventName, hdlr, false);\n    return false;\n  }, this);\n};\n\nEventElement.prototype.unbindAll = function () {\n  for (var name in this.events) {\n    this.unbind(name);\n  }\n};\n\nvar EventManager = function () {\n  this.eventElements = [];\n};\n\nEventManager.prototype.eventElement = function (element) {\n  var ee = this.eventElements.filter(function (eventElement) {\n    return eventElement.element === element;\n  })[0];\n  if (typeof ee === 'undefined') {\n    ee = new EventElement(element);\n    this.eventElements.push(ee);\n  }\n  return ee;\n};\n\nEventManager.prototype.bind = function (element, eventName, handler) {\n  this.eventElement(element).bind(eventName, handler);\n};\n\nEventManager.prototype.unbind = function (element, eventName, handler) {\n  this.eventElement(element).unbind(eventName, handler);\n};\n\nEventManager.prototype.unbindAll = function () {\n  for (var i = 0; i < this.eventElements.length; i++) {\n    this.eventElements[i].unbindAll();\n  }\n};\n\nEventManager.prototype.once = function (element, eventName, handler) {\n  var ee = this.eventElement(element);\n  var onceHandler = function (e) {\n    ee.unbind(eventName, onceHandler);\n    handler(e);\n  };\n  ee.bind(eventName, onceHandler);\n};\n\nmodule.exports = EventManager;\n",
    "'use strict';\n\nmodule.exports = (function () {\n  function s4() {\n    return Math.floor((1 + Math.random()) * 0x10000)\n               .toString(16)\n               .substring(1);\n  }\n  return function () {\n    return s4() + s4() + '-' + s4() + '-' + s4() + '-' +\n           s4() + '-' + s4() + s4() + s4();\n  };\n})();\n",
    "'use strict';\n\nvar cls = require('./class');\nvar dom = require('./dom');\n\nvar toInt = exports.toInt = function (x) {\n  return parseInt(x, 10) || 0;\n};\n\nvar clone = exports.clone = function (obj) {\n  if (!obj) {\n    return null;\n  } else if (Array.isArray(obj)) {\n    return obj.map(clone);\n  } else if (typeof obj === 'object') {\n    var result = {};\n    for (var key in obj) {\n      result[key] = clone(obj[key]);\n    }\n    return result;\n  } else {\n    return obj;\n  }\n};\n\nexports.debounce = function (func, wait, immediate) {\n  var timeout;\n  return function () {\n    var context = this;\n    var args = arguments;\n    var later = function () {\n      timeout = null;\n      if (!immediate) {\n        func.apply(context, args);\n      }\n    };\n    var callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n    if (callNow) {\n      func.apply(context, args);\n    }\n  };\n};\n\nexports.extend = function (original, source) {\n  var result = clone(original);\n  for (var key in source) {\n    result[key] = clone(source[key]);\n  }\n  return result;\n};\n\nexports.isEditable = function (el) {\n  return dom.matches(el, \"input,[contenteditable]\") ||\n         dom.matches(el, \"select,[contenteditable]\") ||\n         dom.matches(el, \"textarea,[contenteditable]\") ||\n         dom.matches(el, \"button,[contenteditable]\");\n};\n\nexports.removePsClasses = function (element) {\n  var clsList = cls.list(element);\n  for (var i = 0; i < clsList.length; i++) {\n    var className = clsList[i];\n    if (className.indexOf('ps-') === 0) {\n      cls.remove(element, className);\n    }\n  }\n};\n\nexports.outerWidth = function (element) {\n  return toInt(dom.css(element, 'width')) +\n         toInt(dom.css(element, 'paddingLeft')) +\n         toInt(dom.css(element, 'paddingRight')) +\n         toInt(dom.css(element, 'borderLeftWidth')) +\n         toInt(dom.css(element, 'borderRightWidth'));\n};\n\nexports.startScrolling = function (element, axis) {\n  cls.add(element, 'ps-in-scrolling');\n  if (typeof axis !== 'undefined') {\n    cls.add(element, 'ps-' + axis);\n  } else {\n    cls.add(element, 'ps-x');\n    cls.add(element, 'ps-y');\n  }\n};\n\nexports.stopScrolling = function (element, axis) {\n  cls.remove(element, 'ps-in-scrolling');\n  if (typeof axis !== 'undefined') {\n    cls.remove(element, 'ps-' + axis);\n  } else {\n    cls.remove(element, 'ps-x');\n    cls.remove(element, 'ps-y');\n  }\n};\n\nexports.env = {\n  isWebKit: 'WebkitAppearance' in document.documentElement.style,\n  supportsTouch: (('ontouchstart' in window) || window.DocumentTouch && document instanceof window.DocumentTouch),\n  supportsIePointer: window.navigator.msMaxTouchPoints !== null\n};\n",
    "'use strict';\n\nvar destroy = require('./plugin/destroy');\nvar initialize = require('./plugin/initialize');\nvar update = require('./plugin/update');\n\nmodule.exports = {\n  initialize: initialize,\n  update: update,\n  destroy: destroy\n};\n",
    "'use strict';\n\nvar update = require('./update');\nvar MutationObserver = window.MutationObserver;\nvar instances = require('./instances');\n\nvar createDOMEvent = function (name) {\n  var event = document.createEvent('Event');\n  event.initEvent(name, true, true);\n  return event;\n};\n\nmodule.exports = function (element) {\n  if (MutationObserver === null || MutationObserver === undefined) {\n    // MutationObserver is not supported\n    return;\n  }\n\n  var i = instances.get(element);\n  var onMutationObserver = function () {\n    update(element);\n    element.dispatchEvent(createDOMEvent('ps-dom-change'));\n  };\n\n  i.observer = new MutationObserver(onMutationObserver);\n  onMutationObserver();\n\n  var config = { childList: true, subtree: true };\n  i.observer.observe(element, config);\n};\n",
    "'use strict';\n\nmodule.exports = {\n  handlers: ['click-rail', 'drag-scrollbar', 'keyboard', 'wheel', 'touch'],\n  maxScrollbarLength: null,\n  minScrollbarLength: null,\n  scrollXMarginOffset: 0,\n  scrollYMarginOffset: 0,\n  suppressScrollX: false,\n  suppressScrollY: false,\n  swipePropagation: true,\n  useBothWheelAxes: false,\n  wheelPropagation: false,\n  wheelSpeed: 1,\n  theme: 'default',\n  autoupdate: true\n};\n",
    "'use strict';\n\nvar _ = require('../lib/helper');\nvar dom = require('../lib/dom');\nvar instances = require('./instances');\n\nmodule.exports = function (element) {\n  var i = instances.get(element);\n\n  if (!i) {\n    return;\n  }\n\n  if (i.observer) {\n    i.observer.disconnect();\n  }\n\n  i.event.unbindAll();\n  dom.remove(i.scrollbarX);\n  dom.remove(i.scrollbarY);\n  dom.remove(i.scrollbarXRail);\n  dom.remove(i.scrollbarYRail);\n  _.removePsClasses(element);\n\n  instances.remove(element);\n};\n",
    "'use strict';\n\nvar instances = require('../instances');\nvar updateGeometry = require('../update-geometry');\nvar updateScroll = require('../update-scroll');\n\nfunction bindClickRailHandler(element, i) {\n  function pageOffset(el) {\n    return el.getBoundingClientRect();\n  }\n  var stopPropagation = function (e) { e.stopPropagation(); };\n\n  i.event.bind(i.scrollbarY, 'click', stopPropagation);\n  i.event.bind(i.scrollbarYRail, 'click', function (e) {\n    var positionTop = e.pageY - window.pageYOffset - pageOffset(i.scrollbarYRail).top;\n    var direction = positionTop > i.scrollbarYTop ? 1 : -1;\n\n    updateScroll(element, 'top', element.scrollTop + direction * i.containerHeight);\n    updateGeometry(element);\n\n    e.stopPropagation();\n  });\n\n  i.event.bind(i.scrollbarX, 'click', stopPropagation);\n  i.event.bind(i.scrollbarXRail, 'click', function (e) {\n    var positionLeft = e.pageX - window.pageXOffset - pageOffset(i.scrollbarXRail).left;\n    var direction = positionLeft > i.scrollbarXLeft ? 1 : -1;\n\n    updateScroll(element, 'left', element.scrollLeft + direction * i.containerWidth);\n    updateGeometry(element);\n\n    e.stopPropagation();\n  });\n}\n\nmodule.exports = function (element) {\n  var i = instances.get(element);\n  bindClickRailHandler(element, i);\n};\n",
    "'use strict';\n\nvar _ = require('../../lib/helper');\nvar dom = require('../../lib/dom');\nvar instances = require('../instances');\nvar updateGeometry = require('../update-geometry');\nvar updateScroll = require('../update-scroll');\n\nfunction bindMouseScrollXHandler(element, i) {\n  var currentLeft = null;\n  var currentPageX = null;\n\n  function updateScrollLeft(deltaX) {\n    var newLeft = currentLeft + (deltaX * i.railXRatio);\n    var maxLeft = Math.max(0, i.scrollbarXRail.getBoundingClientRect().left) + (i.railXRatio * (i.railXWidth - i.scrollbarXWidth));\n\n    if (newLeft < 0) {\n      i.scrollbarXLeft = 0;\n    } else if (newLeft > maxLeft) {\n      i.scrollbarXLeft = maxLeft;\n    } else {\n      i.scrollbarXLeft = newLeft;\n    }\n\n    var scrollLeft = _.toInt(i.scrollbarXLeft * (i.contentWidth - i.containerWidth) / (i.containerWidth - (i.railXRatio * i.scrollbarXWidth))) - i.negativeScrollAdjustment;\n    updateScroll(element, 'left', scrollLeft);\n  }\n\n  var mouseMoveHandler = function (e) {\n    updateScrollLeft(e.pageX - currentPageX);\n    updateGeometry(element);\n    e.stopPropagation();\n    e.preventDefault();\n  };\n\n  var mouseUpHandler = function () {\n    _.stopScrolling(element, 'x');\n    i.event.unbind(i.ownerDocument, 'mousemove', mouseMoveHandler);\n  };\n\n  i.event.bind(i.scrollbarX, 'mousedown', function (e) {\n    currentPageX = e.pageX;\n    currentLeft = _.toInt(dom.css(i.scrollbarX, 'left')) * i.railXRatio;\n    _.startScrolling(element, 'x');\n\n    i.event.bind(i.ownerDocument, 'mousemove', mouseMoveHandler);\n    i.event.once(i.ownerDocument, 'mouseup', mouseUpHandler);\n\n    e.stopPropagation();\n    e.preventDefault();\n  });\n}\n\nfunction bindMouseScrollYHandler(element, i) {\n  var currentTop = null;\n  var currentPageY = null;\n\n  function updateScrollTop(deltaY) {\n    var newTop = currentTop + (deltaY * i.railYRatio);\n    var maxTop = Math.max(0, i.scrollbarYRail.getBoundingClientRect().top) + (i.railYRatio * (i.railYHeight - i.scrollbarYHeight));\n\n    if (newTop < 0) {\n      i.scrollbarYTop = 0;\n    } else if (newTop > maxTop) {\n      i.scrollbarYTop = maxTop;\n    } else {\n      i.scrollbarYTop = newTop;\n    }\n\n    var scrollTop = _.toInt(i.scrollbarYTop * (i.contentHeight - i.containerHeight) / (i.containerHeight - (i.railYRatio * i.scrollbarYHeight)));\n    updateScroll(element, 'top', scrollTop);\n  }\n\n  var mouseMoveHandler = function (e) {\n    updateScrollTop(e.pageY - currentPageY);\n    updateGeometry(element);\n    e.stopPropagation();\n    e.preventDefault();\n  };\n\n  var mouseUpHandler = function () {\n    _.stopScrolling(element, 'y');\n    i.event.unbind(i.ownerDocument, 'mousemove', mouseMoveHandler);\n  };\n\n  i.event.bind(i.scrollbarY, 'mousedown', function (e) {\n    currentPageY = e.pageY;\n    currentTop = _.toInt(dom.css(i.scrollbarY, 'top')) * i.railYRatio;\n    _.startScrolling(element, 'y');\n\n    i.event.bind(i.ownerDocument, 'mousemove', mouseMoveHandler);\n    i.event.once(i.ownerDocument, 'mouseup', mouseUpHandler);\n\n    e.stopPropagation();\n    e.preventDefault();\n  });\n}\n\nmodule.exports = function (element) {\n  var i = instances.get(element);\n  bindMouseScrollXHandler(element, i);\n  bindMouseScrollYHandler(element, i);\n};\n",
    "'use strict';\n\nvar _ = require('../../lib/helper');\nvar dom = require('../../lib/dom');\nvar instances = require('../instances');\nvar updateGeometry = require('../update-geometry');\nvar updateScroll = require('../update-scroll');\n\nfunction bindKeyboardHandler(element, i) {\n  var hovered = false;\n  i.event.bind(element, 'mouseenter', function () {\n    hovered = true;\n  });\n  i.event.bind(element, 'mouseleave', function () {\n    hovered = false;\n  });\n\n  var shouldPrevent = false;\n  function shouldPreventDefault(deltaX, deltaY) {\n    var scrollTop = element.scrollTop;\n    if (deltaX === 0) {\n      if (!i.scrollbarYActive) {\n        return false;\n      }\n      if ((scrollTop === 0 && deltaY > 0) || (scrollTop >= i.contentHeight - i.containerHeight && deltaY < 0)) {\n        return !i.settings.wheelPropagation;\n      }\n    }\n\n    var scrollLeft = element.scrollLeft;\n    if (deltaY === 0) {\n      if (!i.scrollbarXActive) {\n        return false;\n      }\n      if ((scrollLeft === 0 && deltaX < 0) || (scrollLeft >= i.contentWidth - i.containerWidth && deltaX > 0)) {\n        return !i.settings.wheelPropagation;\n      }\n    }\n    return true;\n  }\n\n  i.event.bind(i.ownerDocument, 'keydown', function (e) {\n    if ((e.isDefaultPrevented && e.isDefaultPrevented()) || e.defaultPrevented) {\n      return;\n    }\n\n    var focused = dom.matches(i.scrollbarX, ':focus') ||\n                  dom.matches(i.scrollbarY, ':focus');\n\n    if (!hovered && !focused) {\n      return;\n    }\n\n    var activeElement = document.activeElement ? document.activeElement : i.ownerDocument.activeElement;\n    if (activeElement) {\n      if (activeElement.tagName === 'IFRAME') {\n        activeElement = activeElement.contentDocument.activeElement;\n      } else {\n        // go deeper if element is a webcomponent\n        while (activeElement.shadowRoot) {\n          activeElement = activeElement.shadowRoot.activeElement;\n        }\n      }\n      if (_.isEditable(activeElement)) {\n        return;\n      }\n    }\n\n    var deltaX = 0;\n    var deltaY = 0;\n\n    switch (e.which) {\n    case 37: // left\n      if (e.metaKey) {\n        deltaX = -i.contentWidth;\n      } else if (e.altKey) {\n        deltaX = -i.containerWidth;\n      } else {\n        deltaX = -30;\n      }\n      break;\n    case 38: // up\n      if (e.metaKey) {\n        deltaY = i.contentHeight;\n      } else if (e.altKey) {\n        deltaY = i.containerHeight;\n      } else {\n        deltaY = 30;\n      }\n      break;\n    case 39: // right\n      if (e.metaKey) {\n        deltaX = i.contentWidth;\n      } else if (e.altKey) {\n        deltaX = i.containerWidth;\n      } else {\n        deltaX = 30;\n      }\n      break;\n    case 40: // down\n      if (e.metaKey) {\n        deltaY = -i.contentHeight;\n      } else if (e.altKey) {\n        deltaY = -i.containerHeight;\n      } else {\n        deltaY = -30;\n      }\n      break;\n    case 33: // page up\n      deltaY = 90;\n      break;\n    case 32: // space bar\n      if (e.shiftKey) {\n        deltaY = 90;\n      } else {\n        deltaY = -90;\n      }\n      break;\n    case 34: // page down\n      deltaY = -90;\n      break;\n    case 35: // end\n      if (e.ctrlKey) {\n        deltaY = -i.contentHeight;\n      } else {\n        deltaY = -i.containerHeight;\n      }\n      break;\n    case 36: // home\n      if (e.ctrlKey) {\n        deltaY = element.scrollTop;\n      } else {\n        deltaY = i.containerHeight;\n      }\n      break;\n    default:\n      return;\n    }\n\n    updateScroll(element, 'top', element.scrollTop - deltaY);\n    updateScroll(element, 'left', element.scrollLeft + deltaX);\n    updateGeometry(element);\n\n    shouldPrevent = shouldPreventDefault(deltaX, deltaY);\n    if (shouldPrevent) {\n      e.preventDefault();\n    }\n  });\n}\n\nmodule.exports = function (element) {\n  var i = instances.get(element);\n  bindKeyboardHandler(element, i);\n};\n",
    "'use strict';\n\nvar instances = require('../instances');\nvar updateGeometry = require('../update-geometry');\nvar updateScroll = require('../update-scroll');\n\nfunction bindMouseWheelHandler(element, i) {\n  var shouldPrevent = false;\n\n  function shouldPreventDefault(deltaX, deltaY) {\n    var scrollTop = element.scrollTop;\n    if (deltaX === 0) {\n      if (!i.scrollbarYActive) {\n        return false;\n      }\n      if ((scrollTop === 0 && deltaY > 0) || (scrollTop >= i.contentHeight - i.containerHeight && deltaY < 0)) {\n        return !i.settings.wheelPropagation;\n      }\n    }\n\n    var scrollLeft = element.scrollLeft;\n    if (deltaY === 0) {\n      if (!i.scrollbarXActive) {\n        return false;\n      }\n      if ((scrollLeft === 0 && deltaX < 0) || (scrollLeft >= i.contentWidth - i.containerWidth && deltaX > 0)) {\n        return !i.settings.wheelPropagation;\n      }\n    }\n    return true;\n  }\n\n  function getDeltaFromEvent(e) {\n    var deltaX = e.deltaX;\n    var deltaY = -1 * e.deltaY;\n\n    if (typeof deltaX === \"undefined\" || typeof deltaY === \"undefined\") {\n      // OS X Safari\n      deltaX = -1 * e.wheelDeltaX / 6;\n      deltaY = e.wheelDeltaY / 6;\n    }\n\n    if (e.deltaMode && e.deltaMode === 1) {\n      // Firefox in deltaMode 1: Line scrolling\n      deltaX *= 10;\n      deltaY *= 10;\n    }\n\n    if (deltaX !== deltaX && deltaY !== deltaY/* NaN checks */) {\n      // IE in some mouse drivers\n      deltaX = 0;\n      deltaY = e.wheelDelta;\n    }\n\n    if (e.shiftKey) {\n      // reverse axis with shift key\n      return [-deltaY, -deltaX];\n    }\n    return [deltaX, deltaY];\n  }\n\n  function shouldBeConsumedByChild(deltaX, deltaY) {\n    var child = element.querySelector('textarea:hover, select[multiple]:hover, .ps-child:hover');\n    if (child) {\n      if (!window.getComputedStyle(child).overflow.match(/(scroll|auto)/)) {\n        // if not scrollable\n        return false;\n      }\n\n      var maxScrollTop = child.scrollHeight - child.clientHeight;\n      if (maxScrollTop > 0) {\n        if (!(child.scrollTop === 0 && deltaY > 0) && !(child.scrollTop === maxScrollTop && deltaY < 0)) {\n          return true;\n        }\n      }\n      var maxScrollLeft = child.scrollLeft - child.clientWidth;\n      if (maxScrollLeft > 0) {\n        if (!(child.scrollLeft === 0 && deltaX < 0) && !(child.scrollLeft === maxScrollLeft && deltaX > 0)) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  function mousewheelHandler(e) {\n    var delta = getDeltaFromEvent(e);\n\n    var deltaX = delta[0];\n    var deltaY = delta[1];\n\n    if (shouldBeConsumedByChild(deltaX, deltaY)) {\n      return;\n    }\n\n    shouldPrevent = false;\n    if (!i.settings.useBothWheelAxes) {\n      // deltaX will only be used for horizontal scrolling and deltaY will\n      // only be used for vertical scrolling - this is the default\n      updateScroll(element, 'top', element.scrollTop - (deltaY * i.settings.wheelSpeed));\n      updateScroll(element, 'left', element.scrollLeft + (deltaX * i.settings.wheelSpeed));\n    } else if (i.scrollbarYActive && !i.scrollbarXActive) {\n      // only vertical scrollbar is active and useBothWheelAxes option is\n      // active, so let's scroll vertical bar using both mouse wheel axes\n      if (deltaY) {\n        updateScroll(element, 'top', element.scrollTop - (deltaY * i.settings.wheelSpeed));\n      } else {\n        updateScroll(element, 'top', element.scrollTop + (deltaX * i.settings.wheelSpeed));\n      }\n      shouldPrevent = true;\n    } else if (i.scrollbarXActive && !i.scrollbarYActive) {\n      // useBothWheelAxes and only horizontal bar is active, so use both\n      // wheel axes for horizontal bar\n      if (deltaX) {\n        updateScroll(element, 'left', element.scrollLeft + (deltaX * i.settings.wheelSpeed));\n      } else {\n        updateScroll(element, 'left', element.scrollLeft - (deltaY * i.settings.wheelSpeed));\n      }\n      shouldPrevent = true;\n    }\n\n    updateGeometry(element);\n\n    shouldPrevent = (shouldPrevent || shouldPreventDefault(deltaX, deltaY));\n    if (shouldPrevent) {\n      e.stopPropagation();\n      e.preventDefault();\n    }\n  }\n\n  if (typeof window.onwheel !== \"undefined\") {\n    i.event.bind(element, 'wheel', mousewheelHandler);\n  } else if (typeof window.onmousewheel !== \"undefined\") {\n    i.event.bind(element, 'mousewheel', mousewheelHandler);\n  }\n}\n\nmodule.exports = function (element) {\n  var i = instances.get(element);\n  bindMouseWheelHandler(element, i);\n};\n",
    "'use strict';\n\nvar instances = require('../instances');\nvar updateGeometry = require('../update-geometry');\n\nfunction bindNativeScrollHandler(element, i) {\n  i.event.bind(element, 'scroll', function () {\n    updateGeometry(element);\n  });\n}\n\nmodule.exports = function (element) {\n  var i = instances.get(element);\n  bindNativeScrollHandler(element, i);\n};\n",
    "'use strict';\n\nvar _ = require('../../lib/helper');\nvar instances = require('../instances');\nvar updateGeometry = require('../update-geometry');\nvar updateScroll = require('../update-scroll');\n\nfunction bindSelectionHandler(element, i) {\n  function getRangeNode() {\n    var selection = window.getSelection ? window.getSelection() :\n                    document.getSelection ? document.getSelection() : '';\n    if (selection.toString().length === 0) {\n      return null;\n    } else {\n      return selection.getRangeAt(0).commonAncestorContainer;\n    }\n  }\n\n  var scrollingLoop = null;\n  var scrollDiff = {top: 0, left: 0};\n  function startScrolling() {\n    if (!scrollingLoop) {\n      scrollingLoop = setInterval(function () {\n        if (!instances.get(element)) {\n          clearInterval(scrollingLoop);\n          return;\n        }\n\n        updateScroll(element, 'top', element.scrollTop + scrollDiff.top);\n        updateScroll(element, 'left', element.scrollLeft + scrollDiff.left);\n        updateGeometry(element);\n      }, 50); // every .1 sec\n    }\n  }\n  function stopScrolling() {\n    if (scrollingLoop) {\n      clearInterval(scrollingLoop);\n      scrollingLoop = null;\n    }\n    _.stopScrolling(element);\n  }\n\n  var isSelected = false;\n  i.event.bind(i.ownerDocument, 'selectionchange', function () {\n    if (element.contains(getRangeNode())) {\n      isSelected = true;\n    } else {\n      isSelected = false;\n      stopScrolling();\n    }\n  });\n  i.event.bind(window, 'mouseup', function () {\n    if (isSelected) {\n      isSelected = false;\n      stopScrolling();\n    }\n  });\n  i.event.bind(window, 'keyup', function () {\n    if (isSelected) {\n      isSelected = false;\n      stopScrolling();\n    }\n  });\n\n  i.event.bind(window, 'mousemove', function (e) {\n    if (isSelected) {\n      var mousePosition = {x: e.pageX, y: e.pageY};\n      var containerGeometry = {\n        left: element.offsetLeft,\n        right: element.offsetLeft + element.offsetWidth,\n        top: element.offsetTop,\n        bottom: element.offsetTop + element.offsetHeight\n      };\n\n      if (mousePosition.x < containerGeometry.left + 3) {\n        scrollDiff.left = -5;\n        _.startScrolling(element, 'x');\n      } else if (mousePosition.x > containerGeometry.right - 3) {\n        scrollDiff.left = 5;\n        _.startScrolling(element, 'x');\n      } else {\n        scrollDiff.left = 0;\n      }\n\n      if (mousePosition.y < containerGeometry.top + 3) {\n        if (containerGeometry.top + 3 - mousePosition.y < 5) {\n          scrollDiff.top = -5;\n        } else {\n          scrollDiff.top = -20;\n        }\n        _.startScrolling(element, 'y');\n      } else if (mousePosition.y > containerGeometry.bottom - 3) {\n        if (mousePosition.y - containerGeometry.bottom + 3 < 5) {\n          scrollDiff.top = 5;\n        } else {\n          scrollDiff.top = 20;\n        }\n        _.startScrolling(element, 'y');\n      } else {\n        scrollDiff.top = 0;\n      }\n\n      if (scrollDiff.top === 0 && scrollDiff.left === 0) {\n        stopScrolling();\n      } else {\n        startScrolling();\n      }\n    }\n  });\n}\n\nmodule.exports = function (element) {\n  var i = instances.get(element);\n  bindSelectionHandler(element, i);\n};\n",
    "'use strict';\n\nvar _ = require('../../lib/helper');\nvar instances = require('../instances');\nvar updateGeometry = require('../update-geometry');\nvar updateScroll = require('../update-scroll');\n\nfunction bindTouchHandler(element, i, supportsTouch, supportsIePointer) {\n  function shouldPreventDefault(deltaX, deltaY) {\n    var scrollTop = element.scrollTop;\n    var scrollLeft = element.scrollLeft;\n    var magnitudeX = Math.abs(deltaX);\n    var magnitudeY = Math.abs(deltaY);\n\n    if (magnitudeY > magnitudeX) {\n      // user is perhaps trying to swipe up/down the page\n\n      if (((deltaY < 0) && (scrollTop === i.contentHeight - i.containerHeight)) ||\n          ((deltaY > 0) && (scrollTop === 0))) {\n        return !i.settings.swipePropagation;\n      }\n    } else if (magnitudeX > magnitudeY) {\n      // user is perhaps trying to swipe left/right across the page\n\n      if (((deltaX < 0) && (scrollLeft === i.contentWidth - i.containerWidth)) ||\n          ((deltaX > 0) && (scrollLeft === 0))) {\n        return !i.settings.swipePropagation;\n      }\n    }\n\n    return true;\n  }\n\n  function applyTouchMove(differenceX, differenceY) {\n    updateScroll(element, 'top', element.scrollTop - differenceY);\n    updateScroll(element, 'left', element.scrollLeft - differenceX);\n\n    updateGeometry(element);\n  }\n\n  var startOffset = {};\n  var startTime = 0;\n  var speed = {};\n  var easingLoop = null;\n  var inGlobalTouch = false;\n  var inLocalTouch = false;\n\n  function globalTouchStart() {\n    inGlobalTouch = true;\n  }\n  function globalTouchEnd() {\n    inGlobalTouch = false;\n  }\n\n  function getTouch(e) {\n    if (e.targetTouches) {\n      return e.targetTouches[0];\n    } else {\n      // Maybe IE pointer\n      return e;\n    }\n  }\n  function shouldHandle(e) {\n    if (e.targetTouches && e.targetTouches.length === 1) {\n      return true;\n    }\n    if (e.pointerType && e.pointerType !== 'mouse' && e.pointerType !== e.MSPOINTER_TYPE_MOUSE) {\n      return true;\n    }\n    return false;\n  }\n  function touchStart(e) {\n    if (shouldHandle(e)) {\n      inLocalTouch = true;\n\n      var touch = getTouch(e);\n\n      startOffset.pageX = touch.pageX;\n      startOffset.pageY = touch.pageY;\n\n      startTime = (new Date()).getTime();\n\n      if (easingLoop !== null) {\n        clearInterval(easingLoop);\n      }\n\n      e.stopPropagation();\n    }\n  }\n  function touchMove(e) {\n    var target = e.target;\n    var className = target && target.getAttribute && target.getAttribute('class') || '';\n\n    if (!className.match(/ps-prevent-touchmove/)) {\n      if (!inLocalTouch && i.settings.swipePropagation) {\n        touchStart(e);\n      }\n      if (!inGlobalTouch && inLocalTouch && shouldHandle(e)) {\n        var touch = getTouch(e);\n\n        var currentOffset = {pageX: touch.pageX, pageY: touch.pageY};\n\n        var differenceX = currentOffset.pageX - startOffset.pageX;\n        var differenceY = currentOffset.pageY - startOffset.pageY;\n\n        applyTouchMove(differenceX, differenceY);\n        startOffset = currentOffset;\n\n        var currentTime = (new Date()).getTime();\n\n        var timeGap = currentTime - startTime;\n        if (timeGap > 0) {\n          speed.x = differenceX / timeGap;\n          speed.y = differenceY / timeGap;\n          startTime = currentTime;\n        }\n\n        if (shouldPreventDefault(differenceX, differenceY)) {\n          e.stopPropagation();\n          e.preventDefault();\n        }\n      }\n    }\n  }\n  function touchEnd() {\n    if (!inGlobalTouch && inLocalTouch) {\n      inLocalTouch = false;\n\n      clearInterval(easingLoop);\n      easingLoop = setInterval(function () {\n        if (!instances.get(element)) {\n          clearInterval(easingLoop);\n          return;\n        }\n\n        if (!speed.x && !speed.y) {\n          clearInterval(easingLoop);\n          return;\n        }\n\n        if (Math.abs(speed.x) < 0.01 && Math.abs(speed.y) < 0.01) {\n          clearInterval(easingLoop);\n          return;\n        }\n\n        applyTouchMove(speed.x * 30, speed.y * 30);\n\n        speed.x *= 0.8;\n        speed.y *= 0.8;\n      }, 10);\n    }\n  }\n\n  if (supportsTouch) {\n    i.event.bind(window, 'touchstart', globalTouchStart);\n    i.event.bind(window, 'touchend', globalTouchEnd);\n    i.event.bind(element, 'touchstart', touchStart);\n    i.event.bind(element, 'touchmove', touchMove);\n    i.event.bind(element, 'touchend', touchEnd);\n  } else if (supportsIePointer) {\n    if (window.PointerEvent) {\n      i.event.bind(window, 'pointerdown', globalTouchStart);\n      i.event.bind(window, 'pointerup', globalTouchEnd);\n      i.event.bind(element, 'pointerdown', touchStart);\n      i.event.bind(element, 'pointermove', touchMove);\n      i.event.bind(element, 'pointerup', touchEnd);\n    } else if (window.MSPointerEvent) {\n      i.event.bind(window, 'MSPointerDown', globalTouchStart);\n      i.event.bind(window, 'MSPointerUp', globalTouchEnd);\n      i.event.bind(element, 'MSPointerDown', touchStart);\n      i.event.bind(element, 'MSPointerMove', touchMove);\n      i.event.bind(element, 'MSPointerUp', touchEnd);\n    }\n  }\n}\n\nmodule.exports = function (element) {\n  if (!_.env.supportsTouch && !_.env.supportsIePointer) {\n    return;\n  }\n\n  var i = instances.get(element);\n  bindTouchHandler(element, i, _.env.supportsTouch, _.env.supportsIePointer);\n};\n",
    "'use strict';\n\nvar _ = require('../lib/helper');\nvar cls = require('../lib/class');\nvar instances = require('./instances');\nvar updateGeometry = require('./update-geometry');\nvar autoupdate = require('./autoupdate');\nvar resizer = require('./resizer');\n\n// Handlers\nvar handlers = {\n  'click-rail': require('./handler/click-rail'),\n  'drag-scrollbar': require('./handler/drag-scrollbar'),\n  'keyboard': require('./handler/keyboard'),\n  'wheel': require('./handler/mouse-wheel'),\n  'touch': require('./handler/touch'),\n  'selection': require('./handler/selection')\n};\nvar nativeScrollHandler = require('./handler/native-scroll');\n\nmodule.exports = function (element, userSettings) {\n  userSettings = typeof userSettings === 'object' ? userSettings : {};\n\n  cls.add(element, 'ps-container');\n\n  // Create a plugin instance.\n  var i = instances.add(element);\n\n  i.settings = _.extend(i.settings, userSettings);\n  cls.add(element, 'ps-theme-' + i.settings.theme);\n\n  i.settings.handlers.forEach(function (handlerName) {\n    handlers[handlerName](element);\n  });\n\n  nativeScrollHandler(element);\n\n  updateGeometry(element);\n\n  if (i.settings.autoupdate) {\n    autoupdate(element);\n    resizer(element);\n  }\n};\n",
    "'use strict';\n\nvar _ = require('../lib/helper');\nvar cls = require('../lib/class');\nvar defaultSettings = require('./default-setting');\nvar dom = require('../lib/dom');\nvar EventManager = require('../lib/event-manager');\nvar guid = require('../lib/guid');\n\nvar instances = {};\n\nfunction Instance(element) {\n  var i = this;\n\n  i.settings = _.clone(defaultSettings);\n  i.containerWidth = null;\n  i.containerHeight = null;\n  i.contentWidth = null;\n  i.contentHeight = null;\n\n  i.isRtl = dom.css(element, 'direction') === \"rtl\";\n  i.isNegativeScroll = (function () {\n    var originalScrollLeft = element.scrollLeft;\n    var result = null;\n    element.scrollLeft = -1;\n    result = element.scrollLeft < 0;\n    element.scrollLeft = originalScrollLeft;\n    return result;\n  })();\n  i.negativeScrollAdjustment = i.isNegativeScroll ? element.scrollWidth - element.clientWidth : 0;\n  i.event = new EventManager();\n  i.ownerDocument = element.ownerDocument || document;\n\n  function focus() {\n    cls.add(element, 'ps-focus');\n  }\n\n  function blur() {\n    cls.remove(element, 'ps-focus');\n  }\n\n  i.scrollbarXRail = dom.appendTo(dom.e('div', 'ps-scrollbar-x-rail'), element);\n  i.scrollbarX = dom.appendTo(dom.e('div', 'ps-scrollbar-x'), i.scrollbarXRail);\n  i.scrollbarX.setAttribute('tabindex', 0);\n  i.event.bind(i.scrollbarX, 'focus', focus);\n  i.event.bind(i.scrollbarX, 'blur', blur);\n  i.scrollbarXActive = null;\n  i.scrollbarXWidth = null;\n  i.scrollbarXLeft = null;\n  i.scrollbarXBottom = _.toInt(dom.css(i.scrollbarXRail, 'bottom'));\n  i.isScrollbarXUsingBottom = i.scrollbarXBottom === i.scrollbarXBottom; // !isNaN\n  i.scrollbarXTop = i.isScrollbarXUsingBottom ? null : _.toInt(dom.css(i.scrollbarXRail, 'top'));\n  i.railBorderXWidth = _.toInt(dom.css(i.scrollbarXRail, 'borderLeftWidth')) + _.toInt(dom.css(i.scrollbarXRail, 'borderRightWidth'));\n  // Set rail to display:block to calculate margins\n  dom.css(i.scrollbarXRail, 'display', 'block');\n  i.railXMarginWidth = _.toInt(dom.css(i.scrollbarXRail, 'marginLeft')) + _.toInt(dom.css(i.scrollbarXRail, 'marginRight'));\n  dom.css(i.scrollbarXRail, 'display', '');\n  i.railXWidth = null;\n  i.railXRatio = null;\n\n  i.scrollbarYRail = dom.appendTo(dom.e('div', 'ps-scrollbar-y-rail'), element);\n  i.scrollbarY = dom.appendTo(dom.e('div', 'ps-scrollbar-y'), i.scrollbarYRail);\n  i.scrollbarY.setAttribute('tabindex', 0);\n  i.event.bind(i.scrollbarY, 'focus', focus);\n  i.event.bind(i.scrollbarY, 'blur', blur);\n  i.scrollbarYActive = null;\n  i.scrollbarYHeight = null;\n  i.scrollbarYTop = null;\n  i.scrollbarYRight = _.toInt(dom.css(i.scrollbarYRail, 'right'));\n  i.isScrollbarYUsingRight = i.scrollbarYRight === i.scrollbarYRight; // !isNaN\n  i.scrollbarYLeft = i.isScrollbarYUsingRight ? null : _.toInt(dom.css(i.scrollbarYRail, 'left'));\n  i.scrollbarYOuterWidth = i.isRtl ? _.outerWidth(i.scrollbarY) : null;\n  i.railBorderYWidth = _.toInt(dom.css(i.scrollbarYRail, 'borderTopWidth')) + _.toInt(dom.css(i.scrollbarYRail, 'borderBottomWidth'));\n  dom.css(i.scrollbarYRail, 'display', 'block');\n  i.railYMarginHeight = _.toInt(dom.css(i.scrollbarYRail, 'marginTop')) + _.toInt(dom.css(i.scrollbarYRail, 'marginBottom'));\n  dom.css(i.scrollbarYRail, 'display', '');\n  i.railYHeight = null;\n  i.railYRatio = null;\n}\n\nfunction getId(element) {\n  return element.getAttribute('data-ps-id');\n}\n\nfunction setId(element, id) {\n  element.setAttribute('data-ps-id', id);\n}\n\nfunction removeId(element) {\n  element.removeAttribute('data-ps-id');\n}\n\nexports.add = function (element) {\n  var newId = guid();\n  setId(element, newId);\n  instances[newId] = new Instance(element);\n  return instances[newId];\n};\n\nexports.remove = function (element) {\n  delete instances[getId(element)];\n  removeId(element);\n};\n\nexports.get = function (element) {\n  return instances[getId(element)];\n};\n",
    "'use strict';\n\nvar update = require('./update');\nvar instances = require('./instances');\nvar _ = require('../lib/helper');\n\nmodule.exports = function (element) {\n  var i = instances.get(element);\n\n  var onResize = function () {\n    update(element);\n  };\n\n  i.event.bind(window, 'resize', _.debounce(onResize, 60));\n};\n",
    "'use strict';\n\nvar _ = require('../lib/helper');\nvar cls = require('../lib/class');\nvar dom = require('../lib/dom');\nvar instances = require('./instances');\nvar updateScroll = require('./update-scroll');\n\nfunction getThumbSize(i, thumbSize) {\n  if (i.settings.minScrollbarLength) {\n    thumbSize = Math.max(thumbSize, i.settings.minScrollbarLength);\n  }\n  if (i.settings.maxScrollbarLength) {\n    thumbSize = Math.min(thumbSize, i.settings.maxScrollbarLength);\n  }\n  return thumbSize;\n}\n\nfunction updateCss(element, i) {\n  var xRailOffset = {width: i.railXWidth};\n  if (i.isRtl) {\n    xRailOffset.left = i.negativeScrollAdjustment + element.scrollLeft + i.containerWidth - i.contentWidth;\n  } else {\n    xRailOffset.left = element.scrollLeft;\n  }\n  if (i.isScrollbarXUsingBottom) {\n    xRailOffset.bottom = i.scrollbarXBottom - element.scrollTop;\n  } else {\n    xRailOffset.top = i.scrollbarXTop + element.scrollTop;\n  }\n  dom.css(i.scrollbarXRail, xRailOffset);\n\n  var yRailOffset = {top: element.scrollTop, height: i.railYHeight};\n  if (i.isScrollbarYUsingRight) {\n    if (i.isRtl) {\n      yRailOffset.right = i.contentWidth - (i.negativeScrollAdjustment + element.scrollLeft) - i.scrollbarYRight - i.scrollbarYOuterWidth;\n    } else {\n      yRailOffset.right = i.scrollbarYRight - element.scrollLeft;\n    }\n  } else {\n    if (i.isRtl) {\n      yRailOffset.left = i.negativeScrollAdjustment + element.scrollLeft + i.containerWidth * 2 - i.contentWidth - i.scrollbarYLeft - i.scrollbarYOuterWidth;\n    } else {\n      yRailOffset.left = i.scrollbarYLeft + element.scrollLeft;\n    }\n  }\n  dom.css(i.scrollbarYRail, yRailOffset);\n\n  dom.css(i.scrollbarX, {left: i.scrollbarXLeft, width: i.scrollbarXWidth - i.railBorderXWidth});\n  dom.css(i.scrollbarY, {top: i.scrollbarYTop, height: i.scrollbarYHeight - i.railBorderYWidth});\n}\n\nmodule.exports = function (element) {\n  var i = instances.get(element);\n\n  i.containerWidth = element.clientWidth;\n  i.containerHeight = element.clientHeight;\n  i.contentWidth = element.scrollWidth;\n  i.contentHeight = element.scrollHeight;\n\n  var existingRails;\n  if (!element.contains(i.scrollbarXRail)) {\n    existingRails = dom.queryChildren(element, '.ps-scrollbar-x-rail');\n    if (existingRails.length > 0) {\n      existingRails.forEach(function (rail) {\n        dom.remove(rail);\n      });\n    }\n    dom.appendTo(i.scrollbarXRail, element);\n  }\n  if (!element.contains(i.scrollbarYRail)) {\n    existingRails = dom.queryChildren(element, '.ps-scrollbar-y-rail');\n    if (existingRails.length > 0) {\n      existingRails.forEach(function (rail) {\n        dom.remove(rail);\n      });\n    }\n    dom.appendTo(i.scrollbarYRail, element);\n  }\n\n  if (!i.settings.suppressScrollX && i.containerWidth + i.settings.scrollXMarginOffset < i.contentWidth) {\n    i.scrollbarXActive = true;\n    i.railXWidth = i.containerWidth - i.railXMarginWidth;\n    i.railXRatio = i.containerWidth / i.railXWidth;\n    i.scrollbarXWidth = getThumbSize(i, _.toInt(i.railXWidth * i.containerWidth / i.contentWidth));\n    i.scrollbarXLeft = _.toInt((i.negativeScrollAdjustment + element.scrollLeft) * (i.railXWidth - i.scrollbarXWidth) / (i.contentWidth - i.containerWidth));\n  } else {\n    i.scrollbarXActive = false;\n  }\n\n  if (!i.settings.suppressScrollY && i.containerHeight + i.settings.scrollYMarginOffset < i.contentHeight) {\n    i.scrollbarYActive = true;\n    i.railYHeight = i.containerHeight - i.railYMarginHeight;\n    i.railYRatio = i.containerHeight / i.railYHeight;\n    i.scrollbarYHeight = getThumbSize(i, _.toInt(i.railYHeight * i.containerHeight / i.contentHeight));\n    i.scrollbarYTop = _.toInt(element.scrollTop * (i.railYHeight - i.scrollbarYHeight) / (i.contentHeight - i.containerHeight));\n  } else {\n    i.scrollbarYActive = false;\n  }\n\n  if (i.scrollbarXLeft >= i.railXWidth - i.scrollbarXWidth) {\n    i.scrollbarXLeft = i.railXWidth - i.scrollbarXWidth;\n  }\n  if (i.scrollbarYTop >= i.railYHeight - i.scrollbarYHeight) {\n    i.scrollbarYTop = i.railYHeight - i.scrollbarYHeight;\n  }\n\n  updateCss(element, i);\n\n  if (i.scrollbarXActive) {\n    cls.add(element, 'ps-active-x');\n  } else {\n    cls.remove(element, 'ps-active-x');\n    i.scrollbarXWidth = 0;\n    i.scrollbarXLeft = 0;\n    updateScroll(element, 'left', 0);\n  }\n  if (i.scrollbarYActive) {\n    cls.add(element, 'ps-active-y');\n  } else {\n    cls.remove(element, 'ps-active-y');\n    i.scrollbarYHeight = 0;\n    i.scrollbarYTop = 0;\n    updateScroll(element, 'top', 0);\n  }\n};\n",
    "'use strict';\n\nvar instances = require('./instances');\n\nvar lastTop;\nvar lastLeft;\n\nvar createDOMEvent = function (name) {\n  var event = document.createEvent(\"Event\");\n  event.initEvent(name, true, true);\n  return event;\n};\n\nmodule.exports = function (element, axis, value) {\n  if (typeof element === 'undefined') {\n    throw 'You must provide an element to the update-scroll function';\n  }\n\n  if (typeof axis === 'undefined') {\n    throw 'You must provide an axis to the update-scroll function';\n  }\n\n  if (typeof value === 'undefined') {\n    throw 'You must provide a value to the update-scroll function';\n  }\n\n  if (axis === 'top' && value <= 0) {\n    element.scrollTop = value = 0; // don't allow negative scroll\n    element.dispatchEvent(createDOMEvent('ps-y-reach-start'));\n  }\n\n  if (axis === 'left' && value <= 0) {\n    element.scrollLeft = value = 0; // don't allow negative scroll\n    element.dispatchEvent(createDOMEvent('ps-x-reach-start'));\n  }\n\n  var i = instances.get(element);\n\n  if (axis === 'top' && value >= i.contentHeight - i.containerHeight) {\n    // don't allow scroll past container\n    value = i.contentHeight - i.containerHeight;\n    if (value - element.scrollTop <= 1) {\n      // mitigates rounding errors on non-subpixel scroll values\n      value = element.scrollTop;\n    } else {\n      element.scrollTop = value;\n    }\n    element.dispatchEvent(createDOMEvent('ps-y-reach-end'));\n  }\n\n  if (axis === 'left' && value >= i.contentWidth - i.containerWidth) {\n    // don't allow scroll past container\n    value = i.contentWidth - i.containerWidth;\n    if (value - element.scrollLeft <= 1) {\n      // mitigates rounding errors on non-subpixel scroll values\n      value = element.scrollLeft;\n    } else {\n      element.scrollLeft = value;\n    }\n    element.dispatchEvent(createDOMEvent('ps-x-reach-end'));\n  }\n\n  if (!lastTop) {\n    lastTop = element.scrollTop;\n  }\n\n  if (!lastLeft) {\n    lastLeft = element.scrollLeft;\n  }\n\n  if (axis === 'top' && value < lastTop) {\n    element.dispatchEvent(createDOMEvent('ps-scroll-up'));\n  }\n\n  if (axis === 'top' && value > lastTop) {\n    element.dispatchEvent(createDOMEvent('ps-scroll-down'));\n  }\n\n  if (axis === 'left' && value < lastLeft) {\n    element.dispatchEvent(createDOMEvent('ps-scroll-left'));\n  }\n\n  if (axis === 'left' && value > lastLeft) {\n    element.dispatchEvent(createDOMEvent('ps-scroll-right'));\n  }\n\n  if (axis === 'top') {\n    element.scrollTop = lastTop = value;\n    element.dispatchEvent(createDOMEvent('ps-scroll-y'));\n  }\n\n  if (axis === 'left') {\n    element.scrollLeft = lastLeft = value;\n    element.dispatchEvent(createDOMEvent('ps-scroll-x'));\n  }\n\n};\n",
    "'use strict';\n\nvar _ = require('../lib/helper');\nvar dom = require('../lib/dom');\nvar instances = require('./instances');\nvar updateGeometry = require('./update-geometry');\nvar updateScroll = require('./update-scroll');\n\nmodule.exports = function (element) {\n  var i = instances.get(element);\n\n  if (!i) {\n    return;\n  }\n\n  // Recalcuate negative scrollLeft adjustment\n  i.negativeScrollAdjustment = i.isNegativeScroll ? element.scrollWidth - element.clientWidth : 0;\n\n  // Recalculate rail margins\n  dom.css(i.scrollbarXRail, 'display', 'block');\n  dom.css(i.scrollbarYRail, 'display', 'block');\n  i.railXMarginWidth = _.toInt(dom.css(i.scrollbarXRail, 'marginLeft')) + _.toInt(dom.css(i.scrollbarXRail, 'marginRight'));\n  i.railYMarginHeight = _.toInt(dom.css(i.scrollbarYRail, 'marginTop')) + _.toInt(dom.css(i.scrollbarYRail, 'marginBottom'));\n\n  // Hide scrollbars not to affect scrollWidth and scrollHeight\n  dom.css(i.scrollbarXRail, 'display', 'none');\n  dom.css(i.scrollbarYRail, 'display', 'none');\n\n  updateGeometry(element);\n\n  // Update top/left scroll to trigger events\n  updateScroll(element, 'top', element.scrollTop);\n  updateScroll(element, 'left', element.scrollLeft);\n\n  dom.css(i.scrollbarXRail, 'display', '');\n  dom.css(i.scrollbarYRail, 'display', '');\n};\n",
    "// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n",
    "//     Underscore.js 1.8.3\n//     http://underscorejs.org\n//     (c) 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n//     Underscore may be freely distributed under the MIT license.\n\n(function() {\n\n  // Baseline setup\n  // --------------\n\n  // Establish the root object, `window` in the browser, or `exports` on the server.\n  var root = this;\n\n  // Save the previous value of the `_` variable.\n  var previousUnderscore = root._;\n\n  // Save bytes in the minified (but not gzipped) version:\n  var ArrayProto = Array.prototype, ObjProto = Object.prototype, FuncProto = Function.prototype;\n\n  // Create quick reference variables for speed access to core prototypes.\n  var\n    push             = ArrayProto.push,\n    slice            = ArrayProto.slice,\n    toString         = ObjProto.toString,\n    hasOwnProperty   = ObjProto.hasOwnProperty;\n\n  // All **ECMAScript 5** native function implementations that we hope to use\n  // are declared here.\n  var\n    nativeIsArray      = Array.isArray,\n    nativeKeys         = Object.keys,\n    nativeBind         = FuncProto.bind,\n    nativeCreate       = Object.create;\n\n  // Naked function reference for surrogate-prototype-swapping.\n  var Ctor = function(){};\n\n  // Create a safe reference to the Underscore object for use below.\n  var _ = function(obj) {\n    if (obj instanceof _) return obj;\n    if (!(this instanceof _)) return new _(obj);\n    this._wrapped = obj;\n  };\n\n  // Export the Underscore object for **Node.js**, with\n  // backwards-compatibility for the old `require()` API. If we're in\n  // the browser, add `_` as a global object.\n  if (typeof exports !== 'undefined') {\n    if (typeof module !== 'undefined' && module.exports) {\n      exports = module.exports = _;\n    }\n    exports._ = _;\n  } else {\n    root._ = _;\n  }\n\n  // Current version.\n  _.VERSION = '1.8.3';\n\n  // Internal function that returns an efficient (for current engines) version\n  // of the passed-in callback, to be repeatedly applied in other Underscore\n  // functions.\n  var optimizeCb = function(func, context, argCount) {\n    if (context === void 0) return func;\n    switch (argCount == null ? 3 : argCount) {\n      case 1: return function(value) {\n        return func.call(context, value);\n      };\n      case 2: return function(value, other) {\n        return func.call(context, value, other);\n      };\n      case 3: return function(value, index, collection) {\n        return func.call(context, value, index, collection);\n      };\n      case 4: return function(accumulator, value, index, collection) {\n        return func.call(context, accumulator, value, index, collection);\n      };\n    }\n    return function() {\n      return func.apply(context, arguments);\n    };\n  };\n\n  // A mostly-internal function to generate callbacks that can be applied\n  // to each element in a collection, returning the desired result  either\n  // identity, an arbitrary callback, a property matcher, or a property accessor.\n  var cb = function(value, context, argCount) {\n    if (value == null) return _.identity;\n    if (_.isFunction(value)) return optimizeCb(value, context, argCount);\n    if (_.isObject(value)) return _.matcher(value);\n    return _.property(value);\n  };\n  _.iteratee = function(value, context) {\n    return cb(value, context, Infinity);\n  };\n\n  // An internal function for creating assigner functions.\n  var createAssigner = function(keysFunc, undefinedOnly) {\n    return function(obj) {\n      var length = arguments.length;\n      if (length < 2 || obj == null) return obj;\n      for (var index = 1; index < length; index++) {\n        var source = arguments[index],\n            keys = keysFunc(source),\n            l = keys.length;\n        for (var i = 0; i < l; i++) {\n          var key = keys[i];\n          if (!undefinedOnly || obj[key] === void 0) obj[key] = source[key];\n        }\n      }\n      return obj;\n    };\n  };\n\n  // An internal function for creating a new object that inherits from another.\n  var baseCreate = function(prototype) {\n    if (!_.isObject(prototype)) return {};\n    if (nativeCreate) return nativeCreate(prototype);\n    Ctor.prototype = prototype;\n    var result = new Ctor;\n    Ctor.prototype = null;\n    return result;\n  };\n\n  var property = function(key) {\n    return function(obj) {\n      return obj == null ? void 0 : obj[key];\n    };\n  };\n\n  // Helper for collection methods to determine whether a collection\n  // should be iterated as an array or as an object\n  // Related: http://people.mozilla.org/~jorendorff/es6-draft.html#sec-tolength\n  // Avoids a very nasty iOS 8 JIT bug on ARM-64. #2094\n  var MAX_ARRAY_INDEX = Math.pow(2, 53) - 1;\n  var getLength = property('length');\n  var isArrayLike = function(collection) {\n    var length = getLength(collection);\n    return typeof length == 'number' && length >= 0 && length <= MAX_ARRAY_INDEX;\n  };\n\n  // Collection Functions\n  // --------------------\n\n  // The cornerstone, an `each` implementation, aka `forEach`.\n  // Handles raw objects in addition to array-likes. Treats all\n  // sparse array-likes as if they were dense.\n  _.each = _.forEach = function(obj, iteratee, context) {\n    iteratee = optimizeCb(iteratee, context);\n    var i, length;\n    if (isArrayLike(obj)) {\n      for (i = 0, length = obj.length; i < length; i++) {\n        iteratee(obj[i], i, obj);\n      }\n    } else {\n      var keys = _.keys(obj);\n      for (i = 0, length = keys.length; i < length; i++) {\n        iteratee(obj[keys[i]], keys[i], obj);\n      }\n    }\n    return obj;\n  };\n\n  // Return the results of applying the iteratee to each element.\n  _.map = _.collect = function(obj, iteratee, context) {\n    iteratee = cb(iteratee, context);\n    var keys = !isArrayLike(obj) && _.keys(obj),\n        length = (keys || obj).length,\n        results = Array(length);\n    for (var index = 0; index < length; index++) {\n      var currentKey = keys ? keys[index] : index;\n      results[index] = iteratee(obj[currentKey], currentKey, obj);\n    }\n    return results;\n  };\n\n  // Create a reducing function iterating left or right.\n  function createReduce(dir) {\n    // Optimized iterator function as using arguments.length\n    // in the main function will deoptimize the, see #1991.\n    function iterator(obj, iteratee, memo, keys, index, length) {\n      for (; index >= 0 && index < length; index += dir) {\n        var currentKey = keys ? keys[index] : index;\n        memo = iteratee(memo, obj[currentKey], currentKey, obj);\n      }\n      return memo;\n    }\n\n    return function(obj, iteratee, memo, context) {\n      iteratee = optimizeCb(iteratee, context, 4);\n      var keys = !isArrayLike(obj) && _.keys(obj),\n          length = (keys || obj).length,\n          index = dir > 0 ? 0 : length - 1;\n      // Determine the initial value if none is provided.\n      if (arguments.length < 3) {\n        memo = obj[keys ? keys[index] : index];\n        index += dir;\n      }\n      return iterator(obj, iteratee, memo, keys, index, length);\n    };\n  }\n\n  // **Reduce** builds up a single result from a list of values, aka `inject`,\n  // or `foldl`.\n  _.reduce = _.foldl = _.inject = createReduce(1);\n\n  // The right-associative version of reduce, also known as `foldr`.\n  _.reduceRight = _.foldr = createReduce(-1);\n\n  // Return the first value which passes a truth test. Aliased as `detect`.\n  _.find = _.detect = function(obj, predicate, context) {\n    var key;\n    if (isArrayLike(obj)) {\n      key = _.findIndex(obj, predicate, context);\n    } else {\n      key = _.findKey(obj, predicate, context);\n    }\n    if (key !== void 0 && key !== -1) return obj[key];\n  };\n\n  // Return all the elements that pass a truth test.\n  // Aliased as `select`.\n  _.filter = _.select = function(obj, predicate, context) {\n    var results = [];\n    predicate = cb(predicate, context);\n    _.each(obj, function(value, index, list) {\n      if (predicate(value, index, list)) results.push(value);\n    });\n    return results;\n  };\n\n  // Return all the elements for which a truth test fails.\n  _.reject = function(obj, predicate, context) {\n    return _.filter(obj, _.negate(cb(predicate)), context);\n  };\n\n  // Determine whether all of the elements match a truth test.\n  // Aliased as `all`.\n  _.every = _.all = function(obj, predicate, context) {\n    predicate = cb(predicate, context);\n    var keys = !isArrayLike(obj) && _.keys(obj),\n        length = (keys || obj).length;\n    for (var index = 0; index < length; index++) {\n      var currentKey = keys ? keys[index] : index;\n      if (!predicate(obj[currentKey], currentKey, obj)) return false;\n    }\n    return true;\n  };\n\n  // Determine if at least one element in the object matches a truth test.\n  // Aliased as `any`.\n  _.some = _.any = function(obj, predicate, context) {\n    predicate = cb(predicate, context);\n    var keys = !isArrayLike(obj) && _.keys(obj),\n        length = (keys || obj).length;\n    for (var index = 0; index < length; index++) {\n      var currentKey = keys ? keys[index] : index;\n      if (predicate(obj[currentKey], currentKey, obj)) return true;\n    }\n    return false;\n  };\n\n  // Determine if the array or object contains a given item (using `===`).\n  // Aliased as `includes` and `include`.\n  _.contains = _.includes = _.include = function(obj, item, fromIndex, guard) {\n    if (!isArrayLike(obj)) obj = _.values(obj);\n    if (typeof fromIndex != 'number' || guard) fromIndex = 0;\n    return _.indexOf(obj, item, fromIndex) >= 0;\n  };\n\n  // Invoke a method (with arguments) on every item in a collection.\n  _.invoke = function(obj, method) {\n    var args = slice.call(arguments, 2);\n    var isFunc = _.isFunction(method);\n    return _.map(obj, function(value) {\n      var func = isFunc ? method : value[method];\n      return func == null ? func : func.apply(value, args);\n    });\n  };\n\n  // Convenience version of a common use case of `map`: fetching a property.\n  _.pluck = function(obj, key) {\n    return _.map(obj, _.property(key));\n  };\n\n  // Convenience version of a common use case of `filter`: selecting only objects\n  // containing specific `key:value` pairs.\n  _.where = function(obj, attrs) {\n    return _.filter(obj, _.matcher(attrs));\n  };\n\n  // Convenience version of a common use case of `find`: getting the first object\n  // containing specific `key:value` pairs.\n  _.findWhere = function(obj, attrs) {\n    return _.find(obj, _.matcher(attrs));\n  };\n\n  // Return the maximum element (or element-based computation).\n  _.max = function(obj, iteratee, context) {\n    var result = -Infinity, lastComputed = -Infinity,\n        value, computed;\n    if (iteratee == null && obj != null) {\n      obj = isArrayLike(obj) ? obj : _.values(obj);\n      for (var i = 0, length = obj.length; i < length; i++) {\n        value = obj[i];\n        if (value > result) {\n          result = value;\n        }\n      }\n    } else {\n      iteratee = cb(iteratee, context);\n      _.each(obj, function(value, index, list) {\n        computed = iteratee(value, index, list);\n        if (computed > lastComputed || computed === -Infinity && result === -Infinity) {\n          result = value;\n          lastComputed = computed;\n        }\n      });\n    }\n    return result;\n  };\n\n  // Return the minimum element (or element-based computation).\n  _.min = function(obj, iteratee, context) {\n    var result = Infinity, lastComputed = Infinity,\n        value, computed;\n    if (iteratee == null && obj != null) {\n      obj = isArrayLike(obj) ? obj : _.values(obj);\n      for (var i = 0, length = obj.length; i < length; i++) {\n        value = obj[i];\n        if (value < result) {\n          result = value;\n        }\n      }\n    } else {\n      iteratee = cb(iteratee, context);\n      _.each(obj, function(value, index, list) {\n        computed = iteratee(value, index, list);\n        if (computed < lastComputed || computed === Infinity && result === Infinity) {\n          result = value;\n          lastComputed = computed;\n        }\n      });\n    }\n    return result;\n  };\n\n  // Shuffle a collection, using the modern version of the\n  // [Fisher-Yates shuffle](http://en.wikipedia.org/wiki/FisherYates_shuffle).\n  _.shuffle = function(obj) {\n    var set = isArrayLike(obj) ? obj : _.values(obj);\n    var length = set.length;\n    var shuffled = Array(length);\n    for (var index = 0, rand; index < length; index++) {\n      rand = _.random(0, index);\n      if (rand !== index) shuffled[index] = shuffled[rand];\n      shuffled[rand] = set[index];\n    }\n    return shuffled;\n  };\n\n  // Sample **n** random values from a collection.\n  // If **n** is not specified, returns a single random element.\n  // The internal `guard` argument allows it to work with `map`.\n  _.sample = function(obj, n, guard) {\n    if (n == null || guard) {\n      if (!isArrayLike(obj)) obj = _.values(obj);\n      return obj[_.random(obj.length - 1)];\n    }\n    return _.shuffle(obj).slice(0, Math.max(0, n));\n  };\n\n  // Sort the object's values by a criterion produced by an iteratee.\n  _.sortBy = function(obj, iteratee, context) {\n    iteratee = cb(iteratee, context);\n    return _.pluck(_.map(obj, function(value, index, list) {\n      return {\n        value: value,\n        index: index,\n        criteria: iteratee(value, index, list)\n      };\n    }).sort(function(left, right) {\n      var a = left.criteria;\n      var b = right.criteria;\n      if (a !== b) {\n        if (a > b || a === void 0) return 1;\n        if (a < b || b === void 0) return -1;\n      }\n      return left.index - right.index;\n    }), 'value');\n  };\n\n  // An internal function used for aggregate \"group by\" operations.\n  var group = function(behavior) {\n    return function(obj, iteratee, context) {\n      var result = {};\n      iteratee = cb(iteratee, context);\n      _.each(obj, function(value, index) {\n        var key = iteratee(value, index, obj);\n        behavior(result, value, key);\n      });\n      return result;\n    };\n  };\n\n  // Groups the object's values by a criterion. Pass either a string attribute\n  // to group by, or a function that returns the criterion.\n  _.groupBy = group(function(result, value, key) {\n    if (_.has(result, key)) result[key].push(value); else result[key] = [value];\n  });\n\n  // Indexes the object's values by a criterion, similar to `groupBy`, but for\n  // when you know that your index values will be unique.\n  _.indexBy = group(function(result, value, key) {\n    result[key] = value;\n  });\n\n  // Counts instances of an object that group by a certain criterion. Pass\n  // either a string attribute to count by, or a function that returns the\n  // criterion.\n  _.countBy = group(function(result, value, key) {\n    if (_.has(result, key)) result[key]++; else result[key] = 1;\n  });\n\n  // Safely create a real, live array from anything iterable.\n  _.toArray = function(obj) {\n    if (!obj) return [];\n    if (_.isArray(obj)) return slice.call(obj);\n    if (isArrayLike(obj)) return _.map(obj, _.identity);\n    return _.values(obj);\n  };\n\n  // Return the number of elements in an object.\n  _.size = function(obj) {\n    if (obj == null) return 0;\n    return isArrayLike(obj) ? obj.length : _.keys(obj).length;\n  };\n\n  // Split a collection into two arrays: one whose elements all satisfy the given\n  // predicate, and one whose elements all do not satisfy the predicate.\n  _.partition = function(obj, predicate, context) {\n    predicate = cb(predicate, context);\n    var pass = [], fail = [];\n    _.each(obj, function(value, key, obj) {\n      (predicate(value, key, obj) ? pass : fail).push(value);\n    });\n    return [pass, fail];\n  };\n\n  // Array Functions\n  // ---------------\n\n  // Get the first element of an array. Passing **n** will return the first N\n  // values in the array. Aliased as `head` and `take`. The **guard** check\n  // allows it to work with `_.map`.\n  _.first = _.head = _.take = function(array, n, guard) {\n    if (array == null) return void 0;\n    if (n == null || guard) return array[0];\n    return _.initial(array, array.length - n);\n  };\n\n  // Returns everything but the last entry of the array. Especially useful on\n  // the arguments object. Passing **n** will return all the values in\n  // the array, excluding the last N.\n  _.initial = function(array, n, guard) {\n    return slice.call(array, 0, Math.max(0, array.length - (n == null || guard ? 1 : n)));\n  };\n\n  // Get the last element of an array. Passing **n** will return the last N\n  // values in the array.\n  _.last = function(array, n, guard) {\n    if (array == null) return void 0;\n    if (n == null || guard) return array[array.length - 1];\n    return _.rest(array, Math.max(0, array.length - n));\n  };\n\n  // Returns everything but the first entry of the array. Aliased as `tail` and `drop`.\n  // Especially useful on the arguments object. Passing an **n** will return\n  // the rest N values in the array.\n  _.rest = _.tail = _.drop = function(array, n, guard) {\n    return slice.call(array, n == null || guard ? 1 : n);\n  };\n\n  // Trim out all falsy values from an array.\n  _.compact = function(array) {\n    return _.filter(array, _.identity);\n  };\n\n  // Internal implementation of a recursive `flatten` function.\n  var flatten = function(input, shallow, strict, startIndex) {\n    var output = [], idx = 0;\n    for (var i = startIndex || 0, length = getLength(input); i < length; i++) {\n      var value = input[i];\n      if (isArrayLike(value) && (_.isArray(value) || _.isArguments(value))) {\n        //flatten current level of array or arguments object\n        if (!shallow) value = flatten(value, shallow, strict);\n        var j = 0, len = value.length;\n        output.length += len;\n        while (j < len) {\n          output[idx++] = value[j++];\n        }\n      } else if (!strict) {\n        output[idx++] = value;\n      }\n    }\n    return output;\n  };\n\n  // Flatten out an array, either recursively (by default), or just one level.\n  _.flatten = function(array, shallow) {\n    return flatten(array, shallow, false);\n  };\n\n  // Return a version of the array that does not contain the specified value(s).\n  _.without = function(array) {\n    return _.difference(array, slice.call(arguments, 1));\n  };\n\n  // Produce a duplicate-free version of the array. If the array has already\n  // been sorted, you have the option of using a faster algorithm.\n  // Aliased as `unique`.\n  _.uniq = _.unique = function(array, isSorted, iteratee, context) {\n    if (!_.isBoolean(isSorted)) {\n      context = iteratee;\n      iteratee = isSorted;\n      isSorted = false;\n    }\n    if (iteratee != null) iteratee = cb(iteratee, context);\n    var result = [];\n    var seen = [];\n    for (var i = 0, length = getLength(array); i < length; i++) {\n      var value = array[i],\n          computed = iteratee ? iteratee(value, i, array) : value;\n      if (isSorted) {\n        if (!i || seen !== computed) result.push(value);\n        seen = computed;\n      } else if (iteratee) {\n        if (!_.contains(seen, computed)) {\n          seen.push(computed);\n          result.push(value);\n        }\n      } else if (!_.contains(result, value)) {\n        result.push(value);\n      }\n    }\n    return result;\n  };\n\n  // Produce an array that contains the union: each distinct element from all of\n  // the passed-in arrays.\n  _.union = function() {\n    return _.uniq(flatten(arguments, true, true));\n  };\n\n  // Produce an array that contains every item shared between all the\n  // passed-in arrays.\n  _.intersection = function(array) {\n    var result = [];\n    var argsLength = arguments.length;\n    for (var i = 0, length = getLength(array); i < length; i++) {\n      var item = array[i];\n      if (_.contains(result, item)) continue;\n      for (var j = 1; j < argsLength; j++) {\n        if (!_.contains(arguments[j], item)) break;\n      }\n      if (j === argsLength) result.push(item);\n    }\n    return result;\n  };\n\n  // Take the difference between one array and a number of other arrays.\n  // Only the elements present in just the first array will remain.\n  _.difference = function(array) {\n    var rest = flatten(arguments, true, true, 1);\n    return _.filter(array, function(value){\n      return !_.contains(rest, value);\n    });\n  };\n\n  // Zip together multiple lists into a single array -- elements that share\n  // an index go together.\n  _.zip = function() {\n    return _.unzip(arguments);\n  };\n\n  // Complement of _.zip. Unzip accepts an array of arrays and groups\n  // each array's elements on shared indices\n  _.unzip = function(array) {\n    var length = array && _.max(array, getLength).length || 0;\n    var result = Array(length);\n\n    for (var index = 0; index < length; index++) {\n      result[index] = _.pluck(array, index);\n    }\n    return result;\n  };\n\n  // Converts lists into objects. Pass either a single array of `[key, value]`\n  // pairs, or two parallel arrays of the same length -- one of keys, and one of\n  // the corresponding values.\n  _.object = function(list, values) {\n    var result = {};\n    for (var i = 0, length = getLength(list); i < length; i++) {\n      if (values) {\n        result[list[i]] = values[i];\n      } else {\n        result[list[i][0]] = list[i][1];\n      }\n    }\n    return result;\n  };\n\n  // Generator function to create the findIndex and findLastIndex functions\n  function createPredicateIndexFinder(dir) {\n    return function(array, predicate, context) {\n      predicate = cb(predicate, context);\n      var length = getLength(array);\n      var index = dir > 0 ? 0 : length - 1;\n      for (; index >= 0 && index < length; index += dir) {\n        if (predicate(array[index], index, array)) return index;\n      }\n      return -1;\n    };\n  }\n\n  // Returns the first index on an array-like that passes a predicate test\n  _.findIndex = createPredicateIndexFinder(1);\n  _.findLastIndex = createPredicateIndexFinder(-1);\n\n  // Use a comparator function to figure out the smallest index at which\n  // an object should be inserted so as to maintain order. Uses binary search.\n  _.sortedIndex = function(array, obj, iteratee, context) {\n    iteratee = cb(iteratee, context, 1);\n    var value = iteratee(obj);\n    var low = 0, high = getLength(array);\n    while (low < high) {\n      var mid = Math.floor((low + high) / 2);\n      if (iteratee(array[mid]) < value) low = mid + 1; else high = mid;\n    }\n    return low;\n  };\n\n  // Generator function to create the indexOf and lastIndexOf functions\n  function createIndexFinder(dir, predicateFind, sortedIndex) {\n    return function(array, item, idx) {\n      var i = 0, length = getLength(array);\n      if (typeof idx == 'number') {\n        if (dir > 0) {\n            i = idx >= 0 ? idx : Math.max(idx + length, i);\n        } else {\n            length = idx >= 0 ? Math.min(idx + 1, length) : idx + length + 1;\n        }\n      } else if (sortedIndex && idx && length) {\n        idx = sortedIndex(array, item);\n        return array[idx] === item ? idx : -1;\n      }\n      if (item !== item) {\n        idx = predicateFind(slice.call(array, i, length), _.isNaN);\n        return idx >= 0 ? idx + i : -1;\n      }\n      for (idx = dir > 0 ? i : length - 1; idx >= 0 && idx < length; idx += dir) {\n        if (array[idx] === item) return idx;\n      }\n      return -1;\n    };\n  }\n\n  // Return the position of the first occurrence of an item in an array,\n  // or -1 if the item is not included in the array.\n  // If the array is large and already in sort order, pass `true`\n  // for **isSorted** to use binary search.\n  _.indexOf = createIndexFinder(1, _.findIndex, _.sortedIndex);\n  _.lastIndexOf = createIndexFinder(-1, _.findLastIndex);\n\n  // Generate an integer Array containing an arithmetic progression. A port of\n  // the native Python `range()` function. See\n  // [the Python documentation](http://docs.python.org/library/functions.html#range).\n  _.range = function(start, stop, step) {\n    if (stop == null) {\n      stop = start || 0;\n      start = 0;\n    }\n    step = step || 1;\n\n    var length = Math.max(Math.ceil((stop - start) / step), 0);\n    var range = Array(length);\n\n    for (var idx = 0; idx < length; idx++, start += step) {\n      range[idx] = start;\n    }\n\n    return range;\n  };\n\n  // Function (ahem) Functions\n  // ------------------\n\n  // Determines whether to execute a function as a constructor\n  // or a normal function with the provided arguments\n  var executeBound = function(sourceFunc, boundFunc, context, callingContext, args) {\n    if (!(callingContext instanceof boundFunc)) return sourceFunc.apply(context, args);\n    var self = baseCreate(sourceFunc.prototype);\n    var result = sourceFunc.apply(self, args);\n    if (_.isObject(result)) return result;\n    return self;\n  };\n\n  // Create a function bound to a given object (assigning `this`, and arguments,\n  // optionally). Delegates to **ECMAScript 5**'s native `Function.bind` if\n  // available.\n  _.bind = function(func, context) {\n    if (nativeBind && func.bind === nativeBind) return nativeBind.apply(func, slice.call(arguments, 1));\n    if (!_.isFunction(func)) throw new TypeError('Bind must be called on a function');\n    var args = slice.call(arguments, 2);\n    var bound = function() {\n      return executeBound(func, bound, context, this, args.concat(slice.call(arguments)));\n    };\n    return bound;\n  };\n\n  // Partially apply a function by creating a version that has had some of its\n  // arguments pre-filled, without changing its dynamic `this` context. _ acts\n  // as a placeholder, allowing any combination of arguments to be pre-filled.\n  _.partial = function(func) {\n    var boundArgs = slice.call(arguments, 1);\n    var bound = function() {\n      var position = 0, length = boundArgs.length;\n      var args = Array(length);\n      for (var i = 0; i < length; i++) {\n        args[i] = boundArgs[i] === _ ? arguments[position++] : boundArgs[i];\n      }\n      while (position < arguments.length) args.push(arguments[position++]);\n      return executeBound(func, bound, this, this, args);\n    };\n    return bound;\n  };\n\n  // Bind a number of an object's methods to that object. Remaining arguments\n  // are the method names to be bound. Useful for ensuring that all callbacks\n  // defined on an object belong to it.\n  _.bindAll = function(obj) {\n    var i, length = arguments.length, key;\n    if (length <= 1) throw new Error('bindAll must be passed function names');\n    for (i = 1; i < length; i++) {\n      key = arguments[i];\n      obj[key] = _.bind(obj[key], obj);\n    }\n    return obj;\n  };\n\n  // Memoize an expensive function by storing its results.\n  _.memoize = function(func, hasher) {\n    var memoize = function(key) {\n      var cache = memoize.cache;\n      var address = '' + (hasher ? hasher.apply(this, arguments) : key);\n      if (!_.has(cache, address)) cache[address] = func.apply(this, arguments);\n      return cache[address];\n    };\n    memoize.cache = {};\n    return memoize;\n  };\n\n  // Delays a function for the given number of milliseconds, and then calls\n  // it with the arguments supplied.\n  _.delay = function(func, wait) {\n    var args = slice.call(arguments, 2);\n    return setTimeout(function(){\n      return func.apply(null, args);\n    }, wait);\n  };\n\n  // Defers a function, scheduling it to run after the current call stack has\n  // cleared.\n  _.defer = _.partial(_.delay, _, 1);\n\n  // Returns a function, that, when invoked, will only be triggered at most once\n  // during a given window of time. Normally, the throttled function will run\n  // as much as it can, without ever going more than once per `wait` duration;\n  // but if you'd like to disable the execution on the leading edge, pass\n  // `{leading: false}`. To disable execution on the trailing edge, ditto.\n  _.throttle = function(func, wait, options) {\n    var context, args, result;\n    var timeout = null;\n    var previous = 0;\n    if (!options) options = {};\n    var later = function() {\n      previous = options.leading === false ? 0 : _.now();\n      timeout = null;\n      result = func.apply(context, args);\n      if (!timeout) context = args = null;\n    };\n    return function() {\n      var now = _.now();\n      if (!previous && options.leading === false) previous = now;\n      var remaining = wait - (now - previous);\n      context = this;\n      args = arguments;\n      if (remaining <= 0 || remaining > wait) {\n        if (timeout) {\n          clearTimeout(timeout);\n          timeout = null;\n        }\n        previous = now;\n        result = func.apply(context, args);\n        if (!timeout) context = args = null;\n      } else if (!timeout && options.trailing !== false) {\n        timeout = setTimeout(later, remaining);\n      }\n      return result;\n    };\n  };\n\n  // Returns a function, that, as long as it continues to be invoked, will not\n  // be triggered. The function will be called after it stops being called for\n  // N milliseconds. If `immediate` is passed, trigger the function on the\n  // leading edge, instead of the trailing.\n  _.debounce = function(func, wait, immediate) {\n    var timeout, args, context, timestamp, result;\n\n    var later = function() {\n      var last = _.now() - timestamp;\n\n      if (last < wait && last >= 0) {\n        timeout = setTimeout(later, wait - last);\n      } else {\n        timeout = null;\n        if (!immediate) {\n          result = func.apply(context, args);\n          if (!timeout) context = args = null;\n        }\n      }\n    };\n\n    return function() {\n      context = this;\n      args = arguments;\n      timestamp = _.now();\n      var callNow = immediate && !timeout;\n      if (!timeout) timeout = setTimeout(later, wait);\n      if (callNow) {\n        result = func.apply(context, args);\n        context = args = null;\n      }\n\n      return result;\n    };\n  };\n\n  // Returns the first function passed as an argument to the second,\n  // allowing you to adjust arguments, run code before and after, and\n  // conditionally execute the original function.\n  _.wrap = function(func, wrapper) {\n    return _.partial(wrapper, func);\n  };\n\n  // Returns a negated version of the passed-in predicate.\n  _.negate = function(predicate) {\n    return function() {\n      return !predicate.apply(this, arguments);\n    };\n  };\n\n  // Returns a function that is the composition of a list of functions, each\n  // consuming the return value of the function that follows.\n  _.compose = function() {\n    var args = arguments;\n    var start = args.length - 1;\n    return function() {\n      var i = start;\n      var result = args[start].apply(this, arguments);\n      while (i--) result = args[i].call(this, result);\n      return result;\n    };\n  };\n\n  // Returns a function that will only be executed on and after the Nth call.\n  _.after = function(times, func) {\n    return function() {\n      if (--times < 1) {\n        return func.apply(this, arguments);\n      }\n    };\n  };\n\n  // Returns a function that will only be executed up to (but not including) the Nth call.\n  _.before = function(times, func) {\n    var memo;\n    return function() {\n      if (--times > 0) {\n        memo = func.apply(this, arguments);\n      }\n      if (times <= 1) func = null;\n      return memo;\n    };\n  };\n\n  // Returns a function that will be executed at most one time, no matter how\n  // often you call it. Useful for lazy initialization.\n  _.once = _.partial(_.before, 2);\n\n  // Object Functions\n  // ----------------\n\n  // Keys in IE < 9 that won't be iterated by `for key in ...` and thus missed.\n  var hasEnumBug = !{toString: null}.propertyIsEnumerable('toString');\n  var nonEnumerableProps = ['valueOf', 'isPrototypeOf', 'toString',\n                      'propertyIsEnumerable', 'hasOwnProperty', 'toLocaleString'];\n\n  function collectNonEnumProps(obj, keys) {\n    var nonEnumIdx = nonEnumerableProps.length;\n    var constructor = obj.constructor;\n    var proto = (_.isFunction(constructor) && constructor.prototype) || ObjProto;\n\n    // Constructor is a special case.\n    var prop = 'constructor';\n    if (_.has(obj, prop) && !_.contains(keys, prop)) keys.push(prop);\n\n    while (nonEnumIdx--) {\n      prop = nonEnumerableProps[nonEnumIdx];\n      if (prop in obj && obj[prop] !== proto[prop] && !_.contains(keys, prop)) {\n        keys.push(prop);\n      }\n    }\n  }\n\n  // Retrieve the names of an object's own properties.\n  // Delegates to **ECMAScript 5**'s native `Object.keys`\n  _.keys = function(obj) {\n    if (!_.isObject(obj)) return [];\n    if (nativeKeys) return nativeKeys(obj);\n    var keys = [];\n    for (var key in obj) if (_.has(obj, key)) keys.push(key);\n    // Ahem, IE < 9.\n    if (hasEnumBug) collectNonEnumProps(obj, keys);\n    return keys;\n  };\n\n  // Retrieve all the property names of an object.\n  _.allKeys = function(obj) {\n    if (!_.isObject(obj)) return [];\n    var keys = [];\n    for (var key in obj) keys.push(key);\n    // Ahem, IE < 9.\n    if (hasEnumBug) collectNonEnumProps(obj, keys);\n    return keys;\n  };\n\n  // Retrieve the values of an object's properties.\n  _.values = function(obj) {\n    var keys = _.keys(obj);\n    var length = keys.length;\n    var values = Array(length);\n    for (var i = 0; i < length; i++) {\n      values[i] = obj[keys[i]];\n    }\n    return values;\n  };\n\n  // Returns the results of applying the iteratee to each element of the object\n  // In contrast to _.map it returns an object\n  _.mapObject = function(obj, iteratee, context) {\n    iteratee = cb(iteratee, context);\n    var keys =  _.keys(obj),\n          length = keys.length,\n          results = {},\n          currentKey;\n      for (var index = 0; index < length; index++) {\n        currentKey = keys[index];\n        results[currentKey] = iteratee(obj[currentKey], currentKey, obj);\n      }\n      return results;\n  };\n\n  // Convert an object into a list of `[key, value]` pairs.\n  _.pairs = function(obj) {\n    var keys = _.keys(obj);\n    var length = keys.length;\n    var pairs = Array(length);\n    for (var i = 0; i < length; i++) {\n      pairs[i] = [keys[i], obj[keys[i]]];\n    }\n    return pairs;\n  };\n\n  // Invert the keys and values of an object. The values must be serializable.\n  _.invert = function(obj) {\n    var result = {};\n    var keys = _.keys(obj);\n    for (var i = 0, length = keys.length; i < length; i++) {\n      result[obj[keys[i]]] = keys[i];\n    }\n    return result;\n  };\n\n  // Return a sorted list of the function names available on the object.\n  // Aliased as `methods`\n  _.functions = _.methods = function(obj) {\n    var names = [];\n    for (var key in obj) {\n      if (_.isFunction(obj[key])) names.push(key);\n    }\n    return names.sort();\n  };\n\n  // Extend a given object with all the properties in passed-in object(s).\n  _.extend = createAssigner(_.allKeys);\n\n  // Assigns a given object with all the own properties in the passed-in object(s)\n  // (https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/assign)\n  _.extendOwn = _.assign = createAssigner(_.keys);\n\n  // Returns the first key on an object that passes a predicate test\n  _.findKey = function(obj, predicate, context) {\n    predicate = cb(predicate, context);\n    var keys = _.keys(obj), key;\n    for (var i = 0, length = keys.length; i < length; i++) {\n      key = keys[i];\n      if (predicate(obj[key], key, obj)) return key;\n    }\n  };\n\n  // Return a copy of the object only containing the whitelisted properties.\n  _.pick = function(object, oiteratee, context) {\n    var result = {}, obj = object, iteratee, keys;\n    if (obj == null) return result;\n    if (_.isFunction(oiteratee)) {\n      keys = _.allKeys(obj);\n      iteratee = optimizeCb(oiteratee, context);\n    } else {\n      keys = flatten(arguments, false, false, 1);\n      iteratee = function(value, key, obj) { return key in obj; };\n      obj = Object(obj);\n    }\n    for (var i = 0, length = keys.length; i < length; i++) {\n      var key = keys[i];\n      var value = obj[key];\n      if (iteratee(value, key, obj)) result[key] = value;\n    }\n    return result;\n  };\n\n   // Return a copy of the object without the blacklisted properties.\n  _.omit = function(obj, iteratee, context) {\n    if (_.isFunction(iteratee)) {\n      iteratee = _.negate(iteratee);\n    } else {\n      var keys = _.map(flatten(arguments, false, false, 1), String);\n      iteratee = function(value, key) {\n        return !_.contains(keys, key);\n      };\n    }\n    return _.pick(obj, iteratee, context);\n  };\n\n  // Fill in a given object with default properties.\n  _.defaults = createAssigner(_.allKeys, true);\n\n  // Creates an object that inherits from the given prototype object.\n  // If additional properties are provided then they will be added to the\n  // created object.\n  _.create = function(prototype, props) {\n    var result = baseCreate(prototype);\n    if (props) _.extendOwn(result, props);\n    return result;\n  };\n\n  // Create a (shallow-cloned) duplicate of an object.\n  _.clone = function(obj) {\n    if (!_.isObject(obj)) return obj;\n    return _.isArray(obj) ? obj.slice() : _.extend({}, obj);\n  };\n\n  // Invokes interceptor with the obj, and then returns obj.\n  // The primary purpose of this method is to \"tap into\" a method chain, in\n  // order to perform operations on intermediate results within the chain.\n  _.tap = function(obj, interceptor) {\n    interceptor(obj);\n    return obj;\n  };\n\n  // Returns whether an object has a given set of `key:value` pairs.\n  _.isMatch = function(object, attrs) {\n    var keys = _.keys(attrs), length = keys.length;\n    if (object == null) return !length;\n    var obj = Object(object);\n    for (var i = 0; i < length; i++) {\n      var key = keys[i];\n      if (attrs[key] !== obj[key] || !(key in obj)) return false;\n    }\n    return true;\n  };\n\n\n  // Internal recursive comparison function for `isEqual`.\n  var eq = function(a, b, aStack, bStack) {\n    // Identical objects are equal. `0 === -0`, but they aren't identical.\n    // See the [Harmony `egal` proposal](http://wiki.ecmascript.org/doku.php?id=harmony:egal).\n    if (a === b) return a !== 0 || 1 / a === 1 / b;\n    // A strict comparison is necessary because `null == undefined`.\n    if (a == null || b == null) return a === b;\n    // Unwrap any wrapped objects.\n    if (a instanceof _) a = a._wrapped;\n    if (b instanceof _) b = b._wrapped;\n    // Compare `[[Class]]` names.\n    var className = toString.call(a);\n    if (className !== toString.call(b)) return false;\n    switch (className) {\n      // Strings, numbers, regular expressions, dates, and booleans are compared by value.\n      case '[object RegExp]':\n      // RegExps are coerced to strings for comparison (Note: '' + /a/i === '/a/i')\n      case '[object String]':\n        // Primitives and their corresponding object wrappers are equivalent; thus, `\"5\"` is\n        // equivalent to `new String(\"5\")`.\n        return '' + a === '' + b;\n      case '[object Number]':\n        // `NaN`s are equivalent, but non-reflexive.\n        // Object(NaN) is equivalent to NaN\n        if (+a !== +a) return +b !== +b;\n        // An `egal` comparison is performed for other numeric values.\n        return +a === 0 ? 1 / +a === 1 / b : +a === +b;\n      case '[object Date]':\n      case '[object Boolean]':\n        // Coerce dates and booleans to numeric primitive values. Dates are compared by their\n        // millisecond representations. Note that invalid dates with millisecond representations\n        // of `NaN` are not equivalent.\n        return +a === +b;\n    }\n\n    var areArrays = className === '[object Array]';\n    if (!areArrays) {\n      if (typeof a != 'object' || typeof b != 'object') return false;\n\n      // Objects with different constructors are not equivalent, but `Object`s or `Array`s\n      // from different frames are.\n      var aCtor = a.constructor, bCtor = b.constructor;\n      if (aCtor !== bCtor && !(_.isFunction(aCtor) && aCtor instanceof aCtor &&\n                               _.isFunction(bCtor) && bCtor instanceof bCtor)\n                          && ('constructor' in a && 'constructor' in b)) {\n        return false;\n      }\n    }\n    // Assume equality for cyclic structures. The algorithm for detecting cyclic\n    // structures is adapted from ES 5.1 section 15.12.3, abstract operation `JO`.\n\n    // Initializing stack of traversed objects.\n    // It's done here since we only need them for objects and arrays comparison.\n    aStack = aStack || [];\n    bStack = bStack || [];\n    var length = aStack.length;\n    while (length--) {\n      // Linear search. Performance is inversely proportional to the number of\n      // unique nested structures.\n      if (aStack[length] === a) return bStack[length] === b;\n    }\n\n    // Add the first object to the stack of traversed objects.\n    aStack.push(a);\n    bStack.push(b);\n\n    // Recursively compare objects and arrays.\n    if (areArrays) {\n      // Compare array lengths to determine if a deep comparison is necessary.\n      length = a.length;\n      if (length !== b.length) return false;\n      // Deep compare the contents, ignoring non-numeric properties.\n      while (length--) {\n        if (!eq(a[length], b[length], aStack, bStack)) return false;\n      }\n    } else {\n      // Deep compare objects.\n      var keys = _.keys(a), key;\n      length = keys.length;\n      // Ensure that both objects contain the same number of properties before comparing deep equality.\n      if (_.keys(b).length !== length) return false;\n      while (length--) {\n        // Deep compare each member\n        key = keys[length];\n        if (!(_.has(b, key) && eq(a[key], b[key], aStack, bStack))) return false;\n      }\n    }\n    // Remove the first object from the stack of traversed objects.\n    aStack.pop();\n    bStack.pop();\n    return true;\n  };\n\n  // Perform a deep comparison to check if two objects are equal.\n  _.isEqual = function(a, b) {\n    return eq(a, b);\n  };\n\n  // Is a given array, string, or object empty?\n  // An \"empty\" object has no enumerable own-properties.\n  _.isEmpty = function(obj) {\n    if (obj == null) return true;\n    if (isArrayLike(obj) && (_.isArray(obj) || _.isString(obj) || _.isArguments(obj))) return obj.length === 0;\n    return _.keys(obj).length === 0;\n  };\n\n  // Is a given value a DOM element?\n  _.isElement = function(obj) {\n    return !!(obj && obj.nodeType === 1);\n  };\n\n  // Is a given value an array?\n  // Delegates to ECMA5's native Array.isArray\n  _.isArray = nativeIsArray || function(obj) {\n    return toString.call(obj) === '[object Array]';\n  };\n\n  // Is a given variable an object?\n  _.isObject = function(obj) {\n    var type = typeof obj;\n    return type === 'function' || type === 'object' && !!obj;\n  };\n\n  // Add some isType methods: isArguments, isFunction, isString, isNumber, isDate, isRegExp, isError.\n  _.each(['Arguments', 'Function', 'String', 'Number', 'Date', 'RegExp', 'Error'], function(name) {\n    _['is' + name] = function(obj) {\n      return toString.call(obj) === '[object ' + name + ']';\n    };\n  });\n\n  // Define a fallback version of the method in browsers (ahem, IE < 9), where\n  // there isn't any inspectable \"Arguments\" type.\n  if (!_.isArguments(arguments)) {\n    _.isArguments = function(obj) {\n      return _.has(obj, 'callee');\n    };\n  }\n\n  // Optimize `isFunction` if appropriate. Work around some typeof bugs in old v8,\n  // IE 11 (#1621), and in Safari 8 (#1929).\n  if (typeof /./ != 'function' && typeof Int8Array != 'object') {\n    _.isFunction = function(obj) {\n      return typeof obj == 'function' || false;\n    };\n  }\n\n  // Is a given object a finite number?\n  _.isFinite = function(obj) {\n    return isFinite(obj) && !isNaN(parseFloat(obj));\n  };\n\n  // Is the given value `NaN`? (NaN is the only number which does not equal itself).\n  _.isNaN = function(obj) {\n    return _.isNumber(obj) && obj !== +obj;\n  };\n\n  // Is a given value a boolean?\n  _.isBoolean = function(obj) {\n    return obj === true || obj === false || toString.call(obj) === '[object Boolean]';\n  };\n\n  // Is a given value equal to null?\n  _.isNull = function(obj) {\n    return obj === null;\n  };\n\n  // Is a given variable undefined?\n  _.isUndefined = function(obj) {\n    return obj === void 0;\n  };\n\n  // Shortcut function for checking if an object has a given property directly\n  // on itself (in other words, not on a prototype).\n  _.has = function(obj, key) {\n    return obj != null && hasOwnProperty.call(obj, key);\n  };\n\n  // Utility Functions\n  // -----------------\n\n  // Run Underscore.js in *noConflict* mode, returning the `_` variable to its\n  // previous owner. Returns a reference to the Underscore object.\n  _.noConflict = function() {\n    root._ = previousUnderscore;\n    return this;\n  };\n\n  // Keep the identity function around for default iteratees.\n  _.identity = function(value) {\n    return value;\n  };\n\n  // Predicate-generating functions. Often useful outside of Underscore.\n  _.constant = function(value) {\n    return function() {\n      return value;\n    };\n  };\n\n  _.noop = function(){};\n\n  _.property = property;\n\n  // Generates a function for a given object that returns a given property.\n  _.propertyOf = function(obj) {\n    return obj == null ? function(){} : function(key) {\n      return obj[key];\n    };\n  };\n\n  // Returns a predicate for checking whether an object has a given set of\n  // `key:value` pairs.\n  _.matcher = _.matches = function(attrs) {\n    attrs = _.extendOwn({}, attrs);\n    return function(obj) {\n      return _.isMatch(obj, attrs);\n    };\n  };\n\n  // Run a function **n** times.\n  _.times = function(n, iteratee, context) {\n    var accum = Array(Math.max(0, n));\n    iteratee = optimizeCb(iteratee, context, 1);\n    for (var i = 0; i < n; i++) accum[i] = iteratee(i);\n    return accum;\n  };\n\n  // Return a random integer between min and max (inclusive).\n  _.random = function(min, max) {\n    if (max == null) {\n      max = min;\n      min = 0;\n    }\n    return min + Math.floor(Math.random() * (max - min + 1));\n  };\n\n  // A (possibly faster) way to get the current timestamp as an integer.\n  _.now = Date.now || function() {\n    return new Date().getTime();\n  };\n\n   // List of HTML entities for escaping.\n  var escapeMap = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#x27;',\n    '`': '&#x60;'\n  };\n  var unescapeMap = _.invert(escapeMap);\n\n  // Functions for escaping and unescaping strings to/from HTML interpolation.\n  var createEscaper = function(map) {\n    var escaper = function(match) {\n      return map[match];\n    };\n    // Regexes for identifying a key that needs to be escaped\n    var source = '(?:' + _.keys(map).join('|') + ')';\n    var testRegexp = RegExp(source);\n    var replaceRegexp = RegExp(source, 'g');\n    return function(string) {\n      string = string == null ? '' : '' + string;\n      return testRegexp.test(string) ? string.replace(replaceRegexp, escaper) : string;\n    };\n  };\n  _.escape = createEscaper(escapeMap);\n  _.unescape = createEscaper(unescapeMap);\n\n  // If the value of the named `property` is a function then invoke it with the\n  // `object` as context; otherwise, return it.\n  _.result = function(object, property, fallback) {\n    var value = object == null ? void 0 : object[property];\n    if (value === void 0) {\n      value = fallback;\n    }\n    return _.isFunction(value) ? value.call(object) : value;\n  };\n\n  // Generate a unique integer id (unique within the entire client session).\n  // Useful for temporary DOM ids.\n  var idCounter = 0;\n  _.uniqueId = function(prefix) {\n    var id = ++idCounter + '';\n    return prefix ? prefix + id : id;\n  };\n\n  // By default, Underscore uses ERB-style template delimiters, change the\n  // following template settings to use alternative delimiters.\n  _.templateSettings = {\n    evaluate    : /<%([\\s\\S]+?)%>/g,\n    interpolate : /<%=([\\s\\S]+?)%>/g,\n    escape      : /<%-([\\s\\S]+?)%>/g\n  };\n\n  // When customizing `templateSettings`, if you don't want to define an\n  // interpolation, evaluation or escaping regex, we need one that is\n  // guaranteed not to match.\n  var noMatch = /(.)^/;\n\n  // Certain characters need to be escaped so that they can be put into a\n  // string literal.\n  var escapes = {\n    \"'\":      \"'\",\n    '\\\\':     '\\\\',\n    '\\r':     'r',\n    '\\n':     'n',\n    '\\u2028': 'u2028',\n    '\\u2029': 'u2029'\n  };\n\n  var escaper = /\\\\|'|\\r|\\n|\\u2028|\\u2029/g;\n\n  var escapeChar = function(match) {\n    return '\\\\' + escapes[match];\n  };\n\n  // JavaScript micro-templating, similar to John Resig's implementation.\n  // Underscore templating handles arbitrary delimiters, preserves whitespace,\n  // and correctly escapes quotes within interpolated code.\n  // NB: `oldSettings` only exists for backwards compatibility.\n  _.template = function(text, settings, oldSettings) {\n    if (!settings && oldSettings) settings = oldSettings;\n    settings = _.defaults({}, settings, _.templateSettings);\n\n    // Combine delimiters into one regular expression via alternation.\n    var matcher = RegExp([\n      (settings.escape || noMatch).source,\n      (settings.interpolate || noMatch).source,\n      (settings.evaluate || noMatch).source\n    ].join('|') + '|$', 'g');\n\n    // Compile the template source, escaping string literals appropriately.\n    var index = 0;\n    var source = \"__p+='\";\n    text.replace(matcher, function(match, escape, interpolate, evaluate, offset) {\n      source += text.slice(index, offset).replace(escaper, escapeChar);\n      index = offset + match.length;\n\n      if (escape) {\n        source += \"'+\\n((__t=(\" + escape + \"))==null?'':_.escape(__t))+\\n'\";\n      } else if (interpolate) {\n        source += \"'+\\n((__t=(\" + interpolate + \"))==null?'':__t)+\\n'\";\n      } else if (evaluate) {\n        source += \"';\\n\" + evaluate + \"\\n__p+='\";\n      }\n\n      // Adobe VMs need the match returned to produce the correct offest.\n      return match;\n    });\n    source += \"';\\n\";\n\n    // If a variable is not specified, place data values in local scope.\n    if (!settings.variable) source = 'with(obj||{}){\\n' + source + '}\\n';\n\n    source = \"var __t,__p='',__j=Array.prototype.join,\" +\n      \"print=function(){__p+=__j.call(arguments,'');};\\n\" +\n      source + 'return __p;\\n';\n\n    try {\n      var render = new Function(settings.variable || 'obj', '_', source);\n    } catch (e) {\n      e.source = source;\n      throw e;\n    }\n\n    var template = function(data) {\n      return render.call(this, data, _);\n    };\n\n    // Provide the compiled source as a convenience for precompilation.\n    var argument = settings.variable || 'obj';\n    template.source = 'function(' + argument + '){\\n' + source + '}';\n\n    return template;\n  };\n\n  // Add a \"chain\" function. Start chaining a wrapped Underscore object.\n  _.chain = function(obj) {\n    var instance = _(obj);\n    instance._chain = true;\n    return instance;\n  };\n\n  // OOP\n  // ---------------\n  // If Underscore is called as a function, it returns a wrapped object that\n  // can be used OO-style. This wrapper holds altered versions of all the\n  // underscore functions. Wrapped objects may be chained.\n\n  // Helper function to continue chaining intermediate results.\n  var result = function(instance, obj) {\n    return instance._chain ? _(obj).chain() : obj;\n  };\n\n  // Add your own custom functions to the Underscore object.\n  _.mixin = function(obj) {\n    _.each(_.functions(obj), function(name) {\n      var func = _[name] = obj[name];\n      _.prototype[name] = function() {\n        var args = [this._wrapped];\n        push.apply(args, arguments);\n        return result(this, func.apply(_, args));\n      };\n    });\n  };\n\n  // Add all of the Underscore functions to the wrapper object.\n  _.mixin(_);\n\n  // Add all mutator Array functions to the wrapper.\n  _.each(['pop', 'push', 'reverse', 'shift', 'sort', 'splice', 'unshift'], function(name) {\n    var method = ArrayProto[name];\n    _.prototype[name] = function() {\n      var obj = this._wrapped;\n      method.apply(obj, arguments);\n      if ((name === 'shift' || name === 'splice') && obj.length === 0) delete obj[0];\n      return result(this, obj);\n    };\n  });\n\n  // Add all accessor Array functions to the wrapper.\n  _.each(['concat', 'join', 'slice'], function(name) {\n    var method = ArrayProto[name];\n    _.prototype[name] = function() {\n      return result(this, method.apply(this._wrapped, arguments));\n    };\n  });\n\n  // Extracts the result from a wrapped and chained object.\n  _.prototype.value = function() {\n    return this._wrapped;\n  };\n\n  // Provide unwrapping proxy for some methods used in engine operations\n  // such as arithmetic and JSON stringification.\n  _.prototype.valueOf = _.prototype.toJSON = _.prototype.value;\n\n  _.prototype.toString = function() {\n    return '' + this._wrapped;\n  };\n\n  // AMD registration happens at the end for compatibility with AMD loaders\n  // that may not enforce next-turn semantics on modules. Even though general\n  // practice for AMD registration is to be anonymous, underscore registers\n  // as a named module because, like jQuery, it is a base library that is\n  // popular enough to be bundled in a third party lib, but not be part of\n  // an AMD load request. Those cases could generate an error when an\n  // anonymous define() is called outside of a loader request.\n  if (typeof define === 'function' && define.amd) {\n    define('underscore', [], function() {\n      return _;\n    });\n  }\n}.call(this));\n",
    "if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n",
    "module.exports = function isBuffer(arg) {\n  return arg && typeof arg === 'object'\n    && typeof arg.copy === 'function'\n    && typeof arg.fill === 'function'\n    && typeof arg.readUInt8 === 'function';\n}",
    "// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar formatRegExp = /%[sdj%]/g;\nexports.format = function(f) {\n  if (!isString(f)) {\n    var objects = [];\n    for (var i = 0; i < arguments.length; i++) {\n      objects.push(inspect(arguments[i]));\n    }\n    return objects.join(' ');\n  }\n\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  var str = String(f).replace(formatRegExp, function(x) {\n    if (x === '%%') return '%';\n    if (i >= len) return x;\n    switch (x) {\n      case '%s': return String(args[i++]);\n      case '%d': return Number(args[i++]);\n      case '%j':\n        try {\n          return JSON.stringify(args[i++]);\n        } catch (_) {\n          return '[Circular]';\n        }\n      default:\n        return x;\n    }\n  });\n  for (var x = args[i]; i < len; x = args[++i]) {\n    if (isNull(x) || !isObject(x)) {\n      str += ' ' + x;\n    } else {\n      str += ' ' + inspect(x);\n    }\n  }\n  return str;\n};\n\n\n// Mark that a method should not be used.\n// Returns a modified function which warns once by default.\n// If --no-deprecation is set, then it is a no-op.\nexports.deprecate = function(fn, msg) {\n  // Allow for deprecating things in the process of starting up.\n  if (isUndefined(global.process)) {\n    return function() {\n      return exports.deprecate(fn, msg).apply(this, arguments);\n    };\n  }\n\n  if (process.noDeprecation === true) {\n    return fn;\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (process.throwDeprecation) {\n        throw new Error(msg);\n      } else if (process.traceDeprecation) {\n        console.trace(msg);\n      } else {\n        console.error(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n};\n\n\nvar debugs = {};\nvar debugEnviron;\nexports.debuglog = function(set) {\n  if (isUndefined(debugEnviron))\n    debugEnviron = process.env.NODE_DEBUG || '';\n  set = set.toUpperCase();\n  if (!debugs[set]) {\n    if (new RegExp('\\\\b' + set + '\\\\b', 'i').test(debugEnviron)) {\n      var pid = process.pid;\n      debugs[set] = function() {\n        var msg = exports.format.apply(exports, arguments);\n        console.error('%s %d: %s', set, pid, msg);\n      };\n    } else {\n      debugs[set] = function() {};\n    }\n  }\n  return debugs[set];\n};\n\n\n/**\n * Echos the value of a value. Trys to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Object} opts Optional options object that alters the output.\n */\n/* legacy: obj, showHidden, depth, colors*/\nfunction inspect(obj, opts) {\n  // default options\n  var ctx = {\n    seen: [],\n    stylize: stylizeNoColor\n  };\n  // legacy...\n  if (arguments.length >= 3) ctx.depth = arguments[2];\n  if (arguments.length >= 4) ctx.colors = arguments[3];\n  if (isBoolean(opts)) {\n    // legacy...\n    ctx.showHidden = opts;\n  } else if (opts) {\n    // got an \"options\" object\n    exports._extend(ctx, opts);\n  }\n  // set default options\n  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n  if (isUndefined(ctx.depth)) ctx.depth = 2;\n  if (isUndefined(ctx.colors)) ctx.colors = false;\n  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n  if (ctx.colors) ctx.stylize = stylizeWithColor;\n  return formatValue(ctx, obj, ctx.depth);\n}\nexports.inspect = inspect;\n\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\ninspect.colors = {\n  'bold' : [1, 22],\n  'italic' : [3, 23],\n  'underline' : [4, 24],\n  'inverse' : [7, 27],\n  'white' : [37, 39],\n  'grey' : [90, 39],\n  'black' : [30, 39],\n  'blue' : [34, 39],\n  'cyan' : [36, 39],\n  'green' : [32, 39],\n  'magenta' : [35, 39],\n  'red' : [31, 39],\n  'yellow' : [33, 39]\n};\n\n// Don't use 'blue' not visible on cmd.exe\ninspect.styles = {\n  'special': 'cyan',\n  'number': 'yellow',\n  'boolean': 'yellow',\n  'undefined': 'grey',\n  'null': 'bold',\n  'string': 'green',\n  'date': 'magenta',\n  // \"name\": intentionally not styling\n  'regexp': 'red'\n};\n\n\nfunction stylizeWithColor(str, styleType) {\n  var style = inspect.styles[styleType];\n\n  if (style) {\n    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n           '\\u001b[' + inspect.colors[style][1] + 'm';\n  } else {\n    return str;\n  }\n}\n\n\nfunction stylizeNoColor(str, styleType) {\n  return str;\n}\n\n\nfunction arrayToHash(array) {\n  var hash = {};\n\n  array.forEach(function(val, idx) {\n    hash[val] = true;\n  });\n\n  return hash;\n}\n\n\nfunction formatValue(ctx, value, recurseTimes) {\n  // Provide a hook for user-specified inspect functions.\n  // Check that value is an object with an inspect function on it\n  if (ctx.customInspect &&\n      value &&\n      isFunction(value.inspect) &&\n      // Filter out the util module, it's inspect function is special\n      value.inspect !== exports.inspect &&\n      // Also filter out any prototype objects using the circular check.\n      !(value.constructor && value.constructor.prototype === value)) {\n    var ret = value.inspect(recurseTimes, ctx);\n    if (!isString(ret)) {\n      ret = formatValue(ctx, ret, recurseTimes);\n    }\n    return ret;\n  }\n\n  // Primitive types cannot have properties\n  var primitive = formatPrimitive(ctx, value);\n  if (primitive) {\n    return primitive;\n  }\n\n  // Look up the keys of the object.\n  var keys = Object.keys(value);\n  var visibleKeys = arrayToHash(keys);\n\n  if (ctx.showHidden) {\n    keys = Object.getOwnPropertyNames(value);\n  }\n\n  // IE doesn't make error fields non-enumerable\n  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n  if (isError(value)\n      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n    return formatError(value);\n  }\n\n  // Some type of object without properties can be shortcutted.\n  if (keys.length === 0) {\n    if (isFunction(value)) {\n      var name = value.name ? ': ' + value.name : '';\n      return ctx.stylize('[Function' + name + ']', 'special');\n    }\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    }\n    if (isDate(value)) {\n      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n    }\n    if (isError(value)) {\n      return formatError(value);\n    }\n  }\n\n  var base = '', array = false, braces = ['{', '}'];\n\n  // Make Array say that they are Array\n  if (isArray(value)) {\n    array = true;\n    braces = ['[', ']'];\n  }\n\n  // Make functions say that they are functions\n  if (isFunction(value)) {\n    var n = value.name ? ': ' + value.name : '';\n    base = ' [Function' + n + ']';\n  }\n\n  // Make RegExps say that they are RegExps\n  if (isRegExp(value)) {\n    base = ' ' + RegExp.prototype.toString.call(value);\n  }\n\n  // Make dates with properties first say the date\n  if (isDate(value)) {\n    base = ' ' + Date.prototype.toUTCString.call(value);\n  }\n\n  // Make error with message first say the error\n  if (isError(value)) {\n    base = ' ' + formatError(value);\n  }\n\n  if (keys.length === 0 && (!array || value.length == 0)) {\n    return braces[0] + base + braces[1];\n  }\n\n  if (recurseTimes < 0) {\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    } else {\n      return ctx.stylize('[Object]', 'special');\n    }\n  }\n\n  ctx.seen.push(value);\n\n  var output;\n  if (array) {\n    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n  } else {\n    output = keys.map(function(key) {\n      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n    });\n  }\n\n  ctx.seen.pop();\n\n  return reduceToSingleString(output, base, braces);\n}\n\n\nfunction formatPrimitive(ctx, value) {\n  if (isUndefined(value))\n    return ctx.stylize('undefined', 'undefined');\n  if (isString(value)) {\n    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n                                             .replace(/'/g, \"\\\\'\")\n                                             .replace(/\\\\\"/g, '\"') + '\\'';\n    return ctx.stylize(simple, 'string');\n  }\n  if (isNumber(value))\n    return ctx.stylize('' + value, 'number');\n  if (isBoolean(value))\n    return ctx.stylize('' + value, 'boolean');\n  // For some reason typeof null is \"object\", so special case here.\n  if (isNull(value))\n    return ctx.stylize('null', 'null');\n}\n\n\nfunction formatError(value) {\n  return '[' + Error.prototype.toString.call(value) + ']';\n}\n\n\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n  var output = [];\n  for (var i = 0, l = value.length; i < l; ++i) {\n    if (hasOwnProperty(value, String(i))) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          String(i), true));\n    } else {\n      output.push('');\n    }\n  }\n  keys.forEach(function(key) {\n    if (!key.match(/^\\d+$/)) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          key, true));\n    }\n  });\n  return output;\n}\n\n\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n  var name, str, desc;\n  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n  if (desc.get) {\n    if (desc.set) {\n      str = ctx.stylize('[Getter/Setter]', 'special');\n    } else {\n      str = ctx.stylize('[Getter]', 'special');\n    }\n  } else {\n    if (desc.set) {\n      str = ctx.stylize('[Setter]', 'special');\n    }\n  }\n  if (!hasOwnProperty(visibleKeys, key)) {\n    name = '[' + key + ']';\n  }\n  if (!str) {\n    if (ctx.seen.indexOf(desc.value) < 0) {\n      if (isNull(recurseTimes)) {\n        str = formatValue(ctx, desc.value, null);\n      } else {\n        str = formatValue(ctx, desc.value, recurseTimes - 1);\n      }\n      if (str.indexOf('\\n') > -1) {\n        if (array) {\n          str = str.split('\\n').map(function(line) {\n            return '  ' + line;\n          }).join('\\n').substr(2);\n        } else {\n          str = '\\n' + str.split('\\n').map(function(line) {\n            return '   ' + line;\n          }).join('\\n');\n        }\n      }\n    } else {\n      str = ctx.stylize('[Circular]', 'special');\n    }\n  }\n  if (isUndefined(name)) {\n    if (array && key.match(/^\\d+$/)) {\n      return str;\n    }\n    name = JSON.stringify('' + key);\n    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n      name = name.substr(1, name.length - 2);\n      name = ctx.stylize(name, 'name');\n    } else {\n      name = name.replace(/'/g, \"\\\\'\")\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/(^\"|\"$)/g, \"'\");\n      name = ctx.stylize(name, 'string');\n    }\n  }\n\n  return name + ': ' + str;\n}\n\n\nfunction reduceToSingleString(output, base, braces) {\n  var numLinesEst = 0;\n  var length = output.reduce(function(prev, cur) {\n    numLinesEst++;\n    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n  }, 0);\n\n  if (length > 60) {\n    return braces[0] +\n           (base === '' ? '' : base + '\\n ') +\n           ' ' +\n           output.join(',\\n  ') +\n           ' ' +\n           braces[1];\n  }\n\n  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n}\n\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = require('./support/isBuffer');\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n\n\nfunction pad(n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n}\n\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n              'Oct', 'Nov', 'Dec'];\n\n// 26 Feb 16:19:34\nfunction timestamp() {\n  var d = new Date();\n  var time = [pad(d.getHours()),\n              pad(d.getMinutes()),\n              pad(d.getSeconds())].join(':');\n  return [d.getDate(), months[d.getMonth()], time].join(' ');\n}\n\n\n// log is just a thin wrapper to console.log that prepends a timestamp\nexports.log = function() {\n  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * The Function.prototype.inherits from lang.js rewritten as a standalone\n * function (not on Function.prototype). NOTE: If this file is to be loaded\n * during bootstrapping this function needs to be rewritten using some native\n * functions as prototype setup using normal JavaScript does not work as\n * expected during bootstrapping (see mirror.js in r114903).\n *\n * @param {function} ctor Constructor function which needs to inherit the\n *     prototype.\n * @param {function} superCtor Constructor function to inherit prototype from.\n */\nexports.inherits = require('inherits');\n\nexports._extend = function(origin, add) {\n  // Don't do anything if add isn't an object\n  if (!add || !isObject(add)) return origin;\n\n  var keys = Object.keys(add);\n  var i = keys.length;\n  while (i--) {\n    origin[keys[i]] = add[keys[i]];\n  }\n  return origin;\n};\n\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n",
    "// Released under MIT license\n// Copyright (c) 2009-2010 Dominic Baggott\n// Copyright (c) 2009-2010 Ash Berlin\n// Copyright (c) 2011 Christoph Dorn <christoph@christophdorn.com> (http://www.christophdorn.com)\n\n/*jshint browser:true, devel:true */\n\n(function( expose ) {\n\n/**\n *  class Markdown\n *\n *  Markdown processing in Javascript done right. We have very particular views\n *  on what constitutes 'right' which include:\n *\n *  - produces well-formed HTML (this means that em and strong nesting is\n *    important)\n *\n *  - has an intermediate representation to allow processing of parsed data (We\n *    in fact have two, both as [JsonML]: a markdown tree and an HTML tree).\n *\n *  - is easily extensible to add new dialects without having to rewrite the\n *    entire parsing mechanics\n *\n *  - has a good test suite\n *\n *  This implementation fulfills all of these (except that the test suite could\n *  do with expanding to automatically run all the fixtures from other Markdown\n *  implementations.)\n *\n *  ##### Intermediate Representation\n *\n *  *TODO* Talk about this :) Its JsonML, but document the node names we use.\n *\n *  [JsonML]: http://jsonml.org/ \"JSON Markup Language\"\n **/\nvar Markdown = expose.Markdown = function(dialect) {\n  switch (typeof dialect) {\n    case \"undefined\":\n      this.dialect = Markdown.dialects.Gruber;\n      break;\n    case \"object\":\n      this.dialect = dialect;\n      break;\n    default:\n      if ( dialect in Markdown.dialects ) {\n        this.dialect = Markdown.dialects[dialect];\n      }\n      else {\n        throw new Error(\"Unknown Markdown dialect '\" + String(dialect) + \"'\");\n      }\n      break;\n  }\n  this.em_state = [];\n  this.strong_state = [];\n  this.debug_indent = \"\";\n};\n\n/**\n *  parse( markdown, [dialect] ) -> JsonML\n *  - markdown (String): markdown string to parse\n *  - dialect (String | Dialect): the dialect to use, defaults to gruber\n *\n *  Parse `markdown` and return a markdown document as a Markdown.JsonML tree.\n **/\nexpose.parse = function( source, dialect ) {\n  // dialect will default if undefined\n  var md = new Markdown( dialect );\n  return md.toTree( source );\n};\n\n/**\n *  toHTML( markdown, [dialect]  ) -> String\n *  toHTML( md_tree ) -> String\n *  - markdown (String): markdown string to parse\n *  - md_tree (Markdown.JsonML): parsed markdown tree\n *\n *  Take markdown (either as a string or as a JsonML tree) and run it through\n *  [[toHTMLTree]] then turn it into a well-formated HTML fragment.\n **/\nexpose.toHTML = function toHTML( source , dialect , options ) {\n  var input = expose.toHTMLTree( source , dialect , options );\n\n  return expose.renderJsonML( input );\n};\n\n/**\n *  toHTMLTree( markdown, [dialect] ) -> JsonML\n *  toHTMLTree( md_tree ) -> JsonML\n *  - markdown (String): markdown string to parse\n *  - dialect (String | Dialect): the dialect to use, defaults to gruber\n *  - md_tree (Markdown.JsonML): parsed markdown tree\n *\n *  Turn markdown into HTML, represented as a JsonML tree. If a string is given\n *  to this function, it is first parsed into a markdown tree by calling\n *  [[parse]].\n **/\nexpose.toHTMLTree = function toHTMLTree( input, dialect , options ) {\n  // convert string input to an MD tree\n  if ( typeof input ===\"string\" ) input = this.parse( input, dialect );\n\n  // Now convert the MD tree to an HTML tree\n\n  // remove references from the tree\n  var attrs = extract_attr( input ),\n      refs = {};\n\n  if ( attrs && attrs.references ) {\n    refs = attrs.references;\n  }\n\n  var html = convert_tree_to_html( input, refs , options );\n  merge_text_nodes( html );\n  return html;\n};\n\n// For Spidermonkey based engines\nfunction mk_block_toSource() {\n  return \"Markdown.mk_block( \" +\n          uneval(this.toString()) +\n          \", \" +\n          uneval(this.trailing) +\n          \", \" +\n          uneval(this.lineNumber) +\n          \" )\";\n}\n\n// node\nfunction mk_block_inspect() {\n  var util = require(\"util\");\n  return \"Markdown.mk_block( \" +\n          util.inspect(this.toString()) +\n          \", \" +\n          util.inspect(this.trailing) +\n          \", \" +\n          util.inspect(this.lineNumber) +\n          \" )\";\n\n}\n\nvar mk_block = Markdown.mk_block = function(block, trail, line) {\n  // Be helpful for default case in tests.\n  if ( arguments.length == 1 ) trail = \"\\n\\n\";\n\n  var s = new String(block);\n  s.trailing = trail;\n  // To make it clear its not just a string\n  s.inspect = mk_block_inspect;\n  s.toSource = mk_block_toSource;\n\n  if ( line != undefined )\n    s.lineNumber = line;\n\n  return s;\n};\n\nfunction count_lines( str ) {\n  var n = 0, i = -1;\n  while ( ( i = str.indexOf(\"\\n\", i + 1) ) !== -1 ) n++;\n  return n;\n}\n\n// Internal - split source into rough blocks\nMarkdown.prototype.split_blocks = function splitBlocks( input, startLine ) {\n  input = input.replace(/(\\r\\n|\\n|\\r)/g, \"\\n\");\n  // [\\s\\S] matches _anything_ (newline or space)\n  // [^] is equivalent but doesn't work in IEs.\n  var re = /([\\s\\S]+?)($|\\n#|\\n(?:\\s*\\n|$)+)/g,\n      blocks = [],\n      m;\n\n  var line_no = 1;\n\n  if ( ( m = /^(\\s*\\n)/.exec(input) ) != null ) {\n    // skip (but count) leading blank lines\n    line_no += count_lines( m[0] );\n    re.lastIndex = m[0].length;\n  }\n\n  while ( ( m = re.exec(input) ) !== null ) {\n    if (m[2] == \"\\n#\") {\n      m[2] = \"\\n\";\n      re.lastIndex--;\n    }\n    blocks.push( mk_block( m[1], m[2], line_no ) );\n    line_no += count_lines( m[0] );\n  }\n\n  return blocks;\n};\n\n/**\n *  Markdown#processBlock( block, next ) -> undefined | [ JsonML, ... ]\n *  - block (String): the block to process\n *  - next (Array): the following blocks\n *\n * Process `block` and return an array of JsonML nodes representing `block`.\n *\n * It does this by asking each block level function in the dialect to process\n * the block until one can. Succesful handling is indicated by returning an\n * array (with zero or more JsonML nodes), failure by a false value.\n *\n * Blocks handlers are responsible for calling [[Markdown#processInline]]\n * themselves as appropriate.\n *\n * If the blocks were split incorrectly or adjacent blocks need collapsing you\n * can adjust `next` in place using shift/splice etc.\n *\n * If any of this default behaviour is not right for the dialect, you can\n * define a `__call__` method on the dialect that will get invoked to handle\n * the block processing.\n */\nMarkdown.prototype.processBlock = function processBlock( block, next ) {\n  var cbs = this.dialect.block,\n      ord = cbs.__order__;\n\n  if ( \"__call__\" in cbs ) {\n    return cbs.__call__.call(this, block, next);\n  }\n\n  for ( var i = 0; i < ord.length; i++ ) {\n    //D:this.debug( \"Testing\", ord[i] );\n    var res = cbs[ ord[i] ].call( this, block, next );\n    if ( res ) {\n      //D:this.debug(\"  matched\");\n      if ( !isArray(res) || ( res.length > 0 && !( isArray(res[0]) ) ) )\n        this.debug(ord[i], \"didn't return a proper array\");\n      //D:this.debug( \"\" );\n      return res;\n    }\n  }\n\n  // Uhoh! no match! Should we throw an error?\n  return [];\n};\n\nMarkdown.prototype.processInline = function processInline( block ) {\n  return this.dialect.inline.__call__.call( this, String( block ) );\n};\n\n/**\n *  Markdown#toTree( source ) -> JsonML\n *  - source (String): markdown source to parse\n *\n *  Parse `source` into a JsonML tree representing the markdown document.\n **/\n// custom_tree means set this.tree to `custom_tree` and restore old value on return\nMarkdown.prototype.toTree = function toTree( source, custom_root ) {\n  var blocks = source instanceof Array ? source : this.split_blocks( source );\n\n  // Make tree a member variable so its easier to mess with in extensions\n  var old_tree = this.tree;\n  try {\n    this.tree = custom_root || this.tree || [ \"markdown\" ];\n\n    blocks:\n    while ( blocks.length ) {\n      var b = this.processBlock( blocks.shift(), blocks );\n\n      // Reference blocks and the like won't return any content\n      if ( !b.length ) continue blocks;\n\n      this.tree.push.apply( this.tree, b );\n    }\n    return this.tree;\n  }\n  finally {\n    if ( custom_root ) {\n      this.tree = old_tree;\n    }\n  }\n};\n\n// Noop by default\nMarkdown.prototype.debug = function () {\n  var args = Array.prototype.slice.call( arguments);\n  args.unshift(this.debug_indent);\n  if ( typeof print !== \"undefined\" )\n      print.apply( print, args );\n  if ( typeof console !== \"undefined\" && typeof console.log !== \"undefined\" )\n      console.log.apply( null, args );\n}\n\nMarkdown.prototype.loop_re_over_block = function( re, block, cb ) {\n  // Dont use /g regexps with this\n  var m,\n      b = block.valueOf();\n\n  while ( b.length && (m = re.exec(b) ) != null ) {\n    b = b.substr( m[0].length );\n    cb.call(this, m);\n  }\n  return b;\n};\n\n/**\n * Markdown.dialects\n *\n * Namespace of built-in dialects.\n **/\nMarkdown.dialects = {};\n\n/**\n * Markdown.dialects.Gruber\n *\n * The default dialect that follows the rules set out by John Gruber's\n * markdown.pl as closely as possible. Well actually we follow the behaviour of\n * that script which in some places is not exactly what the syntax web page\n * says.\n **/\nMarkdown.dialects.Gruber = {\n  block: {\n    atxHeader: function atxHeader( block, next ) {\n      var m = block.match( /^(#{1,6})\\s*(.*?)\\s*#*\\s*(?:\\n|$)/ );\n\n      if ( !m ) return undefined;\n\n      var header = [ \"header\", { level: m[ 1 ].length } ];\n      Array.prototype.push.apply(header, this.processInline(m[ 2 ]));\n\n      if ( m[0].length < block.length )\n        next.unshift( mk_block( block.substr( m[0].length ), block.trailing, block.lineNumber + 2 ) );\n\n      return [ header ];\n    },\n\n    setextHeader: function setextHeader( block, next ) {\n      var m = block.match( /^(.*)\\n([-=])\\2\\2+(?:\\n|$)/ );\n\n      if ( !m ) return undefined;\n\n      var level = ( m[ 2 ] === \"=\" ) ? 1 : 2;\n      var header = [ \"header\", { level : level }, m[ 1 ] ];\n\n      if ( m[0].length < block.length )\n        next.unshift( mk_block( block.substr( m[0].length ), block.trailing, block.lineNumber + 2 ) );\n\n      return [ header ];\n    },\n\n    code: function code( block, next ) {\n      // |    Foo\n      // |bar\n      // should be a code block followed by a paragraph. Fun\n      //\n      // There might also be adjacent code block to merge.\n\n      var ret = [],\n          re = /^(?: {0,3}\\t| {4})(.*)\\n?/,\n          lines;\n\n      // 4 spaces + content\n      if ( !block.match( re ) ) return undefined;\n\n      block_search:\n      do {\n        // Now pull out the rest of the lines\n        var b = this.loop_re_over_block(\n                  re, block.valueOf(), function( m ) { ret.push( m[1] ); } );\n\n        if ( b.length ) {\n          // Case alluded to in first comment. push it back on as a new block\n          next.unshift( mk_block(b, block.trailing) );\n          break block_search;\n        }\n        else if ( next.length ) {\n          // Check the next block - it might be code too\n          if ( !next[0].match( re ) ) break block_search;\n\n          // Pull how how many blanks lines follow - minus two to account for .join\n          ret.push ( block.trailing.replace(/[^\\n]/g, \"\").substring(2) );\n\n          block = next.shift();\n        }\n        else {\n          break block_search;\n        }\n      } while ( true );\n\n      return [ [ \"code_block\", ret.join(\"\\n\") ] ];\n    },\n\n    horizRule: function horizRule( block, next ) {\n      // this needs to find any hr in the block to handle abutting blocks\n      var m = block.match( /^(?:([\\s\\S]*?)\\n)?[ \\t]*([-_*])(?:[ \\t]*\\2){2,}[ \\t]*(?:\\n([\\s\\S]*))?$/ );\n\n      if ( !m ) {\n        return undefined;\n      }\n\n      var jsonml = [ [ \"hr\" ] ];\n\n      // if there's a leading abutting block, process it\n      if ( m[ 1 ] ) {\n        jsonml.unshift.apply( jsonml, this.processBlock( m[ 1 ], [] ) );\n      }\n\n      // if there's a trailing abutting block, stick it into next\n      if ( m[ 3 ] ) {\n        next.unshift( mk_block( m[ 3 ] ) );\n      }\n\n      return jsonml;\n    },\n\n    // There are two types of lists. Tight and loose. Tight lists have no whitespace\n    // between the items (and result in text just in the <li>) and loose lists,\n    // which have an empty line between list items, resulting in (one or more)\n    // paragraphs inside the <li>.\n    //\n    // There are all sorts weird edge cases about the original markdown.pl's\n    // handling of lists:\n    //\n    // * Nested lists are supposed to be indented by four chars per level. But\n    //   if they aren't, you can get a nested list by indenting by less than\n    //   four so long as the indent doesn't match an indent of an existing list\n    //   item in the 'nest stack'.\n    //\n    // * The type of the list (bullet or number) is controlled just by the\n    //    first item at the indent. Subsequent changes are ignored unless they\n    //    are for nested lists\n    //\n    lists: (function( ) {\n      // Use a closure to hide a few variables.\n      var any_list = \"[*+-]|\\\\d+\\\\.\",\n          bullet_list = /[*+-]/,\n          number_list = /\\d+\\./,\n          // Capture leading indent as it matters for determining nested lists.\n          is_list_re = new RegExp( \"^( {0,3})(\" + any_list + \")[ \\t]+\" ),\n          indent_re = \"(?: {0,3}\\\\t| {4})\";\n\n      // TODO: Cache this regexp for certain depths.\n      // Create a regexp suitable for matching an li for a given stack depth\n      function regex_for_depth( depth ) {\n\n        return new RegExp(\n          // m[1] = indent, m[2] = list_type\n          \"(?:^(\" + indent_re + \"{0,\" + depth + \"} {0,3})(\" + any_list + \")\\\\s+)|\" +\n          // m[3] = cont\n          \"(^\" + indent_re + \"{0,\" + (depth-1) + \"}[ ]{0,4})\"\n        );\n      }\n      function expand_tab( input ) {\n        return input.replace( / {0,3}\\t/g, \"    \" );\n      }\n\n      // Add inline content `inline` to `li`. inline comes from processInline\n      // so is an array of content\n      function add(li, loose, inline, nl) {\n        if ( loose ) {\n          li.push( [ \"para\" ].concat(inline) );\n          return;\n        }\n        // Hmmm, should this be any block level element or just paras?\n        var add_to = li[li.length -1] instanceof Array && li[li.length - 1][0] == \"para\"\n                   ? li[li.length -1]\n                   : li;\n\n        // If there is already some content in this list, add the new line in\n        if ( nl && li.length > 1 ) inline.unshift(nl);\n\n        for ( var i = 0; i < inline.length; i++ ) {\n          var what = inline[i],\n              is_str = typeof what == \"string\";\n          if ( is_str && add_to.length > 1 && typeof add_to[add_to.length-1] == \"string\" ) {\n            add_to[ add_to.length-1 ] += what;\n          }\n          else {\n            add_to.push( what );\n          }\n        }\n      }\n\n      // contained means have an indent greater than the current one. On\n      // *every* line in the block\n      function get_contained_blocks( depth, blocks ) {\n\n        var re = new RegExp( \"^(\" + indent_re + \"{\" + depth + \"}.*?\\\\n?)*$\" ),\n            replace = new RegExp(\"^\" + indent_re + \"{\" + depth + \"}\", \"gm\"),\n            ret = [];\n\n        while ( blocks.length > 0 ) {\n          if ( re.exec( blocks[0] ) ) {\n            var b = blocks.shift(),\n                // Now remove that indent\n                x = b.replace( replace, \"\");\n\n            ret.push( mk_block( x, b.trailing, b.lineNumber ) );\n          }\n          else {\n            break;\n          }\n        }\n        return ret;\n      }\n\n      // passed to stack.forEach to turn list items up the stack into paras\n      function paragraphify(s, i, stack) {\n        var list = s.list;\n        var last_li = list[list.length-1];\n\n        if ( last_li[1] instanceof Array && last_li[1][0] == \"para\" ) {\n          return;\n        }\n        if ( i + 1 == stack.length ) {\n          // Last stack frame\n          // Keep the same array, but replace the contents\n          last_li.push( [\"para\"].concat( last_li.splice(1, last_li.length - 1) ) );\n        }\n        else {\n          var sublist = last_li.pop();\n          last_li.push( [\"para\"].concat( last_li.splice(1, last_li.length - 1) ), sublist );\n        }\n      }\n\n      // The matcher function\n      return function( block, next ) {\n        var m = block.match( is_list_re );\n        if ( !m ) return undefined;\n\n        function make_list( m ) {\n          var list = bullet_list.exec( m[2] )\n                   ? [\"bulletlist\"]\n                   : [\"numberlist\"];\n\n          stack.push( { list: list, indent: m[1] } );\n          return list;\n        }\n\n\n        var stack = [], // Stack of lists for nesting.\n            list = make_list( m ),\n            last_li,\n            loose = false,\n            ret = [ stack[0].list ],\n            i;\n\n        // Loop to search over block looking for inner block elements and loose lists\n        loose_search:\n        while ( true ) {\n          // Split into lines preserving new lines at end of line\n          var lines = block.split( /(?=\\n)/ );\n\n          // We have to grab all lines for a li and call processInline on them\n          // once as there are some inline things that can span lines.\n          var li_accumulate = \"\";\n\n          // Loop over the lines in this block looking for tight lists.\n          tight_search:\n          for ( var line_no = 0; line_no < lines.length; line_no++ ) {\n            var nl = \"\",\n                l = lines[line_no].replace(/^\\n/, function(n) { nl = n; return \"\"; });\n\n            // TODO: really should cache this\n            var line_re = regex_for_depth( stack.length );\n\n            m = l.match( line_re );\n            //print( \"line:\", uneval(l), \"\\nline match:\", uneval(m) );\n\n            // We have a list item\n            if ( m[1] !== undefined ) {\n              // Process the previous list item, if any\n              if ( li_accumulate.length ) {\n                add( last_li, loose, this.processInline( li_accumulate ), nl );\n                // Loose mode will have been dealt with. Reset it\n                loose = false;\n                li_accumulate = \"\";\n              }\n\n              m[1] = expand_tab( m[1] );\n              var wanted_depth = Math.floor(m[1].length/4)+1;\n              //print( \"want:\", wanted_depth, \"stack:\", stack.length);\n              if ( wanted_depth > stack.length ) {\n                // Deep enough for a nested list outright\n                //print ( \"new nested list\" );\n                list = make_list( m );\n                last_li.push( list );\n                last_li = list[1] = [ \"listitem\" ];\n              }\n              else {\n                // We aren't deep enough to be strictly a new level. This is\n                // where Md.pl goes nuts. If the indent matches a level in the\n                // stack, put it there, else put it one deeper then the\n                // wanted_depth deserves.\n                var found = false;\n                for ( i = 0; i < stack.length; i++ ) {\n                  if ( stack[ i ].indent != m[1] ) continue;\n                  list = stack[ i ].list;\n                  stack.splice( i+1, stack.length - (i+1) );\n                  found = true;\n                  break;\n                }\n\n                if (!found) {\n                  //print(\"not found. l:\", uneval(l));\n                  wanted_depth++;\n                  if ( wanted_depth <= stack.length ) {\n                    stack.splice(wanted_depth, stack.length - wanted_depth);\n                    //print(\"Desired depth now\", wanted_depth, \"stack:\", stack.length);\n                    list = stack[wanted_depth-1].list;\n                    //print(\"list:\", uneval(list) );\n                  }\n                  else {\n                    //print (\"made new stack for messy indent\");\n                    list = make_list(m);\n                    last_li.push(list);\n                  }\n                }\n\n                //print( uneval(list), \"last\", list === stack[stack.length-1].list );\n                last_li = [ \"listitem\" ];\n                list.push(last_li);\n              } // end depth of shenegains\n              nl = \"\";\n            }\n\n            // Add content\n            if ( l.length > m[0].length ) {\n              li_accumulate += nl + l.substr( m[0].length );\n            }\n          } // tight_search\n\n          if ( li_accumulate.length ) {\n            add( last_li, loose, this.processInline( li_accumulate ), nl );\n            // Loose mode will have been dealt with. Reset it\n            loose = false;\n            li_accumulate = \"\";\n          }\n\n          // Look at the next block - we might have a loose list. Or an extra\n          // paragraph for the current li\n          var contained = get_contained_blocks( stack.length, next );\n\n          // Deal with code blocks or properly nested lists\n          if ( contained.length > 0 ) {\n            // Make sure all listitems up the stack are paragraphs\n            forEach( stack, paragraphify, this);\n\n            last_li.push.apply( last_li, this.toTree( contained, [] ) );\n          }\n\n          var next_block = next[0] && next[0].valueOf() || \"\";\n\n          if ( next_block.match(is_list_re) || next_block.match( /^ / ) ) {\n            block = next.shift();\n\n            // Check for an HR following a list: features/lists/hr_abutting\n            var hr = this.dialect.block.horizRule( block, next );\n\n            if ( hr ) {\n              ret.push.apply(ret, hr);\n              break;\n            }\n\n            // Make sure all listitems up the stack are paragraphs\n            forEach( stack, paragraphify, this);\n\n            loose = true;\n            continue loose_search;\n          }\n          break;\n        } // loose_search\n\n        return ret;\n      };\n    })(),\n\n    blockquote: function blockquote( block, next ) {\n      if ( !block.match( /^>/m ) )\n        return undefined;\n\n      var jsonml = [];\n\n      // separate out the leading abutting block, if any. I.e. in this case:\n      //\n      //  a\n      //  > b\n      //\n      if ( block[ 0 ] != \">\" ) {\n        var lines = block.split( /\\n/ ),\n            prev = [],\n            line_no = block.lineNumber;\n\n        // keep shifting lines until you find a crotchet\n        while ( lines.length && lines[ 0 ][ 0 ] != \">\" ) {\n            prev.push( lines.shift() );\n            line_no++;\n        }\n\n        var abutting = mk_block( prev.join( \"\\n\" ), \"\\n\", block.lineNumber );\n        jsonml.push.apply( jsonml, this.processBlock( abutting, [] ) );\n        // reassemble new block of just block quotes!\n        block = mk_block( lines.join( \"\\n\" ), block.trailing, line_no );\n      }\n\n\n      // if the next block is also a blockquote merge it in\n      while ( next.length && next[ 0 ][ 0 ] == \">\" ) {\n        var b = next.shift();\n        block = mk_block( block + block.trailing + b, b.trailing, block.lineNumber );\n      }\n\n      // Strip off the leading \"> \" and re-process as a block.\n      var input = block.replace( /^> ?/gm, \"\" ),\n          old_tree = this.tree,\n          processedBlock = this.toTree( input, [ \"blockquote\" ] ),\n          attr = extract_attr( processedBlock );\n\n      // If any link references were found get rid of them\n      if ( attr && attr.references ) {\n        delete attr.references;\n        // And then remove the attribute object if it's empty\n        if ( isEmpty( attr ) ) {\n          processedBlock.splice( 1, 1 );\n        }\n      }\n\n      jsonml.push( processedBlock );\n      return jsonml;\n    },\n\n    referenceDefn: function referenceDefn( block, next) {\n      var re = /^\\s*\\[(.*?)\\]:\\s*(\\S+)(?:\\s+(?:(['\"])(.*?)\\3|\\((.*?)\\)))?\\n?/;\n      // interesting matches are [ , ref_id, url, , title, title ]\n\n      if ( !block.match(re) )\n        return undefined;\n\n      // make an attribute node if it doesn't exist\n      if ( !extract_attr( this.tree ) ) {\n        this.tree.splice( 1, 0, {} );\n      }\n\n      var attrs = extract_attr( this.tree );\n\n      // make a references hash if it doesn't exist\n      if ( attrs.references === undefined ) {\n        attrs.references = {};\n      }\n\n      var b = this.loop_re_over_block(re, block, function( m ) {\n\n        if ( m[2] && m[2][0] == \"<\" && m[2][m[2].length-1] == \">\" )\n          m[2] = m[2].substring( 1, m[2].length - 1 );\n\n        var ref = attrs.references[ m[1].toLowerCase() ] = {\n          href: m[2]\n        };\n\n        if ( m[4] !== undefined )\n          ref.title = m[4];\n        else if ( m[5] !== undefined )\n          ref.title = m[5];\n\n      } );\n\n      if ( b.length )\n        next.unshift( mk_block( b, block.trailing ) );\n\n      return [];\n    },\n\n    para: function para( block, next ) {\n      // everything's a para!\n      return [ [\"para\"].concat( this.processInline( block ) ) ];\n    }\n  }\n};\n\nMarkdown.dialects.Gruber.inline = {\n\n    __oneElement__: function oneElement( text, patterns_or_re, previous_nodes ) {\n      var m,\n          res,\n          lastIndex = 0;\n\n      patterns_or_re = patterns_or_re || this.dialect.inline.__patterns__;\n      var re = new RegExp( \"([\\\\s\\\\S]*?)(\" + (patterns_or_re.source || patterns_or_re) + \")\" );\n\n      m = re.exec( text );\n      if (!m) {\n        // Just boring text\n        return [ text.length, text ];\n      }\n      else if ( m[1] ) {\n        // Some un-interesting text matched. Return that first\n        return [ m[1].length, m[1] ];\n      }\n\n      var res;\n      if ( m[2] in this.dialect.inline ) {\n        res = this.dialect.inline[ m[2] ].call(\n                  this,\n                  text.substr( m.index ), m, previous_nodes || [] );\n      }\n      // Default for now to make dev easier. just slurp special and output it.\n      res = res || [ m[2].length, m[2] ];\n      return res;\n    },\n\n    __call__: function inline( text, patterns ) {\n\n      var out = [],\n          res;\n\n      function add(x) {\n        //D:self.debug(\"  adding output\", uneval(x));\n        if ( typeof x == \"string\" && typeof out[out.length-1] == \"string\" )\n          out[ out.length-1 ] += x;\n        else\n          out.push(x);\n      }\n\n      while ( text.length > 0 ) {\n        res = this.dialect.inline.__oneElement__.call(this, text, patterns, out );\n        text = text.substr( res.shift() );\n        forEach(res, add )\n      }\n\n      return out;\n    },\n\n    // These characters are intersting elsewhere, so have rules for them so that\n    // chunks of plain text blocks don't include them\n    \"]\": function () {},\n    \"}\": function () {},\n\n    __escape__ : /^\\\\[\\\\`\\*_{}\\[\\]()#\\+.!\\-]/,\n\n    \"\\\\\": function escaped( text ) {\n      // [ length of input processed, node/children to add... ]\n      // Only esacape: \\ ` * _ { } [ ] ( ) # * + - . !\n      if ( this.dialect.inline.__escape__.exec( text ) )\n        return [ 2, text.charAt( 1 ) ];\n      else\n        // Not an esacpe\n        return [ 1, \"\\\\\" ];\n    },\n\n    \"![\": function image( text ) {\n\n      // Unlike images, alt text is plain text only. no other elements are\n      // allowed in there\n\n      // ![Alt text](/path/to/img.jpg \"Optional title\")\n      //      1          2            3       4         <--- captures\n      var m = text.match( /^!\\[(.*?)\\][ \\t]*\\([ \\t]*([^\")]*?)(?:[ \\t]+([\"'])(.*?)\\3)?[ \\t]*\\)/ );\n\n      if ( m ) {\n        if ( m[2] && m[2][0] == \"<\" && m[2][m[2].length-1] == \">\" )\n          m[2] = m[2].substring( 1, m[2].length - 1 );\n\n        m[2] = this.dialect.inline.__call__.call( this, m[2], /\\\\/ )[0];\n\n        var attrs = { alt: m[1], href: m[2] || \"\" };\n        if ( m[4] !== undefined)\n          attrs.title = m[4];\n\n        return [ m[0].length, [ \"img\", attrs ] ];\n      }\n\n      // ![Alt text][id]\n      m = text.match( /^!\\[(.*?)\\][ \\t]*\\[(.*?)\\]/ );\n\n      if ( m ) {\n        // We can't check if the reference is known here as it likely wont be\n        // found till after. Check it in md tree->hmtl tree conversion\n        return [ m[0].length, [ \"img_ref\", { alt: m[1], ref: m[2].toLowerCase(), original: m[0] } ] ];\n      }\n\n      // Just consume the '!['\n      return [ 2, \"![\" ];\n    },\n\n    \"[\": function link( text ) {\n\n      var orig = String(text);\n      // Inline content is possible inside `link text`\n      var res = Markdown.DialectHelpers.inline_until_char.call( this, text.substr(1), \"]\" );\n\n      // No closing ']' found. Just consume the [\n      if ( !res ) return [ 1, \"[\" ];\n\n      var consumed = 1 + res[ 0 ],\n          children = res[ 1 ],\n          link,\n          attrs;\n\n      // At this point the first [...] has been parsed. See what follows to find\n      // out which kind of link we are (reference or direct url)\n      text = text.substr( consumed );\n\n      // [link text](/path/to/img.jpg \"Optional title\")\n      //                 1            2       3         <--- captures\n      // This will capture up to the last paren in the block. We then pull\n      // back based on if there a matching ones in the url\n      //    ([here](/url/(test))\n      // The parens have to be balanced\n      var m = text.match( /^\\s*\\([ \\t]*([^\"']*)(?:[ \\t]+([\"'])(.*?)\\2)?[ \\t]*\\)/ );\n      if ( m ) {\n        var url = m[1];\n        consumed += m[0].length;\n\n        if ( url && url[0] == \"<\" && url[url.length-1] == \">\" )\n          url = url.substring( 1, url.length - 1 );\n\n        // If there is a title we don't have to worry about parens in the url\n        if ( !m[3] ) {\n          var open_parens = 1; // One open that isn't in the capture\n          for ( var len = 0; len < url.length; len++ ) {\n            switch ( url[len] ) {\n            case \"(\":\n              open_parens++;\n              break;\n            case \")\":\n              if ( --open_parens == 0) {\n                consumed -= url.length - len;\n                url = url.substring(0, len);\n              }\n              break;\n            }\n          }\n        }\n\n        // Process escapes only\n        url = this.dialect.inline.__call__.call( this, url, /\\\\/ )[0];\n\n        attrs = { href: url || \"\" };\n        if ( m[3] !== undefined)\n          attrs.title = m[3];\n\n        link = [ \"link\", attrs ].concat( children );\n        return [ consumed, link ];\n      }\n\n      // [Alt text][id]\n      // [Alt text] [id]\n      m = text.match( /^\\s*\\[(.*?)\\]/ );\n\n      if ( m ) {\n\n        consumed += m[ 0 ].length;\n\n        // [links][] uses links as its reference\n        attrs = { ref: ( m[ 1 ] || String(children) ).toLowerCase(),  original: orig.substr( 0, consumed ) };\n\n        link = [ \"link_ref\", attrs ].concat( children );\n\n        // We can't check if the reference is known here as it likely wont be\n        // found till after. Check it in md tree->hmtl tree conversion.\n        // Store the original so that conversion can revert if the ref isn't found.\n        return [ consumed, link ];\n      }\n\n      // [id]\n      // Only if id is plain (no formatting.)\n      if ( children.length == 1 && typeof children[0] == \"string\" ) {\n\n        attrs = { ref: children[0].toLowerCase(),  original: orig.substr( 0, consumed ) };\n        link = [ \"link_ref\", attrs, children[0] ];\n        return [ consumed, link ];\n      }\n\n      // Just consume the \"[\"\n      return [ 1, \"[\" ];\n    },\n\n\n    \"<\": function autoLink( text ) {\n      var m;\n\n      if ( ( m = text.match( /^<(?:((https?|ftp|mailto):[^>]+)|(.*?@.*?\\.[a-zA-Z]+))>/ ) ) != null ) {\n        if ( m[3] ) {\n          return [ m[0].length, [ \"link\", { href: \"mailto:\" + m[3] }, m[3] ] ];\n\n        }\n        else if ( m[2] == \"mailto\" ) {\n          return [ m[0].length, [ \"link\", { href: m[1] }, m[1].substr(\"mailto:\".length ) ] ];\n        }\n        else\n          return [ m[0].length, [ \"link\", { href: m[1] }, m[1] ] ];\n      }\n\n      return [ 1, \"<\" ];\n    },\n\n    \"`\": function inlineCode( text ) {\n      // Inline code block. as many backticks as you like to start it\n      // Always skip over the opening ticks.\n      var m = text.match( /(`+)(([\\s\\S]*?)\\1)/ );\n\n      if ( m && m[2] )\n        return [ m[1].length + m[2].length, [ \"inlinecode\", m[3] ] ];\n      else {\n        // TODO: No matching end code found - warn!\n        return [ 1, \"`\" ];\n      }\n    },\n\n    \"  \\n\": function lineBreak( text ) {\n      return [ 3, [ \"linebreak\" ] ];\n    }\n\n};\n\n// Meta Helper/generator method for em and strong handling\nfunction strong_em( tag, md ) {\n\n  var state_slot = tag + \"_state\",\n      other_slot = tag == \"strong\" ? \"em_state\" : \"strong_state\";\n\n  function CloseTag(len) {\n    this.len_after = len;\n    this.name = \"close_\" + md;\n  }\n\n  return function ( text, orig_match ) {\n\n    if ( this[state_slot][0] == md ) {\n      // Most recent em is of this type\n      //D:this.debug(\"closing\", md);\n      this[state_slot].shift();\n\n      // \"Consume\" everything to go back to the recrusion in the else-block below\n      return[ text.length, new CloseTag(text.length-md.length) ];\n    }\n    else {\n      // Store a clone of the em/strong states\n      var other = this[other_slot].slice(),\n          state = this[state_slot].slice();\n\n      this[state_slot].unshift(md);\n\n      //D:this.debug_indent += \"  \";\n\n      // Recurse\n      var res = this.processInline( text.substr( md.length ) );\n      //D:this.debug_indent = this.debug_indent.substr(2);\n\n      var last = res[res.length - 1];\n\n      //D:this.debug(\"processInline from\", tag + \": \", uneval( res ) );\n\n      var check = this[state_slot].shift();\n      if ( last instanceof CloseTag ) {\n        res.pop();\n        // We matched! Huzzah.\n        var consumed = text.length - last.len_after;\n        return [ consumed, [ tag ].concat(res) ];\n      }\n      else {\n        // Restore the state of the other kind. We might have mistakenly closed it.\n        this[other_slot] = other;\n        this[state_slot] = state;\n\n        // We can't reuse the processed result as it could have wrong parsing contexts in it.\n        return [ md.length, md ];\n      }\n    }\n  }; // End returned function\n}\n\nMarkdown.dialects.Gruber.inline[\"**\"] = strong_em(\"strong\", \"**\");\nMarkdown.dialects.Gruber.inline[\"__\"] = strong_em(\"strong\", \"__\");\nMarkdown.dialects.Gruber.inline[\"*\"]  = strong_em(\"em\", \"*\");\nMarkdown.dialects.Gruber.inline[\"_\"]  = strong_em(\"em\", \"_\");\n\n\n// Build default order from insertion order.\nMarkdown.buildBlockOrder = function(d) {\n  var ord = [];\n  for ( var i in d ) {\n    if ( i == \"__order__\" || i == \"__call__\" ) continue;\n    ord.push( i );\n  }\n  d.__order__ = ord;\n};\n\n// Build patterns for inline matcher\nMarkdown.buildInlinePatterns = function(d) {\n  var patterns = [];\n\n  for ( var i in d ) {\n    // __foo__ is reserved and not a pattern\n    if ( i.match( /^__.*__$/) ) continue;\n    var l = i.replace( /([\\\\.*+?|()\\[\\]{}])/g, \"\\\\$1\" )\n             .replace( /\\n/, \"\\\\n\" );\n    patterns.push( i.length == 1 ? l : \"(?:\" + l + \")\" );\n  }\n\n  patterns = patterns.join(\"|\");\n  d.__patterns__ = patterns;\n  //print(\"patterns:\", uneval( patterns ) );\n\n  var fn = d.__call__;\n  d.__call__ = function(text, pattern) {\n    if ( pattern != undefined ) {\n      return fn.call(this, text, pattern);\n    }\n    else\n    {\n      return fn.call(this, text, patterns);\n    }\n  };\n};\n\nMarkdown.DialectHelpers = {};\nMarkdown.DialectHelpers.inline_until_char = function( text, want ) {\n  var consumed = 0,\n      nodes = [];\n\n  while ( true ) {\n    if ( text.charAt( consumed ) == want ) {\n      // Found the character we were looking for\n      consumed++;\n      return [ consumed, nodes ];\n    }\n\n    if ( consumed >= text.length ) {\n      // No closing char found. Abort.\n      return null;\n    }\n\n    var res = this.dialect.inline.__oneElement__.call(this, text.substr( consumed ) );\n    consumed += res[ 0 ];\n    // Add any returned nodes.\n    nodes.push.apply( nodes, res.slice( 1 ) );\n  }\n}\n\n// Helper function to make sub-classing a dialect easier\nMarkdown.subclassDialect = function( d ) {\n  function Block() {}\n  Block.prototype = d.block;\n  function Inline() {}\n  Inline.prototype = d.inline;\n\n  return { block: new Block(), inline: new Inline() };\n};\n\nMarkdown.buildBlockOrder ( Markdown.dialects.Gruber.block );\nMarkdown.buildInlinePatterns( Markdown.dialects.Gruber.inline );\n\nMarkdown.dialects.Maruku = Markdown.subclassDialect( Markdown.dialects.Gruber );\n\nMarkdown.dialects.Maruku.processMetaHash = function processMetaHash( meta_string ) {\n  var meta = split_meta_hash( meta_string ),\n      attr = {};\n\n  for ( var i = 0; i < meta.length; ++i ) {\n    // id: #foo\n    if ( /^#/.test( meta[ i ] ) ) {\n      attr.id = meta[ i ].substring( 1 );\n    }\n    // class: .foo\n    else if ( /^\\./.test( meta[ i ] ) ) {\n      // if class already exists, append the new one\n      if ( attr[\"class\"] ) {\n        attr[\"class\"] = attr[\"class\"] + meta[ i ].replace( /./, \" \" );\n      }\n      else {\n        attr[\"class\"] = meta[ i ].substring( 1 );\n      }\n    }\n    // attribute: foo=bar\n    else if ( /\\=/.test( meta[ i ] ) ) {\n      var s = meta[ i ].split( /\\=/ );\n      attr[ s[ 0 ] ] = s[ 1 ];\n    }\n  }\n\n  return attr;\n}\n\nfunction split_meta_hash( meta_string ) {\n  var meta = meta_string.split( \"\" ),\n      parts = [ \"\" ],\n      in_quotes = false;\n\n  while ( meta.length ) {\n    var letter = meta.shift();\n    switch ( letter ) {\n      case \" \" :\n        // if we're in a quoted section, keep it\n        if ( in_quotes ) {\n          parts[ parts.length - 1 ] += letter;\n        }\n        // otherwise make a new part\n        else {\n          parts.push( \"\" );\n        }\n        break;\n      case \"'\" :\n      case '\"' :\n        // reverse the quotes and move straight on\n        in_quotes = !in_quotes;\n        break;\n      case \"\\\\\" :\n        // shift off the next letter to be used straight away.\n        // it was escaped so we'll keep it whatever it is\n        letter = meta.shift();\n      default :\n        parts[ parts.length - 1 ] += letter;\n        break;\n    }\n  }\n\n  return parts;\n}\n\nMarkdown.dialects.Maruku.block.document_meta = function document_meta( block, next ) {\n  // we're only interested in the first block\n  if ( block.lineNumber > 1 ) return undefined;\n\n  // document_meta blocks consist of one or more lines of `Key: Value\\n`\n  if ( ! block.match( /^(?:\\w+:.*\\n)*\\w+:.*$/ ) ) return undefined;\n\n  // make an attribute node if it doesn't exist\n  if ( !extract_attr( this.tree ) ) {\n    this.tree.splice( 1, 0, {} );\n  }\n\n  var pairs = block.split( /\\n/ );\n  for ( p in pairs ) {\n    var m = pairs[ p ].match( /(\\w+):\\s*(.*)$/ ),\n        key = m[ 1 ].toLowerCase(),\n        value = m[ 2 ];\n\n    this.tree[ 1 ][ key ] = value;\n  }\n\n  // document_meta produces no content!\n  return [];\n};\n\nMarkdown.dialects.Maruku.block.block_meta = function block_meta( block, next ) {\n  // check if the last line of the block is an meta hash\n  var m = block.match( /(^|\\n) {0,3}\\{:\\s*((?:\\\\\\}|[^\\}])*)\\s*\\}$/ );\n  if ( !m ) return undefined;\n\n  // process the meta hash\n  var attr = this.dialect.processMetaHash( m[ 2 ] );\n\n  var hash;\n\n  // if we matched ^ then we need to apply meta to the previous block\n  if ( m[ 1 ] === \"\" ) {\n    var node = this.tree[ this.tree.length - 1 ];\n    hash = extract_attr( node );\n\n    // if the node is a string (rather than JsonML), bail\n    if ( typeof node === \"string\" ) return undefined;\n\n    // create the attribute hash if it doesn't exist\n    if ( !hash ) {\n      hash = {};\n      node.splice( 1, 0, hash );\n    }\n\n    // add the attributes in\n    for ( a in attr ) {\n      hash[ a ] = attr[ a ];\n    }\n\n    // return nothing so the meta hash is removed\n    return [];\n  }\n\n  // pull the meta hash off the block and process what's left\n  var b = block.replace( /\\n.*$/, \"\" ),\n      result = this.processBlock( b, [] );\n\n  // get or make the attributes hash\n  hash = extract_attr( result[ 0 ] );\n  if ( !hash ) {\n    hash = {};\n    result[ 0 ].splice( 1, 0, hash );\n  }\n\n  // attach the attributes to the block\n  for ( a in attr ) {\n    hash[ a ] = attr[ a ];\n  }\n\n  return result;\n};\n\nMarkdown.dialects.Maruku.block.definition_list = function definition_list( block, next ) {\n  // one or more terms followed by one or more definitions, in a single block\n  var tight = /^((?:[^\\s:].*\\n)+):\\s+([\\s\\S]+)$/,\n      list = [ \"dl\" ],\n      i, m;\n\n  // see if we're dealing with a tight or loose block\n  if ( ( m = block.match( tight ) ) ) {\n    // pull subsequent tight DL blocks out of `next`\n    var blocks = [ block ];\n    while ( next.length && tight.exec( next[ 0 ] ) ) {\n      blocks.push( next.shift() );\n    }\n\n    for ( var b = 0; b < blocks.length; ++b ) {\n      var m = blocks[ b ].match( tight ),\n          terms = m[ 1 ].replace( /\\n$/, \"\" ).split( /\\n/ ),\n          defns = m[ 2 ].split( /\\n:\\s+/ );\n\n      // print( uneval( m ) );\n\n      for ( i = 0; i < terms.length; ++i ) {\n        list.push( [ \"dt\", terms[ i ] ] );\n      }\n\n      for ( i = 0; i < defns.length; ++i ) {\n        // run inline processing over the definition\n        list.push( [ \"dd\" ].concat( this.processInline( defns[ i ].replace( /(\\n)\\s+/, \"$1\" ) ) ) );\n      }\n    }\n  }\n  else {\n    return undefined;\n  }\n\n  return [ list ];\n};\n\n// splits on unescaped instances of @ch. If @ch is not a character the result\n// can be unpredictable\n\nMarkdown.dialects.Maruku.block.table = function table (block, next) {\n\n    var _split_on_unescaped = function(s, ch) {\n        ch = ch || '\\\\s';\n        if (ch.match(/^[\\\\|\\[\\]{}?*.+^$]$/)) { ch = '\\\\' + ch; }\n        var res = [ ],\n            r = new RegExp('^((?:\\\\\\\\.|[^\\\\\\\\' + ch + '])*)' + ch + '(.*)'),\n            m;\n        while(m = s.match(r)) {\n            res.push(m[1]);\n            s = m[2];\n        }\n        res.push(s);\n        return res;\n    }\n\n    var leading_pipe = /^ {0,3}\\|(.+)\\n {0,3}\\|\\s*([\\-:]+[\\-| :]*)\\n((?:\\s*\\|.*(?:\\n|$))*)(?=\\n|$)/,\n        // find at least an unescaped pipe in each line\n        no_leading_pipe = /^ {0,3}(\\S(?:\\\\.|[^\\\\|])*\\|.*)\\n {0,3}([\\-:]+\\s*\\|[\\-| :]*)\\n((?:(?:\\\\.|[^\\\\|])*\\|.*(?:\\n|$))*)(?=\\n|$)/,\n        i, m;\n    if (m = block.match(leading_pipe)) {\n        // remove leading pipes in contents\n        // (header and horizontal rule already have the leading pipe left out)\n        m[3] = m[3].replace(/^\\s*\\|/gm, '');\n    } else if (! ( m = block.match(no_leading_pipe))) {\n        return undefined;\n    }\n\n    var table = [ \"table\", [ \"thead\", [ \"tr\" ] ], [ \"tbody\" ] ];\n\n    // remove trailing pipes, then split on pipes\n    // (no escaped pipes are allowed in horizontal rule)\n    m[2] = m[2].replace(/\\|\\s*$/, '').split('|');\n\n    // process alignment\n    var html_attrs = [ ];\n    forEach (m[2], function (s) {\n        if (s.match(/^\\s*-+:\\s*$/))       html_attrs.push({align: \"right\"});\n        else if (s.match(/^\\s*:-+\\s*$/))  html_attrs.push({align: \"left\"});\n        else if (s.match(/^\\s*:-+:\\s*$/)) html_attrs.push({align: \"center\"});\n        else                              html_attrs.push({});\n    });\n\n    // now for the header, avoid escaped pipes\n    m[1] = _split_on_unescaped(m[1].replace(/\\|\\s*$/, ''), '|');\n    for (i = 0; i < m[1].length; i++) {\n        table[1][1].push(['th', html_attrs[i] || {}].concat(\n            this.processInline(m[1][i].trim())));\n    }\n\n    // now for body contents\n    forEach (m[3].replace(/\\|\\s*$/mg, '').split('\\n'), function (row) {\n        var html_row = ['tr'];\n        row = _split_on_unescaped(row, '|');\n        for (i = 0; i < row.length; i++) {\n            html_row.push(['td', html_attrs[i] || {}].concat(this.processInline(row[i].trim())));\n        }\n        table[2].push(html_row);\n    }, this);\n\n    return [table];\n}\n\nMarkdown.dialects.Maruku.inline[ \"{:\" ] = function inline_meta( text, matches, out ) {\n  if ( !out.length ) {\n    return [ 2, \"{:\" ];\n  }\n\n  // get the preceeding element\n  var before = out[ out.length - 1 ];\n\n  if ( typeof before === \"string\" ) {\n    return [ 2, \"{:\" ];\n  }\n\n  // match a meta hash\n  var m = text.match( /^\\{:\\s*((?:\\\\\\}|[^\\}])*)\\s*\\}/ );\n\n  // no match, false alarm\n  if ( !m ) {\n    return [ 2, \"{:\" ];\n  }\n\n  // attach the attributes to the preceeding element\n  var meta = this.dialect.processMetaHash( m[ 1 ] ),\n      attr = extract_attr( before );\n\n  if ( !attr ) {\n    attr = {};\n    before.splice( 1, 0, attr );\n  }\n\n  for ( var k in meta ) {\n    attr[ k ] = meta[ k ];\n  }\n\n  // cut out the string and replace it with nothing\n  return [ m[ 0 ].length, \"\" ];\n};\n\nMarkdown.dialects.Maruku.inline.__escape__ = /^\\\\[\\\\`\\*_{}\\[\\]()#\\+.!\\-|:]/;\n\nMarkdown.buildBlockOrder ( Markdown.dialects.Maruku.block );\nMarkdown.buildInlinePatterns( Markdown.dialects.Maruku.inline );\n\nvar isArray = Array.isArray || function(obj) {\n  return Object.prototype.toString.call(obj) == \"[object Array]\";\n};\n\nvar forEach;\n// Don't mess with Array.prototype. Its not friendly\nif ( Array.prototype.forEach ) {\n  forEach = function( arr, cb, thisp ) {\n    return arr.forEach( cb, thisp );\n  };\n}\nelse {\n  forEach = function(arr, cb, thisp) {\n    for (var i = 0; i < arr.length; i++) {\n      cb.call(thisp || arr, arr[i], i, arr);\n    }\n  }\n}\n\nvar isEmpty = function( obj ) {\n  for ( var key in obj ) {\n    if ( hasOwnProperty.call( obj, key ) ) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction extract_attr( jsonml ) {\n  return isArray(jsonml)\n      && jsonml.length > 1\n      && typeof jsonml[ 1 ] === \"object\"\n      && !( isArray(jsonml[ 1 ]) )\n      ? jsonml[ 1 ]\n      : undefined;\n}\n\n\n\n/**\n *  renderJsonML( jsonml[, options] ) -> String\n *  - jsonml (Array): JsonML array to render to XML\n *  - options (Object): options\n *\n *  Converts the given JsonML into well-formed XML.\n *\n *  The options currently understood are:\n *\n *  - root (Boolean): wether or not the root node should be included in the\n *    output, or just its children. The default `false` is to not include the\n *    root itself.\n */\nexpose.renderJsonML = function( jsonml, options ) {\n  options = options || {};\n  // include the root element in the rendered output?\n  options.root = options.root || false;\n\n  var content = [];\n\n  if ( options.root ) {\n    content.push( render_tree( jsonml ) );\n  }\n  else {\n    jsonml.shift(); // get rid of the tag\n    if ( jsonml.length && typeof jsonml[ 0 ] === \"object\" && !( jsonml[ 0 ] instanceof Array ) ) {\n      jsonml.shift(); // get rid of the attributes\n    }\n\n    while ( jsonml.length ) {\n      content.push( render_tree( jsonml.shift() ) );\n    }\n  }\n\n  return content.join( \"\\n\\n\" );\n};\n\nfunction escapeHTML( text ) {\n  return text.replace( /&/g, \"&amp;\" )\n             .replace( /</g, \"&lt;\" )\n             .replace( />/g, \"&gt;\" )\n             .replace( /\"/g, \"&quot;\" )\n             .replace( /'/g, \"&#39;\" );\n}\n\nfunction render_tree( jsonml ) {\n  // basic case\n  if ( typeof jsonml === \"string\" ) {\n    return escapeHTML( jsonml );\n  }\n\n  var tag = jsonml.shift(),\n      attributes = {},\n      content = [];\n\n  if ( jsonml.length && typeof jsonml[ 0 ] === \"object\" && !( jsonml[ 0 ] instanceof Array ) ) {\n    attributes = jsonml.shift();\n  }\n\n  while ( jsonml.length ) {\n    content.push( render_tree( jsonml.shift() ) );\n  }\n\n  var tag_attrs = \"\";\n  for ( var a in attributes ) {\n    tag_attrs += \" \" + a + '=\"' + escapeHTML( attributes[ a ] ) + '\"';\n  }\n\n  // be careful about adding whitespace here for inline elements\n  if ( tag == \"img\" || tag == \"br\" || tag == \"hr\" ) {\n    return \"<\"+ tag + tag_attrs + \"/>\";\n  }\n  else {\n    return \"<\"+ tag + tag_attrs + \">\" + content.join( \"\" ) + \"</\" + tag + \">\";\n  }\n}\n\nfunction convert_tree_to_html( tree, references, options ) {\n  var i;\n  options = options || {};\n\n  // shallow clone\n  var jsonml = tree.slice( 0 );\n\n  if ( typeof options.preprocessTreeNode === \"function\" ) {\n      jsonml = options.preprocessTreeNode(jsonml, references);\n  }\n\n  // Clone attributes if they exist\n  var attrs = extract_attr( jsonml );\n  if ( attrs ) {\n    jsonml[ 1 ] = {};\n    for ( i in attrs ) {\n      jsonml[ 1 ][ i ] = attrs[ i ];\n    }\n    attrs = jsonml[ 1 ];\n  }\n\n  // basic case\n  if ( typeof jsonml === \"string\" ) {\n    return jsonml;\n  }\n\n  // convert this node\n  switch ( jsonml[ 0 ] ) {\n    case \"header\":\n      jsonml[ 0 ] = \"h\" + jsonml[ 1 ].level;\n      delete jsonml[ 1 ].level;\n      break;\n    case \"bulletlist\":\n      jsonml[ 0 ] = \"ul\";\n      break;\n    case \"numberlist\":\n      jsonml[ 0 ] = \"ol\";\n      break;\n    case \"listitem\":\n      jsonml[ 0 ] = \"li\";\n      break;\n    case \"para\":\n      jsonml[ 0 ] = \"p\";\n      break;\n    case \"markdown\":\n      jsonml[ 0 ] = \"html\";\n      if ( attrs ) delete attrs.references;\n      break;\n    case \"code_block\":\n      jsonml[ 0 ] = \"pre\";\n      i = attrs ? 2 : 1;\n      var code = [ \"code\" ];\n      code.push.apply( code, jsonml.splice( i, jsonml.length - i ) );\n      jsonml[ i ] = code;\n      break;\n    case \"inlinecode\":\n      jsonml[ 0 ] = \"code\";\n      break;\n    case \"img\":\n      jsonml[ 1 ].src = jsonml[ 1 ].href;\n      delete jsonml[ 1 ].href;\n      break;\n    case \"linebreak\":\n      jsonml[ 0 ] = \"br\";\n    break;\n    case \"link\":\n      jsonml[ 0 ] = \"a\";\n      break;\n    case \"link_ref\":\n      jsonml[ 0 ] = \"a\";\n\n      // grab this ref and clean up the attribute node\n      var ref = references[ attrs.ref ];\n\n      // if the reference exists, make the link\n      if ( ref ) {\n        delete attrs.ref;\n\n        // add in the href and title, if present\n        attrs.href = ref.href;\n        if ( ref.title ) {\n          attrs.title = ref.title;\n        }\n\n        // get rid of the unneeded original text\n        delete attrs.original;\n      }\n      // the reference doesn't exist, so revert to plain text\n      else {\n        return attrs.original;\n      }\n      break;\n    case \"img_ref\":\n      jsonml[ 0 ] = \"img\";\n\n      // grab this ref and clean up the attribute node\n      var ref = references[ attrs.ref ];\n\n      // if the reference exists, make the link\n      if ( ref ) {\n        delete attrs.ref;\n\n        // add in the href and title, if present\n        attrs.src = ref.href;\n        if ( ref.title ) {\n          attrs.title = ref.title;\n        }\n\n        // get rid of the unneeded original text\n        delete attrs.original;\n      }\n      // the reference doesn't exist, so revert to plain text\n      else {\n        return attrs.original;\n      }\n      break;\n  }\n\n  // convert all the children\n  i = 1;\n\n  // deal with the attribute node, if it exists\n  if ( attrs ) {\n    // if there are keys, skip over it\n    for ( var key in jsonml[ 1 ] ) {\n        i = 2;\n        break;\n    }\n    // if there aren't, remove it\n    if ( i === 1 ) {\n      jsonml.splice( i, 1 );\n    }\n  }\n\n  for ( ; i < jsonml.length; ++i ) {\n    jsonml[ i ] = convert_tree_to_html( jsonml[ i ], references, options );\n  }\n\n  return jsonml;\n}\n\n\n// merges adjacent text nodes into a single node\nfunction merge_text_nodes( jsonml ) {\n  // skip the tag name and attribute hash\n  var i = extract_attr( jsonml ) ? 2 : 1;\n\n  while ( i < jsonml.length ) {\n    // if it's a string check the next item too\n    if ( typeof jsonml[ i ] === \"string\" ) {\n      if ( i + 1 < jsonml.length && typeof jsonml[ i + 1 ] === \"string\" ) {\n        // merge the second string into the first and remove it\n        jsonml[ i ] += jsonml.splice( i + 1, 1 )[ 0 ];\n      }\n      else {\n        ++i;\n      }\n    }\n    // if it's not a string recurse\n    else {\n      merge_text_nodes( jsonml[ i ] );\n      ++i;\n    }\n  }\n}\n\n} )( (function() {\n  if ( typeof exports === \"undefined\" ) {\n    window.markdown = {};\n    return window.markdown;\n  }\n  else {\n    return exports;\n  }\n} )() );\n"
  ]
}
{"version":3,"sources":["node_modules/browser-pack/_prelude.js","lib/assets/javascripts/cartodb/common/view_helpers/random_quote.js","lib/assets/javascripts/cartodb/common/views/mapcard_preview.js","lib/assets/javascripts/cartodb/data_library/content/list/dataset_item_view.js","lib/assets/javascripts/cartodb/data_library/content/list/placeholder_item_view.js","lib/assets/javascripts/cartodb/data_library/content/list/view.js","lib/assets/javascripts/cartodb/data_library/content/view.js","lib/assets/javascripts/cartodb/data_library/datasets_collection.js","lib/assets/javascripts/cartodb/data_library/entry.js","lib/assets/javascripts/cartodb/data_library/filters/dropdown/view.js","lib/assets/javascripts/cartodb/data_library/filters/view.js","lib/assets/javascripts/cartodb/data_library/header/view.js","lib/assets/javascripts/cartodb/data_library/main_view.js","lib/assets/javascripts/cartodb/public_common/user_industries/dropdown_view.js","lib/assets/javascripts/cartodb/public_common/user_industries_view.js","lib/assets/javascripts/cartodb/public_common/user_settings/dropdown_view.js","lib/assets/javascripts/cartodb/public_common/user_settings_view.js","lib/assets/javascripts/cartodb/public_dashboard/user_info/breadcrumb_dropdown_view.js","lib/assets/javascripts/cartodb/public_dashboard/user_info_view.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","template","_","quotes","quote","author","Math","round","random","$","window","global","cdb","core","View","extend","options","width","height","privacy","username","visId","mapsApiResource","className","authTokens","_TEMPLATES","regular","cdn","initialize","each","name","this","console","log","load","_startLoader","_loadFromVisId","_generateImageTemplate","replace","protocol","_isHTTPS","cdnConfig","config","get","tpl","_generateAuthTokensParams","url","_loadImage","map","join","location","indexOf","loadURL","$img","$el","append","addClass","fadeIn","showError","_onError","_stopLoader","removeClass","_onSuccess","trigger","error","$error","self","img","Image","onerror","onload","src","err","MapCardPreview","tagName","templates","getTemplate","render","clearSubViews","vis","model","d","attributes","date","datasetSize","_getDatasetSize","geomType","_getGeometryType","account_host","dataset_base_url","html","_renderMapThumbnail","mapCardPreview","el","getMapsResourceName","imageURL","bind","addView","geomTypes","types","find","type","toLowerCase","size","Utils","readablizeBytes","split","DatasetsItem","PlaceholderItem","MAP_CARDS_PER_ROW","_initBinds","collection","_addItem","klass","_ITEMS_PER_PAGE","total_entries","attr","_fillEmptySlotsWithPlaceholderItems","show","hide","m","item","add_related_model","times","_emptySlotsCount","view","randomQuote","defaultUrl","page","isSearching","tag","q","totalItems","totalEntries","admin","Visualizations","Model","_createUrlOptions","UserInfoView","UserSettingsView","UserIndustriesView","DataLibrary","init","namespace","set","common_data_user","document","body","god","authenticatedUser","open","AuthenticatedUser","host","sync","Backbone","withCORS","user","User","userSettingsView","userInfoView","data_library","fetch","DropdownMenu","events","click","click .js-all","click .js-categoryLink","elder","template_base","_onClickAll","tags","_onClickLink","target","text","clean","DropdownView","submit .js-search-form","keydown .js-search-form","click .js-search-form","click .js-search-link","click .js-clean-search","click .js-categoriesDropdown","_preRender","$uInner","$filtersInner","_createDropdown","ev","killEvent","_setupDropdown","closest","horizontal_position","horizontal_offset","tick","position","vertical_offset","dropdownView","_closeAnyOtherOpenDialogs","_onSearchClick","val","focus","_onSearchKeyDown","keyCode","_onCleanSearchClick","_cleanSearch","_submitSearch","stripHTML","trim","bindAll","ACTIVE_CARTODB_ID","_initBindings","click .js-country","click .js-back","_onChangeShowMore","_onChangeVisCount","_onChangeCountries","L","zoomControl","attributionControl","setView","sqlDomain","geojsonURL","encodeURIComponent","getJSON","done","_addGeojsonData","geojsonData","_this","style","color","weight","opacity","fillColor","fillOpacity","layer","geoJson","onEachFeature","feature","featureLayer","on","properties","cartodb_id","_onClickFeature","_onMouseOverFeature","_onMouseOutFeature","addTo","eventLayer","eachLayer","setStyle","bbox","getBounds","fitBounds","_updateBounds","_southWest","lng","lat","_northEast","bounds","_onClickCountry","_onClickBack","toggleClass","FiltersView","ListView","ContentView","DatasetsCollection","DataLibraryHeader","click .js-more","_initModels","_initViews","controlledViews","enabledViews","dataLibraryHeader","filtersView","moreView","listView","noResultsView","errorView","mainLoaderView","_fetchCollection","vis_count","show_more","_onDataFetched","_showLoader","_showLoaderOnly","coll","opts","statusText","_onDataError","activeViews","push","_hideBlocks","_showBlocks","trackJs","track","views","v","without","_isBlockEnabled","contains","_hideLoader","show_countries","is_searching","_resetOptions","order","source","_onClickMore","unbind","_handleClick","constructor","__super__","apply","IndustriesDropdown","click .js-dropdown-target","userUrl","viewUrl","email","isOrgOwner","dashboardUrl","dashboard","publicProfileUrl","publicProfile","accountSettingsUrl","accountSettings","logoutUrl","logout","SettingsDropdown","datasetsUrl","datasets","mapsUrl","maps","avatarUrl","BreadcrumbDropdown","click .js-breadcrumb-dropdown-target","_createBreadcrumbDropdown","dropdown"],"mappings":"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","file":"data_library.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/**\n * Random quote\n */\nmodule.exports = function() {\n\n  var template  = _.template('<p class=\"CDB-Text CDB-Size-medium u-altTextColor\">\"<%= quote %>\"</p><% if (author) { %><p class=\"CDB-Text CDB-Size-medium u-altTextColor u-tSpace\"><em>– <%- author %></em></p><% } %>');\n\n  var quotes = [\n    { quote: \"Geographers never get lost. They just do accidental field work.\", author: \"Nicholas Chrisman\" },\n    { quote: \"Geography is just physics slowed down, with a couple of trees stuck in it.\", author: \"Terry Pratchett\" },\n    { quote: \"Not all those who wander are lost.\", author: \"J. R. R. Tolkien\" },\n    { quote: \"In that Empire, the Art of Cartography attained such Perfection that the map of a single Province occupied the entirety of a City.\", author: \"Jorge Luis Borges\" },\n    { quote: \"X marks the spot\", author: \"Indiana Jones\" },\n    { quote: \"It's turtles all the way down.\", author: null },\n    { quote: \"Remember: no matter where you go, there you are.\", author: null },\n    { quote: \"Without geography, you're nowhere!\", author: \"Jimmy Buffett\" },\n    { quote: \"our earth is a globe / whose surface we probe /<br />no map can replace her / but just try to trace her\", author: \"Steve Waterman\" },\n    { quote: \"Everything happens somewhere.\", author: \"Doctor Who\" },\n    { quote: \"A map is the greatest of all epic poems. Its lines and colors show the realization of great dreams.\", author: \"Gilbert H. Grosvenor\" },\n    { quote: \"Everything is related to everything else,<br />but near things are more related than distant things.\", author: \"Tobler's first law of geography\" },\n    { quote: \"Hic Sunt Dracones\", author: null },\n    { quote: \"Here be dragons\", author: null },\n    { quote: \"Stand in the place where you live / Now face North /<br/>Think about direction / Wonder why you haven't before\", author: \"R.E.M\" },\n    { quote: \"The virtue of maps, they show what can be done with limited space, they foresee that everything can happen therein.\", author: \"José Saramago\" }\n  ];\n\n  var r = Math.round(Math.random() * (quotes.length - 1));\n\n  return template(quotes[r]);\n};\n","var $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\n\n/**\n *  MapCard previews\n *\n */\n\nmodule.exports = cdb.core.View.extend({\n\n  options: {\n    width: 300,\n    height: 170,\n    privacy: 'PUBLIC',\n    username: '',\n    visId: '',\n    mapsApiResource: '',\n    className: '',\n    authTokens: []\n  },\n\n  _TEMPLATES: {\n    // Using <%= %> instead of <%- %> because if not / characters (for example) will be escaped\n    regular: '<%- protocol %>://<%= mapsApiResource %>/api/v1/map/static/named/<%- tpl %>/<%- width %>/<%- height %>.png<%= authTokens %>',\n    cdn: '<%- protocol %>://<%- cdn %>/<%- username %>/api/v1/map/static/named/<%- tpl %>/<%- width %>/<%- height %>.png<%= authTokens %>'\n  },\n\n  initialize: function() {\n    _.each(['visId', 'mapsApiResource', 'username'], function(name) {\n      if (!this.options[name]) {\n        console.log(name + ' is required for Static Map instantiation');\n      }\n    }, this);\n  },\n\n  load: function() {\n    this._startLoader();\n    this._loadFromVisId();\n\n    return this;\n  },\n\n  _generateImageTemplate: function() {\n    return 'tpl_' + this.options.visId.replace(/-/g, '_');\n  },\n\n  _loadFromVisId: function() {\n    var protocol = this._isHTTPS() ? 'https': 'http';\n    var cdnConfig = cdb.config.get('cdn_url');\n    var template = _.template(cdnConfig ? this._TEMPLATES['cdn'] : this._TEMPLATES['regular']);\n\n    var options = {\n      protocol: protocol,\n      username: this.options.username,\n      mapsApiResource: this.options.mapsApiResource,\n      tpl: this._generateImageTemplate(),\n      width: this.options.width,\n      height: this.options.height,\n      authTokens: this._generateAuthTokensParams()\n    };\n\n    if (cdnConfig) {\n      options = _.extend(options, { cdn: cdnConfig[protocol] });\n    }\n\n    var url = template(options);\n\n    this._loadImage({}, url);\n  },\n\n  _generateAuthTokensParams: function () {\n    var authTokens = this.options.authTokens;\n    if (authTokens && authTokens.length > 0) {\n      return '?' + _.map(authTokens, function (t) { return 'auth_token=' + t; }).join('&');\n    } else {\n      return '';\n    }\n  },\n\n  _isHTTPS: function() {\n    return location.protocol.indexOf(\"https\") === 0;\n  },\n\n  loadURL: function(url) {\n    var $img = $('<img class=\"MapCard-preview\" src=\"' + url + '\" />');\n    this.$el.append($img);\n\n    if (this.options.className) {\n      $img.addClass(this.options.className);\n    }\n\n    $img.fadeIn(250);\n  },\n\n  showError: function() {\n    this._onError();\n  },\n\n  _startLoader: function() {\n    this.$el.addClass(\"is-loading\");\n  },\n\n  _stopLoader: function() {\n    this.$el.removeClass(\"is-loading\");\n  },\n\n  _onSuccess: function(url) {\n    this._stopLoader();\n    this.loadURL(url);\n    this.trigger(\"loaded\", url);\n  },\n\n  _onError: function(error) {\n    this._stopLoader();\n    this.$el.addClass(\"has-error\");\n    var $error = $('<div class=\"MapCard-error\" />');\n    this.$el.append($error);\n    $error.fadeIn(250);\n    this.trigger(\"error\");\n  },\n\n  _loadImage: function(error, url) {\n    var self = this;\n    var img  = new Image();\n\n    img.onerror = function() {\n      self._onError(error);\n    };\n\n    img.onload = function() {\n      self._onSuccess(url);\n    };\n\n    try {\n      img.src = url;\n    } catch(err) {\n      this._onError(err);\n    }\n  }\n\n});\n","var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar MapCardPreview = require('../../../common/views/mapcard_preview');\nvar Utils = (typeof window !== \"undefined\" ? window['cdb']['Utils'] : typeof global !== \"undefined\" ? global['cdb']['Utils'] : null);\n\n/**\n * View representing an item in the list under datasets route.\n */\nmodule.exports = cdb.core.View.extend({\n\n  tagName: 'li',\n  className: 'MapsList-item',\n\n  initialize: function() {\n    this.template = cdb.templates.getTemplate('data_library/content/list/dataset_item_template');\n  },\n\n  render: function() {\n    this.clearSubViews();\n\n    var vis = this.model;\n\n    var d = {\n      vis: vis.attributes,\n      date: vis.get('order') === 'updated_at' ? vis.get('updated_at') : vis.get('created_at'),\n      datasetSize: this._getDatasetSize(vis.get('table')['size']),\n      geomType: this._getGeometryType(vis.get('table')['geometry_types']),\n      account_host: cdb.config.get('account_host'),\n      dataset_base_url: cdb.config.get('dataset_base_url')\n    };\n\n    this.$el.html(this.template(d));\n\n    this._renderMapThumbnail();\n\n    return this;\n  },\n\n  _renderMapThumbnail: function() {\n    var username = this.model.get('permission')['owner']['username'];\n    var mapCardPreview = new MapCardPreview({\n      el: this.$('.js-header'),\n      username: username,\n      width: 298,\n      height: 220,\n      visId: this.model.get('id'),\n      mapsApiResource: cdb.config.getMapsResourceName(username)\n    });\n\n    if (this.imageURL) {\n      mapCardPreview.loadURL(this.imageURL);\n    } else {\n      mapCardPreview.load();\n    }\n\n    mapCardPreview.bind(\"loaded\", function(url) {\n      this.imageURL = url;\n    }, this);\n\n    this.addView(mapCardPreview);\n  },\n\n  _getGeometryType: function(geomTypes) {\n    if (geomTypes && geomTypes.length > 0) {\n      var types = ['point', 'polygon', 'line', 'raster'];\n      var geomType = geomTypes[0];\n\n      return _.find(types, function(type) {\n        return geomType.toLowerCase().indexOf(type) !== -1;\n      });\n\n    } else {\n      return null;\n    }\n  },\n\n  _getDatasetSize: function(size) {\n    return size ? cdb.Utils.readablizeBytes(size, true).split(' ') : 0;\n  },\n\n});\n","var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\n\n/**\n * Represents a map card on data library.\n */\n\nmodule.exports = cdb.core.View.extend({\n\n  className: 'MapsList-item MapsList-item--fake',\n  tagName: 'li',\n\n  initialize: function() {\n    this.template = cdb.templates.getTemplate('data_library/content/list/placeholder_item_template');\n  },\n\n  render: function() {\n    this.clearSubViews();\n\n    this.$el.html(\n      this.template()\n    );\n\n    return this;\n  },\n\n});\n","var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar _ = (typeof window !== \"undefined\" ? window['_'] : typeof global !== \"undefined\" ? global['_'] : null);\nvar DatasetsItem = require('./dataset_item_view');\nvar PlaceholderItem = require('./placeholder_item_view');\nvar MAP_CARDS_PER_ROW = 3;\n\n/**\n *  View representing the list of items\n */\n\nmodule.exports = cdb.core.View.extend({\n\n  tagName: 'ul',\n\n  initialize: function() {\n    this._initBinds();\n  },\n\n  render: function() {\n    if (this.collection.options.get('page') === 1) {\n      this.clearSubViews();\n    }\n\n    this.collection.each(this._addItem, this);\n\n    var klass = 'MapsList';\n\n    if (this.collection._ITEMS_PER_PAGE * this.collection.options.get('page') >= this.collection.total_entries) {\n      klass += ' is-bottom';\n    }\n\n    this.$el.attr('class', klass);\n\n    if (this.collection.size() > 0) {\n      this._fillEmptySlotsWithPlaceholderItems();\n    }\n\n    return this;\n  },\n\n  show: function() {\n    this.$el.removeClass('is-hidden');\n  },\n\n  hide: function() {\n    this.$el.addClass('is-hidden');\n  },\n\n  _addItem: function(m) {\n    var item = new DatasetsItem({\n      model: m\n    });\n\n    this.addView(item);\n    this.$el.append(item.render().el);\n  },\n\n  _initBinds: function() {\n    this.collection.bind('reset', this.render, this);\n    this.add_related_model(this.collection);\n  },\n\n  _fillEmptySlotsWithPlaceholderItems: function() {\n    _.times(this._emptySlotsCount(), function(i) {\n      var view = new PlaceholderItem();\n      this.$el.append(view.render().el);\n      this.addView(view);\n    }, this);\n  },\n\n  _emptySlotsCount: function() {\n    return (this.collection._ITEMS_PER_PAGE - this.collection.size()) % MAP_CARDS_PER_ROW;\n  }\n\n});\n","var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar randomQuote = require('../../common/view_helpers/random_quote');\n\n/*\n *  Content result default view\n */\n\nmodule.exports = cdb.core.View.extend({\n\n  initialize: function() {\n    this.template = cdb.templates.getTemplate(this.options.template);\n\n    this._initBinds();\n  },\n\n  render: function() {\n    this.$el.html(this.template({\n      // defaultUrl:     this.router.currentDashboardUrl(),\n      defaultUrl:     '',\n      page:           this.collection.options.get('page'),\n      isSearching:    this.model.get('is_searching'),\n      tag:            this.collection.options.get('tags'),\n      q:              this.collection.options.get('q'),\n      quote:          randomQuote(),\n      type:           this.collection.options.get('type'),\n      totalItems:     this.collection.size(),\n      totalEntries:   this.collection.total_entries\n    }));\n\n    return this;\n  },\n\n  _initBinds: function() {\n    this.collection.bind('change', this.render, this);\n    this.collection.bind('remove add reset', this.render, this);\n    this.add_related_model(this.collection);\n  }\n\n});\n","var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\n\nmodule.exports = cdb.admin.Visualizations.extend({\n\n  _ITEMS_PER_PAGE: 12,\n\n  model: cdb.core.Model,\n\n  url: function() {\n    var u = '//' + cdb.config.get('data_library_user') + '.' + cdb.config.get('account_host') + '/api/v1/viz';\n    u += \"?\" + this._createUrlOptions();\n    return u;\n  }\n\n});\n","var $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\nvar cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar UserInfoView = require('../public_dashboard/user_info_view');\nvar UserSettingsView = require('../public_common/user_settings_view');\nvar UserIndustriesView = require('../public_common/user_industries_view');\nvar DataLibrary = require('./main_view');\n\n/**\n * Entry point for data-library index\n */\n\n$(function() {\n  cdb.init(function() {\n    cdb.templates.namespace = 'cartodb/';\n    cdb.config.set(window.config);\n    cdb.config.set('data_library_user', window.config.common_data_user);\n    cdb.config.set('dataset_base_url', window.dataset_base_url);\n\n    var userIndustriesView = new UserIndustriesView({\n      el: $('.js-user-industries'),\n    });\n\n    $(document.body).bind('click', function() {\n      cdb.god.trigger('closeDialogs');\n    });\n\n    var authenticatedUser = new cdb.open.AuthenticatedUser({ host: cdb.config.get('data_library_user') + '.' + cdb.config.get('account_host')});\n\n    authenticatedUser.sync = Backbone.withCORS;\n\n    authenticatedUser.bind('change', function() {\n      if (authenticatedUser.get('username')) {\n        var user = new cdb.admin.User(authenticatedUser.attributes);\n        var userSettingsView = new UserSettingsView({\n          el: $('.js-user-settings'),\n          model: user\n        });\n        userSettingsView.render();\n\n        $('.js-login').hide();\n        $('.js-learn').show();\n      }\n    });\n\n    var userInfoView = new UserInfoView({\n      el: $('.js-user-info')\n    });\n    userInfoView.render();\n\n    var data_library = new DataLibrary({\n      el: $('.js-data_library')\n    });\n\n    data_library.render();\n\n    authenticatedUser.fetch();\n  });\n});\n","var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\ncdb.admin = (typeof window !== \"undefined\" ? window['cdb']['admin'] : typeof global !== \"undefined\" ? global['cdb']['admin'] : null);\nvar $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\n\n/**\n * The content of the dropdown menu opened by the user in the data-library filters, e.g.:\n *   Category ▼\n *      ______/\\____\n *     |            |\n *     |    this    |\n *     |____________|\n */\nmodule.exports = cdb.admin.DropdownMenu.extend({\n  className: 'CDB-Text Dropdown Dropdown--public',\n\n  events: {\n    'click': 'killEvent',\n    'click .js-all': '_onClickAll',\n    'click .js-categoryLink': '_onClickLink'\n  },\n\n  initialize: function() {\n    this.elder('initialize');\n    this.template_base = cdb.templates.getTemplate('data_library/filters/dropdown/template');\n\n    // TODO: fetch tags dynamically\n\n    // Necessary to hide dialog on click outside popup, for example.\n    cdb.god.bind('closeDialogs', this.hide, this);\n\n    this._initBinds();\n  },\n\n  _initBinds: function() {\n    this.add_related_model(this.collection);\n  },\n\n  _onClickAll: function(e) {\n    this.collection.options.set({\n      tags: '',\n      page: 1\n    });\n    this.hide();\n  },\n\n  _onClickLink: function(e) {\n    var tag = $(e.target).text();\n\n    this.collection.options.set({\n      tags: tag,\n      page: 1\n    });\n    this.hide();\n  },\n\n  render: function() {\n    this.$el.html(this.template_base({ }));\n\n    // TODO: taken from existing code, how should dropdowns really be added to the DOM?\n    $('body').append(this.el);\n\n    return this;\n  },\n\n  clean: function() {\n    this.elder('clean');\n  }\n\n});\n","var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar DropdownView = require('./dropdown/view');\nvar Utils = (typeof window !== \"undefined\" ? window['cdb']['Utils'] : typeof global !== \"undefined\" ? global['cdb']['Utils'] : null);\n\n/**\n *  Dashboard filters.\n *\n *  - 'Filter by' collection.\n *  - 'Search' any pattern within collection.\n *\n */\nmodule.exports = cdb.core.View.extend({\n\n  events: {\n    'submit .js-search-form': '_submitSearch',\n    'keydown .js-search-form': '_onSearchKeyDown',\n    'click .js-search-form': 'killEvent',\n    'click .js-search-link': '_onSearchClick',\n    'click .js-clean-search': '_onCleanSearchClick',\n    'click .js-categoriesDropdown': '_createDropdown'\n  },\n\n  initialize: function() {\n    this.template = cdb.templates.getTemplate('data_library/filters/template');\n\n    this._preRender();\n    this._initBinds();\n  },\n\n  _preRender: function() {\n    var $uInner = $('<div>').addClass('u-inner');\n    var $filtersInner = $('<div>').addClass('Filters-inner');\n    this.$el.append($uInner.append($filtersInner));\n  },\n\n  render: function() {\n    this.$('.Filters-inner').html(\n      this.template({\n        tag: this.collection.options.get('tags'),\n        q: this.collection.options.get('q')\n      })\n    );\n\n    return this;\n  },\n\n  _initBinds: function() {\n    this.collection.bind('add remove change reset', this.render, this);\n    this.collection.options.bind('change:tags', this.render, this);\n    this.add_related_model(this.collection);\n    this.add_related_model(this.collection.options);\n    this.add_related_model(cdb.god);\n  },\n\n  _createDropdown: function(ev) {\n    this.killEvent(ev);\n    this._setupDropdown(new DropdownView({\n      target: $(ev.target).closest('.js-categoriesDropdown'),\n      horizontal_position: 'horizontal_left',\n      horizontal_offset: -90,\n      tick: 'center',\n      collection: this.collection,\n      position: 'offset',\n      vertical_offset: -20\n    }));\n  },\n\n  _setupDropdown: function(dropdownView) {\n    this._closeAnyOtherOpenDialogs();\n\n    this.addView(dropdownView);\n    cdb.god.bind('closeDialogs', function() {\n      dropdownView.clean();\n    }, this);\n\n    this.add_related_model(cdb.god);\n\n    dropdownView.render();\n    dropdownView.open();\n  },\n\n  _closeAnyOtherOpenDialogs: function() {\n    cdb.god.trigger(\"closeDialogs\");\n  },\n\n  _onSearchClick: function(e) {\n    this.killEvent(e);\n\n    this.$('.js-search-input').val('');\n    this.$('.js-search-input').focus();\n  },\n\n  _onSearchKeyDown: function(e) {\n    if (e.keyCode === 27) {\n      this._onSearchClick(e);\n    }\n  },\n\n  // Filter actions\n\n  _onCleanSearchClick: function(e) {\n    this.killEvent(e);\n    this._cleanSearch();\n  },\n\n  _submitSearch: function(e) {\n    this.killEvent(e);\n\n    this.model.set('is_searching', true);\n\n    this.collection.options.set({\n      q: Utils.stripHTML(this.$('.js-search-input').val().trim(),''),\n      page: 1\n    });\n\n    this.render();\n  },\n\n  _cleanSearch: function() {\n    this.model.set('is_searching', false);\n\n    this.collection.options.set({\n      q: '',\n      page: 1\n    });\n\n    this.render();\n  }\n\n});\n","var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\n\n/**\n * The header map in the data-library page, where the user can filter by country, e.g.:\n */\n module.exports = cdb.core.View.extend({\n\n  className: 'DataLibrary-header',\n\n  initialize: function() {\n    _.bindAll(this, '_addGeojsonData');\n\n    this.ACTIVE_CARTODB_ID = null;\n\n    this.template_base = cdb.templates.getTemplate('data_library/header/template');\n\n    this._initBindings();\n  },\n\n  events: {\n    'click .js-country': '_onClickCountry',\n    'click .js-back': '_onClickBack'\n  },\n\n  _initBindings: function() {\n    var self = this;\n\n    this.model.bind('change:show_more', this._onChangeShowMore, this);\n    this.model.bind('change:vis_count', this._onChangeVisCount, this);\n    this.model.bind('change:show_countries', this._onChangeCountries, this);\n  },\n\n  load: function() {\n    this.map = L.map(this.$(\"#DataLibraryMap\")[0], {\n      zoomControl: false,\n      attributionControl: false\n    }).setView([44,-31], 3);\n\n    var sqlDomain = cdb.config.get('sql_api_template').replace('{user}', cdb.config.get('data_library_user'));\n    var geojsonURL = sqlDomain + '/api/v2/sql?q=' + encodeURIComponent(\"select * from world_borders\") + '&format=geojson&filename=world_borders';\n    $.getJSON(geojsonURL).done(this._addGeojsonData);\n  },\n\n  _addGeojsonData: function(geojsonData) {\n    var _this = this;\n\n    var style = {\n      color: '#2E3C43',\n      weight: 1,\n      opacity: 1,\n      fillColor: '#242D32',\n      fillOpacity: 1,\n    };\n\n    this.layer = L.geoJson(geojsonData, {\n      style: style,\n      onEachFeature: function(feature, featureLayer) {\n        featureLayer\n          .on('click', function (e) {\n            if (feature.properties.cartodb_id != _this.ACTIVE_CARTODB_ID) {\n              _this._onClickFeature(feature, featureLayer, e.layer);\n            }\n          })\n          .on('mouseover', function (e) {\n            _this._onMouseOverFeature(featureLayer, e.target);\n          })\n          .on('mouseout', function () {\n            _this._onMouseOutFeature();\n          });\n      }\n    }).addTo(this.map);\n  },\n\n  _onClickFeature: function(feature, featureLayer, eventLayer) {\n    this.ACTIVE_CARTODB_ID = feature.properties.cartodb_id;\n\n    this.layer.eachLayer(function (layer) {\n      layer.setStyle({ fillColor : '#242D32' });\n    });\n\n    featureLayer.setStyle({\n      fillColor: '#fff'\n    });\n\n    var bbox = eventLayer.getBounds();\n\n    this.map.fitBounds(bbox);\n\n    this._updateBounds([\n      bbox._southWest.lng,\n      bbox._southWest.lat,\n      bbox._northEast.lng,\n      bbox._northEast.lat\n    ]);\n  },\n\n  _onMouseOverFeature: function(featureLayer, target) {\n    var _this = this;\n\n    this.layer.eachLayer(function (layer) {\n      if (layer.feature.properties.cartodb_id != _this.ACTIVE_CARTODB_ID) {\n        layer.setStyle({ fillColor : '#242D32' });\n      }\n    });\n\n    if (target.feature.properties.cartodb_id != this.ACTIVE_CARTODB_ID) {\n      featureLayer.setStyle({ fillColor : '#616567' });\n    }\n  },\n\n  _onMouseOutFeature: function() {\n    var _this = this;\n\n    this.layer.eachLayer(function (layer) {\n      if (layer.feature.properties.cartodb_id != _this.ACTIVE_CARTODB_ID) {\n        layer.setStyle({ fillColor : '#242D32' });\n      }\n    });\n  },\n\n  show: function() {\n    $('.js-Header-title').removeClass('is-hidden');\n    $('.js-Header-footer').removeClass('is-hidden');\n    this.$el.addClass('is-active');\n  },\n\n  hide: function() {\n    $('.js-Header-title').addClass('is-hidden');\n    $('.js-Header-footer').addClass('is-hidden');\n\n    this.$el.removeClass('is-active');\n  },\n\n  _updateBounds: function(bounds) {\n    this.collection.options.set({\n      bbox: bounds.join(','),\n      page: 1\n    });\n\n  },\n\n  _onClickCountry: function() {\n    this.model.set('show_countries', true);\n  },\n\n  _onClickBack: function() {\n    this.model.set('show_countries', false);\n    this.ACTIVE_CARTODB_ID = null;\n    this.collection.options.set({\n      bbox: '',\n      page: 1\n    });\n\n    this.map.setView([44,-31], 3);\n\n    this.layer.eachLayer(function (layer) {\n      layer.setStyle({ fillColor : '#242D32' });\n    });\n  },\n\n  render: function() {\n    this.$el.html(this.template_base({ }));\n\n    return this;\n  },\n\n  _onChangeCountries: function() {\n    this.$('.js-Header-title').toggleClass('is-hidden', this.model.get('show_countries'));\n    this.$('.js-CountrySelector').toggleClass('is-hidden', this.model.get('show_countries'));\n    this.$('.js-CountrySelector-back').toggleClass('is-hidden', !this.model.get('show_countries'));\n    this.$el.toggleClass('is-active', this.model.get('show_countries'));\n  }\n\n});\n","var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar FiltersView = require('./filters/view');\nvar ListView = require('./content/list/view');\nvar ContentView = require('./content/view');\nvar DatasetsCollection = require('./datasets_collection');\nvar DataLibraryHeader = require('./header/view');\n\n\nmodule.exports = cdb.core.View.extend({\n\n  events: {\n    'click .js-more': '_onClickMore'\n  },\n\n  initialize: function() {\n    this._initModels();\n    this._initViews();\n\n    this._initBindings();\n  },\n\n  _initViews: function() {\n    this.controlledViews = {};  // All available views\n    this.enabledViews = [];     // Visible views\n\n    var dataLibraryHeader = new DataLibraryHeader({\n      model: this.model,\n      collection: this.collection\n    });\n\n    this.addView(dataLibraryHeader);\n    $('.js-Header--datalibrary').append(dataLibraryHeader.render().el);\n    dataLibraryHeader.load();\n\n    var filtersView = new FiltersView({\n      el: this.$('.Filters'),\n      collection: this.collection,\n      model: this.model\n    });\n    filtersView.render();\n    this.addView(filtersView);\n\n    var moreView = new ContentView({\n      model: this.model,\n      collection: this.collection,\n      template: 'data_library/content/more_template',\n    });\n    this.$el.append(moreView.render().el);\n    this.addView(moreView);\n\n    var listView = new ListView({\n      collection: this.collection\n    });\n    this.$('.js-DataLibrary-content').append(listView.render().el);\n    this.addView(listView);\n    this.controlledViews['list'] = listView;\n\n    var noResultsView = new ContentView({\n      model: this.model,\n      collection: this.collection,\n      template: 'data_library/content/no_results_template',\n    });\n    this.$el.append(noResultsView.render().el);\n    this.addView(noResultsView);\n    this.controlledViews['no_results'] = noResultsView;\n\n    var errorView = new ContentView({\n      model: this.model,\n      collection: this.collection,\n      template: 'data_library/content/error_template'\n    });\n    this.$el.append(errorView.render().el);\n    this.addView(errorView);\n    this.controlledViews['error'] = errorView;\n\n    var mainLoaderView = new ContentView({\n      model: this.model,\n      collection: this.collection,\n      template: 'data_library/content/loader_template'\n    });\n    this.$el.append(mainLoaderView.render().el);\n    this.addView(mainLoaderView);\n    this.controlledViews['main_loader'] = mainLoaderView;\n  },\n\n  _fetchCollection: function() {\n    this.collection.fetch();\n  },\n\n  render: function() {\n    this._fetchCollection();\n\n    return this;\n  },\n\n  _initBindings: function() {\n    this.model.bind('change:show_more', this._onChangeShowMore, this);\n    this.model.bind('change:vis_count', this._onChangeVisCount, this);\n\n    this.collection.options.bind('change:tags', function() {\n      this.model.set({ vis_count: 0 });\n    }, this);\n    this.collection.options.bind('change:bbox', function() {\n      this.model.set({ vis_count: 0 });\n    }, this);\n\n    this.collection.options.bind('change', function() {\n      this.model.set({ show_more: false });\n      this._fetchCollection();\n    }, this);\n    this.collection.bind('reset', function() {\n      this._onDataFetched();\n    }, this);\n    this.collection.bind('loading', function() {\n      if (this.collection.options.get('page') === 1) {\n        this._showLoader();\n      } else {\n        this._showLoaderOnly();\n      }\n    }, this);\n    this.collection.bind('error', function(coll, e, opts) {\n      if (!e || (e && e.statusText !== \"abort\")) {\n        this._onDataError(e);\n      }\n    }, this);\n\n    this.add_related_model(this.collection);\n    this.add_related_model(this.collection.options);\n  },\n\n  _onChangeVisCount: function() {\n    if (this.model.get('vis_count') >= this.collection.total_entries) {\n      this.model.set({ show_more: false });\n    } else {\n      this.model.set({ show_more: true });\n    }\n  },\n\n  _onChangeShowMore: function() {\n    this.$('.js-more').toggleClass('is-hidden', !this.model.get('show_more'));\n  },\n\n  _onDataFetched: function() {\n    var activeViews = [ ];\n\n    if (this.collection.size() === 0) {\n      activeViews.push('no_results');\n    } else {\n      this.model.set({ vis_count: this.model.get('vis_count') + this.collection.length, show_more: true });\n      activeViews.push('list');\n    }\n\n    this._hideBlocks();\n    this._showBlocks(activeViews);\n  },\n\n  _onDataError: function(e) {\n    // Send error to TrackJS\n    if (window.trackJs && window.trackJs.track) {\n      window.trackJs.track(e);\n    }\n\n    this._hideBlocks();\n    this._showBlocks([ 'error' ]);\n  },\n\n  _showBlocks: function(views) {\n    var self = this;\n\n    if (views) {\n      _.each(views, function(v){\n        self.controlledViews[v].show();\n        self.enabledViews.push(v);\n      });\n    } else {\n      self.enabledViews = [];\n      _.each(this.controlledViews, function(v){\n        v.show();\n        self.enabledViews.push(v);\n      });\n    }\n  },\n\n  _hideBlocks: function(views) {\n    var self = this;\n    if (views) {\n      _.each(views, function(v){\n        self.controlledViews[v].hide();\n        self.enabledViews = _.without(self.enabledViews, v);\n      });\n    } else {\n      _.each(this.controlledViews, function(v){\n        v.hide();\n      });\n      self.enabledViews = [];\n    }\n  },\n\n  _isBlockEnabled: function(name) {\n    if (name) {\n      return _.contains(this.enabledViews, name);\n    }\n\n    return false;\n  },\n\n  _showLoader: function() {\n    this._hideBlocks();\n    this._showBlocks([ 'main_loader' ]);\n  },\n\n  _showLoaderOnly: function() {\n    this._showBlocks([ 'main_loader' ]);\n  },\n\n  _hideLoader: function() {\n    this._hideBlocks([ 'main_loader' ]);\n  },\n\n  _initModels: function() {\n    this.model = new cdb.core.Model({\n      vis_count: 0,\n      show_countries: false,\n      is_searching: false\n    });\n\n    this.collection = new DatasetsCollection();\n\n    this._resetOptions();\n  },\n\n  _resetOptions: function() {\n    this.collection.options.set({\n      q: '',\n      order: 'updated_at',\n      page: 1,\n      tags: '',\n      bbox: '',\n      source: [],\n      type: 'table'\n    });\n  },\n\n  _onClickMore: function(e) {\n    this.killEvent(e);\n\n    this.model.set({ show_more: false });\n\n    this.collection.options.set({\n      page: this.collection.options.get('page') + 1\n    });\n  }\n\n});\n","var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\ncdb.admin = (typeof window !== \"undefined\" ? window['cdb']['admin'] : typeof global !== \"undefined\" ? global['cdb']['admin'] : null);\nvar $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\n\n/**\n * The content of the dropdown menu opened by the industries link in the header, e.g.:\n *   CartoDB, Industries, Explore, Pricing\n *             ______/\\____\n *            |            |\n *            |    this    |\n *            |____________|\n */\nmodule.exports = cdb.admin.DropdownMenu.extend({\n  className: 'CDB-Text Dropdown Dropdown--public',\n\n  initialize: function() {\n    this.elder('initialize');\n    this.template_base = cdb.templates.getTemplate('public_common/user_industries/dropdown_template');\n\n    // Necessary to hide dialog on click outside popup, for example.\n    cdb.god.bind('closeDialogs', this.hide, this);\n  },\n\n  render: function() {\n    this.$el.html(this.template_base());\n\n    // TODO: taken from existing code, how should dropdowns really be added to the DOM?\n    $('body').append(this.el);\n\n    return this;\n  },\n\n  clean: function() {\n    // Until https://github.com/CartoDB/cartodb.js/issues/238 is resolved:\n    $(this.options.target).unbind('click', this._handleClick);\n    this.constructor.__super__.clean.apply(this);\n  }\n\n});\n","var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar IndustriesDropdown = require('./user_industries/dropdown_view');\nvar $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\n\n/**\n * View to render the user industries section in the header.\n * Expected to be created from existing DOM element.\n */\nmodule.exports = cdb.core.View.extend({\n\n  events: {\n    'click .js-dropdown-target': '_createDropdown'\n  },\n\n  _createDropdown: function(ev) {\n    this.killEvent(ev);\n    cdb.god.trigger('closeDialogs');\n\n    var view = new IndustriesDropdown({\n      target: $(ev.target),\n      vertical_offset: -10,\n      horizontal_offset: $(ev.target).width()-100,\n      horizontal_position: 'left',\n      tick: 'center'\n    });\n    view.render();\n\n    view.on('onDropdownHidden', function() {\n      view.clean();\n    }, this);\n\n    view.open();\n  }\n\n});\n","var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\ncdb.admin = (typeof window !== \"undefined\" ? window['cdb']['admin'] : typeof global !== \"undefined\" ? global['cdb']['admin'] : null);\nvar $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\n\n/**\n * The content of the dropdown menu opened by the user avatar in the top-right of the header, e.g.:\n *   Explore, Learn, ♞\n *             ______/\\____\n *            |            |\n *            |    this    |\n *            |____________|\n */\nmodule.exports = cdb.admin.DropdownMenu.extend({\n  className: 'CDB-Text Dropdown',\n\n  initialize: function() {\n    this.elder('initialize');\n    this.template_base = cdb.templates.getTemplate('public_common/user_settings/dropdown_template');\n\n    // Necessary to hide dialog on click outside popup, for example.\n    cdb.god.bind('closeDialogs', this.hide, this);\n  },\n\n  render: function() {\n    var user = this.model;\n    var userUrl = user.viewUrl();\n\n    this.$el.html(this.template_base({\n      name: user.get('name') || user.get('username'),\n      email: user.get('email'),\n      isOrgOwner: user.isOrgOwner(),\n      dashboardUrl: userUrl.dashboard(),\n      publicProfileUrl: userUrl.publicProfile(),\n      accountSettingsUrl: userUrl.accountSettings(),\n      logoutUrl: userUrl.logout()\n    }));\n\n    // TODO: taken from existing code, how should dropdowns really be added to the DOM?\n    $('body').append(this.el);\n\n    return this;\n  },\n\n  clean: function() {\n    // Until https://github.com/CartoDB/cartodb.js/issues/238 is resolved:\n    $(this.options.target).unbind('click', this._handleClick);\n    this.constructor.__super__.clean.apply(this);\n  }\n\n});\n","var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar SettingsDropdown = require('./user_settings/dropdown_view');\nvar $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\n\n/**\n * View to render the user settings section in the header.\n * Expected to be created from existing DOM element.\n */\nmodule.exports = cdb.core.View.extend({\n\n  events: {\n    'click .js-dropdown-target': '_createDropdown'\n  },\n\n  render: function() {\n    var dashboardUrl = this.model.viewUrl().dashboard();\n    var datasetsUrl = dashboardUrl.datasets();\n    var mapsUrl = dashboardUrl.maps();\n\n    this.$el.html(\n      cdb.templates.getTemplate('public_common/user_settings_template')({\n        avatarUrl: this.model.get('avatar_url'),\n        mapsUrl: mapsUrl,\n        datasetsUrl: datasetsUrl\n      })\n    );\n\n    return this;\n  },\n\n  _createDropdown: function(ev) {\n    this.killEvent(ev);\n    cdb.god.trigger('closeDialogs');\n\n    var view = new SettingsDropdown({\n      target: $(ev.target),\n      model: this.model, // user\n      horizontal_offset: 18\n    });\n    view.render();\n\n    view.on('onDropdownHidden', function() {\n      view.clean();\n    }, this);\n\n    view.open();\n  }\n\n});\n","var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\n\n/**\n * The content of the dropdown menu opened by the link at the end of the breadcrumbs menu, e.g.\n *   username / Maps v\n *            ______/\\____\n *           |            |\n *           |    this    |\n *           |____________|\n */\nmodule.exports = cdb.admin.DropdownMenu.extend({\n  className: 'Dropdown',\n\n  initialize: function() {\n    this.elder('initialize');\n\n    // Necessary to hide dialog on click outside popup, for example.\n    cdb.god.bind('closeDialogs', this.hide, this);\n  },\n\n  render: function() {\n    this.$el.show();\n\n    return this;\n  },\n\n  clean: function() {\n    this.$el.hide();\n  }\n});\n","var cdb = (typeof window !== \"undefined\" ? window['cdb'] : typeof global !== \"undefined\" ? global['cdb'] : null);\nvar $ = (typeof window !== \"undefined\" ? window['$'] : typeof global !== \"undefined\" ? global['$'] : null);\nvar BreadcrumbDropdown = require('./user_info/breadcrumb_dropdown_view');\n\n/**\n * View to render the user info section.\n * Expected to be created from existing DOM element.\n */\nmodule.exports = cdb.core.View.extend({\n\n  events: {\n    'click .js-breadcrumb-dropdown-target': '_createBreadcrumbDropdown'\n  },\n\n  render: function() {\n    return this;\n  },\n\n  _createBreadcrumbDropdown: function(ev) {\n    this.killEvent(ev);\n    var dropdown = new BreadcrumbDropdown({\n      target: $('.js-breadcrumb-dropdown-target'),\n      el: $('.js-breadcrumb-dropdown-content'),\n      horizontal_offset: 3, // to match the dropdown indicator/arrow\n      horizontal_position: 'right',\n      tick: 'right'\n    });\n    this.addView(dropdown);\n    dropdown.on('onDropdownShown', function () {\n      cdb.god.trigger('closeDialogs');\n    }, this);\n    dropdown.open();\n  }\n});\n"]}
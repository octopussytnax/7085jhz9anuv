/*! v4.7.15 - 2017-05-30 */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){(function(a){var c="undefined"!=typeof window?window.cdb:"undefined"!=typeof a?a.cdb:null,d=("undefined"!=typeof window?window.cdb.admin:"undefined"!=typeof a?a.cdb.admin:null,2e3),e=2.5,f=30;b.exports=c.core.Model.extend({defaults:{email:"",google_sign_in:!1,requires_validation_email:!1,state:"",username:""},url:function(a){var b="/api/v1/user_creations";return b+"/"+this.id},initialize:function(){this._initBinds()},_initBinds:function(){this.bind("change:state",this._checkState,this)},_checkState:function(){this.get("state");(this.hasFinished()||this.hasFailed())&&this.destroyCheck()},pollCheck:function(){function a(){b.destroyCheck(),b.fetch(),++c;var g=c>f?e:1;b.pollTimer=setInterval(a,d*g)}if(!this.pollTimer){var b=this,c=0;this.pollTimer=setInterval(a,d),a()}},destroyCheck:function(){clearInterval(this.pollTimer),delete this.pollTimer},hasUsedGoogle:function(){return this.get("google_sign_in")},requiresValidationEmail:function(){return this.get("requires_validation_email")},hasFinished:function(){return"success"===this.get("state")},hasFailed:function(){return"failure"===this.get("state")}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(a,b,c){(function(b){var c="undefined"!=typeof window?window.$:"undefined"!=typeof b?b.$:null,d="undefined"!=typeof window?window.cdb:"undefined"!=typeof b?b.cdb:null,e=a("./main_view");c(function(){d.init(function(){d.templates.namespace="cartodb/";new e({userCreationId:user_creation_id,username:user_name,customHosted:is_custom_install,userURL:user_url})})})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./main_view":3}],3:[function(a,b,c){(function(c){var d=("undefined"!=typeof window?window.$:"undefined"!=typeof c?c.$:null,"undefined"!=typeof window?window.cdb:"undefined"!=typeof c?c.cdb:null),e=a("./confirmation_model");b.exports=Backbone.View.extend({el:document.body,initialize:function(a){if(!a.userCreationId)throw new Error("user creation id is needed to check its state");this.template=d.templates.getTemplate("confirmation/confirmation_info"),this.model=new e({id:a.userCreationId}),this._initBinds(),this.model.pollCheck()},render:function(){return this.$(".js-info").html(this.template({googleSignup:this.model.get("google_sign_in"),requiresValidationEmail:this.model.requiresValidationEmail(),userCreationId:this.model.get("id"),state:this.model.get("state"),customHosted:d.config.get("cartodb_com_hosted")})),this},_initBinds:function(){this.model.bind("change:state",function(){this._setLogo(),this.render(),!this.model.hasFinished()||!this.model.hasUsedGoogle()&&this.model.requiresValidationEmail()||this._goToUserURL()},this)},_setLogo:function(){this.$(".js-logo").toggleClass("is-loading",!this.model.hasFailed()&&!this.model.hasFinished()),this.model.hasFailed()?this.$(".js-successNotification").remove():this.model.hasFinished()&&this.$(".js-errorNotification").remove(),(this.model.hasFailed()||this.model.hasFinished())&&this.$(".js-notification").show()},_goToUserURL:function(){this.options.userURL&&(window.location.href=this.options.userURL)}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./confirmation_model":1}]},{},[2]);
//# sourceMappingURL=confirmation.js.map